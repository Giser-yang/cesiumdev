/**
 * @license
 * Cesium - https://github.com/CesiumGS/cesium
 * Version 1.123
 *
 * Copyright 2011-2022 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/CesiumGS/cesium/blob/main/LICENSE.md for full licensing details.
 */

var pSe=Object.create;var A$=Object.defineProperty;var _Se=Object.getOwnPropertyDescriptor;var gSe=Object.getOwnPropertyNames;var ySe=Object.getPrototypeOf,xSe=Object.prototype.hasOwnProperty;var Kb=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,n)=>(typeof require<"u"?require:t)[n]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var Fn=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var bSe=(e,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of gSe(t))!xSe.call(e,o)&&o!==n&&A$(e,o,{get:()=>t[o],enumerable:!(i=_Se(t,o))||i.enumerable});return e};var Dr=(e,t,n)=>(n=e!=null?pSe(ySe(e)):{},bSe(t||!e||!e.__esModule?A$(n,"default",{value:e,enumerable:!0}):n,e));var qI=Fn((wvt,E$)=>{var Ym=function(e){e==null&&(e=new Date().getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,e.constructor==Array?this.init_by_array(e,e.length):this.init_seed(e)};Ym.prototype.init_seed=function(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<this.N;this.mti++){var e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(((e&4294901760)>>>16)*1812433253<<16)+(e&65535)*1812433253+this.mti,this.mt[this.mti]>>>=0}};Ym.prototype.init_by_array=function(e,t){var n,i,o;for(this.init_seed(19650218),n=1,i=0,o=this.N>t?this.N:t;o;o--){var r=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(((r&4294901760)>>>16)*1664525<<16)+(r&65535)*1664525)+e[i]+i,this.mt[n]>>>=0,n++,i++,n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1),i>=t&&(i=0)}for(o=this.N-1;o;o--){var r=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(((r&4294901760)>>>16)*1566083941<<16)+(r&65535)*1566083941)-n,this.mt[n]>>>=0,n++,n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1)}this.mt[0]=2147483648};Ym.prototype.random_int=function(){var e,t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var n;for(this.mti==this.N+1&&this.init_seed(5489),n=0;n<this.N-this.M;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+this.M]^e>>>1^t[e&1];for(;n<this.N-1;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+(this.M-this.N)]^e>>>1^t[e&1];e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[e&1],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,e^=e>>>18,e>>>0};Ym.prototype.random_int31=function(){return this.random_int()>>>1};Ym.prototype.random_incl=function(){return this.random_int()*(1/4294967295)};Ym.prototype.random=function(){return this.random_int()*(1/4294967296)};Ym.prototype.random_excl=function(){return(this.random_int()+.5)*(1/4294967296)};Ym.prototype.random_long=function(){var e=this.random_int()>>>5,t=this.random_int()>>>6;return(e*67108864+t)*(1/9007199254740992)};E$.exports=Ym});var K$=Fn((iC,oC)=>{/*! https://mths.be/punycode v1.4.0 by @mathias */(function(e){var t=typeof iC=="object"&&iC&&!iC.nodeType&&iC,n=typeof oC=="object"&&oC&&!oC.nodeType&&oC,i=typeof global=="object"&&global;(i.global===i||i.window===i||i.self===i)&&(e=i);var o,r=2147483647,s=36,a=1,c=26,l=38,f=700,d=72,p=128,g="-",m=/^xn--/,y=/[^\x20-\x7E]/,b=/[\x2E\u3002\uFF0E\uFF61]/g,C={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},A=s-a,T=Math.floor,E=String.fromCharCode,v;function D(V){throw new RangeError(C[V])}function O(V,U){for(var B=V.length,W=[];B--;)W[B]=U(V[B]);return W}function P(V,U){var B=V.split("@"),W="";B.length>1&&(W=B[0]+"@",V=B[1]),V=V.replace(b,".");var j=V.split("."),Q=O(j,U).join(".");return W+Q}function M(V){for(var U=[],B=0,W=V.length,j,Q;B<W;)j=V.charCodeAt(B++),j>=55296&&j<=56319&&B<W?(Q=V.charCodeAt(B++),(Q&64512)==56320?U.push(((j&1023)<<10)+(Q&1023)+65536):(U.push(j),B--)):U.push(j);return U}function L(V){return O(V,function(U){var B="";return U>65535&&(U-=65536,B+=E(U>>>10&1023|55296),U=56320|U&1023),B+=E(U),B}).join("")}function _(V){return V-48<10?V-22:V-65<26?V-65:V-97<26?V-97:s}function S(V,U){return V+22+75*(V<26)-((U!=0)<<5)}function w(V,U,B){var W=0;for(V=B?T(V/f):V>>1,V+=T(V/U);V>A*c>>1;W+=s)V=T(V/A);return T(W+(A+1)*V/(V+l))}function I(V){var U=[],B=V.length,W,j=0,Q=p,q=d,X,Z,fe,xe,re,pe,ye,Se,Te;for(X=V.lastIndexOf(g),X<0&&(X=0),Z=0;Z<X;++Z)V.charCodeAt(Z)>=128&&D("not-basic"),U.push(V.charCodeAt(Z));for(fe=X>0?X+1:0;fe<B;){for(xe=j,re=1,pe=s;fe>=B&&D("invalid-input"),ye=_(V.charCodeAt(fe++)),(ye>=s||ye>T((r-j)/re))&&D("overflow"),j+=ye*re,Se=pe<=q?a:pe>=q+c?c:pe-q,!(ye<Se);pe+=s)Te=s-Se,re>T(r/Te)&&D("overflow"),re*=Te;W=U.length+1,q=w(j-xe,W,xe==0),T(j/W)>r-Q&&D("overflow"),Q+=T(j/W),j%=W,U.splice(j++,0,Q)}return L(U)}function N(V){var U,B,W,j,Q,q,X,Z,fe,xe,re,pe=[],ye,Se,Te,Fe;for(V=M(V),ye=V.length,U=p,B=0,Q=d,q=0;q<ye;++q)re=V[q],re<128&&pe.push(E(re));for(W=j=pe.length,j&&pe.push(g);W<ye;){for(X=r,q=0;q<ye;++q)re=V[q],re>=U&&re<X&&(X=re);for(Se=W+1,X-U>T((r-B)/Se)&&D("overflow"),B+=(X-U)*Se,U=X,q=0;q<ye;++q)if(re=V[q],re<U&&++B>r&&D("overflow"),re==U){for(Z=B,fe=s;xe=fe<=Q?a:fe>=Q+c?c:fe-Q,!(Z<xe);fe+=s)Fe=Z-xe,Te=s-xe,pe.push(E(S(xe+Fe%Te,0))),Z=T(Fe/Te);pe.push(E(S(Z,0))),Q=w(B,Se,W==j),B=0,++W}++B,++U}return pe.join("")}function k(V){return P(V,function(U){return m.test(U)?I(U.slice(4).toLowerCase()):U})}function z(V){return P(V,function(U){return y.test(U)?"xn--"+N(U):U})}if(o={version:"1.3.2",ucs2:{decode:M,encode:L},decode:I,encode:N,toASCII:z,toUnicode:k},typeof define=="function"&&typeof define.amd=="object"&&define.amd)define("punycode",function(){return o});else if(t&&n)if(oC.exports==t)n.exports=o;else for(v in o)o.hasOwnProperty(v)&&(t[v]=o[v]);else e.punycode=o})(iC)});var $$=Fn((Z$,dP)=>{/*!
 * URI.js - Mutating URLs
 * IPv6 Support
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */(function(e,t){"use strict";typeof dP=="object"&&dP.exports?dP.exports=t():typeof define=="function"&&define.amd?define(t):e.IPv6=t(e)})(Z$,function(e){"use strict";var t=e&&e.IPv6;function n(o){var r=o.toLowerCase(),s=r.split(":"),a=s.length,c=8;s[0]===""&&s[1]===""&&s[2]===""?(s.shift(),s.shift()):s[0]===""&&s[1]===""?s.shift():s[a-1]===""&&s[a-2]===""&&s.pop(),a=s.length,s[a-1].indexOf(".")!==-1&&(c=7);var l;for(l=0;l<a&&s[l]!=="";l++);if(l<c)for(s.splice(l,1,"0000");s.length<c;)s.splice(l,0,"0000");for(var f,d=0;d<c;d++){f=s[d].split("");for(var p=0;p<3&&(f[0]==="0"&&f.length>1);p++)f.splice(0,1);s[d]=f.join("")}var g=-1,m=0,y=0,b=-1,C=!1;for(d=0;d<c;d++)C?s[d]==="0"?y+=1:(C=!1,y>m&&(g=b,m=y)):s[d]==="0"&&(C=!0,b=d,y=1);y>m&&(g=b,m=y),m>1&&s.splice(g,m,""),a=s.length;var A="";for(s[0]===""&&(A=":"),d=0;d<a&&(A+=s[d],d!==a-1);d++)A+=":";return s[a-1]===""&&(A+=":"),A}function i(){return e.IPv6===this&&(e.IPv6=t),this}return{best:n,noConflict:i}})});var J$=Fn((Q$,hP)=>{/*!
 * URI.js - Mutating URLs
 * Second Level Domain (SLD) Support
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */(function(e,t){"use strict";typeof hP=="object"&&hP.exports?hP.exports=t():typeof define=="function"&&define.amd?define(t):e.SecondLevelDomains=t(e)})(Q$,function(e){"use strict";var t=e&&e.SecondLevelDomains,n={list:{ac:" com gov mil net org ",ae:" ac co gov mil name net org pro sch ",af:" com edu gov net org ",al:" com edu gov mil net org ",ao:" co ed gv it og pb ",ar:" com edu gob gov int mil net org tur ",at:" ac co gv or ",au:" asn com csiro edu gov id net org ",ba:" co com edu gov mil net org rs unbi unmo unsa untz unze ",bb:" biz co com edu gov info net org store tv ",bh:" biz cc com edu gov info net org ",bn:" com edu gov net org ",bo:" com edu gob gov int mil net org tv ",br:" adm adv agr am arq art ato b bio blog bmd cim cng cnt com coop ecn edu eng esp etc eti far flog fm fnd fot fst g12 ggf gov imb ind inf jor jus lel mat med mil mus net nom not ntr odo org ppg pro psc psi qsl rec slg srv tmp trd tur tv vet vlog wiki zlg ",bs:" com edu gov net org ",bz:" du et om ov rg ",ca:" ab bc mb nb nf nl ns nt nu on pe qc sk yk ",ck:" biz co edu gen gov info net org ",cn:" ac ah bj com cq edu fj gd gov gs gx gz ha hb he hi hl hn jl js jx ln mil net nm nx org qh sc sd sh sn sx tj tw xj xz yn zj ",co:" com edu gov mil net nom org ",cr:" ac c co ed fi go or sa ",cy:" ac biz com ekloges gov ltd name net org parliament press pro tm ",do:" art com edu gob gov mil net org sld web ",dz:" art asso com edu gov net org pol ",ec:" com edu fin gov info med mil net org pro ",eg:" com edu eun gov mil name net org sci ",er:" com edu gov ind mil net org rochest w ",es:" com edu gob nom org ",et:" biz com edu gov info name net org ",fj:" ac biz com info mil name net org pro ",fk:" ac co gov net nom org ",fr:" asso com f gouv nom prd presse tm ",gg:" co net org ",gh:" com edu gov mil org ",gn:" ac com gov net org ",gr:" com edu gov mil net org ",gt:" com edu gob ind mil net org ",gu:" com edu gov net org ",hk:" com edu gov idv net org ",hu:" 2000 agrar bolt casino city co erotica erotika film forum games hotel info ingatlan jogasz konyvelo lakas media news org priv reklam sex shop sport suli szex tm tozsde utazas video ",id:" ac co go mil net or sch web ",il:" ac co gov idf k12 muni net org ",in:" ac co edu ernet firm gen gov i ind mil net nic org res ",iq:" com edu gov i mil net org ",ir:" ac co dnssec gov i id net org sch ",it:" edu gov ",je:" co net org ",jo:" com edu gov mil name net org sch ",jp:" ac ad co ed go gr lg ne or ",ke:" ac co go info me mobi ne or sc ",kh:" com edu gov mil net org per ",ki:" biz com de edu gov info mob net org tel ",km:" asso com coop edu gouv k medecin mil nom notaires pharmaciens presse tm veterinaire ",kn:" edu gov net org ",kr:" ac busan chungbuk chungnam co daegu daejeon es gangwon go gwangju gyeongbuk gyeonggi gyeongnam hs incheon jeju jeonbuk jeonnam k kg mil ms ne or pe re sc seoul ulsan ",kw:" com edu gov net org ",ky:" com edu gov net org ",kz:" com edu gov mil net org ",lb:" com edu gov net org ",lk:" assn com edu gov grp hotel int ltd net ngo org sch soc web ",lr:" com edu gov net org ",lv:" asn com conf edu gov id mil net org ",ly:" com edu gov id med net org plc sch ",ma:" ac co gov m net org press ",mc:" asso tm ",me:" ac co edu gov its net org priv ",mg:" com edu gov mil nom org prd tm ",mk:" com edu gov inf name net org pro ",ml:" com edu gov net org presse ",mn:" edu gov org ",mo:" com edu gov net org ",mt:" com edu gov net org ",mv:" aero biz com coop edu gov info int mil museum name net org pro ",mw:" ac co com coop edu gov int museum net org ",mx:" com edu gob net org ",my:" com edu gov mil name net org sch ",nf:" arts com firm info net other per rec store web ",ng:" biz com edu gov mil mobi name net org sch ",ni:" ac co com edu gob mil net nom org ",np:" com edu gov mil net org ",nr:" biz com edu gov info net org ",om:" ac biz co com edu gov med mil museum net org pro sch ",pe:" com edu gob mil net nom org sld ",ph:" com edu gov i mil net ngo org ",pk:" biz com edu fam gob gok gon gop gos gov net org web ",pl:" art bialystok biz com edu gda gdansk gorzow gov info katowice krakow lodz lublin mil net ngo olsztyn org poznan pwr radom slupsk szczecin torun warszawa waw wroc wroclaw zgora ",pr:" ac biz com edu est gov info isla name net org pro prof ",ps:" com edu gov net org plo sec ",pw:" belau co ed go ne or ",ro:" arts com firm info nom nt org rec store tm www ",rs:" ac co edu gov in org ",sb:" com edu gov net org ",sc:" com edu gov net org ",sh:" co com edu gov net nom org ",sl:" com edu gov net org ",st:" co com consulado edu embaixada gov mil net org principe saotome store ",sv:" com edu gob org red ",sz:" ac co org ",tr:" av bbs bel biz com dr edu gen gov info k12 name net org pol tel tsk tv web ",tt:" aero biz cat co com coop edu gov info int jobs mil mobi museum name net org pro tel travel ",tw:" club com ebiz edu game gov idv mil net org ",mu:" ac co com gov net or org ",mz:" ac co edu gov org ",na:" co com ",nz:" ac co cri geek gen govt health iwi maori mil net org parliament school ",pa:" abo ac com edu gob ing med net nom org sld ",pt:" com edu gov int net nome org publ ",py:" com edu gov mil net org ",qa:" com edu gov mil net org ",re:" asso com nom ",ru:" ac adygeya altai amur arkhangelsk astrakhan bashkiria belgorod bir bryansk buryatia cbg chel chelyabinsk chita chukotka chuvashia com dagestan e-burg edu gov grozny int irkutsk ivanovo izhevsk jar joshkar-ola kalmykia kaluga kamchatka karelia kazan kchr kemerovo khabarovsk khakassia khv kirov koenig komi kostroma kranoyarsk kuban kurgan kursk lipetsk magadan mari mari-el marine mil mordovia mosreg msk murmansk nalchik net nnov nov novosibirsk nsk omsk orenburg org oryol penza perm pp pskov ptz rnd ryazan sakhalin samara saratov simbirsk smolensk spb stavropol stv surgut tambov tatarstan tom tomsk tsaritsyn tsk tula tuva tver tyumen udm udmurtia ulan-ude vladikavkaz vladimir vladivostok volgograd vologda voronezh vrn vyatka yakutia yamal yekaterinburg yuzhno-sakhalinsk ",rw:" ac co com edu gouv gov int mil net ",sa:" com edu gov med net org pub sch ",sd:" com edu gov info med net org tv ",se:" a ac b bd c d e f g h i k l m n o org p parti pp press r s t tm u w x y z ",sg:" com edu gov idn net org per ",sn:" art com edu gouv org perso univ ",sy:" com edu gov mil net news org ",th:" ac co go in mi net or ",tj:" ac biz co com edu go gov info int mil name net nic org test web ",tn:" agrinet com defense edunet ens fin gov ind info intl mincom nat net org perso rnrt rns rnu tourism ",tz:" ac co go ne or ",ua:" biz cherkassy chernigov chernovtsy ck cn co com crimea cv dn dnepropetrovsk donetsk dp edu gov if in ivano-frankivsk kh kharkov kherson khmelnitskiy kiev kirovograd km kr ks kv lg lugansk lutsk lviv me mk net nikolaev od odessa org pl poltava pp rovno rv sebastopol sumy te ternopil uzhgorod vinnica vn zaporizhzhe zhitomir zp zt ",ug:" ac co go ne or org sc ",uk:" ac bl british-library co cym gov govt icnet jet lea ltd me mil mod national-library-scotland nel net nhs nic nls org orgn parliament plc police sch scot soc ",us:" dni fed isa kids nsn ",uy:" com edu gub mil net org ",ve:" co com edu gob info mil net org web ",vi:" co com k12 net org ",vn:" ac biz com edu gov health info int name net org pro ",ye:" co com gov ltd me net org plc ",yu:" ac co edu gov org ",za:" ac agric alt bourse city co cybernet db edu gov grondar iaccess imt inca landesign law mil net ngo nis nom olivetti org pix school tm web ",zm:" ac co com edu gov net org sch ",com:"ar br cn de eu gb gr hu jpn kr no qc ru sa se uk us uy za ",net:"gb jp se uk ",org:"ae",de:"com "},has:function(i){var o=i.lastIndexOf(".");if(o<=0||o>=i.length-1)return!1;var r=i.lastIndexOf(".",o-1);if(r<=0||r>=o-1)return!1;var s=n.list[i.slice(o+1)];return s?s.indexOf(" "+i.slice(r+1,o)+" ")>=0:!1},is:function(i){var o=i.lastIndexOf(".");if(o<=0||o>=i.length-1)return!1;var r=i.lastIndexOf(".",o-1);if(r>=0)return!1;var s=n.list[i.slice(o+1)];return s?s.indexOf(" "+i.slice(0,o)+" ")>=0:!1},get:function(i){var o=i.lastIndexOf(".");if(o<=0||o>=i.length-1)return null;var r=i.lastIndexOf(".",o-1);if(r<=0||r>=o-1)return null;var s=n.list[i.slice(o+1)];return!s||s.indexOf(" "+i.slice(r+1,o)+" ")<0?null:i.slice(r+1)},noConflict:function(){return e.SecondLevelDomains===this&&(e.SecondLevelDomains=t),this}};return n})});var Gl=Fn((eQ,mP)=>{/*!
 * URI.js - Mutating URLs
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */(function(e,t){"use strict";typeof mP=="object"&&mP.exports?mP.exports=t(K$(),$$(),J$()):typeof define=="function"&&define.amd?define(["./punycode","./IPv6","./SecondLevelDomains"],t):e.URI=t(e.punycode,e.IPv6,e.SecondLevelDomains,e)})(eQ,function(e,t,n,i){"use strict";var o=i&&i.URI;function r(S,w){var I=arguments.length>=1,N=arguments.length>=2;if(!(this instanceof r))return I?N?new r(S,w):new r(S):new r;if(S===void 0){if(I)throw new TypeError("undefined is not a valid argument for URI");typeof location<"u"?S=location.href+"":S=""}if(S===null&&I)throw new TypeError("null is not a valid argument for URI");return this.href(S),w!==void 0?this.absoluteTo(w):this}function s(S){return/^[0-9]+$/.test(S)}r.version="1.19.11";var a=r.prototype,c=Object.prototype.hasOwnProperty;function l(S){return S.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function f(S){return S===void 0?"Undefined":String(Object.prototype.toString.call(S)).slice(8,-1)}function d(S){return f(S)==="Array"}function p(S,w){var I={},N,k;if(f(w)==="RegExp")I=null;else if(d(w))for(N=0,k=w.length;N<k;N++)I[w[N]]=!0;else I[w]=!0;for(N=0,k=S.length;N<k;N++){var z=I&&I[S[N]]!==void 0||!I&&w.test(S[N]);z&&(S.splice(N,1),k--,N--)}return S}function g(S,w){var I,N;if(d(w)){for(I=0,N=w.length;I<N;I++)if(!g(S,w[I]))return!1;return!0}var k=f(w);for(I=0,N=S.length;I<N;I++)if(k==="RegExp"){if(typeof S[I]=="string"&&S[I].match(w))return!0}else if(S[I]===w)return!0;return!1}function m(S,w){if(!d(S)||!d(w)||S.length!==w.length)return!1;S.sort(),w.sort();for(var I=0,N=S.length;I<N;I++)if(S[I]!==w[I])return!1;return!0}function y(S){var w=/^\/+|\/+$/g;return S.replace(w,"")}r._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,preventInvalidHostname:r.preventInvalidHostname,duplicateQueryParameters:r.duplicateQueryParameters,escapeQuerySpace:r.escapeQuerySpace}},r.preventInvalidHostname=!1,r.duplicateQueryParameters=!1,r.escapeQuerySpace=!0,r.protocol_expression=/^[a-z][a-z0-9.+-]*$/i,r.idn_expression=/[^a-z0-9\._-]/i,r.punycode_expression=/(xn--)/i,r.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,r.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,r.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/ig,r.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?«»“”„‘’]+$/,parens:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g},r.leading_whitespace_expression=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,r.ascii_tab_whitespace=/[\u0009\u000A\u000D]+/g,r.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},r.hostProtocols=["http","https"],r.invalid_hostname_characters=/[^a-zA-Z0-9\.\-:_]/,r.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"},r.getDomAttribute=function(S){if(!(!S||!S.nodeName)){var w=S.nodeName.toLowerCase();if(!(w==="input"&&S.type!=="image"))return r.domAttributes[w]}};function b(S){return escape(S)}function C(S){return encodeURIComponent(S).replace(/[!'()*]/g,b).replace(/\*/g,"%2A")}r.encode=C,r.decode=decodeURIComponent,r.iso8859=function(){r.encode=escape,r.decode=unescape},r.unicode=function(){r.encode=C,r.decode=decodeURIComponent},r.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/ig,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/ig,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/ig,map:{"%21":"!","%24":"$","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{expression:/[\/\?#:]/g,map:{"/":"%2F","?":"%3F","#":"%23",":":"%3A"}}}},r.encodeQuery=function(S,w){var I=r.encode(S+"");return w===void 0&&(w=r.escapeQuerySpace),w?I.replace(/%20/g,"+"):I},r.decodeQuery=function(S,w){S+="",w===void 0&&(w=r.escapeQuerySpace);try{return r.decode(w?S.replace(/\+/g,"%20"):S)}catch{return S}};var A={encode:"encode",decode:"decode"},T,E=function(S,w){return function(I){try{return r[w](I+"").replace(r.characters[S][w].expression,function(N){return r.characters[S][w].map[N]})}catch{return I}}};for(T in A)r[T+"PathSegment"]=E("pathname",A[T]),r[T+"UrnPathSegment"]=E("urnpath",A[T]);var v=function(S,w,I){return function(N){var k;I?k=function(B){return r[w](r[I](B))}:k=r[w];for(var z=(N+"").split(S),V=0,U=z.length;V<U;V++)z[V]=k(z[V]);return z.join(S)}};r.decodePath=v("/","decodePathSegment"),r.decodeUrnPath=v(":","decodeUrnPathSegment"),r.recodePath=v("/","encodePathSegment","decode"),r.recodeUrnPath=v(":","encodeUrnPathSegment","decode"),r.encodeReserved=E("reserved","encode"),r.parse=function(S,w){var I;return w||(w={preventInvalidHostname:r.preventInvalidHostname}),S=S.replace(r.leading_whitespace_expression,""),S=S.replace(r.ascii_tab_whitespace,""),I=S.indexOf("#"),I>-1&&(w.fragment=S.substring(I+1)||null,S=S.substring(0,I)),I=S.indexOf("?"),I>-1&&(w.query=S.substring(I+1)||null,S=S.substring(0,I)),S=S.replace(/^(https?|ftp|wss?)?:+[/\\]*/i,"$1://"),S=S.replace(/^[/\\]{2,}/i,"//"),S.substring(0,2)==="//"?(w.protocol=null,S=S.substring(2),S=r.parseAuthority(S,w)):(I=S.indexOf(":"),I>-1&&(w.protocol=S.substring(0,I)||null,w.protocol&&!w.protocol.match(r.protocol_expression)?w.protocol=void 0:S.substring(I+1,I+3).replace(/\\/g,"/")==="//"?(S=S.substring(I+3),S=r.parseAuthority(S,w)):(S=S.substring(I+1),w.urn=!0))),w.path=S,w},r.parseHost=function(S,w){S||(S=""),S=S.replace(/\\/g,"/");var I=S.indexOf("/"),N,k;if(I===-1&&(I=S.length),S.charAt(0)==="[")N=S.indexOf("]"),w.hostname=S.substring(1,N)||null,w.port=S.substring(N+2,I)||null,w.port==="/"&&(w.port=null);else{var z=S.indexOf(":"),V=S.indexOf("/"),U=S.indexOf(":",z+1);U!==-1&&(V===-1||U<V)?(w.hostname=S.substring(0,I)||null,w.port=null):(k=S.substring(0,I).split(":"),w.hostname=k[0]||null,w.port=k[1]||null)}return w.hostname&&S.substring(I).charAt(0)!=="/"&&(I++,S="/"+S),w.preventInvalidHostname&&r.ensureValidHostname(w.hostname,w.protocol),w.port&&r.ensureValidPort(w.port),S.substring(I)||"/"},r.parseAuthority=function(S,w){return S=r.parseUserinfo(S,w),r.parseHost(S,w)},r.parseUserinfo=function(S,w){var I=S,N=S.indexOf("\\");N!==-1&&(S=S.replace(/\\/g,"/"));var k=S.indexOf("/"),z=S.lastIndexOf("@",k>-1?k:S.length-1),V;return z>-1&&(k===-1||z<k)?(V=S.substring(0,z).split(":"),w.username=V[0]?r.decode(V[0]):null,V.shift(),w.password=V[0]?r.decode(V.join(":")):null,S=I.substring(z+1)):(w.username=null,w.password=null),S},r.parseQuery=function(S,w){if(!S)return{};if(S=S.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,""),!S)return{};for(var I={},N=S.split("&"),k=N.length,z,V,U,B=0;B<k;B++)z=N[B].split("="),V=r.decodeQuery(z.shift(),w),U=z.length?r.decodeQuery(z.join("="),w):null,V!=="__proto__"&&(c.call(I,V)?((typeof I[V]=="string"||I[V]===null)&&(I[V]=[I[V]]),I[V].push(U)):I[V]=U);return I},r.build=function(S){var w="",I=!1;return S.protocol&&(w+=S.protocol+":"),!S.urn&&(w||S.hostname)&&(w+="//",I=!0),w+=r.buildAuthority(S)||"",typeof S.path=="string"&&(S.path.charAt(0)!=="/"&&I&&(w+="/"),w+=S.path),typeof S.query=="string"&&S.query&&(w+="?"+S.query),typeof S.fragment=="string"&&S.fragment&&(w+="#"+S.fragment),w},r.buildHost=function(S){var w="";if(S.hostname)r.ip6_expression.test(S.hostname)?w+="["+S.hostname+"]":w+=S.hostname;else return"";return S.port&&(w+=":"+S.port),w},r.buildAuthority=function(S){return r.buildUserinfo(S)+r.buildHost(S)},r.buildUserinfo=function(S){var w="";return S.username&&(w+=r.encode(S.username)),S.password&&(w+=":"+r.encode(S.password)),w&&(w+="@"),w},r.buildQuery=function(S,w,I){var N="",k,z,V,U;for(z in S)if(z!=="__proto__"&&c.call(S,z))if(d(S[z]))for(k={},V=0,U=S[z].length;V<U;V++)S[z][V]!==void 0&&k[S[z][V]+""]===void 0&&(N+="&"+r.buildQueryParameter(z,S[z][V],I),w!==!0&&(k[S[z][V]+""]=!0));else S[z]!==void 0&&(N+="&"+r.buildQueryParameter(z,S[z],I));return N.substring(1)},r.buildQueryParameter=function(S,w,I){return r.encodeQuery(S,I)+(w!==null?"="+r.encodeQuery(w,I):"")},r.addQuery=function(S,w,I){if(typeof w=="object")for(var N in w)c.call(w,N)&&r.addQuery(S,N,w[N]);else if(typeof w=="string"){if(S[w]===void 0){S[w]=I;return}else typeof S[w]=="string"&&(S[w]=[S[w]]);d(I)||(I=[I]),S[w]=(S[w]||[]).concat(I)}else throw new TypeError("URI.addQuery() accepts an object, string as the name parameter")},r.setQuery=function(S,w,I){if(typeof w=="object")for(var N in w)c.call(w,N)&&r.setQuery(S,N,w[N]);else if(typeof w=="string")S[w]=I===void 0?null:I;else throw new TypeError("URI.setQuery() accepts an object, string as the name parameter")},r.removeQuery=function(S,w,I){var N,k,z;if(d(w))for(N=0,k=w.length;N<k;N++)S[w[N]]=void 0;else if(f(w)==="RegExp")for(z in S)w.test(z)&&(S[z]=void 0);else if(typeof w=="object")for(z in w)c.call(w,z)&&r.removeQuery(S,z,w[z]);else if(typeof w=="string")I!==void 0?f(I)==="RegExp"?!d(S[w])&&I.test(S[w])?S[w]=void 0:S[w]=p(S[w],I):S[w]===String(I)&&(!d(I)||I.length===1)?S[w]=void 0:d(S[w])&&(S[w]=p(S[w],I)):S[w]=void 0;else throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter")},r.hasQuery=function(S,w,I,N){switch(f(w)){case"String":break;case"RegExp":for(var k in S)if(c.call(S,k)&&w.test(k)&&(I===void 0||r.hasQuery(S,k,I)))return!0;return!1;case"Object":for(var z in w)if(c.call(w,z)&&!r.hasQuery(S,z,w[z]))return!1;return!0;default:throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter")}switch(f(I)){case"Undefined":return w in S;case"Boolean":var V=!!(d(S[w])?S[w].length:S[w]);return I===V;case"Function":return!!I(S[w],w,S);case"Array":if(!d(S[w]))return!1;var U=N?g:m;return U(S[w],I);case"RegExp":return d(S[w])?N?g(S[w],I):!1:!!(S[w]&&S[w].match(I));case"Number":I=String(I);case"String":return d(S[w])?N?g(S[w],I):!1:S[w]===I;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},r.joinPaths=function(){for(var S=[],w=[],I=0,N=0;N<arguments.length;N++){var k=new r(arguments[N]);S.push(k);for(var z=k.segment(),V=0;V<z.length;V++)typeof z[V]=="string"&&w.push(z[V]),z[V]&&I++}if(!w.length||!I)return new r("");var U=new r("").segment(w);return(S[0].path()===""||S[0].path().slice(0,1)==="/")&&U.path("/"+U.path()),U.normalize()},r.commonPath=function(S,w){var I=Math.min(S.length,w.length),N;for(N=0;N<I;N++)if(S.charAt(N)!==w.charAt(N)){N--;break}return N<1?S.charAt(0)===w.charAt(0)&&S.charAt(0)==="/"?"/":"":((S.charAt(N)!=="/"||w.charAt(N)!=="/")&&(N=S.substring(0,N).lastIndexOf("/")),S.substring(0,N+1))},r.withinString=function(S,w,I){I||(I={});var N=I.start||r.findUri.start,k=I.end||r.findUri.end,z=I.trim||r.findUri.trim,V=I.parens||r.findUri.parens,U=/[a-z0-9-]=["']?$/i;for(N.lastIndex=0;;){var B=N.exec(S);if(!B)break;var W=B.index;if(I.ignoreHtml){var j=S.slice(Math.max(W-3,0),W);if(j&&U.test(j))continue}for(var Q=W+S.slice(W).search(k),q=S.slice(W,Q),X=-1;;){var Z=V.exec(q);if(!Z)break;var fe=Z.index+Z[0].length;X=Math.max(X,fe)}if(X>-1?q=q.slice(0,X)+q.slice(X).replace(z,""):q=q.replace(z,""),!(q.length<=B[0].length)&&!(I.ignore&&I.ignore.test(q))){Q=W+q.length;var xe=w(q,W,Q,S);if(xe===void 0){N.lastIndex=Q;continue}xe=String(xe),S=S.slice(0,W)+xe+S.slice(Q),N.lastIndex=W+xe.length}}return N.lastIndex=0,S},r.ensureValidHostname=function(S,w){var I=!!S,N=!!w,k=!1;if(N&&(k=g(r.hostProtocols,w)),k&&!I)throw new TypeError("Hostname cannot be empty, if protocol is "+w);if(S&&S.match(r.invalid_hostname_characters)){if(!e)throw new TypeError('Hostname "'+S+'" contains characters other than [A-Z0-9.-:_] and Punycode.js is not available');if(e.toASCII(S).match(r.invalid_hostname_characters))throw new TypeError('Hostname "'+S+'" contains characters other than [A-Z0-9.-:_]')}},r.ensureValidPort=function(S){if(S){var w=Number(S);if(!(s(w)&&w>0&&w<65536))throw new TypeError('Port "'+S+'" is not a valid port')}},r.noConflict=function(S){if(S){var w={URI:this.noConflict()};return i.URITemplate&&typeof i.URITemplate.noConflict=="function"&&(w.URITemplate=i.URITemplate.noConflict()),i.IPv6&&typeof i.IPv6.noConflict=="function"&&(w.IPv6=i.IPv6.noConflict()),i.SecondLevelDomains&&typeof i.SecondLevelDomains.noConflict=="function"&&(w.SecondLevelDomains=i.SecondLevelDomains.noConflict()),w}else i.URI===this&&(i.URI=o);return this},a.build=function(S){return S===!0?this._deferred_build=!0:(S===void 0||this._deferred_build)&&(this._string=r.build(this._parts),this._deferred_build=!1),this},a.clone=function(){return new r(this)},a.valueOf=a.toString=function(){return this.build(!1)._string};function D(S){return function(w,I){return w===void 0?this._parts[S]||"":(this._parts[S]=w||null,this.build(!I),this)}}function O(S,w){return function(I,N){return I===void 0?this._parts[S]||"":(I!==null&&(I=I+"",I.charAt(0)===w&&(I=I.substring(1))),this._parts[S]=I,this.build(!N),this)}}a.protocol=D("protocol"),a.username=D("username"),a.password=D("password"),a.hostname=D("hostname"),a.port=D("port"),a.query=O("query","?"),a.fragment=O("fragment","#"),a.search=function(S,w){var I=this.query(S,w);return typeof I=="string"&&I.length?"?"+I:I},a.hash=function(S,w){var I=this.fragment(S,w);return typeof I=="string"&&I.length?"#"+I:I},a.pathname=function(S,w){if(S===void 0||S===!0){var I=this._parts.path||(this._parts.hostname?"/":"");return S?(this._parts.urn?r.decodeUrnPath:r.decodePath)(I):I}else return this._parts.urn?this._parts.path=S?r.recodeUrnPath(S):"":this._parts.path=S?r.recodePath(S):"/",this.build(!w),this},a.path=a.pathname,a.href=function(S,w){var I;if(S===void 0)return this.toString();this._string="",this._parts=r._parts();var N=S instanceof r,k=typeof S=="object"&&(S.hostname||S.path||S.pathname);if(S.nodeName){var z=r.getDomAttribute(S);S=S[z]||"",k=!1}if(!N&&k&&S.pathname!==void 0&&(S=S.toString()),typeof S=="string"||S instanceof String)this._parts=r.parse(String(S),this._parts);else if(N||k){var V=N?S._parts:S;for(I in V)I!=="query"&&c.call(this._parts,I)&&(this._parts[I]=V[I]);V.query&&this.query(V.query,!1)}else throw new TypeError("invalid input");return this.build(!w),this},a.is=function(S){var w=!1,I=!1,N=!1,k=!1,z=!1,V=!1,U=!1,B=!this._parts.urn;switch(this._parts.hostname&&(B=!1,I=r.ip4_expression.test(this._parts.hostname),N=r.ip6_expression.test(this._parts.hostname),w=I||N,k=!w,z=k&&n&&n.has(this._parts.hostname),V=k&&r.idn_expression.test(this._parts.hostname),U=k&&r.punycode_expression.test(this._parts.hostname)),S.toLowerCase()){case"relative":return B;case"absolute":return!B;case"domain":case"name":return k;case"sld":return z;case"ip":return w;case"ip4":case"ipv4":case"inet4":return I;case"ip6":case"ipv6":case"inet6":return N;case"idn":return V;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return U}return null};var P=a.protocol,M=a.port,L=a.hostname;a.protocol=function(S,w){if(S&&(S=S.replace(/:(\/\/)?$/,""),!S.match(r.protocol_expression)))throw new TypeError('Protocol "'+S+`" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]`);return P.call(this,S,w)},a.scheme=a.protocol,a.port=function(S,w){return this._parts.urn?S===void 0?"":this:(S!==void 0&&(S===0&&(S=null),S&&(S+="",S.charAt(0)===":"&&(S=S.substring(1)),r.ensureValidPort(S))),M.call(this,S,w))},a.hostname=function(S,w){if(this._parts.urn)return S===void 0?"":this;if(S!==void 0){var I={preventInvalidHostname:this._parts.preventInvalidHostname},N=r.parseHost(S,I);if(N!=="/")throw new TypeError('Hostname "'+S+'" contains characters other than [A-Z0-9.-]');S=I.hostname,this._parts.preventInvalidHostname&&r.ensureValidHostname(S,this._parts.protocol)}return L.call(this,S,w)},a.origin=function(S,w){if(this._parts.urn)return S===void 0?"":this;if(S===void 0){var I=this.protocol(),N=this.authority();return N?(I?I+"://":"")+this.authority():""}else{var k=r(S);return this.protocol(k.protocol()).authority(k.authority()).build(!w),this}},a.host=function(S,w){if(this._parts.urn)return S===void 0?"":this;if(S===void 0)return this._parts.hostname?r.buildHost(this._parts):"";var I=r.parseHost(S,this._parts);if(I!=="/")throw new TypeError('Hostname "'+S+'" contains characters other than [A-Z0-9.-]');return this.build(!w),this},a.authority=function(S,w){if(this._parts.urn)return S===void 0?"":this;if(S===void 0)return this._parts.hostname?r.buildAuthority(this._parts):"";var I=r.parseAuthority(S,this._parts);if(I!=="/")throw new TypeError('Hostname "'+S+'" contains characters other than [A-Z0-9.-]');return this.build(!w),this},a.userinfo=function(S,w){if(this._parts.urn)return S===void 0?"":this;if(S===void 0){var I=r.buildUserinfo(this._parts);return I&&I.substring(0,I.length-1)}else return S[S.length-1]!=="@"&&(S+="@"),r.parseUserinfo(S,this._parts),this.build(!w),this},a.resource=function(S,w){var I;return S===void 0?this.path()+this.search()+this.hash():(I=r.parse(S),this._parts.path=I.path,this._parts.query=I.query,this._parts.fragment=I.fragment,this.build(!w),this)},a.subdomain=function(S,w){if(this._parts.urn)return S===void 0?"":this;if(S===void 0){if(!this._parts.hostname||this.is("IP"))return"";var I=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,I)||""}else{var N=this._parts.hostname.length-this.domain().length,k=this._parts.hostname.substring(0,N),z=new RegExp("^"+l(k));if(S&&S.charAt(S.length-1)!=="."&&(S+="."),S.indexOf(":")!==-1)throw new TypeError("Domains cannot contain colons");return S&&r.ensureValidHostname(S,this._parts.protocol),this._parts.hostname=this._parts.hostname.replace(z,S),this.build(!w),this}},a.domain=function(S,w){if(this._parts.urn)return S===void 0?"":this;if(typeof S=="boolean"&&(w=S,S=void 0),S===void 0){if(!this._parts.hostname||this.is("IP"))return"";var I=this._parts.hostname.match(/\./g);if(I&&I.length<2)return this._parts.hostname;var N=this._parts.hostname.length-this.tld(w).length-1;return N=this._parts.hostname.lastIndexOf(".",N-1)+1,this._parts.hostname.substring(N)||""}else{if(!S)throw new TypeError("cannot set domain empty");if(S.indexOf(":")!==-1)throw new TypeError("Domains cannot contain colons");if(r.ensureValidHostname(S,this._parts.protocol),!this._parts.hostname||this.is("IP"))this._parts.hostname=S;else{var k=new RegExp(l(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(k,S)}return this.build(!w),this}},a.tld=function(S,w){if(this._parts.urn)return S===void 0?"":this;if(typeof S=="boolean"&&(w=S,S=void 0),S===void 0){if(!this._parts.hostname||this.is("IP"))return"";var I=this._parts.hostname.lastIndexOf("."),N=this._parts.hostname.substring(I+1);return w!==!0&&n&&n.list[N.toLowerCase()]&&n.get(this._parts.hostname)||N}else{var k;if(S)if(S.match(/[^a-zA-Z0-9-]/))if(n&&n.is(S))k=new RegExp(l(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(k,S);else throw new TypeError('TLD "'+S+'" contains characters other than [A-Z0-9]');else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");k=new RegExp(l(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(k,S)}else throw new TypeError("cannot set TLD empty");return this.build(!w),this}},a.directory=function(S,w){if(this._parts.urn)return S===void 0?"":this;if(S===void 0||S===!0){if(!this._parts.path&&!this._parts.hostname)return"";if(this._parts.path==="/")return"/";var I=this._parts.path.length-this.filename().length-1,N=this._parts.path.substring(0,I)||(this._parts.hostname?"/":"");return S?r.decodePath(N):N}else{var k=this._parts.path.length-this.filename().length,z=this._parts.path.substring(0,k),V=new RegExp("^"+l(z));return this.is("relative")||(S||(S="/"),S.charAt(0)!=="/"&&(S="/"+S)),S&&S.charAt(S.length-1)!=="/"&&(S+="/"),S=r.recodePath(S),this._parts.path=this._parts.path.replace(V,S),this.build(!w),this}},a.filename=function(S,w){if(this._parts.urn)return S===void 0?"":this;if(typeof S!="string"){if(!this._parts.path||this._parts.path==="/")return"";var I=this._parts.path.lastIndexOf("/"),N=this._parts.path.substring(I+1);return S?r.decodePathSegment(N):N}else{var k=!1;S.charAt(0)==="/"&&(S=S.substring(1)),S.match(/\.?\//)&&(k=!0);var z=new RegExp(l(this.filename())+"$");return S=r.recodePath(S),this._parts.path=this._parts.path.replace(z,S),k?this.normalizePath(w):this.build(!w),this}},a.suffix=function(S,w){if(this._parts.urn)return S===void 0?"":this;if(S===void 0||S===!0){if(!this._parts.path||this._parts.path==="/")return"";var I=this.filename(),N=I.lastIndexOf("."),k,z;return N===-1?"":(k=I.substring(N+1),z=/^[a-z0-9%]+$/i.test(k)?k:"",S?r.decodePathSegment(z):z)}else{S.charAt(0)==="."&&(S=S.substring(1));var V=this.suffix(),U;if(V)S?U=new RegExp(l(V)+"$"):U=new RegExp(l("."+V)+"$");else{if(!S)return this;this._parts.path+="."+r.recodePath(S)}return U&&(S=r.recodePath(S),this._parts.path=this._parts.path.replace(U,S)),this.build(!w),this}},a.segment=function(S,w,I){var N=this._parts.urn?":":"/",k=this.path(),z=k.substring(0,1)==="/",V=k.split(N);if(S!==void 0&&typeof S!="number"&&(I=w,w=S,S=void 0),S!==void 0&&typeof S!="number")throw new Error('Bad segment "'+S+'", must be 0-based integer');if(z&&V.shift(),S<0&&(S=Math.max(V.length+S,0)),w===void 0)return S===void 0?V:V[S];if(S===null||V[S]===void 0)if(d(w)){V=[];for(var U=0,B=w.length;U<B;U++)!w[U].length&&(!V.length||!V[V.length-1].length)||(V.length&&!V[V.length-1].length&&V.pop(),V.push(y(w[U])))}else(w||typeof w=="string")&&(w=y(w),V[V.length-1]===""?V[V.length-1]=w:V.push(w));else w?V[S]=y(w):V.splice(S,1);return z&&V.unshift(""),this.path(V.join(N),I)},a.segmentCoded=function(S,w,I){var N,k,z;if(typeof S!="number"&&(I=w,w=S,S=void 0),w===void 0){if(N=this.segment(S,w,I),!d(N))N=N!==void 0?r.decode(N):void 0;else for(k=0,z=N.length;k<z;k++)N[k]=r.decode(N[k]);return N}if(!d(w))w=typeof w=="string"||w instanceof String?r.encode(w):w;else for(k=0,z=w.length;k<z;k++)w[k]=r.encode(w[k]);return this.segment(S,w,I)};var _=a.query;return a.query=function(S,w){if(S===!0)return r.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if(typeof S=="function"){var I=r.parseQuery(this._parts.query,this._parts.escapeQuerySpace),N=S.call(this,I);return this._parts.query=r.buildQuery(N||I,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!w),this}else return S!==void 0&&typeof S!="string"?(this._parts.query=r.buildQuery(S,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!w),this):_.call(this,S,w)},a.setQuery=function(S,w,I){var N=r.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if(typeof S=="string"||S instanceof String)N[S]=w!==void 0?w:null;else if(typeof S=="object")for(var k in S)c.call(S,k)&&(N[k]=S[k]);else throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");return this._parts.query=r.buildQuery(N,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),typeof S!="string"&&(I=w),this.build(!I),this},a.addQuery=function(S,w,I){var N=r.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return r.addQuery(N,S,w===void 0?null:w),this._parts.query=r.buildQuery(N,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),typeof S!="string"&&(I=w),this.build(!I),this},a.removeQuery=function(S,w,I){var N=r.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return r.removeQuery(N,S,w),this._parts.query=r.buildQuery(N,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),typeof S!="string"&&(I=w),this.build(!I),this},a.hasQuery=function(S,w,I){var N=r.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return r.hasQuery(N,S,w,I)},a.setSearch=a.setQuery,a.addSearch=a.addQuery,a.removeSearch=a.removeQuery,a.hasSearch=a.hasQuery,a.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},a.normalizeProtocol=function(S){return typeof this._parts.protocol=="string"&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!S)),this},a.normalizeHostname=function(S){return this._parts.hostname&&(this.is("IDN")&&e?this._parts.hostname=e.toASCII(this._parts.hostname):this.is("IPv6")&&t&&(this._parts.hostname=t.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!S)),this},a.normalizePort=function(S){return typeof this._parts.protocol=="string"&&this._parts.port===r.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!S)),this},a.normalizePath=function(S){var w=this._parts.path;if(!w)return this;if(this._parts.urn)return this._parts.path=r.recodeUrnPath(this._parts.path),this.build(!S),this;if(this._parts.path==="/")return this;w=r.recodePath(w);var I,N="",k,z;for(w.charAt(0)!=="/"&&(I=!0,w="/"+w),(w.slice(-3)==="/.."||w.slice(-2)==="/.")&&(w+="/"),w=w.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),I&&(N=w.substring(1).match(/^(\.\.\/)+/)||"",N&&(N=N[0]));k=w.search(/\/\.\.(\/|$)/),k!==-1;){if(k===0){w=w.substring(3);continue}z=w.substring(0,k).lastIndexOf("/"),z===-1&&(z=k),w=w.substring(0,z)+w.substring(k+3)}return I&&this.is("relative")&&(w=N+w.substring(1)),this._parts.path=w,this.build(!S),this},a.normalizePathname=a.normalizePath,a.normalizeQuery=function(S){return typeof this._parts.query=="string"&&(this._parts.query.length?this.query(r.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!S)),this},a.normalizeFragment=function(S){return this._parts.fragment||(this._parts.fragment=null,this.build(!S)),this},a.normalizeSearch=a.normalizeQuery,a.normalizeHash=a.normalizeFragment,a.iso8859=function(){var S=r.encode,w=r.decode;r.encode=escape,r.decode=decodeURIComponent;try{this.normalize()}finally{r.encode=S,r.decode=w}return this},a.unicode=function(){var S=r.encode,w=r.decode;r.encode=C,r.decode=unescape;try{this.normalize()}finally{r.encode=S,r.decode=w}return this},a.readable=function(){var S=this.clone();S.username("").password("").normalize();var w="";if(S._parts.protocol&&(w+=S._parts.protocol+"://"),S._parts.hostname&&(S.is("punycode")&&e?(w+=e.toUnicode(S._parts.hostname),S._parts.port&&(w+=":"+S._parts.port)):w+=S.host()),S._parts.hostname&&S._parts.path&&S._parts.path.charAt(0)!=="/"&&(w+="/"),w+=S.path(!0),S._parts.query){for(var I="",N=0,k=S._parts.query.split("&"),z=k.length;N<z;N++){var V=(k[N]||"").split("=");I+="&"+r.decodeQuery(V[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"),V[1]!==void 0&&(I+="="+r.decodeQuery(V[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}w+="?"+I.substring(1)}return w+=r.decodeQuery(S.hash(),!0),w},a.absoluteTo=function(S){var w=this.clone(),I=["protocol","username","password","hostname","port"],N,k,z;if(this._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(S instanceof r||(S=new r(S)),w._parts.protocol||(w._parts.protocol=S._parts.protocol,this._parts.hostname))return w;for(k=0;z=I[k];k++)w._parts[z]=S._parts[z];return w._parts.path?(w._parts.path.substring(-2)===".."&&(w._parts.path+="/"),w.path().charAt(0)!=="/"&&(N=S.directory(),N=N||(S.path().indexOf("/")===0?"/":""),w._parts.path=(N?N+"/":"")+w._parts.path,w.normalizePath())):(w._parts.path=S._parts.path,w._parts.query||(w._parts.query=S._parts.query)),w.build(),w},a.relativeTo=function(S){var w=this.clone().normalize(),I,N,k,z,V;if(w._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(S=new r(S).normalize(),I=w._parts,N=S._parts,z=w.path(),V=S.path(),z.charAt(0)!=="/")throw new Error("URI is already relative");if(V.charAt(0)!=="/")throw new Error("Cannot calculate a URI relative to another relative URI");if(I.protocol===N.protocol&&(I.protocol=null),I.username!==N.username||I.password!==N.password||I.protocol!==null||I.username!==null||I.password!==null)return w.build();if(I.hostname===N.hostname&&I.port===N.port)I.hostname=null,I.port=null;else return w.build();if(z===V)return I.path="",w.build();if(k=r.commonPath(z,V),!k)return w.build();var U=N.path.substring(k.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return I.path=U+I.path.substring(k.length)||"./",w.build()},a.equals=function(S){var w=this.clone(),I=new r(S),N={},k={},z={},V,U,B;if(w.normalize(),I.normalize(),w.toString()===I.toString())return!0;if(V=w.query(),U=I.query(),w.query(""),I.query(""),w.toString()!==I.toString()||V.length!==U.length)return!1;N=r.parseQuery(V,this._parts.escapeQuerySpace),k=r.parseQuery(U,this._parts.escapeQuerySpace);for(B in N)if(c.call(N,B)){if(d(N[B])){if(!m(N[B],k[B]))return!1}else if(N[B]!==k[B])return!1;z[B]=!0}for(B in k)if(c.call(k,B)&&!z[B])return!1;return!0},a.preventInvalidHostname=function(S){return this._parts.preventInvalidHostname=!!S,this},a.duplicateQueryParameters=function(S){return this._parts.duplicateQueryParameters=!!S,this},a.escapeQuerySpace=function(S){return this._parts.escapeQuerySpace=!!S,this},r})});var ice=Fn((cwn,nce)=>{"use strict";nce.exports=cje;var Mw=1e20;function cje(e,t){t||(t={});var n=t.cutoff==null?.25:t.cutoff,i=t.radius==null?8:t.radius,o=t.channel||0,r,s,a,c,l,f,d,p,g,m,y;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!t.width||!t.height)throw Error("For raw data width and height should be provided by options");r=t.width,s=t.height,c=e,t.stride?f=t.stride:f=Math.floor(e.length/r/s)}else window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement?(p=e,d=p.getContext("2d"),r=p.width,s=p.height,g=d.getImageData(0,0,r,s),c=g.data,f=4):window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D?(p=e.canvas,d=e,r=p.width,s=p.height,g=d.getImageData(0,0,r,s),c=g.data,f=4):window.ImageData&&e instanceof window.ImageData&&(g=e,r=e.width,s=e.height,c=g.data,f=4);if(a=Math.max(r,s),window.Uint8ClampedArray&&c instanceof window.Uint8ClampedArray||window.Uint8Array&&c instanceof window.Uint8Array)for(l=c,c=Array(r*s),m=0,y=Math.floor(l.length/f);m<y;m++)c[m]=l[m*f+o]/255;else if(f!==1)throw Error("Raw data can have only 1 value per pixel");var b=Array(r*s),C=Array(r*s),A=Array(a),T=Array(a),E=Array(a+1),v=Array(a);for(m=0,y=r*s;m<y;m++){var D=c[m];b[m]=D===1?0:D===0?Mw:Math.pow(Math.max(0,.5-D),2),C[m]=D===1?Mw:D===0?0:Math.pow(Math.max(0,D-.5),2)}ece(b,r,s,A,T,v,E),ece(C,r,s,A,T,v,E);var O=window.Float32Array?new Float32Array(r*s):new Array(r*s);for(m=0,y=r*s;m<y;m++)O[m]=Math.min(Math.max(1-((b[m]-C[m])/i+n),0),1);return O}function ece(e,t,n,i,o,r,s){for(var a=0;a<t;a++){for(var c=0;c<n;c++)i[c]=e[c*t+a];for(tce(i,o,r,s,n),c=0;c<n;c++)e[c*t+a]=o[c]}for(c=0;c<n;c++){for(a=0;a<t;a++)i[a]=e[c*t+a];for(tce(i,o,r,s,t),a=0;a<t;a++)e[c*t+a]=Math.sqrt(o[a])}}function tce(e,t,n,i,o){n[0]=0,i[0]=-Mw,i[1]=+Mw;for(var r=1,s=0;r<o;r++){for(var a=(e[r]+r*r-(e[n[s]]+n[s]*n[s]))/(2*r-2*n[s]);a<=i[s];)s--,a=(e[r]+r*r-(e[n[s]]+n[s]*n[s]))/(2*r-2*n[s]);s++,n[s]=r,i[s]=a,i[s+1]=+Mw}for(r=0,s=0;r<o;r++){for(;i[s+1]<r;)s++;t[r]=(r-n[s])*(r-n[s])+e[n[s]]}}});var cce=Fn((Swn,pB)=>{function xje(){var e=0,t=1,n=2,i=3,o=4,r=5,s=6,a=7,c=8,l=9,f=10,d=11,p=12,g=13,m=14,y=15,b=16,C=17,A=0,T=1,E=2,v=3,D=4;function O(_,S){return 55296<=_.charCodeAt(S)&&_.charCodeAt(S)<=56319&&56320<=_.charCodeAt(S+1)&&_.charCodeAt(S+1)<=57343}function P(_,S){S===void 0&&(S=0);var w=_.charCodeAt(S);if(55296<=w&&w<=56319&&S<_.length-1){var I=w,N=_.charCodeAt(S+1);return 56320<=N&&N<=57343?(I-55296)*1024+(N-56320)+65536:I}if(56320<=w&&w<=57343&&S>=1){var I=_.charCodeAt(S-1),N=w;return 55296<=I&&I<=56319?(I-55296)*1024+(N-56320)+65536:N}return w}function M(_,S,w){var I=[_].concat(S).concat([w]),N=I[I.length-2],k=w,z=I.lastIndexOf(m);if(z>1&&I.slice(1,z).every(function(B){return B==i})&&[i,g,C].indexOf(_)==-1)return E;var V=I.lastIndexOf(o);if(V>0&&I.slice(1,V).every(function(B){return B==o})&&[p,o].indexOf(N)==-1)return I.filter(function(B){return B==o}).length%2==1?v:D;if(N==e&&k==t)return A;if(N==n||N==e||N==t)return k==m&&S.every(function(B){return B==i})?E:T;if(k==n||k==e||k==t)return T;if(N==s&&(k==s||k==a||k==l||k==f))return A;if((N==l||N==a)&&(k==a||k==c))return A;if((N==f||N==c)&&k==c)return A;if(k==i||k==y)return A;if(k==r)return A;if(N==p)return A;var U=I.indexOf(i)!=-1?I.lastIndexOf(i)-1:I.length-2;return[g,C].indexOf(I[U])!=-1&&I.slice(U+1,-1).every(function(B){return B==i})&&k==m||N==y&&[b,C].indexOf(k)!=-1?A:S.indexOf(o)!=-1?E:N==o&&k==o?A:T}this.nextBreak=function(_,S){if(S===void 0&&(S=0),S<0)return 0;if(S>=_.length-1)return _.length;for(var w=L(P(_,S)),I=[],N=S+1;N<_.length;N++)if(!O(_,N-1)){var k=L(P(_,N));if(M(w,I,k))return N;I.push(k)}return _.length},this.splitGraphemes=function(_){for(var S=[],w=0,I;(I=this.nextBreak(_,w))<_.length;)S.push(_.slice(w,I)),w=I;return w<_.length&&S.push(_.slice(w)),S},this.iterateGraphemes=function(_){var S=0,w={next:function(){var I,N;return(N=this.nextBreak(_,S))<_.length?(I=_.slice(S,N),S=N,{value:I,done:!1}):S<_.length?(I=_.slice(S),S=_.length,{value:I,done:!1}):{value:void 0,done:!0}}.bind(this)};return typeof Symbol<"u"&&Symbol.iterator&&(w[Symbol.iterator]=function(){return w}),w},this.countGraphemes=function(_){for(var S=0,w=0,I;(I=this.nextBreak(_,w))<_.length;)w=I,S++;return w<_.length&&S++,S};function L(_){return 1536<=_&&_<=1541||_==1757||_==1807||_==2274||_==3406||_==69821||70082<=_&&_<=70083||_==72250||72326<=_&&_<=72329||_==73030?p:_==13?e:_==10?t:0<=_&&_<=9||11<=_&&_<=12||14<=_&&_<=31||127<=_&&_<=159||_==173||_==1564||_==6158||_==8203||8206<=_&&_<=8207||_==8232||_==8233||8234<=_&&_<=8238||8288<=_&&_<=8292||_==8293||8294<=_&&_<=8303||55296<=_&&_<=57343||_==65279||65520<=_&&_<=65528||65529<=_&&_<=65531||113824<=_&&_<=113827||119155<=_&&_<=119162||_==917504||_==917505||917506<=_&&_<=917535||917632<=_&&_<=917759||918e3<=_&&_<=921599?n:768<=_&&_<=879||1155<=_&&_<=1159||1160<=_&&_<=1161||1425<=_&&_<=1469||_==1471||1473<=_&&_<=1474||1476<=_&&_<=1477||_==1479||1552<=_&&_<=1562||1611<=_&&_<=1631||_==1648||1750<=_&&_<=1756||1759<=_&&_<=1764||1767<=_&&_<=1768||1770<=_&&_<=1773||_==1809||1840<=_&&_<=1866||1958<=_&&_<=1968||2027<=_&&_<=2035||2070<=_&&_<=2073||2075<=_&&_<=2083||2085<=_&&_<=2087||2089<=_&&_<=2093||2137<=_&&_<=2139||2260<=_&&_<=2273||2275<=_&&_<=2306||_==2362||_==2364||2369<=_&&_<=2376||_==2381||2385<=_&&_<=2391||2402<=_&&_<=2403||_==2433||_==2492||_==2494||2497<=_&&_<=2500||_==2509||_==2519||2530<=_&&_<=2531||2561<=_&&_<=2562||_==2620||2625<=_&&_<=2626||2631<=_&&_<=2632||2635<=_&&_<=2637||_==2641||2672<=_&&_<=2673||_==2677||2689<=_&&_<=2690||_==2748||2753<=_&&_<=2757||2759<=_&&_<=2760||_==2765||2786<=_&&_<=2787||2810<=_&&_<=2815||_==2817||_==2876||_==2878||_==2879||2881<=_&&_<=2884||_==2893||_==2902||_==2903||2914<=_&&_<=2915||_==2946||_==3006||_==3008||_==3021||_==3031||_==3072||3134<=_&&_<=3136||3142<=_&&_<=3144||3146<=_&&_<=3149||3157<=_&&_<=3158||3170<=_&&_<=3171||_==3201||_==3260||_==3263||_==3266||_==3270||3276<=_&&_<=3277||3285<=_&&_<=3286||3298<=_&&_<=3299||3328<=_&&_<=3329||3387<=_&&_<=3388||_==3390||3393<=_&&_<=3396||_==3405||_==3415||3426<=_&&_<=3427||_==3530||_==3535||3538<=_&&_<=3540||_==3542||_==3551||_==3633||3636<=_&&_<=3642||3655<=_&&_<=3662||_==3761||3764<=_&&_<=3769||3771<=_&&_<=3772||3784<=_&&_<=3789||3864<=_&&_<=3865||_==3893||_==3895||_==3897||3953<=_&&_<=3966||3968<=_&&_<=3972||3974<=_&&_<=3975||3981<=_&&_<=3991||3993<=_&&_<=4028||_==4038||4141<=_&&_<=4144||4146<=_&&_<=4151||4153<=_&&_<=4154||4157<=_&&_<=4158||4184<=_&&_<=4185||4190<=_&&_<=4192||4209<=_&&_<=4212||_==4226||4229<=_&&_<=4230||_==4237||_==4253||4957<=_&&_<=4959||5906<=_&&_<=5908||5938<=_&&_<=5940||5970<=_&&_<=5971||6002<=_&&_<=6003||6068<=_&&_<=6069||6071<=_&&_<=6077||_==6086||6089<=_&&_<=6099||_==6109||6155<=_&&_<=6157||6277<=_&&_<=6278||_==6313||6432<=_&&_<=6434||6439<=_&&_<=6440||_==6450||6457<=_&&_<=6459||6679<=_&&_<=6680||_==6683||_==6742||6744<=_&&_<=6750||_==6752||_==6754||6757<=_&&_<=6764||6771<=_&&_<=6780||_==6783||6832<=_&&_<=6845||_==6846||6912<=_&&_<=6915||_==6964||6966<=_&&_<=6970||_==6972||_==6978||7019<=_&&_<=7027||7040<=_&&_<=7041||7074<=_&&_<=7077||7080<=_&&_<=7081||7083<=_&&_<=7085||_==7142||7144<=_&&_<=7145||_==7149||7151<=_&&_<=7153||7212<=_&&_<=7219||7222<=_&&_<=7223||7376<=_&&_<=7378||7380<=_&&_<=7392||7394<=_&&_<=7400||_==7405||_==7412||7416<=_&&_<=7417||7616<=_&&_<=7673||7675<=_&&_<=7679||_==8204||8400<=_&&_<=8412||8413<=_&&_<=8416||_==8417||8418<=_&&_<=8420||8421<=_&&_<=8432||11503<=_&&_<=11505||_==11647||11744<=_&&_<=11775||12330<=_&&_<=12333||12334<=_&&_<=12335||12441<=_&&_<=12442||_==42607||42608<=_&&_<=42610||42612<=_&&_<=42621||42654<=_&&_<=42655||42736<=_&&_<=42737||_==43010||_==43014||_==43019||43045<=_&&_<=43046||43204<=_&&_<=43205||43232<=_&&_<=43249||43302<=_&&_<=43309||43335<=_&&_<=43345||43392<=_&&_<=43394||_==43443||43446<=_&&_<=43449||_==43452||_==43493||43561<=_&&_<=43566||43569<=_&&_<=43570||43573<=_&&_<=43574||_==43587||_==43596||_==43644||_==43696||43698<=_&&_<=43700||43703<=_&&_<=43704||43710<=_&&_<=43711||_==43713||43756<=_&&_<=43757||_==43766||_==44005||_==44008||_==44013||_==64286||65024<=_&&_<=65039||65056<=_&&_<=65071||65438<=_&&_<=65439||_==66045||_==66272||66422<=_&&_<=66426||68097<=_&&_<=68099||68101<=_&&_<=68102||68108<=_&&_<=68111||68152<=_&&_<=68154||_==68159||68325<=_&&_<=68326||_==69633||69688<=_&&_<=69702||69759<=_&&_<=69761||69811<=_&&_<=69814||69817<=_&&_<=69818||69888<=_&&_<=69890||69927<=_&&_<=69931||69933<=_&&_<=69940||_==70003||70016<=_&&_<=70017||70070<=_&&_<=70078||70090<=_&&_<=70092||70191<=_&&_<=70193||_==70196||70198<=_&&_<=70199||_==70206||_==70367||70371<=_&&_<=70378||70400<=_&&_<=70401||_==70460||_==70462||_==70464||_==70487||70502<=_&&_<=70508||70512<=_&&_<=70516||70712<=_&&_<=70719||70722<=_&&_<=70724||_==70726||_==70832||70835<=_&&_<=70840||_==70842||_==70845||70847<=_&&_<=70848||70850<=_&&_<=70851||_==71087||71090<=_&&_<=71093||71100<=_&&_<=71101||71103<=_&&_<=71104||71132<=_&&_<=71133||71219<=_&&_<=71226||_==71229||71231<=_&&_<=71232||_==71339||_==71341||71344<=_&&_<=71349||_==71351||71453<=_&&_<=71455||71458<=_&&_<=71461||71463<=_&&_<=71467||72193<=_&&_<=72198||72201<=_&&_<=72202||72243<=_&&_<=72248||72251<=_&&_<=72254||_==72263||72273<=_&&_<=72278||72281<=_&&_<=72283||72330<=_&&_<=72342||72344<=_&&_<=72345||72752<=_&&_<=72758||72760<=_&&_<=72765||_==72767||72850<=_&&_<=72871||72874<=_&&_<=72880||72882<=_&&_<=72883||72885<=_&&_<=72886||73009<=_&&_<=73014||_==73018||73020<=_&&_<=73021||73023<=_&&_<=73029||_==73031||92912<=_&&_<=92916||92976<=_&&_<=92982||94095<=_&&_<=94098||113821<=_&&_<=113822||_==119141||119143<=_&&_<=119145||119150<=_&&_<=119154||119163<=_&&_<=119170||119173<=_&&_<=119179||119210<=_&&_<=119213||119362<=_&&_<=119364||121344<=_&&_<=121398||121403<=_&&_<=121452||_==121461||_==121476||121499<=_&&_<=121503||121505<=_&&_<=121519||122880<=_&&_<=122886||122888<=_&&_<=122904||122907<=_&&_<=122913||122915<=_&&_<=122916||122918<=_&&_<=122922||125136<=_&&_<=125142||125252<=_&&_<=125258||917536<=_&&_<=917631||917760<=_&&_<=917999?i:127462<=_&&_<=127487?o:_==2307||_==2363||2366<=_&&_<=2368||2377<=_&&_<=2380||2382<=_&&_<=2383||2434<=_&&_<=2435||2495<=_&&_<=2496||2503<=_&&_<=2504||2507<=_&&_<=2508||_==2563||2622<=_&&_<=2624||_==2691||2750<=_&&_<=2752||_==2761||2763<=_&&_<=2764||2818<=_&&_<=2819||_==2880||2887<=_&&_<=2888||2891<=_&&_<=2892||_==3007||3009<=_&&_<=3010||3014<=_&&_<=3016||3018<=_&&_<=3020||3073<=_&&_<=3075||3137<=_&&_<=3140||3202<=_&&_<=3203||_==3262||3264<=_&&_<=3265||3267<=_&&_<=3268||3271<=_&&_<=3272||3274<=_&&_<=3275||3330<=_&&_<=3331||3391<=_&&_<=3392||3398<=_&&_<=3400||3402<=_&&_<=3404||3458<=_&&_<=3459||3536<=_&&_<=3537||3544<=_&&_<=3550||3570<=_&&_<=3571||_==3635||_==3763||3902<=_&&_<=3903||_==3967||_==4145||4155<=_&&_<=4156||4182<=_&&_<=4183||_==4228||_==6070||6078<=_&&_<=6085||6087<=_&&_<=6088||6435<=_&&_<=6438||6441<=_&&_<=6443||6448<=_&&_<=6449||6451<=_&&_<=6456||6681<=_&&_<=6682||_==6741||_==6743||6765<=_&&_<=6770||_==6916||_==6965||_==6971||6973<=_&&_<=6977||6979<=_&&_<=6980||_==7042||_==7073||7078<=_&&_<=7079||_==7082||_==7143||7146<=_&&_<=7148||_==7150||7154<=_&&_<=7155||7204<=_&&_<=7211||7220<=_&&_<=7221||_==7393||7410<=_&&_<=7411||_==7415||43043<=_&&_<=43044||_==43047||43136<=_&&_<=43137||43188<=_&&_<=43203||43346<=_&&_<=43347||_==43395||43444<=_&&_<=43445||43450<=_&&_<=43451||43453<=_&&_<=43456||43567<=_&&_<=43568||43571<=_&&_<=43572||_==43597||_==43755||43758<=_&&_<=43759||_==43765||44003<=_&&_<=44004||44006<=_&&_<=44007||44009<=_&&_<=44010||_==44012||_==69632||_==69634||_==69762||69808<=_&&_<=69810||69815<=_&&_<=69816||_==69932||_==70018||70067<=_&&_<=70069||70079<=_&&_<=70080||70188<=_&&_<=70190||70194<=_&&_<=70195||_==70197||70368<=_&&_<=70370||70402<=_&&_<=70403||_==70463||70465<=_&&_<=70468||70471<=_&&_<=70472||70475<=_&&_<=70477||70498<=_&&_<=70499||70709<=_&&_<=70711||70720<=_&&_<=70721||_==70725||70833<=_&&_<=70834||_==70841||70843<=_&&_<=70844||_==70846||_==70849||71088<=_&&_<=71089||71096<=_&&_<=71099||_==71102||71216<=_&&_<=71218||71227<=_&&_<=71228||_==71230||_==71340||71342<=_&&_<=71343||_==71350||71456<=_&&_<=71457||_==71462||72199<=_&&_<=72200||_==72249||72279<=_&&_<=72280||_==72343||_==72751||_==72766||_==72873||_==72881||_==72884||94033<=_&&_<=94078||_==119142||_==119149?r:4352<=_&&_<=4447||43360<=_&&_<=43388?s:4448<=_&&_<=4519||55216<=_&&_<=55238?a:4520<=_&&_<=4607||55243<=_&&_<=55291?c:_==44032||_==44060||_==44088||_==44116||_==44144||_==44172||_==44200||_==44228||_==44256||_==44284||_==44312||_==44340||_==44368||_==44396||_==44424||_==44452||_==44480||_==44508||_==44536||_==44564||_==44592||_==44620||_==44648||_==44676||_==44704||_==44732||_==44760||_==44788||_==44816||_==44844||_==44872||_==44900||_==44928||_==44956||_==44984||_==45012||_==45040||_==45068||_==45096||_==45124||_==45152||_==45180||_==45208||_==45236||_==45264||_==45292||_==45320||_==45348||_==45376||_==45404||_==45432||_==45460||_==45488||_==45516||_==45544||_==45572||_==45600||_==45628||_==45656||_==45684||_==45712||_==45740||_==45768||_==45796||_==45824||_==45852||_==45880||_==45908||_==45936||_==45964||_==45992||_==46020||_==46048||_==46076||_==46104||_==46132||_==46160||_==46188||_==46216||_==46244||_==46272||_==46300||_==46328||_==46356||_==46384||_==46412||_==46440||_==46468||_==46496||_==46524||_==46552||_==46580||_==46608||_==46636||_==46664||_==46692||_==46720||_==46748||_==46776||_==46804||_==46832||_==46860||_==46888||_==46916||_==46944||_==46972||_==47e3||_==47028||_==47056||_==47084||_==47112||_==47140||_==47168||_==47196||_==47224||_==47252||_==47280||_==47308||_==47336||_==47364||_==47392||_==47420||_==47448||_==47476||_==47504||_==47532||_==47560||_==47588||_==47616||_==47644||_==47672||_==47700||_==47728||_==47756||_==47784||_==47812||_==47840||_==47868||_==47896||_==47924||_==47952||_==47980||_==48008||_==48036||_==48064||_==48092||_==48120||_==48148||_==48176||_==48204||_==48232||_==48260||_==48288||_==48316||_==48344||_==48372||_==48400||_==48428||_==48456||_==48484||_==48512||_==48540||_==48568||_==48596||_==48624||_==48652||_==48680||_==48708||_==48736||_==48764||_==48792||_==48820||_==48848||_==48876||_==48904||_==48932||_==48960||_==48988||_==49016||_==49044||_==49072||_==49100||_==49128||_==49156||_==49184||_==49212||_==49240||_==49268||_==49296||_==49324||_==49352||_==49380||_==49408||_==49436||_==49464||_==49492||_==49520||_==49548||_==49576||_==49604||_==49632||_==49660||_==49688||_==49716||_==49744||_==49772||_==49800||_==49828||_==49856||_==49884||_==49912||_==49940||_==49968||_==49996||_==50024||_==50052||_==50080||_==50108||_==50136||_==50164||_==50192||_==50220||_==50248||_==50276||_==50304||_==50332||_==50360||_==50388||_==50416||_==50444||_==50472||_==50500||_==50528||_==50556||_==50584||_==50612||_==50640||_==50668||_==50696||_==50724||_==50752||_==50780||_==50808||_==50836||_==50864||_==50892||_==50920||_==50948||_==50976||_==51004||_==51032||_==51060||_==51088||_==51116||_==51144||_==51172||_==51200||_==51228||_==51256||_==51284||_==51312||_==51340||_==51368||_==51396||_==51424||_==51452||_==51480||_==51508||_==51536||_==51564||_==51592||_==51620||_==51648||_==51676||_==51704||_==51732||_==51760||_==51788||_==51816||_==51844||_==51872||_==51900||_==51928||_==51956||_==51984||_==52012||_==52040||_==52068||_==52096||_==52124||_==52152||_==52180||_==52208||_==52236||_==52264||_==52292||_==52320||_==52348||_==52376||_==52404||_==52432||_==52460||_==52488||_==52516||_==52544||_==52572||_==52600||_==52628||_==52656||_==52684||_==52712||_==52740||_==52768||_==52796||_==52824||_==52852||_==52880||_==52908||_==52936||_==52964||_==52992||_==53020||_==53048||_==53076||_==53104||_==53132||_==53160||_==53188||_==53216||_==53244||_==53272||_==53300||_==53328||_==53356||_==53384||_==53412||_==53440||_==53468||_==53496||_==53524||_==53552||_==53580||_==53608||_==53636||_==53664||_==53692||_==53720||_==53748||_==53776||_==53804||_==53832||_==53860||_==53888||_==53916||_==53944||_==53972||_==54e3||_==54028||_==54056||_==54084||_==54112||_==54140||_==54168||_==54196||_==54224||_==54252||_==54280||_==54308||_==54336||_==54364||_==54392||_==54420||_==54448||_==54476||_==54504||_==54532||_==54560||_==54588||_==54616||_==54644||_==54672||_==54700||_==54728||_==54756||_==54784||_==54812||_==54840||_==54868||_==54896||_==54924||_==54952||_==54980||_==55008||_==55036||_==55064||_==55092||_==55120||_==55148||_==55176?l:44033<=_&&_<=44059||44061<=_&&_<=44087||44089<=_&&_<=44115||44117<=_&&_<=44143||44145<=_&&_<=44171||44173<=_&&_<=44199||44201<=_&&_<=44227||44229<=_&&_<=44255||44257<=_&&_<=44283||44285<=_&&_<=44311||44313<=_&&_<=44339||44341<=_&&_<=44367||44369<=_&&_<=44395||44397<=_&&_<=44423||44425<=_&&_<=44451||44453<=_&&_<=44479||44481<=_&&_<=44507||44509<=_&&_<=44535||44537<=_&&_<=44563||44565<=_&&_<=44591||44593<=_&&_<=44619||44621<=_&&_<=44647||44649<=_&&_<=44675||44677<=_&&_<=44703||44705<=_&&_<=44731||44733<=_&&_<=44759||44761<=_&&_<=44787||44789<=_&&_<=44815||44817<=_&&_<=44843||44845<=_&&_<=44871||44873<=_&&_<=44899||44901<=_&&_<=44927||44929<=_&&_<=44955||44957<=_&&_<=44983||44985<=_&&_<=45011||45013<=_&&_<=45039||45041<=_&&_<=45067||45069<=_&&_<=45095||45097<=_&&_<=45123||45125<=_&&_<=45151||45153<=_&&_<=45179||45181<=_&&_<=45207||45209<=_&&_<=45235||45237<=_&&_<=45263||45265<=_&&_<=45291||45293<=_&&_<=45319||45321<=_&&_<=45347||45349<=_&&_<=45375||45377<=_&&_<=45403||45405<=_&&_<=45431||45433<=_&&_<=45459||45461<=_&&_<=45487||45489<=_&&_<=45515||45517<=_&&_<=45543||45545<=_&&_<=45571||45573<=_&&_<=45599||45601<=_&&_<=45627||45629<=_&&_<=45655||45657<=_&&_<=45683||45685<=_&&_<=45711||45713<=_&&_<=45739||45741<=_&&_<=45767||45769<=_&&_<=45795||45797<=_&&_<=45823||45825<=_&&_<=45851||45853<=_&&_<=45879||45881<=_&&_<=45907||45909<=_&&_<=45935||45937<=_&&_<=45963||45965<=_&&_<=45991||45993<=_&&_<=46019||46021<=_&&_<=46047||46049<=_&&_<=46075||46077<=_&&_<=46103||46105<=_&&_<=46131||46133<=_&&_<=46159||46161<=_&&_<=46187||46189<=_&&_<=46215||46217<=_&&_<=46243||46245<=_&&_<=46271||46273<=_&&_<=46299||46301<=_&&_<=46327||46329<=_&&_<=46355||46357<=_&&_<=46383||46385<=_&&_<=46411||46413<=_&&_<=46439||46441<=_&&_<=46467||46469<=_&&_<=46495||46497<=_&&_<=46523||46525<=_&&_<=46551||46553<=_&&_<=46579||46581<=_&&_<=46607||46609<=_&&_<=46635||46637<=_&&_<=46663||46665<=_&&_<=46691||46693<=_&&_<=46719||46721<=_&&_<=46747||46749<=_&&_<=46775||46777<=_&&_<=46803||46805<=_&&_<=46831||46833<=_&&_<=46859||46861<=_&&_<=46887||46889<=_&&_<=46915||46917<=_&&_<=46943||46945<=_&&_<=46971||46973<=_&&_<=46999||47001<=_&&_<=47027||47029<=_&&_<=47055||47057<=_&&_<=47083||47085<=_&&_<=47111||47113<=_&&_<=47139||47141<=_&&_<=47167||47169<=_&&_<=47195||47197<=_&&_<=47223||47225<=_&&_<=47251||47253<=_&&_<=47279||47281<=_&&_<=47307||47309<=_&&_<=47335||47337<=_&&_<=47363||47365<=_&&_<=47391||47393<=_&&_<=47419||47421<=_&&_<=47447||47449<=_&&_<=47475||47477<=_&&_<=47503||47505<=_&&_<=47531||47533<=_&&_<=47559||47561<=_&&_<=47587||47589<=_&&_<=47615||47617<=_&&_<=47643||47645<=_&&_<=47671||47673<=_&&_<=47699||47701<=_&&_<=47727||47729<=_&&_<=47755||47757<=_&&_<=47783||47785<=_&&_<=47811||47813<=_&&_<=47839||47841<=_&&_<=47867||47869<=_&&_<=47895||47897<=_&&_<=47923||47925<=_&&_<=47951||47953<=_&&_<=47979||47981<=_&&_<=48007||48009<=_&&_<=48035||48037<=_&&_<=48063||48065<=_&&_<=48091||48093<=_&&_<=48119||48121<=_&&_<=48147||48149<=_&&_<=48175||48177<=_&&_<=48203||48205<=_&&_<=48231||48233<=_&&_<=48259||48261<=_&&_<=48287||48289<=_&&_<=48315||48317<=_&&_<=48343||48345<=_&&_<=48371||48373<=_&&_<=48399||48401<=_&&_<=48427||48429<=_&&_<=48455||48457<=_&&_<=48483||48485<=_&&_<=48511||48513<=_&&_<=48539||48541<=_&&_<=48567||48569<=_&&_<=48595||48597<=_&&_<=48623||48625<=_&&_<=48651||48653<=_&&_<=48679||48681<=_&&_<=48707||48709<=_&&_<=48735||48737<=_&&_<=48763||48765<=_&&_<=48791||48793<=_&&_<=48819||48821<=_&&_<=48847||48849<=_&&_<=48875||48877<=_&&_<=48903||48905<=_&&_<=48931||48933<=_&&_<=48959||48961<=_&&_<=48987||48989<=_&&_<=49015||49017<=_&&_<=49043||49045<=_&&_<=49071||49073<=_&&_<=49099||49101<=_&&_<=49127||49129<=_&&_<=49155||49157<=_&&_<=49183||49185<=_&&_<=49211||49213<=_&&_<=49239||49241<=_&&_<=49267||49269<=_&&_<=49295||49297<=_&&_<=49323||49325<=_&&_<=49351||49353<=_&&_<=49379||49381<=_&&_<=49407||49409<=_&&_<=49435||49437<=_&&_<=49463||49465<=_&&_<=49491||49493<=_&&_<=49519||49521<=_&&_<=49547||49549<=_&&_<=49575||49577<=_&&_<=49603||49605<=_&&_<=49631||49633<=_&&_<=49659||49661<=_&&_<=49687||49689<=_&&_<=49715||49717<=_&&_<=49743||49745<=_&&_<=49771||49773<=_&&_<=49799||49801<=_&&_<=49827||49829<=_&&_<=49855||49857<=_&&_<=49883||49885<=_&&_<=49911||49913<=_&&_<=49939||49941<=_&&_<=49967||49969<=_&&_<=49995||49997<=_&&_<=50023||50025<=_&&_<=50051||50053<=_&&_<=50079||50081<=_&&_<=50107||50109<=_&&_<=50135||50137<=_&&_<=50163||50165<=_&&_<=50191||50193<=_&&_<=50219||50221<=_&&_<=50247||50249<=_&&_<=50275||50277<=_&&_<=50303||50305<=_&&_<=50331||50333<=_&&_<=50359||50361<=_&&_<=50387||50389<=_&&_<=50415||50417<=_&&_<=50443||50445<=_&&_<=50471||50473<=_&&_<=50499||50501<=_&&_<=50527||50529<=_&&_<=50555||50557<=_&&_<=50583||50585<=_&&_<=50611||50613<=_&&_<=50639||50641<=_&&_<=50667||50669<=_&&_<=50695||50697<=_&&_<=50723||50725<=_&&_<=50751||50753<=_&&_<=50779||50781<=_&&_<=50807||50809<=_&&_<=50835||50837<=_&&_<=50863||50865<=_&&_<=50891||50893<=_&&_<=50919||50921<=_&&_<=50947||50949<=_&&_<=50975||50977<=_&&_<=51003||51005<=_&&_<=51031||51033<=_&&_<=51059||51061<=_&&_<=51087||51089<=_&&_<=51115||51117<=_&&_<=51143||51145<=_&&_<=51171||51173<=_&&_<=51199||51201<=_&&_<=51227||51229<=_&&_<=51255||51257<=_&&_<=51283||51285<=_&&_<=51311||51313<=_&&_<=51339||51341<=_&&_<=51367||51369<=_&&_<=51395||51397<=_&&_<=51423||51425<=_&&_<=51451||51453<=_&&_<=51479||51481<=_&&_<=51507||51509<=_&&_<=51535||51537<=_&&_<=51563||51565<=_&&_<=51591||51593<=_&&_<=51619||51621<=_&&_<=51647||51649<=_&&_<=51675||51677<=_&&_<=51703||51705<=_&&_<=51731||51733<=_&&_<=51759||51761<=_&&_<=51787||51789<=_&&_<=51815||51817<=_&&_<=51843||51845<=_&&_<=51871||51873<=_&&_<=51899||51901<=_&&_<=51927||51929<=_&&_<=51955||51957<=_&&_<=51983||51985<=_&&_<=52011||52013<=_&&_<=52039||52041<=_&&_<=52067||52069<=_&&_<=52095||52097<=_&&_<=52123||52125<=_&&_<=52151||52153<=_&&_<=52179||52181<=_&&_<=52207||52209<=_&&_<=52235||52237<=_&&_<=52263||52265<=_&&_<=52291||52293<=_&&_<=52319||52321<=_&&_<=52347||52349<=_&&_<=52375||52377<=_&&_<=52403||52405<=_&&_<=52431||52433<=_&&_<=52459||52461<=_&&_<=52487||52489<=_&&_<=52515||52517<=_&&_<=52543||52545<=_&&_<=52571||52573<=_&&_<=52599||52601<=_&&_<=52627||52629<=_&&_<=52655||52657<=_&&_<=52683||52685<=_&&_<=52711||52713<=_&&_<=52739||52741<=_&&_<=52767||52769<=_&&_<=52795||52797<=_&&_<=52823||52825<=_&&_<=52851||52853<=_&&_<=52879||52881<=_&&_<=52907||52909<=_&&_<=52935||52937<=_&&_<=52963||52965<=_&&_<=52991||52993<=_&&_<=53019||53021<=_&&_<=53047||53049<=_&&_<=53075||53077<=_&&_<=53103||53105<=_&&_<=53131||53133<=_&&_<=53159||53161<=_&&_<=53187||53189<=_&&_<=53215||53217<=_&&_<=53243||53245<=_&&_<=53271||53273<=_&&_<=53299||53301<=_&&_<=53327||53329<=_&&_<=53355||53357<=_&&_<=53383||53385<=_&&_<=53411||53413<=_&&_<=53439||53441<=_&&_<=53467||53469<=_&&_<=53495||53497<=_&&_<=53523||53525<=_&&_<=53551||53553<=_&&_<=53579||53581<=_&&_<=53607||53609<=_&&_<=53635||53637<=_&&_<=53663||53665<=_&&_<=53691||53693<=_&&_<=53719||53721<=_&&_<=53747||53749<=_&&_<=53775||53777<=_&&_<=53803||53805<=_&&_<=53831||53833<=_&&_<=53859||53861<=_&&_<=53887||53889<=_&&_<=53915||53917<=_&&_<=53943||53945<=_&&_<=53971||53973<=_&&_<=53999||54001<=_&&_<=54027||54029<=_&&_<=54055||54057<=_&&_<=54083||54085<=_&&_<=54111||54113<=_&&_<=54139||54141<=_&&_<=54167||54169<=_&&_<=54195||54197<=_&&_<=54223||54225<=_&&_<=54251||54253<=_&&_<=54279||54281<=_&&_<=54307||54309<=_&&_<=54335||54337<=_&&_<=54363||54365<=_&&_<=54391||54393<=_&&_<=54419||54421<=_&&_<=54447||54449<=_&&_<=54475||54477<=_&&_<=54503||54505<=_&&_<=54531||54533<=_&&_<=54559||54561<=_&&_<=54587||54589<=_&&_<=54615||54617<=_&&_<=54643||54645<=_&&_<=54671||54673<=_&&_<=54699||54701<=_&&_<=54727||54729<=_&&_<=54755||54757<=_&&_<=54783||54785<=_&&_<=54811||54813<=_&&_<=54839||54841<=_&&_<=54867||54869<=_&&_<=54895||54897<=_&&_<=54923||54925<=_&&_<=54951||54953<=_&&_<=54979||54981<=_&&_<=55007||55009<=_&&_<=55035||55037<=_&&_<=55063||55065<=_&&_<=55091||55093<=_&&_<=55119||55121<=_&&_<=55147||55149<=_&&_<=55175||55177<=_&&_<=55203?f:_==9757||_==9977||9994<=_&&_<=9997||_==127877||127938<=_&&_<=127940||_==127943||127946<=_&&_<=127948||128066<=_&&_<=128067||128070<=_&&_<=128080||_==128110||128112<=_&&_<=128120||_==128124||128129<=_&&_<=128131||128133<=_&&_<=128135||_==128170||128372<=_&&_<=128373||_==128378||_==128400||128405<=_&&_<=128406||128581<=_&&_<=128583||128587<=_&&_<=128591||_==128675||128692<=_&&_<=128694||_==128704||_==128716||129304<=_&&_<=129308||129310<=_&&_<=129311||_==129318||129328<=_&&_<=129337||129341<=_&&_<=129342||129489<=_&&_<=129501?g:127995<=_&&_<=127999?m:_==8205?y:_==9792||_==9794||9877<=_&&_<=9878||_==9992||_==10084||_==127752||_==127806||_==127859||_==127891||_==127908||_==127912||_==127979||_==127981||_==128139||128187<=_&&_<=128188||_==128295||_==128300||_==128488||_==128640||_==128658?b:128102<=_&&_<=128105?C:d}return this}typeof pB<"u"&&pB.exports&&(pB.exports=xje)});var sle=Fn(()=>{});var Bi=Fn((VB,ale)=>{(function(e,t){typeof VB=="object"?ale.exports=VB=t():typeof define=="function"&&define.amd?define([],t):e.CryptoJS=t()})(VB,function(){var e=e||function(t,n){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof global<"u"&&global.crypto&&(i=global.crypto),!i&&typeof Kb=="function")try{i=sle()}catch{}var o=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},r=Object.create||function(){function C(){}return function(A){var T;return C.prototype=A,T=new C,C.prototype=null,T}}(),s={},a=s.lib={},c=a.Base=function(){return{extend:function(C){var A=r(this);return C&&A.mixIn(C),(!A.hasOwnProperty("init")||this.init===A.init)&&(A.init=function(){A.$super.init.apply(this,arguments)}),A.init.prototype=A,A.$super=this,A},create:function(){var C=this.extend();return C.init.apply(C,arguments),C},init:function(){},mixIn:function(C){for(var A in C)C.hasOwnProperty(A)&&(this[A]=C[A]);C.hasOwnProperty("toString")&&(this.toString=C.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),l=a.WordArray=c.extend({init:function(C,A){C=this.words=C||[],A!=n?this.sigBytes=A:this.sigBytes=C.length*4},toString:function(C){return(C||d).stringify(this)},concat:function(C){var A=this.words,T=C.words,E=this.sigBytes,v=C.sigBytes;if(this.clamp(),E%4)for(var D=0;D<v;D++){var O=T[D>>>2]>>>24-D%4*8&255;A[E+D>>>2]|=O<<24-(E+D)%4*8}else for(var P=0;P<v;P+=4)A[E+P>>>2]=T[P>>>2];return this.sigBytes+=v,this},clamp:function(){var C=this.words,A=this.sigBytes;C[A>>>2]&=4294967295<<32-A%4*8,C.length=t.ceil(A/4)},clone:function(){var C=c.clone.call(this);return C.words=this.words.slice(0),C},random:function(C){for(var A=[],T=0;T<C;T+=4)A.push(o());return new l.init(A,C)}}),f=s.enc={},d=f.Hex={stringify:function(C){for(var A=C.words,T=C.sigBytes,E=[],v=0;v<T;v++){var D=A[v>>>2]>>>24-v%4*8&255;E.push((D>>>4).toString(16)),E.push((D&15).toString(16))}return E.join("")},parse:function(C){for(var A=C.length,T=[],E=0;E<A;E+=2)T[E>>>3]|=parseInt(C.substr(E,2),16)<<24-E%8*4;return new l.init(T,A/2)}},p=f.Latin1={stringify:function(C){for(var A=C.words,T=C.sigBytes,E=[],v=0;v<T;v++){var D=A[v>>>2]>>>24-v%4*8&255;E.push(String.fromCharCode(D))}return E.join("")},parse:function(C){for(var A=C.length,T=[],E=0;E<A;E++)T[E>>>2]|=(C.charCodeAt(E)&255)<<24-E%4*8;return new l.init(T,A)}},g=f.Utf8={stringify:function(C){try{return decodeURIComponent(escape(p.stringify(C)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(C){return p.parse(unescape(encodeURIComponent(C)))}},m=a.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(C){typeof C=="string"&&(C=g.parse(C)),this._data.concat(C),this._nDataBytes+=C.sigBytes},_process:function(C){var A,T=this._data,E=T.words,v=T.sigBytes,D=this.blockSize,O=D*4,P=v/O;C?P=t.ceil(P):P=t.max((P|0)-this._minBufferSize,0);var M=P*D,L=t.min(M*4,v);if(M){for(var _=0;_<M;_+=D)this._doProcessBlock(E,_);A=E.splice(0,M),T.sigBytes-=L}return new l.init(A,L)},clone:function(){var C=c.clone.call(this);return C._data=this._data.clone(),C},_minBufferSize:0}),y=a.Hasher=m.extend({cfg:c.extend(),init:function(C){this.cfg=this.cfg.extend(C),this.reset()},reset:function(){m.reset.call(this),this._doReset()},update:function(C){return this._append(C),this._process(),this},finalize:function(C){C&&this._append(C);var A=this._doFinalize();return A},blockSize:512/32,_createHelper:function(C){return function(A,T){return new C.init(T).finalize(A)}},_createHmacHelper:function(C){return function(A,T){return new b.HMAC.init(C,T).finalize(A)}}}),b=s.algo={};return s}(Math);return e})});var Xw=Fn((UB,cle)=>{(function(e,t){typeof UB=="object"?cle.exports=UB=t(Bi()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(UB,function(e){return function(t){var n=e,i=n.lib,o=i.Base,r=i.WordArray,s=n.x64={},a=s.Word=o.extend({init:function(l,f){this.high=l,this.low=f}}),c=s.WordArray=o.extend({init:function(l,f){l=this.words=l||[],f!=t?this.sigBytes=f:this.sigBytes=l.length*8},toX32:function(){for(var l=this.words,f=l.length,d=[],p=0;p<f;p++){var g=l[p];d.push(g.high),d.push(g.low)}return r.create(d,this.sigBytes)},clone:function(){for(var l=o.clone.call(this),f=l.words=this.words.slice(0),d=f.length,p=0;p<d;p++)f[p]=f[p].clone();return l}})}(),e})});var ule=Fn((zB,lle)=>{(function(e,t){typeof zB=="object"?lle.exports=zB=t(Bi()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(zB,function(e){return function(){if(typeof ArrayBuffer=="function"){var t=e,n=t.lib,i=n.WordArray,o=i.init,r=i.init=function(s){if(s instanceof ArrayBuffer&&(s=new Uint8Array(s)),(s instanceof Int8Array||typeof Uint8ClampedArray<"u"&&s instanceof Uint8ClampedArray||s instanceof Int16Array||s instanceof Uint16Array||s instanceof Int32Array||s instanceof Uint32Array||s instanceof Float32Array||s instanceof Float64Array)&&(s=new Uint8Array(s.buffer,s.byteOffset,s.byteLength)),s instanceof Uint8Array){for(var a=s.byteLength,c=[],l=0;l<a;l++)c[l>>>2]|=s[l]<<24-l%4*8;o.call(this,c,a)}else o.apply(this,arguments)};r.prototype=i}}(),e.lib.WordArray})});var dle=Fn((HB,fle)=>{(function(e,t){typeof HB=="object"?fle.exports=HB=t(Bi()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(HB,function(e){return function(){var t=e,n=t.lib,i=n.WordArray,o=t.enc,r=o.Utf16=o.Utf16BE={stringify:function(a){for(var c=a.words,l=a.sigBytes,f=[],d=0;d<l;d+=2){var p=c[d>>>2]>>>16-d%4*8&65535;f.push(String.fromCharCode(p))}return f.join("")},parse:function(a){for(var c=a.length,l=[],f=0;f<c;f++)l[f>>>1]|=a.charCodeAt(f)<<16-f%2*16;return i.create(l,c*2)}};o.Utf16LE={stringify:function(a){for(var c=a.words,l=a.sigBytes,f=[],d=0;d<l;d+=2){var p=s(c[d>>>2]>>>16-d%4*8&65535);f.push(String.fromCharCode(p))}return f.join("")},parse:function(a){for(var c=a.length,l=[],f=0;f<c;f++)l[f>>>1]|=s(a.charCodeAt(f)<<16-f%2*16);return i.create(l,c*2)}};function s(a){return a<<8&4278255360|a>>>8&16711935}}(),e.enc.Utf16})});var Yg=Fn((GB,hle)=>{(function(e,t){typeof GB=="object"?hle.exports=GB=t(Bi()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(GB,function(e){return function(){var t=e,n=t.lib,i=n.WordArray,o=t.enc,r=o.Base64={stringify:function(a){var c=a.words,l=a.sigBytes,f=this._map;a.clamp();for(var d=[],p=0;p<l;p+=3)for(var g=c[p>>>2]>>>24-p%4*8&255,m=c[p+1>>>2]>>>24-(p+1)%4*8&255,y=c[p+2>>>2]>>>24-(p+2)%4*8&255,b=g<<16|m<<8|y,C=0;C<4&&p+C*.75<l;C++)d.push(f.charAt(b>>>6*(3-C)&63));var A=f.charAt(64);if(A)for(;d.length%4;)d.push(A);return d.join("")},parse:function(a){var c=a.length,l=this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var d=0;d<l.length;d++)f[l.charCodeAt(d)]=d}var p=l.charAt(64);if(p){var g=a.indexOf(p);g!==-1&&(c=g)}return s(a,c,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function s(a,c,l){for(var f=[],d=0,p=0;p<c;p++)if(p%4){var g=l[a.charCodeAt(p-1)]<<p%4*2,m=l[a.charCodeAt(p)]>>>6-p%4*2,y=g|m;f[d>>>2]|=y<<24-d%4*8,d++}return i.create(f,d)}}(),e.enc.Base64})});var ple=Fn((WB,mle)=>{(function(e,t){typeof WB=="object"?mle.exports=WB=t(Bi()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(WB,function(e){return function(){var t=e,n=t.lib,i=n.WordArray,o=t.enc,r=o.Base64url={stringify:function(a,c){c===void 0&&(c=!0);var l=a.words,f=a.sigBytes,d=c?this._safe_map:this._map;a.clamp();for(var p=[],g=0;g<f;g+=3)for(var m=l[g>>>2]>>>24-g%4*8&255,y=l[g+1>>>2]>>>24-(g+1)%4*8&255,b=l[g+2>>>2]>>>24-(g+2)%4*8&255,C=m<<16|y<<8|b,A=0;A<4&&g+A*.75<f;A++)p.push(d.charAt(C>>>6*(3-A)&63));var T=d.charAt(64);if(T)for(;p.length%4;)p.push(T);return p.join("")},parse:function(a,c){c===void 0&&(c=!0);var l=a.length,f=c?this._safe_map:this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var p=0;p<f.length;p++)d[f.charCodeAt(p)]=p}var g=f.charAt(64);if(g){var m=a.indexOf(g);m!==-1&&(l=m)}return s(a,l,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function s(a,c,l){for(var f=[],d=0,p=0;p<c;p++)if(p%4){var g=l[a.charCodeAt(p-1)]<<p%4*2,m=l[a.charCodeAt(p)]>>>6-p%4*2,y=g|m;f[d>>>2]|=y<<24-d%4*8,d++}return i.create(f,d)}}(),e.enc.Base64url})});var Xg=Fn((jB,_le)=>{(function(e,t){typeof jB=="object"?_le.exports=jB=t(Bi()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(jB,function(e){return function(t){var n=e,i=n.lib,o=i.WordArray,r=i.Hasher,s=n.algo,a=[];(function(){for(var g=0;g<64;g++)a[g]=t.abs(t.sin(g+1))*4294967296|0})();var c=s.MD5=r.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(g,m){for(var y=0;y<16;y++){var b=m+y,C=g[b];g[b]=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360}var A=this._hash.words,T=g[m+0],E=g[m+1],v=g[m+2],D=g[m+3],O=g[m+4],P=g[m+5],M=g[m+6],L=g[m+7],_=g[m+8],S=g[m+9],w=g[m+10],I=g[m+11],N=g[m+12],k=g[m+13],z=g[m+14],V=g[m+15],U=A[0],B=A[1],W=A[2],j=A[3];U=l(U,B,W,j,T,7,a[0]),j=l(j,U,B,W,E,12,a[1]),W=l(W,j,U,B,v,17,a[2]),B=l(B,W,j,U,D,22,a[3]),U=l(U,B,W,j,O,7,a[4]),j=l(j,U,B,W,P,12,a[5]),W=l(W,j,U,B,M,17,a[6]),B=l(B,W,j,U,L,22,a[7]),U=l(U,B,W,j,_,7,a[8]),j=l(j,U,B,W,S,12,a[9]),W=l(W,j,U,B,w,17,a[10]),B=l(B,W,j,U,I,22,a[11]),U=l(U,B,W,j,N,7,a[12]),j=l(j,U,B,W,k,12,a[13]),W=l(W,j,U,B,z,17,a[14]),B=l(B,W,j,U,V,22,a[15]),U=f(U,B,W,j,E,5,a[16]),j=f(j,U,B,W,M,9,a[17]),W=f(W,j,U,B,I,14,a[18]),B=f(B,W,j,U,T,20,a[19]),U=f(U,B,W,j,P,5,a[20]),j=f(j,U,B,W,w,9,a[21]),W=f(W,j,U,B,V,14,a[22]),B=f(B,W,j,U,O,20,a[23]),U=f(U,B,W,j,S,5,a[24]),j=f(j,U,B,W,z,9,a[25]),W=f(W,j,U,B,D,14,a[26]),B=f(B,W,j,U,_,20,a[27]),U=f(U,B,W,j,k,5,a[28]),j=f(j,U,B,W,v,9,a[29]),W=f(W,j,U,B,L,14,a[30]),B=f(B,W,j,U,N,20,a[31]),U=d(U,B,W,j,P,4,a[32]),j=d(j,U,B,W,_,11,a[33]),W=d(W,j,U,B,I,16,a[34]),B=d(B,W,j,U,z,23,a[35]),U=d(U,B,W,j,E,4,a[36]),j=d(j,U,B,W,O,11,a[37]),W=d(W,j,U,B,L,16,a[38]),B=d(B,W,j,U,w,23,a[39]),U=d(U,B,W,j,k,4,a[40]),j=d(j,U,B,W,T,11,a[41]),W=d(W,j,U,B,D,16,a[42]),B=d(B,W,j,U,M,23,a[43]),U=d(U,B,W,j,S,4,a[44]),j=d(j,U,B,W,N,11,a[45]),W=d(W,j,U,B,V,16,a[46]),B=d(B,W,j,U,v,23,a[47]),U=p(U,B,W,j,T,6,a[48]),j=p(j,U,B,W,L,10,a[49]),W=p(W,j,U,B,z,15,a[50]),B=p(B,W,j,U,P,21,a[51]),U=p(U,B,W,j,N,6,a[52]),j=p(j,U,B,W,D,10,a[53]),W=p(W,j,U,B,w,15,a[54]),B=p(B,W,j,U,E,21,a[55]),U=p(U,B,W,j,_,6,a[56]),j=p(j,U,B,W,V,10,a[57]),W=p(W,j,U,B,M,15,a[58]),B=p(B,W,j,U,k,21,a[59]),U=p(U,B,W,j,O,6,a[60]),j=p(j,U,B,W,I,10,a[61]),W=p(W,j,U,B,v,15,a[62]),B=p(B,W,j,U,S,21,a[63]),A[0]=A[0]+U|0,A[1]=A[1]+B|0,A[2]=A[2]+W|0,A[3]=A[3]+j|0},_doFinalize:function(){var g=this._data,m=g.words,y=this._nDataBytes*8,b=g.sigBytes*8;m[b>>>5]|=128<<24-b%32;var C=t.floor(y/4294967296),A=y;m[(b+64>>>9<<4)+15]=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,m[(b+64>>>9<<4)+14]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,g.sigBytes=(m.length+1)*4,this._process();for(var T=this._hash,E=T.words,v=0;v<4;v++){var D=E[v];E[v]=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360}return T},clone:function(){var g=r.clone.call(this);return g._hash=this._hash.clone(),g}});function l(g,m,y,b,C,A,T){var E=g+(m&y|~m&b)+C+T;return(E<<A|E>>>32-A)+m}function f(g,m,y,b,C,A,T){var E=g+(m&b|y&~b)+C+T;return(E<<A|E>>>32-A)+m}function d(g,m,y,b,C,A,T){var E=g+(m^y^b)+C+T;return(E<<A|E>>>32-A)+m}function p(g,m,y,b,C,A,T){var E=g+(y^(m|~b))+C+T;return(E<<A|E>>>32-A)+m}n.MD5=r._createHelper(c),n.HmacMD5=r._createHmacHelper(c)}(Math),e.MD5})});var Y7=Fn((qB,gle)=>{(function(e,t){typeof qB=="object"?gle.exports=qB=t(Bi()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(qB,function(e){return function(){var t=e,n=t.lib,i=n.WordArray,o=n.Hasher,r=t.algo,s=[],a=r.SHA1=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(c,l){for(var f=this._hash.words,d=f[0],p=f[1],g=f[2],m=f[3],y=f[4],b=0;b<80;b++){if(b<16)s[b]=c[l+b]|0;else{var C=s[b-3]^s[b-8]^s[b-14]^s[b-16];s[b]=C<<1|C>>>31}var A=(d<<5|d>>>27)+y+s[b];b<20?A+=(p&g|~p&m)+1518500249:b<40?A+=(p^g^m)+1859775393:b<60?A+=(p&g|p&m|g&m)-1894007588:A+=(p^g^m)-899497514,y=m,m=g,g=p<<30|p>>>2,p=d,d=A}f[0]=f[0]+d|0,f[1]=f[1]+p|0,f[2]=f[2]+g|0,f[3]=f[3]+m|0,f[4]=f[4]+y|0},_doFinalize:function(){var c=this._data,l=c.words,f=this._nDataBytes*8,d=c.sigBytes*8;return l[d>>>5]|=128<<24-d%32,l[(d+64>>>9<<4)+14]=Math.floor(f/4294967296),l[(d+64>>>9<<4)+15]=f,c.sigBytes=l.length*4,this._process(),this._hash},clone:function(){var c=o.clone.call(this);return c._hash=this._hash.clone(),c}});t.SHA1=o._createHelper(a),t.HmacSHA1=o._createHmacHelper(a)}(),e.SHA1})});var XB=Fn((YB,yle)=>{(function(e,t){typeof YB=="object"?yle.exports=YB=t(Bi()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(YB,function(e){return function(t){var n=e,i=n.lib,o=i.WordArray,r=i.Hasher,s=n.algo,a=[],c=[];(function(){function d(y){for(var b=t.sqrt(y),C=2;C<=b;C++)if(!(y%C))return!1;return!0}function p(y){return(y-(y|0))*4294967296|0}for(var g=2,m=0;m<64;)d(g)&&(m<8&&(a[m]=p(t.pow(g,1/2))),c[m]=p(t.pow(g,1/3)),m++),g++})();var l=[],f=s.SHA256=r.extend({_doReset:function(){this._hash=new o.init(a.slice(0))},_doProcessBlock:function(d,p){for(var g=this._hash.words,m=g[0],y=g[1],b=g[2],C=g[3],A=g[4],T=g[5],E=g[6],v=g[7],D=0;D<64;D++){if(D<16)l[D]=d[p+D]|0;else{var O=l[D-15],P=(O<<25|O>>>7)^(O<<14|O>>>18)^O>>>3,M=l[D-2],L=(M<<15|M>>>17)^(M<<13|M>>>19)^M>>>10;l[D]=P+l[D-7]+L+l[D-16]}var _=A&T^~A&E,S=m&y^m&b^y&b,w=(m<<30|m>>>2)^(m<<19|m>>>13)^(m<<10|m>>>22),I=(A<<26|A>>>6)^(A<<21|A>>>11)^(A<<7|A>>>25),N=v+I+_+c[D]+l[D],k=w+S;v=E,E=T,T=A,A=C+N|0,C=b,b=y,y=m,m=N+k|0}g[0]=g[0]+m|0,g[1]=g[1]+y|0,g[2]=g[2]+b|0,g[3]=g[3]+C|0,g[4]=g[4]+A|0,g[5]=g[5]+T|0,g[6]=g[6]+E|0,g[7]=g[7]+v|0},_doFinalize:function(){var d=this._data,p=d.words,g=this._nDataBytes*8,m=d.sigBytes*8;return p[m>>>5]|=128<<24-m%32,p[(m+64>>>9<<4)+14]=t.floor(g/4294967296),p[(m+64>>>9<<4)+15]=g,d.sigBytes=p.length*4,this._process(),this._hash},clone:function(){var d=r.clone.call(this);return d._hash=this._hash.clone(),d}});n.SHA256=r._createHelper(f),n.HmacSHA256=r._createHmacHelper(f)}(Math),e.SHA256})});var ble=Fn((KB,xle)=>{(function(e,t,n){typeof KB=="object"?xle.exports=KB=t(Bi(),XB()):typeof define=="function"&&define.amd?define(["./core","./sha256"],t):t(e.CryptoJS)})(KB,function(e){return function(){var t=e,n=t.lib,i=n.WordArray,o=t.algo,r=o.SHA256,s=o.SHA224=r.extend({_doReset:function(){this._hash=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var a=r._doFinalize.call(this);return a.sigBytes-=4,a}});t.SHA224=r._createHelper(s),t.HmacSHA224=r._createHmacHelper(s)}(),e.SHA224})});var X7=Fn((ZB,Cle)=>{(function(e,t,n){typeof ZB=="object"?Cle.exports=ZB=t(Bi(),Xw()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],t):t(e.CryptoJS)})(ZB,function(e){return function(){var t=e,n=t.lib,i=n.Hasher,o=t.x64,r=o.Word,s=o.WordArray,a=t.algo;function c(){return r.create.apply(r,arguments)}var l=[c(1116352408,3609767458),c(1899447441,602891725),c(3049323471,3964484399),c(3921009573,2173295548),c(961987163,4081628472),c(1508970993,3053834265),c(2453635748,2937671579),c(2870763221,3664609560),c(3624381080,2734883394),c(310598401,1164996542),c(607225278,1323610764),c(1426881987,3590304994),c(1925078388,4068182383),c(2162078206,991336113),c(2614888103,633803317),c(3248222580,3479774868),c(3835390401,2666613458),c(4022224774,944711139),c(264347078,2341262773),c(604807628,2007800933),c(770255983,1495990901),c(1249150122,1856431235),c(1555081692,3175218132),c(1996064986,2198950837),c(2554220882,3999719339),c(2821834349,766784016),c(2952996808,2566594879),c(3210313671,3203337956),c(3336571891,1034457026),c(3584528711,2466948901),c(113926993,3758326383),c(338241895,168717936),c(666307205,1188179964),c(773529912,1546045734),c(1294757372,1522805485),c(1396182291,2643833823),c(1695183700,2343527390),c(1986661051,1014477480),c(2177026350,1206759142),c(2456956037,344077627),c(2730485921,1290863460),c(2820302411,3158454273),c(3259730800,3505952657),c(3345764771,106217008),c(3516065817,3606008344),c(3600352804,1432725776),c(4094571909,1467031594),c(275423344,851169720),c(430227734,3100823752),c(506948616,1363258195),c(659060556,3750685593),c(883997877,3785050280),c(958139571,3318307427),c(1322822218,3812723403),c(1537002063,2003034995),c(1747873779,3602036899),c(1955562222,1575990012),c(2024104815,1125592928),c(2227730452,2716904306),c(2361852424,442776044),c(2428436474,593698344),c(2756734187,3733110249),c(3204031479,2999351573),c(3329325298,3815920427),c(3391569614,3928383900),c(3515267271,566280711),c(3940187606,3454069534),c(4118630271,4000239992),c(116418474,1914138554),c(174292421,2731055270),c(289380356,3203993006),c(460393269,320620315),c(685471733,587496836),c(852142971,1086792851),c(1017036298,365543100),c(1126000580,2618297676),c(1288033470,3409855158),c(1501505948,4234509866),c(1607167915,987167468),c(1816402316,1246189591)],f=[];(function(){for(var p=0;p<80;p++)f[p]=c()})();var d=a.SHA512=i.extend({_doReset:function(){this._hash=new s.init([new r.init(1779033703,4089235720),new r.init(3144134277,2227873595),new r.init(1013904242,4271175723),new r.init(2773480762,1595750129),new r.init(1359893119,2917565137),new r.init(2600822924,725511199),new r.init(528734635,4215389547),new r.init(1541459225,327033209)])},_doProcessBlock:function(p,g){for(var m=this._hash.words,y=m[0],b=m[1],C=m[2],A=m[3],T=m[4],E=m[5],v=m[6],D=m[7],O=y.high,P=y.low,M=b.high,L=b.low,_=C.high,S=C.low,w=A.high,I=A.low,N=T.high,k=T.low,z=E.high,V=E.low,U=v.high,B=v.low,W=D.high,j=D.low,Q=O,q=P,X=M,Z=L,fe=_,xe=S,re=w,pe=I,ye=N,Se=k,Te=z,Fe=V,Ve=U,Ze=B,gt=W,lt=j,Oe=0;Oe<80;Oe++){var Mt,ut,at=f[Oe];if(Oe<16)ut=at.high=p[g+Oe*2]|0,Mt=at.low=p[g+Oe*2+1]|0;else{var Kt=f[Oe-15],Ce=Kt.high,Ae=Kt.low,nt=(Ce>>>1|Ae<<31)^(Ce>>>8|Ae<<24)^Ce>>>7,yi=(Ae>>>1|Ce<<31)^(Ae>>>8|Ce<<24)^(Ae>>>7|Ce<<25),ct=f[Oe-2],Si=ct.high,oo=ct.low,Zs=(Si>>>19|oo<<13)^(Si<<3|oo>>>29)^Si>>>6,jo=(oo>>>19|Si<<13)^(oo<<3|Si>>>29)^(oo>>>6|Si<<26),wr=f[Oe-7],Me=wr.high,ot=wr.low,We=f[Oe-16],Ye=We.high,ht=We.low;Mt=yi+ot,ut=nt+Me+(Mt>>>0<yi>>>0?1:0),Mt=Mt+jo,ut=ut+Zs+(Mt>>>0<jo>>>0?1:0),Mt=Mt+ht,ut=ut+Ye+(Mt>>>0<ht>>>0?1:0),at.high=ut,at.low=Mt}var zt=ye&Te^~ye&Ve,mn=Se&Fe^~Se&Ze,bo=Q&X^Q&fe^X&fe,fo=q&Z^q&xe^Z&xe,$s=(Q>>>28|q<<4)^(Q<<30|q>>>2)^(Q<<25|q>>>7),Rs=(q>>>28|Q<<4)^(q<<30|Q>>>2)^(q<<25|Q>>>7),li=(ye>>>14|Se<<18)^(ye>>>18|Se<<14)^(ye<<23|Se>>>9),ti=(Se>>>14|ye<<18)^(Se>>>18|ye<<14)^(Se<<23|ye>>>9),ts=l[Oe],dr=ts.high,ba=ts.low,qn=lt+ti,ro=gt+li+(qn>>>0<lt>>>0?1:0),qn=qn+mn,ro=ro+zt+(qn>>>0<mn>>>0?1:0),qn=qn+ba,ro=ro+dr+(qn>>>0<ba>>>0?1:0),qn=qn+Mt,ro=ro+ut+(qn>>>0<Mt>>>0?1:0),Uu=Rs+fo,hr=$s+bo+(Uu>>>0<Rs>>>0?1:0);gt=Ve,lt=Ze,Ve=Te,Ze=Fe,Te=ye,Fe=Se,Se=pe+qn|0,ye=re+ro+(Se>>>0<pe>>>0?1:0)|0,re=fe,pe=xe,fe=X,xe=Z,X=Q,Z=q,q=qn+Uu|0,Q=ro+hr+(q>>>0<qn>>>0?1:0)|0}P=y.low=P+q,y.high=O+Q+(P>>>0<q>>>0?1:0),L=b.low=L+Z,b.high=M+X+(L>>>0<Z>>>0?1:0),S=C.low=S+xe,C.high=_+fe+(S>>>0<xe>>>0?1:0),I=A.low=I+pe,A.high=w+re+(I>>>0<pe>>>0?1:0),k=T.low=k+Se,T.high=N+ye+(k>>>0<Se>>>0?1:0),V=E.low=V+Fe,E.high=z+Te+(V>>>0<Fe>>>0?1:0),B=v.low=B+Ze,v.high=U+Ve+(B>>>0<Ze>>>0?1:0),j=D.low=j+lt,D.high=W+gt+(j>>>0<lt>>>0?1:0)},_doFinalize:function(){var p=this._data,g=p.words,m=this._nDataBytes*8,y=p.sigBytes*8;g[y>>>5]|=128<<24-y%32,g[(y+128>>>10<<5)+30]=Math.floor(m/4294967296),g[(y+128>>>10<<5)+31]=m,p.sigBytes=g.length*4,this._process();var b=this._hash.toX32();return b},clone:function(){var p=i.clone.call(this);return p._hash=this._hash.clone(),p},blockSize:1024/32});t.SHA512=i._createHelper(d),t.HmacSHA512=i._createHmacHelper(d)}(),e.SHA512})});var Tle=Fn(($B,Ale)=>{(function(e,t,n){typeof $B=="object"?Ale.exports=$B=t(Bi(),Xw(),X7()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./sha512"],t):t(e.CryptoJS)})($B,function(e){return function(){var t=e,n=t.x64,i=n.Word,o=n.WordArray,r=t.algo,s=r.SHA512,a=r.SHA384=s.extend({_doReset:function(){this._hash=new o.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var c=s._doFinalize.call(this);return c.sigBytes-=16,c}});t.SHA384=s._createHelper(a),t.HmacSHA384=s._createHmacHelper(a)}(),e.SHA384})});var Sle=Fn((QB,Ele)=>{(function(e,t,n){typeof QB=="object"?Ele.exports=QB=t(Bi(),Xw()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],t):t(e.CryptoJS)})(QB,function(e){return function(t){var n=e,i=n.lib,o=i.WordArray,r=i.Hasher,s=n.x64,a=s.Word,c=n.algo,l=[],f=[],d=[];(function(){for(var m=1,y=0,b=0;b<24;b++){l[m+5*y]=(b+1)*(b+2)/2%64;var C=y%5,A=(2*m+3*y)%5;m=C,y=A}for(var m=0;m<5;m++)for(var y=0;y<5;y++)f[m+5*y]=y+(2*m+3*y)%5*5;for(var T=1,E=0;E<24;E++){for(var v=0,D=0,O=0;O<7;O++){if(T&1){var P=(1<<O)-1;P<32?D^=1<<P:v^=1<<P-32}T&128?T=T<<1^113:T<<=1}d[E]=a.create(v,D)}})();var p=[];(function(){for(var m=0;m<25;m++)p[m]=a.create()})();var g=c.SHA3=r.extend({cfg:r.cfg.extend({outputLength:512}),_doReset:function(){for(var m=this._state=[],y=0;y<25;y++)m[y]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(m,y){for(var b=this._state,C=this.blockSize/2,A=0;A<C;A++){var T=m[y+2*A],E=m[y+2*A+1];T=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,E=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360;var v=b[A];v.high^=E,v.low^=T}for(var D=0;D<24;D++){for(var O=0;O<5;O++){for(var P=0,M=0,L=0;L<5;L++){var v=b[O+5*L];P^=v.high,M^=v.low}var _=p[O];_.high=P,_.low=M}for(var O=0;O<5;O++)for(var S=p[(O+4)%5],w=p[(O+1)%5],I=w.high,N=w.low,P=S.high^(I<<1|N>>>31),M=S.low^(N<<1|I>>>31),L=0;L<5;L++){var v=b[O+5*L];v.high^=P,v.low^=M}for(var k=1;k<25;k++){var P,M,v=b[k],z=v.high,V=v.low,U=l[k];U<32?(P=z<<U|V>>>32-U,M=V<<U|z>>>32-U):(P=V<<U-32|z>>>64-U,M=z<<U-32|V>>>64-U);var B=p[f[k]];B.high=P,B.low=M}var W=p[0],j=b[0];W.high=j.high,W.low=j.low;for(var O=0;O<5;O++)for(var L=0;L<5;L++){var k=O+5*L,v=b[k],Q=p[k],q=p[(O+1)%5+5*L],X=p[(O+2)%5+5*L];v.high=Q.high^~q.high&X.high,v.low=Q.low^~q.low&X.low}var v=b[0],Z=d[D];v.high^=Z.high,v.low^=Z.low}},_doFinalize:function(){var m=this._data,y=m.words,b=this._nDataBytes*8,C=m.sigBytes*8,A=this.blockSize*32;y[C>>>5]|=1<<24-C%32,y[(t.ceil((C+1)/A)*A>>>5)-1]|=128,m.sigBytes=y.length*4,this._process();for(var T=this._state,E=this.cfg.outputLength/8,v=E/8,D=[],O=0;O<v;O++){var P=T[O],M=P.high,L=P.low;M=(M<<8|M>>>24)&16711935|(M<<24|M>>>8)&4278255360,L=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360,D.push(L),D.push(M)}return new o.init(D,E)},clone:function(){for(var m=r.clone.call(this),y=m._state=this._state.slice(0),b=0;b<25;b++)y[b]=y[b].clone();return m}});n.SHA3=r._createHelper(g),n.HmacSHA3=r._createHmacHelper(g)}(Math),e.SHA3})});var wle=Fn((JB,vle)=>{(function(e,t){typeof JB=="object"?vle.exports=JB=t(Bi()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(JB,function(e){/** @preserve
	(c) 2012 by Cédric Mesnil. All rights reserved.

	Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

	    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
	    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
	*/return function(t){var n=e,i=n.lib,o=i.WordArray,r=i.Hasher,s=n.algo,a=o.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),c=o.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),l=o.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),f=o.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),d=o.create([0,1518500249,1859775393,2400959708,2840853838]),p=o.create([1352829926,1548603684,1836072691,2053994217,0]),g=s.RIPEMD160=r.extend({_doReset:function(){this._hash=o.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(E,v){for(var D=0;D<16;D++){var O=v+D,P=E[O];E[O]=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360}var M=this._hash.words,L=d.words,_=p.words,S=a.words,w=c.words,I=l.words,N=f.words,k,z,V,U,B,W,j,Q,q,X;W=k=M[0],j=z=M[1],Q=V=M[2],q=U=M[3],X=B=M[4];for(var Z,D=0;D<80;D+=1)Z=k+E[v+S[D]]|0,D<16?Z+=m(z,V,U)+L[0]:D<32?Z+=y(z,V,U)+L[1]:D<48?Z+=b(z,V,U)+L[2]:D<64?Z+=C(z,V,U)+L[3]:Z+=A(z,V,U)+L[4],Z=Z|0,Z=T(Z,I[D]),Z=Z+B|0,k=B,B=U,U=T(V,10),V=z,z=Z,Z=W+E[v+w[D]]|0,D<16?Z+=A(j,Q,q)+_[0]:D<32?Z+=C(j,Q,q)+_[1]:D<48?Z+=b(j,Q,q)+_[2]:D<64?Z+=y(j,Q,q)+_[3]:Z+=m(j,Q,q)+_[4],Z=Z|0,Z=T(Z,N[D]),Z=Z+X|0,W=X,X=q,q=T(Q,10),Q=j,j=Z;Z=M[1]+V+q|0,M[1]=M[2]+U+X|0,M[2]=M[3]+B+W|0,M[3]=M[4]+k+j|0,M[4]=M[0]+z+Q|0,M[0]=Z},_doFinalize:function(){var E=this._data,v=E.words,D=this._nDataBytes*8,O=E.sigBytes*8;v[O>>>5]|=128<<24-O%32,v[(O+64>>>9<<4)+14]=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,E.sigBytes=(v.length+1)*4,this._process();for(var P=this._hash,M=P.words,L=0;L<5;L++){var _=M[L];M[L]=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360}return P},clone:function(){var E=r.clone.call(this);return E._hash=this._hash.clone(),E}});function m(E,v,D){return E^v^D}function y(E,v,D){return E&v|~E&D}function b(E,v,D){return(E|~v)^D}function C(E,v,D){return E&D|v&~D}function A(E,v,D){return E^(v|~D)}function T(E,v){return E<<v|E>>>32-v}n.RIPEMD160=r._createHelper(g),n.HmacRIPEMD160=r._createHmacHelper(g)}(Math),e.RIPEMD160})});var t3=Fn((e3,Dle)=>{(function(e,t){typeof e3=="object"?Dle.exports=e3=t(Bi()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(e3,function(e){(function(){var t=e,n=t.lib,i=n.Base,o=t.enc,r=o.Utf8,s=t.algo,a=s.HMAC=i.extend({init:function(c,l){c=this._hasher=new c.init,typeof l=="string"&&(l=r.parse(l));var f=c.blockSize,d=f*4;l.sigBytes>d&&(l=c.finalize(l)),l.clamp();for(var p=this._oKey=l.clone(),g=this._iKey=l.clone(),m=p.words,y=g.words,b=0;b<f;b++)m[b]^=1549556828,y[b]^=909522486;p.sigBytes=g.sigBytes=d,this.reset()},reset:function(){var c=this._hasher;c.reset(),c.update(this._iKey)},update:function(c){return this._hasher.update(c),this},finalize:function(c){var l=this._hasher,f=l.finalize(c);l.reset();var d=l.finalize(this._oKey.clone().concat(f));return d}})})()})});var Ple=Fn((n3,Ile)=>{(function(e,t,n){typeof n3=="object"?Ile.exports=n3=t(Bi(),XB(),t3()):typeof define=="function"&&define.amd?define(["./core","./sha256","./hmac"],t):t(e.CryptoJS)})(n3,function(e){return function(){var t=e,n=t.lib,i=n.Base,o=n.WordArray,r=t.algo,s=r.SHA256,a=r.HMAC,c=r.PBKDF2=i.extend({cfg:i.extend({keySize:128/32,hasher:s,iterations:25e4}),init:function(l){this.cfg=this.cfg.extend(l)},compute:function(l,f){for(var d=this.cfg,p=a.create(d.hasher,l),g=o.create(),m=o.create([1]),y=g.words,b=m.words,C=d.keySize,A=d.iterations;y.length<C;){var T=p.update(f).finalize(m);p.reset();for(var E=T.words,v=E.length,D=T,O=1;O<A;O++){D=p.finalize(D),p.reset();for(var P=D.words,M=0;M<v;M++)E[M]^=P[M]}g.concat(T),b[0]++}return g.sigBytes=C*4,g}});t.PBKDF2=function(l,f,d){return c.create(d).compute(l,f)}}(),e.PBKDF2})});var Gp=Fn((i3,Rle)=>{(function(e,t,n){typeof i3=="object"?Rle.exports=i3=t(Bi(),Y7(),t3()):typeof define=="function"&&define.amd?define(["./core","./sha1","./hmac"],t):t(e.CryptoJS)})(i3,function(e){return function(){var t=e,n=t.lib,i=n.Base,o=n.WordArray,r=t.algo,s=r.MD5,a=r.EvpKDF=i.extend({cfg:i.extend({keySize:128/32,hasher:s,iterations:1}),init:function(c){this.cfg=this.cfg.extend(c)},compute:function(c,l){for(var f,d=this.cfg,p=d.hasher.create(),g=o.create(),m=g.words,y=d.keySize,b=d.iterations;m.length<y;){f&&p.update(f),f=p.update(c).finalize(l),p.reset();for(var C=1;C<b;C++)f=p.finalize(f),p.reset();g.concat(f)}return g.sigBytes=y*4,g}});t.EvpKDF=function(c,l,f){return a.create(f).compute(c,l)}}(),e.EvpKDF})});var Gs=Fn((o3,Ole)=>{(function(e,t,n){typeof o3=="object"?Ole.exports=o3=t(Bi(),Gp()):typeof define=="function"&&define.amd?define(["./core","./evpkdf"],t):t(e.CryptoJS)})(o3,function(e){e.lib.Cipher||function(t){var n=e,i=n.lib,o=i.Base,r=i.WordArray,s=i.BufferedBlockAlgorithm,a=n.enc,c=a.Utf8,l=a.Base64,f=n.algo,d=f.EvpKDF,p=i.Cipher=s.extend({cfg:o.extend(),createEncryptor:function(_,S){return this.create(this._ENC_XFORM_MODE,_,S)},createDecryptor:function(_,S){return this.create(this._DEC_XFORM_MODE,_,S)},init:function(_,S,w){this.cfg=this.cfg.extend(w),this._xformMode=_,this._key=S,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(_){return this._append(_),this._process()},finalize:function(_){_&&this._append(_);var S=this._doFinalize();return S},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function _(S){return typeof S=="string"?L:O}return function(S){return{encrypt:function(w,I,N){return _(I).encrypt(S,w,I,N)},decrypt:function(w,I,N){return _(I).decrypt(S,w,I,N)}}}}()}),g=i.StreamCipher=p.extend({_doFinalize:function(){var _=this._process(!0);return _},blockSize:1}),m=n.mode={},y=i.BlockCipherMode=o.extend({createEncryptor:function(_,S){return this.Encryptor.create(_,S)},createDecryptor:function(_,S){return this.Decryptor.create(_,S)},init:function(_,S){this._cipher=_,this._iv=S}}),b=m.CBC=function(){var _=y.extend();_.Encryptor=_.extend({processBlock:function(w,I){var N=this._cipher,k=N.blockSize;S.call(this,w,I,k),N.encryptBlock(w,I),this._prevBlock=w.slice(I,I+k)}}),_.Decryptor=_.extend({processBlock:function(w,I){var N=this._cipher,k=N.blockSize,z=w.slice(I,I+k);N.decryptBlock(w,I),S.call(this,w,I,k),this._prevBlock=z}});function S(w,I,N){var k,z=this._iv;z?(k=z,this._iv=t):k=this._prevBlock;for(var V=0;V<N;V++)w[I+V]^=k[V]}return _}(),C=n.pad={},A=C.Pkcs7={pad:function(_,S){for(var w=S*4,I=w-_.sigBytes%w,N=I<<24|I<<16|I<<8|I,k=[],z=0;z<I;z+=4)k.push(N);var V=r.create(k,I);_.concat(V)},unpad:function(_){var S=_.words[_.sigBytes-1>>>2]&255;_.sigBytes-=S}},T=i.BlockCipher=p.extend({cfg:p.cfg.extend({mode:b,padding:A}),reset:function(){var _;p.reset.call(this);var S=this.cfg,w=S.iv,I=S.mode;this._xformMode==this._ENC_XFORM_MODE?_=I.createEncryptor:(_=I.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==_?this._mode.init(this,w&&w.words):(this._mode=_.call(I,this,w&&w.words),this._mode.__creator=_)},_doProcessBlock:function(_,S){this._mode.processBlock(_,S)},_doFinalize:function(){var _,S=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(S.pad(this._data,this.blockSize),_=this._process(!0)):(_=this._process(!0),S.unpad(_)),_},blockSize:128/32}),E=i.CipherParams=o.extend({init:function(_){this.mixIn(_)},toString:function(_){return(_||this.formatter).stringify(this)}}),v=n.format={},D=v.OpenSSL={stringify:function(_){var S,w=_.ciphertext,I=_.salt;return I?S=r.create([1398893684,1701076831]).concat(I).concat(w):S=w,S.toString(l)},parse:function(_){var S,w=l.parse(_),I=w.words;return I[0]==1398893684&&I[1]==1701076831&&(S=r.create(I.slice(2,4)),I.splice(0,4),w.sigBytes-=16),E.create({ciphertext:w,salt:S})}},O=i.SerializableCipher=o.extend({cfg:o.extend({format:D}),encrypt:function(_,S,w,I){I=this.cfg.extend(I);var N=_.createEncryptor(w,I),k=N.finalize(S),z=N.cfg;return E.create({ciphertext:k,key:w,iv:z.iv,algorithm:_,mode:z.mode,padding:z.padding,blockSize:_.blockSize,formatter:I.format})},decrypt:function(_,S,w,I){I=this.cfg.extend(I),S=this._parse(S,I.format);var N=_.createDecryptor(w,I).finalize(S.ciphertext);return N},_parse:function(_,S){return typeof _=="string"?S.parse(_,this):_}}),P=n.kdf={},M=P.OpenSSL={execute:function(_,S,w,I,N){if(I||(I=r.random(64/8)),N)var k=d.create({keySize:S+w,hasher:N}).compute(_,I);else var k=d.create({keySize:S+w}).compute(_,I);var z=r.create(k.words.slice(S),w*4);return k.sigBytes=S*4,E.create({key:k,iv:z,salt:I})}},L=i.PasswordBasedCipher=O.extend({cfg:O.cfg.extend({kdf:M}),encrypt:function(_,S,w,I){I=this.cfg.extend(I);var N=I.kdf.execute(w,_.keySize,_.ivSize,I.salt,I.hasher);I.iv=N.iv;var k=O.encrypt.call(this,_,S,N.key,I);return k.mixIn(N),k},decrypt:function(_,S,w,I){I=this.cfg.extend(I),S=this._parse(S,I.format);var N=I.kdf.execute(w,_.keySize,_.ivSize,S.salt,I.hasher);I.iv=N.iv;var k=O.decrypt.call(this,_,S,N.key,I);return k}})}()})});var Lle=Fn((r3,Mle)=>{(function(e,t,n){typeof r3=="object"?Mle.exports=r3=t(Bi(),Gs()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(r3,function(e){return e.mode.CFB=function(){var t=e.lib.BlockCipherMode.extend();t.Encryptor=t.extend({processBlock:function(i,o){var r=this._cipher,s=r.blockSize;n.call(this,i,o,s,r),this._prevBlock=i.slice(o,o+s)}}),t.Decryptor=t.extend({processBlock:function(i,o){var r=this._cipher,s=r.blockSize,a=i.slice(o,o+s);n.call(this,i,o,s,r),this._prevBlock=a}});function n(i,o,r,s){var a,c=this._iv;c?(a=c.slice(0),this._iv=void 0):a=this._prevBlock,s.encryptBlock(a,0);for(var l=0;l<r;l++)i[o+l]^=a[l]}return t}(),e.mode.CFB})});var Fle=Fn((s3,Nle)=>{(function(e,t,n){typeof s3=="object"?Nle.exports=s3=t(Bi(),Gs()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(s3,function(e){return e.mode.CTR=function(){var t=e.lib.BlockCipherMode.extend(),n=t.Encryptor=t.extend({processBlock:function(i,o){var r=this._cipher,s=r.blockSize,a=this._iv,c=this._counter;a&&(c=this._counter=a.slice(0),this._iv=void 0);var l=c.slice(0);r.encryptBlock(l,0),c[s-1]=c[s-1]+1|0;for(var f=0;f<s;f++)i[o+f]^=l[f]}});return t.Decryptor=n,t}(),e.mode.CTR})});var kle=Fn((a3,Ble)=>{(function(e,t,n){typeof a3=="object"?Ble.exports=a3=t(Bi(),Gs()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(a3,function(e){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return e.mode.CTRGladman=function(){var t=e.lib.BlockCipherMode.extend();function n(r){if((r>>24&255)===255){var s=r>>16&255,a=r>>8&255,c=r&255;s===255?(s=0,a===255?(a=0,c===255?c=0:++c):++a):++s,r=0,r+=s<<16,r+=a<<8,r+=c}else r+=1<<24;return r}function i(r){return(r[0]=n(r[0]))===0&&(r[1]=n(r[1])),r}var o=t.Encryptor=t.extend({processBlock:function(r,s){var a=this._cipher,c=a.blockSize,l=this._iv,f=this._counter;l&&(f=this._counter=l.slice(0),this._iv=void 0),i(f);var d=f.slice(0);a.encryptBlock(d,0);for(var p=0;p<c;p++)r[s+p]^=d[p]}});return t.Decryptor=o,t}(),e.mode.CTRGladman})});var Ule=Fn((c3,Vle)=>{(function(e,t,n){typeof c3=="object"?Vle.exports=c3=t(Bi(),Gs()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(c3,function(e){return e.mode.OFB=function(){var t=e.lib.BlockCipherMode.extend(),n=t.Encryptor=t.extend({processBlock:function(i,o){var r=this._cipher,s=r.blockSize,a=this._iv,c=this._keystream;a&&(c=this._keystream=a.slice(0),this._iv=void 0),r.encryptBlock(c,0);for(var l=0;l<s;l++)i[o+l]^=c[l]}});return t.Decryptor=n,t}(),e.mode.OFB})});var Hle=Fn((l3,zle)=>{(function(e,t,n){typeof l3=="object"?zle.exports=l3=t(Bi(),Gs()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(l3,function(e){return e.mode.ECB=function(){var t=e.lib.BlockCipherMode.extend();return t.Encryptor=t.extend({processBlock:function(n,i){this._cipher.encryptBlock(n,i)}}),t.Decryptor=t.extend({processBlock:function(n,i){this._cipher.decryptBlock(n,i)}}),t}(),e.mode.ECB})});var Wle=Fn((u3,Gle)=>{(function(e,t,n){typeof u3=="object"?Gle.exports=u3=t(Bi(),Gs()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(u3,function(e){return e.pad.AnsiX923={pad:function(t,n){var i=t.sigBytes,o=n*4,r=o-i%o,s=i+r-1;t.clamp(),t.words[s>>>2]|=r<<24-s%4*8,t.sigBytes+=r},unpad:function(t){var n=t.words[t.sigBytes-1>>>2]&255;t.sigBytes-=n}},e.pad.Ansix923})});var qle=Fn((f3,jle)=>{(function(e,t,n){typeof f3=="object"?jle.exports=f3=t(Bi(),Gs()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(f3,function(e){return e.pad.Iso10126={pad:function(t,n){var i=n*4,o=i-t.sigBytes%i;t.concat(e.lib.WordArray.random(o-1)).concat(e.lib.WordArray.create([o<<24],1))},unpad:function(t){var n=t.words[t.sigBytes-1>>>2]&255;t.sigBytes-=n}},e.pad.Iso10126})});var Xle=Fn((d3,Yle)=>{(function(e,t,n){typeof d3=="object"?Yle.exports=d3=t(Bi(),Gs()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(d3,function(e){return e.pad.Iso97971={pad:function(t,n){t.concat(e.lib.WordArray.create([2147483648],1)),e.pad.ZeroPadding.pad(t,n)},unpad:function(t){e.pad.ZeroPadding.unpad(t),t.sigBytes--}},e.pad.Iso97971})});var Zle=Fn((h3,Kle)=>{(function(e,t,n){typeof h3=="object"?Kle.exports=h3=t(Bi(),Gs()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(h3,function(e){return e.pad.ZeroPadding={pad:function(t,n){var i=n*4;t.clamp(),t.sigBytes+=i-(t.sigBytes%i||i)},unpad:function(t){for(var n=t.words,i=t.sigBytes-1,i=t.sigBytes-1;i>=0;i--)if(n[i>>>2]>>>24-i%4*8&255){t.sigBytes=i+1;break}}},e.pad.ZeroPadding})});var Qle=Fn((m3,$le)=>{(function(e,t,n){typeof m3=="object"?$le.exports=m3=t(Bi(),Gs()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(m3,function(e){return e.pad.NoPadding={pad:function(){},unpad:function(){}},e.pad.NoPadding})});var eue=Fn((p3,Jle)=>{(function(e,t,n){typeof p3=="object"?Jle.exports=p3=t(Bi(),Gs()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(p3,function(e){return function(t){var n=e,i=n.lib,o=i.CipherParams,r=n.enc,s=r.Hex,a=n.format,c=a.Hex={stringify:function(l){return l.ciphertext.toString(s)},parse:function(l){var f=s.parse(l);return o.create({ciphertext:f})}}}(),e.format.Hex})});var nue=Fn((_3,tue)=>{(function(e,t,n){typeof _3=="object"?tue.exports=_3=t(Bi(),Yg(),Xg(),Gp(),Gs()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(_3,function(e){return function(){var t=e,n=t.lib,i=n.BlockCipher,o=t.algo,r=[],s=[],a=[],c=[],l=[],f=[],d=[],p=[],g=[],m=[];(function(){for(var C=[],A=0;A<256;A++)A<128?C[A]=A<<1:C[A]=A<<1^283;for(var T=0,E=0,A=0;A<256;A++){var v=E^E<<1^E<<2^E<<3^E<<4;v=v>>>8^v&255^99,r[T]=v,s[v]=T;var D=C[T],O=C[D],P=C[O],M=C[v]*257^v*16843008;a[T]=M<<24|M>>>8,c[T]=M<<16|M>>>16,l[T]=M<<8|M>>>24,f[T]=M;var M=P*16843009^O*65537^D*257^T*16843008;d[v]=M<<24|M>>>8,p[v]=M<<16|M>>>16,g[v]=M<<8|M>>>24,m[v]=M,T?(T=D^C[C[C[P^D]]],E^=C[C[E]]):T=E=1}})();var y=[0,1,2,4,8,16,32,64,128,27,54],b=o.AES=i.extend({_doReset:function(){var C;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var A=this._keyPriorReset=this._key,T=A.words,E=A.sigBytes/4,v=this._nRounds=E+6,D=(v+1)*4,O=this._keySchedule=[],P=0;P<D;P++)P<E?O[P]=T[P]:(C=O[P-1],P%E?E>6&&P%E==4&&(C=r[C>>>24]<<24|r[C>>>16&255]<<16|r[C>>>8&255]<<8|r[C&255]):(C=C<<8|C>>>24,C=r[C>>>24]<<24|r[C>>>16&255]<<16|r[C>>>8&255]<<8|r[C&255],C^=y[P/E|0]<<24),O[P]=O[P-E]^C);for(var M=this._invKeySchedule=[],L=0;L<D;L++){var P=D-L;if(L%4)var C=O[P];else var C=O[P-4];L<4||P<=4?M[L]=C:M[L]=d[r[C>>>24]]^p[r[C>>>16&255]]^g[r[C>>>8&255]]^m[r[C&255]]}}},encryptBlock:function(C,A){this._doCryptBlock(C,A,this._keySchedule,a,c,l,f,r)},decryptBlock:function(C,A){var T=C[A+1];C[A+1]=C[A+3],C[A+3]=T,this._doCryptBlock(C,A,this._invKeySchedule,d,p,g,m,s);var T=C[A+1];C[A+1]=C[A+3],C[A+3]=T},_doCryptBlock:function(C,A,T,E,v,D,O,P){for(var M=this._nRounds,L=C[A]^T[0],_=C[A+1]^T[1],S=C[A+2]^T[2],w=C[A+3]^T[3],I=4,N=1;N<M;N++){var k=E[L>>>24]^v[_>>>16&255]^D[S>>>8&255]^O[w&255]^T[I++],z=E[_>>>24]^v[S>>>16&255]^D[w>>>8&255]^O[L&255]^T[I++],V=E[S>>>24]^v[w>>>16&255]^D[L>>>8&255]^O[_&255]^T[I++],U=E[w>>>24]^v[L>>>16&255]^D[_>>>8&255]^O[S&255]^T[I++];L=k,_=z,S=V,w=U}var k=(P[L>>>24]<<24|P[_>>>16&255]<<16|P[S>>>8&255]<<8|P[w&255])^T[I++],z=(P[_>>>24]<<24|P[S>>>16&255]<<16|P[w>>>8&255]<<8|P[L&255])^T[I++],V=(P[S>>>24]<<24|P[w>>>16&255]<<16|P[L>>>8&255]<<8|P[_&255])^T[I++],U=(P[w>>>24]<<24|P[L>>>16&255]<<16|P[_>>>8&255]<<8|P[S&255])^T[I++];C[A]=k,C[A+1]=z,C[A+2]=V,C[A+3]=U},keySize:256/32});t.AES=i._createHelper(b)}(),e.AES})});var oue=Fn((g3,iue)=>{(function(e,t,n){typeof g3=="object"?iue.exports=g3=t(Bi(),Yg(),Xg(),Gp(),Gs()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(g3,function(e){return function(){var t=e,n=t.lib,i=n.WordArray,o=n.BlockCipher,r=t.algo,s=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],l=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],f=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=r.DES=o.extend({_doReset:function(){for(var y=this._key,b=y.words,C=[],A=0;A<56;A++){var T=s[A]-1;C[A]=b[T>>>5]>>>31-T%32&1}for(var E=this._subKeys=[],v=0;v<16;v++){for(var D=E[v]=[],O=c[v],A=0;A<24;A++)D[A/6|0]|=C[(a[A]-1+O)%28]<<31-A%6,D[4+(A/6|0)]|=C[28+(a[A+24]-1+O)%28]<<31-A%6;D[0]=D[0]<<1|D[0]>>>31;for(var A=1;A<7;A++)D[A]=D[A]>>>(A-1)*4+3;D[7]=D[7]<<5|D[7]>>>27}for(var P=this._invSubKeys=[],A=0;A<16;A++)P[A]=E[15-A]},encryptBlock:function(y,b){this._doCryptBlock(y,b,this._subKeys)},decryptBlock:function(y,b){this._doCryptBlock(y,b,this._invSubKeys)},_doCryptBlock:function(y,b,C){this._lBlock=y[b],this._rBlock=y[b+1],p.call(this,4,252645135),p.call(this,16,65535),g.call(this,2,858993459),g.call(this,8,16711935),p.call(this,1,1431655765);for(var A=0;A<16;A++){for(var T=C[A],E=this._lBlock,v=this._rBlock,D=0,O=0;O<8;O++)D|=l[O][((v^T[O])&f[O])>>>0];this._lBlock=v,this._rBlock=E^D}var P=this._lBlock;this._lBlock=this._rBlock,this._rBlock=P,p.call(this,1,1431655765),g.call(this,8,16711935),g.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),y[b]=this._lBlock,y[b+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function p(y,b){var C=(this._lBlock>>>y^this._rBlock)&b;this._rBlock^=C,this._lBlock^=C<<y}function g(y,b){var C=(this._rBlock>>>y^this._lBlock)&b;this._lBlock^=C,this._rBlock^=C<<y}t.DES=o._createHelper(d);var m=r.TripleDES=o.extend({_doReset:function(){var y=this._key,b=y.words;if(b.length!==2&&b.length!==4&&b.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var C=b.slice(0,2),A=b.length<4?b.slice(0,2):b.slice(2,4),T=b.length<6?b.slice(0,2):b.slice(4,6);this._des1=d.createEncryptor(i.create(C)),this._des2=d.createEncryptor(i.create(A)),this._des3=d.createEncryptor(i.create(T))},encryptBlock:function(y,b){this._des1.encryptBlock(y,b),this._des2.decryptBlock(y,b),this._des3.encryptBlock(y,b)},decryptBlock:function(y,b){this._des3.decryptBlock(y,b),this._des2.encryptBlock(y,b),this._des1.decryptBlock(y,b)},keySize:192/32,ivSize:64/32,blockSize:64/32});t.TripleDES=o._createHelper(m)}(),e.TripleDES})});var sue=Fn((y3,rue)=>{(function(e,t,n){typeof y3=="object"?rue.exports=y3=t(Bi(),Yg(),Xg(),Gp(),Gs()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(y3,function(e){return function(){var t=e,n=t.lib,i=n.StreamCipher,o=t.algo,r=o.RC4=i.extend({_doReset:function(){for(var c=this._key,l=c.words,f=c.sigBytes,d=this._S=[],p=0;p<256;p++)d[p]=p;for(var p=0,g=0;p<256;p++){var m=p%f,y=l[m>>>2]>>>24-m%4*8&255;g=(g+d[p]+y)%256;var b=d[p];d[p]=d[g],d[g]=b}this._i=this._j=0},_doProcessBlock:function(c,l){c[l]^=s.call(this)},keySize:256/32,ivSize:0});function s(){for(var c=this._S,l=this._i,f=this._j,d=0,p=0;p<4;p++){l=(l+1)%256,f=(f+c[l])%256;var g=c[l];c[l]=c[f],c[f]=g,d|=c[(c[l]+c[f])%256]<<24-p*8}return this._i=l,this._j=f,d}t.RC4=i._createHelper(r);var a=o.RC4Drop=r.extend({cfg:r.cfg.extend({drop:192}),_doReset:function(){r._doReset.call(this);for(var c=this.cfg.drop;c>0;c--)s.call(this)}});t.RC4Drop=i._createHelper(a)}(),e.RC4})});var cue=Fn((x3,aue)=>{(function(e,t,n){typeof x3=="object"?aue.exports=x3=t(Bi(),Yg(),Xg(),Gp(),Gs()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(x3,function(e){return function(){var t=e,n=t.lib,i=n.StreamCipher,o=t.algo,r=[],s=[],a=[],c=o.Rabbit=i.extend({_doReset:function(){for(var f=this._key.words,d=this.cfg.iv,p=0;p<4;p++)f[p]=(f[p]<<8|f[p]>>>24)&16711935|(f[p]<<24|f[p]>>>8)&4278255360;var g=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],m=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var p=0;p<4;p++)l.call(this);for(var p=0;p<8;p++)m[p]^=g[p+4&7];if(d){var y=d.words,b=y[0],C=y[1],A=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,T=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,E=A>>>16|T&4294901760,v=T<<16|A&65535;m[0]^=A,m[1]^=E,m[2]^=T,m[3]^=v,m[4]^=A,m[5]^=E,m[6]^=T,m[7]^=v;for(var p=0;p<4;p++)l.call(this)}},_doProcessBlock:function(f,d){var p=this._X;l.call(this),r[0]=p[0]^p[5]>>>16^p[3]<<16,r[1]=p[2]^p[7]>>>16^p[5]<<16,r[2]=p[4]^p[1]>>>16^p[7]<<16,r[3]=p[6]^p[3]>>>16^p[1]<<16;for(var g=0;g<4;g++)r[g]=(r[g]<<8|r[g]>>>24)&16711935|(r[g]<<24|r[g]>>>8)&4278255360,f[d+g]^=r[g]},blockSize:128/32,ivSize:64/32});function l(){for(var f=this._X,d=this._C,p=0;p<8;p++)s[p]=d[p];d[0]=d[0]+1295307597+this._b|0,d[1]=d[1]+3545052371+(d[0]>>>0<s[0]>>>0?1:0)|0,d[2]=d[2]+886263092+(d[1]>>>0<s[1]>>>0?1:0)|0,d[3]=d[3]+1295307597+(d[2]>>>0<s[2]>>>0?1:0)|0,d[4]=d[4]+3545052371+(d[3]>>>0<s[3]>>>0?1:0)|0,d[5]=d[5]+886263092+(d[4]>>>0<s[4]>>>0?1:0)|0,d[6]=d[6]+1295307597+(d[5]>>>0<s[5]>>>0?1:0)|0,d[7]=d[7]+3545052371+(d[6]>>>0<s[6]>>>0?1:0)|0,this._b=d[7]>>>0<s[7]>>>0?1:0;for(var p=0;p<8;p++){var g=f[p]+d[p],m=g&65535,y=g>>>16,b=((m*m>>>17)+m*y>>>15)+y*y,C=((g&4294901760)*g|0)+((g&65535)*g|0);a[p]=b^C}f[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,f[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,f[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,f[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,f[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,f[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,f[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,f[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}t.Rabbit=i._createHelper(c)}(),e.Rabbit})});var uue=Fn((b3,lue)=>{(function(e,t,n){typeof b3=="object"?lue.exports=b3=t(Bi(),Yg(),Xg(),Gp(),Gs()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(b3,function(e){return function(){var t=e,n=t.lib,i=n.StreamCipher,o=t.algo,r=[],s=[],a=[],c=o.RabbitLegacy=i.extend({_doReset:function(){var f=this._key.words,d=this.cfg.iv,p=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],g=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var m=0;m<4;m++)l.call(this);for(var m=0;m<8;m++)g[m]^=p[m+4&7];if(d){var y=d.words,b=y[0],C=y[1],A=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,T=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,E=A>>>16|T&4294901760,v=T<<16|A&65535;g[0]^=A,g[1]^=E,g[2]^=T,g[3]^=v,g[4]^=A,g[5]^=E,g[6]^=T,g[7]^=v;for(var m=0;m<4;m++)l.call(this)}},_doProcessBlock:function(f,d){var p=this._X;l.call(this),r[0]=p[0]^p[5]>>>16^p[3]<<16,r[1]=p[2]^p[7]>>>16^p[5]<<16,r[2]=p[4]^p[1]>>>16^p[7]<<16,r[3]=p[6]^p[3]>>>16^p[1]<<16;for(var g=0;g<4;g++)r[g]=(r[g]<<8|r[g]>>>24)&16711935|(r[g]<<24|r[g]>>>8)&4278255360,f[d+g]^=r[g]},blockSize:128/32,ivSize:64/32});function l(){for(var f=this._X,d=this._C,p=0;p<8;p++)s[p]=d[p];d[0]=d[0]+1295307597+this._b|0,d[1]=d[1]+3545052371+(d[0]>>>0<s[0]>>>0?1:0)|0,d[2]=d[2]+886263092+(d[1]>>>0<s[1]>>>0?1:0)|0,d[3]=d[3]+1295307597+(d[2]>>>0<s[2]>>>0?1:0)|0,d[4]=d[4]+3545052371+(d[3]>>>0<s[3]>>>0?1:0)|0,d[5]=d[5]+886263092+(d[4]>>>0<s[4]>>>0?1:0)|0,d[6]=d[6]+1295307597+(d[5]>>>0<s[5]>>>0?1:0)|0,d[7]=d[7]+3545052371+(d[6]>>>0<s[6]>>>0?1:0)|0,this._b=d[7]>>>0<s[7]>>>0?1:0;for(var p=0;p<8;p++){var g=f[p]+d[p],m=g&65535,y=g>>>16,b=((m*m>>>17)+m*y>>>15)+y*y,C=((g&4294901760)*g|0)+((g&65535)*g|0);a[p]=b^C}f[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,f[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,f[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,f[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,f[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,f[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,f[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,f[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}t.RabbitLegacy=i._createHelper(c)}(),e.RabbitLegacy})});var due=Fn((C3,fue)=>{(function(e,t,n){typeof C3=="object"?fue.exports=C3=t(Bi(),Yg(),Xg(),Gp(),Gs()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(C3,function(e){return function(){var t=e,n=t.lib,i=n.BlockCipher,o=t.algo;let r=16,s=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],a=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var c={pbox:[],sbox:[]};function l(m,y){let b=y>>24&255,C=y>>16&255,A=y>>8&255,T=y&255,E=m.sbox[0][b]+m.sbox[1][C];return E=E^m.sbox[2][A],E=E+m.sbox[3][T],E}function f(m,y,b){let C=y,A=b,T;for(let E=0;E<r;++E)C=C^m.pbox[E],A=l(m,C)^A,T=C,C=A,A=T;return T=C,C=A,A=T,A=A^m.pbox[r],C=C^m.pbox[r+1],{left:C,right:A}}function d(m,y,b){let C=y,A=b,T;for(let E=r+1;E>1;--E)C=C^m.pbox[E],A=l(m,C)^A,T=C,C=A,A=T;return T=C,C=A,A=T,A=A^m.pbox[1],C=C^m.pbox[0],{left:C,right:A}}function p(m,y,b){for(let v=0;v<4;v++){m.sbox[v]=[];for(let D=0;D<256;D++)m.sbox[v][D]=a[v][D]}let C=0;for(let v=0;v<r+2;v++)m.pbox[v]=s[v]^y[C],C++,C>=b&&(C=0);let A=0,T=0,E=0;for(let v=0;v<r+2;v+=2)E=f(m,A,T),A=E.left,T=E.right,m.pbox[v]=A,m.pbox[v+1]=T;for(let v=0;v<4;v++)for(let D=0;D<256;D+=2)E=f(m,A,T),A=E.left,T=E.right,m.sbox[v][D]=A,m.sbox[v][D+1]=T;return!0}var g=o.Blowfish=i.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var m=this._keyPriorReset=this._key,y=m.words,b=m.sigBytes/4;p(c,y,b)}},encryptBlock:function(m,y){var b=f(c,m[y],m[y+1]);m[y]=b.left,m[y+1]=b.right},decryptBlock:function(m,y){var b=d(c,m[y],m[y+1]);m[y]=b.left,m[y+1]=b.right},blockSize:64/32,keySize:128/32,ivSize:64/32});t.Blowfish=i._createHelper(g)}(),e.Blowfish})});var mue=Fn((A3,hue)=>{(function(e,t,n){typeof A3=="object"?hue.exports=A3=t(Bi(),Xw(),ule(),dle(),Yg(),ple(),Xg(),Y7(),XB(),ble(),X7(),Tle(),Sle(),wle(),t3(),Ple(),Gp(),Gs(),Lle(),Fle(),kle(),Ule(),Hle(),Wle(),qle(),Xle(),Zle(),Qle(),eue(),nue(),oue(),sue(),cue(),uue(),due()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./lib-typedarrays","./enc-utf16","./enc-base64","./enc-base64url","./md5","./sha1","./sha256","./sha224","./sha512","./sha384","./sha3","./ripemd160","./hmac","./pbkdf2","./evpkdf","./cipher-core","./mode-cfb","./mode-ctr","./mode-ctr-gladman","./mode-ofb","./mode-ecb","./pad-ansix923","./pad-iso10126","./pad-iso97971","./pad-zeropadding","./pad-nopadding","./format-hex","./aes","./tripledes","./rc4","./rabbit","./rabbit-legacy","./blowfish"],t):e.CryptoJS=t(e.CryptoJS)})(A3,function(e){return e})});var rme=Fn((cq,lq)=>{(function(e,t){typeof cq=="object"&&typeof lq<"u"?lq.exports=t():typeof define=="function"&&define.amd?define(t):(e=e||self).RBush=t()})(cq,function(){"use strict";function e(b,C,A,T,E){(function v(D,O,P,M,L){for(;M>P;){if(M-P>600){var _=M-P+1,S=O-P+1,w=Math.log(_),I=.5*Math.exp(2*w/3),N=.5*Math.sqrt(w*I*(_-I)/_)*(S-_/2<0?-1:1),k=Math.max(P,Math.floor(O-S*I/_+N)),z=Math.min(M,Math.floor(O+(_-S)*I/_+N));v(D,O,k,z,L)}var V=D[O],U=P,B=M;for(t(D,P,O),L(D[M],V)>0&&t(D,P,M);U<B;){for(t(D,U,B),U++,B--;L(D[U],V)<0;)U++;for(;L(D[B],V)>0;)B--}L(D[P],V)===0?t(D,P,B):t(D,++B,M),B<=O&&(P=B+1),O<=B&&(M=B-1)}})(b,C,A||0,T||b.length-1,E||n)}function t(b,C,A){var T=b[C];b[C]=b[A],b[A]=T}function n(b,C){return b<C?-1:b>C?1:0}var i=function(b){b===void 0&&(b=9),this._maxEntries=Math.max(4,b),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function o(b,C,A){if(!A)return C.indexOf(b);for(var T=0;T<C.length;T++)if(A(b,C[T]))return T;return-1}function r(b,C){s(b,0,b.children.length,C,b)}function s(b,C,A,T,E){E||(E=m(null)),E.minX=1/0,E.minY=1/0,E.maxX=-1/0,E.maxY=-1/0;for(var v=C;v<A;v++){var D=b.children[v];a(E,b.leaf?T(D):D)}return E}function a(b,C){return b.minX=Math.min(b.minX,C.minX),b.minY=Math.min(b.minY,C.minY),b.maxX=Math.max(b.maxX,C.maxX),b.maxY=Math.max(b.maxY,C.maxY),b}function c(b,C){return b.minX-C.minX}function l(b,C){return b.minY-C.minY}function f(b){return(b.maxX-b.minX)*(b.maxY-b.minY)}function d(b){return b.maxX-b.minX+(b.maxY-b.minY)}function p(b,C){return b.minX<=C.minX&&b.minY<=C.minY&&C.maxX<=b.maxX&&C.maxY<=b.maxY}function g(b,C){return C.minX<=b.maxX&&C.minY<=b.maxY&&C.maxX>=b.minX&&C.maxY>=b.minY}function m(b){return{children:b,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function y(b,C,A,T,E){for(var v=[C,A];v.length;)if(!((A=v.pop())-(C=v.pop())<=T)){var D=C+Math.ceil((A-C)/T/2)*T;e(b,D,C,A,E),v.push(C,D,D,A)}}return i.prototype.all=function(){return this._all(this.data,[])},i.prototype.search=function(b){var C=this.data,A=[];if(!g(b,C))return A;for(var T=this.toBBox,E=[];C;){for(var v=0;v<C.children.length;v++){var D=C.children[v],O=C.leaf?T(D):D;g(b,O)&&(C.leaf?A.push(D):p(b,O)?this._all(D,A):E.push(D))}C=E.pop()}return A},i.prototype.collides=function(b){var C=this.data;if(!g(b,C))return!1;for(var A=[];C;){for(var T=0;T<C.children.length;T++){var E=C.children[T],v=C.leaf?this.toBBox(E):E;if(g(b,v)){if(C.leaf||p(b,v))return!0;A.push(E)}}C=A.pop()}return!1},i.prototype.load=function(b){if(!b||!b.length)return this;if(b.length<this._minEntries){for(var C=0;C<b.length;C++)this.insert(b[C]);return this}var A=this._build(b.slice(),0,b.length-1,0);if(this.data.children.length)if(this.data.height===A.height)this._splitRoot(this.data,A);else{if(this.data.height<A.height){var T=this.data;this.data=A,A=T}this._insert(A,this.data.height-A.height-1,!0)}else this.data=A;return this},i.prototype.insert=function(b){return b&&this._insert(b,this.data.height-1),this},i.prototype.clear=function(){return this.data=m([]),this},i.prototype.remove=function(b,C){if(!b)return this;for(var A,T,E,v=this.data,D=this.toBBox(b),O=[],P=[];v||O.length;){if(v||(v=O.pop(),T=O[O.length-1],A=P.pop(),E=!0),v.leaf){var M=o(b,v.children,C);if(M!==-1)return v.children.splice(M,1),O.push(v),this._condense(O),this}E||v.leaf||!p(v,D)?T?(A++,v=T.children[A],E=!1):v=null:(O.push(v),P.push(A),A=0,T=v,v=v.children[0])}return this},i.prototype.toBBox=function(b){return b},i.prototype.compareMinX=function(b,C){return b.minX-C.minX},i.prototype.compareMinY=function(b,C){return b.minY-C.minY},i.prototype.toJSON=function(){return this.data},i.prototype.fromJSON=function(b){return this.data=b,this},i.prototype._all=function(b,C){for(var A=[];b;)b.leaf?C.push.apply(C,b.children):A.push.apply(A,b.children),b=A.pop();return C},i.prototype._build=function(b,C,A,T){var E,v=A-C+1,D=this._maxEntries;if(v<=D)return r(E=m(b.slice(C,A+1)),this.toBBox),E;T||(T=Math.ceil(Math.log(v)/Math.log(D)),D=Math.ceil(v/Math.pow(D,T-1))),(E=m([])).leaf=!1,E.height=T;var O=Math.ceil(v/D),P=O*Math.ceil(Math.sqrt(D));y(b,C,A,P,this.compareMinX);for(var M=C;M<=A;M+=P){var L=Math.min(M+P-1,A);y(b,M,L,O,this.compareMinY);for(var _=M;_<=L;_+=O){var S=Math.min(_+O-1,L);E.children.push(this._build(b,_,S,T-1))}}return r(E,this.toBBox),E},i.prototype._chooseSubtree=function(b,C,A,T){for(;T.push(C),!C.leaf&&T.length-1!==A;){for(var E=1/0,v=1/0,D=void 0,O=0;O<C.children.length;O++){var P=C.children[O],M=f(P),L=(_=b,S=P,(Math.max(S.maxX,_.maxX)-Math.min(S.minX,_.minX))*(Math.max(S.maxY,_.maxY)-Math.min(S.minY,_.minY))-M);L<v?(v=L,E=M<E?M:E,D=P):L===v&&M<E&&(E=M,D=P)}C=D||C.children[0]}var _,S;return C},i.prototype._insert=function(b,C,A){var T=A?b:this.toBBox(b),E=[],v=this._chooseSubtree(T,this.data,C,E);for(v.children.push(b),a(v,T);C>=0&&E[C].children.length>this._maxEntries;)this._split(E,C),C--;this._adjustParentBBoxes(T,E,C)},i.prototype._split=function(b,C){var A=b[C],T=A.children.length,E=this._minEntries;this._chooseSplitAxis(A,E,T);var v=this._chooseSplitIndex(A,E,T),D=m(A.children.splice(v,A.children.length-v));D.height=A.height,D.leaf=A.leaf,r(A,this.toBBox),r(D,this.toBBox),C?b[C-1].children.push(D):this._splitRoot(A,D)},i.prototype._splitRoot=function(b,C){this.data=m([b,C]),this.data.height=b.height+1,this.data.leaf=!1,r(this.data,this.toBBox)},i.prototype._chooseSplitIndex=function(b,C,A){for(var T,E,v,D,O,P,M,L=1/0,_=1/0,S=C;S<=A-C;S++){var w=s(b,0,S,this.toBBox),I=s(b,S,A,this.toBBox),N=(E=w,v=I,D=void 0,O=void 0,P=void 0,M=void 0,D=Math.max(E.minX,v.minX),O=Math.max(E.minY,v.minY),P=Math.min(E.maxX,v.maxX),M=Math.min(E.maxY,v.maxY),Math.max(0,P-D)*Math.max(0,M-O)),k=f(w)+f(I);N<L?(L=N,T=S,_=k<_?k:_):N===L&&k<_&&(_=k,T=S)}return T||A-C},i.prototype._chooseSplitAxis=function(b,C,A){var T=b.leaf?this.compareMinX:c,E=b.leaf?this.compareMinY:l;this._allDistMargin(b,C,A,T)<this._allDistMargin(b,C,A,E)&&b.children.sort(T)},i.prototype._allDistMargin=function(b,C,A,T){b.children.sort(T);for(var E=this.toBBox,v=s(b,0,C,E),D=s(b,A-C,A,E),O=d(v)+d(D),P=C;P<A-C;P++){var M=b.children[P];a(v,b.leaf?E(M):M),O+=d(v)}for(var L=A-C-1;L>=C;L--){var _=b.children[L];a(D,b.leaf?E(_):_),O+=d(D)}return O},i.prototype._adjustParentBBoxes=function(b,C,A){for(var T=A;T>=0;T--)a(C[T],b)},i.prototype._condense=function(b){for(var C=b.length-1,A=void 0;C>=0;C--)b[C].children.length===0?C>0?(A=b[C-1].children).splice(A.indexOf(b[C]),1):this.clear():r(b[C],this.toBBox)},i})});var vX=Fn((exports,module)=>{/*!
 * protobuf.js v7.4.0 (c) 2016, daniel wirtz
 * compiled thu, 22 aug 2024 20:30:39 utc
 * licensed under the bsd-3-clause license
 * see: https://github.com/dcodeio/protobuf.js for details
 */(function(undefined){"use strict";(function(t,n,i){function o(s){var a=n[s];return a||t[s][0].call(a=n[s]={exports:{}},o,a,a.exports),a.exports}var r=o(i[0]);r.util.global.protobuf=r,typeof define=="function"&&define.amd&&define(["long"],function(s){return s&&s.isLong&&(r.util.Long=s,r.configure()),r}),typeof module=="object"&&module&&module.exports&&(module.exports=r)})({1:[function(e,t,n){"use strict";t.exports=i;function i(o,r){for(var s=new Array(arguments.length-1),a=0,c=2,l=!0;c<arguments.length;)s[a++]=arguments[c++];return new Promise(function(d,p){s[a]=function(m){if(l)if(l=!1,m)p(m);else{for(var y=new Array(arguments.length-1),b=0;b<y.length;)y[b++]=arguments[b];d.apply(null,y)}};try{o.apply(r||null,s)}catch(g){l&&(l=!1,p(g))}})}},{}],2:[function(e,t,n){"use strict";var i=n;i.length=function(l){var f=l.length;if(!f)return 0;for(var d=0;--f%4>1&&l.charAt(f)==="=";)++d;return Math.ceil(l.length*3)/4-d};for(var o=new Array(64),r=new Array(123),s=0;s<64;)r[o[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;i.encode=function(l,f,d){for(var p=null,g=[],m=0,y=0,b;f<d;){var C=l[f++];switch(y){case 0:g[m++]=o[C>>2],b=(C&3)<<4,y=1;break;case 1:g[m++]=o[b|C>>4],b=(C&15)<<2,y=2;break;case 2:g[m++]=o[b|C>>6],g[m++]=o[C&63],y=0;break}m>8191&&((p||(p=[])).push(String.fromCharCode.apply(String,g)),m=0)}return y&&(g[m++]=o[b],g[m++]=61,y===1&&(g[m++]=61)),p?(m&&p.push(String.fromCharCode.apply(String,g.slice(0,m))),p.join("")):String.fromCharCode.apply(String,g.slice(0,m))};var a="invalid encoding";i.decode=function(l,f,d){for(var p=d,g=0,m,y=0;y<l.length;){var b=l.charCodeAt(y++);if(b===61&&g>1)break;if((b=r[b])===undefined)throw Error(a);switch(g){case 0:m=b,g=1;break;case 1:f[d++]=m<<2|(b&48)>>4,m=b,g=2;break;case 2:f[d++]=(m&15)<<4|(b&60)>>2,m=b,g=3;break;case 3:f[d++]=(m&3)<<6|b,g=0;break}}if(g===1)throw Error(a);return d-p},i.test=function(l){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(l)}},{}],3:[function(e,t,n){"use strict";t.exports=i;function i(){this._listeners={}}i.prototype.on=function(r,s,a){return(this._listeners[r]||(this._listeners[r]=[])).push({fn:s,ctx:a||this}),this},i.prototype.off=function(r,s){if(r===undefined)this._listeners={};else if(s===undefined)this._listeners[r]=[];else for(var a=this._listeners[r],c=0;c<a.length;)a[c].fn===s?a.splice(c,1):++c;return this},i.prototype.emit=function(r){var s=this._listeners[r];if(s){for(var a=[],c=1;c<arguments.length;)a.push(arguments[c++]);for(c=0;c<s.length;)s[c].fn.apply(s[c++].ctx,a)}return this}},{}],4:[function(e,t,n){"use strict";t.exports=i(i);function i(c){return typeof Float32Array<"u"?function(){var l=new Float32Array([-0]),f=new Uint8Array(l.buffer),d=f[3]===128;function p(b,C,A){l[0]=b,C[A]=f[0],C[A+1]=f[1],C[A+2]=f[2],C[A+3]=f[3]}function g(b,C,A){l[0]=b,C[A]=f[3],C[A+1]=f[2],C[A+2]=f[1],C[A+3]=f[0]}c.writeFloatLE=d?p:g,c.writeFloatBE=d?g:p;function m(b,C){return f[0]=b[C],f[1]=b[C+1],f[2]=b[C+2],f[3]=b[C+3],l[0]}function y(b,C){return f[3]=b[C],f[2]=b[C+1],f[1]=b[C+2],f[0]=b[C+3],l[0]}c.readFloatLE=d?m:y,c.readFloatBE=d?y:m}():function(){function l(d,p,g,m){var y=p<0?1:0;if(y&&(p=-p),p===0)d(1/p>0?0:2147483648,g,m);else if(isNaN(p))d(2143289344,g,m);else if(p>34028234663852886e22)d((y<<31|2139095040)>>>0,g,m);else if(p<11754943508222875e-54)d((y<<31|Math.round(p/1401298464324817e-60))>>>0,g,m);else{var b=Math.floor(Math.log(p)/Math.LN2),C=Math.round(p*Math.pow(2,-b)*8388608)&8388607;d((y<<31|b+127<<23|C)>>>0,g,m)}}c.writeFloatLE=l.bind(null,o),c.writeFloatBE=l.bind(null,r);function f(d,p,g){var m=d(p,g),y=(m>>31)*2+1,b=m>>>23&255,C=m&8388607;return b===255?C?NaN:y*(1/0):b===0?y*1401298464324817e-60*C:y*Math.pow(2,b-150)*(C+8388608)}c.readFloatLE=f.bind(null,s),c.readFloatBE=f.bind(null,a)}(),typeof Float64Array<"u"?function(){var l=new Float64Array([-0]),f=new Uint8Array(l.buffer),d=f[7]===128;function p(b,C,A){l[0]=b,C[A]=f[0],C[A+1]=f[1],C[A+2]=f[2],C[A+3]=f[3],C[A+4]=f[4],C[A+5]=f[5],C[A+6]=f[6],C[A+7]=f[7]}function g(b,C,A){l[0]=b,C[A]=f[7],C[A+1]=f[6],C[A+2]=f[5],C[A+3]=f[4],C[A+4]=f[3],C[A+5]=f[2],C[A+6]=f[1],C[A+7]=f[0]}c.writeDoubleLE=d?p:g,c.writeDoubleBE=d?g:p;function m(b,C){return f[0]=b[C],f[1]=b[C+1],f[2]=b[C+2],f[3]=b[C+3],f[4]=b[C+4],f[5]=b[C+5],f[6]=b[C+6],f[7]=b[C+7],l[0]}function y(b,C){return f[7]=b[C],f[6]=b[C+1],f[5]=b[C+2],f[4]=b[C+3],f[3]=b[C+4],f[2]=b[C+5],f[1]=b[C+6],f[0]=b[C+7],l[0]}c.readDoubleLE=d?m:y,c.readDoubleBE=d?y:m}():function(){function l(d,p,g,m,y,b){var C=m<0?1:0;if(C&&(m=-m),m===0)d(0,y,b+p),d(1/m>0?0:2147483648,y,b+g);else if(isNaN(m))d(0,y,b+p),d(2146959360,y,b+g);else if(m>17976931348623157e292)d(0,y,b+p),d((C<<31|2146435072)>>>0,y,b+g);else{var A;if(m<22250738585072014e-324)A=m/5e-324,d(A>>>0,y,b+p),d((C<<31|A/4294967296)>>>0,y,b+g);else{var T=Math.floor(Math.log(m)/Math.LN2);T===1024&&(T=1023),A=m*Math.pow(2,-T),d(A*4503599627370496>>>0,y,b+p),d((C<<31|T+1023<<20|A*1048576&1048575)>>>0,y,b+g)}}}c.writeDoubleLE=l.bind(null,o,0,4),c.writeDoubleBE=l.bind(null,r,4,0);function f(d,p,g,m,y){var b=d(m,y+p),C=d(m,y+g),A=(C>>31)*2+1,T=C>>>20&2047,E=4294967296*(C&1048575)+b;return T===2047?E?NaN:A*(1/0):T===0?A*5e-324*E:A*Math.pow(2,T-1075)*(E+4503599627370496)}c.readDoubleLE=f.bind(null,s,0,4),c.readDoubleBE=f.bind(null,a,4,0)}(),c}function o(c,l,f){l[f]=c&255,l[f+1]=c>>>8&255,l[f+2]=c>>>16&255,l[f+3]=c>>>24}function r(c,l,f){l[f]=c>>>24,l[f+1]=c>>>16&255,l[f+2]=c>>>8&255,l[f+3]=c&255}function s(c,l){return(c[l]|c[l+1]<<8|c[l+2]<<16|c[l+3]<<24)>>>0}function a(c,l){return(c[l]<<24|c[l+1]<<16|c[l+2]<<8|c[l+3])>>>0}},{}],5:[function(require,module,exports){"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}},{}],6:[function(e,t,n){"use strict";t.exports=i;function i(o,r,s){var a=s||8192,c=a>>>1,l=null,f=a;return function(p){if(p<1||p>c)return o(p);f+p>a&&(l=o(a),f=0);var g=r.call(l,f,f+=p);return f&7&&(f=(f|7)+1),g}}},{}],7:[function(e,t,n){"use strict";var i=n;i.length=function(r){for(var s=0,a=0,c=0;c<r.length;++c)a=r.charCodeAt(c),a<128?s+=1:a<2048?s+=2:(a&64512)===55296&&(r.charCodeAt(c+1)&64512)===56320?(++c,s+=4):s+=3;return s},i.read=function(r,s,a){var c=a-s;if(c<1)return"";for(var l=null,f=[],d=0,p;s<a;)p=r[s++],p<128?f[d++]=p:p>191&&p<224?f[d++]=(p&31)<<6|r[s++]&63:p>239&&p<365?(p=((p&7)<<18|(r[s++]&63)<<12|(r[s++]&63)<<6|r[s++]&63)-65536,f[d++]=55296+(p>>10),f[d++]=56320+(p&1023)):f[d++]=(p&15)<<12|(r[s++]&63)<<6|r[s++]&63,d>8191&&((l||(l=[])).push(String.fromCharCode.apply(String,f)),d=0);return l?(d&&l.push(String.fromCharCode.apply(String,f.slice(0,d))),l.join("")):String.fromCharCode.apply(String,f.slice(0,d))},i.write=function(r,s,a){for(var c=a,l,f,d=0;d<r.length;++d)l=r.charCodeAt(d),l<128?s[a++]=l:l<2048?(s[a++]=l>>6|192,s[a++]=l&63|128):(l&64512)===55296&&((f=r.charCodeAt(d+1))&64512)===56320?(l=65536+((l&1023)<<10)+(f&1023),++d,s[a++]=l>>18|240,s[a++]=l>>12&63|128,s[a++]=l>>6&63|128,s[a++]=l&63|128):(s[a++]=l>>12|224,s[a++]=l>>6&63|128,s[a++]=l&63|128);return a-c}},{}],8:[function(e,t,n){"use strict";var i=n;i.build="minimal",i.Writer=e(16),i.BufferWriter=e(17),i.Reader=e(9),i.BufferReader=e(10),i.util=e(15),i.rpc=e(12),i.roots=e(11),i.configure=o;function o(){i.util._configure(),i.Writer._configure(i.BufferWriter),i.Reader._configure(i.BufferReader)}o()},{10:10,11:11,12:12,15:15,16:16,17:17,9:9}],9:[function(e,t,n){"use strict";t.exports=c;var i=e(15),o,r=i.LongBits,s=i.utf8;function a(m,y){return RangeError("index out of range: "+m.pos+" + "+(y||1)+" > "+m.len)}function c(m){this.buf=m,this.pos=0,this.len=m.length}var l=typeof Uint8Array<"u"?function(y){if(y instanceof Uint8Array||Array.isArray(y))return new c(y);throw Error("illegal buffer")}:function(y){if(Array.isArray(y))return new c(y);throw Error("illegal buffer")},f=function(){return i.Buffer?function(b){return(c.create=function(A){return i.Buffer.isBuffer(A)?new o(A):l(A)})(b)}:l};c.create=f(),c.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,c.prototype.uint32=function(){var y=4294967295;return function(){if(y=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(y=(y|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(y=(y|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(y=(y|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(y=(y|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return y;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return y}}(),c.prototype.int32=function(){return this.uint32()|0},c.prototype.sint32=function(){var y=this.uint32();return y>>>1^-(y&1)|0};function d(){var m=new r(0,0),y=0;if(this.len-this.pos>4){for(;y<4;++y)if(m.lo=(m.lo|(this.buf[this.pos]&127)<<y*7)>>>0,this.buf[this.pos++]<128)return m;if(m.lo=(m.lo|(this.buf[this.pos]&127)<<28)>>>0,m.hi=(m.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return m;y=0}else{for(;y<3;++y){if(this.pos>=this.len)throw a(this);if(m.lo=(m.lo|(this.buf[this.pos]&127)<<y*7)>>>0,this.buf[this.pos++]<128)return m}return m.lo=(m.lo|(this.buf[this.pos++]&127)<<y*7)>>>0,m}if(this.len-this.pos>4){for(;y<5;++y)if(m.hi=(m.hi|(this.buf[this.pos]&127)<<y*7+3)>>>0,this.buf[this.pos++]<128)return m}else for(;y<5;++y){if(this.pos>=this.len)throw a(this);if(m.hi=(m.hi|(this.buf[this.pos]&127)<<y*7+3)>>>0,this.buf[this.pos++]<128)return m}throw Error("invalid varint encoding")}c.prototype.bool=function(){return this.uint32()!==0};function p(m,y){return(m[y-4]|m[y-3]<<8|m[y-2]<<16|m[y-1]<<24)>>>0}c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return p(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return p(this.buf,this.pos+=4)|0};function g(){if(this.pos+8>this.len)throw a(this,8);return new r(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var y=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,y},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var y=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,y},c.prototype.bytes=function(){var y=this.uint32(),b=this.pos,C=this.pos+y;if(C>this.len)throw a(this,y);if(this.pos+=y,Array.isArray(this.buf))return this.buf.slice(b,C);if(b===C){var A=i.Buffer;return A?A.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,b,C)},c.prototype.string=function(){var y=this.bytes();return s.read(y,0,y.length)},c.prototype.skip=function(y){if(typeof y=="number"){if(this.pos+y>this.len)throw a(this,y);this.pos+=y}else do if(this.pos>=this.len)throw a(this);while(this.buf[this.pos++]&128);return this},c.prototype.skipType=function(m){switch(m){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(m=this.uint32()&7)!==4;)this.skipType(m);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+m+" at offset "+this.pos)}return this},c._configure=function(m){o=m,c.create=f(),o._configure();var y=i.Long?"toLong":"toNumber";i.merge(c.prototype,{int64:function(){return d.call(this)[y](!1)},uint64:function(){return d.call(this)[y](!0)},sint64:function(){return d.call(this).zzDecode()[y](!1)},fixed64:function(){return g.call(this)[y](!0)},sfixed64:function(){return g.call(this)[y](!1)}})}},{15:15}],10:[function(e,t,n){"use strict";t.exports=r;var i=e(9);(r.prototype=Object.create(i.prototype)).constructor=r;var o=e(15);function r(s){i.call(this,s)}r._configure=function(){o.Buffer&&(r.prototype._slice=o.Buffer.prototype.slice)},r.prototype.string=function(){var a=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+a,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+a,this.len))},r._configure()},{15:15,9:9}],11:[function(e,t,n){"use strict";t.exports={}},{}],12:[function(e,t,n){"use strict";var i=n;i.Service=e(13)},{13:13}],13:[function(e,t,n){"use strict";t.exports=o;var i=e(15);(o.prototype=Object.create(i.EventEmitter.prototype)).constructor=o;function o(r,s,a){if(typeof r!="function")throw TypeError("rpcImpl must be a function");i.EventEmitter.call(this),this.rpcImpl=r,this.requestDelimited=!!s,this.responseDelimited=!!a}o.prototype.rpcCall=function r(s,a,c,l,f){if(!l)throw TypeError("request must be specified");var d=this;if(!f)return i.asPromise(r,d,s,a,c,l);if(!d.rpcImpl)return setTimeout(function(){f(Error("already ended"))},0),undefined;try{return d.rpcImpl(s,a[d.requestDelimited?"encodeDelimited":"encode"](l).finish(),function(g,m){if(g)return d.emit("error",g,s),f(g);if(m===null)return d.end(!0),undefined;if(!(m instanceof c))try{m=c[d.responseDelimited?"decodeDelimited":"decode"](m)}catch(y){return d.emit("error",y,s),f(y)}return d.emit("data",m,s),f(null,m)})}catch(p){return d.emit("error",p,s),setTimeout(function(){f(p)},0),undefined}},o.prototype.end=function(s){return this.rpcImpl&&(s||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},{15:15}],14:[function(e,t,n){"use strict";t.exports=o;var i=e(15);function o(c,l){this.lo=c>>>0,this.hi=l>>>0}var r=o.zero=new o(0,0);r.toNumber=function(){return 0},r.zzEncode=r.zzDecode=function(){return this},r.length=function(){return 1};var s=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(l){if(l===0)return r;var f=l<0;f&&(l=-l);var d=l>>>0,p=(l-d)/4294967296>>>0;return f&&(p=~p>>>0,d=~d>>>0,++d>4294967295&&(d=0,++p>4294967295&&(p=0))),new o(d,p)},o.from=function(l){if(typeof l=="number")return o.fromNumber(l);if(i.isString(l))if(i.Long)l=i.Long.fromString(l);else return o.fromNumber(parseInt(l,10));return l.low||l.high?new o(l.low>>>0,l.high>>>0):r},o.prototype.toNumber=function(l){if(!l&&this.hi>>>31){var f=~this.lo+1>>>0,d=~this.hi>>>0;return f||(d=d+1>>>0),-(f+d*4294967296)}return this.lo+this.hi*4294967296},o.prototype.toLong=function(l){return i.Long?new i.Long(this.lo|0,this.hi|0,!!l):{low:this.lo|0,high:this.hi|0,unsigned:!!l}};var a=String.prototype.charCodeAt;o.fromHash=function(l){return l===s?r:new o((a.call(l,0)|a.call(l,1)<<8|a.call(l,2)<<16|a.call(l,3)<<24)>>>0,(a.call(l,4)|a.call(l,5)<<8|a.call(l,6)<<16|a.call(l,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var l=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^l)>>>0,this.lo=(this.lo<<1^l)>>>0,this},o.prototype.zzDecode=function(){var l=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^l)>>>0,this.hi=(this.hi>>>1^l)>>>0,this},o.prototype.length=function(){var l=this.lo,f=(this.lo>>>28|this.hi<<4)>>>0,d=this.hi>>>24;return d===0?f===0?l<16384?l<128?1:2:l<2097152?3:4:f<16384?f<128?5:6:f<2097152?7:8:d<128?9:10}},{15:15}],15:[function(e,t,n){"use strict";var i=n;i.asPromise=e(1),i.base64=e(2),i.EventEmitter=e(3),i.float=e(4),i.inquire=e(5),i.utf8=e(7),i.pool=e(6),i.LongBits=e(14),i.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node),i.global=i.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||this,i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isInteger=Number.isInteger||function(a){return typeof a=="number"&&isFinite(a)&&Math.floor(a)===a},i.isString=function(a){return typeof a=="string"||a instanceof String},i.isObject=function(a){return a&&typeof a=="object"},i.isset=i.isSet=function(a,c){var l=a[c];return l!=null&&a.hasOwnProperty(c)?typeof l!="object"||(Array.isArray(l)?l.length:Object.keys(l).length)>0:!1},i.Buffer=function(){try{var s=i.inquire("buffer").Buffer;return s.prototype.utf8Write?s:null}catch{return null}}(),i._Buffer_from=null,i._Buffer_allocUnsafe=null,i.newBuffer=function(a){return typeof a=="number"?i.Buffer?i._Buffer_allocUnsafe(a):new i.Array(a):i.Buffer?i._Buffer_from(a):typeof Uint8Array>"u"?a:new Uint8Array(a)},i.Array=typeof Uint8Array<"u"?Uint8Array:Array,i.Long=i.global.dcodeIO&&i.global.dcodeIO.Long||i.global.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(a){return a?i.LongBits.from(a).toHash():i.LongBits.zeroHash},i.longFromHash=function(a,c){var l=i.LongBits.fromHash(a);return i.Long?i.Long.fromBits(l.lo,l.hi,c):l.toNumber(!!c)};function o(s,a,c){for(var l=Object.keys(a),f=0;f<l.length;++f)(s[l[f]]===undefined||!c)&&(s[l[f]]=a[l[f]]);return s}i.merge=o,i.lcFirst=function(a){return a.charAt(0).toLowerCase()+a.substring(1)};function r(s){function a(c,l){if(!(this instanceof a))return new a(c,l);Object.defineProperty(this,"message",{get:function(){return c}}),Error.captureStackTrace?Error.captureStackTrace(this,a):Object.defineProperty(this,"stack",{value:new Error().stack||""}),l&&o(this,l)}return a.prototype=Object.create(Error.prototype,{constructor:{value:a,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return s},set:undefined,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),a}i.newError=r,i.ProtocolError=r("ProtocolError"),i.oneOfGetter=function(a){for(var c={},l=0;l<a.length;++l)c[a[l]]=1;return function(){for(var f=Object.keys(this),d=f.length-1;d>-1;--d)if(c[f[d]]===1&&this[f[d]]!==undefined&&this[f[d]]!==null)return f[d]}},i.oneOfSetter=function(a){return function(c){for(var l=0;l<a.length;++l)a[l]!==c&&delete this[a[l]]}},i.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},i._configure=function(){var s=i.Buffer;if(!s){i._Buffer_from=i._Buffer_allocUnsafe=null;return}i._Buffer_from=s.from!==Uint8Array.from&&s.from||function(c,l){return new s(c,l)},i._Buffer_allocUnsafe=s.allocUnsafe||function(c){return new s(c)}}},{1:1,14:14,2:2,3:3,4:4,5:5,6:6,7:7}],16:[function(e,t,n){"use strict";t.exports=d;var i=e(15),o,r=i.LongBits,s=i.base64,a=i.utf8;function c(T,E,v){this.fn=T,this.len=E,this.next=undefined,this.val=v}function l(){}function f(T){this.head=T.head,this.tail=T.tail,this.len=T.len,this.next=T.states}function d(){this.len=0,this.head=new c(l,0,0),this.tail=this.head,this.states=null}var p=function(){return i.Buffer?function(){return(d.create=function(){return new o})()}:function(){return new d}};d.create=p(),d.alloc=function(E){return new i.Array(E)},i.Array!==Array&&(d.alloc=i.pool(d.alloc,i.Array.prototype.subarray)),d.prototype._push=function(E,v,D){return this.tail=this.tail.next=new c(E,v,D),this.len+=v,this};function g(T,E,v){E[v]=T&255}function m(T,E,v){for(;T>127;)E[v++]=T&127|128,T>>>=7;E[v]=T}function y(T,E){this.len=T,this.next=undefined,this.val=E}y.prototype=Object.create(c.prototype),y.prototype.fn=m,d.prototype.uint32=function(E){return this.len+=(this.tail=this.tail.next=new y((E=E>>>0)<128?1:E<16384?2:E<2097152?3:E<268435456?4:5,E)).len,this},d.prototype.int32=function(E){return E<0?this._push(b,10,r.fromNumber(E)):this.uint32(E)},d.prototype.sint32=function(E){return this.uint32((E<<1^E>>31)>>>0)};function b(T,E,v){for(;T.hi;)E[v++]=T.lo&127|128,T.lo=(T.lo>>>7|T.hi<<25)>>>0,T.hi>>>=7;for(;T.lo>127;)E[v++]=T.lo&127|128,T.lo=T.lo>>>7;E[v++]=T.lo}d.prototype.uint64=function(E){var v=r.from(E);return this._push(b,v.length(),v)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function(E){var v=r.from(E).zzEncode();return this._push(b,v.length(),v)},d.prototype.bool=function(E){return this._push(g,1,E?1:0)};function C(T,E,v){E[v]=T&255,E[v+1]=T>>>8&255,E[v+2]=T>>>16&255,E[v+3]=T>>>24}d.prototype.fixed32=function(E){return this._push(C,4,E>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function(E){var v=r.from(E);return this._push(C,4,v.lo)._push(C,4,v.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function(E){return this._push(i.float.writeFloatLE,4,E)},d.prototype.double=function(E){return this._push(i.float.writeDoubleLE,8,E)};var A=i.Array.prototype.set?function(E,v,D){v.set(E,D)}:function(E,v,D){for(var O=0;O<E.length;++O)v[D+O]=E[O]};d.prototype.bytes=function(E){var v=E.length>>>0;if(!v)return this._push(g,1,0);if(i.isString(E)){var D=d.alloc(v=s.length(E));s.decode(E,D,0),E=D}return this.uint32(v)._push(A,v,E)},d.prototype.string=function(E){var v=a.length(E);return v?this.uint32(v)._push(a.write,v,E):this._push(g,1,0)},d.prototype.fork=function(){return this.states=new f(this),this.head=this.tail=new c(l,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(l,0,0),this.len=0),this},d.prototype.ldelim=function(){var E=this.head,v=this.tail,D=this.len;return this.reset().uint32(D),D&&(this.tail.next=E.next,this.tail=v,this.len+=D),this},d.prototype.finish=function(){for(var E=this.head.next,v=this.constructor.alloc(this.len),D=0;E;)E.fn(E.val,v,D),D+=E.len,E=E.next;return v},d._configure=function(T){o=T,d.create=p(),o._configure()}},{15:15}],17:[function(e,t,n){"use strict";t.exports=r;var i=e(16);(r.prototype=Object.create(i.prototype)).constructor=r;var o=e(15);function r(){i.call(this)}r._configure=function(){r.alloc=o._Buffer_allocUnsafe,r.writeBytesBuffer=o.Buffer&&o.Buffer.prototype instanceof Uint8Array&&o.Buffer.prototype.set.name==="set"?function(c,l,f){l.set(c,f)}:function(c,l,f){if(c.copy)c.copy(l,f,0,c.length);else for(var d=0;d<c.length;)l[f++]=c[d++]}},r.prototype.bytes=function(c){o.isString(c)&&(c=o._Buffer_from(c,"base64"));var l=c.length>>>0;return this.uint32(l),l&&this._push(r.writeBytesBuffer,l,c),this};function s(a,c,l){a.length<40?o.utf8.write(a,c,l):c.utf8Write?c.utf8Write(a,l):c.write(a,l)}r.prototype.string=function(c){var l=o.Buffer.byteLength(c);return this.uint32(l),l&&this._push(s,l,c),this},r._configure()},{15:15,16:16}]},{},[8])})()});var jTe=Fn((qVi,oH)=>{/* Copyright 2015-2018 Esri. Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 @preserve */(function(){var e=function(){var o={};o.defaultNoDataValue=-34027999387901484e22,o.decode=function(f,d){d=d||{};var p=d.encodedMaskData||d.encodedMaskData===null,g=c(f,d.inputOffset||0,p),m=d.noDataValue!==null?d.noDataValue:o.defaultNoDataValue,y=r(g,d.pixelType||Float32Array,d.encodedMaskData,m,d.returnMask),b={width:g.width,height:g.height,pixelData:y.resultPixels,minValue:y.minValue,maxValue:g.pixels.maxValue,noDataValue:m};return y.resultMask&&(b.maskData=y.resultMask),d.returnEncodedMask&&g.mask&&(b.encodedMaskData=g.mask.bitset?g.mask.bitset:null),d.returnFileInfo&&(b.fileInfo=s(g),d.computeUsedBitDepths&&(b.fileInfo.bitDepths=a(g))),b};var r=function(f,d,p,g,m){var y=0,b=f.pixels.numBlocksX,C=f.pixels.numBlocksY,A=Math.floor(f.width/b),T=Math.floor(f.height/C),E=2*f.maxZError,v=Number.MAX_VALUE,D;p=p||(f.mask?f.mask.bitset:null);var O,P;O=new d(f.width*f.height),m&&p&&(P=new Uint8Array(f.width*f.height));for(var M=new Float32Array(A*T),L,_,S=0;S<=C;S++){var w=S!==C?T:f.height%C;if(w!==0)for(var I=0;I<=b;I++){var N=I!==b?A:f.width%b;if(N!==0){var k=S*f.width*T+I*A,z=f.width-N,V=f.pixels.blocks[y],U,B,W;V.encoding<2?(V.encoding===0?U=V.rawData:(l(V.stuffedData,V.bitsPerPixel,V.numValidPixels,V.offset,E,M,f.pixels.maxValue),U=M),B=0):V.encoding===2?W=0:W=V.offset;var j;if(p)for(_=0;_<w;_++){for(k&7&&(j=p[k>>3],j<<=k&7),L=0;L<N;L++)k&7||(j=p[k>>3]),j&128?(P&&(P[k]=1),D=V.encoding<2?U[B++]:W,v=v>D?D:v,O[k++]=D):(P&&(P[k]=0),O[k++]=g),j<<=1;k+=z}else if(V.encoding<2)for(_=0;_<w;_++){for(L=0;L<N;L++)D=U[B++],v=v>D?D:v,O[k++]=D;k+=z}else for(v=v>W?W:v,_=0;_<w;_++){for(L=0;L<N;L++)O[k++]=W;k+=z}if(V.encoding===1&&B!==V.numValidPixels)throw"Block and Mask do not match";y++}}}return{resultPixels:O,resultMask:P,minValue:v}},s=function(f){return{fileIdentifierString:f.fileIdentifierString,fileVersion:f.fileVersion,imageType:f.imageType,height:f.height,width:f.width,maxZError:f.maxZError,eofOffset:f.eofOffset,mask:f.mask?{numBlocksX:f.mask.numBlocksX,numBlocksY:f.mask.numBlocksY,numBytes:f.mask.numBytes,maxValue:f.mask.maxValue}:null,pixels:{numBlocksX:f.pixels.numBlocksX,numBlocksY:f.pixels.numBlocksY,numBytes:f.pixels.numBytes,maxValue:f.pixels.maxValue,noDataValue:f.noDataValue}}},a=function(f){for(var d=f.pixels.numBlocksX*f.pixels.numBlocksY,p={},g=0;g<d;g++){var m=f.pixels.blocks[g];m.encoding===0?p.float32=!0:m.encoding===1?p[m.bitsPerPixel]=!0:p[0]=!0}return Object.keys(p)},c=function(f,d,p){var g={},m=new Uint8Array(f,d,10);if(g.fileIdentifierString=String.fromCharCode.apply(null,m),g.fileIdentifierString.trim()!=="CntZImage")throw"Unexpected file identifier string: "+g.fileIdentifierString;d+=10;var y=new DataView(f,d,24);if(g.fileVersion=y.getInt32(0,!0),g.imageType=y.getInt32(4,!0),g.height=y.getUint32(8,!0),g.width=y.getUint32(12,!0),g.maxZError=y.getFloat64(16,!0),d+=24,!p)if(y=new DataView(f,d,16),g.mask={},g.mask.numBlocksY=y.getUint32(0,!0),g.mask.numBlocksX=y.getUint32(4,!0),g.mask.numBytes=y.getUint32(8,!0),g.mask.maxValue=y.getFloat32(12,!0),d+=16,g.mask.numBytes>0){var b=new Uint8Array(Math.ceil(g.width*g.height/8));y=new DataView(f,d,g.mask.numBytes);var C=y.getInt16(0,!0),A=2,T=0;do{if(C>0)for(;C--;)b[T++]=y.getUint8(A++);else{var E=y.getUint8(A++);for(C=-C;C--;)b[T++]=E}C=y.getInt16(A,!0),A+=2}while(A<g.mask.numBytes);if(C!==-32768||T<b.length)throw"Unexpected end of mask RLE encoding";g.mask.bitset=b,d+=g.mask.numBytes}else g.mask.numBytes|g.mask.numBlocksY|g.mask.maxValue||(g.mask.bitset=new Uint8Array(Math.ceil(g.width*g.height/8)));y=new DataView(f,d,16),g.pixels={},g.pixels.numBlocksY=y.getUint32(0,!0),g.pixels.numBlocksX=y.getUint32(4,!0),g.pixels.numBytes=y.getUint32(8,!0),g.pixels.maxValue=y.getFloat32(12,!0),d+=16;var v=g.pixels.numBlocksX,D=g.pixels.numBlocksY,O=v+(g.width%v>0?1:0),P=D+(g.height%D>0?1:0);g.pixels.blocks=new Array(O*P);for(var M=0,L=0;L<P;L++)for(var _=0;_<O;_++){var S=0,w=f.byteLength-d;y=new DataView(f,d,Math.min(10,w));var I={};g.pixels.blocks[M++]=I;var N=y.getUint8(0);if(S++,I.encoding=N&63,I.encoding>3)throw"Invalid block encoding ("+I.encoding+")";if(I.encoding===2){d++;continue}if(N!==0&&N!==2){if(N>>=6,I.offsetType=N,N===2)I.offset=y.getInt8(1),S++;else if(N===1)I.offset=y.getInt16(1,!0),S+=2;else if(N===0)I.offset=y.getFloat32(1,!0),S+=4;else throw"Invalid block offset type";if(I.encoding===1)if(N=y.getUint8(S),S++,I.bitsPerPixel=N&63,N>>=6,I.numValidPixelsType=N,N===2)I.numValidPixels=y.getUint8(S),S++;else if(N===1)I.numValidPixels=y.getUint16(S,!0),S+=2;else if(N===0)I.numValidPixels=y.getUint32(S,!0),S+=4;else throw"Invalid valid pixel count type"}if(d+=S,I.encoding!==3){var k,z;if(I.encoding===0){var V=(g.pixels.numBytes-1)/4;if(V!==Math.floor(V))throw"uncompressed block has invalid length";k=new ArrayBuffer(V*4),z=new Uint8Array(k),z.set(new Uint8Array(f,d,V*4));var U=new Float32Array(k);I.rawData=U,d+=V*4}else if(I.encoding===1){var B=Math.ceil(I.numValidPixels*I.bitsPerPixel/8),W=Math.ceil(B/4);k=new ArrayBuffer(W*4),z=new Uint8Array(k),z.set(new Uint8Array(f,d,B)),I.stuffedData=new Uint32Array(k),d+=B}}}return g.eofOffset=d,g},l=function(f,d,p,g,m,y,b){var C=(1<<d)-1,A=0,T,E=0,v,D,O=Math.ceil((b-g)/m),P=f.length*4-Math.ceil(d*p/8);for(f[f.length-1]<<=8*P,T=0;T<p;T++){if(E===0&&(D=f[A++],E=32),E>=d)v=D>>>E-d&C,E-=d;else{var M=d-E;v=(D&C)<<M&C,D=f[A++],E=32-M,v+=D>>>E}y[T]=v<O?g+v*m:b}return y};return o}(),t=function(){"use strict";var o={unstuff:function(c,l,f,d,p,g,m,y){var b=(1<<f)-1,C=0,A,T=0,E,v,D,O,P=c.length*4-Math.ceil(f*d/8);if(c[c.length-1]<<=8*P,p)for(A=0;A<d;A++)T===0&&(v=c[C++],T=32),T>=f?(E=v>>>T-f&b,T-=f):(D=f-T,E=(v&b)<<D&b,v=c[C++],T=32-D,E+=v>>>T),l[A]=p[E];else for(O=Math.ceil((y-g)/m),A=0;A<d;A++)T===0&&(v=c[C++],T=32),T>=f?(E=v>>>T-f&b,T-=f):(D=f-T,E=(v&b)<<D&b,v=c[C++],T=32-D,E+=v>>>T),l[A]=E<O?g+E*m:y},unstuffLUT:function(c,l,f,d,p,g){var m=(1<<l)-1,y=0,b=0,C=0,A=0,T=0,E,v=[],D=c.length*4-Math.ceil(l*f/8);c[c.length-1]<<=8*D;var O=Math.ceil((g-d)/p);for(b=0;b<f;b++)A===0&&(E=c[y++],A=32),A>=l?(T=E>>>A-l&m,A-=l):(C=l-A,T=(E&m)<<C&m,E=c[y++],A=32-C,T+=E>>>A),v[b]=T<O?d+T*p:g;return v.unshift(d),v},unstuff2:function(c,l,f,d,p,g,m,y){var b=(1<<f)-1,C=0,A,T=0,E=0,v,D,O;if(p)for(A=0;A<d;A++)T===0&&(D=c[C++],T=32,E=0),T>=f?(v=D>>>E&b,T-=f,E+=f):(O=f-T,v=D>>>E&b,D=c[C++],T=32-O,v|=(D&(1<<O)-1)<<f-O,E=O),l[A]=p[v];else{var P=Math.ceil((y-g)/m);for(A=0;A<d;A++)T===0&&(D=c[C++],T=32,E=0),T>=f?(v=D>>>E&b,T-=f,E+=f):(O=f-T,v=D>>>E&b,D=c[C++],T=32-O,v|=(D&(1<<O)-1)<<f-O,E=O),l[A]=v<P?g+v*m:y}return l},unstuffLUT2:function(c,l,f,d,p,g){var m=(1<<l)-1,y=0,b=0,C=0,A=0,T=0,E=0,v,D=[],O=Math.ceil((g-d)/p);for(b=0;b<f;b++)A===0&&(v=c[y++],A=32,E=0),A>=l?(T=v>>>E&m,A-=l,E+=l):(C=l-A,T=v>>>E&m,v=c[y++],A=32-C,T|=(v&(1<<C)-1)<<l-C,E=C),D[b]=T<O?d+T*p:g;return D.unshift(d),D},originalUnstuff:function(c,l,f,d){var p=(1<<f)-1,g=0,m,y=0,b,C,A,T=c.length*4-Math.ceil(f*d/8);for(c[c.length-1]<<=8*T,m=0;m<d;m++)y===0&&(C=c[g++],y=32),y>=f?(b=C>>>y-f&p,y-=f):(A=f-y,b=(C&p)<<A&p,C=c[g++],y=32-A,b+=C>>>y),l[m]=b;return l},originalUnstuff2:function(c,l,f,d){var p=(1<<f)-1,g=0,m,y=0,b=0,C,A,T;for(m=0;m<d;m++)y===0&&(A=c[g++],y=32,b=0),y>=f?(C=A>>>b&p,y-=f,b+=f):(T=f-y,C=A>>>b&p,A=c[g++],y=32-T,C|=(A&(1<<T)-1)<<f-T,b=T),l[m]=C;return l}},r={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(c){for(var l=65535,f=65535,d=c.length,p=Math.floor(d/2),g=0;p;){var m=p>=359?359:p;p-=m;do l+=c[g++]<<8,f+=l+=c[g++];while(--m);l=(l&65535)+(l>>>16),f=(f&65535)+(f>>>16)}return d&1&&(f+=l+=c[g]<<8),l=(l&65535)+(l>>>16),f=(f&65535)+(f>>>16),(f<<16|l)>>>0},readHeaderInfo:function(c,l){var f=l.ptr,d=new Uint8Array(c,f,6),p={};if(p.fileIdentifierString=String.fromCharCode.apply(null,d),p.fileIdentifierString.lastIndexOf("Lerc2",0)!==0)throw"Unexpected file identifier string (expect Lerc2 ): "+p.fileIdentifierString;f+=6;var g=new DataView(c,f,8),m=g.getInt32(0,!0);p.fileVersion=m,f+=4,m>=3&&(p.checksum=g.getUint32(4,!0),f+=4),g=new DataView(c,f,12),p.height=g.getUint32(0,!0),p.width=g.getUint32(4,!0),f+=8,m>=4?(p.numDims=g.getUint32(8,!0),f+=4):p.numDims=1,g=new DataView(c,f,40),p.numValidPixel=g.getUint32(0,!0),p.microBlockSize=g.getInt32(4,!0),p.blobSize=g.getInt32(8,!0),p.imageType=g.getInt32(12,!0),p.maxZError=g.getFloat64(16,!0),p.zMin=g.getFloat64(24,!0),p.zMax=g.getFloat64(32,!0),f+=40,l.headerInfo=p,l.ptr=f;var y,b;if(m>=3&&(b=m>=4?52:48,y=this.computeChecksumFletcher32(new Uint8Array(c,f-b,p.blobSize-14)),y!==p.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(c,l){var f=l.headerInfo,d=this.getDataTypeArray(f.imageType),p=f.numDims*this.getDataTypeSize(f.imageType),g=this.readSubArray(c,l.ptr,d,p),m=this.readSubArray(c,l.ptr+p,d,p);l.ptr+=2*p;var y,b=!0;for(y=0;y<f.numDims;y++)if(g[y]!==m[y]){b=!1;break}return f.minValues=g,f.maxValues=m,b},readSubArray:function(c,l,f,d){var p;if(f===Uint8Array)p=new Uint8Array(c,l,d);else{var g=new ArrayBuffer(d),m=new Uint8Array(g);m.set(new Uint8Array(c,l,d)),p=new f(g)}return p},readMask:function(c,l){var f=l.ptr,d=l.headerInfo,p=d.width*d.height,g=d.numValidPixel,m=new DataView(c,f,4),y={};if(y.numBytes=m.getUint32(0,!0),f+=4,(g===0||p===g)&&y.numBytes!==0)throw"invalid mask";var b,C;if(g===0)b=new Uint8Array(Math.ceil(p/8)),y.bitset=b,C=new Uint8Array(p),l.pixels.resultMask=C,f+=y.numBytes;else if(y.numBytes>0){b=new Uint8Array(Math.ceil(p/8)),m=new DataView(c,f,y.numBytes);var A=m.getInt16(0,!0),T=2,E=0,v=0;do{if(A>0)for(;A--;)b[E++]=m.getUint8(T++);else for(v=m.getUint8(T++),A=-A;A--;)b[E++]=v;A=m.getInt16(T,!0),T+=2}while(T<y.numBytes);if(A!==-32768||E<b.length)throw"Unexpected end of mask RLE encoding";C=new Uint8Array(p);var D=0,O=0;for(O=0;O<p;O++)O&7?(D=b[O>>3],D<<=O&7):D=b[O>>3],D&128&&(C[O]=1);l.pixels.resultMask=C,y.bitset=b,f+=y.numBytes}return l.ptr=f,l.mask=y,!0},readDataOneSweep:function(c,l,f){var d=l.ptr,p=l.headerInfo,g=p.numDims,m=p.width*p.height,y=p.imageType,b=p.numValidPixel*r.getDataTypeSize(y)*g,C,A=l.pixels.resultMask;if(f===Uint8Array)C=new Uint8Array(c,d,b);else{var T=new ArrayBuffer(b),E=new Uint8Array(T);E.set(new Uint8Array(c,d,b)),C=new f(T)}if(C.length===m*g)l.pixels.resultPixels=C;else{l.pixels.resultPixels=new f(m*g);var v=0,D=0,O=0,P=0;if(g>1)for(O=0;O<g;O++)for(P=O*m,D=0;D<m;D++)A[D]&&(l.pixels.resultPixels[P+D]=C[v++]);else for(D=0;D<m;D++)A[D]&&(l.pixels.resultPixels[D]=C[v++])}return d+=b,l.ptr=d,!0},readHuffmanTree:function(c,l){var f=this.HUFFMAN_LUT_BITS_MAX,d=new DataView(c,l.ptr,16);l.ptr+=16;var p=d.getInt32(0,!0);if(p<2)throw"unsupported Huffman version";var g=d.getInt32(4,!0),m=d.getInt32(8,!0),y=d.getInt32(12,!0);if(m>=y)return!1;var b=new Uint32Array(y-m);r.decodeBits(c,l,b);var C=[],A,T,E,v;for(A=m;A<y;A++)T=A-(A<g?0:g),C[T]={first:b[A-m],second:null};var D=c.byteLength-l.ptr,O=Math.ceil(D/4),P=new ArrayBuffer(O*4),M=new Uint8Array(P);M.set(new Uint8Array(c,l.ptr,D));var L=new Uint32Array(P),_=0,S,w=0;for(S=L[0],A=m;A<y;A++)T=A-(A<g?0:g),v=C[T].first,v>0&&(C[T].second=S<<_>>>32-v,32-_>=v?(_+=v,_===32&&(_=0,w++,S=L[w])):(_+=v-32,w++,S=L[w],C[T].second|=S>>>32-_));var I=0,N=0,k=new s;for(A=0;A<C.length;A++)C[A]!==void 0&&(I=Math.max(I,C[A].first));I>=f?N=f:N=I,I>=30&&console.log("WARning, large NUM LUT BITS IS "+I);var z=[],V,U,B,W,j,Q;for(A=m;A<y;A++)if(T=A-(A<g?0:g),v=C[T].first,v>0)if(V=[v,T],v<=N)for(U=C[T].second<<N-v,B=1<<N-v,E=0;E<B;E++)z[U|E]=V;else for(U=C[T].second,Q=k,W=v-1;W>=0;W--)j=U>>>W&1,j?(Q.right||(Q.right=new s),Q=Q.right):(Q.left||(Q.left=new s),Q=Q.left),W===0&&!Q.val&&(Q.val=V[1]);return{decodeLut:z,numBitsLUTQick:N,numBitsLUT:I,tree:k,stuffedData:L,srcPtr:w,bitPos:_}},readHuffman:function(c,l,f){var d=l.headerInfo,p=d.numDims,g=l.headerInfo.height,m=l.headerInfo.width,y=m*g,b=this.readHuffmanTree(c,l),C=b.decodeLut,A=b.tree,T=b.stuffedData,E=b.srcPtr,v=b.bitPos,D=b.numBitsLUTQick,O=b.numBitsLUT,P=l.headerInfo.imageType===0?128:0,M,L,_,S=l.pixels.resultMask,w,I,N,k,z,V,U,B=0;v>0&&(E++,v=0);var W=T[E],j=l.encodeMode===1,Q=new f(y*p),q=Q,X;for(X=0;X<d.numDims;X++){if(p>1&&(q=new f(Q.buffer,y*X,y),B=0),l.headerInfo.numValidPixel===m*g)for(V=0,k=0;k<g;k++)for(z=0;z<m;z++,V++){if(L=0,w=W<<v>>>32-D,I=w,32-v<D&&(w|=T[E+1]>>>64-v-D,I=w),C[I])L=C[I][1],v+=C[I][0];else for(w=W<<v>>>32-O,I=w,32-v<O&&(w|=T[E+1]>>>64-v-O,I=w),M=A,U=0;U<O;U++)if(N=w>>>O-U-1&1,M=N?M.right:M.left,!(M.left||M.right)){L=M.val,v=v+U+1;break}v>=32&&(v-=32,E++,W=T[E]),_=L-P,j?(z>0?_+=B:k>0?_+=q[V-m]:_+=B,_&=255,q[V]=_,B=_):q[V]=_}else for(V=0,k=0;k<g;k++)for(z=0;z<m;z++,V++)if(S[V]){if(L=0,w=W<<v>>>32-D,I=w,32-v<D&&(w|=T[E+1]>>>64-v-D,I=w),C[I])L=C[I][1],v+=C[I][0];else for(w=W<<v>>>32-O,I=w,32-v<O&&(w|=T[E+1]>>>64-v-O,I=w),M=A,U=0;U<O;U++)if(N=w>>>O-U-1&1,M=N?M.right:M.left,!(M.left||M.right)){L=M.val,v=v+U+1;break}v>=32&&(v-=32,E++,W=T[E]),_=L-P,j?(z>0&&S[V-1]?_+=B:k>0&&S[V-m]?_+=q[V-m]:_+=B,_&=255,q[V]=_,B=_):q[V]=_}l.ptr=l.ptr+(E+1)*4+(v>0?4:0)}l.pixels.resultPixels=Q},decodeBits:function(c,l,f,d,p){{var g=l.headerInfo,m=g.fileVersion,y=0,b=new DataView(c,l.ptr,5),C=b.getUint8(0);y++;var A=C>>6,T=A===0?4:3-A,E=(C&32)>0,v=C&31,D=0;if(T===1)D=b.getUint8(y),y++;else if(T===2)D=b.getUint16(y,!0),y+=2;else if(T===4)D=b.getUint32(y,!0),y+=4;else throw"Invalid valid pixel count type";var O=2*g.maxZError,P,M,L,_,S,w,I,N,k,z,V=g.numDims>1?g.maxValues[p]:g.zMax;if(E){for(l.counter.lut++,N=b.getUint8(y),k=v,y++,_=Math.ceil((N-1)*v/8),S=Math.ceil(_/4),M=new ArrayBuffer(S*4),L=new Uint8Array(M),l.ptr+=y,L.set(new Uint8Array(c,l.ptr,_)),I=new Uint32Array(M),l.ptr+=_,z=0;N-1>>>z;)z++;_=Math.ceil(D*z/8),S=Math.ceil(_/4),M=new ArrayBuffer(S*4),L=new Uint8Array(M),L.set(new Uint8Array(c,l.ptr,_)),P=new Uint32Array(M),l.ptr+=_,m>=3?w=o.unstuffLUT2(I,v,N-1,d,O,V):w=o.unstuffLUT(I,v,N-1,d,O,V),m>=3?o.unstuff2(P,f,z,D,w):o.unstuff(P,f,z,D,w)}else l.counter.bitstuffer++,z=v,l.ptr+=y,z>0&&(_=Math.ceil(D*z/8),S=Math.ceil(_/4),M=new ArrayBuffer(S*4),L=new Uint8Array(M),L.set(new Uint8Array(c,l.ptr,_)),P=new Uint32Array(M),l.ptr+=_,m>=3?d==null?o.originalUnstuff2(P,f,z,D):o.unstuff2(P,f,z,D,!1,d,O,V):d==null?o.originalUnstuff(P,f,z,D):o.unstuff(P,f,z,D,!1,d,O,V))}},readTiles:function(c,l,f){var d=l.headerInfo,p=d.width,g=d.height,m=d.microBlockSize,y=d.imageType,b=r.getDataTypeSize(y),C=Math.ceil(p/m),A=Math.ceil(g/m);l.pixels.numBlocksY=A,l.pixels.numBlocksX=C,l.pixels.ptr=0;var T=0,E=0,v=0,D=0,O=0,P=0,M=0,L=0,_=0,S=0,w=0,I=0,N=0,k=0,z=0,V=0,U,B,W,j,Q,q,X=new f(m*m),Z=g%m||m,fe=p%m||m,xe,re,pe=d.numDims,ye,Se=l.pixels.resultMask,Te=l.pixels.resultPixels;for(v=0;v<A;v++)for(O=v!==A-1?m:Z,D=0;D<C;D++)for(P=D!==C-1?m:fe,w=v*p*m+D*m,I=p-P,ye=0;ye<pe;ye++){if(pe>1&&(Te=new f(l.pixels.resultPixels.buffer,p*g*ye*b,p*g)),M=c.byteLength-l.ptr,U=new DataView(c,l.ptr,Math.min(10,M)),B={},V=0,L=U.getUint8(0),V++,_=L>>6&255,S=L>>2&15,S!==(D*m>>3&15))throw"integrity issue";if(q=L&3,q>3)throw l.ptr+=V,"Invalid block encoding ("+q+")";if(q===2){l.counter.constant++,l.ptr+=V;continue}else if(q===0){if(l.counter.uncompressed++,l.ptr+=V,N=O*P*b,k=c.byteLength-l.ptr,N=N<k?N:k,W=new ArrayBuffer(N%b===0?N:N+b-N%b),j=new Uint8Array(W),j.set(new Uint8Array(c,l.ptr,N)),Q=new f(W),z=0,Se)for(T=0;T<O;T++){for(E=0;E<P;E++)Se[w]&&(Te[w]=Q[z++]),w++;w+=I}else for(T=0;T<O;T++){for(E=0;E<P;E++)Te[w++]=Q[z++];w+=I}l.ptr+=z*b}else if(xe=r.getDataTypeUsed(y,_),re=r.getOnePixel(B,V,xe,U),V+=r.getDataTypeSize(xe),q===3)if(l.ptr+=V,l.counter.constantoffset++,Se)for(T=0;T<O;T++){for(E=0;E<P;E++)Se[w]&&(Te[w]=re),w++;w+=I}else for(T=0;T<O;T++){for(E=0;E<P;E++)Te[w++]=re;w+=I}else if(l.ptr+=V,r.decodeBits(c,l,X,re,ye),V=0,Se)for(T=0;T<O;T++){for(E=0;E<P;E++)Se[w]&&(Te[w]=X[V++]),w++;w+=I}else for(T=0;T<O;T++){for(E=0;E<P;E++)Te[w++]=X[V++];w+=I}}},formatFileInfo:function(c){return{fileIdentifierString:c.headerInfo.fileIdentifierString,fileVersion:c.headerInfo.fileVersion,imageType:c.headerInfo.imageType,height:c.headerInfo.height,width:c.headerInfo.width,numValidPixel:c.headerInfo.numValidPixel,microBlockSize:c.headerInfo.microBlockSize,blobSize:c.headerInfo.blobSize,maxZError:c.headerInfo.maxZError,pixelType:r.getPixelType(c.headerInfo.imageType),eofOffset:c.eofOffset,mask:c.mask?{numBytes:c.mask.numBytes}:null,pixels:{numBlocksX:c.pixels.numBlocksX,numBlocksY:c.pixels.numBlocksY,maxValue:c.headerInfo.zMax,minValue:c.headerInfo.zMin,noDataValue:c.noDataValue}}},constructConstantSurface:function(c){var l=c.headerInfo.zMax,f=c.headerInfo.numDims,d=c.headerInfo.height*c.headerInfo.width,p=d*f,g=0,m=0,y=0,b=c.pixels.resultMask;if(b)if(f>1)for(g=0;g<f;g++)for(y=g*d,m=0;m<d;m++)b[m]&&(c.pixels.resultPixels[y+m]=l);else for(m=0;m<d;m++)b[m]&&(c.pixels.resultPixels[m]=l);else if(c.pixels.resultPixels.fill)c.pixels.resultPixels.fill(l);else for(m=0;m<p;m++)c.pixels.resultPixels[m]=l},getDataTypeArray:function(c){var l;switch(c){case 0:l=Int8Array;break;case 1:l=Uint8Array;break;case 2:l=Int16Array;break;case 3:l=Uint16Array;break;case 4:l=Int32Array;break;case 5:l=Uint32Array;break;case 6:l=Float32Array;break;case 7:l=Float64Array;break;default:l=Float32Array}return l},getPixelType:function(c){var l;switch(c){case 0:l="S8";break;case 1:l="U8";break;case 2:l="S16";break;case 3:l="U16";break;case 4:l="S32";break;case 5:l="U32";break;case 6:l="F32";break;case 7:l="F64";break;default:l="F32"}return l},isValidPixelValue:function(c,l){if(l==null)return!1;var f;switch(c){case 0:f=l>=-128&&l<=127;break;case 1:f=l>=0&&l<=255;break;case 2:f=l>=-32768&&l<=32767;break;case 3:f=l>=0&&l<=65536;break;case 4:f=l>=-2147483648&&l<=2147483647;break;case 5:f=l>=0&&l<=4294967296;break;case 6:f=l>=-34027999387901484e22&&l<=34027999387901484e22;break;case 7:f=l>=5e-324&&l<=17976931348623157e292;break;default:f=!1}return f},getDataTypeSize:function(c){var l=0;switch(c){case 0:case 1:l=1;break;case 2:case 3:l=2;break;case 4:case 5:case 6:l=4;break;case 7:l=8;break;default:l=c}return l},getDataTypeUsed:function(c,l){var f=c;switch(c){case 2:case 4:f=c-l;break;case 3:case 5:f=c-2*l;break;case 6:l===0?f=c:l===1?f=2:f=1;break;case 7:l===0?f=c:f=c-2*l+1;break;default:f=c;break}return f},getOnePixel:function(c,l,f,d){var p=0;switch(f){case 0:p=d.getInt8(l);break;case 1:p=d.getUint8(l);break;case 2:p=d.getInt16(l,!0);break;case 3:p=d.getUint16(l,!0);break;case 4:p=d.getInt32(l,!0);break;case 5:p=d.getUInt32(l,!0);break;case 6:p=d.getFloat32(l,!0);break;case 7:p=d.getFloat64(l,!0);break;default:throw"the decoder does not understand this pixel type"}return p}},s=function(c,l,f){this.val=c,this.left=l,this.right=f},a={decode:function(c,l){l=l||{};var f=l.noDataValue,d=0,p={};if(p.ptr=l.inputOffset||0,p.pixels={},!!r.readHeaderInfo(c,p)){var g=p.headerInfo,m=g.fileVersion,y=r.getDataTypeArray(g.imageType);r.readMask(c,p),g.numValidPixel!==g.width*g.height&&!p.pixels.resultMask&&(p.pixels.resultMask=l.maskData);var b=g.width*g.height;if(p.pixels.resultPixels=new y(b*g.numDims),p.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0},g.numValidPixel!==0)if(g.zMax===g.zMin)r.constructConstantSurface(p);else if(m>=4&&r.checkMinMaxRanges(c,p))r.constructConstantSurface(p);else{var C=new DataView(c,p.ptr,2),A=C.getUint8(0);if(p.ptr++,A)r.readDataOneSweep(c,p,y);else if(m>1&&g.imageType<=1&&Math.abs(g.maxZError-.5)<1e-5){var T=C.getUint8(1);if(p.ptr++,p.encodeMode=T,T>2||m<4&&T>1)throw"Invalid Huffman flag "+T;T?r.readHuffman(c,p,y):r.readTiles(c,p,y)}else r.readTiles(c,p,y)}p.eofOffset=p.ptr;var E;l.inputOffset?(E=p.headerInfo.blobSize+l.inputOffset-p.ptr,Math.abs(E)>=1&&(p.eofOffset=l.inputOffset+p.headerInfo.blobSize)):(E=p.headerInfo.blobSize-p.ptr,Math.abs(E)>=1&&(p.eofOffset=p.headerInfo.blobSize));var v={width:g.width,height:g.height,pixelData:p.pixels.resultPixels,minValue:g.zMin,maxValue:g.zMax,validPixelCount:g.numValidPixel,dimCount:g.numDims,dimStats:{minValues:g.minValues,maxValues:g.maxValues},maskData:p.pixels.resultMask};if(p.pixels.resultMask&&r.isValidPixelValue(g.imageType,f)){var D=p.pixels.resultMask;for(d=0;d<b;d++)D[d]||(v.pixelData[d]=f);v.noDataValue=f}return p.noDataValue=f,l.returnFileInfo&&(v.fileInfo=r.formatFileInfo(p)),v}},getBandCount:function(c){var l=0,f=0,d={};for(d.ptr=0,d.pixels={};f<c.byteLength-58;)r.readHeaderInfo(c,d),f+=d.headerInfo.blobSize,l++,d.ptr=f;return l}};return a}(),n=function(){var o=new ArrayBuffer(4),r=new Uint8Array(o),s=new Uint32Array(o);return s[0]=1,r[0]===1}(),i={decode:function(o,r){if(!n)throw"Big endian system is not supported.";r=r||{};var s=r.inputOffset||0,a=new Uint8Array(o,s,10),c=String.fromCharCode.apply(null,a),l,f;if(c.trim()==="CntZImage")l=e,f=1;else if(c.substring(0,5)==="Lerc2")l=t,f=2;else throw"Unexpected file identifier string: "+c;for(var d=0,p=o.byteLength-10,g,m=[],y,b,C={width:0,height:0,pixels:[],pixelType:r.pixelType,mask:null,statistics:[]};s<p;){var A=l.decode(o,{inputOffset:s,encodedMaskData:g,maskData:b,returnMask:d===0,returnEncodedMask:d===0,returnFileInfo:!0,pixelType:r.pixelType||null,noDataValue:r.noDataValue||null});s=A.fileInfo.eofOffset,d===0&&(g=A.encodedMaskData,b=A.maskData,C.width=A.width,C.height=A.height,C.dimCount=A.dimCount||1,C.pixelType=A.pixelType||A.fileInfo.pixelType,C.mask=A.maskData),f>1&&A.fileInfo.mask&&A.fileInfo.mask.numBytes>0&&m.push(A.maskData),d++,C.pixels.push(A.pixelData),C.statistics.push({minValue:A.minValue,maxValue:A.maxValue,noDataValue:A.noDataValue,dimStats:A.dimStats})}var T,E,v;if(f>1&&m.length>1){for(v=C.width*C.height,C.bandMasks=m,b=new Uint8Array(v),b.set(m[0]),T=1;T<m.length;T++)for(y=m[T],E=0;E<v;E++)b[E]=b[E]&y[E];C.maskData=b}return C}};typeof define=="function"&&define.amd?define([],function(){return i}):typeof oH<"u"&&oH.exports?oH.exports=i:this.Lerc=i})()});var QEe=Fn((lco,$Ee)=>{$Ee.exports={webm:"data:video/webm;base64,GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4EEQoWBAhhTgGcBAAAAAAAVkhFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsghV17AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU1LjMzLjEwMFdBjUxhdmY1NS4zMy4xMDBzpJBlrrXf3DCDVB8KcgbMpcr+RImIQJBgAAAAAAAWVK5rAQAAAAAAD++uAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDiDgQEj44OEAmJaAOABAAAAAAAABrCBsLqBkK4BAAAAAAAPq9eBAnPFgQKcgQAitZyDdW5khohBX1ZPUkJJU4OBAuEBAAAAAAAAEZ+BArWIQOdwAAAAAABiZIEgY6JPbwIeVgF2b3JiaXMAAAAAAoC7AAAAAAAAgLUBAAAAAAC4AQN2b3JiaXMtAAAAWGlwaC5PcmcgbGliVm9yYmlzIEkgMjAxMDExMDEgKFNjaGF1ZmVudWdnZXQpAQAAABUAAABlbmNvZGVyPUxhdmM1NS41Mi4xMDIBBXZvcmJpcyVCQ1YBAEAAACRzGCpGpXMWhBAaQlAZ4xxCzmvsGUJMEYIcMkxbyyVzkCGkoEKIWyiB0JBVAABAAACHQXgUhIpBCCGEJT1YkoMnPQghhIg5eBSEaUEIIYQQQgghhBBCCCGERTlokoMnQQgdhOMwOAyD5Tj4HIRFOVgQgydB6CCED0K4moOsOQghhCQ1SFCDBjnoHITCLCiKgsQwuBaEBDUojILkMMjUgwtCiJqDSTX4GoRnQXgWhGlBCCGEJEFIkIMGQcgYhEZBWJKDBjm4FITLQagahCo5CB+EIDRkFQCQAACgoiiKoigKEBqyCgDIAAAQQFEUx3EcyZEcybEcCwgNWQUAAAEACAAAoEiKpEiO5EiSJFmSJVmSJVmS5omqLMuyLMuyLMsyEBqyCgBIAABQUQxFcRQHCA1ZBQBkAAAIoDiKpViKpWiK54iOCISGrAIAgAAABAAAEDRDUzxHlETPVFXXtm3btm3btm3btm3btm1blmUZCA1ZBQBAAAAQ0mlmqQaIMAMZBkJDVgEACAAAgBGKMMSA0JBVAABAAACAGEoOogmtOd+c46BZDppKsTkdnEi1eZKbirk555xzzsnmnDHOOeecopxZDJoJrTnnnMSgWQqaCa0555wnsXnQmiqtOeeccc7pYJwRxjnnnCateZCajbU555wFrWmOmkuxOeecSLl5UptLtTnnnHPOOeecc84555zqxekcnBPOOeecqL25lpvQxTnnnE/G6d6cEM4555xzzjnnnHPOOeecIDRkFQAABABAEIaNYdwpCNLnaCBGEWIaMulB9+gwCRqDnELq0ehopJQ6CCWVcVJKJwgNWQUAAAIAQAghhRRSSCGFFFJIIYUUYoghhhhyyimnoIJKKqmooowyyyyzzDLLLLPMOuyssw47DDHEEEMrrcRSU2011lhr7jnnmoO0VlprrbVSSimllFIKQkNWAQAgAAAEQgYZZJBRSCGFFGKIKaeccgoqqIDQkFUAACAAgAAAAABP8hzRER3RER3RER3RER3R8RzPESVREiVREi3TMjXTU0VVdWXXlnVZt31b2IVd933d933d+HVhWJZlWZZlWZZlWZZlWZZlWZYgNGQVAAACAAAghBBCSCGFFFJIKcYYc8w56CSUEAgNWQUAAAIACAAAAHAUR3EcyZEcSbIkS9IkzdIsT/M0TxM9URRF0zRV0RVdUTdtUTZl0zVdUzZdVVZtV5ZtW7Z125dl2/d93/d93/d93/d93/d9XQdCQ1YBABIAADqSIymSIimS4ziOJElAaMgqAEAGAEAAAIriKI7jOJIkSZIlaZJneZaomZrpmZ4qqkBoyCoAABAAQAAAAAAAAIqmeIqpeIqoeI7oiJJomZaoqZoryqbsuq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq4LhIasAgAkAAB0JEdyJEdSJEVSJEdygNCQVQCADACAAAAcwzEkRXIsy9I0T/M0TxM90RM901NFV3SB0JBVAAAgAIAAAAAAAAAMybAUy9EcTRIl1VItVVMt1VJF1VNVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVN0zRNEwgNWQkAkAEAkBBTLS3GmgmLJGLSaqugYwxS7KWxSCpntbfKMYUYtV4ah5RREHupJGOKQcwtpNApJq3WVEKFFKSYYyoVUg5SIDRkhQAQmgHgcBxAsixAsiwAAAAAAAAAkDQN0DwPsDQPAAAAAAAAACRNAyxPAzTPAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA0jRA8zxA8zwAAAAAAAAA0DwP8DwR8EQRAAAAAAAAACzPAzTRAzxRBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA0jRA8zxA8zwAAAAAAAAAsDwP8EQR0DwRAAAAAAAAACzPAzxRBDzRAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAEOAAABBgIRQasiIAiBMAcEgSJAmSBM0DSJYFTYOmwTQBkmVB06BpME0AAAAAAAAAAAAAJE2DpkHTIIoASdOgadA0iCIAAAAAAAAAAAAAkqZB06BpEEWApGnQNGgaRBEAAAAAAAAAAAAAzzQhihBFmCbAM02IIkQRpgkAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAGHAAAAgwoQwUGrIiAIgTAHA4imUBAIDjOJYFAACO41gWAABYliWKAABgWZooAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAYcAAACDChDBQashIAiAIAcCiKZQHHsSzgOJYFJMmyAJYF0DyApgFEEQAIAAAocAAACLBBU2JxgEJDVgIAUQAABsWxLE0TRZKkaZoniiRJ0zxPFGma53meacLzPM80IYqiaJoQRVE0TZimaaoqME1VFQAAUOAAABBgg6bE4gCFhqwEAEICAByKYlma5nmeJ4qmqZokSdM8TxRF0TRNU1VJkqZ5niiKommapqqyLE3zPFEURdNUVVWFpnmeKIqiaaqq6sLzPE8URdE0VdV14XmeJ4qiaJqq6roQRVE0TdNUTVV1XSCKpmmaqqqqrgtETxRNU1Vd13WB54miaaqqq7ouEE3TVFVVdV1ZBpimaaqq68oyQFVV1XVdV5YBqqqqruu6sgxQVdd1XVmWZQCu67qyLMsCAAAOHAAAAoygk4wqi7DRhAsPQKEhKwKAKAAAwBimFFPKMCYhpBAaxiSEFEImJaXSUqogpFJSKRWEVEoqJaOUUmopVRBSKamUCkIqJZVSAADYgQMA2IGFUGjISgAgDwCAMEYpxhhzTiKkFGPOOScRUoox55yTSjHmnHPOSSkZc8w556SUzjnnnHNSSuacc845KaVzzjnnnJRSSuecc05KKSWEzkEnpZTSOeecEwAAVOAAABBgo8jmBCNBhYasBABSAQAMjmNZmuZ5omialiRpmud5niiapiZJmuZ5nieKqsnzPE8URdE0VZXneZ4oiqJpqirXFUXTNE1VVV2yLIqmaZqq6rowTdNUVdd1XZimaaqq67oubFtVVdV1ZRm2raqq6rqyDFzXdWXZloEsu67s2rIAAPAEBwCgAhtWRzgpGgssNGQlAJABAEAYg5BCCCFlEEIKIYSUUggJAAAYcAAACDChDBQashIASAUAAIyx1lprrbXWQGettdZaa62AzFprrbXWWmuttdZaa6211lJrrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmstpZRSSimllFJKKaWUUkoppZRSSgUA+lU4APg/2LA6wknRWGChISsBgHAAAMAYpRhzDEIppVQIMeacdFRai7FCiDHnJKTUWmzFc85BKCGV1mIsnnMOQikpxVZjUSmEUlJKLbZYi0qho5JSSq3VWIwxqaTWWoutxmKMSSm01FqLMRYjbE2ptdhqq7EYY2sqLbQYY4zFCF9kbC2m2moNxggjWywt1VprMMYY3VuLpbaaizE++NpSLDHWXAAAd4MDAESCjTOsJJ0VjgYXGrISAAgJACAQUooxxhhzzjnnpFKMOeaccw5CCKFUijHGnHMOQgghlIwx5pxzEEIIIYRSSsaccxBCCCGEkFLqnHMQQgghhBBKKZ1zDkIIIYQQQimlgxBCCCGEEEoopaQUQgghhBBCCKmklEIIIYRSQighlZRSCCGEEEIpJaSUUgohhFJCCKGElFJKKYUQQgillJJSSimlEkoJJYQSUikppRRKCCGUUkpKKaVUSgmhhBJKKSWllFJKIYQQSikFAAAcOAAABBhBJxlVFmGjCRcegEJDVgIAZAAAkKKUUiktRYIipRikGEtGFXNQWoqocgxSzalSziDmJJaIMYSUk1Qy5hRCDELqHHVMKQYtlRhCxhik2HJLoXMOAAAAQQCAgJAAAAMEBTMAwOAA4XMQdAIERxsAgCBEZohEw0JweFAJEBFTAUBigkIuAFRYXKRdXECXAS7o4q4DIQQhCEEsDqCABByccMMTb3jCDU7QKSp1IAAAAAAADADwAACQXAAREdHMYWRobHB0eHyAhIiMkAgAAAAAABcAfAAAJCVAREQ0cxgZGhscHR4fICEiIyQBAIAAAgAAAAAggAAEBAQAAAAAAAIAAAAEBB9DtnUBAAAAAAAEPueBAKOFggAAgACjzoEAA4BwBwCdASqwAJAAAEcIhYWIhYSIAgIABhwJ7kPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99YAD+/6tQgKOFggADgAqjhYIAD4AOo4WCACSADqOZgQArADECAAEQEAAYABhYL/QACIBDmAYAAKOFggA6gA6jhYIAT4AOo5mBAFMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAGSADqOFggB6gA6jmYEAewAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIAj4AOo5mBAKMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAKSADqOFggC6gA6jmYEAywAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIAz4AOo4WCAOSADqOZgQDzADECAAEQEAAYABhYL/QACIBDmAYAAKOFggD6gA6jhYIBD4AOo5iBARsAEQIAARAQFGAAYWC/0AAiAQ5gGACjhYIBJIAOo4WCATqADqOZgQFDADECAAEQEAAYABhYL/QACIBDmAYAAKOFggFPgA6jhYIBZIAOo5mBAWsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAXqADqOFggGPgA6jmYEBkwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIBpIAOo4WCAbqADqOZgQG7ADECAAEQEAAYABhYL/QACIBDmAYAAKOFggHPgA6jmYEB4wAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIB5IAOo4WCAfqADqOZgQILADECAAEQEAAYABhYL/QACIBDmAYAAKOFggIPgA6jhYICJIAOo5mBAjMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAjqADqOFggJPgA6jmYECWwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYICZIAOo4WCAnqADqOZgQKDADECAAEQEAAYABhYL/QACIBDmAYAAKOFggKPgA6jhYICpIAOo5mBAqsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCArqADqOFggLPgA6jmIEC0wARAgABEBAUYABhYL/QACIBDmAYAKOFggLkgA6jhYIC+oAOo5mBAvsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAw+ADqOZgQMjADECAAEQEAAYABhYL/QACIBDmAYAAKOFggMkgA6jhYIDOoAOo5mBA0sAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCA0+ADqOFggNkgA6jmYEDcwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIDeoAOo4WCA4+ADqOZgQObADECAAEQEAAYABhYL/QACIBDmAYAAKOFggOkgA6jhYIDuoAOo5mBA8MAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCA8+ADqOFggPkgA6jhYID+oAOo4WCBA+ADhxTu2sBAAAAAAAAEbuPs4EDt4r3gQHxghEr8IEK",mp4:"data:video/mp4;base64,AAAAHGZ0eXBNNFYgAAACAGlzb21pc28yYXZjMQAAAAhmcmVlAAAGF21kYXTeBAAAbGliZmFhYyAxLjI4AABCAJMgBDIARwAAArEGBf//rdxF6b3m2Ui3lizYINkj7u94MjY0IC0gY29yZSAxNDIgcjIgOTU2YzhkOCAtIEguMjY0L01QRUctNCBBVkMgY29kZWMgLSBDb3B5bGVmdCAyMDAzLTIwMTQgLSBodHRwOi8vd3d3LnZpZGVvbGFuLm9yZy94MjY0Lmh0bWwgLSBvcHRpb25zOiBjYWJhYz0wIHJlZj0zIGRlYmxvY2s9MTowOjAgYW5hbHlzZT0weDE6MHgxMTEgbWU9aGV4IHN1Ym1lPTcgcHN5PTEgcHN5X3JkPTEuMDA6MC4wMCBtaXhlZF9yZWY9MSBtZV9yYW5nZT0xNiBjaHJvbWFfbWU9MSB0cmVsbGlzPTEgOHg4ZGN0PTAgY3FtPTAgZGVhZHpvbmU9MjEsMTEgZmFzdF9wc2tpcD0xIGNocm9tYV9xcF9vZmZzZXQ9LTIgdGhyZWFkcz02IGxvb2thaGVhZF90aHJlYWRzPTEgc2xpY2VkX3RocmVhZHM9MCBucj0wIGRlY2ltYXRlPTEgaW50ZXJsYWNlZD0wIGJsdXJheV9jb21wYXQ9MCBjb25zdHJhaW5lZF9pbnRyYT0wIGJmcmFtZXM9MCB3ZWlnaHRwPTAga2V5aW50PTI1MCBrZXlpbnRfbWluPTI1IHNjZW5lY3V0PTQwIGludHJhX3JlZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAuNjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCB2YnZfbWF4cmF0ZT03NjggdmJ2X2J1ZnNpemU9MzAwMCBjcmZfbWF4PTAuMCBuYWxfaHJkPW5vbmUgZmlsbGVyPTAgaXBfcmF0aW89MS40MCBhcT0xOjEuMDAAgAAAAFZliIQL8mKAAKvMnJycnJycnJycnXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXiEASZACGQAjgCEASZACGQAjgAAAAAdBmjgX4GSAIQBJkAIZACOAAAAAB0GaVAX4GSAhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGagC/AySEASZACGQAjgAAAAAZBmqAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZrAL8DJIQBJkAIZACOAAAAABkGa4C/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmwAvwMkhAEmQAhkAI4AAAAAGQZsgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGbQC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm2AvwMkhAEmQAhkAI4AAAAAGQZuAL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGboC/AySEASZACGQAjgAAAAAZBm8AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZvgL8DJIQBJkAIZACOAAAAABkGaAC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmiAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpAL8DJIQBJkAIZACOAAAAABkGaYC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmoAvwMkhAEmQAhkAI4AAAAAGQZqgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGawC/AySEASZACGQAjgAAAAAZBmuAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZsAL8DJIQBJkAIZACOAAAAABkGbIC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm0AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZtgL8DJIQBJkAIZACOAAAAABkGbgCvAySEASZACGQAjgCEASZACGQAjgAAAAAZBm6AnwMkhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AAAAhubW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAABDcAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAzB0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAABAAAAAAAAA+kAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAALAAAACQAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAPpAAAAAAABAAAAAAKobWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAB1MAAAdU5VxAAAAAAALWhkbHIAAAAAAAAAAHZpZGUAAAAAAAAAAAAAAABWaWRlb0hhbmRsZXIAAAACU21pbmYAAAAUdm1oZAAAAAEAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAhNzdGJsAAAAr3N0c2QAAAAAAAAAAQAAAJ9hdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAALAAkABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAALWF2Y0MBQsAN/+EAFWdCwA3ZAsTsBEAAAPpAADqYA8UKkgEABWjLg8sgAAAAHHV1aWRraEDyXyRPxbo5pRvPAyPzAAAAAAAAABhzdHRzAAAAAAAAAAEAAAAeAAAD6QAAABRzdHNzAAAAAAAAAAEAAAABAAAAHHN0c2MAAAAAAAAAAQAAAAEAAAABAAAAAQAAAIxzdHN6AAAAAAAAAAAAAAAeAAADDwAAAAsAAAALAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAAiHN0Y28AAAAAAAAAHgAAAEYAAANnAAADewAAA5gAAAO0AAADxwAAA+MAAAP2AAAEEgAABCUAAARBAAAEXQAABHAAAASMAAAEnwAABLsAAATOAAAE6gAABQYAAAUZAAAFNQAABUgAAAVkAAAFdwAABZMAAAWmAAAFwgAABd4AAAXxAAAGDQAABGh0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAACAAAAAAAABDcAAAAAAAAAAAAAAAEBAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAQkAAADcAABAAAAAAPgbWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAC7gAAAykBVxAAAAAAALWhkbHIAAAAAAAAAAHNvdW4AAAAAAAAAAAAAAABTb3VuZEhhbmRsZXIAAAADi21pbmYAAAAQc21oZAAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAADT3N0YmwAAABnc3RzZAAAAAAAAAABAAAAV21wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAAM2VzZHMAAAAAA4CAgCIAAgAEgICAFEAVBbjYAAu4AAAADcoFgICAAhGQBoCAgAECAAAAIHN0dHMAAAAAAAAAAgAAADIAAAQAAAAAAQAAAkAAAAFUc3RzYwAAAAAAAAAbAAAAAQAAAAEAAAABAAAAAgAAAAIAAAABAAAAAwAAAAEAAAABAAAABAAAAAIAAAABAAAABgAAAAEAAAABAAAABwAAAAIAAAABAAAACAAAAAEAAAABAAAACQAAAAIAAAABAAAACgAAAAEAAAABAAAACwAAAAIAAAABAAAADQAAAAEAAAABAAAADgAAAAIAAAABAAAADwAAAAEAAAABAAAAEAAAAAIAAAABAAAAEQAAAAEAAAABAAAAEgAAAAIAAAABAAAAFAAAAAEAAAABAAAAFQAAAAIAAAABAAAAFgAAAAEAAAABAAAAFwAAAAIAAAABAAAAGAAAAAEAAAABAAAAGQAAAAIAAAABAAAAGgAAAAEAAAABAAAAGwAAAAIAAAABAAAAHQAAAAEAAAABAAAAHgAAAAIAAAABAAAAHwAAAAQAAAABAAAA4HN0c3oAAAAAAAAAAAAAADMAAAAaAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAACMc3RjbwAAAAAAAAAfAAAALAAAA1UAAANyAAADhgAAA6IAAAO+AAAD0QAAA+0AAAQAAAAEHAAABC8AAARLAAAEZwAABHoAAASWAAAEqQAABMUAAATYAAAE9AAABRAAAAUjAAAFPwAABVIAAAVuAAAFgQAABZ0AAAWwAAAFzAAABegAAAX7AAAGFwAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTUuMzMuMTAw"}});var eSe=Fn((uco,JEe)=>{var{webm:ZSt,mp4:$St}=QEe(),p$=()=>typeof navigator<"u"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,_$=()=>"wakeLock"in navigator,g$=class{constructor(){if(this.enabled=!1,_$()){this._wakeLock=null;let t=()=>{this._wakeLock!==null&&document.visibilityState==="visible"&&this.enable()};document.addEventListener("visibilitychange",t),document.addEventListener("fullscreenchange",t)}else p$()?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("title","No Sleep"),this.noSleepVideo.setAttribute("playsinline",""),this._addSourceToVideo(this.noSleepVideo,"webm",ZSt),this._addSourceToVideo(this.noSleepVideo,"mp4",$St),this.noSleepVideo.addEventListener("loadedmetadata",()=>{this.noSleepVideo.duration<=1?this.noSleepVideo.setAttribute("loop",""):this.noSleepVideo.addEventListener("timeupdate",()=>{this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())})}))}_addSourceToVideo(t,n,i){var o=document.createElement("source");o.src=i,o.type=`video/${n}`,t.appendChild(o)}get isEnabled(){return this.enabled}enable(){return _$()?navigator.wakeLock.request("screen").then(t=>{this._wakeLock=t,this.enabled=!0,console.log("Wake Lock active."),this._wakeLock.addEventListener("release",()=>{console.log("Wake Lock released.")})}).catch(t=>{throw this.enabled=!1,console.error(`${t.name}, ${t.message}`),t}):p$()?(this.disable(),console.warn(`
        NoSleep enabled for older iOS devices. This can interrupt
        active or long-running network requests from completing successfully.
        See https://github.com/richtr/NoSleep.js/issues/15 for more details.
      `),this.noSleepTimer=window.setInterval(()=>{document.hidden||(window.location.href=window.location.href.split("#")[0],window.setTimeout(window.stop,0))},15e3),this.enabled=!0,Promise.resolve()):this.noSleepVideo.play().then(n=>(this.enabled=!0,n)).catch(n=>{throw this.enabled=!1,n})}disable(){_$()?(this._wakeLock&&this._wakeLock.release(),this._wakeLock=null):p$()?this.noSleepTimer&&(console.warn(`
          NoSleep now disabled for older iOS devices.
        `),window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause(),this.enabled=!1}};JEe.exports=g$});function CSe(e){return e!=null}var u=CSe;function xy(e){this.name="DeveloperError",this.message=e;let t;try{throw new Error}catch(n){t=n.stack}this.stack=t}u(Object.create)&&(xy.prototype=Object.create(Error.prototype),xy.prototype.constructor=xy);xy.prototype.toString=function(){let e=`${this.name}: ${this.message}`;return u(this.stack)&&(e+=`
${this.stack.toString()}`),e};xy.throwInstantiationError=function(){throw new xy("This function defines an interface and should not be called directly.")};var he=xy;var _s={};_s.typeOf={};function ASe(e){return`${e} is required, actual value was undefined`}function Zb(e,t,n){return`Expected ${n} to be typeof ${t}, actual typeof was ${e}`}_s.defined=function(e,t){if(!u(t))throw new he(ASe(e))};_s.typeOf.func=function(e,t){if(typeof t!="function")throw new he(Zb(typeof t,"function",e))};_s.typeOf.string=function(e,t){if(typeof t!="string")throw new he(Zb(typeof t,"string",e))};_s.typeOf.number=function(e,t){if(typeof t!="number")throw new he(Zb(typeof t,"number",e))};_s.typeOf.number.lessThan=function(e,t,n){if(_s.typeOf.number(e,t),t>=n)throw new he(`Expected ${e} to be less than ${n}, actual value was ${t}`)};_s.typeOf.number.lessThanOrEquals=function(e,t,n){if(_s.typeOf.number(e,t),t>n)throw new he(`Expected ${e} to be less than or equal to ${n}, actual value was ${t}`)};_s.typeOf.number.greaterThan=function(e,t,n){if(_s.typeOf.number(e,t),t<=n)throw new he(`Expected ${e} to be greater than ${n}, actual value was ${t}`)};_s.typeOf.number.greaterThanOrEquals=function(e,t,n){if(_s.typeOf.number(e,t),t<n)throw new he(`Expected ${e} to be greater than or equal to ${n}, actual value was ${t}`)};_s.typeOf.object=function(e,t){if(typeof t!="object")throw new he(Zb(typeof t,"object",e))};_s.typeOf.bool=function(e,t){if(typeof t!="boolean")throw new he(Zb(typeof t,"boolean",e))};_s.typeOf.bigint=function(e,t){if(typeof t!="bigint")throw new he(Zb(typeof t,"bigint",e))};_s.typeOf.number.equals=function(e,t,n,i){if(_s.typeOf.number(e,n),_s.typeOf.number(t,i),n!==i)throw new he(`${e} must be equal to ${t}, the actual values are ${n} and ${i}`)};var To=_s;function T$(e,t){return e??t}T$.EMPTY_OBJECT=Object.freeze({});var x=T$;var b6=Dr(qI(),1);var st={};st.EPSILON1=.1;st.EPSILON2=.01;st.EPSILON3=.001;st.EPSILON4=1e-4;st.EPSILON5=1e-5;st.EPSILON6=1e-6;st.EPSILON7=1e-7;st.EPSILON8=1e-8;st.EPSILON9=1e-9;st.EPSILON10=1e-10;st.EPSILON11=1e-11;st.EPSILON12=1e-12;st.EPSILON13=1e-13;st.EPSILON14=1e-14;st.EPSILON15=1e-15;st.EPSILON16=1e-16;st.EPSILON17=1e-17;st.EPSILON18=1e-18;st.EPSILON19=1e-19;st.EPSILON20=1e-20;st.EPSILON21=1e-21;st.GRAVITATIONALPARAMETER=3986004418e5;st.SOLAR_RADIUS=6955e5;st.LUNAR_RADIUS=1737400;st.SIXTY_FOUR_KILOBYTES=64*1024;st.FOUR_GIGABYTES=4*1024*1024*1024;st.sign=x(Math.sign,function(t){return t=+t,t===0||t!==t?t:t>0?1:-1});st.signNotZero=function(e){return e<0?-1:1};st.toSNorm=function(e,t){return t=x(t,255),Math.round((st.clamp(e,-1,1)*.5+.5)*t)};st.fromSNorm=function(e,t){return t=x(t,255),st.clamp(e,0,t)/t*2-1};st.normalize=function(e,t,n){return n=Math.max(n-t,0),n===0?0:st.clamp((e-t)/n,0,1)};st.sinh=x(Math.sinh,function(t){return(Math.exp(t)-Math.exp(-t))/2});st.cosh=x(Math.cosh,function(t){return(Math.exp(t)+Math.exp(-t))/2});st.lerp=function(e,t,n){return(1-n)*e+n*t};st.PI=Math.PI;st.ONE_OVER_PI=1/Math.PI;st.PI_OVER_TWO=Math.PI/2;st.PI_OVER_THREE=Math.PI/3;st.PI_OVER_FOUR=Math.PI/4;st.PI_OVER_SIX=Math.PI/6;st.THREE_PI_OVER_TWO=3*Math.PI/2;st.TWO_PI=2*Math.PI;st.ONE_OVER_TWO_PI=1/(2*Math.PI);st.RADIANS_PER_DEGREE=Math.PI/180;st.DEGREES_PER_RADIAN=180/Math.PI;st.RADIANS_PER_ARCSECOND=st.RADIANS_PER_DEGREE/3600;st.toRadians=function(e){return e*st.RADIANS_PER_DEGREE};st.toDegrees=function(e){return e*st.DEGREES_PER_RADIAN};st.convertLongitudeRange=function(e){let t=st.TWO_PI,n=e-Math.floor(e/t)*t;return n<-Math.PI?n+t:n>=Math.PI?n-t:n};st.clampToLatitudeRange=function(e){return st.clamp(e,-1*st.PI_OVER_TWO,st.PI_OVER_TWO)};st.negativePiToPi=function(e){return e>=-st.PI&&e<=st.PI?e:st.zeroToTwoPi(e+st.PI)-st.PI};st.zeroToTwoPi=function(e){if(e>=0&&e<=st.TWO_PI)return e;let t=st.mod(e,st.TWO_PI);return Math.abs(t)<st.EPSILON14&&Math.abs(e)>st.EPSILON14?st.TWO_PI:t};st.mod=function(e,t){return st.sign(e)===st.sign(t)&&Math.abs(e)<Math.abs(t)?e:(e%t+t)%t};st.equalsEpsilon=function(e,t,n,i){n=x(n,0),i=x(i,n);let o=Math.abs(e-t);return o<=i||o<=n*Math.max(Math.abs(e),Math.abs(t))};st.lessThan=function(e,t,n){return e-t<-n};st.lessThanOrEquals=function(e,t,n){return e-t<n};st.greaterThan=function(e,t,n){return e-t>n};st.greaterThanOrEquals=function(e,t,n){return e-t>-n};var YI=[1];st.factorial=function(e){let t=YI.length;if(e>=t){let n=YI[t-1];for(let i=t;i<=e;i++){let o=n*i;YI.push(o),n=o}}return YI[e]};st.incrementWrap=function(e,t,n){return n=x(n,0),++e,e>t&&(e=n),e};st.isPowerOfTwo=function(e){return e!==0&&(e&e-1)===0};st.nextPowerOfTwo=function(e){return--e,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e,e};st.previousPowerOfTwo=function(e){return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e|=e>>32,e=(e>>>0)-(e>>>1),e};st.clamp=function(e,t,n){return e<t?t:e>n?n:e};var S$=new b6.default;st.setRandomNumberSeed=function(e){S$=new b6.default(e)};st.nextRandomNumber=function(){return S$.random()};st.randomBetween=function(e,t){return st.nextRandomNumber()*(t-e)+e};st.acosClamped=function(e){return Math.acos(st.clamp(e,-1,1))};st.asinClamped=function(e){return Math.asin(st.clamp(e,-1,1))};st.chordLength=function(e,t){return 2*t*Math.sin(e*.5)};st.logBase=function(e,t){return Math.log(e)/Math.log(t)};st.cbrt=x(Math.cbrt,function(t){let n=Math.pow(Math.abs(t),.3333333333333333);return t<0?-n:n});st.log2=x(Math.log2,function(t){return Math.log(t)*Math.LOG2E});st.fog=function(e,t){let n=e*t;return 1-Math.exp(-(n*n))};st.fastApproximateAtan=function(e){return e*(-.1784*Math.abs(e)-.0663*e*e+1.0301)};st.fastApproximateAtan2=function(e,t){let n,i=Math.abs(e);n=Math.abs(t);let o=Math.max(i,n);n=Math.min(i,n);let r=n/o;return i=st.fastApproximateAtan(r),i=Math.abs(t)>Math.abs(e)?st.PI_OVER_TWO-i:i,i=e<0?st.PI-i:i,i=t<0?-i:i,i};var R=st;function $e(e,t,n){this.x=x(e,0),this.y=x(t,0),this.z=x(n,0)}$e.fromSpherical=function(e,t){u(t)||(t=new $e);let n=e.clock,i=e.cone,o=x(e.magnitude,1),r=o*Math.sin(i);return t.x=r*Math.cos(n),t.y=r*Math.sin(n),t.z=o*Math.cos(i),t};$e.fromElements=function(e,t,n,i){return u(i)?(i.x=e,i.y=t,i.z=n,i):new $e(e,t,n)};$e.clone=function(e,t){if(u(e))return u(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t):new $e(e.x,e.y,e.z)};$e.fromCartesian4=$e.clone;$e.packedLength=3;$e.pack=function(e,t,n){return n=x(n,0),t[n++]=e.x,t[n++]=e.y,t[n]=e.z,t};$e.unpack=function(e,t,n){return t=x(t,0),u(n)||(n=new $e),n.x=e[t++],n.y=e[t++],n.z=e[t],n};$e.packArray=function(e,t){let n=e.length,i=n*3;u(t)?!Array.isArray(t)&&t.length!==i||t.length!==i&&(t.length=i):t=new Array(i);for(let o=0;o<n;++o)$e.pack(e[o],t,o*3);return t};$e.unpackArray=function(e,t){let n=e.length;u(t)?t.length=n/3:t=new Array(n/3);for(let i=0;i<n;i+=3){let o=i/3;t[o]=$e.unpack(e,i,t[o])}return t};$e.fromArray=$e.unpack;$e.maximumComponent=function(e){return Math.max(e.x,e.y,e.z)};$e.minimumComponent=function(e){return Math.min(e.x,e.y,e.z)};$e.minimumByComponent=function(e,t,n){return n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n.z=Math.min(e.z,t.z),n};$e.maximumByComponent=function(e,t,n){return n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n.z=Math.max(e.z,t.z),n};$e.clamp=function(e,t,n,i){let o=R.clamp(e.x,t.x,n.x),r=R.clamp(e.y,t.y,n.y),s=R.clamp(e.z,t.z,n.z);return i.x=o,i.y=r,i.z=s,i};$e.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z};$e.magnitude=function(e){return Math.sqrt($e.magnitudeSquared(e))};var KI=new $e;$e.distance=function(e,t){return $e.subtract(e,t,KI),$e.magnitude(KI)};$e.distanceSquared=function(e,t){return $e.subtract(e,t,KI),$e.magnitudeSquared(KI)};$e.normalize=function(e,t){let n=$e.magnitude(e);return t.x=e.x/n,t.y=e.y/n,t.z=e.z/n,t};$e.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z};$e.multiplyComponents=function(e,t,n){return n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n};$e.divideComponents=function(e,t,n){return n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z,n};$e.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n};$e.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n};$e.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n};$e.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n};$e.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t};$e.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t};var v$=new $e;$e.lerp=function(e,t,n,i){return $e.multiplyByScalar(t,n,v$),i=$e.multiplyByScalar(e,1-n,i),$e.add(v$,i,i)};var XI=new $e,C6=new $e;$e.angleBetween=function(e,t){$e.normalize(e,XI),$e.normalize(t,C6);let n=$e.dot(XI,C6),i=$e.magnitude($e.cross(XI,C6,XI));return Math.atan2(i,n)};var TSe=new $e;$e.mostOrthogonalAxis=function(e,t){let n=$e.normalize(e,TSe);return $e.abs(n,n),n.x<=n.y?n.x<=n.z?t=$e.clone($e.UNIT_X,t):t=$e.clone($e.UNIT_Z,t):n.y<=n.z?t=$e.clone($e.UNIT_Y,t):t=$e.clone($e.UNIT_Z,t),t};$e.projectVector=function(e,t,n){let i=$e.dot(e,t)/$e.dot(t,t);return $e.multiplyByScalar(t,i,n)};$e.equals=function(e,t){return e===t||u(e)&&u(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z};$e.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]};$e.equalsEpsilon=function(e,t,n,i){return e===t||u(e)&&u(t)&&R.equalsEpsilon(e.x,t.x,n,i)&&R.equalsEpsilon(e.y,t.y,n,i)&&R.equalsEpsilon(e.z,t.z,n,i)};$e.cross=function(e,t,n){let i=e.x,o=e.y,r=e.z,s=t.x,a=t.y,c=t.z,l=o*c-r*a,f=r*s-i*c,d=i*a-o*s;return n.x=l,n.y=f,n.z=d,n};$e.midpoint=function(e,t,n){return n.x=(e.x+t.x)*.5,n.y=(e.y+t.y)*.5,n.z=(e.z+t.z)*.5,n};$e.fromDegrees=function(e,t,n,i,o){return e=R.toRadians(e),t=R.toRadians(t),$e.fromRadians(e,t,n,i,o)};var ju=new $e,$b=new $e;$e._ellipsoidRadiiSquared=new $e(6378137*6378137,6378137*6378137,6356752314245179e-9*6356752314245179e-9);$e.fromRadians=function(e,t,n,i,o){n=x(n,0);let r=u(i)?i.radiiSquared:$e._ellipsoidRadiiSquared,s=Math.cos(t);ju.x=s*Math.cos(e),ju.y=s*Math.sin(e),ju.z=Math.sin(t),ju=$e.normalize(ju,ju),$e.multiplyComponents(r,ju,$b);let a=Math.sqrt($e.dot(ju,$b));return $b=$e.divideByScalar($b,a,$b),ju=$e.multiplyByScalar(ju,n,ju),u(o)||(o=new $e),$e.add($b,ju,o)};$e.fromDegreesArray=function(e,t,n){let i=e.length;u(n)?n.length=i/2:n=new Array(i/2);for(let o=0;o<i;o+=2){let r=e[o],s=e[o+1],a=o/2;n[a]=$e.fromDegrees(r,s,0,t,n[a])}return n};$e.fromRadiansArray=function(e,t,n){let i=e.length;u(n)?n.length=i/2:n=new Array(i/2);for(let o=0;o<i;o+=2){let r=e[o],s=e[o+1],a=o/2;n[a]=$e.fromRadians(r,s,0,t,n[a])}return n};$e.fromDegreesArrayHeights=function(e,t,n){let i=e.length;u(n)?n.length=i/3:n=new Array(i/3);for(let o=0;o<i;o+=3){let r=e[o],s=e[o+1],a=e[o+2],c=o/3;n[c]=$e.fromDegrees(r,s,a,t,n[c])}return n};$e.fromRadiansArrayHeights=function(e,t,n){let i=e.length;u(n)?n.length=i/3:n=new Array(i/3);for(let o=0;o<i;o+=3){let r=e[o],s=e[o+1],a=e[o+2],c=o/3;n[c]=$e.fromRadians(r,s,a,t,n[c])}return n};$e.ZERO=Object.freeze(new $e(0,0,0));$e.ONE=Object.freeze(new $e(1,1,1));$e.UNIT_X=Object.freeze(new $e(1,0,0));$e.UNIT_Y=Object.freeze(new $e(0,1,0));$e.UNIT_Z=Object.freeze(new $e(0,0,1));$e.prototype.clone=function(e){return $e.clone(this,e)};$e.prototype.equals=function(e){return $e.equals(this,e)};$e.prototype.equalsEpsilon=function(e,t,n){return $e.equalsEpsilon(this,e,t,n)};$e.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z})`};var h=$e;function yt(e,t,n,i){this.x=x(e,0),this.y=x(t,0),this.z=x(n,0),this.w=x(i,0)}yt.fromElements=function(e,t,n,i,o){return u(o)?(o.x=e,o.y=t,o.z=n,o.w=i,o):new yt(e,t,n,i)};yt.fromColor=function(e,t){return u(t)?(t.x=e.red,t.y=e.green,t.z=e.blue,t.w=e.alpha,t):new yt(e.red,e.green,e.blue,e.alpha)};yt.clone=function(e,t){if(u(e))return u(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new yt(e.x,e.y,e.z,e.w)};yt.packedLength=4;yt.pack=function(e,t,n){return n=x(n,0),t[n++]=e.x,t[n++]=e.y,t[n++]=e.z,t[n]=e.w,t};yt.unpack=function(e,t,n){return t=x(t,0),u(n)||(n=new yt),n.x=e[t++],n.y=e[t++],n.z=e[t++],n.w=e[t],n};yt.packArray=function(e,t){let n=e.length,i=n*4;u(t)?!Array.isArray(t)&&t.length!==i||t.length!==i&&(t.length=i):t=new Array(i);for(let o=0;o<n;++o)yt.pack(e[o],t,o*4);return t};yt.unpackArray=function(e,t){let n=e.length;u(t)?t.length=n/4:t=new Array(n/4);for(let i=0;i<n;i+=4){let o=i/4;t[o]=yt.unpack(e,i,t[o])}return t};yt.fromArray=yt.unpack;yt.maximumComponent=function(e){return Math.max(e.x,e.y,e.z,e.w)};yt.minimumComponent=function(e){return Math.min(e.x,e.y,e.z,e.w)};yt.minimumByComponent=function(e,t,n){return n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n.z=Math.min(e.z,t.z),n.w=Math.min(e.w,t.w),n};yt.maximumByComponent=function(e,t,n){return n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n.z=Math.max(e.z,t.z),n.w=Math.max(e.w,t.w),n};yt.clamp=function(e,t,n,i){let o=R.clamp(e.x,t.x,n.x),r=R.clamp(e.y,t.y,n.y),s=R.clamp(e.z,t.z,n.z),a=R.clamp(e.w,t.w,n.w);return i.x=o,i.y=r,i.z=s,i.w=a,i};yt.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w};yt.magnitude=function(e){return Math.sqrt(yt.magnitudeSquared(e))};var ZI=new yt;yt.distance=function(e,t){return yt.subtract(e,t,ZI),yt.magnitude(ZI)};yt.distanceSquared=function(e,t){return yt.subtract(e,t,ZI),yt.magnitudeSquared(ZI)};yt.normalize=function(e,t){let n=yt.magnitude(e);return t.x=e.x/n,t.y=e.y/n,t.z=e.z/n,t.w=e.w/n,t};yt.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w};yt.multiplyComponents=function(e,t,n){return n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n.w=e.w*t.w,n};yt.divideComponents=function(e,t,n){return n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z,n.w=e.w/t.w,n};yt.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n};yt.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n};yt.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n};yt.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n};yt.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t};yt.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t.w=Math.abs(e.w),t};var w$=new yt;yt.lerp=function(e,t,n,i){return yt.multiplyByScalar(t,n,w$),i=yt.multiplyByScalar(e,1-n,i),yt.add(w$,i,i)};var ESe=new yt;yt.mostOrthogonalAxis=function(e,t){let n=yt.normalize(e,ESe);return yt.abs(n,n),n.x<=n.y?n.x<=n.z?n.x<=n.w?t=yt.clone(yt.UNIT_X,t):t=yt.clone(yt.UNIT_W,t):n.z<=n.w?t=yt.clone(yt.UNIT_Z,t):t=yt.clone(yt.UNIT_W,t):n.y<=n.z?n.y<=n.w?t=yt.clone(yt.UNIT_Y,t):t=yt.clone(yt.UNIT_W,t):n.z<=n.w?t=yt.clone(yt.UNIT_Z,t):t=yt.clone(yt.UNIT_W,t),t};yt.equals=function(e,t){return e===t||u(e)&&u(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w};yt.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]&&e.w===t[n+3]};yt.equalsEpsilon=function(e,t,n,i){return e===t||u(e)&&u(t)&&R.equalsEpsilon(e.x,t.x,n,i)&&R.equalsEpsilon(e.y,t.y,n,i)&&R.equalsEpsilon(e.z,t.z,n,i)&&R.equalsEpsilon(e.w,t.w,n,i)};yt.ZERO=Object.freeze(new yt(0,0,0,0));yt.ONE=Object.freeze(new yt(1,1,1,1));yt.UNIT_X=Object.freeze(new yt(1,0,0,0));yt.UNIT_Y=Object.freeze(new yt(0,1,0,0));yt.UNIT_Z=Object.freeze(new yt(0,0,1,0));yt.UNIT_W=Object.freeze(new yt(0,0,0,1));yt.prototype.clone=function(e){return yt.clone(this,e)};yt.prototype.equals=function(e){return yt.equals(this,e)};yt.prototype.equalsEpsilon=function(e,t,n){return yt.equalsEpsilon(this,e,t,n)};yt.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};var A6=new Float32Array(1),Ua=new Uint8Array(A6.buffer),SSe=new Uint32Array([287454020]),vSe=new Uint8Array(SSe.buffer),D$=vSe[0]===68;yt.packFloat=function(e,t){return u(t)||(t=new yt),A6[0]=e,D$?(t.x=Ua[0],t.y=Ua[1],t.z=Ua[2],t.w=Ua[3]):(t.x=Ua[3],t.y=Ua[2],t.z=Ua[1],t.w=Ua[0]),t};yt.unpackFloat=function(e){return D$?(Ua[0]=e.x,Ua[1]=e.y,Ua[2]=e.z,Ua[3]=e.w):(Ua[0]=e.w,Ua[1]=e.z,Ua[2]=e.y,Ua[3]=e.x),A6[0]};var oe=yt;function et(e,t,n,i,o,r,s,a,c){this[0]=x(e,0),this[1]=x(i,0),this[2]=x(s,0),this[3]=x(t,0),this[4]=x(o,0),this[5]=x(a,0),this[6]=x(n,0),this[7]=x(r,0),this[8]=x(c,0)}et.packedLength=9;et.pack=function(e,t,n){return n=x(n,0),t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t[n++]=e[4],t[n++]=e[5],t[n++]=e[6],t[n++]=e[7],t[n++]=e[8],t};et.unpack=function(e,t,n){return t=x(t,0),u(n)||(n=new et),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n[4]=e[t++],n[5]=e[t++],n[6]=e[t++],n[7]=e[t++],n[8]=e[t++],n};et.packArray=function(e,t){let n=e.length,i=n*9;u(t)?!Array.isArray(t)&&t.length!==i||t.length!==i&&(t.length=i):t=new Array(i);for(let o=0;o<n;++o)et.pack(e[o],t,o*9);return t};et.unpackArray=function(e,t){let n=e.length;u(t)?t.length=n/9:t=new Array(n/9);for(let i=0;i<n;i+=9){let o=i/9;t[o]=et.unpack(e,i,t[o])}return t};et.clone=function(e,t){if(u(e))return u(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):new et(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])};et.fromArray=et.unpack;et.fromColumnMajorArray=function(e,t){return et.clone(e,t)};et.fromRowMajorArray=function(e,t){return u(t)?(t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t):new et(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])};et.fromQuaternion=function(e,t){let n=e.x*e.x,i=e.x*e.y,o=e.x*e.z,r=e.x*e.w,s=e.y*e.y,a=e.y*e.z,c=e.y*e.w,l=e.z*e.z,f=e.z*e.w,d=e.w*e.w,p=n-s-l+d,g=2*(i-f),m=2*(o+c),y=2*(i+f),b=-n+s-l+d,C=2*(a-r),A=2*(o-c),T=2*(a+r),E=-n-s+l+d;return u(t)?(t[0]=p,t[1]=y,t[2]=A,t[3]=g,t[4]=b,t[5]=T,t[6]=m,t[7]=C,t[8]=E,t):new et(p,g,m,y,b,C,A,T,E)};et.fromHeadingPitchRoll=function(e,t){let n=Math.cos(-e.pitch),i=Math.cos(-e.heading),o=Math.cos(e.roll),r=Math.sin(-e.pitch),s=Math.sin(-e.heading),a=Math.sin(e.roll),c=n*i,l=-o*s+a*r*i,f=a*s+o*r*i,d=n*s,p=o*i+a*r*s,g=-a*i+o*r*s,m=-r,y=a*n,b=o*n;return u(t)?(t[0]=c,t[1]=d,t[2]=m,t[3]=l,t[4]=p,t[5]=y,t[6]=f,t[7]=g,t[8]=b,t):new et(c,l,f,d,p,g,m,y,b)};et.fromScale=function(e,t){return u(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=e.y,t[5]=0,t[6]=0,t[7]=0,t[8]=e.z,t):new et(e.x,0,0,0,e.y,0,0,0,e.z)};et.fromUniformScale=function(e,t){return u(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=e,t):new et(e,0,0,0,e,0,0,0,e)};et.fromCrossProduct=function(e,t){return u(t)?(t[0]=0,t[1]=e.z,t[2]=-e.y,t[3]=-e.z,t[4]=0,t[5]=e.x,t[6]=e.y,t[7]=-e.x,t[8]=0,t):new et(0,-e.z,e.y,e.z,0,-e.x,-e.y,e.x,0)};et.fromRotationX=function(e,t){let n=Math.cos(e),i=Math.sin(e);return u(t)?(t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=n,t[5]=i,t[6]=0,t[7]=-i,t[8]=n,t):new et(1,0,0,0,n,-i,0,i,n)};et.fromRotationY=function(e,t){let n=Math.cos(e),i=Math.sin(e);return u(t)?(t[0]=n,t[1]=0,t[2]=-i,t[3]=0,t[4]=1,t[5]=0,t[6]=i,t[7]=0,t[8]=n,t):new et(n,0,i,0,1,0,-i,0,n)};et.fromRotationZ=function(e,t){let n=Math.cos(e),i=Math.sin(e);return u(t)?(t[0]=n,t[1]=i,t[2]=0,t[3]=-i,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new et(n,-i,0,i,n,0,0,0,1)};et.toArray=function(e,t){return u(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]};et.getElementIndex=function(e,t){return e*3+t};et.getColumn=function(e,t,n){let i=t*3,o=e[i],r=e[i+1],s=e[i+2];return n.x=o,n.y=r,n.z=s,n};et.setColumn=function(e,t,n,i){i=et.clone(e,i);let o=t*3;return i[o]=n.x,i[o+1]=n.y,i[o+2]=n.z,i};et.getRow=function(e,t,n){let i=e[t],o=e[t+3],r=e[t+6];return n.x=i,n.y=o,n.z=r,n};et.setRow=function(e,t,n,i){return i=et.clone(e,i),i[t]=n.x,i[t+3]=n.y,i[t+6]=n.z,i};var wSe=new h;et.setScale=function(e,t,n){let i=et.getScale(e,wSe),o=t.x/i.x,r=t.y/i.y,s=t.z/i.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3]*r,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*s,n[7]=e[7]*s,n[8]=e[8]*s,n};var DSe=new h;et.setUniformScale=function(e,t,n){let i=et.getScale(e,DSe),o=t/i.x,r=t/i.y,s=t/i.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3]*r,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*s,n[7]=e[7]*s,n[8]=e[8]*s,n};var T6=new h;et.getScale=function(e,t){return t.x=h.magnitude(h.fromElements(e[0],e[1],e[2],T6)),t.y=h.magnitude(h.fromElements(e[3],e[4],e[5],T6)),t.z=h.magnitude(h.fromElements(e[6],e[7],e[8],T6)),t};var I$=new h;et.getMaximumScale=function(e){return et.getScale(e,I$),h.maximumComponent(I$)};var ISe=new h;et.setRotation=function(e,t,n){let i=et.getScale(e,ISe);return n[0]=t[0]*i.x,n[1]=t[1]*i.x,n[2]=t[2]*i.x,n[3]=t[3]*i.y,n[4]=t[4]*i.y,n[5]=t[5]*i.y,n[6]=t[6]*i.z,n[7]=t[7]*i.z,n[8]=t[8]*i.z,n};var PSe=new h;et.getRotation=function(e,t){let n=et.getScale(e,PSe);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.x,t[3]=e[3]/n.y,t[4]=e[4]/n.y,t[5]=e[5]/n.y,t[6]=e[6]/n.z,t[7]=e[7]/n.z,t[8]=e[8]/n.z,t};et.multiply=function(e,t,n){let i=e[0]*t[0]+e[3]*t[1]+e[6]*t[2],o=e[1]*t[0]+e[4]*t[1]+e[7]*t[2],r=e[2]*t[0]+e[5]*t[1]+e[8]*t[2],s=e[0]*t[3]+e[3]*t[4]+e[6]*t[5],a=e[1]*t[3]+e[4]*t[4]+e[7]*t[5],c=e[2]*t[3]+e[5]*t[4]+e[8]*t[5],l=e[0]*t[6]+e[3]*t[7]+e[6]*t[8],f=e[1]*t[6]+e[4]*t[7]+e[7]*t[8],d=e[2]*t[6]+e[5]*t[7]+e[8]*t[8];return n[0]=i,n[1]=o,n[2]=r,n[3]=s,n[4]=a,n[5]=c,n[6]=l,n[7]=f,n[8]=d,n};et.add=function(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n};et.subtract=function(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n};et.multiplyByVector=function(e,t,n){let i=t.x,o=t.y,r=t.z,s=e[0]*i+e[3]*o+e[6]*r,a=e[1]*i+e[4]*o+e[7]*r,c=e[2]*i+e[5]*o+e[8]*r;return n.x=s,n.y=a,n.z=c,n};et.multiplyByScalar=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n};et.multiplyByScale=function(e,t,n){return n[0]=e[0]*t.x,n[1]=e[1]*t.x,n[2]=e[2]*t.x,n[3]=e[3]*t.y,n[4]=e[4]*t.y,n[5]=e[5]*t.y,n[6]=e[6]*t.z,n[7]=e[7]*t.z,n[8]=e[8]*t.z,n};et.multiplyByUniformScale=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n};et.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t};et.transpose=function(e,t){let n=e[0],i=e[3],o=e[6],r=e[1],s=e[4],a=e[7],c=e[2],l=e[5],f=e[8];return t[0]=n,t[1]=i,t[2]=o,t[3]=r,t[4]=s,t[5]=a,t[6]=c,t[7]=l,t[8]=f,t};function RSe(e){let t=0;for(let n=0;n<9;++n){let i=e[n];t+=i*i}return Math.sqrt(t)}var E6=[1,0,0],S6=[2,2,1];function OSe(e){let t=0;for(let n=0;n<3;++n){let i=e[et.getElementIndex(S6[n],E6[n])];t+=2*i*i}return Math.sqrt(t)}function MSe(e,t){let n=R.EPSILON15,i=0,o=1;for(let l=0;l<3;++l){let f=Math.abs(e[et.getElementIndex(S6[l],E6[l])]);f>i&&(o=l,i=f)}let r=1,s=0,a=E6[o],c=S6[o];if(Math.abs(e[et.getElementIndex(c,a)])>n){let l=e[et.getElementIndex(c,c)],f=e[et.getElementIndex(a,a)],d=e[et.getElementIndex(c,a)],p=(l-f)/2/d,g;p<0?g=-1/(-p+Math.sqrt(1+p*p)):g=1/(p+Math.sqrt(1+p*p)),r=1/Math.sqrt(1+g*g),s=g*r}return t=et.clone(et.IDENTITY,t),t[et.getElementIndex(a,a)]=t[et.getElementIndex(c,c)]=r,t[et.getElementIndex(c,a)]=s,t[et.getElementIndex(a,c)]=-s,t}var $I=new et,P$=new et;et.computeEigenDecomposition=function(e,t){let n=R.EPSILON20,i=10,o=0,r=0;u(t)||(t={});let s=t.unitary=et.clone(et.IDENTITY,t.unitary),a=t.diagonal=et.clone(e,t.diagonal),c=n*RSe(a);for(;r<i&&OSe(a)>c;)MSe(a,$I),et.transpose($I,P$),et.multiply(a,$I,a),et.multiply(P$,a,a),et.multiply(s,$I,s),++o>2&&(++r,o=0);return t};et.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t};et.determinant=function(e){let t=e[0],n=e[3],i=e[6],o=e[1],r=e[4],s=e[7],a=e[2],c=e[5],l=e[8];return t*(r*l-c*s)+o*(c*i-n*l)+a*(n*s-r*i)};et.inverse=function(e,t){let n=e[0],i=e[1],o=e[2],r=e[3],s=e[4],a=e[5],c=e[6],l=e[7],f=e[8],d=et.determinant(e);t[0]=s*f-l*a,t[1]=l*o-i*f,t[2]=i*a-s*o,t[3]=c*a-r*f,t[4]=n*f-c*o,t[5]=r*o-n*a,t[6]=r*l-c*s,t[7]=c*i-n*l,t[8]=n*s-r*i;let p=1/d;return et.multiplyByScalar(t,p,t)};var LSe=new et;et.inverseTranspose=function(e,t){return et.inverse(et.transpose(e,LSe),t)};et.equals=function(e,t){return e===t||u(e)&&u(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]};et.equalsEpsilon=function(e,t,n){return n=x(n,0),e===t||u(e)&&u(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n&&Math.abs(e[4]-t[4])<=n&&Math.abs(e[5]-t[5])<=n&&Math.abs(e[6]-t[6])<=n&&Math.abs(e[7]-t[7])<=n&&Math.abs(e[8]-t[8])<=n};et.IDENTITY=Object.freeze(new et(1,0,0,0,1,0,0,0,1));et.ZERO=Object.freeze(new et(0,0,0,0,0,0,0,0,0));et.COLUMN0ROW0=0;et.COLUMN0ROW1=1;et.COLUMN0ROW2=2;et.COLUMN1ROW0=3;et.COLUMN1ROW1=4;et.COLUMN1ROW2=5;et.COLUMN2ROW0=6;et.COLUMN2ROW1=7;et.COLUMN2ROW2=8;Object.defineProperties(et.prototype,{length:{get:function(){return et.packedLength}}});et.prototype.clone=function(e){return et.clone(this,e)};et.prototype.equals=function(e){return et.equals(this,e)};et.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]};et.prototype.equalsEpsilon=function(e,t){return et.equalsEpsilon(this,e,t)};et.prototype.toString=function(){return`(${this[0]}, ${this[3]}, ${this[6]})
(${this[1]}, ${this[4]}, ${this[7]})
(${this[2]}, ${this[5]}, ${this[8]})`};var J=et;function RS(e){this.name="RuntimeError",this.message=e;let t;try{throw new Error}catch(n){t=n.stack}this.stack=t}u(Object.create)&&(RS.prototype=Object.create(Error.prototype),RS.prototype.constructor=RS);RS.prototype.toString=function(){let e=`${this.name}: ${this.message}`;return u(this.stack)&&(e+=`
${this.stack.toString()}`),e};var ce=RS;function Je(e,t,n,i,o,r,s,a,c,l,f,d,p,g,m,y){this[0]=x(e,0),this[1]=x(o,0),this[2]=x(c,0),this[3]=x(p,0),this[4]=x(t,0),this[5]=x(r,0),this[6]=x(l,0),this[7]=x(g,0),this[8]=x(n,0),this[9]=x(s,0),this[10]=x(f,0),this[11]=x(m,0),this[12]=x(i,0),this[13]=x(a,0),this[14]=x(d,0),this[15]=x(y,0)}Je.packedLength=16;Je.pack=function(e,t,n){return n=x(n,0),t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t[n++]=e[4],t[n++]=e[5],t[n++]=e[6],t[n++]=e[7],t[n++]=e[8],t[n++]=e[9],t[n++]=e[10],t[n++]=e[11],t[n++]=e[12],t[n++]=e[13],t[n++]=e[14],t[n]=e[15],t};Je.unpack=function(e,t,n){return t=x(t,0),u(n)||(n=new Je),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n[4]=e[t++],n[5]=e[t++],n[6]=e[t++],n[7]=e[t++],n[8]=e[t++],n[9]=e[t++],n[10]=e[t++],n[11]=e[t++],n[12]=e[t++],n[13]=e[t++],n[14]=e[t++],n[15]=e[t],n};Je.packArray=function(e,t){let n=e.length,i=n*16;u(t)?!Array.isArray(t)&&t.length!==i||t.length!==i&&(t.length=i):t=new Array(i);for(let o=0;o<n;++o)Je.pack(e[o],t,o*16);return t};Je.unpackArray=function(e,t){let n=e.length;u(t)?t.length=n/16:t=new Array(n/16);for(let i=0;i<n;i+=16){let o=i/16;t[o]=Je.unpack(e,i,t[o])}return t};Je.clone=function(e,t){if(u(e))return u(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):new Je(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])};Je.fromArray=Je.unpack;Je.fromColumnMajorArray=function(e,t){return Je.clone(e,t)};Je.fromRowMajorArray=function(e,t){return u(t)?(t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t):new Je(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])};Je.fromRotationTranslation=function(e,t,n){return t=x(t,h.ZERO),u(n)?(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=0,n[4]=e[3],n[5]=e[4],n[6]=e[5],n[7]=0,n[8]=e[6],n[9]=e[7],n[10]=e[8],n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,n):new Je(e[0],e[3],e[6],t.x,e[1],e[4],e[7],t.y,e[2],e[5],e[8],t.z,0,0,0,1)};Je.fromTranslationQuaternionRotationScale=function(e,t,n,i){u(i)||(i=new Je);let o=n.x,r=n.y,s=n.z,a=t.x*t.x,c=t.x*t.y,l=t.x*t.z,f=t.x*t.w,d=t.y*t.y,p=t.y*t.z,g=t.y*t.w,m=t.z*t.z,y=t.z*t.w,b=t.w*t.w,C=a-d-m+b,A=2*(c-y),T=2*(l+g),E=2*(c+y),v=-a+d-m+b,D=2*(p-f),O=2*(l-g),P=2*(p+f),M=-a-d+m+b;return i[0]=C*o,i[1]=E*o,i[2]=O*o,i[3]=0,i[4]=A*r,i[5]=v*r,i[6]=P*r,i[7]=0,i[8]=T*s,i[9]=D*s,i[10]=M*s,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,i};Je.fromTranslationRotationScale=function(e,t){return Je.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t)};Je.fromTranslation=function(e,t){return Je.fromRotationTranslation(J.IDENTITY,e,t)};Je.fromScale=function(e,t){return u(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e.y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e.z,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new Je(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1)};Je.fromUniformScale=function(e,t){return u(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new Je(e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1)};Je.fromRotation=function(e,t){return u(t)||(t=new Je),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=0,t[4]=e[3],t[5]=e[4],t[6]=e[5],t[7]=0,t[8]=e[6],t[9]=e[7],t[10]=e[8],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t};var Qb=new h,Jb=new h,OS=new h;Je.fromCamera=function(e,t){let n=e.position,i=e.direction,o=e.up;h.normalize(i,Qb),h.normalize(h.cross(Qb,o,Jb),Jb),h.normalize(h.cross(Jb,Qb,OS),OS);let r=Jb.x,s=Jb.y,a=Jb.z,c=Qb.x,l=Qb.y,f=Qb.z,d=OS.x,p=OS.y,g=OS.z,m=n.x,y=n.y,b=n.z,C=r*-m+s*-y+a*-b,A=d*-m+p*-y+g*-b,T=c*m+l*y+f*b;return u(t)?(t[0]=r,t[1]=d,t[2]=-c,t[3]=0,t[4]=s,t[5]=p,t[6]=-l,t[7]=0,t[8]=a,t[9]=g,t[10]=-f,t[11]=0,t[12]=C,t[13]=A,t[14]=T,t[15]=1,t):new Je(r,s,a,C,d,p,g,A,-c,-l,-f,T,0,0,0,1)};Je.computePerspectiveFieldOfView=function(e,t,n,i,o){let s=1/Math.tan(e*.5),a=s/t,c=(i+n)/(n-i),l=2*i*n/(n-i);return o[0]=a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=s,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=c,o[11]=-1,o[12]=0,o[13]=0,o[14]=l,o[15]=0,o};Je.computeOrthographicOffCenter=function(e,t,n,i,o,r,s){let a=1/(t-e),c=1/(i-n),l=1/(r-o),f=-(t+e)*a,d=-(i+n)*c,p=-(r+o)*l;return a*=2,c*=2,l*=-2,s[0]=a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=c,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=l,s[11]=0,s[12]=f,s[13]=d,s[14]=p,s[15]=1,s};Je.computePerspectiveOffCenter=function(e,t,n,i,o,r,s){let a=2*o/(t-e),c=2*o/(i-n),l=(t+e)/(t-e),f=(i+n)/(i-n),d=-(r+o)/(r-o),p=-1,g=-2*r*o/(r-o);return s[0]=a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=c,s[6]=0,s[7]=0,s[8]=l,s[9]=f,s[10]=d,s[11]=p,s[12]=0,s[13]=0,s[14]=g,s[15]=0,s};Je.computeInfinitePerspectiveOffCenter=function(e,t,n,i,o,r){let s=2*o/(t-e),a=2*o/(i-n),c=(t+e)/(t-e),l=(i+n)/(i-n),f=-1,d=-1,p=-2*o;return r[0]=s,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=c,r[9]=l,r[10]=f,r[11]=d,r[12]=0,r[13]=0,r[14]=p,r[15]=0,r};Je.computeViewportTransformation=function(e,t,n,i){u(i)||(i=new Je),e=x(e,x.EMPTY_OBJECT);let o=x(e.x,0),r=x(e.y,0),s=x(e.width,0),a=x(e.height,0);t=x(t,0),n=x(n,1);let c=s*.5,l=a*.5,f=(n-t)*.5,d=c,p=l,g=f,m=o+c,y=r+l,b=t+f,C=1;return i[0]=d,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=p,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=g,i[11]=0,i[12]=m,i[13]=y,i[14]=b,i[15]=C,i};Je.computeView=function(e,t,n,i,o){return o[0]=i.x,o[1]=n.x,o[2]=-t.x,o[3]=0,o[4]=i.y,o[5]=n.y,o[6]=-t.y,o[7]=0,o[8]=i.z,o[9]=n.z,o[10]=-t.z,o[11]=0,o[12]=-h.dot(i,e),o[13]=-h.dot(n,e),o[14]=h.dot(t,e),o[15]=1,o};Je.toArray=function(e,t){return u(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]};Je.getElementIndex=function(e,t){return e*4+t};Je.getColumn=function(e,t,n){let i=t*4,o=e[i],r=e[i+1],s=e[i+2],a=e[i+3];return n.x=o,n.y=r,n.z=s,n.w=a,n};Je.setColumn=function(e,t,n,i){i=Je.clone(e,i);let o=t*4;return i[o]=n.x,i[o+1]=n.y,i[o+2]=n.z,i[o+3]=n.w,i};Je.getRow=function(e,t,n){let i=e[t],o=e[t+4],r=e[t+8],s=e[t+12];return n.x=i,n.y=o,n.z=r,n.w=s,n};Je.setRow=function(e,t,n,i){return i=Je.clone(e,i),i[t]=n.x,i[t+4]=n.y,i[t+8]=n.z,i[t+12]=n.w,i};Je.setTranslation=function(e,t,n){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=e[15],n};var NSe=new h;Je.setScale=function(e,t,n){let i=Je.getScale(e,NSe),o=t.x/i.x,r=t.y/i.y,s=t.z/i.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3],n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7],n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};var FSe=new h;Je.setUniformScale=function(e,t,n){let i=Je.getScale(e,FSe),o=t/i.x,r=t/i.y,s=t/i.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3],n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7],n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};var v6=new h;Je.getScale=function(e,t){return t.x=h.magnitude(h.fromElements(e[0],e[1],e[2],v6)),t.y=h.magnitude(h.fromElements(e[4],e[5],e[6],v6)),t.z=h.magnitude(h.fromElements(e[8],e[9],e[10],v6)),t};var R$=new h;Je.getMaximumScale=function(e){return Je.getScale(e,R$),h.maximumComponent(R$)};var BSe=new h;Je.setRotation=function(e,t,n){let i=Je.getScale(e,BSe);return n[0]=t[0]*i.x,n[1]=t[1]*i.x,n[2]=t[2]*i.x,n[3]=e[3],n[4]=t[3]*i.y,n[5]=t[4]*i.y,n[6]=t[5]*i.y,n[7]=e[7],n[8]=t[6]*i.z,n[9]=t[7]*i.z,n[10]=t[8]*i.z,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};var kSe=new h;Je.getRotation=function(e,t){let n=Je.getScale(e,kSe);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.x,t[3]=e[4]/n.y,t[4]=e[5]/n.y,t[5]=e[6]/n.y,t[6]=e[8]/n.z,t[7]=e[9]/n.z,t[8]=e[10]/n.z,t};Je.multiply=function(e,t,n){let i=e[0],o=e[1],r=e[2],s=e[3],a=e[4],c=e[5],l=e[6],f=e[7],d=e[8],p=e[9],g=e[10],m=e[11],y=e[12],b=e[13],C=e[14],A=e[15],T=t[0],E=t[1],v=t[2],D=t[3],O=t[4],P=t[5],M=t[6],L=t[7],_=t[8],S=t[9],w=t[10],I=t[11],N=t[12],k=t[13],z=t[14],V=t[15],U=i*T+a*E+d*v+y*D,B=o*T+c*E+p*v+b*D,W=r*T+l*E+g*v+C*D,j=s*T+f*E+m*v+A*D,Q=i*O+a*P+d*M+y*L,q=o*O+c*P+p*M+b*L,X=r*O+l*P+g*M+C*L,Z=s*O+f*P+m*M+A*L,fe=i*_+a*S+d*w+y*I,xe=o*_+c*S+p*w+b*I,re=r*_+l*S+g*w+C*I,pe=s*_+f*S+m*w+A*I,ye=i*N+a*k+d*z+y*V,Se=o*N+c*k+p*z+b*V,Te=r*N+l*k+g*z+C*V,Fe=s*N+f*k+m*z+A*V;return n[0]=U,n[1]=B,n[2]=W,n[3]=j,n[4]=Q,n[5]=q,n[6]=X,n[7]=Z,n[8]=fe,n[9]=xe,n[10]=re,n[11]=pe,n[12]=ye,n[13]=Se,n[14]=Te,n[15]=Fe,n};Je.add=function(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n[9]=e[9]+t[9],n[10]=e[10]+t[10],n[11]=e[11]+t[11],n[12]=e[12]+t[12],n[13]=e[13]+t[13],n[14]=e[14]+t[14],n[15]=e[15]+t[15],n};Je.subtract=function(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n[9]=e[9]-t[9],n[10]=e[10]-t[10],n[11]=e[11]-t[11],n[12]=e[12]-t[12],n[13]=e[13]-t[13],n[14]=e[14]-t[14],n[15]=e[15]-t[15],n};Je.multiplyTransformation=function(e,t,n){let i=e[0],o=e[1],r=e[2],s=e[4],a=e[5],c=e[6],l=e[8],f=e[9],d=e[10],p=e[12],g=e[13],m=e[14],y=t[0],b=t[1],C=t[2],A=t[4],T=t[5],E=t[6],v=t[8],D=t[9],O=t[10],P=t[12],M=t[13],L=t[14],_=i*y+s*b+l*C,S=o*y+a*b+f*C,w=r*y+c*b+d*C,I=i*A+s*T+l*E,N=o*A+a*T+f*E,k=r*A+c*T+d*E,z=i*v+s*D+l*O,V=o*v+a*D+f*O,U=r*v+c*D+d*O,B=i*P+s*M+l*L+p,W=o*P+a*M+f*L+g,j=r*P+c*M+d*L+m;return n[0]=_,n[1]=S,n[2]=w,n[3]=0,n[4]=I,n[5]=N,n[6]=k,n[7]=0,n[8]=z,n[9]=V,n[10]=U,n[11]=0,n[12]=B,n[13]=W,n[14]=j,n[15]=1,n};Je.multiplyByMatrix3=function(e,t,n){let i=e[0],o=e[1],r=e[2],s=e[4],a=e[5],c=e[6],l=e[8],f=e[9],d=e[10],p=t[0],g=t[1],m=t[2],y=t[3],b=t[4],C=t[5],A=t[6],T=t[7],E=t[8],v=i*p+s*g+l*m,D=o*p+a*g+f*m,O=r*p+c*g+d*m,P=i*y+s*b+l*C,M=o*y+a*b+f*C,L=r*y+c*b+d*C,_=i*A+s*T+l*E,S=o*A+a*T+f*E,w=r*A+c*T+d*E;return n[0]=v,n[1]=D,n[2]=O,n[3]=0,n[4]=P,n[5]=M,n[6]=L,n[7]=0,n[8]=_,n[9]=S,n[10]=w,n[11]=0,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};Je.multiplyByTranslation=function(e,t,n){let i=t.x,o=t.y,r=t.z,s=i*e[0]+o*e[4]+r*e[8]+e[12],a=i*e[1]+o*e[5]+r*e[9]+e[13],c=i*e[2]+o*e[6]+r*e[10]+e[14];return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=s,n[13]=a,n[14]=c,n[15]=e[15],n};Je.multiplyByScale=function(e,t,n){let i=t.x,o=t.y,r=t.z;return i===1&&o===1&&r===1?Je.clone(e,n):(n[0]=i*e[0],n[1]=i*e[1],n[2]=i*e[2],n[3]=e[3],n[4]=o*e[4],n[5]=o*e[5],n[6]=o*e[6],n[7]=e[7],n[8]=r*e[8],n[9]=r*e[9],n[10]=r*e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n)};Je.multiplyByUniformScale=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3],n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7],n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};Je.multiplyByVector=function(e,t,n){let i=t.x,o=t.y,r=t.z,s=t.w,a=e[0]*i+e[4]*o+e[8]*r+e[12]*s,c=e[1]*i+e[5]*o+e[9]*r+e[13]*s,l=e[2]*i+e[6]*o+e[10]*r+e[14]*s,f=e[3]*i+e[7]*o+e[11]*r+e[15]*s;return n.x=a,n.y=c,n.z=l,n.w=f,n};Je.multiplyByPointAsVector=function(e,t,n){let i=t.x,o=t.y,r=t.z,s=e[0]*i+e[4]*o+e[8]*r,a=e[1]*i+e[5]*o+e[9]*r,c=e[2]*i+e[6]*o+e[10]*r;return n.x=s,n.y=a,n.z=c,n};Je.multiplyByPoint=function(e,t,n){let i=t.x,o=t.y,r=t.z,s=e[0]*i+e[4]*o+e[8]*r+e[12],a=e[1]*i+e[5]*o+e[9]*r+e[13],c=e[2]*i+e[6]*o+e[10]*r+e[14];return n.x=s,n.y=a,n.z=c,n};Je.multiplyByScalar=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11]*t,n[12]=e[12]*t,n[13]=e[13]*t,n[14]=e[14]*t,n[15]=e[15]*t,n};Je.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t};Je.transpose=function(e,t){let n=e[1],i=e[2],o=e[3],r=e[6],s=e[7],a=e[11];return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=r,t[10]=e[10],t[11]=e[14],t[12]=o,t[13]=s,t[14]=a,t[15]=e[15],t};Je.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t[9]=Math.abs(e[9]),t[10]=Math.abs(e[10]),t[11]=Math.abs(e[11]),t[12]=Math.abs(e[12]),t[13]=Math.abs(e[13]),t[14]=Math.abs(e[14]),t[15]=Math.abs(e[15]),t};Je.equals=function(e,t){return e===t||u(e)&&u(t)&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[3]===t[3]&&e[7]===t[7]&&e[11]===t[11]&&e[15]===t[15]};Je.equalsEpsilon=function(e,t,n){return n=x(n,0),e===t||u(e)&&u(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n&&Math.abs(e[4]-t[4])<=n&&Math.abs(e[5]-t[5])<=n&&Math.abs(e[6]-t[6])<=n&&Math.abs(e[7]-t[7])<=n&&Math.abs(e[8]-t[8])<=n&&Math.abs(e[9]-t[9])<=n&&Math.abs(e[10]-t[10])<=n&&Math.abs(e[11]-t[11])<=n&&Math.abs(e[12]-t[12])<=n&&Math.abs(e[13]-t[13])<=n&&Math.abs(e[14]-t[14])<=n&&Math.abs(e[15]-t[15])<=n};Je.getTranslation=function(e,t){return t.x=e[12],t.y=e[13],t.z=e[14],t};Je.getMatrix3=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t};var VSe=new J,USe=new J,zSe=new oe,HSe=new oe(0,0,0,1);Je.inverse=function(e,t){let n=e[0],i=e[4],o=e[8],r=e[12],s=e[1],a=e[5],c=e[9],l=e[13],f=e[2],d=e[6],p=e[10],g=e[14],m=e[3],y=e[7],b=e[11],C=e[15],A=p*C,T=g*b,E=d*C,v=g*y,D=d*b,O=p*y,P=f*C,M=g*m,L=f*b,_=p*m,S=f*y,w=d*m,I=A*a+v*c+D*l-(T*a+E*c+O*l),N=T*s+P*c+_*l-(A*s+M*c+L*l),k=E*s+M*a+S*l-(v*s+P*a+w*l),z=O*s+L*a+w*c-(D*s+_*a+S*c),V=T*i+E*o+O*r-(A*i+v*o+D*r),U=A*n+M*o+L*r-(T*n+P*o+_*r),B=v*n+P*i+w*r-(E*n+M*i+S*r),W=D*n+_*i+S*o-(O*n+L*i+w*o);A=o*l,T=r*c,E=i*l,v=r*a,D=i*c,O=o*a,P=n*l,M=r*s,L=n*c,_=o*s,S=n*a,w=i*s;let j=A*y+v*b+D*C-(T*y+E*b+O*C),Q=T*m+P*b+_*C-(A*m+M*b+L*C),q=E*m+M*y+S*C-(v*m+P*y+w*C),X=O*m+L*y+w*b-(D*m+_*y+S*b),Z=E*p+O*g+T*d-(D*g+A*d+v*p),fe=L*g+A*f+M*p-(P*p+_*g+T*f),xe=P*d+w*g+v*f-(S*g+E*f+M*d),re=S*p+D*f+_*d-(L*d+w*p+O*f),pe=n*I+i*N+o*k+r*z;if(Math.abs(pe)<R.EPSILON21){if(J.equalsEpsilon(Je.getMatrix3(e,VSe),USe,R.EPSILON7)&&oe.equals(Je.getRow(e,3,zSe),HSe))return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=0,t[11]=0,t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=1,t;throw new ce("matrix is not invertible because its determinate is zero.")}return pe=1/pe,t[0]=I*pe,t[1]=N*pe,t[2]=k*pe,t[3]=z*pe,t[4]=V*pe,t[5]=U*pe,t[6]=B*pe,t[7]=W*pe,t[8]=j*pe,t[9]=Q*pe,t[10]=q*pe,t[11]=X*pe,t[12]=Z*pe,t[13]=fe*pe,t[14]=xe*pe,t[15]=re*pe,t};Je.inverseTransformation=function(e,t){let n=e[0],i=e[1],o=e[2],r=e[4],s=e[5],a=e[6],c=e[8],l=e[9],f=e[10],d=e[12],p=e[13],g=e[14],m=-n*d-i*p-o*g,y=-r*d-s*p-a*g,b=-c*d-l*p-f*g;return t[0]=n,t[1]=r,t[2]=c,t[3]=0,t[4]=i,t[5]=s,t[6]=l,t[7]=0,t[8]=o,t[9]=a,t[10]=f,t[11]=0,t[12]=m,t[13]=y,t[14]=b,t[15]=1,t};var GSe=new Je;Je.inverseTranspose=function(e,t){return Je.inverse(Je.transpose(e,GSe),t)};Je.IDENTITY=Object.freeze(new Je(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1));Je.ZERO=Object.freeze(new Je(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0));Je.COLUMN0ROW0=0;Je.COLUMN0ROW1=1;Je.COLUMN0ROW2=2;Je.COLUMN0ROW3=3;Je.COLUMN1ROW0=4;Je.COLUMN1ROW1=5;Je.COLUMN1ROW2=6;Je.COLUMN1ROW3=7;Je.COLUMN2ROW0=8;Je.COLUMN2ROW1=9;Je.COLUMN2ROW2=10;Je.COLUMN2ROW3=11;Je.COLUMN3ROW0=12;Je.COLUMN3ROW1=13;Je.COLUMN3ROW2=14;Je.COLUMN3ROW3=15;Object.defineProperties(Je.prototype,{length:{get:function(){return Je.packedLength}}});Je.prototype.clone=function(e){return Je.clone(this,e)};Je.prototype.equals=function(e){return Je.equals(this,e)};Je.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]&&e[9]===t[n+9]&&e[10]===t[n+10]&&e[11]===t[n+11]&&e[12]===t[n+12]&&e[13]===t[n+13]&&e[14]===t[n+14]&&e[15]===t[n+15]};Je.prototype.equalsEpsilon=function(e,t){return Je.equalsEpsilon(this,e,t)};Je.prototype.toString=function(){return`(${this[0]}, ${this[4]}, ${this[8]}, ${this[12]})
(${this[1]}, ${this[5]}, ${this[9]}, ${this[13]})
(${this[2]}, ${this[6]}, ${this[10]}, ${this[14]})
(${this[3]}, ${this[7]}, ${this[11]}, ${this[15]})`};var F=Je;var WSe={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_ASTC_4x4_WEBGL:37808,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGBA_BPTC_UNORM:36492,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047},te=Object.freeze(WSe);var jSe=new h;function Dt(e){this._size=e.size,this._datatype=e.datatype,this.getValue=e.getValue}var Qs={};Qs[te.FLOAT]="float";Qs[te.FLOAT_VEC2]="vec2";Qs[te.FLOAT_VEC3]="vec3";Qs[te.FLOAT_VEC4]="vec4";Qs[te.INT]="int";Qs[te.INT_VEC2]="ivec2";Qs[te.INT_VEC3]="ivec3";Qs[te.INT_VEC4]="ivec4";Qs[te.BOOL]="bool";Qs[te.BOOL_VEC2]="bvec2";Qs[te.BOOL_VEC3]="bvec3";Qs[te.BOOL_VEC4]="bvec4";Qs[te.FLOAT_MAT2]="mat2";Qs[te.FLOAT_MAT3]="mat3";Qs[te.FLOAT_MAT4]="mat4";Qs[te.SAMPLER_2D]="sampler2D";Qs[te.SAMPLER_CUBE]="samplerCube";Dt.prototype.getDeclaration=function(e){let t=`uniform ${Qs[this._datatype]} ${e}`,n=this._size;return n===1?t+=";":t+=`[${n.toString()}];`,t};var qSe={czm_viewport:new Dt({size:1,datatype:te.FLOAT_VEC4,getValue:function(e){return e.viewportCartesian4}}),czm_viewportOrthographic:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.viewportOrthographic}}),czm_viewportTransformation:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.viewportTransformation}}),czm_globeDepthTexture:new Dt({size:1,datatype:te.SAMPLER_2D,getValue:function(e){return e.globeDepthTexture}}),czm_model:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.model}}),czm_inverseModel:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.inverseModel}}),czm_view:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.view}}),czm_view3D:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.view3D}}),czm_viewRotation:new Dt({size:1,datatype:te.FLOAT_MAT3,getValue:function(e){return e.viewRotation}}),czm_viewRotation3D:new Dt({size:1,datatype:te.FLOAT_MAT3,getValue:function(e){return e.viewRotation3D}}),czm_inverseView:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.inverseView}}),czm_inverseView3D:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.inverseView3D}}),czm_inverseViewRotation:new Dt({size:1,datatype:te.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation}}),czm_inverseViewRotation3D:new Dt({size:1,datatype:te.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation3D}}),czm_projection:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.projection}}),czm_inverseProjection:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.inverseProjection}}),czm_infiniteProjection:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.infiniteProjection}}),czm_modelView:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.modelView}}),czm_modelView3D:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.modelView3D}}),czm_modelViewRelativeToEye:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.modelViewRelativeToEye}}),czm_inverseModelView:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.inverseModelView}}),czm_inverseModelView3D:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.inverseModelView3D}}),czm_viewProjection:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.viewProjection}}),czm_inverseViewProjection:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.inverseViewProjection}}),czm_modelViewProjection:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.modelViewProjection}}),czm_inverseModelViewProjection:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.inverseModelViewProjection}}),czm_modelViewProjectionRelativeToEye:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.modelViewProjectionRelativeToEye}}),czm_modelViewInfiniteProjection:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.modelViewInfiniteProjection}}),czm_orthographicIn3D:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.orthographicIn3D?1:0}}),czm_normal:new Dt({size:1,datatype:te.FLOAT_MAT3,getValue:function(e){return e.normal}}),czm_normal3D:new Dt({size:1,datatype:te.FLOAT_MAT3,getValue:function(e){return e.normal3D}}),czm_inverseNormal:new Dt({size:1,datatype:te.FLOAT_MAT3,getValue:function(e){return e.inverseNormal}}),czm_inverseNormal3D:new Dt({size:1,datatype:te.FLOAT_MAT3,getValue:function(e){return e.inverseNormal3D}}),czm_eyeHeight:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.eyeHeight}}),czm_eyeHeight2D:new Dt({size:1,datatype:te.FLOAT_VEC2,getValue:function(e){return e.eyeHeight2D}}),czm_eyeEllipsoidNormalEC:new Dt({size:1,datatype:te.FLOAT_VEC3,getValue:function(e){return e.eyeEllipsoidNormalEC}}),czm_eyeEllipsoidCurvature:new Dt({size:1,datatype:te.FLOAT_VEC2,getValue:function(e){return e.eyeEllipsoidCurvature}}),czm_modelToEnu:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.modelToEnu}}),czm_enuToModel:new Dt({size:1,datatype:te.FLOAT_MAT4,getValue:function(e){return e.enuToModel}}),czm_entireFrustum:new Dt({size:1,datatype:te.FLOAT_VEC2,getValue:function(e){return e.entireFrustum}}),czm_currentFrustum:new Dt({size:1,datatype:te.FLOAT_VEC2,getValue:function(e){return e.currentFrustum}}),czm_frustumPlanes:new Dt({size:1,datatype:te.FLOAT_VEC4,getValue:function(e){return e.frustumPlanes}}),czm_farDepthFromNearPlusOne:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.farDepthFromNearPlusOne}}),czm_log2FarDepthFromNearPlusOne:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.log2FarDepthFromNearPlusOne}}),czm_oneOverLog2FarDepthFromNearPlusOne:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.oneOverLog2FarDepthFromNearPlusOne}}),czm_sunPositionWC:new Dt({size:1,datatype:te.FLOAT_VEC3,getValue:function(e){return e.sunPositionWC}}),czm_sunPositionColumbusView:new Dt({size:1,datatype:te.FLOAT_VEC3,getValue:function(e){return e.sunPositionColumbusView}}),czm_sunDirectionEC:new Dt({size:1,datatype:te.FLOAT_VEC3,getValue:function(e){return e.sunDirectionEC}}),czm_sunDirectionWC:new Dt({size:1,datatype:te.FLOAT_VEC3,getValue:function(e){return e.sunDirectionWC}}),czm_moonDirectionEC:new Dt({size:1,datatype:te.FLOAT_VEC3,getValue:function(e){return e.moonDirectionEC}}),czm_lightDirectionEC:new Dt({size:1,datatype:te.FLOAT_VEC3,getValue:function(e){return e.lightDirectionEC}}),czm_lightDirectionWC:new Dt({size:1,datatype:te.FLOAT_VEC3,getValue:function(e){return e.lightDirectionWC}}),czm_lightColor:new Dt({size:1,datatype:te.FLOAT_VEC3,getValue:function(e){return e.lightColor}}),czm_lightColorHdr:new Dt({size:1,datatype:te.FLOAT_VEC3,getValue:function(e){return e.lightColorHdr}}),czm_encodedCameraPositionMCHigh:new Dt({size:1,datatype:te.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCHigh}}),czm_encodedCameraPositionMCLow:new Dt({size:1,datatype:te.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCLow}}),czm_viewerPositionWC:new Dt({size:1,datatype:te.FLOAT_VEC3,getValue:function(e){return F.getTranslation(e.inverseView,jSe)}}),czm_frameNumber:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.frameState.frameNumber}}),czm_morphTime:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.frameState.morphTime}}),czm_sceneMode:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.frameState.mode}}),czm_pass:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.pass}}),czm_backgroundColor:new Dt({size:1,datatype:te.FLOAT_VEC4,getValue:function(e){return e.backgroundColor}}),czm_brdfLut:new Dt({size:1,datatype:te.SAMPLER_2D,getValue:function(e){return e.brdfLut}}),czm_environmentMap:new Dt({size:1,datatype:te.SAMPLER_CUBE,getValue:function(e){return e.environmentMap}}),czm_specularEnvironmentMaps:new Dt({size:1,datatype:te.SAMPLER_2D,getValue:function(e){return e.specularEnvironmentMaps}}),czm_specularEnvironmentMapsMaximumLOD:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.specularEnvironmentMapsMaximumLOD}}),czm_sphericalHarmonicCoefficients:new Dt({size:9,datatype:te.FLOAT_VEC3,getValue:function(e){return e.sphericalHarmonicCoefficients}}),czm_temeToPseudoFixed:new Dt({size:1,datatype:te.FLOAT_MAT3,getValue:function(e){return e.temeToPseudoFixedMatrix}}),czm_pixelRatio:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.pixelRatio}}),czm_fogDensity:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.fogDensity}}),czm_fogVisualDensityScalar:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.fogVisualDensityScalar}}),czm_fogMinimumBrightness:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.fogMinimumBrightness}}),czm_atmosphereHsbShift:new Dt({size:1,datatype:te.FLOAT_VEC3,getValue:function(e){return e.atmosphereHsbShift}}),czm_atmosphereLightIntensity:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.atmosphereLightIntensity}}),czm_atmosphereRayleighCoefficient:new Dt({size:1,datatype:te.FLOAT_VEC3,getValue:function(e){return e.atmosphereRayleighCoefficient}}),czm_atmosphereRayleighScaleHeight:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.atmosphereRayleighScaleHeight}}),czm_atmosphereMieCoefficient:new Dt({size:1,datatype:te.FLOAT_VEC3,getValue:function(e){return e.atmosphereMieCoefficient}}),czm_atmosphereMieScaleHeight:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.atmosphereMieScaleHeight}}),czm_atmosphereMieAnisotropy:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.atmosphereMieAnisotropy}}),czm_atmosphereDynamicLighting:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.atmosphereDynamicLighting}}),czm_splitPosition:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.splitPosition}}),czm_geometricToleranceOverMeter:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.geometricToleranceOverMeter}}),czm_minimumDisableDepthTestDistance:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.minimumDisableDepthTestDistance}}),czm_invertClassificationColor:new Dt({size:1,datatype:te.FLOAT_VEC4,getValue:function(e){return e.invertClassificationColor}}),czm_gamma:new Dt({size:1,datatype:te.FLOAT,getValue:function(e){return e.gamma}}),czm_ellipsoidRadii:new Dt({size:1,datatype:te.FLOAT_VEC3,getValue:function(e){return e.ellipsoid.radii}}),czm_ellipsoidInverseRadii:new Dt({size:1,datatype:te.FLOAT_VEC3,getValue:function(e){return e.ellipsoid.oneOverRadii}})},I_=qSe;function YSe(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}var Hn=YSe;function XSe(){return!0}function KSe(e,t){t=x(t,"This object was destroyed, i.e., destroy() was called.");function n(){}for(let i in e)typeof e[i]=="function"&&(e[i]=n);e.isDestroyed=XSe}var ue=KSe;var Os={UNSIGNED_BYTE:te.UNSIGNED_BYTE,UNSIGNED_SHORT:te.UNSIGNED_SHORT,UNSIGNED_INT:te.UNSIGNED_INT};Os.getSizeInBytes=function(e){switch(e){case Os.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Os.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Os.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT}};Os.fromSizeInBytes=function(e){switch(e){case 2:return Os.UNSIGNED_SHORT;case 4:return Os.UNSIGNED_INT;case 1:return Os.UNSIGNED_BYTE}};Os.validate=function(e){return u(e)&&(e===Os.UNSIGNED_BYTE||e===Os.UNSIGNED_SHORT||e===Os.UNSIGNED_INT)};Os.createTypedArray=function(e,t){return e>=R.SIXTY_FOUR_KILOBYTES?new Uint32Array(t):new Uint16Array(t)};Os.createTypedArrayFromArrayBuffer=function(e,t,n,i){return e>=R.SIXTY_FOUR_KILOBYTES?new Uint32Array(t,n,i):new Uint16Array(t,n,i)};Os.fromTypedArray=function(e){if(e instanceof Uint8Array)return Os.UNSIGNED_BYTE;if(e instanceof Uint16Array)return Os.UNSIGNED_SHORT;if(e instanceof Uint32Array)return Os.UNSIGNED_INT};var Be=Object.freeze(Os);var QI={STREAM_DRAW:te.STREAM_DRAW,STATIC_DRAW:te.STATIC_DRAW,DYNAMIC_DRAW:te.DYNAMIC_DRAW,validate:function(e){return e===QI.STREAM_DRAW||e===QI.STATIC_DRAW||e===QI.DYNAMIC_DRAW}},ke=Object.freeze(QI);function qu(e){e=x(e,x.EMPTY_OBJECT);let t=e.context._gl,n=e.bufferTarget,i=e.typedArray,o=e.sizeInBytes,r=e.usage,s=u(i);s&&(o=i.byteLength);let a=t.createBuffer();t.bindBuffer(n,a),t.bufferData(n,s?i:o,r),t.bindBuffer(n,null),this._id=Hn(),this._gl=t,this._webgl2=e.context._webgl2,this._bufferTarget=n,this._sizeInBytes=o,this._usage=r,this._buffer=a,this.vertexArrayDestroyable=!0}qu.createVertexBuffer=function(e){return new qu({context:e.context,bufferTarget:te.ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage})};qu.createIndexBuffer=function(e){let t=e.context,n=e.indexDatatype,i=Be.getSizeInBytes(n),o=new qu({context:t,bufferTarget:te.ELEMENT_ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage}),r=o.sizeInBytes/i;return Object.defineProperties(o,{indexDatatype:{get:function(){return n}},bytesPerIndex:{get:function(){return i}},numberOfIndices:{get:function(){return r}}}),o};Object.defineProperties(qu.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}}});qu.prototype._getBuffer=function(){return this._buffer};qu.prototype.copyFromArrayView=function(e,t){t=x(t,0);let n=this._gl,i=this._bufferTarget;n.bindBuffer(i,this._buffer),n.bufferSubData(i,t,e),n.bindBuffer(i,null)};qu.prototype.copyFromBuffer=function(e,t,n,i){let o=te.COPY_READ_BUFFER,r=te.COPY_WRITE_BUFFER,s=this._gl;s.bindBuffer(r,this._buffer),s.bindBuffer(o,e._buffer),s.copyBufferSubData(o,r,t,n,i),s.bindBuffer(r,null),s.bindBuffer(o,null)};qu.prototype.getBufferData=function(e,t,n,i){t=x(t,0),n=x(n,0);let o=this._gl,r=te.COPY_READ_BUFFER;o.bindBuffer(r,this._buffer),o.getBufferSubData(r,t,e,n,i),o.bindBuffer(r,null)};qu.prototype.isDestroyed=function(){return!1};qu.prototype.destroy=function(){return this._gl.deleteBuffer(this._buffer),ue(this)};var xt=qu;var P_,Ir={requestFullscreen:void 0,exitFullscreen:void 0,fullscreenEnabled:void 0,fullscreenElement:void 0,fullscreenchange:void 0,fullscreenerror:void 0},al={};Object.defineProperties(al,{element:{get:function(){if(al.supportsFullscreen())return document[Ir.fullscreenElement]}},changeEventName:{get:function(){if(al.supportsFullscreen())return Ir.fullscreenchange}},errorEventName:{get:function(){if(al.supportsFullscreen())return Ir.fullscreenerror}},enabled:{get:function(){if(al.supportsFullscreen())return document[Ir.fullscreenEnabled]}},fullscreen:{get:function(){if(al.supportsFullscreen())return al.element!==null}}});al.supportsFullscreen=function(){if(u(P_))return P_;P_=!1;let e=document.body;if(typeof e.requestFullscreen=="function")return Ir.requestFullscreen="requestFullscreen",Ir.exitFullscreen="exitFullscreen",Ir.fullscreenEnabled="fullscreenEnabled",Ir.fullscreenElement="fullscreenElement",Ir.fullscreenchange="fullscreenchange",Ir.fullscreenerror="fullscreenerror",P_=!0,P_;let t=["webkit","moz","o","ms","khtml"],n;for(let i=0,o=t.length;i<o;++i){let r=t[i];n=`${r}RequestFullscreen`,typeof e[n]=="function"?(Ir.requestFullscreen=n,P_=!0):(n=`${r}RequestFullScreen`,typeof e[n]=="function"&&(Ir.requestFullscreen=n,P_=!0)),n=`${r}ExitFullscreen`,typeof document[n]=="function"?Ir.exitFullscreen=n:(n=`${r}CancelFullScreen`,typeof document[n]=="function"&&(Ir.exitFullscreen=n)),n=`${r}FullscreenEnabled`,document[n]!==void 0?Ir.fullscreenEnabled=n:(n=`${r}FullScreenEnabled`,document[n]!==void 0&&(Ir.fullscreenEnabled=n)),n=`${r}FullscreenElement`,document[n]!==void 0?Ir.fullscreenElement=n:(n=`${r}FullScreenElement`,document[n]!==void 0&&(Ir.fullscreenElement=n)),n=`${r}fullscreenchange`,document[`on${n}`]!==void 0&&(r==="ms"&&(n="MSFullscreenChange"),Ir.fullscreenchange=n),n=`${r}fullscreenerror`,document[`on${n}`]!==void 0&&(r==="ms"&&(n="MSFullscreenError"),Ir.fullscreenerror=n)}return P_};al.requestFullscreen=function(e,t){al.supportsFullscreen()&&e[Ir.requestFullscreen]({vrDisplay:t})};al.exitFullscreen=function(){al.supportsFullscreen()&&document[Ir.exitFullscreen]()};al._names=Ir;var Pr=al;var za;typeof navigator<"u"?za=navigator:za={};function by(e){let t=e.split(".");for(let n=0,i=t.length;n<i;++n)t[n]=parseInt(t[n],10);return t}var JI,O$;function O6(){if(!u(JI)&&(JI=!1,!rP())){let e=/ Chrome\/([\.0-9]+)/.exec(za.userAgent);e!==null&&(JI=!0,O$=by(e[1]))}return JI}function ZSe(){return O6()&&O$}var eP,M$;function L$(){if(!u(eP)&&(eP=!1,!O6()&&!rP()&&/ Safari\/[\.0-9]+/.test(za.userAgent))){let e=/ Version\/([\.0-9]+)/.exec(za.userAgent);e!==null&&(eP=!0,M$=by(e[1]))}return eP}function $Se(){return L$()&&M$}var tP,P6;function N$(){if(!u(tP)){tP=!1;let e=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(za.userAgent);e!==null&&(tP=!0,P6=by(e[1]),P6.isNightly=!!e[2])}return tP}function QSe(){return N$()&&P6}var MS,R6;function F$(){if(!u(MS)){MS=!1;let e;za.appName==="Microsoft Internet Explorer"?(e=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(za.userAgent),e!==null&&(MS=!0,R6=by(e[1]))):za.appName==="Netscape"&&(e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(za.userAgent),e!==null&&(MS=!0,R6=by(e[1])))}return MS}function JSe(){return F$()&&R6}var nP,B$;function rP(){if(!u(nP)){nP=!1;let e=/ Edg\/([\.0-9]+)/.exec(za.userAgent);e!==null&&(nP=!0,B$=by(e[1]))}return nP}function eve(){return rP()&&B$}var iP,M6;function sP(){if(!u(iP)){iP=!1;let e=/Firefox\/([\.0-9]+)/.exec(za.userAgent);e!==null&&(iP=!0,M6=by(e[1]))}return iP}var w6;function tve(){return u(w6)||(w6=/Windows/i.test(za.appVersion)),w6}var D6;function nve(){return u(D6)||(D6=navigator.platform==="iPhone"||navigator.platform==="iPod"||navigator.platform==="iPad"),D6}function ive(){return sP()&&M6}var I6;function ove(){return u(I6)||(I6=!sP()&&typeof PointerEvent<"u"&&(!u(za.pointerEnabled)||za.pointerEnabled)),I6}var k$,oP;function V$(){if(!u(oP)){let e=document.createElement("canvas");e.setAttribute("style","image-rendering: -moz-crisp-edges;image-rendering: pixelated;");let t=e.style.imageRendering;oP=u(t)&&t!=="",oP&&(k$=t)}return oP}function rve(){return V$()?k$:void 0}function bc(){return bc._result}bc._promise=void 0;bc._result=void 0;bc.initialize=function(){return u(bc._promise)||(bc._promise=new Promise(e=>{let t=new Image;t.onload=function(){bc._result=t.width>0&&t.height>0,e(bc._result)},t.onerror=function(){bc._result=!1,e(bc._result)},t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA"})),bc._promise};Object.defineProperties(bc,{initialized:{get:function(){return u(bc._result)}}});var eC=[];typeof ArrayBuffer<"u"&&(eC.push(Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array),typeof Uint8ClampedArray<"u"&&eC.push(Uint8ClampedArray),typeof Uint8ClampedArray<"u"&&eC.push(Uint8ClampedArray),typeof BigInt64Array<"u"&&eC.push(BigInt64Array),typeof BigUint64Array<"u"&&eC.push(BigUint64Array));var Yu={isChrome:O6,chromeVersion:ZSe,isSafari:L$,safariVersion:$Se,isWebkit:N$,webkitVersion:QSe,isInternetExplorer:F$,internetExplorerVersion:JSe,isEdge:rP,edgeVersion:eve,isFirefox:sP,firefoxVersion:ive,isWindows:tve,isIPadOrIOS:nve,hardwareConcurrency:x(za.hardwareConcurrency,3),supportsPointerEvents:ove,supportsImageRenderingPixelated:V$,supportsWebP:bc,imageRenderingValue:rve,typedArrayTypes:eC};Yu.supportsBasis=function(e){return Yu.supportsWebAssembly()&&e.context.supportsBasis};Yu.supportsFullscreen=function(){return Pr.supportsFullscreen()};Yu.supportsTypedArrays=function(){return typeof ArrayBuffer<"u"};Yu.supportsBigInt64Array=function(){return typeof BigInt64Array<"u"};Yu.supportsBigUint64Array=function(){return typeof BigUint64Array<"u"};Yu.supportsBigInt=function(){return typeof BigInt<"u"};Yu.supportsWebWorkers=function(){return typeof Worker<"u"};Yu.supportsWebAssembly=function(){return typeof WebAssembly<"u"};Yu.supportsWebgl2=function(e){return e.context.webgl2};Yu.supportsEsmWebWorkers=function(){return!sP()||parseInt(M6)>=114};var Wt=Yu;function L6(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n*6<1?e+(t-e)*6*n:n*2<1?t:n*3<2?e+(t-e)*(2/3-n)*6:e}function ie(e,t,n,i){this.red=x(e,1),this.green=x(t,1),this.blue=x(n,1),this.alpha=x(i,1)}ie.fromCartesian4=function(e,t){return u(t)?(t.red=e.x,t.green=e.y,t.blue=e.z,t.alpha=e.w,t):new ie(e.x,e.y,e.z,e.w)};ie.fromBytes=function(e,t,n,i,o){return e=ie.byteToFloat(x(e,255)),t=ie.byteToFloat(x(t,255)),n=ie.byteToFloat(x(n,255)),i=ie.byteToFloat(x(i,255)),u(o)?(o.red=e,o.green=t,o.blue=n,o.alpha=i,o):new ie(e,t,n,i)};ie.fromAlpha=function(e,t,n){return u(n)?(n.red=e.red,n.green=e.green,n.blue=e.blue,n.alpha=t,n):new ie(e.red,e.green,e.blue,t)};var N6,F6,Xm;Wt.supportsTypedArrays()&&(N6=new ArrayBuffer(4),F6=new Uint32Array(N6),Xm=new Uint8Array(N6));ie.fromRgba=function(e,t){return F6[0]=e,ie.fromBytes(Xm[0],Xm[1],Xm[2],Xm[3],t)};ie.fromHsl=function(e,t,n,i,o){e=x(e,0)%1,t=x(t,0),n=x(n,0),i=x(i,1);let r=n,s=n,a=n;if(t!==0){let c;n<.5?c=n*(1+t):c=n+t-n*t;let l=2*n-c;r=L6(l,c,e+1/3),s=L6(l,c,e),a=L6(l,c,e-1/3)}return u(o)?(o.red=r,o.green=s,o.blue=a,o.alpha=i,o):new ie(r,s,a,i)};ie.fromRandom=function(e,t){e=x(e,x.EMPTY_OBJECT);let n=e.red;if(!u(n)){let s=x(e.minimumRed,0),a=x(e.maximumRed,1);n=s+R.nextRandomNumber()*(a-s)}let i=e.green;if(!u(i)){let s=x(e.minimumGreen,0),a=x(e.maximumGreen,1);i=s+R.nextRandomNumber()*(a-s)}let o=e.blue;if(!u(o)){let s=x(e.minimumBlue,0),a=x(e.maximumBlue,1);o=s+R.nextRandomNumber()*(a-s)}let r=e.alpha;if(!u(r)){let s=x(e.minimumAlpha,0),a=x(e.maximumAlpha,1);r=s+R.nextRandomNumber()*(a-s)}return u(t)?(t.red=n,t.green=i,t.blue=o,t.alpha=r,t):new ie(n,i,o,r)};var sve=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,ave=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,cve=/^rgba?\s*\(\s*([0-9.]+%?)\s*[,\s]+\s*([0-9.]+%?)\s*[,\s]+\s*([0-9.]+%?)(?:\s*[,\s/]+\s*([0-9.]+))?\s*\)$/i,lve=/^hsla?\s*\(\s*([0-9.]+)\s*[,\s]+\s*([0-9.]+%)\s*[,\s]+\s*([0-9.]+%)(?:\s*[,\s/]+\s*([0-9.]+))?\s*\)$/i;ie.fromCssColorString=function(e,t){u(t)||(t=new ie),e=e.trim();let n=ie[e.toUpperCase()];if(u(n))return ie.clone(n,t),t;let i=sve.exec(e);return i!==null?(t.red=parseInt(i[1],16)/15,t.green=parseInt(i[2],16)/15,t.blue=parseInt(i[3],16)/15,t.alpha=parseInt(x(i[4],"f"),16)/15,t):(i=ave.exec(e),i!==null?(t.red=parseInt(i[1],16)/255,t.green=parseInt(i[2],16)/255,t.blue=parseInt(i[3],16)/255,t.alpha=parseInt(x(i[4],"ff"),16)/255,t):(i=cve.exec(e),i!==null?(t.red=parseFloat(i[1])/(i[1].substr(-1)==="%"?100:255),t.green=parseFloat(i[2])/(i[2].substr(-1)==="%"?100:255),t.blue=parseFloat(i[3])/(i[3].substr(-1)==="%"?100:255),t.alpha=parseFloat(x(i[4],"1.0")),t):(i=lve.exec(e),i!==null?ie.fromHsl(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,parseFloat(x(i[4],"1.0")),t):(t=void 0,t))))};ie.packedLength=4;ie.pack=function(e,t,n){return n=x(n,0),t[n++]=e.red,t[n++]=e.green,t[n++]=e.blue,t[n]=e.alpha,t};ie.unpack=function(e,t,n){return t=x(t,0),u(n)||(n=new ie),n.red=e[t++],n.green=e[t++],n.blue=e[t++],n.alpha=e[t],n};ie.byteToFloat=function(e){return e/255};ie.floatToByte=function(e){return e===1?255:e*256|0};ie.clone=function(e,t){if(u(e))return u(t)?(t.red=e.red,t.green=e.green,t.blue=e.blue,t.alpha=e.alpha,t):new ie(e.red,e.green,e.blue,e.alpha)};ie.equals=function(e,t){return e===t||u(e)&&u(t)&&e.red===t.red&&e.green===t.green&&e.blue===t.blue&&e.alpha===t.alpha};ie.equalsArray=function(e,t,n){return e.red===t[n]&&e.green===t[n+1]&&e.blue===t[n+2]&&e.alpha===t[n+3]};ie.prototype.clone=function(e){return ie.clone(this,e)};ie.prototype.equals=function(e){return ie.equals(this,e)};ie.prototype.equalsEpsilon=function(e,t){return this===e||u(e)&&Math.abs(this.red-e.red)<=t&&Math.abs(this.green-e.green)<=t&&Math.abs(this.blue-e.blue)<=t&&Math.abs(this.alpha-e.alpha)<=t};ie.prototype.toString=function(){return`(${this.red}, ${this.green}, ${this.blue}, ${this.alpha})`};ie.prototype.toCssColorString=function(){let e=ie.floatToByte(this.red),t=ie.floatToByte(this.green),n=ie.floatToByte(this.blue);return this.alpha===1?`rgb(${e},${t},${n})`:`rgba(${e},${t},${n},${this.alpha})`};ie.prototype.toCssHexString=function(){let e=ie.floatToByte(this.red).toString(16);e.length<2&&(e=`0${e}`);let t=ie.floatToByte(this.green).toString(16);t.length<2&&(t=`0${t}`);let n=ie.floatToByte(this.blue).toString(16);if(n.length<2&&(n=`0${n}`),this.alpha<1){let i=ie.floatToByte(this.alpha).toString(16);return i.length<2&&(i=`0${i}`),`#${e}${t}${n}${i}`}return`#${e}${t}${n}`};ie.prototype.toBytes=function(e){let t=ie.floatToByte(this.red),n=ie.floatToByte(this.green),i=ie.floatToByte(this.blue),o=ie.floatToByte(this.alpha);return u(e)?(e[0]=t,e[1]=n,e[2]=i,e[3]=o,e):[t,n,i,o]};ie.prototype.toRgba=function(){return Xm[0]=ie.floatToByte(this.red),Xm[1]=ie.floatToByte(this.green),Xm[2]=ie.floatToByte(this.blue),Xm[3]=ie.floatToByte(this.alpha),F6[0]};ie.prototype.brighten=function(e,t){return e=1-e,t.red=1-(1-this.red)*e,t.green=1-(1-this.green)*e,t.blue=1-(1-this.blue)*e,t.alpha=this.alpha,t};ie.prototype.darken=function(e,t){return e=1-e,t.red=this.red*e,t.green=this.green*e,t.blue=this.blue*e,t.alpha=this.alpha,t};ie.prototype.withAlpha=function(e,t){return ie.fromAlpha(this,e,t)};ie.add=function(e,t,n){return n.red=e.red+t.red,n.green=e.green+t.green,n.blue=e.blue+t.blue,n.alpha=e.alpha+t.alpha,n};ie.subtract=function(e,t,n){return n.red=e.red-t.red,n.green=e.green-t.green,n.blue=e.blue-t.blue,n.alpha=e.alpha-t.alpha,n};ie.multiply=function(e,t,n){return n.red=e.red*t.red,n.green=e.green*t.green,n.blue=e.blue*t.blue,n.alpha=e.alpha*t.alpha,n};ie.divide=function(e,t,n){return n.red=e.red/t.red,n.green=e.green/t.green,n.blue=e.blue/t.blue,n.alpha=e.alpha/t.alpha,n};ie.mod=function(e,t,n){return n.red=e.red%t.red,n.green=e.green%t.green,n.blue=e.blue%t.blue,n.alpha=e.alpha%t.alpha,n};ie.lerp=function(e,t,n,i){return i.red=R.lerp(e.red,t.red,n),i.green=R.lerp(e.green,t.green,n),i.blue=R.lerp(e.blue,t.blue,n),i.alpha=R.lerp(e.alpha,t.alpha,n),i};ie.multiplyByScalar=function(e,t,n){return n.red=e.red*t,n.green=e.green*t,n.blue=e.blue*t,n.alpha=e.alpha*t,n};ie.divideByScalar=function(e,t,n){return n.red=e.red/t,n.green=e.green/t,n.blue=e.blue/t,n.alpha=e.alpha/t,n};ie.ALICEBLUE=Object.freeze(ie.fromCssColorString("#F0F8FF"));ie.ANTIQUEWHITE=Object.freeze(ie.fromCssColorString("#FAEBD7"));ie.AQUA=Object.freeze(ie.fromCssColorString("#00FFFF"));ie.AQUAMARINE=Object.freeze(ie.fromCssColorString("#7FFFD4"));ie.AZURE=Object.freeze(ie.fromCssColorString("#F0FFFF"));ie.BEIGE=Object.freeze(ie.fromCssColorString("#F5F5DC"));ie.BISQUE=Object.freeze(ie.fromCssColorString("#FFE4C4"));ie.BLACK=Object.freeze(ie.fromCssColorString("#000000"));ie.BLANCHEDALMOND=Object.freeze(ie.fromCssColorString("#FFEBCD"));ie.BLUE=Object.freeze(ie.fromCssColorString("#0000FF"));ie.BLUEVIOLET=Object.freeze(ie.fromCssColorString("#8A2BE2"));ie.BROWN=Object.freeze(ie.fromCssColorString("#A52A2A"));ie.BURLYWOOD=Object.freeze(ie.fromCssColorString("#DEB887"));ie.CADETBLUE=Object.freeze(ie.fromCssColorString("#5F9EA0"));ie.CHARTREUSE=Object.freeze(ie.fromCssColorString("#7FFF00"));ie.CHOCOLATE=Object.freeze(ie.fromCssColorString("#D2691E"));ie.CORAL=Object.freeze(ie.fromCssColorString("#FF7F50"));ie.CORNFLOWERBLUE=Object.freeze(ie.fromCssColorString("#6495ED"));ie.CORNSILK=Object.freeze(ie.fromCssColorString("#FFF8DC"));ie.CRIMSON=Object.freeze(ie.fromCssColorString("#DC143C"));ie.CYAN=Object.freeze(ie.fromCssColorString("#00FFFF"));ie.DARKBLUE=Object.freeze(ie.fromCssColorString("#00008B"));ie.DARKCYAN=Object.freeze(ie.fromCssColorString("#008B8B"));ie.DARKGOLDENROD=Object.freeze(ie.fromCssColorString("#B8860B"));ie.DARKGRAY=Object.freeze(ie.fromCssColorString("#A9A9A9"));ie.DARKGREEN=Object.freeze(ie.fromCssColorString("#006400"));ie.DARKGREY=ie.DARKGRAY;ie.DARKKHAKI=Object.freeze(ie.fromCssColorString("#BDB76B"));ie.DARKMAGENTA=Object.freeze(ie.fromCssColorString("#8B008B"));ie.DARKOLIVEGREEN=Object.freeze(ie.fromCssColorString("#556B2F"));ie.DARKORANGE=Object.freeze(ie.fromCssColorString("#FF8C00"));ie.DARKORCHID=Object.freeze(ie.fromCssColorString("#9932CC"));ie.DARKRED=Object.freeze(ie.fromCssColorString("#8B0000"));ie.DARKSALMON=Object.freeze(ie.fromCssColorString("#E9967A"));ie.DARKSEAGREEN=Object.freeze(ie.fromCssColorString("#8FBC8F"));ie.DARKSLATEBLUE=Object.freeze(ie.fromCssColorString("#483D8B"));ie.DARKSLATEGRAY=Object.freeze(ie.fromCssColorString("#2F4F4F"));ie.DARKSLATEGREY=ie.DARKSLATEGRAY;ie.DARKTURQUOISE=Object.freeze(ie.fromCssColorString("#00CED1"));ie.DARKVIOLET=Object.freeze(ie.fromCssColorString("#9400D3"));ie.DEEPPINK=Object.freeze(ie.fromCssColorString("#FF1493"));ie.DEEPSKYBLUE=Object.freeze(ie.fromCssColorString("#00BFFF"));ie.DIMGRAY=Object.freeze(ie.fromCssColorString("#696969"));ie.DIMGREY=ie.DIMGRAY;ie.DODGERBLUE=Object.freeze(ie.fromCssColorString("#1E90FF"));ie.FIREBRICK=Object.freeze(ie.fromCssColorString("#B22222"));ie.FLORALWHITE=Object.freeze(ie.fromCssColorString("#FFFAF0"));ie.FORESTGREEN=Object.freeze(ie.fromCssColorString("#228B22"));ie.FUCHSIA=Object.freeze(ie.fromCssColorString("#FF00FF"));ie.GAINSBORO=Object.freeze(ie.fromCssColorString("#DCDCDC"));ie.GHOSTWHITE=Object.freeze(ie.fromCssColorString("#F8F8FF"));ie.GOLD=Object.freeze(ie.fromCssColorString("#FFD700"));ie.GOLDENROD=Object.freeze(ie.fromCssColorString("#DAA520"));ie.GRAY=Object.freeze(ie.fromCssColorString("#808080"));ie.GREEN=Object.freeze(ie.fromCssColorString("#008000"));ie.GREENYELLOW=Object.freeze(ie.fromCssColorString("#ADFF2F"));ie.GREY=ie.GRAY;ie.HONEYDEW=Object.freeze(ie.fromCssColorString("#F0FFF0"));ie.HOTPINK=Object.freeze(ie.fromCssColorString("#FF69B4"));ie.INDIANRED=Object.freeze(ie.fromCssColorString("#CD5C5C"));ie.INDIGO=Object.freeze(ie.fromCssColorString("#4B0082"));ie.IVORY=Object.freeze(ie.fromCssColorString("#FFFFF0"));ie.KHAKI=Object.freeze(ie.fromCssColorString("#F0E68C"));ie.LAVENDER=Object.freeze(ie.fromCssColorString("#E6E6FA"));ie.LAVENDAR_BLUSH=Object.freeze(ie.fromCssColorString("#FFF0F5"));ie.LAWNGREEN=Object.freeze(ie.fromCssColorString("#7CFC00"));ie.LEMONCHIFFON=Object.freeze(ie.fromCssColorString("#FFFACD"));ie.LIGHTBLUE=Object.freeze(ie.fromCssColorString("#ADD8E6"));ie.LIGHTCORAL=Object.freeze(ie.fromCssColorString("#F08080"));ie.LIGHTCYAN=Object.freeze(ie.fromCssColorString("#E0FFFF"));ie.LIGHTGOLDENRODYELLOW=Object.freeze(ie.fromCssColorString("#FAFAD2"));ie.LIGHTGRAY=Object.freeze(ie.fromCssColorString("#D3D3D3"));ie.LIGHTGREEN=Object.freeze(ie.fromCssColorString("#90EE90"));ie.LIGHTGREY=ie.LIGHTGRAY;ie.LIGHTPINK=Object.freeze(ie.fromCssColorString("#FFB6C1"));ie.LIGHTSEAGREEN=Object.freeze(ie.fromCssColorString("#20B2AA"));ie.LIGHTSKYBLUE=Object.freeze(ie.fromCssColorString("#87CEFA"));ie.LIGHTSLATEGRAY=Object.freeze(ie.fromCssColorString("#778899"));ie.LIGHTSLATEGREY=ie.LIGHTSLATEGRAY;ie.LIGHTSTEELBLUE=Object.freeze(ie.fromCssColorString("#B0C4DE"));ie.LIGHTYELLOW=Object.freeze(ie.fromCssColorString("#FFFFE0"));ie.LIME=Object.freeze(ie.fromCssColorString("#00FF00"));ie.LIMEGREEN=Object.freeze(ie.fromCssColorString("#32CD32"));ie.LINEN=Object.freeze(ie.fromCssColorString("#FAF0E6"));ie.MAGENTA=Object.freeze(ie.fromCssColorString("#FF00FF"));ie.MAROON=Object.freeze(ie.fromCssColorString("#800000"));ie.MEDIUMAQUAMARINE=Object.freeze(ie.fromCssColorString("#66CDAA"));ie.MEDIUMBLUE=Object.freeze(ie.fromCssColorString("#0000CD"));ie.MEDIUMORCHID=Object.freeze(ie.fromCssColorString("#BA55D3"));ie.MEDIUMPURPLE=Object.freeze(ie.fromCssColorString("#9370DB"));ie.MEDIUMSEAGREEN=Object.freeze(ie.fromCssColorString("#3CB371"));ie.MEDIUMSLATEBLUE=Object.freeze(ie.fromCssColorString("#7B68EE"));ie.MEDIUMSPRINGGREEN=Object.freeze(ie.fromCssColorString("#00FA9A"));ie.MEDIUMTURQUOISE=Object.freeze(ie.fromCssColorString("#48D1CC"));ie.MEDIUMVIOLETRED=Object.freeze(ie.fromCssColorString("#C71585"));ie.MIDNIGHTBLUE=Object.freeze(ie.fromCssColorString("#191970"));ie.MINTCREAM=Object.freeze(ie.fromCssColorString("#F5FFFA"));ie.MISTYROSE=Object.freeze(ie.fromCssColorString("#FFE4E1"));ie.MOCCASIN=Object.freeze(ie.fromCssColorString("#FFE4B5"));ie.NAVAJOWHITE=Object.freeze(ie.fromCssColorString("#FFDEAD"));ie.NAVY=Object.freeze(ie.fromCssColorString("#000080"));ie.OLDLACE=Object.freeze(ie.fromCssColorString("#FDF5E6"));ie.OLIVE=Object.freeze(ie.fromCssColorString("#808000"));ie.OLIVEDRAB=Object.freeze(ie.fromCssColorString("#6B8E23"));ie.ORANGE=Object.freeze(ie.fromCssColorString("#FFA500"));ie.ORANGERED=Object.freeze(ie.fromCssColorString("#FF4500"));ie.ORCHID=Object.freeze(ie.fromCssColorString("#DA70D6"));ie.PALEGOLDENROD=Object.freeze(ie.fromCssColorString("#EEE8AA"));ie.PALEGREEN=Object.freeze(ie.fromCssColorString("#98FB98"));ie.PALETURQUOISE=Object.freeze(ie.fromCssColorString("#AFEEEE"));ie.PALEVIOLETRED=Object.freeze(ie.fromCssColorString("#DB7093"));ie.PAPAYAWHIP=Object.freeze(ie.fromCssColorString("#FFEFD5"));ie.PEACHPUFF=Object.freeze(ie.fromCssColorString("#FFDAB9"));ie.PERU=Object.freeze(ie.fromCssColorString("#CD853F"));ie.PINK=Object.freeze(ie.fromCssColorString("#FFC0CB"));ie.PLUM=Object.freeze(ie.fromCssColorString("#DDA0DD"));ie.POWDERBLUE=Object.freeze(ie.fromCssColorString("#B0E0E6"));ie.PURPLE=Object.freeze(ie.fromCssColorString("#800080"));ie.RED=Object.freeze(ie.fromCssColorString("#FF0000"));ie.ROSYBROWN=Object.freeze(ie.fromCssColorString("#BC8F8F"));ie.ROYALBLUE=Object.freeze(ie.fromCssColorString("#4169E1"));ie.SADDLEBROWN=Object.freeze(ie.fromCssColorString("#8B4513"));ie.SALMON=Object.freeze(ie.fromCssColorString("#FA8072"));ie.SANDYBROWN=Object.freeze(ie.fromCssColorString("#F4A460"));ie.SEAGREEN=Object.freeze(ie.fromCssColorString("#2E8B57"));ie.SEASHELL=Object.freeze(ie.fromCssColorString("#FFF5EE"));ie.SIENNA=Object.freeze(ie.fromCssColorString("#A0522D"));ie.SILVER=Object.freeze(ie.fromCssColorString("#C0C0C0"));ie.SKYBLUE=Object.freeze(ie.fromCssColorString("#87CEEB"));ie.SLATEBLUE=Object.freeze(ie.fromCssColorString("#6A5ACD"));ie.SLATEGRAY=Object.freeze(ie.fromCssColorString("#708090"));ie.SLATEGREY=ie.SLATEGRAY;ie.SNOW=Object.freeze(ie.fromCssColorString("#FFFAFA"));ie.SPRINGGREEN=Object.freeze(ie.fromCssColorString("#00FF7F"));ie.STEELBLUE=Object.freeze(ie.fromCssColorString("#4682B4"));ie.TAN=Object.freeze(ie.fromCssColorString("#D2B48C"));ie.TEAL=Object.freeze(ie.fromCssColorString("#008080"));ie.THISTLE=Object.freeze(ie.fromCssColorString("#D8BFD8"));ie.TOMATO=Object.freeze(ie.fromCssColorString("#FF6347"));ie.TURQUOISE=Object.freeze(ie.fromCssColorString("#40E0D0"));ie.VIOLET=Object.freeze(ie.fromCssColorString("#EE82EE"));ie.WHEAT=Object.freeze(ie.fromCssColorString("#F5DEB3"));ie.WHITE=Object.freeze(ie.fromCssColorString("#FFFFFF"));ie.WHITESMOKE=Object.freeze(ie.fromCssColorString("#F5F5F5"));ie.YELLOW=Object.freeze(ie.fromCssColorString("#FFFF00"));ie.YELLOWGREEN=Object.freeze(ie.fromCssColorString("#9ACD32"));ie.TRANSPARENT=Object.freeze(new ie(0,0,0,0));var G=ie;function aP(e){e=x(e,x.EMPTY_OBJECT),this.color=e.color,this.depth=e.depth,this.stencil=e.stencil,this.renderState=e.renderState,this.framebuffer=e.framebuffer,this.owner=e.owner,this.pass=e.pass}aP.ALL=Object.freeze(new aP({color:new G(0,0,0,0),depth:1,stencil:0}));aP.prototype.execute=function(e,t){e.clear(this,t)};var ni=aP;var uve={ENVIRONMENT:0,COMPUTE:1,GLOBE:2,TERRAIN_CLASSIFICATION:3,CESIUM_3D_TILE:4,CESIUM_3D_TILE_CLASSIFICATION:5,CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW:6,OPAQUE:7,TRANSLUCENT:8,VOXELS:9,OVERLAY:10,NUMBER_OF_PASSES:11},we=Object.freeze(uve);function U$(e){e=x(e,x.EMPTY_OBJECT),this.vertexArray=e.vertexArray,this.fragmentShaderSource=e.fragmentShaderSource,this.shaderProgram=e.shaderProgram,this.uniformMap=e.uniformMap,this.outputTexture=e.outputTexture,this.preExecute=e.preExecute,this.postExecute=e.postExecute,this.canceled=e.canceled,this.persists=x(e.persists,!1),this.pass=we.COMPUTE,this.owner=e.owner}U$.prototype.execute=function(e){e.execute(this)};var cl=U$;function Bt(e,t){this.x=x(e,0),this.y=x(t,0)}Bt.fromElements=function(e,t,n){return u(n)?(n.x=e,n.y=t,n):new Bt(e,t)};Bt.clone=function(e,t){if(u(e))return u(t)?(t.x=e.x,t.y=e.y,t):new Bt(e.x,e.y)};Bt.fromCartesian3=Bt.clone;Bt.fromCartesian4=Bt.clone;Bt.packedLength=2;Bt.pack=function(e,t,n){return n=x(n,0),t[n++]=e.x,t[n]=e.y,t};Bt.unpack=function(e,t,n){return t=x(t,0),u(n)||(n=new Bt),n.x=e[t++],n.y=e[t],n};Bt.packArray=function(e,t){let n=e.length,i=n*2;u(t)?!Array.isArray(t)&&t.length!==i||t.length!==i&&(t.length=i):t=new Array(i);for(let o=0;o<n;++o)Bt.pack(e[o],t,o*2);return t};Bt.unpackArray=function(e,t){let n=e.length;u(t)?t.length=n/2:t=new Array(n/2);for(let i=0;i<n;i+=2){let o=i/2;t[o]=Bt.unpack(e,i,t[o])}return t};Bt.fromArray=Bt.unpack;Bt.maximumComponent=function(e){return Math.max(e.x,e.y)};Bt.minimumComponent=function(e){return Math.min(e.x,e.y)};Bt.minimumByComponent=function(e,t,n){return n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n};Bt.maximumByComponent=function(e,t,n){return n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n};Bt.clamp=function(e,t,n,i){let o=R.clamp(e.x,t.x,n.x),r=R.clamp(e.y,t.y,n.y);return i.x=o,i.y=r,i};Bt.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y};Bt.magnitude=function(e){return Math.sqrt(Bt.magnitudeSquared(e))};var cP=new Bt;Bt.distance=function(e,t){return Bt.subtract(e,t,cP),Bt.magnitude(cP)};Bt.distanceSquared=function(e,t){return Bt.subtract(e,t,cP),Bt.magnitudeSquared(cP)};Bt.normalize=function(e,t){let n=Bt.magnitude(e);return t.x=e.x/n,t.y=e.y/n,t};Bt.dot=function(e,t){return e.x*t.x+e.y*t.y};Bt.cross=function(e,t){return e.x*t.y-e.y*t.x};Bt.multiplyComponents=function(e,t,n){return n.x=e.x*t.x,n.y=e.y*t.y,n};Bt.divideComponents=function(e,t,n){return n.x=e.x/t.x,n.y=e.y/t.y,n};Bt.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n};Bt.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n};Bt.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n};Bt.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n};Bt.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t};Bt.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t};var z$=new Bt;Bt.lerp=function(e,t,n,i){return Bt.multiplyByScalar(t,n,z$),i=Bt.multiplyByScalar(e,1-n,i),Bt.add(z$,i,i)};var H$=new Bt,G$=new Bt;Bt.angleBetween=function(e,t){return Bt.normalize(e,H$),Bt.normalize(t,G$),R.acosClamped(Bt.dot(H$,G$))};var fve=new Bt;Bt.mostOrthogonalAxis=function(e,t){let n=Bt.normalize(e,fve);return Bt.abs(n,n),n.x<=n.y?t=Bt.clone(Bt.UNIT_X,t):t=Bt.clone(Bt.UNIT_Y,t),t};Bt.equals=function(e,t){return e===t||u(e)&&u(t)&&e.x===t.x&&e.y===t.y};Bt.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]};Bt.equalsEpsilon=function(e,t,n,i){return e===t||u(e)&&u(t)&&R.equalsEpsilon(e.x,t.x,n,i)&&R.equalsEpsilon(e.y,t.y,n,i)};Bt.ZERO=Object.freeze(new Bt(0,0));Bt.ONE=Object.freeze(new Bt(1,1));Bt.UNIT_X=Object.freeze(new Bt(1,0));Bt.UNIT_Y=Object.freeze(new Bt(0,1));Bt.prototype.clone=function(e){return Bt.clone(this,e)};Bt.prototype.equals=function(e){return Bt.equals(this,e)};Bt.prototype.equalsEpsilon=function(e,t,n){return Bt.equalsEpsilon(this,e,t,n)};Bt.prototype.toString=function(){return`(${this.x}, ${this.y})`};var H=Bt;var dve=new h,hve=new h;function mve(e,t,n,i,o){let r=e.x,s=e.y,a=e.z,c=t.x,l=t.y,f=t.z,d=r*r*c*c,p=s*s*l*l,g=a*a*f*f,m=d+p+g,y=Math.sqrt(1/m),b=h.multiplyByScalar(e,y,dve);if(m<i)return isFinite(y)?h.clone(b,o):void 0;let C=n.x,A=n.y,T=n.z,E=hve;E.x=b.x*C*2,E.y=b.y*A*2,E.z=b.z*T*2;let v=(1-y)*h.magnitude(e)/(.5*h.magnitude(E)),D=0,O,P,M,L,_,S,w,I,N,k,z;do{v-=D,M=1/(1+v*C),L=1/(1+v*A),_=1/(1+v*T),S=M*M,w=L*L,I=_*_,N=S*M,k=w*L,z=I*_,O=d*S+p*w+g*I-1,P=d*N*C+p*k*A+g*z*T;let V=-2*P;D=O/V}while(Math.abs(O)>R.EPSILON12);return u(o)?(o.x=r*M,o.y=s*L,o.z=a*_,o):new h(r*M,s*L,a*_)}var tC=mve;function Lo(e,t,n){this.longitude=x(e,0),this.latitude=x(t,0),this.height=x(n,0)}Lo.fromRadians=function(e,t,n,i){return n=x(n,0),u(i)?(i.longitude=e,i.latitude=t,i.height=n,i):new Lo(e,t,n)};Lo.fromDegrees=function(e,t,n,i){return e=R.toRadians(e),t=R.toRadians(t),Lo.fromRadians(e,t,n,i)};var pve=new h,_ve=new h,gve=new h;Lo._ellipsoidOneOverRadii=new h(1/6378137,1/6378137,1/6356752314245179e-9);Lo._ellipsoidOneOverRadiiSquared=new h(1/(6378137*6378137),1/(6378137*6378137),1/(6356752314245179e-9*6356752314245179e-9));Lo._ellipsoidCenterToleranceSquared=R.EPSILON1;Lo.fromCartesian=function(e,t,n){let i=u(t)?t.oneOverRadii:Lo._ellipsoidOneOverRadii,o=u(t)?t.oneOverRadiiSquared:Lo._ellipsoidOneOverRadiiSquared,r=u(t)?t._centerToleranceSquared:Lo._ellipsoidCenterToleranceSquared,s=tC(e,i,o,r,_ve);if(!u(s))return;let a=h.multiplyComponents(s,o,pve);a=h.normalize(a,a);let c=h.subtract(e,s,gve),l=Math.atan2(a.y,a.x),f=Math.asin(a.z),d=R.sign(h.dot(c,e))*h.magnitude(c);return u(n)?(n.longitude=l,n.latitude=f,n.height=d,n):new Lo(l,f,d)};Lo.toCartesian=function(e,t,n){return h.fromRadians(e.longitude,e.latitude,e.height,t,n)};Lo.clone=function(e,t){if(u(e))return u(t)?(t.longitude=e.longitude,t.latitude=e.latitude,t.height=e.height,t):new Lo(e.longitude,e.latitude,e.height)};Lo.equals=function(e,t){return e===t||u(e)&&u(t)&&e.longitude===t.longitude&&e.latitude===t.latitude&&e.height===t.height};Lo.equalsEpsilon=function(e,t,n){return n=x(n,0),e===t||u(e)&&u(t)&&Math.abs(e.longitude-t.longitude)<=n&&Math.abs(e.latitude-t.latitude)<=n&&Math.abs(e.height-t.height)<=n};Lo.ZERO=Object.freeze(new Lo(0,0,0));Lo.prototype.clone=function(e){return Lo.clone(this,e)};Lo.prototype.equals=function(e){return Lo.equals(this,e)};Lo.prototype.equalsEpsilon=function(e,t){return Lo.equalsEpsilon(this,e,t)};Lo.prototype.toString=function(){return`(${this.longitude}, ${this.latitude}, ${this.height})`};var de=Lo;function j$(e,t,n,i){t=x(t,0),n=x(n,0),i=x(i,0),e._radii=new h(t,n,i),e._radiiSquared=new h(t*t,n*n,i*i),e._radiiToTheFourth=new h(t*t*t*t,n*n*n*n,i*i*i*i),e._oneOverRadii=new h(t===0?0:1/t,n===0?0:1/n,i===0?0:1/i),e._oneOverRadiiSquared=new h(t===0?0:1/(t*t),n===0?0:1/(n*n),i===0?0:1/(i*i)),e._minimumRadius=Math.min(t,n,i),e._maximumRadius=Math.max(t,n,i),e._centerToleranceSquared=R.EPSILON1,e._radiiSquared.z!==0&&(e._squaredXOverSquaredZ=e._radiiSquared.x/e._radiiSquared.z)}function hi(e,t,n){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,j$(this,e,t,n)}Object.defineProperties(hi.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}});hi.clone=function(e,t){if(!u(e))return;let n=e._radii;return u(t)?(h.clone(n,t._radii),h.clone(e._radiiSquared,t._radiiSquared),h.clone(e._radiiToTheFourth,t._radiiToTheFourth),h.clone(e._oneOverRadii,t._oneOverRadii),h.clone(e._oneOverRadiiSquared,t._oneOverRadiiSquared),t._minimumRadius=e._minimumRadius,t._maximumRadius=e._maximumRadius,t._centerToleranceSquared=e._centerToleranceSquared,t):new hi(n.x,n.y,n.z)};hi.fromCartesian3=function(e,t){return u(t)||(t=new hi),u(e)&&j$(t,e.x,e.y,e.z),t};hi.WGS84=Object.freeze(new hi(6378137,6378137,6356752314245179e-9));hi.UNIT_SPHERE=Object.freeze(new hi(1,1,1));hi.MOON=Object.freeze(new hi(R.LUNAR_RADIUS,R.LUNAR_RADIUS,R.LUNAR_RADIUS));hi._default=hi.WGS84;Object.defineProperties(hi,{default:{get:function(){return hi._default},set:function(e){hi._default=e,h._ellipsoidRadiiSquared=e.radiiSquared,de._ellipsoidOneOverRadii=e.oneOverRadii,de._ellipsoidOneOverRadiiSquared=e.oneOverRadiiSquared,de._ellipsoidCenterToleranceSquared=e._centerToleranceSquared}}});hi.prototype.clone=function(e){return hi.clone(this,e)};hi.packedLength=h.packedLength;hi.pack=function(e,t,n){return n=x(n,0),h.pack(e._radii,t,n),t};hi.unpack=function(e,t,n){t=x(t,0);let i=h.unpack(e,t);return hi.fromCartesian3(i,n)};hi.prototype.geocentricSurfaceNormal=h.normalize;hi.prototype.geodeticSurfaceNormalCartographic=function(e,t){let n=e.longitude,i=e.latitude,o=Math.cos(i),r=o*Math.cos(n),s=o*Math.sin(n),a=Math.sin(i);return u(t)||(t=new h),t.x=r,t.y=s,t.z=a,h.normalize(t,t)};hi.prototype.geodeticSurfaceNormal=function(e,t){if(!h.equalsEpsilon(e,h.ZERO,R.EPSILON14))return u(t)||(t=new h),t=h.multiplyComponents(e,this._oneOverRadiiSquared,t),h.normalize(t,t)};var yve=new h,xve=new h;hi.prototype.cartographicToCartesian=function(e,t){let n=yve,i=xve;this.geodeticSurfaceNormalCartographic(e,n),h.multiplyComponents(this._radiiSquared,n,i);let o=Math.sqrt(h.dot(n,i));return h.divideByScalar(i,o,i),h.multiplyByScalar(n,e.height,n),u(t)||(t=new h),h.add(i,n,t)};hi.prototype.cartographicArrayToCartesianArray=function(e,t){let n=e.length;u(t)?t.length=n:t=new Array(n);for(let i=0;i<n;i++)t[i]=this.cartographicToCartesian(e[i],t[i]);return t};var bve=new h,Cve=new h,Ave=new h;hi.prototype.cartesianToCartographic=function(e,t){let n=this.scaleToGeodeticSurface(e,Cve);if(!u(n))return;let i=this.geodeticSurfaceNormal(n,bve),o=h.subtract(e,n,Ave),r=Math.atan2(i.y,i.x),s=Math.asin(i.z),a=R.sign(h.dot(o,e))*h.magnitude(o);return u(t)?(t.longitude=r,t.latitude=s,t.height=a,t):new de(r,s,a)};hi.prototype.cartesianArrayToCartographicArray=function(e,t){let n=e.length;u(t)?t.length=n:t=new Array(n);for(let i=0;i<n;++i)t[i]=this.cartesianToCartographic(e[i],t[i]);return t};hi.prototype.scaleToGeodeticSurface=function(e,t){return tC(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,t)};hi.prototype.scaleToGeocentricSurface=function(e,t){u(t)||(t=new h);let n=e.x,i=e.y,o=e.z,r=this._oneOverRadiiSquared,s=1/Math.sqrt(n*n*r.x+i*i*r.y+o*o*r.z);return h.multiplyByScalar(e,s,t)};hi.prototype.transformPositionToScaledSpace=function(e,t){return u(t)||(t=new h),h.multiplyComponents(e,this._oneOverRadii,t)};hi.prototype.transformPositionFromScaledSpace=function(e,t){return u(t)||(t=new h),h.multiplyComponents(e,this._radii,t)};hi.prototype.equals=function(e){return this===e||u(e)&&h.equals(this._radii,e._radii)};hi.prototype.toString=function(){return this._radii.toString()};hi.prototype.getSurfaceNormalIntersectionWithZAxis=function(e,t,n){t=x(t,0);let i=this._squaredXOverSquaredZ;if(u(n)||(n=new h),n.x=0,n.y=0,n.z=e.z*(1-i),!(Math.abs(n.z)>=this._radii.z-t))return n};var Tve=new h;hi.prototype.getLocalCurvature=function(e,t){u(t)||(t=new H);let n=this.getSurfaceNormalIntersectionWithZAxis(e,0,Tve),i=h.distance(e,n),o=this.minimumRadius*i/this.maximumRadius**2,r=i*o**2;return H.fromElements(1/i,1/r,t)};var Eve=[.14887433898163,.43339539412925,.67940956829902,.86506336668898,.97390652851717,0],Sve=[.29552422471475,.26926671930999,.21908636251598,.14945134915058,.066671344308684,0];function W$(e,t,n){let i=.5*(t+e),o=.5*(t-e),r=0;for(let s=0;s<5;s++){let a=o*Eve[s];r+=Sve[s]*(n(i+a)+n(i-a))}return r*=o,r}hi.prototype.surfaceArea=function(e){let t=e.west,n=e.east,i=e.south,o=e.north;for(;n<t;)n+=R.TWO_PI;let r=this._radiiSquared,s=r.x,a=r.y,c=r.z,l=s*a;return W$(i,o,function(f){let d=Math.cos(f),p=Math.sin(f);return Math.cos(f)*W$(t,n,function(g){let m=Math.cos(g),y=Math.sin(g);return Math.sqrt(l*p*p+c*(a*m*m+s*y*y)*d*d)})})};var ee=hi;function lP(e){this._ellipsoid=x(e,ee.default),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object.defineProperties(lP.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});lP.prototype.project=function(e,t){let n=this._semimajorAxis,i=e.longitude*n,o=e.latitude*n,r=e.height;return u(t)?(t.x=i,t.y=o,t.z=r,t):new h(i,o,r)};lP.prototype.unproject=function(e,t){let n=this._oneOverSemimajorAxis,i=e.x*n,o=e.y*n,r=e.z;return u(t)?(t.longitude=i,t.latitude=o,t.height=r,t):new de(i,o,r)};var Oi=lP;var vve={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},qt=Object.freeze(vve);function wve(e,t,n){let i=0,o=e.length-1,r,s;for(;i<=o;){if(r=~~((i+o)/2),s=n(e[r],t),s<0){i=r+1;continue}if(s>0){o=r-1;continue}return r}return~(o+1)}var No=wve;function Dve(e,t,n,i,o){this.xPoleWander=e,this.yPoleWander=t,this.xPoleOffset=n,this.yPoleOffset=i,this.ut1MinusUtc=o}var Cy=Dve;function Ive(e){return e%4===0&&e%100!==0||e%400===0}var gh=Ive;var q$=[31,28,31,30,31,30,31,31,30,31,30,31];function Pve(e,t,n,i,o,r,s,a){e=x(e,1),t=x(t,1),n=x(n,1),i=x(i,0),o=x(o,0),r=x(r,0),s=x(s,0),a=x(a,!1),this.year=e,this.month=t,this.day=n,this.hour=i,this.minute=o,this.second=r,this.millisecond=s,this.isLeapSecond=a;function y(){To.typeOf.number.greaterThanOrEquals("Year",e,1),To.typeOf.number.lessThanOrEquals("Year",e,9999),To.typeOf.number.greaterThanOrEquals("Month",t,1),To.typeOf.number.lessThanOrEquals("Month",t,12),To.typeOf.number.greaterThanOrEquals("Day",n,1),To.typeOf.number.lessThanOrEquals("Day",n,31),To.typeOf.number.greaterThanOrEquals("Hour",i,0),To.typeOf.number.lessThanOrEquals("Hour",i,23),To.typeOf.number.greaterThanOrEquals("Minute",o,0),To.typeOf.number.lessThanOrEquals("Minute",o,59),To.typeOf.bool("IsLeapSecond",a),To.typeOf.number.greaterThanOrEquals("Second",r,0),To.typeOf.number.lessThanOrEquals("Second",r,a?60:59),To.typeOf.number.greaterThanOrEquals("Millisecond",s,0),To.typeOf.number.lessThan("Millisecond",s,1e3)}function b(){let C=t===2&&gh(e)?q$[t-1]+1:q$[t-1];if(n>C)throw new he("Month and Day represents invalid date")}}var R_=Pve;function Rve(e,t){this.julianDate=e,this.offset=t}var Ki=Rve;var Ove={SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:24000005e-1},Yn=Object.freeze(Ove);var Mve={UTC:0,TAI:1},jn=Object.freeze(Mve);var X$=new R_,B6=[31,28,31,30,31,30,31,31,30,31,30,31],k6=29;function V6(e,t){return Rt.compare(e.julianDate,t.julianDate)}var nC=new Ki;function fP(e){nC.julianDate=e;let t=Rt.leapSeconds,n=No(t,nC,V6);n<0&&(n=~n),n>=t.length&&(n=t.length-1);let i=t[n].offset;n>0&&Rt.secondsDifference(t[n].julianDate,e)>i&&(n--,i=t[n].offset),Rt.addSeconds(e,i,e)}function Y$(e,t){nC.julianDate=e;let n=Rt.leapSeconds,i=No(n,nC,V6);if(i<0&&(i=~i),i===0)return Rt.addSeconds(e,-n[0].offset,t);if(i>=n.length)return Rt.addSeconds(e,-n[i-1].offset,t);let o=Rt.secondsDifference(n[i].julianDate,e);if(o===0)return Rt.addSeconds(e,-n[i].offset,t);if(!(o<=1))return Rt.addSeconds(e,-n[--i].offset,t)}function O_(e,t,n){let i=t/Yn.SECONDS_PER_DAY|0;return e+=i,t-=Yn.SECONDS_PER_DAY*i,t<0&&(e--,t+=Yn.SECONDS_PER_DAY),n.dayNumber=e,n.secondsOfDay=t,n}function U6(e,t,n,i,o,r,s){let a=(t-14)/12|0,c=e+4800+a,l=(1461*c/4|0)+(367*(t-2-12*a)/12|0)-(3*((c+100)/100|0)/4|0)+n-32075;i=i-12,i<0&&(i+=24);let f=r+(i*Yn.SECONDS_PER_HOUR+o*Yn.SECONDS_PER_MINUTE+s*Yn.SECONDS_PER_MILLISECOND);return f>=43200&&(l-=1),[l,f]}var Lve=/^(\d{4})$/,Nve=/^(\d{4})-(\d{2})$/,Fve=/^(\d{4})-?(\d{3})$/,Bve=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,kve=/^(\d{4})-?(\d{2})-?(\d{2})$/,z6=/([Z+\-])?(\d{2})?:?(\d{2})?$/,Vve=/^(\d{2})(\.\d+)?/.source+z6.source,Uve=/^(\d{2}):?(\d{2})(\.\d+)?/.source+z6.source,zve=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+z6.source;function Rt(e,t,n){this.dayNumber=void 0,this.secondsOfDay=void 0,e=x(e,0),t=x(t,0),n=x(n,jn.UTC);let i=e|0;t=t+(e-i)*Yn.SECONDS_PER_DAY,O_(i,t,this),n===jn.UTC&&fP(this)}Rt.fromGregorianDate=function(e,t){let n=U6(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond);return u(t)?(O_(n[0],n[1],t),fP(t),t):new Rt(n[0],n[1],jn.UTC)};Rt.fromDate=function(e,t){let n=U6(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return u(t)?(O_(n[0],n[1],t),fP(t),t):new Rt(n[0],n[1],jn.UTC)};Rt.fromIso8601=function(e,t){e=e.replace(",",".");let n=e.split("T"),i,o=1,r=1,s=0,a=0,c=0,l=0,f=n[0],d=n[1],p,g;if(n=f.match(kve),n!==null)i=+n[1],o=+n[2],r=+n[3];else if(n=f.match(Nve),n!==null)i=+n[1],o=+n[2];else if(n=f.match(Lve),n!==null)i=+n[1];else{let C;if(n=f.match(Fve),n!==null)i=+n[1],C=+n[2],g=gh(i);else if(n=f.match(Bve),n!==null){i=+n[1];let A=+n[2],T=+n[3]||0,E=new Date(Date.UTC(i,0,4));C=A*7+T-E.getUTCDay()-3}p=new Date(Date.UTC(i,0,1)),p.setUTCDate(C),o=p.getUTCMonth()+1,r=p.getUTCDate()}g=gh(i);let m;if(u(d)){n=d.match(zve),n!==null?(s=+n[1],a=+n[2],c=+n[3],l=+(n[4]||0)*1e3,m=5):(n=d.match(Uve),n!==null?(s=+n[1],a=+n[2],c=+(n[3]||0)*60,m=4):(n=d.match(Vve),n!==null&&(s=+n[1],a=+(n[2]||0)*60,m=3)));let C=n[m],A=+n[m+1],T=+(n[m+2]||0);switch(C){case"+":s=s-A,a=a-T;break;case"-":s=s+A,a=a+T;break;case"Z":break;default:a=a+new Date(Date.UTC(i,o-1,r,s,a)).getTimezoneOffset();break}}let y=c===60;for(y&&c--;a>=60;)a-=60,s++;for(;s>=24;)s-=24,r++;for(p=g&&o===2?k6:B6[o-1];r>p;)r-=p,o++,o>12&&(o-=12,i++),p=g&&o===2?k6:B6[o-1];for(;a<0;)a+=60,s--;for(;s<0;)s+=24,r--;for(;r<1;)o--,o<1&&(o+=12,i--),p=g&&o===2?k6:B6[o-1],r+=p;let b=U6(i,o,r,s,a,c,l);return u(t)?(O_(b[0],b[1],t),fP(t)):t=new Rt(b[0],b[1],jn.UTC),y&&Rt.addSeconds(t,1,t),t};Rt.now=function(e){return Rt.fromDate(new Date,e)};var uP=new Rt(0,0,jn.TAI);Rt.toGregorianDate=function(e,t){let n=!1,i=Y$(e,uP);u(i)||(Rt.addSeconds(e,-1,uP),i=Y$(uP,uP),n=!0);let o=i.dayNumber,r=i.secondsOfDay;r>=43200&&(o+=1);let s=o+68569|0,a=4*s/146097|0;s=s-((146097*a+3)/4|0)|0;let c=4e3*(s+1)/1461001|0;s=s-(1461*c/4|0)+31|0;let l=80*s/2447|0,f=s-(2447*l/80|0)|0;s=l/11|0;let d=l+2-12*s|0,p=100*(a-49)+c+s|0,g=r/Yn.SECONDS_PER_HOUR|0,m=r-g*Yn.SECONDS_PER_HOUR,y=m/Yn.SECONDS_PER_MINUTE|0;m=m-y*Yn.SECONDS_PER_MINUTE;let b=m|0,C=(m-b)/Yn.SECONDS_PER_MILLISECOND;return g+=12,g>23&&(g-=24),n&&(b+=1),u(t)?(t.year=p,t.month=d,t.day=f,t.hour=g,t.minute=y,t.second=b,t.millisecond=C,t.isLeapSecond=n,t):new R_(p,d,f,g,y,b,C,n)};Rt.toDate=function(e){let t=Rt.toGregorianDate(e,X$),n=t.second;return t.isLeapSecond&&(n-=1),new Date(Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,n,t.millisecond))};Rt.toIso8601=function(e,t){let n=Rt.toGregorianDate(e,X$),i=n.year,o=n.month,r=n.day,s=n.hour,a=n.minute,c=n.second,l=n.millisecond;i===1e4&&o===1&&r===1&&s===0&&a===0&&c===0&&l===0&&(i=9999,o=12,r=31,s=24);let f;return!u(t)&&l!==0?(f=(l*.01).toString().replace(".",""),`${i.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${r.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}.${f}Z`):!u(t)||t===0?`${i.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${r.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}Z`:(f=(l*.01).toFixed(t).replace(".","").slice(0,t),`${i.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${r.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}.${f}Z`)};Rt.clone=function(e,t){if(u(e))return u(t)?(t.dayNumber=e.dayNumber,t.secondsOfDay=e.secondsOfDay,t):new Rt(e.dayNumber,e.secondsOfDay,jn.TAI)};Rt.compare=function(e,t){let n=e.dayNumber-t.dayNumber;return n!==0?n:e.secondsOfDay-t.secondsOfDay};Rt.equals=function(e,t){return e===t||u(e)&&u(t)&&e.dayNumber===t.dayNumber&&e.secondsOfDay===t.secondsOfDay};Rt.equalsEpsilon=function(e,t,n){return n=x(n,0),e===t||u(e)&&u(t)&&Math.abs(Rt.secondsDifference(e,t))<=n};Rt.totalDays=function(e){return e.dayNumber+e.secondsOfDay/Yn.SECONDS_PER_DAY};Rt.secondsDifference=function(e,t){return(e.dayNumber-t.dayNumber)*Yn.SECONDS_PER_DAY+(e.secondsOfDay-t.secondsOfDay)};Rt.daysDifference=function(e,t){let n=e.dayNumber-t.dayNumber,i=(e.secondsOfDay-t.secondsOfDay)/Yn.SECONDS_PER_DAY;return n+i};Rt.computeTaiMinusUtc=function(e){nC.julianDate=e;let t=Rt.leapSeconds,n=No(t,nC,V6);return n<0&&(n=~n,--n,n<0&&(n=0)),t[n].offset};Rt.addSeconds=function(e,t,n){return O_(e.dayNumber,e.secondsOfDay+t,n)};Rt.addMinutes=function(e,t,n){let i=e.secondsOfDay+t*Yn.SECONDS_PER_MINUTE;return O_(e.dayNumber,i,n)};Rt.addHours=function(e,t,n){let i=e.secondsOfDay+t*Yn.SECONDS_PER_HOUR;return O_(e.dayNumber,i,n)};Rt.addDays=function(e,t,n){let i=e.dayNumber+t;return O_(i,e.secondsOfDay,n)};Rt.lessThan=function(e,t){return Rt.compare(e,t)<0};Rt.lessThanOrEquals=function(e,t){return Rt.compare(e,t)<=0};Rt.greaterThan=function(e,t){return Rt.compare(e,t)>0};Rt.greaterThanOrEquals=function(e,t){return Rt.compare(e,t)>=0};Rt.prototype.clone=function(e){return Rt.clone(this,e)};Rt.prototype.equals=function(e){return Rt.equals(this,e)};Rt.prototype.equalsEpsilon=function(e,t){return Rt.equalsEpsilon(this,e,t)};Rt.prototype.toString=function(){return Rt.toIso8601(this)};Rt.leapSeconds=[new Ki(new Rt(2441317,43210,jn.TAI),10),new Ki(new Rt(2441499,43211,jn.TAI),11),new Ki(new Rt(2441683,43212,jn.TAI),12),new Ki(new Rt(2442048,43213,jn.TAI),13),new Ki(new Rt(2442413,43214,jn.TAI),14),new Ki(new Rt(2442778,43215,jn.TAI),15),new Ki(new Rt(2443144,43216,jn.TAI),16),new Ki(new Rt(2443509,43217,jn.TAI),17),new Ki(new Rt(2443874,43218,jn.TAI),18),new Ki(new Rt(2444239,43219,jn.TAI),19),new Ki(new Rt(2444786,43220,jn.TAI),20),new Ki(new Rt(2445151,43221,jn.TAI),21),new Ki(new Rt(2445516,43222,jn.TAI),22),new Ki(new Rt(2446247,43223,jn.TAI),23),new Ki(new Rt(2447161,43224,jn.TAI),24),new Ki(new Rt(2447892,43225,jn.TAI),25),new Ki(new Rt(2448257,43226,jn.TAI),26),new Ki(new Rt(2448804,43227,jn.TAI),27),new Ki(new Rt(2449169,43228,jn.TAI),28),new Ki(new Rt(2449534,43229,jn.TAI),29),new Ki(new Rt(2450083,43230,jn.TAI),30),new Ki(new Rt(2450630,43231,jn.TAI),31),new Ki(new Rt(2451179,43232,jn.TAI),32),new Ki(new Rt(2453736,43233,jn.TAI),33),new Ki(new Rt(2454832,43234,jn.TAI),34),new Ki(new Rt(2456109,43235,jn.TAI),35),new Ki(new Rt(2457204,43236,jn.TAI),36),new Ki(new Rt(2457754,43237,jn.TAI),37)];var $=Rt;var hQ=Dr(Gl(),1);function Hve(e){return(e.length===0||e[e.length-1]!=="/")&&(e=`${e}/`),e}var pP=Hve;function tQ(e,t){if(e===null||typeof e!="object")return e;t=x(t,!1);let n=new e.constructor;for(let i in e)if(e.hasOwnProperty(i)){let o=e[i];t&&(o=tQ(o,t)),n[i]=o}return n}var Ge=tQ;function nQ(e,t,n){n=x(n,!1);let i={},o=u(e),r=u(t),s,a,c;if(o)for(s in e)e.hasOwnProperty(s)&&(a=e[s],r&&n&&typeof a=="object"&&t.hasOwnProperty(s)?(c=t[s],typeof c=="object"?i[s]=nQ(a,c,n):i[s]=a):i[s]=a);if(r)for(s in t)t.hasOwnProperty(s)&&!i.hasOwnProperty(s)&&(c=t[s],i[s]=c);return i}var bt=nQ;function Gve(){let e,t,n=new Promise(function(i,o){e=i,t=o});return{resolve:e,reject:t,promise:n}}var Wl=Gve;var iQ=Dr(Gl(),1);function H6(e,t){let n;return typeof document<"u"&&(n=document),H6._implementation(e,t,n)}H6._implementation=function(e,t,n){if(!u(t)){if(typeof n>"u")return e;t=x(n.baseURI,n.location.href)}let i=new iQ.default(e);return i.scheme()!==""?i.toString():i.absoluteTo(t).toString()};var Km=H6;var oQ=Dr(Gl(),1);function Wve(e,t){let n="",i=e.lastIndexOf("/");return i!==-1&&(n=e.substring(0,i+1)),t&&(e=new oQ.default(e),e.query().length!==0&&(n+=`?${e.query()}`),e.fragment().length!==0&&(n+=`#${e.fragment()}`)),n}var _P=Wve;var rQ=Dr(Gl(),1);function jve(e){let t=new rQ.default(e);t.normalize();let n=t.path(),i=n.lastIndexOf("/");return i!==-1&&(n=n.substr(i+1)),i=n.lastIndexOf("."),i===-1?n="":n=n.substr(i+1),n}var rC=jve;var sQ={};function qve(e,t,n){u(t)||(t=e.width),u(n)||(n=e.height);let i=sQ[t];u(i)||(i={},sQ[t]=i);let o=i[n];if(!u(o)){let r=document.createElement("canvas");r.width=t,r.height=n,o=r.getContext("2d",{willReadFrequently:!0}),o.globalCompositeOperation="copy",i[n]=o}return o.drawImage(e,0,0,t,n),o.getImageData(0,0,t,n).data}var yh=qve;var Yve=/^blob:/i;function Xve(e){return Yve.test(e)}var sC=Xve;var xh;function Kve(e){u(xh)||(xh=document.createElement("a")),xh.href=window.location.href;let t=xh.host,n=xh.protocol;return xh.href=e,xh.href=xh.href,n!==xh.protocol||t!==xh.host}var Ay=Kve;var Zve=/^data:/i;function $ve(e){return Zve.test(e)}var M_=$ve;function Qve(e){let t=document.createElement("script");return t.async=!0,t.src=e,new Promise((n,i)=>{window.crossOriginIsolated&&t.setAttribute("crossorigin","anonymous");let o=document.getElementsByTagName("head")[0];t.onload=function(){t.onload=void 0,o.removeChild(t),n()},t.onerror=function(r){i(r)},o.appendChild(t)})}var aC=Qve;function Jve(e){let t="";for(let n in e)if(e.hasOwnProperty(n)){let i=e[n],o=`${encodeURIComponent(n)}=`;if(Array.isArray(i))for(let r=0,s=i.length;r<s;++r)t+=`${o+encodeURIComponent(i[r])}&`;else t+=`${o+encodeURIComponent(i)}&`}return t=t.slice(0,-1),t}var cC=Jve;function ewe(e){let t={};if(e==="")return t;let n=e.replace(/\+/g,"%20").split(/[&;]/);for(let i=0,o=n.length;i<o;++i){let r=n[i].split("="),s=decodeURIComponent(r[0]),a=r[1];u(a)?a=decodeURIComponent(a):a="";let c=t[s];typeof c=="string"?t[s]=[c,a]:Array.isArray(c)?c.push(a):t[s]=a}return t}var Xu=ewe;var twe={UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5},$n=Object.freeze(twe);var nwe={TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3},gs=Object.freeze(nwe);function gP(e){e=x(e,x.EMPTY_OBJECT);let t=x(e.throttleByServer,!1),n=x(e.throttle,!1);this.url=e.url,this.requestFunction=e.requestFunction,this.cancelFunction=e.cancelFunction,this.priorityFunction=e.priorityFunction,this.priority=x(e.priority,0),this.throttle=n,this.throttleByServer=t,this.type=x(e.type,gs.OTHER),this.serverKey=e.serverKey,this.state=$n.UNISSUED,this.deferred=void 0,this.cancelled=!1}gP.prototype.cancel=function(){this.cancelled=!0};gP.prototype.clone=function(e){return u(e)?(e.url=this.url,e.requestFunction=this.requestFunction,e.cancelFunction=this.cancelFunction,e.priorityFunction=this.priorityFunction,e.priority=this.priority,e.throttle=this.throttle,e.throttleByServer=this.throttleByServer,e.type=this.type,e.serverKey=this.serverKey,e.state=$n.UNISSUED,e.deferred=void 0,e.cancelled=!1,e):new gP(this)};var rr=gP;function iwe(e){let t={};if(!e)return t;let n=e.split(`\r
`);for(let i=0;i<n.length;++i){let o=n[i],r=o.indexOf(": ");if(r>0){let s=o.substring(0,r),a=o.substring(r+2);t[s]=a}}return t}var yP=iwe;function aQ(e,t,n){this.statusCode=e,this.response=t,this.responseHeaders=n,typeof this.responseHeaders=="string"&&(this.responseHeaders=yP(this.responseHeaders))}aQ.prototype.toString=function(){let e="Request has failed.";return u(this.statusCode)&&(e+=` Status Code: ${this.statusCode}`),e};var Zm=aQ;var bP=Dr(Gl(),1);function LS(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}Object.defineProperties(LS.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}});LS.prototype.addEventListener=function(e,t){this._listeners.push(e),this._scopes.push(t);let n=this;return function(){n.removeEventListener(e,t)}};LS.prototype.removeEventListener=function(e,t){let n=this._listeners,i=this._scopes,o=-1;for(let r=0;r<n.length;r++)if(n[r]===e&&i[r]===t){o=r;break}return o!==-1?(this._insideRaiseEvent?(this._toRemove.push(o),n[o]=void 0,i[o]=void 0):(n.splice(o,1),i.splice(o,1)),!0):!1};function owe(e,t){return t-e}LS.prototype.raiseEvent=function(){this._insideRaiseEvent=!0;let e,t=this._listeners,n=this._scopes,i=t.length;for(e=0;e<i;e++){let r=t[e];u(r)&&t[e].apply(n[e],arguments)}let o=this._toRemove;if(i=o.length,i>0){for(o.sort(owe),e=0;e<i;e++){let r=o[e];t.splice(r,1),n.splice(r,1)}o.length=0}this._insideRaiseEvent=!1};var me=LS;function Ty(e){this._comparator=e.comparator,this._array=[],this._length=0,this._maximumLength=void 0}Object.defineProperties(Ty.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(e){let t=this._length;if(e<t){let n=this._array;for(let i=e;i<t;++i)n[i]=void 0;this._length=e,n.length=e}this._maximumLength=e}},comparator:{get:function(){return this._comparator}}});function G6(e,t,n){let i=e[t];e[t]=e[n],e[n]=i}Ty.prototype.reserve=function(e){e=x(e,this._length),this._array.length=e};Ty.prototype.heapify=function(e){e=x(e,0);let t=this._length,n=this._comparator,i=this._array,o=-1,r=!0;for(;r;){let s=2*(e+1),a=s-1;a<t&&n(i[a],i[e])<0?o=a:o=e,s<t&&n(i[s],i[o])<0&&(o=s),o!==e?(G6(i,o,e),e=o):r=!1}};Ty.prototype.resort=function(){let e=this._length;for(let t=Math.ceil(e/2);t>=0;--t)this.heapify(t)};Ty.prototype.insert=function(e){let t=this._array,n=this._comparator,i=this._maximumLength,o=this._length++;for(o<t.length?t[o]=e:t.push(e);o!==0;){let s=Math.floor((o-1)/2);if(n(t[o],t[s])<0)G6(t,o,s),o=s;else break}let r;return u(i)&&this._length>i&&(r=t[i],this._length=i),r};Ty.prototype.pop=function(e){if(e=x(e,0),this._length===0)return;let t=this._array,n=t[e];return G6(t,e,--this._length),this.heapify(e),t[this._length]=void 0,n};var xP=Ty;function rwe(e,t){return e.priority-t.priority}var Ji={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0,lastNumberOfActiveRequests:0},lC=20,Ha=new xP({comparator:rwe});Ha.maximumLength=lC;Ha.reserve(lC);var bh=[],$m={},swe=typeof document<"u"?new bP.default(document.location.href):new bP.default,CP=new me;function qo(){}qo.maximumRequests=50;qo.maximumRequestsPerServer=18;qo.requestsByServer={};qo.throttleRequests=!0;qo.debugShowStatistics=!1;qo.requestCompletedEvent=CP;Object.defineProperties(qo,{statistics:{get:function(){return Ji}},priorityHeapLength:{get:function(){return lC},set:function(e){if(e<lC)for(;Ha.length>e;){let t=Ha.pop();Ey(t)}lC=e,Ha.maximumLength=e,Ha.reserve(e)}}});function cQ(e){u(e.priorityFunction)&&(e.priority=e.priorityFunction())}qo.serverHasOpenSlots=function(e,t){t=x(t,1);let n=x(qo.requestsByServer[e],qo.maximumRequestsPerServer);return $m[e]+t<=n};qo.heapHasOpenSlots=function(e){return Ha.length+e<=lC};function lQ(e){return e.state===$n.UNISSUED&&(e.state=$n.ISSUED,e.deferred=Wl()),e.deferred.promise}function awe(e){return function(t){if(e.state===$n.CANCELLED)return;let n=e.deferred;--Ji.numberOfActiveRequests,--$m[e.serverKey],CP.raiseEvent(),e.state=$n.RECEIVED,e.deferred=void 0,n.resolve(t)}}function cwe(e){return function(t){e.state!==$n.CANCELLED&&(++Ji.numberOfFailedRequests,--Ji.numberOfActiveRequests,--$m[e.serverKey],CP.raiseEvent(t),e.state=$n.FAILED,e.deferred.reject(t))}}function uQ(e){let t=lQ(e);return e.state=$n.ACTIVE,bh.push(e),++Ji.numberOfActiveRequests,++Ji.numberOfActiveRequestsEver,++$m[e.serverKey],e.requestFunction().then(awe(e)).catch(cwe(e)),t}function Ey(e){let t=e.state===$n.ACTIVE;if(e.state=$n.CANCELLED,++Ji.numberOfCancelledRequests,u(e.deferred)){let n=e.deferred;e.deferred=void 0,n.reject()}t&&(--Ji.numberOfActiveRequests,--$m[e.serverKey],++Ji.numberOfCancelledActiveRequests),u(e.cancelFunction)&&e.cancelFunction()}qo.update=function(){let e,t,n=0,i=bh.length;for(e=0;e<i;++e){if(t=bh[e],t.cancelled&&Ey(t),t.state!==$n.ACTIVE){++n;continue}n>0&&(bh[e-n]=t)}bh.length-=n;let o=Ha.internalArray,r=Ha.length;for(e=0;e<r;++e)cQ(o[e]);Ha.resort();let s=Math.max(qo.maximumRequests-bh.length,0),a=0;for(;a<s&&Ha.length>0;){if(t=Ha.pop(),t.cancelled){Ey(t);continue}if(t.throttleByServer&&!qo.serverHasOpenSlots(t.serverKey)){Ey(t);continue}uQ(t),++a}lwe()};qo.getServerKey=function(e){let t=new bP.default(e);t.scheme()===""&&(t=t.absoluteTo(swe),t.normalize());let n=t.authority();/:/.test(n)||(n=`${n}:${t.scheme()==="https"?"443":"80"}`);let i=$m[n];return u(i)||($m[n]=0),n};qo.request=function(e){if(M_(e.url)||sC(e.url))return CP.raiseEvent(),e.state=$n.RECEIVED,e.requestFunction();if(++Ji.numberOfAttemptedRequests,u(e.serverKey)||(e.serverKey=qo.getServerKey(e.url)),qo.throttleRequests&&e.throttleByServer&&!qo.serverHasOpenSlots(e.serverKey))return;if(!qo.throttleRequests||!e.throttle)return uQ(e);if(bh.length>=qo.maximumRequests)return;cQ(e);let t=Ha.insert(e);if(u(t)){if(t===e)return;Ey(t)}return lQ(e)};function lwe(){qo.debugShowStatistics&&(Ji.numberOfActiveRequests===0&&Ji.lastNumberOfActiveRequests>0&&(Ji.numberOfAttemptedRequests>0&&(console.log(`Number of attempted requests: ${Ji.numberOfAttemptedRequests}`),Ji.numberOfAttemptedRequests=0),Ji.numberOfCancelledRequests>0&&(console.log(`Number of cancelled requests: ${Ji.numberOfCancelledRequests}`),Ji.numberOfCancelledRequests=0),Ji.numberOfCancelledActiveRequests>0&&(console.log(`Number of cancelled active requests: ${Ji.numberOfCancelledActiveRequests}`),Ji.numberOfCancelledActiveRequests=0),Ji.numberOfFailedRequests>0&&(console.log(`Number of failed requests: ${Ji.numberOfFailedRequests}`),Ji.numberOfFailedRequests=0)),Ji.lastNumberOfActiveRequests=Ji.numberOfActiveRequests)}qo.clearForSpecs=function(){for(;Ha.length>0;){let t=Ha.pop();Ey(t)}let e=bh.length;for(let t=0;t<e;++t)Ey(bh[t]);bh.length=0,$m={},Ji.numberOfAttemptedRequests=0,Ji.numberOfActiveRequests=0,Ji.numberOfCancelledRequests=0,Ji.numberOfCancelledActiveRequests=0,Ji.numberOfFailedRequests=0,Ji.numberOfActiveRequestsEver=0,Ji.lastNumberOfActiveRequests=0};qo.numberOfActiveRequestsByServer=function(e){return $m[e]};qo.requestHeap=Ha;var Cc=qo;var fQ=Dr(Gl(),1);var NS={},uC={};NS.add=function(e,t){let n=`${e.toLowerCase()}:${t}`;u(uC[n])||(uC[n]=!0)};NS.remove=function(e,t){let n=`${e.toLowerCase()}:${t}`;u(uC[n])&&delete uC[n]};function uwe(e){let t=new fQ.default(e);t.normalize();let n=t.authority();if(n.length!==0){if(t.authority(n),n.indexOf("@")!==-1&&(n=n.split("@")[1]),n.indexOf(":")===-1){let i=t.scheme();if(i.length===0&&(i=window.location.protocol,i=i.substring(0,i.length-1)),i==="http")n+=":80";else if(i==="https")n+=":443";else return}return n}}NS.contains=function(e){let t=uwe(e);return!!(u(t)&&u(uC[t]))};NS.clear=function(){uC={}};var FS=NS;var mQ=function(){try{let e=new XMLHttpRequest;return e.open("GET","#",!0),e.responseType="blob",e.responseType==="blob"}catch{return!1}}();function It(e){e=x(e,x.EMPTY_OBJECT),typeof e=="string"&&(e={url:e}),this._url=void 0,this._templateValues=Ch(e.templateValues,{}),this._queryParameters=Ch(e.queryParameters,{}),this.headers=Ch(e.headers,{}),this.request=x(e.request,new rr),this.proxy=e.proxy,this.retryCallback=e.retryCallback,this.retryAttempts=x(e.retryAttempts,0),this._retryCount=0,x(e.parseUrl,!0)?this.parseUrl(e.url,!0,!0):this._url=e.url,this._credits=e.credits}function Ch(e,t){return u(e)?Ge(e):t}It.createIfNeeded=function(e){return e instanceof It?e.getDerivedResource({request:e.request}):typeof e!="string"?e:new It({url:e})};var fC;It.supportsImageBitmapOptions=function(){return u(fC)?fC:typeof createImageBitmap!="function"?(fC=Promise.resolve(!1),fC):(fC=It.fetchBlob({url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAABGdBTUEAAE4g3rEiDgAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAADElEQVQI12Ng6GAAAAEUAIngE3ZiAAAAAElFTkSuQmCC"}).then(function(t){let n={imageOrientation:"flipY",premultiplyAlpha:"none",colorSpaceConversion:"none"};return Promise.all([createImageBitmap(t,n),createImageBitmap(t)])}).then(function(t){let n=yh(t[0]),i=yh(t[1]);return n[1]!==i[1]}).catch(function(){return!1}),fC)};Object.defineProperties(It,{isBlobSupported:{get:function(){return mQ}}});Object.defineProperties(It.prototype,{queryParameters:{get:function(){return this._queryParameters}},templateValues:{get:function(){return this._templateValues}},url:{get:function(){return this.getUrlComponent(!0,!0)},set:function(e){this.parseUrl(e,!1,!1)}},extension:{get:function(){return rC(this._url)}},isDataUri:{get:function(){return M_(this._url)}},isBlobUri:{get:function(){return sC(this._url)}},isCrossOriginUrl:{get:function(){return Ay(this._url)}},hasHeaders:{get:function(){return Object.keys(this.headers).length>0}},credits:{get:function(){return this._credits}}});It.prototype.toString=function(){return this.getUrlComponent(!0,!0)};It.prototype.parseUrl=function(e,t,n,i){let o=new hQ.default(e),r=fwe(o.query());this._queryParameters=t?TP(r,this.queryParameters,n):r,o.search(""),o.fragment(""),u(i)&&o.scheme()===""&&(o=o.absoluteTo(Km(i))),this._url=o.toString()};function fwe(e){return e.length===0?{}:e.indexOf("=")===-1?{[e]:void 0}:Xu(e)}function TP(e,t,n){if(!n)return bt(e,t);let i=Ge(e,!0);for(let o in t)if(t.hasOwnProperty(o)){let r=i[o],s=t[o];u(r)?(Array.isArray(r)||(r=i[o]=[r]),i[o]=r.concat(s)):i[o]=Array.isArray(s)?s.slice():s}return i}It.prototype.getUrlComponent=function(e,t){if(this.isDataUri)return this._url;let n=this._url;e&&(n=`${n}${dwe(this.queryParameters)}`),n=n.replace(/%7B/g,"{").replace(/%7D/g,"}");let i=this._templateValues;return Object.keys(i).length>0&&(n=n.replace(/{(.*?)}/g,function(o,r){let s=i[r];return u(s)?encodeURIComponent(s):o})),t&&u(this.proxy)&&(n=this.proxy.getURL(n)),n};function dwe(e){let t=Object.keys(e);return t.length===0?"":t.length===1&&!u(e[t[0]])?`?${t[0]}`:`?${cC(e)}`}It.prototype.setQueryParameters=function(e,t){t?this._queryParameters=TP(this._queryParameters,e,!1):this._queryParameters=TP(e,this._queryParameters,!1)};It.prototype.appendQueryParameters=function(e){this._queryParameters=TP(e,this._queryParameters,!0)};It.prototype.setTemplateValues=function(e,t){t?this._templateValues=bt(this._templateValues,e):this._templateValues=bt(e,this._templateValues)};It.prototype.getDerivedResource=function(e){let t=this.clone();if(t._retryCount=0,u(e.url)){let n=x(e.preserveQueryParameters,!1);t.parseUrl(e.url,!0,n,this._url)}return u(e.queryParameters)&&(t._queryParameters=bt(e.queryParameters,t.queryParameters)),u(e.templateValues)&&(t._templateValues=bt(e.templateValues,t.templateValues)),u(e.headers)&&(t.headers=bt(e.headers,t.headers)),u(e.proxy)&&(t.proxy=e.proxy),u(e.request)&&(t.request=e.request),u(e.retryCallback)&&(t.retryCallback=e.retryCallback),u(e.retryAttempts)&&(t.retryAttempts=e.retryAttempts),t};It.prototype.retryOnError=function(e){let t=this.retryCallback;if(typeof t!="function"||this._retryCount>=this.retryAttempts)return Promise.resolve(!1);let n=this;return Promise.resolve(t(this,e)).then(function(i){return++n._retryCount,i})};It.prototype.clone=function(e){return u(e)?(e._url=this._url,e._queryParameters=Ge(this._queryParameters),e._templateValues=Ge(this._templateValues),e.headers=Ge(this.headers),e.proxy=this.proxy,e.retryCallback=this.retryCallback,e.retryAttempts=this.retryAttempts,e._retryCount=0,e.request=this.request.clone(),e):new It({url:this._url,queryParameters:this.queryParameters,templateValues:this.templateValues,headers:this.headers,proxy:this.proxy,retryCallback:this.retryCallback,retryAttempts:this.retryAttempts,request:this.request.clone(),parseUrl:!1,credits:u(this.credits)?this.credits.slice():void 0})};It.prototype.getBaseUri=function(e){return _P(this.getUrlComponent(e),e)};It.prototype.appendForwardSlash=function(){this._url=pP(this._url)};It.prototype.fetchArrayBuffer=function(){return this.fetch({responseType:"arraybuffer"})};It.fetchArrayBuffer=function(e){return new It(e).fetchArrayBuffer()};It.prototype.fetchBlob=function(){return this.fetch({responseType:"blob"})};It.fetchBlob=function(e){return new It(e).fetchBlob()};It.prototype.fetchImage=function(e){e=x(e,x.EMPTY_OBJECT);let t=x(e.preferImageBitmap,!1),n=x(e.preferBlob,!1),i=x(e.flipY,!1),o=x(e.skipColorSpaceConversion,!1);if(j6(this.request),!mQ||this.isDataUri||this.isBlobUri||!this.hasHeaders&&!n)return W6({resource:this,flipY:i,skipColorSpaceConversion:o,preferImageBitmap:t});let r=this.fetchBlob();if(!u(r))return;let s,a,c,l;return It.supportsImageBitmapOptions().then(function(f){return s=f,a=s&&t,r}).then(function(f){if(!u(f))return;if(l=f,a)return It.createImageBitmapFromBlob(f,{flipY:i,premultiplyAlpha:!1,skipColorSpaceConversion:o});let d=window.URL.createObjectURL(f);return c=new It({url:d}),W6({resource:c,flipY:i,skipColorSpaceConversion:o,preferImageBitmap:!1})}).then(function(f){if(u(f))return f.blob=l,a||window.URL.revokeObjectURL(c.url),f}).catch(function(f){return u(c)&&window.URL.revokeObjectURL(c.url),f.blob=l,Promise.reject(f)})};function W6(e){let t=e.resource,n=e.flipY,i=e.skipColorSpaceConversion,o=e.preferImageBitmap,r=t.request;r.url=t.url,r.requestFunction=function(){let a=!1;!t.isDataUri&&!t.isBlobUri&&(a=t.isCrossOriginUrl);let c=Wl();return It._Implementations.createImage(r,a,c,n,i,o),c.promise};let s=Cc.request(r);if(u(s))return s.catch(function(a){return r.state!==$n.FAILED?Promise.reject(a):t.retryOnError(a).then(function(c){return c?(r.state=$n.UNISSUED,r.deferred=void 0,W6({resource:t,flipY:n,skipColorSpaceConversion:i,preferImageBitmap:o})):Promise.reject(a)})})}It.fetchImage=function(e){return new It(e).fetchImage({flipY:e.flipY,skipColorSpaceConversion:e.skipColorSpaceConversion,preferBlob:e.preferBlob,preferImageBitmap:e.preferImageBitmap})};It.prototype.fetchText=function(){return this.fetch({responseType:"text"})};It.fetchText=function(e){return new It(e).fetchText()};It.prototype.fetchJson=function(){let e=this.fetch({responseType:"text",headers:{Accept:"application/json,*/*;q=0.01"}});if(u(e))return e.then(function(t){if(u(t))return JSON.parse(t)})};It.fetchJson=function(e){return new It(e).fetchJson()};It.prototype.fetchXML=function(){return this.fetch({responseType:"document",overrideMimeType:"text/xml"})};It.fetchXML=function(e){return new It(e).fetchXML()};It.prototype.fetchJsonp=function(e){e=x(e,"callback"),j6(this.request);let t;do t=`loadJsonp${R.nextRandomNumber().toString().substring(2,8)}`;while(u(window[t]));return pQ(this,e,t)};function pQ(e,t,n){let i={};i[t]=n,e.setQueryParameters(i);let o=e.request,r=e.url;o.url=r,o.requestFunction=function(){let a=Wl();return window[n]=function(c){a.resolve(c);try{delete window[n]}catch{window[n]=void 0}},It._Implementations.loadAndExecuteScript(r,n,a),a.promise};let s=Cc.request(o);if(u(s))return s.catch(function(a){return o.state!==$n.FAILED?Promise.reject(a):e.retryOnError(a).then(function(c){return c?(o.state=$n.UNISSUED,o.deferred=void 0,pQ(e,t,n)):Promise.reject(a)})})}It.fetchJsonp=function(e){return new It(e).fetchJsonp(e.callbackParameterName)};It.prototype._makeRequest=function(e){let t=this;j6(t.request);let n=t.request,i=t.url;n.url=i,n.requestFunction=function(){let r=e.responseType,s=bt(e.headers,t.headers),a=e.overrideMimeType,c=e.method,l=e.data,f=Wl(),d=It._Implementations.loadWithXhr(i,r,c,l,s,f,a);return u(d)&&u(d.abort)&&(n.cancelFunction=function(){d.abort()}),f.promise};let o=Cc.request(n);if(u(o))return o.then(function(r){return n.cancelFunction=void 0,r}).catch(function(r){return n.cancelFunction=void 0,n.state!==$n.FAILED?Promise.reject(r):t.retryOnError(r).then(function(s){return s?(n.state=$n.UNISSUED,n.deferred=void 0,t.fetch(e)):Promise.reject(r)})})};function j6(e){if(e.state===$n.ISSUED||e.state===$n.ACTIVE)throw new ce("The Resource is already being fetched.");e.state=$n.UNISSUED,e.deferred=void 0}var hwe=/^data:(.*?)(;base64)?,(.*)$/;function AP(e,t){let n=decodeURIComponent(t);return e?atob(n):n}function dQ(e,t){let n=AP(e,t),i=new ArrayBuffer(n.length),o=new Uint8Array(i);for(let r=0;r<n.length;r++)o[r]=n.charCodeAt(r);return i}function mwe(e,t){t=x(t,"");let n=e[1],i=!!e[2],o=e[3],r,s;switch(t){case"":case"text":return AP(i,o);case"arraybuffer":return dQ(i,o);case"blob":return r=dQ(i,o),new Blob([r],{type:n});case"document":return s=new DOMParser,s.parseFromString(AP(i,o),n);case"json":return JSON.parse(AP(i,o));default:}}It.prototype.fetch=function(e){return e=Ch(e,{}),e.method="GET",this._makeRequest(e)};It.fetch=function(e){return new It(e).fetch({responseType:e.responseType,overrideMimeType:e.overrideMimeType})};It.prototype.delete=function(e){return e=Ch(e,{}),e.method="DELETE",this._makeRequest(e)};It.delete=function(e){return new It(e).delete({responseType:e.responseType,overrideMimeType:e.overrideMimeType,data:e.data})};It.prototype.head=function(e){return e=Ch(e,{}),e.method="HEAD",this._makeRequest(e)};It.head=function(e){return new It(e).head({responseType:e.responseType,overrideMimeType:e.overrideMimeType})};It.prototype.options=function(e){return e=Ch(e,{}),e.method="OPTIONS",this._makeRequest(e)};It.options=function(e){return new It(e).options({responseType:e.responseType,overrideMimeType:e.overrideMimeType})};It.prototype.post=function(e,t){return To.defined("data",e),t=Ch(t,{}),t.method="POST",t.data=e,this._makeRequest(t)};It.post=function(e){return new It(e).post(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})};It.prototype.put=function(e,t){return To.defined("data",e),t=Ch(t,{}),t.method="PUT",t.data=e,this._makeRequest(t)};It.put=function(e){return new It(e).put(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})};It.prototype.patch=function(e,t){return To.defined("data",e),t=Ch(t,{}),t.method="PATCH",t.data=e,this._makeRequest(t)};It.patch=function(e){return new It(e).patch(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})};It._Implementations={};It._Implementations.loadImageElement=function(e,t,n){let i=new Image;i.onload=function(){i.naturalWidth===0&&i.naturalHeight===0&&i.width===0&&i.height===0&&(i.width=300,i.height=150),n.resolve(i)},i.onerror=function(o){n.reject(o)},t&&(FS.contains(e)?i.crossOrigin="use-credentials":i.crossOrigin=""),i.src=e};It._Implementations.createImage=function(e,t,n,i,o,r){let s=e.url;It.supportsImageBitmapOptions().then(function(a){if(!(a&&r)){It._Implementations.loadImageElement(s,t,n);return}let c="blob",l="GET",f=Wl(),d=It._Implementations.loadWithXhr(s,c,l,void 0,void 0,f,void 0,void 0,void 0);return u(d)&&u(d.abort)&&(e.cancelFunction=function(){d.abort()}),f.promise.then(function(p){if(!u(p)){n.reject(new ce(`Successfully retrieved ${s} but it contained no content.`));return}return It.createImageBitmapFromBlob(p,{flipY:i,premultiplyAlpha:!1,skipColorSpaceConversion:o})}).then(function(p){n.resolve(p)})}).catch(function(a){n.reject(a)})};It.createImageBitmapFromBlob=function(e,t){return To.defined("options",t),To.typeOf.bool("options.flipY",t.flipY),To.typeOf.bool("options.premultiplyAlpha",t.premultiplyAlpha),To.typeOf.bool("options.skipColorSpaceConversion",t.skipColorSpaceConversion),createImageBitmap(e,{imageOrientation:t.flipY?"flipY":"none",premultiplyAlpha:t.premultiplyAlpha?"premultiply":"none",colorSpaceConversion:t.skipColorSpaceConversion?"none":"default"})};function pwe(e,t,n,i,o,r,s){fetch(e,{method:n,headers:o}).then(async a=>{if(!a.ok){let c={};a.headers.forEach((l,f)=>{c[f]=l}),r.reject(new Zm(a.status,a,c));return}switch(t){case"text":r.resolve(a.text());break;case"json":r.resolve(a.json());break;default:r.resolve(new Uint8Array(await a.arrayBuffer()).buffer);break}}).catch(()=>{r.reject(new Zm)})}var _we=typeof XMLHttpRequest>"u";It._Implementations.loadWithXhr=function(e,t,n,i,o,r,s){let a=hwe.exec(e);if(a!==null){r.resolve(mwe(a,t));return}if(_we){pwe(e,t,n,i,o,r,s);return}let c=new XMLHttpRequest;if(FS.contains(e)&&(c.withCredentials=!0),c.open(n,e,!0),u(s)&&u(c.overrideMimeType)&&c.overrideMimeType(s),u(o))for(let f in o)o.hasOwnProperty(f)&&c.setRequestHeader(f,o[f]);u(t)&&(c.responseType=t);let l=!1;return typeof e=="string"&&(l=e.indexOf("file://")===0||typeof window<"u"&&window.location.origin==="file://"),c.onload=function(){if((c.status<200||c.status>=300)&&!(l&&c.status===0)){r.reject(new Zm(c.status,c.response,c.getAllResponseHeaders()));return}let f=c.response,d=c.responseType;if(n==="HEAD"||n==="OPTIONS"){let g=c.getAllResponseHeaders().trim().split(/[\r\n]+/),m={};g.forEach(function(y){let b=y.split(": "),C=b.shift();m[C]=b.join(": ")}),r.resolve(m);return}if(c.status===204)r.resolve(void 0);else if(u(f)&&(!u(t)||d===t))r.resolve(f);else if(t==="json"&&typeof f=="string")try{r.resolve(JSON.parse(f))}catch(p){r.reject(p)}else(d===""||d==="document")&&u(c.responseXML)&&c.responseXML.hasChildNodes()?r.resolve(c.responseXML):(d===""||d==="text")&&u(c.responseText)?r.resolve(c.responseText):r.reject(new ce("Invalid XMLHttpRequest response type."))},c.onerror=function(f){r.reject(new Zm)},c.send(i),c};It._Implementations.loadAndExecuteScript=function(e,t,n){return aC(e,t).catch(function(i){n.reject(i)})};It._DefaultImplementations={};It._DefaultImplementations.createImage=It._Implementations.createImage;It._DefaultImplementations.loadWithXhr=It._Implementations.loadWithXhr;It._DefaultImplementations.loadAndExecuteScript=It._Implementations.loadAndExecuteScript;It.DEFAULT=Object.freeze(new It({url:typeof document>"u"?"":document.location.href.split("?")[0]}));var De=It;function kS(e){e=x(e,x.EMPTY_OBJECT),this._dates=void 0,this._samples=void 0,this._dateColumn=-1,this._xPoleWanderRadiansColumn=-1,this._yPoleWanderRadiansColumn=-1,this._ut1MinusUtcSecondsColumn=-1,this._xCelestialPoleOffsetRadiansColumn=-1,this._yCelestialPoleOffsetRadiansColumn=-1,this._taiMinusUtcSecondsColumn=-1,this._columnCount=0,this._lastIndex=-1,this._addNewLeapSeconds=x(e.addNewLeapSeconds,!0),u(e.data)?_Q(this,e.data):_Q(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}kS.fromUrl=async function(e,t){t=x(t,x.EMPTY_OBJECT);let n=De.createIfNeeded(e),i;try{i=await n.fetchJson()}catch{throw new ce(`An error occurred while retrieving the EOP data from the URL ${n.url}.`)}return new kS({addNewLeapSeconds:t.addNewLeapSeconds,data:i})};kS.NONE=Object.freeze({compute:function(e,t){return u(t)?(t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0):t=new Cy(0,0,0,0,0),t}});kS.prototype.compute=function(e,t){if(!u(this._samples))return;if(u(t)||(t=new Cy(0,0,0,0,0)),this._samples.length===0)return t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0,t;let n=this._dates,i=this._lastIndex,o=0,r=0;if(u(i)){let a=n[i],c=n[i+1],l=$.lessThanOrEquals(a,e),f=!u(c),d=f||$.greaterThanOrEquals(c,e);if(l&&d)return o=i,!f&&c.equals(e)&&++o,r=o+1,yQ(this,n,this._samples,e,o,r,t),t}let s=No(n,e,$.compare,this._dateColumn);return s>=0?(s<n.length-1&&n[s+1].equals(e)&&++s,o=s,r=s):(r=~s,o=r-1,o<0&&(o=0)),this._lastIndex=o,yQ(this,n,this._samples,e,o,r,t),t};function gwe(e,t){return $.compare(e.julianDate,t)}function _Q(e,t){if(!u(t.columnNames))throw new ce("Error in loaded EOP data: The columnNames property is required.");if(!u(t.samples))throw new ce("Error in loaded EOP data: The samples property is required.");let n=t.columnNames.indexOf("modifiedJulianDateUtc"),i=t.columnNames.indexOf("xPoleWanderRadians"),o=t.columnNames.indexOf("yPoleWanderRadians"),r=t.columnNames.indexOf("ut1MinusUtcSeconds"),s=t.columnNames.indexOf("xCelestialPoleOffsetRadians"),a=t.columnNames.indexOf("yCelestialPoleOffsetRadians"),c=t.columnNames.indexOf("taiMinusUtcSeconds");if(n<0||i<0||o<0||r<0||s<0||a<0||c<0)throw new ce("Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns");let l=e._samples=t.samples,f=e._dates=[];e._dateColumn=n,e._xPoleWanderRadiansColumn=i,e._yPoleWanderRadiansColumn=o,e._ut1MinusUtcSecondsColumn=r,e._xCelestialPoleOffsetRadiansColumn=s,e._yCelestialPoleOffsetRadiansColumn=a,e._taiMinusUtcSecondsColumn=c,e._columnCount=t.columnNames.length,e._lastIndex=void 0;let d,p=e._addNewLeapSeconds;for(let g=0,m=l.length;g<m;g+=e._columnCount){let y=l[g+n],b=l[g+c],C=y+Yn.MODIFIED_JULIAN_DATE_DIFFERENCE,A=new $(C,b,jn.TAI);if(f.push(A),p){if(b!==d&&u(d)){let T=$.leapSeconds,E=No(T,A,gwe);if(E<0){let v=new Ki(A,b);T.splice(~E,0,v)}}d=b}}}function gQ(e,t,n,i,o){let r=n*i;o.xPoleWander=t[r+e._xPoleWanderRadiansColumn],o.yPoleWander=t[r+e._yPoleWanderRadiansColumn],o.xPoleOffset=t[r+e._xCelestialPoleOffsetRadiansColumn],o.yPoleOffset=t[r+e._yCelestialPoleOffsetRadiansColumn],o.ut1MinusUtc=t[r+e._ut1MinusUtcSecondsColumn]}function BS(e,t,n){return t+e*(n-t)}function yQ(e,t,n,i,o,r,s){let a=e._columnCount;if(r>t.length-1)return s.xPoleWander=0,s.yPoleWander=0,s.xPoleOffset=0,s.yPoleOffset=0,s.ut1MinusUtc=0,s;let c=t[o],l=t[r];if(c.equals(l)||i.equals(c))return gQ(e,n,o,a,s),s;if(i.equals(l))return gQ(e,n,r,a,s),s;let f=$.secondsDifference(i,c)/$.secondsDifference(l,c),d=o*a,p=r*a,g=n[d+e._ut1MinusUtcSecondsColumn],m=n[p+e._ut1MinusUtcSecondsColumn],y=m-g;if(y>.5||y<-.5){let b=n[d+e._taiMinusUtcSecondsColumn],C=n[p+e._taiMinusUtcSecondsColumn];b!==C&&(l.equals(i)?g=m:m-=C-b)}return s.xPoleWander=BS(f,n[d+e._xPoleWanderRadiansColumn],n[p+e._xPoleWanderRadiansColumn]),s.yPoleWander=BS(f,n[d+e._yPoleWanderRadiansColumn],n[p+e._yPoleWanderRadiansColumn]),s.xPoleOffset=BS(f,n[d+e._xCelestialPoleOffsetRadiansColumn],n[p+e._xCelestialPoleOffsetRadiansColumn]),s.yPoleOffset=BS(f,n[d+e._yCelestialPoleOffsetRadiansColumn],n[p+e._yCelestialPoleOffsetRadiansColumn]),s.ut1MinusUtc=BS(f,g,m),s}var EP=kS;function Ga(e,t,n){this.heading=x(e,0),this.pitch=x(t,0),this.roll=x(n,0)}Ga.fromQuaternion=function(e,t){u(t)||(t=new Ga);let n=2*(e.w*e.y-e.z*e.x),i=1-2*(e.x*e.x+e.y*e.y),o=2*(e.w*e.x+e.y*e.z),r=1-2*(e.y*e.y+e.z*e.z),s=2*(e.w*e.z+e.x*e.y);return t.heading=-Math.atan2(s,r),t.roll=Math.atan2(o,i),t.pitch=-R.asinClamped(n),t};Ga.fromDegrees=function(e,t,n,i){return u(i)||(i=new Ga),i.heading=e*R.RADIANS_PER_DEGREE,i.pitch=t*R.RADIANS_PER_DEGREE,i.roll=n*R.RADIANS_PER_DEGREE,i};Ga.clone=function(e,t){if(u(e))return u(t)?(t.heading=e.heading,t.pitch=e.pitch,t.roll=e.roll,t):new Ga(e.heading,e.pitch,e.roll)};Ga.equals=function(e,t){return e===t||u(e)&&u(t)&&e.heading===t.heading&&e.pitch===t.pitch&&e.roll===t.roll};Ga.equalsEpsilon=function(e,t,n,i){return e===t||u(e)&&u(t)&&R.equalsEpsilon(e.heading,t.heading,n,i)&&R.equalsEpsilon(e.pitch,t.pitch,n,i)&&R.equalsEpsilon(e.roll,t.roll,n,i)};Ga.prototype.clone=function(e){return Ga.clone(this,e)};Ga.prototype.equals=function(e){return Ga.equals(this,e)};Ga.prototype.equalsEpsilon=function(e,t,n){return Ga.equalsEpsilon(this,e,t,n)};Ga.prototype.toString=function(){return`(${this.heading}, ${this.pitch}, ${this.roll})`};var Wa=Ga;var xQ=/((?:.*\/)|^)Cesium\.js(?:\?|\#|$)/;function ywe(){let e=document.getElementsByTagName("script");for(let t=0,n=e.length;t<n;++t){let i=e[t].getAttribute("src"),o=xQ.exec(i);if(o!==null)return o[1]}}var SP;function bQ(e){return typeof document>"u"?e:(u(SP)||(SP=document.createElement("a")),SP.href=e,SP.href)}var Sy;function CQ(){if(u(Sy))return Sy;let e;return typeof CESIUM_BASE_URL<"u"?e=CESIUM_BASE_URL:u(import.meta?.url)?e=Km(".",import.meta.url):typeof define=="object"&&u(define.amd)&&!define.amd.toUrlUndefined&&u(Kb.toUrl)?e=Km("..",vy("Core/buildModuleUrl.js")):e=ywe(),Sy=new De({url:bQ(e)}),Sy.appendForwardSlash(),Sy}function xwe(e){return bQ(Kb.toUrl(`../${e}`))}function AQ(e){return CQ().getDerivedResource({url:e}).url}var vP;function vy(e){return u(vP)||(typeof define=="object"&&u(define.amd)&&!define.amd.toUrlUndefined&&u(Kb.toUrl)?vP=xwe:vP=AQ),vP(e)}vy._cesiumScriptRegex=xQ;vy._buildModuleUrlFromBaseUrl=AQ;vy._clearBaseResource=function(){Sy=void 0};vy.setBaseUrl=function(e){Sy=De.DEFAULT.getDerivedResource({url:e})};vy.getCesiumBaseUrl=CQ;var on=vy;function bwe(e,t,n){this.x=e,this.y=t,this.s=n}var dC=bwe;function X6(e){e=x(e,x.EMPTY_OBJECT),this._xysFileUrlTemplate=De.createIfNeeded(e.xysFileUrlTemplate),this._interpolationOrder=x(e.interpolationOrder,9),this._sampleZeroJulianEphemerisDate=x(e.sampleZeroJulianEphemerisDate,24423965e-1),this._sampleZeroDateTT=new $(this._sampleZeroJulianEphemerisDate,0,jn.TAI),this._stepSizeDays=x(e.stepSizeDays,1),this._samplesPerXysFile=x(e.samplesPerXysFile,1e3),this._totalSamples=x(e.totalSamples,27426),this._samples=new Array(this._totalSamples*3),this._chunkDownloadsInProgress=[];let t=this._interpolationOrder,n=this._denominators=new Array(t+1),i=this._xTable=new Array(t+1),o=Math.pow(this._stepSizeDays,t);for(let r=0;r<=t;++r){n[r]=o,i[r]=r*this._stepSizeDays;for(let s=0;s<=t;++s)s!==r&&(n[r]*=r-s);n[r]=1/n[r]}this._work=new Array(t+1),this._coef=new Array(t+1)}var Cwe=new $(0,0,jn.TAI);function q6(e,t,n){let i=Cwe;return i.dayNumber=t,i.secondsOfDay=n,$.daysDifference(i,e._sampleZeroDateTT)}X6.prototype.preload=function(e,t,n,i){let o=q6(this,e,t),r=q6(this,n,i),s=o/this._stepSizeDays-this._interpolationOrder/2|0;s<0&&(s=0);let a=r/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;a>=this._totalSamples&&(a=this._totalSamples-1);let c=s/this._samplesPerXysFile|0,l=a/this._samplesPerXysFile|0,f=[];for(let d=c;d<=l;++d)f.push(Y6(this,d));return Promise.all(f)};X6.prototype.computeXysRadians=function(e,t,n){let i=q6(this,e,t);if(i<0)return;let o=i/this._stepSizeDays|0;if(o>=this._totalSamples)return;let r=this._interpolationOrder,s=o-(r/2|0);s<0&&(s=0);let a=s+r;a>=this._totalSamples&&(a=this._totalSamples-1,s=a-r,s<0&&(s=0));let c=!1,l=this._samples;if(u(l[s*3])||(Y6(this,s/this._samplesPerXysFile|0),c=!0),u(l[a*3])||(Y6(this,a/this._samplesPerXysFile|0),c=!0),c)return;u(n)?(n.x=0,n.y=0,n.s=0):n=new dC(0,0,0);let f=i-s*this._stepSizeDays,d=this._work,p=this._denominators,g=this._coef,m=this._xTable,y,b;for(y=0;y<=r;++y)d[y]=f-m[y];for(y=0;y<=r;++y){for(g[y]=1,b=0;b<=r;++b)b!==y&&(g[y]*=d[b]);g[y]*=p[y];let C=(s+y)*3;n.x+=g[y]*l[C++],n.y+=g[y]*l[C++],n.s+=g[y]*l[C]}return n};function Y6(e,t){if(e._chunkDownloadsInProgress[t])return e._chunkDownloadsInProgress[t];let n,i=e._xysFileUrlTemplate;u(i)?n=i.getDerivedResource({templateValues:{0:t}}):n=new De({url:on(`Assets/IAU2006_XYS/IAU2006_XYS_${t}.json`)});let o=n.fetchJson().then(function(r){e._chunkDownloadsInProgress[t]=!1;let s=e._samples,a=r.samples,c=t*e._samplesPerXysFile*3;for(let l=0,f=a.length;l<f;++l)s[c+l]=a[l]});return e._chunkDownloadsInProgress[t]=o,o}var wP=X6;function it(e,t,n,i){this.x=x(e,0),this.y=x(t,0),this.z=x(n,0),this.w=x(i,0)}var VS=new h;it.fromAxisAngle=function(e,t,n){let i=t/2,o=Math.sin(i);VS=h.normalize(e,VS);let r=VS.x*o,s=VS.y*o,a=VS.z*o,c=Math.cos(i);return u(n)?(n.x=r,n.y=s,n.z=a,n.w=c,n):new it(r,s,a,c)};var Awe=[1,2,0],Twe=new Array(3);it.fromRotationMatrix=function(e,t){let n,i,o,r,s,a=e[J.COLUMN0ROW0],c=e[J.COLUMN1ROW1],l=e[J.COLUMN2ROW2],f=a+c+l;if(f>0)n=Math.sqrt(f+1),s=.5*n,n=.5/n,i=(e[J.COLUMN1ROW2]-e[J.COLUMN2ROW1])*n,o=(e[J.COLUMN2ROW0]-e[J.COLUMN0ROW2])*n,r=(e[J.COLUMN0ROW1]-e[J.COLUMN1ROW0])*n;else{let d=Awe,p=0;c>a&&(p=1),l>a&&l>c&&(p=2);let g=d[p],m=d[g];n=Math.sqrt(e[J.getElementIndex(p,p)]-e[J.getElementIndex(g,g)]-e[J.getElementIndex(m,m)]+1);let y=Twe;y[p]=.5*n,n=.5/n,s=(e[J.getElementIndex(m,g)]-e[J.getElementIndex(g,m)])*n,y[g]=(e[J.getElementIndex(g,p)]+e[J.getElementIndex(p,g)])*n,y[m]=(e[J.getElementIndex(m,p)]+e[J.getElementIndex(p,m)])*n,i=-y[0],o=-y[1],r=-y[2]}return u(t)?(t.x=i,t.y=o,t.z=r,t.w=s,t):new it(i,o,r,s)};var TQ=new it,EQ=new it,K6=new it,SQ=new it;it.fromHeadingPitchRoll=function(e,t){return SQ=it.fromAxisAngle(h.UNIT_X,e.roll,TQ),K6=it.fromAxisAngle(h.UNIT_Y,-e.pitch,t),t=it.multiply(K6,SQ,K6),EQ=it.fromAxisAngle(h.UNIT_Z,-e.heading,TQ),it.multiply(EQ,t,t)};var DP=new h,Z6=new h,rd=new it,vQ=new it,IP=new it;it.packedLength=4;it.pack=function(e,t,n){return n=x(n,0),t[n++]=e.x,t[n++]=e.y,t[n++]=e.z,t[n]=e.w,t};it.unpack=function(e,t,n){return t=x(t,0),u(n)||(n=new it),n.x=e[t],n.y=e[t+1],n.z=e[t+2],n.w=e[t+3],n};it.packedInterpolationLength=3;it.convertPackedArrayForInterpolation=function(e,t,n,i){it.unpack(e,n*4,IP),it.conjugate(IP,IP);for(let o=0,r=n-t+1;o<r;o++){let s=o*3;it.unpack(e,(t+o)*4,rd),it.multiply(rd,IP,rd),rd.w<0&&it.negate(rd,rd),it.computeAxis(rd,DP);let a=it.computeAngle(rd);u(i)||(i=[]),i[s]=DP.x*a,i[s+1]=DP.y*a,i[s+2]=DP.z*a}};it.unpackInterpolationResult=function(e,t,n,i,o){u(o)||(o=new it),h.fromArray(e,0,Z6);let r=h.magnitude(Z6);return it.unpack(t,i*4,vQ),r===0?it.clone(it.IDENTITY,rd):it.fromAxisAngle(Z6,r,rd),it.multiply(rd,vQ,o)};it.clone=function(e,t){if(u(e))return u(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new it(e.x,e.y,e.z,e.w)};it.conjugate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w,t};it.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w};it.magnitude=function(e){return Math.sqrt(it.magnitudeSquared(e))};it.normalize=function(e,t){let n=1/it.magnitude(e),i=e.x*n,o=e.y*n,r=e.z*n,s=e.w*n;return t.x=i,t.y=o,t.z=r,t.w=s,t};it.inverse=function(e,t){let n=it.magnitudeSquared(e);return t=it.conjugate(e,t),it.multiplyByScalar(t,1/n,t)};it.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n};it.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n};it.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t};it.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w};it.multiply=function(e,t,n){let i=e.x,o=e.y,r=e.z,s=e.w,a=t.x,c=t.y,l=t.z,f=t.w,d=s*a+i*f+o*l-r*c,p=s*c-i*l+o*f+r*a,g=s*l+i*c-o*a+r*f,m=s*f-i*a-o*c-r*l;return n.x=d,n.y=p,n.z=g,n.w=m,n};it.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n};it.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n};it.computeAxis=function(e,t){let n=e.w;if(Math.abs(n-1)<R.EPSILON6||Math.abs(n+1)<R.EPSILON6)return t.x=1,t.y=t.z=0,t;let i=1/Math.sqrt(1-n*n);return t.x=e.x*i,t.y=e.y*i,t.z=e.z*i,t};it.computeAngle=function(e){return Math.abs(e.w-1)<R.EPSILON6?0:2*Math.acos(e.w)};var $6=new it;it.lerp=function(e,t,n,i){return $6=it.multiplyByScalar(t,n,$6),i=it.multiplyByScalar(e,1-n,i),it.add($6,i,i)};var wQ=new it,Q6=new it,J6=new it;it.slerp=function(e,t,n,i){let o=it.dot(e,t),r=t;if(o<0&&(o=-o,r=wQ=it.negate(t,wQ)),1-o<R.EPSILON6)return it.lerp(e,r,n,i);let s=Math.acos(o);return Q6=it.multiplyByScalar(e,Math.sin((1-n)*s),Q6),J6=it.multiplyByScalar(r,Math.sin(n*s),J6),i=it.add(Q6,J6,i),it.multiplyByScalar(i,1/Math.sin(s),i)};it.log=function(e,t){let n=R.acosClamped(e.w),i=0;return n!==0&&(i=n/Math.sin(n)),h.multiplyByScalar(e,i,t)};it.exp=function(e,t){let n=h.magnitude(e),i=0;return n!==0&&(i=Math.sin(n)/n),t.x=e.x*i,t.y=e.y*i,t.z=e.z*i,t.w=Math.cos(n),t};var Ewe=new h,Swe=new h,US=new it,hC=new it;it.computeInnerQuadrangle=function(e,t,n,i){let o=it.conjugate(t,US);it.multiply(o,n,hC);let r=it.log(hC,Ewe);it.multiply(o,e,hC);let s=it.log(hC,Swe);return h.add(r,s,r),h.multiplyByScalar(r,.25,r),h.negate(r,r),it.exp(r,US),it.multiply(t,US,i)};it.squad=function(e,t,n,i,o,r){let s=it.slerp(e,t,o,US),a=it.slerp(n,i,o,hC);return it.slerp(s,a,2*o*(1-o),r)};var vwe=new it,DQ=1.9011074535173003,PP=Wt.supportsTypedArrays()?new Float32Array(8):[],RP=Wt.supportsTypedArrays()?new Float32Array(8):[],Qm=Wt.supportsTypedArrays()?new Float32Array(8):[],Jm=Wt.supportsTypedArrays()?new Float32Array(8):[];for(let e=0;e<7;++e){let t=e+1,n=2*t+1;PP[e]=1/(t*n),RP[e]=t/n}PP[7]=DQ/(8*17);RP[7]=DQ*8/17;it.fastSlerp=function(e,t,n,i){let o=it.dot(e,t),r;o>=0?r=1:(r=-1,o=-o);let s=o-1,a=1-n,c=n*n,l=a*a;for(let g=7;g>=0;--g)Qm[g]=(PP[g]*c-RP[g])*s,Jm[g]=(PP[g]*l-RP[g])*s;let f=r*n*(1+Qm[0]*(1+Qm[1]*(1+Qm[2]*(1+Qm[3]*(1+Qm[4]*(1+Qm[5]*(1+Qm[6]*(1+Qm[7])))))))),d=a*(1+Jm[0]*(1+Jm[1]*(1+Jm[2]*(1+Jm[3]*(1+Jm[4]*(1+Jm[5]*(1+Jm[6]*(1+Jm[7])))))))),p=it.multiplyByScalar(e,d,vwe);return it.multiplyByScalar(t,f,i),it.add(p,i,i)};it.fastSquad=function(e,t,n,i,o,r){let s=it.fastSlerp(e,t,o,US),a=it.fastSlerp(n,i,o,hC);return it.fastSlerp(s,a,2*o*(1-o),r)};it.equals=function(e,t){return e===t||u(e)&&u(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w};it.equalsEpsilon=function(e,t,n){return n=x(n,0),e===t||u(e)&&u(t)&&Math.abs(e.x-t.x)<=n&&Math.abs(e.y-t.y)<=n&&Math.abs(e.z-t.z)<=n&&Math.abs(e.w-t.w)<=n};it.ZERO=Object.freeze(new it(0,0,0,0));it.IDENTITY=Object.freeze(new it(0,0,0,1));it.prototype.clone=function(e){return it.clone(this,e)};it.prototype.equals=function(e){return it.equals(this,e)};it.prototype.equalsEpsilon=function(e,t){return it.equalsEpsilon(this,e,t)};it.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};var Le=it;var ui={},eG={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},mC={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},tG={},ll={east:new h,north:new h,up:new h,west:new h,south:new h,down:new h},L_=new h,N_=new h,F_=new h;ui.localFrameToFixedFrameGenerator=function(e,t){if(!eG.hasOwnProperty(e)||!eG[e].hasOwnProperty(t))throw new he("firstAxis and secondAxis must be east, north, up, west, south or down.");let n=eG[e][t],i,o=e+t;return u(tG[o])?i=tG[o]:(i=function(r,s,a){if(u(a)||(a=new F),h.equalsEpsilon(r,h.ZERO,R.EPSILON14))h.unpack(mC[e],0,L_),h.unpack(mC[t],0,N_),h.unpack(mC[n],0,F_);else if(R.equalsEpsilon(r.x,0,R.EPSILON14)&&R.equalsEpsilon(r.y,0,R.EPSILON14)){let c=R.sign(r.z);h.unpack(mC[e],0,L_),e!=="east"&&e!=="west"&&h.multiplyByScalar(L_,c,L_),h.unpack(mC[t],0,N_),t!=="east"&&t!=="west"&&h.multiplyByScalar(N_,c,N_),h.unpack(mC[n],0,F_),n!=="east"&&n!=="west"&&h.multiplyByScalar(F_,c,F_)}else{s=x(s,ee.default),s.geodeticSurfaceNormal(r,ll.up);let c=ll.up,l=ll.east;l.x=-r.y,l.y=r.x,l.z=0,h.normalize(l,ll.east),h.cross(c,l,ll.north),h.multiplyByScalar(ll.up,-1,ll.down),h.multiplyByScalar(ll.east,-1,ll.west),h.multiplyByScalar(ll.north,-1,ll.south),L_=ll[e],N_=ll[t],F_=ll[n]}return a[0]=L_.x,a[1]=L_.y,a[2]=L_.z,a[3]=0,a[4]=N_.x,a[5]=N_.y,a[6]=N_.z,a[7]=0,a[8]=F_.x,a[9]=F_.y,a[10]=F_.z,a[11]=0,a[12]=r.x,a[13]=r.y,a[14]=r.z,a[15]=1,a},tG[o]=i),i};ui.eastNorthUpToFixedFrame=ui.localFrameToFixedFrameGenerator("east","north");ui.northEastDownToFixedFrame=ui.localFrameToFixedFrameGenerator("north","east");ui.northUpEastToFixedFrame=ui.localFrameToFixedFrameGenerator("north","up");ui.northWestUpToFixedFrame=ui.localFrameToFixedFrameGenerator("north","west");var wwe=new Le,Dwe=new h(1,1,1),Iwe=new F;ui.headingPitchRollToFixedFrame=function(e,t,n,i,o){i=x(i,ui.eastNorthUpToFixedFrame);let r=Le.fromHeadingPitchRoll(t,wwe),s=F.fromTranslationQuaternionRotationScale(h.ZERO,r,Dwe,Iwe);return o=i(e,n,o),F.multiply(o,s,o)};var Pwe=new F,Rwe=new J;ui.headingPitchRollQuaternion=function(e,t,n,i,o){let r=ui.headingPitchRollToFixedFrame(e,t,n,i,Pwe),s=F.getMatrix3(r,Rwe);return Le.fromRotationMatrix(s,o)};var Owe=new h(1,1,1),Mwe=new h,IQ=new F,Lwe=new F,Nwe=new J,Fwe=new Le;ui.fixedFrameToHeadingPitchRoll=function(e,t,n,i){t=x(t,ee.default),n=x(n,ui.eastNorthUpToFixedFrame),u(i)||(i=new Wa);let o=F.getTranslation(e,Mwe);if(h.equals(o,h.ZERO))return i.heading=0,i.pitch=0,i.roll=0,i;let r=F.inverseTransformation(n(o,t,IQ),IQ),s=F.setScale(e,Owe,Lwe);s=F.setTranslation(s,h.ZERO,s),r=F.multiply(r,s,r);let a=Le.fromRotationMatrix(F.getMatrix3(r,Nwe),Fwe);return a=Le.normalize(a,a),Wa.fromQuaternion(a,i)};var Bwe=6*3600+41*60+50.54841,kwe=8640184812866e-6,Vwe=.093104,Uwe=-62e-7,zwe=11772758384668e-32,Hwe=72921158553e-15,Gwe=R.TWO_PI/86400,OP=new $;ui.computeIcrfToCentralBodyFixedMatrix=function(e,t){let n=ui.computeIcrfToFixedMatrix(e,t);return u(n)||(n=ui.computeTemeToPseudoFixedMatrix(e,t)),n};ui.computeTemeToPseudoFixedMatrix=function(e,t){OP=$.addSeconds(e,-$.computeTaiMinusUtc(e),OP);let n=OP.dayNumber,i=OP.secondsOfDay,o,r=n-2451545;i>=43200?o=(r+.5)/Yn.DAYS_PER_JULIAN_CENTURY:o=(r-.5)/Yn.DAYS_PER_JULIAN_CENTURY;let a=(Bwe+o*(kwe+o*(Vwe+o*Uwe)))*Gwe%R.TWO_PI,c=Hwe+zwe*(n-24515455e-1),l=(i+Yn.SECONDS_PER_DAY*.5)%Yn.SECONDS_PER_DAY,f=a+c*l,d=Math.cos(f),p=Math.sin(f);return u(t)?(t[0]=d,t[1]=-p,t[2]=0,t[3]=p,t[4]=d,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new J(d,p,0,-p,d,0,0,0,1)};ui.iau2006XysData=new wP;ui.earthOrientationParameters=EP.NONE;var oG=32.184,Wwe=2451545;ui.preloadIcrfFixed=function(e){let t=e.start.dayNumber,n=e.start.secondsOfDay+oG,i=e.stop.dayNumber,o=e.stop.secondsOfDay+oG;return ui.iau2006XysData.preload(t,n,i,o)};ui.computeIcrfToFixedMatrix=function(e,t){u(t)||(t=new J);let n=ui.computeFixedToIcrfMatrix(e,t);if(u(n))return J.transpose(n,t)};var jwe=32.184,qwe=2451545,MP=new Wa,Ywe=new J,Xwe=new $;ui.computeMoonFixedToIcrfMatrix=function(e,t){u(t)||(t=new J);let n=$.addSeconds(e,jwe,Xwe),i=$.totalDays(n)-qwe,o=R.toRadians(12.112)-R.toRadians(.052992)*i,r=R.toRadians(24.224)-R.toRadians(.105984)*i,s=R.toRadians(227.645)+R.toRadians(13.012)*i,a=R.toRadians(261.105)+R.toRadians(13.340716)*i,c=R.toRadians(358)+R.toRadians(.9856)*i;return MP.pitch=R.toRadians(180)-R.toRadians(3.878)*Math.sin(o)-R.toRadians(.12)*Math.sin(r)+R.toRadians(.07)*Math.sin(s)-R.toRadians(.017)*Math.sin(a),MP.roll=R.toRadians(66.53-90)+R.toRadians(1.543)*Math.cos(o)+R.toRadians(.24)*Math.cos(r)-R.toRadians(.028)*Math.cos(s)+R.toRadians(.007)*Math.cos(a),MP.heading=R.toRadians(244.375-90)+R.toRadians(13.17635831)*i+R.toRadians(3.558)*Math.sin(o)+R.toRadians(.121)*Math.sin(r)-R.toRadians(.064)*Math.sin(s)+R.toRadians(.016)*Math.sin(a)+R.toRadians(.025)*Math.sin(c),J.fromHeadingPitchRoll(MP,Ywe)};ui.computeIcrfToMoonFixedMatrix=function(e,t){u(t)||(t=new J);let n=ui.computeMoonFixedToIcrfMatrix(e,t);if(u(n))return J.transpose(n,t)};var Kwe=new dC(0,0,0),Zwe=new Cy(0,0,0,0,0,0),nG=new J,iG=new J;ui.computeFixedToIcrfMatrix=function(e,t){u(t)||(t=new J);let n=ui.earthOrientationParameters.compute(e,Zwe);if(!u(n))return;let i=e.dayNumber,o=e.secondsOfDay+oG,r=ui.iau2006XysData.computeXysRadians(i,o,Kwe);if(!u(r))return;let s=r.x+n.xPoleOffset,a=r.y+n.yPoleOffset,c=1/(1+Math.sqrt(1-s*s-a*a)),l=nG;l[0]=1-c*s*s,l[3]=-c*s*a,l[6]=s,l[1]=-c*s*a,l[4]=1-c*a*a,l[7]=a,l[2]=-s,l[5]=-a,l[8]=1-c*(s*s+a*a);let f=J.fromRotationZ(-r.s,iG),d=J.multiply(l,f,nG),p=e.dayNumber,g=e.secondsOfDay-$.computeTaiMinusUtc(e)+n.ut1MinusUtc,m=p-2451545,y=g/Yn.SECONDS_PER_DAY,b=.779057273264+y+.00273781191135448*(m+y);b=b%1*R.TWO_PI;let C=J.fromRotationZ(b,iG),A=J.multiply(d,C,nG),T=Math.cos(n.xPoleWander),E=Math.cos(n.yPoleWander),v=Math.sin(n.xPoleWander),D=Math.sin(n.yPoleWander),O=i-Wwe+o/Yn.SECONDS_PER_DAY;O/=36525;let P=-47e-6*O*R.RADIANS_PER_DEGREE/3600,M=Math.cos(P),L=Math.sin(P),_=iG;return _[0]=T*M,_[1]=T*L,_[2]=v,_[3]=-E*L+D*v*M,_[4]=E*M+D*v*L,_[5]=-D*T,_[6]=-D*L-E*v*M,_[7]=D*M-E*v*L,_[8]=E*T,J.multiply(A,_,t)};var $we=new oe;ui.pointToWindowCoordinates=function(e,t,n,i){return i=ui.pointToGLWindowCoordinates(e,t,n,i),i.y=2*t[5]-i.y,i};ui.pointToGLWindowCoordinates=function(e,t,n,i){u(i)||(i=new H);let o=$we;return F.multiplyByVector(e,oe.fromElements(n.x,n.y,n.z,1,o),o),oe.multiplyByScalar(o,1/o.w,o),F.multiplyByVector(t,o,o),H.fromCartesian4(o,i)};var Qwe=new h,Jwe=new h,e1e=new h;ui.rotationMatrixFromPositionVelocity=function(e,t,n,i){let o=x(n,ee.default).geodeticSurfaceNormal(e,Qwe),r=h.cross(t,o,Jwe);h.equalsEpsilon(r,h.ZERO,R.EPSILON6)&&(r=h.clone(h.UNIT_X,r));let s=h.cross(r,t,e1e);return h.normalize(s,s),h.cross(t,s,r),h.negate(r,r),h.normalize(r,r),u(i)||(i=new J),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=r.x,i[4]=r.y,i[5]=r.z,i[6]=s.x,i[7]=s.y,i[8]=s.z,i};var PQ=new F(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),RQ=new de,rG=new h,t1e=new h,n1e=new J,sG=new F,OQ=new F;ui.basisTo2D=function(e,t,n){let i=F.getTranslation(t,t1e),o=e.ellipsoid,r;if(h.equals(i,h.ZERO))r=h.clone(h.ZERO,rG);else{let f=o.cartesianToCartographic(i,RQ);r=e.project(f,rG),h.fromElements(r.z,r.x,r.y,r)}let s=ui.eastNorthUpToFixedFrame(i,o,sG),a=F.inverseTransformation(s,OQ),c=F.getMatrix3(t,n1e),l=F.multiplyByMatrix3(a,c,n);return F.multiply(PQ,l,n),F.setTranslation(n,r,n),n};ui.ellipsoidTo2DModelMatrix=function(e,t,n){let i=e.ellipsoid,o=ui.eastNorthUpToFixedFrame(t,i,sG),r=F.inverseTransformation(o,OQ),s=i.cartesianToCartographic(t,RQ),a=e.project(s,rG);h.fromElements(a.z,a.x,a.y,a);let c=F.fromTranslation(a,sG);return F.multiply(PQ,r,n),F.multiply(c,n,n),n};var Lt=ui;var MQ={};function zS(e,t){u(MQ[e])||(MQ[e]=!0,console.warn(x(t,e)))}zS.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.";zS.geometryZIndex="Entity geometry with zIndex are unsupported when height or extrudedHeight are defined.  zIndex will be ignored";zS.geometryHeightReference="Entity corridor, ellipse, polygon or rectangle with heightReference must also have a defined height.  heightReference will be ignored";zS.geometryExtrudedHeightReference="Entity corridor, ellipse, polygon or rectangle with extrudedHeightReference must also have a defined extrudedHeight.  extrudedHeightReference will be ignored";var At=zS;function i1e(e,t){At(e,t)}var ys=i1e;function An(e,t,n,i){this.west=x(e,0),this.south=x(t,0),this.east=x(n,0),this.north=x(i,0)}Object.defineProperties(An.prototype,{width:{get:function(){return An.computeWidth(this)}},height:{get:function(){return An.computeHeight(this)}}});An.packedLength=4;An.pack=function(e,t,n){return n=x(n,0),t[n++]=e.west,t[n++]=e.south,t[n++]=e.east,t[n]=e.north,t};An.unpack=function(e,t,n){return t=x(t,0),u(n)||(n=new An),n.west=e[t++],n.south=e[t++],n.east=e[t++],n.north=e[t],n};An.computeWidth=function(e){let t=e.east,n=e.west;return t<n&&(t+=R.TWO_PI),t-n};An.computeHeight=function(e){return e.north-e.south};An.fromDegrees=function(e,t,n,i,o){return e=R.toRadians(x(e,0)),t=R.toRadians(x(t,0)),n=R.toRadians(x(n,0)),i=R.toRadians(x(i,0)),u(o)?(o.west=e,o.south=t,o.east=n,o.north=i,o):new An(e,t,n,i)};An.fromRadians=function(e,t,n,i,o){return u(o)?(o.west=x(e,0),o.south=x(t,0),o.east=x(n,0),o.north=x(i,0),o):new An(e,t,n,i)};An.fromCartographicArray=function(e,t){let n=Number.MAX_VALUE,i=-Number.MAX_VALUE,o=Number.MAX_VALUE,r=-Number.MAX_VALUE,s=Number.MAX_VALUE,a=-Number.MAX_VALUE;for(let c=0,l=e.length;c<l;c++){let f=e[c];n=Math.min(n,f.longitude),i=Math.max(i,f.longitude),s=Math.min(s,f.latitude),a=Math.max(a,f.latitude);let d=f.longitude>=0?f.longitude:f.longitude+R.TWO_PI;o=Math.min(o,d),r=Math.max(r,d)}return i-n>r-o&&(n=o,i=r,i>R.PI&&(i=i-R.TWO_PI),n>R.PI&&(n=n-R.TWO_PI)),u(t)?(t.west=n,t.south=s,t.east=i,t.north=a,t):new An(n,s,i,a)};An.fromCartesianArray=function(e,t,n){t=x(t,ee.default);let i=Number.MAX_VALUE,o=-Number.MAX_VALUE,r=Number.MAX_VALUE,s=-Number.MAX_VALUE,a=Number.MAX_VALUE,c=-Number.MAX_VALUE;for(let l=0,f=e.length;l<f;l++){let d=t.cartesianToCartographic(e[l]);i=Math.min(i,d.longitude),o=Math.max(o,d.longitude),a=Math.min(a,d.latitude),c=Math.max(c,d.latitude);let p=d.longitude>=0?d.longitude:d.longitude+R.TWO_PI;r=Math.min(r,p),s=Math.max(s,p)}return o-i>s-r&&(i=r,o=s,o>R.PI&&(o=o-R.TWO_PI),i>R.PI&&(i=i-R.TWO_PI)),u(n)?(n.west=i,n.south=a,n.east=o,n.north=c,n):new An(i,a,o,c)};var o1e=new h,r1e=new h,s1e=new h,a1e=new h,c1e=new h,aG=new Array(5);for(let e=0;e<aG.length;++e)aG[e]=new h;An.fromBoundingSphere=function(e,t,n){let i=e.center,o=e.radius;if(u(t)||(t=ee.default),u(n)||(n=new An),h.equals(i,h.ZERO))return An.clone(An.MAX_VALUE,n),n;let r=Lt.eastNorthUpToFixedFrame(i,t,o1e),s=F.multiplyByPointAsVector(r,h.UNIT_X,r1e);h.normalize(s,s);let a=F.multiplyByPointAsVector(r,h.UNIT_Y,s1e);h.normalize(a,a),h.multiplyByScalar(a,o,a),h.multiplyByScalar(s,o,s);let c=h.negate(a,c1e),l=h.negate(s,a1e),f=aG,d=f[0];return h.add(i,a,d),d=f[1],h.add(i,l,d),d=f[2],h.add(i,c,d),d=f[3],h.add(i,s,d),f[4]=i,An.fromCartesianArray(f,t,n)};An.clone=function(e,t){if(u(e))return u(t)?(t.west=e.west,t.south=e.south,t.east=e.east,t.north=e.north,t):new An(e.west,e.south,e.east,e.north)};An.equalsEpsilon=function(e,t,n){return n=x(n,0),e===t||u(e)&&u(t)&&Math.abs(e.west-t.west)<=n&&Math.abs(e.south-t.south)<=n&&Math.abs(e.east-t.east)<=n&&Math.abs(e.north-t.north)<=n};An.prototype.clone=function(e){return An.clone(this,e)};An.prototype.equals=function(e){return An.equals(this,e)};An.equals=function(e,t){return e===t||u(e)&&u(t)&&e.west===t.west&&e.south===t.south&&e.east===t.east&&e.north===t.north};An.prototype.equalsEpsilon=function(e,t){return An.equalsEpsilon(this,e,t)};An.validate=function(e){return ys("Rectangle.validate","Rectangle.validate is a no-op and has been deprecated. It will be removed in Cesium 1.124."),An._validate(e)};An._validate=function(e){};An.southwest=function(e,t){return u(t)?(t.longitude=e.west,t.latitude=e.south,t.height=0,t):new de(e.west,e.south)};An.northwest=function(e,t){return u(t)?(t.longitude=e.west,t.latitude=e.north,t.height=0,t):new de(e.west,e.north)};An.northeast=function(e,t){return u(t)?(t.longitude=e.east,t.latitude=e.north,t.height=0,t):new de(e.east,e.north)};An.southeast=function(e,t){return u(t)?(t.longitude=e.east,t.latitude=e.south,t.height=0,t):new de(e.east,e.south)};An.center=function(e,t){let n=e.east,i=e.west;n<i&&(n+=R.TWO_PI);let o=R.negativePiToPi((i+n)*.5),r=(e.south+e.north)*.5;return u(t)?(t.longitude=o,t.latitude=r,t.height=0,t):new de(o,r)};An.intersection=function(e,t,n){let i=e.east,o=e.west,r=t.east,s=t.west;i<o&&r>0?i+=R.TWO_PI:r<s&&i>0&&(r+=R.TWO_PI),i<o&&s<0?s+=R.TWO_PI:r<s&&o<0&&(o+=R.TWO_PI);let a=R.negativePiToPi(Math.max(o,s)),c=R.negativePiToPi(Math.min(i,r));if((e.west<e.east||t.west<t.east)&&c<=a)return;let l=Math.max(e.south,t.south),f=Math.min(e.north,t.north);if(!(l>=f))return u(n)?(n.west=a,n.south=l,n.east=c,n.north=f,n):new An(a,l,c,f)};An.simpleIntersection=function(e,t,n){let i=Math.max(e.west,t.west),o=Math.max(e.south,t.south),r=Math.min(e.east,t.east),s=Math.min(e.north,t.north);if(!(o>=s||i>=r))return u(n)?(n.west=i,n.south=o,n.east=r,n.north=s,n):new An(i,o,r,s)};An.union=function(e,t,n){u(n)||(n=new An);let i=e.east,o=e.west,r=t.east,s=t.west;i<o&&r>0?i+=R.TWO_PI:r<s&&i>0&&(r+=R.TWO_PI),i<o&&s<0?s+=R.TWO_PI:r<s&&o<0&&(o+=R.TWO_PI);let a=R.negativePiToPi(Math.min(o,s)),c=R.negativePiToPi(Math.max(i,r));return n.west=a,n.south=Math.min(e.south,t.south),n.east=c,n.north=Math.max(e.north,t.north),n};An.expand=function(e,t,n){return u(n)||(n=new An),n.west=Math.min(e.west,t.longitude),n.south=Math.min(e.south,t.latitude),n.east=Math.max(e.east,t.longitude),n.north=Math.max(e.north,t.latitude),n};An.contains=function(e,t){let n=t.longitude,i=t.latitude,o=e.west,r=e.east;return r<o&&(r+=R.TWO_PI,n<0&&(n+=R.TWO_PI)),(n>o||R.equalsEpsilon(n,o,R.EPSILON14))&&(n<r||R.equalsEpsilon(n,r,R.EPSILON14))&&i>=e.south&&i<=e.north};var l1e=new de;An.subsample=function(e,t,n,i){t=x(t,ee.default),n=x(n,0),u(i)||(i=[]);let o=0,r=e.north,s=e.south,a=e.east,c=e.west,l=l1e;l.height=n,l.longitude=c,l.latitude=r,i[o]=t.cartographicToCartesian(l,i[o]),o++,l.longitude=a,i[o]=t.cartographicToCartesian(l,i[o]),o++,l.latitude=s,i[o]=t.cartographicToCartesian(l,i[o]),o++,l.longitude=c,i[o]=t.cartographicToCartesian(l,i[o]),o++,r<0?l.latitude=r:s>0?l.latitude=s:l.latitude=0;for(let f=1;f<8;++f)l.longitude=-Math.PI+f*R.PI_OVER_TWO,An.contains(e,l)&&(i[o]=t.cartographicToCartesian(l,i[o]),o++);return l.latitude===0&&(l.longitude=c,i[o]=t.cartographicToCartesian(l,i[o]),o++,l.longitude=a,i[o]=t.cartographicToCartesian(l,i[o]),o++),i.length=o,i};An.subsection=function(e,t,n,i,o,r){if(u(r)||(r=new An),e.west<=e.east){let a=e.east-e.west;r.west=e.west+t*a,r.east=e.west+i*a}else{let a=R.TWO_PI+e.east-e.west;r.west=R.negativePiToPi(e.west+t*a),r.east=R.negativePiToPi(e.west+i*a)}let s=e.north-e.south;return r.south=e.south+n*s,r.north=e.south+o*s,t===1&&(r.west=e.east),i===1&&(r.east=e.east),n===1&&(r.south=e.north),o===1&&(r.north=e.north),r};An.MAX_VALUE=Object.freeze(new An(-Math.PI,-R.PI_OVER_TWO,Math.PI,R.PI_OVER_TWO));var se=An;function Rr(e,t,n,i){this.x=x(e,0),this.y=x(t,0),this.width=x(n,0),this.height=x(i,0)}Rr.packedLength=4;Rr.pack=function(e,t,n){return n=x(n,0),t[n++]=e.x,t[n++]=e.y,t[n++]=e.width,t[n]=e.height,t};Rr.unpack=function(e,t,n){return t=x(t,0),u(n)||(n=new Rr),n.x=e[t++],n.y=e[t++],n.width=e[t++],n.height=e[t],n};Rr.fromPoints=function(e,t){if(u(t)||(t=new Rr),!u(e)||e.length===0)return t.x=0,t.y=0,t.width=0,t.height=0,t;let n=e.length,i=e[0].x,o=e[0].y,r=e[0].x,s=e[0].y;for(let a=1;a<n;a++){let c=e[a],l=c.x,f=c.y;i=Math.min(l,i),r=Math.max(l,r),o=Math.min(f,o),s=Math.max(f,s)}return t.x=i,t.y=o,t.width=r-i,t.height=s-o,t};var LQ=new Oi,u1e=new de,f1e=new de;Rr.fromRectangle=function(e,t,n){if(u(n)||(n=new Rr),!u(e))return n.x=0,n.y=0,n.width=0,n.height=0,n;LQ._ellipsoid=ee.default,t=x(t,LQ);let i=t.project(se.southwest(e,u1e)),o=t.project(se.northeast(e,f1e));return H.subtract(o,i,o),n.x=i.x,n.y=i.y,n.width=o.x,n.height=o.y,n};Rr.clone=function(e,t){if(u(e))return u(t)?(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t):new Rr(e.x,e.y,e.width,e.height)};Rr.union=function(e,t,n){u(n)||(n=new Rr);let i=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width),s=Math.max(e.y+e.height,t.y+t.height);return n.x=i,n.y=o,n.width=r-i,n.height=s-o,n};Rr.expand=function(e,t,n){n=Rr.clone(e,n);let i=t.x-n.x,o=t.y-n.y;return i>n.width?n.width=i:i<0&&(n.width-=i,n.x=t.x),o>n.height?n.height=o:o<0&&(n.height-=o,n.y=t.y),n};Rr.intersect=function(e,t){let n=e.x,i=e.y,o=t.x,r=t.y;return n>o+t.width||n+e.width<o||i+e.height<r||i>r+t.height?qt.OUTSIDE:qt.INTERSECTING};Rr.equals=function(e,t){return e===t||u(e)&&u(t)&&e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height};Rr.prototype.clone=function(e){return Rr.clone(this,e)};Rr.prototype.intersect=function(e){return Rr.intersect(this,e)};Rr.prototype.equals=function(e){return Rr.equals(this,e)};var qe=Rr;var Ta={POINTS:te.POINTS,LINES:te.LINES,LINE_LOOP:te.LINE_LOOP,LINE_STRIP:te.LINE_STRIP,TRIANGLES:te.TRIANGLES,TRIANGLE_STRIP:te.TRIANGLE_STRIP,TRIANGLE_FAN:te.TRIANGLE_FAN};Ta.isLines=function(e){return e===Ta.LINES||e===Ta.LINE_LOOP||e===Ta.LINE_STRIP};Ta.isTriangles=function(e){return e===Ta.TRIANGLES||e===Ta.TRIANGLE_STRIP||e===Ta.TRIANGLE_FAN};Ta.validate=function(e){return e===Ta.POINTS||e===Ta.LINES||e===Ta.LINE_LOOP||e===Ta.LINE_STRIP||e===Ta.TRIANGLES||e===Ta.TRIANGLE_STRIP||e===Ta.TRIANGLE_FAN};var Ne=Object.freeze(Ta);var pC=`in vec4 position;
in vec2 textureCoordinates;

out vec2 v_textureCoordinates;

void main() 
{
    gl_Position = position;
    v_textureCoordinates = textureCoordinates;
}
`;var pr={CULL:1,OCCLUDE:2,EXECUTE_IN_CLOSEST_FRUSTUM:4,DEBUG_SHOW_BOUNDING_VOLUME:8,CAST_SHADOWS:16,RECEIVE_SHADOWS:32,PICK_ONLY:64,DEPTH_FOR_TRANSLUCENT_CLASSIFICATION:128};function HS(e){e=x(e,x.EMPTY_OBJECT),this._boundingVolume=e.boundingVolume,this._orientedBoundingBox=e.orientedBoundingBox,this._modelMatrix=e.modelMatrix,this._primitiveType=x(e.primitiveType,Ne.TRIANGLES),this._vertexArray=e.vertexArray,this._count=e.count,this._offset=x(e.offset,0),this._instanceCount=x(e.instanceCount,0),this._shaderProgram=e.shaderProgram,this._uniformMap=e.uniformMap,this._renderState=e.renderState,this._framebuffer=e.framebuffer,this._pass=e.pass,this._owner=e.owner,this._debugOverlappingFrustums=0,this._pickId=e.pickId,this._pickMetadataAllowed=e.pickMetadataAllowed===!0,this._pickedMetadataInfo=void 0,this._flags=0,this.cull=x(e.cull,!0),this.occlude=x(e.occlude,!0),this.executeInClosestFrustum=x(e.executeInClosestFrustum,!1),this.debugShowBoundingVolume=x(e.debugShowBoundingVolume,!1),this.castShadows=x(e.castShadows,!1),this.receiveShadows=x(e.receiveShadows,!1),this.pickOnly=x(e.pickOnly,!1),this.depthForTranslucentClassification=x(e.depthForTranslucentClassification,!1),this.dirty=!0,this.lastDirtyTime=0,this.derivedCommands={}}function ja(e,t){return(e._flags&t)===t}function B_(e,t,n){n?e._flags|=t:e._flags&=~t}Object.defineProperties(HS.prototype,{boundingVolume:{get:function(){return this._boundingVolume},set:function(e){this._boundingVolume!==e&&(this._boundingVolume=e,this.dirty=!0)}},orientedBoundingBox:{get:function(){return this._orientedBoundingBox},set:function(e){this._orientedBoundingBox!==e&&(this._orientedBoundingBox=e,this.dirty=!0)}},cull:{get:function(){return ja(this,pr.CULL)},set:function(e){ja(this,pr.CULL)!==e&&(B_(this,pr.CULL,e),this.dirty=!0)}},occlude:{get:function(){return ja(this,pr.OCCLUDE)},set:function(e){ja(this,pr.OCCLUDE)!==e&&(B_(this,pr.OCCLUDE,e),this.dirty=!0)}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix!==e&&(this._modelMatrix=e,this.dirty=!0)}},primitiveType:{get:function(){return this._primitiveType},set:function(e){this._primitiveType!==e&&(this._primitiveType=e,this.dirty=!0)}},vertexArray:{get:function(){return this._vertexArray},set:function(e){this._vertexArray!==e&&(this._vertexArray=e,this.dirty=!0)}},count:{get:function(){return this._count},set:function(e){this._count!==e&&(this._count=e,this.dirty=!0)}},offset:{get:function(){return this._offset},set:function(e){this._offset!==e&&(this._offset=e,this.dirty=!0)}},instanceCount:{get:function(){return this._instanceCount},set:function(e){this._instanceCount!==e&&(this._instanceCount=e,this.dirty=!0)}},shaderProgram:{get:function(){return this._shaderProgram},set:function(e){this._shaderProgram!==e&&(this._shaderProgram=e,this.dirty=!0)}},castShadows:{get:function(){return ja(this,pr.CAST_SHADOWS)},set:function(e){ja(this,pr.CAST_SHADOWS)!==e&&(B_(this,pr.CAST_SHADOWS,e),this.dirty=!0)}},receiveShadows:{get:function(){return ja(this,pr.RECEIVE_SHADOWS)},set:function(e){ja(this,pr.RECEIVE_SHADOWS)!==e&&(B_(this,pr.RECEIVE_SHADOWS,e),this.dirty=!0)}},uniformMap:{get:function(){return this._uniformMap},set:function(e){this._uniformMap!==e&&(this._uniformMap=e,this.dirty=!0)}},renderState:{get:function(){return this._renderState},set:function(e){this._renderState!==e&&(this._renderState=e,this.dirty=!0)}},framebuffer:{get:function(){return this._framebuffer},set:function(e){this._framebuffer!==e&&(this._framebuffer=e,this.dirty=!0)}},pass:{get:function(){return this._pass},set:function(e){this._pass!==e&&(this._pass=e,this.dirty=!0)}},executeInClosestFrustum:{get:function(){return ja(this,pr.EXECUTE_IN_CLOSEST_FRUSTUM)},set:function(e){ja(this,pr.EXECUTE_IN_CLOSEST_FRUSTUM)!==e&&(B_(this,pr.EXECUTE_IN_CLOSEST_FRUSTUM,e),this.dirty=!0)}},owner:{get:function(){return this._owner},set:function(e){this._owner!==e&&(this._owner=e,this.dirty=!0)}},debugShowBoundingVolume:{get:function(){return ja(this,pr.DEBUG_SHOW_BOUNDING_VOLUME)},set:function(e){ja(this,pr.DEBUG_SHOW_BOUNDING_VOLUME)!==e&&(B_(this,pr.DEBUG_SHOW_BOUNDING_VOLUME,e),this.dirty=!0)}},debugOverlappingFrustums:{get:function(){return this._debugOverlappingFrustums},set:function(e){this._debugOverlappingFrustums!==e&&(this._debugOverlappingFrustums=e,this.dirty=!0)}},pickId:{get:function(){return this._pickId},set:function(e){this._pickId!==e&&(this._pickId=e,this.dirty=!0)}},pickMetadataAllowed:{get:function(){return this._pickMetadataAllowed}},pickedMetadataInfo:{get:function(){return this._pickedMetadataInfo},set:function(e){this._pickedMetadataInfo!==e&&(this._pickedMetadataInfo=e,this.dirty=!0)}},pickOnly:{get:function(){return ja(this,pr.PICK_ONLY)},set:function(e){ja(this,pr.PICK_ONLY)!==e&&(B_(this,pr.PICK_ONLY,e),this.dirty=!0)}},depthForTranslucentClassification:{get:function(){return ja(this,pr.DEPTH_FOR_TRANSLUCENT_CLASSIFICATION)},set:function(e){ja(this,pr.DEPTH_FOR_TRANSLUCENT_CLASSIFICATION)!==e&&(B_(this,pr.DEPTH_FOR_TRANSLUCENT_CLASSIFICATION,e),this.dirty=!0)}}});HS.shallowClone=function(e,t){if(u(e))return u(t)||(t=new HS),t._boundingVolume=e._boundingVolume,t._orientedBoundingBox=e._orientedBoundingBox,t._modelMatrix=e._modelMatrix,t._primitiveType=e._primitiveType,t._vertexArray=e._vertexArray,t._count=e._count,t._offset=e._offset,t._instanceCount=e._instanceCount,t._shaderProgram=e._shaderProgram,t._uniformMap=e._uniformMap,t._renderState=e._renderState,t._framebuffer=e._framebuffer,t._pass=e._pass,t._owner=e._owner,t._debugOverlappingFrustums=e._debugOverlappingFrustums,t._pickId=e._pickId,t._pickMetadataAllowed=e._pickMetadataAllowed,t._pickedMetadataInfo=e._pickedMetadataInfo,t._flags=e._flags,t.dirty=!0,t.lastDirtyTime=0,t};HS.prototype.execute=function(e,t){e.draw(this,t)};var Qe=HS;var fi={UNSIGNED_BYTE:te.UNSIGNED_BYTE,UNSIGNED_SHORT:te.UNSIGNED_SHORT,UNSIGNED_INT:te.UNSIGNED_INT,FLOAT:te.FLOAT,HALF_FLOAT:te.HALF_FLOAT_OES,UNSIGNED_INT_24_8:te.UNSIGNED_INT_24_8,UNSIGNED_SHORT_4_4_4_4:te.UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1:te.UNSIGNED_SHORT_5_5_5_1,UNSIGNED_SHORT_5_6_5:te.UNSIGNED_SHORT_5_6_5};fi.toWebGLConstant=function(e,t){switch(e){case fi.UNSIGNED_BYTE:return te.UNSIGNED_BYTE;case fi.UNSIGNED_SHORT:return te.UNSIGNED_SHORT;case fi.UNSIGNED_INT:return te.UNSIGNED_INT;case fi.FLOAT:return te.FLOAT;case fi.HALF_FLOAT:return t.webgl2?te.HALF_FLOAT:te.HALF_FLOAT_OES;case fi.UNSIGNED_INT_24_8:return te.UNSIGNED_INT_24_8;case fi.UNSIGNED_SHORT_4_4_4_4:return te.UNSIGNED_SHORT_4_4_4_4;case fi.UNSIGNED_SHORT_5_5_5_1:return te.UNSIGNED_SHORT_5_5_5_1;case fi.UNSIGNED_SHORT_5_6_5:return fi.UNSIGNED_SHORT_5_6_5}};fi.isPacked=function(e){return e===fi.UNSIGNED_INT_24_8||e===fi.UNSIGNED_SHORT_4_4_4_4||e===fi.UNSIGNED_SHORT_5_5_5_1||e===fi.UNSIGNED_SHORT_5_6_5};fi.sizeInBytes=function(e){switch(e){case fi.UNSIGNED_BYTE:return 1;case fi.UNSIGNED_SHORT:case fi.UNSIGNED_SHORT_4_4_4_4:case fi.UNSIGNED_SHORT_5_5_5_1:case fi.UNSIGNED_SHORT_5_6_5:case fi.HALF_FLOAT:return 2;case fi.UNSIGNED_INT:case fi.FLOAT:case fi.UNSIGNED_INT_24_8:return 4}};fi.validate=function(e){return e===fi.UNSIGNED_BYTE||e===fi.UNSIGNED_SHORT||e===fi.UNSIGNED_INT||e===fi.FLOAT||e===fi.HALF_FLOAT||e===fi.UNSIGNED_INT_24_8||e===fi.UNSIGNED_SHORT_4_4_4_4||e===fi.UNSIGNED_SHORT_5_5_5_1||e===fi.UNSIGNED_SHORT_5_6_5};fi.getTypedArrayConstructor=function(e){let t=fi.sizeInBytes(e);return t===Uint8Array.BYTES_PER_ELEMENT?Uint8Array:t===Uint16Array.BYTES_PER_ELEMENT?Uint16Array:t===Float32Array.BYTES_PER_ELEMENT&&e===fi.FLOAT?Float32Array:Uint32Array};var Ke=Object.freeze(fi);var rt={DEPTH_COMPONENT:te.DEPTH_COMPONENT,DEPTH_STENCIL:te.DEPTH_STENCIL,ALPHA:te.ALPHA,RED:te.RED,RG:te.RG,RGB:te.RGB,RGBA:te.RGBA,LUMINANCE:te.LUMINANCE,LUMINANCE_ALPHA:te.LUMINANCE_ALPHA,RGB_DXT1:te.COMPRESSED_RGB_S3TC_DXT1_EXT,RGBA_DXT1:te.COMPRESSED_RGBA_S3TC_DXT1_EXT,RGBA_DXT3:te.COMPRESSED_RGBA_S3TC_DXT3_EXT,RGBA_DXT5:te.COMPRESSED_RGBA_S3TC_DXT5_EXT,RGB_PVRTC_4BPPV1:te.COMPRESSED_RGB_PVRTC_4BPPV1_IMG,RGB_PVRTC_2BPPV1:te.COMPRESSED_RGB_PVRTC_2BPPV1_IMG,RGBA_PVRTC_4BPPV1:te.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG,RGBA_PVRTC_2BPPV1:te.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG,RGBA_ASTC:te.COMPRESSED_RGBA_ASTC_4x4_WEBGL,RGB_ETC1:te.COMPRESSED_RGB_ETC1_WEBGL,RGB8_ETC2:te.COMPRESSED_RGB8_ETC2,RGBA8_ETC2_EAC:te.COMPRESSED_RGBA8_ETC2_EAC,RGBA_BC7:te.COMPRESSED_RGBA_BPTC_UNORM};rt.componentsLength=function(e){switch(e){case rt.RGB:return 3;case rt.RGBA:return 4;case rt.LUMINANCE_ALPHA:case rt.RG:return 2;case rt.ALPHA:case rt.RED:case rt.LUMINANCE:return 1;default:return 1}};rt.validate=function(e){return e===rt.DEPTH_COMPONENT||e===rt.DEPTH_STENCIL||e===rt.ALPHA||e===rt.RED||e===rt.RG||e===rt.RGB||e===rt.RGBA||e===rt.LUMINANCE||e===rt.LUMINANCE_ALPHA||e===rt.RGB_DXT1||e===rt.RGBA_DXT1||e===rt.RGBA_DXT3||e===rt.RGBA_DXT5||e===rt.RGB_PVRTC_4BPPV1||e===rt.RGB_PVRTC_2BPPV1||e===rt.RGBA_PVRTC_4BPPV1||e===rt.RGBA_PVRTC_2BPPV1||e===rt.RGBA_ASTC||e===rt.RGB_ETC1||e===rt.RGB8_ETC2||e===rt.RGBA8_ETC2_EAC||e===rt.RGBA_BC7};rt.isColorFormat=function(e){return e===rt.RED||e===rt.ALPHA||e===rt.RGB||e===rt.RGBA||e===rt.LUMINANCE||e===rt.LUMINANCE_ALPHA};rt.isDepthFormat=function(e){return e===rt.DEPTH_COMPONENT||e===rt.DEPTH_STENCIL};rt.isCompressedFormat=function(e){return e===rt.RGB_DXT1||e===rt.RGBA_DXT1||e===rt.RGBA_DXT3||e===rt.RGBA_DXT5||e===rt.RGB_PVRTC_4BPPV1||e===rt.RGB_PVRTC_2BPPV1||e===rt.RGBA_PVRTC_4BPPV1||e===rt.RGBA_PVRTC_2BPPV1||e===rt.RGBA_ASTC||e===rt.RGB_ETC1||e===rt.RGB8_ETC2||e===rt.RGBA8_ETC2_EAC||e===rt.RGBA_BC7};rt.isDXTFormat=function(e){return e===rt.RGB_DXT1||e===rt.RGBA_DXT1||e===rt.RGBA_DXT3||e===rt.RGBA_DXT5};rt.isPVRTCFormat=function(e){return e===rt.RGB_PVRTC_4BPPV1||e===rt.RGB_PVRTC_2BPPV1||e===rt.RGBA_PVRTC_4BPPV1||e===rt.RGBA_PVRTC_2BPPV1};rt.isASTCFormat=function(e){return e===rt.RGBA_ASTC};rt.isETC1Format=function(e){return e===rt.RGB_ETC1};rt.isETC2Format=function(e){return e===rt.RGB8_ETC2||e===rt.RGBA8_ETC2_EAC};rt.isBC7Format=function(e){return e===rt.RGBA_BC7};rt.compressedTextureSizeInBytes=function(e,t,n){switch(e){case rt.RGB_DXT1:case rt.RGBA_DXT1:case rt.RGB_ETC1:case rt.RGB8_ETC2:return Math.floor((t+3)/4)*Math.floor((n+3)/4)*8;case rt.RGBA_DXT3:case rt.RGBA_DXT5:case rt.RGBA_ASTC:case rt.RGBA8_ETC2_EAC:return Math.floor((t+3)/4)*Math.floor((n+3)/4)*16;case rt.RGB_PVRTC_4BPPV1:case rt.RGBA_PVRTC_4BPPV1:return Math.floor((Math.max(t,8)*Math.max(n,8)*4+7)/8);case rt.RGB_PVRTC_2BPPV1:case rt.RGBA_PVRTC_2BPPV1:return Math.floor((Math.max(t,16)*Math.max(n,8)*2+7)/8);case rt.RGBA_BC7:return Math.ceil(t/4)*Math.ceil(n/4)*16;default:return 0}};rt.textureSizeInBytes=function(e,t,n,i){let o=rt.componentsLength(e);return Ke.isPacked(t)&&(o=1),o*Ke.sizeInBytes(t)*n*i};rt.alignmentInBytes=function(e,t,n){let i=rt.textureSizeInBytes(e,t,n,1)%4;return i===0?4:i===2?2:1};rt.createTypedArray=function(e,t,n,i){let o=Ke.getTypedArrayConstructor(t),r=rt.componentsLength(e)*n*i;return new o(r)};rt.flipY=function(e,t,n,i,o){if(o===1)return e;let r=rt.createTypedArray(t,n,i,o),s=rt.componentsLength(t),a=i*s;for(let c=0;c<o;++c){let l=c*i*s,f=(o-c-1)*i*s;for(let d=0;d<a;++d)r[f+d]=e[l+d]}return r};rt.toInternalFormat=function(e,t,n){if(!n.webgl2)return e;if(e===rt.DEPTH_STENCIL)return te.DEPTH24_STENCIL8;if(e===rt.DEPTH_COMPONENT){if(t===Ke.UNSIGNED_SHORT)return te.DEPTH_COMPONENT16;if(t===Ke.UNSIGNED_INT)return te.DEPTH_COMPONENT24}if(t===Ke.FLOAT)switch(e){case rt.RGBA:return te.RGBA32F;case rt.RGB:return te.RGB32F;case rt.RG:return te.RG32F;case rt.RED:return te.R32F}if(t===Ke.HALF_FLOAT)switch(e){case rt.RGBA:return te.RGBA16F;case rt.RGB:return te.RGB16F;case rt.RG:return te.RG16F;case rt.RED:return te.R16F}return e};var tt=Object.freeze(rt);var _r={_maximumCombinedTextureImageUnits:0,_maximumCubeMapSize:0,_maximumFragmentUniformVectors:0,_maximumTextureImageUnits:0,_maximumRenderbufferSize:0,_maximumTextureSize:0,_maximumVaryingVectors:0,_maximumVertexAttributes:0,_maximumVertexTextureImageUnits:0,_maximumVertexUniformVectors:0,_minimumAliasedLineWidth:0,_maximumAliasedLineWidth:0,_minimumAliasedPointSize:0,_maximumAliasedPointSize:0,_maximumViewportWidth:0,_maximumViewportHeight:0,_maximumTextureFilterAnisotropy:0,_maximumDrawBuffers:0,_maximumColorAttachments:0,_maximumSamples:0,_highpFloatSupported:!1,_highpIntSupported:!1};Object.defineProperties(_r,{maximumCombinedTextureImageUnits:{get:function(){return _r._maximumCombinedTextureImageUnits}},maximumCubeMapSize:{get:function(){return _r._maximumCubeMapSize}},maximumFragmentUniformVectors:{get:function(){return _r._maximumFragmentUniformVectors}},maximumTextureImageUnits:{get:function(){return _r._maximumTextureImageUnits}},maximumRenderbufferSize:{get:function(){return _r._maximumRenderbufferSize}},maximumTextureSize:{get:function(){return _r._maximumTextureSize}},maximumVaryingVectors:{get:function(){return _r._maximumVaryingVectors}},maximumVertexAttributes:{get:function(){return _r._maximumVertexAttributes}},maximumVertexTextureImageUnits:{get:function(){return _r._maximumVertexTextureImageUnits}},maximumVertexUniformVectors:{get:function(){return _r._maximumVertexUniformVectors}},minimumAliasedLineWidth:{get:function(){return _r._minimumAliasedLineWidth}},maximumAliasedLineWidth:{get:function(){return _r._maximumAliasedLineWidth}},minimumAliasedPointSize:{get:function(){return _r._minimumAliasedPointSize}},maximumAliasedPointSize:{get:function(){return _r._maximumAliasedPointSize}},maximumViewportWidth:{get:function(){return _r._maximumViewportWidth}},maximumViewportHeight:{get:function(){return _r._maximumViewportHeight}},maximumTextureFilterAnisotropy:{get:function(){return _r._maximumTextureFilterAnisotropy}},maximumDrawBuffers:{get:function(){return _r._maximumDrawBuffers}},maximumColorAttachments:{get:function(){return _r._maximumColorAttachments}},maximumSamples:{get:function(){return _r._maximumSamples}},highpFloatSupported:{get:function(){return _r._highpFloatSupported}},highpIntSupported:{get:function(){return _r._highpIntSupported}}});var Vt=_r;function cG(e,t,n){let i=e._gl;i.framebufferTexture2D(i.FRAMEBUFFER,t,n._target,n._texture,0)}function LP(e,t,n){let i=e._gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,t,i.RENDERBUFFER,n._getRenderbuffer())}function sd(e){e=x(e,x.EMPTY_OBJECT);let n=e.context._gl,i=Vt.maximumColorAttachments;if(this._gl=n,this._framebuffer=n.createFramebuffer(),this._colorTextures=[],this._colorRenderbuffers=[],this._activeColorAttachments=[],this._depthTexture=void 0,this._depthRenderbuffer=void 0,this._stencilRenderbuffer=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this.destroyAttachments=x(e.destroyAttachments,!0),this._bind(),u(e.colorTextures)){let o=e.colorTextures,r=this._colorTextures.length=this._activeColorAttachments.length=o.length;for(let s=0;s<r;++s){let a=o[s],c=this._gl.COLOR_ATTACHMENT0+s;cG(this,c,a),this._activeColorAttachments[s]=c,this._colorTextures[s]=a}}if(u(e.colorRenderbuffers)){let o=e.colorRenderbuffers,r=this._colorRenderbuffers.length=this._activeColorAttachments.length=o.length;for(let s=0;s<r;++s){let a=o[s],c=this._gl.COLOR_ATTACHMENT0+s;LP(this,c,a),this._activeColorAttachments[s]=c,this._colorRenderbuffers[s]=a}}if(u(e.depthTexture)){let o=e.depthTexture;cG(this,this._gl.DEPTH_ATTACHMENT,o),this._depthTexture=o}if(u(e.depthRenderbuffer)){let o=e.depthRenderbuffer;LP(this,this._gl.DEPTH_ATTACHMENT,o),this._depthRenderbuffer=o}if(u(e.stencilRenderbuffer)){let o=e.stencilRenderbuffer;LP(this,this._gl.STENCIL_ATTACHMENT,o),this._stencilRenderbuffer=o}if(u(e.depthStencilTexture)){let o=e.depthStencilTexture;cG(this,this._gl.DEPTH_STENCIL_ATTACHMENT,o),this._depthStencilTexture=o}if(u(e.depthStencilRenderbuffer)){let o=e.depthStencilRenderbuffer;LP(this,this._gl.DEPTH_STENCIL_ATTACHMENT,o),this._depthStencilRenderbuffer=o}this._unBind()}Object.defineProperties(sd.prototype,{status:{get:function(){this._bind();let e=this._gl.checkFramebufferStatus(this._gl.FRAMEBUFFER);return this._unBind(),e}},numberOfColorAttachments:{get:function(){return this._activeColorAttachments.length}},depthTexture:{get:function(){return this._depthTexture}},depthRenderbuffer:{get:function(){return this._depthRenderbuffer}},stencilRenderbuffer:{get:function(){return this._stencilRenderbuffer}},depthStencilTexture:{get:function(){return this._depthStencilTexture}},depthStencilRenderbuffer:{get:function(){return this._depthStencilRenderbuffer}},hasDepthAttachment:{get:function(){return!!(this.depthTexture||this.depthRenderbuffer||this.depthStencilTexture||this.depthStencilRenderbuffer)}}});sd.prototype._bind=function(){let e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer)};sd.prototype._unBind=function(){let e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,null)};sd.prototype.bindDraw=function(){let e=this._gl;e.bindFramebuffer(e.DRAW_FRAMEBUFFER,this._framebuffer)};sd.prototype.bindRead=function(){let e=this._gl;e.bindFramebuffer(e.READ_FRAMEBUFFER,this._framebuffer)};sd.prototype._getActiveColorAttachments=function(){return this._activeColorAttachments};sd.prototype.getColorTexture=function(e){return this._colorTextures[e]};sd.prototype.getColorRenderbuffer=function(e){return this._colorRenderbuffers[e]};sd.prototype.isDestroyed=function(){return!1};sd.prototype.destroy=function(){if(this.destroyAttachments){let e=this._colorTextures;for(let n=0;n<e.length;++n){let i=e[n];u(i)&&i.destroy()}let t=this._colorRenderbuffers;for(let n=0;n<t.length;++n){let i=t[n];u(i)&&i.destroy()}this._depthTexture=this._depthTexture&&this._depthTexture.destroy(),this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy(),this._stencilRenderbuffer=this._stencilRenderbuffer&&this._stencilRenderbuffer.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy()}return this._gl.deleteFramebuffer(this._framebuffer),ue(this)};var Hr=sd;var NP={CLOCKWISE:te.CW,COUNTER_CLOCKWISE:te.CCW};NP.validate=function(e){return e===NP.CLOCKWISE||e===NP.COUNTER_CLOCKWISE};var xs=Object.freeze(NP);function NQ(e){if(typeof e!="object"||e===null)return e;let t,n=Object.keys(e);for(let i=0;i<n.length;i++)t=n[i],e.hasOwnProperty(t)&&t!=="_applyFunctions"&&(e[t]=NQ(e[t]));return Object.freeze(e)}var FQ=NQ;function Th(e){let t=x(e,x.EMPTY_OBJECT),n=x(t.cull,x.EMPTY_OBJECT),i=x(t.polygonOffset,x.EMPTY_OBJECT),o=x(t.scissorTest,x.EMPTY_OBJECT),r=x(o.rectangle,x.EMPTY_OBJECT),s=x(t.depthRange,x.EMPTY_OBJECT),a=x(t.depthTest,x.EMPTY_OBJECT),c=x(t.colorMask,x.EMPTY_OBJECT),l=x(t.blending,x.EMPTY_OBJECT),f=x(l.color,x.EMPTY_OBJECT),d=x(t.stencilTest,x.EMPTY_OBJECT),p=x(d.frontOperation,x.EMPTY_OBJECT),g=x(d.backOperation,x.EMPTY_OBJECT),m=x(t.sampleCoverage,x.EMPTY_OBJECT),y=t.viewport;this.frontFace=x(t.frontFace,xs.COUNTER_CLOCKWISE),this.cull={enabled:x(n.enabled,!1),face:x(n.face,te.BACK)},this.lineWidth=x(t.lineWidth,1),this.polygonOffset={enabled:x(i.enabled,!1),factor:x(i.factor,0),units:x(i.units,0)},this.scissorTest={enabled:x(o.enabled,!1),rectangle:qe.clone(r)},this.depthRange={near:x(s.near,0),far:x(s.far,1)},this.depthTest={enabled:x(a.enabled,!1),func:x(a.func,te.LESS)},this.colorMask={red:x(c.red,!0),green:x(c.green,!0),blue:x(c.blue,!0),alpha:x(c.alpha,!0)},this.depthMask=x(t.depthMask,!0),this.stencilMask=x(t.stencilMask,-1),this.blending={enabled:x(l.enabled,!1),color:new G(x(f.red,0),x(f.green,0),x(f.blue,0),x(f.alpha,0)),equationRgb:x(l.equationRgb,te.FUNC_ADD),equationAlpha:x(l.equationAlpha,te.FUNC_ADD),functionSourceRgb:x(l.functionSourceRgb,te.ONE),functionSourceAlpha:x(l.functionSourceAlpha,te.ONE),functionDestinationRgb:x(l.functionDestinationRgb,te.ZERO),functionDestinationAlpha:x(l.functionDestinationAlpha,te.ZERO)},this.stencilTest={enabled:x(d.enabled,!1),frontFunction:x(d.frontFunction,te.ALWAYS),backFunction:x(d.backFunction,te.ALWAYS),reference:x(d.reference,0),mask:x(d.mask,-1),frontOperation:{fail:x(p.fail,te.KEEP),zFail:x(p.zFail,te.KEEP),zPass:x(p.zPass,te.KEEP)},backOperation:{fail:x(g.fail,te.KEEP),zFail:x(g.zFail,te.KEEP),zPass:x(g.zPass,te.KEEP)}},this.sampleCoverage={enabled:x(m.enabled,!1),value:x(m.value,1),invert:x(m.invert,!1)},this.viewport=u(y)?new qe(y.x,y.y,y.width,y.height):void 0,this.id=0,this._applyFunctions=[]}var d1e=0,Ah={};Th.fromCache=function(e){let t=JSON.stringify(e),n=Ah[t];if(u(n))return++n.referenceCount,n.state;let i=new Th(e),o=JSON.stringify(i);return n=Ah[o],u(n)||(i.id=d1e++,n={referenceCount:0,state:i},Ah[o]=n),++n.referenceCount,Ah[t]={referenceCount:1,state:n.state},n.state};Th.removeFromCache=function(e){let t=new Th(e),n=JSON.stringify(t),i=Ah[n],o=JSON.stringify(e),r=Ah[o];u(r)&&(--r.referenceCount,r.referenceCount===0&&(delete Ah[o],u(i)&&--i.referenceCount)),u(i)&&i.referenceCount===0&&delete Ah[n]};Th.getCache=function(){return Ah};Th.clearCache=function(){Ah={}};function wy(e,t,n){n?e.enable(t):e.disable(t)}function BQ(e,t){e.frontFace(t.frontFace)}function kQ(e,t){let n=t.cull,i=n.enabled;wy(e,e.CULL_FACE,i),i&&e.cullFace(n.face)}function VQ(e,t){e.lineWidth(t.lineWidth)}function UQ(e,t){let n=t.polygonOffset,i=n.enabled;wy(e,e.POLYGON_OFFSET_FILL,i),i&&e.polygonOffset(n.factor,n.units)}function zQ(e,t,n){let i=t.scissorTest,o=u(n.scissorTest)?n.scissorTest.enabled:i.enabled;if(wy(e,e.SCISSOR_TEST,o),o){let r=u(n.scissorTest)?n.scissorTest.rectangle:i.rectangle;e.scissor(r.x,r.y,r.width,r.height)}}function HQ(e,t){let n=t.depthRange;e.depthRange(n.near,n.far)}function GQ(e,t){let n=t.depthTest,i=n.enabled;wy(e,e.DEPTH_TEST,i),i&&e.depthFunc(n.func)}function WQ(e,t){let n=t.colorMask;e.colorMask(n.red,n.green,n.blue,n.alpha)}function jQ(e,t){e.depthMask(t.depthMask)}function qQ(e,t){e.stencilMask(t.stencilMask)}function h1e(e,t){e.blendColor(t.red,t.green,t.blue,t.alpha)}function YQ(e,t,n){let i=t.blending,o=u(n.blendingEnabled)?n.blendingEnabled:i.enabled;wy(e,e.BLEND,o),o&&(h1e(e,i.color),e.blendEquationSeparate(i.equationRgb,i.equationAlpha),e.blendFuncSeparate(i.functionSourceRgb,i.functionDestinationRgb,i.functionSourceAlpha,i.functionDestinationAlpha))}function XQ(e,t){let n=t.stencilTest,i=n.enabled;if(wy(e,e.STENCIL_TEST,i),i){let o=n.frontFunction,r=n.backFunction,s=n.reference,a=n.mask;e.stencilFunc(o,s,a),e.stencilFuncSeparate(e.BACK,r,s,a),e.stencilFuncSeparate(e.FRONT,o,s,a);let c=n.frontOperation,l=c.fail,f=c.zFail,d=c.zPass;e.stencilOpSeparate(e.FRONT,l,f,d);let p=n.backOperation,g=p.fail,m=p.zFail,y=p.zPass;e.stencilOpSeparate(e.BACK,g,m,y)}}function KQ(e,t){let n=t.sampleCoverage,i=n.enabled;wy(e,e.SAMPLE_COVERAGE,i),i&&e.sampleCoverage(n.value,n.invert)}var m1e=new qe;function ZQ(e,t,n){let i=x(t.viewport,n.viewport);u(i)||(i=m1e,i.width=n.context.drawingBufferWidth,i.height=n.context.drawingBufferHeight),n.context.uniformState.viewport=i,e.viewport(i.x,i.y,i.width,i.height)}Th.apply=function(e,t,n){BQ(e,t),kQ(e,t),VQ(e,t),UQ(e,t),HQ(e,t),GQ(e,t),WQ(e,t),jQ(e,t),qQ(e,t),XQ(e,t),KQ(e,t),zQ(e,t,n),YQ(e,t,n),ZQ(e,t,n)};function p1e(e,t){let n=[];return e.frontFace!==t.frontFace&&n.push(BQ),(e.cull.enabled!==t.cull.enabled||e.cull.face!==t.cull.face)&&n.push(kQ),e.lineWidth!==t.lineWidth&&n.push(VQ),(e.polygonOffset.enabled!==t.polygonOffset.enabled||e.polygonOffset.factor!==t.polygonOffset.factor||e.polygonOffset.units!==t.polygonOffset.units)&&n.push(UQ),(e.depthRange.near!==t.depthRange.near||e.depthRange.far!==t.depthRange.far)&&n.push(HQ),(e.depthTest.enabled!==t.depthTest.enabled||e.depthTest.func!==t.depthTest.func)&&n.push(GQ),(e.colorMask.red!==t.colorMask.red||e.colorMask.green!==t.colorMask.green||e.colorMask.blue!==t.colorMask.blue||e.colorMask.alpha!==t.colorMask.alpha)&&n.push(WQ),e.depthMask!==t.depthMask&&n.push(jQ),e.stencilMask!==t.stencilMask&&n.push(qQ),(e.stencilTest.enabled!==t.stencilTest.enabled||e.stencilTest.frontFunction!==t.stencilTest.frontFunction||e.stencilTest.backFunction!==t.stencilTest.backFunction||e.stencilTest.reference!==t.stencilTest.reference||e.stencilTest.mask!==t.stencilTest.mask||e.stencilTest.frontOperation.fail!==t.stencilTest.frontOperation.fail||e.stencilTest.frontOperation.zFail!==t.stencilTest.frontOperation.zFail||e.stencilTest.backOperation.fail!==t.stencilTest.backOperation.fail||e.stencilTest.backOperation.zFail!==t.stencilTest.backOperation.zFail||e.stencilTest.backOperation.zPass!==t.stencilTest.backOperation.zPass)&&n.push(XQ),(e.sampleCoverage.enabled!==t.sampleCoverage.enabled||e.sampleCoverage.value!==t.sampleCoverage.value||e.sampleCoverage.invert!==t.sampleCoverage.invert)&&n.push(KQ),n}Th.partialApply=function(e,t,n,i,o,r){if(t!==n){let f=n._applyFunctions[t.id];u(f)||(f=p1e(t,n),n._applyFunctions[t.id]=f);let d=f.length;for(let p=0;p<d;++p)f[p](e,n)}let s=u(i.scissorTest)?i.scissorTest:t.scissorTest,a=u(o.scissorTest)?o.scissorTest:n.scissorTest;(s!==a||r)&&zQ(e,n,o);let c=u(i.blendingEnabled)?i.blendingEnabled:t.blending.enabled,l=u(o.blendingEnabled)?o.blendingEnabled:n.blending.enabled;(c!==l||l&&t.blending!==n.blending)&&YQ(e,n,o),(t!==n||i!==o||i.context!==o.context)&&ZQ(e,n,o)};Th.getState=function(e){return{frontFace:e.frontFace,cull:{enabled:e.cull.enabled,face:e.cull.face},lineWidth:e.lineWidth,polygonOffset:{enabled:e.polygonOffset.enabled,factor:e.polygonOffset.factor,units:e.polygonOffset.units},scissorTest:{enabled:e.scissorTest.enabled,rectangle:qe.clone(e.scissorTest.rectangle)},depthRange:{near:e.depthRange.near,far:e.depthRange.far},depthTest:{enabled:e.depthTest.enabled,func:e.depthTest.func},colorMask:{red:e.colorMask.red,green:e.colorMask.green,blue:e.colorMask.blue,alpha:e.colorMask.alpha},depthMask:e.depthMask,stencilMask:e.stencilMask,blending:{enabled:e.blending.enabled,color:G.clone(e.blending.color),equationRgb:e.blending.equationRgb,equationAlpha:e.blending.equationAlpha,functionSourceRgb:e.blending.functionSourceRgb,functionSourceAlpha:e.blending.functionSourceAlpha,functionDestinationRgb:e.blending.functionDestinationRgb,functionDestinationAlpha:e.blending.functionDestinationAlpha},stencilTest:{enabled:e.stencilTest.enabled,frontFunction:e.stencilTest.frontFunction,backFunction:e.stencilTest.backFunction,reference:e.stencilTest.reference,mask:e.stencilTest.mask,frontOperation:{fail:e.stencilTest.frontOperation.fail,zFail:e.stencilTest.frontOperation.zFail,zPass:e.stencilTest.frontOperation.zPass},backOperation:{fail:e.stencilTest.backOperation.fail,zFail:e.stencilTest.backOperation.zFail,zPass:e.stencilTest.backOperation.zPass}},sampleCoverage:{enabled:e.sampleCoverage.enabled,value:e.sampleCoverage.value,invert:e.sampleCoverage.invert},viewport:u(e.viewport)?qe.clone(e.viewport):void 0}};var Ue=Th;function Xt(e,t,n,i){this[0]=x(e,0),this[1]=x(n,0),this[2]=x(t,0),this[3]=x(i,0)}Xt.packedLength=4;Xt.pack=function(e,t,n){return n=x(n,0),t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t};Xt.unpack=function(e,t,n){return t=x(t,0),u(n)||(n=new Xt),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n};Xt.packArray=function(e,t){let n=e.length,i=n*4;u(t)?!Array.isArray(t)&&t.length!==i||t.length!==i&&(t.length=i):t=new Array(i);for(let o=0;o<n;++o)Xt.pack(e[o],t,o*4);return t};Xt.unpackArray=function(e,t){let n=e.length;u(t)?t.length=n/4:t=new Array(n/4);for(let i=0;i<n;i+=4){let o=i/4;t[o]=Xt.unpack(e,i,t[o])}return t};Xt.clone=function(e,t){if(u(e))return u(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):new Xt(e[0],e[2],e[1],e[3])};Xt.fromArray=Xt.unpack;Xt.fromColumnMajorArray=function(e,t){return Xt.clone(e,t)};Xt.fromRowMajorArray=function(e,t){return u(t)?(t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t):new Xt(e[0],e[1],e[2],e[3])};Xt.fromScale=function(e,t){return u(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=e.y,t):new Xt(e.x,0,0,e.y)};Xt.fromUniformScale=function(e,t){return u(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=e,t):new Xt(e,0,0,e)};Xt.fromRotation=function(e,t){let n=Math.cos(e),i=Math.sin(e);return u(t)?(t[0]=n,t[1]=i,t[2]=-i,t[3]=n,t):new Xt(n,-i,i,n)};Xt.toArray=function(e,t){return u(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):[e[0],e[1],e[2],e[3]]};Xt.getElementIndex=function(e,t){return e*2+t};Xt.getColumn=function(e,t,n){let i=t*2,o=e[i],r=e[i+1];return n.x=o,n.y=r,n};Xt.setColumn=function(e,t,n,i){i=Xt.clone(e,i);let o=t*2;return i[o]=n.x,i[o+1]=n.y,i};Xt.getRow=function(e,t,n){let i=e[t],o=e[t+2];return n.x=i,n.y=o,n};Xt.setRow=function(e,t,n,i){return i=Xt.clone(e,i),i[t]=n.x,i[t+2]=n.y,i};var _1e=new H;Xt.setScale=function(e,t,n){let i=Xt.getScale(e,_1e),o=t.x/i.x,r=t.y/i.y;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*r,n[3]=e[3]*r,n};var g1e=new H;Xt.setUniformScale=function(e,t,n){let i=Xt.getScale(e,g1e),o=t/i.x,r=t/i.y;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*r,n[3]=e[3]*r,n};var $Q=new H;Xt.getScale=function(e,t){return t.x=H.magnitude(H.fromElements(e[0],e[1],$Q)),t.y=H.magnitude(H.fromElements(e[2],e[3],$Q)),t};var QQ=new H;Xt.getMaximumScale=function(e){return Xt.getScale(e,QQ),H.maximumComponent(QQ)};var y1e=new H;Xt.setRotation=function(e,t,n){let i=Xt.getScale(e,y1e);return n[0]=t[0]*i.x,n[1]=t[1]*i.x,n[2]=t[2]*i.y,n[3]=t[3]*i.y,n};var x1e=new H;Xt.getRotation=function(e,t){let n=Xt.getScale(e,x1e);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.y,t[3]=e[3]/n.y,t};Xt.multiply=function(e,t,n){let i=e[0]*t[0]+e[2]*t[1],o=e[0]*t[2]+e[2]*t[3],r=e[1]*t[0]+e[3]*t[1],s=e[1]*t[2]+e[3]*t[3];return n[0]=i,n[1]=r,n[2]=o,n[3]=s,n};Xt.add=function(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n};Xt.subtract=function(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n};Xt.multiplyByVector=function(e,t,n){let i=e[0]*t.x+e[2]*t.y,o=e[1]*t.x+e[3]*t.y;return n.x=i,n.y=o,n};Xt.multiplyByScalar=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n};Xt.multiplyByScale=function(e,t,n){return n[0]=e[0]*t.x,n[1]=e[1]*t.x,n[2]=e[2]*t.y,n[3]=e[3]*t.y,n};Xt.multiplyByUniformScale=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n};Xt.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t};Xt.transpose=function(e,t){let n=e[0],i=e[2],o=e[1],r=e[3];return t[0]=n,t[1]=i,t[2]=o,t[3]=r,t};Xt.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t};Xt.equals=function(e,t){return e===t||u(e)&&u(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]};Xt.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]};Xt.equalsEpsilon=function(e,t,n){return n=x(n,0),e===t||u(e)&&u(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n};Xt.IDENTITY=Object.freeze(new Xt(1,0,0,1));Xt.ZERO=Object.freeze(new Xt(0,0,0,0));Xt.COLUMN0ROW0=0;Xt.COLUMN0ROW1=1;Xt.COLUMN1ROW0=2;Xt.COLUMN1ROW1=3;Object.defineProperties(Xt.prototype,{length:{get:function(){return Xt.packedLength}}});Xt.prototype.clone=function(e){return Xt.clone(this,e)};Xt.prototype.equals=function(e){return Xt.equals(this,e)};Xt.prototype.equalsEpsilon=function(e,t){return Xt.equalsEpsilon(this,e,t)};Xt.prototype.toString=function(){return`(${this[0]}, ${this[2]})
(${this[1]}, ${this[3]})`};var Hi=Xt;function b1e(e,t,n,i){switch(t.type){case e.FLOAT:return new JQ(e,t,n,i);case e.FLOAT_VEC2:return new eJ(e,t,n,i);case e.FLOAT_VEC3:return new tJ(e,t,n,i);case e.FLOAT_VEC4:return new nJ(e,t,n,i);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new lG(e,t,n,i);case e.INT:case e.BOOL:return new iJ(e,t,n,i);case e.INT_VEC2:case e.BOOL_VEC2:return new oJ(e,t,n,i);case e.INT_VEC3:case e.BOOL_VEC3:return new rJ(e,t,n,i);case e.INT_VEC4:case e.BOOL_VEC4:return new sJ(e,t,n,i);case e.FLOAT_MAT2:return new aJ(e,t,n,i);case e.FLOAT_MAT3:return new cJ(e,t,n,i);case e.FLOAT_MAT4:return new lJ(e,t,n,i);default:throw new ce(`Unrecognized uniform type: ${t.type} for uniform "${n}".`)}}function JQ(e,t,n,i){this.name=n,this.value=void 0,this._value=0,this._gl=e,this._location=i}JQ.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1f(this._location,this.value))};function eJ(e,t,n,i){this.name=n,this.value=void 0,this._value=new H,this._gl=e,this._location=i}eJ.prototype.set=function(){let e=this.value;H.equals(e,this._value)||(H.clone(e,this._value),this._gl.uniform2f(this._location,e.x,e.y))};function tJ(e,t,n,i){this.name=n,this.value=void 0,this._value=void 0,this._gl=e,this._location=i}tJ.prototype.set=function(){let e=this.value;u(e.red)?G.equals(e,this._value)||(this._value=G.clone(e,this._value),this._gl.uniform3f(this._location,e.red,e.green,e.blue)):u(e.x)&&(h.equals(e,this._value)||(this._value=h.clone(e,this._value),this._gl.uniform3f(this._location,e.x,e.y,e.z)))};function nJ(e,t,n,i){this.name=n,this.value=void 0,this._value=void 0,this._gl=e,this._location=i}nJ.prototype.set=function(){let e=this.value;u(e.red)?G.equals(e,this._value)||(this._value=G.clone(e,this._value),this._gl.uniform4f(this._location,e.red,e.green,e.blue,e.alpha)):u(e.x)&&(oe.equals(e,this._value)||(this._value=oe.clone(e,this._value),this._gl.uniform4f(this._location,e.x,e.y,e.z,e.w)))};function lG(e,t,n,i){this.name=n,this.value=void 0,this._gl=e,this._location=i,this.textureUnitIndex=void 0}lG.prototype.set=function(){let e=this._gl;e.activeTexture(e.TEXTURE0+this.textureUnitIndex);let t=this.value;e.bindTexture(t._target,t._texture)};lG.prototype._setSampler=function(e){return this.textureUnitIndex=e,this._gl.uniform1i(this._location,e),e+1};function iJ(e,t,n,i){this.name=n,this.value=void 0,this._value=0,this._gl=e,this._location=i}iJ.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1i(this._location,this.value))};function oJ(e,t,n,i){this.name=n,this.value=void 0,this._value=new H,this._gl=e,this._location=i}oJ.prototype.set=function(){let e=this.value;H.equals(e,this._value)||(H.clone(e,this._value),this._gl.uniform2i(this._location,e.x,e.y))};function rJ(e,t,n,i){this.name=n,this.value=void 0,this._value=new h,this._gl=e,this._location=i}rJ.prototype.set=function(){let e=this.value;h.equals(e,this._value)||(h.clone(e,this._value),this._gl.uniform3i(this._location,e.x,e.y,e.z))};function sJ(e,t,n,i){this.name=n,this.value=void 0,this._value=new oe,this._gl=e,this._location=i}sJ.prototype.set=function(){let e=this.value;oe.equals(e,this._value)||(oe.clone(e,this._value),this._gl.uniform4i(this._location,e.x,e.y,e.z,e.w))};var C1e=new Float32Array(4);function aJ(e,t,n,i){this.name=n,this.value=void 0,this._value=new Hi,this._gl=e,this._location=i}aJ.prototype.set=function(){if(!Hi.equalsArray(this.value,this._value,0)){Hi.clone(this.value,this._value);let e=Hi.toArray(this.value,C1e);this._gl.uniformMatrix2fv(this._location,!1,e)}};var A1e=new Float32Array(9);function cJ(e,t,n,i){this.name=n,this.value=void 0,this._value=new J,this._gl=e,this._location=i}cJ.prototype.set=function(){if(!J.equalsArray(this.value,this._value,0)){J.clone(this.value,this._value);let e=J.toArray(this.value,A1e);this._gl.uniformMatrix3fv(this._location,!1,e)}};var T1e=new Float32Array(16);function lJ(e,t,n,i){this.name=n,this.value=void 0,this._value=new F,this._gl=e,this._location=i}lJ.prototype.set=function(){if(!F.equalsArray(this.value,this._value,0)){F.clone(this.value,this._value);let e=F.toArray(this.value,T1e);this._gl.uniformMatrix4fv(this._location,!1,e)}};var FP=b1e;function E1e(e,t,n,i){switch(t.type){case e.FLOAT:return new uJ(e,t,n,i);case e.FLOAT_VEC2:return new fJ(e,t,n,i);case e.FLOAT_VEC3:return new dJ(e,t,n,i);case e.FLOAT_VEC4:return new hJ(e,t,n,i);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new uG(e,t,n,i);case e.INT:case e.BOOL:return new mJ(e,t,n,i);case e.INT_VEC2:case e.BOOL_VEC2:return new pJ(e,t,n,i);case e.INT_VEC3:case e.BOOL_VEC3:return new _J(e,t,n,i);case e.INT_VEC4:case e.BOOL_VEC4:return new gJ(e,t,n,i);case e.FLOAT_MAT2:return new yJ(e,t,n,i);case e.FLOAT_MAT3:return new xJ(e,t,n,i);case e.FLOAT_MAT4:return new bJ(e,t,n,i);default:throw new ce(`Unrecognized uniform type: ${t.type} for uniform "${n}".`)}}function uJ(e,t,n,i){let o=i.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o),this._gl=e,this._location=i[0]}uJ.prototype.set=function(){let e=this.value,t=e.length,n=this._value,i=!1;for(let o=0;o<t;++o){let r=e[o];r!==n[o]&&(n[o]=r,i=!0)}i&&this._gl.uniform1fv(this._location,n)};function fJ(e,t,n,i){let o=i.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o*2),this._gl=e,this._location=i[0]}fJ.prototype.set=function(){let e=this.value,t=e.length,n=this._value,i=!1,o=0;for(let r=0;r<t;++r){let s=e[r];H.equalsArray(s,n,o)||(H.pack(s,n,o),i=!0),o+=2}i&&this._gl.uniform2fv(this._location,n)};function dJ(e,t,n,i){let o=i.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o*3),this._gl=e,this._location=i[0]}dJ.prototype.set=function(){let e=this.value,t=e.length,n=this._value,i=!1,o=0;for(let r=0;r<t;++r){let s=e[r];u(s.red)?(s.red!==n[o]||s.green!==n[o+1]||s.blue!==n[o+2])&&(n[o]=s.red,n[o+1]=s.green,n[o+2]=s.blue,i=!0):u(s.x)&&(h.equalsArray(s,n,o)||(h.pack(s,n,o),i=!0)),o+=3}i&&this._gl.uniform3fv(this._location,n)};function hJ(e,t,n,i){let o=i.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o*4),this._gl=e,this._location=i[0]}hJ.prototype.set=function(){let e=this.value,t=e.length,n=this._value,i=!1,o=0;for(let r=0;r<t;++r){let s=e[r];u(s.red)?G.equalsArray(s,n,o)||(G.pack(s,n,o),i=!0):u(s.x)&&(oe.equalsArray(s,n,o)||(oe.pack(s,n,o),i=!0)),o+=4}i&&this._gl.uniform4fv(this._location,n)};function uG(e,t,n,i){let o=i.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o),this._gl=e,this._locations=i,this.textureUnitIndex=void 0}uG.prototype.set=function(){let e=this._gl,t=e.TEXTURE0+this.textureUnitIndex,n=this.value,i=n.length;for(let o=0;o<i;++o){let r=n[o];e.activeTexture(t+o),e.bindTexture(r._target,r._texture)}};uG.prototype._setSampler=function(e){this.textureUnitIndex=e;let t=this._locations,n=t.length;for(let i=0;i<n;++i){let o=e+i;this._gl.uniform1i(t[i],o)}return e+n};function mJ(e,t,n,i){let o=i.length;this.name=n,this.value=new Array(o),this._value=new Int32Array(o),this._gl=e,this._location=i[0]}mJ.prototype.set=function(){let e=this.value,t=e.length,n=this._value,i=!1;for(let o=0;o<t;++o){let r=e[o];r!==n[o]&&(n[o]=r,i=!0)}i&&this._gl.uniform1iv(this._location,n)};function pJ(e,t,n,i){let o=i.length;this.name=n,this.value=new Array(o),this._value=new Int32Array(o*2),this._gl=e,this._location=i[0]}pJ.prototype.set=function(){let e=this.value,t=e.length,n=this._value,i=!1,o=0;for(let r=0;r<t;++r){let s=e[r];H.equalsArray(s,n,o)||(H.pack(s,n,o),i=!0),o+=2}i&&this._gl.uniform2iv(this._location,n)};function _J(e,t,n,i){let o=i.length;this.name=n,this.value=new Array(o),this._value=new Int32Array(o*3),this._gl=e,this._location=i[0]}_J.prototype.set=function(){let e=this.value,t=e.length,n=this._value,i=!1,o=0;for(let r=0;r<t;++r){let s=e[r];h.equalsArray(s,n,o)||(h.pack(s,n,o),i=!0),o+=3}i&&this._gl.uniform3iv(this._location,n)};function gJ(e,t,n,i){let o=i.length;this.name=n,this.value=new Array(o),this._value=new Int32Array(o*4),this._gl=e,this._location=i[0]}gJ.prototype.set=function(){let e=this.value,t=e.length,n=this._value,i=!1,o=0;for(let r=0;r<t;++r){let s=e[r];oe.equalsArray(s,n,o)||(oe.pack(s,n,o),i=!0),o+=4}i&&this._gl.uniform4iv(this._location,n)};function yJ(e,t,n,i){let o=i.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o*4),this._gl=e,this._location=i[0]}yJ.prototype.set=function(){let e=this.value,t=e.length,n=this._value,i=!1,o=0;for(let r=0;r<t;++r){let s=e[r];Hi.equalsArray(s,n,o)||(Hi.pack(s,n,o),i=!0),o+=4}i&&this._gl.uniformMatrix2fv(this._location,!1,n)};function xJ(e,t,n,i){let o=i.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o*9),this._gl=e,this._location=i[0]}xJ.prototype.set=function(){let e=this.value,t=e.length,n=this._value,i=!1,o=0;for(let r=0;r<t;++r){let s=e[r];J.equalsArray(s,n,o)||(J.pack(s,n,o),i=!0),o+=9}i&&this._gl.uniformMatrix3fv(this._location,!1,n)};function bJ(e,t,n,i){let o=i.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o*16),this._gl=e,this._location=i[0]}bJ.prototype.set=function(){let e=this.value,t=e.length,n=this._value,i=!1,o=0;for(let r=0;r<t;++r){let s=e[r];F.equalsArray(s,n,o)||(F.pack(s,n,o),i=!0),o+=16}i&&this._gl.uniformMatrix4fv(this._location,!1,n)};var BP=E1e;var S1e=0;function ep(e){let t=e.vertexShaderText,n=e.fragmentShaderText;typeof spector<"u"&&(t=t.replace(/^#line/gm,"//#line"),n=n.replace(/^#line/gm,"//#line"));let i=v1e(t,n);this._gl=e.gl,this._logShaderCompilation=e.logShaderCompilation,this._debugShaders=e.debugShaders,this._attributeLocations=e.attributeLocations,this._program=void 0,this._numberOfVertexAttributes=void 0,this._vertexAttributes=void 0,this._uniformsByName=void 0,this._uniforms=void 0,this._automaticUniforms=void 0,this._manualUniforms=void 0,this._duplicateUniformNames=i.duplicateUniformNames,this._cachedShader=void 0,this.maximumTextureUnitIndex=void 0,this._vertexShaderSource=e.vertexShaderSource,this._vertexShaderText=e.vertexShaderText,this._fragmentShaderSource=e.fragmentShaderSource,this._fragmentShaderText=i.fragmentShaderText,this.id=S1e++}ep.fromCache=function(e){return e=x(e,x.EMPTY_OBJECT),e.context.shaderCache.getShaderProgram(e)};ep.replaceCache=function(e){return e=x(e,x.EMPTY_OBJECT),e.context.shaderCache.replaceShaderProgram(e)};Object.defineProperties(ep.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},vertexAttributes:{get:function(){return kP(this),this._vertexAttributes}},numberOfVertexAttributes:{get:function(){return kP(this),this._numberOfVertexAttributes}},allUniforms:{get:function(){return kP(this),this._uniformsByName}}});function CJ(e){let t=[],n=e.match(/uniform.*?(?![^{]*})(?=[=\[;])/g);if(u(n)){let i=n.length;for(let o=0;o<i;o++){let r=n[o].trim(),s=r.slice(r.lastIndexOf(" ")+1);t.push(s)}}return t}function v1e(e,t){let n={};if(!Vt.highpFloatSupported||!Vt.highpIntSupported){let i,o,r,s,a=CJ(e),c=CJ(t),l=a.length,f=c.length;for(i=0;i<l;i++)for(o=0;o<f;o++)if(a[i]===c[o]){r=a[i],s=`czm_mediump_${r}`;let d=new RegExp(`${r}\\b`,"g");t=t.replace(d,s),n[s]=r}}return{fragmentShaderText:t,duplicateUniformNames:n}}var Eh="[Cesium WebGL] ";function w1e(e,t){let n=t._vertexShaderText,i=t._fragmentShaderText,o=e.createShader(e.VERTEX_SHADER);e.shaderSource(o,n),e.compileShader(o);let r=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(r,i),e.compileShader(r);let s=e.createProgram();e.attachShader(s,o),e.attachShader(s,r);let a=t._attributeLocations;if(u(a))for(let p in a)a.hasOwnProperty(p)&&e.bindAttribLocation(s,a[p],p);e.linkProgram(s);let c;if(e.getProgramParameter(s,e.LINK_STATUS))return t._logShaderCompilation&&(c=e.getShaderInfoLog(o),u(c)&&c.length>0&&console.log(`${Eh}Vertex shader compile log: ${c}`),c=e.getShaderInfoLog(r),u(c)&&c.length>0&&console.log(`${Eh}Fragment shader compile log: ${c}`),c=e.getProgramInfoLog(s),u(c)&&c.length>0&&console.log(`${Eh}Shader program link log: ${c}`)),e.deleteShader(o),e.deleteShader(r),s;let l,f=t._debugShaders;throw e.getShaderParameter(r,e.COMPILE_STATUS)?e.getShaderParameter(o,e.COMPILE_STATUS)?(c=e.getProgramInfoLog(s),console.error(`${Eh}Shader program link log: ${c}`),d(o,"vertex"),d(r,"fragment"),l=`Program failed to link.  Link log: ${c}`):(c=e.getShaderInfoLog(o),console.error(`${Eh}Vertex shader compile log: ${c}`),console.error(`${Eh} Vertex shader source:
${n}`),l=`Vertex shader failed to compile.  Compile log: ${c}`):(c=e.getShaderInfoLog(r),console.error(`${Eh}Fragment shader compile log: ${c}`),console.error(`${Eh} Fragment shader source:
${i}`),l=`Fragment shader failed to compile.  Compile log: ${c}`),e.deleteShader(o),e.deleteShader(r),e.deleteProgram(s),new ce(l);function d(p,g){if(!u(f))return;let m=f.getTranslatedShaderSource(p);if(m===""){console.error(`${Eh}${g} shader translation failed.`);return}console.error(`${Eh}Translated ${g} shaderSource:
${m}`)}}function D1e(e,t,n){let i={};for(let o=0;o<n;++o){let r=e.getActiveAttrib(t,o),s=e.getAttribLocation(t,r.name);i[r.name]={name:r.name,type:r.type,index:s}}return i}function I1e(e,t){let n={},i=[],o=[],r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<r;++s){let a=e.getActiveUniform(t,s),c="[0]",l=a.name.indexOf(c,a.name.length-c.length)!==-1?a.name.slice(0,a.name.length-3):a.name;if(l.indexOf("gl_")!==0)if(a.name.indexOf("[")<0){let f=e.getUniformLocation(t,l);if(f!==null){let d=FP(e,a,l,f);n[l]=d,i.push(d),d._setSampler&&o.push(d)}}else{let f,d,p,g,m=l.indexOf("[");if(m>=0){if(f=n[l.slice(0,m)],!u(f))continue;d=f._locations,d.length<=1&&(p=f.value,g=e.getUniformLocation(t,l),g!==null&&(d.push(g),p.push(e.getUniform(t,g))))}else{d=[];for(let y=0;y<a.size;++y)g=e.getUniformLocation(t,`${l}[${y}]`),g!==null&&d.push(g);f=BP(e,a,l,d),n[l]=f,i.push(f),f._setSampler&&o.push(f)}}}return{uniformsByName:n,uniforms:i,samplerUniforms:o}}function P1e(e,t){let n=[],i=[];for(let o in t)if(t.hasOwnProperty(o)){let r=t[o],s=o,a=e._duplicateUniformNames[s];u(a)&&(r.name=a,s=a);let c=I_[s];u(c)?n.push({uniform:r,automaticUniform:c}):i.push(r)}return{automaticUniforms:n,manualUniforms:i}}function R1e(e,t,n){e.useProgram(t);let i=0,o=n.length;for(let r=0;r<o;++r)i=n[r]._setSampler(i);return e.useProgram(null),i}function kP(e){u(e._program)||AJ(e)}function AJ(e){let t=e._program,n=e._gl,i=w1e(n,e,e._debugShaders),o=n.getProgramParameter(i,n.ACTIVE_ATTRIBUTES),r=I1e(n,i),s=P1e(e,r.uniformsByName);e._program=i,e._numberOfVertexAttributes=o,e._vertexAttributes=D1e(n,i,o),e._uniformsByName=r.uniformsByName,e._uniforms=r.uniforms,e._automaticUniforms=s.automaticUniforms,e._manualUniforms=s.manualUniforms,e.maximumTextureUnitIndex=R1e(n,i,r.samplerUniforms),t&&e._gl.deleteProgram(t),typeof spector<"u"&&(e._program.__SPECTOR_rebuildProgram=function(a,c,l,f){let d=e._vertexShaderText,p=e._fragmentShaderText,g=/ ! = /g;e._vertexShaderText=a.replace(g," != "),e._fragmentShaderText=c.replace(g," != ");try{AJ(e),l(e._program)}catch(m){e._vertexShaderText=d,e._fragmentShaderText=p;let b=/(?:Compile|Link) error: ([^]*)/.exec(m.message);f(b?b[1]:m.message)}})}ep.prototype._bind=function(){kP(this),this._gl.useProgram(this._program)};ep.prototype._setUniforms=function(e,t,n){let i,o;if(u(e)){let a=this._manualUniforms;for(i=a.length,o=0;o<i;++o){let c=a[o];c.value=e[c.name]()}}let r=this._automaticUniforms;for(i=r.length,o=0;o<i;++o){let a=r[o];a.uniform.value=a.automaticUniform.getValue(t)}let s=this._uniforms;for(i=s.length,o=0;o<i;++o)s[o].set();if(n){let a=this._gl,c=this._program;a.validateProgram(c)}};ep.prototype.isDestroyed=function(){return!1};ep.prototype.destroy=function(){this._cachedShader.cache.releaseShaderProgram(this)};ep.prototype.finalDestroy=function(){return this._gl.deleteProgram(this._program),ue(this)};var tn=ep;function VP(e){this._context=e}var GS,O1e=new Qe({primitiveType:Ne.TRIANGLES}),M1e=new ni({color:new G(0,0,0,0)});function L1e(e,t){return new Hr({context:e,colorTextures:[t],destroyAttachments:!1})}function N1e(e,t){return tn.fromCache({context:e,vertexShaderSource:pC,fragmentShaderSource:t,attributeLocations:{position:0,textureCoordinates:1}})}function F1e(e,t){return(!u(GS)||GS.viewport.width!==e||GS.viewport.height!==t)&&(GS=Ue.fromCache({viewport:new qe(0,0,e,t)})),GS}VP.prototype.execute=function(e){u(e.preExecute)&&e.preExecute(e);let t=e.outputTexture,n=t.width,i=t.height,o=this._context,r=u(e.vertexArray)?e.vertexArray:o.getViewportQuadVertexArray(),s=u(e.shaderProgram)?e.shaderProgram:N1e(o,e.fragmentShaderSource),a=L1e(o,t),c=F1e(n,i),l=e.uniformMap,f=M1e;f.framebuffer=a,f.renderState=c,f.execute(o);let d=O1e;d.vertexArray=r,d.renderState=c,d.shaderProgram=s,d.uniformMap=l,d.framebuffer=a,d.execute(o),a.destroy(),e.persists||(s.destroy(),u(e.vertexArray)&&r.destroy()),u(e.postExecute)&&e.postExecute(t)};VP.prototype.isDestroyed=function(){return!1};VP.prototype.destroy=function(){return ue(this)};var UP=VP;var Tn={BYTE:te.BYTE,UNSIGNED_BYTE:te.UNSIGNED_BYTE,SHORT:te.SHORT,UNSIGNED_SHORT:te.UNSIGNED_SHORT,INT:te.INT,UNSIGNED_INT:te.UNSIGNED_INT,FLOAT:te.FLOAT,DOUBLE:te.DOUBLE};Tn.getSizeInBytes=function(e){switch(e){case Tn.BYTE:return Int8Array.BYTES_PER_ELEMENT;case Tn.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Tn.SHORT:return Int16Array.BYTES_PER_ELEMENT;case Tn.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Tn.INT:return Int32Array.BYTES_PER_ELEMENT;case Tn.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case Tn.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case Tn.DOUBLE:return Float64Array.BYTES_PER_ELEMENT}};Tn.fromTypedArray=function(e){if(e instanceof Int8Array)return Tn.BYTE;if(e instanceof Uint8Array)return Tn.UNSIGNED_BYTE;if(e instanceof Int16Array)return Tn.SHORT;if(e instanceof Uint16Array)return Tn.UNSIGNED_SHORT;if(e instanceof Int32Array)return Tn.INT;if(e instanceof Uint32Array)return Tn.UNSIGNED_INT;if(e instanceof Float32Array)return Tn.FLOAT;if(e instanceof Float64Array)return Tn.DOUBLE};Tn.validate=function(e){return u(e)&&(e===Tn.BYTE||e===Tn.UNSIGNED_BYTE||e===Tn.SHORT||e===Tn.UNSIGNED_SHORT||e===Tn.INT||e===Tn.UNSIGNED_INT||e===Tn.FLOAT||e===Tn.DOUBLE)};Tn.createTypedArray=function(e,t){switch(e){case Tn.BYTE:return new Int8Array(t);case Tn.UNSIGNED_BYTE:return new Uint8Array(t);case Tn.SHORT:return new Int16Array(t);case Tn.UNSIGNED_SHORT:return new Uint16Array(t);case Tn.INT:return new Int32Array(t);case Tn.UNSIGNED_INT:return new Uint32Array(t);case Tn.FLOAT:return new Float32Array(t);case Tn.DOUBLE:return new Float64Array(t)}};Tn.createArrayBufferView=function(e,t,n,i){switch(n=x(n,0),i=x(i,(t.byteLength-n)/Tn.getSizeInBytes(e)),e){case Tn.BYTE:return new Int8Array(t,n,i);case Tn.UNSIGNED_BYTE:return new Uint8Array(t,n,i);case Tn.SHORT:return new Int16Array(t,n,i);case Tn.UNSIGNED_SHORT:return new Uint16Array(t,n,i);case Tn.INT:return new Int32Array(t,n,i);case Tn.UNSIGNED_INT:return new Uint32Array(t,n,i);case Tn.FLOAT:return new Float32Array(t,n,i);case Tn.DOUBLE:return new Float64Array(t,n,i)}};Tn.fromName=function(e){switch(e){case"BYTE":return Tn.BYTE;case"UNSIGNED_BYTE":return Tn.UNSIGNED_BYTE;case"SHORT":return Tn.SHORT;case"UNSIGNED_SHORT":return Tn.UNSIGNED_SHORT;case"INT":return Tn.INT;case"UNSIGNED_INT":return Tn.UNSIGNED_INT;case"FLOAT":return Tn.FLOAT;case"DOUBLE":return Tn.DOUBLE}};var K=Object.freeze(Tn);var B1e={NONE:0,TRIANGLES:1,LINES:2,POLYLINES:3},ad=Object.freeze(B1e);function fG(e){e=x(e,x.EMPTY_OBJECT),this.attributes=e.attributes,this.indices=e.indices,this.primitiveType=x(e.primitiveType,Ne.TRIANGLES),this.boundingSphere=e.boundingSphere,this.geometryType=x(e.geometryType,ad.NONE),this.boundingSphereCV=e.boundingSphereCV,this.offsetAttribute=e.offsetAttribute}fG.computeNumberOfVertices=function(e){let t=-1;for(let n in e.attributes)if(e.attributes.hasOwnProperty(n)&&u(e.attributes[n])&&u(e.attributes[n].values)){let i=e.attributes[n];t=i.values.length/i.componentsPerAttribute}return t};var k1e=new de,V1e=new h,TJ=new F,U1e=[new de,new de,new de],z1e=[new H,new H,new H],H1e=[new H,new H,new H],G1e=new h,W1e=new Le,j1e=new F,q1e=new Hi;fG._textureCoordinateRotationPoints=function(e,t,n,i){let o,r=se.center(i,k1e),s=de.toCartesian(r,n,V1e),a=Lt.eastNorthUpToFixedFrame(s,n,TJ),c=F.inverse(a,TJ),l=z1e,f=U1e;f[0].longitude=i.west,f[0].latitude=i.south,f[1].longitude=i.west,f[1].latitude=i.north,f[2].longitude=i.east,f[2].latitude=i.south;let d=G1e;for(o=0;o<3;o++)de.toCartesian(f[o],n,d),d=F.multiplyByPointAsVector(c,d,d),l[o].x=d.x,l[o].y=d.y;let p=Le.fromAxisAngle(h.UNIT_Z,-t,W1e),g=J.fromQuaternion(p,j1e),m=e.length,y=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,C=Number.NEGATIVE_INFINITY,A=Number.NEGATIVE_INFINITY;for(o=0;o<m;o++)d=F.multiplyByPointAsVector(c,e[o],d),d=J.multiplyByVector(g,d,d),y=Math.min(y,d.x),b=Math.min(b,d.y),C=Math.max(C,d.x),A=Math.max(A,d.y);let T=Hi.fromRotation(t,q1e),E=H1e;E[0].x=y,E[0].y=b,E[1].x=y,E[1].y=A,E[2].x=C,E[2].y=b;let v=l[0],D=l[2].x-v.x,O=l[1].y-v.y;for(o=0;o<3;o++){let S=E[o];Hi.multiplyByVector(T,S,S),S.x=(S.x-v.x)/D,S.y=(S.y-v.y)/O}let P=E[0],M=E[1],L=E[2],_=new Array(6);return H.pack(P,_),H.pack(M,_,2),H.pack(L,_,4),_};var ft=fG;function Y1e(e){e=x(e,x.EMPTY_OBJECT),this.componentDatatype=e.componentDatatype,this.componentsPerAttribute=e.componentsPerAttribute,this.normalize=x(e.normalize,!1),this.values=e.values}var ve=Y1e;function _C(e,t,n,i,o){this._format=e,this._datatype=t,this._width=n,this._height=i,this._buffer=o}Object.defineProperties(_C.prototype,{internalFormat:{get:function(){return this._format}},pixelDatatype:{get:function(){return this._datatype}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},bufferView:{get:function(){return this._buffer}},arrayBufferView:{get:function(){return this._buffer}}});_C.clone=function(e){if(u(e))return new _C(e._format,e._datatype,e._width,e._height,e._buffer)};_C.prototype.clone=function(){return _C.clone(this)};var zP=_C;var EJ=Dr(Gl(),1);function SJ(){if(!u(Js._canTransferArrayBuffer)){let e=mG("transferTypedArrayTest");e.postMessage=x(e.webkitPostMessage,e.postMessage);let t=99,n=new Int8Array([t]);try{e.postMessage({array:n},[n.buffer])}catch{return Js._canTransferArrayBuffer=!1,Js._canTransferArrayBuffer}Js._canTransferArrayBuffer=new Promise(i=>{e.onmessage=function(o){let r=o.data.array,s=u(r)&&r[0]===t;i(s),e.terminate(),Js._canTransferArrayBuffer=s}})}return Js._canTransferArrayBuffer}var hG=new me;function dG(e){let t;try{t=new Blob([e],{type:"application/javascript"})}catch{let o=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,r=new o;r.append(e),t=r.getBlob("application/javascript")}return(window.URL||window.webkitURL).createObjectURL(t)}function mG(e){let t=new EJ.default(e),n=t.scheme().length!==0&&t.fragment().length===0,i=e.replace(/\.js$/,""),o={},r,s;if(Ay(e))s=e;else if(!n){let a=on(`${Js._workerModulePrefix}/${i}.js`);Ay(a)&&(s=a)}if(s){let a=`import "${s}";`;return r=dG(a),o.type="module",new Worker(r,o)}if(!n&&typeof CESIUM_WORKERS<"u"){let a=`
      importScripts("${dG(CESIUM_WORKERS)}");
      CesiumWorkers["${i}"]();
    `;return r=dG(a),new Worker(r,o)}if(r=e,n||(r=on(`${Js._workerModulePrefix+i}.js`)),!Wt.supportsEsmWebWorkers())throw new ce("This browser is not supported. Please update your browser to continue.");return o.type="module",new Worker(r,o)}async function X1e(e,t){let n={modulePath:void 0,wasmBinaryFile:void 0,wasmBinary:void 0};if(!Wt.supportsWebAssembly()){if(!u(t.fallbackModulePath))throw new ce(`This browser does not support Web Assembly, and no backup module was provided for ${e._workerPath}`);return n.modulePath=on(t.fallbackModulePath),n}n.wasmBinaryFile=on(t.wasmBinaryFile);let i=await De.fetchArrayBuffer({url:n.wasmBinaryFile});return n.wasmBinary=i,n}function Js(e,t){this._workerPath=e,this._maximumActiveTasks=x(t,Number.POSITIVE_INFINITY),this._activeTasks=0,this._nextID=0,this._webAssemblyPromise=void 0}var K1e=(e,t,n,i)=>{let o=({data:r})=>{if(r.id===t){if(u(r.error)){let s=r.error;s.name==="RuntimeError"?(s=new ce(r.error.message),s.stack=r.error.stack):s.name==="DeveloperError"?(s=new he(r.error.message),s.stack=r.error.stack):s.name==="Error"&&(s=new Error(r.error.message),s.stack=r.error.stack),hG.raiseEvent(s),i(s)}else hG.raiseEvent(),n(r.result);e.removeEventListener("message",o)}};return o},Z1e=[];async function $1e(e,t,n){let i=await Promise.resolve(SJ());u(n)?i||(n.length=0):n=Z1e;let o=e._nextID++,r=new Promise((s,a)=>{e._worker.addEventListener("message",K1e(e._worker,o,s,a))});return e._worker.postMessage({id:o,baseUrl:on.getCesiumBaseUrl().url,parameters:t,canTransferArrayBuffer:i},n),r}async function Q1e(e,t,n){++e._activeTasks;try{let i=await $1e(e,t,n);return--e._activeTasks,i}catch(i){throw--e._activeTasks,i}}Js.prototype.scheduleTask=function(e,t){if(u(this._worker)||(this._worker=mG(this._workerPath)),!(this._activeTasks>=this._maximumActiveTasks))return Q1e(this,e,t)};Js.prototype.initWebAssemblyModule=async function(e){if(u(this._webAssemblyPromise))return this._webAssemblyPromise;let t=async()=>{let n=this._worker=mG(this._workerPath),i=await X1e(this,e),o=await Promise.resolve(SJ()),r,s=i.wasmBinary;u(s)&&o&&(r=[s]);let a=new Promise((c,l)=>{n.onmessage=function({data:f}){u(f)?c(f.result):l(new ce("Could not configure wasm module"))}});return n.postMessage({canTransferArrayBuffer:o,parameters:{webAssemblyConfig:i}},r),a};return this._webAssemblyPromise=t(),this._webAssemblyPromise};Js.prototype.isDestroyed=function(){return!1};Js.prototype.destroy=function(){return u(this._worker)&&this._worker.terminate(),ue(this)};Js.taskCompletedEvent=hG;Js._defaultWorkerModulePrefix="Workers/";Js._workerModulePrefix=Js._defaultWorkerModulePrefix;Js._canTransferArrayBuffer=void 0;var xi=Js;function tp(){}tp._transcodeTaskProcessor=new xi("transcodeKTX2",Number.POSITIVE_INFINITY);tp._readyPromise=void 0;function J1e(){let e=tp._transcodeTaskProcessor.initWebAssemblyModule({wasmBinaryFile:"ThirdParty/basis_transcoder.wasm"}).then(function(t){if(t)return tp._transcodeTaskProcessor;throw new ce("KTX2 transcoder could not be initialized.")});tp._readyPromise=e}tp.transcode=function(e,t){return u(tp._readyPromise)||J1e(),tp._readyPromise.then(function(n){let i=e;e instanceof ArrayBuffer&&(i=new Uint8Array(e));let o={supportedTargetFormats:t,ktx2Buffer:i};return n.scheduleTask(o,[i.buffer])}).then(function(n){let i=n.length,o=Object.keys(n[0]);for(let r=0;r<i;r++){let s=n[r];for(let a=0;a<o.length;a++){let c=s[o[a]];s[o[a]]=new zP(c.internalFormat,c.datatype,c.width,c.height,c.levelBuffer)}}if(o.length===1){for(let r=0;r<i;++r)n[r]=n[r][o[0]];i===1&&(n=n[0])}return n}).catch(function(n){throw n})};var HP=tp;var vJ;wJ.setKTX2SupportedFormats=function(e,t,n,i,o,r){vJ={s3tc:e,pvrtc:t,astc:n,etc:i,etc1:o,bc7:r}};function wJ(e){let t;return e instanceof ArrayBuffer||ArrayBuffer.isView(e)?t=Promise.resolve(e):t=De.createIfNeeded(e).fetchArrayBuffer(),t.then(function(n){return HP.transcode(n,vJ)})}var jl=wJ;function eDe(e,t){this.start=x(e,0),this.stop=x(t,0)}var qa=eDe;function dn(e,t){this.center=h.clone(x(e,h.ZERO)),this.radius=x(t,0)}var gG=new h,yG=new h,xG=new h,bG=new h,CG=new h,AG=new h,TG=new h,ea=new h,EG=new h,SG=new h,vG=new h,wG=new h,tDe=4/3*R.PI;dn.fromPoints=function(e,t){if(u(t)||(t=new dn),!u(e)||e.length===0)return t.center=h.clone(h.ZERO,t.center),t.radius=0,t;let n=h.clone(e[0],TG),i=h.clone(n,gG),o=h.clone(n,yG),r=h.clone(n,xG),s=h.clone(n,bG),a=h.clone(n,CG),c=h.clone(n,AG),l=e.length,f;for(f=1;f<l;f++){h.clone(e[f],n);let P=n.x,M=n.y,L=n.z;P<i.x&&h.clone(n,i),P>s.x&&h.clone(n,s),M<o.y&&h.clone(n,o),M>a.y&&h.clone(n,a),L<r.z&&h.clone(n,r),L>c.z&&h.clone(n,c)}let d=h.magnitudeSquared(h.subtract(s,i,ea)),p=h.magnitudeSquared(h.subtract(a,o,ea)),g=h.magnitudeSquared(h.subtract(c,r,ea)),m=i,y=s,b=d;p>b&&(b=p,m=o,y=a),g>b&&(b=g,m=r,y=c);let C=EG;C.x=(m.x+y.x)*.5,C.y=(m.y+y.y)*.5,C.z=(m.z+y.z)*.5;let A=h.magnitudeSquared(h.subtract(y,C,ea)),T=Math.sqrt(A),E=SG;E.x=i.x,E.y=o.y,E.z=r.z;let v=vG;v.x=s.x,v.y=a.y,v.z=c.z;let D=h.midpoint(E,v,wG),O=0;for(f=0;f<l;f++){h.clone(e[f],n);let P=h.magnitude(h.subtract(n,D,ea));P>O&&(O=P);let M=h.magnitudeSquared(h.subtract(n,C,ea));if(M>A){let L=Math.sqrt(M);T=(T+L)*.5,A=T*T;let _=L-T;C.x=(T*C.x+_*n.x)/L,C.y=(T*C.y+_*n.y)/L,C.z=(T*C.z+_*n.z)/L}}return T<O?(h.clone(C,t.center),t.radius=T):(h.clone(D,t.center),t.radius=O),t};var DJ=new Oi,nDe=new h,iDe=new h,pG=new de,_G=new de;dn.fromRectangle2D=function(e,t,n){return dn.fromRectangleWithHeights2D(e,t,0,0,n)};dn.fromRectangleWithHeights2D=function(e,t,n,i,o){if(u(o)||(o=new dn),!u(e))return o.center=h.clone(h.ZERO,o.center),o.radius=0,o;DJ._ellipsoid=ee.default,t=x(t,DJ),se.southwest(e,pG),pG.height=n,se.northeast(e,_G),_G.height=i;let r=t.project(pG,nDe),s=t.project(_G,iDe),a=s.x-r.x,c=s.y-r.y,l=s.z-r.z;o.radius=Math.sqrt(a*a+c*c+l*l)*.5;let f=o.center;return f.x=r.x+a*.5,f.y=r.y+c*.5,f.z=r.z+l*.5,o};var oDe=[];dn.fromRectangle3D=function(e,t,n,i){if(t=x(t,ee.default),n=x(n,0),u(i)||(i=new dn),!u(e))return i.center=h.clone(h.ZERO,i.center),i.radius=0,i;let o=se.subsample(e,t,n,oDe);return dn.fromPoints(o,i)};dn.fromVertices=function(e,t,n,i){if(u(i)||(i=new dn),!u(e)||e.length===0)return i.center=h.clone(h.ZERO,i.center),i.radius=0,i;t=x(t,h.ZERO),n=x(n,3);let o=TG;o.x=e[0]+t.x,o.y=e[1]+t.y,o.z=e[2]+t.z;let r=h.clone(o,gG),s=h.clone(o,yG),a=h.clone(o,xG),c=h.clone(o,bG),l=h.clone(o,CG),f=h.clone(o,AG),d=e.length,p;for(p=0;p<d;p+=n){let L=e[p]+t.x,_=e[p+1]+t.y,S=e[p+2]+t.z;o.x=L,o.y=_,o.z=S,L<r.x&&h.clone(o,r),L>c.x&&h.clone(o,c),_<s.y&&h.clone(o,s),_>l.y&&h.clone(o,l),S<a.z&&h.clone(o,a),S>f.z&&h.clone(o,f)}let g=h.magnitudeSquared(h.subtract(c,r,ea)),m=h.magnitudeSquared(h.subtract(l,s,ea)),y=h.magnitudeSquared(h.subtract(f,a,ea)),b=r,C=c,A=g;m>A&&(A=m,b=s,C=l),y>A&&(A=y,b=a,C=f);let T=EG;T.x=(b.x+C.x)*.5,T.y=(b.y+C.y)*.5,T.z=(b.z+C.z)*.5;let E=h.magnitudeSquared(h.subtract(C,T,ea)),v=Math.sqrt(E),D=SG;D.x=r.x,D.y=s.y,D.z=a.z;let O=vG;O.x=c.x,O.y=l.y,O.z=f.z;let P=h.midpoint(D,O,wG),M=0;for(p=0;p<d;p+=n){o.x=e[p]+t.x,o.y=e[p+1]+t.y,o.z=e[p+2]+t.z;let L=h.magnitude(h.subtract(o,P,ea));L>M&&(M=L);let _=h.magnitudeSquared(h.subtract(o,T,ea));if(_>E){let S=Math.sqrt(_);v=(v+S)*.5,E=v*v;let w=S-v;T.x=(v*T.x+w*o.x)/S,T.y=(v*T.y+w*o.y)/S,T.z=(v*T.z+w*o.z)/S}}return v<M?(h.clone(T,i.center),i.radius=v):(h.clone(P,i.center),i.radius=M),i};dn.fromEncodedCartesianVertices=function(e,t,n){if(u(n)||(n=new dn),!u(e)||!u(t)||e.length!==t.length||e.length===0)return n.center=h.clone(h.ZERO,n.center),n.radius=0,n;let i=TG;i.x=e[0]+t[0],i.y=e[1]+t[1],i.z=e[2]+t[2];let o=h.clone(i,gG),r=h.clone(i,yG),s=h.clone(i,xG),a=h.clone(i,bG),c=h.clone(i,CG),l=h.clone(i,AG),f=e.length,d;for(d=0;d<f;d+=3){let M=e[d]+t[d],L=e[d+1]+t[d+1],_=e[d+2]+t[d+2];i.x=M,i.y=L,i.z=_,M<o.x&&h.clone(i,o),M>a.x&&h.clone(i,a),L<r.y&&h.clone(i,r),L>c.y&&h.clone(i,c),_<s.z&&h.clone(i,s),_>l.z&&h.clone(i,l)}let p=h.magnitudeSquared(h.subtract(a,o,ea)),g=h.magnitudeSquared(h.subtract(c,r,ea)),m=h.magnitudeSquared(h.subtract(l,s,ea)),y=o,b=a,C=p;g>C&&(C=g,y=r,b=c),m>C&&(C=m,y=s,b=l);let A=EG;A.x=(y.x+b.x)*.5,A.y=(y.y+b.y)*.5,A.z=(y.z+b.z)*.5;let T=h.magnitudeSquared(h.subtract(b,A,ea)),E=Math.sqrt(T),v=SG;v.x=o.x,v.y=r.y,v.z=s.z;let D=vG;D.x=a.x,D.y=c.y,D.z=l.z;let O=h.midpoint(v,D,wG),P=0;for(d=0;d<f;d+=3){i.x=e[d]+t[d],i.y=e[d+1]+t[d+1],i.z=e[d+2]+t[d+2];let M=h.magnitude(h.subtract(i,O,ea));M>P&&(P=M);let L=h.magnitudeSquared(h.subtract(i,A,ea));if(L>T){let _=Math.sqrt(L);E=(E+_)*.5,T=E*E;let S=_-E;A.x=(E*A.x+S*i.x)/_,A.y=(E*A.y+S*i.y)/_,A.z=(E*A.z+S*i.z)/_}}return E<P?(h.clone(A,n.center),n.radius=E):(h.clone(O,n.center),n.radius=P),n};dn.fromCornerPoints=function(e,t,n){u(n)||(n=new dn);let i=h.midpoint(e,t,n.center);return n.radius=h.distance(i,t),n};dn.fromEllipsoid=function(e,t){return u(t)||(t=new dn),h.clone(h.ZERO,t.center),t.radius=e.maximumRadius,t};var rDe=new h;dn.fromBoundingSpheres=function(e,t){if(u(t)||(t=new dn),!u(e)||e.length===0)return t.center=h.clone(h.ZERO,t.center),t.radius=0,t;let n=e.length;if(n===1)return dn.clone(e[0],t);if(n===2)return dn.union(e[0],e[1],t);let i=[],o;for(o=0;o<n;o++)i.push(e[o].center);t=dn.fromPoints(i,t);let r=t.center,s=t.radius;for(o=0;o<n;o++){let a=e[o];s=Math.max(s,h.distance(r,a.center,rDe)+a.radius)}return t.radius=s,t};var sDe=new h,aDe=new h,cDe=new h;dn.fromOrientedBoundingBox=function(e,t){u(t)||(t=new dn);let n=e.halfAxes,i=J.getColumn(n,0,sDe),o=J.getColumn(n,1,aDe),r=J.getColumn(n,2,cDe);return h.add(i,o,i),h.add(i,r,i),t.center=h.clone(e.center,t.center),t.radius=h.magnitude(i),t};var lDe=new h,uDe=new h;dn.fromTransformation=function(e,t){u(t)||(t=new dn);let n=F.getTranslation(e,lDe),i=F.getScale(e,uDe),o=.5*h.magnitude(i);return t.center=h.clone(n,t.center),t.radius=o,t};dn.clone=function(e,t){if(u(e))return u(t)?(t.center=h.clone(e.center,t.center),t.radius=e.radius,t):new dn(e.center,e.radius)};dn.packedLength=4;dn.pack=function(e,t,n){n=x(n,0);let i=e.center;return t[n++]=i.x,t[n++]=i.y,t[n++]=i.z,t[n]=e.radius,t};dn.unpack=function(e,t,n){t=x(t,0),u(n)||(n=new dn);let i=n.center;return i.x=e[t++],i.y=e[t++],i.z=e[t++],n.radius=e[t],n};var fDe=new h,dDe=new h;dn.union=function(e,t,n){u(n)||(n=new dn);let i=e.center,o=e.radius,r=t.center,s=t.radius,a=h.subtract(r,i,fDe),c=h.magnitude(a);if(o>=c+s)return e.clone(n),n;if(s>=c+o)return t.clone(n),n;let l=(o+c+s)*.5,f=h.multiplyByScalar(a,(-o+l)/c,dDe);return h.add(f,i,f),h.clone(f,n.center),n.radius=l,n};var hDe=new h;dn.expand=function(e,t,n){n=dn.clone(e,n);let i=h.magnitude(h.subtract(t,n.center,hDe));return i>n.radius&&(n.radius=i),n};dn.intersectPlane=function(e,t){let n=e.center,i=e.radius,o=t.normal,r=h.dot(o,n)+t.distance;return r<-i?qt.OUTSIDE:r<i?qt.INTERSECTING:qt.INSIDE};dn.transform=function(e,t,n){return u(n)||(n=new dn),n.center=F.multiplyByPoint(t,e.center,n.center),n.radius=F.getMaximumScale(t)*e.radius,n};var mDe=new h;dn.distanceSquaredTo=function(e,t){let n=h.subtract(e.center,t,mDe),i=h.magnitude(n)-e.radius;return i<=0?0:i*i};dn.transformWithoutScale=function(e,t,n){return u(n)||(n=new dn),n.center=F.multiplyByPoint(t,e.center,n.center),n.radius=e.radius,n};var pDe=new h;dn.computePlaneDistances=function(e,t,n,i){u(i)||(i=new qa);let o=h.subtract(e.center,t,pDe),r=h.dot(n,o);return i.start=r-e.radius,i.stop=r+e.radius,i};var IJ=new h,_De=new h,gDe=new h,yDe=new h,xDe=new h,bDe=new de,RJ=new Array(8);for(let e=0;e<8;++e)RJ[e]=new h;var PJ=new Oi;dn.projectTo2D=function(e,t,n){PJ._ellipsoid=ee.default,t=x(t,PJ);let i=t.ellipsoid,o=e.center,r=e.radius,s;h.equals(o,h.ZERO)?s=h.clone(h.UNIT_X,IJ):s=i.geodeticSurfaceNormal(o,IJ);let a=h.cross(h.UNIT_Z,s,_De);h.normalize(a,a);let c=h.cross(s,a,gDe);h.normalize(c,c),h.multiplyByScalar(s,r,s),h.multiplyByScalar(c,r,c),h.multiplyByScalar(a,r,a);let l=h.negate(c,xDe),f=h.negate(a,yDe),d=RJ,p=d[0];h.add(s,c,p),h.add(p,a,p),p=d[1],h.add(s,c,p),h.add(p,f,p),p=d[2],h.add(s,l,p),h.add(p,f,p),p=d[3],h.add(s,l,p),h.add(p,a,p),h.negate(s,s),p=d[4],h.add(s,c,p),h.add(p,a,p),p=d[5],h.add(s,c,p),h.add(p,f,p),p=d[6],h.add(s,l,p),h.add(p,f,p),p=d[7],h.add(s,l,p),h.add(p,a,p);let g=d.length;for(let C=0;C<g;++C){let A=d[C];h.add(o,A,A);let T=i.cartesianToCartographic(A,bDe);t.project(T,A)}n=dn.fromPoints(d,n),o=n.center;let m=o.x,y=o.y,b=o.z;return o.x=b,o.y=m,o.z=y,n};dn.isOccluded=function(e,t){return!t.isBoundingSphereVisible(e)};dn.equals=function(e,t){return e===t||u(e)&&u(t)&&h.equals(e.center,t.center)&&e.radius===t.radius};dn.prototype.intersectPlane=function(e){return dn.intersectPlane(this,e)};dn.prototype.distanceSquaredTo=function(e){return dn.distanceSquaredTo(this,e)};dn.prototype.computePlaneDistances=function(e,t,n){return dn.computePlaneDistances(this,e,t,n)};dn.prototype.isOccluded=function(e){return dn.isOccluded(this,e)};dn.prototype.equals=function(e){return dn.equals(this,e)};dn.prototype.clone=function(e){return dn.clone(this,e)};dn.prototype.volume=function(){let e=this.radius;return tDe*e*e*e};var ae=dn;function CDe(e){e=x(e,x.EMPTY_OBJECT),this.position=e.position,this.normal=e.normal,this.st=e.st,this.bitangent=e.bitangent,this.tangent=e.tangent,this.color=e.color}var hn=CDe;var ADe={NONE:0,TOP:1,ALL:2},an=Object.freeze(ADe);function is(e){e=x(e,x.EMPTY_OBJECT),this.position=x(e.position,!1),this.normal=x(e.normal,!1),this.st=x(e.st,!1),this.bitangent=x(e.bitangent,!1),this.tangent=x(e.tangent,!1),this.color=x(e.color,!1)}is.POSITION_ONLY=Object.freeze(new is({position:!0}));is.POSITION_AND_NORMAL=Object.freeze(new is({position:!0,normal:!0}));is.POSITION_NORMAL_AND_ST=Object.freeze(new is({position:!0,normal:!0,st:!0}));is.POSITION_AND_ST=Object.freeze(new is({position:!0,st:!0}));is.POSITION_AND_COLOR=Object.freeze(new is({position:!0,color:!0}));is.ALL=Object.freeze(new is({position:!0,normal:!0,st:!0,tangent:!0,bitangent:!0}));is.DEFAULT=is.POSITION_NORMAL_AND_ST;is.packedLength=6;is.pack=function(e,t,n){return n=x(n,0),t[n++]=e.position?1:0,t[n++]=e.normal?1:0,t[n++]=e.st?1:0,t[n++]=e.tangent?1:0,t[n++]=e.bitangent?1:0,t[n]=e.color?1:0,t};is.unpack=function(e,t,n){return t=x(t,0),u(n)||(n=new is),n.position=e[t++]===1,n.normal=e[t++]===1,n.st=e[t++]===1,n.tangent=e[t++]===1,n.bitangent=e[t++]===1,n.color=e[t]===1,n};is.clone=function(e,t){if(u(e))return u(t)||(t=new is),t.position=e.position,t.normal=e.normal,t.st=e.st,t.tangent=e.tangent,t.bitangent=e.bitangent,t.color=e.color,t};var Ie=is;var TDe=new h;function ql(e){e=x(e,x.EMPTY_OBJECT);let t=e.minimum,n=e.maximum,i=x(e.vertexFormat,Ie.DEFAULT);this._minimum=h.clone(t),this._maximum=h.clone(n),this._vertexFormat=i,this._offsetAttribute=e.offsetAttribute,this._workerName="createBoxGeometry"}ql.fromDimensions=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.dimensions,n=h.multiplyByScalar(t,.5,new h);return new ql({minimum:h.negate(n,new h),maximum:n,vertexFormat:e.vertexFormat,offsetAttribute:e.offsetAttribute})};ql.fromAxisAlignedBoundingBox=function(e){return new ql({minimum:e.minimum,maximum:e.maximum})};ql.packedLength=2*h.packedLength+Ie.packedLength+1;ql.pack=function(e,t,n){return n=x(n,0),h.pack(e._minimum,t,n),h.pack(e._maximum,t,n+h.packedLength),Ie.pack(e._vertexFormat,t,n+2*h.packedLength),t[n+2*h.packedLength+Ie.packedLength]=x(e._offsetAttribute,-1),t};var MJ=new h,LJ=new h,NJ=new Ie,OJ={minimum:MJ,maximum:LJ,vertexFormat:NJ,offsetAttribute:void 0};ql.unpack=function(e,t,n){t=x(t,0);let i=h.unpack(e,t,MJ),o=h.unpack(e,t+h.packedLength,LJ),r=Ie.unpack(e,t+2*h.packedLength,NJ),s=e[t+2*h.packedLength+Ie.packedLength];return u(n)?(n._minimum=h.clone(i,n._minimum),n._maximum=h.clone(o,n._maximum),n._vertexFormat=Ie.clone(r,n._vertexFormat),n._offsetAttribute=s===-1?void 0:s,n):(OJ.offsetAttribute=s===-1?void 0:s,new ql(OJ))};ql.createGeometry=function(e){let t=e._minimum,n=e._maximum,i=e._vertexFormat;if(h.equals(t,n))return;let o=new hn,r,s;if(i.position&&(i.st||i.normal||i.tangent||i.bitangent)){if(i.position&&(s=new Float64Array(6*4*3),s[0]=t.x,s[1]=t.y,s[2]=n.z,s[3]=n.x,s[4]=t.y,s[5]=n.z,s[6]=n.x,s[7]=n.y,s[8]=n.z,s[9]=t.x,s[10]=n.y,s[11]=n.z,s[12]=t.x,s[13]=t.y,s[14]=t.z,s[15]=n.x,s[16]=t.y,s[17]=t.z,s[18]=n.x,s[19]=n.y,s[20]=t.z,s[21]=t.x,s[22]=n.y,s[23]=t.z,s[24]=n.x,s[25]=t.y,s[26]=t.z,s[27]=n.x,s[28]=n.y,s[29]=t.z,s[30]=n.x,s[31]=n.y,s[32]=n.z,s[33]=n.x,s[34]=t.y,s[35]=n.z,s[36]=t.x,s[37]=t.y,s[38]=t.z,s[39]=t.x,s[40]=n.y,s[41]=t.z,s[42]=t.x,s[43]=n.y,s[44]=n.z,s[45]=t.x,s[46]=t.y,s[47]=n.z,s[48]=t.x,s[49]=n.y,s[50]=t.z,s[51]=n.x,s[52]=n.y,s[53]=t.z,s[54]=n.x,s[55]=n.y,s[56]=n.z,s[57]=t.x,s[58]=n.y,s[59]=n.z,s[60]=t.x,s[61]=t.y,s[62]=t.z,s[63]=n.x,s[64]=t.y,s[65]=t.z,s[66]=n.x,s[67]=t.y,s[68]=n.z,s[69]=t.x,s[70]=t.y,s[71]=n.z,o.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:s})),i.normal){let l=new Float32Array(72);l[0]=0,l[1]=0,l[2]=1,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=1,l[9]=0,l[10]=0,l[11]=1,l[12]=0,l[13]=0,l[14]=-1,l[15]=0,l[16]=0,l[17]=-1,l[18]=0,l[19]=0,l[20]=-1,l[21]=0,l[22]=0,l[23]=-1,l[24]=1,l[25]=0,l[26]=0,l[27]=1,l[28]=0,l[29]=0,l[30]=1,l[31]=0,l[32]=0,l[33]=1,l[34]=0,l[35]=0,l[36]=-1,l[37]=0,l[38]=0,l[39]=-1,l[40]=0,l[41]=0,l[42]=-1,l[43]=0,l[44]=0,l[45]=-1,l[46]=0,l[47]=0,l[48]=0,l[49]=1,l[50]=0,l[51]=0,l[52]=1,l[53]=0,l[54]=0,l[55]=1,l[56]=0,l[57]=0,l[58]=1,l[59]=0,l[60]=0,l[61]=-1,l[62]=0,l[63]=0,l[64]=-1,l[65]=0,l[66]=0,l[67]=-1,l[68]=0,l[69]=0,l[70]=-1,l[71]=0,o.normal=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:l})}if(i.st){let l=new Float32Array(48);l[0]=0,l[1]=0,l[2]=1,l[3]=0,l[4]=1,l[5]=1,l[6]=0,l[7]=1,l[8]=1,l[9]=0,l[10]=0,l[11]=0,l[12]=0,l[13]=1,l[14]=1,l[15]=1,l[16]=0,l[17]=0,l[18]=1,l[19]=0,l[20]=1,l[21]=1,l[22]=0,l[23]=1,l[24]=1,l[25]=0,l[26]=0,l[27]=0,l[28]=0,l[29]=1,l[30]=1,l[31]=1,l[32]=1,l[33]=0,l[34]=0,l[35]=0,l[36]=0,l[37]=1,l[38]=1,l[39]=1,l[40]=0,l[41]=0,l[42]=1,l[43]=0,l[44]=1,l[45]=1,l[46]=0,l[47]=1,o.st=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:l})}if(i.tangent){let l=new Float32Array(72);l[0]=1,l[1]=0,l[2]=0,l[3]=1,l[4]=0,l[5]=0,l[6]=1,l[7]=0,l[8]=0,l[9]=1,l[10]=0,l[11]=0,l[12]=-1,l[13]=0,l[14]=0,l[15]=-1,l[16]=0,l[17]=0,l[18]=-1,l[19]=0,l[20]=0,l[21]=-1,l[22]=0,l[23]=0,l[24]=0,l[25]=1,l[26]=0,l[27]=0,l[28]=1,l[29]=0,l[30]=0,l[31]=1,l[32]=0,l[33]=0,l[34]=1,l[35]=0,l[36]=0,l[37]=-1,l[38]=0,l[39]=0,l[40]=-1,l[41]=0,l[42]=0,l[43]=-1,l[44]=0,l[45]=0,l[46]=-1,l[47]=0,l[48]=-1,l[49]=0,l[50]=0,l[51]=-1,l[52]=0,l[53]=0,l[54]=-1,l[55]=0,l[56]=0,l[57]=-1,l[58]=0,l[59]=0,l[60]=1,l[61]=0,l[62]=0,l[63]=1,l[64]=0,l[65]=0,l[66]=1,l[67]=0,l[68]=0,l[69]=1,l[70]=0,l[71]=0,o.tangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:l})}if(i.bitangent){let l=new Float32Array(72);l[0]=0,l[1]=1,l[2]=0,l[3]=0,l[4]=1,l[5]=0,l[6]=0,l[7]=1,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=1,l[14]=0,l[15]=0,l[16]=1,l[17]=0,l[18]=0,l[19]=1,l[20]=0,l[21]=0,l[22]=1,l[23]=0,l[24]=0,l[25]=0,l[26]=1,l[27]=0,l[28]=0,l[29]=1,l[30]=0,l[31]=0,l[32]=1,l[33]=0,l[34]=0,l[35]=1,l[36]=0,l[37]=0,l[38]=1,l[39]=0,l[40]=0,l[41]=1,l[42]=0,l[43]=0,l[44]=1,l[45]=0,l[46]=0,l[47]=1,l[48]=0,l[49]=0,l[50]=1,l[51]=0,l[52]=0,l[53]=1,l[54]=0,l[55]=0,l[56]=1,l[57]=0,l[58]=0,l[59]=1,l[60]=0,l[61]=0,l[62]=1,l[63]=0,l[64]=0,l[65]=1,l[66]=0,l[67]=0,l[68]=1,l[69]=0,l[70]=0,l[71]=1,o.bitangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:l})}r=new Uint16Array(6*2*3),r[0]=0,r[1]=1,r[2]=2,r[3]=0,r[4]=2,r[5]=3,r[6]=6,r[7]=5,r[8]=4,r[9]=7,r[10]=6,r[11]=4,r[12]=8,r[13]=9,r[14]=10,r[15]=8,r[16]=10,r[17]=11,r[18]=14,r[19]=13,r[20]=12,r[21]=15,r[22]=14,r[23]=12,r[24]=18,r[25]=17,r[26]=16,r[27]=19,r[28]=18,r[29]=16,r[30]=20,r[31]=21,r[32]=22,r[33]=20,r[34]=22,r[35]=23}else s=new Float64Array(8*3),s[0]=t.x,s[1]=t.y,s[2]=t.z,s[3]=n.x,s[4]=t.y,s[5]=t.z,s[6]=n.x,s[7]=n.y,s[8]=t.z,s[9]=t.x,s[10]=n.y,s[11]=t.z,s[12]=t.x,s[13]=t.y,s[14]=n.z,s[15]=n.x,s[16]=t.y,s[17]=n.z,s[18]=n.x,s[19]=n.y,s[20]=n.z,s[21]=t.x,s[22]=n.y,s[23]=n.z,o.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:s}),r=new Uint16Array(6*2*3),r[0]=4,r[1]=5,r[2]=6,r[3]=4,r[4]=6,r[5]=7,r[6]=1,r[7]=0,r[8]=3,r[9]=1,r[10]=3,r[11]=2,r[12]=1,r[13]=6,r[14]=5,r[15]=1,r[16]=2,r[17]=6,r[18]=2,r[19]=3,r[20]=7,r[21]=2,r[22]=7,r[23]=6,r[24]=3,r[25]=0,r[26]=4,r[27]=3,r[28]=4,r[29]=7,r[30]=0,r[31]=1,r[32]=5,r[33]=0,r[34]=5,r[35]=4;let a=h.subtract(n,t,TDe),c=h.magnitude(a)*.5;if(u(e._offsetAttribute)){let l=s.length,f=e._offsetAttribute===an.NONE?0:1,d=new Uint8Array(l/3).fill(f);o.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:d})}return new ft({attributes:o,indices:r,primitiveType:Ne.TRIANGLES,boundingSphere:new ae(h.ZERO,c),offsetAttribute:e._offsetAttribute})};var DG;ql.getUnitBox=function(){return u(DG)||(DG=ql.createGeometry(ql.fromDimensions({dimensions:new h(1,1,1),vertexFormat:Ie.POSITION_ONLY}))),DG};var Ya=ql;var eo={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4"};eo.getMathType=function(e){switch(e){case eo.SCALAR:return Number;case eo.VEC2:return H;case eo.VEC3:return h;case eo.VEC4:return oe;case eo.MAT2:return Hi;case eo.MAT3:return J;case eo.MAT4:return F}};eo.getNumberOfComponents=function(e){switch(e){case eo.SCALAR:return 1;case eo.VEC2:return 2;case eo.VEC3:return 3;case eo.VEC4:case eo.MAT2:return 4;case eo.MAT3:return 9;case eo.MAT4:return 16}};eo.getAttributeLocationCount=function(e){switch(e){case eo.SCALAR:case eo.VEC2:case eo.VEC3:case eo.VEC4:return 1;case eo.MAT2:return 2;case eo.MAT3:return 3;case eo.MAT4:return 4}};eo.getGlslType=function(e){switch(e){case eo.SCALAR:return"float";case eo.VEC2:return"vec2";case eo.VEC3:return"vec3";case eo.VEC4:return"vec4";case eo.MAT2:return"mat2";case eo.MAT3:return"mat3";case eo.MAT4:return"mat4"}};var rn=Object.freeze(eo);var FJ=1/256,BJ=256,Co={};Co.octEncodeInRange=function(e,t,n){if(n.x=e.x/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),n.y=e.y/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),e.z<0){let i=n.x,o=n.y;n.x=(1-Math.abs(o))*R.signNotZero(i),n.y=(1-Math.abs(i))*R.signNotZero(o)}return n.x=R.toSNorm(n.x,t),n.y=R.toSNorm(n.y,t),n};Co.octEncode=function(e,t){return Co.octEncodeInRange(e,255,t)};var WS=new H,kJ=new Uint8Array(1);function GP(e){return kJ[0]=e,kJ[0]}Co.octEncodeToCartesian4=function(e,t){return Co.octEncodeInRange(e,65535,WS),t.x=GP(WS.x*FJ),t.y=GP(WS.x),t.z=GP(WS.y*FJ),t.w=GP(WS.y),t};Co.octDecodeInRange=function(e,t,n,i){if(i.x=R.fromSNorm(e,n),i.y=R.fromSNorm(t,n),i.z=1-(Math.abs(i.x)+Math.abs(i.y)),i.z<0){let o=i.x;i.x=(1-Math.abs(i.y))*R.signNotZero(o),i.y=(1-Math.abs(o))*R.signNotZero(i.y)}return h.normalize(i,i)};Co.octDecode=function(e,t,n){return Co.octDecodeInRange(e,t,255,n)};Co.octDecodeFromCartesian4=function(e,t){let n=e.x,i=e.y,o=e.z,r=e.w,s=n*BJ+i,a=o*BJ+r;return Co.octDecodeInRange(s,a,65535,t)};Co.octPackFloat=function(e){return 256*e.x+e.y};var PG=new H;Co.octEncodeFloat=function(e){return Co.octEncode(e,PG),Co.octPackFloat(PG)};Co.octDecodeFloat=function(e,t){let n=e/256,i=Math.floor(n),o=(n-i)*256;return Co.octDecode(i,o,t)};Co.octPack=function(e,t,n,i){let o=Co.octEncodeFloat(e),r=Co.octEncodeFloat(t),s=Co.octEncode(n,PG);return i.x=65536*s.x+o,i.y=65536*s.y+r,i};Co.octUnpack=function(e,t,n,i){let o=e.x/65536,r=Math.floor(o),s=(o-r)*65536;o=e.y/65536;let a=Math.floor(o),c=(o-a)*65536;Co.octDecodeFloat(s,t),Co.octDecodeFloat(c,n),Co.octDecode(r,a,i)};Co.compressTextureCoordinates=function(e){let t=e.x*4095|0,n=e.y*4095|0;return 4096*t+n};Co.decompressTextureCoordinates=function(e,t){let n=e/4096,i=Math.floor(n);return t.x=i/4095,t.y=(e-i*4096)/4095,t};function IG(e){return e>>1^-(e&1)}Co.zigZagDeltaDecode=function(e,t,n){let i=e.length,o=0,r=0,s=0;for(let a=0;a<i;++a)o+=IG(e[a]),r+=IG(t[a]),e[a]=o,t[a]=r,u(n)&&(s+=IG(n[a]),n[a]=s)};Co.dequantize=function(e,t,n,i){let o=rn.getNumberOfComponents(n),r;switch(t){case K.BYTE:r=127;break;case K.UNSIGNED_BYTE:r=255;break;case K.SHORT:r=32767;break;case K.UNSIGNED_SHORT:r=65535;break;case K.INT:r=2147483647;break;case K.UNSIGNED_INT:r=4294967295;break}let s=new Float32Array(i*o);for(let a=0;a<i;a++)for(let c=0;c<o;c++){let l=a*o+c;s[l]=Math.max(e[l]/r,-1)}return s};Co.decodeRGB565=function(e,t){let n=e.length;u(t)||(t=new Float32Array(n*3));let i=31,o=63,r=1/31,s=1/63;for(let a=0;a<n;a++){let c=e[a],l=c>>11,f=c>>5&o,d=c&i,p=3*a;t[p]=l*r,t[p+1]=f*s,t[p+2]=d*r}return t};var Ln=Co;var VJ=new h,UJ=new h,zJ=new h;function EDe(e,t,n,i,o){u(o)||(o=new h);let r,s,a,c,l,f,d,p;if(u(t.z)){if(h.equalsEpsilon(e,t,R.EPSILON14))return h.clone(h.UNIT_X,o);if(h.equalsEpsilon(e,n,R.EPSILON14))return h.clone(h.UNIT_Y,o);if(h.equalsEpsilon(e,i,R.EPSILON14))return h.clone(h.UNIT_Z,o);r=h.subtract(n,t,VJ),s=h.subtract(i,t,UJ),a=h.subtract(e,t,zJ),c=h.dot(r,r),l=h.dot(r,s),f=h.dot(r,a),d=h.dot(s,s),p=h.dot(s,a)}else{if(H.equalsEpsilon(e,t,R.EPSILON14))return h.clone(h.UNIT_X,o);if(H.equalsEpsilon(e,n,R.EPSILON14))return h.clone(h.UNIT_Y,o);if(H.equalsEpsilon(e,i,R.EPSILON14))return h.clone(h.UNIT_Z,o);r=H.subtract(n,t,VJ),s=H.subtract(i,t,UJ),a=H.subtract(e,t,zJ),c=H.dot(r,r),l=H.dot(r,s),f=H.dot(r,a),d=H.dot(s,s),p=H.dot(s,a)}o.y=d*f-l*p,o.z=c*p-l*f;let g=c*d-l*l;if(g!==0)return o.y/=g,o.z/=g,o.x=1-o.y-o.z,o}var gC=EDe;function Sh(){this.high=h.clone(h.ZERO),this.low=h.clone(h.ZERO)}Sh.encode=function(e,t){u(t)||(t={high:0,low:0});let n;return e>=0?(n=Math.floor(e/65536)*65536,t.high=n,t.low=e-n):(n=Math.floor(-e/65536)*65536,t.high=-n,t.low=e+n),t};var np={high:0,low:0};Sh.fromCartesian=function(e,t){u(t)||(t=new Sh);let n=t.high,i=t.low;return Sh.encode(e.x,np),n.x=np.high,i.x=np.low,Sh.encode(e.y,np),n.y=np.high,i.y=np.low,Sh.encode(e.z,np),n.z=np.high,i.z=np.low,t};var RG=new Sh;Sh.writeElements=function(e,t,n){Sh.fromCartesian(e,RG);let i=RG.high,o=RG.low;t[n]=i.x,t[n+1]=i.y,t[n+2]=i.z,t[n+3]=o.x,t[n+4]=o.y,t[n+5]=o.z};var Gn=Sh;var OG={};OG.computeDiscriminant=function(e,t,n){return t*t-4*e*n};function HJ(e,t,n){let i=e+t;return R.sign(e)!==R.sign(t)&&Math.abs(i/Math.max(Math.abs(e),Math.abs(t)))<n?0:i}OG.computeRealRoots=function(e,t,n){let i;if(e===0)return t===0?[]:[-n/t];if(t===0){if(n===0)return[0,0];let c=Math.abs(n),l=Math.abs(e);if(c<l&&c/l<R.EPSILON14)return[0,0];if(c>l&&l/c<R.EPSILON14)return[];if(i=-n/e,i<0)return[];let f=Math.sqrt(i);return[-f,f]}else if(n===0)return i=-t/e,i<0?[i,0]:[0,i];let o=t*t,r=4*e*n,s=HJ(o,-r,R.EPSILON14);if(s<0)return[];let a=-.5*HJ(t,R.sign(t)*Math.sqrt(s),R.EPSILON14);return t>0?[a/e,n/a]:[n/a,a/e]};var ul=OG;var LG={};LG.computeDiscriminant=function(e,t,n,i){let o=e*e,r=t*t,s=n*n,a=i*i;return 18*e*t*n*i+r*s-27*o*a-4*(e*s*n+r*t*i)};function MG(e,t,n,i){let o=e,r=t/3,s=n/3,a=i,c=o*s,l=r*a,f=r*r,d=s*s,p=o*s-f,g=o*a-r*s,m=r*a-d,y=4*p*m-g*g,b,C;if(y<0){let W,j,Q;f*l>=c*d?(W=o,j=p,Q=-2*r*p+o*g):(W=a,j=m,Q=-a*g+2*s*m);let X=-(Q<0?-1:1)*Math.abs(W)*Math.sqrt(-y);C=-Q+X;let Z=C/2,fe=Z<0?-Math.pow(-Z,1/3):Math.pow(Z,1/3),xe=C===X?-fe:-j/fe;return b=j<=0?fe+xe:-Q/(fe*fe+xe*xe+j),f*l>=c*d?[(b-r)/o]:[-a/(b+s)]}let A=p,T=-2*r*p+o*g,E=m,v=-a*g+2*s*m,D=Math.sqrt(y),O=Math.sqrt(3)/2,P=Math.abs(Math.atan2(o*D,-T)/3);b=2*Math.sqrt(-A);let M=Math.cos(P);C=b*M;let L=b*(-M/2-O*Math.sin(P)),_=C+L>2*r?C-r:L-r,S=o,w=_/S;P=Math.abs(Math.atan2(a*D,-v)/3),b=2*Math.sqrt(-E),M=Math.cos(P),C=b*M,L=b*(-M/2-O*Math.sin(P));let I=-a,N=C+L<2*s?C+s:L+s,k=I/N,z=S*N,V=-_*N-S*I,U=_*I,B=(s*V-r*U)/(-r*V+s*z);return w<=B?w<=k?B<=k?[w,B,k]:[w,k,B]:[k,w,B]:w<=k?[B,w,k]:B<=k?[B,k,w]:[k,B,w]}LG.computeRealRoots=function(e,t,n,i){let o,r;if(e===0)return ul.computeRealRoots(t,n,i);if(t===0){if(n===0){if(i===0)return[0,0,0];r=-i/e;let s=r<0?-Math.pow(-r,1/3):Math.pow(r,1/3);return[s,s,s]}else if(i===0)return o=ul.computeRealRoots(e,0,n),o.Length===0?[0]:[o[0],0,o[1]];return MG(e,0,n,i)}else{if(n===0)return i===0?(r=-t/e,r<0?[r,0,0]:[0,0,r]):MG(e,t,0,i);if(i===0)return o=ul.computeRealRoots(e,t,n),o.length===0?[0]:o[1]<=0?[o[0],o[1],0]:o[0]>=0?[0,o[0],o[1]]:[o[0],0,o[1]]}return MG(e,t,n,i)};var yC=LG;var NG={};NG.computeDiscriminant=function(e,t,n,i,o){let r=e*e,s=r*e,a=t*t,c=a*t,l=n*n,f=l*n,d=i*i,p=d*i,g=o*o,m=g*o;return a*l*d-4*c*p-4*e*f*d+18*e*t*n*p-27*r*d*d+256*s*m+o*(18*c*n*i-4*a*f+16*e*l*l-80*e*t*l*i-6*e*a*d+144*r*n*d)+g*(144*e*a*n-27*a*a-128*r*l-192*r*t*i)};function cd(e,t,n,i){let o=e*e,r=t-3*o/8,s=n-t*e/2+o*e/8,a=i-n*e/4+t*o/16-3*o*o/256,c=yC.computeRealRoots(1,2*r,r*r-4*a,-s*s);if(c.length>0){let l=-e/4,f=c[c.length-1];if(Math.abs(f)<R.EPSILON14){let d=ul.computeRealRoots(1,r,a);if(d.length===2){let p=d[0],g=d[1],m;if(p>=0&&g>=0){let y=Math.sqrt(p),b=Math.sqrt(g);return[l-b,l-y,l+y,l+b]}else{if(p>=0&&g<0)return m=Math.sqrt(p),[l-m,l+m];if(p<0&&g>=0)return m=Math.sqrt(g),[l-m,l+m]}}return[]}else if(f>0){let d=Math.sqrt(f),p=(r+f-s/d)/2,g=(r+f+s/d)/2,m=ul.computeRealRoots(1,d,p),y=ul.computeRealRoots(1,-d,g);return m.length!==0?(m[0]+=l,m[1]+=l,y.length!==0?(y[0]+=l,y[1]+=l,m[1]<=y[0]?[m[0],m[1],y[0],y[1]]:y[1]<=m[0]?[y[0],y[1],m[0],m[1]]:m[0]>=y[0]&&m[1]<=y[1]?[y[0],m[0],m[1],y[1]]:y[0]>=m[0]&&y[1]<=m[1]?[m[0],y[0],y[1],m[1]]:m[0]>y[0]&&m[0]<y[1]?[y[0],m[0],y[1],m[1]]:[m[0],y[0],m[1],y[1]]):m):y.length!==0?(y[0]+=l,y[1]+=l,y):[]}}return[]}function jS(e,t,n,i){let o=n*n,r=t*t,s=e*e,a=-2*t,c=n*e+r-4*i,l=s*i-n*t*e+o,f=yC.computeRealRoots(1,a,c,l);if(f.length>0){let d=f[0],p=t-d,g=p*p,m=e/2,y=p/2,b=g-4*i,C=g+4*Math.abs(i),A=s-4*d,T=s+4*Math.abs(d),E,v;if(d<0||b*T<A*C){let S=Math.sqrt(A);E=S/2,v=S===0?0:(e*y-n)/S}else{let S=Math.sqrt(b);E=S===0?0:(e*y-n)/S,v=S/2}let D,O;m===0&&E===0?(D=0,O=0):R.sign(m)===R.sign(E)?(D=m+E,O=d/D):(O=m-E,D=d/O);let P,M;y===0&&v===0?(P=0,M=0):R.sign(y)===R.sign(v)?(P=y+v,M=i/P):(M=y-v,P=i/M);let L=ul.computeRealRoots(1,D,P),_=ul.computeRealRoots(1,O,M);if(L.length!==0)return _.length!==0?L[1]<=_[0]?[L[0],L[1],_[0],_[1]]:_[1]<=L[0]?[_[0],_[1],L[0],L[1]]:L[0]>=_[0]&&L[1]<=_[1]?[_[0],L[0],L[1],_[1]]:_[0]>=L[0]&&_[1]<=L[1]?[L[0],_[0],_[1],L[1]]:L[0]>_[0]&&L[0]<_[1]?[_[0],L[0],_[1],L[1]]:[L[0],_[0],L[1],_[1]]:L;if(_.length!==0)return _}return[]}NG.computeRealRoots=function(e,t,n,i,o){if(Math.abs(e)<R.EPSILON15)return yC.computeRealRoots(t,n,i,o);let r=t/e,s=n/e,a=i/e,c=o/e,l=r<0?1:0;switch(l+=s<0?l+1:l,l+=a<0?l+1:l,l+=c<0?l+1:l,l){case 0:return cd(r,s,a,c);case 1:return jS(r,s,a,c);case 2:return jS(r,s,a,c);case 3:return cd(r,s,a,c);case 4:return cd(r,s,a,c);case 5:return jS(r,s,a,c);case 6:return cd(r,s,a,c);case 7:return cd(r,s,a,c);case 8:return jS(r,s,a,c);case 9:return cd(r,s,a,c);case 10:return cd(r,s,a,c);case 11:return jS(r,s,a,c);case 12:return cd(r,s,a,c);case 13:return cd(r,s,a,c);case 14:return cd(r,s,a,c);case 15:return cd(r,s,a,c);default:return}};var WP=NG;function jP(e,t){t=h.clone(x(t,h.ZERO)),h.equals(t,h.ZERO)||h.normalize(t,t),this.origin=h.clone(x(e,h.ZERO)),this.direction=t}jP.clone=function(e,t){if(u(e))return u(t)?(t.origin=h.clone(e.origin),t.direction=h.clone(e.direction),t):new jP(e.origin,e.direction)};jP.getPoint=function(e,t,n){return u(n)||(n=new h),n=h.multiplyByScalar(e.direction,t,n),h.add(e.origin,n,n)};var _n=jP;var Fo={};Fo.rayPlane=function(e,t,n){u(n)||(n=new h);let i=e.origin,o=e.direction,r=t.normal,s=h.dot(r,o);if(Math.abs(s)<R.EPSILON15)return;let a=(-t.distance-h.dot(r,i))/s;if(!(a<0))return n=h.multiplyByScalar(o,a,n),h.add(i,n,n)};var SDe=new h,vDe=new h,ZJ=new h,GJ=new h,WJ=new h;Fo.rayTriangleParametric=function(e,t,n,i,o){o=x(o,!1);let r=e.origin,s=e.direction,a=h.subtract(n,t,SDe),c=h.subtract(i,t,vDe),l=h.cross(s,c,ZJ),f=h.dot(a,l),d,p,g,m,y;if(o){if(f<R.EPSILON6||(d=h.subtract(r,t,GJ),g=h.dot(d,l),g<0||g>f)||(p=h.cross(d,a,WJ),m=h.dot(s,p),m<0||g+m>f))return;y=h.dot(c,p)/f}else{if(Math.abs(f)<R.EPSILON6)return;let b=1/f;if(d=h.subtract(r,t,GJ),g=h.dot(d,l)*b,g<0||g>1||(p=h.cross(d,a,WJ),m=h.dot(s,p)*b,m<0||g+m>1))return;y=h.dot(c,p)*b}return y};Fo.rayTriangle=function(e,t,n,i,o,r){let s=Fo.rayTriangleParametric(e,t,n,i,o);if(!(!u(s)||s<0))return u(r)||(r=new h),h.multiplyByScalar(e.direction,s,r),h.add(e.origin,r,r)};var wDe=new _n;Fo.lineSegmentTriangle=function(e,t,n,i,o,r,s){let a=wDe;h.clone(e,a.origin),h.subtract(t,e,a.direction),h.normalize(a.direction,a.direction);let c=Fo.rayTriangleParametric(a,n,i,o,r);if(!(!u(c)||c<0||c>h.distance(e,t)))return u(s)||(s=new h),h.multiplyByScalar(a.direction,c,s),h.add(a.origin,s,s)};function DDe(e,t,n,i){let o=t*t-4*e*n;if(o<0)return;if(o>0){let s=1/(2*e),a=Math.sqrt(o),c=(-t+a)*s,l=(-t-a)*s;return c<l?(i.root0=c,i.root1=l):(i.root0=l,i.root1=c),i}let r=-t/(2*e);if(r!==0)return i.root0=i.root1=r,i}var IDe={root0:0,root1:0};function $J(e,t,n){u(n)||(n=new qa);let i=e.origin,o=e.direction,r=t.center,s=t.radius*t.radius,a=h.subtract(i,r,ZJ),c=h.dot(o,o),l=2*h.dot(o,a),f=h.magnitudeSquared(a)-s,d=DDe(c,l,f,IDe);if(u(d))return n.start=d.root0,n.stop=d.root1,n}Fo.raySphere=function(e,t,n){if(n=$J(e,t,n),!(!u(n)||n.stop<0))return n.start=Math.max(n.start,0),n};var PDe=new _n;Fo.lineSegmentSphere=function(e,t,n,i){let o=PDe;h.clone(e,o.origin);let r=h.subtract(t,e,o.direction),s=h.magnitude(r);if(h.normalize(r,r),i=$J(o,n,i),!(!u(i)||i.stop<0||i.start>s))return i.start=Math.max(i.start,0),i.stop=Math.min(i.stop,s),i};var RDe=new h,ODe=new h;Fo.rayEllipsoid=function(e,t){let n=t.oneOverRadii,i=h.multiplyComponents(n,e.origin,RDe),o=h.multiplyComponents(n,e.direction,ODe),r=h.magnitudeSquared(i),s=h.dot(i,o),a,c,l,f,d;if(r>1){if(s>=0)return;let p=s*s;if(a=r-1,c=h.magnitudeSquared(o),l=c*a,p<l)return;if(p>l){f=s*s-l,d=-s+Math.sqrt(f);let m=d/c,y=a/d;return m<y?new qa(m,y):{start:y,stop:m}}let g=Math.sqrt(a/c);return new qa(g,g)}else if(r<1)return a=r-1,c=h.magnitudeSquared(o),l=c*a,f=s*s-l,d=-s+Math.sqrt(f),new qa(0,d/c);if(s<0)return c=h.magnitudeSquared(o),new qa(0,-s/c)};function Dy(e,t,n){let i=e+t;return R.sign(e)!==R.sign(t)&&Math.abs(i/Math.max(Math.abs(e),Math.abs(t)))<n?0:i}Fo.quadraticVectorExpression=function(e,t,n,i,o){let r=i*i,s=o*o,a=(e[J.COLUMN1ROW1]-e[J.COLUMN2ROW2])*s,c=o*(i*Dy(e[J.COLUMN1ROW0],e[J.COLUMN0ROW1],R.EPSILON15)+t.y),l=e[J.COLUMN0ROW0]*r+e[J.COLUMN2ROW2]*s+i*t.x+n,f=s*Dy(e[J.COLUMN2ROW1],e[J.COLUMN1ROW2],R.EPSILON15),d=o*(i*Dy(e[J.COLUMN2ROW0],e[J.COLUMN0ROW2])+t.z),p,g=[];if(d===0&&f===0){if(p=ul.computeRealRoots(a,c,l),p.length===0)return g;let P=p[0],M=Math.sqrt(Math.max(1-P*P,0));if(g.push(new h(i,o*P,o*-M)),g.push(new h(i,o*P,o*M)),p.length===2){let L=p[1],_=Math.sqrt(Math.max(1-L*L,0));g.push(new h(i,o*L,o*-_)),g.push(new h(i,o*L,o*_))}return g}let m=d*d,y=f*f,b=a*a,C=d*f,A=b+y,T=2*(c*a+C),E=2*l*a+c*c-y+m,v=2*(l*c-C),D=l*l-m;if(A===0&&T===0&&E===0&&v===0)return g;p=WP.computeRealRoots(A,T,E,v,D);let O=p.length;if(O===0)return g;for(let P=0;P<O;++P){let M=p[P],L=M*M,_=Math.max(1-L,0),S=Math.sqrt(_),w;R.sign(a)===R.sign(l)?w=Dy(a*L+l,c*M,R.EPSILON12):R.sign(l)===R.sign(c*M)?w=Dy(a*L,c*M+l,R.EPSILON12):w=Dy(a*L+c*M,l,R.EPSILON12);let I=Dy(f*M,d,R.EPSILON15),N=w*I;N<0?g.push(new h(i,o*M,o*S)):N>0?g.push(new h(i,o*M,o*-S)):S!==0?(g.push(new h(i,o*M,o*-S)),g.push(new h(i,o*M,o*S)),++P):g.push(new h(i,o*M,o*S))}return g};var FG=new h,jJ=new h,qJ=new h,qP=new h,MDe=new h,LDe=new J,NDe=new J,FDe=new J,BDe=new J,kDe=new J,YJ=new J,XJ=new J,KJ=new h,VDe=new h,UDe=new de;Fo.grazingAltitudeLocation=function(e,t){let n=e.origin,i=e.direction;if(!h.equals(n,h.ZERO)){let D=t.geodeticSurfaceNormal(n,FG);if(h.dot(i,D)>=0)return n}let o=u(this.rayEllipsoid(e,t)),r=t.transformPositionToScaledSpace(i,FG),s=h.normalize(r,r),a=h.mostOrthogonalAxis(r,qP),c=h.normalize(h.cross(a,s,jJ),jJ),l=h.normalize(h.cross(s,c,qJ),qJ),f=LDe;f[0]=s.x,f[1]=s.y,f[2]=s.z,f[3]=c.x,f[4]=c.y,f[5]=c.z,f[6]=l.x,f[7]=l.y,f[8]=l.z;let d=J.transpose(f,NDe),p=J.fromScale(t.radii,FDe),g=J.fromScale(t.oneOverRadii,BDe),m=kDe;m[0]=0,m[1]=-i.z,m[2]=i.y,m[3]=i.z,m[4]=0,m[5]=-i.x,m[6]=-i.y,m[7]=i.x,m[8]=0;let y=J.multiply(J.multiply(d,g,YJ),m,YJ),b=J.multiply(J.multiply(y,p,XJ),f,XJ),C=J.multiplyByVector(y,n,MDe),A=Fo.quadraticVectorExpression(b,h.negate(C,FG),0,0,1),T,E,v=A.length;if(v>0){let D=h.clone(h.ZERO,VDe),O=Number.NEGATIVE_INFINITY;for(let M=0;M<v;++M){T=J.multiplyByVector(p,J.multiplyByVector(f,A[M],KJ),KJ);let L=h.normalize(h.subtract(T,n,qP),qP),_=h.dot(L,i);_>O&&(O=_,D=h.clone(T,D))}let P=t.cartesianToCartographic(D,UDe);return O=R.clamp(O,0,1),E=h.magnitude(h.subtract(D,n,qP))*Math.sqrt(1-O*O),E=o?-E:E,P.height=E,t.cartographicToCartesian(P,new h)}};var zDe=new h;Fo.lineSegmentPlane=function(e,t,n,i){u(i)||(i=new h);let o=h.subtract(t,e,zDe),r=n.normal,s=h.dot(r,o);if(Math.abs(s)<R.EPSILON6)return;let a=h.dot(r,e),c=-(n.distance+a)/s;if(!(c<0||c>1))return h.multiplyByScalar(o,c,i),h.add(e,i,i),i};Fo.trianglePlaneIntersection=function(e,t,n,i){let o=i.normal,r=i.distance,s=h.dot(o,e)+r<0,a=h.dot(o,t)+r<0,c=h.dot(o,n)+r<0,l=0;l+=s?1:0,l+=a?1:0,l+=c?1:0;let f,d;if((l===1||l===2)&&(f=new h,d=new h),l===1){if(s)return Fo.lineSegmentPlane(e,t,i,f),Fo.lineSegmentPlane(e,n,i,d),{positions:[e,t,n,f,d],indices:[0,3,4,1,2,4,1,4,3]};if(a)return Fo.lineSegmentPlane(t,n,i,f),Fo.lineSegmentPlane(t,e,i,d),{positions:[e,t,n,f,d],indices:[1,3,4,2,0,4,2,4,3]};if(c)return Fo.lineSegmentPlane(n,e,i,f),Fo.lineSegmentPlane(n,t,i,d),{positions:[e,t,n,f,d],indices:[2,3,4,0,1,4,0,4,3]}}else if(l===2)if(s)if(a){if(!c)return Fo.lineSegmentPlane(e,n,i,f),Fo.lineSegmentPlane(t,n,i,d),{positions:[e,t,n,f,d],indices:[0,1,4,0,4,3,2,3,4]}}else return Fo.lineSegmentPlane(n,t,i,f),Fo.lineSegmentPlane(e,t,i,d),{positions:[e,t,n,f,d],indices:[2,0,4,2,4,3,1,3,4]};else return Fo.lineSegmentPlane(t,e,i,f),Fo.lineSegmentPlane(n,e,i,d),{positions:[e,t,n,f,d],indices:[1,2,4,1,4,3,0,3,4]}};var Qn=Fo;function Ms(e,t){this.normal=h.clone(e),this.distance=t}Ms.fromPointNormal=function(e,t,n){let i=-h.dot(t,e);return u(n)?(h.clone(t,n.normal),n.distance=i,n):new Ms(t,i)};var HDe=new h;Ms.fromCartesian4=function(e,t){let n=h.fromCartesian4(e,HDe),i=e.w;return u(t)?(h.clone(n,t.normal),t.distance=i,t):new Ms(n,i)};Ms.getPointDistance=function(e,t){return h.dot(e.normal,t)+e.distance};var GDe=new h;Ms.projectPointOntoPlane=function(e,t,n){u(n)||(n=new h);let i=Ms.getPointDistance(e,t),o=h.multiplyByScalar(e.normal,i,GDe);return h.subtract(t,o,n)};var WDe=new F,jDe=new oe,qDe=new h;Ms.transform=function(e,t,n){let i=e.normal,o=e.distance,r=F.inverseTranspose(t,WDe),s=oe.fromElements(i.x,i.y,i.z,o,jDe);s=F.multiplyByVector(r,s,s);let a=h.fromCartesian4(s,qDe);return s=oe.divideByScalar(s,h.magnitude(a),s),Ms.fromCartesian4(s,n)};Ms.clone=function(e,t){return u(t)?(h.clone(e.normal,t.normal),t.distance=e.distance,t):new Ms(e.normal,e.distance)};Ms.equals=function(e,t){return e.distance===t.distance&&h.equals(e.normal,t.normal)};Ms.ORIGIN_XY_PLANE=Object.freeze(new Ms(h.UNIT_Z,0));Ms.ORIGIN_YZ_PLANE=Object.freeze(new Ms(h.UNIT_X,0));Ms.ORIGIN_ZX_PLANE=Object.freeze(new Ms(h.UNIT_Y,0));var cn=Ms;var BG={};BG.calculateACMR=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.indices,n=e.maximumIndex,i=x(e.cacheSize,24),o=t.length;if(!u(n)){n=0;let a=0,c=t[a];for(;a<o;)c>n&&(n=c),++a,c=t[a]}let r=[];for(let a=0;a<n+1;a++)r[a]=0;let s=i+1;for(let a=0;a<o;++a)s-r[t[a]]>i&&(r[t[a]]=s,++s);return(s-i+1)/(o/3)};BG.tipsify=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.indices,n=e.maximumIndex,i=x(e.cacheSize,24),o;function r(_,S,w,I){for(;S.length>=1;){let N=S[S.length-1];if(S.splice(S.length-1,1),_[N].numLiveTriangles>0)return N}for(;o<I;){if(_[o].numLiveTriangles>0)return++o,o-1;++o}return-1}function s(_,S,w,I,N,k,z){let V=-1,U,B=-1,W=0;for(;W<w.length;){let j=w[W];I[j].numLiveTriangles&&(U=0,N-I[j].timeStamp+2*I[j].numLiveTriangles<=S&&(U=N-I[j].timeStamp),(U>B||B===-1)&&(B=U,V=j)),++W}return V===-1?r(I,k,_,z):V}let a=t.length,c=0,l=0,f=t[l],d=a;if(u(n))c=n+1;else{for(;l<d;)f>c&&(c=f),++l,f=t[l];if(c===-1)return 0;++c}let p=[],g;for(g=0;g<c;g++)p[g]={numLiveTriangles:0,timeStamp:0,vertexTriangles:[]};l=0;let m=0;for(;l<d;)p[t[l]].vertexTriangles.push(m),++p[t[l]].numLiveTriangles,p[t[l+1]].vertexTriangles.push(m),++p[t[l+1]].numLiveTriangles,p[t[l+2]].vertexTriangles.push(m),++p[t[l+2]].numLiveTriangles,++m,l+=3;let y=0,b=i+1;o=1;let C=[],A=[],T,E,v=0,D=[],O=a/3,P=[];for(g=0;g<O;g++)P[g]=!1;let M,L;for(;y!==-1;){C=[],E=p[y],L=E.vertexTriangles.length;for(let _=0;_<L;++_)if(m=E.vertexTriangles[_],!P[m]){P[m]=!0,l=m+m+m;for(let S=0;S<3;++S)M=t[l],C.push(M),A.push(M),D[v]=M,++v,T=p[M],--T.numLiveTriangles,b-T.timeStamp>i&&(T.timeStamp=b,++b),++l}y=s(t,i,C,p,b,A,c)}return D};var YP=BG;var Ac={};function eR(e,t,n,i,o){e[t++]=n,e[t++]=i,e[t++]=i,e[t++]=o,e[t++]=o,e[t]=n}function YDe(e){let t=e.length,n=t/3*6,i=Be.createTypedArray(t,n),o=0;for(let r=0;r<t;r+=3,o+=6)eR(i,o,e[r],e[r+1],e[r+2]);return i}function XDe(e){let t=e.length;if(t>=3){let n=(t-2)*6,i=Be.createTypedArray(t,n);eR(i,0,e[0],e[1],e[2]);let o=6;for(let r=3;r<t;++r,o+=6)eR(i,o,e[r-1],e[r],e[r-2]);return i}return new Uint16Array}function KDe(e){if(e.length>0){let t=e.length-1,n=(t-1)*6,i=Be.createTypedArray(t,n),o=e[0],r=0;for(let s=1;s<t;++s,r+=6)eR(i,r,o,e[s],e[s+1]);return i}return new Uint16Array}Ac.toWireframe=function(e){let t=e.indices;if(u(t)){switch(e.primitiveType){case Ne.TRIANGLES:e.indices=YDe(t);break;case Ne.TRIANGLE_STRIP:e.indices=XDe(t);break;case Ne.TRIANGLE_FAN:e.indices=KDe(t);break}e.primitiveType=Ne.LINES}return e};Ac.createLineSegmentsForVectors=function(e,t,n){t=x(t,"normal"),n=x(n,1e4);let i=e.attributes.position.values,o=e.attributes[t].values,r=i.length,s=new Float64Array(2*r),a=0;for(let f=0;f<r;f+=3)s[a++]=i[f],s[a++]=i[f+1],s[a++]=i[f+2],s[a++]=i[f]+o[f]*n,s[a++]=i[f+1]+o[f+1]*n,s[a++]=i[f+2]+o[f+2]*n;let c,l=e.boundingSphere;return u(l)&&(c=new ae(l.center,l.radius+n)),new ft({attributes:{position:new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:s})},primitiveType:Ne.LINES,boundingSphere:c})};Ac.createAttributeLocations=function(e){let t=["position","positionHigh","positionLow","position3DHigh","position3DLow","position2DHigh","position2DLow","pickColor","normal","st","tangent","bitangent","extrudeDirection","compressedAttributes"],n=e.attributes,i={},o=0,r,s=t.length;for(r=0;r<s;++r){let a=t[r];u(n[a])&&(i[a]=o++)}for(let a in n)n.hasOwnProperty(a)&&!u(i[a])&&(i[a]=o++);return i};Ac.reorderForPreVertexCache=function(e){let t=ft.computeNumberOfVertices(e),n=e.indices;if(u(n)){let i=new Int32Array(t);for(let p=0;p<t;p++)i[p]=-1;let o=n,r=o.length,s=Be.createTypedArray(t,r),a=0,c=0,l=0,f;for(;a<r;)f=i[o[a]],f!==-1?s[c]=f:(f=o[a],i[f]=l,s[c]=l,++l),++a,++c;e.indices=s;let d=e.attributes;for(let p in d)if(d.hasOwnProperty(p)&&u(d[p])&&u(d[p].values)){let g=d[p],m=g.values,y=0,b=g.componentsPerAttribute,C=K.createTypedArray(g.componentDatatype,l*b);for(;y<t;){let A=i[y];if(A!==-1)for(let T=0;T<b;T++)C[b*A+T]=m[b*y+T];++y}g.values=C}}return e};Ac.reorderForPostVertexCache=function(e,t){let n=e.indices;if(e.primitiveType===Ne.TRIANGLES&&u(n)){let i=n.length,o=0;for(let r=0;r<i;r++)n[r]>o&&(o=n[r]);e.indices=YP.tipsify({indices:n,maximumIndex:o,cacheSize:t})}return e};function QJ(e){let t={};for(let n in e)if(e.hasOwnProperty(n)&&u(e[n])&&u(e[n].values)){let i=e[n];t[n]=new ve({componentDatatype:i.componentDatatype,componentsPerAttribute:i.componentsPerAttribute,normalize:i.normalize,values:[]})}return t}function ZDe(e,t,n){for(let i in t)if(t.hasOwnProperty(i)&&u(t[i])&&u(t[i].values)){let o=t[i];for(let r=0;r<o.componentsPerAttribute;++r)e[i].values.push(o.values[n*o.componentsPerAttribute+r])}}Ac.fitToUnsignedShortIndices=function(e){let t=[],n=ft.computeNumberOfVertices(e);if(u(e.indices)&&n>=R.SIXTY_FOUR_KILOBYTES){let i=[],o=[],r=0,s=QJ(e.attributes),a=e.indices,c=a.length,l;e.primitiveType===Ne.TRIANGLES?l=3:e.primitiveType===Ne.LINES?l=2:e.primitiveType===Ne.POINTS&&(l=1);for(let f=0;f<c;f+=l){for(let d=0;d<l;++d){let p=a[f+d],g=i[p];u(g)||(g=r++,i[p]=g,ZDe(s,e.attributes,p)),o.push(g)}r+l>=R.SIXTY_FOUR_KILOBYTES&&(t.push(new ft({attributes:s,indices:o,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV})),i=[],o=[],r=0,s=QJ(e.attributes))}o.length!==0&&t.push(new ft({attributes:s,indices:o,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}))}else t.push(e);return t};var JJ=new h,$De=new de;Ac.projectTo2D=function(e,t,n,i,o){let r=e.attributes[t];o=u(o)?o:new Oi;let s=o.ellipsoid,a=r.values,c=new Float64Array(a.length),l=0;for(let f=0;f<a.length;f+=3){let d=h.fromArray(a,f,JJ),p=s.cartesianToCartographic(d,$De),g=o.project(p,JJ);c[l++]=g.x,c[l++]=g.y,c[l++]=g.z}return e.attributes[n]=r,e.attributes[i]=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:c}),delete e.attributes[t],e};var kG={high:0,low:0};Ac.encodeAttribute=function(e,t,n,i){let o=e.attributes[t],r=o.values,s=r.length,a=new Float32Array(s),c=new Float32Array(s);for(let f=0;f<s;++f)Gn.encode(r[f],kG),a[f]=kG.high,c[f]=kG.low;let l=o.componentsPerAttribute;return e.attributes[n]=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:l,values:a}),e.attributes[i]=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:l,values:c}),delete e.attributes[t],e};var ud=new h;function VG(e,t){if(u(t)){let n=t.values,i=n.length;for(let o=0;o<i;o+=3)h.unpack(n,o,ud),F.multiplyByPoint(e,ud,ud),h.pack(ud,n,o)}}function UG(e,t){if(u(t)){let n=t.values,i=n.length;for(let o=0;o<i;o+=3)h.unpack(n,o,ud),J.multiplyByVector(e,ud,ud),ud=h.normalize(ud,ud),h.pack(ud,n,o)}}var XP=new F,KP=new J;Ac.transformToWorldCoordinates=function(e){let t=e.modelMatrix;if(F.equals(t,F.IDENTITY))return e;let n=e.geometry.attributes;VG(t,n.position),VG(t,n.prevPosition),VG(t,n.nextPosition),(u(n.normal)||u(n.tangent)||u(n.bitangent))&&(F.inverse(t,XP),F.transpose(XP,XP),F.getMatrix3(XP,KP),UG(KP,n.normal),UG(KP,n.tangent),UG(KP,n.bitangent));let i=e.geometry.boundingSphere;return u(i)&&(e.geometry.boundingSphere=ae.transform(i,t,i)),e.modelMatrix=F.clone(F.IDENTITY),e};function QDe(e,t){let n=e.length,i={},o=e[0][t].attributes,r;for(r in o)if(o.hasOwnProperty(r)&&u(o[r])&&u(o[r].values)){let s=o[r],a=s.values.length,c=!0;for(let l=1;l<n;++l){let f=e[l][t].attributes[r];if(!u(f)||s.componentDatatype!==f.componentDatatype||s.componentsPerAttribute!==f.componentsPerAttribute||s.normalize!==f.normalize){c=!1;break}a+=f.values.length}c&&(i[r]=new ve({componentDatatype:s.componentDatatype,componentsPerAttribute:s.componentsPerAttribute,normalize:s.normalize,values:K.createTypedArray(s.componentDatatype,a)}))}return i}var JDe=new h;function zG(e,t){let n=e.length,i,o,r,s,a=e[0].modelMatrix,c=u(e[0][t].indices),l=e[0][t].primitiveType,f=QDe(e,t),d,p,g;for(i in f)if(f.hasOwnProperty(i))for(d=f[i].values,s=0,o=0;o<n;++o)for(p=e[o][t].attributes[i].values,g=p.length,r=0;r<g;++r)d[s++]=p[r];let m;if(c){let A=0;for(o=0;o<n;++o)A+=e[o][t].indices.length;let T=ft.computeNumberOfVertices(new ft({attributes:f,primitiveType:Ne.POINTS})),E=Be.createTypedArray(T,A),v=0,D=0;for(o=0;o<n;++o){let O=e[o][t].indices,P=O.length;for(s=0;s<P;++s)E[v++]=D+O[s];D+=ft.computeNumberOfVertices(e[o][t])}m=E}let y=new h,b=0,C;for(o=0;o<n;++o){if(C=e[o][t].boundingSphere,!u(C)){y=void 0;break}h.add(C.center,y,y)}if(u(y))for(h.divideByScalar(y,n,y),o=0;o<n;++o){C=e[o][t].boundingSphere;let A=h.magnitude(h.subtract(C.center,y,JDe))+C.radius;A>b&&(b=A)}return new ft({attributes:f,indices:m,primitiveType:l,boundingSphere:u(y)?new ae(y,b):void 0})}Ac.combineInstances=function(e){let t=[],n=[],i=e.length;for(let r=0;r<i;++r){let s=e[r];u(s.geometry)?t.push(s):u(s.westHemisphereGeometry)&&u(s.eastHemisphereGeometry)&&n.push(s)}let o=[];return t.length>0&&o.push(zG(t,"geometry")),n.length>0&&(o.push(zG(n,"westHemisphereGeometry")),o.push(zG(n,"eastHemisphereGeometry"))),o};var Ku=new h,qS=new h,xC=new h,bC=new h;Ac.computeNormal=function(e){let t=e.indices,n=e.attributes,i=n.position.values,o=n.position.values.length/3,r=t.length,s=new Array(o),a=new Array(r/3),c=new Array(r),l;for(l=0;l<o;l++)s[l]={indexOffset:0,count:0,currentCount:0};let f=0;for(l=0;l<r;l+=3){let m=t[l],y=t[l+1],b=t[l+2],C=m*3,A=y*3,T=b*3;qS.x=i[C],qS.y=i[C+1],qS.z=i[C+2],xC.x=i[A],xC.y=i[A+1],xC.z=i[A+2],bC.x=i[T],bC.y=i[T+1],bC.z=i[T+2],s[m].count++,s[y].count++,s[b].count++,h.subtract(xC,qS,xC),h.subtract(bC,qS,bC),a[f]=h.cross(xC,bC,new h),f++}let d=0;for(l=0;l<o;l++)s[l].indexOffset+=d,d+=s[l].count;f=0;let p;for(l=0;l<r;l+=3){p=s[t[l]];let m=p.indexOffset+p.currentCount;c[m]=f,p.currentCount++,p=s[t[l+1]],m=p.indexOffset+p.currentCount,c[m]=f,p.currentCount++,p=s[t[l+2]],m=p.indexOffset+p.currentCount,c[m]=f,p.currentCount++,f++}let g=new Float32Array(o*3);for(l=0;l<o;l++){let m=l*3;if(p=s[l],h.clone(h.ZERO,Ku),p.count>0){for(f=0;f<p.count;f++)h.add(Ku,a[c[p.indexOffset+f]],Ku);h.equalsEpsilon(h.ZERO,Ku,R.EPSILON10)&&h.clone(a[c[p.indexOffset]],Ku)}h.equalsEpsilon(h.ZERO,Ku,R.EPSILON10)&&(Ku.z=1),h.normalize(Ku,Ku),g[m]=Ku.x,g[m+1]=Ku.y,g[m+2]=Ku.z}return e.attributes.normal=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:g}),e};var eIe=new h,eee=new h,tIe=new h;Ac.computeTangentAndBitangent=function(e){let t=e.attributes,n=e.indices,i=e.attributes.position.values,o=e.attributes.normal.values,r=e.attributes.st.values,s=e.attributes.position.values.length/3,a=n.length,c=new Array(s*3),l;for(l=0;l<c.length;l++)c[l]=0;let f,d,p;for(l=0;l<a;l+=3){let y=n[l],b=n[l+1],C=n[l+2];f=y*3,d=b*3,p=C*3;let A=y*2,T=b*2,E=C*2,v=i[f],D=i[f+1],O=i[f+2],P=r[A],M=r[A+1],L=r[T+1]-M,_=r[E+1]-M,S=1/((r[T]-P)*_-(r[E]-P)*L),w=(_*(i[d]-v)-L*(i[p]-v))*S,I=(_*(i[d+1]-D)-L*(i[p+1]-D))*S,N=(_*(i[d+2]-O)-L*(i[p+2]-O))*S;c[f]+=w,c[f+1]+=I,c[f+2]+=N,c[d]+=w,c[d+1]+=I,c[d+2]+=N,c[p]+=w,c[p+1]+=I,c[p+2]+=N}let g=new Float32Array(s*3),m=new Float32Array(s*3);for(l=0;l<s;l++){f=l*3,d=f+1,p=f+2;let y=h.fromArray(o,f,eIe),b=h.fromArray(c,f,tIe),C=h.dot(y,b);h.multiplyByScalar(y,C,eee),h.normalize(h.subtract(b,eee,b),b),g[f]=b.x,g[d]=b.y,g[p]=b.z,h.normalize(h.cross(y,b,b),b),m[f]=b.x,m[d]=b.y,m[p]=b.z}return e.attributes.tangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:g}),e.attributes.bitangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:m}),e};var YS=new H,ld=new h,tee=new h,nee=new h,ZP=new H;Ac.compressVertices=function(e){let t=e.attributes.extrudeDirection,n,i;if(u(t)){let D=t.values;i=D.length/3;let O=new Float32Array(i*2),P=0;for(n=0;n<i;++n){if(h.fromArray(D,n*3,ld),h.equals(ld,h.ZERO)){P+=2;continue}ZP=Ln.octEncodeInRange(ld,65535,ZP),O[P++]=ZP.x,O[P++]=ZP.y}return e.attributes.compressedAttributes=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:O}),delete e.attributes.extrudeDirection,e}let o=e.attributes.normal,r=e.attributes.st,s=u(o),a=u(r);if(!s&&!a)return e;let c=e.attributes.tangent,l=e.attributes.bitangent,f=u(c),d=u(l),p,g,m,y;s&&(p=o.values),a&&(g=r.values),f&&(m=c.values),d&&(y=l.values),i=(s?p.length:g.length)/(s?3:2);let A=i,T=a&&s?2:1;T+=f||d?1:0,A*=T;let E=new Float32Array(A),v=0;for(n=0;n<i;++n){a&&(H.fromArray(g,n*2,YS),E[v++]=Ln.compressTextureCoordinates(YS));let D=n*3;s&&u(m)&&u(y)?(h.fromArray(p,D,ld),h.fromArray(m,D,tee),h.fromArray(y,D,nee),Ln.octPack(ld,tee,nee,YS),E[v++]=YS.x,E[v++]=YS.y):(s&&(h.fromArray(p,D,ld),E[v++]=Ln.octEncodeFloat(ld)),f&&(h.fromArray(m,D,ld),E[v++]=Ln.octEncodeFloat(ld)),d&&(h.fromArray(y,D,ld),E[v++]=Ln.octEncodeFloat(ld)))}return e.attributes.compressedAttributes=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:T,values:E}),s&&delete e.attributes.normal,a&&delete e.attributes.st,d&&delete e.attributes.bitangent,f&&delete e.attributes.tangent,e};function nIe(e){if(u(e.indices))return e;let t=ft.computeNumberOfVertices(e),n=Be.createTypedArray(t,t);for(let i=0;i<t;++i)n[i]=i;return e.indices=n,e}function iIe(e){let t=ft.computeNumberOfVertices(e),n=Be.createTypedArray(t,(t-2)*3);n[0]=1,n[1]=0,n[2]=2;let i=3;for(let o=3;o<t;++o)n[i++]=o-1,n[i++]=0,n[i++]=o;return e.indices=n,e.primitiveType=Ne.TRIANGLES,e}function oIe(e){let t=ft.computeNumberOfVertices(e),n=Be.createTypedArray(t,(t-2)*3);n[0]=0,n[1]=1,n[2]=2,t>3&&(n[3]=0,n[4]=2,n[5]=3);let i=6;for(let o=3;o<t-1;o+=2)n[i++]=o,n[i++]=o-1,n[i++]=o+1,o+2<t&&(n[i++]=o,n[i++]=o+1,n[i++]=o+2);return e.indices=n,e.primitiveType=Ne.TRIANGLES,e}function rIe(e){if(u(e.indices))return e;let t=ft.computeNumberOfVertices(e),n=Be.createTypedArray(t,t);for(let i=0;i<t;++i)n[i]=i;return e.indices=n,e}function sIe(e){let t=ft.computeNumberOfVertices(e),n=Be.createTypedArray(t,(t-1)*2);n[0]=0,n[1]=1;let i=2;for(let o=2;o<t;++o)n[i++]=o-1,n[i++]=o;return e.indices=n,e.primitiveType=Ne.LINES,e}function aIe(e){let t=ft.computeNumberOfVertices(e),n=Be.createTypedArray(t,t*2);n[0]=0,n[1]=1;let i=2;for(let o=2;o<t;++o)n[i++]=o-1,n[i++]=o;return n[i++]=t-1,n[i]=0,e.indices=n,e.primitiveType=Ne.LINES,e}function cIe(e){switch(e.primitiveType){case Ne.TRIANGLE_FAN:return iIe(e);case Ne.TRIANGLE_STRIP:return oIe(e);case Ne.TRIANGLES:return nIe(e);case Ne.LINE_STRIP:return sIe(e);case Ne.LINE_LOOP:return aIe(e);case Ne.LINES:return rIe(e)}return e}function k_(e,t){Math.abs(e.y)<R.EPSILON6&&(t?e.y=-R.EPSILON6:e.y=R.EPSILON6)}function lIe(e,t,n){if(e.y!==0&&t.y!==0&&n.y!==0){k_(e,e.y<0),k_(t,t.y<0),k_(n,n.y<0);return}let i=Math.abs(e.y),o=Math.abs(t.y),r=Math.abs(n.y),s;i>o?i>r?s=R.sign(e.y):s=R.sign(n.y):o>r?s=R.sign(t.y):s=R.sign(n.y);let a=s<0;k_(e,a),k_(t,a),k_(n,a)}var iee=new h;function Zu(e,t,n,i){h.add(e,h.multiplyByScalar(h.subtract(t,e,iee),e.y/(e.y-t.y),iee),n),h.clone(n,i),k_(n,!0),k_(i,!1)}var Iy=new h,Py=new h,Ry=new h,Oy=new h,HG={positions:new Array(7),indices:new Array(3*3)};function uIe(e,t,n){if(e.x>=0||t.x>=0||n.x>=0)return;lIe(e,t,n);let i=e.y<0,o=t.y<0,r=n.y<0,s=0;s+=i?1:0,s+=o?1:0,s+=r?1:0;let a=HG.indices;s===1?(a[1]=3,a[2]=4,a[5]=6,a[7]=6,a[8]=5,i?(Zu(e,t,Iy,Ry),Zu(e,n,Py,Oy),a[0]=0,a[3]=1,a[4]=2,a[6]=1):o?(Zu(t,n,Iy,Ry),Zu(t,e,Py,Oy),a[0]=1,a[3]=2,a[4]=0,a[6]=2):r&&(Zu(n,e,Iy,Ry),Zu(n,t,Py,Oy),a[0]=2,a[3]=0,a[4]=1,a[6]=0)):s===2&&(a[2]=4,a[4]=4,a[5]=3,a[7]=5,a[8]=6,i?o?r||(Zu(n,e,Iy,Ry),Zu(n,t,Py,Oy),a[0]=0,a[1]=1,a[3]=0,a[6]=2):(Zu(t,n,Iy,Ry),Zu(t,e,Py,Oy),a[0]=2,a[1]=0,a[3]=2,a[6]=1):(Zu(e,t,Iy,Ry),Zu(e,n,Py,Oy),a[0]=1,a[1]=2,a[3]=1,a[6]=0));let c=HG.positions;return c[0]=e,c[1]=t,c[2]=n,c.length=3,(s===1||s===2)&&(c[3]=Iy,c[4]=Py,c[5]=Ry,c[6]=Oy,c.length=7),HG}function oee(e,t){let n=e.attributes;if(n.position.values.length===0)return;for(let o in n)if(n.hasOwnProperty(o)&&u(n[o])&&u(n[o].values)){let r=n[o];r.values=K.createTypedArray(r.componentDatatype,r.values)}let i=ft.computeNumberOfVertices(e);return e.indices=Be.createTypedArray(i,e.indices),t&&(e.boundingSphere=ae.fromVertices(n.position.values)),e}function AC(e){let t=e.attributes,n={};for(let i in t)if(t.hasOwnProperty(i)&&u(t[i])&&u(t[i].values)){let o=t[i];n[i]=new ve({componentDatatype:o.componentDatatype,componentsPerAttribute:o.componentsPerAttribute,normalize:o.normalize,values:[]})}return new ft({attributes:n,indices:[],primitiveType:e.primitiveType})}function qG(e,t,n){let i=u(e.geometry.boundingSphere);t=oee(t,i),n=oee(n,i),u(n)&&!u(t)?e.geometry=n:!u(n)&&u(t)?e.geometry=t:(e.westHemisphereGeometry=t,e.eastHemisphereGeometry=n,e.geometry=void 0)}function YG(e,t){let n=new e,i=new e,o=new e;return function(r,s,a,c,l,f,d,p){let g=e.fromArray(l,r*t,n),m=e.fromArray(l,s*t,i),y=e.fromArray(l,a*t,o);e.multiplyByScalar(g,c.x,g),e.multiplyByScalar(m,c.y,m),e.multiplyByScalar(y,c.z,y);let b=e.add(g,m,g);e.add(b,y,b),p&&e.normalize(b,b),e.pack(b,f,d*t)}}var fIe=YG(oe,4),JP=YG(h,3),uee=YG(H,2),dIe=function(e,t,n,i,o,r,s){let a=o[e]*i.x,c=o[t]*i.y,l=o[n]*i.z;r[s]=a+c+l>R.EPSILON6?1:0},XS=new h,GG=new h,WG=new h,hIe=new h;function $P(e,t,n,i,o,r,s,a,c,l,f,d,p,g,m,y){if(!u(r)&&!u(s)&&!u(a)&&!u(c)&&!u(l)&&g===0)return;let b=h.fromArray(o,e*3,XS),C=h.fromArray(o,t*3,GG),A=h.fromArray(o,n*3,WG),T=gC(i,b,C,A,hIe);if(u(T)){if(u(r)&&JP(e,t,n,T,r,d.normal.values,y,!0),u(l)){let E=h.fromArray(l,e*3,XS),v=h.fromArray(l,t*3,GG),D=h.fromArray(l,n*3,WG);h.multiplyByScalar(E,T.x,E),h.multiplyByScalar(v,T.y,v),h.multiplyByScalar(D,T.z,D);let O;!h.equals(E,h.ZERO)||!h.equals(v,h.ZERO)||!h.equals(D,h.ZERO)?(O=h.add(E,v,E),h.add(O,D,O),h.normalize(O,O)):(O=XS,O.x=0,O.y=0,O.z=0),h.pack(O,d.extrudeDirection.values,y*3)}if(u(f)&&dIe(e,t,n,T,f,d.applyOffset.values,y),u(s)&&JP(e,t,n,T,s,d.tangent.values,y,!0),u(a)&&JP(e,t,n,T,a,d.bitangent.values,y,!0),u(c)&&uee(e,t,n,T,c,d.st.values,y),g>0)for(let E=0;E<g;E++){let v=p[E];mIe(e,t,n,T,y,m[v],d[v])}}}function mIe(e,t,n,i,o,r,s){let a=r.componentsPerAttribute,c=r.values,l=s.values;switch(a){case 4:fIe(e,t,n,i,c,l,o,!1);break;case 3:JP(e,t,n,i,c,l,o,!1);break;case 2:uee(e,t,n,i,c,l,o,!1);break;default:l[o]=c[e]*i.x+c[t]*i.y+c[n]*i.z}}function vh(e,t,n,i,o,r){let s=e.position.values.length/3;if(o!==-1){let a=i[o],c=n[a];return c===-1?(n[a]=s,e.position.values.push(r.x,r.y,r.z),t.push(s),s):(t.push(c),c)}return e.position.values.push(r.x,r.y,r.z),t.push(s),s}var pIe={position:!0,normal:!0,bitangent:!0,tangent:!0,st:!0,extrudeDirection:!0,applyOffset:!0};function ree(e){let t=e.geometry,n=t.attributes,i=n.position.values,o=u(n.normal)?n.normal.values:void 0,r=u(n.bitangent)?n.bitangent.values:void 0,s=u(n.tangent)?n.tangent.values:void 0,a=u(n.st)?n.st.values:void 0,c=u(n.extrudeDirection)?n.extrudeDirection.values:void 0,l=u(n.applyOffset)?n.applyOffset.values:void 0,f=t.indices,d=[];for(let O in n)n.hasOwnProperty(O)&&!pIe[O]&&u(n[O])&&d.push(O);let p=d.length,g=AC(t),m=AC(t),y,b,C,A,T,E=[];E.length=i.length/3;let v=[];for(v.length=i.length/3,T=0;T<E.length;++T)E[T]=-1,v[T]=-1;let D=f.length;for(T=0;T<D;T+=3){let O=f[T],P=f[T+1],M=f[T+2],L=h.fromArray(i,O*3),_=h.fromArray(i,P*3),S=h.fromArray(i,M*3),w=uIe(L,_,S);if(u(w)&&w.positions.length>3){let I=w.positions,N=w.indices,k=N.length;for(let z=0;z<k;++z){let V=N[z],U=I[V];U.y<0?(y=m.attributes,b=m.indices,C=E):(y=g.attributes,b=g.indices,C=v),A=vh(y,b,C,f,V<3?T+V:-1,U),$P(O,P,M,U,i,o,s,r,a,c,l,y,d,p,n,A)}}else u(w)&&(L=w.positions[0],_=w.positions[1],S=w.positions[2]),L.y<0?(y=m.attributes,b=m.indices,C=E):(y=g.attributes,b=g.indices,C=v),A=vh(y,b,C,f,T,L),$P(O,P,M,L,i,o,s,r,a,c,l,y,d,p,n,A),A=vh(y,b,C,f,T+1,_),$P(O,P,M,_,i,o,s,r,a,c,l,y,d,p,n,A),A=vh(y,b,C,f,T+2,S),$P(O,P,M,S,i,o,s,r,a,c,l,y,d,p,n,A)}qG(e,m,g)}var fee=cn.fromPointNormal(h.ZERO,h.UNIT_Y),_Ie=new h,gIe=new h;function CC(e,t,n,i,o,r,s){if(!u(s))return;let a=h.fromArray(i,e*3,XS);h.equalsEpsilon(a,n,R.EPSILON10)?r.applyOffset.values[o]=s[e]:r.applyOffset.values[o]=s[t]}function see(e){let t=e.geometry,n=t.attributes,i=n.position.values,o=u(n.applyOffset)?n.applyOffset.values:void 0,r=t.indices,s=AC(t),a=AC(t),c,l=r.length,f=[];f.length=i.length/3;let d=[];for(d.length=i.length/3,c=0;c<f.length;++c)f[c]=-1,d[c]=-1;for(c=0;c<l;c+=2){let p=r[c],g=r[c+1],m=h.fromArray(i,p*3,XS),y=h.fromArray(i,g*3,GG),b;Math.abs(m.y)<R.EPSILON6&&(m.y<0?m.y=-R.EPSILON6:m.y=R.EPSILON6),Math.abs(y.y)<R.EPSILON6&&(y.y<0?y.y=-R.EPSILON6:y.y=R.EPSILON6);let C=s.attributes,A=s.indices,T=d,E=a.attributes,v=a.indices,D=f,O=Qn.lineSegmentPlane(m,y,fee,WG);if(u(O)){let P=h.multiplyByScalar(h.UNIT_Y,5*R.EPSILON9,_Ie);m.y<0&&(h.negate(P,P),C=a.attributes,A=a.indices,T=f,E=s.attributes,v=s.indices,D=d);let M=h.add(O,P,gIe);b=vh(C,A,T,r,c,m),CC(p,g,m,i,b,C,o),b=vh(C,A,T,r,-1,M),CC(p,g,M,i,b,C,o),h.negate(P,P),h.add(O,P,M),b=vh(E,v,D,r,-1,M),CC(p,g,M,i,b,E,o),b=vh(E,v,D,r,c+1,y),CC(p,g,y,i,b,E,o)}else{let P,M,L;m.y<0?(P=a.attributes,M=a.indices,L=f):(P=s.attributes,M=s.indices,L=d),b=vh(P,M,L,r,c,m),CC(p,g,m,i,b,P,o),b=vh(P,M,L,r,c+1,y),CC(p,g,y,i,b,P,o)}}qG(e,a,s)}var aee=new H,yIe=new H,dee=new h,hee=new h,jG=new h,xIe=new h,bIe=new h,CIe=new h,cee=new oe;function lee(e){let t=e.attributes,n=t.position.values,i=t.prevPosition.values,o=t.nextPosition.values,r=n.length;for(let s=0;s<r;s+=3){let a=h.unpack(n,s,dee);if(a.x>0)continue;let c=h.unpack(i,s,hee);(a.y<0&&c.y>0||a.y>0&&c.y<0)&&(s-3>0?(i[s]=n[s-3],i[s+1]=n[s-2],i[s+2]=n[s-1]):h.pack(a,i,s));let l=h.unpack(o,s,jG);(a.y<0&&l.y>0||a.y>0&&l.y<0)&&(s+3<r?(o[s]=n[s+3],o[s+1]=n[s+4],o[s+2]=n[s+5]):h.pack(a,o,s))}}var AIe=5*R.EPSILON9,QP=R.EPSILON6;function TIe(e){let t=e.geometry,n=t.attributes,i=n.position.values,o=n.prevPosition.values,r=n.nextPosition.values,s=n.expandAndWidth.values,a=u(n.st)?n.st.values:void 0,c=u(n.color)?n.color.values:void 0,l=AC(t),f=AC(t),d,p,g,m=!1,y=i.length/3;for(d=0;d<y;d+=4){let b=d,C=d+2,A=h.fromArray(i,b*3,dee),T=h.fromArray(i,C*3,hee);if(Math.abs(A.y)<QP)for(A.y=QP*(T.y<0?-1:1),i[d*3+1]=A.y,i[(d+1)*3+1]=A.y,p=b*3;p<b*3+4*3;p+=3)o[p]=i[d*3],o[p+1]=i[d*3+1],o[p+2]=i[d*3+2];if(Math.abs(T.y)<QP)for(T.y=QP*(A.y<0?-1:1),i[(d+2)*3+1]=T.y,i[(d+3)*3+1]=T.y,p=b*3;p<b*3+4*3;p+=3)r[p]=i[(d+2)*3],r[p+1]=i[(d+2)*3+1],r[p+2]=i[(d+2)*3+2];let E=l.attributes,v=l.indices,D=f.attributes,O=f.indices,P=Qn.lineSegmentPlane(A,T,fee,xIe);if(u(P)){m=!0;let M=h.multiplyByScalar(h.UNIT_Y,AIe,bIe);A.y<0&&(h.negate(M,M),E=f.attributes,v=f.indices,D=l.attributes,O=l.indices);let L=h.add(P,M,CIe);E.position.values.push(A.x,A.y,A.z,A.x,A.y,A.z),E.position.values.push(L.x,L.y,L.z),E.position.values.push(L.x,L.y,L.z),E.prevPosition.values.push(o[b*3],o[b*3+1],o[b*3+2]),E.prevPosition.values.push(o[b*3+3],o[b*3+4],o[b*3+5]),E.prevPosition.values.push(A.x,A.y,A.z,A.x,A.y,A.z),E.nextPosition.values.push(L.x,L.y,L.z),E.nextPosition.values.push(L.x,L.y,L.z),E.nextPosition.values.push(L.x,L.y,L.z),E.nextPosition.values.push(L.x,L.y,L.z),h.negate(M,M),h.add(P,M,L),D.position.values.push(L.x,L.y,L.z),D.position.values.push(L.x,L.y,L.z),D.position.values.push(T.x,T.y,T.z,T.x,T.y,T.z),D.prevPosition.values.push(L.x,L.y,L.z),D.prevPosition.values.push(L.x,L.y,L.z),D.prevPosition.values.push(L.x,L.y,L.z),D.prevPosition.values.push(L.x,L.y,L.z),D.nextPosition.values.push(T.x,T.y,T.z,T.x,T.y,T.z),D.nextPosition.values.push(r[C*3],r[C*3+1],r[C*3+2]),D.nextPosition.values.push(r[C*3+3],r[C*3+4],r[C*3+5]);let _=H.fromArray(s,b*2,aee),S=Math.abs(_.y);E.expandAndWidth.values.push(-1,S,1,S),E.expandAndWidth.values.push(-1,-S,1,-S),D.expandAndWidth.values.push(-1,S,1,S),D.expandAndWidth.values.push(-1,-S,1,-S);let w=h.magnitudeSquared(h.subtract(P,A,jG));if(w/=h.magnitudeSquared(h.subtract(T,A,jG)),u(c)){let I=oe.fromArray(c,b*4,cee),N=oe.fromArray(c,C*4,cee),k=R.lerp(I.x,N.x,w),z=R.lerp(I.y,N.y,w),V=R.lerp(I.z,N.z,w),U=R.lerp(I.w,N.w,w);for(p=b*4;p<b*4+2*4;++p)E.color.values.push(c[p]);for(E.color.values.push(k,z,V,U),E.color.values.push(k,z,V,U),D.color.values.push(k,z,V,U),D.color.values.push(k,z,V,U),p=C*4;p<C*4+2*4;++p)D.color.values.push(c[p])}if(u(a)){let I=H.fromArray(a,b*2,aee),N=H.fromArray(a,(d+3)*2,yIe),k=R.lerp(I.x,N.x,w);for(p=b*2;p<b*2+2*2;++p)E.st.values.push(a[p]);for(E.st.values.push(k,I.y),E.st.values.push(k,N.y),D.st.values.push(k,I.y),D.st.values.push(k,N.y),p=C*2;p<C*2+2*2;++p)D.st.values.push(a[p])}g=E.position.values.length/3-4,v.push(g,g+2,g+1),v.push(g+1,g+2,g+3),g=D.position.values.length/3-4,O.push(g,g+2,g+1),O.push(g+1,g+2,g+3)}else{let M,L;for(A.y<0?(M=f.attributes,L=f.indices):(M=l.attributes,L=l.indices),M.position.values.push(A.x,A.y,A.z),M.position.values.push(A.x,A.y,A.z),M.position.values.push(T.x,T.y,T.z),M.position.values.push(T.x,T.y,T.z),p=d*3;p<d*3+4*3;++p)M.prevPosition.values.push(o[p]),M.nextPosition.values.push(r[p]);for(p=d*2;p<d*2+4*2;++p)M.expandAndWidth.values.push(s[p]),u(a)&&M.st.values.push(a[p]);if(u(c))for(p=d*4;p<d*4+4*4;++p)M.color.values.push(c[p]);g=M.position.values.length/3-4,L.push(g,g+2,g+1),L.push(g+1,g+2,g+3)}}m&&(lee(f),lee(l)),qG(e,f,l)}Ac.splitLongitude=function(e){let t=e.geometry,n=t.boundingSphere;if(u(n)&&(n.center.x-n.radius>0||ae.intersectPlane(n,cn.ORIGIN_ZX_PLANE)!==qt.INTERSECTING))return e;if(t.geometryType!==ad.NONE)switch(t.geometryType){case ad.POLYLINES:TIe(e);break;case ad.TRIANGLES:ree(e);break;case ad.LINES:see(e);break}else cIe(t),t.primitiveType===Ne.TRIANGLES?ree(e):t.primitiveType===Ne.LINES&&see(e);return e};var Nn=Ac;function KS(e,t,n,i,o,r,s,a,c,l,f){this._context=e,this._texture=t,this._textureTarget=n,this._targetFace=i,this._pixelDatatype=s,this._internalFormat=o,this._pixelFormat=r,this._size=a,this._preMultiplyAlpha=c,this._flipY=l,this._initialized=f}Object.defineProperties(KS.prototype,{pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},_target:{get:function(){return this._targetFace}}});KS.prototype.copyFrom=function(e){let{xOffset:t=0,yOffset:n=0,source:i,skipColorSpaceConversion:o=!1}=e,{width:r,height:s}=i,a=this._context._gl,c=this._textureTarget,l=this._targetFace;a.activeTexture(a.TEXTURE0),a.bindTexture(c,this._texture);let f=i.arrayBufferView,d=this._size,p=this._pixelFormat,g=this._internalFormat,m=this._pixelDatatype,y=this._preMultiplyAlpha,b=this._flipY,C=4;u(f)&&(C=tt.alignmentInBytes(p,m,r)),a.pixelStorei(a.UNPACK_ALIGNMENT,C),o?a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,a.NONE):a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,a.BROWSER_DEFAULT_WEBGL);let A=!1;if(!this._initialized){let T;t===0&&n===0&&r===d&&s===d?(u(f)?(a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1),b&&(f=tt.flipY(f,p,m,d,d)),T=f):(a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,b),T=i),A=!0):(a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1),T=tt.createTypedArray(p,m,d,d)),a.texImage2D(l,0,g,d,d,0,p,Ke.toWebGLConstant(m,this._context),T),this._initialized=!0}A||(u(f)?(a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1),b&&(f=tt.flipY(f,p,m,r,s)),a.texSubImage2D(l,0,t,n,r,s,p,Ke.toWebGLConstant(m,this._context),f)):(a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,b),a.texSubImage2D(l,0,t,n,p,Ke.toWebGLConstant(m,this._context),i))),a.bindTexture(c,null)};KS.prototype.copyFromFramebuffer=function(e,t,n,i,o,r){e=x(e,0),t=x(t,0),n=x(n,0),i=x(i,0),o=x(o,this._size),r=x(r,this._size);let s=this._context._gl,a=this._textureTarget;s.activeTexture(s.TEXTURE0),s.bindTexture(a,this._texture),s.copyTexSubImage2D(this._targetFace,0,e,t,n,i,o,r),s.bindTexture(a,null),this._initialized=!0};KS.prototype.copyMipmapFromFramebuffer=function(e,t,n,i,o){e=x(e,0),t=x(t,0),n=x(n,this._size),i=x(i,this._size),o=x(o,0);let r=this._context._gl,s=this._textureTarget;r.activeTexture(r.TEXTURE0),r.bindTexture(s,this._texture),r.copyTexImage2D(this._targetFace,o,this._internalFormat,e,t,n,i,0),r.bindTexture(s,null),this._initialized=!0};var tR=KS;var nR={DONT_CARE:te.DONT_CARE,FASTEST:te.FASTEST,NICEST:te.NICEST,validate:function(e){return e===nR.DONT_CARE||e===nR.FASTEST||e===nR.NICEST}},ip=Object.freeze(nR);var iR={NEAREST:te.NEAREST,LINEAR:te.LINEAR};iR.validate=function(e){return e===iR.NEAREST||e===iR.LINEAR};var mi=Object.freeze(iR);var V_={NEAREST:te.NEAREST,LINEAR:te.LINEAR,NEAREST_MIPMAP_NEAREST:te.NEAREST_MIPMAP_NEAREST,LINEAR_MIPMAP_NEAREST:te.LINEAR_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:te.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_LINEAR:te.LINEAR_MIPMAP_LINEAR};V_.validate=function(e){return e===V_.NEAREST||e===V_.LINEAR||e===V_.NEAREST_MIPMAP_NEAREST||e===V_.LINEAR_MIPMAP_NEAREST||e===V_.NEAREST_MIPMAP_LINEAR||e===V_.LINEAR_MIPMAP_LINEAR};var $t=Object.freeze(V_);var oR={CLAMP_TO_EDGE:te.CLAMP_TO_EDGE,REPEAT:te.REPEAT,MIRRORED_REPEAT:te.MIRRORED_REPEAT,validate:function(e){return e===oR.CLAMP_TO_EDGE||e===oR.REPEAT||e===oR.MIRRORED_REPEAT}},En=Object.freeze(oR);function ZS(e){e=x(e,x.EMPTY_OBJECT);let{wrapS:t=En.CLAMP_TO_EDGE,wrapT:n=En.CLAMP_TO_EDGE,minificationFilter:i=$t.LINEAR,magnificationFilter:o=mi.LINEAR,maximumAnisotropy:r=1}=e;this._wrapS=t,this._wrapT=n,this._minificationFilter=i,this._magnificationFilter=o,this._maximumAnisotropy=r}Object.defineProperties(ZS.prototype,{wrapS:{get:function(){return this._wrapS}},wrapT:{get:function(){return this._wrapT}},minificationFilter:{get:function(){return this._minificationFilter}},magnificationFilter:{get:function(){return this._magnificationFilter}},maximumAnisotropy:{get:function(){return this._maximumAnisotropy}}});ZS.equals=function(e,t){return e===t||u(e)&&u(t)&&e._wrapS===t._wrapS&&e._wrapT===t._wrapT&&e._minificationFilter===t._minificationFilter&&e._magnificationFilter===t._magnificationFilter&&e._maximumAnisotropy===t._maximumAnisotropy};ZS.NEAREST=Object.freeze(new ZS({wrapS:En.CLAMP_TO_EDGE,wrapT:En.CLAMP_TO_EDGE,minificationFilter:$t.NEAREST,magnificationFilter:mi.NEAREST}));var Qt=ZS;function EIe(e,t,n,i){let o=u(t.vertexBuffer),r=u(t.value),s=t.value?t.value.length:t.componentsPerAttribute,a={index:x(t.index,n),enabled:x(t.enabled,!0),vertexBuffer:t.vertexBuffer,value:r?t.value.slice(0):void 0,componentsPerAttribute:s,componentDatatype:x(t.componentDatatype,K.FLOAT),normalize:x(t.normalize,!1),offsetInBytes:x(t.offsetInBytes,0),strideInBytes:x(t.strideInBytes,0),instanceDivisor:x(t.instanceDivisor,0)};if(o)a.vertexAttrib=function(c){let l=this.index;c.bindBuffer(c.ARRAY_BUFFER,this.vertexBuffer._getBuffer()),c.vertexAttribPointer(l,this.componentsPerAttribute,this.componentDatatype,this.normalize,this.strideInBytes,this.offsetInBytes),c.enableVertexAttribArray(l),this.instanceDivisor>0&&(i.glVertexAttribDivisor(l,this.instanceDivisor),i._vertexAttribDivisors[l]=this.instanceDivisor,i._previousDrawInstanced=!0)},a.disableVertexAttribArray=function(c){c.disableVertexAttribArray(this.index),this.instanceDivisor>0&&i.glVertexAttribDivisor(n,0)};else{switch(a.componentsPerAttribute){case 1:a.vertexAttrib=function(c){c.vertexAttrib1fv(this.index,this.value)};break;case 2:a.vertexAttrib=function(c){c.vertexAttrib2fv(this.index,this.value)};break;case 3:a.vertexAttrib=function(c){c.vertexAttrib3fv(this.index,this.value)};break;case 4:a.vertexAttrib=function(c){c.vertexAttrib4fv(this.index,this.value)};break}a.disableVertexAttribArray=function(c){}}e.push(a)}function pee(e,t,n){for(let i=0;i<t.length;++i){let o=t[i];o.enabled&&o.vertexAttrib(e)}u(n)&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n._getBuffer())}function op(e){e=x(e,x.EMPTY_OBJECT);let t=e.context,n=t._gl,i=e.attributes,o=e.indexBuffer,r,s=[],a=1,c=!1,l=!1,f=i.length;for(r=0;r<f;++r)EIe(s,i[r],r,t);for(f=s.length,r=0;r<f;++r){let p=s[r];if(u(p.vertexBuffer)&&p.instanceDivisor===0){let g=p.strideInBytes||p.componentsPerAttribute*K.getSizeInBytes(p.componentDatatype);a=p.vertexBuffer.sizeInBytes/g;break}}for(r=0;r<f;++r)s[r].instanceDivisor>0&&(c=!0),u(s[r].value)&&(l=!0);let d;t.vertexArrayObject&&(d=t.glCreateVertexArray(),t.glBindVertexArray(d),pee(n,s,o),t.glBindVertexArray(null)),this._numberOfVertices=a,this._hasInstancedAttributes=c,this._hasConstantAttributes=l,this._context=t,this._gl=n,this._vao=d,this._attributes=s,this._indexBuffer=o}function mee(e){return e.values.length/e.componentsPerAttribute}function SIe(e){return K.getSizeInBytes(e.componentDatatype)*e.componentsPerAttribute}function vIe(e){let t,n,i,o=[];for(n in e)e.hasOwnProperty(n)&&u(e[n])&&u(e[n].values)&&(o.push(n),e[n].componentDatatype===K.DOUBLE&&(e[n].componentDatatype=K.FLOAT,e[n].values=K.createTypedArray(K.FLOAT,e[n].values)));let r,s=o.length;if(s>0)for(r=mee(e[o[0]]),t=1;t<s;++t){let l=mee(e[o[t]]);if(l!==r)throw new ce(`Each attribute list must have the same number of vertices.  Attribute ${o[t]} has a different number of vertices (${l.toString()}) than attribute ${o[0]} (${r.toString()}).`)}o.sort(function(l,f){return K.getSizeInBytes(e[f].componentDatatype)-K.getSizeInBytes(e[l].componentDatatype)});let a=0,c={};for(t=0;t<s;++t)n=o[t],i=e[n],c[n]=a,a+=SIe(i);if(a>0){let l=K.getSizeInBytes(e[o[0]].componentDatatype),f=a%l;f!==0&&(a+=l-f);let d=r*a,p=new ArrayBuffer(d),g={};for(t=0;t<s;++t){n=o[t];let m=K.getSizeInBytes(e[n].componentDatatype);g[n]={pointer:K.createTypedArray(e[n].componentDatatype,p),index:c[n]/m,strideInComponentType:a/m}}for(t=0;t<r;++t)for(let m=0;m<s;++m){n=o[m],i=e[n];let y=i.values,b=g[n],C=b.pointer,A=i.componentsPerAttribute;for(let T=0;T<A;++T)C[b.index+T]=y[t*A+T];b.index+=b.strideInComponentType}return{buffer:p,offsetsInBytes:c,vertexSizeInBytes:a}}}op.fromGeometry=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.context,n=x(e.geometry,x.EMPTY_OBJECT),i=x(e.bufferUsage,ke.DYNAMIC_DRAW),o=x(e.attributeLocations,x.EMPTY_OBJECT),r=x(e.interleave,!1),s=e.vertexArrayAttributes,a,c,l,f=u(s)?s:[],d=n.attributes;if(r){let m=vIe(d);if(u(m)){l=xt.createVertexBuffer({context:t,typedArray:m.buffer,usage:i});let y=m.offsetsInBytes,b=m.vertexSizeInBytes;for(a in d)d.hasOwnProperty(a)&&u(d[a])&&(c=d[a],u(c.values)?f.push({index:o[a],vertexBuffer:l,componentDatatype:c.componentDatatype,componentsPerAttribute:c.componentsPerAttribute,normalize:c.normalize,offsetInBytes:y[a],strideInBytes:b}):f.push({index:o[a],value:c.value,componentDatatype:c.componentDatatype,normalize:c.normalize}))}}else for(a in d)if(d.hasOwnProperty(a)&&u(d[a])){c=d[a];let m=c.componentDatatype;m===K.DOUBLE&&(m=K.FLOAT),l=void 0,u(c.values)&&(l=xt.createVertexBuffer({context:t,typedArray:K.createTypedArray(m,c.values),usage:i})),f.push({index:o[a],vertexBuffer:l,value:c.value,componentDatatype:m,componentsPerAttribute:c.componentsPerAttribute,normalize:c.normalize})}let p,g=n.indices;return u(g)&&(ft.computeNumberOfVertices(n)>=R.SIXTY_FOUR_KILOBYTES&&t.elementIndexUint?p=xt.createIndexBuffer({context:t,typedArray:new Uint32Array(g),usage:i,indexDatatype:Be.UNSIGNED_INT}):p=xt.createIndexBuffer({context:t,typedArray:new Uint16Array(g),usage:i,indexDatatype:Be.UNSIGNED_SHORT})),new op({context:t,attributes:f,indexBuffer:p})};Object.defineProperties(op.prototype,{numberOfAttributes:{get:function(){return this._attributes.length}},numberOfVertices:{get:function(){return this._numberOfVertices}},indexBuffer:{get:function(){return this._indexBuffer}}});op.prototype.getAttribute=function(e){return this._attributes[e]};function wIe(e){let t=e._context,n=e._hasInstancedAttributes;if(!n&&!t._previousDrawInstanced)return;t._previousDrawInstanced=n;let i=t._vertexAttribDivisors,o=e._attributes,r=Vt.maximumVertexAttributes,s;if(n){let a=o.length;for(s=0;s<a;++s){let c=o[s];if(c.enabled){let l=c.instanceDivisor,f=c.index;l!==i[f]&&(t.glVertexAttribDivisor(f,l),i[f]=l)}}}else for(s=0;s<r;++s)i[s]>0&&(t.glVertexAttribDivisor(s,0),i[s]=0)}function DIe(e,t){let n=e._attributes,i=n.length;for(let o=0;o<i;++o){let r=n[o];r.enabled&&u(r.value)&&r.vertexAttrib(t)}}op.prototype._bind=function(){u(this._vao)?(this._context.glBindVertexArray(this._vao),this._context.instancedArrays&&wIe(this),this._hasConstantAttributes&&DIe(this,this._gl)):pee(this._gl,this._attributes,this._indexBuffer)};op.prototype._unBind=function(){if(u(this._vao))this._context.glBindVertexArray(null);else{let e=this._attributes,t=this._gl;for(let n=0;n<e.length;++n){let i=e[n];i.enabled&&i.disableVertexAttribArray(t)}this._indexBuffer&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}};op.prototype.isDestroyed=function(){return!1};op.prototype.destroy=function(){let e=this._attributes;for(let n=0;n<e.length;++n){let i=e[n].vertexBuffer;u(i)&&!i.isDestroyed()&&i.vertexArrayDestroyable&&i.destroy()}let t=this._indexBuffer;return u(t)&&!t.isDestroyed()&&t.vertexArrayDestroyable&&t.destroy(),u(this._vao)&&this._context.glDeleteVertexArray(this._vao),ue(this)};var ii=op;function Yo(e){e=x(e,x.EMPTY_OBJECT);let{context:t,source:n,pixelFormat:i=tt.RGBA,pixelDatatype:o=Ke.UNSIGNED_BYTE,flipY:r=!0,skipColorSpaceConversion:s=!1,sampler:a=new Qt}=e,c=e.preMultiplyAlpha||i===tt.RGB||i===tt.LUMINANCE,{width:l,height:f}=e;u(n)&&({width:l,height:f}=n.positiveX);let d=l,p=tt.textureSizeInBytes(i,o,d,d)*6,g=tt.toInternalFormat(i,o,t),m=t._gl,y=m.TEXTURE_CUBE_MAP,b=m.createTexture();this._context=t,this._textureFilterAnisotropic=t._textureFilterAnisotropic,this._textureTarget=y,this._texture=b,this._pixelFormat=i,this._pixelDatatype=o,this._size=d,this._hasMipmap=!1,this._sizeInBytes=p,this._preMultiplyAlpha=c,this._flipY=r;let C=u(n);function A(T){return new tR(t,b,y,T,g,i,o,d,c,r,C)}this._positiveX=A(m.TEXTURE_CUBE_MAP_POSITIVE_X),this._negativeX=A(m.TEXTURE_CUBE_MAP_NEGATIVE_X),this._positiveY=A(m.TEXTURE_CUBE_MAP_POSITIVE_Y),this._negativeY=A(m.TEXTURE_CUBE_MAP_NEGATIVE_Y),this._positiveZ=A(m.TEXTURE_CUBE_MAP_POSITIVE_Z),this._negativeZ=A(m.TEXTURE_CUBE_MAP_NEGATIVE_Z),this._sampler=a,_ee(this,a),m.activeTexture(m.TEXTURE0),m.bindTexture(y,b),s?m.pixelStorei(m.UNPACK_COLORSPACE_CONVERSION_WEBGL,m.NONE):m.pixelStorei(m.UNPACK_COLORSPACE_CONVERSION_WEBGL,m.BROWSER_DEFAULT_WEBGL);for(let T of Yo.faceNames())XG(this[T],n?.[T],0);m.bindTexture(y,null)}Yo.prototype.copyFace=function(e,t,n,i){let o=e.context,r=new Hr({context:o,colorTextures:[t],destroyAttachments:!1});r._bind(),this[n].copyMipmapFromFramebuffer(0,0,t.width,t.height,x(i,0)),r._unBind(),r.destroy()};Yo.FaceName=Object.freeze({POSITIVEX:"positiveX",NEGATIVEX:"negativeX",POSITIVEY:"positiveY",NEGATIVEY:"negativeY",POSITIVEZ:"positiveZ",NEGATIVEZ:"negativeZ"});function*IIe(){yield Yo.FaceName.POSITIVEX,yield Yo.FaceName.NEGATIVEX,yield Yo.FaceName.POSITIVEY,yield Yo.FaceName.NEGATIVEY,yield Yo.FaceName.POSITIVEZ,yield Yo.FaceName.NEGATIVEZ}Yo.faceNames=function(){return IIe()};function XG(e,t,n){n=x(n,0);let i=e._targetFace,o=Math.max(Math.floor(e._size/2**n),1),r=e._pixelFormat,s=e._pixelDatatype,a=e._internalFormat,c=e._flipY,l=e._preMultiplyAlpha,f=e._context,d=f._gl;if(!u(t)){d.texImage2D(i,n,a,o,o,0,r,Ke.toWebGLConstant(s,f),null);return}let{arrayBufferView:p}=t,g=4;u(p)&&(g=tt.alignmentInBytes(r,s,o)),d.pixelStorei(d.UNPACK_ALIGNMENT,g),u(p)?(d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,!1),c&&(p=tt.flipY(p,r,s,o,o)),d.texImage2D(i,n,a,o,o,0,r,Ke.toWebGLConstant(s,f),p)):(d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,c),d.texImage2D(i,n,a,r,Ke.toWebGLConstant(s,f),t))}Yo.loadFace=XG;Object.defineProperties(Yo.prototype,{positiveX:{get:function(){return this._positiveX}},negativeX:{get:function(){return this._negativeX}},positiveY:{get:function(){return this._positiveY}},negativeY:{get:function(){return this._negativeY}},positiveZ:{get:function(){return this._positiveZ}},negativeZ:{get:function(){return this._negativeZ}},sampler:{get:function(){return this._sampler},set:function(e){_ee(this,e),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},width:{get:function(){return this._size}},height:{get:function(){return this._size}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(this._sizeInBytes*4/3):this._sizeInBytes}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},_target:{get:function(){return this._textureTarget}}});Yo.getDirection=function(e,t){switch(e){case Yo.FaceName.POSITIVEX:return h.clone(h.UNIT_X,t);case Yo.FaceName.NEGATIVEX:return h.negate(h.UNIT_X,t);case Yo.FaceName.POSITIVEY:return h.clone(h.UNIT_Y,t);case Yo.FaceName.NEGATIVEY:return h.negate(h.UNIT_Y,t);case Yo.FaceName.POSITIVEZ:return h.clone(h.UNIT_Z,t);case Yo.FaceName.NEGATIVEZ:return h.negate(h.UNIT_Z,t)}};function _ee(e,t){let{minificationFilter:n,magnificationFilter:i}=t,o=[$t.NEAREST_MIPMAP_NEAREST,$t.NEAREST_MIPMAP_LINEAR,$t.LINEAR_MIPMAP_NEAREST,$t.LINEAR_MIPMAP_LINEAR].includes(n),r=e._context,s=e._pixelDatatype;(s===Ke.FLOAT&&!r.textureFloatLinear||s===Ke.HALF_FLOAT&&!r.textureHalfFloatLinear)&&(n=o?$t.NEAREST_MIPMAP_NEAREST:$t.NEAREST,i=mi.NEAREST);let a=r._gl,c=e._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(c,e._texture),a.texParameteri(c,a.TEXTURE_MIN_FILTER,n),a.texParameteri(c,a.TEXTURE_MAG_FILTER,i),a.texParameteri(c,a.TEXTURE_WRAP_S,t.wrapS),a.texParameteri(c,a.TEXTURE_WRAP_T,t.wrapT),u(e._textureFilterAnisotropic)&&a.texParameteri(c,e._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.maximumAnisotropy),a.bindTexture(c,null)}Yo.prototype.loadMipmaps=function(e,t){t=x(t,!1);let n=this._context._gl,i=this._texture,o=this._textureTarget;n.activeTexture(n.TEXTURE0),n.bindTexture(o,i),t?n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE):n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.BROWSER_DEFAULT_WEBGL);for(let r=0;r<e.length;r++){let s=e[r],a=r+1;for(let c of Yo.faceNames())XG(this[c],s[c],a)}n.bindTexture(o,null),this._hasMipmap=!0};Yo.prototype.generateMipmap=function(e){e=x(e,ip.DONT_CARE),this._hasMipmap=!0;let t=this._context._gl,n=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(n,this._texture),t.generateMipmap(n),t.bindTexture(n,null)};Yo.createVertexArray=function(e){let t=Ya.createGeometry(Ya.fromDimensions({dimensions:new h(2,2,2),vertexFormat:Ie.POSITION_ONLY})),n=this._attributeLocations=Nn.createAttributeLocations(t);return ii.fromGeometry({context:e,geometry:t,attributeLocations:n,bufferUsage:ke.STATIC_DRAW})};Yo.prototype.isDestroyed=function(){return!1};Yo.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),this._positiveX=ue(this._positiveX),this._negativeX=ue(this._negativeX),this._positiveY=ue(this._positiveY),this._negativeY=ue(this._negativeY),this._positiveZ=ue(this._positiveZ),this._negativeZ=ue(this._negativeZ),ue(this)};var Or=Yo;function PIe(e){this.context=e,this.framebuffer=void 0,this.blendingEnabled=void 0,this.scissorTest=void 0,this.viewport=void 0}var Tc=PIe;var rR=`/**
 * A built-in GLSL floating-point constant for converting radians to degrees.
 *
 * @alias czm_degreesPerRadian
 * @glslConstant
 *
 * @see CesiumMath.DEGREES_PER_RADIAN
 *
 * @example
 * // GLSL declaration
 * const float czm_degreesPerRadian = ...;
 *
 * // Example
 * float deg = czm_degreesPerRadian * rad;
 */
const float czm_degreesPerRadian = 57.29577951308232;
`;var sR=`/**
 * A built-in GLSL vec2 constant for defining the depth range.
 * This is a workaround to a bug where IE11 does not implement gl_DepthRange.
 *
 * @alias czm_depthRange
 * @glslConstant
 *
 * @example
 * // GLSL declaration
 * float depthRangeNear = czm_depthRange.near;
 * float depthRangeFar = czm_depthRange.far;
 *
 */
const czm_depthRangeStruct czm_depthRange = czm_depthRangeStruct(0.0, 1.0);
`;var aR=`/**
 * 0.1
 *
 * @name czm_epsilon1
 * @glslConstant
 */
const float czm_epsilon1 = 0.1;
`;var cR=`/**
 * 0.01
 *
 * @name czm_epsilon2
 * @glslConstant
 */
const float czm_epsilon2 = 0.01;
`;var lR=`/**
 * 0.001
 *
 * @name czm_epsilon3
 * @glslConstant
 */
const float czm_epsilon3 = 0.001;
`;var uR=`/**
 * 0.0001
 *
 * @name czm_epsilon4
 * @glslConstant
 */
const float czm_epsilon4 = 0.0001;
`;var fR=`/**
 * 0.00001
 *
 * @name czm_epsilon5
 * @glslConstant
 */
const float czm_epsilon5 = 0.00001;
`;var dR=`/**
 * 0.000001
 *
 * @name czm_epsilon6
 * @glslConstant
 */
const float czm_epsilon6 = 0.000001;
`;var hR=`/**
 * 0.0000001
 *
 * @name czm_epsilon7
 * @glslConstant
 */
const float czm_epsilon7 = 0.0000001;
`;var mR=`/**
 * DOC_TBA
 *
 * @name czm_infinity
 * @glslConstant
 */
const float czm_infinity = 5906376272000.0;  // Distance from the Sun to Pluto in meters.  TODO: What is best given lowp, mediump, and highp?
`;var pR=`/**
 * A built-in GLSL floating-point constant for <code>1/pi</code>.
 *
 * @alias czm_oneOverPi
 * @glslConstant
 *
 * @see CesiumMath.ONE_OVER_PI
 *
 * @example
 * // GLSL declaration
 * const float czm_oneOverPi = ...;
 *
 * // Example
 * float pi = 1.0 / czm_oneOverPi;
 */
const float czm_oneOverPi = 0.3183098861837907;
`;var _R=`/**
 * A built-in GLSL floating-point constant for <code>1/2pi</code>.
 *
 * @alias czm_oneOverTwoPi
 * @glslConstant
 *
 * @see CesiumMath.ONE_OVER_TWO_PI
 *
 * @example
 * // GLSL declaration
 * const float czm_oneOverTwoPi = ...;
 *
 * // Example
 * float pi = 2.0 * czm_oneOverTwoPi;
 */
const float czm_oneOverTwoPi = 0.15915494309189535;
`;var gR=`/**
 * The automatic GLSL constant for {@link Pass#CESIUM_3D_TILE}
 *
 * @name czm_passCesium3DTile
 * @glslConstant
 *
 * @see czm_pass
 */
const float czm_passCesium3DTile = 4.0;
`;var yR=`/**
 * The automatic GLSL constant for {@link Pass#CESIUM_3D_TILE_CLASSIFICATION}
 *
 * @name czm_passCesium3DTileClassification
 * @glslConstant
 *
 * @see czm_pass
 */
const float czm_passCesium3DTileClassification = 5.0;
`;var xR=`/**
 * The automatic GLSL constant for {@link Pass#CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW}
 *
 * @name czm_passCesium3DTileClassificationIgnoreShow
 * @glslConstant
 *
 * @see czm_pass
 */
const float czm_passCesium3DTileClassificationIgnoreShow = 6.0;
`;var bR=`/**
 * The automatic GLSL constant for {@link Pass#CLASSIFICATION}
 *
 * @name czm_passClassification
 * @glslConstant
 *
 * @see czm_pass
 */
const float czm_passClassification = 7.0;
`;var CR=`/**
 * The automatic GLSL constant for {@link Pass#COMPUTE}
 *
 * @name czm_passCompute
 * @glslConstant
 *
 * @see czm_pass
 */
const float czm_passCompute = 1.0;
`;var AR=`/**
 * The automatic GLSL constant for {@link Pass#ENVIRONMENT}
 *
 * @name czm_passEnvironment
 * @glslConstant
 *
 * @see czm_pass
 */
const float czm_passEnvironment = 0.0;
`;var TR=`/**
 * The automatic GLSL constant for {@link Pass#GLOBE}
 *
 * @name czm_passGlobe
 * @glslConstant
 *
 * @see czm_pass
 */
const float czm_passGlobe = 2.0;
`;var ER=`/**
 * The automatic GLSL constant for {@link Pass#OPAQUE}
 *
 * @name czm_passOpaque
 * @glslConstant
 *
 * @see czm_pass
 */
const float czm_passOpaque = 7.0;
`;var SR=`/**
 * The automatic GLSL constant for {@link Pass#OVERLAY}
 *
 * @name czm_passOverlay
 * @glslConstant
 *
 * @see czm_pass
 */
const float czm_passOverlay = 10.0;
`;var vR=`/**
 * The automatic GLSL constant for {@link Pass#TERRAIN_CLASSIFICATION}
 *
 * @name czm_passTerrainClassification
 * @glslConstant
 *
 * @see czm_pass
 */
const float czm_passTerrainClassification = 3.0;
`;var wR=`/**
 * The automatic GLSL constant for {@link Pass#TRANSLUCENT}
 *
 * @name czm_passTranslucent
 * @glslConstant
 *
 * @see czm_pass
 */
const float czm_passTranslucent = 8.0;
`;var DR=`/**
 * The automatic GLSL constant for {@link Pass#VOXELS}
 *
 * @name czm_passVoxels
 * @glslConstant
 *
 * @see czm_pass
 */
const float czm_passVoxels = 9.0;
`;var IR=`/**
 * A built-in GLSL floating-point constant for <code>Math.PI</code>.
 *
 * @alias czm_pi
 * @glslConstant
 *
 * @see CesiumMath.PI
 *
 * @example
 * // GLSL declaration
 * const float czm_pi = ...;
 *
 * // Example
 * float twoPi = 2.0 * czm_pi;
 */
const float czm_pi = 3.141592653589793;
`;var PR=`/**
 * A built-in GLSL floating-point constant for <code>pi/4</code>.
 *
 * @alias czm_piOverFour
 * @glslConstant
 *
 * @see CesiumMath.PI_OVER_FOUR
 *
 * @example
 * // GLSL declaration
 * const float czm_piOverFour = ...;
 *
 * // Example
 * float pi = 4.0 * czm_piOverFour;
 */
const float czm_piOverFour = 0.7853981633974483;
`;var RR=`/**
 * A built-in GLSL floating-point constant for <code>pi/6</code>.
 *
 * @alias czm_piOverSix
 * @glslConstant
 *
 * @see CesiumMath.PI_OVER_SIX
 *
 * @example
 * // GLSL declaration
 * const float czm_piOverSix = ...;
 *
 * // Example
 * float pi = 6.0 * czm_piOverSix;
 */
const float czm_piOverSix = 0.5235987755982988;
`;var OR=`/**
 * A built-in GLSL floating-point constant for <code>pi/3</code>.
 *
 * @alias czm_piOverThree
 * @glslConstant
 *
 * @see CesiumMath.PI_OVER_THREE
 *
 * @example
 * // GLSL declaration
 * const float czm_piOverThree = ...;
 *
 * // Example
 * float pi = 3.0 * czm_piOverThree;
 */
const float czm_piOverThree = 1.0471975511965976;
`;var MR=`/**
 * A built-in GLSL floating-point constant for <code>pi/2</code>.
 *
 * @alias czm_piOverTwo
 * @glslConstant
 *
 * @see CesiumMath.PI_OVER_TWO
 *
 * @example
 * // GLSL declaration
 * const float czm_piOverTwo = ...;
 *
 * // Example
 * float pi = 2.0 * czm_piOverTwo;
 */
const float czm_piOverTwo = 1.5707963267948966;
`;var LR=`/**
 * A built-in GLSL floating-point constant for converting degrees to radians.
 *
 * @alias czm_radiansPerDegree
 * @glslConstant
 *
 * @see CesiumMath.RADIANS_PER_DEGREE
 *
 * @example
 * // GLSL declaration
 * const float czm_radiansPerDegree = ...;
 *
 * // Example
 * float rad = czm_radiansPerDegree * deg;
 */
const float czm_radiansPerDegree = 0.017453292519943295;
`;var NR=`/**
 * The constant identifier for the 2D {@link SceneMode}
 *
 * @name czm_sceneMode2D
 * @glslConstant
 * @see czm_sceneMode
 * @see czm_sceneModeColumbusView
 * @see czm_sceneMode3D
 * @see czm_sceneModeMorphing
 */
const float czm_sceneMode2D = 2.0;
`;var FR=`/**
 * The constant identifier for the 3D {@link SceneMode}
 *
 * @name czm_sceneMode3D
 * @glslConstant
 * @see czm_sceneMode
 * @see czm_sceneMode2D
 * @see czm_sceneModeColumbusView
 * @see czm_sceneModeMorphing
 */
const float czm_sceneMode3D = 3.0;
`;var BR=`/**
 * The constant identifier for the Columbus View {@link SceneMode}
 *
 * @name czm_sceneModeColumbusView
 * @glslConstant
 * @see czm_sceneMode
 * @see czm_sceneMode2D
 * @see czm_sceneMode3D
 * @see czm_sceneModeMorphing
 */
const float czm_sceneModeColumbusView = 1.0;
`;var kR=`/**
 * The constant identifier for the Morphing {@link SceneMode}
 *
 * @name czm_sceneModeMorphing
 * @glslConstant
 * @see czm_sceneMode
 * @see czm_sceneMode2D
 * @see czm_sceneModeColumbusView
 * @see czm_sceneMode3D
 */
const float czm_sceneModeMorphing = 0.0;
`;var VR=`/**
 * A built-in GLSL floating-point constant for one solar radius.
 *
 * @alias czm_solarRadius
 * @glslConstant
 *
 * @see CesiumMath.SOLAR_RADIUS
 *
 * @example
 * // GLSL declaration
 * const float czm_solarRadius = ...;
 */
const float czm_solarRadius = 695500000.0;
`;var UR=`/**
 * A built-in GLSL floating-point constant for <code>3pi/2</code>.
 *
 * @alias czm_threePiOver2
 * @glslConstant
 *
 * @see CesiumMath.THREE_PI_OVER_TWO
 *
 * @example
 * // GLSL declaration
 * const float czm_threePiOver2 = ...;
 *
 * // Example
 * float pi = (2.0 / 3.0) * czm_threePiOver2;
 */
const float czm_threePiOver2 = 4.71238898038469;
`;var zR=`/**
 * A built-in GLSL floating-point constant for <code>2pi</code>.
 *
 * @alias czm_twoPi
 * @glslConstant
 *
 * @see CesiumMath.TWO_PI
 *
 * @example
 * // GLSL declaration
 * const float czm_twoPi = ...;
 *
 * // Example
 * float pi = czm_twoPi / 2.0;
 */
const float czm_twoPi = 6.283185307179586;
`;var HR=`/**
 * The maximum latitude, in radians, both North and South, supported by a Web Mercator
 * (EPSG:3857) projection.  Technically, the Mercator projection is defined
 * for any latitude up to (but not including) 90 degrees, but it makes sense
 * to cut it off sooner because it grows exponentially with increasing latitude.
 * The logic behind this particular cutoff value, which is the one used by
 * Google Maps, Bing Maps, and Esri, is that it makes the projection
 * square.  That is, the rectangle is equal in the X and Y directions.
 *
 * The constant value is computed as follows:
 *   czm_pi * 0.5 - (2.0 * atan(exp(-czm_pi)))
 *
 * @name czm_webMercatorMaxLatitude
 * @glslConstant
 */
const float czm_webMercatorMaxLatitude = 1.4844222297453324;
`;var GR=`/**
 * @name czm_depthRangeStruct
 * @glslStruct
 */
struct czm_depthRangeStruct
{
    float near;
    float far;
};
`;var WR=`/**
 * Holds material information that can be used for lighting. Returned by all czm_getMaterial functions.
 *
 * @name czm_material
 * @glslStruct
 *
 * @property {vec3} diffuse Incoming light that scatters evenly in all directions.
 * @property {float} specular Intensity of incoming light reflecting in a single direction.
 * @property {float} shininess The sharpness of the specular reflection.  Higher values create a smaller, more focused specular highlight.
 * @property {vec3} normal Surface's normal in eye coordinates. It is used for effects such as normal mapping. The default is the surface's unmodified normal.
 * @property {vec3} emission Light emitted by the material equally in all directions. The default is vec3(0.0), which emits no light.
 * @property {float} alpha Alpha of this material. 0.0 is completely transparent; 1.0 is completely opaque.
 */
struct czm_material
{
    vec3 diffuse;
    float specular;
    float shininess;
    vec3 normal;
    vec3 emission;
    float alpha;
};
`;var jR=`/**
 * Used as input to every material's czm_getMaterial function.
 *
 * @name czm_materialInput
 * @glslStruct
 *
 * @property {float} s 1D texture coordinates.
 * @property {vec2} st 2D texture coordinates.
 * @property {vec3} str 3D texture coordinates.
 * @property {vec3} normalEC Unperturbed surface normal in eye coordinates.
 * @property {mat3} tangentToEyeMatrix Matrix for converting a tangent space normal to eye space.
 * @property {vec3} positionToEyeEC Vector from the fragment to the eye in eye coordinates.  The magnitude is the distance in meters from the fragment to the eye.
 * @property {float} height The height of the terrain in meters above or below the ellipsoid.  Only available for globe materials.
 * @property {float} slope The slope of the terrain in radians.  0 is flat; pi/2 is vertical.  Only available for globe materials.
 * @property {float} aspect The aspect of the terrain in radians.  0 is East, pi/2 is North, pi is West, 3pi/2 is South.  Only available for globe materials.
* @property {float} waterMask The value of the water mask. 0 is land, 1 is water. Only available for globe materials.
 */
struct czm_materialInput
{
    float s;
    vec2 st;
    vec3 str;
    vec3 normalEC;
    mat3 tangentToEyeMatrix;
    vec3 positionToEyeEC;
    float height;
    float slope;
    float aspect;
    float waterMask;
};
`;var qR=`/**
 * Struct for representing a material for a {@link Model}. The model
 * rendering pipeline will pass this struct between material, custom shaders,
 * and lighting stages. This is not to be confused with {@link czm_material}
 * which is used by the older Fabric materials system, although they are similar.
 * <p>
 * All color values (diffuse, specular, emissive) are in linear color space.
 * </p>
 *
 * @name czm_modelMaterial
 * @glslStruct
 *
 * @property {vec4} baseColor The base color of the material.
 * @property {vec3} diffuse Incoming light that scatters evenly in all directions.
 * @property {float} alpha Alpha of this material. 0.0 is completely transparent; 1.0 is completely opaque.
 * @property {vec3} specular Color of reflected light at normal incidence in PBR materials. This is sometimes referred to as f0 in the literature.
 * @property {float} roughness A number from 0.0 to 1.0 representing how rough the surface is. Values near 0.0 produce glossy surfaces, while values near 1.0 produce rough surfaces.
 * @property {vec3} normalEC Surface's normal in eye coordinates. It is used for effects such as normal mapping. The default is the surface's unmodified normal.
 * @property {float} occlusion Ambient occlusion recieved at this point on the material. 1.0 means fully lit, 0.0 means fully occluded.
 * @property {vec3} emissive Light emitted by the material equally in all directions. The default is vec3(0.0), which emits no light.
 */
struct czm_modelMaterial {
    vec4 baseColor;
    vec3 diffuse;
    float alpha;
    vec3 specular;
    float roughness;
    vec3 normalEC;
    float occlusion;
    vec3 emissive;
#ifdef USE_SPECULAR
    float specularWeight;
#endif
#ifdef USE_ANISOTROPY
    vec3 anisotropicT;
    vec3 anisotropicB;
    float anisotropyStrength;
#endif
#ifdef USE_CLEARCOAT
    float clearcoatFactor;
    float clearcoatRoughness;
    vec3 clearcoatNormal;
    // Add clearcoatF0 when KHR_materials_ior is implemented
#endif
};
`;var YR=`/**
 * Struct for representing the output of a custom vertex shader.
 * 
 * @name czm_modelVertexOutput
 * @glslStruct
 *
 * @see {@link CustomShader}
 * @see {@link Model}
 *
 * @property {vec3} positionMC The position of the vertex in model coordinates
 * @property {float} pointSize A custom value for gl_PointSize. This is only used for point primitives. 
 */
struct czm_modelVertexOutput {
  vec3 positionMC;
  float pointSize;
};
`;var XR=`/**
 * DOC_TBA
 *
 * @name czm_ray
 * @glslStruct
 */
struct czm_ray
{
    vec3 origin;
    vec3 direction;
};
`;var KR=`/**
 * DOC_TBA
 *
 * @name czm_raySegment
 * @glslStruct
 */
struct czm_raySegment
{
    float start;
    float stop;
};

/**
 * DOC_TBA
 *
 * @name czm_emptyRaySegment
 * @glslConstant 
 */
const czm_raySegment czm_emptyRaySegment = czm_raySegment(-czm_infinity, -czm_infinity);

/**
 * DOC_TBA
 *
 * @name czm_fullRaySegment
 * @glslConstant 
 */
const czm_raySegment czm_fullRaySegment = czm_raySegment(0.0, czm_infinity);
`;var ZR=`struct czm_shadowParameters
{
#ifdef USE_CUBE_MAP_SHADOW
    vec3 texCoords;
#else
    vec2 texCoords;
#endif

    float depthBias;
    float depth;
    float nDotL;
    vec2 texelStepSize;
    float normalShadingSmooth;
    float darkness;
};
`;var $R=`// See:
//    https://knarkowicz.wordpress.com/2016/01/06/aces-filmic-tone-mapping-curve/

vec3 czm_acesTonemapping(vec3 color) {
    float g = 0.985;
    float a = 0.065;
    float b = 0.0001;
    float c = 0.433;
    float d = 0.238;

    color = (color * (color + a) - b) / (color * (g * color + c) + d);

    color = clamp(color, 0.0, 1.0);

    return color;
}
`;var QR=`/**
 * @private
 */
float czm_alphaWeight(float a)
{
    float z = (gl_FragCoord.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];

    // See Weighted Blended Order-Independent Transparency for examples of different weighting functions:
    // http://jcgt.org/published/0002/02/09/
    return pow(a + 0.01, 4.0) + max(1e-2, min(3.0 * 1e3, 0.003 / (1e-5 + pow(abs(z) / 200.0, 4.0))));
}
`;var JR=`/**
 * Procedural anti-aliasing by blurring two colors that meet at a sharp edge.
 *
 * @name czm_antialias
 * @glslFunction
 *
 * @param {vec4} color1 The color on one side of the edge.
 * @param {vec4} color2 The color on the other side of the edge.
 * @param {vec4} currentcolor The current color, either <code>color1</code> or <code>color2</code>.
 * @param {float} dist The distance to the edge in texture coordinates.
 * @param {float} [fuzzFactor=0.1] Controls the blurriness between the two colors.
 * @returns {vec4} The anti-aliased color.
 *
 * @example
 * // GLSL declarations
 * vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist, float fuzzFactor);
 * vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist);
 *
 * // get the color for a material that has a sharp edge at the line y = 0.5 in texture space
 * float dist = abs(textureCoordinates.t - 0.5);
 * vec4 currentColor = mix(bottomColor, topColor, step(0.5, textureCoordinates.t));
 * vec4 color = czm_antialias(bottomColor, topColor, currentColor, dist, 0.1);
 */
vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist, float fuzzFactor)
{
    float val1 = clamp(dist / fuzzFactor, 0.0, 1.0);
    float val2 = clamp((dist - 0.5) / fuzzFactor, 0.0, 1.0);
    val1 = val1 * (1.0 - val2);
    val1 = val1 * val1 * (3.0 - (2.0 * val1));
    val1 = pow(val1, 0.5); //makes the transition nicer
    
    vec4 midColor = (color1 + color2) * 0.5;
    return mix(midColor, currentColor, val1);
}

vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist)
{
    return czm_antialias(color1, color2, currentColor, dist, 0.1);
}
`;var eO=`/**
 * Apply a HSB color shift to an RGB color.
 *
 * @param {vec3} rgb The color in RGB space.
 * @param {vec3} hsbShift The amount to shift each component. The xyz components correspond to hue, saturation, and brightness. Shifting the hue by +/- 1.0 corresponds to shifting the hue by a full cycle. Saturation and brightness are clamped between 0 and 1 after the adjustment
 * @param {bool} ignoreBlackPixels If true, black pixels will be unchanged. This is necessary in some shaders such as atmosphere-related effects.
 *
 * @return {vec3} The RGB color after shifting in HSB space and clamping saturation and brightness to a valid range.
 */
vec3 czm_applyHSBShift(vec3 rgb, vec3 hsbShift, bool ignoreBlackPixels) {
    // Convert rgb color to hsb
    vec3 hsb = czm_RGBToHSB(rgb);

    // Perform hsb shift
    // Hue cycles around so no clamp is needed.
    hsb.x += hsbShift.x; // hue
    hsb.y = clamp(hsb.y + hsbShift.y, 0.0, 1.0); // saturation

    // brightness
    //
    // Some shaders such as atmosphere-related effects need to leave black
    // pixels unchanged
    if (ignoreBlackPixels) {
        hsb.z = hsb.z > czm_epsilon7 ? hsb.z + hsbShift.z : 0.0;
    } else {
        hsb.z = hsb.z + hsbShift.z;
    }
    hsb.z = clamp(hsb.z, 0.0, 1.0);

    // Convert shifted hsb back to rgb
    return czm_HSBToRGB(hsb);
}
`;var tO=`/**
 * Approximately computes spherical coordinates given a normal.
 * Uses approximate inverse trigonometry for speed and consistency,
 * since inverse trigonometry can differ from vendor-to-vendor and when compared with the CPU.
 *
 * @name czm_approximateSphericalCoordinates
 * @glslFunction
 *
 * @param {vec3} normal arbitrary-length normal.
 *
 * @returns {vec2} Approximate latitude and longitude spherical coordinates.
 */
vec2 czm_approximateSphericalCoordinates(vec3 normal) {
    // Project into plane with vertical for latitude
    float latitudeApproximation = czm_fastApproximateAtan(sqrt(normal.x * normal.x + normal.y * normal.y), normal.z);
    float longitudeApproximation = czm_fastApproximateAtan(normal.x, normal.y);
    return vec2(latitudeApproximation, longitudeApproximation);
}
`;var nO=`/**
 * Compute a rational approximation to tanh(x)
 *
 * @param {float} x A real number input
 * @returns {float} An approximation for tanh(x)
*/
float czm_approximateTanh(float x) {
    float x2 = x * x;
    return max(-1.0, min(1.0, x * (27.0 + x2) / (27.0 + 9.0 * x2)));
}
`;var iO=`/**
 * Determines if the fragment is back facing
 *
 * @name czm_backFacing
 * @glslFunction 
 * 
 * @returns {bool} <code>true</code> if the fragment is back facing; otherwise, <code>false</code>.
 */
bool czm_backFacing()
{
    // !gl_FrontFacing doesn't work as expected on Mac/Intel so use the more verbose form instead. See https://github.com/CesiumGS/cesium/pull/8494.
    return gl_FrontFacing == false;
}
`;var oO=`/**
 * Branchless ternary operator to be used when it's inexpensive to explicitly
 * evaluate both possibilities for a float expression.
 *
 * @name czm_branchFreeTernary
 * @glslFunction
 *
 * @param {bool} comparison A comparison statement
 * @param {float} a Value to return if the comparison is true.
 * @param {float} b Value to return if the comparison is false.
 *
 * @returns {float} equivalent of comparison ? a : b
 */
float czm_branchFreeTernary(bool comparison, float a, float b) {
    float useA = float(comparison);
    return a * useA + b * (1.0 - useA);
}

/**
 * Branchless ternary operator to be used when it's inexpensive to explicitly
 * evaluate both possibilities for a vec2 expression.
 *
 * @name czm_branchFreeTernary
 * @glslFunction
 *
 * @param {bool} comparison A comparison statement
 * @param {vec2} a Value to return if the comparison is true.
 * @param {vec2} b Value to return if the comparison is false.
 *
 * @returns {vec2} equivalent of comparison ? a : b
 */
vec2 czm_branchFreeTernary(bool comparison, vec2 a, vec2 b) {
    float useA = float(comparison);
    return a * useA + b * (1.0 - useA);
}

/**
 * Branchless ternary operator to be used when it's inexpensive to explicitly
 * evaluate both possibilities for a vec3 expression.
 *
 * @name czm_branchFreeTernary
 * @glslFunction
 *
 * @param {bool} comparison A comparison statement
 * @param {vec3} a Value to return if the comparison is true.
 * @param {vec3} b Value to return if the comparison is false.
 *
 * @returns {vec3} equivalent of comparison ? a : b
 */
vec3 czm_branchFreeTernary(bool comparison, vec3 a, vec3 b) {
    float useA = float(comparison);
    return a * useA + b * (1.0 - useA);
}

/**
 * Branchless ternary operator to be used when it's inexpensive to explicitly
 * evaluate both possibilities for a vec4 expression.
 *
 * @name czm_branchFreeTernary
 * @glslFunction
 *
 * @param {bool} comparison A comparison statement
 * @param {vec3} a Value to return if the comparison is true.
 * @param {vec3} b Value to return if the comparison is false.
 *
 * @returns {vec3} equivalent of comparison ? a : b
 */
vec4 czm_branchFreeTernary(bool comparison, vec4 a, vec4 b) {
    float useA = float(comparison);
    return a * useA + b * (1.0 - useA);
}
`;var rO=`
vec4 czm_cascadeColor(vec4 weights)
{
    return vec4(1.0, 0.0, 0.0, 1.0) * weights.x +
           vec4(0.0, 1.0, 0.0, 1.0) * weights.y +
           vec4(0.0, 0.0, 1.0, 1.0) * weights.z +
           vec4(1.0, 0.0, 1.0, 1.0) * weights.w;
}
`;var sO=`
uniform vec4 shadowMap_cascadeDistances;

float czm_cascadeDistance(vec4 weights)
{
    return dot(shadowMap_cascadeDistances, weights);
}
`;var aO=`
uniform mat4 shadowMap_cascadeMatrices[4];

mat4 czm_cascadeMatrix(vec4 weights)
{
    return shadowMap_cascadeMatrices[0] * weights.x +
           shadowMap_cascadeMatrices[1] * weights.y +
           shadowMap_cascadeMatrices[2] * weights.z +
           shadowMap_cascadeMatrices[3] * weights.w;
}
`;var cO=`
uniform vec4 shadowMap_cascadeSplits[2];

vec4 czm_cascadeWeights(float depthEye)
{
    // One component is set to 1.0 and all others set to 0.0.
    vec4 near = step(shadowMap_cascadeSplits[0], vec4(depthEye));
    vec4 far = step(depthEye, shadowMap_cascadeSplits[1]);
    return near * far;
}
`;var lO=`float getSignedDistance(vec2 uv, highp sampler2D clippingDistance) {
    float signedDistance = texture(clippingDistance, uv).r;
    return (signedDistance - 0.5) * 2.0;
}

void czm_clipPolygons(highp sampler2D clippingDistance, int extentsLength, vec2 clippingPosition, int regionIndex) {
    // Position is completely outside of polygons bounds
    vec2 rectUv = clippingPosition;
    if (regionIndex < 0 || rectUv.x <= 0.0 || rectUv.y <= 0.0 || rectUv.x >= 1.0 || rectUv.y >= 1.0) {
        #ifdef CLIPPING_INVERSE 
            discard;
        #endif
        return;
    }

    vec2 clippingDistanceTextureDimensions = vec2(textureSize(clippingDistance, 0));
    vec2 sampleOffset = max(1.0 / clippingDistanceTextureDimensions, vec2(0.005));
    float dimension = float(extentsLength);
    if (extentsLength > 2) {
       dimension = ceil(log2(float(extentsLength)));
    }

    vec2 textureOffset = vec2(mod(float(regionIndex), dimension), floor(float(regionIndex) / dimension)) / dimension;
    vec2 uv = textureOffset + rectUv / dimension;

    float signedDistance = getSignedDistance(uv, clippingDistance);

    #ifdef CLIPPING_INVERSE
    if (signedDistance > 0.0)  {
        discard;
    }
    #else
    if (signedDistance < 0.0)  {
        discard;
    }
    #endif
}
`;var uO=`/**
 * DOC_TBA
 *
 * @name czm_columbusViewMorph
 * @glslFunction
 */
vec4 czm_columbusViewMorph(vec4 position2D, vec4 position3D, float time)
{
    // Just linear for now.
    vec3 p = mix(position2D.xyz, position3D.xyz, time);
    return vec4(p, 1.0);
}
`;var fO=`/**
 * Compute the atmosphere color, applying Rayleigh and Mie scattering. This
 * builtin uses automatic uniforms so the atmophere settings are synced with the
 * state of the Scene, even in other contexts like Model.
 *
 * @name czm_computeAtmosphereColor
 * @glslFunction
 *
 * @param {vec3} positionWC Position of the fragment in world coords (low precision)
 * @param {vec3} lightDirection Light direction from the sun or other light source.
 * @param {vec3} rayleighColor The Rayleigh scattering color computed by a scattering function
 * @param {vec3} mieColor The Mie scattering color computed by a scattering function
 * @param {float} opacity The opacity computed by a scattering function.
 */
vec4 czm_computeAtmosphereColor(
    vec3 positionWC,
    vec3 lightDirection,
    vec3 rayleighColor,
    vec3 mieColor,
    float opacity
) {
    // Setup the primary ray: from the camera position to the vertex position.
    vec3 cameraToPositionWC = positionWC - czm_viewerPositionWC;
    vec3 cameraToPositionWCDirection = normalize(cameraToPositionWC);

    float cosAngle = dot(cameraToPositionWCDirection, lightDirection);
    float cosAngleSq = cosAngle * cosAngle;

    float G = czm_atmosphereMieAnisotropy;
    float GSq = G * G;

    // The Rayleigh phase function.
    float rayleighPhase = 3.0 / (50.2654824574) * (1.0 + cosAngleSq);
    // The Mie phase function.
    float miePhase = 3.0 / (25.1327412287) * ((1.0 - GSq) * (cosAngleSq + 1.0)) / (pow(1.0 + GSq - 2.0 * cosAngle * G, 1.5) * (2.0 + GSq));

    // The final color is generated by combining the effects of the Rayleigh and Mie scattering.
    vec3 rayleigh = rayleighPhase * rayleighColor;
    vec3 mie = miePhase * mieColor;

    vec3 color = (rayleigh + mie) * czm_atmosphereLightIntensity;

    return vec4(color, opacity);
}

/**
 * Compute the atmosphere color, applying Rayleigh and Mie scattering. This
 * builtin uses automatic uniforms so the atmophere settings are synced with the
 * state of the Scene, even in other contexts like Model.
 *
 * @name czm_computeAtmosphereColor
 * @glslFunction
 *
 * @param {czm_ray} primaryRay Ray from the origin to sky fragment to in world coords (low precision)
 * @param {vec3} lightDirection Light direction from the sun or other light source.
 * @param {vec3} rayleighColor The Rayleigh scattering color computed by a scattering function
 * @param {vec3} mieColor The Mie scattering color computed by a scattering function
 * @param {float} opacity The opacity computed by a scattering function.
 */
vec4 czm_computeAtmosphereColor(
    czm_ray primaryRay,
    vec3 lightDirection,
    vec3 rayleighColor,
    vec3 mieColor,
    float opacity
) {
    vec3 direction = normalize(primaryRay.direction);

    float cosAngle = dot(direction, lightDirection);
    float cosAngleSq = cosAngle * cosAngle;

    float G = czm_atmosphereMieAnisotropy;
    float GSq = G * G;

    // The Rayleigh phase function.
    float rayleighPhase = 3.0 / (50.2654824574) * (1.0 + cosAngleSq);
    // The Mie phase function.
    float miePhase = 3.0 / (25.1327412287) * ((1.0 - GSq) * (cosAngleSq + 1.0)) / (pow(1.0 + GSq - 2.0 * cosAngle * G, 1.5) * (2.0 + GSq));

    // The final color is generated by combining the effects of the Rayleigh and Mie scattering.
    vec3 rayleigh = rayleighPhase * rayleighColor;
    vec3 mie = miePhase * mieColor;

    vec3 color = (rayleigh + mie) * czm_atmosphereLightIntensity;

    return vec4(color, opacity);
}

`;var dO=`/**
 * Compute atmosphere scattering for the ground atmosphere and fog. This method
 * uses automatic uniforms so it is always synced with the scene settings.
 *
 * @name czm_computeGroundAtmosphereScattering
 * @glslfunction
 *
 * @param {vec3} positionWC The position of the fragment in world coordinates.
 * @param {vec3} lightDirection The direction of the light to calculate the scattering from.
 * @param {vec3} rayleighColor The variable the Rayleigh scattering will be written to.
 * @param {vec3} mieColor The variable the Mie scattering will be written to.
 * @param {float} opacity The variable the transmittance will be written to.
 */
void czm_computeGroundAtmosphereScattering(vec3 positionWC, vec3 lightDirection, out vec3 rayleighColor, out vec3 mieColor, out float opacity) {
    vec3 cameraToPositionWC = positionWC - czm_viewerPositionWC;
    vec3 cameraToPositionWCDirection = normalize(cameraToPositionWC);
    czm_ray primaryRay = czm_ray(czm_viewerPositionWC, cameraToPositionWCDirection);

    float atmosphereInnerRadius = length(positionWC);

    czm_computeScattering(
        primaryRay,
        length(cameraToPositionWC),
        lightDirection,
        atmosphereInnerRadius,
        rayleighColor,
        mieColor,
        opacity
    );
}
`;var hO=`/**
 * Returns a position in model coordinates relative to eye taking into
 * account the current scene mode: 3D, 2D, or Columbus view.
 * <p>
 * This uses standard position attributes, <code>position3DHigh</code>, 
 * <code>position3DLow</code>, <code>position2DHigh</code>, and <code>position2DLow</code>, 
 * and should be used when writing a vertex shader for an {@link Appearance}.
 * </p>
 *
 * @name czm_computePosition
 * @glslFunction
 *
 * @returns {vec4} The position relative to eye.
 *
 * @example
 * vec4 p = czm_computePosition();
 * v_positionEC = (czm_modelViewRelativeToEye * p).xyz;
 * gl_Position = czm_modelViewProjectionRelativeToEye * p;
 *
 * @see czm_translateRelativeToEye
 */
vec4 czm_computePosition();
`;var mO=`/**
 * This function computes the colors contributed by Rayliegh and Mie scattering on a given ray, as well as
 * the transmittance value for the ray. This function uses automatic uniforms
 * so the atmosphere settings are always synced with the current scene.
 *
 * @name czm_computeScattering
 * @glslfunction
 *
 * @param {czm_ray} primaryRay The ray from the camera to the position.
 * @param {float} primaryRayLength The length of the primary ray.
 * @param {vec3} lightDirection The direction of the light to calculate the scattering from.
 * @param {vec3} rayleighColor The variable the Rayleigh scattering will be written to.
 * @param {vec3} mieColor The variable the Mie scattering will be written to.
 * @param {float} opacity The variable the transmittance will be written to.
 */
void czm_computeScattering(
    czm_ray primaryRay,
    float primaryRayLength,
    vec3 lightDirection,
    float atmosphereInnerRadius,
    out vec3 rayleighColor,
    out vec3 mieColor,
    out float opacity
) {
    const float ATMOSPHERE_THICKNESS = 111e3; // The thickness of the atmosphere in meters.
    const int PRIMARY_STEPS_MAX = 16; // Maximum number of times the ray from the camera to the world position (primary ray) is sampled.
    const int LIGHT_STEPS_MAX = 4; // Maximum number of times the light is sampled from the light source's intersection with the atmosphere to a sample position on the primary ray.

    // Initialize the default scattering amounts to 0.
    rayleighColor = vec3(0.0);
    mieColor = vec3(0.0);
    opacity = 0.0;

    float atmosphereOuterRadius = atmosphereInnerRadius + ATMOSPHERE_THICKNESS;

    vec3 origin = vec3(0.0);

    // Calculate intersection from the camera to the outer ring of the atmosphere.
    czm_raySegment primaryRayAtmosphereIntersect = czm_raySphereIntersectionInterval(primaryRay, origin, atmosphereOuterRadius);

    // Return empty colors if no intersection with the atmosphere geometry.
    if (primaryRayAtmosphereIntersect == czm_emptyRaySegment) {
        return;
    }

    // To deal with smaller values of PRIMARY_STEPS (e.g. 4)
    // we implement a split strategy: sky or horizon.
    // For performance reasons, instead of a if/else branch
    // a soft choice is implemented through a weight 0.0 <= w_stop_gt_lprl <= 1.0
    float x = 1e-7 * primaryRayAtmosphereIntersect.stop / length(primaryRayLength);
    // Value close to 0.0: close to the horizon
    // Value close to 1.0: above in the sky
    float w_stop_gt_lprl = 0.5 * (1.0 + czm_approximateTanh(x));

    // The ray should start from the first intersection with the outer atmopshere, or from the camera position, if it is inside the atmosphere.
    float start_0 = primaryRayAtmosphereIntersect.start;
    primaryRayAtmosphereIntersect.start = max(primaryRayAtmosphereIntersect.start, 0.0);
    // The ray should end at the exit from the atmosphere or at the distance to the vertex, whichever is smaller.
    primaryRayAtmosphereIntersect.stop = min(primaryRayAtmosphereIntersect.stop, length(primaryRayLength));

    // For the number of ray steps, distinguish inside or outside atmosphere (outer space)
    // (1) from outer space we have to use more ray steps to get a realistic rendering
    // (2) within atmosphere we need fewer steps for faster rendering
    float x_o_a = start_0 - ATMOSPHERE_THICKNESS; // ATMOSPHERE_THICKNESS used as an ad-hoc constant, no precise meaning here, only the order of magnitude matters
    float w_inside_atmosphere = 1.0 - 0.5 * (1.0 + czm_approximateTanh(x_o_a));
    int PRIMARY_STEPS = PRIMARY_STEPS_MAX - int(w_inside_atmosphere * 12.0); // Number of times the ray from the camera to the world position (primary ray) is sampled.
    int LIGHT_STEPS = LIGHT_STEPS_MAX - int(w_inside_atmosphere * 2.0); // Number of times the light is sampled from the light source's intersection with the atmosphere to a sample position on the primary ray.

    // Setup for sampling positions along the ray - starting from the intersection with the outer ring of the atmosphere.
    float rayPositionLength = primaryRayAtmosphereIntersect.start;
    // (1) Outside the atmosphere: constant rayStepLength
    // (2) Inside atmosphere: variable rayStepLength to compensate the rough rendering of the smaller number of ray steps
    float totalRayLength = primaryRayAtmosphereIntersect.stop - rayPositionLength;
    float rayStepLengthIncrease = w_inside_atmosphere * ((1.0 - w_stop_gt_lprl) * totalRayLength / (float(PRIMARY_STEPS * (PRIMARY_STEPS + 1)) / 2.0));
    float rayStepLength = max(1.0 - w_inside_atmosphere, w_stop_gt_lprl) * totalRayLength / max(7.0 * w_inside_atmosphere, float(PRIMARY_STEPS));

    vec3 rayleighAccumulation = vec3(0.0);
    vec3 mieAccumulation = vec3(0.0);
    vec2 opticalDepth = vec2(0.0);
    vec2 heightScale = vec2(czm_atmosphereRayleighScaleHeight, czm_atmosphereMieScaleHeight);

    // Sample positions on the primary ray.
    for (int i = 0; i < PRIMARY_STEPS_MAX; ++i) {

        // The loop should be: for (int i = 0; i < PRIMARY_STEPS; ++i) {...} but WebGL1 cannot
        // loop with non-constant condition, so it has to break early instead
        if (i >= PRIMARY_STEPS) {
            break;
        }

        // Calculate sample position along viewpoint ray.
        vec3 samplePosition = primaryRay.origin + primaryRay.direction * (rayPositionLength + rayStepLength);

        // Calculate height of sample position above ellipsoid.
        float sampleHeight = length(samplePosition) - atmosphereInnerRadius;

        // Calculate and accumulate density of particles at the sample position.
        vec2 sampleDensity = exp(-sampleHeight / heightScale) * rayStepLength;
        opticalDepth += sampleDensity;

        // Generate ray from the sample position segment to the light source, up to the outer ring of the atmosphere.
        czm_ray lightRay = czm_ray(samplePosition, lightDirection);
        czm_raySegment lightRayAtmosphereIntersect = czm_raySphereIntersectionInterval(lightRay, origin, atmosphereOuterRadius);

        float lightStepLength = lightRayAtmosphereIntersect.stop / float(LIGHT_STEPS);
        float lightPositionLength = 0.0;

        vec2 lightOpticalDepth = vec2(0.0);

        // Sample positions along the light ray, to accumulate incidence of light on the latest sample segment.
        for (int j = 0; j < LIGHT_STEPS_MAX; ++j) {

            // The loop should be: for (int j = 0; i < LIGHT_STEPS; ++j) {...} but WebGL1 cannot
            // loop with non-constant condition, so it has to break early instead
            if (j >= LIGHT_STEPS) {
                break;
            }

            // Calculate sample position along light ray.
            vec3 lightPosition = samplePosition + lightDirection * (lightPositionLength + lightStepLength * 0.5);

            // Calculate height of the light sample position above ellipsoid.
            float lightHeight = length(lightPosition) - atmosphereInnerRadius;

            // Calculate density of photons at the light sample position.
            lightOpticalDepth += exp(-lightHeight / heightScale) * lightStepLength;

            // Increment distance on light ray.
            lightPositionLength += lightStepLength;
        }

        // Compute attenuation via the primary ray and the light ray.
        vec3 attenuation = exp(-((czm_atmosphereMieCoefficient * (opticalDepth.y + lightOpticalDepth.y)) + (czm_atmosphereRayleighCoefficient * (opticalDepth.x + lightOpticalDepth.x))));

        // Accumulate the scattering.
        rayleighAccumulation += sampleDensity.x * attenuation;
        mieAccumulation += sampleDensity.y * attenuation;

        // Increment distance on primary ray.
        rayPositionLength += (rayStepLength += rayStepLengthIncrease);
    }

    // Compute the scattering amount.
    rayleighColor = czm_atmosphereRayleighCoefficient * rayleighAccumulation;
    mieColor = czm_atmosphereMieCoefficient * mieAccumulation;

    // Compute the transmittance i.e. how much light is passing through the atmosphere.
    opacity = length(exp(-((czm_atmosphereMieCoefficient * opticalDepth.y) + (czm_atmosphereRayleighCoefficient * opticalDepth.x))));
}
`;var pO=`/**
 * @private
 */
vec2 cordic(float angle)
{
// Scale the vector by the appropriate factor for the 24 iterations to follow.
    vec2 vector = vec2(6.0725293500888267e-1, 0.0);
// Iteration 1
    float sense = (angle < 0.0) ? -1.0 : 1.0;
 //   float factor = sense * 1.0;  // 2^-0
    mat2 rotation = mat2(1.0, sense, -sense, 1.0);
    vector = rotation * vector;
    angle -= sense * 7.8539816339744828e-1;  // atan(2^-0)
// Iteration 2
    sense = (angle < 0.0) ? -1.0 : 1.0;
    float factor = sense * 5.0e-1;  // 2^-1
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 4.6364760900080609e-1;  // atan(2^-1)
// Iteration 3
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 2.5e-1;  // 2^-2
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 2.4497866312686414e-1;  // atan(2^-2)
// Iteration 4
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 1.25e-1;  // 2^-3
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 1.2435499454676144e-1;  // atan(2^-3)
// Iteration 5
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 6.25e-2;  // 2^-4
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 6.2418809995957350e-2;  // atan(2^-4)
// Iteration 6
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 3.125e-2;  // 2^-5
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 3.1239833430268277e-2;  // atan(2^-5)
// Iteration 7
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 1.5625e-2;  // 2^-6
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 1.5623728620476831e-2;  // atan(2^-6)
// Iteration 8
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 7.8125e-3;  // 2^-7
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 7.8123410601011111e-3;  // atan(2^-7)
// Iteration 9
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 3.90625e-3;  // 2^-8
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 3.9062301319669718e-3;  // atan(2^-8)
// Iteration 10
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 1.953125e-3;  // 2^-9
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 1.9531225164788188e-3;  // atan(2^-9)
// Iteration 11
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 9.765625e-4;  // 2^-10
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 9.7656218955931946e-4;  // atan(2^-10)
// Iteration 12
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 4.8828125e-4;  // 2^-11
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 4.8828121119489829e-4;  // atan(2^-11)
// Iteration 13
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 2.44140625e-4;  // 2^-12
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 2.4414062014936177e-4;  // atan(2^-12)
// Iteration 14
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 1.220703125e-4;  // 2^-13
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 1.2207031189367021e-4;  // atan(2^-13)
// Iteration 15
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 6.103515625e-5;  // 2^-14
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 6.1035156174208773e-5;  // atan(2^-14)
// Iteration 16
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 3.0517578125e-5;  // 2^-15
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 3.0517578115526096e-5;  // atan(2^-15)
// Iteration 17
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 1.52587890625e-5;  // 2^-16
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 1.5258789061315762e-5;  // atan(2^-16)
// Iteration 18
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 7.62939453125e-6;  // 2^-17
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 7.6293945311019700e-6;  // atan(2^-17)
// Iteration 19
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 3.814697265625e-6;  // 2^-18
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 3.8146972656064961e-6;  // atan(2^-18)
// Iteration 20
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 1.9073486328125e-6;  // 2^-19
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 1.9073486328101870e-6;  // atan(2^-19)
// Iteration 21
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 9.5367431640625e-7;  // 2^-20
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 9.5367431640596084e-7;  // atan(2^-20)
// Iteration 22
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 4.76837158203125e-7;  // 2^-21
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 4.7683715820308884e-7;  // atan(2^-21)
// Iteration 23
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 2.384185791015625e-7;  // 2^-22
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
    angle -= sense * 2.3841857910155797e-7;  // atan(2^-22)
// Iteration 24
    sense = (angle < 0.0) ? -1.0 : 1.0;
    factor = sense * 1.1920928955078125e-7;  // 2^-23
    rotation[0][1] = factor;
    rotation[1][0] = -factor;
    vector = rotation * vector;
//    angle -= sense * 1.1920928955078068e-7;  // atan(2^-23)

    return vector;
}

/**
 * Computes the cosine and sine of the provided angle using the CORDIC algorithm.
 *
 * @name czm_cosineAndSine
 * @glslFunction
 *
 * @param {float} angle The angle in radians.
 *
 * @returns {vec2} The resulting cosine of the angle (as the x coordinate) and sine of the angle (as the y coordinate).
 *
 * @example
 * vec2 v = czm_cosineAndSine(czm_piOverSix);
 * float cosine = v.x;
 * float sine = v.y;
 */
vec2 czm_cosineAndSine(float angle)
{
    if (angle < -czm_piOverTwo || angle > czm_piOverTwo)
    {
        if (angle < 0.0)
        {
            return -cordic(angle + czm_pi);
        }
        else
        {
            return -cordic(angle - czm_pi);
        }
    }
    else
    {
        return cordic(angle);
    }
}
`;var _O=`/**
 * Decompresses texture coordinates that were packed into a single float.
 *
 * @name czm_decompressTextureCoordinates
 * @glslFunction
 *
 * @param {float} encoded The compressed texture coordinates.
 * @returns {vec2} The decompressed texture coordinates.
 */
 vec2 czm_decompressTextureCoordinates(float encoded)
 {
    float temp = encoded / 4096.0;
    float xZeroTo4095 = floor(temp);
    float stx = xZeroTo4095 / 4095.0;
    float sty = (encoded - xZeroTo4095 * 4096.0) / 4095.0;
    return vec2(stx, sty);
 }
`;var gO=`// emulated noperspective
#if (__VERSION__ == 300 || defined(GL_EXT_frag_depth)) && !defined(LOG_DEPTH)
out float v_WindowZ;
#endif

/**
 * Emulates GL_DEPTH_CLAMP, which is not available in WebGL 1 or 2.
 * GL_DEPTH_CLAMP clamps geometry that is outside the near and far planes, 
 * capping the shadow volume. More information here: 
 * https://www.khronos.org/registry/OpenGL/extensions/ARB/ARB_depth_clamp.txt.
 *
 * When GL_EXT_frag_depth is available we emulate GL_DEPTH_CLAMP by ensuring 
 * no geometry gets clipped by setting the clip space z value to 0.0 and then
 * sending the unaltered screen space z value (using emulated noperspective
 * interpolation) to the frag shader where it is clamped to [0,1] and then
 * written with gl_FragDepth (see czm_writeDepthClamp). This technique is based on:
 * https://stackoverflow.com/questions/5960757/how-to-emulate-gl-depth-clamp-nv.
 *
 * When GL_EXT_frag_depth is not available, which is the case on some mobile 
 * devices, we must attempt to fix this only in the vertex shader. 
 * The approach is to clamp the z value to the far plane, which closes the 
 * shadow volume but also distorts the geometry, so there can still be artifacts
 * on frustum seams.
 *
 * @name czm_depthClamp
 * @glslFunction
 *
 * @param {vec4} coords The vertex in clip coordinates.
 * @returns {vec4} The modified vertex.
 *
 * @example
 * gl_Position = czm_depthClamp(czm_modelViewProjection * vec4(position, 1.0));
 *
 * @see czm_writeDepthClamp
 */
vec4 czm_depthClamp(vec4 coords)
{
#ifndef LOG_DEPTH
#if __VERSION__ == 300 || defined(GL_EXT_frag_depth)
    v_WindowZ = (0.5 * (coords.z / coords.w) + 0.5) * coords.w;
    coords.z = 0.0;
#else
    coords.z = min(coords.z, coords.w);
#endif
#endif
    return coords;
}
`;var yO=`/**
 * Computes a 3x3 rotation matrix that transforms vectors from an ellipsoid's east-north-up coordinate system 
 * to eye coordinates.  In east-north-up coordinates, x points east, y points north, and z points along the 
 * surface normal.  East-north-up can be used as an ellipsoid's tangent space for operations such as bump mapping.
 * <br /><br />
 * The ellipsoid is assumed to be centered at the model coordinate's origin.
 *
 * @name czm_eastNorthUpToEyeCoordinates
 * @glslFunction
 *
 * @param {vec3} positionMC The position on the ellipsoid in model coordinates.
 * @param {vec3} normalEC The normalized ellipsoid surface normal, at <code>positionMC</code>, in eye coordinates.
 *
 * @returns {mat3} A 3x3 rotation matrix that transforms vectors from the east-north-up coordinate system to eye coordinates.
 *
 * @example
 * // Transform a vector defined in the east-north-up coordinate 
 * // system, (0, 0, 1) which is the surface normal, to eye 
 * // coordinates.
 * mat3 m = czm_eastNorthUpToEyeCoordinates(positionMC, normalEC);
 * vec3 normalEC = m * vec3(0.0, 0.0, 1.0);
 */
mat3 czm_eastNorthUpToEyeCoordinates(vec3 positionMC, vec3 normalEC)
{
    vec3 tangentMC = normalize(vec3(-positionMC.y, positionMC.x, 0.0));  // normalized surface tangent in model coordinates
    vec3 tangentEC = normalize(czm_normal3D * tangentMC);                // normalized surface tangent in eye coordinates
    vec3 bitangentEC = normalize(cross(normalEC, tangentEC));            // normalized surface bitangent in eye coordinates

    return mat3(
        tangentEC.x,   tangentEC.y,   tangentEC.z,
        bitangentEC.x, bitangentEC.y, bitangentEC.z,
        normalEC.x,    normalEC.y,    normalEC.z);
}
`;var xO=`/**
 * DOC_TBA
 *
 * @name czm_ellipsoidContainsPoint
 * @glslFunction
 *
 */
bool czm_ellipsoidContainsPoint(vec3 ellipsoid_inverseRadii, vec3 point)
{
    vec3 scaled = ellipsoid_inverseRadii * (czm_inverseModelView * vec4(point, 1.0)).xyz;
    return (dot(scaled, scaled) <= 1.0);
}
`;var bO=`/**
 * Approximate uv coordinates based on the ellipsoid normal.
 *
 * @name czm_ellipsoidTextureCoordinates
 * @glslFunction
 */
vec2 czm_ellipsoidTextureCoordinates(vec3 normal)
{
    return vec2(atan(normal.y, normal.x) * czm_oneOverTwoPi + 0.5, asin(normal.z) * czm_oneOverPi + 0.5);
}
`;var CO=`/**
 * Compares <code>left</code> and <code>right</code> componentwise. Returns <code>true</code>
 * if they are within <code>epsilon</code> and <code>false</code> otherwise. The inputs
 * <code>left</code> and <code>right</code> can be <code>float</code>s, <code>vec2</code>s,
 * <code>vec3</code>s, or <code>vec4</code>s.
 *
 * @name czm_equalsEpsilon
 * @glslFunction
 *
 * @param {} left The first vector.
 * @param {} right The second vector.
 * @param {float} epsilon The epsilon to use for equality testing.
 * @returns {bool} <code>true</code> if the components are within <code>epsilon</code> and <code>false</code> otherwise.
 *
 * @example
 * // GLSL declarations
 * bool czm_equalsEpsilon(float left, float right, float epsilon);
 * bool czm_equalsEpsilon(vec2 left, vec2 right, float epsilon);
 * bool czm_equalsEpsilon(vec3 left, vec3 right, float epsilon);
 * bool czm_equalsEpsilon(vec4 left, vec4 right, float epsilon);
 */
bool czm_equalsEpsilon(vec4 left, vec4 right, float epsilon) {
    return all(lessThanEqual(abs(left - right), vec4(epsilon)));
}

bool czm_equalsEpsilon(vec3 left, vec3 right, float epsilon) {
    return all(lessThanEqual(abs(left - right), vec3(epsilon)));
}

bool czm_equalsEpsilon(vec2 left, vec2 right, float epsilon) {
    return all(lessThanEqual(abs(left - right), vec2(epsilon)));
}

bool czm_equalsEpsilon(float left, float right, float epsilon) {
    return (abs(left - right) <= epsilon);
}
`;var AO=`/**
 * DOC_TBA
 *
 * @name czm_eyeOffset
 * @glslFunction
 *
 * @param {vec4} positionEC DOC_TBA.
 * @param {vec3} eyeOffset DOC_TBA.
 *
 * @returns {vec4} DOC_TBA.
 */
vec4 czm_eyeOffset(vec4 positionEC, vec3 eyeOffset)
{
    // This equation is approximate in x and y.
    vec4 p = positionEC;
    vec4 zEyeOffset = normalize(p) * eyeOffset.z;
    p.xy += eyeOffset.xy + zEyeOffset.xy;
    p.z += zEyeOffset.z;
    return p;
}
`;var TO=`/**
 * Transforms a position from eye to window coordinates.  The transformation
 * from eye to clip coordinates is done using {@link czm_projection}.
 * The transform from normalized device coordinates to window coordinates is
 * done using {@link czm_viewportTransformation}, which assumes a depth range
 * of <code>near = 0</code> and <code>far = 1</code>.
 * <br /><br />
 * This transform is useful when there is a need to manipulate window coordinates
 * in a vertex shader as done by {@link BillboardCollection}.
 *
 * @name czm_eyeToWindowCoordinates
 * @glslFunction
 *
 * @param {vec4} position The position in eye coordinates to transform.
 *
 * @returns {vec4} The transformed position in window coordinates.
 *
 * @see czm_modelToWindowCoordinates
 * @see czm_projection
 * @see czm_viewportTransformation
 * @see BillboardCollection
 *
 * @example
 * vec4 positionWC = czm_eyeToWindowCoordinates(positionEC);
 */
vec4 czm_eyeToWindowCoordinates(vec4 positionEC)
{
    vec4 q = czm_projection * positionEC;                        // clip coordinates
    q.xyz /= q.w;                                                // normalized device coordinates
    q.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz; // window coordinates
    return q;
}
`;var EO=`/**
 * Approxiamtes atan over the range [0, 1]. Safe to flip output for negative input.
 *
 * Based on Michal Drobot's approximation from ShaderFastLibs, which in turn is based on
 * "Efficient approximations for the arctangent function," Rajan, S. Sichun Wang Inkol, R. Joyal, A., May 2006.
 * Adapted from ShaderFastLibs under MIT License.
 *
 * Chosen for the following characteristics over range [0, 1]:
 * - basically no error at 0 and 1, important for getting around range limit (naive atan2 via atan requires infinite range atan)
 * - no visible artifacts from first-derivative discontinuities, unlike latitude via range-reduced sqrt asin approximations (at equator)
 *
 * The original code is x * (-0.1784 * abs(x) - 0.0663 * x * x + 1.0301);
 * Removed the abs() in here because it isn't needed, the input range is guaranteed as [0, 1] by how we're approximating atan2.
 *
 * @name czm_fastApproximateAtan
 * @glslFunction
 *
 * @param {float} x Value between 0 and 1 inclusive.
 *
 * @returns {float} Approximation of atan(x)
 */
float czm_fastApproximateAtan(float x) {
    return x * (-0.1784 * x - 0.0663 * x * x + 1.0301);
}

/**
 * Approximation of atan2.
 *
 * Range reduction math based on nvidia's cg reference implementation for atan2: http://developer.download.nvidia.com/cg/atan2.html
 * However, we replaced their atan curve with Michael Drobot's (see above).
 *
 * @name czm_fastApproximateAtan
 * @glslFunction
 *
 * @param {float} x Value between -1 and 1 inclusive.
 * @param {float} y Value between -1 and 1 inclusive.
 *
 * @returns {float} Approximation of atan2(x, y)
 */
float czm_fastApproximateAtan(float x, float y) {
    // atan approximations are usually only reliable over [-1, 1], or, in our case, [0, 1] due to modifications.
    // So range-reduce using abs and by flipping whether x or y is on top.
    float t = abs(x); // t used as swap and atan result.
    float opposite = abs(y);
    float adjacent = max(t, opposite);
    opposite = min(t, opposite);

    t = czm_fastApproximateAtan(opposite / adjacent);

    // Undo range reduction
    t = czm_branchFreeTernary(abs(y) > abs(x), czm_piOverTwo - t, t);
    t = czm_branchFreeTernary(x < 0.0, czm_pi - t, t);
    t = czm_branchFreeTernary(y < 0.0, -t, t);
    return t;
}
`;var SO=`/**
 * Gets the color with fog at a distance from the camera.
 *
 * @name czm_fog
 * @glslFunction
 *
 * @param {float} distanceToCamera The distance to the camera in meters.
 * @param {vec3} color The original color.
 * @param {vec3} fogColor The color of the fog.
 *
 * @returns {vec3} The color adjusted for fog at the distance from the camera.
 */
vec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor)
{
    float scalar = distanceToCamera * czm_fogDensity;
    float fog = 1.0 - exp(-(scalar * scalar));
    return mix(color, fogColor, fog);
}

/**
 * Gets the color with fog at a distance from the camera.
 *
 * @name czm_fog
 * @glslFunction
 *
 * @param {float} distanceToCamera The distance to the camera in meters.
 * @param {vec3} color The original color.
 * @param {vec3} fogColor The color of the fog.
 * @param {float} fogModifierConstant A constant to modify the appearance of fog.
 *
 * @returns {vec3} The color adjusted for fog at the distance from the camera.
 */
vec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor, float fogModifierConstant)
{
    float scalar = distanceToCamera * czm_fogDensity;
    float fog = 1.0 - exp(-((fogModifierConstant * scalar + fogModifierConstant) * (scalar * (1.0 + fogModifierConstant))));
    return mix(color, fogColor, fog);
}
`;var vO=`/**
 * Converts a color from RGB space to linear space.
 *
 * @name czm_gammaCorrect
 * @glslFunction
 *
 * @param {vec3} color The color in RGB space.
 * @returns {vec3} The color in linear space.
 */
vec3 czm_gammaCorrect(vec3 color) {
#ifdef HDR
    color = pow(color, vec3(czm_gamma));
#endif
    return color;
}

vec4 czm_gammaCorrect(vec4 color) {
#ifdef HDR
    color.rgb = pow(color.rgb, vec3(czm_gamma));
#endif
    return color;
}
`;var wO=`/**
 * DOC_TBA
 *
 * @name czm_geodeticSurfaceNormal
 * @glslFunction
 *
 * @param {vec3} positionOnEllipsoid DOC_TBA
 * @param {vec3} ellipsoidCenter DOC_TBA
 * @param {vec3} oneOverEllipsoidRadiiSquared DOC_TBA
 * 
 * @returns {vec3} DOC_TBA.
 */
vec3 czm_geodeticSurfaceNormal(vec3 positionOnEllipsoid, vec3 ellipsoidCenter, vec3 oneOverEllipsoidRadiiSquared)
{
    return normalize((positionOnEllipsoid - ellipsoidCenter) * oneOverEllipsoidRadiiSquared);
}
`;var DO=`/**
 * An czm_material with default values. Every material's czm_getMaterial
 * should use this default material as a base for the material it returns.
 * The default normal value is given by materialInput.normalEC.
 *
 * @name czm_getDefaultMaterial
 * @glslFunction
 *
 * @param {czm_materialInput} input The input used to construct the default material.
 *
 * @returns {czm_material} The default material.
 *
 * @see czm_materialInput
 * @see czm_material
 * @see czm_getMaterial
 */
czm_material czm_getDefaultMaterial(czm_materialInput materialInput)
{
    czm_material material;
    material.diffuse = vec3(0.0);
    material.specular = 0.0;
    material.shininess = 1.0;
    material.normal = materialInput.normalEC;
    material.emission = vec3(0.0);
    material.alpha = 1.0;
    return material;
}
`;var IO=`/**
 * Select which direction vector to use for dynamic atmosphere lighting based on an enum value
 *
 * @name czm_getDynamicAtmosphereLightDirection
 * @glslfunction
 * @see DynamicAtmosphereLightingType.js
 *
 * @param {vec3} positionWC the position of the vertex/fragment in world coordinates. This is normalized and returned when dynamic lighting is turned off.
 * @param {float} lightEnum The enum value for selecting between light sources.
 * @return {vec3} The normalized light direction vector. Depending on the enum value, it is either positionWC, czm_lightDirectionWC or czm_sunDirectionWC
 */
vec3 czm_getDynamicAtmosphereLightDirection(vec3 positionWC, float lightEnum) {
    const float NONE = 0.0;
    const float SCENE_LIGHT = 1.0;
    const float SUNLIGHT = 2.0;

    vec3 lightDirection =
        positionWC * float(lightEnum == NONE) +
        czm_lightDirectionWC * float(lightEnum == SCENE_LIGHT) +
        czm_sunDirectionWC * float(lightEnum == SUNLIGHT);
    return normalize(lightDirection);
}
`;var PO=`/**
 * Calculates the intensity of diffusely reflected light.
 *
 * @name czm_getLambertDiffuse
 * @glslFunction
 *
 * @param {vec3} lightDirectionEC Unit vector pointing to the light source in eye coordinates.
 * @param {vec3} normalEC The surface normal in eye coordinates.
 *
 * @returns {float} The intensity of the diffuse reflection.
 *
 * @see czm_phong
 *
 * @example
 * float diffuseIntensity = czm_getLambertDiffuse(lightDirectionEC, normalEC);
 * float specularIntensity = czm_getSpecular(lightDirectionEC, toEyeEC, normalEC, 200);
 * vec3 color = (diffuseColor * diffuseIntensity) + (specularColor * specularIntensity);
 */
float czm_getLambertDiffuse(vec3 lightDirectionEC, vec3 normalEC)
{
    return max(dot(lightDirectionEC, normalEC), 0.0);
}
`;var RO=`/**
 * Calculates the specular intensity of reflected light.
 *
 * @name czm_getSpecular
 * @glslFunction
 *
 * @param {vec3} lightDirectionEC Unit vector pointing to the light source in eye coordinates.
 * @param {vec3} toEyeEC Unit vector pointing to the eye position in eye coordinates.
 * @param {vec3} normalEC The surface normal in eye coordinates.
 * @param {float} shininess The sharpness of the specular reflection.  Higher values create a smaller, more focused specular highlight.
 *
 * @returns {float} The intensity of the specular highlight.
 *
 * @see czm_phong
 *
 * @example
 * float diffuseIntensity = czm_getLambertDiffuse(lightDirectionEC, normalEC);
 * float specularIntensity = czm_getSpecular(lightDirectionEC, toEyeEC, normalEC, 200);
 * vec3 color = (diffuseColor * diffuseIntensity) + (specularColor * specularIntensity);
 */
float czm_getSpecular(vec3 lightDirectionEC, vec3 toEyeEC, vec3 normalEC, float shininess)
{
    vec3 toReflectedLight = reflect(-lightDirectionEC, normalEC);
    float specular = max(dot(toReflectedLight, toEyeEC), 0.0);

    // pow has undefined behavior if both parameters <= 0.
    // Prevent this by making sure shininess is at least czm_epsilon2.
    return pow(specular, max(shininess, czm_epsilon2));
}
`;var OO=`/**
 * @private
 */
vec4 czm_getWaterNoise(sampler2D normalMap, vec2 uv, float time, float angleInRadians)
{
    float cosAngle = cos(angleInRadians);
    float sinAngle = sin(angleInRadians);

    // time dependent sampling directions
    vec2 s0 = vec2(1.0/17.0, 0.0);
    vec2 s1 = vec2(-1.0/29.0, 0.0);
    vec2 s2 = vec2(1.0/101.0, 1.0/59.0);
    vec2 s3 = vec2(-1.0/109.0, -1.0/57.0);

    // rotate sampling direction by specified angle
    s0 = vec2((cosAngle * s0.x) - (sinAngle * s0.y), (sinAngle * s0.x) + (cosAngle * s0.y));
    s1 = vec2((cosAngle * s1.x) - (sinAngle * s1.y), (sinAngle * s1.x) + (cosAngle * s1.y));
    s2 = vec2((cosAngle * s2.x) - (sinAngle * s2.y), (sinAngle * s2.x) + (cosAngle * s2.y));
    s3 = vec2((cosAngle * s3.x) - (sinAngle * s3.y), (sinAngle * s3.x) + (cosAngle * s3.y));

    vec2 uv0 = (uv/103.0) + (time * s0);
    vec2 uv1 = uv/107.0 + (time * s1) + vec2(0.23);
    vec2 uv2 = uv/vec2(897.0, 983.0) + (time * s2) + vec2(0.51);
    vec2 uv3 = uv/vec2(991.0, 877.0) + (time * s3) + vec2(0.71);

    uv0 = fract(uv0);
    uv1 = fract(uv1);
    uv2 = fract(uv2);
    uv3 = fract(uv3);
    vec4 noise = (texture(normalMap, uv0)) +
                 (texture(normalMap, uv1)) +
                 (texture(normalMap, uv2)) +
                 (texture(normalMap, uv3));

    // average and scale to between -1 and 1
    return ((noise / 4.0) - 0.5) * 2.0;
}
`;var MO=`/**
 * Converts an HSB color (hue, saturation, brightness) to RGB
 * HSB <-> RGB conversion with minimal branching: {@link http://lolengine.net/blog/2013/07/27/rgb-to-hsv-in-glsl}
 *
 * @name czm_HSBToRGB
 * @glslFunction
 * 
 * @param {vec3} hsb The color in HSB.
 *
 * @returns {vec3} The color in RGB.
 *
 * @example
 * vec3 hsb = czm_RGBToHSB(rgb);
 * hsb.z *= 0.1;
 * rgb = czm_HSBToRGB(hsb);
 */

const vec4 K_HSB2RGB = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);

vec3 czm_HSBToRGB(vec3 hsb)
{
    vec3 p = abs(fract(hsb.xxx + K_HSB2RGB.xyz) * 6.0 - K_HSB2RGB.www);
    return hsb.z * mix(K_HSB2RGB.xxx, clamp(p - K_HSB2RGB.xxx, 0.0, 1.0), hsb.y);
}
`;var LO=`/**
 * Converts an HSL color (hue, saturation, lightness) to RGB
 * HSL <-> RGB conversion: {@link http://www.chilliant.com/rgb2hsv.html}
 *
 * @name czm_HSLToRGB
 * @glslFunction
 * 
 * @param {vec3} rgb The color in HSL.
 *
 * @returns {vec3} The color in RGB.
 *
 * @example
 * vec3 hsl = czm_RGBToHSL(rgb);
 * hsl.z *= 0.1;
 * rgb = czm_HSLToRGB(hsl);
 */

vec3 hueToRGB(float hue)
{
    float r = abs(hue * 6.0 - 3.0) - 1.0;
    float g = 2.0 - abs(hue * 6.0 - 2.0);
    float b = 2.0 - abs(hue * 6.0 - 4.0);
    return clamp(vec3(r, g, b), 0.0, 1.0);
}

vec3 czm_HSLToRGB(vec3 hsl)
{
    vec3 rgb = hueToRGB(hsl.x);
    float c = (1.0 - abs(2.0 * hsl.z - 1.0)) * hsl.y;
    return (rgb - 0.5) * c + hsl.z;
}
`;var NO=`/**
 * Adjusts the hue of a color.
 * 
 * @name czm_hue
 * @glslFunction
 * 
 * @param {vec3} rgb The color.
 * @param {float} adjustment The amount to adjust the hue of the color in radians.
 *
 * @returns {float} The color with the hue adjusted.
 *
 * @example
 * vec3 adjustHue = czm_hue(color, czm_pi); // The same as czm_hue(color, -czm_pi)
 */
vec3 czm_hue(vec3 rgb, float adjustment)
{
    const mat3 toYIQ = mat3(0.299,     0.587,     0.114,
                            0.595716, -0.274453, -0.321263,
                            0.211456, -0.522591,  0.311135);
    const mat3 toRGB = mat3(1.0,  0.9563,  0.6210,
                            1.0, -0.2721, -0.6474,
                            1.0, -1.107,   1.7046);
    
    vec3 yiq = toYIQ * rgb;
    float hue = atan(yiq.z, yiq.y) + adjustment;
    float chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);
    
    vec3 color = vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));
    return toRGB * color;
}
`;var FO=`/**
 * Converts a color in linear space to RGB space.
 *
 * @name czm_inverseGamma
 * @glslFunction
 *
 * @param {vec3} color The color in linear space.
 * @returns {vec3} The color in RGB space.
 */
vec3 czm_inverseGamma(vec3 color) {
    return pow(color, vec3(1.0 / czm_gamma));
}
`;var BO=`/**
 * Determines if a time interval is empty.
 *
 * @name czm_isEmpty
 * @glslFunction 
 * 
 * @param {czm_raySegment} interval The interval to test.
 * 
 * @returns {bool} <code>true</code> if the time interval is empty; otherwise, <code>false</code>.
 *
 * @example
 * bool b0 = czm_isEmpty(czm_emptyRaySegment);      // true
 * bool b1 = czm_isEmpty(czm_raySegment(0.0, 1.0)); // false
 * bool b2 = czm_isEmpty(czm_raySegment(1.0, 1.0)); // false, contains 1.0.
 */
bool czm_isEmpty(czm_raySegment interval)
{
    return (interval.stop < 0.0);
}
`;var kO=`/**
 * Determines if a time interval is empty.
 *
 * @name czm_isFull
 * @glslFunction 
 * 
 * @param {czm_raySegment} interval The interval to test.
 * 
 * @returns {bool} <code>true</code> if the time interval is empty; otherwise, <code>false</code>.
 *
 * @example
 * bool b0 = czm_isEmpty(czm_emptyRaySegment);      // true
 * bool b1 = czm_isEmpty(czm_raySegment(0.0, 1.0)); // false
 * bool b2 = czm_isEmpty(czm_raySegment(1.0, 1.0)); // false, contains 1.0.
 */
bool czm_isFull(czm_raySegment interval)
{
    return (interval.start == 0.0 && interval.stop == czm_infinity);
}
`;var VO=`/**
 * Computes the fraction of a Web Wercator rectangle at which a given geodetic latitude is located.
 *
 * @name czm_latitudeToWebMercatorFraction
 * @glslFunction
 *
 * @param {float} latitude The geodetic latitude, in radians.
 * @param {float} southMercatorY The Web Mercator coordinate of the southern boundary of the rectangle.
 * @param {float} oneOverMercatorHeight The total height of the rectangle in Web Mercator coordinates.
 *
 * @returns {float} The fraction of the rectangle at which the latitude occurs.  If the latitude is the southern
 *          boundary of the rectangle, the return value will be zero.  If it is the northern boundary, the return
 *          value will be 1.0.  Latitudes in between are mapped according to the Web Mercator projection.
 */ 
float czm_latitudeToWebMercatorFraction(float latitude, float southMercatorY, float oneOverMercatorHeight)
{
    float sinLatitude = sin(latitude);
    float mercatorY = 0.5 * log((1.0 + sinLatitude) / (1.0 - sinLatitude));
    
    return (mercatorY - southMercatorY) * oneOverMercatorHeight;
}
`;var UO=`/**
 * Converts a linear RGB color to an sRGB color.
 *
 * @param {vec3|vec4} linearIn The color in linear color space.
 * @returns {vec3|vec4} The color in sRGB color space. The vector type matches the input.
 */
vec3 czm_linearToSrgb(vec3 linearIn) 
{
    return pow(linearIn, vec3(1.0/2.2));
}

vec4 czm_linearToSrgb(vec4 linearIn) 
{
    vec3 srgbOut = pow(linearIn.rgb, vec3(1.0/2.2));
    return vec4(srgbOut, linearIn.a);
}
`;var zO=`/**
 * Computes distance from an point in 2D to a line in 2D.
 *
 * @name czm_lineDistance
 * @glslFunction
 *
 * param {vec2} point1 A point along the line.
 * param {vec2} point2 A point along the line.
 * param {vec2} point A point that may or may not be on the line.
 * returns {float} The distance from the point to the line.
 */
float czm_lineDistance(vec2 point1, vec2 point2, vec2 point) {
    return abs((point2.y - point1.y) * point.x - (point2.x - point1.x) * point.y + point2.x * point1.y - point2.y * point1.x) / distance(point2, point1);
}
`;var HO=`/**
 * Computes the luminance of a color. 
 *
 * @name czm_luminance
 * @glslFunction
 *
 * @param {vec3} rgb The color.
 * 
 * @returns {float} The luminance.
 *
 * @example
 * float light = czm_luminance(vec3(0.0)); // 0.0
 * float dark = czm_luminance(vec3(1.0));  // ~1.0 
 */
float czm_luminance(vec3 rgb)
{
    // Algorithm from Chapter 10 of Graphics Shaders.
    const vec3 W = vec3(0.2125, 0.7154, 0.0721);
    return dot(rgb, W);
}
`;var GO=`/**
 * Find the maximum component of a vector.
 *
 * @name czm_maximumComponent
 * @glslFunction
 *
 * @param {vec2|vec3|vec4} v The input vector.
 * @returns {float} The value of the largest component.
 */
float czm_maximumComponent(vec2 v)
{
    return max(v.x, v.y);
}
float czm_maximumComponent(vec3 v)
{
    return max(max(v.x, v.y), v.z);
}
float czm_maximumComponent(vec4 v)
{
    return max(max(max(v.x, v.y), v.z), v.w);
}
`;var WO=`/**
 * Computes the size of a pixel in meters at a distance from the eye.
 * <p>
 * Use this version when passing in a custom pixel ratio. For example, passing in 1.0 will return meters per native device pixel.
 * </p>
 * @name czm_metersPerPixel
 * @glslFunction
 *
 * @param {vec3} positionEC The position to get the meters per pixel in eye coordinates.
 * @param {float} pixelRatio The scaling factor from pixel space to coordinate space
 *
 * @returns {float} The meters per pixel at positionEC.
 */
float czm_metersPerPixel(vec4 positionEC, float pixelRatio)
{
    float width = czm_viewport.z;
    float height = czm_viewport.w;
    float pixelWidth;
    float pixelHeight;

    float top = czm_frustumPlanes.x;
    float bottom = czm_frustumPlanes.y;
    float left = czm_frustumPlanes.z;
    float right = czm_frustumPlanes.w;

    if (czm_sceneMode == czm_sceneMode2D || czm_orthographicIn3D == 1.0)
    {
        float frustumWidth = right - left;
        float frustumHeight = top - bottom;
        pixelWidth = frustumWidth / width;
        pixelHeight = frustumHeight / height;
    }
    else
    {
        float distanceToPixel = -positionEC.z;
        float inverseNear = 1.0 / czm_currentFrustum.x;
        float tanTheta = top * inverseNear;
        pixelHeight = 2.0 * distanceToPixel * tanTheta / height;
        tanTheta = right * inverseNear;
        pixelWidth = 2.0 * distanceToPixel * tanTheta / width;
    }

    return max(pixelWidth, pixelHeight) * pixelRatio;
}

/**
 * Computes the size of a pixel in meters at a distance from the eye.
 * <p>
 * Use this version when scaling by pixel ratio.
 * </p>
 * @name czm_metersPerPixel
 * @glslFunction
 *
 * @param {vec3} positionEC The position to get the meters per pixel in eye coordinates.
 *
 * @returns {float} The meters per pixel at positionEC.
 */
float czm_metersPerPixel(vec4 positionEC)
{
    return czm_metersPerPixel(positionEC, czm_pixelRatio);
}
`;var jO=`/**
 * Transforms a position from model to window coordinates.  The transformation
 * from model to clip coordinates is done using {@link czm_modelViewProjection}.
 * The transform from normalized device coordinates to window coordinates is
 * done using {@link czm_viewportTransformation}, which assumes a depth range
 * of <code>near = 0</code> and <code>far = 1</code>.
 * <br /><br />
 * This transform is useful when there is a need to manipulate window coordinates
 * in a vertex shader as done by {@link BillboardCollection}.
 * <br /><br />
 * This function should not be confused with {@link czm_viewportOrthographic},
 * which is an orthographic projection matrix that transforms from window 
 * coordinates to clip coordinates.
 *
 * @name czm_modelToWindowCoordinates
 * @glslFunction
 *
 * @param {vec4} position The position in model coordinates to transform.
 *
 * @returns {vec4} The transformed position in window coordinates.
 *
 * @see czm_eyeToWindowCoordinates
 * @see czm_modelViewProjection
 * @see czm_viewportTransformation
 * @see czm_viewportOrthographic
 * @see BillboardCollection
 *
 * @example
 * vec4 positionWC = czm_modelToWindowCoordinates(positionMC);
 */
vec4 czm_modelToWindowCoordinates(vec4 position)
{
    vec4 q = czm_modelViewProjection * position;                // clip coordinates
    q.xyz /= q.w;                                                // normalized device coordinates
    q.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz; // window coordinates
    return q;
}
`;var qO=`/**
 * DOC_TBA
 *
 * @name czm_multiplyWithColorBalance
 * @glslFunction
 */
vec3 czm_multiplyWithColorBalance(vec3 left, vec3 right)
{
    // Algorithm from Chapter 10 of Graphics Shaders.
    const vec3 W = vec3(0.2125, 0.7154, 0.0721);
    
    vec3 target = left * right;
    float leftLuminance = dot(left, W);
    float rightLuminance = dot(right, W);
    float targetLuminance = dot(target, W);
    
    return ((leftLuminance + rightLuminance) / (2.0 * targetLuminance)) * target;
}
`;var YO=`/**
 * Computes a value that scales with distance.  The scaling is clamped at the near and
 * far distances, and does not extrapolate.  This function works with the
 * {@link NearFarScalar} JavaScript class.
 *
 * @name czm_nearFarScalar
 * @glslFunction
 *
 * @param {vec4} nearFarScalar A vector with 4 components: Near distance (x), Near value (y), Far distance (z), Far value (w).
 * @param {float} cameraDistSq The square of the current distance from the camera.
 *
 * @returns {float} The value at this distance.
 */
float czm_nearFarScalar(vec4 nearFarScalar, float cameraDistSq)
{
    float valueAtMin = nearFarScalar.y;
    float valueAtMax = nearFarScalar.w;
    float nearDistanceSq = nearFarScalar.x * nearFarScalar.x;
    float farDistanceSq = nearFarScalar.z * nearFarScalar.z;

    float t = (cameraDistSq - nearDistanceSq) / (farDistanceSq - nearDistanceSq);

    t = pow(clamp(t, 0.0, 1.0), 0.2);

    return mix(valueAtMin, valueAtMax, t);
}
`;var XO=` /**
  * Decodes a unit-length vector in 'oct' encoding to a normalized 3-component Cartesian vector.
  * The 'oct' encoding is described in "A Survey of Efficient Representations of Independent Unit Vectors",
  * Cigolle et al 2014: http://jcgt.org/published/0003/02/01/
  *
  * @name czm_octDecode
  * @param {vec2} encoded The oct-encoded, unit-length vector
  * @param {float} range The maximum value of the SNORM range. The encoded vector is stored in log2(rangeMax+1) bits.
  * @returns {vec3} The decoded and normalized vector
  */
  vec3 czm_octDecode(vec2 encoded, float range)
  {
      if (encoded.x == 0.0 && encoded.y == 0.0) {
          return vec3(0.0, 0.0, 0.0);
      }

     encoded = encoded / range * 2.0 - 1.0;
     vec3 v = vec3(encoded.x, encoded.y, 1.0 - abs(encoded.x) - abs(encoded.y));
     if (v.z < 0.0)
     {
         v.xy = (1.0 - abs(v.yx)) * czm_signNotZero(v.xy);
     }

     return normalize(v);
  }

/**
 * Decodes a unit-length vector in 'oct' encoding to a normalized 3-component Cartesian vector.
 * The 'oct' encoding is described in "A Survey of Efficient Representations of Independent Unit Vectors",
 * Cigolle et al 2014: http://jcgt.org/published/0003/02/01/
 *
 * @name czm_octDecode
 * @param {vec2} encoded The oct-encoded, unit-length vector
 * @returns {vec3} The decoded and normalized vector
 */
 vec3 czm_octDecode(vec2 encoded)
 {
    return czm_octDecode(encoded, 255.0);
 }

 /**
 * Decodes a unit-length vector in 'oct' encoding packed into a floating-point number to a normalized 3-component Cartesian vector.
 * The 'oct' encoding is described in "A Survey of Efficient Representations of Independent Unit Vectors",
 * Cigolle et al 2014: http://jcgt.org/published/0003/02/01/
 *
 * @name czm_octDecode
 * @param {float} encoded The oct-encoded, unit-length vector
 * @returns {vec3} The decoded and normalized vector
 */
 vec3 czm_octDecode(float encoded)
 {
    float temp = encoded / 256.0;
    float x = floor(temp);
    float y = (temp - x) * 256.0;
    return czm_octDecode(vec2(x, y));
 }

/**
 * Decodes three unit-length vectors in 'oct' encoding packed into two floating-point numbers to normalized 3-component Cartesian vectors.
 * The 'oct' encoding is described in "A Survey of Efficient Representations of Independent Unit Vectors",
 * Cigolle et al 2014: http://jcgt.org/published/0003/02/01/
 *
 * @name czm_octDecode
 * @param {vec2} encoded The packed oct-encoded, unit-length vectors.
 * @param {vec3} vector1 One decoded and normalized vector.
 * @param {vec3} vector2 One decoded and normalized vector.
 * @param {vec3} vector3 One decoded and normalized vector.
 */
  void czm_octDecode(vec2 encoded, out vec3 vector1, out vec3 vector2, out vec3 vector3)
 {
    float temp = encoded.x / 65536.0;
    float x = floor(temp);
    float encodedFloat1 = (temp - x) * 65536.0;

    temp = encoded.y / 65536.0;
    float y = floor(temp);
    float encodedFloat2 = (temp - y) * 65536.0;

    vector1 = czm_octDecode(encodedFloat1);
    vector2 = czm_octDecode(encodedFloat2);
    vector3 = czm_octDecode(vec2(x, y));
 }

`;var KO=`/**
 * Packs a depth value into a vec4 that can be represented by unsigned bytes.
 *
 * @name czm_packDepth
 * @glslFunction
 *
 * @param {float} depth The floating-point depth.
 * @returns {vec4} The packed depth.
 */
vec4 czm_packDepth(float depth)
{
    // See Aras Pranckevi\u010Dius' post Encoding Floats to RGBA
    // http://aras-p.info/blog/2009/07/30/encoding-floats-to-rgba-the-final/
    vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * depth;
    enc = fract(enc);
    enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);
    return enc;
}
`;var ZO=`vec3 lambertianDiffuse(vec3 diffuseColor)
{
    return diffuseColor / czm_pi;
}

vec3 fresnelSchlick2(vec3 f0, vec3 f90, float VdotH)
{
    float versine = 1.0 - VdotH;
    // pow(versine, 5.0) is slow. See https://stackoverflow.com/a/68793086/10082269
    float versineSquared = versine * versine;
    return f0 + (f90 - f0) * versineSquared * versineSquared * versine;
}

#ifdef USE_ANISOTROPY
/**
 * @param {float} bitangentRoughness Material roughness (along the anisotropy bitangent)
 * @param {float} tangentialRoughness Anisotropic roughness (along the anisotropy tangent)
 * @param {vec3} lightDirection The direction from the fragment to the light source, transformed to tangent-bitangent-normal coordinates
 * @param {vec3} viewDirection The direction from the fragment to the camera, transformed to tangent-bitangent-normal coordinates
 */
float smithVisibilityGGX_anisotropic(float bitangentRoughness, float tangentialRoughness, vec3 lightDirection, vec3 viewDirection)
{
    vec3 roughnessScale = vec3(tangentialRoughness, bitangentRoughness, 1.0);
    float GGXV = lightDirection.z * length(roughnessScale * viewDirection);
    float GGXL = viewDirection.z * length(roughnessScale * lightDirection);
    float v = 0.5 / (GGXV + GGXL);
    return clamp(v, 0.0, 1.0);
}

/**
 * @param {float} bitangentRoughness Material roughness (along the anisotropy bitangent)
 * @param {float} tangentialRoughness Anisotropic roughness (along the anisotropy tangent)
 * @param {vec3} halfwayDirection The unit vector halfway between light and view directions, transformed to tangent-bitangent-normal coordinates
 */
float GGX_anisotropic(float bitangentRoughness, float tangentialRoughness, vec3 halfwayDirection)
{
    float roughnessSquared = bitangentRoughness * tangentialRoughness;
    vec3 f = halfwayDirection * vec3(bitangentRoughness, tangentialRoughness, roughnessSquared);
    float w2 = roughnessSquared / dot(f, f);
    return roughnessSquared * w2 * w2 / czm_pi;
}
#endif

/**
 * Estimate the geometric self-shadowing of the microfacets in a surface,
 * using the Smith Joint GGX visibility function.
 * Note: Vis = G / (4 * NdotL * NdotV)
 * see Eric Heitz. 2014. Understanding the Masking-Shadowing Function in Microfacet-Based BRDFs. Journal of Computer Graphics Techniques, 3
 * see Real-Time Rendering. Page 331 to 336.
 * see https://google.github.io/filament/Filament.md.html#materialsystem/specularbrdf/geometricshadowing(specularg)
 *
 * @param {float} alphaRoughness The roughness of the material, expressed as the square of perceptual roughness.
 * @param {float} NdotL The cosine of the angle between the surface normal and the direction to the light source.
 * @param {float} NdotV The cosine of the angle between the surface normal and the direction to the camera.
 */
float smithVisibilityGGX(float alphaRoughness, float NdotL, float NdotV)
{
    float alphaRoughnessSq = alphaRoughness * alphaRoughness;

    float GGXV = NdotL * sqrt(NdotV * NdotV * (1.0 - alphaRoughnessSq) + alphaRoughnessSq);
    float GGXL = NdotV * sqrt(NdotL * NdotL * (1.0 - alphaRoughnessSq) + alphaRoughnessSq);

    float GGX = GGXV + GGXL;
    if (GGX > 0.0)
    {
        return 0.5 / GGX;
    }
    return 0.0;
}

/**
 * Estimate the fraction of the microfacets in a surface that are aligned with 
 * the halfway vector, which is aligned halfway between the directions from
 * the fragment to the camera and from the fragment to the light source.
 *
 * @param {float} alphaRoughness The roughness of the material, expressed as the square of perceptual roughness.
 * @param {float} NdotH The cosine of the angle between the surface normal and the halfway vector.
 * @return {float} The fraction of microfacets aligned to the halfway vector.
 */
float GGX(float alphaRoughness, float NdotH)
{
    float alphaRoughnessSquared = alphaRoughness * alphaRoughness;
    float f = (NdotH * alphaRoughnessSquared - NdotH) * NdotH + 1.0;
    return alphaRoughnessSquared / (czm_pi * f * f);
}

/**
 * Compute the strength of the specular reflection due to direct lighting.
 *
 * @param {vec3} normal The surface normal.
 * @param {vec3} lightDirection The unit vector pointing from the fragment to the light source.
 * @param {vec3} viewDirection The unit vector pointing from the fragment to the camera.
 * @param {vec3} halfwayDirection The unit vector pointing from the fragment to halfway between the light source and the camera.
 * @param {float} alphaRoughness The roughness of the material, expressed as the square of perceptual roughness.
 * @return {float} The strength of the specular reflection.
 */
float computeDirectSpecularStrength(vec3 normal, vec3 lightDirection, vec3 viewDirection, vec3 halfwayDirection, float alphaRoughness)
{
    float NdotL = clamp(dot(normal, lightDirection), 0.0, 1.0);
    float NdotV = clamp(dot(normal, viewDirection), 0.0, 1.0);
    float G = smithVisibilityGGX(alphaRoughness, NdotL, NdotV);
    float NdotH = clamp(dot(normal, halfwayDirection), 0.0, 1.0);
    float D = GGX(alphaRoughness, NdotH);
    return G * D;
}

/**
 * Compute the diffuse and specular contributions using physically based
 * rendering. This function only handles direct lighting.
 * <p>
 * This function only handles the lighting calculations. Metallic/roughness
 * and specular/glossy must be handled separately. See {@MaterialStageFS}
 * </p>
 *
 * @name czm_pbrLighting
 * @glslFunction
 *
 * @param {vec3} viewDirectionEC Unit vector pointing from the fragment to the eye position
 * @param {vec3} normalEC The surface normal in eye coordinates
 * @param {vec3} lightDirectionEC Unit vector pointing to the light source in eye coordinates.
 * @param {czm_modelMaterial} The material properties.
 * @return {vec3} The computed HDR color
 */
vec3 czm_pbrLighting(vec3 viewDirectionEC, vec3 normalEC, vec3 lightDirectionEC, czm_modelMaterial material)
{
    vec3 halfwayDirectionEC = normalize(viewDirectionEC + lightDirectionEC);
    float VdotH = clamp(dot(viewDirectionEC, halfwayDirectionEC), 0.0, 1.0);
    float NdotL = clamp(dot(normalEC, lightDirectionEC), 0.001, 1.0);

    vec3 f0 = material.specular;
    float reflectance = czm_maximumComponent(f0);
    // Typical dielectrics will have reflectance 0.04, so f90 will be 1.0.
    // In this case, at grazing angle, all incident energy is reflected.
    vec3 f90 = vec3(clamp(reflectance * 25.0, 0.0, 1.0));
    vec3 F = fresnelSchlick2(f0, f90, VdotH);

    #if defined(USE_SPECULAR)
        F *= material.specularWeight;
    #endif

    float alphaRoughness = material.roughness * material.roughness;
    #ifdef USE_ANISOTROPY
        mat3 tbn = mat3(material.anisotropicT, material.anisotropicB, normalEC);
        vec3 lightDirection = lightDirectionEC * tbn;
        vec3 viewDirection = viewDirectionEC * tbn;
        vec3 halfwayDirection = halfwayDirectionEC * tbn;
        float anisotropyStrength = material.anisotropyStrength;
        float tangentialRoughness = mix(alphaRoughness, 1.0, anisotropyStrength * anisotropyStrength);
        float bitangentRoughness = clamp(alphaRoughness, 0.001, 1.0);
        float G = smithVisibilityGGX_anisotropic(bitangentRoughness, tangentialRoughness, lightDirection, viewDirection);
        float D = GGX_anisotropic(bitangentRoughness, tangentialRoughness, halfwayDirection);
        vec3 specularContribution = F * G * D;
    #else
        float specularStrength = computeDirectSpecularStrength(normalEC, lightDirectionEC, viewDirectionEC, halfwayDirectionEC, alphaRoughness);
        vec3 specularContribution = F * specularStrength;
    #endif

    vec3 diffuseColor = material.diffuse;
    // F here represents the specular contribution
    vec3 diffuseContribution = (1.0 - F) * lambertianDiffuse(diffuseColor);

    // Lo = (diffuse + specular) * Li * NdotL
    return (diffuseContribution + specularContribution) * NdotL;
}
`;var $O=`// KhronosGroup https://github.com/KhronosGroup/ToneMapping/tree/main/PBR_Neutral

// Input color is non-negative and resides in the Linear Rec. 709 color space.
// Output color is also Linear Rec. 709, but in the [0, 1] range.

vec3 czm_pbrNeutralTonemapping(vec3 color) {
    const float startCompression = 0.8 - 0.04;
    const float desaturation = 0.15;

    float x = min(color.r, min(color.g, color.b));
    float offset = czm_branchFreeTernary(x < 0.08, x - 6.25 * x * x, 0.04);
    color -= offset;

    float peak = max(color.r, max(color.g, color.b));
    if (peak < startCompression) return color;

    const float d = 1.0 - startCompression;
    float newPeak = 1.0 - d * d / (peak + d - startCompression);
    color *= newPeak / peak;

    float g = 1.0 - 1.0 / (desaturation * (peak - newPeak) + 1.0);
    return mix(color, newPeak * vec3(1.0, 1.0, 1.0), g);
}
`;var QO=`float czm_private_getLambertDiffuseOfMaterial(vec3 lightDirectionEC, czm_material material)
{
    return czm_getLambertDiffuse(lightDirectionEC, material.normal);
}

float czm_private_getSpecularOfMaterial(vec3 lightDirectionEC, vec3 toEyeEC, czm_material material)
{
    return czm_getSpecular(lightDirectionEC, toEyeEC, material.normal, material.shininess);
}

/**
 * Computes a color using the Phong lighting model.
 *
 * @name czm_phong
 * @glslFunction
 *
 * @param {vec3} toEye A normalized vector from the fragment to the eye in eye coordinates.
 * @param {czm_material} material The fragment's material.
 *
 * @returns {vec4} The computed color.
 *
 * @example
 * vec3 positionToEyeEC = // ...
 * czm_material material = // ...
 * vec3 lightDirectionEC = // ...
 * out_FragColor = czm_phong(normalize(positionToEyeEC), material, lightDirectionEC);
 *
 * @see czm_getMaterial
 */
vec4 czm_phong(vec3 toEye, czm_material material, vec3 lightDirectionEC)
{
    // Diffuse from directional light sources at eye (for top-down)
    float diffuse = czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 0.0, 1.0), material);
    if (czm_sceneMode == czm_sceneMode3D) {
        // (and horizon views in 3D)
        diffuse += czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 1.0, 0.0), material);
    }

    float specular = czm_private_getSpecularOfMaterial(lightDirectionEC, toEye, material);

    // Temporary workaround for adding ambient.
    vec3 materialDiffuse = material.diffuse * 0.5;

    vec3 ambient = materialDiffuse;
    vec3 color = ambient + material.emission;
    color += materialDiffuse * diffuse * czm_lightColor;
    color += material.specular * specular * czm_lightColor;

    return vec4(color, material.alpha);
}

vec4 czm_private_phong(vec3 toEye, czm_material material, vec3 lightDirectionEC)
{
    float diffuse = czm_private_getLambertDiffuseOfMaterial(lightDirectionEC, material);
    float specular = czm_private_getSpecularOfMaterial(lightDirectionEC, toEye, material);

    vec3 ambient = vec3(0.0);
    vec3 color = ambient + material.emission;
    color += material.diffuse * diffuse * czm_lightColor;
    color += material.specular * specular * czm_lightColor;

    return vec4(color, material.alpha);
}
`;var JO=`/**
 * Computes distance from a point to a plane.
 *
 * @name czm_planeDistance
 * @glslFunction
 *
 * param {vec4} plane A Plane in Hessian Normal Form. See Plane.js
 * param {vec3} point A point in the same space as the plane.
 * returns {float} The distance from the point to the plane.
 */
float czm_planeDistance(vec4 plane, vec3 point) {
    return (dot(plane.xyz, point) + plane.w);
}

/**
 * Computes distance from a point to a plane.
 *
 * @name czm_planeDistance
 * @glslFunction
 *
 * param {vec3} planeNormal Normal for a plane in Hessian Normal Form. See Plane.js
 * param {float} planeDistance Distance for a plane in Hessian Normal form. See Plane.js
 * param {vec3} point A point in the same space as the plane.
 * returns {float} The distance from the point to the plane.
 */
float czm_planeDistance(vec3 planeNormal, float planeDistance, vec3 point) {
    return (dot(planeNormal, point) + planeDistance);
}
`;var eM=`/**
 * Computes the point along a ray at the given time.  <code>time</code> can be positive, negative, or zero.
 *
 * @name czm_pointAlongRay
 * @glslFunction
 *
 * @param {czm_ray} ray The ray to compute the point along.
 * @param {float} time The time along the ray.
 * 
 * @returns {vec3} The point along the ray at the given time.
 * 
 * @example
 * czm_ray ray = czm_ray(vec3(0.0), vec3(1.0, 0.0, 0.0)); // origin, direction
 * vec3 v = czm_pointAlongRay(ray, 2.0); // (2.0, 0.0, 0.0)
 */
vec3 czm_pointAlongRay(czm_ray ray, float time)
{
    return ray.origin + (time * ray.direction);
}
`;var tM=`/**
 * DOC_TBA
 *
 * @name czm_rayEllipsoidIntersectionInterval
 * @glslFunction
 */
czm_raySegment czm_rayEllipsoidIntersectionInterval(czm_ray ray, vec3 ellipsoid_center, vec3 ellipsoid_inverseRadii)
{
   // ray and ellipsoid center in eye coordinates.  radii in model coordinates.
    vec3 q = ellipsoid_inverseRadii * (czm_inverseModelView * vec4(ray.origin, 1.0)).xyz;
    vec3 w = ellipsoid_inverseRadii * (czm_inverseModelView * vec4(ray.direction, 0.0)).xyz;

    q = q - ellipsoid_inverseRadii * (czm_inverseModelView * vec4(ellipsoid_center, 1.0)).xyz;

    float q2 = dot(q, q);
    float qw = dot(q, w);

    if (q2 > 1.0) // Outside ellipsoid.
    {
        if (qw >= 0.0) // Looking outward or tangent (0 intersections).
        {
            return czm_emptyRaySegment;
        }
        else // qw < 0.0.
        {
            float qw2 = qw * qw;
            float difference = q2 - 1.0; // Positively valued.
            float w2 = dot(w, w);
            float product = w2 * difference;

            if (qw2 < product) // Imaginary roots (0 intersections).
            {
                return czm_emptyRaySegment;
            }
            else if (qw2 > product) // Distinct roots (2 intersections).
            {
                float discriminant = qw * qw - product;
                float temp = -qw + sqrt(discriminant); // Avoid cancellation.
                float root0 = temp / w2;
                float root1 = difference / temp;
                if (root0 < root1)
                {
                    czm_raySegment i = czm_raySegment(root0, root1);
                    return i;
                }
                else
                {
                    czm_raySegment i = czm_raySegment(root1, root0);
                    return i;
                }
            }
            else // qw2 == product.  Repeated roots (2 intersections).
            {
                float root = sqrt(difference / w2);
                czm_raySegment i = czm_raySegment(root, root);
                return i;
            }
        }
    }
    else if (q2 < 1.0) // Inside ellipsoid (2 intersections).
    {
        float difference = q2 - 1.0; // Negatively valued.
        float w2 = dot(w, w);
        float product = w2 * difference; // Negatively valued.
        float discriminant = qw * qw - product;
        float temp = -qw + sqrt(discriminant); // Positively valued.
        czm_raySegment i = czm_raySegment(0.0, temp / w2);
        return i;
    }
    else // q2 == 1.0. On ellipsoid.
    {
        if (qw < 0.0) // Looking inward.
        {
            float w2 = dot(w, w);
            czm_raySegment i = czm_raySegment(0.0, -qw / w2);
            return i;
        }
        else // qw >= 0.0.  Looking outward or tangent.
        {
            return czm_emptyRaySegment;
        }
    }
}
`;var nM=`/**
 * Compute the intersection interval of a ray with a sphere.
 *
 * @name czm_raySphereIntersectionInterval
 * @glslFunction
 *
 * @param {czm_ray} ray The ray.
 * @param {vec3} center The center of the sphere.
 * @param {float} radius The radius of the sphere.
 * @return {czm_raySegment} The intersection interval of the ray with the sphere.
 */
czm_raySegment czm_raySphereIntersectionInterval(czm_ray ray, vec3 center, float radius)
{
    vec3 o = ray.origin;
    vec3 d = ray.direction;

    vec3 oc = o - center;

    float a = dot(d, d);
    float b = 2.0 * dot(d, oc);
    float c = dot(oc, oc) - (radius * radius);

    float det = (b * b) - (4.0 * a * c);

    if (det < 0.0) {
        return czm_emptyRaySegment;
    }

    float sqrtDet = sqrt(det);

    float t0 = (-b - sqrtDet) / (2.0 * a);
    float t1 = (-b + sqrtDet) / (2.0 * a);

    czm_raySegment result = czm_raySegment(t0, t1);
    return result;
}
`;var iM=`float czm_readDepth(sampler2D depthTexture, vec2 texCoords)
{
    return czm_reverseLogDepth(texture(depthTexture, texCoords).r);
}
`;var oM=`/**
 * Reads a value previously transformed with {@link czm_writeNonPerspective}
 * by dividing it by \`w\`, the value used in the perspective divide.
 * This function is intended to be called in a fragment shader to access a
 * \`varying\` that should not be subject to perspective interpolation.
 * For example, screen-space texture coordinates. The value should have been
 * previously written in the vertex shader with a call to
 * {@link czm_writeNonPerspective}.
 *
 * @name czm_readNonPerspective
 * @glslFunction
 *
 * @param {float|vec2|vec3|vec4} value The non-perspective value to be read.
 * @param {float} oneOverW One over the perspective divide value, \`w\`. Usually this is simply \`gl_FragCoord.w\`.
 * @returns {float|vec2|vec3|vec4} The usable value.
 */
float czm_readNonPerspective(float value, float oneOverW) {
    return value * oneOverW;
}

vec2 czm_readNonPerspective(vec2 value, float oneOverW) {
    return value * oneOverW;
}

vec3 czm_readNonPerspective(vec3 value, float oneOverW) {
    return value * oneOverW;
}

vec4 czm_readNonPerspective(vec4 value, float oneOverW) {
    return value * oneOverW;
}
`;var rM=`float czm_reverseLogDepth(float logZ)
{
#ifdef LOG_DEPTH
    float near = czm_currentFrustum.x;
    float far = czm_currentFrustum.y;
    float log2Depth = logZ * czm_log2FarDepthFromNearPlusOne;
    float depthFromNear = pow(2.0, log2Depth) - 1.0;
    return far * (1.0 - near / (depthFromNear + near)) / (far - near);
#endif
    return logZ;
}
`;var sM=`/**
 * Converts an RGB color to HSB (hue, saturation, brightness)
 * HSB <-> RGB conversion with minimal branching: {@link http://lolengine.net/blog/2013/07/27/rgb-to-hsv-in-glsl}
 *
 * @name czm_RGBToHSB
 * @glslFunction
 * 
 * @param {vec3} rgb The color in RGB.
 *
 * @returns {vec3} The color in HSB.
 *
 * @example
 * vec3 hsb = czm_RGBToHSB(rgb);
 * hsb.z *= 0.1;
 * rgb = czm_HSBToRGB(hsb);
 */

const vec4 K_RGB2HSB = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);

vec3 czm_RGBToHSB(vec3 rgb)
{
    vec4 p = mix(vec4(rgb.bg, K_RGB2HSB.wz), vec4(rgb.gb, K_RGB2HSB.xy), step(rgb.b, rgb.g));
    vec4 q = mix(vec4(p.xyw, rgb.r), vec4(rgb.r, p.yzx), step(p.x, rgb.r));

    float d = q.x - min(q.w, q.y);
    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + czm_epsilon7)), d / (q.x + czm_epsilon7), q.x);
}
`;var aM=`/**
 * Converts an RGB color to HSL (hue, saturation, lightness)
 * HSL <-> RGB conversion: {@link http://www.chilliant.com/rgb2hsv.html}
 *
 * @name czm_RGBToHSL
 * @glslFunction
 * 
 * @param {vec3} rgb The color in RGB.
 *
 * @returns {vec3} The color in HSL.
 *
 * @example
 * vec3 hsl = czm_RGBToHSL(rgb);
 * hsl.z *= 0.1;
 * rgb = czm_HSLToRGB(hsl);
 */
 
vec3 RGBtoHCV(vec3 rgb)
{
    // Based on work by Sam Hocevar and Emil Persson
    vec4 p = (rgb.g < rgb.b) ? vec4(rgb.bg, -1.0, 2.0 / 3.0) : vec4(rgb.gb, 0.0, -1.0 / 3.0);
    vec4 q = (rgb.r < p.x) ? vec4(p.xyw, rgb.r) : vec4(rgb.r, p.yzx);
    float c = q.x - min(q.w, q.y);
    float h = abs((q.w - q.y) / (6.0 * c + czm_epsilon7) + q.z);
    return vec3(h, c, q.x);
}

vec3 czm_RGBToHSL(vec3 rgb)
{
    vec3 hcv = RGBtoHCV(rgb);
    float l = hcv.z - hcv.y * 0.5;
    float s = hcv.y / (1.0 - abs(l * 2.0 - 1.0) + czm_epsilon7);
    return vec3(hcv.x, s, l);
}
`;var cM=`/**
 * Converts an RGB color to CIE Yxy.
 * <p>The conversion is described in
 * {@link http://content.gpwiki.org/index.php/D3DBook:High-Dynamic_Range_Rendering#Luminance_Transform|Luminance Transform}
 * </p>
 * 
 * @name czm_RGBToXYZ
 * @glslFunction
 * 
 * @param {vec3} rgb The color in RGB.
 *
 * @returns {vec3} The color in CIE Yxy.
 *
 * @example
 * vec3 xyz = czm_RGBToXYZ(rgb);
 * xyz.x = max(xyz.x - luminanceThreshold, 0.0);
 * rgb = czm_XYZToRGB(xyz);
 */
vec3 czm_RGBToXYZ(vec3 rgb)
{
    const mat3 RGB2XYZ = mat3(0.4124, 0.2126, 0.0193,
                              0.3576, 0.7152, 0.1192,
                              0.1805, 0.0722, 0.9505);
    vec3 xyz = RGB2XYZ * rgb;
    vec3 Yxy;
    Yxy.r = xyz.g;
    float temp = dot(vec3(1.0), xyz);
    Yxy.gb = xyz.rg / temp;
    return Yxy;
}
`;var lM=`/**
 * Round a floating point value. This function exists because round() doesn't
 * exist in GLSL 1.00. 
 *
 * @param {float|vec2|vec3|vec4} value The value to round
 * @param {float|vec2|vec3|vec3} The rounded value. The type matches the input.
 */
float czm_round(float value) {
  return floor(value + 0.5);
}

vec2 czm_round(vec2 value) {
  return floor(value + 0.5);
}

vec3 czm_round(vec3 value) {
  return floor(value + 0.5);
}

vec4 czm_round(vec4 value) {
  return floor(value + 0.5);
}
`;var uM=`/**
 * Adjusts the saturation of a color.
 * 
 * @name czm_saturation
 * @glslFunction
 * 
 * @param {vec3} rgb The color.
 * @param {float} adjustment The amount to adjust the saturation of the color.
 *
 * @returns {float} The color with the saturation adjusted.
 *
 * @example
 * vec3 greyScale = czm_saturation(color, 0.0);
 * vec3 doubleSaturation = czm_saturation(color, 2.0);
 */
vec3 czm_saturation(vec3 rgb, float adjustment)
{
    // Algorithm from Chapter 16 of OpenGL Shading Language
    const vec3 W = vec3(0.2125, 0.7154, 0.0721);
    vec3 intensity = vec3(dot(rgb, W));
    return mix(intensity, rgb, adjustment);
}
`;var fM=`
float czm_sampleShadowMap(highp samplerCube shadowMap, vec3 d)
{
    return czm_unpackDepth(czm_textureCube(shadowMap, d));
}

float czm_sampleShadowMap(highp sampler2D shadowMap, vec2 uv)
{
#ifdef USE_SHADOW_DEPTH_TEXTURE
    return texture(shadowMap, uv).r;
#else
    return czm_unpackDepth(texture(shadowMap, uv));
#endif
}

float czm_shadowDepthCompare(samplerCube shadowMap, vec3 uv, float depth)
{
    return step(depth, czm_sampleShadowMap(shadowMap, uv));
}

float czm_shadowDepthCompare(sampler2D shadowMap, vec2 uv, float depth)
{
    return step(depth, czm_sampleShadowMap(shadowMap, uv));
}
`;var dM=`
float czm_private_shadowVisibility(float visibility, float nDotL, float normalShadingSmooth, float darkness)
{
#ifdef USE_NORMAL_SHADING
#ifdef USE_NORMAL_SHADING_SMOOTH
    float strength = clamp(nDotL / normalShadingSmooth, 0.0, 1.0);
#else
    float strength = step(0.0, nDotL);
#endif
    visibility *= strength;
#endif

    visibility = max(visibility, darkness);
    return visibility;
}

#ifdef USE_CUBE_MAP_SHADOW
float czm_shadowVisibility(samplerCube shadowMap, czm_shadowParameters shadowParameters)
{
    float depthBias = shadowParameters.depthBias;
    float depth = shadowParameters.depth;
    float nDotL = shadowParameters.nDotL;
    float normalShadingSmooth = shadowParameters.normalShadingSmooth;
    float darkness = shadowParameters.darkness;
    vec3 uvw = shadowParameters.texCoords;

    depth -= depthBias;
    float visibility = czm_shadowDepthCompare(shadowMap, uvw, depth);
    return czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);
}
#else
float czm_shadowVisibility(sampler2D shadowMap, czm_shadowParameters shadowParameters)
{
    float depthBias = shadowParameters.depthBias;
    float depth = shadowParameters.depth;
    float nDotL = shadowParameters.nDotL;
    float normalShadingSmooth = shadowParameters.normalShadingSmooth;
    float darkness = shadowParameters.darkness;
    vec2 uv = shadowParameters.texCoords;

    depth -= depthBias;
#ifdef USE_SOFT_SHADOWS
    vec2 texelStepSize = shadowParameters.texelStepSize;
    float radius = 1.0;
    float dx0 = -texelStepSize.x * radius;
    float dy0 = -texelStepSize.y * radius;
    float dx1 = texelStepSize.x * radius;
    float dy1 = texelStepSize.y * radius;
    float visibility = (
        czm_shadowDepthCompare(shadowMap, uv, depth) +
        czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy0), depth) +
        czm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy0), depth) +
        czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy0), depth) +
        czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, 0.0), depth) +
        czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, 0.0), depth) +
        czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy1), depth) +
        czm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy1), depth) +
        czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy1), depth)
    ) * (1.0 / 9.0);
#else
    float visibility = czm_shadowDepthCompare(shadowMap, uv, depth);
#endif

    return czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);
}
#endif
`;var hM=`/**
 * Returns 1.0 if the given value is positive or zero, and -1.0 if it is negative.  This is similar to the GLSL
 * built-in function <code>sign</code> except that returns 1.0 instead of 0.0 when the input value is 0.0.
 * 
 * @name czm_signNotZero
 * @glslFunction
 *
 * @param {} value The value for which to determine the sign.
 * @returns {} 1.0 if the value is positive or zero, -1.0 if the value is negative.
 */
float czm_signNotZero(float value)
{
    return value >= 0.0 ? 1.0 : -1.0;
}

vec2 czm_signNotZero(vec2 value)
{
    return vec2(czm_signNotZero(value.x), czm_signNotZero(value.y));
}

vec3 czm_signNotZero(vec3 value)
{
    return vec3(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z));
}

vec4 czm_signNotZero(vec4 value)
{
    return vec4(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z), czm_signNotZero(value.w));
}
`;var mM=`/**
 * Computes a color from the third order spherical harmonic coefficients and a normalized direction vector.
 * <p>
 * The order of the coefficients is [L00, L1_1, L10, L11, L2_2, L2_1, L20, L21, L22].
 * </p>
 *
 * @name czm_sphericalHarmonics
 * @glslFunction
 *
 * @param {vec3} normal The normalized direction.
 * @param {vec3[9]} coefficients The third order spherical harmonic coefficients.
 * @returns {vec3} The color at the direction.
 *
 * @see https://graphics.stanford.edu/papers/envmap/envmap.pdf
 */
vec3 czm_sphericalHarmonics(vec3 normal, vec3 coefficients[9])
{
    vec3 L00 = coefficients[0];
    vec3 L1_1 = coefficients[1];
    vec3 L10 = coefficients[2];
    vec3 L11 = coefficients[3];
    vec3 L2_2 = coefficients[4];
    vec3 L2_1 = coefficients[5];
    vec3 L20 = coefficients[6];
    vec3 L21 = coefficients[7];
    vec3 L22 = coefficients[8];

    float x = normal.x;
    float y = normal.y;
    float z = normal.z;

    vec3 L =
          L00
        + L1_1 * y
        + L10 * z
        + L11 * x
        + L2_2 * (y * x)
        + L2_1 * (y * z)
        + L20 * (3.0 * z * z - 1.0)
        + L21 * (z * x)
        + L22 * (x * x - y * y);
        
    return max(L, vec3(0.0));
}
`;var pM=`/**
 * Converts an sRGB color to a linear RGB color.
 *
 * @param {vec3|vec4} srgbIn The color in sRGB space
 * @returns {vec3|vec4} The color in linear color space. The vector type matches the input.
 */
vec3 czm_srgbToLinear(vec3 srgbIn)
{
    return pow(srgbIn, vec3(2.2));
}

vec4 czm_srgbToLinear(vec4 srgbIn) 
{
    vec3 linearOut = pow(srgbIn.rgb, vec3(2.2));
    return vec4(linearOut, srgbIn.a);
}
`;var _M=`/**
 * Creates a matrix that transforms vectors from tangent space to eye space.
 *
 * @name czm_tangentToEyeSpaceMatrix
 * @glslFunction
 *
 * @param {vec3} normalEC The normal vector in eye coordinates.
 * @param {vec3} tangentEC The tangent vector in eye coordinates.
 * @param {vec3} bitangentEC The bitangent vector in eye coordinates.
 *
 * @returns {mat3} The matrix that transforms from tangent space to eye space.
 *
 * @example
 * mat3 tangentToEye = czm_tangentToEyeSpaceMatrix(normalEC, tangentEC, bitangentEC);
 * vec3 normal = tangentToEye * texture(normalMap, st).xyz;
 */
mat3 czm_tangentToEyeSpaceMatrix(vec3 normalEC, vec3 tangentEC, vec3 bitangentEC)
{
    vec3 normal = normalize(normalEC);
    vec3 tangent = normalize(tangentEC);
    vec3 bitangent = normalize(bitangentEC);
    return mat3(tangent.x  , tangent.y  , tangent.z,
                bitangent.x, bitangent.y, bitangent.z,
                normal.x   , normal.y   , normal.z);
}
`;var gM=`/**
 * A wrapper around the texture (WebGL2) / textureCube (WebGL1)
 * function to allow for WebGL 1 support.
 * 
 * @name czm_textureCube
 * @glslFunction
 *
 * @param {samplerCube} sampler The sampler.
 * @param {vec3} p The coordinate at which to sample the texture.
 */
vec4 czm_textureCube(samplerCube sampler, vec3 p) {
#if __VERSION__ == 300
    return texture(sampler, p);
#else
    return textureCube(sampler, p);
#endif
}

/**
 * A wrapper around the textureLod (WebGL2) / textureCube (WebGL1)
 * function to allow for WebGL 1 support in fragment shaders.
 *
 * @name czm_textureCubeLod
 * @glslFunction
 *
 * @param {samplerCube} sampler The sampler.
 * @param {vec3} p The coordinate at which to sample the texture.
 * @param {float} lod The mipmap level from which to sample.
 */
vec4 czm_textureCube(samplerCube sampler, vec3 p, float lod) {
#if __VERSION__ == 300
    return textureLod(sampler, p, lod);
#elif defined(GL_EXT_shader_texture_lod)
    return textureCubeLodEXT(sampler, p, lod);
#endif
}`;var yM=`/**
 * Transforms a plane.
 * 
 * @name czm_transformPlane
 * @glslFunction
 *
 * @param {vec4} plane The plane in Hessian Normal Form.
 * @param {mat4} transform The inverse-transpose of a transformation matrix.
 */
vec4 czm_transformPlane(vec4 plane, mat4 transform) {
    vec4 transformedPlane = transform * plane;
    // Convert the transformed plane to Hessian Normal Form
    float normalMagnitude = length(transformedPlane.xyz);
    return transformedPlane / normalMagnitude;
}
`;var xM=`/**
 * Translates a position (or any <code>vec3</code>) that was encoded with {@link EncodedCartesian3},
 * and then provided to the shader as separate <code>high</code> and <code>low</code> bits to
 * be relative to the eye.  As shown in the example, the position can then be transformed in eye
 * or clip coordinates using {@link czm_modelViewRelativeToEye} or {@link czm_modelViewProjectionRelativeToEye},
 * respectively.
 * <p>
 * This technique, called GPU RTE, eliminates jittering artifacts when using large coordinates as
 * described in {@link http://help.agi.com/AGIComponents/html/BlogPrecisionsPrecisions.htm|Precisions, Precisions}.
 * </p>
 *
 * @name czm_translateRelativeToEye
 * @glslFunction
 *
 * @param {vec3} high The position's high bits.
 * @param {vec3} low The position's low bits.
 * @returns {vec3} The position translated to be relative to the camera's position.
 *
 * @example
 * in vec3 positionHigh;
 * in vec3 positionLow;
 *
 * void main()
 * {
 *   vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);
 *   gl_Position = czm_modelViewProjectionRelativeToEye * p;
 * }
 *
 * @see czm_modelViewRelativeToEye
 * @see czm_modelViewProjectionRelativeToEye
 * @see czm_computePosition
 * @see EncodedCartesian3
 */
vec4 czm_translateRelativeToEye(vec3 high, vec3 low)
{
    vec3 highDifference = high - czm_encodedCameraPositionMCHigh;
    // This check handles the case when NaN values have gotten into \`highDifference\`.
    // Such a thing could happen on devices running iOS.
    if (length(highDifference) == 0.0) {  
        highDifference = vec3(0);  
    }
    vec3 lowDifference = low - czm_encodedCameraPositionMCLow;

    return vec4(highDifference + lowDifference, 1.0);
}
`;var bM=`/**
 * @private
 */
vec4 czm_translucentPhong(vec3 toEye, czm_material material, vec3 lightDirectionEC)
{
    // Diffuse from directional light sources at eye (for top-down and horizon views)
    float diffuse = czm_getLambertDiffuse(vec3(0.0, 0.0, 1.0), material.normal);

    if (czm_sceneMode == czm_sceneMode3D) {
        // (and horizon views in 3D)
        diffuse += czm_getLambertDiffuse(vec3(0.0, 1.0, 0.0), material.normal);
    }

    diffuse = clamp(diffuse, 0.0, 1.0);

    float specular = czm_getSpecular(lightDirectionEC, toEye, material.normal, material.shininess);

    // Temporary workaround for adding ambient.
    vec3 materialDiffuse = material.diffuse * 0.5;

    vec3 ambient = materialDiffuse;
    vec3 color = ambient + material.emission;
    color += materialDiffuse * diffuse * czm_lightColor;
    color += material.specular * specular * czm_lightColor;

    return vec4(color, material.alpha);
}
`;var CM=`/**
 * Returns the transpose of the matrix.  The input <code>matrix</code> can be
 * a <code>mat2</code>, <code>mat3</code>, or <code>mat4</code>.
 *
 * @name czm_transpose
 * @glslFunction
 *
 * @param {} matrix The matrix to transpose.
 *
 * @returns {} The transposed matrix.
 *
 * @example
 * // GLSL declarations
 * mat2 czm_transpose(mat2 matrix);
 * mat3 czm_transpose(mat3 matrix);
 * mat4 czm_transpose(mat4 matrix);
 *
 * // Transpose a 3x3 rotation matrix to find its inverse.
 * mat3 eastNorthUpToEye = czm_eastNorthUpToEyeCoordinates(
 *     positionMC, normalEC);
 * mat3 eyeToEastNorthUp = czm_transpose(eastNorthUpToEye);
 */
mat2 czm_transpose(mat2 matrix)
{
    return mat2(
        matrix[0][0], matrix[1][0],
        matrix[0][1], matrix[1][1]);
}

mat3 czm_transpose(mat3 matrix)
{
    return mat3(
        matrix[0][0], matrix[1][0], matrix[2][0],
        matrix[0][1], matrix[1][1], matrix[2][1],
        matrix[0][2], matrix[1][2], matrix[2][2]);
}

mat4 czm_transpose(mat4 matrix)
{
    return mat4(
        matrix[0][0], matrix[1][0], matrix[2][0], matrix[3][0],
        matrix[0][1], matrix[1][1], matrix[2][1], matrix[3][1],
        matrix[0][2], matrix[1][2], matrix[2][2], matrix[3][2],
        matrix[0][3], matrix[1][3], matrix[2][3], matrix[3][3]);
}
`;var AM=`vec2 getLookupUv(vec2 dimensions, int i) {
    int pixY = i / int(dimensions.x);
    int pixX = i - (pixY * int(dimensions.x));
    float pixelWidth = 1.0 / dimensions.x;
    float pixelHeight = 1.0 / dimensions.y;
    float u = (float(pixX) + 0.5) * pixelWidth; // sample from center of pixel
    float v = (float(pixY) + 0.5) * pixelHeight;
    return vec2(u, v);
}

vec4 czm_unpackClippingExtents(highp sampler2D extentsTexture, int index) {
    vec2 textureDimensions = vec2(textureSize(extentsTexture, 0));
    return texture(extentsTexture, getLookupUv(textureDimensions, index));
}`;var TM=`/**
 * Unpacks a vec4 depth value to a float in [0, 1) range.
 *
 * @name czm_unpackDepth
 * @glslFunction
 *
 * @param {vec4} packedDepth The packed depth.
 *
 * @returns {float} The floating-point depth in [0, 1) range.
 */
float czm_unpackDepth(vec4 packedDepth)
{
    // See Aras Pranckevi\u010Dius' post Encoding Floats to RGBA
    // http://aras-p.info/blog/2009/07/30/encoding-floats-to-rgba-the-final/
    return dot(packedDepth, vec4(1.0, 1.0 / 255.0, 1.0 / 65025.0, 1.0 / 16581375.0));
}
`;var EM=`/**
 * Unpack an IEEE 754 single-precision float that is packed as a little-endian unsigned normalized vec4.
 *
 * @name czm_unpackFloat
 * @glslFunction
 *
 * @param {vec4} packedFloat The packed float.
 *
 * @returns {float} The floating-point depth in arbitrary range.
 */
float czm_unpackFloat(vec4 packedFloat)
{
    // Convert to [0.0, 255.0] and round to integer
    packedFloat = floor(packedFloat * 255.0 + 0.5);
    float sign = 1.0 - step(128.0, packedFloat[3]) * 2.0;
    float exponent = 2.0 * mod(packedFloat[3], 128.0) + step(128.0, packedFloat[2]) - 127.0;    
    if (exponent == -127.0)
    {
        return 0.0;
    }
    float mantissa = mod(packedFloat[2], 128.0) * 65536.0 + packedFloat[1] * 256.0 + packedFloat[0] + float(0x800000);
    float result = sign * exp2(exponent - 23.0) * mantissa;
    return result;
}
`;var SM=`/**
 * Unpack unsigned integers of 1-4 bytes. in WebGL 1, there is no uint type,
 * so the return value is an int.
 * <p>
 * There are also precision limitations in WebGL 1. highp int is still limited
 * to 24 bits. Above the value of 2^24 = 16777216, precision loss may occur.
 * </p>
 *
 * @param {float|vec2|vec3|vec4} packed The packed value. For vectors, the components are listed in little-endian order.
 *
 * @return {int} The unpacked value.
 */
 int czm_unpackUint(float packedValue) {
   float rounded = czm_round(packedValue * 255.0);
   return int(rounded);
 }

 int czm_unpackUint(vec2 packedValue) {
   vec2 rounded = czm_round(packedValue * 255.0);
   return int(dot(rounded, vec2(1.0, 256.0)));
 }

 int czm_unpackUint(vec3 packedValue) {
   vec3 rounded = czm_round(packedValue * 255.0);
   return int(dot(rounded, vec3(1.0, 256.0, 65536.0)));
 }

 int czm_unpackUint(vec4 packedValue) {
   vec4 rounded = czm_round(packedValue * 255.0);
   return int(dot(rounded, vec4(1.0, 256.0, 65536.0, 16777216.0)));
 }
`;var vM=`/**
 * Transform metadata values following the EXT_structural_metadata spec
 * by multiplying by scale and adding the offset. Operations are always
 * performed component-wise, even for matrices.
 * 
 * @param {float|vec2|vec3|vec4|mat2|mat3|mat4} offset The offset to add
 * @param {float|vec2|vec3|vec4|mat2|mat3|mat4} scale The scale factor to multiply
 * @param {float|vec2|vec3|vec4|mat2|mat3|mat4} value The original value.
 *
 * @return {float|vec2|vec3|vec4|mat2|mat3|mat4} The transformed value of the same scalar/vector/matrix type as the input.
 */
float czm_valueTransform(float offset, float scale, float value) {
  return scale * value + offset;
}

vec2 czm_valueTransform(vec2 offset, vec2 scale, vec2 value) {
  return scale * value + offset;
}

vec3 czm_valueTransform(vec3 offset, vec3 scale, vec3 value) {
  return scale * value + offset;
}

vec4 czm_valueTransform(vec4 offset, vec4 scale, vec4 value) {
  return scale * value + offset;
}

mat2 czm_valueTransform(mat2 offset, mat2 scale, mat2 value) {
  return matrixCompMult(scale, value) + offset;
}

mat3 czm_valueTransform(mat3 offset, mat3 scale, mat3 value) {
  return matrixCompMult(scale, value) + offset;
}

mat4 czm_valueTransform(mat4 offset, mat4 scale, mat4 value) {
  return matrixCompMult(scale, value) + offset;
}
`;var wM=`#ifdef LOG_DEPTH
// 1.0 at the near plane, increasing linearly from there.
out float v_depthFromNearPlusOne;
#ifdef SHADOW_MAP
out vec3 v_logPositionEC;
#endif
#endif

vec4 czm_updatePositionDepth(vec4 coords) {
#if defined(LOG_DEPTH)

#ifdef SHADOW_MAP
    vec3 logPositionEC = (czm_inverseProjection * coords).xyz;
    v_logPositionEC = logPositionEC;
#endif

    // With the very high far/near ratios used with the logarithmic depth
    // buffer, floating point rounding errors can cause linear depth values
    // to end up on the wrong side of the far plane, even for vertices that
    // are really nowhere near it. Since we always write a correct logarithmic
    // depth value in the fragment shader anyway, we just need to make sure
    // such errors don't cause the primitive to be clipped entirely before
    // we even get to the fragment shader.
    coords.z = clamp(coords.z / coords.w, -1.0, 1.0) * coords.w;
#endif

    return coords;
}

/**
 * Writes the logarithmic depth to gl_Position using the already computed gl_Position.
 *
 * @name czm_vertexLogDepth
 * @glslFunction
 */
void czm_vertexLogDepth()
{
#ifdef LOG_DEPTH
    v_depthFromNearPlusOne = (gl_Position.w - czm_currentFrustum.x) + 1.0;
    gl_Position = czm_updatePositionDepth(gl_Position);
#endif
}

/**
 * Writes the logarithmic depth to gl_Position using the provided clip coordinates.
 * <p>
 * An example use case for this function would be moving the vertex in window coordinates
 * before converting back to clip coordinates. Use the original vertex clip coordinates.
 * </p>
 * @name czm_vertexLogDepth
 * @glslFunction
 *
 * @param {vec4} clipCoords The vertex in clip coordinates.
 *
 * @example
 * czm_vertexLogDepth(czm_projection * vec4(positionEyeCoordinates, 1.0));
 */
void czm_vertexLogDepth(vec4 clipCoords)
{
#ifdef LOG_DEPTH
    v_depthFromNearPlusOne = (clipCoords.w - czm_currentFrustum.x) + 1.0;
    czm_updatePositionDepth(clipCoords);
#endif
}
`;var DM=`vec4 czm_screenToEyeCoordinates(vec4 screenCoordinate)
{
    // Reconstruct NDC coordinates
    float x = 2.0 * screenCoordinate.x - 1.0;
    float y = 2.0 * screenCoordinate.y - 1.0;
    float z = (screenCoordinate.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];
    vec4 q = vec4(x, y, z, 1.0);

    // Reverse the perspective division to obtain clip coordinates.
    q /= screenCoordinate.w;

    // Reverse the projection transformation to obtain eye coordinates.
    if (!(czm_inverseProjection == mat4(0.0))) // IE and Edge sometimes do something weird with != between mat4s
    {
        q = czm_inverseProjection * q;
    }
    else
    {
        float top = czm_frustumPlanes.x;
        float bottom = czm_frustumPlanes.y;
        float left = czm_frustumPlanes.z;
        float right = czm_frustumPlanes.w;

        float near = czm_currentFrustum.x;
        float far = czm_currentFrustum.y;

        q.x = (q.x * (right - left) + left + right) * 0.5;
        q.y = (q.y * (top - bottom) + bottom + top) * 0.5;
        q.z = (q.z * (near - far) - near - far) * 0.5;
        q.w = 1.0;
    }

    return q;
}

/**
 * Transforms a position from window to eye coordinates.
 * The transform from window to normalized device coordinates is done using components
 * of (@link czm_viewport} and {@link czm_viewportTransformation} instead of calculating
 * the inverse of <code>czm_viewportTransformation</code>. The transformation from
 * normalized device coordinates to clip coordinates is done using <code>fragmentCoordinate.w</code>,
 * which is expected to be the scalar used in the perspective divide. The transformation
 * from clip to eye coordinates is done using {@link czm_inverseProjection}.
 *
 * @name czm_windowToEyeCoordinates
 * @glslFunction
 *
 * @param {vec4} fragmentCoordinate The position in window coordinates to transform.
 *
 * @returns {vec4} The transformed position in eye coordinates.
 *
 * @see czm_modelToWindowCoordinates
 * @see czm_eyeToWindowCoordinates
 * @see czm_inverseProjection
 * @see czm_viewport
 * @see czm_viewportTransformation
 *
 * @example
 * vec4 positionEC = czm_windowToEyeCoordinates(gl_FragCoord);
 */
vec4 czm_windowToEyeCoordinates(vec4 fragmentCoordinate)
{
    vec2 screenCoordXY = (fragmentCoordinate.xy - czm_viewport.xy) / czm_viewport.zw;
    return czm_screenToEyeCoordinates(vec4(screenCoordXY, fragmentCoordinate.zw));
}

vec4 czm_screenToEyeCoordinates(vec2 screenCoordinateXY, float depthOrLogDepth)
{
    // See reverseLogDepth.glsl. This is separate to re-use the pow.
#if defined(LOG_DEPTH) || defined(LOG_DEPTH_READ_ONLY)
    float near = czm_currentFrustum.x;
    float far = czm_currentFrustum.y;
    float log2Depth = depthOrLogDepth * czm_log2FarDepthFromNearPlusOne;
    float depthFromNear = exp2(log2Depth) - 1.0;
    float depthFromCamera = depthFromNear + near;
    vec4 screenCoord = vec4(screenCoordinateXY, far * (1.0 - near / depthFromCamera) / (far - near), 1.0);
    vec4 eyeCoordinate = czm_screenToEyeCoordinates(screenCoord);
    eyeCoordinate.w = 1.0 / depthFromCamera; // Better precision
    return eyeCoordinate;
#else
    vec4 screenCoord = vec4(screenCoordinateXY, depthOrLogDepth, 1.0);
    vec4 eyeCoordinate = czm_screenToEyeCoordinates(screenCoord);
#endif
    return eyeCoordinate;
}

/**
 * Transforms a position given as window x/y and a depth or a log depth from window to eye coordinates.
 * This function produces more accurate results for window positions with log depth than
 * conventionally unpacking the log depth using czm_reverseLogDepth and using the standard version
 * of czm_windowToEyeCoordinates.
 *
 * @name czm_windowToEyeCoordinates
 * @glslFunction
 *
 * @param {vec2} fragmentCoordinateXY The XY position in window coordinates to transform.
 * @param {float} depthOrLogDepth A depth or log depth for the fragment.
 *
 * @see czm_modelToWindowCoordinates
 * @see czm_eyeToWindowCoordinates
 * @see czm_inverseProjection
 * @see czm_viewport
 * @see czm_viewportTransformation
 *
 * @returns {vec4} The transformed position in eye coordinates.
 */
vec4 czm_windowToEyeCoordinates(vec2 fragmentCoordinateXY, float depthOrLogDepth)
{
    vec2 screenCoordXY = (fragmentCoordinateXY.xy - czm_viewport.xy) / czm_viewport.zw;
    return czm_screenToEyeCoordinates(screenCoordXY, depthOrLogDepth);
}
`;var IM=`// emulated noperspective
#if !defined(LOG_DEPTH)
in float v_WindowZ;
#endif

/**
 * Emulates GL_DEPTH_CLAMP. Clamps a fragment to the near and far plane
 * by writing the fragment's depth. See czm_depthClamp for more details.
 *
 * @name czm_writeDepthClamp
 * @glslFunction
 *
 * @example
 * out_FragColor = color;
 * czm_writeDepthClamp();
 *
 * @see czm_depthClamp
 */
void czm_writeDepthClamp()
{
#if (!defined(LOG_DEPTH) && (__VERSION__ == 300 || defined(GL_EXT_frag_depth)))
    gl_FragDepth = clamp(v_WindowZ * gl_FragCoord.w, 0.0, 1.0);
#endif
}
`;var PM=`#ifdef LOG_DEPTH
in float v_depthFromNearPlusOne;

#ifdef POLYGON_OFFSET
uniform vec2 u_polygonOffset;
#endif

#endif

/**
 * Writes the fragment depth to the logarithmic depth buffer.
 * <p>
 * Use this when the vertex shader does not call {@link czm_vertexLogDepth}, for example, when
 * ray-casting geometry using a full screen quad.
 * </p>
 * @name czm_writeLogDepth
 * @glslFunction
 *
 * @param {float} depth The depth coordinate, where 1.0 is on the near plane and
 *                      depth increases in eye-space units from there
 *
 * @example
 * czm_writeLogDepth((czm_projection * v_positionEyeCoordinates).w + 1.0);
 */
void czm_writeLogDepth(float depth)
{
#if (defined(LOG_DEPTH) && (__VERSION__ == 300 || defined(GL_EXT_frag_depth)))
    // Discard the vertex if it's not between the near and far planes.
    // We allow a bit of epsilon on the near plane comparison because a 1.0
    // from the vertex shader (indicating the vertex should be _on_ the near
    // plane) will not necessarily come here as exactly 1.0.
    if (depth <= 0.9999999 || depth > czm_farDepthFromNearPlusOne) {
        discard;
    }

#ifdef POLYGON_OFFSET
    // Polygon offset: m * factor + r * units
    float factor = u_polygonOffset[0];
    float units = u_polygonOffset[1];

#if (__VERSION__ == 300 || defined(GL_OES_standard_derivatives))
    // This factor doesn't work in IE 10
    if (factor != 0.0) {
        // m = sqrt(dZdX^2 + dZdY^2);
        float x = dFdx(depth);
        float y = dFdy(depth);
        float m = sqrt(x * x + y * y);

        // Apply the factor before computing the log depth.
        depth += m * factor;
    }
#endif

#endif

    gl_FragDepth = log2(depth) * czm_oneOverLog2FarDepthFromNearPlusOne;

#ifdef POLYGON_OFFSET
    // Apply the units after the log depth.
    gl_FragDepth += czm_epsilon7 * units;
#endif

#endif
}

/**
 * Writes the fragment depth to the logarithmic depth buffer.
 * <p>
 * Use this when the vertex shader calls {@link czm_vertexLogDepth}.
 * </p>
 *
 * @name czm_writeLogDepth
 * @glslFunction
 */
void czm_writeLogDepth() {
#ifdef LOG_DEPTH
    czm_writeLogDepth(v_depthFromNearPlusOne);
#endif
}
`;var RM=`/**
 * Transforms a value for non-perspective interpolation by multiplying
 * it by w, the value used in the perspective divide. This function is
 * intended to be called in a vertex shader to compute the value of a
 * \`varying\` that should not be subject to perspective interpolation.
 * For example, screen-space texture coordinates. The fragment shader
 * must call {@link czm_readNonPerspective} to retrieve the final
 * non-perspective value.
 *
 * @name czm_writeNonPerspective
 * @glslFunction
 *
 * @param {float|vec2|vec3|vec4} value The value to be interpolated without accounting for perspective.
 * @param {float} w The perspective divide value. Usually this is the computed \`gl_Position.w\`.
 * @returns {float|vec2|vec3|vec4} The transformed value, intended to be stored in a \`varying\` and read in the
 *          fragment shader with {@link czm_readNonPerspective}.
 */
float czm_writeNonPerspective(float value, float w) {
    return value * w;
}

vec2 czm_writeNonPerspective(vec2 value, float w) {
    return value * w;
}

vec3 czm_writeNonPerspective(vec3 value, float w) {
    return value * w;
}

vec4 czm_writeNonPerspective(vec4 value, float w) {
    return value * w;
}
`;var OM=`/**
 * Converts a CIE Yxy color to RGB.
 * <p>The conversion is described in
 * {@link http://content.gpwiki.org/index.php/D3DBook:High-Dynamic_Range_Rendering#Luminance_Transform|Luminance Transform}
 * </p>
 * 
 * @name czm_XYZToRGB
 * @glslFunction
 * 
 * @param {vec3} Yxy The color in CIE Yxy.
 *
 * @returns {vec3} The color in RGB.
 *
 * @example
 * vec3 xyz = czm_RGBToXYZ(rgb);
 * xyz.x = max(xyz.x - luminanceThreshold, 0.0);
 * rgb = czm_XYZToRGB(xyz);
 */
vec3 czm_XYZToRGB(vec3 Yxy)
{
    const mat3 XYZ2RGB = mat3( 3.2405, -0.9693,  0.0556,
                              -1.5371,  1.8760, -0.2040,
                              -0.4985,  0.0416,  1.0572);
    vec3 xyz;
    xyz.r = Yxy.r * Yxy.g / Yxy.b;
    xyz.g = Yxy.r;
    xyz.b = Yxy.r * (1.0 - Yxy.g - Yxy.b) / Yxy.b;
    
    return XYZ2RGB * xyz;
}
`;var TC={czm_degreesPerRadian:rR,czm_depthRange:sR,czm_epsilon1:aR,czm_epsilon2:cR,czm_epsilon3:lR,czm_epsilon4:uR,czm_epsilon5:fR,czm_epsilon6:dR,czm_epsilon7:hR,czm_infinity:mR,czm_oneOverPi:pR,czm_oneOverTwoPi:_R,czm_passCesium3DTile:gR,czm_passCesium3DTileClassification:yR,czm_passCesium3DTileClassificationIgnoreShow:xR,czm_passClassification:bR,czm_passCompute:CR,czm_passEnvironment:AR,czm_passGlobe:TR,czm_passOpaque:ER,czm_passOverlay:SR,czm_passTerrainClassification:vR,czm_passTranslucent:wR,czm_passVoxels:DR,czm_pi:IR,czm_piOverFour:PR,czm_piOverSix:RR,czm_piOverThree:OR,czm_piOverTwo:MR,czm_radiansPerDegree:LR,czm_sceneMode2D:NR,czm_sceneMode3D:FR,czm_sceneModeColumbusView:BR,czm_sceneModeMorphing:kR,czm_solarRadius:VR,czm_threePiOver2:UR,czm_twoPi:zR,czm_webMercatorMaxLatitude:HR,czm_depthRangeStruct:GR,czm_material:WR,czm_materialInput:jR,czm_modelMaterial:qR,czm_modelVertexOutput:YR,czm_ray:XR,czm_raySegment:KR,czm_shadowParameters:ZR,czm_acesTonemapping:$R,czm_alphaWeight:QR,czm_antialias:JR,czm_applyHSBShift:eO,czm_approximateSphericalCoordinates:tO,czm_approximateTanh:nO,czm_backFacing:iO,czm_branchFreeTernary:oO,czm_cascadeColor:rO,czm_cascadeDistance:sO,czm_cascadeMatrix:aO,czm_cascadeWeights:cO,czm_clipPolygons:lO,czm_columbusViewMorph:uO,czm_computeAtmosphereColor:fO,czm_computeGroundAtmosphereScattering:dO,czm_computePosition:hO,czm_computeScattering:mO,czm_cosineAndSine:pO,czm_decompressTextureCoordinates:_O,czm_depthClamp:gO,czm_eastNorthUpToEyeCoordinates:yO,czm_ellipsoidContainsPoint:xO,czm_ellipsoidTextureCoordinates:bO,czm_equalsEpsilon:CO,czm_eyeOffset:AO,czm_eyeToWindowCoordinates:TO,czm_fastApproximateAtan:EO,czm_fog:SO,czm_gammaCorrect:vO,czm_geodeticSurfaceNormal:wO,czm_getDefaultMaterial:DO,czm_getDynamicAtmosphereLightDirection:IO,czm_getLambertDiffuse:PO,czm_getSpecular:RO,czm_getWaterNoise:OO,czm_HSBToRGB:MO,czm_HSLToRGB:LO,czm_hue:NO,czm_inverseGamma:FO,czm_isEmpty:BO,czm_isFull:kO,czm_latitudeToWebMercatorFraction:VO,czm_linearToSrgb:UO,czm_lineDistance:zO,czm_luminance:HO,czm_maximumComponent:GO,czm_metersPerPixel:WO,czm_modelToWindowCoordinates:jO,czm_multiplyWithColorBalance:qO,czm_nearFarScalar:YO,czm_octDecode:XO,czm_packDepth:KO,czm_pbrLighting:ZO,czm_pbrNeutralTonemapping:$O,czm_phong:QO,czm_planeDistance:JO,czm_pointAlongRay:eM,czm_rayEllipsoidIntersectionInterval:tM,czm_raySphereIntersectionInterval:nM,czm_readDepth:iM,czm_readNonPerspective:oM,czm_reverseLogDepth:rM,czm_RGBToHSB:sM,czm_RGBToHSL:aM,czm_RGBToXYZ:cM,czm_round:lM,czm_saturation:uM,czm_shadowDepthCompare:fM,czm_shadowVisibility:dM,czm_signNotZero:hM,czm_sphericalHarmonics:mM,czm_srgbToLinear:pM,czm_tangentToEyeSpaceMatrix:_M,czm_textureCube:gM,czm_transformPlane:yM,czm_translateRelativeToEye:xM,czm_translucentPhong:bM,czm_transpose:CM,czm_unpackClippingExtents:AM,czm_unpackDepth:TM,czm_unpackFloat:EM,czm_unpackUint:SM,czm_valueTransform:vM,czm_vertexLogDepth:wM,czm_windowToEyeCoordinates:DM,czm_writeDepthClamp:IM,czm_writeLogDepth:PM,czm_writeNonPerspective:RM,czm_XYZToRGB:OM};function RIe(e,t){let n=e;return n=n.replaceAll("version 300 es",""),n=n.replaceAll(/(texture\()/g,"texture2D("),t?(n=n.replaceAll(/\n\s*(in)\s+(vec\d|mat\d|float)/g,`
varying $2`),/out_FragData_(\d+)/.test(n)&&(n=`#extension GL_EXT_draw_buffers : enable
${n}`,n=n.replaceAll(/layout\s+\(location\s*=\s*\d+\)\s*out\s+vec4\s+out_FragData_\d+;/g,""),n=n.replaceAll(/out_FragData_(\d+)/g,"gl_FragData[$1]")),n=n.replaceAll(/layout\s+\(location\s*=\s*0\)\s*out\s+vec4\s+out_FragColor;/g,""),n=n.replaceAll(/out_FragColor/g,"gl_FragColor"),n=n.replaceAll(/out_FragColor\[(\d+)\]/g,"gl_FragColor[$1]"),/gl_FragDepth/.test(n)&&(n=`#extension GL_EXT_frag_depth : enable
${n}`,n=n.replaceAll(/gl_FragDepth/g,"gl_FragDepthEXT")),n=`#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable
#endif
${n}`,n=`#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
${n}`):(n=n.replaceAll(/(in)\s+(vec\d|mat\d|float)/g,"attribute $2"),n=n.replaceAll(/(out)\s+(vec\d|mat\d|float)\s+([\w]+);/g,"varying $2 $3;")),n=`#version 100
${n}`,n}var MM=RIe;function gee(e){return e=e.replace(/\/\/.*/g,""),e.replace(/\/\*\*[\s\S]*?\*\//gm,function(t){let n=t.match(/\n/gm).length,i="";for(let o=0;o<n;++o)i+=`
`;return i})}function yee(e,t,n){let i;for(let o=0;o<n.length;++o)n[o].name===e&&(i=n[o]);return u(i)||(t=gee(t),i={name:e,glslSource:t,dependsOn:[],requiredBy:[],evaluated:!1},n.push(i)),i}function xee(e,t){if(e.evaluated)return;e.evaluated=!0;let n=e.glslSource.match(/\bczm_[a-zA-Z0-9_]*/g);u(n)&&n!==null&&(n=n.filter(function(i,o){return n.indexOf(i)===o}),n.forEach(function(i){if(i!==e.name&&Ls._czmBuiltinsAndUniforms.hasOwnProperty(i)){let o=yee(i,Ls._czmBuiltinsAndUniforms[i],t);e.dependsOn.push(o),o.requiredBy.push(e),xee(o,t)}}))}function OIe(e){let t=[],n=[];for(;e.length>0;){let o=e.pop();n.push(o),o.requiredBy.length===0&&t.push(o)}for(;t.length>0;){let o=t.shift();e.push(o);for(let r=0;r<o.dependsOn.length;++r){let s=o.dependsOn[r],a=s.requiredBy.indexOf(o);s.requiredBy.splice(a,1),s.requiredBy.length===0&&t.push(s)}}let i=[];for(let o=0;o<n.length;++o)n[o].requiredBy.length!==0&&i.push(n[o])}function MIe(e){let t=[],n=yee("main",e,t);xee(n,t),OIe(t);let i="";for(let o=t.length-1;o>=0;--o)i=`${i+t[o].glslSource}
`;return i.replace(n.glslSource,"")}function bee(e,t,n){let i,o,r="",s=e.sources;if(u(s))for(i=0,o=s.length;i<o;++i)r+=`
#line 0
${s[i]}`;r=gee(r);let a;r=r.replace(/#version\s+(.*?)\n/gm,function(y,b){return a=b,`
`});let c=[];r=r.replace(/#extension.*\n/gm,function(y){return c.push(y),`
`}),r=r.replace(/precision\s(lowp|mediump|highp)\s(float|int);/,"");let l=e.pickColorQualifier;u(l)&&(r=Ls.createPickFragmentShaderSource(r,l));let f="",d=c.length;for(i=0;i<d;i++)f+=c[i];t&&(f+=`#ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    precision highp int;
#else
    precision mediump float;
    precision mediump int;
    #define highp mediump
#endif

`);let p=e.defines;if(u(p))for(i=0,o=p.length;i<o;++i){let y=p[i];y.length!==0&&(f+=`#define ${y}
`)}n.textureFloatLinear&&(f+=`#define OES_texture_float_linear

`),n.floatingPointTexture&&(f+=`#define OES_texture_float

`);let g="";e.includeBuiltIns&&(g=MIe(r)),f+=`
#line 0
`;let m=g+r;return n.webgl2&&t&&!/layout\s*\(location\s*=\s*0\)\s*out\s+vec4\s+out_FragColor;/g.test(m)&&!/czm_out_FragColor/g.test(m)&&/out_FragColor/g.test(m)&&(f+=`layout(location = 0) out vec4 out_FragColor;

`),f+=g,f+=r,n.webgl2?f=`#version 300 es
${f}`:f=MM(f,t),f}function Ls(e){e=x(e,x.EMPTY_OBJECT);let t=e.pickColorQualifier;this.defines=u(e.defines)?e.defines.slice(0):[],this.sources=u(e.sources)?e.sources.slice(0):[],this.pickColorQualifier=t,this.includeBuiltIns=x(e.includeBuiltIns,!0)}Ls.prototype.clone=function(){return new Ls({sources:this.sources,defines:this.defines,pickColorQualifier:this.pickColorQualifier,includeBuiltIns:this.includeBuiltIns})};Ls.replaceMain=function(e,t){return t=`void ${t}()`,e.replace(/void\s+main\s*\(\s*(?:void)?\s*\)/g,t)};Ls.prototype.getCacheKey=function(){let t=this.defines.slice().sort().join(","),n=this.pickColorQualifier,i=this.includeBuiltIns,o=this.sources.join(`
`);return`${t}:${n}:${i}:${o}`};Ls.prototype.createCombinedVertexShader=function(e){return bee(this,!1,e)};Ls.prototype.createCombinedFragmentShader=function(e){return bee(this,!0,e)};Ls._czmBuiltinsAndUniforms={};for(let e in TC)TC.hasOwnProperty(e)&&(Ls._czmBuiltinsAndUniforms[e]=TC[e]);for(let e in I_)if(I_.hasOwnProperty(e)){let t=I_[e];typeof t.getDeclaration=="function"&&(Ls._czmBuiltinsAndUniforms[e]=t.getDeclaration(e))}Ls.createPickVertexShaderSource=function(e){return`${Ls.replaceMain(e,"czm_old_main")}
in vec4 pickColor; 
out vec4 czm_pickColor; 
void main() 
{ 
    czm_old_main(); 
    czm_pickColor = pickColor; 
}`};Ls.createPickFragmentShaderSource=function(e,t){let n=Ls.replaceMain(e,"czm_old_main"),i=`${t} vec4 czm_pickColor; 
void main() 
{ 
    czm_old_main(); 
    if (out_FragColor.a == 0.0) { 
       discard; 
    } 
    out_FragColor = czm_pickColor; 
}`;return`${n}
${i}`};function LIe(e,t){let n=e.defines,i=n.length;for(let o=0;o<i;++o)if(n[o]===t)return!0;return!1}function Cee(e,t){let n=e.sources,i=n.length;for(let o=0;o<i;++o)if(n[o].indexOf(t)!==-1)return!0;return!1}function Aee(e,t){let n=t.length;for(let i=0;i<n;++i){let o=t[i];if(Cee(e,o))return o}}var NIe=["v_normalEC","v_normal"];Ls.findNormalVarying=function(e){return Cee(e,"#ifdef HAS_NORMALS")?LIe(e,"HAS_NORMALS")?"v_normalEC":void 0:Aee(e,NIe)};var FIe=["v_positionEC"];Ls.findPositionVarying=function(e){return Aee(e,FIe)};var ze=Ls;function fd(e){this._context=e,this._shaders={},this._numberOfShaders=0,this._shadersToRelease={}}Object.defineProperties(fd.prototype,{numberOfShaders:{get:function(){return this._numberOfShaders}}});fd.prototype.replaceShaderProgram=function(e){return u(e.shaderProgram)&&e.shaderProgram.destroy(),this.getShaderProgram(e)};function BIe(e){let t=Object.keys(e).sort();return JSON.stringify(e,t)}fd.prototype.getShaderProgram=function(e){let t=e.vertexShaderSource,n=e.fragmentShaderSource,i=e.attributeLocations;typeof t=="string"&&(t=new ze({sources:[t]})),typeof n=="string"&&(n=new ze({sources:[n]}));let o=t.getCacheKey(),r=n.getCacheKey(),s=u(i)?BIe(i):"",a=`${o}:${r}:${s}`,c;if(u(this._shaders[a]))c=this._shaders[a],delete this._shadersToRelease[a];else{let l=this._context,f=t.createCombinedVertexShader(l),d=n.createCombinedFragmentShader(l),p=new tn({gl:l._gl,logShaderCompilation:l.logShaderCompilation,debugShaders:l.debugShaders,vertexShaderSource:t,vertexShaderText:f,fragmentShaderSource:n,fragmentShaderText:d,attributeLocations:i});c={cache:this,shaderProgram:p,keyword:a,derivedKeywords:[],count:0},p._cachedShader=c,this._shaders[a]=c,++this._numberOfShaders}return++c.count,c.shaderProgram};fd.prototype.replaceDerivedShaderProgram=function(e,t,n){let i=e._cachedShader,o=t+i.keyword,r=this._shaders[o];if(u(r)){KG(this,r);let s=i.derivedKeywords.indexOf(t);s>-1&&i.derivedKeywords.splice(s,1)}return this.createDerivedShaderProgram(e,t,n)};fd.prototype.getDerivedShaderProgram=function(e,t){let n=e._cachedShader,i=t+n.keyword,o=this._shaders[i];if(u(o))return o.shaderProgram};fd.prototype.createDerivedShaderProgram=function(e,t,n){let i=e._cachedShader,o=t+i.keyword,r=n.vertexShaderSource,s=n.fragmentShaderSource,a=n.attributeLocations;typeof r=="string"&&(r=new ze({sources:[r]})),typeof s=="string"&&(s=new ze({sources:[s]}));let c=this._context,l=r.createCombinedVertexShader(c),f=s.createCombinedFragmentShader(c),d=new tn({gl:c._gl,logShaderCompilation:c.logShaderCompilation,debugShaders:c.debugShaders,vertexShaderSource:r,vertexShaderText:l,fragmentShaderSource:s,fragmentShaderText:f,attributeLocations:a}),p={cache:this,shaderProgram:d,keyword:o,derivedKeywords:[],count:0};return i.derivedKeywords.push(t),d._cachedShader=p,this._shaders[o]=p,d};function KG(e,t){let n=t.derivedKeywords,i=n.length;for(let o=0;o<i;++o){let r=n[o]+t.keyword,s=e._shaders[r];KG(e,s)}delete e._shaders[t.keyword],t.shaderProgram.finalDestroy()}fd.prototype.destroyReleasedShaderPrograms=function(){let e=this._shadersToRelease;for(let t in e)if(e.hasOwnProperty(t)){let n=e[t];KG(this,n),--this._numberOfShaders}this._shadersToRelease={}};fd.prototype.releaseShaderProgram=function(e){if(u(e)){let t=e._cachedShader;t&&--t.count===0&&(this._shadersToRelease[t.keyword]=t)}};fd.prototype.isDestroyed=function(){return!1};fd.prototype.destroy=function(){let e=this._shaders;for(let t in e)e.hasOwnProperty(t)&&e[t].shaderProgram.finalDestroy();return ue(this)};var LM=fd;function dd(e){e=x(e,x.EMPTY_OBJECT);let{context:t,source:n,pixelFormat:i=tt.RGBA,pixelDatatype:o=Ke.UNSIGNED_BYTE,flipY:r=!0,skipColorSpaceConversion:s=!1,sampler:a=new Qt}=e,{width:c,height:l}=e;u(n)&&(u(c)||(c=n.videoWidth??n.naturalWidth??n.width),u(l)||(l=n.videoHeight??n.naturalHeight??n.height));let f=e.preMultiplyAlpha||i===tt.RGB||i===tt.LUMINANCE,d=tt.toInternalFormat(i,o,t),p=tt.isCompressedFormat(d),g=t._gl,m=p?tt.compressedTextureSizeInBytes(i,c,l):tt.textureSizeInBytes(i,o,c,l);this._id=Hn(),this._context=t,this._textureFilterAnisotropic=t._textureFilterAnisotropic,this._textureTarget=g.TEXTURE_2D,this._texture=g.createTexture(),this._internalFormat=d,this._pixelFormat=i,this._pixelDatatype=o,this._width=c,this._height=l,this._dimensions=new H(c,l),this._hasMipmap=!1,this._sizeInBytes=m,this._preMultiplyAlpha=f,this._flipY=r,this._initialized=!1,this._sampler=void 0,this._sampler=a,Tee(this,a),g.activeTexture(g.TEXTURE0),g.bindTexture(this._textureTarget,this._texture),u(n)?(s?g.pixelStorei(g.UNPACK_COLORSPACE_CONVERSION_WEBGL,g.NONE):g.pixelStorei(g.UNPACK_COLORSPACE_CONVERSION_WEBGL,g.BROWSER_DEFAULT_WEBGL),u(n.arrayBufferView)?tt.isCompressedFormat(d)?kIe(this,n):VIe(this,n):u(n.framebuffer)?UIe(this,n):zIe(this,n),this._initialized=!0):HIe(this),g.bindTexture(this._textureTarget,null)}function kIe(e,t){let i=e._context._gl,o=e._textureTarget,r=e._internalFormat,{width:s,height:a}=e;if(i.pixelStorei(i.UNPACK_ALIGNMENT,4),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1),i.compressedTexImage2D(o,0,r,s,a,0,t.arrayBufferView),u(t.mipLevels)){let c=s,l=a;for(let f=0;f<t.mipLevels.length;++f)c=NM(c),l=NM(l),i.compressedTexImage2D(o,f+1,r,c,l,0,t.mipLevels[f])}}function VIe(e,t){let n=e._context,i=n._gl,o=e._textureTarget,r=e._internalFormat,{width:s,height:a,pixelFormat:c,pixelDatatype:l,flipY:f}=e,d=tt.alignmentInBytes(c,l,s);i.pixelStorei(i.UNPACK_ALIGNMENT,d),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1);let p=t.arrayBufferView;if(f&&(p=tt.flipY(p,c,l,s,a)),i.texImage2D(o,0,r,s,a,0,c,Ke.toWebGLConstant(l,n),p),u(t.mipLevels)){let g=s,m=a;for(let y=0;y<t.mipLevels.length;++y)g=NM(g),m=NM(m),i.texImage2D(o,y+1,r,g,m,0,c,Ke.toWebGLConstant(l,n),t.mipLevels[y])}}function UIe(e,t){let n=e._context,i=n._gl;i.pixelStorei(i.UNPACK_ALIGNMENT,4),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1),t.framebuffer!==n.defaultFramebuffer&&t.framebuffer._bind(),i.copyTexImage2D(e._textureTarget,0,e._internalFormat,t.xOffset,t.yOffset,e.width,e.height,0),t.framebuffer!==n.defaultFramebuffer&&t.framebuffer._unBind()}function zIe(e,t){let n=e._context,i=n._gl;i.pixelStorei(i.UNPACK_ALIGNMENT,4),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.preMultiplyAlpha),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,e.flipY),i.texImage2D(e._textureTarget,0,e._internalFormat,e.pixelFormat,Ke.toWebGLConstant(e.pixelDatatype,n),t)}function NM(e){let t=Math.floor(e/2)|0;return Math.max(t,1)}function HIe(e){let t=e._context;t._gl.texImage2D(e._textureTarget,0,e._internalFormat,e._width,e._height,0,e._pixelFormat,Ke.toWebGLConstant(e._pixelDatatype,t),null)}dd.create=function(e){return new dd(e)};dd.fromFramebuffer=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.context,n=t._gl,{pixelFormat:i=tt.RGB,framebufferXOffset:o=0,framebufferYOffset:r=0,width:s=n.drawingBufferWidth,height:a=n.drawingBufferHeight,framebuffer:c}=e;return new dd({context:t,width:s,height:a,pixelFormat:i,source:{framebuffer:u(c)?c:t.defaultFramebuffer,xOffset:o,yOffset:r,width:s,height:a}})};Object.defineProperties(dd.prototype,{id:{get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(e){Tee(this,e),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(this._sizeInBytes*4/3):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}}});function Tee(e,t){let{minificationFilter:n,magnificationFilter:i}=t,o=[$t.NEAREST_MIPMAP_NEAREST,$t.NEAREST_MIPMAP_LINEAR,$t.LINEAR_MIPMAP_NEAREST,$t.LINEAR_MIPMAP_LINEAR].includes(n),r=e._context,s=e._pixelFormat,a=e._pixelDatatype;(a===Ke.FLOAT&&!r.textureFloatLinear||a===Ke.HALF_FLOAT&&!r.textureHalfFloatLinear)&&(n=o?$t.NEAREST_MIPMAP_NEAREST:$t.NEAREST,i=mi.NEAREST),r.webgl2&&tt.isDepthFormat(s)&&(n=$t.NEAREST,i=mi.NEAREST);let c=r._gl,l=e._textureTarget;c.activeTexture(c.TEXTURE0),c.bindTexture(l,e._texture),c.texParameteri(l,c.TEXTURE_MIN_FILTER,n),c.texParameteri(l,c.TEXTURE_MAG_FILTER,i),c.texParameteri(l,c.TEXTURE_WRAP_S,t.wrapS),c.texParameteri(l,c.TEXTURE_WRAP_T,t.wrapT),u(e._textureFilterAnisotropic)&&c.texParameteri(l,e._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.maximumAnisotropy),c.bindTexture(l,null)}dd.prototype.copyFrom=function(e){let{xOffset:t=0,yOffset:n=0,source:i,skipColorSpaceConversion:o=!1}=e,r=this._context,s=r._gl,a=this._textureTarget;s.activeTexture(s.TEXTURE0),s.bindTexture(a,this._texture);let{width:c,height:l}=i,f=i.arrayBufferView;u(i.videoWidth)&&u(i.videoHeight)?(c=i.videoWidth,l=i.videoHeight):u(i.naturalWidth)&&u(i.naturalHeight)&&(c=i.naturalWidth,l=i.naturalHeight);let d=this._width,p=this._height,g=this._internalFormat,m=this._pixelFormat,y=this._pixelDatatype,b=this._preMultiplyAlpha,C=this._flipY,A=4;u(f)&&(A=tt.alignmentInBytes(m,y,c)),s.pixelStorei(s.UNPACK_ALIGNMENT,A),o?s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,s.NONE):s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,s.BROWSER_DEFAULT_WEBGL);let T=!1;if(!this._initialized){let E;t===0&&n===0&&c===d&&l===p?(u(f)?(s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1),C?E=tt.flipY(f,m,y,d,p):E=f):(s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,C),E=i),T=!0):(s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1),E=tt.createTypedArray(m,y,d,p)),s.texImage2D(a,0,g,d,p,0,m,Ke.toWebGLConstant(y,r),E),this._initialized=!0}if(!T){let E;u(f)?(s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1),C?E=tt.flipY(f,m,y,c,l):E=f):(s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,C),E=i),s.texSubImage2D(a,0,t,n,c,l,m,Ke.toWebGLConstant(y,r),E)}s.bindTexture(a,null)};dd.prototype.copyFromFramebuffer=function(e,t,n,i,o,r){e=x(e,0),t=x(t,0),n=x(n,0),i=x(i,0),o=x(o,this._width),r=x(r,this._height);let s=this._context._gl,a=this._textureTarget;s.activeTexture(s.TEXTURE0),s.bindTexture(a,this._texture),s.copyTexSubImage2D(a,0,e,t,n,i,o,r),s.bindTexture(a,null),this._initialized=!0};dd.prototype.generateMipmap=function(e){e=x(e,ip.DONT_CARE),this._hasMipmap=!0;let t=this._context._gl,n=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(n,this._texture),t.generateMipmap(n),t.bindTexture(n,null)};dd.prototype.isDestroyed=function(){return!1};dd.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),ue(this)};var Ot=dd;function My(){this._textures={},this._numberOfTextures=0,this._texturesToRelease={}}Object.defineProperties(My.prototype,{numberOfTextures:{get:function(){return this._numberOfTextures}}});My.prototype.getTexture=function(e){let t=this._textures[e];if(u(t))return delete this._texturesToRelease[e],++t.count,t.texture};My.prototype.addTexture=function(e,t){let n={texture:t,count:1};t.finalDestroy=t.destroy;let i=this;t.destroy=function(){--n.count===0&&(i._texturesToRelease[e]=n)},this._textures[e]=n,++this._numberOfTextures};My.prototype.destroyReleasedTextures=function(){let e=this._texturesToRelease;for(let t in e)if(e.hasOwnProperty(t)){let n=e[t];delete this._textures[t],n.texture.finalDestroy(),--this._numberOfTextures}this._texturesToRelease={}};My.prototype.isDestroyed=function(){return!1};My.prototype.destroy=function(){let e=this._textures;for(let t in e)e.hasOwnProperty(t)&&e[t].texture.finalDestroy();return ue(this)};var FM=My;function $u(e){this.planes=x(e,[])}var $S=[new h,new h,new h];h.clone(h.UNIT_X,$S[0]);h.clone(h.UNIT_Y,$S[1]);h.clone(h.UNIT_Z,$S[2]);var U_=new h,GIe=new h,Eee=new cn(new h(1,0,0),0);$u.fromBoundingSphere=function(e,t){u(t)||(t=new $u);let n=$S.length,i=t.planes;i.length=2*n;let o=e.center,r=e.radius,s=0;for(let a=0;a<n;++a){let c=$S[a],l=i[s],f=i[s+1];u(l)||(l=i[s]=new oe),u(f)||(f=i[s+1]=new oe),h.multiplyByScalar(c,-r,U_),h.add(o,U_,U_),l.x=c.x,l.y=c.y,l.z=c.z,l.w=-h.dot(c,U_),h.multiplyByScalar(c,r,U_),h.add(o,U_,U_),f.x=-c.x,f.y=-c.y,f.z=-c.z,f.w=-h.dot(h.negate(c,GIe),U_),s+=2}return t};$u.prototype.computeVisibility=function(e){let t=this.planes,n=!1;for(let i=0,o=t.length;i<o;++i){let r=e.intersectPlane(cn.fromCartesian4(t[i],Eee));if(r===qt.OUTSIDE)return qt.OUTSIDE;r===qt.INTERSECTING&&(n=!0)}return n?qt.INTERSECTING:qt.INSIDE};$u.prototype.computeVisibilityWithPlaneMask=function(e,t){if(t===$u.MASK_OUTSIDE||t===$u.MASK_INSIDE)return t;let n=$u.MASK_INSIDE,i=this.planes;for(let o=0,r=i.length;o<r;++o){let s=o<31?1<<o:0;if(o<31&&!(t&s))continue;let a=e.intersectPlane(cn.fromCartesian4(i[o],Eee));if(a===qt.OUTSIDE)return $u.MASK_OUTSIDE;a===qt.INTERSECTING&&(n|=s)}return n};$u.MASK_OUTSIDE=4294967295;$u.MASK_INSIDE=0;$u.MASK_INDETERMINATE=2147483647;var bs=$u;function wh(e){e=x(e,x.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=x(e.near,1),this._near=this.near,this.far=x(e.far,5e8),this._far=this.far,this._cullingVolume=new bs,this._orthographicMatrix=new F}function See(e){(e.top!==e._top||e.bottom!==e._bottom||e.left!==e._left||e.right!==e._right||e.near!==e._near||e.far!==e._far)&&(e._left=e.left,e._right=e.right,e._top=e.top,e._bottom=e.bottom,e._near=e.near,e._far=e.far,e._orthographicMatrix=F.computeOrthographicOffCenter(e.left,e.right,e.bottom,e.top,e.near,e.far,e._orthographicMatrix))}Object.defineProperties(wh.prototype,{projectionMatrix:{get:function(){return See(this),this._orthographicMatrix}}});var WIe=new h,jIe=new h,qIe=new h,ZG=new h;wh.prototype.computeCullingVolume=function(e,t,n){let i=this._cullingVolume.planes,o=this.top,r=this.bottom,s=this.right,a=this.left,c=this.near,l=this.far,f=h.cross(t,n,WIe);h.normalize(f,f);let d=jIe;h.multiplyByScalar(t,c,d),h.add(e,d,d);let p=qIe;h.multiplyByScalar(f,a,p),h.add(d,p,p);let g=i[0];return u(g)||(g=i[0]=new oe),g.x=f.x,g.y=f.y,g.z=f.z,g.w=-h.dot(f,p),h.multiplyByScalar(f,s,p),h.add(d,p,p),g=i[1],u(g)||(g=i[1]=new oe),g.x=-f.x,g.y=-f.y,g.z=-f.z,g.w=-h.dot(h.negate(f,ZG),p),h.multiplyByScalar(n,r,p),h.add(d,p,p),g=i[2],u(g)||(g=i[2]=new oe),g.x=n.x,g.y=n.y,g.z=n.z,g.w=-h.dot(n,p),h.multiplyByScalar(n,o,p),h.add(d,p,p),g=i[3],u(g)||(g=i[3]=new oe),g.x=-n.x,g.y=-n.y,g.z=-n.z,g.w=-h.dot(h.negate(n,ZG),p),g=i[4],u(g)||(g=i[4]=new oe),g.x=t.x,g.y=t.y,g.z=t.z,g.w=-h.dot(t,d),h.multiplyByScalar(t,l,p),h.add(e,p,p),g=i[5],u(g)||(g=i[5]=new oe),g.x=-t.x,g.y=-t.y,g.z=-t.z,g.w=-h.dot(h.negate(t,ZG),p),this._cullingVolume};wh.prototype.getPixelDimensions=function(e,t,n,i,o){See(this);let r=this.right-this.left,s=this.top-this.bottom,a=i*r/e,c=i*s/t;return o.x=a,o.y=c,o};wh.prototype.clone=function(e){return u(e)||(e=new wh),e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e};wh.prototype.equals=function(e){return u(e)&&e instanceof wh&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far};wh.prototype.equalsEpsilon=function(e,t,n){return e===this||u(e)&&e instanceof wh&&R.equalsEpsilon(this.right,e.right,t,n)&&R.equalsEpsilon(this.left,e.left,t,n)&&R.equalsEpsilon(this.top,e.top,t,n)&&R.equalsEpsilon(this.bottom,e.bottom,t,n)&&R.equalsEpsilon(this.near,e.near,t,n)&&R.equalsEpsilon(this.far,e.far,t,n)};var Gr=wh;function fl(e){e=x(e,x.EMPTY_OBJECT),this._offCenterFrustum=new Gr,this.width=e.width,this._width=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=x(e.near,1),this._near=this.near,this.far=x(e.far,5e8),this._far=this.far}fl.packedLength=4;fl.pack=function(e,t,n){return n=x(n,0),t[n++]=e.width,t[n++]=e.aspectRatio,t[n++]=e.near,t[n]=e.far,t};fl.unpack=function(e,t,n){return t=x(t,0),u(n)||(n=new fl),n.width=e[t++],n.aspectRatio=e[t++],n.near=e[t++],n.far=e[t],n};function z_(e){let t=e._offCenterFrustum;if(e.width!==e._width||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far){e._aspectRatio=e.aspectRatio,e._width=e.width,e._near=e.near,e._far=e.far;let n=1/e.aspectRatio;t.right=e.width*.5,t.left=-t.right,t.top=n*t.right,t.bottom=-t.top,t.near=e.near,t.far=e.far}}Object.defineProperties(fl.prototype,{projectionMatrix:{get:function(){return z_(this),this._offCenterFrustum.projectionMatrix}},offCenterFrustum:{get:function(){return z_(this),this._offCenterFrustum}}});fl.prototype.computeCullingVolume=function(e,t,n){return z_(this),this._offCenterFrustum.computeCullingVolume(e,t,n)};fl.prototype.getPixelDimensions=function(e,t,n,i,o){return z_(this),this._offCenterFrustum.getPixelDimensions(e,t,n,i,o)};fl.prototype.clone=function(e){return u(e)||(e=new fl),e.aspectRatio=this.aspectRatio,e.width=this.width,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._width=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e};fl.prototype.equals=function(e){return!u(e)||!(e instanceof fl)?!1:(z_(this),z_(e),this.width===e.width&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))};fl.prototype.equalsEpsilon=function(e,t,n){return!u(e)||!(e instanceof fl)?!1:(z_(this),z_(e),R.equalsEpsilon(this.width,e.width,t,n)&&R.equalsEpsilon(this.aspectRatio,e.aspectRatio,t,n)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,t,n))};var sn=fl;var $G={};function YIe(e){let t=6.239996+.0172019696544*e;return .001657*Math.sin(t+.01671*Math.sin(t))}var XIe=32.184,KIe=2451545;function Wee(e,t){t=$.addSeconds(e,XIe,t);let n=$.totalDays(t)-KIe;return t=$.addSeconds(t,YIe(n),t),t}var BM=new $(2451545,0,jn.TAI),ZIe=1e3,Qu=R.RADIANS_PER_DEGREE,Yl=R.RADIANS_PER_ARCSECOND,Ea=14959787e4,vee=new J;function jee(e,t,n,i,o,r,s){n<0&&(n=-n,o+=R.PI);let a=e*(1-t),c=i-o,l=o,f=QIe(r-i,t),d=$Ie(t,0);iPe(c,n,l,vee);let p=a*(1+t),g=Math.cos(f),m=Math.sin(f),y=1+t*g,b=p/y;return u(s)?(s.x=b*g,s.y=b*m,s.z=0):s=new h(b*g,b*m,0),J.multiplyByVector(vee,s,s)}function $Ie(e,t){return e<=t?"Circular":e<1-t?"Elliptical":e<=1+t?"Parabolic":"Hyperbolic"}function QIe(e,t){let n=tPe(e,t);return nPe(n,t)}var JIe=50,ePe=R.EPSILON8;function tPe(e,t){let n=Math.floor(e/R.TWO_PI);e-=n*R.TWO_PI;let i=e+t*Math.sin(e)/(1-Math.sin(e+t)+Math.sin(e)),o=Number.MAX_VALUE,r;for(r=0;r<JIe&&Math.abs(o-i)>ePe;++r){o=i;let s=o-t*Math.sin(o)-e,a=1-t*Math.cos(o);i=o-s/a}return o=i+n*R.TWO_PI,o}function nPe(e,t){let n=Math.floor(e/R.TWO_PI);e-=n*R.TWO_PI;let i=Math.cos(e)-t,o=Math.sin(e)*Math.sqrt(1-t*t),r=Math.atan2(o,i);return r=R.zeroToTwoPi(r),e<0&&(r-=R.TWO_PI),r+=n*R.TWO_PI,r}function iPe(e,t,n,i){let o=Math.cos(e),r=Math.sin(e),s=Math.cos(t),a=Math.sin(t),c=Math.cos(n),l=Math.sin(n);return u(i)?(i[0]=c*o-l*r*s,i[1]=l*o+c*r*s,i[2]=r*a,i[3]=-c*r-l*o*s,i[4]=-l*r+c*o*s,i[5]=o*a,i[6]=l*a,i[7]=-c*a,i[8]=s):i=new J(c*o-l*r*s,-c*r-l*o*s,l*a,l*o+c*r*s,-l*r+c*o*s,-c*a,r*a,o*a,s),i}var oPe=1.0000010178*Ea,rPe=100.46645683*Qu,sPe=129597742283429e-5*Yl,wee=16002,Dee=21863,Iee=32004,Pee=10931,Ree=14529,Oee=16368,Mee=15318,Lee=32794,aPe=64*1e-7*Ea,cPe=-152*1e-7*Ea,lPe=62*1e-7*Ea,uPe=-8*1e-7*Ea,fPe=32*1e-7*Ea,dPe=-41*1e-7*Ea,hPe=19*1e-7*Ea,mPe=-11*1e-7*Ea,pPe=-150*1e-7*Ea,_Pe=-46*1e-7*Ea,gPe=68*1e-7*Ea,yPe=54*1e-7*Ea,xPe=14*1e-7*Ea,bPe=24*1e-7*Ea,CPe=-28*1e-7*Ea,APe=22*1e-7*Ea,Nee=10,Fee=16002,Bee=21863,kee=10931,Vee=1473,Uee=32004,zee=4387,Hee=73,TPe=-325*1e-7,EPe=-322*1e-7,SPe=-79*1e-7,vPe=232*1e-7,wPe=-52*1e-7,DPe=97*1e-7,IPe=55*1e-7,PPe=-41*1e-7,RPe=-105*1e-7,OPe=-137*1e-7,MPe=258*1e-7,LPe=35*1e-7,NPe=-116*1e-7,FPe=-88*1e-7,BPe=-112*1e-7,kPe=-80*1e-7,EC=new $(0,0,jn.TAI);function VPe(e,t){Wee(e,EC);let i=(EC.dayNumber-BM.dayNumber+(EC.secondsOfDay-BM.secondsOfDay)/Yn.SECONDS_PER_DAY)/(Yn.DAYS_PER_JULIAN_CENTURY*10),o=.3595362*i,r=oPe+aPe*Math.cos(wee*o)+pPe*Math.sin(wee*o)+cPe*Math.cos(Dee*o)+_Pe*Math.sin(Dee*o)+lPe*Math.cos(Iee*o)+gPe*Math.sin(Iee*o)+uPe*Math.cos(Pee*o)+yPe*Math.sin(Pee*o)+fPe*Math.cos(Ree*o)+xPe*Math.sin(Ree*o)+dPe*Math.cos(Oee*o)+bPe*Math.sin(Oee*o)+hPe*Math.cos(Mee*o)+CPe*Math.sin(Mee*o)+mPe*Math.cos(Lee*o)+APe*Math.sin(Lee*o),s=rPe+sPe*i+TPe*Math.cos(Nee*o)+RPe*Math.sin(Nee*o)+EPe*Math.cos(Fee*o)+OPe*Math.sin(Fee*o)+SPe*Math.cos(Bee*o)+MPe*Math.sin(Bee*o)+vPe*Math.cos(kee*o)+LPe*Math.sin(kee*o)+wPe*Math.cos(Vee*o)+NPe*Math.sin(Vee*o)+DPe*Math.cos(Uee*o)+FPe*Math.sin(Uee*o)+IPe*Math.cos(zee*o)+BPe*Math.sin(zee*o)+PPe*Math.cos(Hee*o)+kPe*Math.sin(Hee*o),a=.0167086342-.0004203654*i,c=102.93734808*Qu+11612.3529*Yl*i,l=469.97289*Yl*i,f=174.87317577*Qu-8679.27034*Yl*i;return jee(r,a,l,c,f,s,t)}function qee(e,t){Wee(e,EC);let i=(EC.dayNumber-BM.dayNumber+(EC.secondsOfDay-BM.secondsOfDay)/Yn.SECONDS_PER_DAY)/Yn.DAYS_PER_JULIAN_CENTURY,o=i*i,r=o*i,s=r*i,a=383397.7725+.004*i,c=.055545526-16e-9*i,l=5.15668983*Qu,f=-8e-5*i+.02966*o-42e-6*r-13e-8*s,d=83.35324312*Qu,p=146434202669e-4*i-38.2702*o-.045047*r+21301e-8*s,g=125.04455501*Qu,m=-69679193631e-4*i+6.3602*o+.007625*r-3586e-8*s,y=218.31664563*Qu,b=17325593434847e-4*i-6.391*o+.006588*r-3169e-8*s,C=297.85019547*Qu+Yl*(1602961601209e-3*i-6.3706*o+.006593*r-3169e-8*s),A=93.27209062*Qu+Yl*(17395272628478e-4*i-12.7512*o-.001037*r+417e-8*s),T=134.96340251*Qu+Yl*(17179159232178e-4*i+31.8792*o+.051635*r-2447e-7*s),E=357.52910918*Qu+Yl*(1295965810481e-4*i-.5532*o+136e-6*r-1149e-8*s),v=310.17137918*Qu-Yl*(6967051436e-3*i+6.2068*o+.007618*r-3219e-8*s),D=2*C,O=4*C,P=6*C,M=2*T,L=3*T,_=4*T,S=2*A;a+=3400.4*Math.cos(D)-635.6*Math.cos(D-T)-235.6*Math.cos(T)+218.1*Math.cos(D-E)+181*Math.cos(D+T),c+=.014216*Math.cos(D-T)+.008551*Math.cos(D-M)-.001383*Math.cos(T)+.001356*Math.cos(D+T)-.001147*Math.cos(O-L)-914e-6*Math.cos(O-M)+869e-6*Math.cos(D-E-T)-627e-6*Math.cos(D)-394e-6*Math.cos(O-_)+282e-6*Math.cos(D-E-M)-279e-6*Math.cos(C-T)-236e-6*Math.cos(M)+231e-6*Math.cos(O)+229e-6*Math.cos(P-_)-201e-6*Math.cos(M-S),f+=486.26*Math.cos(D-S)-40.13*Math.cos(D)+37.51*Math.cos(S)+25.73*Math.cos(M-S)+19.97*Math.cos(D-E-S),p+=-55609*Math.sin(D-T)-34711*Math.sin(D-M)-9792*Math.sin(T)+9385*Math.sin(O-L)+7505*Math.sin(O-M)+5318*Math.sin(D+T)+3484*Math.sin(O-_)-3417*Math.sin(D-E-T)-2530*Math.sin(P-_)-2376*Math.sin(D)-2075*Math.sin(D-L)-1883*Math.sin(M)-1736*Math.sin(P-5*T)+1626*Math.sin(E)-1370*Math.sin(P-L),m+=-5392*Math.sin(D-S)-540*Math.sin(E)-441*Math.sin(D)+423*Math.sin(S)-288*Math.sin(M-S),b+=-3332.9*Math.sin(D)+1197.4*Math.sin(D-T)-662.5*Math.sin(E)+396.3*Math.sin(T)-218*Math.sin(D-E);let w=2*v,I=3*v;f+=46.997*Math.cos(v)*i-.614*Math.cos(D-S+v)*i+.614*Math.cos(D-S-v)*i-.0297*Math.cos(w)*o-.0335*Math.cos(v)*o+.0012*Math.cos(D-S+w)*o-16e-5*Math.cos(v)*r+4e-5*Math.cos(I)*r+4e-5*Math.cos(w)*r;let N=2.116*Math.sin(v)*i-.111*Math.sin(D-S-v)*i-.0015*Math.sin(v)*o;p+=N,b+=N,m+=-520.77*Math.sin(v)*i+13.66*Math.sin(D-S+v)*i+1.12*Math.sin(D-v)*i-1.06*Math.sin(S-v)*i+.66*Math.sin(w)*o+.371*Math.sin(v)*o-.035*Math.sin(D-S+w)*o-.015*Math.sin(D-S+v)*o+.0014*Math.sin(v)*r-.0011*Math.sin(I)*r-9e-4*Math.sin(w)*r,a*=ZIe;let k=l+f*Yl,z=d+p*Yl,V=y+b*Yl,U=g+m*Yl;return jee(a,c,k,z,U,V,t)}var Gee=.012300034,UPe=Gee/(Gee+1)*-1;function zPe(e,t){return t=qee(e,t),h.multiplyByScalar(t,UPe,t)}var Yee=new J(1.0000000000000002,5619723173785822e-31,4690511510146299e-34,-5154129427414611e-31,.9174820620691819,-.39777715593191376,-223970096136568e-30,.39777715593191376,.9174820620691819),QS=new h;$G.computeSunPositionInEarthInertialFrame=function(e,t){return u(e)||(e=$.now()),u(t)||(t=new h),QS=VPe(e,QS),t=h.negate(QS,t),zPe(e,QS),h.subtract(t,QS,t),J.multiplyByVector(Yee,t,t),t};$G.computeMoonPositionInEarthInertialFrame=function(e,t){return u(e)||(e=$.now()),t=qee(e,t),J.multiplyByVector(Yee,t,t),t};var Ly=$G;var kM={MORPHING:0,COLUMBUS_VIEW:1,SCENE2D:2,SCENE3D:3};kM.getMorphTime=function(e){return e===kM.SCENE3D?1:e===kM.MORPHING?void 0:0};var ne=Object.freeze(kM);function HPe(e){e=x(e,x.EMPTY_OBJECT),this.color=G.clone(x(e.color,G.WHITE)),this.intensity=x(e.intensity,2)}var H_=HPe;function SC(){this.globeDepthTexture=void 0,this.gamma=void 0,this._viewport=new qe,this._viewportCartesian4=new oe,this._viewportDirty=!1,this._viewportOrthographicMatrix=F.clone(F.IDENTITY),this._viewportTransformation=F.clone(F.IDENTITY),this._model=F.clone(F.IDENTITY),this._view=F.clone(F.IDENTITY),this._inverseView=F.clone(F.IDENTITY),this._projection=F.clone(F.IDENTITY),this._infiniteProjection=F.clone(F.IDENTITY),this._entireFrustum=new H,this._currentFrustum=new H,this._frustumPlanes=new oe,this._farDepthFromNearPlusOne=void 0,this._log2FarDepthFromNearPlusOne=void 0,this._oneOverLog2FarDepthFromNearPlusOne=void 0,this._frameState=void 0,this._temeToPseudoFixed=J.clone(F.IDENTITY),this._view3DDirty=!0,this._view3D=new F,this._inverseView3DDirty=!0,this._inverseView3D=new F,this._inverseModelDirty=!0,this._inverseModel=new F,this._inverseTransposeModelDirty=!0,this._inverseTransposeModel=new J,this._viewRotation=new J,this._inverseViewRotation=new J,this._viewRotation3D=new J,this._inverseViewRotation3D=new J,this._inverseProjectionDirty=!0,this._inverseProjection=new F,this._modelViewDirty=!0,this._modelView=new F,this._modelView3DDirty=!0,this._modelView3D=new F,this._modelViewRelativeToEyeDirty=!0,this._modelViewRelativeToEye=new F,this._inverseModelViewDirty=!0,this._inverseModelView=new F,this._inverseModelView3DDirty=!0,this._inverseModelView3D=new F,this._viewProjectionDirty=!0,this._viewProjection=new F,this._inverseViewProjectionDirty=!0,this._inverseViewProjection=new F,this._modelViewProjectionDirty=!0,this._modelViewProjection=new F,this._inverseModelViewProjectionDirty=!0,this._inverseModelViewProjection=new F,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewProjectionRelativeToEye=new F,this._modelViewInfiniteProjectionDirty=!0,this._modelViewInfiniteProjection=new F,this._normalDirty=!0,this._normal=new J,this._normal3DDirty=!0,this._normal3D=new J,this._inverseNormalDirty=!0,this._inverseNormal=new J,this._inverseNormal3DDirty=!0,this._inverseNormal3D=new J,this._encodedCameraPositionMCDirty=!0,this._encodedCameraPositionMC=new Gn,this._cameraPosition=new h,this._sunPositionWC=new h,this._sunPositionColumbusView=new h,this._sunDirectionWC=new h,this._sunDirectionEC=new h,this._moonDirectionEC=new h,this._lightDirectionWC=new h,this._lightDirectionEC=new h,this._lightColor=new h,this._lightColorHdr=new h,this._pass=void 0,this._mode=void 0,this._mapProjection=void 0,this._ellipsoid=void 0,this._cameraDirection=new h,this._cameraRight=new h,this._cameraUp=new h,this._frustum2DWidth=0,this._eyeHeight=0,this._eyeHeight2D=new H,this._eyeEllipsoidNormalEC=new h,this._eyeEllipsoidCurvature=new H,this._modelToEnu=new F,this._enuToModel=new F,this._pixelRatio=1,this._orthographicIn3D=!1,this._backgroundColor=new G,this._brdfLut=void 0,this._environmentMap=void 0,this._sphericalHarmonicCoefficients=void 0,this._specularEnvironmentMaps=void 0,this._specularEnvironmentMapsMaximumLOD=void 0,this._fogDensity=void 0,this._fogVisualDensityScalar=void 0,this._fogMinimumBrightness=void 0,this._atmosphereHsbShift=void 0,this._atmosphereLightIntensity=void 0,this._atmosphereRayleighCoefficient=new h,this._atmosphereRayleighScaleHeight=new h,this._atmosphereMieCoefficient=new h,this._atmosphereMieScaleHeight=void 0,this._atmosphereMieAnisotropy=void 0,this._atmosphereDynamicLighting=void 0,this._invertClassificationColor=void 0,this._splitPosition=0,this._pixelSizePerMeter=void 0,this._geometricToleranceOverMeter=void 0,this._minimumDisableDepthTestDistance=void 0}Object.defineProperties(SC.prototype,{frameState:{get:function(){return this._frameState}},viewport:{get:function(){return this._viewport},set:function(e){if(!qe.equals(e,this._viewport)){qe.clone(e,this._viewport);let t=this._viewport,n=this._viewportCartesian4;n.x=t.x,n.y=t.y,n.z=t.width,n.w=t.height,this._viewportDirty=!0}}},viewportCartesian4:{get:function(){return this._viewportCartesian4}},viewportOrthographic:{get:function(){return Kee(this),this._viewportOrthographicMatrix}},viewportTransformation:{get:function(){return Kee(this),this._viewportTransformation}},model:{get:function(){return this._model},set:function(e){F.clone(e,this._model),this._modelView3DDirty=!0,this._inverseModelView3DDirty=!0,this._inverseModelDirty=!0,this._inverseTransposeModelDirty=!0,this._modelViewDirty=!0,this._inverseModelViewDirty=!0,this._modelViewRelativeToEyeDirty=!0,this._inverseModelViewDirty=!0,this._modelViewProjectionDirty=!0,this._inverseModelViewProjectionDirty=!0,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewInfiniteProjectionDirty=!0,this._normalDirty=!0,this._inverseNormalDirty=!0,this._normal3DDirty=!0,this._inverseNormal3DDirty=!0,this._encodedCameraPositionMCDirty=!0}},inverseModel:{get:function(){return this._inverseModelDirty&&(this._inverseModelDirty=!1,F.inverse(this._model,this._inverseModel)),this._inverseModel}},inverseTransposeModel:{get:function(){let e=this._inverseTransposeModel;return this._inverseTransposeModelDirty&&(this._inverseTransposeModelDirty=!1,F.getMatrix3(this.inverseModel,e),J.transpose(e,e)),e}},view:{get:function(){return this._view}},view3D:{get:function(){return JG(this),this._view3D}},viewRotation:{get:function(){return JG(this),this._viewRotation}},viewRotation3D:{get:function(){return JG(this),this._viewRotation3D}},inverseView:{get:function(){return this._inverseView}},inverseView3D:{get:function(){return Qee(this),this._inverseView3D}},inverseViewRotation:{get:function(){return this._inverseViewRotation}},inverseViewRotation3D:{get:function(){return Qee(this),this._inverseViewRotation3D}},projection:{get:function(){return this._projection}},inverseProjection:{get:function(){return JPe(this),this._inverseProjection}},infiniteProjection:{get:function(){return this._infiniteProjection}},modelView:{get:function(){return eRe(this),this._modelView}},modelView3D:{get:function(){return tRe(this),this._modelView3D}},modelViewRelativeToEye:{get:function(){return aRe(this),this._modelViewRelativeToEye}},inverseModelView:{get:function(){return nRe(this),this._inverseModelView}},inverseModelView3D:{get:function(){return iRe(this),this._inverseModelView3D}},viewProjection:{get:function(){return oRe(this),this._viewProjection}},inverseViewProjection:{get:function(){return rRe(this),this._inverseViewProjection}},modelViewProjection:{get:function(){return sRe(this),this._modelViewProjection}},inverseModelViewProjection:{get:function(){return cRe(this),this._inverseModelViewProjection}},modelViewProjectionRelativeToEye:{get:function(){return lRe(this),this._modelViewProjectionRelativeToEye}},modelViewInfiniteProjection:{get:function(){return uRe(this),this._modelViewInfiniteProjection}},normal:{get:function(){return fRe(this),this._normal}},normal3D:{get:function(){return dRe(this),this._normal3D}},inverseNormal:{get:function(){return hRe(this),this._inverseNormal}},inverseNormal3D:{get:function(){return mRe(this),this._inverseNormal3D}},entireFrustum:{get:function(){return this._entireFrustum}},currentFrustum:{get:function(){return this._currentFrustum}},frustumPlanes:{get:function(){return this._frustumPlanes}},farDepthFromNearPlusOne:{get:function(){return this._farDepthFromNearPlusOne}},log2FarDepthFromNearPlusOne:{get:function(){return this._log2FarDepthFromNearPlusOne}},oneOverLog2FarDepthFromNearPlusOne:{get:function(){return this._oneOverLog2FarDepthFromNearPlusOne}},eyeHeight:{get:function(){return this._eyeHeight}},eyeHeight2D:{get:function(){return this._eyeHeight2D}},eyeEllipsoidNormalEC:{get:function(){return this._eyeEllipsoidNormalEC}},eyeEllipsoidCurvature:{get:function(){return this._eyeEllipsoidCurvature}},modelToEnu:{get:function(){return this._modelToEnu}},enuToModel:{get:function(){return this._enuToModel}},sunPositionWC:{get:function(){return this._sunPositionWC}},sunPositionColumbusView:{get:function(){return this._sunPositionColumbusView}},sunDirectionWC:{get:function(){return this._sunDirectionWC}},sunDirectionEC:{get:function(){return this._sunDirectionEC}},moonDirectionEC:{get:function(){return this._moonDirectionEC}},lightDirectionWC:{get:function(){return this._lightDirectionWC}},lightDirectionEC:{get:function(){return this._lightDirectionEC}},lightColor:{get:function(){return this._lightColor}},lightColorHdr:{get:function(){return this._lightColorHdr}},encodedCameraPositionMCHigh:{get:function(){return $ee(this),this._encodedCameraPositionMC.high}},encodedCameraPositionMCLow:{get:function(){return $ee(this),this._encodedCameraPositionMC.low}},temeToPseudoFixedMatrix:{get:function(){return this._temeToPseudoFixed}},pixelRatio:{get:function(){return this._pixelRatio}},fogDensity:{get:function(){return this._fogDensity}},fogVisualDensityScalar:{get:function(){return this._fogVisualDensityScalar}},fogMinimumBrightness:{get:function(){return this._fogMinimumBrightness}},atmosphereHsbShift:{get:function(){return this._atmosphereHsbShift}},atmosphereLightIntensity:{get:function(){return this._atmosphereLightIntensity}},atmosphereRayleighCoefficient:{get:function(){return this._atmosphereRayleighCoefficient}},atmosphereRayleighScaleHeight:{get:function(){return this._atmosphereRayleighScaleHeight}},atmosphereMieCoefficient:{get:function(){return this._atmosphereMieCoefficient}},atmosphereMieScaleHeight:{get:function(){return this._atmosphereMieScaleHeight}},atmosphereMieAnisotropy:{get:function(){return this._atmosphereMieAnisotropy}},atmosphereDynamicLighting:{get:function(){return this._atmosphereDynamicLighting}},geometricToleranceOverMeter:{get:function(){return this._geometricToleranceOverMeter}},pass:{get:function(){return this._pass}},backgroundColor:{get:function(){return this._backgroundColor}},brdfLut:{get:function(){return this._brdfLut}},environmentMap:{get:function(){return this._environmentMap}},sphericalHarmonicCoefficients:{get:function(){return this._sphericalHarmonicCoefficients}},specularEnvironmentMaps:{get:function(){return this._specularEnvironmentMaps}},specularEnvironmentMapsMaximumLOD:{get:function(){return this._specularEnvironmentMapsMaximumLOD}},splitPosition:{get:function(){return this._splitPosition}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance}},invertClassificationColor:{get:function(){return this._invertClassificationColor}},orthographicIn3D:{get:function(){return this._orthographicIn3D}},ellipsoid:{get:function(){return x(this._ellipsoid,ee.default)}}});function GPe(e,t){F.clone(t,e._view),F.getMatrix3(t,e._viewRotation),e._view3DDirty=!0,e._inverseView3DDirty=!0,e._modelViewDirty=!0,e._modelView3DDirty=!0,e._modelViewRelativeToEyeDirty=!0,e._inverseModelViewDirty=!0,e._inverseModelView3DDirty=!0,e._viewProjectionDirty=!0,e._inverseViewProjectionDirty=!0,e._modelViewProjectionDirty=!0,e._modelViewProjectionRelativeToEyeDirty=!0,e._modelViewInfiniteProjectionDirty=!0,e._normalDirty=!0,e._inverseNormalDirty=!0,e._normal3DDirty=!0,e._inverseNormal3DDirty=!0}function WPe(e,t){F.clone(t,e._inverseView),F.getMatrix3(t,e._inverseViewRotation)}function jPe(e,t){F.clone(t,e._projection),e._inverseProjectionDirty=!0,e._viewProjectionDirty=!0,e._inverseViewProjectionDirty=!0,e._modelViewProjectionDirty=!0,e._modelViewProjectionRelativeToEyeDirty=!0}function qPe(e,t){F.clone(t,e._infiniteProjection),e._modelViewInfiniteProjectionDirty=!0}var Xee=new h,YPe=new F;function XPe(e,t){h.clone(t.positionWC,e._cameraPosition),h.clone(t.directionWC,e._cameraDirection),h.clone(t.rightWC,e._cameraRight),h.clone(t.upWC,e._cameraUp);let n=e._ellipsoid,i,o=t.positionCartographic;if(u(o)?(e._eyeHeight=o.height,e._eyeEllipsoidNormalEC=n.geodeticSurfaceNormalCartographic(o,e._eyeEllipsoidNormalEC),i=h.fromRadians(o.longitude,o.latitude,0,n,Xee)):(e._eyeHeight=-n.maximumRadius,h.magnitude(t.positionWC)>0&&(e._eyeEllipsoidNormalEC=h.normalize(t.positionWC,e._eyeEllipsoidNormalEC)),i=n.scaleToGeodeticSurface(t.positionWC,Xee)),e._encodedCameraPositionMCDirty=!0,!u(i))return;e._eyeEllipsoidNormalEC=J.multiplyByVector(e._viewRotation,e._eyeEllipsoidNormalEC,e._eyeEllipsoidNormalEC);let r=Lt.eastNorthUpToFixedFrame(i,n,YPe);e._enuToModel=F.multiplyTransformation(e.inverseModel,r,e._enuToModel),e._modelToEnu=F.inverseTransformation(e._enuToModel,e._modelToEnu),R.equalsEpsilon(n._radii.x,n._radii.y,R.EPSILON15)&&(e._eyeEllipsoidCurvature=n.getLocalCurvature(i,e._eyeEllipsoidCurvature))}var QG=new J,KPe=new de;function ZPe(e,t){Lt.computeIcrfToCentralBodyFixedMatrix(t.time,QG);let n=Ly.computeSunPositionInEarthInertialFrame(t.time,e._sunPositionWC);J.multiplyByVector(QG,n,n),h.normalize(n,e._sunDirectionWC),n=J.multiplyByVector(e.viewRotation3D,n,e._sunDirectionEC),h.normalize(n,n),n=Ly.computeMoonPositionInEarthInertialFrame(t.time,e._moonDirectionEC),J.multiplyByVector(QG,n,n),J.multiplyByVector(e.viewRotation3D,n,n),h.normalize(n,n);let i=t.mapProjection,r=i.ellipsoid.cartesianToCartographic(e._sunPositionWC,KPe);i.project(r,e._sunPositionColumbusView)}SC.prototype.updateCamera=function(e){GPe(this,e.viewMatrix),WPe(this,e.inverseViewMatrix),XPe(this,e),this._entireFrustum.x=e.frustum.near,this._entireFrustum.y=e.frustum.far,this.updateFrustum(e.frustum),this._orthographicIn3D=this._mode!==ne.SCENE2D&&e.frustum instanceof sn};SC.prototype.updateFrustum=function(e){jPe(this,e.projectionMatrix),u(e.infiniteProjectionMatrix)&&qPe(this,e.infiniteProjectionMatrix),this._currentFrustum.x=e.near,this._currentFrustum.y=e.far,this._farDepthFromNearPlusOne=e.far-e.near+1,this._log2FarDepthFromNearPlusOne=R.log2(this._farDepthFromNearPlusOne),this._oneOverLog2FarDepthFromNearPlusOne=1/this._log2FarDepthFromNearPlusOne;let t=e.offCenterFrustum;u(t)&&(e=t),this._frustumPlanes.x=e.top,this._frustumPlanes.y=e.bottom,this._frustumPlanes.z=e.left,this._frustumPlanes.w=e.right};SC.prototype.updatePass=function(e){this._pass=e};var $Pe=[],QPe=new H_;SC.prototype.update=function(e){this._mode=e.mode,this._mapProjection=e.mapProjection,this._ellipsoid=e.mapProjection.ellipsoid,this._pixelRatio=e.pixelRatio;let t=e.camera;this.updateCamera(t),e.mode===ne.SCENE2D?(this._frustum2DWidth=t.frustum.right-t.frustum.left,this._eyeHeight2D.x=this._frustum2DWidth*.5,this._eyeHeight2D.y=this._eyeHeight2D.x*this._eyeHeight2D.x):(this._frustum2DWidth=0,this._eyeHeight2D.x=0,this._eyeHeight2D.y=0),ZPe(this,e);let n=x(e.light,QPe);n instanceof H_?(this._lightDirectionWC=h.clone(this._sunDirectionWC,this._lightDirectionWC),this._lightDirectionEC=h.clone(this._sunDirectionEC,this._lightDirectionEC)):(this._lightDirectionWC=h.normalize(h.negate(n.direction,this._lightDirectionWC),this._lightDirectionWC),this._lightDirectionEC=J.multiplyByVector(this.viewRotation3D,this._lightDirectionWC,this._lightDirectionEC));let i=n.color,o=h.fromElements(i.red,i.green,i.blue,this._lightColorHdr);o=h.multiplyByScalar(o,n.intensity,o);let r=h.maximumComponent(o);r>1?h.divideByScalar(o,r,this._lightColor):h.clone(o,this._lightColor);let s=e.brdfLutGenerator,a=u(s)?s.colorTexture:void 0;this._brdfLut=a,this._environmentMap=x(e.environmentMap,e.context.defaultCubeMap),this._sphericalHarmonicCoefficients=x(e.sphericalHarmonicCoefficients,$Pe),this._specularEnvironmentMaps=e.specularEnvironmentMaps,this._specularEnvironmentMapsMaximumLOD=e.specularEnvironmentMapsMaximumLOD,this._fogDensity=e.fog.density,this._fogVisualDensityScalar=e.fog.visualDensityScalar,this._fogMinimumBrightness=e.fog.minimumBrightness;let c=e.atmosphere;u(c)&&(this._atmosphereHsbShift=h.fromElements(c.hueShift,c.saturationShift,c.brightnessShift,this._atmosphereHsbShift),this._atmosphereLightIntensity=c.lightIntensity,this._atmosphereRayleighCoefficient=h.clone(c.rayleighCoefficient,this._atmosphereRayleighCoefficient),this._atmosphereRayleighScaleHeight=c.rayleighScaleHeight,this._atmosphereMieCoefficient=h.clone(c.mieCoefficient,this._atmosphereMieCoefficient),this._atmosphereMieScaleHeight=c.mieScaleHeight,this._atmosphereMieAnisotropy=c.mieAnisotropy,this._atmosphereDynamicLighting=c.dynamicLighting),this._invertClassificationColor=e.invertClassificationColor,this._frameState=e,this._temeToPseudoFixed=Lt.computeTemeToPseudoFixedMatrix(e.time,this._temeToPseudoFixed),this._splitPosition=e.splitPosition*e.context.drawingBufferWidth;let l=t.frustum.fov,f=this._viewport,d;u(l)?f.height>f.width?d=Math.tan(.5*l)*2/f.height:d=Math.tan(.5*l)*2/f.width:d=1/Math.max(f.width,f.height),this._geometricToleranceOverMeter=d*e.maximumScreenSpaceError,G.clone(e.backgroundColor,this._backgroundColor),this._minimumDisableDepthTestDistance=e.minimumDisableDepthTestDistance,this._minimumDisableDepthTestDistance*=this._minimumDisableDepthTestDistance,this._minimumDisableDepthTestDistance===Number.POSITIVE_INFINITY&&(this._minimumDisableDepthTestDistance=-1)};function Kee(e){if(e._viewportDirty){let t=e._viewport;F.computeOrthographicOffCenter(t.x,t.x+t.width,t.y,t.y+t.height,0,1,e._viewportOrthographicMatrix),F.computeViewportTransformation(t,0,1,e._viewportTransformation),e._viewportDirty=!1}}function JPe(e){e._inverseProjectionDirty&&(e._inverseProjectionDirty=!1,e._mode!==ne.SCENE2D&&e._mode!==ne.MORPHING&&!e._orthographicIn3D?F.inverse(e._projection,e._inverseProjection):F.clone(F.ZERO,e._inverseProjection))}function eRe(e){e._modelViewDirty&&(e._modelViewDirty=!1,F.multiplyTransformation(e._view,e._model,e._modelView))}function tRe(e){e._modelView3DDirty&&(e._modelView3DDirty=!1,F.multiplyTransformation(e.view3D,e._model,e._modelView3D))}function nRe(e){e._inverseModelViewDirty&&(e._inverseModelViewDirty=!1,F.inverse(e.modelView,e._inverseModelView))}function iRe(e){e._inverseModelView3DDirty&&(e._inverseModelView3DDirty=!1,F.inverse(e.modelView3D,e._inverseModelView3D))}function oRe(e){e._viewProjectionDirty&&(e._viewProjectionDirty=!1,F.multiply(e._projection,e._view,e._viewProjection))}function rRe(e){e._inverseViewProjectionDirty&&(e._inverseViewProjectionDirty=!1,F.inverse(e.viewProjection,e._inverseViewProjection))}function sRe(e){e._modelViewProjectionDirty&&(e._modelViewProjectionDirty=!1,F.multiply(e._projection,e.modelView,e._modelViewProjection))}function aRe(e){if(e._modelViewRelativeToEyeDirty){e._modelViewRelativeToEyeDirty=!1;let t=e.modelView,n=e._modelViewRelativeToEye;n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=0,n[13]=0,n[14]=0,n[15]=t[15]}}function cRe(e){e._inverseModelViewProjectionDirty&&(e._inverseModelViewProjectionDirty=!1,F.inverse(e.modelViewProjection,e._inverseModelViewProjection))}function lRe(e){e._modelViewProjectionRelativeToEyeDirty&&(e._modelViewProjectionRelativeToEyeDirty=!1,F.multiply(e._projection,e.modelViewRelativeToEye,e._modelViewProjectionRelativeToEye))}function uRe(e){e._modelViewInfiniteProjectionDirty&&(e._modelViewInfiniteProjectionDirty=!1,F.multiply(e._infiniteProjection,e.modelView,e._modelViewInfiniteProjection))}function fRe(e){if(e._normalDirty){e._normalDirty=!1;let t=e._normal;F.getMatrix3(e.inverseModelView,t),J.transpose(t,t)}}function dRe(e){if(e._normal3DDirty){e._normal3DDirty=!1;let t=e._normal3D;F.getMatrix3(e.inverseModelView3D,t),J.transpose(t,t)}}function hRe(e){if(e._inverseNormalDirty){e._inverseNormalDirty=!1;let t=e._inverseNormal;F.getMatrix3(e.modelView,t),J.transpose(t,t)}}function mRe(e){if(e._inverseNormal3DDirty){e._inverseNormal3DDirty=!1;let t=e._inverseNormal3D;F.getMatrix3(e.modelView3D,t),J.transpose(t,t)}}var Zee=new h;function $ee(e){e._encodedCameraPositionMCDirty&&(e._encodedCameraPositionMCDirty=!1,F.multiplyByPoint(e.inverseModel,e._cameraPosition,Zee),Gn.fromCartesian(Zee,e._encodedCameraPositionMC))}var pRe=new h,_Re=new h,gRe=new h,yRe=new h,xRe=new de,bRe=new h,CRe=new F;function ARe(e,t,n,i,o,r,s,a){let c=pRe;c.x=e.y,c.y=e.z,c.z=e.x;let l=_Re;l.x=n.y,l.y=n.z,l.z=n.x;let f=gRe;f.x=i.y,f.y=i.z,f.z=i.x;let d=yRe;d.x=t.y,d.y=t.z,d.z=t.x,r===ne.SCENE2D&&(c.z=o*.5);let p=s.unproject(c,xRe);p.longitude=R.clamp(p.longitude,-Math.PI,Math.PI),p.latitude=R.clamp(p.latitude,-R.PI_OVER_TWO,R.PI_OVER_TWO);let g=s.ellipsoid,m=g.cartographicToCartesian(p,bRe),y=Lt.eastNorthUpToFixedFrame(m,g,CRe);return F.multiplyByPointAsVector(y,l,l),F.multiplyByPointAsVector(y,f,f),F.multiplyByPointAsVector(y,d,d),u(a)||(a=new F),a[0]=l.x,a[1]=f.x,a[2]=-d.x,a[3]=0,a[4]=l.y,a[5]=f.y,a[6]=-d.y,a[7]=0,a[8]=l.z,a[9]=f.z,a[10]=-d.z,a[11]=0,a[12]=-h.dot(l,m),a[13]=-h.dot(f,m),a[14]=h.dot(d,m),a[15]=1,a}function JG(e){e._view3DDirty&&(e._mode===ne.SCENE3D?F.clone(e._view,e._view3D):ARe(e._cameraPosition,e._cameraDirection,e._cameraRight,e._cameraUp,e._frustum2DWidth,e._mode,e._mapProjection,e._view3D),F.getMatrix3(e._view3D,e._viewRotation3D),e._view3DDirty=!1)}function Qee(e){e._inverseView3DDirty&&(F.inverseTransformation(e.view3D,e._inverseView3D),F.getMatrix3(e._inverseView3D,e._inverseViewRotation3D),e._inverseView3DDirty=!1)}var VM=SC;function Xl(e,t){let{getWebGLStub:n,requestWebgl1:i,webgl:o={},allowTextureFilterAnisotropic:r=!0}=x(t,{});o.alpha=x(o.alpha,!1),o.stencil=x(o.stencil,!0),o.powerPreference=x(o.powerPreference,"high-performance");let s=u(n)?n(e,o):TRe(e,o,i),c=typeof WebGL2RenderingContext<"u"&&s instanceof WebGL2RenderingContext;this._canvas=e,this._originalGLContext=s,this._gl=s,this._webgl2=c,this._id=Hn(),this.validateFramebuffer=!1,this.validateShaderProgram=!1,this.logShaderCompilation=!1,this._throwOnWebGLError=!1,this._shaderCache=new LM(this),this._textureCache=new FM;let l=s;this._stencilBits=l.getParameter(l.STENCIL_BITS),Vt._maximumCombinedTextureImageUnits=l.getParameter(l.MAX_COMBINED_TEXTURE_IMAGE_UNITS),Vt._maximumCubeMapSize=l.getParameter(l.MAX_CUBE_MAP_TEXTURE_SIZE),Vt._maximumFragmentUniformVectors=l.getParameter(l.MAX_FRAGMENT_UNIFORM_VECTORS),Vt._maximumTextureImageUnits=l.getParameter(l.MAX_TEXTURE_IMAGE_UNITS),Vt._maximumRenderbufferSize=l.getParameter(l.MAX_RENDERBUFFER_SIZE),Vt._maximumTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE),Vt._maximumVaryingVectors=l.getParameter(l.MAX_VARYING_VECTORS),Vt._maximumVertexAttributes=l.getParameter(l.MAX_VERTEX_ATTRIBS),Vt._maximumVertexTextureImageUnits=l.getParameter(l.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Vt._maximumVertexUniformVectors=l.getParameter(l.MAX_VERTEX_UNIFORM_VECTORS),Vt._maximumSamples=this._webgl2?l.getParameter(l.MAX_SAMPLES):0;let f=l.getParameter(l.ALIASED_LINE_WIDTH_RANGE);Vt._minimumAliasedLineWidth=f[0],Vt._maximumAliasedLineWidth=f[1];let d=l.getParameter(l.ALIASED_POINT_SIZE_RANGE);Vt._minimumAliasedPointSize=d[0],Vt._maximumAliasedPointSize=d[1];let p=l.getParameter(l.MAX_VIEWPORT_DIMS);Vt._maximumViewportWidth=p[0],Vt._maximumViewportHeight=p[1];let g=l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.HIGH_FLOAT);Vt._highpFloatSupported=g.precision!==0;let m=l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.HIGH_INT);Vt._highpIntSupported=m.rangeMax!==0,this._antialias=l.getContextAttributes().antialias,this._standardDerivatives=!!gr(l,["OES_standard_derivatives"]),this._blendMinmax=!!gr(l,["EXT_blend_minmax"]),this._elementIndexUint=!!gr(l,["OES_element_index_uint"]),this._depthTexture=!!gr(l,["WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]),this._fragDepth=!!gr(l,["EXT_frag_depth"]),this._debugShaders=gr(l,["WEBGL_debug_shaders"]),this._textureFloat=!!gr(l,["OES_texture_float"]),this._textureHalfFloat=!!gr(l,["OES_texture_half_float"]),this._textureFloatLinear=!!gr(l,["OES_texture_float_linear"]),this._textureHalfFloatLinear=!!gr(l,["OES_texture_half_float_linear"]),this._supportsTextureLod=!!gr(l,["EXT_shader_texture_lod"]),this._colorBufferFloat=!!gr(l,["EXT_color_buffer_float","WEBGL_color_buffer_float"]),this._floatBlend=!!gr(l,["EXT_float_blend"]),this._colorBufferHalfFloat=!!gr(l,["EXT_color_buffer_half_float"]),this._s3tc=!!gr(l,["WEBGL_compressed_texture_s3tc","MOZ_WEBGL_compressed_texture_s3tc","WEBKIT_WEBGL_compressed_texture_s3tc"]),this._pvrtc=!!gr(l,["WEBGL_compressed_texture_pvrtc","WEBKIT_WEBGL_compressed_texture_pvrtc"]),this._astc=!!gr(l,["WEBGL_compressed_texture_astc"]),this._etc=!!gr(l,["WEBG_compressed_texture_etc"]),this._etc1=!!gr(l,["WEBGL_compressed_texture_etc1"]),this._bc7=!!gr(l,["EXT_texture_compression_bptc"]),jl.setKTX2SupportedFormats(this._s3tc,this._pvrtc,this._astc,this._etc,this._etc1,this._bc7);let y=r?gr(l,["EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic"]):void 0;this._textureFilterAnisotropic=y,Vt._maximumTextureFilterAnisotropy=u(y)?l.getParameter(y.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1;let b,C,A,T,E,v,D,O,P,M;if(c){let w=this;b=function(){return w._gl.createVertexArray()},C=function(I){w._gl.bindVertexArray(I)},A=function(I){w._gl.deleteVertexArray(I)},T=function(I,N,k,z,V){l.drawElementsInstanced(I,N,k,z,V)},E=function(I,N,k,z){l.drawArraysInstanced(I,N,k,z)},v=function(I,N){l.vertexAttribDivisor(I,N)},D=function(I){l.drawBuffers(I)}}else O=gr(l,["OES_vertex_array_object"]),u(O)&&(b=function(){return O.createVertexArrayOES()},C=function(w){O.bindVertexArrayOES(w)},A=function(w){O.deleteVertexArrayOES(w)}),P=gr(l,["ANGLE_instanced_arrays"]),u(P)&&(T=function(w,I,N,k,z){P.drawElementsInstancedANGLE(w,I,N,k,z)},E=function(w,I,N,k){P.drawArraysInstancedANGLE(w,I,N,k)},v=function(w,I){P.vertexAttribDivisorANGLE(w,I)}),M=gr(l,["WEBGL_draw_buffers"]),u(M)&&(D=function(w){M.drawBuffersWEBGL(w)});this.glCreateVertexArray=b,this.glBindVertexArray=C,this.glDeleteVertexArray=A,this.glDrawElementsInstanced=T,this.glDrawArraysInstanced=E,this.glVertexAttribDivisor=v,this.glDrawBuffers=D,this._vertexArrayObject=!!O,this._instancedArrays=!!P,this._drawBuffers=!!M,Vt._maximumDrawBuffers=this.drawBuffers?l.getParameter(te.MAX_DRAW_BUFFERS):1,Vt._maximumColorAttachments=this.drawBuffers?l.getParameter(te.MAX_COLOR_ATTACHMENTS):1,this._clearColor=new G(0,0,0,0),this._clearDepth=1,this._clearStencil=0;let L=new VM,_=new Tc(this),S=Ue.fromCache();this._defaultPassState=_,this._defaultRenderState=S,this._defaultTexture=void 0,this._defaultEmissiveTexture=void 0,this._defaultNormalTexture=void 0,this._defaultCubeMap=void 0,this._us=L,this._currentRenderState=S,this._currentPassState=_,this._currentFramebuffer=void 0,this._maxFrameTextureUnitIndex=0,this._vertexAttribDivisors=[],this._previousDrawInstanced=!1;for(let w=0;w<Vt._maximumVertexAttributes;w++)this._vertexAttribDivisors.push(0);this._pickObjects={},this._nextPickColor=new Uint32Array(1),this.options={getWebGLStub:n,requestWebgl1:i,webgl:o,allowTextureFilterAnisotropic:r},this.cache={},Ue.apply(l,S,_)}function TRe(e,t,n){if(typeof WebGLRenderingContext>"u")throw new ce("The browser does not support WebGL.  Visit http://get.webgl.org.");!n&&!(typeof WebGL2RenderingContext<"u")&&(n=!0);let o=n?"webgl":"webgl2",r=e.getContext(o,t);if(!u(r))throw new ce("The browser supports WebGL, but initialization failed.");return r}function ERe(e,t){let n="WebGL Error:  ";switch(t){case e.INVALID_ENUM:n+="INVALID_ENUM";break;case e.INVALID_VALUE:n+="INVALID_VALUE";break;case e.INVALID_OPERATION:n+="INVALID_OPERATION";break;case e.OUT_OF_MEMORY:n+="OUT_OF_MEMORY";break;case e.CONTEXT_LOST_WEBGL:n+="CONTEXT_LOST_WEBGL lost";break;default:n+=`Unknown (${t})`}return n}function SRe(e,t,n,i){let o=`${ERe(e,i)}: ${t.name}(`;for(let r=0;r<n.length;++r)r!==0&&(o+=", "),o+=n[r];return o+=");",o}function vRe(e,t,n){let i=e.getError();if(i!==e.NO_ERROR)throw new ce(SRe(e,t,n,i))}function wRe(e,t,n){return{get:function(){let i=e[t];return n(e,`get: ${t}`,i),e[t]},set:function(i){e[t]=i,n(e,`set: ${t}`,i)}}}function DRe(e,t){if(!u(t))return e;function n(o){return function(){let r=o.apply(e,arguments);return t(e,o,arguments),r}}let i={};for(let o in e){let r=e[o];r instanceof Function?i[o]=n(r):Object.defineProperty(i,o,wRe(e,o,t))}return i}function gr(e,t){let n=t.length;for(let i=0;i<n;++i){let o=e.getExtension(t[i]);if(o)return o}}var IRe={};Object.defineProperties(Xl.prototype,{id:{get:function(){return this._id}},webgl2:{get:function(){return this._webgl2}},canvas:{get:function(){return this._canvas}},shaderCache:{get:function(){return this._shaderCache}},textureCache:{get:function(){return this._textureCache}},uniformState:{get:function(){return this._us}},stencilBits:{get:function(){return this._stencilBits}},stencilBuffer:{get:function(){return this._stencilBits>=8}},antialias:{get:function(){return this._antialias}},msaa:{get:function(){return this._webgl2}},standardDerivatives:{get:function(){return this._standardDerivatives||this._webgl2}},floatBlend:{get:function(){return this._floatBlend}},blendMinmax:{get:function(){return this._blendMinmax||this._webgl2}},elementIndexUint:{get:function(){return this._elementIndexUint||this._webgl2}},depthTexture:{get:function(){return this._depthTexture||this._webgl2}},floatingPointTexture:{get:function(){return this._webgl2||this._textureFloat}},halfFloatingPointTexture:{get:function(){return this._webgl2||this._textureHalfFloat}},textureFloatLinear:{get:function(){return this._textureFloatLinear}},textureHalfFloatLinear:{get:function(){return this._webgl2&&this._textureFloatLinear||!this._webgl2&&this._textureHalfFloatLinear}},supportsTextureLod:{get:function(){return this._webgl2||this._supportsTextureLod}},textureFilterAnisotropic:{get:function(){return!!this._textureFilterAnisotropic}},s3tc:{get:function(){return this._s3tc}},pvrtc:{get:function(){return this._pvrtc}},astc:{get:function(){return this._astc}},etc:{get:function(){return this._etc}},etc1:{get:function(){return this._etc1}},bc7:{get:function(){return this._bc7}},supportsBasis:{get:function(){return this._s3tc||this._pvrtc||this._astc||this._etc||this._etc1||this._bc7}},vertexArrayObject:{get:function(){return this._vertexArrayObject||this._webgl2}},fragmentDepth:{get:function(){return this._fragDepth||this._webgl2}},instancedArrays:{get:function(){return this._instancedArrays||this._webgl2}},colorBufferFloat:{get:function(){return this._colorBufferFloat}},colorBufferHalfFloat:{get:function(){return this._webgl2&&this._colorBufferFloat||!this._webgl2&&this._colorBufferHalfFloat}},drawBuffers:{get:function(){return this._drawBuffers||this._webgl2}},debugShaders:{get:function(){return this._debugShaders}},throwOnWebGLError:{get:function(){return this._throwOnWebGLError},set:function(e){this._throwOnWebGLError=e,this._gl=DRe(this._originalGLContext,e?vRe:void 0)}},defaultTexture:{get:function(){return this._defaultTexture===void 0&&(this._defaultTexture=new Ot({context:this,source:{width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])},flipY:!1})),this._defaultTexture}},defaultEmissiveTexture:{get:function(){return this._defaultEmissiveTexture===void 0&&(this._defaultEmissiveTexture=new Ot({context:this,pixelFormat:tt.RGB,source:{width:1,height:1,arrayBufferView:new Uint8Array([0,0,0])},flipY:!1})),this._defaultEmissiveTexture}},defaultNormalTexture:{get:function(){return this._defaultNormalTexture===void 0&&(this._defaultNormalTexture=new Ot({context:this,pixelFormat:tt.RGB,source:{width:1,height:1,arrayBufferView:new Uint8Array([128,128,255])},flipY:!1})),this._defaultNormalTexture}},defaultCubeMap:{get:function(){if(this._defaultCubeMap===void 0){let e={width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])};this._defaultCubeMap=new Or({context:this,source:{positiveX:e,negativeX:e,positiveY:e,negativeY:e,positiveZ:e,negativeZ:e},flipY:!1})}return this._defaultCubeMap}},drawingBufferHeight:{get:function(){return this._gl.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._gl.drawingBufferWidth}},defaultFramebuffer:{get:function(){return IRe}}});function Jee(e,t,n,i){let o=e._currentRenderState,r=e._currentPassState;e._currentRenderState=t,e._currentPassState=n,Ue.partialApply(e._gl,o,t,r,n,i)}var e9;typeof WebGLRenderingContext<"u"&&(e9=[te.BACK]);function t9(e,t){if(t!==e._currentFramebuffer){e._currentFramebuffer=t;let n=e9;if(u(t))t._bind(),n=t._getActiveColorAttachments();else{let i=e._gl;i.bindFramebuffer(i.FRAMEBUFFER,null)}e.drawBuffers&&e.glDrawBuffers(n)}}var PRe=new ni;Xl.prototype.clear=function(e,t){e=x(e,PRe),t=x(t,this._defaultPassState);let n=this._gl,i=0,o=e.color,r=e.depth,s=e.stencil;u(o)&&(G.equals(this._clearColor,o)||(G.clone(o,this._clearColor),n.clearColor(o.red,o.green,o.blue,o.alpha)),i|=n.COLOR_BUFFER_BIT),u(r)&&(r!==this._clearDepth&&(this._clearDepth=r,n.clearDepth(r)),i|=n.DEPTH_BUFFER_BIT),u(s)&&(s!==this._clearStencil&&(this._clearStencil=s,n.clearStencil(s)),i|=n.STENCIL_BUFFER_BIT);let a=x(e.renderState,this._defaultRenderState);Jee(this,a,t,!0);let c=x(e.framebuffer,t.framebuffer);t9(this,c),n.clear(i)};function RRe(e,t,n,i,o){t9(e,t),Jee(e,o,n,!1),i._bind(),e._maxFrameTextureUnitIndex=Math.max(e._maxFrameTextureUnitIndex,i.maximumTextureUnitIndex)}function ORe(e,t,n,i){let o=t._primitiveType,r=t._vertexArray,s=t._offset,a=t._count,c=t.instanceCount;e._us.model=x(t._modelMatrix,F.IDENTITY),n._setUniforms(i,e._us,e.validateShaderProgram),r._bind();let l=r.indexBuffer;u(l)?(s=s*l.bytesPerIndex,u(a)?a=Math.min(a,l.numberOfIndices):a=l.numberOfIndices,c===0?e._gl.drawElements(o,a,l.indexDatatype,s):e.glDrawElementsInstanced(o,a,l.indexDatatype,s,c)):(u(a)?a=Math.min(a,r.numberOfVertices):a=r.numberOfVertices,c===0?e._gl.drawArrays(o,s,a):e.glDrawArraysInstanced(o,s,a,c)),r._unBind()}Xl.prototype.draw=function(e,t,n,i){t=x(t,this._defaultPassState);let o=x(e._framebuffer,t.framebuffer),r=x(e._renderState,this._defaultRenderState);n=x(n,e._shaderProgram),i=x(i,e._uniformMap),RRe(this,o,t,n,r),ORe(this,e,n,i)};Xl.prototype.endFrame=function(){let e=this._gl;e.useProgram(null),this._currentFramebuffer=void 0,e.bindFramebuffer(e.FRAMEBUFFER,null);let t=e9;this.drawBuffers&&this.glDrawBuffers(t);let n=this._maxFrameTextureUnitIndex;this._maxFrameTextureUnitIndex=0;for(let i=0;i<n;++i)e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_2D,null),e.bindTexture(e.TEXTURE_CUBE_MAP,null)};Xl.prototype.readPixels=function(e){let t=this._gl;e=x(e,x.EMPTY_OBJECT);let n=Math.max(x(e.x,0),0),i=Math.max(x(e.y,0),0),o=x(e.width,t.drawingBufferWidth),r=x(e.height,t.drawingBufferHeight),s=e.framebuffer,a=Ke.UNSIGNED_BYTE;u(s)&&s.numberOfColorAttachments>0&&(a=s.getColorTexture(0).pixelDatatype);let c=tt.createTypedArray(tt.RGBA,a,o,r);return t9(this,s),t.readPixels(n,i,o,r,tt.RGBA,Ke.toWebGLConstant(a,this),c),c};var ete={position:0,textureCoordinates:1};Xl.prototype.getViewportQuadVertexArray=function(){let e=this.cache.viewportQuad_vertexArray;if(!u(e)){let t=new ft({attributes:{position:new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:[-1,-1,1,-1,1,1,-1,1]}),textureCoordinates:new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:[0,0,1,0,1,1,0,1]})},indices:new Uint16Array([0,1,2,0,2,3]),primitiveType:Ne.TRIANGLES});e=ii.fromGeometry({context:this,geometry:t,attributeLocations:ete,bufferUsage:ke.STATIC_DRAW,interleave:!0}),this.cache.viewportQuad_vertexArray=e}return e};Xl.prototype.createViewportQuadCommand=function(e,t){return t=x(t,x.EMPTY_OBJECT),new Qe({vertexArray:this.getViewportQuadVertexArray(),primitiveType:Ne.TRIANGLES,renderState:t.renderState,shaderProgram:tn.fromCache({context:this,vertexShaderSource:pC,fragmentShaderSource:e,attributeLocations:ete}),uniformMap:t.uniformMap,owner:t.owner,framebuffer:t.framebuffer,pass:t.pass})};Xl.prototype.getObjectByPickColor=function(e){return this._pickObjects[e.toRgba()]};function n9(e,t,n){this._pickObjects=e,this.key=t,this.color=n}Object.defineProperties(n9.prototype,{object:{get:function(){return this._pickObjects[this.key]},set:function(e){this._pickObjects[this.key]=e}}});n9.prototype.destroy=function(){delete this._pickObjects[this.key]};Xl.prototype.createPickId=function(e){++this._nextPickColor[0];let t=this._nextPickColor[0];if(t===0)throw new ce("Out of unique Pick IDs.");return this._pickObjects[t]=e,new n9(this._pickObjects,t,G.fromRgba(t))};Xl.prototype.isDestroyed=function(){return!1};Xl.prototype.destroy=function(){let e=this.cache;for(let t in e)if(e.hasOwnProperty(t)){let n=e[t];u(n.destroy)&&n.destroy()}return this._shaderCache=this._shaderCache.destroy(),this._textureCache=this._textureCache.destroy(),this._defaultTexture=this._defaultTexture&&this._defaultTexture.destroy(),this._defaultEmissiveTexture=this._defaultEmissiveTexture&&this._defaultEmissiveTexture.destroy(),this._defaultNormalTexture=this._defaultNormalTexture&&this._defaultNormalTexture.destroy(),this._defaultCubeMap=this._defaultCubeMap&&this._defaultCubeMap.destroy(),ue(this)};Xl._deprecationWarning=ys;var UM=Xl;function vC(e){e=x(e,x.EMPTY_OBJECT);let{context:t,width:n,height:i,colorRenderbuffers:o,colorTextures:r,depthStencilRenderbuffer:s,depthStencilTexture:a,destroyAttachments:c}=e;if(this._width=n,this._height=i,u(o)!==u(r))throw new he("Both color renderbuffer and texture attachments must be provided.");if(u(s)!==u(a))throw new he("Both depth-stencil renderbuffer and texture attachments must be provided.");this._renderFramebuffer=new Hr({context:t,colorRenderbuffers:o,depthStencilRenderbuffer:s,destroyAttachments:c}),this._colorFramebuffer=new Hr({context:t,colorTextures:r,depthStencilTexture:a,destroyAttachments:c})}vC.prototype.getRenderFramebuffer=function(){return this._renderFramebuffer};vC.prototype.getColorFramebuffer=function(){return this._colorFramebuffer};vC.prototype.blitFramebuffers=function(e,t){this._renderFramebuffer.bindRead(),this._colorFramebuffer.bindDraw();let n=e._gl,i=0;this._colorFramebuffer._colorTextures.length>0&&(i|=n.COLOR_BUFFER_BIT),u(this._colorFramebuffer.depthStencilTexture)&&(i|=n.DEPTH_BUFFER_BIT|(t?n.STENCIL_BUFFER_BIT:0)),n.blitFramebuffer(0,0,this._width,this._height,0,0,this._width,this._height,i,n.NEAREST),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null)};vC.prototype.isDestroyed=function(){return!1};vC.prototype.destroy=function(){return this._renderFramebuffer.destroy(),this._colorFramebuffer.destroy(),ue(this)};var zM=vC;var dl={RGBA4:te.RGBA4,RGBA8:te.RGBA8,RGBA16F:te.RGBA16F,RGBA32F:te.RGBA32F,RGB5_A1:te.RGB5_A1,RGB565:te.RGB565,DEPTH_COMPONENT16:te.DEPTH_COMPONENT16,STENCIL_INDEX8:te.STENCIL_INDEX8,DEPTH_STENCIL:te.DEPTH_STENCIL,DEPTH24_STENCIL8:te.DEPTH24_STENCIL8,validate:function(e){return e===dl.RGBA4||e===dl.RGBA8||e===dl.RGBA16F||e===dl.RGBA32F||e===dl.RGB5_A1||e===dl.RGB565||e===dl.DEPTH_COMPONENT16||e===dl.STENCIL_INDEX8||e===dl.DEPTH_STENCIL||e===dl.DEPTH24_STENCIL8},getColorFormat:function(e){return e===te.FLOAT?dl.RGBA32F:e===te.HALF_FLOAT_OES?dl.RGBA16F:dl.RGBA8}},hl=Object.freeze(dl);function JS(e){e=x(e,x.EMPTY_OBJECT);let n=e.context._gl,i=Vt.maximumRenderbufferSize,o=x(e.format,hl.RGBA4),r=u(e.width)?e.width:n.drawingBufferWidth,s=u(e.height)?e.height:n.drawingBufferHeight,a=x(e.numSamples,1);this._gl=n,this._format=o,this._width=r,this._height=s,this._renderbuffer=this._gl.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,this._renderbuffer),a>1?n.renderbufferStorageMultisample(n.RENDERBUFFER,a,o,r,s):n.renderbufferStorage(n.RENDERBUFFER,o,r,s),n.bindRenderbuffer(n.RENDERBUFFER,null)}Object.defineProperties(JS.prototype,{format:{get:function(){return this._format}},width:{get:function(){return this._width}},height:{get:function(){return this._height}}});JS.prototype._getRenderbuffer=function(){return this._renderbuffer};JS.prototype.isDestroyed=function(){return!1};JS.prototype.destroy=function(){return this._gl.deleteRenderbuffer(this._renderbuffer),ue(this)};var Ju=JS;function Cs(e){e=x(e,x.EMPTY_OBJECT),this._numSamples=x(e.numSamples,1),this._colorAttachmentsLength=x(e.colorAttachmentsLength,1),this._color=x(e.color,!0),this._depth=x(e.depth,!1),this._depthStencil=x(e.depthStencil,!1),this._supportsDepthTexture=x(e.supportsDepthTexture,!1),this._createColorAttachments=x(e.createColorAttachments,!0),this._createDepthAttachments=x(e.createDepthAttachments,!0),this._pixelDatatype=e.pixelDatatype,this._pixelFormat=e.pixelFormat,this._width=void 0,this._height=void 0,this._framebuffer=void 0,this._multisampleFramebuffer=void 0,this._colorTextures=void 0,this._color&&(this._colorTextures=new Array(this._colorAttachmentsLength),this._colorRenderbuffers=new Array(this._colorAttachmentsLength)),this._colorRenderbuffer=void 0,this._depthStencilRenderbuffer=void 0,this._depthStencilTexture=void 0,this._depthRenderbuffer=void 0,this._depthTexture=void 0,this._attachmentsDirty=!1}Object.defineProperties(Cs.prototype,{framebuffer:{get:function(){return this._numSamples>1?this._multisampleFramebuffer.getRenderFramebuffer():this._framebuffer}},numSamples:{get:function(){return this._numSamples}},status:{get:function(){return this.framebuffer.status}}});Cs.prototype.isDirty=function(e,t,n,i,o){n=x(n,1);let r=this._width!==e||this._height!==t,s=this._numSamples!==n,a=u(i)&&this._pixelDatatype!==i||u(o)&&this._pixelFormat!==o,c=n===1?u(this._framebuffer):u(this._multisampleFramebuffer);return this._attachmentsDirty||r||s||a||!c||this._color&&!u(this._colorTextures[0])};Cs.prototype.update=function(e,t,n,i,o,r){if(i=e.msaa?x(i,1):1,o=x(o,this._color?x(this._pixelDatatype,Ke.UNSIGNED_BYTE):void 0),r=x(r,this._color?x(this._pixelFormat,tt.RGBA):void 0),this.isDirty(t,n,i,o,r)){if(this.destroy(),this._width=t,this._height=n,this._numSamples=i,this._pixelDatatype=o,this._pixelFormat=r,this._attachmentsDirty=!1,this._color&&this._createColorAttachments){for(let s=0;s<this._colorAttachmentsLength;++s)if(this._colorTextures[s]=new Ot({context:e,width:t,height:n,pixelFormat:r,pixelDatatype:o,sampler:Qt.NEAREST}),this._numSamples>1){let a=hl.getColorFormat(o);this._colorRenderbuffers[s]=new Ju({context:e,width:t,height:n,format:a,numSamples:this._numSamples})}}this._depthStencil&&this._createDepthAttachments&&(this._supportsDepthTexture&&e.depthTexture?(this._depthStencilTexture=new Ot({context:e,width:t,height:n,pixelFormat:tt.DEPTH_STENCIL,pixelDatatype:Ke.UNSIGNED_INT_24_8,sampler:Qt.NEAREST}),this._numSamples>1&&(this._depthStencilRenderbuffer=new Ju({context:e,width:t,height:n,format:hl.DEPTH24_STENCIL8,numSamples:this._numSamples}))):this._depthStencilRenderbuffer=new Ju({context:e,width:t,height:n,format:hl.DEPTH_STENCIL})),this._depth&&this._createDepthAttachments&&(this._supportsDepthTexture&&e.depthTexture?this._depthTexture=new Ot({context:e,width:t,height:n,pixelFormat:tt.DEPTH_COMPONENT,pixelDatatype:Ke.UNSIGNED_INT,sampler:Qt.NEAREST}):this._depthRenderbuffer=new Ju({context:e,width:t,height:n,format:hl.DEPTH_COMPONENT16})),this._numSamples>1?this._multisampleFramebuffer=new zM({context:e,width:this._width,height:this._height,colorTextures:this._colorTextures,colorRenderbuffers:this._colorRenderbuffers,depthStencilTexture:this._depthStencilTexture,depthStencilRenderbuffer:this._depthStencilRenderbuffer,destroyAttachments:!1}):this._framebuffer=new Hr({context:e,colorTextures:this._colorTextures,depthTexture:this._depthTexture,depthRenderbuffer:this._depthRenderbuffer,depthStencilTexture:this._depthStencilTexture,depthStencilRenderbuffer:this._depthStencilRenderbuffer,destroyAttachments:!1})}};Cs.prototype.getColorTexture=function(e){return e=x(e,0),this._colorTextures[e]};Cs.prototype.setColorTexture=function(e,t){t=x(t,0),this._attachmentsDirty=e!==this._colorTextures[t],this._colorTextures[t]=e};Cs.prototype.getColorRenderbuffer=function(e){return e=x(e,0),this._colorRenderbuffers[e]};Cs.prototype.setColorRenderbuffer=function(e,t){t=x(t,0),this._attachmentsDirty=e!==this._colorRenderbuffers[t],this._colorRenderbuffers[t]=e};Cs.prototype.getDepthRenderbuffer=function(){return this._depthRenderbuffer};Cs.prototype.setDepthRenderbuffer=function(e){this._attachmentsDirty=e!==this._depthRenderbuffer,this._depthRenderbuffer=e};Cs.prototype.getDepthTexture=function(){return this._depthTexture};Cs.prototype.setDepthTexture=function(e){this._attachmentsDirty=e!==this._depthTexture,this._depthTexture=e};Cs.prototype.getDepthStencilRenderbuffer=function(){return this._depthStencilRenderbuffer};Cs.prototype.setDepthStencilRenderbuffer=function(e){this._attachmentsDirty=e!==this._depthStencilRenderbuffer,this._depthStencilRenderbuffer=e};Cs.prototype.getDepthStencilTexture=function(){return this._depthStencilTexture};Cs.prototype.setDepthStencilTexture=function(e){this._attachmentsDirty=e!==this._depthStencilTexture,this._depthStencilTexture=e};Cs.prototype.prepareTextures=function(e,t){this._numSamples>1&&this._multisampleFramebuffer.blitFramebuffers(e,t)};Cs.prototype.clear=function(e,t,n){let i=t.framebuffer;t.framebuffer=this.framebuffer,t.execute(e,n),t.framebuffer=i};Cs.prototype.destroyFramebuffer=function(){this._framebuffer=this._framebuffer&&this._framebuffer.destroy(),this._multisampleFramebuffer=this._multisampleFramebuffer&&this._multisampleFramebuffer.destroy()};Cs.prototype.destroy=function(){if(this._color){let e=this._colorTextures,t=this._colorRenderbuffers;for(let n=0;n<e.length;++n){let i=e[n];this._createColorAttachments&&u(i)&&!i.isDestroyed()&&i.destroy(),u(i)&&i.isDestroyed()&&(e[n]=void 0);let o=t[n];this._createColorAttachments&&u(o)&&!o.isDestroyed()&&o.destroy(),u(o)&&o.isDestroyed()&&(t[n]=void 0)}}this._depthStencil&&(this._createDepthAttachments&&(this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy()),u(this._depthStencilTexture)&&this._depthStencilTexture.isDestroyed()&&(this._depthStencilTexture=void 0),u(this._depthStencilRenderbuffer)&&this._depthStencilRenderbuffer.isDestroyed()&&(this._depthStencilRenderbuffer=void 0)),this._depth&&(this._createDepthAttachments&&(this._depthTexture=this._depthTexture&&this._depthTexture.destroy(),this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy()),u(this._depthTexture)&&this._depthTexture.isDestroyed()&&(this._depthTexture=void 0),u(this._depthRenderbuffer)&&this._depthRenderbuffer.isDestroyed()&&(this._depthRenderbuffer=void 0)),this.destroyFramebuffer()};var pi=Cs;function MRe(e,t,n){let i={flipY:!0,skipColorSpaceConversion:n,preferImageBitmap:!0},o=[De.createIfNeeded(t.positiveX).fetchImage(i),De.createIfNeeded(t.negativeX).fetchImage(i),De.createIfNeeded(t.positiveY).fetchImage(i),De.createIfNeeded(t.negativeY).fetchImage(i),De.createIfNeeded(t.positiveZ).fetchImage(i),De.createIfNeeded(t.negativeZ).fetchImage(i)];return Promise.all(o).then(function(r){return new Or({context:e,source:{positiveX:r[0],negativeX:r[1],positiveY:r[2],negativeY:r[3],positiveZ:r[4],negativeZ:r[5]}})})}var HM=MRe;var Ny={VERTEX:0,FRAGMENT:1,BOTH:2};Ny.includesVertexShader=function(e){return e===Ny.VERTEX||e===Ny.BOTH};Ny.includesFragmentShader=function(e){return e===Ny.FRAGMENT||e===Ny.BOTH};var _e=Object.freeze(Ny);function i9(e){this.name=e,this.fields=[]}i9.prototype.addField=function(e,t){let n=`    ${e} ${t};`;this.fields.push(n)};i9.prototype.generateGlslLines=function(){let e=this.fields;return e.length===0&&(e=["    float _empty;"]),[].concat(`struct ${this.name}`,"{",e,"};")};var GM=i9;function o9(e){this.signature=e,this.body=[]}o9.prototype.addLines=function(e){let t=this.body;if(Array.isArray(e)){let n=e.length;for(let i=0;i<n;i++)t.push(`    ${e[i]}`)}else t.push(`    ${e}`)};o9.prototype.generateGlslLines=function(){return[].concat(this.signature,"{",this.body,"}")};var WM=o9;function Ec(){this._positionAttributeLine=void 0,this._nextAttributeLocation=1,this._attributeLocations={},this._attributeLines=[],this._structs={},this._functions={},this._vertexShaderParts={defineLines:[],uniformLines:[],shaderLines:[],varyingLines:[],structIds:[],functionIds:[]},this._fragmentShaderParts={defineLines:[],uniformLines:[],shaderLines:[],varyingLines:[],structIds:[],functionIds:[]}}Object.defineProperties(Ec.prototype,{attributeLocations:{get:function(){return this._attributeLocations}}});Ec.prototype.addDefine=function(e,t,n){n=x(n,_e.BOTH);let i=e;u(t)&&(i+=` ${t.toString()}`),_e.includesVertexShader(n)&&this._vertexShaderParts.defineLines.push(i),_e.includesFragmentShader(n)&&this._fragmentShaderParts.defineLines.push(i)};Ec.prototype.addStruct=function(e,t,n){this._structs[e]=new GM(t),_e.includesVertexShader(n)&&this._vertexShaderParts.structIds.push(e),_e.includesFragmentShader(n)&&this._fragmentShaderParts.structIds.push(e)};Ec.prototype.addStructField=function(e,t,n){this._structs[e].addField(t,n)};Ec.prototype.addFunction=function(e,t,n){this._functions[e]=new WM(t),_e.includesVertexShader(n)&&this._vertexShaderParts.functionIds.push(e),_e.includesFragmentShader(n)&&this._fragmentShaderParts.functionIds.push(e)};Ec.prototype.addFunctionLines=function(e,t){this._functions[e].addLines(t)};Ec.prototype.addUniform=function(e,t,n){n=x(n,_e.BOTH);let i=`uniform ${e} ${t};`;_e.includesVertexShader(n)&&this._vertexShaderParts.uniformLines.push(i),_e.includesFragmentShader(n)&&this._fragmentShaderParts.uniformLines.push(i)};Ec.prototype.setPositionAttribute=function(e,t){return this._positionAttributeLine=`in ${e} ${t};`,this._attributeLocations[t]=0,0};Ec.prototype.addAttribute=function(e,t){let n=`in ${e} ${t};`;this._attributeLines.push(n);let i=this._nextAttributeLocation;return this._attributeLocations[t]=i,this._nextAttributeLocation+=NRe(e),i};Ec.prototype.addVarying=function(e,t,n){n=u(n)?`${n} `:"";let i=`${e} ${t};`;this._vertexShaderParts.varyingLines.push(`${n}out ${i}`),this._fragmentShaderParts.varyingLines.push(`${n}in ${i}`)};Ec.prototype.addVertexLines=function(e){let t=this._vertexShaderParts.shaderLines;Array.isArray(e)?t.push.apply(t,e):t.push(e)};Ec.prototype.addFragmentLines=function(e){let t=this._fragmentShaderParts.shaderLines;Array.isArray(e)?t.push.apply(t,e):t.push(e)};Ec.prototype.buildShaderProgram=function(e){let t=u(this._positionAttributeLine)?[this._positionAttributeLine]:[],n=LRe(this),i=FRe(this),o=t.concat(this._attributeLines,this._vertexShaderParts.uniformLines,this._vertexShaderParts.varyingLines,n.vertexLines,i.vertexLines,this._vertexShaderParts.shaderLines).join(`
`),r=new ze({defines:this._vertexShaderParts.defineLines,sources:[o]}),s=this._fragmentShaderParts.uniformLines.concat(this._fragmentShaderParts.varyingLines,n.fragmentLines,i.fragmentLines,this._fragmentShaderParts.shaderLines).join(`
`),a=new ze({defines:this._fragmentShaderParts.defineLines,sources:[s]});return tn.fromCache({context:e,vertexShaderSource:r,fragmentShaderSource:a,attributeLocations:this._attributeLocations})};Ec.prototype.clone=function(){return Ge(this,!0)};function LRe(e){let t=[],n=[],i,o=e._vertexShaderParts.structIds,r,s,a;for(i=0;i<o.length;i++)r=o[i],s=e._structs[r],a=s.generateGlslLines(),t.push.apply(t,a);for(o=e._fragmentShaderParts.structIds,i=0;i<o.length;i++)r=o[i],s=e._structs[r],a=s.generateGlslLines(),n.push.apply(n,a);return{vertexLines:t,fragmentLines:n}}function NRe(e){switch(e){case"mat2":return 2;case"mat3":return 3;case"mat4":return 4;default:return 1}}function FRe(e){let t=[],n=[],i,o=e._vertexShaderParts.functionIds,r,s,a;for(i=0;i<o.length;i++)r=o[i],s=e._functions[r],a=s.generateGlslLines(),t.push.apply(t,a);for(o=e._fragmentShaderParts.functionIds,i=0;i<o.length;i++)r=o[i],s=e._functions[r],a=s.generateGlslLines(),n.push.apply(n,a);return{vertexLines:t,fragmentLines:n}}var wC=Ec;function Ns(e,t,n,i){let o=Ns._verifyAttributes(t);n=x(n,0);let r=[],s={},a,c,l=o.length;for(let d=0;d<l;++d){let p=o[d];if(p.vertexBuffer){r.push(p);continue}c=p.usage,a=s[c],u(a)||(a=s[c]=[]),a.push(p)}function f(d,p){return K.getSizeInBytes(p.componentDatatype)-K.getSizeInBytes(d.componentDatatype)}this._allBuffers=[];for(c in s)if(s.hasOwnProperty(c)){a=s[c],a.sort(f);let d=Ns._vertexSizeInBytes(a),p=a[0].usage,g={vertexSizeInBytes:d,vertexBuffer:void 0,usage:p,needsCommit:!1,arrayBuffer:void 0,arrayViews:Ns._createArrayViews(a,d)};this._allBuffers.push(g)}this._size=0,this._instanced=x(i,!1),this._precreated=r,this._context=e,this.writers=void 0,this.va=void 0,this.resize(n)}Ns._verifyAttributes=function(e){let t=[];for(let i=0;i<e.length;++i){let o=e[i],r={index:x(o.index,i),enabled:x(o.enabled,!0),componentsPerAttribute:o.componentsPerAttribute,componentDatatype:x(o.componentDatatype,K.FLOAT),normalize:x(o.normalize,!1),vertexBuffer:o.vertexBuffer,usage:x(o.usage,ke.STATIC_DRAW)};t.push(r)}let n=new Array(t.length);for(let i=0;i<t.length;++i){let r=t[i].index;n[r]=!0}return t};Ns._vertexSizeInBytes=function(e){let t=0,n=e.length;for(let s=0;s<n;++s){let a=e[s];t+=a.componentsPerAttribute*K.getSizeInBytes(a.componentDatatype)}let i=n>0?K.getSizeInBytes(e[0].componentDatatype):0,o=i>0?t%i:0,r=o===0?0:i-o;return t+=r,t};Ns._createArrayViews=function(e,t){let n=[],i=0,o=e.length;for(let r=0;r<o;++r){let s=e[r],a=s.componentDatatype;n.push({index:s.index,enabled:s.enabled,componentsPerAttribute:s.componentsPerAttribute,componentDatatype:a,normalize:s.normalize,offsetInBytes:i,vertexSizeInComponentType:t/K.getSizeInBytes(a),view:void 0}),i+=s.componentsPerAttribute*K.getSizeInBytes(a)}return n};Ns.prototype.resize=function(e){this._size=e;let t=this._allBuffers;this.writers=[];for(let n=0,i=t.length;n<i;++n){let o=t[n];Ns._resize(o,this._size),Ns._appendWriters(this.writers,o)}r9(this)};Ns._resize=function(e,t){if(e.vertexSizeInBytes>0){let n=new ArrayBuffer(t*e.vertexSizeInBytes);if(u(e.arrayBuffer)){let r=new Uint8Array(n),s=new Uint8Array(e.arrayBuffer),a=s.length;for(let c=0;c<a;++c)r[c]=s[c]}let i=e.arrayViews,o=i.length;for(let r=0;r<o;++r){let s=i[r];s.view=K.createArrayBufferView(s.componentDatatype,n,s.offsetInBytes)}e.arrayBuffer=n}};var BRe=[function(e,t,n){return function(i,o){t[i*n]=o,e.needsCommit=!0}},function(e,t,n){return function(i,o,r){let s=i*n;t[s]=o,t[s+1]=r,e.needsCommit=!0}},function(e,t,n){return function(i,o,r,s){let a=i*n;t[a]=o,t[a+1]=r,t[a+2]=s,e.needsCommit=!0}},function(e,t,n){return function(i,o,r,s,a){let c=i*n;t[c]=o,t[c+1]=r,t[c+2]=s,t[c+3]=a,e.needsCommit=!0}}];Ns._appendWriters=function(e,t){let n=t.arrayViews,i=n.length;for(let o=0;o<i;++o){let r=n[o];e[r.index]=BRe[r.componentsPerAttribute-1](t,r.view,r.vertexSizeInComponentType)}};Ns.prototype.commit=function(e){let t=!1,n=this._allBuffers,i,o,r;for(o=0,r=n.length;o<r;++o)i=n[o],t=kRe(this,i)||t;if(t||!u(this.va)){r9(this);let s=this.va=[],a=R.SIXTY_FOUR_KILOBYTES-4,c=u(e)&&!this._instanced?Math.ceil(this._size/a):1;for(let l=0;l<c;++l){let f=[];for(o=0,r=n.length;o<r;++o){i=n[o];let d=l*(i.vertexSizeInBytes*a);Ns._appendAttributes(f,i,d,this._instanced)}f=f.concat(this._precreated),s.push({va:new ii({context:this._context,attributes:f,indexBuffer:e}),indicesCount:1.5*(l!==c-1?a:this._size%a)})}}};function kRe(e,t){if(t.needsCommit&&t.vertexSizeInBytes>0){t.needsCommit=!1;let n=t.vertexBuffer,i=e._size*t.vertexSizeInBytes,o=u(n);if(!o||n.sizeInBytes<i)return o&&n.destroy(),t.vertexBuffer=xt.createVertexBuffer({context:e._context,typedArray:t.arrayBuffer,usage:t.usage}),t.vertexBuffer.vertexArrayDestroyable=!1,!0;t.vertexBuffer.copyFromArrayView(t.arrayBuffer)}return!1}Ns._appendAttributes=function(e,t,n,i){let o=t.arrayViews,r=o.length;for(let s=0;s<r;++s){let a=o[s];e.push({index:a.index,enabled:a.enabled,componentsPerAttribute:a.componentsPerAttribute,componentDatatype:a.componentDatatype,normalize:a.normalize,vertexBuffer:t.vertexBuffer,offsetInBytes:n+a.offsetInBytes,strideInBytes:t.vertexSizeInBytes,instanceDivisor:i?1:0})}};Ns.prototype.subCommit=function(e,t){let n=this._allBuffers;for(let i=0,o=n.length;i<o;++i)VRe(n[i],e,t)};function VRe(e,t,n){if(e.needsCommit&&e.vertexSizeInBytes>0){let i=e.vertexSizeInBytes*t,o=e.vertexSizeInBytes*n;e.vertexBuffer.copyFromArrayView(new Uint8Array(e.arrayBuffer,i,o),i)}}Ns.prototype.endSubCommits=function(){let e=this._allBuffers;for(let t=0,n=e.length;t<n;++t)e[t].needsCommit=!1};function r9(e){let t=e.va;if(!u(t))return;let n=t.length;for(let i=0;i<n;++i)t[i].va.destroy();e.va=void 0}Ns.prototype.isDestroyed=function(){return!1};Ns.prototype.destroy=function(){let e=this._allBuffers;for(let t=0,n=e.length;t<n;++t){let i=e[t];i.vertexBuffer=i.vertexBuffer&&i.vertexBuffer.destroy()}return r9(this),ue(this)};var G_=Ns;function W_(e){this._value=void 0,this._hasClone=!1,this._hasEquals=!1,this._definitionChanged=new me,this.setValue(e)}Object.defineProperties(W_.prototype,{isConstant:{value:!0},definitionChanged:{get:function(){return this._definitionChanged}}});W_.prototype.getValue=function(e,t){return this._hasClone?this._value.clone(t):this._value};W_.prototype.setValue=function(e){let t=this._value;if(t!==e){let n=u(e),i=n&&typeof e.clone=="function",o=n&&typeof e.equals=="function";(!o||!e.equals(t))&&(this._hasClone=i,this._hasEquals=o,this._value=i?e.clone(this._value):e,this._definitionChanged.raiseEvent(this))}};W_.prototype.equals=function(e){return this===e||e instanceof W_&&(!this._hasEquals&&this._value===e._value||this._hasEquals&&this._value.equals(e._value))};W_.prototype.valueOf=function(){return this._value};W_.prototype.toString=function(){return String(this._value)};var Kn=W_;function URe(e,t,n,i,o){return{configurable:i,get:function(){return this[t]},set:function(r){let s=this[t],a=this[n];u(a)&&(a(),this[n]=void 0),r!==void 0&&(!u(r)||!u(r.getValue))&&u(o)&&(r=o(r)),s!==r&&(this[t]=r,this._definitionChanged.raiseEvent(this,e,r,s)),u(r)&&u(r.definitionChanged)&&(this[n]=r.definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this,e,r,r)},this))}}}function zRe(e){return new Kn(e)}function HRe(e,t,n){return URe(e,`_${e.toString()}`,`_${e.toString()}Subscription`,x(t,!1),x(n,zRe))}var le=HRe;function ev(e){this._definitionChanged=new me,this._show=void 0,this._showSubscription=void 0,this._image=void 0,this._imageSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._pixelOffset=void 0,this._pixelOffsetSubscription=void 0,this._eyeOffset=void 0,this._eyeOffsetSubscription=void 0,this._horizontalOrigin=void 0,this._horizontalOriginSubscription=void 0,this._verticalOrigin=void 0,this._verticalOriginSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._alignedAxis=void 0,this._alignedAxisSubscription=void 0,this._sizeInMeters=void 0,this._sizeInMetersSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._pixelOffsetScaleByDistance=void 0,this._pixelOffsetScaleByDistanceSubscription=void 0,this._imageSubRegion=void 0,this._imageSubRegionSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this._splitDirection=void 0,this._splitDirectionSubscription=void 0,this.merge(x(e,x.EMPTY_OBJECT))}Object.defineProperties(ev.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:le("show"),image:le("image"),scale:le("scale"),pixelOffset:le("pixelOffset"),eyeOffset:le("eyeOffset"),horizontalOrigin:le("horizontalOrigin"),verticalOrigin:le("verticalOrigin"),heightReference:le("heightReference"),color:le("color"),rotation:le("rotation"),alignedAxis:le("alignedAxis"),sizeInMeters:le("sizeInMeters"),width:le("width"),height:le("height"),scaleByDistance:le("scaleByDistance"),translucencyByDistance:le("translucencyByDistance"),pixelOffsetScaleByDistance:le("pixelOffsetScaleByDistance"),imageSubRegion:le("imageSubRegion"),distanceDisplayCondition:le("distanceDisplayCondition"),disableDepthTestDistance:le("disableDepthTestDistance"),splitDirection:le("splitDirection")});ev.prototype.clone=function(e){return u(e)?(e.show=this._show,e.image=this._image,e.scale=this._scale,e.pixelOffset=this._pixelOffset,e.eyeOffset=this._eyeOffset,e.horizontalOrigin=this._horizontalOrigin,e.verticalOrigin=this._verticalOrigin,e.heightReference=this._heightReference,e.color=this._color,e.rotation=this._rotation,e.alignedAxis=this._alignedAxis,e.sizeInMeters=this._sizeInMeters,e.width=this._width,e.height=this._height,e.scaleByDistance=this._scaleByDistance,e.translucencyByDistance=this._translucencyByDistance,e.pixelOffsetScaleByDistance=this._pixelOffsetScaleByDistance,e.imageSubRegion=this._imageSubRegion,e.distanceDisplayCondition=this._distanceDisplayCondition,e.disableDepthTestDistance=this._disableDepthTestDistance,e.splitDirection=this._splitDirection,e):new ev(this)};ev.prototype.merge=function(e){this.show=x(this._show,e.show),this.image=x(this._image,e.image),this.scale=x(this._scale,e.scale),this.pixelOffset=x(this._pixelOffset,e.pixelOffset),this.eyeOffset=x(this._eyeOffset,e.eyeOffset),this.horizontalOrigin=x(this._horizontalOrigin,e.horizontalOrigin),this.verticalOrigin=x(this._verticalOrigin,e.verticalOrigin),this.heightReference=x(this._heightReference,e.heightReference),this.color=x(this._color,e.color),this.rotation=x(this._rotation,e.rotation),this.alignedAxis=x(this._alignedAxis,e.alignedAxis),this.sizeInMeters=x(this._sizeInMeters,e.sizeInMeters),this.width=x(this._width,e.width),this.height=x(this._height,e.height),this.scaleByDistance=x(this._scaleByDistance,e.scaleByDistance),this.translucencyByDistance=x(this._translucencyByDistance,e.translucencyByDistance),this.pixelOffsetScaleByDistance=x(this._pixelOffsetScaleByDistance,e.pixelOffsetScaleByDistance),this.imageSubRegion=x(this._imageSubRegion,e.imageSubRegion),this.distanceDisplayCondition=x(this._distanceDisplayCondition,e.distanceDisplayCondition),this.disableDepthTestDistance=x(this._disableDepthTestDistance,e.disableDepthTestDistance),this.splitDirection=x(this.splitDirection,e.splitDirection)};var Sc=ev;function Fy(){this._array=[],this._hash={}}Object.defineProperties(Fy.prototype,{length:{get:function(){return this._array.length}},values:{get:function(){return this._array}}});Fy.prototype.contains=function(e){return u(this._hash[e])};Fy.prototype.set=function(e,t){let n=this._hash[e];t!==n&&(this.remove(e),this._hash[e]=t,this._array.push(t))};Fy.prototype.get=function(e){return this._hash[e]};Fy.prototype.remove=function(e){let t=this._hash[e],n=u(t);if(n){let i=this._array;i.splice(i.indexOf(t),1),delete this._hash[e]}return n};Fy.prototype.removeAll=function(){let e=this._array;e.length>0&&(this._hash={},e.length=0)};var St=Fy;function Kl(e,t){e=x(e,0),this._near=e,t=x(t,Number.MAX_VALUE),this._far=t}Object.defineProperties(Kl.prototype,{near:{get:function(){return this._near},set:function(e){this._near=e}},far:{get:function(){return this._far},set:function(e){this._far=e}}});Kl.packedLength=2;Kl.pack=function(e,t,n){return n=x(n,0),t[n++]=e.near,t[n]=e.far,t};Kl.unpack=function(e,t,n){return t=x(t,0),u(n)||(n=new Kl),n.near=e[t++],n.far=e[t],n};Kl.equals=function(e,t){return e===t||u(e)&&u(t)&&e.near===t.near&&e.far===t.far};Kl.clone=function(e,t){if(u(e))return u(t)||(t=new Kl),t.near=e.near,t.far=e.far,t};Kl.prototype.clone=function(e){return Kl.clone(this,e)};Kl.prototype.equals=function(e){return Kl.equals(this,e)};var Nt=Kl;function ef(e,t,n,i){this.near=x(e,0),this.nearValue=x(t,0),this.far=x(n,1),this.farValue=x(i,0)}ef.clone=function(e,t){if(u(e))return u(t)?(t.near=e.near,t.nearValue=e.nearValue,t.far=e.far,t.farValue=e.farValue,t):new ef(e.near,e.nearValue,e.far,e.farValue)};ef.packedLength=4;ef.pack=function(e,t,n){return n=x(n,0),t[n++]=e.near,t[n++]=e.nearValue,t[n++]=e.far,t[n]=e.farValue,t};ef.unpack=function(e,t,n){return t=x(t,0),u(n)||(n=new ef),n.near=e[t++],n.nearValue=e[t++],n.far=e[t++],n.farValue=e[t],n};ef.equals=function(e,t){return e===t||u(e)&&u(t)&&e.near===t.near&&e.nearValue===t.nearValue&&e.far===t.far&&e.farValue===t.farValue};ef.prototype.clone=function(e){return ef.clone(this,e)};ef.prototype.equals=function(e){return ef.equals(this,e)};var kt=ef;var By={NONE:0,CLAMP_TO_GROUND:1,RELATIVE_TO_GROUND:2,CLAMP_TO_TERRAIN:3,RELATIVE_TO_TERRAIN:4,CLAMP_TO_3D_TILE:5,RELATIVE_TO_3D_TILE:6},Xe=Object.freeze(By);function tf(e){return e===By.CLAMP_TO_GROUND||e===By.CLAMP_TO_3D_TILE||e===By.CLAMP_TO_TERRAIN}function DC(e){return e===By.RELATIVE_TO_GROUND||e===By.RELATIVE_TO_3D_TILE||e===By.RELATIVE_TO_TERRAIN}var GRe={CENTER:0,LEFT:1,RIGHT:-1},bi=Object.freeze(GRe);var WRe={CENTER:0,BOTTOM:1,BASELINE:2,TOP:-1},On=Object.freeze(WRe);var jRe={DONE:0,PENDING:1,FAILED:2},dt=Object.freeze(jRe);function hd(){he.throwInstantiationError()}Object.defineProperties(hd.prototype,{isConstant:{get:he.throwInstantiationError},definitionChanged:{get:he.throwInstantiationError}});hd.prototype.getValue=he.throwInstantiationError;hd.prototype.equals=he.throwInstantiationError;hd.equals=function(e,t){return e===t||u(e)&&e.equals(t)};hd.arrayEquals=function(e,t){if(e===t)return!0;if(!u(e)||!u(t)||e.length!==t.length)return!1;let n=e.length;for(let i=0;i<n;i++)if(!hd.equals(e[i],t[i]))return!1;return!0};hd.isConstant=function(e){return!u(e)||e.isConstant};hd.getValueOrUndefined=function(e,t,n){return u(e)?e.getValue(t,n):void 0};hd.getValueOrDefault=function(e,t,n,i){return u(e)?x(e.getValue(t,i),n):n};hd.getValueOrClonedDefault=function(e,t,n,i){let o;return u(e)&&(o=e.getValue(t,i)),u(o)||(o=n.clone(o)),o};var Y=hd;var qRe={LEFT:-1,NONE:0,RIGHT:1},Wr=Object.freeze(qRe);var YRe=G.WHITE,XRe=h.ZERO,KRe=Xe.NONE,ZRe=H.ZERO,$Re=1,QRe=0,JRe=h.ZERO,eOe=bi.CENTER,tOe=On.CENTER,nOe=!1,iOe=Wr.NONE,oOe=new h,rOe=new G,sOe=new h,aOe=new H,cOe=new kt,lOe=new kt,uOe=new kt,fOe=new qe,dOe=new Nt;function tte(e){this.entity=e,this.billboard=void 0,this.textureValue=void 0}function j_(e,t){t.collectionChanged.addEventListener(j_.prototype._onCollectionChanged,this),this._cluster=e,this._entityCollection=t,this._items=new St,this._onCollectionChanged(t,t.values,[],[])}j_.prototype.update=function(e){let t=this._items.values,n=this._cluster;for(let i=0,o=t.length;i<o;i++){let r=t[i],s=r.entity,a=s._billboard,c,l=r.billboard,f=s.isShowing&&s.isAvailable(e)&&Y.getValueOrDefault(a._show,e,!0),d;if(f&&(d=Y.getValueOrUndefined(s._position,e,oOe),c=Y.getValueOrUndefined(a._image,e),f=u(d)&&u(c)),!f){s9(r,s,n);continue}Y.isConstant(s._position)||(n._clusterDirty=!0),u(l)||(l=n.getBillboard(s),l.id=s,l.image=void 0,r.billboard=l),l.show=f,(!u(l.image)||r.textureValue!==c)&&(l.image=c,r.textureValue=c),l.position=d,l.color=Y.getValueOrDefault(a._color,e,YRe,rOe),l.eyeOffset=Y.getValueOrDefault(a._eyeOffset,e,XRe,sOe),l.heightReference=Y.getValueOrDefault(a._heightReference,e,KRe),l.pixelOffset=Y.getValueOrDefault(a._pixelOffset,e,ZRe,aOe),l.scale=Y.getValueOrDefault(a._scale,e,$Re),l.rotation=Y.getValueOrDefault(a._rotation,e,QRe),l.alignedAxis=Y.getValueOrDefault(a._alignedAxis,e,JRe),l.horizontalOrigin=Y.getValueOrDefault(a._horizontalOrigin,e,eOe),l.verticalOrigin=Y.getValueOrDefault(a._verticalOrigin,e,tOe),l.width=Y.getValueOrUndefined(a._width,e),l.height=Y.getValueOrUndefined(a._height,e),l.scaleByDistance=Y.getValueOrUndefined(a._scaleByDistance,e,cOe),l.translucencyByDistance=Y.getValueOrUndefined(a._translucencyByDistance,e,lOe),l.pixelOffsetScaleByDistance=Y.getValueOrUndefined(a._pixelOffsetScaleByDistance,e,uOe),l.sizeInMeters=Y.getValueOrDefault(a._sizeInMeters,e,nOe),l.distanceDisplayCondition=Y.getValueOrUndefined(a._distanceDisplayCondition,e,dOe),l.disableDepthTestDistance=Y.getValueOrUndefined(a._disableDepthTestDistance,e),l.splitDirection=Y.getValueOrDefault(a._splitDirection,e,iOe);let p=Y.getValueOrUndefined(a._imageSubRegion,e,fOe);u(p)&&l.setImageSubRegion(l._imageId,p)}return!0};j_.prototype.getBoundingSphere=function(e,t){let n=this._items.get(e.id);if(!u(n)||!u(n.billboard))return dt.FAILED;let i=n.billboard;if(i.heightReference===Xe.NONE)t.center=h.clone(i.position,t.center);else{if(!u(i._clampedPosition))return dt.PENDING;t.center=h.clone(i._clampedPosition,t.center)}return t.radius=0,dt.DONE};j_.prototype.isDestroyed=function(){return!1};j_.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(j_.prototype._onCollectionChanged,this);let e=this._entityCollection.values;for(let t=0;t<e.length;t++)this._cluster.removeBillboard(e[t]);return ue(this)};j_.prototype._onCollectionChanged=function(e,t,n,i){let o,r,s=this._items,a=this._cluster;for(o=t.length-1;o>-1;o--)r=t[o],u(r._billboard)&&u(r._position)&&s.set(r.id,new tte(r));for(o=i.length-1;o>-1;o--)r=i[o],u(r._billboard)&&u(r._position)?s.contains(r.id)||s.set(r.id,new tte(r)):(s9(s.get(r.id),r,a),s.remove(r.id));for(o=n.length-1;o>-1;o--)r=n[o],s9(s.get(r.id),r,a),s.remove(r.id)};function s9(e,t,n){u(e)&&(e.billboard=void 0,n.removeBillboard(t))}var jM=j_;var hOe=new h;function Dh(e){e=x(e,x.EMPTY_OBJECT);let t=e.minimum,n=e.maximum;this._min=h.clone(t),this._max=h.clone(n),this._offsetAttribute=e.offsetAttribute,this._workerName="createBoxOutlineGeometry"}Dh.fromDimensions=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.dimensions,n=h.multiplyByScalar(t,.5,new h);return new Dh({minimum:h.negate(n,new h),maximum:n,offsetAttribute:e.offsetAttribute})};Dh.fromAxisAlignedBoundingBox=function(e){return new Dh({minimum:e.minimum,maximum:e.maximum})};Dh.packedLength=2*h.packedLength+1;Dh.pack=function(e,t,n){return n=x(n,0),h.pack(e._min,t,n),h.pack(e._max,t,n+h.packedLength),t[n+h.packedLength*2]=x(e._offsetAttribute,-1),t};var ite=new h,ote=new h,nte={minimum:ite,maximum:ote,offsetAttribute:void 0};Dh.unpack=function(e,t,n){t=x(t,0);let i=h.unpack(e,t,ite),o=h.unpack(e,t+h.packedLength,ote),r=e[t+h.packedLength*2];return u(n)?(n._min=h.clone(i,n._min),n._max=h.clone(o,n._max),n._offsetAttribute=r===-1?void 0:r,n):(nte.offsetAttribute=r===-1?void 0:r,new Dh(nte))};Dh.createGeometry=function(e){let t=e._min,n=e._max;if(h.equals(t,n))return;let i=new hn,o=new Uint16Array(12*2),r=new Float64Array(8*3);r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=n.x,r[4]=t.y,r[5]=t.z,r[6]=n.x,r[7]=n.y,r[8]=t.z,r[9]=t.x,r[10]=n.y,r[11]=t.z,r[12]=t.x,r[13]=t.y,r[14]=n.z,r[15]=n.x,r[16]=t.y,r[17]=n.z,r[18]=n.x,r[19]=n.y,r[20]=n.z,r[21]=t.x,r[22]=n.y,r[23]=n.z,i.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:r}),o[0]=4,o[1]=5,o[2]=5,o[3]=6,o[4]=6,o[5]=7,o[6]=7,o[7]=4,o[8]=0,o[9]=1,o[10]=1,o[11]=2,o[12]=2,o[13]=3,o[14]=3,o[15]=0,o[16]=0,o[17]=4,o[18]=1,o[19]=5,o[20]=2,o[21]=6,o[22]=3,o[23]=7;let s=h.subtract(n,t,hOe),a=h.magnitude(s)*.5;if(u(e._offsetAttribute)){let c=r.length,l=e._offsetAttribute===an.NONE?0:1,f=new Uint8Array(c/3).fill(l);i.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:f})}return new ft({attributes:i,indices:o,primitiveType:Ne.LINES,boundingSphere:new ae(h.ZERO,a),offsetAttribute:e._offsetAttribute})};var Ih=Dh;function IC(e,t,n,i){e=x(e,1),t=x(t,1),n=x(n,1),i=x(i,1),this.value=new Uint8Array([G.floatToByte(e),G.floatToByte(t),G.floatToByte(n),G.floatToByte(i)])}Object.defineProperties(IC.prototype,{componentDatatype:{get:function(){return K.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 4}},normalize:{get:function(){return!0}}});IC.fromColor=function(e){return new IC(e.red,e.green,e.blue,e.alpha)};IC.toValue=function(e,t){return u(t)?e.toBytes(t):new Uint8Array(e.toBytes())};IC.equals=function(e,t){return e===t||u(e)&&u(t)&&e.value[0]===t.value[0]&&e.value[1]===t.value[1]&&e.value[2]===t.value[2]&&e.value[3]===t.value[3]};var jt=IC;function tv(e,t){e=x(e,0),t=x(t,Number.MAX_VALUE),this.value=new Float32Array([e,t])}Object.defineProperties(tv.prototype,{componentDatatype:{get:function(){return K.FLOAT}},componentsPerAttribute:{get:function(){return 2}},normalize:{get:function(){return!1}}});tv.fromDistanceDisplayCondition=function(e){return new tv(e.near,e.far)};tv.toValue=function(e,t){return u(t)?(t[0]=e.near,t[1]=e.far,t):new Float32Array([e.near,e.far])};var kn=tv;function mOe(e){e=x(e,x.EMPTY_OBJECT),this.geometry=e.geometry,this.modelMatrix=F.clone(x(e.modelMatrix,F.IDENTITY)),this.id=e.id,this.pickPrimitive=e.pickPrimitive,this.attributes=x(e.attributes,{}),this.westHemisphereGeometry=void 0,this.eastHemisphereGeometry=void 0}var vt=mOe;function Xo(e){e=x(e,x.EMPTY_OBJECT),this.start=u(e.start)?$.clone(e.start):new $,this.stop=u(e.stop)?$.clone(e.stop):new $,this.data=e.data,this.isStartIncluded=x(e.isStartIncluded,!0),this.isStopIncluded=x(e.isStopIncluded,!0)}Object.defineProperties(Xo.prototype,{isEmpty:{get:function(){let e=$.compare(this.stop,this.start);return e<0||e===0&&(!this.isStartIncluded||!this.isStopIncluded)}}});var PC={start:void 0,stop:void 0,isStartIncluded:void 0,isStopIncluded:void 0,data:void 0};Xo.fromIso8601=function(e,t){let n=e.iso8601.split("/");if(n.length!==2)throw new he("options.iso8601 is an invalid ISO 8601 interval.");let i=$.fromIso8601(n[0]),o=$.fromIso8601(n[1]),r=x(e.isStartIncluded,!0),s=x(e.isStopIncluded,!0),a=e.data;return u(t)?(t.start=i,t.stop=o,t.isStartIncluded=r,t.isStopIncluded=s,t.data=a,t):(PC.start=i,PC.stop=o,PC.isStartIncluded=r,PC.isStopIncluded=s,PC.data=a,new Xo(PC))};Xo.toIso8601=function(e,t){return`${$.toIso8601(e.start,t)}/${$.toIso8601(e.stop,t)}`};Xo.clone=function(e,t){if(u(e))return u(t)?(t.start=e.start,t.stop=e.stop,t.isStartIncluded=e.isStartIncluded,t.isStopIncluded=e.isStopIncluded,t.data=e.data,t):new Xo(e)};Xo.equals=function(e,t,n){return e===t||u(e)&&u(t)&&(e.isEmpty&&t.isEmpty||e.isStartIncluded===t.isStartIncluded&&e.isStopIncluded===t.isStopIncluded&&$.equals(e.start,t.start)&&$.equals(e.stop,t.stop)&&(e.data===t.data||u(n)&&n(e.data,t.data)))};Xo.equalsEpsilon=function(e,t,n,i){return n=x(n,0),e===t||u(e)&&u(t)&&(e.isEmpty&&t.isEmpty||e.isStartIncluded===t.isStartIncluded&&e.isStopIncluded===t.isStopIncluded&&$.equalsEpsilon(e.start,t.start,n)&&$.equalsEpsilon(e.stop,t.stop,n)&&(e.data===t.data||u(i)&&i(e.data,t.data)))};Xo.intersect=function(e,t,n,i){if(!u(t))return Xo.clone(Xo.EMPTY,n);let o=e.start,r=e.stop,s=t.start,a=t.stop,c=$.greaterThanOrEquals(s,o)&&$.greaterThanOrEquals(r,s),l=!c&&$.lessThanOrEquals(s,o)&&$.lessThanOrEquals(o,a);if(!c&&!l)return Xo.clone(Xo.EMPTY,n);let f=e.isStartIncluded,d=e.isStopIncluded,p=t.isStartIncluded,g=t.isStopIncluded,m=$.lessThan(r,a);return u(n)||(n=new Xo),n.start=c?s:o,n.isStartIncluded=f&&p||!$.equals(s,o)&&(c&&p||l&&f),n.stop=m?r:a,n.isStopIncluded=m?d:d&&g||!$.equals(a,r)&&g,n.data=u(i)?i(e.data,t.data):e.data,n};Xo.contains=function(e,t){if(e.isEmpty)return!1;let n=$.compare(e.start,t);if(n===0)return e.isStartIncluded;let i=$.compare(t,e.stop);return i===0?e.isStopIncluded:n<0&&i<0};Xo.prototype.clone=function(e){return Xo.clone(this,e)};Xo.prototype.equals=function(e,t){return Xo.equals(this,e,t)};Xo.prototype.equalsEpsilon=function(e,t,n){return Xo.equalsEpsilon(this,e,t,n)};Xo.prototype.toString=function(){return Xo.toIso8601(this)};Xo.EMPTY=Object.freeze(new Xo({start:new $,stop:new $,isStartIncluded:!1,isStopIncluded:!1}));var Sn=Xo;var rte=Object.freeze($.fromIso8601("0000-01-01T00:00:00Z")),ste=Object.freeze($.fromIso8601("9999-12-31T24:00:00Z")),pOe=Object.freeze(new Sn({start:rte,stop:ste})),_Oe={MINIMUM_VALUE:rte,MAXIMUM_VALUE:ste,MAXIMUM_INTERVAL:pOe},He=_Oe;function nv(e,t,n){e=x(e,0),t=x(t,0),n=x(n,0),this.value=new Float32Array([e,t,n])}Object.defineProperties(nv.prototype,{componentDatatype:{get:function(){return K.FLOAT}},componentsPerAttribute:{get:function(){return 3}},normalize:{get:function(){return!1}}});nv.fromCartesian3=function(e){return new nv(e.x,e.y,e.z)};nv.toValue=function(e,t){return u(t)||(t=new Float32Array([e.x,e.y,e.z])),t[0]=e.x,t[1]=e.y,t[2]=e.z,t};var to=nv;function qM(e){e=x(e,!0),this.value=qM.toValue(e)}Object.defineProperties(qM.prototype,{componentDatatype:{get:function(){return K.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 1}},normalize:{get:function(){return!1}}});qM.toValue=function(e,t){return u(t)?(t[0]=e,t):new Uint8Array([e])};var yn=qM;var YM=`in vec3 v_positionEC;
in vec3 v_normalEC;
in vec3 v_tangentEC;
in vec3 v_bitangentEC;
in vec2 v_st;

void main()
{
    vec3 positionToEyeEC = -v_positionEC;
    mat3 tangentToEyeMatrix = czm_tangentToEyeSpaceMatrix(v_normalEC, v_tangentEC, v_bitangentEC);

    vec3 normalEC = normalize(v_normalEC);
#ifdef FACE_FORWARD
    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);
#endif

    czm_materialInput materialInput;
    materialInput.normalEC = normalEC;
    materialInput.tangentToEyeMatrix = tangentToEyeMatrix;
    materialInput.positionToEyeEC = positionToEyeEC;
    materialInput.st = v_st;
    czm_material material = czm_getMaterial(materialInput);

#ifdef FLAT
    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#else
    out_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);
#endif
}
`;var XM=`in vec3 position3DHigh;
in vec3 position3DLow;
in vec3 normal;
in vec3 tangent;
in vec3 bitangent;
in vec2 st;
in float batchId;

out vec3 v_positionEC;
out vec3 v_normalEC;
out vec3 v_tangentEC;
out vec3 v_bitangentEC;
out vec2 v_st;

void main()
{
    vec4 p = czm_computePosition();

    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates
    v_normalEC = czm_normal * normal;                         // normal in eye coordinates
    v_tangentEC = czm_normal * tangent;                       // tangent in eye coordinates
    v_bitangentEC = czm_normal * bitangent;                   // bitangent in eye coordinates
    v_st = st;

    gl_Position = czm_modelViewProjectionRelativeToEye * p;
}
`;var KM=`in vec3 v_positionEC;
in vec3 v_normalEC;

void main()
{
    vec3 positionToEyeEC = -v_positionEC;

    vec3 normalEC = normalize(v_normalEC);
#ifdef FACE_FORWARD
    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);
#endif

    czm_materialInput materialInput;
    materialInput.normalEC = normalEC;
    materialInput.positionToEyeEC = positionToEyeEC;
    czm_material material = czm_getMaterial(materialInput);

#ifdef FLAT
    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#else
    out_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);
#endif
}
`;var ZM=`in vec3 position3DHigh;
in vec3 position3DLow;
in vec3 normal;
in float batchId;

out vec3 v_positionEC;
out vec3 v_normalEC;

void main()
{
    vec4 p = czm_computePosition();

    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates
    v_normalEC = czm_normal * normal;                         // normal in eye coordinates

    gl_Position = czm_modelViewProjectionRelativeToEye * p;
}
`;var $M=`in vec3 v_positionEC;
in vec3 v_normalEC;
in vec2 v_st;

void main()
{
    vec3 positionToEyeEC = -v_positionEC;

    vec3 normalEC = normalize(v_normalEC);
#ifdef FACE_FORWARD
    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);
#endif

    czm_materialInput materialInput;
    materialInput.normalEC = normalEC;
    materialInput.positionToEyeEC = positionToEyeEC;
    materialInput.st = v_st;
    czm_material material = czm_getMaterial(materialInput);

#ifdef FLAT
    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#else
    out_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);
#endif
}
`;var QM=`in vec3 position3DHigh;
in vec3 position3DLow;
in vec3 normal;
in vec2 st;
in float batchId;

out vec3 v_positionEC;
out vec3 v_normalEC;
out vec2 v_st;

void main()
{
    vec4 p = czm_computePosition();

    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates
    v_normalEC = czm_normal * normal;                         // normal in eye coordinates
    v_st = st;

    gl_Position = czm_modelViewProjectionRelativeToEye * p;
}
`;var gOe={ADD:te.FUNC_ADD,SUBTRACT:te.FUNC_SUBTRACT,REVERSE_SUBTRACT:te.FUNC_REVERSE_SUBTRACT,MIN:te.MIN,MAX:te.MAX},Xa=Object.freeze(gOe);var yOe={ZERO:te.ZERO,ONE:te.ONE,SOURCE_COLOR:te.SRC_COLOR,ONE_MINUS_SOURCE_COLOR:te.ONE_MINUS_SRC_COLOR,DESTINATION_COLOR:te.DST_COLOR,ONE_MINUS_DESTINATION_COLOR:te.ONE_MINUS_DST_COLOR,SOURCE_ALPHA:te.SRC_ALPHA,ONE_MINUS_SOURCE_ALPHA:te.ONE_MINUS_SRC_ALPHA,DESTINATION_ALPHA:te.DST_ALPHA,ONE_MINUS_DESTINATION_ALPHA:te.ONE_MINUS_DST_ALPHA,CONSTANT_COLOR:te.CONSTANT_COLOR,ONE_MINUS_CONSTANT_COLOR:te.ONE_MINUS_CONSTANT_COLOR,CONSTANT_ALPHA:te.CONSTANT_ALPHA,ONE_MINUS_CONSTANT_ALPHA:te.ONE_MINUS_CONSTANT_ALPHA,SOURCE_ALPHA_SATURATE:te.SRC_ALPHA_SATURATE},Do=Object.freeze(yOe);var xOe={DISABLED:Object.freeze({enabled:!1}),ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:Xa.ADD,equationAlpha:Xa.ADD,functionSourceRgb:Do.SOURCE_ALPHA,functionSourceAlpha:Do.ONE,functionDestinationRgb:Do.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:Do.ONE_MINUS_SOURCE_ALPHA}),PRE_MULTIPLIED_ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:Xa.ADD,equationAlpha:Xa.ADD,functionSourceRgb:Do.ONE,functionSourceAlpha:Do.ONE,functionDestinationRgb:Do.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:Do.ONE_MINUS_SOURCE_ALPHA}),ADDITIVE_BLEND:Object.freeze({enabled:!0,equationRgb:Xa.ADD,equationAlpha:Xa.ADD,functionSourceRgb:Do.SOURCE_ALPHA,functionSourceAlpha:Do.ONE,functionDestinationRgb:Do.ONE,functionDestinationAlpha:Do.ONE})},un=Object.freeze(xOe);var bOe={FRONT:te.FRONT,BACK:te.BACK,FRONT_AND_BACK:te.FRONT_AND_BACK},Ci=Object.freeze(bOe);function RC(e){e=x(e,x.EMPTY_OBJECT),this.material=e.material,this.translucent=x(e.translucent,!0),this._vertexShaderSource=e.vertexShaderSource,this._fragmentShaderSource=e.fragmentShaderSource,this._renderState=e.renderState,this._closed=x(e.closed,!1)}Object.defineProperties(RC.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}}});RC.prototype.getFragmentShaderSource=function(){let e=[];return this.flat&&e.push("#define FLAT"),this.faceForward&&e.push("#define FACE_FORWARD"),u(this.material)&&e.push(this.material.shaderSource),e.push(this.fragmentShaderSource),e.join(`
`)};RC.prototype.isTranslucent=function(){return u(this.material)&&this.material.isTranslucent()||!u(this.material)&&this.translucent};RC.prototype.getRenderState=function(){let e=this.isTranslucent(),t=Ge(this.renderState,!1);return e?(t.depthMask=!1,t.blending=un.ALPHA_BLEND):t.depthMask=!0,t};RC.getDefaultRenderState=function(e,t,n){let i={depthTest:{enabled:!0}};return e&&(i.depthMask=!1,i.blending=un.ALPHA_BLEND),t&&(i.cull={enabled:!0,face:Ci.BACK}),u(n)&&(i=bt(n,i,!0)),i};var so=RC;var JM=`uniform sampler2D image;

czm_material czm_getMaterial(czm_materialInput materialInput)
{
    czm_material material = czm_getDefaultMaterial(materialInput);
    vec4 rampColor = texture(image, vec2(materialInput.aspect / (2.0 * czm_pi), 0.5));
    rampColor = czm_gammaCorrect(rampColor);
    material.diffuse = rampColor.rgb;
    material.alpha = rampColor.a;
    return material;
}
`;var eL=`uniform sampler2D image;
uniform float strength;
uniform vec2 repeat;

czm_material czm_getMaterial(czm_materialInput materialInput)
{
    czm_material material = czm_getDefaultMaterial(materialInput);

    vec2 st = materialInput.st;

    vec2 centerPixel = fract(repeat * st);
    float centerBump = texture(image, centerPixel).channel;

    float imageWidth = float(imageDimensions.x);
    vec2 rightPixel = fract(repeat * (st + vec2(1.0 / imageWidth, 0.0)));
    float rightBump = texture(image, rightPixel).channel;

    float imageHeight = float(imageDimensions.y);
    vec2 leftPixel = fract(repeat * (st + vec2(0.0, 1.0 / imageHeight)));
    float topBump = texture(image, leftPixel).channel;

    vec3 normalTangentSpace = normalize(vec3(centerBump - rightBump, centerBump - topBump, clamp(1.0 - strength, 0.1, 1.0)));
    vec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;

    material.normal = normalEC;
    material.diffuse = vec3(0.01);

    return material;
}
`;var tL=`uniform vec4 lightColor;
uniform vec4 darkColor;
uniform vec2 repeat;

czm_material czm_getMaterial(czm_materialInput materialInput)
{
    czm_material material = czm_getDefaultMaterial(materialInput);

    vec2 st = materialInput.st;

    // From Stefan Gustavson's Procedural Textures in GLSL in OpenGL Insights
    float b = mod(floor(repeat.s * st.s) + floor(repeat.t * st.t), 2.0);  // 0.0 or 1.0

    // Find the distance from the closest separator (region between two colors)
    float scaledWidth = fract(repeat.s * st.s);
    scaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));
    float scaledHeight = fract(repeat.t * st.t);
    scaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));
    float value = min(scaledWidth, scaledHeight);

    vec4 currentColor = mix(lightColor, darkColor, b);
    vec4 color = czm_antialias(lightColor, darkColor, currentColor, value, 0.03);

    color = czm_gammaCorrect(color);
    material.diffuse = color.rgb;
    material.alpha = color.a;

    return material;
}
`;var nL=`uniform vec4 lightColor;
uniform vec4 darkColor;
uniform vec2 repeat;

czm_material czm_getMaterial(czm_materialInput materialInput)
{
    czm_material material = czm_getDefaultMaterial(materialInput);

    // From Stefan Gustavson's Procedural Textures in GLSL in OpenGL Insights
    float b = smoothstep(0.3, 0.32, length(fract(repeat * materialInput.st) - 0.5));  // 0.0 or 1.0

    vec4 color = mix(lightColor, darkColor, b);
    color = czm_gammaCorrect(color);
    material.diffuse = color.rgb;
    material.alpha = color.a;

    return material;
}
`;var iL=`uniform sampler2D heights;
uniform sampler2D colors;

// This material expects heights to be sorted from lowest to highest.

float getHeight(int idx, float invTexSize)
{
    vec2 uv = vec2((float(idx) + 0.5) * invTexSize, 0.5);
#ifdef OES_texture_float
    return texture(heights, uv).x;
#else
    return czm_unpackFloat(texture(heights, uv));
#endif
}

czm_material czm_getMaterial(czm_materialInput materialInput)
{
    czm_material material = czm_getDefaultMaterial(materialInput);

    float height = materialInput.height;
    float invTexSize = 1.0 / float(heightsDimensions.x);

    float minHeight = getHeight(0, invTexSize);
    float maxHeight = getHeight(heightsDimensions.x - 1, invTexSize);

    // early-out when outside the height range
    if (height < minHeight || height > maxHeight) {
        material.diffuse = vec3(0.0);
        material.alpha = 0.0;
        return material;
    }

    // Binary search to find heights above and below.
    int idxBelow = 0;
    int idxAbove = heightsDimensions.x;
    float heightBelow = minHeight;
    float heightAbove = maxHeight;

    // while loop not allowed, so use for loop with max iterations.
    // maxIterations of 16 supports a texture size up to 65536 (2^16).
    const int maxIterations = 16;
    for (int i = 0; i < maxIterations; i++) {
        if (idxBelow >= idxAbove - 1) {
            break;
        }

        int idxMid = (idxBelow + idxAbove) / 2;
        float heightTex = getHeight(idxMid, invTexSize);

        if (height > heightTex) {
            idxBelow = idxMid;
            heightBelow = heightTex;
        } else {
            idxAbove = idxMid;
            heightAbove = heightTex;
        }
    }

    float lerper = heightBelow == heightAbove ? 1.0 : (height - heightBelow) / (heightAbove - heightBelow);
    vec2 colorUv = vec2(invTexSize * (float(idxBelow) + 0.5 + lerper), 0.5);
    vec4 color = texture(colors, colorUv);

    // undo preumultiplied alpha
    if (color.a > 0.0) 
    {
        color.rgb /= color.a;
    }
    
    color.rgb = czm_gammaCorrect(color.rgb);

    material.diffuse = color.rgb;
    material.alpha = color.a;
    return material;
}
`;var oL=`uniform vec4 color;
uniform float spacing;
uniform float width;

czm_material czm_getMaterial(czm_materialInput materialInput)
{
    czm_material material = czm_getDefaultMaterial(materialInput);

    float distanceToContour = mod(materialInput.height, spacing);

#if (__VERSION__ == 300 || defined(GL_OES_standard_derivatives))
    float dxc = abs(dFdx(materialInput.height));
    float dyc = abs(dFdy(materialInput.height));
    float dF = max(dxc, dyc) * czm_pixelRatio * width;
    float alpha = (distanceToContour < dF) ? 1.0 : 0.0;
#else
    // If no derivatives available (IE 10?), use pixel ratio
    float alpha = (distanceToContour < (czm_pixelRatio * width)) ? 1.0 : 0.0;
#endif

    vec4 outColor = czm_gammaCorrect(vec4(color.rgb, alpha * color.a));
    material.diffuse = outColor.rgb;
    material.alpha = outColor.a;

    return material;
}
`;var rL=`uniform sampler2D image;
uniform float minimumHeight;
uniform float maximumHeight;

czm_material czm_getMaterial(czm_materialInput materialInput)
{
    czm_material material = czm_getDefaultMaterial(materialInput);
    float scaledHeight = clamp((materialInput.height - minimumHeight) / (maximumHeight - minimumHeight), 0.0, 1.0);
    vec4 rampColor = texture(image, vec2(scaledHeight, 0.5));
    rampColor = czm_gammaCorrect(rampColor);
    material.diffuse = rampColor.rgb;
    material.alpha = rampColor.a;
    return material;
}
`;var sL=`uniform vec4 fadeInColor;
uniform vec4 fadeOutColor;
uniform float maximumDistance;
uniform bool repeat;
uniform vec2 fadeDirection;
uniform vec2 time;

float getTime(float t, float coord)
{
    float scalar = 1.0 / maximumDistance;
    float q  = distance(t, coord) * scalar;
    if (repeat)
    {
        float r = distance(t, coord + 1.0) * scalar;
        float s = distance(t, coord - 1.0) * scalar;
        q = min(min(r, s), q);
    }
    return clamp(q, 0.0, 1.0);
}

czm_material czm_getMaterial(czm_materialInput materialInput)
{
    czm_material material = czm_getDefaultMaterial(materialInput);

    vec2 st = materialInput.st;
    float s = getTime(time.x, st.s) * fadeDirection.s;
    float t = getTime(time.y, st.t) * fadeDirection.t;

    float u = length(vec2(s, t));
    vec4 color = mix(fadeInColor, fadeOutColor, u);

    color = czm_gammaCorrect(color);
    material.emission = color.rgb;
    material.alpha = color.a;

    return material;
}
`;var aL=`uniform vec4 color;
uniform float cellAlpha;
uniform vec2 lineCount;
uniform vec2 lineThickness;
uniform vec2 lineOffset;

czm_material czm_getMaterial(czm_materialInput materialInput)
{
    czm_material material = czm_getDefaultMaterial(materialInput);

    vec2 st = materialInput.st;

    float scaledWidth = fract(lineCount.s * st.s - lineOffset.s);
    scaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));
    float scaledHeight = fract(lineCount.t * st.t - lineOffset.t);
    scaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));

    float value;

    // Fuzz Factor - Controls blurriness of lines
#if (__VERSION__ == 300 || defined(GL_OES_standard_derivatives))
    const float fuzz = 1.2;
    vec2 thickness = (lineThickness * czm_pixelRatio) - 1.0;

    // From "3D Engine Design for Virtual Globes" by Cozzi and Ring, Listing 4.13.
    vec2 dx = abs(dFdx(st));
    vec2 dy = abs(dFdy(st));
    vec2 dF = vec2(max(dx.s, dy.s), max(dx.t, dy.t)) * lineCount;
    value = min(
        smoothstep(dF.s * thickness.s, dF.s * (fuzz + thickness.s), scaledWidth),
        smoothstep(dF.t * thickness.t, dF.t * (fuzz + thickness.t), scaledHeight));
#else
    // If no derivatives available (IE 10?), revert to view-dependent fuzz
    const float fuzz = 0.05;

    vec2 range = 0.5 - (lineThickness * 0.05);
    value = min(
        1.0 - smoothstep(range.s, range.s + fuzz, scaledWidth),
        1.0 - smoothstep(range.t, range.t + fuzz, scaledHeight));
#endif

    // Edges taken from RimLightingMaterial.glsl
    // See http://www.fundza.com/rman_shaders/surface/fake_rim/fake_rim1.html
    float dRim = 1.0 - abs(dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC)));
    float sRim = smoothstep(0.8, 1.0, dRim);
    value *= (1.0 - sRim);

    vec4 halfColor;
    halfColor.rgb = color.rgb * 0.5;
    halfColor.a = color.a * (1.0 - ((1.0 - cellAlpha) * value));
    halfColor = czm_gammaCorrect(halfColor);
    material.diffuse = halfColor.rgb;
    material.emission = halfColor.rgb;
    material.alpha = halfColor.a;

    return material;
}
`;var cL=`uniform sampler2D image;
uniform float strength;
uniform vec2 repeat;

czm_material czm_getMaterial(czm_materialInput materialInput)
{
    czm_material material = czm_getDefaultMaterial(materialInput);
    
    vec4 textureValue = texture(image, fract(repeat * materialInput.st));
    vec3 normalTangentSpace = textureValue.channels;
    normalTangentSpace.xy = normalTangentSpace.xy * 2.0 - 1.0;
    normalTangentSpace.z = clamp(1.0 - strength, 0.1, 1.0);
    normalTangentSpace = normalize(normalTangentSpace);
    vec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;
    
    material.normal = normalEC;
    
    return material;
}
`;var lL=`uniform vec4 color;

float getPointOnLine(vec2 p0, vec2 p1, float x)
{
    float slope = (p0.y - p1.y) / (p0.x - p1.x);
    return slope * (x - p0.x) + p0.y;
}

czm_material czm_getMaterial(czm_materialInput materialInput)
{
    czm_material material = czm_getDefaultMaterial(materialInput);

    vec2 st = materialInput.st;

#if (__VERSION__ == 300 || defined(GL_OES_standard_derivatives))
    float base = 1.0 - abs(fwidth(st.s)) * 10.0 * czm_pixelRatio;
#else
     // If no derivatives available (IE 10?), 2.5% of the line will be the arrow head
    float base = 0.975;
#endif

    vec2 center = vec2(1.0, 0.5);
    float ptOnUpperLine = getPointOnLine(vec2(base, 1.0), center, st.s);
    float ptOnLowerLine = getPointOnLine(vec2(base, 0.0), center, st.s);

    float halfWidth = 0.15;
    float s = step(0.5 - halfWidth, st.t);
    s *= 1.0 - step(0.5 + halfWidth, st.t);
    s *= 1.0 - step(base, st.s);

    float t = step(base, materialInput.st.s);
    t *= 1.0 - step(ptOnUpperLine, st.t);
    t *= step(ptOnLowerLine, st.t);

    // Find the distance from the closest separator (region between two colors)
    float dist;
    if (st.s < base)
    {
        float d1 = abs(st.t - (0.5 - halfWidth));
        float d2 = abs(st.t - (0.5 + halfWidth));
        dist = min(d1, d2);
    }
    else
    {
        float d1 = czm_infinity;
        if (st.t < 0.5 - halfWidth && st.t > 0.5 + halfWidth)
        {
            d1 = abs(st.s - base);
        }
        float d2 = abs(st.t - ptOnUpperLine);
        float d3 = abs(st.t - ptOnLowerLine);
        dist = min(min(d1, d2), d3);
    }

    vec4 outsideColor = vec4(0.0);
    vec4 currentColor = mix(outsideColor, color, clamp(s + t, 0.0, 1.0));
    vec4 outColor = czm_antialias(outsideColor, color, currentColor, dist);

    outColor = czm_gammaCorrect(outColor);
    material.diffuse = outColor.rgb;
    material.alpha = outColor.a;
    return material;
}
`;var uL=`uniform vec4 color;
uniform vec4 gapColor;
uniform float dashLength;
uniform float dashPattern;
in float v_polylineAngle;

const float maskLength = 16.0;

mat2 rotate(float rad) {
    float c = cos(rad);
    float s = sin(rad);
    return mat2(
        c, s,
        -s, c
    );
}

czm_material czm_getMaterial(czm_materialInput materialInput)
{
    czm_material material = czm_getDefaultMaterial(materialInput);

    vec2 pos = rotate(v_polylineAngle) * gl_FragCoord.xy;

    // Get the relative position within the dash from 0 to 1
    float dashPosition = fract(pos.x / (dashLength * czm_pixelRatio));
    // Figure out the mask index.
    float maskIndex = floor(dashPosition * maskLength);
    // Test the bit mask.
    float maskTest = floor(dashPattern / pow(2.0, maskIndex));
    vec4 fragColor = (mod(maskTest, 2.0) < 1.0) ? gapColor : color;
    if (fragColor.a < 0.005) {   // matches 0/255 and 1/255
        discard;
    }

    fragColor = czm_gammaCorrect(fragColor);
    material.emission = fragColor.rgb;
    material.alpha = fragColor.a;
    return material;
}
`;var fL=`uniform vec4 color;
uniform float glowPower;
uniform float taperPower;

czm_material czm_getMaterial(czm_materialInput materialInput)
{
    czm_material material = czm_getDefaultMaterial(materialInput);

    vec2 st = materialInput.st;
    float glow = glowPower / abs(st.t - 0.5) - (glowPower / 0.5);

    if (taperPower <= 0.99999) {
        glow *= min(1.0, taperPower / (0.5 - st.s * 0.5) - (taperPower / 0.5));
    }

    vec4 fragColor;
    fragColor.rgb = max(vec3(glow - 1.0 + color.rgb), color.rgb);
    fragColor.a = clamp(0.0, 1.0, glow) * color.a;
    fragColor = czm_gammaCorrect(fragColor);

    material.emission = fragColor.rgb;
    material.alpha = fragColor.a;

    return material;
}
`;var dL=`uniform vec4 color;
uniform vec4 outlineColor;
uniform float outlineWidth;

in float v_width;

czm_material czm_getMaterial(czm_materialInput materialInput)
{
    czm_material material = czm_getDefaultMaterial(materialInput);

    vec2 st = materialInput.st;
    float halfInteriorWidth =  0.5 * (v_width - outlineWidth) / v_width;
    float b = step(0.5 - halfInteriorWidth, st.t);
    b *= 1.0 - step(0.5 + halfInteriorWidth, st.t);

    // Find the distance from the closest separator (region between two colors)
    float d1 = abs(st.t - (0.5 - halfInteriorWidth));
    float d2 = abs(st.t - (0.5 + halfInteriorWidth));
    float dist = min(d1, d2);

    vec4 currentColor = mix(outlineColor, color, b);
    vec4 outColor = czm_antialias(outlineColor, color, currentColor, dist);
    outColor = czm_gammaCorrect(outColor);

    material.diffuse = outColor.rgb;
    material.alpha = outColor.a;

    return material;
}
`;var hL=`uniform vec4 color;
uniform vec4 rimColor;
uniform float width;

czm_material czm_getMaterial(czm_materialInput materialInput)
{
    czm_material material = czm_getDefaultMaterial(materialInput);

    // See http://www.fundza.com/rman_shaders/surface/fake_rim/fake_rim1.html
    float d = 1.0 - dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC));
    float s = smoothstep(1.0 - width, 1.0, d);

    vec4 outColor = czm_gammaCorrect(color);
    vec4 outRimColor = czm_gammaCorrect(rimColor);

    material.diffuse = outColor.rgb;
    material.emission = outRimColor.rgb * s;
    material.alpha = mix(outColor.a, outRimColor.a, s);

    return material;
}
`;var mL=`uniform sampler2D image;

czm_material czm_getMaterial(czm_materialInput materialInput)
{
    czm_material material = czm_getDefaultMaterial(materialInput);
    vec4 rampColor = texture(image, vec2(materialInput.slope / (czm_pi / 2.0), 0.5));
    rampColor = czm_gammaCorrect(rampColor);
    material.diffuse = rampColor.rgb;
    material.alpha = rampColor.a;
    return material;
}
`;var pL=`uniform vec4 evenColor;
uniform vec4 oddColor;
uniform float offset;
uniform float repeat;
uniform bool horizontal;

czm_material czm_getMaterial(czm_materialInput materialInput)
{
    czm_material material = czm_getDefaultMaterial(materialInput);

    // Based on the Stripes Fragment Shader in the Orange Book (11.1.2)
    float coord = mix(materialInput.st.s, materialInput.st.t, float(horizontal));
    float value = fract((coord - offset) * (repeat * 0.5));
    float dist = min(value, min(abs(value - 0.5), 1.0 - value));

    vec4 currentColor = mix(evenColor, oddColor, step(0.5, value));
    vec4 color = czm_antialias(evenColor, oddColor, currentColor, dist);
    color = czm_gammaCorrect(color);

    material.diffuse = color.rgb;
    material.alpha = color.a;

    return material;
}
`;var _L=`uniform vec4 waterColor;
uniform vec4 landColor;

czm_material czm_getMaterial(czm_materialInput materialInput)
{
    czm_material material = czm_getDefaultMaterial(materialInput);

    vec4 outColor = mix(landColor, waterColor, materialInput.waterMask);
    outColor = czm_gammaCorrect(outColor);

    material.diffuse = outColor.rgb;
    material.alpha = outColor.a;

    return material;
}
`;var gL=`// Thanks for the contribution Jonas
// http://29a.ch/2012/7/19/webgl-terrain-rendering-water-fog

uniform sampler2D specularMap;
uniform sampler2D normalMap;
uniform vec4 baseWaterColor;
uniform vec4 blendColor;
uniform float frequency;
uniform float animationSpeed;
uniform float amplitude;
uniform float specularIntensity;
uniform float fadeFactor;

czm_material czm_getMaterial(czm_materialInput materialInput)
{
    czm_material material = czm_getDefaultMaterial(materialInput);

    float time = czm_frameNumber * animationSpeed;

    // fade is a function of the distance from the fragment and the frequency of the waves
    float fade = max(1.0, (length(materialInput.positionToEyeEC) / 10000000000.0) * frequency * fadeFactor);

    float specularMapValue = texture(specularMap, materialInput.st).r;

    // note: not using directional motion at this time, just set the angle to 0.0;
    vec4 noise = czm_getWaterNoise(normalMap, materialInput.st * frequency, time, 0.0);
    vec3 normalTangentSpace = noise.xyz * vec3(1.0, 1.0, (1.0 / amplitude));

    // fade out the normal perturbation as we move further from the water surface
    normalTangentSpace.xy /= fade;

    // attempt to fade out the normal perturbation as we approach non water areas (low specular map value)
    normalTangentSpace = mix(vec3(0.0, 0.0, 50.0), normalTangentSpace, specularMapValue);

    normalTangentSpace = normalize(normalTangentSpace);

    // get ratios for alignment of the new normal vector with a vector perpendicular to the tangent plane
    float tsPerturbationRatio = clamp(dot(normalTangentSpace, vec3(0.0, 0.0, 1.0)), 0.0, 1.0);

    // fade out water effect as specular map value decreases
    material.alpha = mix(blendColor.a, baseWaterColor.a, specularMapValue) * specularMapValue;

    // base color is a blend of the water and non-water color based on the value from the specular map
    // may need a uniform blend factor to better control this
    material.diffuse = mix(blendColor.rgb, baseWaterColor.rgb, specularMapValue);

    // diffuse highlights are based on how perturbed the normal is
    material.diffuse += (0.1 * tsPerturbationRatio);

    material.diffuse = material.diffuse;

    material.normal = normalize(materialInput.tangentToEyeMatrix * normalTangentSpace);

    material.specular = specularIntensity;
    material.shininess = 10.0;

    return material;
}
`;function je(e){this.type=void 0,this.shaderSource=void 0,this.materials=void 0,this.uniforms=void 0,this._uniforms=void 0,this.translucent=void 0,this._minificationFilter=x(e.minificationFilter,$t.LINEAR),this._magnificationFilter=x(e.magnificationFilter,mi.LINEAR),this._strict=void 0,this._template=void 0,this._count=void 0,this._texturePaths={},this._loadedImages=[],this._loadedCubeMaps=[],this._textures={},this._updateFunctions=[],this._defaultTexture=void 0,COe(e,this),Object.defineProperties(this,{type:{value:this.type,writable:!1}}),u(je._uniformList[this.type])||(je._uniformList[this.type]=Object.keys(this._uniforms))}je._uniformList={};je.fromType=function(e,t){let n=new je({fabric:{type:e}});if(u(t))for(let i in t)t.hasOwnProperty(i)&&(n.uniforms[i]=t[i]);return n};je.prototype.isTranslucent=function(){if(u(this.translucent))return typeof this.translucent=="function"?this.translucent():this.translucent;let e=!0,t=this._translucentFunctions,n=t.length;for(let i=0;i<n;++i){let o=t[i];if(typeof o=="function"?e=e&&o():e=e&&o,!e)break}return e};je.prototype.update=function(e){this._defaultTexture=e.defaultTexture;let t,n,i=this._loadedImages,o=i.length;for(t=0;t<o;++t){let c=i[t];n=c.id;let l=c.image,f;Array.isArray(l)&&(f=l.slice(1,l.length).map(function(y){return y.bufferView}),l=l[0]);let d=new Qt({minificationFilter:this._minificationFilter,magnificationFilter:this._magnificationFilter}),p;u(l.internalFormat)?p=new Ot({context:e,pixelFormat:l.internalFormat,width:l.width,height:l.height,source:{arrayBufferView:l.bufferView,mipLevels:f},sampler:d}):p=new Ot({context:e,source:l,sampler:d});let g=this._textures[n];u(g)&&g!==this._defaultTexture&&g.destroy(),this._textures[n]=p;let m=`${n}Dimensions`;if(this.uniforms.hasOwnProperty(m)){let y=this.uniforms[m];y.x=p._width,y.y=p._height}}i.length=0;let r=this._loadedCubeMaps;for(o=r.length,t=0;t<o;++t){let c=r[t];n=c.id;let l=c.images,f=new Or({context:e,source:{positiveX:l[0],negativeX:l[1],positiveY:l[2],negativeY:l[3],positiveZ:l[4],negativeZ:l[5]},sampler:new Qt({minificationFilter:this._minificationFilter,magnificationFilter:this._magnificationFilter})});this._textures[n]=f}r.length=0;let s=this._updateFunctions;for(o=s.length,t=0;t<o;++t)s[t](this,e);let a=this.materials;for(let c in a)a.hasOwnProperty(c)&&a[c].update(e)};je.prototype.isDestroyed=function(){return!1};je.prototype.destroy=function(){let e=this._textures;for(let n in e)if(e.hasOwnProperty(n)){let i=e[n];i!==this._defaultTexture&&i.destroy()}let t=this.materials;for(let n in t)t.hasOwnProperty(n)&&t[n].destroy();return ue(this)};function COe(e,t){e=x(e,x.EMPTY_OBJECT),t._strict=x(e.strict,!1),t._count=x(e.count,0),t._template=Ge(x(e.fabric,x.EMPTY_OBJECT)),t._template.uniforms=Ge(x(t._template.uniforms,x.EMPTY_OBJECT)),t._template.materials=Ge(x(t._template.materials,x.EMPTY_OBJECT)),t.type=u(t._template.type)?t._template.type:Hn(),t.shaderSource="",t.materials={},t.uniforms={},t._uniforms={},t._translucentFunctions=[];let n,i=je._materialCache.getMaterial(t.type);if(u(i)){let r=Ge(i.fabric,!0);t._template=bt(t._template,r,!0),n=i.translucent}SOe(t),u(i)||je._materialCache.addMaterial(t.type,t),wOe(t),ROe(t),MOe(t);let o=t._translucentFunctions.length===0?!0:void 0;if(n=x(n,o),n=x(e.translucent,n),u(n))if(typeof n=="function"){let r=function(){return n(t)};t._translucentFunctions.push(r)}else t._translucentFunctions.push(n)}function a9(e,t,n,i){if(u(e)){for(let o in e)if(e.hasOwnProperty(o)){let r=t.indexOf(o)!==-1;(i&&!r||!i&&r)&&n(o,t)}}}function ate(e,t){}function AOe(e,t){}var TOe=["type","materials","uniforms","components","source"],EOe=["diffuse","specular","shininess","normal","emission","alpha"];function SOe(e){let t=e._template,n=t.uniforms,i=t.materials,o=t.components;a9(t,TOe,ate,!0),a9(o,EOe,ate,!0);let r=[];for(let s in i)i.hasOwnProperty(s)&&r.push(s);a9(n,r,AOe,!1)}function vOe(e,t){let n=t._template.materials;for(let i in n)if(n.hasOwnProperty(i)&&e.indexOf(i)>-1)return!0;return!1}function wOe(e){let t=e._template.components,n=e._template.source;if(u(n))e.shaderSource+=`${n}
`;else{if(e.shaderSource+=`czm_material czm_getMaterial(czm_materialInput materialInput)
{
`,e.shaderSource+=`czm_material material = czm_getDefaultMaterial(materialInput);
`,u(t)){let i=Object.keys(e._template.materials).length>0;for(let o in t)if(t.hasOwnProperty(o))if(o==="diffuse"||o==="emission"){let s=i&&vOe(t[o],e)?t[o]:`czm_gammaCorrect(${t[o]})`;e.shaderSource+=`material.${o} = ${s}; 
`}else o==="alpha"?e.shaderSource+=`material.alpha = ${t.alpha}; 
`:e.shaderSource+=`material.${o} = ${t[o]};
`}e.shaderSource+=`return material;
}
`}}var cte={mat2:Hi,mat3:J,mat4:F},DOe=/\.ktx2$/i;function IOe(e){let t;return function(n,i){let o=n.uniforms,r=o[e],s=t!==r,a=!u(r)||r===je.DefaultImageId;t=r;let c=n._textures[e],l,f;if(r instanceof HTMLVideoElement){if(r.readyState>=2){if(s&&u(c)&&(c!==i.defaultTexture&&c.destroy(),c=void 0),!u(c)||c===i.defaultTexture){let p=new Qt({minificationFilter:n._minificationFilter,magnificationFilter:n._magnificationFilter});c=new Ot({context:i,source:r,sampler:p}),n._textures[e]=c;return}c.copyFrom({source:r})}else u(c)||(n._textures[e]=i.defaultTexture);return}if(r instanceof Ot&&r!==c){n._texturePaths[e]=void 0;let p=n._textures[e];u(p)&&p!==n._defaultTexture&&p.destroy(),n._textures[e]=r,l=`${e}Dimensions`,o.hasOwnProperty(l)&&(f=o[l],f.x=r._width,f.y=r._height);return}if(s&&u(c)&&a&&(c!==n._defaultTexture&&c.destroy(),c=void 0),u(c)||(n._texturePaths[e]=void 0,c=n._textures[e]=n._defaultTexture,l=`${e}Dimensions`,o.hasOwnProperty(l)&&(f=o[l],f.x=c._width,f.y=c._height)),a)return;let d=r instanceof De;if(!u(n._texturePaths[e])||d&&r.url!==n._texturePaths[e].url||!d&&r!==n._texturePaths[e]){if(typeof r=="string"||d){let p=d?r:De.createIfNeeded(r),g;DOe.test(p.url)?g=jl(p.url):g=p.fetchImage(),Promise.resolve(g).then(function(m){n._loadedImages.push({id:e,image:m})}).catch(function(){u(c)&&c!==n._defaultTexture&&c.destroy(),n._textures[e]=n._defaultTexture})}else(r instanceof HTMLCanvasElement||r instanceof HTMLImageElement)&&n._loadedImages.push({id:e,image:r});n._texturePaths[e]=r}}}function POe(e){return function(t,n){let i=t.uniforms[e];if(i instanceof Or){let r=t._textures[e];r!==t._defaultTexture&&r.destroy(),t._texturePaths[e]=void 0,t._textures[e]=i;return}if(u(t._textures[e])||(t._texturePaths[e]=void 0,t._textures[e]=n.defaultCubeMap),i===je.DefaultCubeMapId)return;let o=i.positiveX+i.negativeX+i.positiveY+i.negativeY+i.positiveZ+i.negativeZ;if(o!==t._texturePaths[e]){let r=[De.createIfNeeded(i.positiveX).fetchImage(),De.createIfNeeded(i.negativeX).fetchImage(),De.createIfNeeded(i.positiveY).fetchImage(),De.createIfNeeded(i.negativeY).fetchImage(),De.createIfNeeded(i.positiveZ).fetchImage(),De.createIfNeeded(i.negativeZ).fetchImage()];Promise.all(r).then(function(s){t._loadedCubeMaps.push({id:e,images:s})}),t._texturePaths[e]=o}}}function ROe(e){let t=e._template.uniforms;for(let n in t)t.hasOwnProperty(n)&&lte(e,n)}function lte(e,t){let n=e._strict,i=e._template.uniforms,o=i[t],r=OOe(o),s;if(r==="channels")s=iv(e,t,o,!1);else{if(r==="sampler2D"){let l=`${t}Dimensions`;LOe(e,l)>0&&(i[l]={type:"ivec3",x:1,y:1},lte(e,l))}if(!new RegExp(`uniform\\s+${r}\\s+${t}\\s*;`).test(e.shaderSource)){let l=`uniform ${r} ${t};`;e.shaderSource=l+e.shaderSource}let c=`${t}_${e._count++}`;if(s=iv(e,t,c),e.uniforms[t]=o,r==="sampler2D")e._uniforms[c]=function(){return e._textures[t]},e._updateFunctions.push(IOe(t));else if(r==="samplerCube")e._uniforms[c]=function(){return e._textures[t]},e._updateFunctions.push(POe(t));else if(r.indexOf("mat")!==-1){let l=new cte[r];e._uniforms[c]=function(){return cte[r].fromColumnMajorArray(e.uniforms[t],l)}}else e._uniforms[c]=function(){return e.uniforms[t]}}}function OOe(e){let t=e.type;if(!u(t)){let n=typeof e;if(n==="number")t="float";else if(n==="boolean")t="bool";else if(n==="string"||e instanceof De||e instanceof HTMLCanvasElement||e instanceof HTMLImageElement)/^([rgba]){1,4}$/i.test(e)?t="channels":e===je.DefaultCubeMapId?t="samplerCube":t="sampler2D";else if(n==="object")if(Array.isArray(e))(e.length===4||e.length===9||e.length===16)&&(t=`mat${Math.sqrt(e.length)}`);else{let i=0;for(let o in e)e.hasOwnProperty(o)&&(i+=1);i>=2&&i<=4?t=`vec${i}`:i===6&&(t="samplerCube")}}return t}function MOe(e){let t=e._strict,n=e._template.materials;for(let i in n)if(n.hasOwnProperty(i)){let o=new je({strict:t,fabric:n[i],count:e._count});e._count=o._count,e._uniforms=bt(e._uniforms,o._uniforms,!0),e.materials[i]=o,e._translucentFunctions=e._translucentFunctions.concat(o._translucentFunctions);let r="czm_getMaterial",s=`${r}_${e._count++}`;iv(o,r,s),e.shaderSource=o.shaderSource+e.shaderSource;let a=`${s}(materialInput)`,c=iv(e,i,a)}}function iv(e,t,n,i){i=x(i,!0);let o=0,r="([\\w])?",s=`([\\w${i?".":""}])?`,a=new RegExp(s+t+r,"g");return e.shaderSource=e.shaderSource.replace(a,function(c,l,f){return l||f?c:(o+=1,n)}),o}function LOe(e,t,n){return iv(e,t,t,n)}je._materialCache={_materials:{},addMaterial:function(e,t){this._materials[e]=t},getMaterial:function(e){return this._materials[e]}};je.DefaultImageId="czm_defaultImage";je.DefaultCubeMapId="czm_defaultCubeMap";je.ColorType="Color";je._materialCache.addMaterial(je.ColorType,{fabric:{type:je.ColorType,uniforms:{color:new G(1,0,0,.5)},components:{diffuse:"color.rgb",alpha:"color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}});je.ImageType="Image";je._materialCache.addMaterial(je.ImageType,{fabric:{type:je.ImageType,uniforms:{image:je.DefaultImageId,repeat:new H(1,1),color:new G(1,1,1,1)},components:{diffuse:"texture(image, fract(repeat * materialInput.st)).rgb * color.rgb",alpha:"texture(image, fract(repeat * materialInput.st)).a * color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}});je.DiffuseMapType="DiffuseMap";je._materialCache.addMaterial(je.DiffuseMapType,{fabric:{type:je.DiffuseMapType,uniforms:{image:je.DefaultImageId,channels:"rgb",repeat:new H(1,1)},components:{diffuse:"texture(image, fract(repeat * materialInput.st)).channels"}},translucent:!1});je.AlphaMapType="AlphaMap";je._materialCache.addMaterial(je.AlphaMapType,{fabric:{type:je.AlphaMapType,uniforms:{image:je.DefaultImageId,channel:"a",repeat:new H(1,1)},components:{alpha:"texture(image, fract(repeat * materialInput.st)).channel"}},translucent:!0});je.SpecularMapType="SpecularMap";je._materialCache.addMaterial(je.SpecularMapType,{fabric:{type:je.SpecularMapType,uniforms:{image:je.DefaultImageId,channel:"r",repeat:new H(1,1)},components:{specular:"texture(image, fract(repeat * materialInput.st)).channel"}},translucent:!1});je.EmissionMapType="EmissionMap";je._materialCache.addMaterial(je.EmissionMapType,{fabric:{type:je.EmissionMapType,uniforms:{image:je.DefaultImageId,channels:"rgb",repeat:new H(1,1)},components:{emission:"texture(image, fract(repeat * materialInput.st)).channels"}},translucent:!1});je.BumpMapType="BumpMap";je._materialCache.addMaterial(je.BumpMapType,{fabric:{type:je.BumpMapType,uniforms:{image:je.DefaultImageId,channel:"r",strength:.8,repeat:new H(1,1)},source:eL},translucent:!1});je.NormalMapType="NormalMap";je._materialCache.addMaterial(je.NormalMapType,{fabric:{type:je.NormalMapType,uniforms:{image:je.DefaultImageId,channels:"rgb",strength:.8,repeat:new H(1,1)},source:cL},translucent:!1});je.GridType="Grid";je._materialCache.addMaterial(je.GridType,{fabric:{type:je.GridType,uniforms:{color:new G(0,1,0,1),cellAlpha:.1,lineCount:new H(8,8),lineThickness:new H(1,1),lineOffset:new H(0,0)},source:aL},translucent:function(e){let t=e.uniforms;return t.color.alpha<1||t.cellAlpha<1}});je.StripeType="Stripe";je._materialCache.addMaterial(je.StripeType,{fabric:{type:je.StripeType,uniforms:{horizontal:!0,evenColor:new G(1,1,1,.5),oddColor:new G(0,0,1,.5),offset:0,repeat:5},source:pL},translucent:function(e){let t=e.uniforms;return t.evenColor.alpha<1||t.oddColor.alpha<1}});je.CheckerboardType="Checkerboard";je._materialCache.addMaterial(je.CheckerboardType,{fabric:{type:je.CheckerboardType,uniforms:{lightColor:new G(1,1,1,.5),darkColor:new G(0,0,0,.5),repeat:new H(5,5)},source:tL},translucent:function(e){let t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}});je.DotType="Dot";je._materialCache.addMaterial(je.DotType,{fabric:{type:je.DotType,uniforms:{lightColor:new G(1,1,0,.75),darkColor:new G(0,1,1,.75),repeat:new H(5,5)},source:nL},translucent:function(e){let t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}});je.WaterType="Water";je._materialCache.addMaterial(je.WaterType,{fabric:{type:je.WaterType,uniforms:{baseWaterColor:new G(.2,.3,.6,1),blendColor:new G(0,1,.699,1),specularMap:je.DefaultImageId,normalMap:je.DefaultImageId,frequency:10,animationSpeed:.01,amplitude:1,specularIntensity:.5,fadeFactor:1},source:gL},translucent:function(e){let t=e.uniforms;return t.baseWaterColor.alpha<1||t.blendColor.alpha<1}});je.RimLightingType="RimLighting";je._materialCache.addMaterial(je.RimLightingType,{fabric:{type:je.RimLightingType,uniforms:{color:new G(1,0,0,.7),rimColor:new G(1,1,1,.4),width:.3},source:hL},translucent:function(e){let t=e.uniforms;return t.color.alpha<1||t.rimColor.alpha<1}});je.FadeType="Fade";je._materialCache.addMaterial(je.FadeType,{fabric:{type:je.FadeType,uniforms:{fadeInColor:new G(1,0,0,1),fadeOutColor:new G(0,0,0,0),maximumDistance:.5,repeat:!0,fadeDirection:{x:!0,y:!0},time:new H(.5,.5)},source:sL},translucent:function(e){let t=e.uniforms;return t.fadeInColor.alpha<1||t.fadeOutColor.alpha<1}});je.PolylineArrowType="PolylineArrow";je._materialCache.addMaterial(je.PolylineArrowType,{fabric:{type:je.PolylineArrowType,uniforms:{color:new G(1,1,1,1)},source:lL},translucent:!0});je.PolylineDashType="PolylineDash";je._materialCache.addMaterial(je.PolylineDashType,{fabric:{type:je.PolylineDashType,uniforms:{color:new G(1,0,1,1),gapColor:new G(0,0,0,0),dashLength:16,dashPattern:255},source:uL},translucent:!0});je.PolylineGlowType="PolylineGlow";je._materialCache.addMaterial(je.PolylineGlowType,{fabric:{type:je.PolylineGlowType,uniforms:{color:new G(0,.5,1,1),glowPower:.25,taperPower:1},source:fL},translucent:!0});je.PolylineOutlineType="PolylineOutline";je._materialCache.addMaterial(je.PolylineOutlineType,{fabric:{type:je.PolylineOutlineType,uniforms:{color:new G(1,1,1,1),outlineColor:new G(1,0,0,1),outlineWidth:1},source:dL},translucent:function(e){let t=e.uniforms;return t.color.alpha<1||t.outlineColor.alpha<1}});je.ElevationContourType="ElevationContour";je._materialCache.addMaterial(je.ElevationContourType,{fabric:{type:je.ElevationContourType,uniforms:{spacing:100,color:new G(1,0,0,1),width:1},source:oL},translucent:!1});je.ElevationRampType="ElevationRamp";je._materialCache.addMaterial(je.ElevationRampType,{fabric:{type:je.ElevationRampType,uniforms:{image:je.DefaultImageId,minimumHeight:0,maximumHeight:1e4},source:rL},translucent:!1});je.SlopeRampMaterialType="SlopeRamp";je._materialCache.addMaterial(je.SlopeRampMaterialType,{fabric:{type:je.SlopeRampMaterialType,uniforms:{image:je.DefaultImageId},source:mL},translucent:!1});je.AspectRampMaterialType="AspectRamp";je._materialCache.addMaterial(je.AspectRampMaterialType,{fabric:{type:je.AspectRampMaterialType,uniforms:{image:je.DefaultImageId},source:JM},translucent:!1});je.ElevationBandType="ElevationBand";je._materialCache.addMaterial(je.ElevationBandType,{fabric:{type:je.ElevationBandType,uniforms:{heights:je.DefaultImageId,colors:je.DefaultImageId},source:iL},translucent:!0});je.WaterMaskType="WaterMask";je._materialCache.addMaterial(je.WaterMaskType,{fabric:{type:je.WaterMaskType,source:_L,uniforms:{waterColor:new G(1,1,1,1),landColor:new G(0,0,0,0)}},translucent:!1});var Zi=je;function ky(e){e=x(e,x.EMPTY_OBJECT);let t=x(e.translucent,!0),n=x(e.closed,!1),i=x(e.materialSupport,ky.MaterialSupport.TEXTURED);this.material=u(e.material)?e.material:Zi.fromType(Zi.ColorType),this.translucent=t,this._vertexShaderSource=x(e.vertexShaderSource,i.vertexShaderSource),this._fragmentShaderSource=x(e.fragmentShaderSource,i.fragmentShaderSource),this._renderState=so.getDefaultRenderState(t,n,e.renderState),this._closed=n,this._materialSupport=i,this._vertexFormat=i.vertexFormat,this._flat=x(e.flat,!1),this._faceForward=x(e.faceForward,!n)}Object.defineProperties(ky.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},materialSupport:{get:function(){return this._materialSupport}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}});ky.prototype.getFragmentShaderSource=so.prototype.getFragmentShaderSource;ky.prototype.isTranslucent=so.prototype.isTranslucent;ky.prototype.getRenderState=so.prototype.getRenderState;ky.MaterialSupport={BASIC:Object.freeze({vertexFormat:Ie.POSITION_AND_NORMAL,vertexShaderSource:ZM,fragmentShaderSource:KM}),TEXTURED:Object.freeze({vertexFormat:Ie.POSITION_NORMAL_AND_ST,vertexShaderSource:QM,fragmentShaderSource:$M}),ALL:Object.freeze({vertexFormat:Ie.ALL,vertexShaderSource:XM,fragmentShaderSource:YM})};var ho=ky;var yL=`in vec3 v_positionEC;
in vec3 v_normalEC;
in vec4 v_color;

void main()
{
    vec3 positionToEyeEC = -v_positionEC;

    vec3 normalEC = normalize(v_normalEC);
#ifdef FACE_FORWARD
    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);
#endif

    vec4 color = czm_gammaCorrect(v_color);

    czm_materialInput materialInput;
    materialInput.normalEC = normalEC;
    materialInput.positionToEyeEC = positionToEyeEC;
    czm_material material = czm_getDefaultMaterial(materialInput);
    material.diffuse = color.rgb;
    material.alpha = color.a;

    out_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);
}
`;var xL=`in vec3 position3DHigh;
in vec3 position3DLow;
in vec3 normal;
in vec4 color;
in float batchId;

out vec3 v_positionEC;
out vec3 v_normalEC;
out vec4 v_color;

void main()
{
    vec4 p = czm_computePosition();

    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates
    v_normalEC = czm_normal * normal;                         // normal in eye coordinates
    v_color = color;

    gl_Position = czm_modelViewProjectionRelativeToEye * p;
}
`;var OC=`in vec4 v_color;

void main()
{
    out_FragColor = czm_gammaCorrect(v_color);
}
`;var bL=`in vec3 position3DHigh;
in vec3 position3DLow;
in vec4 color;
in float batchId;

out vec4 v_color;

void main()
{
    vec4 p = czm_computePosition();

    v_color = color;

    gl_Position = czm_modelViewProjectionRelativeToEye * p;
}
`;function rp(e){e=x(e,x.EMPTY_OBJECT);let t=x(e.translucent,!0),n=x(e.closed,!1),i=x(e.flat,!1),o=i?bL:xL,r=i?OC:yL,s=i?rp.FLAT_VERTEX_FORMAT:rp.VERTEX_FORMAT;this.material=void 0,this.translucent=t,this._vertexShaderSource=x(e.vertexShaderSource,o),this._fragmentShaderSource=x(e.fragmentShaderSource,r),this._renderState=so.getDefaultRenderState(t,n,e.renderState),this._closed=n,this._vertexFormat=s,this._flat=i,this._faceForward=x(e.faceForward,!n)}Object.defineProperties(rp.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}});rp.VERTEX_FORMAT=Ie.POSITION_AND_NORMAL;rp.FLAT_VERTEX_FORMAT=Ie.POSITION_ONLY;rp.prototype.getFragmentShaderSource=so.prototype.getFragmentShaderSource;rp.prototype.isTranslucent=so.prototype.isTranslucent;rp.prototype.getRenderState=so.prototype.getRenderState;var ln=rp;function MC(e){this._definitionChanged=new me,this._color=void 0,this._colorSubscription=void 0,this.color=e}Object.defineProperties(MC.prototype,{isConstant:{get:function(){return Y.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:le("color")});MC.prototype.getType=function(e){return"Color"};var NOe=new $;MC.prototype.getValue=function(e,t){return u(e)||(e=$.now(NOe)),u(t)||(t={}),t.color=Y.getValueOrClonedDefault(this._color,e,G.WHITE,t.color),t};MC.prototype.equals=function(e){return this===e||e instanceof MC&&Y.equals(this._color,e._color)};var Ht=MC;function q_(e){e=x(e,x.EMPTY_OBJECT),this._ellipsoid=x(e.ellipsoid,ee.default),this._rectangle=x(e.rectangle,se.MAX_VALUE),this._projection=new Oi(this._ellipsoid),this._numberOfLevelZeroTilesX=x(e.numberOfLevelZeroTilesX,2),this._numberOfLevelZeroTilesY=x(e.numberOfLevelZeroTilesY,1)}Object.defineProperties(q_.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}});q_.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e};q_.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e};q_.prototype.rectangleToNativeRectangle=function(e,t){let n=R.toDegrees(e.west),i=R.toDegrees(e.south),o=R.toDegrees(e.east),r=R.toDegrees(e.north);return u(t)?(t.west=n,t.south=i,t.east=o,t.north=r,t):new se(n,i,o,r)};q_.prototype.tileXYToNativeRectangle=function(e,t,n,i){let o=this.tileXYToRectangle(e,t,n,i);return o.west=R.toDegrees(o.west),o.south=R.toDegrees(o.south),o.east=R.toDegrees(o.east),o.north=R.toDegrees(o.north),o};q_.prototype.tileXYToRectangle=function(e,t,n,i){let o=this._rectangle,r=this.getNumberOfXTilesAtLevel(n),s=this.getNumberOfYTilesAtLevel(n),a=o.width/r,c=e*a+o.west,l=(e+1)*a+o.west,f=o.height/s,d=o.north-t*f,p=o.north-(t+1)*f;return u(i)||(i=new se(c,p,l,d)),i.west=c,i.south=p,i.east=l,i.north=d,i};q_.prototype.positionToTileXY=function(e,t,n){let i=this._rectangle;if(!se.contains(i,e))return;let o=this.getNumberOfXTilesAtLevel(t),r=this.getNumberOfYTilesAtLevel(t),s=i.width/o,a=i.height/r,c=e.longitude;i.east<i.west&&(c+=R.TWO_PI);let l=(c-i.west)/s|0;l>=o&&(l=o-1);let f=(i.north-e.latitude)/a|0;return f>=r&&(f=r-1),u(n)?(n.x=l,n.y=f,n):new H(l,f)};var $i=q_;var ute=new h,fte=new h,dte=new de,c9=new h,FOe=new h,hte=new ae,BOe=new $i,ov=[new de,new de,new de,new de],rv=new H,jr={};jr.initialize=function(){let e=jr._initPromise;return u(e)||(e=De.fetchJson(on("Assets/approximateTerrainHeights.json")).then(function(t){jr._terrainHeights=t}),jr._initPromise=e),e};jr.getMinimumMaximumHeights=function(e,t){t=x(t,ee.default);let n=mte(e),i=jr._defaultMinTerrainHeight,o=jr._defaultMaxTerrainHeight;if(u(n)){let r=`${n.level}-${n.x}-${n.y}`,s=jr._terrainHeights[r];u(s)&&(i=s[0],o=s[1]),t.cartographicToCartesian(se.northeast(e,dte),ute),t.cartographicToCartesian(se.southwest(e,dte),fte),h.midpoint(fte,ute,c9);let a=t.scaleToGeodeticSurface(c9,FOe);if(u(a)){let c=h.distance(c9,a);i=Math.min(i,-c)}else i=jr._defaultMinTerrainHeight}return i=Math.max(jr._defaultMinTerrainHeight,i),{minimumTerrainHeight:i,maximumTerrainHeight:o}};jr.getBoundingSphere=function(e,t){t=x(t,ee.default);let n=mte(e),i=jr._defaultMaxTerrainHeight;if(u(n)){let r=`${n.level}-${n.x}-${n.y}`,s=jr._terrainHeights[r];u(s)&&(i=s[1])}let o=ae.fromRectangle3D(e,t,0);return ae.fromRectangle3D(e,t,i,hte),ae.union(o,hte,o)};function mte(e){de.fromRadians(e.east,e.north,0,ov[0]),de.fromRadians(e.west,e.north,0,ov[1]),de.fromRadians(e.east,e.south,0,ov[2]),de.fromRadians(e.west,e.south,0,ov[3]);let t=0,n=0,i=0,o=0,r=jr._terrainHeightsMaxLevel,s;for(s=0;s<=r;++s){let a=!1;for(let c=0;c<4;++c){let l=ov[c];if(BOe.positionToTileXY(l,s,rv),c===0)i=rv.x,o=rv.y;else if(i!==rv.x||o!==rv.y){a=!0;break}}if(a)break;t=i,n=o}if(s!==0)return{x:t,y:n,level:s>r?r:s-1}}jr._terrainHeightsMaxLevel=6;jr._defaultMaxTerrainHeight=9e3;jr._defaultMinTerrainHeight=-1e5;jr._terrainHeights=void 0;jr._initPromise=void 0;Object.defineProperties(jr,{initialized:{get:function(){return u(jr._terrainHeights)}}});var di=jr;function vc(e,t,n){this.minimum=h.clone(x(e,h.ZERO)),this.maximum=h.clone(x(t,h.ZERO)),u(n)?n=h.clone(n):n=h.midpoint(this.minimum,this.maximum,new h),this.center=n}vc.fromCorners=function(e,t,n){return u(n)||(n=new vc),n.minimum=h.clone(e,n.minimum),n.maximum=h.clone(t,n.maximum),n.center=h.midpoint(e,t,n.center),n};vc.fromPoints=function(e,t){if(u(t)||(t=new vc),!u(e)||e.length===0)return t.minimum=h.clone(h.ZERO,t.minimum),t.maximum=h.clone(h.ZERO,t.maximum),t.center=h.clone(h.ZERO,t.center),t;let n=e[0].x,i=e[0].y,o=e[0].z,r=e[0].x,s=e[0].y,a=e[0].z,c=e.length;for(let d=1;d<c;d++){let p=e[d],g=p.x,m=p.y,y=p.z;n=Math.min(g,n),r=Math.max(g,r),i=Math.min(m,i),s=Math.max(m,s),o=Math.min(y,o),a=Math.max(y,a)}let l=t.minimum;l.x=n,l.y=i,l.z=o;let f=t.maximum;return f.x=r,f.y=s,f.z=a,t.center=h.midpoint(l,f,t.center),t};vc.clone=function(e,t){if(u(e))return u(t)?(t.minimum=h.clone(e.minimum,t.minimum),t.maximum=h.clone(e.maximum,t.maximum),t.center=h.clone(e.center,t.center),t):new vc(e.minimum,e.maximum,e.center)};vc.equals=function(e,t){return e===t||u(e)&&u(t)&&h.equals(e.center,t.center)&&h.equals(e.minimum,t.minimum)&&h.equals(e.maximum,t.maximum)};var CL=new h;vc.intersectPlane=function(e,t){CL=h.subtract(e.maximum,e.minimum,CL);let n=h.multiplyByScalar(CL,.5,CL),i=t.normal,o=n.x*Math.abs(i.x)+n.y*Math.abs(i.y)+n.z*Math.abs(i.z),r=h.dot(e.center,i)+t.distance;return r-o>0?qt.INSIDE:r+o<0?qt.OUTSIDE:qt.INTERSECTING};vc.prototype.clone=function(e){return vc.clone(this,e)};vc.prototype.intersectPlane=function(e){return vc.intersectPlane(this,e)};vc.prototype.equals=function(e){return vc.equals(this,e)};var Vy=vc;var l9=new oe;function Ph(e,t){t=x(t,ee.default),e=t.scaleToGeodeticSurface(e);let n=Lt.eastNorthUpToFixedFrame(e,t);this._ellipsoid=t,this._origin=e,this._xAxis=h.fromCartesian4(F.getColumn(n,0,l9)),this._yAxis=h.fromCartesian4(F.getColumn(n,1,l9));let i=h.fromCartesian4(F.getColumn(n,2,l9));this._plane=cn.fromPointNormal(e,i)}Object.defineProperties(Ph.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});var kOe=new Vy;Ph.fromPoints=function(e,t){let n=Vy.fromPoints(e,kOe);return new Ph(n.center,t)};var pte=new _n,AL=new h;Ph.prototype.projectPointOntoPlane=function(e,t){let n=pte;n.origin=e,h.normalize(e,n.direction);let i=Qn.rayPlane(n,this._plane,AL);if(u(i)||(h.negate(n.direction,n.direction),i=Qn.rayPlane(n,this._plane,AL)),u(i)){let o=h.subtract(i,this._origin,i),r=h.dot(this._xAxis,o),s=h.dot(this._yAxis,o);return u(t)?(t.x=r,t.y=s,t):new H(r,s)}};Ph.prototype.projectPointsOntoPlane=function(e,t){u(t)||(t=[]);let n=0,i=e.length;for(let o=0;o<i;o++){let r=this.projectPointOntoPlane(e[o],t[n]);u(r)&&(t[n]=r,n++)}return t.length=n,t};Ph.prototype.projectPointToNearestOnPlane=function(e,t){u(t)||(t=new H);let n=pte;n.origin=e,h.clone(this._plane.normal,n.direction);let i=Qn.rayPlane(n,this._plane,AL);u(i)||(h.negate(n.direction,n.direction),i=Qn.rayPlane(n,this._plane,AL));let o=h.subtract(i,this._origin,i),r=h.dot(this._xAxis,o),s=h.dot(this._yAxis,o);return t.x=r,t.y=s,t};Ph.prototype.projectPointsToNearestOnPlane=function(e,t){u(t)||(t=[]);let n=e.length;t.length=n;for(let i=0;i<n;i++)t[i]=this.projectPointToNearestOnPlane(e[i],t[i]);return t};var VOe=new h;Ph.prototype.projectPointOntoEllipsoid=function(e,t){u(t)||(t=new h);let n=this._ellipsoid,i=this._origin,o=this._xAxis,r=this._yAxis,s=VOe;return h.multiplyByScalar(o,e.x,s),t=h.add(i,s,t),h.multiplyByScalar(r,e.y,s),h.add(t,s,t),n.scaleToGeocentricSurface(t,t),t};Ph.prototype.projectPointsOntoEllipsoid=function(e,t){let n=e.length;u(t)?t.length=n:t=new Array(n);for(let i=0;i<n;++i)t[i]=this.projectPointOntoEllipsoid(e[i],t[i]);return t};var os=Ph;function Mi(e,t){this.center=h.clone(x(e,h.ZERO)),this.halfAxes=J.clone(x(t,J.ZERO))}Mi.packedLength=h.packedLength+J.packedLength;Mi.pack=function(e,t,n){return n=x(n,0),h.pack(e.center,t,n),J.pack(e.halfAxes,t,n+h.packedLength),t};Mi.unpack=function(e,t,n){return t=x(t,0),u(n)||(n=new Mi),h.unpack(e,t,n.center),J.unpack(e,t+h.packedLength,n.halfAxes),n};var UOe=new h,zOe=new h,HOe=new h,GOe=new h,WOe=new h,jOe=new h,qOe=new J,YOe={unitary:new J,diagonal:new J};Mi.fromPoints=function(e,t){if(u(t)||(t=new Mi),!u(e)||e.length===0)return t.halfAxes=J.ZERO,t.center=h.ZERO,t;let n,i=e.length,o=h.clone(e[0],UOe);for(n=1;n<i;n++)h.add(o,e[n],o);let r=1/i;h.multiplyByScalar(o,r,o);let s=0,a=0,c=0,l=0,f=0,d=0,p;for(n=0;n<i;n++)p=h.subtract(e[n],o,zOe),s+=p.x*p.x,a+=p.x*p.y,c+=p.x*p.z,l+=p.y*p.y,f+=p.y*p.z,d+=p.z*p.z;s*=r,a*=r,c*=r,l*=r,f*=r,d*=r;let g=qOe;g[0]=s,g[1]=a,g[2]=c,g[3]=a,g[4]=l,g[5]=f,g[6]=c,g[7]=f,g[8]=d;let m=J.computeEigenDecomposition(g,YOe),y=J.clone(m.unitary,t.halfAxes),b=J.getColumn(y,0,GOe),C=J.getColumn(y,1,WOe),A=J.getColumn(y,2,jOe),T=-Number.MAX_VALUE,E=-Number.MAX_VALUE,v=-Number.MAX_VALUE,D=Number.MAX_VALUE,O=Number.MAX_VALUE,P=Number.MAX_VALUE;for(n=0;n<i;n++)p=e[n],T=Math.max(h.dot(b,p),T),E=Math.max(h.dot(C,p),E),v=Math.max(h.dot(A,p),v),D=Math.min(h.dot(b,p),D),O=Math.min(h.dot(C,p),O),P=Math.min(h.dot(A,p),P);b=h.multiplyByScalar(b,.5*(D+T),b),C=h.multiplyByScalar(C,.5*(O+E),C),A=h.multiplyByScalar(A,.5*(P+v),A);let M=h.add(b,C,t.center);h.add(M,A,M);let L=HOe;return L.x=T-D,L.y=E-O,L.z=v-P,h.multiplyByScalar(L,.5,L),J.multiplyByScale(t.halfAxes,L,t.halfAxes),t};var Cte=new h,XOe=new h;function _te(e,t,n,i,o,r,s,a,c,l,f){u(f)||(f=new Mi);let d=f.halfAxes;J.setColumn(d,0,t,d),J.setColumn(d,1,n,d),J.setColumn(d,2,i,d);let p=Cte;p.x=(o+r)/2,p.y=(s+a)/2,p.z=(c+l)/2;let g=XOe;g.x=(r-o)/2,g.y=(a-s)/2,g.z=(l-c)/2;let m=f.center;return p=J.multiplyByVector(d,p,p),h.add(e,p,m),J.multiplyByScale(d,g,d),f}var gte=new de,KOe=new h,ZOe=new de,$Oe=new de,QOe=new de,JOe=new de,eMe=new de,tMe=new h,yte=new h,nMe=new h,xte=new h,iMe=new h,oMe=new H,rMe=new H,sMe=new H,aMe=new H,cMe=new H,lMe=new h,uMe=new h,fMe=new h,dMe=new h,hMe=new H,mMe=new h,pMe=new h,_Me=new h,gMe=new cn(h.UNIT_X,0);Mi.fromRectangle=function(e,t,n,i,o){t=x(t,0),n=x(n,0),i=x(i,ee.default);let r,s,a,c,l,f,d;if(e.width<=R.PI){let O=se.center(e,gte),P=i.cartographicToCartesian(O,KOe),M=new os(P,i);d=M.plane;let L=O.longitude,_=e.south<0&&e.north>0?0:O.latitude,S=de.fromRadians(L,e.north,n,ZOe),w=de.fromRadians(e.west,e.north,n,$Oe),I=de.fromRadians(e.west,_,n,QOe),N=de.fromRadians(e.west,e.south,n,JOe),k=de.fromRadians(L,e.south,n,eMe),z=i.cartographicToCartesian(S,tMe),V=i.cartographicToCartesian(w,yte),U=i.cartographicToCartesian(I,nMe),B=i.cartographicToCartesian(N,xte),W=i.cartographicToCartesian(k,iMe),j=M.projectPointToNearestOnPlane(z,oMe),Q=M.projectPointToNearestOnPlane(V,rMe),q=M.projectPointToNearestOnPlane(U,sMe),X=M.projectPointToNearestOnPlane(B,aMe),Z=M.projectPointToNearestOnPlane(W,cMe);return r=Math.min(Q.x,q.x,X.x),s=-r,c=Math.max(Q.y,j.y),a=Math.min(X.y,Z.y),w.height=N.height=t,V=i.cartographicToCartesian(w,yte),B=i.cartographicToCartesian(N,xte),l=Math.min(cn.getPointDistance(d,V),cn.getPointDistance(d,B)),f=n,_te(M.origin,M.xAxis,M.yAxis,M.zAxis,r,s,a,c,l,f,o)}let p=e.south>0,g=e.north<0,m=p?e.south:g?e.north:0,y=se.center(e,gte).longitude,b=h.fromRadians(y,m,n,i,lMe);b.z=0;let A=Math.abs(b.x)<R.EPSILON10&&Math.abs(b.y)<R.EPSILON10?h.UNIT_X:h.normalize(b,uMe),T=h.UNIT_Z,E=h.cross(A,T,fMe);d=cn.fromPointNormal(b,A,gMe);let v=h.fromRadians(y+R.PI_OVER_TWO,m,n,i,dMe);s=h.dot(cn.projectPointOntoPlane(d,v,hMe),E),r=-s,c=h.fromRadians(0,e.north,g?t:n,i,mMe).z,a=h.fromRadians(0,e.south,p?t:n,i,pMe).z;let D=h.fromRadians(e.east,m,n,i,_Me);return l=cn.getPointDistance(d,D),f=0,_te(b,E,T,A,r,s,a,c,l,f,o)};Mi.fromTransformation=function(e,t){return u(t)||(t=new Mi),t.center=F.getTranslation(e,t.center),t.halfAxes=F.getMatrix3(e,t.halfAxes),t.halfAxes=J.multiplyByScalar(t.halfAxes,.5,t.halfAxes),t};Mi.clone=function(e,t){if(u(e))return u(t)?(h.clone(e.center,t.center),J.clone(e.halfAxes,t.halfAxes),t):new Mi(e.center,e.halfAxes)};Mi.intersectPlane=function(e,t){let n=e.center,i=t.normal,o=e.halfAxes,r=i.x,s=i.y,a=i.z,c=Math.abs(r*o[J.COLUMN0ROW0]+s*o[J.COLUMN0ROW1]+a*o[J.COLUMN0ROW2])+Math.abs(r*o[J.COLUMN1ROW0]+s*o[J.COLUMN1ROW1]+a*o[J.COLUMN1ROW2])+Math.abs(r*o[J.COLUMN2ROW0]+s*o[J.COLUMN2ROW1]+a*o[J.COLUMN2ROW2]),l=h.dot(i,n)+t.distance;return l<=-c?qt.OUTSIDE:l>=c?qt.INSIDE:qt.INTERSECTING};var Ate=new h,Tte=new h,Ete=new h,yMe=new h,bte=new h,xMe=new h;Mi.distanceSquaredTo=function(e,t){let n=h.subtract(t,e.center,Cte),i=e.halfAxes,o=J.getColumn(i,0,Ate),r=J.getColumn(i,1,Tte),s=J.getColumn(i,2,Ete),a=h.magnitude(o),c=h.magnitude(r),l=h.magnitude(s),f=!0,d=!0,p=!0;a>0?h.divideByScalar(o,a,o):f=!1,c>0?h.divideByScalar(r,c,r):d=!1,l>0?h.divideByScalar(s,l,s):p=!1;let g=!f+!d+!p,m,y,b;if(g===1){let E=o;m=r,y=s,d?p||(E=s,y=o):(E=r,m=o),b=h.cross(m,y,bte),E===o?o=b:E===r?r=b:E===s&&(s=b)}else if(g===2){m=o,d?m=r:p&&(m=s);let E=h.UNIT_Y;E.equalsEpsilon(m,R.EPSILON3)&&(E=h.UNIT_X),y=h.cross(m,E,yMe),h.normalize(y,y),b=h.cross(m,y,bte),h.normalize(b,b),m===o?(r=y,s=b):m===r?(s=y,o=b):m===s&&(o=y,r=b)}else g===3&&(o=h.UNIT_X,r=h.UNIT_Y,s=h.UNIT_Z);let C=xMe;C.x=h.dot(n,o),C.y=h.dot(n,r),C.z=h.dot(n,s);let A=0,T;return C.x<-a?(T=C.x+a,A+=T*T):C.x>a&&(T=C.x-a,A+=T*T),C.y<-c?(T=C.y+c,A+=T*T):C.y>c&&(T=C.y-c,A+=T*T),C.z<-l?(T=C.z+l,A+=T*T):C.z>l&&(T=C.z-l,A+=T*T),A};var bMe=new h,CMe=new h;Mi.computePlaneDistances=function(e,t,n,i){u(i)||(i=new qa);let o=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,s=e.center,a=e.halfAxes,c=J.getColumn(a,0,Ate),l=J.getColumn(a,1,Tte),f=J.getColumn(a,2,Ete),d=h.add(c,l,bMe);h.add(d,f,d),h.add(d,s,d);let p=h.subtract(d,t,CMe),g=h.dot(n,p);return o=Math.min(g,o),r=Math.max(g,r),h.add(s,c,d),h.add(d,l,d),h.subtract(d,f,d),h.subtract(d,t,p),g=h.dot(n,p),o=Math.min(g,o),r=Math.max(g,r),h.add(s,c,d),h.subtract(d,l,d),h.add(d,f,d),h.subtract(d,t,p),g=h.dot(n,p),o=Math.min(g,o),r=Math.max(g,r),h.add(s,c,d),h.subtract(d,l,d),h.subtract(d,f,d),h.subtract(d,t,p),g=h.dot(n,p),o=Math.min(g,o),r=Math.max(g,r),h.subtract(s,c,d),h.add(d,l,d),h.add(d,f,d),h.subtract(d,t,p),g=h.dot(n,p),o=Math.min(g,o),r=Math.max(g,r),h.subtract(s,c,d),h.add(d,l,d),h.subtract(d,f,d),h.subtract(d,t,p),g=h.dot(n,p),o=Math.min(g,o),r=Math.max(g,r),h.subtract(s,c,d),h.subtract(d,l,d),h.add(d,f,d),h.subtract(d,t,p),g=h.dot(n,p),o=Math.min(g,o),r=Math.max(g,r),h.subtract(s,c,d),h.subtract(d,l,d),h.subtract(d,f,d),h.subtract(d,t,p),g=h.dot(n,p),o=Math.min(g,o),r=Math.max(g,r),i.start=o,i.stop=r,i};var AMe=new h,TMe=new h,EMe=new h;Mi.computeCorners=function(e,t){u(t)||(t=[new h,new h,new h,new h,new h,new h,new h,new h]);let n=e.center,i=e.halfAxes,o=J.getColumn(i,0,AMe),r=J.getColumn(i,1,TMe),s=J.getColumn(i,2,EMe);return h.clone(n,t[0]),h.subtract(t[0],o,t[0]),h.subtract(t[0],r,t[0]),h.subtract(t[0],s,t[0]),h.clone(n,t[1]),h.subtract(t[1],o,t[1]),h.subtract(t[1],r,t[1]),h.add(t[1],s,t[1]),h.clone(n,t[2]),h.subtract(t[2],o,t[2]),h.add(t[2],r,t[2]),h.subtract(t[2],s,t[2]),h.clone(n,t[3]),h.subtract(t[3],o,t[3]),h.add(t[3],r,t[3]),h.add(t[3],s,t[3]),h.clone(n,t[4]),h.add(t[4],o,t[4]),h.subtract(t[4],r,t[4]),h.subtract(t[4],s,t[4]),h.clone(n,t[5]),h.add(t[5],o,t[5]),h.subtract(t[5],r,t[5]),h.add(t[5],s,t[5]),h.clone(n,t[6]),h.add(t[6],o,t[6]),h.add(t[6],r,t[6]),h.subtract(t[6],s,t[6]),h.clone(n,t[7]),h.add(t[7],o,t[7]),h.add(t[7],r,t[7]),h.add(t[7],s,t[7]),t};var SMe=new J;Mi.computeTransformation=function(e,t){u(t)||(t=new F);let n=e.center,i=J.multiplyByUniformScale(e.halfAxes,2,SMe);return F.fromRotationTranslation(i,n,t)};var vMe=new ae;Mi.isOccluded=function(e,t){let n=ae.fromOrientedBoundingBox(e,vMe);return!t.isBoundingSphereVisible(n)};Mi.prototype.intersectPlane=function(e){return Mi.intersectPlane(this,e)};Mi.prototype.distanceSquaredTo=function(e){return Mi.distanceSquaredTo(this,e)};Mi.prototype.computePlaneDistances=function(e,t,n){return Mi.computePlaneDistances(this,e,t,n)};Mi.prototype.computeCorners=function(e){return Mi.computeCorners(this,e)};Mi.prototype.computeTransformation=function(e){return Mi.computeTransformation(this,e)};Mi.prototype.isOccluded=function(e){return Mi.isOccluded(this,e)};Mi.equals=function(e,t){return e===t||u(e)&&u(t)&&h.equals(e.center,t.center)&&J.equals(e.halfAxes,t.halfAxes)};Mi.prototype.clone=function(e){return Mi.clone(this,e)};Mi.prototype.equals=function(e){return Mi.equals(this,e)};var wn=Mi;var TL={};TL.getHeight=function(e,t,n){return(e-n)*t+n};var wMe=new de;TL.getPosition=function(e,t,n,i,o){let r=t.cartesianToCartographic(e,wMe);if(!u(r))return h.clone(e,o);let s=TL.getHeight(r.height,n,i);return h.fromRadians(r.longitude,r.latitude,s,t,o)};var Mr=TL;var EL=`in vec3 position3DHigh;
in vec3 position3DLow;
in float batchId;

#ifdef EXTRUDED_GEOMETRY
in vec3 extrudeDirection;

uniform float u_globeMinimumAltitude;
#endif // EXTRUDED_GEOMETRY

#ifdef PER_INSTANCE_COLOR
out vec4 v_color;
#endif // PER_INSTANCE_COLOR

#ifdef TEXTURE_COORDINATES
#ifdef SPHERICAL
out vec4 v_sphericalExtents;
#else // SPHERICAL
out vec2 v_inversePlaneExtents;
out vec4 v_westPlane;
out vec4 v_southPlane;
#endif // SPHERICAL
out vec3 v_uvMinAndSphericalLongitudeRotation;
out vec3 v_uMaxAndInverseDistance;
out vec3 v_vMaxAndInverseDistance;
#endif // TEXTURE_COORDINATES

void main()
{
    vec4 position = czm_computePosition();

#ifdef EXTRUDED_GEOMETRY
    float delta = min(u_globeMinimumAltitude, czm_geometricToleranceOverMeter * length(position.xyz));
    delta *= czm_sceneMode == czm_sceneMode3D ? 1.0 : 0.0;

    //extrudeDirection is zero for the top layer
    position = position + vec4(extrudeDirection * delta, 0.0);
#endif

#ifdef TEXTURE_COORDINATES
#ifdef SPHERICAL
    v_sphericalExtents = czm_batchTable_sphericalExtents(batchId);
    v_uvMinAndSphericalLongitudeRotation.z = czm_batchTable_longitudeRotation(batchId);
#else // SPHERICAL
#ifdef COLUMBUS_VIEW_2D
    vec4 planes2D_high = czm_batchTable_planes2D_HIGH(batchId);
    vec4 planes2D_low = czm_batchTable_planes2D_LOW(batchId);

    // If the primitive is split across the IDL (planes2D_high.x > planes2D_high.w):
    // - If this vertex is on the east side of the IDL (position3DLow.y > 0.0, comparison with position3DHigh may produce artifacts)
    // - existing "east" is on the wrong side of the world, far away (planes2D_high/low.w)
    // - so set "east" as beyond the eastmost extent of the projection (idlSplitNewPlaneHiLow)
    vec2 idlSplitNewPlaneHiLow = vec2(EAST_MOST_X_HIGH - (WEST_MOST_X_HIGH - planes2D_high.w), EAST_MOST_X_LOW - (WEST_MOST_X_LOW - planes2D_low.w));
    bool idlSplit = planes2D_high.x > planes2D_high.w && position3DLow.y > 0.0;
    planes2D_high.w = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.x, planes2D_high.w);
    planes2D_low.w = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.y, planes2D_low.w);

    // - else, if this vertex is on the west side of the IDL (position3DLow.y < 0.0)
    // - existing "west" is on the wrong side of the world, far away (planes2D_high/low.x)
    // - so set "west" as beyond the westmost extent of the projection (idlSplitNewPlaneHiLow)
    idlSplit = planes2D_high.x > planes2D_high.w && position3DLow.y < 0.0;
    idlSplitNewPlaneHiLow = vec2(WEST_MOST_X_HIGH - (EAST_MOST_X_HIGH - planes2D_high.x), WEST_MOST_X_LOW - (EAST_MOST_X_LOW - planes2D_low.x));
    planes2D_high.x = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.x, planes2D_high.x);
    planes2D_low.x = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.y, planes2D_low.x);

    vec3 southWestCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, planes2D_high.xy), vec3(0.0, planes2D_low.xy))).xyz;
    vec3 northWestCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, planes2D_high.x, planes2D_high.z), vec3(0.0, planes2D_low.x, planes2D_low.z))).xyz;
    vec3 southEastCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, planes2D_high.w, planes2D_high.y), vec3(0.0, planes2D_low.w, planes2D_low.y))).xyz;
#else // COLUMBUS_VIEW_2D
    // 3D case has smaller "plane extents," so planes encoded as a 64 bit position and 2 vec3s for distances/direction
    vec3 southWestCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(czm_batchTable_southWest_HIGH(batchId), czm_batchTable_southWest_LOW(batchId))).xyz;
    vec3 northWestCorner = czm_normal * czm_batchTable_northward(batchId) + southWestCorner;
    vec3 southEastCorner = czm_normal * czm_batchTable_eastward(batchId) + southWestCorner;
#endif // COLUMBUS_VIEW_2D

    vec3 eastWard = southEastCorner - southWestCorner;
    float eastExtent = length(eastWard);
    eastWard /= eastExtent;

    vec3 northWard = northWestCorner - southWestCorner;
    float northExtent = length(northWard);
    northWard /= northExtent;

    v_westPlane = vec4(eastWard, -dot(eastWard, southWestCorner));
    v_southPlane = vec4(northWard, -dot(northWard, southWestCorner));
    v_inversePlaneExtents = vec2(1.0 / eastExtent, 1.0 / northExtent);
#endif // SPHERICAL
    vec4 uvMinAndExtents = czm_batchTable_uvMinAndExtents(batchId);
    vec4 uMaxVmax = czm_batchTable_uMaxVmax(batchId);

    v_uMaxAndInverseDistance = vec3(uMaxVmax.xy, uvMinAndExtents.z);
    v_vMaxAndInverseDistance = vec3(uMaxVmax.zw, uvMinAndExtents.w);
    v_uvMinAndSphericalLongitudeRotation.xy = uvMinAndExtents.xy;
#endif // TEXTURE_COORDINATES

#ifdef PER_INSTANCE_COLOR
    v_color = czm_batchTable_color(batchId);
#endif

    gl_Position = czm_depthClamp(czm_modelViewProjectionRelativeToEye * position);
}
`;var Uy=`#ifdef VECTOR_TILE
uniform vec4 u_highlightColor;
#endif

void main(void)
{
#ifdef VECTOR_TILE
    out_FragColor = czm_gammaCorrect(u_highlightColor);
#else
    out_FragColor = vec4(1.0);
#endif
    czm_writeDepthClamp();
}
`;var Ste={TERRAIN:0,CESIUM_3D_TILE:1,BOTH:2};Ste.NUMBER_OF_CLASSIFICATION_TYPES=3;var Vn=Object.freeze(Ste);var DMe={NEVER:te.NEVER,LESS:te.LESS,EQUAL:te.EQUAL,LESS_OR_EQUAL:te.LEQUAL,GREATER:te.GREATER,NOT_EQUAL:te.NOTEQUAL,GREATER_OR_EQUAL:te.GEQUAL,ALWAYS:te.ALWAYS},wc=Object.freeze(DMe);function IMe(e,t){let n=[],i=e.length,o=0;for(;o<i;){let r=Math.ceil((i-o)/t--);n.push(e.slice(o,o+r)),o+=r}return n}var SL=IMe;function sp(e,t,n){if(this._attributes=t,this._numberOfInstances=n,t.length===0)return;let i=PMe(t),o=e.floatingPointTexture,r=i===Ke.FLOAT&&!o,s=RMe(t,r),a=OMe(s,t,r),c=Math.floor(Vt.maximumTextureSize/a),l=Math.min(n,c),f=a*l,d=Math.ceil(n/l),p=1/f,g=p*.5,m=1/d,y=m*.5;this._textureDimensions=new H(f,d),this._textureStep=new oe(p,g,m,y),this._pixelDatatype=r?Ke.UNSIGNED_BYTE:i,this._packFloats=r,this._offsets=s,this._stride=a,this._texture=void 0;let b=4*f*d;this._batchValues=i===Ke.FLOAT&&!r?new Float32Array(b):new Uint8Array(b),this._batchValuesDirty=!1}Object.defineProperties(sp.prototype,{attributes:{get:function(){return this._attributes}},numberOfInstances:{get:function(){return this._numberOfInstances}}});function PMe(e){let t=!1,n=e.length;for(let i=0;i<n;++i)if(e[i].componentDatatype!==K.UNSIGNED_BYTE){t=!0;break}return t?Ke.FLOAT:Ke.UNSIGNED_BYTE}function wte(e,t){let n=e[t].componentsPerAttribute;return n===2?H:n===3?h:n===4?oe:Number}function RMe(e,t){let n=new Array(e.length),i=0,o=e.length;for(let r=0;r<o;++r){let a=e[r].componentDatatype;n[r]=i,a!==K.UNSIGNED_BYTE&&t?i+=4:++i}return n}function OMe(e,t,n){let i=e.length,o=e[i-1];return t[i-1].componentDatatype!==K.UNSIGNED_BYTE&&n?o+4:o+1}var sv=new oe;function MMe(e,t,n){let i=oe.unpack(e,t,sv),o=oe.unpackFloat(i);i=oe.unpack(e,t+4,sv);let r=oe.unpackFloat(i);i=oe.unpack(e,t+8,sv);let s=oe.unpackFloat(i);i=oe.unpack(e,t+12,sv);let a=oe.unpackFloat(i);return oe.fromElements(o,r,s,a,n)}function LMe(e,t,n){let i=oe.packFloat(e.x,sv);oe.pack(i,t,n),i=oe.packFloat(e.y,i),oe.pack(i,t,n+4),i=oe.packFloat(e.z,i),oe.pack(i,t,n+8),i=oe.packFloat(e.w,i),oe.pack(i,t,n+12)}var vte=new oe;sp.prototype.getBatchedAttribute=function(e,t,n){let i=this._attributes,o=this._offsets[t],s=4*this._stride*e+4*o,a;this._packFloats&&i[t].componentDatatype!==Ke.UNSIGNED_BYTE?a=MMe(this._batchValues,s,vte):a=oe.unpack(this._batchValues,s,vte);let c=wte(i,t);return u(c.fromCartesian4)?c.fromCartesian4(a,n):u(c.clone)?c.clone(a,n):a.x};var NMe=[void 0,void 0,new H,new h,new oe],FMe=new oe;sp.prototype.setBatchedAttribute=function(e,t,n){let i=this._attributes,o=NMe[i[t].componentsPerAttribute],r=this.getBatchedAttribute(e,t,o),s=wte(this._attributes,t);if(u(s.equals)?s.equals(r,n):r===n)return;let c=FMe;c.x=u(n.x)?n.x:n,c.y=u(n.y)?n.y:0,c.z=u(n.z)?n.z:0,c.w=u(n.w)?n.w:0;let l=this._offsets[t],d=4*this._stride*e+4*l;this._packFloats&&i[t].componentDatatype!==Ke.UNSIGNED_BYTE?LMe(c,this._batchValues,d):oe.pack(c,this._batchValues,d),this._batchValuesDirty=!0};function BMe(e,t){let n=e._textureDimensions;e._texture=new Ot({context:t,pixelFormat:tt.RGBA,pixelDatatype:e._pixelDatatype,width:n.x,height:n.y,sampler:Qt.NEAREST,flipY:!1})}function kMe(e){let t=e._textureDimensions;e._texture.copyFrom({source:{width:t.x,height:t.y,arrayBufferView:e._batchValues}})}sp.prototype.update=function(e){u(this._texture)&&!this._batchValuesDirty||this._attributes.length===0||(this._batchValuesDirty=!1,u(this._texture)||BMe(this,e.context),kMe(this))};sp.prototype.getUniformMapCallback=function(){let e=this;return function(t){return e._attributes.length===0?t:bt(t,{batchTexture:function(){return e._texture},batchTextureDimensions:function(){return e._textureDimensions},batchTextureStep:function(){return e._textureStep}})}};function VMe(e){let t=e._stride;return e._textureDimensions.y===1?`uniform vec4 batchTextureStep; 
vec2 computeSt(float batchId) 
{ 
    float stepX = batchTextureStep.x; 
    float centerX = batchTextureStep.y; 
    float numberOfAttributes = float(${t}); 
    return vec2(centerX + (batchId * numberOfAttributes * stepX), 0.5); 
} 
`:`uniform vec4 batchTextureStep; 
uniform vec2 batchTextureDimensions; 
vec2 computeSt(float batchId) 
{ 
    float stepX = batchTextureStep.x; 
    float centerX = batchTextureStep.y; 
    float stepY = batchTextureStep.z; 
    float centerY = batchTextureStep.w; 
    float numberOfAttributes = float(${t}); 
    float xId = mod(batchId * numberOfAttributes, batchTextureDimensions.x); 
    float yId = floor(batchId * numberOfAttributes / batchTextureDimensions.x); 
    return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); 
} 
`}function UMe(e){return e===1?"float":`vec${e}`}function zMe(e){return e===1?".x":e===2?".xy":e===3?".xyz":""}function HMe(e,t){let i=e._attributes[t],o=i.componentsPerAttribute,r=i.functionName,s=UMe(o),a=zMe(o),c=e._offsets[t],l=`${s} ${r}(float batchId) 
{ 
    vec2 st = computeSt(batchId); 
    st.x += batchTextureStep.x * float(${c}); 
`;return e._packFloats&&i.componentDatatype!==Ke.UNSIGNED_BYTE?l+=`vec4 textureValue; 
textureValue.x = czm_unpackFloat(texture(batchTexture, st)); 
textureValue.y = czm_unpackFloat(texture(batchTexture, st + vec2(batchTextureStep.x, 0.0))); 
textureValue.z = czm_unpackFloat(texture(batchTexture, st + vec2(batchTextureStep.x * 2.0, 0.0))); 
textureValue.w = czm_unpackFloat(texture(batchTexture, st + vec2(batchTextureStep.x * 3.0, 0.0))); 
`:l+=`    vec4 textureValue = texture(batchTexture, st); 
`,l+=`    ${s} value = textureValue${a}; 
`,e._pixelDatatype===Ke.UNSIGNED_BYTE&&i.componentDatatype===K.UNSIGNED_BYTE&&!i.normalize?l+=`value *= 255.0; 
`:e._pixelDatatype===Ke.FLOAT&&i.componentDatatype===K.UNSIGNED_BYTE&&i.normalize&&(l+=`value /= 255.0; 
`),l+=`    return value; 
} 
`,l}sp.prototype.getVertexShaderCallback=function(){let e=this._attributes;if(e.length===0)return function(i){return i};let t=`uniform highp sampler2D batchTexture; 
`;t+=`${VMe(this)}
`;let n=e.length;for(let i=0;i<n;++i)t+=HMe(this,i);return function(i){let o=i.indexOf("void main"),r=i.substring(0,o),s=i.substring(o);return`${r}
${t}
${s}`}};sp.prototype.isDestroyed=function(){return!1};sp.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),ue(this)};var LC=sp;function ml(e){this._ellipsoid=x(e,ee.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object.defineProperties(ml.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});ml.mercatorAngleToGeodeticLatitude=function(e){return R.PI_OVER_TWO-2*Math.atan(Math.exp(-e))};ml.geodeticLatitudeToMercatorAngle=function(e){e>ml.MaximumLatitude?e=ml.MaximumLatitude:e<-ml.MaximumLatitude&&(e=-ml.MaximumLatitude);let t=Math.sin(e);return .5*Math.log((1+t)/(1-t))};ml.MaximumLatitude=ml.mercatorAngleToGeodeticLatitude(Math.PI);ml.prototype.project=function(e,t){let n=this._semimajorAxis,i=e.longitude*n,o=ml.geodeticLatitudeToMercatorAngle(e.latitude)*n,r=e.height;return u(t)?(t.x=i,t.y=o,t.z=r,t):new h(i,o,r)};ml.prototype.unproject=function(e,t){let n=this._oneOverSemimajorAxis,i=e.x*n,o=ml.mercatorAngleToGeodeticLatitude(e.y*n),r=e.z;return u(t)?(t.longitude=i,t.latitude=o,t.height=r,t):new de(i,o,r)};var Li=ml;function GMe(e,t,n){let i=!n,o=e.length,r;if(!i&&o>1){let s=e[0].modelMatrix;for(r=1;r<o;++r)if(!F.equals(s,e[r].modelMatrix)){i=!0;break}}if(i)for(r=0;r<o;++r)u(e[r].geometry)&&Nn.transformToWorldCoordinates(e[r]);else F.multiplyTransformation(t,e[0].modelMatrix,t)}function u9(e,t){let n=e.attributes,i=n.position,o=i.values.length/i.componentsPerAttribute;n.batchId=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:1,values:new Float32Array(o)});let r=n.batchId.values;for(let s=0;s<o;++s)r[s]=t}function WMe(e){let t=e.length;for(let n=0;n<t;++n){let i=e[n];u(i.geometry)?u9(i.geometry,n):u(i.westHemisphereGeometry)&&u(i.eastHemisphereGeometry)&&(u9(i.westHemisphereGeometry,n),u9(i.eastHemisphereGeometry,n))}}function jMe(e){let t=e.instances,n=e.projection,i=e.elementIndexUintSupported,o=e.scene3DOnly,r=e.vertexCacheOptimize,s=e.compressVertices,a=e.modelMatrix,c,l,f,d=t.length;for(c=0;c<d;++c)if(u(t[c].geometry)){f=t[c].geometry.primitiveType;break}if(GMe(t,a,o),!o)for(c=0;c<d;++c)u(t[c].geometry)&&Nn.splitLongitude(t[c]);if(WMe(t),r)for(c=0;c<d;++c){let g=t[c];u(g.geometry)?(Nn.reorderForPostVertexCache(g.geometry),Nn.reorderForPreVertexCache(g.geometry)):u(g.westHemisphereGeometry)&&u(g.eastHemisphereGeometry)&&(Nn.reorderForPostVertexCache(g.westHemisphereGeometry),Nn.reorderForPreVertexCache(g.westHemisphereGeometry),Nn.reorderForPostVertexCache(g.eastHemisphereGeometry),Nn.reorderForPreVertexCache(g.eastHemisphereGeometry))}let p=Nn.combineInstances(t);for(d=p.length,c=0;c<d;++c){l=p[c];let g=l.attributes;if(o)for(let m in g)g.hasOwnProperty(m)&&g[m].componentDatatype===K.DOUBLE&&Nn.encodeAttribute(l,m,`${m}3DHigh`,`${m}3DLow`);else for(let m in g)if(g.hasOwnProperty(m)&&g[m].componentDatatype===K.DOUBLE){let y=`${m}3D`,b=`${m}2D`;Nn.projectTo2D(l,m,y,b,n),u(l.boundingSphere)&&m==="position"&&(l.boundingSphereCV=ae.fromVertices(l.attributes.position2D.values)),Nn.encodeAttribute(l,y,`${y}High`,`${y}Low`),Nn.encodeAttribute(l,b,`${b}High`,`${b}Low`)}s&&Nn.compressVertices(l)}if(!i){let g=[];for(d=p.length,c=0;c<d;++c)l=p[c],g=g.concat(Nn.fitToUnsignedShortIndices(l));p=g}return p}function f9(e,t,n,i){let o,r,s,a=i.length-1;if(a>=0){let l=i[a];o=l.offset+l.count,s=l.index,r=n[s].indices.length}else o=0,s=0,r=n[s].indices.length;let c=e.length;for(let l=0;l<c;++l){let d=e[l][t];if(!u(d))continue;let p=d.indices.length;o+p>r&&(o=0,r=n[++s].indices.length),i.push({index:s,offset:o,count:p}),o+=p}}function qMe(e,t){let n=[];return f9(e,"geometry",t,n),f9(e,"westHemisphereGeometry",t,n),f9(e,"eastHemisphereGeometry",t,n),n}var ap={};ap.combineGeometry=function(e){let t,n,i=e.instances,o=i.length,r,s,a=!1;o>0&&(t=jMe(e),t.length>0&&(n=Nn.createAttributeLocations(t[0]),e.createPickOffsets&&(r=qMe(i,t))),u(i[0].attributes)&&u(i[0].attributes.offset)&&(s=new Array(o),a=!0));let c=new Array(o),l=new Array(o);for(let f=0;f<o;++f){let d=i[f],p=d.geometry;u(p)&&(c[f]=p.boundingSphere,l[f]=p.boundingSphereCV,a&&(s[f]=d.geometry.offsetAttribute));let g=d.eastHemisphereGeometry,m=d.westHemisphereGeometry;u(g)&&u(m)&&(u(g.boundingSphere)&&u(m.boundingSphere)&&(c[f]=ae.union(g.boundingSphere,m.boundingSphere)),u(g.boundingSphereCV)&&u(m.boundingSphereCV)&&(l[f]=ae.union(g.boundingSphereCV,m.boundingSphereCV)))}return{geometries:t,modelMatrix:e.modelMatrix,attributeLocations:n,pickOffsets:r,offsetInstanceExtend:s,boundingSpheres:c,boundingSpheresCV:l}};function YMe(e,t){let n=e.attributes;for(let i in n)if(n.hasOwnProperty(i)){let o=n[i];u(o)&&u(o.values)&&t.push(o.values.buffer)}u(e.indices)&&t.push(e.indices.buffer)}function XMe(e,t){let n=e.length;for(let i=0;i<n;++i)YMe(e[i],t)}function KMe(e){let t=1,n=e.length;for(let i=0;i<n;i++){let o=e[i];if(++t,!u(o))continue;let r=o.attributes;t+=7+2*ae.packedLength+(u(o.indices)?o.indices.length:0);for(let s in r)if(r.hasOwnProperty(s)&&u(r[s])){let a=r[s];t+=5+a.values.length}}return t}ap.packCreateGeometryResults=function(e,t){let n=new Float64Array(KMe(e)),i=[],o={},r=e.length,s=0;n[s++]=r;for(let a=0;a<r;a++){let c=e[a],l=u(c);if(n[s++]=l?1:0,!l)continue;n[s++]=c.primitiveType,n[s++]=c.geometryType,n[s++]=x(c.offsetAttribute,-1);let f=u(c.boundingSphere)?1:0;n[s++]=f,f&&ae.pack(c.boundingSphere,n,s),s+=ae.packedLength;let d=u(c.boundingSphereCV)?1:0;n[s++]=d,d&&ae.pack(c.boundingSphereCV,n,s),s+=ae.packedLength;let p=c.attributes,g=[];for(let y in p)p.hasOwnProperty(y)&&u(p[y])&&(g.push(y),u(o[y])||(o[y]=i.length,i.push(y)));n[s++]=g.length;for(let y=0;y<g.length;y++){let b=g[y],C=p[b];n[s++]=o[b],n[s++]=C.componentDatatype,n[s++]=C.componentsPerAttribute,n[s++]=C.normalize?1:0,n[s++]=C.values.length,n.set(C.values,s),s+=C.values.length}let m=u(c.indices)?c.indices.length:0;n[s++]=m,m>0&&(n.set(c.indices,s),s+=m)}return t.push(n.buffer),{stringTable:i,packedData:n}};ap.unpackCreateGeometryResults=function(e){let t=e.stringTable,n=e.packedData,i,o=new Array(n[0]),r=0,s=1;for(;s<n.length;){if(!(n[s++]===1)){o[r++]=void 0;continue}let c=n[s++],l=n[s++],f=n[s++];f===-1&&(f=void 0);let d,p;n[s++]===1&&(d=ae.unpack(n,s)),s+=ae.packedLength,n[s++]===1&&(p=ae.unpack(n,s)),s+=ae.packedLength;let y,b,C,A=new hn,T=n[s++];for(i=0;i<T;i++){let v=t[n[s++]],D=n[s++];C=n[s++];let O=n[s++]!==0;y=n[s++],b=K.createTypedArray(D,y);for(let P=0;P<y;P++)b[P]=n[s++];A[v]=new ve({componentDatatype:D,componentsPerAttribute:C,normalize:O,values:b})}let E;if(y=n[s++],y>0){let v=b.length/C;for(E=Be.createTypedArray(v,y),i=0;i<y;i++)E[i]=n[s++]}o[r++]=new ft({primitiveType:c,geometryType:l,boundingSphere:d,boundingSphereCV:p,indices:E,attributes:A,offsetAttribute:f})}return o};function ZMe(e,t){let n=e.length,i=new Float64Array(1+n*19),o=0;i[o++]=n;for(let r=0;r<n;r++){let s=e[r];if(F.pack(s.modelMatrix,i,o),o+=F.packedLength,u(s.attributes)&&u(s.attributes.offset)){let a=s.attributes.offset.value;i[o]=a[0],i[o+1]=a[1],i[o+2]=a[2]}o+=3}return t.push(i.buffer),i}function $Me(e){let t=e,n=new Array(t[0]),i=0,o=1;for(;o<t.length;){let r=F.unpack(t,o),s;o+=F.packedLength,u(t[o])&&(s={offset:new to(t[o],t[o+1],t[o+2])}),o+=3,n[i++]={modelMatrix:r,attributes:s}}return n}ap.packCombineGeometryParameters=function(e,t){let n=e.createGeometryResults,i=n.length;for(let o=0;o<i;o++)t.push(n[o].packedData.buffer);return{createGeometryResults:e.createGeometryResults,packedInstances:ZMe(e.instances,t),ellipsoid:e.ellipsoid,isGeographic:e.projection instanceof Oi,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e.createPickOffsets}};ap.unpackCombineGeometryParameters=function(e){let t=$Me(e.packedInstances),n=e.createGeometryResults,i=n.length,o=0;for(let a=0;a<i;a++){let c=ap.unpackCreateGeometryResults(n[a]),l=c.length;for(let f=0;f<l;f++){let d=c[f],p=t[o];p.geometry=d,++o}}let r=ee.clone(e.ellipsoid),s=e.isGeographic?new Oi(r):new Li(r);return{instances:t,ellipsoid:r,projection:s,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:F.clone(e.modelMatrix),createPickOffsets:e.createPickOffsets}};function Dte(e){let t=e.length,n=1+(ae.packedLength+1)*t,i=new Float32Array(n),o=0;i[o++]=t;for(let r=0;r<t;++r){let s=e[r];u(s)?(i[o++]=1,ae.pack(e[r],i,o)):i[o++]=0,o+=ae.packedLength}return i}function Ite(e){let t=new Array(e[0]),n=0,i=1;for(;i<e.length;)e[i++]===1&&(t[n]=ae.unpack(e,i)),++n,i+=ae.packedLength;return t}ap.packCombineGeometryResults=function(e,t){u(e.geometries)&&XMe(e.geometries,t);let n=Dte(e.boundingSpheres),i=Dte(e.boundingSpheresCV);return t.push(n.buffer,i.buffer),{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:n,boundingSpheresCV:i}};ap.unpackCombineGeometryResults=function(e){return{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:Ite(e.boundingSpheres),boundingSpheresCV:Ite(e.boundingSpheresCV)}};var NC=ap;var QMe={READY:0,CREATING:1,CREATED:2,COMBINING:3,COMBINED:4,COMPLETE:5,FAILED:6},Lr=Object.freeze(QMe);var Zl={DISABLED:0,ENABLED:1,CAST_ONLY:2,RECEIVE_ONLY:3};Zl.NUMBER_OF_SHADOW_MODES=4;Zl.castShadows=function(e){return e===Zl.ENABLED||e===Zl.CAST_ONLY};Zl.receiveShadows=function(e){return e===Zl.ENABLED||e===Zl.RECEIVE_ONLY};Zl.fromCastReceive=function(e,t){return e&&t?Zl.ENABLED:e?Zl.CAST_ONLY:t?Zl.RECEIVE_ONLY:Zl.DISABLED};var xn=Object.freeze(Zl);function yr(e){e=x(e,x.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this.appearance=e.appearance,this._appearance=void 0,this._material=void 0,this.depthFailAppearance=e.depthFailAppearance,this._depthFailAppearance=void 0,this._depthFailMaterial=void 0,this.modelMatrix=F.clone(x(e.modelMatrix,F.IDENTITY)),this._modelMatrix=new F,this.show=x(e.show,!0),this._vertexCacheOptimize=x(e.vertexCacheOptimize,!1),this._interleave=x(e.interleave,!1),this._releaseGeometryInstances=x(e.releaseGeometryInstances,!0),this._allowPicking=x(e.allowPicking,!0),this._asynchronous=x(e.asynchronous,!0),this._compressVertices=x(e.compressVertices,!0),this.cull=x(e.cull,!0),this.debugShowBoundingVolume=x(e.debugShowBoundingVolume,!1),this.rtcCenter=e.rtcCenter,this.shadows=x(e.shadows,xn.DISABLED),this._translucent=void 0,this._state=Lr.READY,this._geometries=[],this._error=void 0,this._numberOfInstances=0,this._boundingSpheres=[],this._boundingSphereWC=[],this._boundingSphereCV=[],this._boundingSphere2D=[],this._boundingSphereMorph=[],this._perInstanceAttributeCache=new Map,this._instanceIds=[],this._lastPerInstanceAttributeIndex=0,this._va=[],this._attributeLocations=void 0,this._primitiveType=void 0,this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._depthFailAppearance=void 0,this._spDepthFail=void 0,this._frontFaceDepthFailRS=void 0,this._backFaceDepthFailRS=void 0,this._pickIds=[],this._colorCommands=[],this._pickCommands=[],this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._createRenderStatesFunction=e._createRenderStatesFunction,this._createShaderProgramFunction=e._createShaderProgramFunction,this._createCommandsFunction=e._createCommandsFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._createPickOffsets=e._createPickOffsets,this._pickOffsets=void 0,this._createGeometryResults=void 0,this._ready=!1,this._batchTable=void 0,this._batchTableAttributeIndices=void 0,this._offsetInstanceExtend=void 0,this._batchTableOffsetAttribute2DIndex=void 0,this._batchTableOffsetsUpdated=!1,this._instanceBoundingSpheres=void 0,this._instanceBoundingSpheresCV=void 0,this._tempBoundingSpheres=void 0,this._recomputeBoundingSpheres=!1,this._batchTableBoundingSpheresUpdated=!1,this._batchTableBoundingSphereAttributeIndices=void 0}Object.defineProperties(yr.prototype,{vertexCacheOptimize:{get:function(){return this._vertexCacheOptimize}},interleave:{get:function(){return this._interleave}},releaseGeometryInstances:{get:function(){return this._releaseGeometryInstances}},allowPicking:{get:function(){return this._allowPicking}},asynchronous:{get:function(){return this._asynchronous}},compressVertices:{get:function(){return this._compressVertices}},ready:{get:function(){return this._ready}}});function JMe(e){let t=e.length,n=[],i=e[0].attributes,o;for(o in i)if(i.hasOwnProperty(o)&&u(i[o])){let r=i[o],s=!0;for(let a=1;a<t;++a){let c=e[a].attributes[o];if(!u(c)||r.componentDatatype!==c.componentDatatype||r.componentsPerAttribute!==c.componentsPerAttribute||r.normalize!==c.normalize){s=!1;break}}s&&n.push(o)}return n}var eLe=new H,tLe=new h,kte=new oe;function Vte(e){let t=e.length;if(t===1)return e[0];if(t===2)return H.unpack(e,0,eLe);if(t===3)return h.unpack(e,0,tLe);if(t===4)return oe.unpack(e,0,kte)}function nLe(e,t){let n=e.geometryInstances,i=Array.isArray(n)?n:[n],o=i.length;if(o===0)return;let r=JMe(i),s=r.length,a=[],c={},l={},f,p=i[0].attributes,g,m,y;for(g=0;g<s;++g)m=r[g],y=p[m],c[m]=g,a.push({functionName:`czm_batchTable_${m}`,componentDatatype:y.componentDatatype,componentsPerAttribute:y.componentsPerAttribute,normalize:y.normalize});r.indexOf("distanceDisplayCondition")!==-1&&(a.push({functionName:"czm_batchTable_boundingSphereCenter3DHigh",componentDatatype:K.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter3DLow",componentDatatype:K.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DHigh",componentDatatype:K.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DLow",componentDatatype:K.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereRadius",componentDatatype:K.FLOAT,componentsPerAttribute:1}),l.center3DHigh=a.length-5,l.center3DLow=a.length-4,l.center2DHigh=a.length-3,l.center2DLow=a.length-2,l.radius=a.length-1),r.indexOf("offset")!==-1&&(a.push({functionName:"czm_batchTable_offset2D",componentDatatype:K.FLOAT,componentsPerAttribute:3}),f=a.length-1),a.push({functionName:"czm_batchTable_pickColor",componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0});let b=a.length,C=new LC(t,a,o);for(g=0;g<o;++g){let A=i[g];p=A.attributes;for(let O=0;O<s;++O){m=r[O],y=p[m];let P=Vte(y.value),M=c[m];C.setBatchedAttribute(g,M,P)}let T={primitive:x(A.pickPrimitive,e)};u(A.id)&&(T.id=A.id);let E=t.createPickId(T);e._pickIds.push(E);let v=E.color,D=kte;D.x=G.floatToByte(v.red),D.y=G.floatToByte(v.green),D.z=G.floatToByte(v.blue),D.w=G.floatToByte(v.alpha),C.setBatchedAttribute(g,b-1,D)}e._batchTable=C,e._batchTableAttributeIndices=c,e._batchTableBoundingSphereAttributeIndices=l,e._batchTableOffsetAttribute2DIndex=f}function iLe(e){let t;return Array.isArray(e.values)?t=e.values.slice(0):t=new e.values.constructor(e.values),new ve({componentDatatype:e.componentDatatype,componentsPerAttribute:e.componentsPerAttribute,normalize:e.normalize,values:t})}function oLe(e){let t=e.attributes,n=new hn;for(let o in t)t.hasOwnProperty(o)&&u(t[o])&&(n[o]=iLe(t[o]));let i;if(u(e.indices)){let o=e.indices;Array.isArray(o)?i=o.slice(0):i=new o.constructor(o)}return new ft({attributes:n,indices:i,primitiveType:e.primitiveType,boundingSphere:ae.clone(e.boundingSphere)})}function rLe(e,t){return{geometry:t,attributes:e.attributes,modelMatrix:F.clone(e.modelMatrix),pickPrimitive:e.pickPrimitive,id:e.id}}var sLe=/in\s+vec(?:3|4)\s+(.*)3DHigh;/g;yr._modifyShaderPosition=function(e,t,n){let i,o="",r="",s="";for(;(i=sLe.exec(t))!==null;){let a=i[1],c=`vec4 czm_compute${a[0].toUpperCase()}${a.substr(1)}()`;c!=="vec4 czm_computePosition()"&&(o+=`${c};
`),u(e.rtcCenter)?(t=t.replace(/in\s+vec(?:3|4)\s+position3DHigh;/g,""),t=t.replace(/in\s+vec(?:3|4)\s+position3DLow;/g,""),o+=`uniform mat4 u_modifiedModelView;
`,r+=`in vec4 position;
`,s+=`${c}
{
    return u_modifiedModelView * position;
}

`,t=t.replace(/czm_modelViewRelativeToEye\s+\*\s+/g,""),t=t.replace(/czm_modelViewProjectionRelativeToEye/g,"czm_projection")):n?s+=`${c}
{
    return czm_translateRelativeToEye(${a}3DHigh, ${a}3DLow);
}

`:(r+=`in vec3 ${a}2DHigh;
in vec3 ${a}2DLow;
`,s+=`${c}
{
    vec4 p;
    if (czm_morphTime == 1.0)
    {
        p = czm_translateRelativeToEye(${a}3DHigh, ${a}3DLow);
    }
    else if (czm_morphTime == 0.0)
    {
        p = czm_translateRelativeToEye(${a}2DHigh.zxy, ${a}2DLow.zxy);
    }
    else
    {
        p = czm_columbusViewMorph(
                czm_translateRelativeToEye(${a}2DHigh.zxy, ${a}2DLow.zxy),
                czm_translateRelativeToEye(${a}3DHigh, ${a}3DLow),
                czm_morphTime);
    }
    return p;
}

`)}return[o,r,t,s].join(`
`)};yr._appendShowToShader=function(e,t){return u(e._batchTableAttributeIndices.show)?`${ze.replaceMain(t,"czm_non_show_main")}
void main() 
{ 
    czm_non_show_main(); 
    gl_Position *= czm_batchTable_show(batchId); 
}`:t};yr._updateColorAttribute=function(e,t,n){if(!u(e._batchTableAttributeIndices.color)&&!u(e._batchTableAttributeIndices.depthFailColor)||t.search(/in\s+vec4\s+color;/g)===-1)return t;let i=t;return i=i.replace(/in\s+vec4\s+color;/g,""),n?i=i.replace(/(\b)color(\b)/g,"$1czm_batchTable_depthFailColor(batchId)$2"):i=i.replace(/(\b)color(\b)/g,"$1czm_batchTable_color(batchId)$2"),i};function Pte(e){return`${ze.replaceMain(e,"czm_non_pick_main")}
out vec4 v_pickColor; 
void main() 
{ 
    czm_non_pick_main(); 
    v_pickColor = czm_batchTable_pickColor(batchId); 
}`}function Rte(e){return`in vec4 v_pickColor;
${e}`}yr._updatePickColorAttribute=function(e){let t=e.replace(/in\s+vec4\s+pickColor;/g,"");return t=t.replace(/(\b)pickColor(\b)/g,"$1czm_batchTable_pickColor(batchId)$2"),t};yr._appendOffsetToShader=function(e,t){if(!u(e._batchTableAttributeIndices.offset))return t;let n=`in float batchId;
`;n+="in float applyOffset;";let i=t.replace(/in\s+float\s+batchId;/g,n),o=`vec4 $1 = czm_computePosition();
`;return o+=`    if (czm_sceneMode == czm_sceneMode3D)
`,o+=`    {
`,o+="        $1 = $1 + vec4(czm_batchTable_offset(batchId) * applyOffset, 0.0);",o+=`    }
`,o+=`    else
`,o+=`    {
`,o+="        $1 = $1 + vec4(czm_batchTable_offset2D(batchId) * applyOffset, 0.0);",o+=`    }
`,i=i.replace(/vec4\s+([A-Za-z0-9_]+)\s+=\s+czm_computePosition\(\);/g,o),i};yr._appendDistanceDisplayConditionToShader=function(e,t,n){if(!u(e._batchTableAttributeIndices.distanceDisplayCondition))return t;let i=ze.replaceMain(t,"czm_non_distanceDisplayCondition_main"),o=`void main() 
{ 
    czm_non_distanceDisplayCondition_main(); 
    vec2 distanceDisplayCondition = czm_batchTable_distanceDisplayCondition(batchId);
    vec3 boundingSphereCenter3DHigh = czm_batchTable_boundingSphereCenter3DHigh(batchId);
    vec3 boundingSphereCenter3DLow = czm_batchTable_boundingSphereCenter3DLow(batchId);
    float boundingSphereRadius = czm_batchTable_boundingSphereRadius(batchId);
`;return n?o+=`    vec4 centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);
`:o+=`    vec3 boundingSphereCenter2DHigh = czm_batchTable_boundingSphereCenter2DHigh(batchId);
    vec3 boundingSphereCenter2DLow = czm_batchTable_boundingSphereCenter2DLow(batchId);
    vec4 centerRTE;
    if (czm_morphTime == 1.0)
    {
        centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);
    }
    else if (czm_morphTime == 0.0)
    {
        centerRTE = czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy);
    }
    else
    {
        centerRTE = czm_columbusViewMorph(
                czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy),
                czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow),
                czm_morphTime);
    }
`,o+=`    float radiusSq = boundingSphereRadius * boundingSphereRadius; 
    float distanceSq; 
    if (czm_sceneMode == czm_sceneMode2D) 
    { 
        distanceSq = czm_eyeHeight2D.y - radiusSq; 
    } 
    else 
    { 
        distanceSq = dot(centerRTE.xyz, centerRTE.xyz) - radiusSq; 
    } 
    distanceSq = max(distanceSq, 0.0); 
    float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x; 
    float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y; 
    float show = (distanceSq >= nearSq && distanceSq <= farSq) ? 1.0 : 0.0; 
    gl_Position *= show; 
}`,`${i}
${o}`};function Ote(e,t){if(!e.compressVertices)return t;let n=t.search(/in\s+vec3\s+normal;/g)!==-1,i=t.search(/in\s+vec2\s+st;/g)!==-1;if(!n&&!i)return t;let o=t.search(/in\s+vec3\s+tangent;/g)!==-1,r=t.search(/in\s+vec3\s+bitangent;/g)!==-1,s=i&&n?2:1;s+=o||r?1:0;let a=s>1?`vec${s}`:"float",c="compressedAttributes",l=`in ${a} ${c};`,f="",d="";if(i){f+=`vec2 st;
`;let m=s>1?`${c}.x`:c;d+=`    st = czm_decompressTextureCoordinates(${m});
`}n&&o&&r?(f+=`vec3 normal;
vec3 tangent;
vec3 bitangent;
`,d+=`    czm_octDecode(${c}.${i?"yz":"xy"}, normal, tangent, bitangent);
`):(n&&(f+=`vec3 normal;
`,d+=`    normal = czm_octDecode(${c}${s>1?`.${i?"y":"x"}`:""});
`),o&&(f+=`vec3 tangent;
`,d+=`    tangent = czm_octDecode(${c}.${i&&n?"z":"y"});
`),r&&(f+=`vec3 bitangent;
`,d+=`    bitangent = czm_octDecode(${c}.${i&&n?"z":"y"});
`));let p=t;p=p.replace(/in\s+vec3\s+normal;/g,""),p=p.replace(/in\s+vec2\s+st;/g,""),p=p.replace(/in\s+vec3\s+tangent;/g,""),p=p.replace(/in\s+vec3\s+bitangent;/g,""),p=ze.replaceMain(p,"czm_non_compressed_main");let g=`void main() 
{ 
${d}    czm_non_compressed_main(); 
}`;return[l,f,p,g].join(`
`)}function aLe(e){let t=ze.replaceMain(e,"czm_non_depth_clamp_main");return t+=`void main() {
    czm_non_depth_clamp_main();
    gl_Position = czm_depthClamp(gl_Position);}
`,t}function cLe(e){let t=ze.replaceMain(e,"czm_non_depth_clamp_main");return t+=`void main() {
    czm_non_depth_clamp_main();
    #if defined(LOG_DEPTH)
        czm_writeLogDepth();
    #else
        czm_writeDepthClamp();
    #endif
}
`,t}function Mte(e,t){let n=e.vertexAttributes}function lLe(e,t){return function(){return e[t]}}var d9=Math.max(Wt.hardwareConcurrency-1,1),vL,uLe=new xi("combineGeometry");function fLe(e,t){let n,i,o,r,s=e._instanceIds;if(e._state===Lr.READY){n=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];let a=e._numberOfInstances=n.length,c=[],l=[];for(o=0;o<a;++o)i=n[o].geometry,s.push(n[o].id),l.push({moduleName:i._workerName,modulePath:i._workerPath,geometry:i});if(!u(vL))for(vL=new Array(d9),o=0;o<d9;o++)vL[o]=new xi("createGeometry");let f;for(l=SL(l,d9),o=0;o<l.length;o++){let d=0,p=l[o],g=p.length;for(r=0;r<g;++r)f=p[r],i=f.geometry,u(i.constructor.pack)&&(f.offset=d,d+=x(i.constructor.packedLength,i.packedLength));let m;if(d>0){let y=new Float64Array(d);for(m=[y.buffer],r=0;r<g;++r)f=p[r],i=f.geometry,u(i.constructor.pack)&&(i.constructor.pack(i,y,f.offset),f.geometry=y)}c.push(vL[o].scheduleTask({subTasks:l[o]},m))}e._state=Lr.CREATING,Promise.all(c).then(function(d){e._createGeometryResults=d,e._state=Lr.CREATED}).catch(function(d){cv(e,t,Lr.FAILED,d)})}else if(e._state===Lr.CREATED){let a=[];n=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];let c=t.scene3DOnly,l=t.mapProjection,f=uLe.scheduleTask(NC.packCombineGeometryParameters({createGeometryResults:e._createGeometryResults,instances:n,ellipsoid:l.ellipsoid,projection:l,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:c,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets},a),a);e._createGeometryResults=void 0,e._state=Lr.COMBINING,Promise.resolve(f).then(function(d){let p=NC.unpackCombineGeometryResults(d);e._geometries=p.geometries,e._attributeLocations=p.attributeLocations,e.modelMatrix=F.clone(p.modelMatrix,e.modelMatrix),e._pickOffsets=p.pickOffsets,e._offsetInstanceExtend=p.offsetInstanceExtend,e._instanceBoundingSpheres=p.boundingSpheres,e._instanceBoundingSpheresCV=p.boundingSpheresCV,u(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=Lr.COMBINED):cv(e,t,Lr.FAILED,void 0)}).catch(function(d){cv(e,t,Lr.FAILED,d)})}}function dLe(e,t){let n=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances],i=e._numberOfInstances=n.length,o=new Array(i),r=e._instanceIds,s,a,c=0;for(a=0;a<i;a++){s=n[a];let p=s.geometry,g;u(p.attributes)&&u(p.primitiveType)?g=oLe(p):g=p.constructor.createGeometry(p),o[c++]=rLe(s,g),r.push(s.id)}o.length=c;let l=t.scene3DOnly,f=t.mapProjection,d=NC.combineGeometry({instances:o,ellipsoid:f.ellipsoid,projection:f,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:l,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets});e._geometries=d.geometries,e._attributeLocations=d.attributeLocations,e.modelMatrix=F.clone(d.modelMatrix,e.modelMatrix),e._pickOffsets=d.pickOffsets,e._offsetInstanceExtend=d.offsetInstanceExtend,e._instanceBoundingSpheres=d.boundingSpheres,e._instanceBoundingSpheresCV=d.boundingSpheresCV,u(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=Lr.COMBINED):cv(e,t,Lr.FAILED,void 0)}function hLe(e,t){let n=e._batchTableAttributeIndices.offset;if(!e._recomputeBoundingSpheres||!u(n)){e._recomputeBoundingSpheres=!1;return}let i,o=e._offsetInstanceExtend,r=e._instanceBoundingSpheres,s=r.length,a=e._tempBoundingSpheres;if(!u(a)){for(a=new Array(s),i=0;i<s;i++)a[i]=new ae;e._tempBoundingSpheres=a}for(i=0;i<s;++i){let y=a[i],b=e._batchTable.getBatchedAttribute(i,n,new h);y=r[i].clone(y),Gte(y,b,o[i])}let c=[],l=[],f=[];for(i=0;i<s;++i){let y=a[i];y.center.x-y.radius>0||ae.intersectPlane(y,cn.ORIGIN_ZX_PLANE)!==qt.INTERSECTING?c.push(y):(l.push(y),f.push(y))}let d=c[0],p=f[0],g=l[0];for(i=1;i<c.length;i++)d=ae.union(d,c[i]);for(i=1;i<f.length;i++)p=ae.union(p,f[i]);for(i=1;i<l.length;i++)g=ae.union(g,l[i]);let m=[];for(u(d)&&m.push(d),u(p)&&m.push(p),u(g)&&m.push(g),i=0;i<m.length;i++){let y=m[i].clone(e._boundingSpheres[i]);e._boundingSpheres[i]=y,e._boundingSphereCV[i]=ae.projectTo2D(y,t.mapProjection,e._boundingSphereCV[i])}yr._updateBoundingVolumes(e,t,e.modelMatrix,!0),e._recomputeBoundingSpheres=!1}var Lte=new Gn,Ute=new de,zte=new h,Hte=new ae;function mLe(e,t){if(!u(e._batchTableAttributeIndices.distanceDisplayCondition)||e._batchTableBoundingSpheresUpdated)return;let i=e._batchTableBoundingSphereAttributeIndices,o=i.center3DHigh,r=i.center3DLow,s=i.center2DHigh,a=i.center2DLow,c=i.radius,l=t.mapProjection,f=l.ellipsoid,d=e._batchTable,p=e._instanceBoundingSpheres,g=p.length;for(let m=0;m<g;++m){let y=p[m];if(!u(y))continue;let b=e.modelMatrix;u(b)&&(y=ae.transform(y,b,Hte));let C=y.center,A=y.radius,T=Gn.fromCartesian(C,Lte);if(d.setBatchedAttribute(m,o,T.high),d.setBatchedAttribute(m,r,T.low),!t.scene3DOnly){let E=f.cartesianToCartographic(C,Ute),v=l.project(E,zte);T=Gn.fromCartesian(v,Lte),d.setBatchedAttribute(m,s,T.high),d.setBatchedAttribute(m,a,T.low)}d.setBatchedAttribute(m,c,A)}e._batchTableBoundingSpheresUpdated=!0}var h9=new h,pLe=new h;function Nte(e,t){if(!u(e._batchTableAttributeIndices.offset)||e._batchTableOffsetsUpdated||t.scene3DOnly)return;let i=e._batchTableOffsetAttribute2DIndex,o=t.mapProjection,r=o.ellipsoid,s=e._batchTable,a=e._instanceBoundingSpheres,c=a.length;for(let l=0;l<c;++l){let f=a[l];if(!u(f))continue;let d=s.getBatchedAttribute(l,e._batchTableAttributeIndices.offset);if(h.equals(d,h.ZERO)){s.setBatchedAttribute(l,i,h.ZERO);continue}let p=e.modelMatrix;u(p)&&(f=ae.transform(f,p,Hte));let g=f.center;g=r.scaleToGeodeticSurface(g,pLe);let m=r.cartesianToCartographic(g,Ute),y=o.project(m,zte),b=h.add(d,g,h9);m=r.cartesianToCartographic(b,m);let C=o.project(m,h9),A=h.subtract(C,y,h9),T=A.x;A.x=A.z,A.z=A.y,A.y=T,s.setBatchedAttribute(l,i,A)}e._batchTableOffsetsUpdated=!0}function _Le(e,t){let n=e._attributeLocations,i=e._geometries,o=t.scene3DOnly,r=t.context,s=[],a=i.length;for(let c=0;c<a;++c){let l=i[c];if(s.push(ii.fromGeometry({context:r,geometry:l,attributeLocations:n,bufferUsage:ke.STATIC_DRAW,interleave:e._interleave})),u(e._createBoundingVolumeFunction))e._createBoundingVolumeFunction(t,l);else if(e._boundingSpheres.push(ae.clone(l.boundingSphere)),e._boundingSphereWC.push(new ae),!o){let f=l.boundingSphereCV.center,d=f.x,p=f.y,g=f.z;f.x=g,f.y=d,f.z=p,e._boundingSphereCV.push(ae.clone(l.boundingSphereCV)),e._boundingSphere2D.push(new ae),e._boundingSphereMorph.push(new ae)}}e._va=s,e._primitiveType=i[0].primitiveType,e.releaseGeometryInstances&&(e.geometryInstances=void 0),e._geometries=void 0,cv(e,t,Lr.COMPLETE,void 0)}function gLe(e,t,n,i){let o=n.getRenderState(),r;i?(r=Ge(o,!1),r.cull={enabled:!0,face:Ci.BACK},e._frontFaceRS=Ue.fromCache(r),r.cull.face=Ci.FRONT,e._backFaceRS=Ue.fromCache(r)):(e._frontFaceRS=Ue.fromCache(o),e._backFaceRS=e._frontFaceRS),r=Ge(o,!1),u(e._depthFailAppearance)&&(r.depthTest.enabled=!1),u(e._depthFailAppearance)&&(o=e._depthFailAppearance.getRenderState(),r=Ge(o,!1),r.depthTest.func=wc.GREATER,i?(r.cull={enabled:!0,face:Ci.BACK},e._frontFaceDepthFailRS=Ue.fromCache(r),r.cull.face=Ci.FRONT,e._backFaceDepthFailRS=Ue.fromCache(r)):(e._frontFaceDepthFailRS=Ue.fromCache(r),e._backFaceDepthFailRS=e._frontFaceRS))}function yLe(e,t,n){let i=t.context,o=e._attributeLocations,r=e._batchTable.getVertexShaderCallback()(n.vertexShaderSource);r=yr._appendOffsetToShader(e,r),r=yr._appendShowToShader(e,r),r=yr._appendDistanceDisplayConditionToShader(e,r,t.scene3DOnly),r=Pte(r),r=yr._updateColorAttribute(e,r,!1),r=Ote(e,r),r=yr._modifyShaderPosition(e,r,t.scene3DOnly);let s=n.getFragmentShaderSource();s=Rte(s),e._sp=tn.replaceCache({context:i,shaderProgram:e._sp,vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:o}),Mte(e._sp,o),u(e._depthFailAppearance)&&(r=e._batchTable.getVertexShaderCallback()(e._depthFailAppearance.vertexShaderSource),r=yr._appendShowToShader(e,r),r=yr._appendDistanceDisplayConditionToShader(e,r,t.scene3DOnly),r=Pte(r),r=yr._updateColorAttribute(e,r,!0),r=Ote(e,r),r=yr._modifyShaderPosition(e,r,t.scene3DOnly),r=aLe(r),s=e._depthFailAppearance.getFragmentShaderSource(),s=Rte(s),s=cLe(s),e._spDepthFail=tn.replaceCache({context:i,shaderProgram:e._spDepthFail,vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:o}),Mte(e._spDepthFail,o))}var av=new F,Fte=new h;function Bte(e,t,n,i){let o=u(n)?n._uniforms:void 0,r={},s=t.uniforms;if(u(s))for(let c in s)s.hasOwnProperty(c)&&(r[c]=lLe(s,c));let a=bt(r,o);return a=e._batchTable.getUniformMapCallback()(a),u(e.rtcCenter)&&(a.u_modifiedModelView=function(){let c=i.context.uniformState.view;return F.multiply(c,e._modelMatrix,av),F.multiplyByPoint(av,e.rtcCenter,Fte),F.setTranslation(av,Fte,av),av}),a}function xLe(e,t,n,i,o,r,s,a){let c=Bte(e,t,n,a),l;u(e._depthFailAppearance)&&(l=Bte(e,e._depthFailAppearance,e._depthFailAppearance.material,a));let f=i?we.TRANSLUCENT:we.OPAQUE,d=o?2:1;d*=u(e._depthFailAppearance)?2:1,r.length=e._va.length*d;let p=r.length,g=0;for(let m=0;m<p;++m){let y;o&&(y=r[m],u(y)||(y=r[m]=new Qe({owner:e,primitiveType:e._primitiveType})),y.vertexArray=e._va[g],y.renderState=e._backFaceRS,y.shaderProgram=e._sp,y.uniformMap=c,y.pass=f,++m),y=r[m],u(y)||(y=r[m]=new Qe({owner:e,primitiveType:e._primitiveType})),y.vertexArray=e._va[g],y.renderState=e._frontFaceRS,y.shaderProgram=e._sp,y.uniformMap=c,y.pass=f,u(e._depthFailAppearance)&&(o&&(++m,y=r[m],u(y)||(y=r[m]=new Qe({owner:e,primitiveType:e._primitiveType})),y.vertexArray=e._va[g],y.renderState=e._backFaceDepthFailRS,y.shaderProgram=e._spDepthFail,y.uniformMap=l,y.pass=f),++m,y=r[m],u(y)||(y=r[m]=new Qe({owner:e,primitiveType:e._primitiveType})),y.vertexArray=e._va[g],y.renderState=e._frontFaceDepthFailRS,y.shaderProgram=e._spDepthFail,y.uniformMap=l,y.pass=f),++g}}yr._updateBoundingVolumes=function(e,t,n,i){let o,r,s;if(i||!F.equals(n,e._modelMatrix))for(F.clone(n,e._modelMatrix),r=e._boundingSpheres.length,o=0;o<r;++o)s=e._boundingSpheres[o],u(s)&&(e._boundingSphereWC[o]=ae.transform(s,n,e._boundingSphereWC[o]),t.scene3DOnly||(e._boundingSphere2D[o]=ae.clone(e._boundingSphereCV[o],e._boundingSphere2D[o]),e._boundingSphere2D[o].center.x=0,e._boundingSphereMorph[o]=ae.union(e._boundingSphereWC[o],e._boundingSphereCV[o])));let a=e.appearance.pixelSize;if(u(a))for(r=e._boundingSpheres.length,o=0;o<r;++o){s=e._boundingSpheres[o];let c=e._boundingSphereWC[o],f=t.camera.getPixelSize(s,t.context.drawingBufferWidth,t.context.drawingBufferHeight)*a;c.radius=s.radius+f}};function bLe(e,t,n,i,o,r,s,a){yr._updateBoundingVolumes(e,t,o);let c;t.mode===ne.SCENE3D?c=e._boundingSphereWC:t.mode===ne.COLUMBUS_VIEW?c=e._boundingSphereCV:t.mode===ne.SCENE2D&&u(e._boundingSphere2D)?c=e._boundingSphere2D:u(e._boundingSphereMorph)&&(c=e._boundingSphereMorph);let l=t.commandList,f=t.passes;if(f.render||f.pick){let d=e.allowPicking,p=xn.castShadows(e.shadows),g=xn.receiveShadows(e.shadows),m=n.length,y=a?2:1;y*=u(e._depthFailAppearance)?2:1;for(let b=0;b<m;++b){let C=Math.floor(b/y),A=n[b];A.modelMatrix=o,A.boundingVolume=c[C],A.cull=r,A.debugShowBoundingVolume=s,A.castShadows=p,A.receiveShadows=g,d?A.pickId="v_pickColor":A.pickId=void 0,l.push(A)}}}yr.prototype.update=function(e){if(!u(this.geometryInstances)&&this._va.length===0||u(this.geometryInstances)&&Array.isArray(this.geometryInstances)&&this.geometryInstances.length===0||!u(this.appearance)||e.mode!==ne.SCENE3D&&e.scene3DOnly||!e.passes.render&&!e.passes.pick)return;if(u(this._error))throw this._error;if(this._state===Lr.FAILED)return;let t=e.context;if(u(this._batchTable)||nLe(this,t),this._batchTable.attributes.length>0){if(Vt.maximumVertexTextureImageUnits===0)throw new ce("Vertex texture fetch support is required to render primitives with per-instance attributes. The maximum number of vertex texture image units must be greater than zero.");this._batchTable.update(e)}if(this._state!==Lr.COMPLETE&&this._state!==Lr.COMBINED&&(this.asynchronous?fLe(this,e):dLe(this,e)),this._state===Lr.COMBINED&&(mLe(this,e),Nte(this,e),_Le(this,e)),!this.show||this._state!==Lr.COMPLETE)return;this._batchTableOffsetsUpdated||Nte(this,e),this._recomputeBoundingSpheres&&hLe(this,e);let n=this.appearance,i=n.material,o=!1,r=!1;this._appearance!==n?(this._appearance=n,this._material=i,o=!0,r=!0):this._material!==i&&(this._material=i,r=!0);let s=this.depthFailAppearance,a=u(s)?s.material:void 0;this._depthFailAppearance!==s?(this._depthFailAppearance=s,this._depthFailMaterial=a,o=!0,r=!0):this._depthFailMaterial!==a&&(this._depthFailMaterial=a,r=!0);let c=this._appearance.isTranslucent();this._translucent!==c&&(this._translucent=c,o=!0),u(this._material)&&this._material.update(t);let l=n.closed&&c;o&&x(this._createRenderStatesFunction,gLe)(this,t,n,l),r&&x(this._createShaderProgramFunction,yLe)(this,e,n),(o||r)&&x(this._createCommandsFunction,xLe)(this,n,i,c,l,this._colorCommands,this._pickCommands,e),x(this._updateAndQueueCommandsFunction,bLe)(this,e,this._colorCommands,this._pickCommands,this.modelMatrix,this.cull,this.debugShowBoundingVolume,l)};var CLe=new ae,ALe=new ae;function Gte(e,t,n){if(n===an.TOP){let i=ae.clone(e,CLe),o=ae.clone(e,ALe);o.center=h.add(o.center,t,o.center),e=ae.union(i,o,e)}else n===an.ALL&&(e.center=h.add(e.center,t,e.center));return e}function TLe(e,t,n){return function(){let i=e.getBatchedAttribute(t,n),o=e.attributes[n],r=o.componentsPerAttribute,s=K.createTypedArray(o.componentDatatype,r);return u(i.constructor.pack)?i.constructor.pack(i,s,0):s[0]=i,s}}function ELe(e,t,n,i,o){return function(r){let s=Vte(r);e.setBatchedAttribute(t,n,s),o==="offset"&&(i._recomputeBoundingSpheres=!0,i._batchTableOffsetsUpdated=!1)}}var SLe=new h;function vLe(e,t,n){t.boundingSphere={get:function(){let i=e._instanceBoundingSpheres[n];if(u(i)){i=i.clone();let o=e.modelMatrix,r=t.offset;u(r)&&Gte(i,h.fromArray(r.get(),0,SLe),e._offsetInstanceExtend[n]),u(o)&&(i=ae.transform(i,o))}return i}},t.boundingSphereCV={get:function(){return e._instanceBoundingSpheresCV[n]}}}function wLe(e,t,n){t.pickId={get:function(){return e._pickIds[n]}}}yr.prototype.getGeometryInstanceAttributes=function(e){let t=this._perInstanceAttributeCache.get(e);if(u(t))return t;let n=-1,i=this._lastPerInstanceAttributeIndex,o=this._instanceIds,r=o.length;for(let l=0;l<r;++l){let f=(i+l)%r;if(e===o[f]){n=f;break}}if(n===-1)return;let s=this._batchTable,a=this._batchTableAttributeIndices;t={};let c={};for(let l in a)if(a.hasOwnProperty(l)){let f=a[l];c[l]={get:TLe(s,n,f),set:ELe(s,n,f,this,l)}}return vLe(this,c,n),wLe(this,c,n),Object.defineProperties(t,c),this._lastPerInstanceAttributeIndex=n,this._perInstanceAttributeCache.set(e,t),t};yr.prototype.isDestroyed=function(){return!1};yr.prototype.destroy=function(){let e,t;this._sp=this._sp&&this._sp.destroy(),this._spDepthFail=this._spDepthFail&&this._spDepthFail.destroy();let n=this._va;for(e=n.length,t=0;t<e;++t)n[t].destroy();this._va=void 0;let i=this._pickIds;for(e=i.length,t=0;t<e;++t)i[t].destroy();return this._pickIds=void 0,this._batchTable=this._batchTable&&this._batchTable.destroy(),this._instanceIds=void 0,this._perInstanceAttributeCache=void 0,this._attributeLocations=void 0,ue(this)};function cv(e,t,n,i){e._error=i,e._state=n,t.afterRender.push(function(){e._ready=e._state===Lr.COMPLETE||e._state===Lr.FAILED})}var In=yr;function DLe(e){e=x(e,x.EMPTY_OBJECT),this.componentDatatype=e.componentDatatype,this.componentsPerAttribute=e.componentsPerAttribute,this.normalize=x(e.normalize,!1),this.value=e.value}var Dc=DLe;var lv=`#ifdef TEXTURE_COORDINATES
#ifdef SPHERICAL
in vec4 v_sphericalExtents;
#else // SPHERICAL
in vec2 v_inversePlaneExtents;
in vec4 v_westPlane;
in vec4 v_southPlane;
#endif // SPHERICAL
in vec3 v_uvMinAndSphericalLongitudeRotation;
in vec3 v_uMaxAndInverseDistance;
in vec3 v_vMaxAndInverseDistance;
#endif // TEXTURE_COORDINATES

#ifdef PER_INSTANCE_COLOR
in vec4 v_color;
#endif

#ifdef NORMAL_EC
vec3 getEyeCoordinate3FromWindowCoordinate(vec2 fragCoord, float logDepthOrDepth) {
    vec4 eyeCoordinate = czm_windowToEyeCoordinates(fragCoord, logDepthOrDepth);
    return eyeCoordinate.xyz / eyeCoordinate.w;
}

vec3 vectorFromOffset(vec4 eyeCoordinate, vec2 positiveOffset) {
    vec2 glFragCoordXY = gl_FragCoord.xy;
    // Sample depths at both offset and negative offset
    float upOrRightLogDepth = czm_unpackDepth(texture(czm_globeDepthTexture, (glFragCoordXY + positiveOffset) / czm_viewport.zw));
    float downOrLeftLogDepth = czm_unpackDepth(texture(czm_globeDepthTexture, (glFragCoordXY - positiveOffset) / czm_viewport.zw));
    // Explicitly evaluate both paths
    // Necessary for multifrustum and for edges of the screen
    bvec2 upOrRightInBounds = lessThan(glFragCoordXY + positiveOffset, czm_viewport.zw);
    float useUpOrRight = float(upOrRightLogDepth > 0.0 && upOrRightInBounds.x && upOrRightInBounds.y);
    float useDownOrLeft = float(useUpOrRight == 0.0);
    vec3 upOrRightEC = getEyeCoordinate3FromWindowCoordinate(glFragCoordXY + positiveOffset, upOrRightLogDepth);
    vec3 downOrLeftEC = getEyeCoordinate3FromWindowCoordinate(glFragCoordXY - positiveOffset, downOrLeftLogDepth);
    return (upOrRightEC - (eyeCoordinate.xyz / eyeCoordinate.w)) * useUpOrRight + ((eyeCoordinate.xyz / eyeCoordinate.w) - downOrLeftEC) * useDownOrLeft;
}
#endif // NORMAL_EC

void main(void)
{
#ifdef REQUIRES_EC
    float logDepthOrDepth = czm_unpackDepth(texture(czm_globeDepthTexture, gl_FragCoord.xy / czm_viewport.zw));
    vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);
#endif

#ifdef REQUIRES_WC
    vec4 worldCoordinate4 = czm_inverseView * eyeCoordinate;
    vec3 worldCoordinate = worldCoordinate4.xyz / worldCoordinate4.w;
#endif

#ifdef TEXTURE_COORDINATES
    vec2 uv;
#ifdef SPHERICAL
    // Treat world coords as a sphere normal for spherical coordinates
    vec2 sphericalLatLong = czm_approximateSphericalCoordinates(worldCoordinate);
    sphericalLatLong.y += v_uvMinAndSphericalLongitudeRotation.z;
    sphericalLatLong.y = czm_branchFreeTernary(sphericalLatLong.y < czm_pi, sphericalLatLong.y, sphericalLatLong.y - czm_twoPi);
    uv.x = (sphericalLatLong.y - v_sphericalExtents.y) * v_sphericalExtents.w;
    uv.y = (sphericalLatLong.x - v_sphericalExtents.x) * v_sphericalExtents.z;
#else // SPHERICAL
    // Unpack planes and transform to eye space
    uv.x = czm_planeDistance(v_westPlane, eyeCoordinate.xyz / eyeCoordinate.w) * v_inversePlaneExtents.x;
    uv.y = czm_planeDistance(v_southPlane, eyeCoordinate.xyz / eyeCoordinate.w) * v_inversePlaneExtents.y;
#endif // SPHERICAL
#endif // TEXTURE_COORDINATES

#ifdef PICK
#ifdef CULL_FRAGMENTS
    // When classifying translucent geometry, logDepthOrDepth == 0.0
    // indicates a region that should not be classified, possibly due to there
    // being opaque pixels there in another buffer.
    // Check for logDepthOrDepth != 0.0 to make sure this should be classified.
    if (0.0 <= uv.x && uv.x <= 1.0 && 0.0 <= uv.y && uv.y <= 1.0 || logDepthOrDepth != 0.0) {
        out_FragColor.a = 1.0; // 0.0 alpha leads to discard from ShaderSource.createPickFragmentShaderSource
        czm_writeDepthClamp();
    }
#else // CULL_FRAGMENTS
        out_FragColor.a = 1.0;
#endif // CULL_FRAGMENTS
#else // PICK

#ifdef CULL_FRAGMENTS
    // When classifying translucent geometry, logDepthOrDepth == 0.0
    // indicates a region that should not be classified, possibly due to there
    // being opaque pixels there in another buffer.
    if (uv.x <= 0.0 || 1.0 <= uv.x || uv.y <= 0.0 || 1.0 <= uv.y || logDepthOrDepth == 0.0) {
        discard;
    }
#endif

#ifdef NORMAL_EC
    // Compute normal by sampling adjacent pixels in 2x2 block in screen space
    vec3 downUp = vectorFromOffset(eyeCoordinate, vec2(0.0, 1.0));
    vec3 leftRight = vectorFromOffset(eyeCoordinate, vec2(1.0, 0.0));
    vec3 normalEC = normalize(cross(leftRight, downUp));
#endif


#ifdef PER_INSTANCE_COLOR

    vec4 color = czm_gammaCorrect(v_color);
#ifdef FLAT
    out_FragColor = color;
#else // FLAT
    czm_materialInput materialInput;
    materialInput.normalEC = normalEC;
    materialInput.positionToEyeEC = -eyeCoordinate.xyz;
    czm_material material = czm_getDefaultMaterial(materialInput);
    material.diffuse = color.rgb;
    material.alpha = color.a;

    out_FragColor = czm_phong(normalize(-eyeCoordinate.xyz), material, czm_lightDirectionEC);
#endif // FLAT

    // Premultiply alpha. Required for classification primitives on translucent globe.
    out_FragColor.rgb *= out_FragColor.a;

#else // PER_INSTANCE_COLOR

    // Material support.
    // USES_ is distinct from REQUIRES_, because some things are dependencies of each other or
    // dependencies for culling but might not actually be used by the material.

    czm_materialInput materialInput;

#ifdef USES_NORMAL_EC
    materialInput.normalEC = normalEC;
#endif

#ifdef USES_POSITION_TO_EYE_EC
    materialInput.positionToEyeEC = -eyeCoordinate.xyz;
#endif

#ifdef USES_TANGENT_TO_EYE
    materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(worldCoordinate, normalEC);
#endif

#ifdef USES_ST
    // Remap texture coordinates from computed (approximately aligned with cartographic space) to the desired
    // texture coordinate system, which typically forms a tight oriented bounding box around the geometry.
    // Shader is provided a set of reference points for remapping.
    materialInput.st.x = czm_lineDistance(v_uvMinAndSphericalLongitudeRotation.xy, v_uMaxAndInverseDistance.xy, uv) * v_uMaxAndInverseDistance.z;
    materialInput.st.y = czm_lineDistance(v_uvMinAndSphericalLongitudeRotation.xy, v_vMaxAndInverseDistance.xy, uv) * v_vMaxAndInverseDistance.z;
#endif

    czm_material material = czm_getMaterial(materialInput);

#ifdef FLAT
    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#else // FLAT
    out_FragColor = czm_phong(normalize(-eyeCoordinate.xyz), material, czm_lightDirectionEC);
#endif // FLAT

    // Premultiply alpha. Required for classification primitives on translucent globe.
    out_FragColor.rgb *= out_FragColor.a;

#endif // PER_INSTANCE_COLOR
    czm_writeDepthClamp();
#endif // PICK
}
`;function nf(e,t,n){this._projectionExtentDefines={eastMostYhighDefine:"",eastMostYlowDefine:"",westMostYhighDefine:"",westMostYlowDefine:""};let i=new m9;i.requiresTextureCoordinates=e,i.requiresEC=!n.flat;let o=new m9;if(o.requiresTextureCoordinates=e,n instanceof ln)i.requiresNormalEC=!n.flat;else{let r=`${n.material.shaderSource}
${n.fragmentShaderSource}`;i.normalEC=r.indexOf("materialInput.normalEC")!==-1||r.indexOf("czm_getDefaultMaterial")!==-1,i.positionToEyeEC=r.indexOf("materialInput.positionToEyeEC")!==-1,i.tangentToEyeMatrix=r.indexOf("materialInput.tangentToEyeMatrix")!==-1,i.st=r.indexOf("materialInput.st")!==-1}this._colorShaderDependencies=i,this._pickShaderDependencies=o,this._appearance=n,this._extentsCulling=e,this._planarExtents=t}nf.prototype.createFragmentShader=function(e){let t=this._appearance,n=this._colorShaderDependencies,i=[];!e&&!this._planarExtents&&i.push("SPHERICAL"),n.requiresEC&&i.push("REQUIRES_EC"),n.requiresWC&&i.push("REQUIRES_WC"),n.requiresTextureCoordinates&&i.push("TEXTURE_COORDINATES"),this._extentsCulling&&i.push("CULL_FRAGMENTS"),n.requiresNormalEC&&i.push("NORMAL_EC"),t instanceof ln&&i.push("PER_INSTANCE_COLOR"),n.normalEC&&i.push("USES_NORMAL_EC"),n.positionToEyeEC&&i.push("USES_POSITION_TO_EYE_EC"),n.tangentToEyeMatrix&&i.push("USES_TANGENT_TO_EYE"),n.st&&i.push("USES_ST"),t.flat&&i.push("FLAT");let o="";return t instanceof ln||(o=t.material.shaderSource),new ze({defines:i,sources:[o,lv]})};nf.prototype.createPickFragmentShader=function(e){let t=this._pickShaderDependencies,n=["PICK"];return!e&&!this._planarExtents&&n.push("SPHERICAL"),t.requiresEC&&n.push("REQUIRES_EC"),t.requiresWC&&n.push("REQUIRES_WC"),t.requiresTextureCoordinates&&n.push("TEXTURE_COORDINATES"),this._extentsCulling&&n.push("CULL_FRAGMENTS"),new ze({defines:n,sources:[lv],pickColorQualifier:"in"})};nf.prototype.createVertexShader=function(e,t,n,i){return $te(this._colorShaderDependencies,this._planarExtents,n,e,t,this._appearance,i,this._projectionExtentDefines)};nf.prototype.createPickVertexShader=function(e,t,n,i){return $te(this._pickShaderDependencies,this._planarExtents,n,e,t,void 0,i,this._projectionExtentDefines)};var Wte=new h,jte=new de,qte={high:0,low:0};function $te(e,t,n,i,o,r,s,a){let c=i.slice();if(a.eastMostYhighDefine===""){let l=jte;l.longitude=R.PI,l.latitude=0,l.height=0;let f=s.project(l,Wte),d=Gn.encode(f.x,qte);a.eastMostYhighDefine=`EAST_MOST_X_HIGH ${d.high.toFixed(`${d.high}`.length+1)}`,a.eastMostYlowDefine=`EAST_MOST_X_LOW ${d.low.toFixed(`${d.low}`.length+1)}`;let p=jte;p.longitude=-R.PI,p.latitude=0,p.height=0;let g=s.project(p,Wte);d=Gn.encode(g.x,qte),a.westMostYhighDefine=`WEST_MOST_X_HIGH ${d.high.toFixed(`${d.high}`.length+1)}`,a.westMostYlowDefine=`WEST_MOST_X_LOW ${d.low.toFixed(`${d.low}`.length+1)}`}return n&&(c.push(a.eastMostYhighDefine),c.push(a.eastMostYlowDefine),c.push(a.westMostYhighDefine),c.push(a.westMostYlowDefine)),u(r)&&r instanceof ln&&c.push("PER_INSTANCE_COLOR"),e.requiresTextureCoordinates&&(c.push("TEXTURE_COORDINATES"),t||n||c.push("SPHERICAL"),n&&c.push("COLUMBUS_VIEW_2D")),new ze({defines:c,sources:[o]})}function m9(){this._requiresEC=!1,this._requiresWC=!1,this._requiresNormalEC=!1,this._requiresTextureCoordinates=!1,this._usesNormalEC=!1,this._usesPositionToEyeEC=!1,this._usesTangentToEyeMat=!1,this._usesSt=!1}Object.defineProperties(m9.prototype,{requiresEC:{get:function(){return this._requiresEC},set:function(e){this._requiresEC=e||this._requiresEC}},requiresWC:{get:function(){return this._requiresWC},set:function(e){this._requiresWC=e||this._requiresWC,this.requiresEC=this._requiresWC}},requiresNormalEC:{get:function(){return this._requiresNormalEC},set:function(e){this._requiresNormalEC=e||this._requiresNormalEC,this.requiresEC=this._requiresNormalEC}},requiresTextureCoordinates:{get:function(){return this._requiresTextureCoordinates},set:function(e){this._requiresTextureCoordinates=e||this._requiresTextureCoordinates,this.requiresWC=this._requiresTextureCoordinates}},normalEC:{set:function(e){this.requiresNormalEC=e,this._usesNormalEC=e},get:function(){return this._usesNormalEC}},tangentToEyeMatrix:{set:function(e){this.requiresWC=e,this.requiresNormalEC=e,this._usesTangentToEyeMat=e},get:function(){return this._usesTangentToEyeMat}},positionToEyeEC:{set:function(e){this.requiresEC=e,this._usesPositionToEyeEC=e},get:function(){return this._usesPositionToEyeEC}},st:{set:function(e){this.requiresTextureCoordinates=e,this._usesSt=e},get:function(){return this._usesSt}}});function Yte(e,t,n){return Math.abs((t.y-e.y)*n.x-(t.x-e.x)*n.y+t.x*e.y-t.y*e.x)/H.distance(t,e)}var ILe=[new H,new H,new H,new H];function Qte(e,t){let n=ILe,i=H.unpack(t,0,n[0]),o=H.unpack(t,2,n[1]),r=H.unpack(t,4,n[2]);e.uMaxVmax=new Dc({componentDatatype:K.FLOAT,componentsPerAttribute:4,normalize:!1,value:[o.x,o.y,r.x,r.y]});let s=1/Yte(i,o,r),a=1/Yte(i,r,o);e.uvMinAndExtents=new Dc({componentDatatype:K.FLOAT,componentsPerAttribute:4,normalize:!1,value:[i.x,i.y,s,a]})}var Jte=new de,ene=new h,PLe=new h,RLe=new h,wL={high:0,low:0};function tne(e,t,n){let i=Jte;i.height=0,i.longitude=e.west,i.latitude=e.south;let o=t.project(i,ene);i.latitude=e.north;let r=t.project(i,PLe);i.longitude=e.east,i.latitude=e.south;let s=t.project(i,RLe),a=[0,0,0,0],c=[0,0,0,0],l=Gn.encode(o.x,wL);a[0]=l.high,c[0]=l.low,l=Gn.encode(o.y,wL),a[1]=l.high,c[1]=l.low,l=Gn.encode(r.y,wL),a[2]=l.high,c[2]=l.low,l=Gn.encode(s.x,wL),a[3]=l.high,c[3]=l.low,n.planes2D_HIGH=new Dc({componentDatatype:K.FLOAT,componentsPerAttribute:4,normalize:!1,value:a}),n.planes2D_LOW=new Dc({componentDatatype:K.FLOAT,componentsPerAttribute:4,normalize:!1,value:c})}var OLe=new F,MLe=new F,Xte=new h,LLe=new de,NLe=[new de,new de,new de,new de,new de,new de,new de,new de];function FLe(e,t,n,i,o,r){let s=se.center(e,LLe);s.height=n;let a=de.toCartesian(s,t,Xte),c=Lt.eastNorthUpToFixedFrame(a,t,OLe),l=F.inverse(c,MLe),f=e.west,d=e.east,p=e.north,g=e.south,m=NLe;m[0].latitude=g,m[0].longitude=f,m[1].latitude=p,m[1].longitude=f,m[2].latitude=p,m[2].longitude=d,m[3].latitude=g,m[3].longitude=d;let y=(f+d)*.5,b=(p+g)*.5;m[4].latitude=g,m[4].longitude=y,m[5].latitude=p,m[5].longitude=y,m[6].latitude=b,m[6].longitude=f,m[7].latitude=b,m[7].longitude=d;let C=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY,T=Number.POSITIVE_INFINITY,E=Number.NEGATIVE_INFINITY;for(let P=0;P<8;P++){m[P].height=n;let M=de.toCartesian(m[P],t,Xte);F.multiplyByPoint(l,M,M),M.z=0,C=Math.min(C,M.x),A=Math.max(A,M.x),T=Math.min(T,M.y),E=Math.max(E,M.y)}let v=i;v.x=C,v.y=T,v.z=0,F.multiplyByPoint(c,v,v);let D=o;D.x=A,D.y=T,D.z=0,F.multiplyByPoint(c,D,D),h.subtract(D,v,o);let O=r;O.x=C,O.y=E,O.z=0,F.multiplyByPoint(c,O,O),h.subtract(O,v,r)}var BLe=new h,kLe=new h,VLe=new Gn;nf.getPlanarTextureCoordinateAttributes=function(e,t,n,i,o){let r=ene,s=BLe,a=kLe;FLe(e,n,x(o,0),r,s,a);let c={};Qte(c,t);let l=Gn.fromCartesian(r,VLe);return c.southWest_HIGH=new Dc({componentDatatype:K.FLOAT,componentsPerAttribute:3,normalize:!1,value:h.pack(l.high,[0,0,0])}),c.southWest_LOW=new Dc({componentDatatype:K.FLOAT,componentsPerAttribute:3,normalize:!1,value:h.pack(l.low,[0,0,0])}),c.eastward=new Dc({componentDatatype:K.FLOAT,componentsPerAttribute:3,normalize:!1,value:h.pack(s,[0,0,0])}),c.northward=new Dc({componentDatatype:K.FLOAT,componentsPerAttribute:3,normalize:!1,value:h.pack(a,[0,0,0])}),tne(e,i,c),c};var ULe=new h;function Kte(e,t,n,i){let o=Jte;o.latitude=e,o.longitude=t,o.height=0;let r=de.toCartesian(o,n,ULe),s=Math.sqrt(r.x*r.x+r.y*r.y),a=R.fastApproximateAtan2(s,r.z),c=R.fastApproximateAtan2(r.x,r.y);return i.x=a,i.y=c,i}var Zte=new H;nf.getSphericalExtentGeometryInstanceAttributes=function(e,t,n,i){let o=Kte(e.south,e.west,n,Zte),r=o.x,s=o.y,a=Kte(e.north,e.east,n,Zte),c=a.x,l=a.y,f=0;s>l&&(f=R.PI-s,s=-R.PI,l+=f),r-=R.EPSILON5,s-=R.EPSILON5,c+=R.EPSILON5,l+=R.EPSILON5;let d=1/(l-s),p=1/(c-r),g={sphericalExtents:new Dc({componentDatatype:K.FLOAT,componentsPerAttribute:4,normalize:!1,value:[r,s,p,d]}),longitudeRotation:new Dc({componentDatatype:K.FLOAT,componentsPerAttribute:1,normalize:!1,value:[f]})};return Qte(g,t),tne(e,i,g),g};nf.hasAttributesForTextureCoordinatePlanes=function(e){return u(e.southWest_HIGH)&&u(e.southWest_LOW)&&u(e.northward)&&u(e.eastward)&&u(e.planes2D_HIGH)&&u(e.planes2D_LOW)&&u(e.uMaxVmax)&&u(e.uvMinAndExtents)};nf.hasAttributesForSphericalExtents=function(e){return u(e.sphericalExtents)&&u(e.longitudeRotation)&&u(e.planes2D_HIGH)&&u(e.planes2D_LOW)&&u(e.uMaxVmax)&&u(e.uvMinAndExtents)};function zLe(e){return Math.max(e.width,e.height)>nf.MAX_WIDTH_FOR_PLANAR_EXTENTS}nf.shouldUseSphericalCoordinates=function(e){return zLe(e)};nf.MAX_WIDTH_FOR_PLANAR_EXTENTS=R.toRadians(1);var of=nf;var HLe={NEVER:te.NEVER,LESS:te.LESS,EQUAL:te.EQUAL,LESS_OR_EQUAL:te.LEQUAL,GREATER:te.GREATER,NOT_EQUAL:te.NOTEQUAL,GREATER_OR_EQUAL:te.GEQUAL,ALWAYS:te.ALWAYS},Un=Object.freeze(HLe);var GLe={ZERO:te.ZERO,KEEP:te.KEEP,REPLACE:te.REPLACE,INCREMENT:te.INCR,DECREMENT:te.DECR,INVERT:te.INVERT,INCREMENT_WRAP:te.INCR_WRAP,DECREMENT_WRAP:te.DECR_WRAP},mt=Object.freeze(GLe);var DL={CESIUM_3D_TILE_MASK:128,SKIP_LOD_MASK:112,SKIP_LOD_BIT_SHIFT:4,CLASSIFICATION_MASK:15};DL.setCesium3DTileBit=function(){return{enabled:!0,frontFunction:Un.ALWAYS,frontOperation:{fail:mt.KEEP,zFail:mt.KEEP,zPass:mt.REPLACE},backFunction:Un.ALWAYS,backOperation:{fail:mt.KEEP,zFail:mt.KEEP,zPass:mt.REPLACE},reference:DL.CESIUM_3D_TILE_MASK,mask:DL.CESIUM_3D_TILE_MASK}};var Ut=Object.freeze(DL);function zy(e){e=x(e,x.EMPTY_OBJECT);let t=e.geometryInstances;this.geometryInstances=t,this.show=x(e.show,!0),this.classificationType=x(e.classificationType,Vn.BOTH),this.debugShowBoundingVolume=x(e.debugShowBoundingVolume,!1),this.debugShowShadowVolume=x(e.debugShowShadowVolume,!1),this._debugShowShadowVolume=!1,this._extruded=x(e._extruded,!1),this._uniformMap=e._uniformMap,this._sp=void 0,this._spStencil=void 0,this._spPick=void 0,this._spColor=void 0,this._spPick2D=void 0,this._spColor2D=void 0,this._rsStencilDepthPass=void 0,this._rsStencilDepthPass3DTiles=void 0,this._rsColorPass=void 0,this._rsPickPass=void 0,this._commandsIgnoreShow=[],this._ready=!1,this._primitive=void 0,this._pickPrimitive=e._pickPrimitive,this._hasSphericalExtentsAttribute=!1,this._hasPlanarExtentsAttributes=!1,this._hasPerColorAttribute=!1,this.appearance=e.appearance,this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._usePickOffsets=!1,this._primitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:x(e.vertexCacheOptimize,!1),interleave:x(e.interleave,!1),releaseGeometryInstances:x(e.releaseGeometryInstances,!0),allowPicking:x(e.allowPicking,!0),asynchronous:x(e.asynchronous,!0),compressVertices:x(e.compressVertices,!0),_createBoundingVolumeFunction:void 0,_createRenderStatesFunction:void 0,_createShaderProgramFunction:void 0,_createCommandsFunction:void 0,_updateAndQueueCommandsFunction:void 0,_createPickOffsets:!0}}Object.defineProperties(zy.prototype,{vertexCacheOptimize:{get:function(){return this._primitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},compressVertices:{get:function(){return this._primitiveOptions.compressVertices}},ready:{get:function(){return this._ready}},_needs2DShader:{get:function(){return this._hasPlanarExtentsAttributes||this._hasSphericalExtentsAttribute}}});zy.isSupported=function(e){return e.context.stencilBuffer};function FC(e,t){let n=t?Un.EQUAL:Un.ALWAYS;return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:e,frontFunction:n,frontOperation:{fail:mt.KEEP,zFail:mt.DECREMENT_WRAP,zPass:mt.KEEP},backFunction:n,backOperation:{fail:mt.KEEP,zFail:mt.INCREMENT_WRAP,zPass:mt.KEEP},reference:Ut.CESIUM_3D_TILE_MASK,mask:Ut.CESIUM_3D_TILE_MASK},stencilMask:Ut.CLASSIFICATION_MASK,depthTest:{enabled:!0,func:wc.LESS_OR_EQUAL},depthMask:!1}}function _9(e){return{stencilTest:{enabled:e,frontFunction:Un.NOT_EQUAL,frontOperation:{fail:mt.ZERO,zFail:mt.ZERO,zPass:mt.ZERO},backFunction:Un.NOT_EQUAL,backOperation:{fail:mt.ZERO,zFail:mt.ZERO,zPass:mt.ZERO},reference:0,mask:Ut.CLASSIFICATION_MASK},stencilMask:Ut.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1,blending:un.PRE_MULTIPLIED_ALPHA_BLEND}}var WLe={stencilTest:{enabled:!0,frontFunction:Un.NOT_EQUAL,frontOperation:{fail:mt.ZERO,zFail:mt.ZERO,zPass:mt.ZERO},backFunction:Un.NOT_EQUAL,backOperation:{fail:mt.ZERO,zFail:mt.ZERO,zPass:mt.ZERO},reference:0,mask:Ut.CLASSIFICATION_MASK},stencilMask:Ut.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1};function jLe(e,t,n,i){if(u(e._rsStencilDepthPass))return;let o=!e.debugShowShadowVolume;e._rsStencilDepthPass=Ue.fromCache(FC(o,!1)),e._rsStencilDepthPass3DTiles=Ue.fromCache(FC(o,!0)),e._rsColorPass=Ue.fromCache(_9(o,!1)),e._rsPickPass=Ue.fromCache(WLe)}function qLe(e,t){if(!e.compressVertices)return t;if(t.search(/in\s+vec3\s+extrudeDirection;/g)!==-1){let n="compressedAttributes",i=`in vec2 ${n};`,o=`vec3 extrudeDirection;
`,r=`    extrudeDirection = czm_octDecode(${n}, 65535.0);
`,s=t;s=s.replace(/in\s+vec3\s+extrudeDirection;/g,""),s=ze.replaceMain(s,"czm_non_compressed_main");let a=`void main() 
{ 
${r}    czm_non_compressed_main(); 
}`;return[i,o,s,a].join(`
`)}}function YLe(e,t){let n=t.context,i=e._primitive,o=EL;o=e._primitive._batchTable.getVertexShaderCallback()(o),o=In._appendDistanceDisplayConditionToShader(i,o),o=In._modifyShaderPosition(e,o,t.scene3DOnly),o=In._updateColorAttribute(i,o);let r=e._hasPlanarExtentsAttributes,s=r||e._hasSphericalExtentsAttribute;e._extruded&&(o=qLe(i,o));let a=e._extruded?"EXTRUDED_GEOMETRY":"",c=new ze({defines:[a],sources:[o]}),l=new ze({sources:[Uy]}),f=e._primitive._attributeLocations,d=new of(s,r,e.appearance);if(e._spStencil=tn.replaceCache({context:n,shaderProgram:e._spStencil,vertexShaderSource:c,fragmentShaderSource:l,attributeLocations:f}),e._primitive.allowPicking){let m=ze.createPickVertexShaderSource(o);m=In._appendShowToShader(i,m),m=In._updatePickColorAttribute(m);let y=d.createPickFragmentShader(!1),b=d.createPickVertexShader([a],m,!1,t.mapProjection);if(e._spPick=tn.replaceCache({context:n,shaderProgram:e._spPick,vertexShaderSource:b,fragmentShaderSource:y,attributeLocations:f}),s){let C=n.shaderCache.getDerivedShaderProgram(e._spPick,"2dPick");if(!u(C)){let A=d.createPickFragmentShader(!0),T=d.createPickVertexShader([a],m,!0,t.mapProjection);C=n.shaderCache.createDerivedShaderProgram(e._spPick,"2dPick",{vertexShaderSource:T,fragmentShaderSource:A,attributeLocations:f})}e._spPick2D=C}}else e._spPick=tn.fromCache({context:n,vertexShaderSource:c,fragmentShaderSource:l,attributeLocations:f});o=In._appendShowToShader(i,o),c=new ze({defines:[a],sources:[o]}),e._sp=tn.replaceCache({context:n,shaderProgram:e._sp,vertexShaderSource:c,fragmentShaderSource:l,attributeLocations:f});let p=d.createFragmentShader(!1),g=d.createVertexShader([a],o,!1,t.mapProjection);if(e._spColor=tn.replaceCache({context:n,shaderProgram:e._spColor,vertexShaderSource:g,fragmentShaderSource:p,attributeLocations:f}),s){let m=n.shaderCache.getDerivedShaderProgram(e._spColor,"2dColor");if(!u(m)){let y=d.createFragmentShader(!0),b=d.createVertexShader([a],o,!0,t.mapProjection);m=n.shaderCache.createDerivedShaderProgram(e._spColor,"2dColor",{vertexShaderSource:b,fragmentShaderSource:y,attributeLocations:f})}e._spColor2D=m}}function XLe(e,t){let n=e._primitive,i=n._va.length*2;t.length=i;let o,r,s,a=0,c=n._batchTable.getUniformMapCallback()(e._uniformMap),l=e._needs2DShader;for(o=0;o<i;o+=2){let g=n._va[a++];r=t[o],u(r)||(r=t[o]=new Qe({owner:e,primitiveType:n._primitiveType})),r.vertexArray=g,r.renderState=e._rsStencilDepthPass,r.shaderProgram=e._sp,r.uniformMap=c,r.pass=we.TERRAIN_CLASSIFICATION,s=Qe.shallowClone(r,r.derivedCommands.tileset),s.renderState=e._rsStencilDepthPass3DTiles,s.pass=we.CESIUM_3D_TILE_CLASSIFICATION,r.derivedCommands.tileset=s,r=t[o+1],u(r)||(r=t[o+1]=new Qe({owner:e,primitiveType:n._primitiveType})),r.vertexArray=g,r.renderState=e._rsColorPass,r.shaderProgram=e._spColor,r.pass=we.TERRAIN_CLASSIFICATION;let y=e.appearance.material;if(u(y)&&(c=bt(c,y._uniforms)),r.uniformMap=c,s=Qe.shallowClone(r,r.derivedCommands.tileset),s.pass=we.CESIUM_3D_TILE_CLASSIFICATION,r.derivedCommands.tileset=s,l){let b=Qe.shallowClone(r,r.derivedCommands.appearance2D);b.shaderProgram=e._spColor2D,r.derivedCommands.appearance2D=b,b=Qe.shallowClone(s,s.derivedCommands.appearance2D),b.shaderProgram=e._spColor2D,s.derivedCommands.appearance2D=b}}let f=e._commandsIgnoreShow,d=e._spStencil,p=0;i=f.length=i/2;for(let g=0;g<i;++g){let m=f[g]=Qe.shallowClone(t[p],f[g]);m.shaderProgram=d,m.pass=we.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,p+=2}}function KLe(e,t){let n=e._usePickOffsets,i=e._primitive,o=i._va.length*2,r,s=0,a;n&&(r=i._pickOffsets,o=r.length*2),t.length=o;let c,l,f,d=0,p=i._batchTable.getUniformMapCallback()(e._uniformMap),g=e._needs2DShader;for(c=0;c<o;c+=2){let m=i._va[d++];if(n&&(a=r[s++],m=i._va[a.index]),l=t[c],u(l)||(l=t[c]=new Qe({owner:e,primitiveType:i._primitiveType,pickOnly:!0})),l.vertexArray=m,l.renderState=e._rsStencilDepthPass,l.shaderProgram=e._sp,l.uniformMap=p,l.pass=we.TERRAIN_CLASSIFICATION,n&&(l.offset=a.offset,l.count=a.count),f=Qe.shallowClone(l,l.derivedCommands.tileset),f.renderState=e._rsStencilDepthPass3DTiles,f.pass=we.CESIUM_3D_TILE_CLASSIFICATION,l.derivedCommands.tileset=f,l=t[c+1],u(l)||(l=t[c+1]=new Qe({owner:e,primitiveType:i._primitiveType,pickOnly:!0})),l.vertexArray=m,l.renderState=e._rsPickPass,l.shaderProgram=e._spPick,l.uniformMap=p,l.pass=we.TERRAIN_CLASSIFICATION,n&&(l.offset=a.offset,l.count=a.count),f=Qe.shallowClone(l,l.derivedCommands.tileset),f.pass=we.CESIUM_3D_TILE_CLASSIFICATION,l.derivedCommands.tileset=f,g){let y=Qe.shallowClone(l,l.derivedCommands.pick2D);y.shaderProgram=e._spPick2D,l.derivedCommands.pick2D=y,y=Qe.shallowClone(f,f.derivedCommands.pick2D),y.shaderProgram=e._spPick2D,f.derivedCommands.pick2D=y}}}function ZLe(e,t,n,i,o,r,s){XLe(e,r),KLe(e,s)}function nne(e,t){return Math.floor(e%t/2)}function p9(e,t,n,i,o,r){e.modelMatrix=n,e.boundingVolume=o,e.cull=i,e.debugShowBoundingVolume=r,t.commandList.push(e)}function ine(e,t,n,i,o){e.modelMatrix=n,e.boundingVolume=o,e.cull=i,t.commandList.push(e)}function $Le(e,t,n,i,o,r,s,a){let c=e._primitive;In._updateBoundingVolumes(c,t,o);let l;t.mode===ne.SCENE3D?l=c._boundingSphereWC:t.mode===ne.COLUMBUS_VIEW?l=c._boundingSphereCV:t.mode===ne.SCENE2D&&u(c._boundingSphere2D)?l=c._boundingSphere2D:u(c._boundingSphereMorph)&&(l=c._boundingSphereMorph);let f=e.classificationType,d=f!==Vn.CESIUM_3D_TILE,p=f!==Vn.TERRAIN,g=t.passes,m,y,b;if(g.render){let C=n.length;for(m=0;m<C;++m)y=l[nne(m,C)],d&&(b=n[m],p9(b,t,o,r,y,s)),p&&(b=n[m].derivedCommands.tileset,p9(b,t,o,r,y,s));if(t.invertClassification){let A=e._commandsIgnoreShow,T=A.length;for(m=0;m<T;++m)y=l[m],b=A[m],p9(b,t,o,r,y,s)}}if(g.pick){let C=i.length,A=c._pickOffsets;for(m=0;m<C;++m){let T=A[nne(m,C)];y=l[T.index],d&&(b=i[m],ine(b,t,o,r,y)),p&&(b=i[m].derivedCommands.tileset,ine(b,t,o,r,y))}}}zy.prototype.update=function(e){if(!u(this._primitive)&&!u(this.geometryInstances))return;let t=this.appearance;u(t)&&u(t.material)&&t.material.update(e.context);let n=this,i=this._primitiveOptions;if(!u(this._primitive)){let o=Array.isArray(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],r=o.length,s,a,c,l=!1,f=!0,d,p=!1,g=!1;for(r>0&&(c=o[0].attributes,p=of.hasAttributesForSphericalExtents(c),g=of.hasAttributesForTextureCoordinatePlanes(c),d=c.color),s=0;s<r;s++){a=o[s];let y=a.attributes.color;u(y)&&(l=!0),f=f&&u(y)&&jt.equals(d,y)}if(!f&&!p&&!g)throw new he("All GeometryInstances must have the same color attribute except via GroundPrimitives");l&&!u(t)&&(t=new ln({flat:!0}),this.appearance=t),this._usePickOffsets=!p&&!g,this._hasSphericalExtentsAttribute=p,this._hasPlanarExtentsAttributes=g,this._hasPerColorAttribute=l;let m=new Array(r);for(s=0;s<r;++s)a=o[s],m[s]=new vt({geometry:a.geometry,attributes:a.attributes,modelMatrix:a.modelMatrix,id:a.id,pickPrimitive:x(this._pickPrimitive,n)});i.appearance=t,i.geometryInstances=m,u(this._createBoundingVolumeFunction)&&(i._createBoundingVolumeFunction=function(y,b){n._createBoundingVolumeFunction(y,b)}),i._createRenderStatesFunction=function(y,b,C,A){jLe(n,b)},i._createShaderProgramFunction=function(y,b,C){YLe(n,b)},i._createCommandsFunction=function(y,b,C,A,T,E,v){ZLe(n,void 0,void 0,!0,!1,E,v)},u(this._updateAndQueueCommandsFunction)?i._updateAndQueueCommandsFunction=function(y,b,C,A,T,E,v,D){n._updateAndQueueCommandsFunction(y,b,C,A,T,E,v,D)}:i._updateAndQueueCommandsFunction=function(y,b,C,A,T,E,v,D){$Le(n,b,C,A,T,E,v,D)},this._primitive=new In(i)}this.debugShowShadowVolume&&!this._debugShowShadowVolume&&this._ready?(this._debugShowShadowVolume=!0,this._rsStencilDepthPass=Ue.fromCache(FC(!1,!1)),this._rsStencilDepthPass3DTiles=Ue.fromCache(FC(!1,!0)),this._rsColorPass=Ue.fromCache(_9(!1))):!this.debugShowShadowVolume&&this._debugShowShadowVolume&&(this._debugShowShadowVolume=!1,this._rsStencilDepthPass=Ue.fromCache(FC(!0,!1)),this._rsStencilDepthPass3DTiles=Ue.fromCache(FC(!0,!0)),this._rsColorPass=Ue.fromCache(_9(!0))),this._primitive.appearance!==t&&(this._primitive.appearance=t),this._primitive.show=this.show,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e),e.afterRender.push(()=>{u(this._primitive)&&this._primitive.ready&&(this._ready=!0,this.releaseGeometryInstances&&(this.geometryInstances=void 0))})};zy.prototype.getGeometryInstanceAttributes=function(e){return this._primitive.getGeometryInstanceAttributes(e)};zy.prototype.isDestroyed=function(){return!1};zy.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._spColor=this._spColor&&this._spColor.destroy(),this._spPick2D=void 0,this._spColor2D=void 0,ue(this)};var uv=zy;var QLe={u_globeMinimumAltitude:function(){return 55e3}};function pl(e){e=x(e,x.EMPTY_OBJECT);let t=e.appearance,n=e.geometryInstances;if(!u(t)&&u(n)){let o=Array.isArray(n)?n:[n],r=o.length;for(let s=0;s<r;s++){let a=o[s].attributes;if(u(a)&&u(a.color)){t=new ln({flat:!0});break}}}this.appearance=t,this.geometryInstances=e.geometryInstances,this.show=x(e.show,!0),this.classificationType=x(e.classificationType,Vn.BOTH),this.debugShowBoundingVolume=x(e.debugShowBoundingVolume,!1),this.debugShowShadowVolume=x(e.debugShowShadowVolume,!1),this._boundingVolumes=[],this._boundingVolumes2D=[],this._ready=!1,this._primitive=void 0,this._maxHeight=void 0,this._minHeight=void 0,this._maxTerrainHeight=di._defaultMaxTerrainHeight,this._minTerrainHeight=di._defaultMinTerrainHeight,this._boundingSpheresKeys=[],this._boundingSpheres=[],this._useFragmentCulling=!1,this._zIndex=void 0;let i=this;this._classificationPrimitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:x(e.vertexCacheOptimize,!1),interleave:x(e.interleave,!1),releaseGeometryInstances:x(e.releaseGeometryInstances,!0),allowPicking:x(e.allowPicking,!0),asynchronous:x(e.asynchronous,!0),compressVertices:x(e.compressVertices,!0),_createBoundingVolumeFunction:void 0,_updateAndQueueCommandsFunction:void 0,_pickPrimitive:i,_extruded:!0,_uniformMap:QLe}}Object.defineProperties(pl.prototype,{vertexCacheOptimize:{get:function(){return this._classificationPrimitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._classificationPrimitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._classificationPrimitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._classificationPrimitiveOptions.allowPicking}},asynchronous:{get:function(){return this._classificationPrimitiveOptions.asynchronous}},compressVertices:{get:function(){return this._classificationPrimitiveOptions.compressVertices}},ready:{get:function(){return this._ready}}});pl.isSupported=uv.isSupported;function one(e){return function(t,n){let i=n.maximumRadius,o=i/Math.cos(t*.5)-i;return e._maxHeight+o}}function rne(e){return function(t,n){return e._minHeight}}var JLe=new h,eNe=new h,tNe=new h,nNe=new de,iNe=new se;function IL(e,t){let n=e.mapProjection.ellipsoid;if(!u(t.attributes)||!u(t.attributes.position3DHigh))return u(t.rectangle)?t.rectangle:void 0;let i=t.attributes.position3DHigh.values,o=t.attributes.position3DLow.values,r=i.length,s=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;for(let d=0;d<r;d+=3){let p=h.unpack(i,d,JLe),g=h.unpack(o,d,eNe),m=h.add(p,g,tNe),y=n.cartesianToCartographic(m,nNe),b=y.latitude,C=y.longitude;s=Math.min(s,b),a=Math.min(a,C),c=Math.max(c,b),l=Math.max(l,C)}let f=iNe;return f.north=c,f.south=s,f.east=l,f.west=a,f}function oNe(e,t,n){let i=di.getMinimumMaximumHeights(t,n);e._minTerrainHeight=i.minimumTerrainHeight,e._maxTerrainHeight=i.maximumTerrainHeight}function rNe(e,t,n){let i=t.mapProjection.ellipsoid,o=IL(t,n),r=wn.fromRectangle(o,e._minHeight,e._maxHeight,i);if(e._boundingVolumes.push(r),!t.scene3DOnly){let s=t.mapProjection,a=ae.fromRectangleWithHeights2D(o,s,e._maxHeight,e._minHeight);h.fromElements(a.center.z,a.center.x,a.center.y,a.center),e._boundingVolumes2D.push(a)}}function g9(e,t){return Math.floor(e%t/2)}function y9(e,t,n,i,o,r,s){let a=e._primitive;n.mode!==ne.SCENE3D&&t.shaderProgram===a._spColor&&a._needs2DShader&&(t=t.derivedCommands.appearance2D),t.owner=e,t.modelMatrix=i,t.boundingVolume=r,t.cull=o,t.debugShowBoundingVolume=s,n.commandList.push(t)}function sne(e,t,n,i,o,r){let s=e._primitive;n.mode!==ne.SCENE3D&&t.shaderProgram===s._spPick&&s._needs2DShader&&(t=t.derivedCommands.pick2D),t.owner=e,t.modelMatrix=i,t.boundingVolume=r,t.cull=o,n.commandList.push(t)}function sNe(e,t,n,i,o,r,s,a){let c;t.mode===ne.SCENE3D?c=e._boundingVolumes:c=e._boundingVolumes2D;let l=e.classificationType,f=l!==Vn.CESIUM_3D_TILE,d=l!==Vn.TERRAIN,p=t.passes,g=e._primitive,m,y,b;if(p.render){let C=n.length;for(m=0;m<C;++m)y=c[g9(m,C)],f&&(b=n[m],y9(e,b,t,o,r,y,s)),d&&(b=n[m].derivedCommands.tileset,y9(e,b,t,o,r,y,s));if(t.invertClassification){let A=g._commandsIgnoreShow,T=A.length;for(m=0;m<T;++m)y=c[m],b=A[m],y9(e,b,t,o,r,y,s)}}if(p.pick){let C=i.length,A;for(e._useFragmentCulling||(A=g._primitive._pickOffsets),m=0;m<C;++m){if(y=c[g9(m,C)],!e._useFragmentCulling){let T=A[g9(m,C)];y=c[T.index]}f&&(b=i[m],sne(e,b,t,o,r,y)),d&&(b=i[m].derivedCommands.tileset,sne(e,b,t,o,r,y))}}}pl.initializeTerrainHeights=function(){return di.initialize()};pl.prototype.update=function(e){if(!u(this._primitive)&&!u(this.geometryInstances))return;if(!di.initialized){pl.initializeTerrainHeights();return}let t=this,n=this._classificationPrimitiveOptions;if(!u(this._primitive)){let i=e.mapProjection.ellipsoid,o,r,s,a=Array.isArray(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],c=a.length,l=new Array(c),f,d;for(f=0;f<c;++f){o=a[f],r=o.geometry;let y=IL(e,r);u(d)?u(y)&&se.union(d,y,d):d=se.clone(y);let b=o.id;if(u(b)&&u(y)){let C=di.getBoundingSphere(y,i);this._boundingSpheresKeys.push(b),this._boundingSpheres.push(C)}s=r.constructor,!u(s)||u(s.createShadowVolume)}oNe(this,d,i);let p=e.verticalExaggeration,g=e.verticalExaggerationRelativeHeight;this._minHeight=Mr.getHeight(this._minTerrainHeight,p,g),this._maxHeight=Mr.getHeight(this._maxTerrainHeight,p,g);let m=pl._supportsMaterials(e.context);if(this._useFragmentCulling=m,m){let y,b=!0;for(f=0;f<c;++f)if(o=a[f],r=o.geometry,d=IL(e,r),of.shouldUseSphericalCoordinates(d)){b=!1;break}for(f=0;f<c;++f){o=a[f],r=o.geometry,s=r.constructor;let C=IL(e,r),A=r.textureCoordinateRotationPoints;b?y=of.getPlanarTextureCoordinateAttributes(C,A,i,e.mapProjection,this._maxHeight):y=of.getSphericalExtentGeometryInstanceAttributes(C,A,i,e.mapProjection);let T=o.attributes;for(let E in T)T.hasOwnProperty(E)&&(y[E]=T[E]);l[f]=new vt({geometry:s.createShadowVolume(r,rne(this),one(this)),attributes:y,id:o.id})}}else for(f=0;f<c;++f)o=a[f],r=o.geometry,s=r.constructor,l[f]=new vt({geometry:s.createShadowVolume(r,rne(this),one(this)),attributes:o.attributes,id:o.id});n.geometryInstances=l,n.appearance=this.appearance,n._createBoundingVolumeFunction=function(y,b){rNe(t,y,b)},n._updateAndQueueCommandsFunction=function(y,b,C,A,T,E,v,D){sNe(t,b,C,A,T,E,v,D)},this._primitive=new uv(n)}this._primitive.appearance=this.appearance,this._primitive.show=this.show,this._primitive.debugShowShadowVolume=this.debugShowShadowVolume,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e),e.afterRender.push(()=>{!this._ready&&u(this._primitive)&&this._primitive.ready&&(this._ready=!0,this.releaseGeometryInstances&&(this.geometryInstances=void 0))})};pl.prototype.getBoundingSphere=function(e){let t=this._boundingSpheresKeys.indexOf(e);if(t!==-1)return this._boundingSpheres[t]};pl.prototype.getGeometryInstanceAttributes=function(e){return this._primitive.getGeometryInstanceAttributes(e)};pl.prototype.isDestroyed=function(){return!1};pl.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),ue(this)};pl._supportsMaterials=function(e){return e.depthTexture};pl.supportsMaterials=function(e){return pl._supportsMaterials(e.frameState.context)};var _l=pl;function BC(){he.throwInstantiationError()}Object.defineProperties(BC.prototype,{isConstant:{get:he.throwInstantiationError},definitionChanged:{get:he.throwInstantiationError}});BC.prototype.getType=he.throwInstantiationError;BC.prototype.getValue=he.throwInstantiationError;BC.prototype.equals=he.throwInstantiationError;var aNe=new $;BC.getValue=function(e,t,n){let i;return u(e)||(e=$.now(aNe)),u(t)&&(i=t.getType(e),u(i))?((!u(n)||n.type!==i)&&(n=Zi.fromType(i)),t.getValue(e,n.uniforms),n):((!u(n)||n.type!==Zi.ColorType)&&(n=Zi.fromType(Zi.ColorType)),G.clone(G.WHITE,n.uniforms.color),n)};var sr=BC;function Hy(e,t,n){this._primitives=t,this._orderedGroundPrimitives=n,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=e,this._options=e._options,this._entity=e._entity,this._material=void 0}Hy.prototype._isHidden=function(e,t,n){return!e.isShowing||!e.isAvailable(n)||!Y.getValueOrDefault(t.show,n,!0)};Hy.prototype._setOptions=he.throwInstantiationError;Hy.prototype.update=function(e){let t=this._geometryUpdater,n=t._onTerrain,i=this._primitives,o=this._orderedGroundPrimitives;n?o.remove(this._primitive):(i.removeAndDestroy(this._primitive),i.removeAndDestroy(this._outlinePrimitive),this._outlinePrimitive=void 0),this._primitive=void 0;let r=this._entity,s=r[this._geometryUpdater._geometryPropertyName];if(this._setOptions(r,s,e),this._isHidden(r,s,e))return;let a=this._geometryUpdater.shadowsProperty.getValue(e),c=this._options;if(!u(s.fill)||s.fill.getValue(e)){let l=t.fillMaterialProperty,f=l instanceof Ht,d,p=t._getIsClosed(c);if(f)d=new ln({closed:p,flat:n&&!t._supportsMaterialsforEntitiesOnTerrain});else{let g=sr.getValue(e,l,this._material);this._material=g,d=new ho({material:g,translucent:g.isTranslucent(),closed:p})}if(n)c.vertexFormat=ln.VERTEX_FORMAT,this._primitive=o.add(new _l({geometryInstances:this._geometryUpdater.createFillGeometryInstance(e),appearance:d,asynchronous:!1,shadows:a,classificationType:this._geometryUpdater.classificationTypeProperty.getValue(e)}),Y.getValueOrUndefined(this._geometryUpdater.zIndex,e));else{c.vertexFormat=d.vertexFormat;let g=this._geometryUpdater.createFillGeometryInstance(e);f&&(d.translucent=g.attributes.color.value[3]!==255),this._primitive=i.add(new In({geometryInstances:g,appearance:d,asynchronous:!1,shadows:a}))}}if(!n&&u(s.outline)&&s.outline.getValue(e)){let l=this._geometryUpdater.createOutlineGeometryInstance(e),f=Y.getValueOrDefault(s.outlineWidth,e,1);this._outlinePrimitive=i.add(new In({geometryInstances:l,appearance:new ln({flat:!0,translucent:l.attributes.color.value[3]!==255,renderState:{lineWidth:t._scene.clampLineWidth(f)}}),asynchronous:!1,shadows:a}))}};Hy.prototype.getBoundingSphere=function(e){let t=this._entity,n=this._primitive,i=this._outlinePrimitive,o;return u(n)&&n.show&&n.ready&&(o=n.getGeometryInstanceAttributes(t),u(o)&&u(o.boundingSphere))?(ae.clone(o.boundingSphere,e),dt.DONE):u(i)&&i.show&&i.ready&&(o=i.getGeometryInstanceAttributes(t),u(o)&&u(o.boundingSphere))?(ae.clone(o.boundingSphere,e),dt.DONE):u(n)&&!n.ready||u(i)&&!i.ready?dt.PENDING:dt.FAILED};Hy.prototype.isDestroyed=function(){return!1};Hy.prototype.destroy=function(){let e=this._primitives,t=this._orderedGroundPrimitives;this._geometryUpdater._onTerrain?t.remove(this._primitive):e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),ue(this)};var oi=Hy;var cNe={NONE:0,GEODESIC:1,RHUMB:2},nn=Object.freeze(cNe);var ane=R.EPSILON10;function lNe(e,t,n,i){if(!u(e))return;n=x(n,!1);let o=u(i),r=e.length;if(r<2)return e;let s,a=e[0],c,l,f=0,d=-1;for(s=1;s<r;++s)c=e[s],t(a,c,ane)?(u(l)||(l=e.slice(0,s),f=s-1,d=0),o&&i.push(s)):(u(l)&&(l.push(c),f=s,o&&(d=i.length)),a=c);return n&&t(e[0],e[r-1],ane)&&(o&&(u(l)?i.splice(d,0,f):i.push(r-1)),u(l)?l.length-=1:l=e.slice(0,-1)),u(l)?l:e}var Eo=lNe;function uNe(e){let t=e._uSquared,n=e._ellipsoid.maximumRadius,i=e._ellipsoid.minimumRadius,o=(n-i)/n,r=Math.cos(e._startHeading),s=Math.sin(e._startHeading),a=(1-o)*Math.tan(e._start.latitude),c=1/Math.sqrt(1+a*a),l=c*a,f=Math.atan2(a,r),d=c*s,p=d*d,g=1-p,m=Math.sqrt(g),y=t/4,b=y*y,C=b*y,A=b*b,T=1+y-3*b/4+5*C/4-175*A/64,E=1-y+15*b/8-35*C/8,v=1-3*y+35*b/4,D=1-5*y,O=T*f-E*Math.sin(2*f)*y/2-v*Math.sin(4*f)*b/16-D*Math.sin(6*f)*C/48-Math.sin(8*f)*5*A/512,P=e._constants;P.a=n,P.b=i,P.f=o,P.cosineHeading=r,P.sineHeading=s,P.tanU=a,P.cosineU=c,P.sineU=l,P.sigma=f,P.sineAlpha=d,P.sineSquaredAlpha=p,P.cosineSquaredAlpha=g,P.cosineAlpha=m,P.u2Over4=y,P.u4Over16=b,P.u6Over64=C,P.u8Over256=A,P.a0=T,P.a1=E,P.a2=v,P.a3=D,P.distanceRatio=O}function fNe(e,t){return e*t*(4+e*(4-3*t))/16}function cne(e,t,n,i,o,r,s){let a=fNe(e,n);return(1-a)*e*t*(i+a*o*(s+a*r*(2*s*s-1)))}function dNe(e,t,n,i,o,r,s){let a=(t-n)/t,c=r-i,l=Math.atan((1-a)*Math.tan(o)),f=Math.atan((1-a)*Math.tan(s)),d=Math.cos(l),p=Math.sin(l),g=Math.cos(f),m=Math.sin(f),y=d*g,b=d*m,C=p*m,A=p*g,T=c,E=R.TWO_PI,v=Math.cos(T),D=Math.sin(T),O,P,M,L,_;do{v=Math.cos(T),D=Math.sin(T);let B=b-A*v;M=Math.sqrt(g*g*D*D+B*B),P=C+y*v,O=Math.atan2(M,P);let W;M===0?(W=0,L=1):(W=y*D/M,L=1-W*W),E=T,_=P-2*C/L,isFinite(_)||(_=0),T=c+cne(a,W,L,O,M,P,_)}while(Math.abs(T-E)>R.EPSILON12);let S=L*(t*t-n*n)/(n*n),w=1+S*(4096+S*(S*(320-175*S)-768))/16384,I=S*(256+S*(S*(74-47*S)-128))/1024,N=_*_,k=I*M*(_+I*(P*(2*N-1)-I*_*(4*M*M-3)*(4*N-3)/6)/4),z=n*w*(O-k),V=Math.atan2(g*D,b-A*v),U=Math.atan2(d*D,b*v-A);e._distance=z,e._startHeading=V,e._endHeading=U,e._uSquared=S}var hNe=new h,x9=new h;function lne(e,t,n,i){let o=h.normalize(i.cartographicToCartesian(t,x9),hNe),r=h.normalize(i.cartographicToCartesian(n,x9),x9);dNe(e,i.maximumRadius,i.minimumRadius,t.longitude,t.latitude,n.longitude,n.latitude),e._start=de.clone(t,e._start),e._end=de.clone(n,e._end),e._start.height=0,e._end.height=0,uNe(e)}function fv(e,t,n){let i=x(n,ee.default);this._ellipsoid=i,this._start=new de,this._end=new de,this._constants={},this._startHeading=void 0,this._endHeading=void 0,this._distance=void 0,this._uSquared=void 0,u(e)&&u(t)&&lne(this,e,t,i)}Object.defineProperties(fv.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){return this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},startHeading:{get:function(){return this._startHeading}},endHeading:{get:function(){return this._endHeading}}});fv.prototype.setEndPoints=function(e,t){lne(this,e,t,this._ellipsoid)};fv.prototype.interpolateUsingFraction=function(e,t){return this.interpolateUsingSurfaceDistance(this._distance*e,t)};fv.prototype.interpolateUsingSurfaceDistance=function(e,t){let n=this._constants,i=n.distanceRatio+e/n.b,o=Math.cos(2*i),r=Math.cos(4*i),s=Math.cos(6*i),a=Math.sin(2*i),c=Math.sin(4*i),l=Math.sin(6*i),f=Math.sin(8*i),d=i*i,p=i*d,g=n.u8Over256,m=n.u2Over4,y=n.u6Over64,b=n.u4Over16,C=2*p*g*o/3+i*(1-m+7*b/4-15*y/4+579*g/64-(b-15*y/4+187*g/16)*o-(5*y/4-115*g/16)*r-29*g*s/16)+(m/2-b+71*y/32-85*g/16)*a+(5*b/16-5*y/4+383*g/96)*c-d*((y-11*g/2)*a+5*g*c/2)+(29*y/96-29*g/16)*l+539*g*f/1536,A=Math.asin(Math.sin(C)*n.cosineAlpha),T=Math.atan(n.a/n.b*Math.tan(A));C=C-n.sigma;let E=Math.cos(2*n.sigma+C),v=Math.sin(C),D=Math.cos(C),O=n.cosineU*D,P=n.sineU*v,L=Math.atan2(v*n.sineHeading,O-P*n.cosineHeading)-cne(n.f,n.sineAlpha,n.cosineSquaredAlpha,C,v,D,E);return u(t)?(t.longitude=this._start.longitude+L,t.latitude=T,t.height=0,t):new de(this._start.longitude+L,T,0)};var Y_=fv;function C9(e,t,n){if(e===0)return t*n;let i=e*e,o=i*i,r=o*i,s=r*i,a=s*i,c=a*i,l=n,f=Math.sin(2*l),d=Math.sin(4*l),p=Math.sin(6*l),g=Math.sin(8*l),m=Math.sin(10*l),y=Math.sin(12*l);return t*((1-i/4-3*o/64-5*r/256-175*s/16384-441*a/65536-4851*c/1048576)*l-(3*i/8+3*o/32+45*r/1024+105*s/4096+2205*a/131072+6237*c/524288)*f+(15*o/256+45*r/1024+525*s/16384+1575*a/65536+155925*c/8388608)*d-(35*r/3072+175*s/12288+3675*a/262144+13475*c/1048576)*p+(315*s/131072+2205*a/524288+43659*c/8388608)*g-(693*a/1310720+6237*c/5242880)*m+1001*c/8388608*y)}function mNe(e,t,n){let i=e/n;if(t===0)return i;let o=i*i,r=o*i,s=r*i,a=t,c=a*a,l=c*c,f=l*c,d=f*c,p=d*c,g=p*c,m=Math.sin(2*i),y=Math.cos(2*i),b=Math.sin(4*i),C=Math.cos(4*i),A=Math.sin(6*i),T=Math.cos(6*i),E=Math.sin(8*i),v=Math.cos(8*i),D=Math.sin(10*i),O=Math.cos(10*i),P=Math.sin(12*i);return i+i*c/4+7*i*l/64+15*i*f/256+579*i*d/16384+1515*i*p/65536+16837*i*g/1048576+(3*i*l/16+45*i*f/256-i*(32*o-561)*d/4096-i*(232*o-1677)*p/16384+i*(399985-90560*o+512*s)*g/5242880)*y+(21*i*f/256+483*i*d/4096-i*(224*o-1969)*p/16384-i*(33152*o-112599)*g/1048576)*C+(151*i*d/4096+4681*i*p/65536+1479*i*g/16384-453*r*g/32768)*T+(1097*i*p/65536+42783*i*g/1048576)*v+8011*i*g/1048576*O+(3*c/8+3*l/16+213*f/2048-3*o*f/64+255*d/4096-33*o*d/512+20861*p/524288-33*o*p/512+s*p/1024+28273*g/1048576-471*o*g/8192+9*s*g/4096)*m+(21*l/256+21*f/256+533*d/8192-21*o*d/512+197*p/4096-315*o*p/4096+584039*g/16777216-12517*o*g/131072+7*s*g/2048)*b+(151*f/6144+151*d/4096+5019*p/131072-453*o*p/16384+26965*g/786432-8607*o*g/131072)*A+(1097*d/131072+1097*p/65536+225797*g/10485760-1097*o*g/65536)*E+(8011*p/2621440+8011*g/1048576)*D+293393*g/251658240*P}function kC(e,t){if(e===0)return Math.log(Math.tan(.5*(R.PI_OVER_TWO+t)));let n=e*Math.sin(t);return Math.log(Math.tan(.5*(R.PI_OVER_TWO+t)))-e/2*Math.log((1+n)/(1-n))}function pNe(e,t,n,i,o){let r=kC(e._ellipticity,n),s=kC(e._ellipticity,o);return Math.atan2(R.negativePiToPi(i-t),s-r)}function _Ne(e,t,n,i,o,r,s){let a=e._heading,c=r-i,l=0;if(R.equalsEpsilon(Math.abs(a),R.PI_OVER_TWO,R.EPSILON8))if(t===n)l=t*Math.cos(o)*R.negativePiToPi(c);else{let f=Math.sin(o);l=t*Math.cos(o)*R.negativePiToPi(c)/Math.sqrt(1-e._ellipticitySquared*f*f)}else{let f=C9(e._ellipticity,t,o);l=(C9(e._ellipticity,t,s)-f)/Math.cos(a)}return Math.abs(l)}var gNe=new h,b9=new h;function une(e,t,n,i){let o=h.normalize(i.cartographicToCartesian(t,b9),gNe),r=h.normalize(i.cartographicToCartesian(n,b9),b9),s=i.maximumRadius,a=i.minimumRadius,c=s*s,l=a*a;e._ellipticitySquared=(c-l)/c,e._ellipticity=Math.sqrt(e._ellipticitySquared),e._start=de.clone(t,e._start),e._start.height=0,e._end=de.clone(n,e._end),e._end.height=0,e._heading=pNe(e,t.longitude,t.latitude,n.longitude,n.latitude),e._distance=_Ne(e,i.maximumRadius,i.minimumRadius,t.longitude,t.latitude,n.longitude,n.latitude)}function fne(e,t,n,i,o,r){if(n===0)return de.clone(e,r);let s=o*o,a,c,l;if(Math.abs(R.PI_OVER_TWO-Math.abs(t))>R.EPSILON8){let f=C9(o,i,e.latitude),d=n*Math.cos(t),p=f+d;if(c=mNe(p,o,i),Math.abs(t)<R.EPSILON10)a=R.negativePiToPi(e.longitude);else{let g=kC(o,e.latitude),m=kC(o,c);l=Math.tan(t)*(m-g),a=R.negativePiToPi(e.longitude+l)}}else{c=e.latitude;let f;if(o===0)f=i*Math.cos(e.latitude);else{let d=Math.sin(e.latitude);f=i*Math.cos(e.latitude)/Math.sqrt(1-s*d*d)}l=n/f,t>0?a=R.negativePiToPi(e.longitude+l):a=R.negativePiToPi(e.longitude-l)}return u(r)?(r.longitude=a,r.latitude=c,r.height=0,r):new de(a,c,0)}function cp(e,t,n){let i=x(n,ee.default);this._ellipsoid=i,this._start=new de,this._end=new de,this._heading=void 0,this._distance=void 0,this._ellipticity=void 0,this._ellipticitySquared=void 0,u(e)&&u(t)&&une(this,e,t,i)}Object.defineProperties(cp.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){return this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},heading:{get:function(){return this._heading}}});cp.fromStartHeadingDistance=function(e,t,n,i,o){let r=x(i,ee.default),s=r.maximumRadius,a=r.minimumRadius,c=s*s,l=a*a,f=Math.sqrt((c-l)/c);t=R.negativePiToPi(t);let d=fne(e,t,n,r.maximumRadius,f);return!u(o)||u(i)&&!i.equals(o.ellipsoid)?new cp(e,d,r):(o.setEndPoints(e,d),o)};cp.prototype.setEndPoints=function(e,t){une(this,e,t,this._ellipsoid)};cp.prototype.interpolateUsingFraction=function(e,t){return this.interpolateUsingSurfaceDistance(e*this._distance,t)};cp.prototype.interpolateUsingSurfaceDistance=function(e,t){return fne(this._start,this._heading,e,this._ellipsoid.maximumRadius,this._ellipticity,t)};cp.prototype.findIntersectionWithLongitude=function(e,t){let n=this._ellipticity,i=this._heading,o=Math.abs(i),r=this._start;if(e=R.negativePiToPi(e),R.equalsEpsilon(Math.abs(e),Math.PI,R.EPSILON14)&&(e=R.sign(r.longitude)*Math.PI),u(t)||(t=new de),Math.abs(R.PI_OVER_TWO-o)<=R.EPSILON8)return t.longitude=e,t.latitude=r.latitude,t.height=0,t;if(R.equalsEpsilon(Math.abs(R.PI_OVER_TWO-o),R.PI_OVER_TWO,R.EPSILON8))return R.equalsEpsilon(e,r.longitude,R.EPSILON12)?void 0:(t.longitude=e,t.latitude=R.PI_OVER_TWO*R.sign(R.PI_OVER_TWO-i),t.height=0,t);let s=r.latitude,a=n*Math.sin(s),c=Math.tan(.5*(R.PI_OVER_TWO+s))*Math.exp((e-r.longitude)/Math.tan(i)),l=(1+a)/(1-a),f=r.latitude,d;do{d=f;let p=n*Math.sin(d),g=(1+p)/(1-p);f=2*Math.atan(c*Math.pow(g/l,n/2))-R.PI_OVER_TWO}while(!R.equalsEpsilon(f,d,R.EPSILON12));return t.longitude=e,t.latitude=f,t.height=0,t};cp.prototype.findIntersectionWithLatitude=function(e,t){let n=this._ellipticity,i=this._heading,o=this._start;if(R.equalsEpsilon(Math.abs(i),R.PI_OVER_TWO,R.EPSILON8))return;let r=kC(n,o.latitude),s=kC(n,e),a=Math.tan(i)*(s-r),c=R.negativePiToPi(o.longitude+a);return u(t)?(t.longitude=c,t.latitude=e,t.height=0,t):new de(c,e,0)};var Ka=cp;var I9=[Oi,Li],yNe=I9.length,Rne=Math.cos(R.toRadians(30)),dne=Math.cos(R.toRadians(150)),One=0,Mne=1e3;function K_(e){e=x(e,x.EMPTY_OBJECT);let t=e.positions;this.width=x(e.width,1),this._positions=t,this.granularity=x(e.granularity,9999),this.loop=x(e.loop,!1),this.arcType=x(e.arcType,nn.GEODESIC),this._ellipsoid=ee.default,this._projectionIndex=0,this._workerName="createGroundPolylineGeometry",this._scene3DOnly=!1}Object.defineProperties(K_.prototype,{packedLength:{get:function(){return 1+this._positions.length*3+1+1+1+ee.packedLength+1+1}}});K_.setProjectionAndEllipsoid=function(e,t){let n=0;for(let i=0;i<yNe;i++)if(t instanceof I9[i]){n=i;break}e._projectionIndex=n,e._ellipsoid=t.ellipsoid};var xNe=new h,hne=new h,mne=new h;function D9(e,t,n,i,o){let r=Ic(i,e,0,xNe),s=Ic(i,e,n,hne),a=Ic(i,t,0,mne),c=lp(s,r,hne),l=lp(a,r,mne);return h.cross(l,c,o),h.normalize(o,o)}var bNe=new de,CNe=new h,ANe=new h,TNe=new h;function A9(e,t,n,i,o,r,s,a,c,l,f){if(o===0)return;let d;r===nn.GEODESIC?d=new Y_(e,t,s):r===nn.RHUMB&&(d=new Ka(e,t,s));let p=d.surfaceDistance;if(p<o)return;let g=D9(e,t,i,s,TNe),m=Math.ceil(p/o),y=p/m,b=y,C=m-1,A=a.length;for(let T=0;T<C;T++){let E=d.interpolateUsingSurfaceDistance(b,bNe),v=Ic(s,E,n,CNe),D=Ic(s,E,i,ANe);h.pack(g,a,A),h.pack(v,c,A),h.pack(D,l,A),f.push(E.latitude),f.push(E.longitude),A+=3,b+=y}}var T9=new de;function Ic(e,t,n,i){return de.clone(t,T9),T9.height=n,de.toCartesian(T9,e,i)}K_.pack=function(e,t,n){let i=x(n,0),o=e._positions,r=o.length;t[i++]=r;for(let s=0;s<r;++s){let a=o[s];h.pack(a,t,i),i+=3}return t[i++]=e.granularity,t[i++]=e.loop?1:0,t[i++]=e.arcType,ee.pack(e._ellipsoid,t,i),i+=ee.packedLength,t[i++]=e._projectionIndex,t[i++]=e._scene3DOnly?1:0,t};K_.unpack=function(e,t,n){let i=x(t,0),o=e[i++],r=new Array(o);for(let p=0;p<o;p++)r[p]=h.unpack(e,i),i+=3;let s=e[i++],a=e[i++]===1,c=e[i++],l=ee.unpack(e,i);i+=ee.packedLength;let f=e[i++],d=e[i++]===1;return u(n)||(n=new K_({positions:r})),n._positions=r,n.granularity=s,n.loop=a,n.arcType=c,n._ellipsoid=l,n._projectionIndex=f,n._scene3DOnly=d,n};function lp(e,t,n){return h.subtract(e,t,n),h.normalize(n,n),n}function pne(e,t,n,i){return i=lp(e,t,i),i=h.cross(i,n,i),i=h.normalize(i,i),i=h.cross(n,i,i),i}var ENe=new h,SNe=new h,vNe=new h,Lne=new h,wNe=0,DNe=-1;function E9(e,t,n,i,o){let r=lp(n,t,Lne),s=pne(e,t,r,ENe),a=pne(i,t,r,SNe);if(R.equalsEpsilon(h.dot(s,a),DNe,R.EPSILON5))return o=h.cross(r,s,o),o=h.normalize(o,o),o;o=h.add(a,s,o),o=h.normalize(o,o);let c=h.cross(r,o,vNe);return h.dot(a,c)<wNe&&(o=h.negate(o,o)),o}var ML=cn.fromPointNormal(h.ZERO,h.UNIT_Y),INe=new h,PNe=new h,RNe=new h,ONe=new h,MNe=new h,PL=new h,RL=new de,_ne=new de,gne=new de;K_.createGeometry=function(e){let t=!e._scene3DOnly,n=e.loop,i=e._ellipsoid,o=e.granularity,r=e.arcType,s=new I9[e._projectionIndex](i),a=One,c=Mne,l,f,d=e._positions,p=d.length;p===2&&(n=!1);let g,m,y,b,C=new Ka(void 0,void 0,i),A,T,E,v=[d[0]];for(f=0;f<p-1;f++)g=d[f],m=d[f+1],A=Qn.lineSegmentPlane(g,m,ML,PL),u(A)&&!h.equalsEpsilon(A,g,R.EPSILON7)&&!h.equalsEpsilon(A,m,R.EPSILON7)&&(e.arcType===nn.GEODESIC?v.push(h.clone(A)):e.arcType===nn.RHUMB&&(E=i.cartesianToCartographic(A,RL).longitude,y=i.cartesianToCartographic(g,RL),b=i.cartesianToCartographic(m,_ne),C.setEndPoints(y,b),T=C.findIntersectionWithLongitude(E,gne),A=i.cartographicToCartesian(T,PL),u(A)&&!h.equalsEpsilon(A,g,R.EPSILON7)&&!h.equalsEpsilon(A,m,R.EPSILON7)&&v.push(h.clone(A)))),v.push(m);n&&(g=d[p-1],m=d[0],A=Qn.lineSegmentPlane(g,m,ML,PL),u(A)&&!h.equalsEpsilon(A,g,R.EPSILON7)&&!h.equalsEpsilon(A,m,R.EPSILON7)&&(e.arcType===nn.GEODESIC?v.push(h.clone(A)):e.arcType===nn.RHUMB&&(E=i.cartesianToCartographic(A,RL).longitude,y=i.cartesianToCartographic(g,RL),b=i.cartesianToCartographic(m,_ne),C.setEndPoints(y,b),T=C.findIntersectionWithLongitude(E,gne),A=i.cartographicToCartesian(T,PL),u(A)&&!h.equalsEpsilon(A,g,R.EPSILON7)&&!h.equalsEpsilon(A,m,R.EPSILON7)&&v.push(h.clone(A)))));let D=v.length,O=new Array(D);for(f=0;f<D;f++){let j=de.fromCartesian(v[f],i);j.height=0,O[f]=j}if(O=Eo(O,de.equalsEpsilon),D=O.length,D<2)return;let P=[],M=[],L=[],_=[],S=INe,w=PNe,I=RNe,N=ONe,k=MNe,z=O[0],V=O[1],U=O[D-1];for(S=Ic(i,U,a,S),N=Ic(i,V,a,N),w=Ic(i,z,a,w),I=Ic(i,z,c,I),n?k=E9(S,w,I,N,k):k=D9(z,V,c,i,k),h.pack(k,M,0),h.pack(w,L,0),h.pack(I,_,0),P.push(z.latitude),P.push(z.longitude),A9(z,V,a,c,o,r,i,M,L,_,P),f=1;f<D-1;++f){S=h.clone(w,S),w=h.clone(N,w);let j=O[f];Ic(i,j,c,I),Ic(i,O[f+1],a,N),E9(S,w,I,N,k),l=M.length,h.pack(k,M,l),h.pack(w,L,l),h.pack(I,_,l),P.push(j.latitude),P.push(j.longitude),A9(O[f],O[f+1],a,c,o,r,i,M,L,_,P)}let B=O[D-1],W=O[D-2];if(w=Ic(i,B,a,w),I=Ic(i,B,c,I),n){let j=O[0];S=Ic(i,W,a,S),N=Ic(i,j,a,N),k=E9(S,w,I,N,k)}else k=D9(W,B,c,i,k);if(l=M.length,h.pack(k,M,l),h.pack(w,L,l),h.pack(I,_,l),P.push(B.latitude),P.push(B.longitude),n){for(A9(B,z,a,c,o,r,i,M,L,_,P),l=M.length,f=0;f<3;++f)M[l+f]=M[f],L[l+f]=L[f],_[l+f]=_[f];P.push(z.latitude),P.push(z.longitude)}return r2e(n,s,L,_,M,P,t)};var LNe=new h,NNe=new J,FNe=new Le;function yne(e,t,n,i){let o=lp(n,t,LNe),r=h.dot(o,e);if(r>Rne||r<dne){let s=lp(i,n,Lne),a=r<dne?R.PI_OVER_TWO:-R.PI_OVER_TWO,c=Le.fromAxisAngle(s,a,FNe),l=J.fromQuaternion(c,NNe);return J.multiplyByVector(l,e,e),!0}return!1}var xne=new de,BNe=new h,bne=new h;function dv(e,t,n,i,o){let r=de.toCartesian(t,e._ellipsoid,BNe),s=h.add(r,n,bne),a=!1,c=e._ellipsoid,l=c.cartesianToCartographic(s,xne);Math.abs(t.longitude-l.longitude)>R.PI_OVER_TWO&&(a=!0,s=h.subtract(r,n,bne),l=c.cartesianToCartographic(s,xne)),l.height=0;let f=e.project(l,o);return o=h.subtract(f,i,o),o.z=0,o=h.normalize(o,o),a&&h.negate(o,o),o}var kNe=new h,Cne=new h;function Ane(e,t,n,i,o,r){let s=h.subtract(t,e,kNe);h.normalize(s,s);let a=n-One,c=h.multiplyByScalar(s,a,Cne);h.add(e,c,o);let l=i-Mne;c=h.multiplyByScalar(s,l,Cne),h.add(t,c,r)}var VNe=new h;function OL(e,t){let n=cn.getPointDistance(ML,e),i=cn.getPointDistance(ML,t),o=VNe;R.equalsEpsilon(n,0,R.EPSILON2)?(o=lp(t,e,o),h.multiplyByScalar(o,R.EPSILON2,o),h.add(e,o,e)):R.equalsEpsilon(i,0,R.EPSILON2)&&(o=lp(e,t,o),h.multiplyByScalar(o,R.EPSILON2,o),h.add(t,o,t))}function UNe(e,t){let n=Math.abs(e.longitude),i=Math.abs(t.longitude);if(R.equalsEpsilon(n,R.PI,R.EPSILON11)){let o=R.sign(t.longitude);return e.longitude=o*(n-R.EPSILON11),1}else if(R.equalsEpsilon(i,R.PI,R.EPSILON11)){let o=R.sign(e.longitude);return t.longitude=o*(i-R.EPSILON11),2}return 0}var Nne=new de,Fne=new de,Tne=new h,S9=new h,Ene=new h,Sne=new h,zNe=new h,vne=new h,HNe=[Nne,Fne],GNe=new se,WNe=new h,jNe=new h,qNe=new h,YNe=new h,XNe=new h,KNe=new h,v9=new h,w9=new h,ZNe=new h,$Ne=new h,QNe=new h,wne=new h,JNe=new h,e2e=new h,t2e=new Gn,n2e=new Gn,Dne=new h,i2e=new h,Ine=new h,o2e=[new ae,new ae],Bne=[0,2,1,0,3,2,0,7,3,0,4,7,0,5,4,0,1,5,5,7,4,5,6,7,5,2,6,5,1,2,3,6,2,3,7,6],Pne=Bne.length;function r2e(e,t,n,i,o,r,s){let a,c,l=t._ellipsoid,f=n.length/3-1,d=f*8,p=d*4,g=f*36,m=d>65535?new Uint32Array(g):new Uint16Array(g),y=new Float64Array(d*3),b=new Float32Array(p),C=new Float32Array(p),A=new Float32Array(p),T=new Float32Array(p),E=new Float32Array(p),v,D,O,P;s&&(v=new Float32Array(p),D=new Float32Array(p),O=new Float32Array(p),P=new Float32Array(d*2));let M=r.length/2,L=0,_=Nne;_.height=0;let S=Fne;S.height=0;let w=Tne,I=S9;if(s)for(c=0,a=1;a<M;a++)_.latitude=r[c],_.longitude=r[c+1],S.latitude=r[c+2],S.longitude=r[c+3],w=t.project(_,w),I=t.project(S,I),L+=h.distance(w,I),c+=2;let N=i.length/3;I=h.unpack(i,0,I);let k=0;for(c=3,a=1;a<N;a++)w=h.clone(I,w),I=h.unpack(i,c,I),k+=h.distance(w,I),c+=3;let z;c=3;let V=0,U=0,B=0,W=0,j=!1,Q=h.unpack(n,0,Sne),q=h.unpack(i,0,S9),X=h.unpack(o,0,vne);if(e){let Te=h.unpack(n,n.length-6,Ene);yne(X,Te,Q,q)&&(X=h.negate(X,X))}let Z=0,fe=0,xe=0;for(a=0;a<f;a++){let Te=h.clone(Q,Ene),Fe=h.clone(q,Tne),Ve=h.clone(X,zNe);j&&(Ve=h.negate(Ve,Ve)),Q=h.unpack(n,c,Sne),q=h.unpack(i,c,S9),X=h.unpack(o,c,vne),j=yne(X,Te,Q,q),_.latitude=r[V],_.longitude=r[V+1],S.latitude=r[V+2],S.longitude=r[V+3];let Ze,gt,lt,Oe;if(s){let ti=UNe(_,S);Ze=t.project(_,XNe),gt=t.project(S,KNe);let ts=lp(gt,Ze,Dne);ts.y=Math.abs(ts.y),lt=v9,Oe=w9,ti===0||h.dot(ts,h.UNIT_Y)>Rne?(lt=dv(t,_,Ve,Ze,v9),Oe=dv(t,S,X,gt,w9)):ti===1?(Oe=dv(t,S,X,gt,w9),lt.x=0,lt.y=R.sign(_.longitude-Math.abs(S.longitude)),lt.z=0):(lt=dv(t,_,Ve,Ze,v9),Oe.x=0,Oe.y=R.sign(_.longitude-S.longitude),Oe.z=0)}let Mt=h.distance(Fe,q),ut=Gn.fromCartesian(Te,t2e),at=h.subtract(Q,Te,ZNe),Kt=h.normalize(at,wne),Ce=h.subtract(Fe,Te,$Ne);Ce=h.normalize(Ce,Ce);let Ae=h.cross(Kt,Ce,wne);Ae=h.normalize(Ae,Ae);let nt=h.cross(Ce,Ve,JNe);nt=h.normalize(nt,nt);let yi=h.subtract(q,Q,QNe);yi=h.normalize(yi,yi);let ct=h.cross(X,yi,e2e);ct=h.normalize(ct,ct);let Si=Mt/k,oo=Z/k,Zs=0,jo,wr,Me,ot=0,We=0;if(s){Zs=h.distance(Ze,gt),jo=Gn.fromCartesian(Ze,n2e),wr=h.subtract(gt,Ze,Dne),Me=h.normalize(wr,i2e);let ti=Me.x;Me.x=Me.y,Me.y=-ti,ot=Zs/L,We=fe/L}for(z=0;z<8;z++){let ti=W+z*4,ts=U+z*2,dr=ti+3,ba=z<4?1:-1,qn=z===2||z===3||z===6||z===7?1:-1;h.pack(ut.high,b,ti),b[dr]=at.x,h.pack(ut.low,C,ti),C[dr]=at.y,h.pack(nt,A,ti),A[dr]=at.z,h.pack(ct,T,ti),T[dr]=Si*ba,h.pack(Ae,E,ti);let ro=oo*qn;ro===0&&qn<0&&(ro=9),E[dr]=ro,s&&(v[ti]=jo.high.x,v[ti+1]=jo.high.y,v[ti+2]=jo.low.x,v[ti+3]=jo.low.y,O[ti]=-lt.y,O[ti+1]=lt.x,O[ti+2]=Oe.y,O[ti+3]=-Oe.x,D[ti]=wr.x,D[ti+1]=wr.y,D[ti+2]=Me.x,D[ti+3]=Me.y,P[ts]=ot*ba,ro=We*qn,ro===0&&qn<0&&(ro=9),P[ts+1]=ro)}let Ye=qNe,ht=YNe,zt=WNe,mn=jNe,bo=se.fromCartographicArray(HNe,GNe),fo=di.getMinimumMaximumHeights(bo,l),$s=fo.minimumTerrainHeight,Rs=fo.maximumTerrainHeight;xe+=Math.abs($s),xe+=Math.abs(Rs),Ane(Te,Fe,$s,Rs,Ye,zt),Ane(Q,q,$s,Rs,ht,mn);let li=h.multiplyByScalar(Ae,R.EPSILON5,Ine);h.add(Ye,li,Ye),h.add(ht,li,ht),h.add(zt,li,zt),h.add(mn,li,mn),OL(Ye,ht),OL(zt,mn),h.pack(Ye,y,B),h.pack(ht,y,B+3),h.pack(mn,y,B+6),h.pack(zt,y,B+9),li=h.multiplyByScalar(Ae,-2*R.EPSILON5,Ine),h.add(Ye,li,Ye),h.add(ht,li,ht),h.add(zt,li,zt),h.add(mn,li,mn),OL(Ye,ht),OL(zt,mn),h.pack(Ye,y,B+12),h.pack(ht,y,B+15),h.pack(mn,y,B+18),h.pack(zt,y,B+21),V+=2,c+=3,U+=16,B+=24,W+=32,Z+=Mt,fe+=Zs}c=0;let re=0;for(a=0;a<f;a++){for(z=0;z<Pne;z++)m[c+z]=Bne[z]+re;re+=8,c+=Pne}let pe=o2e;ae.fromVertices(n,h.ZERO,3,pe[0]),ae.fromVertices(i,h.ZERO,3,pe[1]);let ye=ae.fromBoundingSpheres(pe);ye.radius+=xe/(f*2);let Se={position:new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,normalize:!1,values:y}),startHiAndForwardOffsetX:X_(b),startLoAndForwardOffsetY:X_(C),startNormalAndForwardOffsetZ:X_(A),endNormalAndTextureCoordinateNormalizationX:X_(T),rightNormalAndTextureCoordinateNormalizationY:X_(E)};return s&&(Se.startHiLo2D=X_(v),Se.offsetAndRight2D=X_(D),Se.startEndNormals2D=X_(O),Se.texcoordNormalization2D=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,normalize:!1,values:P})),new ft({attributes:Se,indices:m,boundingSphere:ye})}function X_(e){return new ve({componentDatatype:K.FLOAT,componentsPerAttribute:4,normalize:!1,values:e})}K_._projectNormal=dv;var VC=K_;var LL=`in vec4 v_startPlaneNormalEcAndHalfWidth;
in vec4 v_endPlaneNormalEcAndBatchId;
in vec4 v_rightPlaneEC; // Technically can compute distance for this here
in vec4 v_endEcAndStartEcX;
in vec4 v_texcoordNormalizationAndStartEcYZ;

#ifdef PER_INSTANCE_COLOR
in vec4 v_color;
#endif

void main(void)
{
    float logDepthOrDepth = czm_branchFreeTernary(czm_sceneMode == czm_sceneMode2D, gl_FragCoord.z, czm_unpackDepth(texture(czm_globeDepthTexture, gl_FragCoord.xy / czm_viewport.zw)));
    vec3 ecStart = vec3(v_endEcAndStartEcX.w, v_texcoordNormalizationAndStartEcYZ.zw);

    // Discard for sky
    if (logDepthOrDepth == 0.0) {
#ifdef DEBUG_SHOW_VOLUME
        out_FragColor = vec4(1.0, 0.0, 0.0, 0.5);
        return;
#else // DEBUG_SHOW_VOLUME
        discard;
#endif // DEBUG_SHOW_VOLUME
    }

    vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);
    eyeCoordinate /= eyeCoordinate.w;

    float halfMaxWidth = v_startPlaneNormalEcAndHalfWidth.w * czm_metersPerPixel(eyeCoordinate);
    // Check distance of the eye coordinate against the right-facing plane
    float widthwiseDistance = czm_planeDistance(v_rightPlaneEC, eyeCoordinate.xyz);

    // Check eye coordinate against the mitering planes
    float distanceFromStart = czm_planeDistance(v_startPlaneNormalEcAndHalfWidth.xyz, -dot(ecStart, v_startPlaneNormalEcAndHalfWidth.xyz), eyeCoordinate.xyz);
    float distanceFromEnd = czm_planeDistance(v_endPlaneNormalEcAndBatchId.xyz, -dot(v_endEcAndStartEcX.xyz, v_endPlaneNormalEcAndBatchId.xyz), eyeCoordinate.xyz);

    if (abs(widthwiseDistance) > halfMaxWidth || distanceFromStart < 0.0 || distanceFromEnd < 0.0) {
#ifdef DEBUG_SHOW_VOLUME
        out_FragColor = vec4(1.0, 0.0, 0.0, 0.5);
        return;
#else // DEBUG_SHOW_VOLUME
        discard;
#endif // DEBUG_SHOW_VOLUME
    }

    // Check distance of the eye coordinate against start and end planes with normals in the right plane.
    // For computing unskewed lengthwise texture coordinate.
    // Can also be used for clipping extremely pointy miters, but in practice unnecessary because of miter breaking.

    // aligned plane: cross the right plane normal with miter plane normal, then cross the result with right again to point it more "forward"
    vec3 alignedPlaneNormal;

    // start aligned plane
    alignedPlaneNormal = cross(v_rightPlaneEC.xyz, v_startPlaneNormalEcAndHalfWidth.xyz);
    alignedPlaneNormal = normalize(cross(alignedPlaneNormal, v_rightPlaneEC.xyz));
    distanceFromStart = czm_planeDistance(alignedPlaneNormal, -dot(alignedPlaneNormal, ecStart), eyeCoordinate.xyz);

    // end aligned plane
    alignedPlaneNormal = cross(v_rightPlaneEC.xyz, v_endPlaneNormalEcAndBatchId.xyz);
    alignedPlaneNormal = normalize(cross(alignedPlaneNormal, v_rightPlaneEC.xyz));
    distanceFromEnd = czm_planeDistance(alignedPlaneNormal, -dot(alignedPlaneNormal, v_endEcAndStartEcX.xyz), eyeCoordinate.xyz);

#ifdef PER_INSTANCE_COLOR
    out_FragColor = czm_gammaCorrect(v_color);
#else // PER_INSTANCE_COLOR
    // Clamp - distance to aligned planes may be negative due to mitering,
    // so fragment texture coordinate might be out-of-bounds.
    float s = clamp(distanceFromStart / (distanceFromStart + distanceFromEnd), 0.0, 1.0);
    s = (s * v_texcoordNormalizationAndStartEcYZ.x) + v_texcoordNormalizationAndStartEcYZ.y;
    float t = (widthwiseDistance + halfMaxWidth) / (2.0 * halfMaxWidth);

    czm_materialInput materialInput;

    materialInput.s = s;
    materialInput.st = vec2(s, t);
    materialInput.str = vec3(s, t, 0.0);

    czm_material material = czm_getMaterial(materialInput);
    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#endif // PER_INSTANCE_COLOR

    // Premultiply alpha. Required for classification primitives on translucent globe.
    out_FragColor.rgb *= out_FragColor.a;

    czm_writeDepthClamp();
}
`;var NL=`in vec3 v_forwardDirectionEC;
in vec3 v_texcoordNormalizationAndHalfWidth;
in float v_batchId;

#ifdef PER_INSTANCE_COLOR
in vec4 v_color;
#else
in vec2 v_alignedPlaneDistances;
in float v_texcoordT;
#endif

float rayPlaneDistanceUnsafe(vec3 origin, vec3 direction, vec3 planeNormal, float planeDistance) {
    // We don't expect the ray to ever be parallel to the plane
    return (-planeDistance - dot(planeNormal, origin)) / dot(planeNormal, direction);
}

void main(void)
{
    vec4 eyeCoordinate = gl_FragCoord;
    eyeCoordinate /= eyeCoordinate.w;

#ifdef PER_INSTANCE_COLOR
    out_FragColor = czm_gammaCorrect(v_color);
#else // PER_INSTANCE_COLOR
    // Use distances for planes aligned with segment to prevent skew in dashing
    float distanceFromStart = rayPlaneDistanceUnsafe(eyeCoordinate.xyz, -v_forwardDirectionEC, v_forwardDirectionEC.xyz, v_alignedPlaneDistances.x);
    float distanceFromEnd = rayPlaneDistanceUnsafe(eyeCoordinate.xyz, v_forwardDirectionEC, -v_forwardDirectionEC.xyz, v_alignedPlaneDistances.y);

    // Clamp - distance to aligned planes may be negative due to mitering
    distanceFromStart = max(0.0, distanceFromStart);
    distanceFromEnd = max(0.0, distanceFromEnd);

    float s = distanceFromStart / (distanceFromStart + distanceFromEnd);
    s = (s * v_texcoordNormalizationAndHalfWidth.x) + v_texcoordNormalizationAndHalfWidth.y;

    czm_materialInput materialInput;

    materialInput.s = s;
    materialInput.st = vec2(s, v_texcoordT);
    materialInput.str = vec3(s, v_texcoordT, 0.0);

    czm_material material = czm_getMaterial(materialInput);
    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#endif // PER_INSTANCE_COLOR
}
`;var FL=`in vec3 position3DHigh;
in vec3 position3DLow;

in vec4 startHiAndForwardOffsetX;
in vec4 startLoAndForwardOffsetY;
in vec4 startNormalAndForwardOffsetZ;
in vec4 endNormalAndTextureCoordinateNormalizationX;
in vec4 rightNormalAndTextureCoordinateNormalizationY;
in vec4 startHiLo2D;
in vec4 offsetAndRight2D;
in vec4 startEndNormals2D;
in vec2 texcoordNormalization2D;

in float batchId;

out vec3 v_forwardDirectionEC;
out vec3 v_texcoordNormalizationAndHalfWidth;
out float v_batchId;

// For materials
#ifdef WIDTH_VARYING
out float v_width;
#endif
#ifdef ANGLE_VARYING
out float v_polylineAngle;
#endif

#ifdef PER_INSTANCE_COLOR
out vec4 v_color;
#else
out vec2 v_alignedPlaneDistances;
out float v_texcoordT;
#endif

// Morphing planes using SLERP or NLERP doesn't seem to work, so instead draw the material directly on the shadow volume.
// Morph views are from very far away and aren't meant to be used precisely, so this should be sufficient.
void main()
{
    v_batchId = batchId;

    // Start position
    vec4 posRelativeToEye2D = czm_translateRelativeToEye(vec3(0.0, startHiLo2D.xy), vec3(0.0, startHiLo2D.zw));
    vec4 posRelativeToEye3D = czm_translateRelativeToEye(startHiAndForwardOffsetX.xyz, startLoAndForwardOffsetY.xyz);
    vec4 posRelativeToEye = czm_columbusViewMorph(posRelativeToEye2D, posRelativeToEye3D, czm_morphTime);
    vec3 posEc2D = (czm_modelViewRelativeToEye * posRelativeToEye2D).xyz;
    vec3 posEc3D = (czm_modelViewRelativeToEye * posRelativeToEye3D).xyz;
    vec3 startEC = (czm_modelViewRelativeToEye * posRelativeToEye).xyz;

    // Start plane
    vec4 startPlane2D;
    vec4 startPlane3D;
    startPlane2D.xyz = czm_normal * vec3(0.0, startEndNormals2D.xy);
    startPlane3D.xyz = czm_normal * startNormalAndForwardOffsetZ.xyz;
    startPlane2D.w = -dot(startPlane2D.xyz, posEc2D);
    startPlane3D.w = -dot(startPlane3D.xyz, posEc3D);

    // Right plane
    vec4 rightPlane2D;
    vec4 rightPlane3D;
    rightPlane2D.xyz = czm_normal * vec3(0.0, offsetAndRight2D.zw);
    rightPlane3D.xyz = czm_normal * rightNormalAndTextureCoordinateNormalizationY.xyz;
    rightPlane2D.w = -dot(rightPlane2D.xyz, posEc2D);
    rightPlane3D.w = -dot(rightPlane3D.xyz, posEc3D);

    // End position
    posRelativeToEye2D = posRelativeToEye2D + vec4(0.0, offsetAndRight2D.xy, 0.0);
    posRelativeToEye3D = posRelativeToEye3D + vec4(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w, 0.0);
    posRelativeToEye = czm_columbusViewMorph(posRelativeToEye2D, posRelativeToEye3D, czm_morphTime);
    posEc2D = (czm_modelViewRelativeToEye * posRelativeToEye2D).xyz;
    posEc3D = (czm_modelViewRelativeToEye * posRelativeToEye3D).xyz;
    vec3 endEC = (czm_modelViewRelativeToEye * posRelativeToEye).xyz;
    vec3 forwardEc3D = czm_normal * normalize(vec3(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w));
    vec3 forwardEc2D = czm_normal * normalize(vec3(0.0, offsetAndRight2D.xy));

    // End plane
    vec4 endPlane2D;
    vec4 endPlane3D;
    endPlane2D.xyz = czm_normal * vec3(0.0, startEndNormals2D.zw);
    endPlane3D.xyz = czm_normal * endNormalAndTextureCoordinateNormalizationX.xyz;
    endPlane2D.w = -dot(endPlane2D.xyz, posEc2D);
    endPlane3D.w = -dot(endPlane3D.xyz, posEc3D);

    // Forward direction
    v_forwardDirectionEC = normalize(endEC - startEC);

    vec2 cleanTexcoordNormalization2D;
    cleanTexcoordNormalization2D.x = abs(texcoordNormalization2D.x);
    cleanTexcoordNormalization2D.y = czm_branchFreeTernary(texcoordNormalization2D.y > 1.0, 0.0, abs(texcoordNormalization2D.y));
    vec2 cleanTexcoordNormalization3D;
    cleanTexcoordNormalization3D.x = abs(endNormalAndTextureCoordinateNormalizationX.w);
    cleanTexcoordNormalization3D.y = rightNormalAndTextureCoordinateNormalizationY.w;
    cleanTexcoordNormalization3D.y = czm_branchFreeTernary(cleanTexcoordNormalization3D.y > 1.0, 0.0, abs(cleanTexcoordNormalization3D.y));

    v_texcoordNormalizationAndHalfWidth.xy = mix(cleanTexcoordNormalization2D, cleanTexcoordNormalization3D, czm_morphTime);

#ifdef PER_INSTANCE_COLOR
    v_color = czm_batchTable_color(batchId);
#else // PER_INSTANCE_COLOR
    // For computing texture coordinates

    v_alignedPlaneDistances.x = -dot(v_forwardDirectionEC, startEC);
    v_alignedPlaneDistances.y = -dot(-v_forwardDirectionEC, endEC);
#endif // PER_INSTANCE_COLOR

#ifdef WIDTH_VARYING
    float width = czm_batchTable_width(batchId);
    float halfWidth = width * 0.5;
    v_width = width;
    v_texcoordNormalizationAndHalfWidth.z = halfWidth;
#else
    float halfWidth = 0.5 * czm_batchTable_width(batchId);
    v_texcoordNormalizationAndHalfWidth.z = halfWidth;
#endif

    // Compute a normal along which to "push" the position out, extending the miter depending on view distance.
    // Position has already been "pushed" by unit length along miter normal, and miter normals are encoded in the planes.
    // Decode the normal to use at this specific vertex, push the position back, and then push to where it needs to be.
    // Since this is morphing, compute both 3D and 2D positions and then blend.

    // ****** 3D ******
    // Check distance to the end plane and start plane, pick the plane that is closer
    vec4 positionEc3D = czm_modelViewRelativeToEye * czm_translateRelativeToEye(position3DHigh, position3DLow); // w = 1.0, see czm_computePosition
    float absStartPlaneDistance = abs(czm_planeDistance(startPlane3D, positionEc3D.xyz));
    float absEndPlaneDistance = abs(czm_planeDistance(endPlane3D, positionEc3D.xyz));
    vec3 planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlane3D.xyz, endPlane3D.xyz);
    vec3 upOrDown = normalize(cross(rightPlane3D.xyz, planeDirection)); // Points "up" for start plane, "down" at end plane.
    vec3 normalEC = normalize(cross(planeDirection, upOrDown));         // In practice, the opposite seems to work too.

    // Nudge the top vertex upwards to prevent flickering
    vec3 geodeticSurfaceNormal = normalize(cross(normalEC, forwardEc3D));
    geodeticSurfaceNormal *= float(0.0 <= rightNormalAndTextureCoordinateNormalizationY.w && rightNormalAndTextureCoordinateNormalizationY.w <= 1.0);
    geodeticSurfaceNormal *= MAX_TERRAIN_HEIGHT;
    positionEc3D.xyz += geodeticSurfaceNormal;

    // Determine if this vertex is on the "left" or "right"
    normalEC *= sign(endNormalAndTextureCoordinateNormalizationX.w);

    // A "perfect" implementation would push along normals according to the angle against forward.
    // In practice, just pushing the normal out by halfWidth is sufficient for morph views.
    positionEc3D.xyz += halfWidth * max(0.0, czm_metersPerPixel(positionEc3D)) * normalEC; // prevent artifacts when czm_metersPerPixel is negative (behind camera)

    // ****** 2D ******
    // Check distance to the end plane and start plane, pick the plane that is closer
    vec4 positionEc2D = czm_modelViewRelativeToEye * czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy); // w = 1.0, see czm_computePosition
    absStartPlaneDistance = abs(czm_planeDistance(startPlane2D, positionEc2D.xyz));
    absEndPlaneDistance = abs(czm_planeDistance(endPlane2D, positionEc2D.xyz));
    planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlane2D.xyz, endPlane2D.xyz);
    upOrDown = normalize(cross(rightPlane2D.xyz, planeDirection)); // Points "up" for start plane, "down" at end plane.
    normalEC = normalize(cross(planeDirection, upOrDown));         // In practice, the opposite seems to work too.

    // Nudge the top vertex upwards to prevent flickering
    geodeticSurfaceNormal = normalize(cross(normalEC, forwardEc2D));
    geodeticSurfaceNormal *= float(0.0 <= texcoordNormalization2D.y && texcoordNormalization2D.y <= 1.0);
    geodeticSurfaceNormal *= MAX_TERRAIN_HEIGHT;
    positionEc2D.xyz += geodeticSurfaceNormal;

    // Determine if this vertex is on the "left" or "right"
    normalEC *= sign(texcoordNormalization2D.x);
#ifndef PER_INSTANCE_COLOR
    // Use vertex's sidedness to compute its texture coordinate.
    v_texcoordT = clamp(sign(texcoordNormalization2D.x), 0.0, 1.0);
#endif

    // A "perfect" implementation would push along normals according to the angle against forward.
    // In practice, just pushing the normal out by halfWidth is sufficient for morph views.
    positionEc2D.xyz += halfWidth * max(0.0, czm_metersPerPixel(positionEc2D)) * normalEC; // prevent artifacts when czm_metersPerPixel is negative (behind camera)

    // Blend for actual position
    gl_Position = czm_projection * mix(positionEc2D, positionEc3D, czm_morphTime);

#ifdef ANGLE_VARYING
    // Approximate relative screen space direction of the line.
    vec2 approxLineDirection = normalize(vec2(v_forwardDirectionEC.x, -v_forwardDirectionEC.y));
    approxLineDirection.y = czm_branchFreeTernary(approxLineDirection.x == 0.0 && approxLineDirection.y == 0.0, -1.0, approxLineDirection.y);
    v_polylineAngle = czm_fastApproximateAtan(approxLineDirection.x, approxLineDirection.y);
#endif
}
`;var BL=`in vec3 position3DHigh;
in vec3 position3DLow;

// In 2D and in 3D, texture coordinate normalization component signs encodes:
// * X sign - sidedness relative to right plane
// * Y sign - is negative OR magnitude is greater than 1.0 if vertex is on bottom of volume
#ifndef COLUMBUS_VIEW_2D
in vec4 startHiAndForwardOffsetX;
in vec4 startLoAndForwardOffsetY;
in vec4 startNormalAndForwardOffsetZ;
in vec4 endNormalAndTextureCoordinateNormalizationX;
in vec4 rightNormalAndTextureCoordinateNormalizationY;
#else
in vec4 startHiLo2D;
in vec4 offsetAndRight2D;
in vec4 startEndNormals2D;
in vec2 texcoordNormalization2D;
#endif

in float batchId;

out vec4 v_startPlaneNormalEcAndHalfWidth;
out vec4 v_endPlaneNormalEcAndBatchId;
out vec4 v_rightPlaneEC;
out vec4 v_endEcAndStartEcX;
out vec4 v_texcoordNormalizationAndStartEcYZ;

// For materials
#ifdef WIDTH_VARYING
out float v_width;
#endif
#ifdef ANGLE_VARYING
out float v_polylineAngle;
#endif

#ifdef PER_INSTANCE_COLOR
out vec4 v_color;
#endif

void main()
{
#ifdef COLUMBUS_VIEW_2D
    vec3 ecStart = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, startHiLo2D.xy), vec3(0.0, startHiLo2D.zw))).xyz;

    vec3 forwardDirectionEC = czm_normal * vec3(0.0, offsetAndRight2D.xy);
    vec3 ecEnd = forwardDirectionEC + ecStart;
    forwardDirectionEC = normalize(forwardDirectionEC);

    // Right plane
    v_rightPlaneEC.xyz = czm_normal * vec3(0.0, offsetAndRight2D.zw);
    v_rightPlaneEC.w = -dot(v_rightPlaneEC.xyz, ecStart);

    // start plane
    vec4 startPlaneEC;
    startPlaneEC.xyz =  czm_normal * vec3(0.0, startEndNormals2D.xy);
    startPlaneEC.w = -dot(startPlaneEC.xyz, ecStart);

    // end plane
    vec4 endPlaneEC;
    endPlaneEC.xyz =  czm_normal * vec3(0.0, startEndNormals2D.zw);
    endPlaneEC.w = -dot(endPlaneEC.xyz, ecEnd);

    v_texcoordNormalizationAndStartEcYZ.x = abs(texcoordNormalization2D.x);
    v_texcoordNormalizationAndStartEcYZ.y = texcoordNormalization2D.y;

#else // COLUMBUS_VIEW_2D
    vec3 ecStart = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(startHiAndForwardOffsetX.xyz, startLoAndForwardOffsetY.xyz)).xyz;
    vec3 offset = czm_normal * vec3(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w);
    vec3 ecEnd = ecStart + offset;

    vec3 forwardDirectionEC = normalize(offset);

    // start plane
    vec4 startPlaneEC;
    startPlaneEC.xyz = czm_normal * startNormalAndForwardOffsetZ.xyz;
    startPlaneEC.w = -dot(startPlaneEC.xyz, ecStart);

    // end plane
    vec4 endPlaneEC;
    endPlaneEC.xyz = czm_normal * endNormalAndTextureCoordinateNormalizationX.xyz;
    endPlaneEC.w = -dot(endPlaneEC.xyz, ecEnd);

    // Right plane
    v_rightPlaneEC.xyz = czm_normal * rightNormalAndTextureCoordinateNormalizationY.xyz;
    v_rightPlaneEC.w = -dot(v_rightPlaneEC.xyz, ecStart);

    v_texcoordNormalizationAndStartEcYZ.x = abs(endNormalAndTextureCoordinateNormalizationX.w);
    v_texcoordNormalizationAndStartEcYZ.y = rightNormalAndTextureCoordinateNormalizationY.w;

#endif // COLUMBUS_VIEW_2D

    v_endEcAndStartEcX.xyz = ecEnd;
    v_endEcAndStartEcX.w = ecStart.x;
    v_texcoordNormalizationAndStartEcYZ.zw = ecStart.yz;

#ifdef PER_INSTANCE_COLOR
    v_color = czm_batchTable_color(batchId);
#endif // PER_INSTANCE_COLOR

    // Compute a normal along which to "push" the position out, extending the miter depending on view distance.
    // Position has already been "pushed" by unit length along miter normal, and miter normals are encoded in the planes.
    // Decode the normal to use at this specific vertex, push the position back, and then push to where it needs to be.
    vec4 positionRelativeToEye = czm_computePosition();

    // Check distance to the end plane and start plane, pick the plane that is closer
    vec4 positionEC = czm_modelViewRelativeToEye * positionRelativeToEye; // w = 1.0, see czm_computePosition
    float absStartPlaneDistance = abs(czm_planeDistance(startPlaneEC, positionEC.xyz));
    float absEndPlaneDistance = abs(czm_planeDistance(endPlaneEC, positionEC.xyz));
    vec3 planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlaneEC.xyz, endPlaneEC.xyz);
    vec3 upOrDown = normalize(cross(v_rightPlaneEC.xyz, planeDirection)); // Points "up" for start plane, "down" at end plane.
    vec3 normalEC = normalize(cross(planeDirection, upOrDown));           // In practice, the opposite seems to work too.

    // Extrude bottom vertices downward for far view distances, like for GroundPrimitives
    upOrDown = cross(forwardDirectionEC, normalEC);
    upOrDown = float(czm_sceneMode == czm_sceneMode3D) * upOrDown;
    upOrDown = float(v_texcoordNormalizationAndStartEcYZ.y > 1.0 || v_texcoordNormalizationAndStartEcYZ.y < 0.0) * upOrDown;
    upOrDown = min(GLOBE_MINIMUM_ALTITUDE, czm_geometricToleranceOverMeter * length(positionRelativeToEye.xyz)) * upOrDown;
    positionEC.xyz += upOrDown;

    v_texcoordNormalizationAndStartEcYZ.y = czm_branchFreeTernary(v_texcoordNormalizationAndStartEcYZ.y > 1.0, 0.0, abs(v_texcoordNormalizationAndStartEcYZ.y));

    // Determine distance along normalEC to push for a volume of appropriate width.
    // Make volumes about double pixel width for a conservative fit - in practice the
    // extra cost here is minimal compared to the loose volume heights.
    //
    // N = normalEC (guaranteed "right-facing")
    // R = rightEC
    // p = angle between N and R
    // w = distance to push along R if R == N
    // d = distance to push along N
    //
    //   N   R
    //  {  p| }      * cos(p) = dot(N, R) = w / d
    //  d  |  |w    * d = w / dot(N, R)
    //    { | }
    //       o---------- polyline segment ---->
    //
    float width = czm_batchTable_width(batchId);
#ifdef WIDTH_VARYING
    v_width = width;
#endif

    v_startPlaneNormalEcAndHalfWidth.xyz = startPlaneEC.xyz;
    v_startPlaneNormalEcAndHalfWidth.w = width * 0.5;

    v_endPlaneNormalEcAndBatchId.xyz = endPlaneEC.xyz;
    v_endPlaneNormalEcAndBatchId.w = batchId;

    width = width * max(0.0, czm_metersPerPixel(positionEC)); // width = distance to push along R
    width = width / dot(normalEC, v_rightPlaneEC.xyz); // width = distance to push along N

    // Determine if this vertex is on the "left" or "right"
#ifdef COLUMBUS_VIEW_2D
        normalEC *= sign(texcoordNormalization2D.x);
#else
        normalEC *= sign(endNormalAndTextureCoordinateNormalizationX.w);
#endif

    positionEC.xyz += width * normalEC;
    gl_Position = czm_depthClamp(czm_projection * positionEC);

#ifdef ANGLE_VARYING
    // Approximate relative screen space direction of the line.
    vec2 approxLineDirection = normalize(vec2(forwardDirectionEC.x, -forwardDirectionEC.y));
    approxLineDirection.y = czm_branchFreeTernary(approxLineDirection.x == 0.0 && approxLineDirection.y == 0.0, -1.0, approxLineDirection.y);
    v_polylineAngle = czm_fastApproximateAtan(approxLineDirection.x, approxLineDirection.y);
#endif
}
`;var kL=`in vec3 position3DHigh;
in vec3 position3DLow;
in vec3 prevPosition3DHigh;
in vec3 prevPosition3DLow;
in vec3 nextPosition3DHigh;
in vec3 nextPosition3DLow;
in vec2 expandAndWidth;
in vec4 color;
in float batchId;

out vec4 v_color;

void main()
{
    float expandDir = expandAndWidth.x;
    float width = abs(expandAndWidth.y) + 0.5;
    bool usePrev = expandAndWidth.y < 0.0;

    vec4 p = czm_computePosition();
    vec4 prev = czm_computePrevPosition();
    vec4 next = czm_computeNextPosition();

    float angle;
    vec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, angle);
    gl_Position = czm_viewportOrthographic * positionWC;

    v_color = color;
}
`;var rf=`void clipLineSegmentToNearPlane(
    vec3 p0,
    vec3 p1,
    out vec4 positionWC,
    out bool clipped,
    out bool culledByNearPlane,
    out vec4 clippedPositionEC)
{
    culledByNearPlane = false;
    clipped = false;

    vec3 p0ToP1 = p1 - p0;
    float magnitude = length(p0ToP1);
    vec3 direction = normalize(p0ToP1);

    // Distance that p0 is behind the near plane. Negative means p0 is
    // in front of the near plane.
    float endPoint0Distance =  czm_currentFrustum.x + p0.z;

    // Camera looks down -Z.
    // When moving a point along +Z: LESS VISIBLE
    //   * Points in front of the camera move closer to the camera.
    //   * Points behind the camrea move farther away from the camera.
    // When moving a point along -Z: MORE VISIBLE
    //   * Points in front of the camera move farther away from the camera.
    //   * Points behind the camera move closer to the camera.

    // Positive denominator: -Z, becoming more visible
    // Negative denominator: +Z, becoming less visible
    // Nearly zero: parallel to near plane
    float denominator = -direction.z;

    if (endPoint0Distance > 0.0 && abs(denominator) < czm_epsilon7)
    {
        // p0 is behind the near plane and the line to p1 is nearly parallel to
        // the near plane, so cull the segment completely.
        culledByNearPlane = true;
    }
    else if (endPoint0Distance > 0.0)
    {
        // p0 is behind the near plane, and the line to p1 is moving distinctly
        // toward or away from it.

        // t = (-plane distance - dot(plane normal, ray origin)) / dot(plane normal, ray direction)
        float t = endPoint0Distance / denominator;
        if (t < 0.0 || t > magnitude)
        {
            // Near plane intersection is not between the two points.
            // We already confirmed p0 is behind the naer plane, so now
            // we know the entire segment is behind it.
            culledByNearPlane = true;
        }
        else
        {
            // Segment crosses the near plane, update p0 to lie exactly on it.
            p0 = p0 + t * direction;

            // Numerical noise might put us a bit on the wrong side of the near plane.
            // Don't let that happen.
            p0.z = min(p0.z, -czm_currentFrustum.x);

            clipped = true;
        }
    }

    clippedPositionEC = vec4(p0, 1.0);
    positionWC = czm_eyeToWindowCoordinates(clippedPositionEC);
}

vec4 getPolylineWindowCoordinatesEC(vec4 positionEC, vec4 prevEC, vec4 nextEC, float expandDirection, float width, bool usePrevious, out float angle)
{
    // expandDirection +1 is to the _left_ when looking from positionEC toward nextEC.

#ifdef POLYLINE_DASH
    // Compute the window coordinates of the points.
    vec4 positionWindow = czm_eyeToWindowCoordinates(positionEC);
    vec4 previousWindow = czm_eyeToWindowCoordinates(prevEC);
    vec4 nextWindow = czm_eyeToWindowCoordinates(nextEC);

    // Determine the relative screen space direction of the line.
    vec2 lineDir;
    if (usePrevious) {
        lineDir = normalize(positionWindow.xy - previousWindow.xy);
    }
    else {
        lineDir = normalize(nextWindow.xy - positionWindow.xy);
    }
    angle = atan(lineDir.x, lineDir.y) - 1.570796327; // precomputed atan(1,0)

    // Quantize the angle so it doesn't change rapidly between segments.
    angle = floor(angle / czm_piOverFour + 0.5) * czm_piOverFour;
#endif

    vec4 clippedPrevWC, clippedPrevEC;
    bool prevSegmentClipped, prevSegmentCulled;
    clipLineSegmentToNearPlane(prevEC.xyz, positionEC.xyz, clippedPrevWC, prevSegmentClipped, prevSegmentCulled, clippedPrevEC);

    vec4 clippedNextWC, clippedNextEC;
    bool nextSegmentClipped, nextSegmentCulled;
    clipLineSegmentToNearPlane(nextEC.xyz, positionEC.xyz, clippedNextWC, nextSegmentClipped, nextSegmentCulled, clippedNextEC);

    bool segmentClipped, segmentCulled;
    vec4 clippedPositionWC, clippedPositionEC;
    clipLineSegmentToNearPlane(positionEC.xyz, usePrevious ? prevEC.xyz : nextEC.xyz, clippedPositionWC, segmentClipped, segmentCulled, clippedPositionEC);

    if (segmentCulled)
    {
        return vec4(0.0, 0.0, 0.0, 1.0);
    }

    vec2 directionToPrevWC = normalize(clippedPrevWC.xy - clippedPositionWC.xy);
    vec2 directionToNextWC = normalize(clippedNextWC.xy - clippedPositionWC.xy);

    // If a segment was culled, we can't use the corresponding direction
    // computed above. We should never see both of these be true without
    // \`segmentCulled\` above also being true.
    if (prevSegmentCulled)
    {
        directionToPrevWC = -directionToNextWC;
    }
    else if (nextSegmentCulled)
    {
        directionToNextWC = -directionToPrevWC;
    }

    vec2 thisSegmentForwardWC, otherSegmentForwardWC;
    if (usePrevious)
    {
        thisSegmentForwardWC = -directionToPrevWC;
        otherSegmentForwardWC = directionToNextWC;
    }
    else
    {
        thisSegmentForwardWC = directionToNextWC;
        otherSegmentForwardWC =  -directionToPrevWC;
    }

    vec2 thisSegmentLeftWC = vec2(-thisSegmentForwardWC.y, thisSegmentForwardWC.x);

    vec2 leftWC = thisSegmentLeftWC;
    float expandWidth = width * 0.5;

    // When lines are split at the anti-meridian, the position may be at the
    // same location as the next or previous position, and we need to handle
    // that to avoid producing NaNs.
    if (!czm_equalsEpsilon(prevEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1) && !czm_equalsEpsilon(nextEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1))
    {
        vec2 otherSegmentLeftWC = vec2(-otherSegmentForwardWC.y, otherSegmentForwardWC.x);

        vec2 leftSumWC = thisSegmentLeftWC + otherSegmentLeftWC;
        float leftSumLength = length(leftSumWC);
        leftWC = leftSumLength < czm_epsilon6 ? thisSegmentLeftWC : (leftSumWC / leftSumLength);

        // The sine of the angle between the two vectors is given by the formula
        //         |a x b| = |a||b|sin(theta)
        // which is
        //     float sinAngle = length(cross(vec3(leftWC, 0.0), vec3(-thisSegmentForwardWC, 0.0)));
        // Because the z components of both vectors are zero, the x and y coordinate will be zero.
        // Therefore, the sine of the angle is just the z component of the cross product.
        vec2 u = -thisSegmentForwardWC;
        vec2 v = leftWC;
        float sinAngle = abs(u.x * v.y - u.y * v.x);
        expandWidth = clamp(expandWidth / sinAngle, 0.0, width * 2.0);
    }

    vec2 offset = leftWC * expandDirection * expandWidth * czm_pixelRatio;
    return vec4(clippedPositionWC.xy + offset, -clippedPositionWC.z, 1.0) * (czm_projection * clippedPositionEC).w;
}

vec4 getPolylineWindowCoordinates(vec4 position, vec4 previous, vec4 next, float expandDirection, float width, bool usePrevious, out float angle)
{
    vec4 positionEC = czm_modelViewRelativeToEye * position;
    vec4 prevEC = czm_modelViewRelativeToEye * previous;
    vec4 nextEC = czm_modelViewRelativeToEye * next;
    return getPolylineWindowCoordinatesEC(positionEC, prevEC, nextEC, expandDirection, width, usePrevious, angle);
}
`;var P9=`${rf}
${kL}`,s2e=OC;Wt.isInternetExplorer()||(P9=`#define CLIP_POLYLINE 
${P9}`);function Gy(e){e=x(e,x.EMPTY_OBJECT);let t=x(e.translucent,!0),n=!1,i=Gy.VERTEX_FORMAT;this.material=void 0,this.translucent=t,this._vertexShaderSource=x(e.vertexShaderSource,P9),this._fragmentShaderSource=x(e.fragmentShaderSource,s2e),this._renderState=so.getDefaultRenderState(t,n,e.renderState),this._closed=n,this._vertexFormat=i}Object.defineProperties(Gy.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}});Gy.VERTEX_FORMAT=Ie.POSITION_ONLY;Gy.prototype.getFragmentShaderSource=so.prototype.getFragmentShaderSource;Gy.prototype.isTranslucent=so.prototype.isTranslucent;Gy.prototype.getRenderState=so.prototype.getRenderState;var rs=Gy;var VL=`in vec3 position3DHigh;
in vec3 position3DLow;
in vec3 prevPosition3DHigh;
in vec3 prevPosition3DLow;
in vec3 nextPosition3DHigh;
in vec3 nextPosition3DLow;
in vec2 expandAndWidth;
in vec2 st;
in float batchId;

out float v_width;
out vec2 v_st;
out float v_polylineAngle;

void main()
{
    float expandDir = expandAndWidth.x;
    float width = abs(expandAndWidth.y) + 0.5;
    bool usePrev = expandAndWidth.y < 0.0;

    vec4 p = czm_computePosition();
    vec4 prev = czm_computePrevPosition();
    vec4 next = czm_computeNextPosition();

    float angle;
    vec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, angle);
    gl_Position = czm_viewportOrthographic * positionWC;

    v_width = width;
    v_st.s = st.s;
    v_st.t = czm_writeNonPerspective(st.t, gl_Position.w);
    v_polylineAngle = angle;
}
`;var UC=`#ifdef VECTOR_TILE
uniform vec4 u_highlightColor;
#endif

in vec2 v_st;

void main()
{
    czm_materialInput materialInput;

    vec2 st = v_st;
    st.t = czm_readNonPerspective(st.t, gl_FragCoord.w);

    materialInput.s = st.s;
    materialInput.st = st;
    materialInput.str = vec3(st, 0.0);

    czm_material material = czm_getMaterial(materialInput);
    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#ifdef VECTOR_TILE
    out_FragColor *= u_highlightColor;
#endif

    czm_writeLogDepth();
}
`;var R9=`${rf}
${VL}`,a2e=UC;Wt.isInternetExplorer()||(R9=`#define CLIP_POLYLINE 
${R9}`);function Wy(e){e=x(e,x.EMPTY_OBJECT);let t=x(e.translucent,!0),n=!1,i=Wy.VERTEX_FORMAT;this.material=u(e.material)?e.material:Zi.fromType(Zi.ColorType),this.translucent=t,this._vertexShaderSource=x(e.vertexShaderSource,R9),this._fragmentShaderSource=x(e.fragmentShaderSource,a2e),this._renderState=so.getDefaultRenderState(t,n,e.renderState),this._closed=n,this._vertexFormat=i}Object.defineProperties(Wy.prototype,{vertexShaderSource:{get:function(){let e=this._vertexShaderSource;return this.material.shaderSource.search(/in\s+float\s+v_polylineAngle;/g)!==-1&&(e=`#define POLYLINE_DASH
${e}`),e}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}});Wy.VERTEX_FORMAT=Ie.POSITION_AND_ST;Wy.prototype.getFragmentShaderSource=so.prototype.getFragmentShaderSource;Wy.prototype.isTranslucent=so.prototype.isTranslucent;Wy.prototype.getRenderState=so.prototype.getRenderState;var Sa=Wy;function up(e){e=x(e,x.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this._hasPerInstanceColors=!0;let t=e.appearance;u(t)||(t=new Sa),this.appearance=t,this.show=x(e.show,!0),this.classificationType=x(e.classificationType,Vn.BOTH),this.debugShowBoundingVolume=x(e.debugShowBoundingVolume,!1),this._debugShowShadowVolume=x(e.debugShowShadowVolume,!1),this._primitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:!1,interleave:x(e.interleave,!1),releaseGeometryInstances:x(e.releaseGeometryInstances,!0),allowPicking:x(e.allowPicking,!0),asynchronous:x(e.asynchronous,!0),compressVertices:!1,_createShaderProgramFunction:void 0,_createCommandsFunction:void 0,_updateAndQueueCommandsFunction:void 0},this._zIndex=void 0,this._ready=!1,this._primitive=void 0,this._sp=void 0,this._sp2D=void 0,this._spMorph=void 0,this._renderState=kne(!1),this._renderState3DTiles=kne(!0),this._renderStateMorph=Ue.fromCache({cull:{enabled:!0,face:Ci.FRONT},depthTest:{enabled:!0},blending:un.PRE_MULTIPLIED_ALPHA_BLEND,depthMask:!1})}Object.defineProperties(up.prototype,{interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},ready:{get:function(){return this._ready}},debugShowShadowVolume:{get:function(){return this._debugShowShadowVolume}}});up.initializeTerrainHeights=function(){return di.initialize()};function c2e(e,t,n){let i=t.context,o=e._primitive,r=o._attributeLocations,s=o._batchTable.getVertexShaderCallback()(BL);s=In._appendShowToShader(o,s),s=In._appendDistanceDisplayConditionToShader(o,s),s=In._modifyShaderPosition(e,s,t.scene3DOnly);let a=o._batchTable.getVertexShaderCallback()(FL);a=In._appendShowToShader(o,a),a=In._appendDistanceDisplayConditionToShader(o,a),a=In._modifyShaderPosition(e,a,t.scene3DOnly);let c=o._batchTable.getVertexShaderCallback()(LL),l=[`GLOBE_MINIMUM_ALTITUDE ${t.mapProjection.ellipsoid.minimumRadius.toFixed(1)}`],f="",d="";u(n.material)?(d=u(n.material)?n.material.shaderSource:"",d.search(/in\s+float\s+v_polylineAngle;/g)!==-1&&l.push("ANGLE_VARYING"),d.search(/in\s+float\s+v_width;/g)!==-1&&l.push("WIDTH_VARYING")):f="PER_INSTANCE_COLOR",l.push(f);let p=e.debugShowShadowVolume?["DEBUG_SHOW_VOLUME",f]:[f],g=new ze({defines:l,sources:[s]}),m=new ze({defines:p,sources:[d,c]});e._sp=tn.replaceCache({context:i,shaderProgram:o._sp,vertexShaderSource:g,fragmentShaderSource:m,attributeLocations:r});let y=i.shaderCache.getDerivedShaderProgram(e._sp,"2dColor");if(!u(y)){let C=new ze({defines:l.concat(["COLUMBUS_VIEW_2D"]),sources:[s]});y=i.shaderCache.createDerivedShaderProgram(e._sp,"2dColor",{context:i,shaderProgram:e._sp2D,vertexShaderSource:C,fragmentShaderSource:m,attributeLocations:r})}e._sp2D=y;let b=i.shaderCache.getDerivedShaderProgram(e._sp,"MorphColor");if(!u(b)){let C=new ze({defines:l.concat([`MAX_TERRAIN_HEIGHT ${di._defaultMaxTerrainHeight.toFixed(1)}`]),sources:[a]});c=o._batchTable.getVertexShaderCallback()(NL);let A=new ze({defines:p,sources:[d,c]});b=i.shaderCache.createDerivedShaderProgram(e._sp,"MorphColor",{context:i,shaderProgram:e._spMorph,vertexShaderSource:C,fragmentShaderSource:A,attributeLocations:r})}e._spMorph=b}function kne(e){return Ue.fromCache({cull:{enabled:!0},blending:un.PRE_MULTIPLIED_ALPHA_BLEND,depthMask:!1,stencilTest:{enabled:e,frontFunction:Un.EQUAL,frontOperation:{fail:mt.KEEP,zFail:mt.KEEP,zPass:mt.KEEP},backFunction:Un.EQUAL,backOperation:{fail:mt.KEEP,zFail:mt.KEEP,zPass:mt.KEEP},reference:Ut.CESIUM_3D_TILE_MASK,mask:Ut.CESIUM_3D_TILE_MASK}})}function l2e(e,t,n,i,o,r){let s=e._primitive,a=s._va.length;o.length=a,r.length=a;let l=t instanceof rs?{}:n._uniforms,f=s._batchTable.getUniformMapCallback()(l);for(let d=0;d<a;d++){let p=s._va[d],g=o[d];u(g)||(g=o[d]=new Qe({owner:e,primitiveType:s._primitiveType})),g.vertexArray=p,g.renderState=e._renderState,g.shaderProgram=e._sp,g.uniformMap=f,g.pass=we.TERRAIN_CLASSIFICATION,g.pickId="czm_batchTable_pickColor(v_endPlaneNormalEcAndBatchId.w)";let m=Qe.shallowClone(g,g.derivedCommands.tileset);m.renderState=e._renderState3DTiles,m.pass=we.CESIUM_3D_TILE_CLASSIFICATION,g.derivedCommands.tileset=m;let y=Qe.shallowClone(g,g.derivedCommands.color2D);y.shaderProgram=e._sp2D,g.derivedCommands.color2D=y;let b=Qe.shallowClone(m,m.derivedCommands.color2D);b.shaderProgram=e._sp2D,m.derivedCommands.color2D=b;let C=Qe.shallowClone(g,g.derivedCommands.colorMorph);C.renderState=e._renderStateMorph,C.shaderProgram=e._spMorph,C.pickId="czm_batchTable_pickColor(v_batchId)",g.derivedCommands.colorMorph=C}}function Vne(e,t,n,i,o,r,s){n.mode===ne.MORPHING?t=t.derivedCommands.colorMorph:n.mode!==ne.SCENE3D&&(t=t.derivedCommands.color2D),t.modelMatrix=i,t.boundingVolume=r,t.cull=o,t.debugShowBoundingVolume=s,n.commandList.push(t)}function u2e(e,t,n,i,o,r,s){let a=e._primitive;In._updateBoundingVolumes(a,t,o);let c;t.mode===ne.SCENE3D?c=a._boundingSphereWC:t.mode===ne.COLUMBUS_VIEW?c=a._boundingSphereCV:t.mode===ne.SCENE2D&&u(a._boundingSphere2D)?c=a._boundingSphere2D:u(a._boundingSphereMorph)&&(c=a._boundingSphereMorph);let l=t.mode===ne.MORPHING,f=e.classificationType,d=f!==Vn.CESIUM_3D_TILE,p=f!==Vn.TERRAIN&&!l,g,m=t.passes;if(m.render||m.pick&&a.allowPicking){let y=n.length;for(let b=0;b<y;++b){let C=c[b];d&&(g=n[b],Vne(e,g,t,o,r,C,s)),p&&(g=n[b].derivedCommands.tileset,Vne(e,g,t,o,r,C,s))}}}up.prototype.update=function(e){if(!u(this._primitive)&&!u(this.geometryInstances))return;if(!di.initialized){up.initializeTerrainHeights();return}let t,n=this,i=this._primitiveOptions;if(!u(this._primitive)){let o=Array.isArray(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],r=o.length,s=new Array(r),a;for(t=0;t<r;++t)if(a=o[t].attributes,!u(a)||!u(a.color)){this._hasPerInstanceColors=!1;break}for(t=0;t<r;++t){let c=o[t];a={};let l=c.attributes;for(let f in l)l.hasOwnProperty(f)&&(a[f]=l[f]);u(a.width)||(a.width=new Dc({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,value:[c.geometry.width]})),c.geometry._scene3DOnly=e.scene3DOnly,VC.setProjectionAndEllipsoid(c.geometry,e.mapProjection),s[t]=new vt({geometry:c.geometry,attributes:a,id:c.id,pickPrimitive:n})}i.geometryInstances=s,i.appearance=this.appearance,i._createShaderProgramFunction=function(c,l,f){c2e(n,l,f)},i._createCommandsFunction=function(c,l,f,d,p,g,m){l2e(n,l,f,d,g,m)},i._updateAndQueueCommandsFunction=function(c,l,f,d,p,g,m,y){u2e(n,l,f,d,p,g,m)},this._primitive=new In(i)}if(this.appearance instanceof rs&&!this._hasPerInstanceColors)throw new he("All GeometryInstances must have color attributes to use PolylineColorAppearance with GroundPolylinePrimitive.");this._primitive.appearance=this.appearance,this._primitive.show=this.show,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e),e.afterRender.push(()=>{!this._ready&&u(this._primitive)&&this._primitive.ready&&(this._ready=!0,this.releaseGeometryInstances&&(this.geometryInstances=void 0))})};up.prototype.getGeometryInstanceAttributes=function(e){return this._primitive.getGeometryInstanceAttributes(e)};up.isSupported=function(e){return e.frameState.context.depthTexture};up.prototype.isDestroyed=function(){return!1};up.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),this._sp=this._sp&&this._sp.destroy(),this._sp2D=void 0,this._spMorph=void 0,ue(this)};var Rh=up;var f2e=new H(1,1),d2e=!1,h2e=G.WHITE;function zC(e){e=x(e,x.EMPTY_OBJECT),this._definitionChanged=new me,this._image=void 0,this._imageSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._transparent=void 0,this._transparentSubscription=void 0,this.image=e.image,this.repeat=e.repeat,this.color=e.color,this.transparent=e.transparent}Object.defineProperties(zC.prototype,{isConstant:{get:function(){return Y.isConstant(this._image)&&Y.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},image:le("image"),repeat:le("repeat"),color:le("color"),transparent:le("transparent")});zC.prototype.getType=function(e){return"Image"};var m2e=new $;zC.prototype.getValue=function(e,t){return u(e)||(e=$.now(m2e)),u(t)||(t={}),t.image=Y.getValueOrUndefined(this._image,e),t.repeat=Y.getValueOrClonedDefault(this._repeat,e,f2e,t.repeat),t.color=Y.getValueOrClonedDefault(this._color,e,h2e,t.color),Y.getValueOrDefault(this._transparent,e,d2e)&&(t.color.alpha=Math.min(.99,t.color.alpha)),t};zC.prototype.equals=function(e){return this===e||e instanceof zC&&Y.equals(this._image,e._image)&&Y.equals(this._repeat,e._repeat)&&Y.equals(this._color,e._color)&&Y.equals(this._transparent,e._transparent)};var jy=zC;function p2e(e){if(e instanceof G)return new Ht(e);if(typeof e=="string"||e instanceof De||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement){let t=new jy;return t.image=e,t}}function _2e(e,t){return le(e,t,p2e)}var Bo=_2e;function hv(e){this._definitionChanged=new me,this._show=void 0,this._showSubscription=void 0,this._dimensions=void 0,this._dimensionsSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(x(e,x.EMPTY_OBJECT))}Object.defineProperties(hv.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:le("show"),dimensions:le("dimensions"),heightReference:le("heightReference"),fill:le("fill"),material:Bo("material"),outline:le("outline"),outlineColor:le("outlineColor"),outlineWidth:le("outlineWidth"),shadows:le("shadows"),distanceDisplayCondition:le("distanceDisplayCondition")});hv.prototype.clone=function(e){return u(e)?(e.show=this.show,e.dimensions=this.dimensions,e.heightReference=this.heightReference,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new hv(this)};hv.prototype.merge=function(e){this.show=x(this.show,e.show),this.dimensions=x(this.dimensions,e.dimensions),this.heightReference=x(this.heightReference,e.heightReference),this.fill=x(this.fill,e.fill),this.material=x(this.material,e.material),this.outline=x(this.outline,e.outline),this.outlineColor=x(this.outlineColor,e.outlineColor),this.outlineWidth=x(this.outlineWidth,e.outlineWidth),this.shadows=x(this.shadows,e.shadows),this.distanceDisplayCondition=x(this.distanceDisplayCondition,e.distanceDisplayCondition)};var HC=hv;var g2e={FIXED:0,INERTIAL:1},Gi=Object.freeze(g2e);function GC(){he.throwInstantiationError()}Object.defineProperties(GC.prototype,{isConstant:{get:he.throwInstantiationError},definitionChanged:{get:he.throwInstantiationError},referenceFrame:{get:he.throwInstantiationError}});GC.prototype.getValue=he.throwInstantiationError;GC.prototype.getValueInReferenceFrame=he.throwInstantiationError;GC.prototype.equals=he.throwInstantiationError;var Une=new J;GC.convertToReferenceFrame=function(e,t,n,i,o){if(!u(t))return t;if(u(o)||(o=new h),n===i)return h.clone(t,o);let r=Lt.computeIcrfToCentralBodyFixedMatrix(e,Une);if(n===Gi.INERTIAL)return J.multiplyByVector(r,t,o);if(n===Gi.FIXED)return J.multiplyByVector(J.transpose(r,Une),t,o)};var Oh=GC;function qy(e,t){this._definitionChanged=new me,this._value=h.clone(e),this._referenceFrame=x(t,Gi.FIXED)}Object.defineProperties(qy.prototype,{isConstant:{get:function(){return!u(this._value)||this._referenceFrame===Gi.FIXED}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}});var y2e=new $;qy.prototype.getValue=function(e,t){return u(e)||(e=$.now(y2e)),this.getValueInReferenceFrame(e,Gi.FIXED,t)};qy.prototype.setValue=function(e,t){let n=!1;h.equals(this._value,e)||(n=!0,this._value=h.clone(e)),u(t)&&this._referenceFrame!==t&&(n=!0,this._referenceFrame=t),n&&this._definitionChanged.raiseEvent(this)};qy.prototype.getValueInReferenceFrame=function(e,t,n){return Oh.convertToReferenceFrame(e,this._value,this._referenceFrame,t,n)};qy.prototype.equals=function(e){return this===e||e instanceof qy&&h.equals(this._value,e._value)&&this._referenceFrame===e._referenceFrame};var gl=qy;function mv(e){this._definitionChanged=new me,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._cornerType=void 0,this._cornerTypeSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(x(e,x.EMPTY_OBJECT))}Object.defineProperties(mv.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:le("show"),positions:le("positions"),width:le("width"),height:le("height"),heightReference:le("heightReference"),extrudedHeight:le("extrudedHeight"),extrudedHeightReference:le("extrudedHeightReference"),cornerType:le("cornerType"),granularity:le("granularity"),fill:le("fill"),material:Bo("material"),outline:le("outline"),outlineColor:le("outlineColor"),outlineWidth:le("outlineWidth"),shadows:le("shadows"),distanceDisplayCondition:le("distanceDisplayCondition"),classificationType:le("classificationType"),zIndex:le("zIndex")});mv.prototype.clone=function(e){return u(e)?(e.show=this.show,e.positions=this.positions,e.width=this.width,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.cornerType=this.cornerType,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new mv(this)};mv.prototype.merge=function(e){this.show=x(this.show,e.show),this.positions=x(this.positions,e.positions),this.width=x(this.width,e.width),this.height=x(this.height,e.height),this.heightReference=x(this.heightReference,e.heightReference),this.extrudedHeight=x(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=x(this.extrudedHeightReference,e.extrudedHeightReference),this.cornerType=x(this.cornerType,e.cornerType),this.granularity=x(this.granularity,e.granularity),this.fill=x(this.fill,e.fill),this.material=x(this.material,e.material),this.outline=x(this.outline,e.outline),this.outlineColor=x(this.outlineColor,e.outlineColor),this.outlineWidth=x(this.outlineWidth,e.outlineWidth),this.shadows=x(this.shadows,e.shadows),this.distanceDisplayCondition=x(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=x(this.classificationType,e.classificationType),this.zIndex=x(this.zIndex,e.zIndex)};var WC=mv;function x2e(e){return e}function b2e(e,t){return le(e,t,x2e)}var $l=b2e;function pv(e){this._definitionChanged=new me,this._show=void 0,this._showSubscription=void 0,this._length=void 0,this._lengthSubscription=void 0,this._topRadius=void 0,this._topRadiusSubscription=void 0,this._bottomRadius=void 0,this._bottomRadiusSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._numberOfVerticalLines=void 0,this._numberOfVerticalLinesSubscription=void 0,this._slices=void 0,this._slicesSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(x(e,x.EMPTY_OBJECT))}Object.defineProperties(pv.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:le("show"),length:le("length"),topRadius:le("topRadius"),bottomRadius:le("bottomRadius"),heightReference:le("heightReference"),fill:le("fill"),material:Bo("material"),outline:le("outline"),outlineColor:le("outlineColor"),outlineWidth:le("outlineWidth"),numberOfVerticalLines:le("numberOfVerticalLines"),slices:le("slices"),shadows:le("shadows"),distanceDisplayCondition:le("distanceDisplayCondition")});pv.prototype.clone=function(e){return u(e)?(e.show=this.show,e.length=this.length,e.topRadius=this.topRadius,e.bottomRadius=this.bottomRadius,e.heightReference=this.heightReference,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.numberOfVerticalLines=this.numberOfVerticalLines,e.slices=this.slices,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new pv(this)};pv.prototype.merge=function(e){this.show=x(this.show,e.show),this.length=x(this.length,e.length),this.topRadius=x(this.topRadius,e.topRadius),this.bottomRadius=x(this.bottomRadius,e.bottomRadius),this.heightReference=x(this.heightReference,e.heightReference),this.fill=x(this.fill,e.fill),this.material=x(this.material,e.material),this.outline=x(this.outline,e.outline),this.outlineColor=x(this.outlineColor,e.outlineColor),this.outlineWidth=x(this.outlineWidth,e.outlineWidth),this.numberOfVerticalLines=x(this.numberOfVerticalLines,e.numberOfVerticalLines),this.slices=x(this.slices,e.slices),this.shadows=x(this.shadows,e.shadows),this.distanceDisplayCondition=x(this.distanceDisplayCondition,e.distanceDisplayCondition)};var jC=pv;function _v(e){this._definitionChanged=new me,this._show=void 0,this._showSubscription=void 0,this._semiMajorAxis=void 0,this._semiMajorAxisSubscription=void 0,this._semiMinorAxis=void 0,this._semiMinorAxisSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._numberOfVerticalLines=void 0,this._numberOfVerticalLinesSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(x(e,x.EMPTY_OBJECT))}Object.defineProperties(_v.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:le("show"),semiMajorAxis:le("semiMajorAxis"),semiMinorAxis:le("semiMinorAxis"),height:le("height"),heightReference:le("heightReference"),extrudedHeight:le("extrudedHeight"),extrudedHeightReference:le("extrudedHeightReference"),rotation:le("rotation"),stRotation:le("stRotation"),granularity:le("granularity"),fill:le("fill"),material:Bo("material"),outline:le("outline"),outlineColor:le("outlineColor"),outlineWidth:le("outlineWidth"),numberOfVerticalLines:le("numberOfVerticalLines"),shadows:le("shadows"),distanceDisplayCondition:le("distanceDisplayCondition"),classificationType:le("classificationType"),zIndex:le("zIndex")});_v.prototype.clone=function(e){return u(e)?(e.show=this.show,e.semiMajorAxis=this.semiMajorAxis,e.semiMinorAxis=this.semiMinorAxis,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.rotation=this.rotation,e.stRotation=this.stRotation,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.numberOfVerticalLines=this.numberOfVerticalLines,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new _v(this)};_v.prototype.merge=function(e){this.show=x(this.show,e.show),this.semiMajorAxis=x(this.semiMajorAxis,e.semiMajorAxis),this.semiMinorAxis=x(this.semiMinorAxis,e.semiMinorAxis),this.height=x(this.height,e.height),this.heightReference=x(this.heightReference,e.heightReference),this.extrudedHeight=x(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=x(this.extrudedHeightReference,e.extrudedHeightReference),this.rotation=x(this.rotation,e.rotation),this.stRotation=x(this.stRotation,e.stRotation),this.granularity=x(this.granularity,e.granularity),this.fill=x(this.fill,e.fill),this.material=x(this.material,e.material),this.outline=x(this.outline,e.outline),this.outlineColor=x(this.outlineColor,e.outlineColor),this.outlineWidth=x(this.outlineWidth,e.outlineWidth),this.numberOfVerticalLines=x(this.numberOfVerticalLines,e.numberOfVerticalLines),this.shadows=x(this.shadows,e.shadows),this.distanceDisplayCondition=x(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=x(this.classificationType,e.classificationType),this.zIndex=x(this.zIndex,e.zIndex)};var qC=_v;function gv(e){this._definitionChanged=new me,this._show=void 0,this._showSubscription=void 0,this._radii=void 0,this._radiiSubscription=void 0,this._innerRadii=void 0,this._innerRadiiSubscription=void 0,this._minimumClock=void 0,this._minimumClockSubscription=void 0,this._maximumClock=void 0,this._maximumClockSubscription=void 0,this._minimumCone=void 0,this._minimumConeSubscription=void 0,this._maximumCone=void 0,this._maximumConeSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._stackPartitions=void 0,this._stackPartitionsSubscription=void 0,this._slicePartitions=void 0,this._slicePartitionsSubscription=void 0,this._subdivisions=void 0,this._subdivisionsSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(x(e,x.EMPTY_OBJECT))}Object.defineProperties(gv.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:le("show"),radii:le("radii"),innerRadii:le("innerRadii"),minimumClock:le("minimumClock"),maximumClock:le("maximumClock"),minimumCone:le("minimumCone"),maximumCone:le("maximumCone"),heightReference:le("heightReference"),fill:le("fill"),material:Bo("material"),outline:le("outline"),outlineColor:le("outlineColor"),outlineWidth:le("outlineWidth"),stackPartitions:le("stackPartitions"),slicePartitions:le("slicePartitions"),subdivisions:le("subdivisions"),shadows:le("shadows"),distanceDisplayCondition:le("distanceDisplayCondition")});gv.prototype.clone=function(e){return u(e)?(e.show=this.show,e.radii=this.radii,e.innerRadii=this.innerRadii,e.minimumClock=this.minimumClock,e.maximumClock=this.maximumClock,e.minimumCone=this.minimumCone,e.maximumCone=this.maximumCone,e.heightReference=this.heightReference,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.stackPartitions=this.stackPartitions,e.slicePartitions=this.slicePartitions,e.subdivisions=this.subdivisions,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new gv(this)};gv.prototype.merge=function(e){this.show=x(this.show,e.show),this.radii=x(this.radii,e.radii),this.innerRadii=x(this.innerRadii,e.innerRadii),this.minimumClock=x(this.minimumClock,e.minimumClock),this.maximumClock=x(this.maximumClock,e.maximumClock),this.minimumCone=x(this.minimumCone,e.minimumCone),this.maximumCone=x(this.maximumCone,e.maximumCone),this.heightReference=x(this.heightReference,e.heightReference),this.fill=x(this.fill,e.fill),this.material=x(this.material,e.material),this.outline=x(this.outline,e.outline),this.outlineColor=x(this.outlineColor,e.outlineColor),this.outlineWidth=x(this.outlineWidth,e.outlineWidth),this.stackPartitions=x(this.stackPartitions,e.stackPartitions),this.slicePartitions=x(this.slicePartitions,e.slicePartitions),this.subdivisions=x(this.subdivisions,e.subdivisions),this.shadows=x(this.shadows,e.shadows),this.distanceDisplayCondition=x(this.distanceDisplayCondition,e.distanceDisplayCondition)};var YC=gv;function yv(e){this._definitionChanged=new me,this._show=void 0,this._showSubscription=void 0,this._text=void 0,this._textSubscription=void 0,this._font=void 0,this._fontSubscription=void 0,this._style=void 0,this._styleSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._showBackground=void 0,this._showBackgroundSubscription=void 0,this._backgroundColor=void 0,this._backgroundColorSubscription=void 0,this._backgroundPadding=void 0,this._backgroundPaddingSubscription=void 0,this._pixelOffset=void 0,this._pixelOffsetSubscription=void 0,this._eyeOffset=void 0,this._eyeOffsetSubscription=void 0,this._horizontalOrigin=void 0,this._horizontalOriginSubscription=void 0,this._verticalOrigin=void 0,this._verticalOriginSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fillColor=void 0,this._fillColorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._pixelOffsetScaleByDistance=void 0,this._pixelOffsetScaleByDistanceSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this.merge(x(e,x.EMPTY_OBJECT))}Object.defineProperties(yv.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:le("show"),text:le("text"),font:le("font"),style:le("style"),scale:le("scale"),showBackground:le("showBackground"),backgroundColor:le("backgroundColor"),backgroundPadding:le("backgroundPadding"),pixelOffset:le("pixelOffset"),eyeOffset:le("eyeOffset"),horizontalOrigin:le("horizontalOrigin"),verticalOrigin:le("verticalOrigin"),heightReference:le("heightReference"),fillColor:le("fillColor"),outlineColor:le("outlineColor"),outlineWidth:le("outlineWidth"),translucencyByDistance:le("translucencyByDistance"),pixelOffsetScaleByDistance:le("pixelOffsetScaleByDistance"),scaleByDistance:le("scaleByDistance"),distanceDisplayCondition:le("distanceDisplayCondition"),disableDepthTestDistance:le("disableDepthTestDistance")});yv.prototype.clone=function(e){return u(e)?(e.show=this.show,e.text=this.text,e.font=this.font,e.style=this.style,e.scale=this.scale,e.showBackground=this.showBackground,e.backgroundColor=this.backgroundColor,e.backgroundPadding=this.backgroundPadding,e.pixelOffset=this.pixelOffset,e.eyeOffset=this.eyeOffset,e.horizontalOrigin=this.horizontalOrigin,e.verticalOrigin=this.verticalOrigin,e.heightReference=this.heightReference,e.fillColor=this.fillColor,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.translucencyByDistance=this.translucencyByDistance,e.pixelOffsetScaleByDistance=this.pixelOffsetScaleByDistance,e.scaleByDistance=this.scaleByDistance,e.distanceDisplayCondition=this.distanceDisplayCondition,e.disableDepthTestDistance=this.disableDepthTestDistance,e):new yv(this)};yv.prototype.merge=function(e){this.show=x(this.show,e.show),this.text=x(this.text,e.text),this.font=x(this.font,e.font),this.style=x(this.style,e.style),this.scale=x(this.scale,e.scale),this.showBackground=x(this.showBackground,e.showBackground),this.backgroundColor=x(this.backgroundColor,e.backgroundColor),this.backgroundPadding=x(this.backgroundPadding,e.backgroundPadding),this.pixelOffset=x(this.pixelOffset,e.pixelOffset),this.eyeOffset=x(this.eyeOffset,e.eyeOffset),this.horizontalOrigin=x(this.horizontalOrigin,e.horizontalOrigin),this.verticalOrigin=x(this.verticalOrigin,e.verticalOrigin),this.heightReference=x(this.heightReference,e.heightReference),this.fillColor=x(this.fillColor,e.fillColor),this.outlineColor=x(this.outlineColor,e.outlineColor),this.outlineWidth=x(this.outlineWidth,e.outlineWidth),this.translucencyByDistance=x(this.translucencyByDistance,e.translucencyByDistance),this.pixelOffsetScaleByDistance=x(this.pixelOffsetScaleByDistance,e.pixelOffsetScaleByDistance),this.scaleByDistance=x(this.scaleByDistance,e.scaleByDistance),this.distanceDisplayCondition=x(this.distanceDisplayCondition,e.distanceDisplayCondition),this.disableDepthTestDistance=x(this.disableDepthTestDistance,e.disableDepthTestDistance)};var Mh=yv;var C2e=new h(1,1,1),A2e=h.ZERO,T2e=Le.IDENTITY;function zne(e,t,n){this.translation=h.clone(x(e,A2e)),this.rotation=Le.clone(x(t,T2e)),this.scale=h.clone(x(n,C2e))}zne.prototype.equals=function(e){return this===e||u(e)&&h.equals(this.translation,e.translation)&&Le.equals(this.rotation,e.rotation)&&h.equals(this.scale,e.scale)};var Yy=zne;var O9=new Yy;function xv(e){e=x(e,x.EMPTY_OBJECT),this._definitionChanged=new me,this._translation=void 0,this._translationSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this.translation=e.translation,this.rotation=e.rotation,this.scale=e.scale}Object.defineProperties(xv.prototype,{isConstant:{get:function(){return Y.isConstant(this._translation)&&Y.isConstant(this._rotation)&&Y.isConstant(this._scale)}},definitionChanged:{get:function(){return this._definitionChanged}},translation:le("translation"),rotation:le("rotation"),scale:le("scale")});var E2e=new $;xv.prototype.getValue=function(e,t){return u(e)||(e=$.now(E2e)),u(t)||(t=new Yy),t.translation=Y.getValueOrClonedDefault(this._translation,e,O9.translation,t.translation),t.rotation=Y.getValueOrClonedDefault(this._rotation,e,O9.rotation,t.rotation),t.scale=Y.getValueOrClonedDefault(this._scale,e,O9.scale,t.scale),t};xv.prototype.equals=function(e){return this===e||e instanceof xv&&Y.equals(this._translation,e._translation)&&Y.equals(this._rotation,e._rotation)&&Y.equals(this._scale,e._scale)};var XC=xv;function fp(e,t){this._propertyNames=[],this._definitionChanged=new me,u(e)&&this.merge(e,t)}Object.defineProperties(fp.prototype,{propertyNames:{get:function(){return this._propertyNames}},isConstant:{get:function(){let e=this._propertyNames;for(let t=0,n=e.length;t<n;t++)if(!Y.isConstant(this[e[t]]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}}});fp.prototype.hasProperty=function(e){return this._propertyNames.indexOf(e)!==-1};function S2e(e){return new Kn(e)}fp.prototype.addProperty=function(e,t,n){this._propertyNames.push(e),Object.defineProperty(this,e,le(e,!0,x(n,S2e))),u(t)&&(this[e]=t),this._definitionChanged.raiseEvent(this)};fp.prototype.removeProperty=function(e){let n=this._propertyNames.indexOf(e);this._propertyNames.splice(n,1),delete this[e],this._definitionChanged.raiseEvent(this)};var v2e=new $;fp.prototype.getValue=function(e,t){u(e)||(e=$.now(v2e)),u(t)||(t={});let n=this._propertyNames;for(let i=0,o=n.length;i<o;i++){let r=n[i];t[r]=Y.getValueOrUndefined(this[r],e,t[r])}return t};fp.prototype.merge=function(e,t){let n=this._propertyNames,i=u(e._propertyNames)?e._propertyNames:Object.keys(e);for(let o=0,r=i.length;o<r;o++){let s=i[o],a=this[s],c=e[s];a===void 0&&n.indexOf(s)===-1&&this.addProperty(s,void 0,t),c!==void 0&&(a!==void 0?u(a)&&u(a.merge)&&a.merge(c):u(c)&&u(c.merge)&&u(c.clone)?this[s]=c.clone():this[s]=c)}};function w2e(e,t){let n=e._propertyNames,i=t._propertyNames,o=n.length;if(o!==i.length)return!1;for(let r=0;r<o;++r){let s=n[r];if(i.indexOf(s)===-1||!Y.equals(e[s],t[s]))return!1}return!0}fp.prototype.equals=function(e){return this===e||e instanceof fp&&w2e(this,e)};var Ql=fp;function Hne(e){return new XC(e)}function D2e(e){return new Ql(e,Hne)}function I2e(e){return new Ql(e)}function bv(e){this._definitionChanged=new me,this._show=void 0,this._showSubscription=void 0,this._uri=void 0,this._uriSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._hasVerticalExaggeration=void 0,this._hasVerticalExaggerationSubscription=void 0,this._enableVerticalExaggeration=void 0,this._enableVerticalExaggerationSubscription=void 0,this._minimumPixelSize=void 0,this._minimumPixelSizeSubscription=void 0,this._maximumScale=void 0,this._maximumScaleSubscription=void 0,this._incrementallyLoadTextures=void 0,this._incrementallyLoadTexturesSubscription=void 0,this._runAnimations=void 0,this._runAnimationsSubscription=void 0,this._clampAnimations=void 0,this._clampAnimationsSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._silhouetteColor=void 0,this._silhouetteColorSubscription=void 0,this._silhouetteSize=void 0,this._silhouetteSizeSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._colorBlendMode=void 0,this._colorBlendModeSubscription=void 0,this._colorBlendAmount=void 0,this._colorBlendAmountSubscription=void 0,this._imageBasedLightingFactor=void 0,this._imageBasedLightingFactorSubscription=void 0,this._lightColor=void 0,this._lightColorSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._nodeTransformations=void 0,this._nodeTransformationsSubscription=void 0,this._articulations=void 0,this._articulationsSubscription=void 0,this._clippingPlanes=void 0,this._clippingPlanesSubscription=void 0,this._customShader=void 0,this._customShaderSubscription=void 0,this.merge(x(e,x.EMPTY_OBJECT))}Object.defineProperties(bv.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:le("show"),uri:le("uri"),scale:le("scale"),enableVerticalExaggeration:le("enableVerticalExaggeration"),minimumPixelSize:le("minimumPixelSize"),maximumScale:le("maximumScale"),incrementallyLoadTextures:le("incrementallyLoadTextures"),runAnimations:le("runAnimations"),clampAnimations:le("clampAnimations"),shadows:le("shadows"),heightReference:le("heightReference"),silhouetteColor:le("silhouetteColor"),silhouetteSize:le("silhouetteSize"),color:le("color"),colorBlendMode:le("colorBlendMode"),colorBlendAmount:le("colorBlendAmount"),imageBasedLightingFactor:le("imageBasedLightingFactor"),lightColor:le("lightColor"),distanceDisplayCondition:le("distanceDisplayCondition"),nodeTransformations:le("nodeTransformations",void 0,D2e),articulations:le("articulations",void 0,I2e),clippingPlanes:le("clippingPlanes"),customShader:le("customShader")});bv.prototype.clone=function(e){return u(e)?(e.show=this.show,e.uri=this.uri,e.scale=this.scale,e.enableVerticalExaggeration=this.enableVerticalExaggeration,e.minimumPixelSize=this.minimumPixelSize,e.maximumScale=this.maximumScale,e.incrementallyLoadTextures=this.incrementallyLoadTextures,e.runAnimations=this.runAnimations,e.clampAnimations=this.clampAnimations,e.heightReference=this._heightReference,e.silhouetteColor=this.silhouetteColor,e.silhouetteSize=this.silhouetteSize,e.color=this.color,e.colorBlendMode=this.colorBlendMode,e.colorBlendAmount=this.colorBlendAmount,e.imageBasedLightingFactor=this.imageBasedLightingFactor,e.lightColor=this.lightColor,e.distanceDisplayCondition=this.distanceDisplayCondition,e.nodeTransformations=this.nodeTransformations,e.articulations=this.articulations,e.clippingPlanes=this.clippingPlanes,e.customShader=this.customShader,e):new bv(this)};bv.prototype.merge=function(e){this.show=x(this.show,e.show),this.uri=x(this.uri,e.uri),this.scale=x(this.scale,e.scale),this.enableVerticalExaggeration=x(this.enableVerticalExaggeration,e.enableVerticalExaggeration),this.minimumPixelSize=x(this.minimumPixelSize,e.minimumPixelSize),this.maximumScale=x(this.maximumScale,e.maximumScale),this.incrementallyLoadTextures=x(this.incrementallyLoadTextures,e.incrementallyLoadTextures),this.runAnimations=x(this.runAnimations,e.runAnimations),this.clampAnimations=x(this.clampAnimations,e.clampAnimations),this.shadows=x(this.shadows,e.shadows),this.heightReference=x(this.heightReference,e.heightReference),this.silhouetteColor=x(this.silhouetteColor,e.silhouetteColor),this.silhouetteSize=x(this.silhouetteSize,e.silhouetteSize),this.color=x(this.color,e.color),this.colorBlendMode=x(this.colorBlendMode,e.colorBlendMode),this.colorBlendAmount=x(this.colorBlendAmount,e.colorBlendAmount),this.imageBasedLightingFactor=x(this.imageBasedLightingFactor,e.imageBasedLightingFactor),this.lightColor=x(this.lightColor,e.lightColor),this.distanceDisplayCondition=x(this.distanceDisplayCondition,e.distanceDisplayCondition),this.clippingPlanes=x(this.clippingPlanes,e.clippingPlanes),this.customShader=x(this.customShader,e.customShader);let t=e.nodeTransformations;if(u(t)){let i=this.nodeTransformations;u(i)?i.merge(t):this.nodeTransformations=new Ql(t,Hne)}let n=e.articulations;if(u(n)){let i=this.articulations;u(i)?i.merge(n):this.articulations=new Ql(n)}};var Z_=bv;function Cv(e){this._definitionChanged=new me,this._show=void 0,this._showSubscription=void 0,this._uri=void 0,this._uriSubscription=void 0,this._maximumScreenSpaceError=void 0,this._maximumScreenSpaceErrorSubscription=void 0,this.merge(x(e,x.EMPTY_OBJECT))}Object.defineProperties(Cv.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:le("show"),uri:le("uri"),maximumScreenSpaceError:le("maximumScreenSpaceError")});Cv.prototype.clone=function(e){return u(e)?(e.show=this.show,e.uri=this.uri,e.maximumScreenSpaceError=this.maximumScreenSpaceError,e):new Cv(this)};Cv.prototype.merge=function(e){this.show=x(this.show,e.show),this.uri=x(this.uri,e.uri),this.maximumScreenSpaceError=x(this.maximumScreenSpaceError,e.maximumScreenSpaceError)};var KC=Cv;function Av(e){this._definitionChanged=new me,this._show=void 0,this._showSubscription=void 0,this._leadTime=void 0,this._leadTimeSubscription=void 0,this._trailTime=void 0,this._trailTimeSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._resolution=void 0,this._resolutionSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(x(e,x.EMPTY_OBJECT))}Object.defineProperties(Av.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:le("show"),leadTime:le("leadTime"),trailTime:le("trailTime"),width:le("width"),resolution:le("resolution"),material:Bo("material"),distanceDisplayCondition:le("distanceDisplayCondition")});Av.prototype.clone=function(e){return u(e)?(e.show=this.show,e.leadTime=this.leadTime,e.trailTime=this.trailTime,e.width=this.width,e.resolution=this.resolution,e.material=this.material,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new Av(this)};Av.prototype.merge=function(e){this.show=x(this.show,e.show),this.leadTime=x(this.leadTime,e.leadTime),this.trailTime=x(this.trailTime,e.trailTime),this.width=x(this.width,e.width),this.resolution=x(this.resolution,e.resolution),this.material=x(this.material,e.material),this.distanceDisplayCondition=x(this.distanceDisplayCondition,e.distanceDisplayCondition)};var $_=Av;function Tv(e){this._definitionChanged=new me,this._show=void 0,this._showSubscription=void 0,this._plane=void 0,this._planeSubscription=void 0,this._dimensions=void 0,this._dimensionsSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(x(e,x.EMPTY_OBJECT))}Object.defineProperties(Tv.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:le("show"),plane:le("plane"),dimensions:le("dimensions"),fill:le("fill"),material:Bo("material"),outline:le("outline"),outlineColor:le("outlineColor"),outlineWidth:le("outlineWidth"),shadows:le("shadows"),distanceDisplayCondition:le("distanceDisplayCondition")});Tv.prototype.clone=function(e){return u(e)?(e.show=this.show,e.plane=this.plane,e.dimensions=this.dimensions,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new Tv(this)};Tv.prototype.merge=function(e){this.show=x(this.show,e.show),this.plane=x(this.plane,e.plane),this.dimensions=x(this.dimensions,e.dimensions),this.fill=x(this.fill,e.fill),this.material=x(this.material,e.material),this.outline=x(this.outline,e.outline),this.outlineColor=x(this.outlineColor,e.outlineColor),this.outlineWidth=x(this.outlineWidth,e.outlineWidth),this.shadows=x(this.shadows,e.shadows),this.distanceDisplayCondition=x(this.distanceDisplayCondition,e.distanceDisplayCondition)};var UL=Tv;function Ev(e){this._definitionChanged=new me,this._show=void 0,this._showSubscription=void 0,this._pixelSize=void 0,this._pixelSizeSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this._splitDirection=void 0,this._splitDirectionSubscription=void 0,this.merge(x(e,x.EMPTY_OBJECT))}Object.defineProperties(Ev.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:le("show"),pixelSize:le("pixelSize"),heightReference:le("heightReference"),color:le("color"),outlineColor:le("outlineColor"),outlineWidth:le("outlineWidth"),scaleByDistance:le("scaleByDistance"),translucencyByDistance:le("translucencyByDistance"),distanceDisplayCondition:le("distanceDisplayCondition"),disableDepthTestDistance:le("disableDepthTestDistance"),splitDirection:le("splitDirection")});Ev.prototype.clone=function(e){return u(e)?(e.show=this.show,e.pixelSize=this.pixelSize,e.heightReference=this.heightReference,e.color=this.color,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.scaleByDistance=this.scaleByDistance,e.translucencyByDistance=this._translucencyByDistance,e.distanceDisplayCondition=this.distanceDisplayCondition,e.disableDepthTestDistance=this.disableDepthTestDistance,e.splitDirection=this.splitDirection,e):new Ev(this)};Ev.prototype.merge=function(e){this.show=x(this.show,e.show),this.pixelSize=x(this.pixelSize,e.pixelSize),this.heightReference=x(this.heightReference,e.heightReference),this.color=x(this.color,e.color),this.outlineColor=x(this.outlineColor,e.outlineColor),this.outlineWidth=x(this.outlineWidth,e.outlineWidth),this.scaleByDistance=x(this.scaleByDistance,e.scaleByDistance),this.translucencyByDistance=x(this._translucencyByDistance,e.translucencyByDistance),this.distanceDisplayCondition=x(this.distanceDisplayCondition,e.distanceDisplayCondition),this.disableDepthTestDistance=x(this.disableDepthTestDistance,e.disableDepthTestDistance),this.splitDirection=x(this.splitDirection,e.splitDirection)};var ZC=Ev;function P2e(e,t){this.positions=u(e)?e:[],this.holes=u(t)?t:[]}var Za=P2e;function R2e(e){return Array.isArray(e)&&(e=new Za(e)),new Kn(e)}function Sv(e){this._definitionChanged=new me,this._show=void 0,this._showSubscription=void 0,this._hierarchy=void 0,this._hierarchySubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._perPositionHeight=void 0,this._perPositionHeightSubscription=void 0,this._closeTop=void 0,this._closeTopSubscription=void 0,this._closeBottom=void 0,this._closeBottomSubscription=void 0,this._arcType=void 0,this._arcTypeSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this._textureCoordinates=void 0,this._textureCoordinatesSubscription=void 0,this.merge(x(e,x.EMPTY_OBJECT))}Object.defineProperties(Sv.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:le("show"),hierarchy:le("hierarchy",void 0,R2e),height:le("height"),heightReference:le("heightReference"),extrudedHeight:le("extrudedHeight"),extrudedHeightReference:le("extrudedHeightReference"),stRotation:le("stRotation"),granularity:le("granularity"),fill:le("fill"),material:Bo("material"),outline:le("outline"),outlineColor:le("outlineColor"),outlineWidth:le("outlineWidth"),perPositionHeight:le("perPositionHeight"),closeTop:le("closeTop"),closeBottom:le("closeBottom"),arcType:le("arcType"),shadows:le("shadows"),distanceDisplayCondition:le("distanceDisplayCondition"),classificationType:le("classificationType"),zIndex:le("zIndex"),textureCoordinates:le("textureCoordinates")});Sv.prototype.clone=function(e){return u(e)?(e.show=this.show,e.hierarchy=this.hierarchy,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.stRotation=this.stRotation,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.perPositionHeight=this.perPositionHeight,e.closeTop=this.closeTop,e.closeBottom=this.closeBottom,e.arcType=this.arcType,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e.textureCoordinates=this.textureCoordinates,e):new Sv(this)};Sv.prototype.merge=function(e){this.show=x(this.show,e.show),this.hierarchy=x(this.hierarchy,e.hierarchy),this.height=x(this.height,e.height),this.heightReference=x(this.heightReference,e.heightReference),this.extrudedHeight=x(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=x(this.extrudedHeightReference,e.extrudedHeightReference),this.stRotation=x(this.stRotation,e.stRotation),this.granularity=x(this.granularity,e.granularity),this.fill=x(this.fill,e.fill),this.material=x(this.material,e.material),this.outline=x(this.outline,e.outline),this.outlineColor=x(this.outlineColor,e.outlineColor),this.outlineWidth=x(this.outlineWidth,e.outlineWidth),this.perPositionHeight=x(this.perPositionHeight,e.perPositionHeight),this.closeTop=x(this.closeTop,e.closeTop),this.closeBottom=x(this.closeBottom,e.closeBottom),this.arcType=x(this.arcType,e.arcType),this.shadows=x(this.shadows,e.shadows),this.distanceDisplayCondition=x(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=x(this.classificationType,e.classificationType),this.zIndex=x(this.zIndex,e.zIndex),this.textureCoordinates=x(this.textureCoordinates,e.textureCoordinates)};var Lh=Sv;function vv(e){this._definitionChanged=new me,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._depthFailMaterial=void 0,this._depthFailMaterialSubscription=void 0,this._arcType=void 0,this._arcTypeSubscription=void 0,this._clampToGround=void 0,this._clampToGroundSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(x(e,x.EMPTY_OBJECT))}Object.defineProperties(vv.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:le("show"),positions:le("positions"),width:le("width"),granularity:le("granularity"),material:Bo("material"),depthFailMaterial:Bo("depthFailMaterial"),arcType:le("arcType"),clampToGround:le("clampToGround"),shadows:le("shadows"),distanceDisplayCondition:le("distanceDisplayCondition"),classificationType:le("classificationType"),zIndex:le("zIndex")});vv.prototype.clone=function(e){return u(e)?(e.show=this.show,e.positions=this.positions,e.width=this.width,e.granularity=this.granularity,e.material=this.material,e.depthFailMaterial=this.depthFailMaterial,e.arcType=this.arcType,e.clampToGround=this.clampToGround,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new vv(this)};vv.prototype.merge=function(e){this.show=x(this.show,e.show),this.positions=x(this.positions,e.positions),this.width=x(this.width,e.width),this.granularity=x(this.granularity,e.granularity),this.material=x(this.material,e.material),this.depthFailMaterial=x(this.depthFailMaterial,e.depthFailMaterial),this.arcType=x(this.arcType,e.arcType),this.clampToGround=x(this.clampToGround,e.clampToGround),this.shadows=x(this.shadows,e.shadows),this.distanceDisplayCondition=x(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=x(this.classificationType,e.classificationType),this.zIndex=x(this.zIndex,e.zIndex)};var Pc=vv;function wv(e){this._definitionChanged=new me,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._shape=void 0,this._shapeSubscription=void 0,this._cornerType=void 0,this._cornerTypeSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubsription=void 0,this.merge(x(e,x.EMPTY_OBJECT))}Object.defineProperties(wv.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:le("show"),positions:le("positions"),shape:le("shape"),cornerType:le("cornerType"),granularity:le("granularity"),fill:le("fill"),material:Bo("material"),outline:le("outline"),outlineColor:le("outlineColor"),outlineWidth:le("outlineWidth"),shadows:le("shadows"),distanceDisplayCondition:le("distanceDisplayCondition")});wv.prototype.clone=function(e){return u(e)?(e.show=this.show,e.positions=this.positions,e.shape=this.shape,e.cornerType=this.cornerType,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new wv(this)};wv.prototype.merge=function(e){this.show=x(this.show,e.show),this.positions=x(this.positions,e.positions),this.shape=x(this.shape,e.shape),this.cornerType=x(this.cornerType,e.cornerType),this.granularity=x(this.granularity,e.granularity),this.fill=x(this.fill,e.fill),this.material=x(this.material,e.material),this.outline=x(this.outline,e.outline),this.outlineColor=x(this.outlineColor,e.outlineColor),this.outlineWidth=x(this.outlineWidth,e.outlineWidth),this.shadows=x(this.shadows,e.shadows),this.distanceDisplayCondition=x(this.distanceDisplayCondition,e.distanceDisplayCondition)};var $C=wv;function Dv(e){this._definitionChanged=new me,this._show=void 0,this._showSubscription=void 0,this._coordinates=void 0,this._coordinatesSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distancedisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(x(e,x.EMPTY_OBJECT))}Object.defineProperties(Dv.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:le("show"),coordinates:le("coordinates"),height:le("height"),heightReference:le("heightReference"),extrudedHeight:le("extrudedHeight"),extrudedHeightReference:le("extrudedHeightReference"),rotation:le("rotation"),stRotation:le("stRotation"),granularity:le("granularity"),fill:le("fill"),material:Bo("material"),outline:le("outline"),outlineColor:le("outlineColor"),outlineWidth:le("outlineWidth"),shadows:le("shadows"),distanceDisplayCondition:le("distanceDisplayCondition"),classificationType:le("classificationType"),zIndex:le("zIndex")});Dv.prototype.clone=function(e){return u(e)?(e.show=this.show,e.coordinates=this.coordinates,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.rotation=this.rotation,e.stRotation=this.stRotation,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new Dv(this)};Dv.prototype.merge=function(e){this.show=x(this.show,e.show),this.coordinates=x(this.coordinates,e.coordinates),this.height=x(this.height,e.height),this.heightReference=x(this.heightReference,e.heightReference),this.extrudedHeight=x(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=x(this.extrudedHeightReference,e.extrudedHeightReference),this.rotation=x(this.rotation,e.rotation),this.stRotation=x(this.stRotation,e.stRotation),this.granularity=x(this.granularity,e.granularity),this.fill=x(this.fill,e.fill),this.material=x(this.material,e.material),this.outline=x(this.outline,e.outline),this.outlineColor=x(this.outlineColor,e.outlineColor),this.outlineWidth=x(this.outlineWidth,e.outlineWidth),this.shadows=x(this.shadows,e.shadows),this.distanceDisplayCondition=x(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=x(this.classificationType,e.classificationType),this.zIndex=x(this.zIndex,e.zIndex)};var Nh=Dv;function Iv(e){this._definitionChanged=new me,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._minimumHeights=void 0,this._minimumHeightsSubscription=void 0,this._maximumHeights=void 0,this._maximumHeightsSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(x(e,x.EMPTY_OBJECT))}Object.defineProperties(Iv.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:le("show"),positions:le("positions"),minimumHeights:le("minimumHeights"),maximumHeights:le("maximumHeights"),granularity:le("granularity"),fill:le("fill"),material:Bo("material"),outline:le("outline"),outlineColor:le("outlineColor"),outlineWidth:le("outlineWidth"),shadows:le("shadows"),distanceDisplayCondition:le("distanceDisplayCondition")});Iv.prototype.clone=function(e){return u(e)?(e.show=this.show,e.positions=this.positions,e.minimumHeights=this.minimumHeights,e.maximumHeights=this.maximumHeights,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new Iv(this)};Iv.prototype.merge=function(e){this.show=x(this.show,e.show),this.positions=x(this.positions,e.positions),this.minimumHeights=x(this.minimumHeights,e.minimumHeights),this.maximumHeights=x(this.maximumHeights,e.maximumHeights),this.granularity=x(this.granularity,e.granularity),this.fill=x(this.fill,e.fill),this.material=x(this.material,e.material),this.outline=x(this.outline,e.outline),this.outlineColor=x(this.outlineColor,e.outlineColor),this.outlineWidth=x(this.outlineWidth,e.outlineWidth),this.shadows=x(this.shadows,e.shadows),this.distanceDisplayCondition=x(this.distanceDisplayCondition,e.distanceDisplayCondition)};var Q_=Iv;var O2e=new de,M9=[];function M2e(e){return new gl(e)}function L2e(e){return le(e,void 0,M2e)}function Fs(e,t){return le(e,void 0,function(n){return n instanceof t?n:new t(n)})}function sf(e){e=x(e,x.EMPTY_OBJECT);let t=e.id;u(t)||(t=Hn()),this._availability=void 0,this._id=t,this._definitionChanged=new me,this._name=e.name,this._show=x(e.show,!0),this._parent=void 0,this._propertyNames=["billboard","box","corridor","cylinder","description","ellipse","ellipsoid","label","model","tileset","orientation","path","plane","point","polygon","polyline","polylineVolume","position","properties","rectangle","viewFrom","wall",...M9],this._billboard=void 0,this._billboardSubscription=void 0,this._box=void 0,this._boxSubscription=void 0,this._corridor=void 0,this._corridorSubscription=void 0,this._cylinder=void 0,this._cylinderSubscription=void 0,this._description=void 0,this._descriptionSubscription=void 0,this._ellipse=void 0,this._ellipseSubscription=void 0,this._ellipsoid=void 0,this._ellipsoidSubscription=void 0,this._label=void 0,this._labelSubscription=void 0,this._model=void 0,this._modelSubscription=void 0,this._tileset=void 0,this._tilesetSubscription=void 0,this._orientation=void 0,this._orientationSubscription=void 0,this._path=void 0,this._pathSubscription=void 0,this._plane=void 0,this._planeSubscription=void 0,this._point=void 0,this._pointSubscription=void 0,this._polygon=void 0,this._polygonSubscription=void 0,this._polyline=void 0,this._polylineSubscription=void 0,this._polylineVolume=void 0,this._polylineVolumeSubscription=void 0,this._position=void 0,this._positionSubscription=void 0,this._properties=void 0,this._propertiesSubscription=void 0,this._rectangle=void 0,this._rectangleSubscription=void 0,this._viewFrom=void 0,this._viewFromSubscription=void 0,this._wall=void 0,this._wallSubscription=void 0,this._children=[],this.entityCollection=void 0,this.parent=e.parent,this.merge(e)}function L9(e,t,n){let i=t.length;for(let o=0;o<i;o++){let r=t[o],s=r._show;(!n&&s)!==(n&&s)&&L9(r,r._children,n)}e._definitionChanged.raiseEvent(e,"isShowing",n,!n)}Object.defineProperties(sf.prototype,{availability:$l("availability"),id:{get:function(){return this._id}},definitionChanged:{get:function(){return this._definitionChanged}},name:$l("name"),show:{get:function(){return this._show},set:function(e){if(e===this._show)return;let t=this.isShowing;this._show=e;let n=this.isShowing;t!==n&&L9(this,this._children,n),this._definitionChanged.raiseEvent(this,"show",e,!e)}},isShowing:{get:function(){return this._show&&(!u(this.entityCollection)||this.entityCollection.show)&&(!u(this._parent)||this._parent.isShowing)}},parent:{get:function(){return this._parent},set:function(e){let t=this._parent;if(t===e)return;let n=this.isShowing;if(u(t)){let o=t._children.indexOf(this);t._children.splice(o,1)}this._parent=e,u(e)&&e._children.push(this);let i=this.isShowing;n!==i&&L9(this,this._children,i),this._definitionChanged.raiseEvent(this,"parent",e,t)}},propertyNames:{get:function(){return this._propertyNames}},billboard:Fs("billboard",Sc),box:Fs("box",HC),corridor:Fs("corridor",WC),cylinder:Fs("cylinder",jC),description:le("description"),ellipse:Fs("ellipse",qC),ellipsoid:Fs("ellipsoid",YC),label:Fs("label",Mh),model:Fs("model",Z_),tileset:Fs("tileset",KC),orientation:le("orientation"),path:Fs("path",$_),plane:Fs("plane",UL),point:Fs("point",ZC),polygon:Fs("polygon",Lh),polyline:Fs("polyline",Pc),polylineVolume:Fs("polylineVolume",$C),properties:Fs("properties",Ql),position:L2e("position"),rectangle:Fs("rectangle",Nh),viewFrom:le("viewFrom"),wall:Fs("wall",Q_)});sf.registerEntityType=function(e,t){Object.defineProperties(sf.prototype,{[e]:Fs(e,t)}),M9.includes(e)||M9.push(e)};sf.prototype.isAvailable=function(e){let t=this._availability;return!u(t)||t.contains(e)};sf.prototype.addProperty=function(e){this._propertyNames.push(e),Object.defineProperty(this,e,$l(e,!0))};sf.prototype.removeProperty=function(e){let n=this._propertyNames.indexOf(e);this._propertyNames.splice(n,1),delete this[e]};sf.prototype.merge=function(e){this.name=x(this.name,e.name),this.availability=x(this.availability,e.availability);let t=this._propertyNames,n=u(e._propertyNames)?e._propertyNames:Object.keys(e),i=n.length;for(let o=0;o<i;o++){let r=n[o];if(r==="parent"||r==="name"||r==="availability"||r==="children")continue;let s=this[r],a=e[r];!u(s)&&t.indexOf(r)===-1&&this.addProperty(r),u(a)&&(u(s)?u(s.merge)&&s.merge(a):u(a.merge)&&u(a.clone)?this[r]=a.clone():this[r]=a)}};var Gne=new J,Wne=new h,jne=new Le;sf.prototype.computeModelMatrix=function(e,t){let n=Y.getValueOrUndefined(this._position,e,Wne);if(!u(n))return;let i=Y.getValueOrUndefined(this._orientation,e,jne);return u(i)?t=F.fromRotationTranslation(J.fromQuaternion(i,Gne),n,t):t=Lt.eastNorthUpToFixedFrame(n,void 0,t),t};sf.prototype.computeModelMatrixForHeightReference=function(e,t,n,i,o){let r=Y.getValueOrDefault(t,e,Xe.NONE),s=Y.getValueOrUndefined(this._position,e,Wne);if(r===Xe.NONE||!u(s)||h.equalsEpsilon(s,h.ZERO,R.EPSILON8))return this.computeModelMatrix(e,o);let a=i.cartesianToCartographic(s,O2e);tf(r)?a.height=n:a.height+=n,s=i.cartographicToCartesian(a,s);let c=Y.getValueOrUndefined(this._orientation,e,jne);return u(c)?o=F.fromRotationTranslation(J.fromQuaternion(c,Gne),s,o):o=Lt.eastNorthUpToFixedFrame(s,void 0,o),o};sf.supportsMaterialsforEntitiesOnTerrain=function(e){return _l.supportsMaterials(e)};sf.supportsPolylinesOnTerrain=function(e){return Rh.isSupported(e)};var ar=sf;var N2e=new Ht(G.WHITE),F2e=new Kn(!0),B2e=new Kn(!0),k2e=new Kn(!1),V2e=new Kn(G.BLACK),U2e=new Kn(xn.DISABLED),z2e=new Kn(new Nt),H2e=new Kn(Vn.BOTH);function Rc(e){let t=e.entity,n=e.geometryPropertyName;this._entity=t,this._scene=e.scene,this._fillEnabled=!1,this._isClosed=!1,this._onTerrain=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new me,this._showProperty=void 0,this._materialProperty=void 0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._classificationTypeProperty=void 0,this._options=e.geometryOptions,this._geometryPropertyName=n,this._id=`${n}-${t.id}`,this._observedPropertyNames=e.observedPropertyNames,this._supportsMaterialsforEntitiesOnTerrain=ar.supportsMaterialsforEntitiesOnTerrain(e.scene)}Object.defineProperties(Rc.prototype,{id:{get:function(){return this._id}},entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!u(this._entity.availability)&&Y.isConstant(this._showProperty)&&Y.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!u(this._entity.availability)&&Y.isConstant(this._showProperty)&&Y.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},classificationTypeProperty:{get:function(){return this._classificationTypeProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}});Rc.prototype.isOutlineVisible=function(e){let t=this._entity,n=this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e);return x(n,!1)};Rc.prototype.isFilled=function(e){let t=this._entity,n=this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e);return x(n,!1)};Rc.prototype.createFillGeometryInstance=he.throwInstantiationError;Rc.prototype.createOutlineGeometryInstance=he.throwInstantiationError;Rc.prototype.isDestroyed=function(){return!1};Rc.prototype.destroy=function(){ue(this)};Rc.prototype._isHidden=function(e,t){let n=t.show;return u(n)&&n.isConstant&&!n.getValue(He.MINIMUM_VALUE)};Rc.prototype._isOnTerrain=function(e,t){return!1};Rc.prototype._getIsClosed=function(e){return!0};Rc.prototype._isDynamic=he.throwInstantiationError;Rc.prototype._setStaticOptions=he.throwInstantiationError;Rc.prototype._onEntityPropertyChanged=function(e,t,n,i){if(this._observedPropertyNames.indexOf(t)===-1)return;let o=this._entity[this._geometryPropertyName];if(!u(o)){(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this));return}let r=o.fill,s=u(r)&&r.isConstant?r.getValue(He.MINIMUM_VALUE):!0,a=o.outline,c=u(a);if(c&&a.isConstant&&(c=a.getValue(He.MINIMUM_VALUE)),!s&&!c){(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this));return}let l=o.show;if(this._isHidden(e,o)){(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this));return}this._materialProperty=x(o.material,N2e),this._fillProperty=x(r,B2e),this._showProperty=x(l,F2e),this._showOutlineProperty=x(o.outline,k2e),this._outlineColorProperty=c?x(o.outlineColor,V2e):void 0,this._shadowsProperty=x(o.shadows,U2e),this._distanceDisplayConditionProperty=x(o.distanceDisplayCondition,z2e),this._classificationTypeProperty=x(o.classificationType,H2e),this._fillEnabled=s;let f=this._isOnTerrain(e,o)&&(this._supportsMaterialsforEntitiesOnTerrain||this._materialProperty instanceof Ht);if(c&&f&&(At(At.geometryOutlines),c=!1),this._onTerrain=f,this._outlineEnabled=c,this._isDynamic(e,o))this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this));else{this._setStaticOptions(e,o),this._isClosed=this._getIsClosed(this._options);let d=o.outlineWidth;this._outlineWidth=u(d)?d.getValue(He.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}};Rc.prototype.createDynamicUpdater=function(e,t){return new this.constructor.DynamicGeometryUpdater(this,e,t)};var ri=Rc;function QC(e,t){this._callback=void 0,this._isConstant=void 0,this._definitionChanged=new me,this.setCallback(e,t)}Object.defineProperties(QC.prototype,{isConstant:{get:function(){return this._isConstant}},definitionChanged:{get:function(){return this._definitionChanged}}});var G2e=new $;QC.prototype.getValue=function(e,t){return u(e)||(e=$.now(G2e)),this._callback(e,t)};QC.prototype.setCallback=function(e,t){let n=this._callback!==e||this._isConstant!==t;this._callback=e,this._isConstant=t,n&&this._definitionChanged.raiseEvent(this)};QC.prototype.equals=function(e){return this===e||e instanceof QC&&this._callback===e._callback&&this._isConstant===e._isConstant};var Fh=QC;var qne=new h;function JC(e,t,n,i){this._scene=e,this._heightReference=n,this._extrudedHeightReference=i,this._positionProperty=t,this._position=new h,this._cartographicPosition=new de,this._normal=new h,this._definitionChanged=new me,this._terrainHeight=0,this._removeCallbackFunc=void 0,this._removeEventListener=void 0,this._removeModeListener=void 0;let o=this;if(u(e.globe)&&(this._removeEventListener=e.terrainProviderChanged.addEventListener(function(){o._updateClamping()}),this._removeModeListener=e.morphComplete.addEventListener(function(){o._updateClamping()})),t.isConstant){let r=t.getValue(He.MINIMUM_VALUE,qne);if(!u(r)||h.equals(r,h.ZERO)||!u(e.globe))return;this._position=h.clone(r,this._position),this._updateClamping(),this._normal=e.ellipsoid.geodeticSurfaceNormal(r,this._normal)}}Object.defineProperties(JC.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}}});JC.prototype._updateClamping=function(){u(this._removeCallbackFunc)&&this._removeCallbackFunc();let e=this._scene,t=this._position;if(h.equals(t,h.ZERO)){this._terrainHeight=0;return}let i=e.ellipsoid.cartesianToCartographic(t,this._cartographicPosition),o=e.getHeight(i,this._heightReference);u(o)?this._terrainHeight=o:this._terrainHeight=0;let r=s=>{this._terrainHeight=s.height,this.definitionChanged.raiseEvent()};this._removeCallbackFunc=e.updateHeight(i,r,this._heightReference)};var W2e=new $;JC.prototype.getValue=function(e,t){u(e)||(e=$.now(W2e));let n=Y.getValueOrDefault(this._heightReference,e,Xe.NONE),i=Y.getValueOrDefault(this._extrudedHeightReference,e,Xe.NONE);if(n===Xe.NONE&&!DC(i))return this._position=h.clone(h.ZERO,this._position),h.clone(h.ZERO,t);if(this._positionProperty.isConstant)return h.multiplyByScalar(this._normal,this._terrainHeight,t);let o=this._scene,r=this._positionProperty.getValue(e,qne);if(!u(r)||h.equals(r,h.ZERO)||!u(o.globe))return h.clone(h.ZERO,t);if(h.equalsEpsilon(this._position,r,R.EPSILON10))return h.multiplyByScalar(this._normal,this._terrainHeight,t);this._position=h.clone(r,this._position),this._updateClamping();let s=o.ellipsoid.geodeticSurfaceNormal(r,this._normal);return h.multiplyByScalar(s,this._terrainHeight,t)};JC.prototype.isDestroyed=function(){return!1};JC.prototype.destroy=function(){return u(this._removeEventListener)&&this._removeEventListener(),u(this._removeModeListener)&&this._removeModeListener(),u(this._removeCallbackFunc)&&this._removeCallbackFunc(),ue(this)};var eA=JC;function j2e(e,t,n,i){if(ri.prototype._onEntityPropertyChanged.call(this,e,t,n,i),this._observedPropertyNames.indexOf(t)===-1)return;let o=this._entity[this._geometryPropertyName];if(!u(o))return;u(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0);let r=o.heightReference;if(u(r)){let s=new Fh(this._computeCenter.bind(this),!this._dynamic);this._terrainOffsetProperty=new eA(this._scene,s,r)}}var J_=j2e;var Yne=h.ZERO,Xne=new h,q2e=new h,Kne=new G;function Y2e(e){this.id=e,this.vertexFormat=void 0,this.dimensions=void 0,this.offsetAttribute=void 0}function Jl(e,t){ri.call(this,{entity:e,scene:t,geometryOptions:new Y2e(e),geometryPropertyName:"box",observedPropertyNames:["availability","position","orientation","box"]}),this._onEntityPropertyChanged(e,"box",e.box,void 0)}u(Object.create)&&(Jl.prototype=Object.create(ri.prototype),Jl.prototype.constructor=Jl);Object.defineProperties(Jl.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}});Jl.prototype.createFillGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i=new yn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),r=kn.fromDistanceDisplayCondition(o),s={show:i,distanceDisplayCondition:r,color:void 0,offset:void 0};if(this._materialProperty instanceof Ht){let a;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(a=this._materialProperty.color.getValue(e,Kne)),u(a)||(a=G.WHITE),s.color=jt.fromColor(a)}return u(this._options.offsetAttribute)&&(s.offset=to.fromCartesian3(Y.getValueOrDefault(this._terrainOffsetProperty,e,Yne,Xne))),new vt({id:t,geometry:Ya.fromDimensions(this._options),modelMatrix:t.computeModelMatrixForHeightReference(e,t.box.heightReference,this._options.dimensions.z*.5,this._scene.ellipsoid),attributes:s})};Jl.prototype.createOutlineGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i=Y.getValueOrDefault(this._outlineColorProperty,e,G.BLACK,Kne),o=this._distanceDisplayConditionProperty.getValue(e),r={show:new yn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:jt.fromColor(i),distanceDisplayCondition:kn.fromDistanceDisplayCondition(o),offset:void 0};return u(this._options.offsetAttribute)&&(r.offset=to.fromCartesian3(Y.getValueOrDefault(this._terrainOffsetProperty,e,Yne,Xne))),new vt({id:t,geometry:Ih.fromDimensions(this._options),modelMatrix:t.computeModelMatrixForHeightReference(e,t.box.heightReference,this._options.dimensions.z*.5,this._scene.ellipsoid),attributes:r})};Jl.prototype._computeCenter=function(e,t){return Y.getValueOrUndefined(this._entity.position,e,t)};Jl.prototype._isHidden=function(e,t){return!u(t.dimensions)||!u(e.position)||ri.prototype._isHidden.call(this,e,t)};Jl.prototype._isDynamic=function(e,t){return!e.position.isConstant||!Y.isConstant(e.orientation)||!t.dimensions.isConstant||!Y.isConstant(t.outlineWidth)};Jl.prototype._setStaticOptions=function(e,t){let n=Y.getValueOrDefault(t.heightReference,He.MINIMUM_VALUE,Xe.NONE),i=this._options;i.vertexFormat=this._materialProperty instanceof Ht?ln.VERTEX_FORMAT:ho.MaterialSupport.TEXTURED.vertexFormat,i.dimensions=t.dimensions.getValue(He.MINIMUM_VALUE,i.dimensions),i.offsetAttribute=n!==Xe.NONE?an.ALL:void 0};Jl.prototype._onEntityPropertyChanged=J_;Jl.DynamicGeometryUpdater=tA;function tA(e,t,n){oi.call(this,e,t,n)}u(Object.create)&&(tA.prototype=Object.create(oi.prototype),tA.prototype.constructor=tA);tA.prototype._isHidden=function(e,t,n){let i=Y.getValueOrUndefined(e.position,n,q2e),o=this._options.dimensions;return!u(i)||!u(o)||oi.prototype._isHidden.call(this,e,t,n)};tA.prototype._setOptions=function(e,t,n){let i=Y.getValueOrDefault(t.heightReference,n,Xe.NONE),o=this._options;o.dimensions=Y.getValueOrUndefined(t.dimensions,n,o.dimensions),o.offsetAttribute=i!==Xe.NONE?an.ALL:void 0};var zL=Jl;function Xy(e,t,n){this._callback=void 0,this._isConstant=void 0,this._referenceFrame=x(n,Gi.FIXED),this._definitionChanged=new me,this.setCallback(e,t)}Object.defineProperties(Xy.prototype,{isConstant:{get:function(){return this._isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}});var X2e=new $;Xy.prototype.getValue=function(e,t){return u(e)||(e=$.now(X2e)),this.getValueInReferenceFrame(e,Gi.FIXED,t)};Xy.prototype.setCallback=function(e,t){let n=this._callback!==e||this._isConstant!==t;this._callback=e,this._isConstant=t,n&&this._definitionChanged.raiseEvent(this)};Xy.prototype.getValueInReferenceFrame=function(e,t,n){let i=this._callback(e,n);return Oh.convertToReferenceFrame(e,i,this._referenceFrame,t,n)};Xy.prototype.equals=function(e){return this===e||e instanceof Xy&&this._callback===e._callback&&this._isConstant===e._isConstant&&this._referenceFrame===e._referenceFrame};var HL=Xy;/*! @license DOMPurify 3.2.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.0/LICENSE */var{entries:oie,setPrototypeOf:Zne,isFrozen:K2e,getPrototypeOf:Z2e,getOwnPropertyDescriptor:$2e}=Object,{freeze:Mc,seal:af,create:rie}=Object,{apply:U9,construct:z9}=typeof Reflect<"u"&&Reflect;Mc||(Mc=function(t){return t});af||(af=function(t){return t});U9||(U9=function(t,n,i){return t.apply(n,i)});z9||(z9=function(t,n){return new t(...n)});var GL=eu(Array.prototype.forEach),$ne=eu(Array.prototype.pop),Pv=eu(Array.prototype.push),jL=eu(String.prototype.toLowerCase),N9=eu(String.prototype.toString),Qne=eu(String.prototype.match),Rv=eu(String.prototype.replace),Q2e=eu(String.prototype.indexOf),J2e=eu(String.prototype.trim),md=eu(Object.prototype.hasOwnProperty),Oc=eu(RegExp.prototype.test),Ov=eFe(TypeError);function eu(e){return function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return U9(e,t,i)}}function eFe(e){return function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return z9(e,n)}}function vi(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:jL;Zne&&Zne(e,null);let i=t.length;for(;i--;){let o=t[i];if(typeof o=="string"){let r=n(o);r!==o&&(K2e(t)||(t[i]=r),o=r)}e[o]=!0}return e}function tFe(e){for(let t=0;t<e.length;t++)md(e,t)||(e[t]=null);return e}function Ky(e){let t=rie(null);for(let[n,i]of oie(e))md(e,n)&&(Array.isArray(i)?t[n]=tFe(i):i&&typeof i=="object"&&i.constructor===Object?t[n]=Ky(i):t[n]=i);return t}function Mv(e,t){for(;e!==null;){let i=$2e(e,t);if(i){if(i.get)return eu(i.get);if(typeof i.value=="function")return eu(i.value)}e=Z2e(e)}function n(){return null}return n}var Jne=Mc(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),F9=Mc(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),B9=Mc(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),nFe=Mc(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),k9=Mc(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),iFe=Mc(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),eie=Mc(["#text"]),tie=Mc(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),V9=Mc(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),nie=Mc(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),WL=Mc(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),oFe=af(/\{\{[\w\W]*|[\w\W]*\}\}/gm),rFe=af(/<%[\w\W]*|[\w\W]*%>/gm),sFe=af(/\${[\w\W]*}/gm),aFe=af(/^data-[\-\w.\u00B7-\uFFFF]/),cFe=af(/^aria-[\-\w]+$/),sie=af(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),lFe=af(/^(?:\w+script|data):/i),uFe=af(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),aie=af(/^html$/i),fFe=af(/^[a-z][.\w]*(-[.\w]+)+$/i),iie=Object.freeze({__proto__:null,ARIA_ATTR:cFe,ATTR_WHITESPACE:uFe,CUSTOM_ELEMENT:fFe,DATA_ATTR:aFe,DOCTYPE_NAME:aie,ERB_EXPR:rFe,IS_ALLOWED_URI:sie,IS_SCRIPT_OR_DATA:lFe,MUSTACHE_EXPR:oFe,TMPLIT_EXPR:sFe}),Lv={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},dFe=function(){return typeof window>"u"?null:window},hFe=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let i=null,o="data-tt-policy-suffix";n&&n.hasAttribute(o)&&(i=n.getAttribute(o));let r="dompurify"+(i?"#"+i:"");try{return t.createPolicy(r,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function cie(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:dFe(),t=en=>cie(en);if(t.version="3.2.0",t.removed=[],!e||!e.document||e.document.nodeType!==Lv.document)return t.isSupported=!1,t;let{document:n}=e,i=n,o=i.currentScript,{DocumentFragment:r,HTMLTemplateElement:s,Node:a,Element:c,NodeFilter:l,NamedNodeMap:f=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:d,DOMParser:p,trustedTypes:g}=e,m=c.prototype,y=Mv(m,"cloneNode"),b=Mv(m,"remove"),C=Mv(m,"nextSibling"),A=Mv(m,"childNodes"),T=Mv(m,"parentNode");if(typeof s=="function"){let en=n.createElement("template");en.content&&en.content.ownerDocument&&(n=en.content.ownerDocument)}let E,v="",{implementation:D,createNodeIterator:O,createDocumentFragment:P,getElementsByTagName:M}=n,{importNode:L}=i,_={};t.isSupported=typeof oie=="function"&&typeof T=="function"&&D&&D.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:S,ERB_EXPR:w,TMPLIT_EXPR:I,DATA_ATTR:N,ARIA_ATTR:k,IS_SCRIPT_OR_DATA:z,ATTR_WHITESPACE:V,CUSTOM_ELEMENT:U}=iie,{IS_ALLOWED_URI:B}=iie,W=null,j=vi({},[...Jne,...F9,...B9,...k9,...eie]),Q=null,q=vi({},[...tie,...V9,...nie,...WL]),X=Object.seal(rie(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Z=null,fe=null,xe=!0,re=!0,pe=!1,ye=!0,Se=!1,Te=!0,Fe=!1,Ve=!1,Ze=!1,gt=!1,lt=!1,Oe=!1,Mt=!0,ut=!1,at="user-content-",Kt=!0,Ce=!1,Ae={},nt=null,yi=vi({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),ct=null,Si=vi({},["audio","video","img","source","image","track"]),oo=null,Zs=vi({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),jo="http://www.w3.org/1998/Math/MathML",wr="http://www.w3.org/2000/svg",Me="http://www.w3.org/1999/xhtml",ot=Me,We=!1,Ye=null,ht=vi({},[jo,wr,Me],N9),zt=vi({},["mi","mo","mn","ms","mtext"]),mn=vi({},["annotation-xml"]),bo=vi({},["title","style","font","a","script"]),fo=null,$s=["application/xhtml+xml","text/html"],Rs="text/html",li=null,ti=null,ts=n.createElement("form"),dr=function(Ee){return Ee instanceof RegExp||Ee instanceof Function},ba=function(){let Ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(ti&&ti===Ee)){if((!Ee||typeof Ee!="object")&&(Ee={}),Ee=Ky(Ee),fo=$s.indexOf(Ee.PARSER_MEDIA_TYPE)===-1?Rs:Ee.PARSER_MEDIA_TYPE,li=fo==="application/xhtml+xml"?N9:jL,W=md(Ee,"ALLOWED_TAGS")?vi({},Ee.ALLOWED_TAGS,li):j,Q=md(Ee,"ALLOWED_ATTR")?vi({},Ee.ALLOWED_ATTR,li):q,Ye=md(Ee,"ALLOWED_NAMESPACES")?vi({},Ee.ALLOWED_NAMESPACES,N9):ht,oo=md(Ee,"ADD_URI_SAFE_ATTR")?vi(Ky(Zs),Ee.ADD_URI_SAFE_ATTR,li):Zs,ct=md(Ee,"ADD_DATA_URI_TAGS")?vi(Ky(Si),Ee.ADD_DATA_URI_TAGS,li):Si,nt=md(Ee,"FORBID_CONTENTS")?vi({},Ee.FORBID_CONTENTS,li):yi,Z=md(Ee,"FORBID_TAGS")?vi({},Ee.FORBID_TAGS,li):{},fe=md(Ee,"FORBID_ATTR")?vi({},Ee.FORBID_ATTR,li):{},Ae=md(Ee,"USE_PROFILES")?Ee.USE_PROFILES:!1,xe=Ee.ALLOW_ARIA_ATTR!==!1,re=Ee.ALLOW_DATA_ATTR!==!1,pe=Ee.ALLOW_UNKNOWN_PROTOCOLS||!1,ye=Ee.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Se=Ee.SAFE_FOR_TEMPLATES||!1,Te=Ee.SAFE_FOR_XML!==!1,Fe=Ee.WHOLE_DOCUMENT||!1,gt=Ee.RETURN_DOM||!1,lt=Ee.RETURN_DOM_FRAGMENT||!1,Oe=Ee.RETURN_TRUSTED_TYPE||!1,Ze=Ee.FORCE_BODY||!1,Mt=Ee.SANITIZE_DOM!==!1,ut=Ee.SANITIZE_NAMED_PROPS||!1,Kt=Ee.KEEP_CONTENT!==!1,Ce=Ee.IN_PLACE||!1,B=Ee.ALLOWED_URI_REGEXP||sie,ot=Ee.NAMESPACE||Me,zt=Ee.MATHML_TEXT_INTEGRATION_POINTS||zt,mn=Ee.HTML_INTEGRATION_POINTS||mn,X=Ee.CUSTOM_ELEMENT_HANDLING||{},Ee.CUSTOM_ELEMENT_HANDLING&&dr(Ee.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(X.tagNameCheck=Ee.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Ee.CUSTOM_ELEMENT_HANDLING&&dr(Ee.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(X.attributeNameCheck=Ee.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Ee.CUSTOM_ELEMENT_HANDLING&&typeof Ee.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(X.allowCustomizedBuiltInElements=Ee.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Se&&(re=!1),lt&&(gt=!0),Ae&&(W=vi({},eie),Q=[],Ae.html===!0&&(vi(W,Jne),vi(Q,tie)),Ae.svg===!0&&(vi(W,F9),vi(Q,V9),vi(Q,WL)),Ae.svgFilters===!0&&(vi(W,B9),vi(Q,V9),vi(Q,WL)),Ae.mathMl===!0&&(vi(W,k9),vi(Q,nie),vi(Q,WL))),Ee.ADD_TAGS&&(W===j&&(W=Ky(W)),vi(W,Ee.ADD_TAGS,li)),Ee.ADD_ATTR&&(Q===q&&(Q=Ky(Q)),vi(Q,Ee.ADD_ATTR,li)),Ee.ADD_URI_SAFE_ATTR&&vi(oo,Ee.ADD_URI_SAFE_ATTR,li),Ee.FORBID_CONTENTS&&(nt===yi&&(nt=Ky(nt)),vi(nt,Ee.FORBID_CONTENTS,li)),Kt&&(W["#text"]=!0),Fe&&vi(W,["html","head","body"]),W.table&&(vi(W,["tbody"]),delete Z.tbody),Ee.TRUSTED_TYPES_POLICY){if(typeof Ee.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ov('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof Ee.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ov('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');E=Ee.TRUSTED_TYPES_POLICY,v=E.createHTML("")}else E===void 0&&(E=hFe(g,o)),E!==null&&typeof v=="string"&&(v=E.createHTML(""));Mc&&Mc(Ee),ti=Ee}},qn=vi({},[...F9,...B9,...nFe]),ro=vi({},[...k9,...iFe]),Uu=function(Ee){let Pt=T(Ee);(!Pt||!Pt.tagName)&&(Pt={namespaceURI:ot,tagName:"template"});let pn=jL(Ee.tagName),mr=jL(Pt.tagName);return Ye[Ee.namespaceURI]?Ee.namespaceURI===wr?Pt.namespaceURI===Me?pn==="svg":Pt.namespaceURI===jo?pn==="svg"&&(mr==="annotation-xml"||zt[mr]):!!qn[pn]:Ee.namespaceURI===jo?Pt.namespaceURI===Me?pn==="math":Pt.namespaceURI===wr?pn==="math"&&mn[mr]:!!ro[pn]:Ee.namespaceURI===Me?Pt.namespaceURI===wr&&!mn[mr]||Pt.namespaceURI===jo&&!zt[mr]?!1:!ro[pn]&&(bo[pn]||!qn[pn]):!!(fo==="application/xhtml+xml"&&Ye[Ee.namespaceURI]):!1},hr=function(Ee){Pv(t.removed,{element:Ee});try{T(Ee).removeChild(Ee)}catch{b(Ee)}},zu=function(Ee,Pt){try{Pv(t.removed,{attribute:Pt.getAttributeNode(Ee),from:Pt})}catch{Pv(t.removed,{attribute:null,from:Pt})}if(Pt.removeAttribute(Ee),Ee==="is"&&!Q[Ee])if(gt||lt)try{hr(Pt)}catch{}else try{Pt.setAttribute(Ee,"")}catch{}},ka=function(Ee){let Pt=null,pn=null;if(Ze)Ee="<remove></remove>"+Ee;else{let Aa=Qne(Ee,/^[\r\n\t ]+/);pn=Aa&&Aa[0]}fo==="application/xhtml+xml"&&ot===Me&&(Ee='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Ee+"</body></html>");let mr=E?E.createHTML(Ee):Ee;if(ot===Me)try{Pt=new p().parseFromString(mr,fo)}catch{}if(!Pt||!Pt.documentElement){Pt=D.createDocument(ot,"template",null);try{Pt.documentElement.innerHTML=We?v:mr}catch{}}let Va=Pt.body||Pt.documentElement;return Ee&&pn&&Va.insertBefore(n.createTextNode(pn),Va.childNodes[0]||null),ot===Me?M.call(Pt,Fe?"html":"body")[0]:Fe?Pt.documentElement:Va},yy=function(Ee){return O.call(Ee.ownerDocument||Ee,Ee,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT|l.SHOW_PROCESSING_INSTRUCTION|l.SHOW_CDATA_SECTION,null)},Ca=function(Ee){return Ee instanceof d&&(typeof Ee.nodeName!="string"||typeof Ee.textContent!="string"||typeof Ee.removeChild!="function"||!(Ee.attributes instanceof f)||typeof Ee.removeAttribute!="function"||typeof Ee.setAttribute!="function"||typeof Ee.namespaceURI!="string"||typeof Ee.insertBefore!="function"||typeof Ee.hasChildNodes!="function")},rl=function(Ee){return typeof a=="function"&&Ee instanceof a};function yc(en,Ee,Pt){_[en]&&GL(_[en],pn=>{pn.call(t,Ee,Pt,ti)})}let ns=function(Ee){let Pt=null;if(yc("beforeSanitizeElements",Ee,null),Ca(Ee))return hr(Ee),!0;let pn=li(Ee.nodeName);if(yc("uponSanitizeElement",Ee,{tagName:pn,allowedTags:W}),Ee.hasChildNodes()&&!rl(Ee.firstElementChild)&&Oc(/<[/\w]/g,Ee.innerHTML)&&Oc(/<[/\w]/g,Ee.textContent)||Ee.nodeType===Lv.progressingInstruction||Te&&Ee.nodeType===Lv.comment&&Oc(/<[/\w]/g,Ee.data))return hr(Ee),!0;if(!W[pn]||Z[pn]){if(!Z[pn]&&Gu(pn)&&(X.tagNameCheck instanceof RegExp&&Oc(X.tagNameCheck,pn)||X.tagNameCheck instanceof Function&&X.tagNameCheck(pn)))return!1;if(Kt&&!nt[pn]){let mr=T(Ee)||Ee.parentNode,Va=A(Ee)||Ee.childNodes;if(Va&&mr){let Aa=Va.length;for(let sl=Aa-1;sl>=0;--sl){let _h=y(Va[sl],!0);_h.__removalCount=(Ee.__removalCount||0)+1,mr.insertBefore(_h,C(Ee))}}}return hr(Ee),!0}return Ee instanceof c&&!Uu(Ee)||(pn==="noscript"||pn==="noembed"||pn==="noframes")&&Oc(/<\/no(script|embed|frames)/i,Ee.innerHTML)?(hr(Ee),!0):(Se&&Ee.nodeType===Lv.text&&(Pt=Ee.textContent,GL([S,w,I],mr=>{Pt=Rv(Pt,mr," ")}),Ee.textContent!==Pt&&(Pv(t.removed,{element:Ee.cloneNode()}),Ee.textContent=Pt)),yc("afterSanitizeElements",Ee,null),!1)},Hu=function(Ee,Pt,pn){if(Mt&&(Pt==="id"||Pt==="name")&&(pn in n||pn in ts))return!1;if(!(re&&!fe[Pt]&&Oc(N,Pt))){if(!(xe&&Oc(k,Pt))){if(!Q[Pt]||fe[Pt]){if(!(Gu(Ee)&&(X.tagNameCheck instanceof RegExp&&Oc(X.tagNameCheck,Ee)||X.tagNameCheck instanceof Function&&X.tagNameCheck(Ee))&&(X.attributeNameCheck instanceof RegExp&&Oc(X.attributeNameCheck,Pt)||X.attributeNameCheck instanceof Function&&X.attributeNameCheck(Pt))||Pt==="is"&&X.allowCustomizedBuiltInElements&&(X.tagNameCheck instanceof RegExp&&Oc(X.tagNameCheck,pn)||X.tagNameCheck instanceof Function&&X.tagNameCheck(pn))))return!1}else if(!oo[Pt]){if(!Oc(B,Rv(pn,V,""))){if(!((Pt==="src"||Pt==="xlink:href"||Pt==="href")&&Ee!=="script"&&Q2e(pn,"data:")===0&&ct[Ee])){if(!(pe&&!Oc(z,Rv(pn,V,"")))){if(pn)return!1}}}}}}return!0},Gu=function(Ee){return Ee!=="annotation-xml"&&Qne(Ee,U)},Wu=function(Ee){yc("beforeSanitizeAttributes",Ee,null);let{attributes:Pt}=Ee;if(!Pt)return;let pn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Q,forceKeepAttr:void 0},mr=Pt.length;for(;mr--;){let Va=Pt[mr],{name:Aa,namespaceURI:sl,value:_h}=Va,PS=li(Aa),xc=Aa==="value"?_h:J2e(_h);if(pn.attrName=PS,pn.attrValue=xc,pn.keepAttr=!0,pn.forceKeepAttr=void 0,yc("uponSanitizeAttribute",Ee,pn),xc=pn.attrValue,ut&&(PS==="id"||PS==="name")&&(zu(Aa,Ee),xc=at+xc),Te&&Oc(/((--!?|])>)|<\/(style|title)/i,xc)){zu(Aa,Ee);continue}if(pn.forceKeepAttr||(zu(Aa,Ee),!pn.keepAttr))continue;if(!ye&&Oc(/\/>/i,xc)){zu(Aa,Ee);continue}Se&&GL([S,w,I],C$=>{xc=Rv(xc,C$," ")});let b$=li(Ee.nodeName);if(Hu(b$,PS,xc)){if(E&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!sl)switch(g.getAttributeType(b$,PS)){case"TrustedHTML":{xc=E.createHTML(xc);break}case"TrustedScriptURL":{xc=E.createScriptURL(xc);break}}try{sl?Ee.setAttributeNS(sl,Aa,xc):Ee.setAttribute(Aa,xc),Ca(Ee)?hr(Ee):$ne(t.removed)}catch{}}}yc("afterSanitizeAttributes",Ee,null)},Mo=function en(Ee){let Pt=null,pn=yy(Ee);for(yc("beforeSanitizeShadowDOM",Ee,null);Pt=pn.nextNode();)yc("uponSanitizeShadowNode",Pt,null),!ns(Pt)&&(Pt.content instanceof r&&en(Pt.content),Wu(Pt));yc("afterSanitizeShadowDOM",Ee,null)};return t.sanitize=function(en){let Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Pt=null,pn=null,mr=null,Va=null;if(We=!en,We&&(en="<!-->"),typeof en!="string"&&!rl(en))if(typeof en.toString=="function"){if(en=en.toString(),typeof en!="string")throw Ov("dirty is not a string, aborting")}else throw Ov("toString is not a function");if(!t.isSupported)return en;if(Ve||ba(Ee),t.removed=[],typeof en=="string"&&(Ce=!1),Ce){if(en.nodeName){let _h=li(en.nodeName);if(!W[_h]||Z[_h])throw Ov("root node is forbidden and cannot be sanitized in-place")}}else if(en instanceof a)Pt=ka("<!---->"),pn=Pt.ownerDocument.importNode(en,!0),pn.nodeType===Lv.element&&pn.nodeName==="BODY"||pn.nodeName==="HTML"?Pt=pn:Pt.appendChild(pn);else{if(!gt&&!Se&&!Fe&&en.indexOf("<")===-1)return E&&Oe?E.createHTML(en):en;if(Pt=ka(en),!Pt)return gt?null:Oe?v:""}Pt&&Ze&&hr(Pt.firstChild);let Aa=yy(Ce?en:Pt);for(;mr=Aa.nextNode();)ns(mr)||(mr.content instanceof r&&Mo(mr.content),Wu(mr));if(Ce)return en;if(gt){if(lt)for(Va=P.call(Pt.ownerDocument);Pt.firstChild;)Va.appendChild(Pt.firstChild);else Va=Pt;return(Q.shadowroot||Q.shadowrootmode)&&(Va=L.call(i,Va,!0)),Va}let sl=Fe?Pt.outerHTML:Pt.innerHTML;return Fe&&W["!doctype"]&&Pt.ownerDocument&&Pt.ownerDocument.doctype&&Pt.ownerDocument.doctype.name&&Oc(aie,Pt.ownerDocument.doctype.name)&&(sl="<!DOCTYPE "+Pt.ownerDocument.doctype.name+`>
`+sl),Se&&GL([S,w,I],_h=>{sl=Rv(sl,_h," ")}),E&&Oe?E.createHTML(sl):sl},t.setConfig=function(){let en=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ba(en),Ve=!0},t.clearConfig=function(){ti=null,Ve=!1},t.isValidAttribute=function(en,Ee,Pt){ti||ba({});let pn=li(en),mr=li(Ee);return Hu(pn,mr,Pt)},t.addHook=function(en,Ee){typeof Ee=="function"&&(_[en]=_[en]||[],Pv(_[en],Ee))},t.removeHook=function(en){if(_[en])return $ne(_[en])},t.removeHooks=function(en){_[en]&&(_[en]=[])},t.removeAllHooks=function(){_={}},t}var lie=cie();var mFe=0,H9={};function Bh(e,t){let n,i=e;u(H9[i])?n=H9[i]:(n=mFe++,H9[i]=n),t=x(t,!1),this._id=n,this._html=e,this._showOnScreen=t,this._element=void 0}Object.defineProperties(Bh.prototype,{html:{get:function(){return this._html}},id:{get:function(){return this._id}},showOnScreen:{get:function(){return this._showOnScreen},set:function(e){this._showOnScreen=e}},element:{get:function(){if(!u(this._element)){let e=lie.sanitize(this._html),t=document.createElement("div");t.className="cesium-credit-wrapper",t._creditId=this._id,t.style.display="inline",t.innerHTML=e;let n=t.querySelectorAll("a");for(let i=0;i<n.length;i++)n[i].setAttribute("target","_blank");this._element=t}return this._element}}});Bh.equals=function(e,t){return e===t||u(e)&&u(t)&&e._id===t._id&&e._showOnScreen===t._showOnScreen};Bh.prototype.equals=function(e){return Bh.equals(this,e)};Bh.prototype.isIon=function(){return this.html.indexOf("ion-credit.png")!==-1};Bh.getIonCredit=function(e){let t=u(e.collapsible)&&!e.collapsible;return new Bh(e.html,t)};Bh.clone=function(e){if(u(e))return new Bh(e.html,e.showOnScreen)};var wt=Bh;function Zy(e){this._url=e,this._cubeMapBuffers=void 0,this._texture=void 0,this._maximumMipmapLevel=void 0,this._loading=!1,this._ready=!1,this._errorEvent=new me}Object.defineProperties(Zy.prototype,{url:{get:function(){return this._url}},errorEvent:{get:function(){return this._errorEvent}},texture:{get:function(){return this._texture}},maximumMipmapLevel:{get:function(){return this._maximumMipmapLevel}},ready:{get:function(){return this._ready}}});Zy.isSupported=function(e){return(e.colorBufferHalfFloat&&e.halfFloatingPointTexture||e.floatingPointTexture&&e.colorBufferFloat)&&e.supportsTextureLod};function G9(e){e._cubeMapBuffers=void 0}Zy.prototype.update=function(e){let{context:t}=e;if(!Zy.isSupported(t))return;if(u(this._texture)){G9(this);return}if(!u(this._texture)&&!this._loading){let f=t.textureCache.getTexture(this._url);u(f)&&(G9(this),this._texture=f,this._maximumMipmapLevel=this._texture.maximumMipmapLevel,this._ready=!0)}let n=this._cubeMapBuffers;if(!u(n)&&!this._loading){let f=this;jl(this._url).then(function(d){f._cubeMapBuffers=d,f._loading=!1}).catch(function(d){f.isDestroyed()||f._errorEvent.raiseEvent(d)}),this._loading=!0}if(!u(this._cubeMapBuffers))return;let{pixelDatatype:i}=n[0].positiveX;u(i)||(i=t.halfFloatingPointTexture?Ke.HALF_FLOAT:Ke.FLOAT);let o=tt.RGBA,r=n.length;this._maximumMipmapLevel=r-1;let s=n[0].positiveX.width,a=Math.log2(s)+1;if(r!==a){let f={};Object.values(Or.FaceName).forEach(d=>{f[d]=void 0});for(let d=r;d<a;d++)n.push(f)}let c=new Qt({minificationFilter:$t.LINEAR_MIPMAP_LINEAR}),l=new Or({context:t,source:n[0],flipY:!1,pixelDatatype:i,pixelFormat:o,sampler:c});l.loadMipmaps(n.slice(1)),this._texture=l,this._texture.maximumMipmapLevel=this._maximumMipmapLevel,t.textureCache.addTexture(this._url,this._texture),this._ready=!0};Zy.prototype.isDestroyed=function(){return!1};Zy.prototype.destroy=function(){return G9(this),this._texture=this._texture&&this._texture.destroy(),ue(this)};var kh=Zy;function Nv(e){e=x(e,x.EMPTY_OBJECT);let t=u(e.imageBasedLightingFactor)?H.clone(e.imageBasedLightingFactor):new H(1,1);this._imageBasedLightingFactor=t;let n=e.sphericalHarmonicCoefficients;this._sphericalHarmonicCoefficients=n,this._specularEnvironmentMaps=e.specularEnvironmentMaps,this._specularEnvironmentCubeMap=void 0,this._specularEnvironmentCubeMapDirty=!0,this._specularEnvironmentMapLoaded=!1,this._previousSpecularEnvironmentMapLoaded=!1,this._useDefaultSpecularMaps=!1,this._useDefaultSphericalHarmonics=!1,this._shouldRegenerateShaders=!1,this._previousFrameNumber=void 0,this._previousImageBasedLightingFactor=H.clone(t),this._previousSphericalHarmonicCoefficients=n,this._removeErrorListener=void 0}Object.defineProperties(Nv.prototype,{imageBasedLightingFactor:{get:function(){return this._imageBasedLightingFactor},set:function(e){this._previousImageBasedLightingFactor=H.clone(this._imageBasedLightingFactor,this._previousImageBasedLightingFactor),this._imageBasedLightingFactor=H.clone(e,this._imageBasedLightingFactor)}},sphericalHarmonicCoefficients:{get:function(){return this._sphericalHarmonicCoefficients},set:function(e){this._previousSphericalHarmonicCoefficients=this._sphericalHarmonicCoefficients,this._sphericalHarmonicCoefficients=e}},specularEnvironmentMaps:{get:function(){return this._specularEnvironmentMaps},set:function(e){e!==this._specularEnvironmentMaps&&(this._specularEnvironmentCubeMapDirty=this._specularEnvironmentCubeMapDirty||e!==this._specularEnvironmentMaps,this._specularEnvironmentMapLoaded=!1),this._specularEnvironmentMaps=e}},enabled:{get:function(){return this._imageBasedLightingFactor.x>0||this._imageBasedLightingFactor.y>0}},shouldRegenerateShaders:{get:function(){return this._shouldRegenerateShaders}},specularEnvironmentCubeMap:{get:function(){return this._specularEnvironmentCubeMap}},useDefaultSphericalHarmonics:{get:function(){return this._useDefaultSphericalHarmonics}},useDefaultSpecularMaps:{get:function(){return this._useDefaultSpecularMaps}},useSpecularEnvironmentMaps:{get:function(){return u(this._specularEnvironmentCubeMap)&&this._specularEnvironmentCubeMap.ready||this._useDefaultSpecularMaps}}});function pFe(e,t){if(kh.isSupported(t)){if(e._specularEnvironmentCubeMap=e._specularEnvironmentCubeMap&&e._specularEnvironmentCubeMap.destroy(),u(e._specularEnvironmentMaps)){let n=new kh(e._specularEnvironmentMaps);e._specularEnvironmentCubeMap=n,e._removeErrorListener=n.errorEvent.addEventListener(i=>{console.error(`Error loading specularEnvironmentMaps: ${i}`)})}e._shouldRegenerateShaders=!0}}Nv.prototype.update=function(e){if(e.frameNumber===this._previousFrameNumber)return;this._previousFrameNumber=e.frameNumber;let t=e.context;e.brdfLutGenerator.update(e),this._shouldRegenerateShaders=!1;let n=this._imageBasedLightingFactor,i=this._previousImageBasedLightingFactor;H.equals(n,i)||(this._shouldRegenerateShaders=n.x>0&&i.x===0||n.x===0&&i.x>0,this._shouldRegenerateShaders=this._shouldRegenerateShaders||n.y>0&&i.y===0||n.y===0&&i.y>0,this._previousImageBasedLightingFactor=H.clone(this._imageBasedLightingFactor,this._previousImageBasedLightingFactor)),this._previousSphericalHarmonicCoefficients!==this._sphericalHarmonicCoefficients&&(this._shouldRegenerateShaders=this._shouldRegenerateShaders||u(this._previousSphericalHarmonicCoefficients)!==u(this._sphericalHarmonicCoefficients),this._previousSphericalHarmonicCoefficients=this._sphericalHarmonicCoefficients),this._shouldRegenerateShaders=this._shouldRegenerateShaders||this._previousSpecularEnvironmentMapLoaded!==this._specularEnvironmentMapLoaded,this._previousSpecularEnvironmentMapLoaded=this._specularEnvironmentMapLoaded,this._specularEnvironmentCubeMapDirty&&(pFe(this,t),this._specularEnvironmentCubeMapDirty=!1),u(this._specularEnvironmentCubeMap)&&(this._specularEnvironmentCubeMap.update(e),this._specularEnvironmentCubeMap.ready&&(this._specularEnvironmentMapLoaded=!0));let o=!u(this._specularEnvironmentCubeMap)&&u(e.specularEnvironmentMaps)&&!this._useDefaultSpecularMaps,r=!u(e.specularEnvironmentMaps)&&this._useDefaultSpecularMaps,s=!u(this._sphericalHarmonicCoefficients)&&u(e.sphericalHarmonicCoefficients)&&!this._useDefaultSphericalHarmonics,a=!u(e.sphericalHarmonicCoefficients)&&this._useDefaultSphericalHarmonics;this._shouldRegenerateShaders=this._shouldRegenerateShaders||o||r||s||a,this._useDefaultSpecularMaps=!u(this._specularEnvironmentCubeMap)&&u(e.specularEnvironmentMaps),this._useDefaultSphericalHarmonics=!u(this._sphericalHarmonicCoefficients)&&u(e.sphericalHarmonicCoefficients)};Nv.prototype.isDestroyed=function(){return!1};Nv.prototype.destroy=function(){return this._specularEnvironmentCubeMap=this._specularEnvironmentCubeMap&&this._specularEnvironmentCubeMap.destroy(),this._removeErrorListener=this._removeErrorListener&&this._removeErrorListener(),ue(this)};var nA=Nv;var j9=Dr(Gl(),1);var W9,uie="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJiZjBmMDE4Ny05M2JlLTRlMzgtYjIxYi05YmJjM2QwMzJkYWMiLCJpZCI6MjU5LCJpYXQiOjE3MzA0NjY3MDl9.t-7gCGPUe-oGCyCoeXPtYmlMVdgqUQD9mn-Da23yUoI",qL={};qL.defaultAccessToken=uie;qL.defaultServer=new De({url:"https://api.cesium.com/"});qL.getDefaultTokenCredit=function(e){if(e===uie){if(!u(W9)){let t=`<b>             This application is using Cesium's default ion access token. Please assign <i>Cesium.Ion.defaultAccessToken</i>             with an access token from your ion account before making any Cesium API calls.             You can sign up for a free ion account at <a href="https://cesium.com">https://cesium.com</a>.</b>`;W9=new wt(t,!0)}return W9}};var Vh=qL;function Lc(e,t){let n,i=e.externalType,o=u(i);if(!o)n={url:e.url,retryAttempts:1,retryCallback:_Fe};else if(i==="3DTILES"||i==="STK_TERRAIN_SERVER")n={url:e.options.url};else throw new ce("Ion.createResource does not support external imagery assets; use IonImageryProvider instead.");De.call(this,n),this._ionEndpoint=e,this._ionEndpointDomain=o?void 0:new j9.default(e.url).authority(),this._ionEndpointResource=t,this._ionRoot=void 0,this._pendingPromise=void 0,this._credits=void 0,this._isExternal=o}u(Object.create)&&(Lc.prototype=Object.create(De.prototype),Lc.prototype.constructor=Lc);Lc.fromAssetId=function(e,t){let n=Lc._createEndpointResource(e,t);return n.fetchJson().then(function(i){return new Lc(i,n)})};Object.defineProperties(Lc.prototype,{credits:{get:function(){return u(this._ionRoot)?this._ionRoot.credits:u(this._credits)?this._credits:(this._credits=Lc.getCreditsFromEndpoint(this._ionEndpoint,this._ionEndpointResource),this._credits)}}});Lc.getCreditsFromEndpoint=function(e,t){let n=e.attributions.map(wt.getIonCredit),i=Vh.getDefaultTokenCredit(t.queryParameters.access_token);return u(i)&&n.push(wt.clone(i)),n};Lc.prototype.clone=function(e){let t=x(this._ionRoot,this);return u(e)||(e=new Lc(t._ionEndpoint,t._ionEndpointResource)),e=De.prototype.clone.call(this,e),e._ionRoot=t,e._isExternal=this._isExternal,e};Lc.prototype.fetchImage=function(e){if(!this._isExternal){let t=e;e={preferBlob:!0},u(t)&&(e.flipY=t.flipY,e.preferImageBitmap=t.preferImageBitmap)}return De.prototype.fetchImage.call(this,e)};Lc.prototype._makeRequest=function(e){return this._isExternal||new j9.default(this.url).authority()!==this._ionEndpointDomain?De.prototype._makeRequest.call(this,e):(u(e.headers)||(e.headers={}),e.headers.Authorization=`Bearer ${this._ionEndpoint.accessToken}`,e.headers["X-Cesium-Client"]="CesiumJS",typeof CESIUM_VERSION<"u"&&(e.headers["X-Cesium-Client-Version"]=CESIUM_VERSION),De.prototype._makeRequest.call(this,e))};Lc._createEndpointResource=function(e,t){t=x(t,x.EMPTY_OBJECT);let n=x(t.server,Vh.defaultServer),i=x(t.accessToken,Vh.defaultAccessToken);n=De.createIfNeeded(n);let o={url:`v1/assets/${e}/endpoint`};return u(i)&&(o.queryParameters={access_token:i}),n.getDerivedResource(o)};function _Fe(e,t){let n=x(e._ionRoot,e),i=n._ionEndpointResource,o=typeof Image<"u";return!u(t)||t.statusCode!==401&&!(o&&t.target instanceof Image)?Promise.resolve(!1):(u(n._pendingPromise)||(n._pendingPromise=i.fetchJson().then(function(r){return n._ionEndpoint=r,r}).finally(function(r){return n._pendingPromise=void 0,r})),n._pendingPromise.then(function(r){return e._ionEndpoint=r,!0}))}var cf=Lc;function Uh(e){e=x(e,0),this._array=new Array(e),this._length=e}Object.defineProperties(Uh.prototype,{length:{get:function(){return this._length},set:function(e){let t=this._array,n=this._length;if(e<n)for(let i=e;i<n;++i)t[i]=void 0;else e>t.length&&(t.length=e);this._length=e}},values:{get:function(){return this._array}}});Uh.prototype.get=function(e){return this._array[e]};Uh.prototype.set=function(e,t){e>=this._length&&(this.length=e+1),this._array[e]=t};Uh.prototype.peek=function(){return this._array[this._length-1]};Uh.prototype.push=function(e){let t=this.length++;this._array[t]=e};Uh.prototype.pop=function(){if(this._length===0)return;let e=this._array[this._length-1];return--this.length,e};Uh.prototype.reserve=function(e){e>this._array.length&&(this._array.length=e)};Uh.prototype.resize=function(e){this.length=e};Uh.prototype.trim=function(e){e=x(e,this._length),this._array.length=e};var yl=Uh;var dp={X:0,Y:1,Z:2};dp.Y_UP_TO_Z_UP=F.fromRotationTranslation(J.fromArray([1,0,0,0,0,1,0,-1,0]));dp.Z_UP_TO_Y_UP=F.fromRotationTranslation(J.fromArray([1,0,0,0,0,-1,0,1,0]));dp.X_UP_TO_Z_UP=F.fromRotationTranslation(J.fromArray([0,0,1,0,1,0,-1,0,0]));dp.Z_UP_TO_X_UP=F.fromRotationTranslation(J.fromArray([0,0,-1,0,1,0,1,0,0]));dp.X_UP_TO_Y_UP=F.fromRotationTranslation(J.fromArray([0,1,0,-1,0,0,0,0,1]));dp.Y_UP_TO_X_UP=F.fromRotationTranslation(J.fromArray([0,-1,0,1,0,0,0,0,1]));dp.fromName=function(e){return dp[e]};var Vo=Object.freeze(dp);function fie(e){e=x(e,x.EMPTY_OBJECT),this._metadata=e.metadata}Object.defineProperties(fie.prototype,{metadata:{get:function(){return this._metadata}}});var iA=fie;function eg(e,t,n){return t=x(t,0),n=x(n,e.byteLength-t),e=e.subarray(t,t+n),eg.decode(e)}eg.decodeWithTextDecoder=function(e){return new TextDecoder("utf-8").decode(e)};eg.decodeWithFromCharCode=function(e){let t="",n=gFe(e),i=n.length;for(let o=0;o<i;++o){let r=n[o];r<=65535?t+=String.fromCharCode(r):(r-=65536,t+=String.fromCharCode((r>>10)+55296,(r&1023)+56320))}return t};function Fv(e,t,n){return t<=e&&e<=n}function gFe(e){let t=0,n=0,i=0,o=128,r=191,s=[],a=e.length;for(let c=0;c<a;++c){let l=e[c];if(i===0){if(Fv(l,0,127)){s.push(l);continue}if(Fv(l,194,223)){i=1,t=l&31;continue}if(Fv(l,224,239)){l===224&&(o=160),l===237&&(r=159),i=2,t=l&15;continue}if(Fv(l,240,244)){l===240&&(o=144),l===244&&(r=143),i=3,t=l&7;continue}throw new ce("String decoding failed.")}if(!Fv(l,o,r)){t=i=n=0,o=128,r=191,--c;continue}o=128,r=191,t=t<<6|l&63,++n,n===i&&(s.push(t),t=i=n=0)}return s}typeof TextDecoder<"u"?eg.decode=eg.decodeWithTextDecoder:eg.decode=eg.decodeWithFromCharCode;var tu=eg;function yFe(e,t){return t=x(t,0),tu(e,t,Math.min(4,e.length))}var zh=yFe;function lf(e,t,n,i){this._tileset=e,this._tile=t,this._resource=n,u(i)||(i=[]),this._contents=i,this._metadata=void 0,this._group=void 0,this._ready=!1}Object.defineProperties(lf.prototype,{featurePropertiesDirty:{get:function(){let e=this._contents,t=e.length;for(let n=0;n<t;++n)if(e[n].featurePropertiesDirty)return!0;return!1},set:function(e){let t=this._contents,n=t.length;for(let i=0;i<n;++i)t[i].featurePropertiesDirty=e}},featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){return this._contents}},ready:{get:function(){return this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e;let t=this._contents,n=t.length;for(let i=0;i<n;++i)t[i].metadata=e}},batchTable:{get:function(){}},group:{get:function(){return this._group},set:function(e){this._group=e;let t=this._contents,n=t.length;for(let i=0;i<n;++i)t[i].group=e}}});var Bv=Uint32Array.BYTES_PER_ELEMENT;lf.fromTileType=async function(e,t,n,i,o,r){o=x(o,0);let s=new Uint8Array(i),a=new DataView(i);o+=Bv;let c=a.getUint32(o,!0);if(c!==1)throw new ce(`Only Composite Tile version 1 is supported. Version ${c} is not.`);o+=Bv,o+=Bv;let l=a.getUint32(o,!0);o+=Bv;let f=n.queryParameters.compositeIndex;u(f)?f=`${f}_`:f="";let d=[];d.length=l;for(let m=0;m<l;++m){let y=zh(s,o),b=a.getUint32(o+Bv*2,!0),C=r[y],A=`${f}${m}`,T=n.getDerivedResource({queryParameters:{compositeIndex:A}});if(u(C))d[m]=Promise.resolve(C(e,t,T,i,o));else throw new ce(`Unknown tile content type, ${y}, inside Composite tile`);o+=b}let p=await Promise.all(d);return new lf(e,t,n,p)};lf.prototype.hasProperty=function(e,t){return!1};lf.prototype.getFeature=function(e){};lf.prototype.applyDebugSettings=function(e,t){let n=this._contents,i=n.length;for(let o=0;o<i;++o)n[o].applyDebugSettings(e,t)};lf.prototype.applyStyle=function(e){let t=this._contents,n=t.length;for(let i=0;i<n;++i)t[i].applyStyle(e)};lf.prototype.update=function(e,t){let n=this._contents,i=n.length,o=!0;for(let r=0;r<i;++r)n[r].update(e,t),o=o&&n[r].ready;!this._ready&&o&&(this._ready=!0)};lf.prototype.pick=function(e,t,n){if(!this._ready)return;let i,o=Number.POSITIVE_INFINITY,r=this._contents,s=r.length;for(let a=0;a<s;++a){let c=r[a].pick(e,t,n);if(!u(c))continue;let l=h.distance(e.origin,c);l<o&&(i=c,o=l)}if(u(i))return n};lf.prototype.isDestroyed=function(){return!1};lf.prototype.destroy=function(){let e=this._contents,t=e.length;for(let n=0;n<t;++n)e[n].destroy();return ue(this)};var YL=lf;function xFe(e,t,n){return JSON.parse(tu(e,t,n))}var Uo=xFe;function $a(e){this._id=Hn();let t=e.featuresLength;this._showAlphaProperties=void 0,this._batchValues=void 0,this._batchValuesDirty=!1,this._batchTexture=void 0,this._defaultTexture=void 0,this._pickTexture=void 0,this._pickIds=[];let n,i;if(t>0){let o=Math.min(t,Vt.maximumTextureSize),r=Math.ceil(t/Vt.maximumTextureSize),s=1/o,a=s*.5,c=1/r,l=c*.5;n=new H(o,r),i=new oe(s,a,c,l)}this._translucentFeaturesLength=0,this._featuresLength=t,this._textureDimensions=n,this._textureStep=i,this._owner=e.owner,this._statistics=e.statistics,this._colorChangedCallback=e.colorChangedCallback}Object.defineProperties($a.prototype,{translucentFeaturesLength:{get:function(){return this._translucentFeaturesLength}},byteLength:{get:function(){let e=0;return u(this._pickTexture)&&(e+=this._pickTexture.sizeInBytes),u(this._batchTexture)&&(e+=this._batchTexture.sizeInBytes),e}},textureDimensions:{get:function(){return this._textureDimensions}},textureStep:{get:function(){return this._textureStep}},batchTexture:{get:function(){return this._batchTexture}},defaultTexture:{get:function(){return this._defaultTexture}},pickTexture:{get:function(){return this._pickTexture}}});$a.DEFAULT_COLOR_VALUE=G.WHITE;$a.DEFAULT_SHOW_VALUE=!0;function die(e){let t=e._textureDimensions;return t.x*t.y*4}function hie(e){if(!u(e._batchValues)){let t=die(e),n=new Uint8Array(t).fill(255);e._batchValues=n}return e._batchValues}function mie(e){if(!u(e._showAlphaProperties)){let t=2*e._featuresLength,n=new Uint8Array(t).fill(255);e._showAlphaProperties=n}return e._showAlphaProperties}$a.prototype.setShow=function(e,t){if(t&&!u(this._showAlphaProperties))return;let n=mie(this),i=e*2,o=t?255:0;if(n[i]!==o){n[i]=o;let r=hie(this),s=e*4+3;r[s]=t?n[i+1]:0,this._batchValuesDirty=!0}};$a.prototype.setAllShow=function(e){let t=this._featuresLength;for(let n=0;n<t;++n)this.setShow(n,e)};$a.prototype.getShow=function(e){if(!u(this._showAlphaProperties))return!0;let t=e*2;return this._showAlphaProperties[t]===255};var bFe=new Array(4);$a.prototype.setColor=function(e,t){if(G.equals(t,$a.DEFAULT_COLOR_VALUE)&&!u(this._batchValues))return;let n=t.toBytes(bFe),i=n[3],o=hie(this),r=e*4,s=mie(this),a=e*2;if(o[r]!==n[0]||o[r+1]!==n[1]||o[r+2]!==n[2]||s[a+1]!==i){o[r]=n[0],o[r+1]=n[1],o[r+2]=n[2];let c=s[a+1]!==255,l=s[a]!==0;o[r+3]=l?i:0,s[a+1]=i;let f=i!==255;f&&!c?++this._translucentFeaturesLength:!f&&c&&--this._translucentFeaturesLength,this._batchValuesDirty=!0,u(this._colorChangedCallback)&&this._colorChangedCallback(e,t)}};$a.prototype.setAllColor=function(e){let t=this._featuresLength;for(let n=0;n<t;++n)this.setColor(n,e)};$a.prototype.getColor=function(e,t){if(!u(this._batchValues))return G.clone($a.DEFAULT_COLOR_VALUE,t);let n=this._batchValues,i=e*4,o=this._showAlphaProperties,r=e*2;return G.fromBytes(n[i],n[i+1],n[i+2],o[r+1],t)};$a.prototype.getPickColor=function(e){return this._pickIds[e]};function pie(e,t,n){let i=e._textureDimensions;return new Ot({context:t,pixelFormat:tt.RGBA,pixelDatatype:Ke.UNSIGNED_BYTE,source:{width:i.x,height:i.y,arrayBufferView:n},flipY:!1,sampler:Qt.NEAREST})}function CFe(e,t){let n=e._featuresLength;if(!u(e._pickTexture)&&n>0){let i=e._pickIds,o=die(e),r=new Uint8Array(o),s=e._owner,a=e._statistics;for(let c=0;c<n;++c){let l=t.createPickId(s.getFeature(c));i.push(l);let f=l.color,d=c*4;r[d]=G.floatToByte(f.red),r[d+1]=G.floatToByte(f.green),r[d+2]=G.floatToByte(f.blue),r[d+3]=G.floatToByte(f.alpha)}e._pickTexture=pie(e,t,r),u(a)&&(a.batchTableByteLength+=e._pickTexture.sizeInBytes)}}function AFe(e){let t=e._textureDimensions;e._batchTexture.copyFrom({source:{width:t.x,height:t.y,arrayBufferView:e._batchValues}})}$a.prototype.update=function(e,t){let n=t.context;this._defaultTexture=n.defaultTexture;let i=t.passes;(i.pick||i.postProcess)&&CFe(this,n),this._batchValuesDirty&&(this._batchValuesDirty=!1,u(this._batchTexture)||(this._batchTexture=pie(this,n,this._batchValues),u(this._statistics)&&(this._statistics.batchTableByteLength+=this._batchTexture.sizeInBytes)),AFe(this))};$a.prototype.isDestroyed=function(){return!1};$a.prototype.destroy=function(){this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),this._pickTexture=this._pickTexture&&this._pickTexture.destroy();let e=this._pickIds,t=e.length;for(let n=0;n<t;++n)e[n].destroy();return ue(this)};var xl=$a;var TFe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},EFe={SCALAR:void 0,VEC2:H,VEC3:h,VEC4:oe,MAT2:Hi,MAT3:J,MAT4:F};function SFe(e){let t=e.componentType,n;typeof t=="string"?n=K.fromName(t):n=t;let i=TFe[e.type],o=EFe[e.type];return{componentsPerAttribute:i,classType:o,createArrayBufferView:function(r,s,a){return K.createArrayBufferView(n,r,s,i*a)}}}var uf=SFe;function hp(e){this._classes=void 0,this._classIds=void 0,this._classIndexes=void 0,this._parentCounts=void 0,this._parentIndexes=void 0,this._parentIds=void 0,this._byteLength=0,vFe(this,e.extension,e.binaryBody)}Object.defineProperties(hp.prototype,{byteLength:{get:function(){return this._byteLength}}});function vFe(e,t,n){let i,o,r,s=t.instancesLength,a=t.classes,c=t.classIds,l=t.parentCounts,f=t.parentIds,d=s,p=0;u(c.byteOffset)&&(c.componentType=x(c.componentType,K.UNSIGNED_SHORT),c.type=rn.SCALAR,r=uf(c),c=r.createArrayBufferView(n.buffer,n.byteOffset+c.byteOffset,s),p+=c.byteLength);let g;if(u(l)){for(u(l.byteOffset)&&(l.componentType=x(l.componentType,K.UNSIGNED_SHORT),l.type=rn.SCALAR,r=uf(l),l=r.createArrayBufferView(n.buffer,n.byteOffset+l.byteOffset,s),p+=l.byteLength),g=new Uint16Array(s),d=0,i=0;i<s;++i)g[i]=d,d+=l[i];p+=g.byteLength}u(f)&&u(f.byteOffset)&&(f.componentType=x(f.componentType,K.UNSIGNED_SHORT),f.type=rn.SCALAR,r=uf(f),f=r.createArrayBufferView(n.buffer,n.byteOffset+f.byteOffset,d),p+=f.byteLength);let m=a.length;for(i=0;i<m;++i){let C=a[i].length,A=a[i].instances,T=wFe(C,A,n);p+=DFe(T),a[i].instances=bt(T,A)}let y=new Array(m).fill(0),b=new Uint16Array(s);for(i=0;i<s;++i)o=c[i],b[i]=y[o],++y[o];p+=b.byteLength,e._classes=a,e._classIds=c,e._classIndexes=b,e._parentCounts=l,e._parentIndexes=g,e._parentIds=f,e._byteLength=p}function wFe(e,t,n){let i;for(let o in t)if(t.hasOwnProperty(o)){let r=t[o],s=r.byteOffset;if(u(s)){let a=r.componentType,c=r.type;if(!u(a))throw new ce("componentType is required.");if(!u(c))throw new ce("type is required.");if(!u(n))throw new ce(`Property ${o} requires a batch table binary.`);let l=uf(r),f=l.componentsPerAttribute,d=l.classType,p=l.createArrayBufferView(n.buffer,n.byteOffset+s,e);u(i)||(i={}),i[o]={typedArray:p,componentCount:f,type:d}}}return i}function DFe(e){let t=0;for(let n in e)e.hasOwnProperty(n)&&(t+=e[n].typedArray.byteLength);return t}var IFe=[],PFe=[],RFe=0;function OFe(e,t,n){let i=e._classIds,o=e._parentCounts,r=e._parentIds,s=e._parentIndexes,a=i.length,c=IFe;c.length=Math.max(c.length,a);let l=++RFe,f=PFe;for(f.length=0,f.push(t);f.length>0;){if(t=f.pop(),c[t]===l)continue;c[t]=l;let d=n(e,t);if(u(d))return d;let p=o[t],g=s[t];for(let m=0;m<p;++m){let y=r[g+m];y!==t&&f.push(y)}}}function MFe(e,t,n){let i=!0;for(;i;){let o=n(e,t);if(u(o))return o;let r=e._parentIds[t];i=r!==t,t=r}}function kv(e,t,n){let i=e._parentCounts,o=e._parentIds;if(u(o)){if(u(i))return OFe(e,t,n)}else return n(e,t);return MFe(e,t,n)}hp.prototype.hasProperty=function(e,t){let n=kv(this,e,function(i,o){let r=i._classIds[o],s=i._classes[r].instances;if(u(s[t]))return!0});return u(n)};hp.prototype.propertyExists=function(e){let t=this._classes,n=t.length;for(let i=0;i<n;++i){let o=t[i].instances;if(u(o[e]))return!0}return!1};hp.prototype.getPropertyIds=function(e,t){return t=u(t)?t:[],t.length=0,kv(this,e,function(n,i){let o=n._classIds[i],r=n._classes[o].instances;for(let s in r)r.hasOwnProperty(s)&&t.indexOf(s)===-1&&t.push(s)}),t};hp.prototype.getProperty=function(e,t){return kv(this,e,function(n,i){let o=n._classIds[i],r=n._classes[o],s=n._classIndexes[i],a=r.instances[t];if(u(a))return u(a.typedArray)?LFe(a,s):Ge(a[s],!0)})};function LFe(e,t){let n=e.typedArray,i=e.componentCount;return i===1?n[t]:e.type.unpack(n,t*i)}hp.prototype.setProperty=function(e,t,n){let i=kv(this,e,function(o,r){let s=o._classIds[r],a=o._classes[s],c=o._classIndexes[r],l=a.instances[t];if(u(l))return u(l.typedArray)?NFe(l,c,n):l[c]=Ge(n,!0),!0});return u(i)};function NFe(e,t,n){let i=e.typedArray,o=e.componentCount;o===1?i[t]=n:e.type.pack(n,i,t*o)}hp.prototype.isClass=function(e,t){let n=kv(this,e,function(i,o){let r=i._classIds[o];if(i._classes[r].name===t)return!0});return u(n)};hp.prototype.getClassName=function(e){let t=this._classIds[e];return this._classes[t].name};var oA=hp;var FFe={HIGHLIGHT:0,REPLACE:1,MIX:2},nu=Object.freeze(FFe);var q9=xl.DEFAULT_COLOR_VALUE,Y9=xl.DEFAULT_SHOW_VALUE;function mo(e,t,n,i,o){this.featuresLength=t;let r;u(n)&&(r=n.extensions),this._extensions=x(r,{});let s=BFe(n);this._properties=s,this._batchTableHierarchy=kFe(this,n,i);let a=gie(t,s,i);this._binaryPropertiesByteLength=VFe(a),this._batchTableBinaryProperties=a,this._content=e,this._batchTexture=new xl({featuresLength:t,colorChangedCallback:o,owner:e,statistics:e.tileset.statistics})}mo._deprecationWarning=ys;Object.defineProperties(mo.prototype,{batchTableByteLength:{get:function(){let e=this._binaryPropertiesByteLength;return u(this._batchTableHierarchy)&&(e+=this._batchTableHierarchy.byteLength),e+=this._batchTexture.byteLength,e}}});function BFe(e){let t={};if(!u(e))return t;for(let n in e)e.hasOwnProperty(n)&&n!=="HIERARCHY"&&n!=="extensions"&&n!=="extras"&&(t[n]=Ge(e[n],!0));return t}function kFe(e,t,n){if(!u(t))return;let i=e._extensions["3DTILES_batch_table_hierarchy"],o=t.HIERARCHY;if(u(o)&&(mo._deprecationWarning("batchTableHierarchyExtension","The batch table HIERARCHY property has been moved to an extension. Use extensions.3DTILES_batch_table_hierarchy instead."),e._extensions["3DTILES_batch_table_hierarchy"]=o,i=o),!!u(i))return new oA({extension:i,binaryBody:n})}function gie(e,t,n){let i;for(let o in t)if(t.hasOwnProperty(o)){let r=t[o],s=r.byteOffset;if(u(s)){let a=r.componentType,c=r.type;if(!u(a))throw new ce("componentType is required.");if(!u(c))throw new ce("type is required.");if(!u(n))throw new ce(`Property ${o} requires a batch table binary.`);let l=uf(r),f=l.componentsPerAttribute,d=l.classType,p=l.createArrayBufferView(n.buffer,n.byteOffset+s,e);u(i)||(i={}),i[o]={typedArray:p,componentCount:f,type:d}}}return i}function VFe(e){if(!u(e))return 0;let t=0;for(let n in e)e.hasOwnProperty(n)&&(t+=e[n].typedArray.byteLength);return t}mo.getBinaryProperties=function(e,t,n){return gie(e,t,n)};mo.prototype.setShow=function(e,t){this._batchTexture.setShow(e,t)};mo.prototype.setAllShow=function(e){this._batchTexture.setAllShow(e)};mo.prototype.getShow=function(e){return this._batchTexture.getShow(e)};mo.prototype.setColor=function(e,t){this._batchTexture.setColor(e,t)};mo.prototype.setAllColor=function(e){this._batchTexture.setAllColor(e)};mo.prototype.getColor=function(e,t){return this._batchTexture.getColor(e,t)};mo.prototype.getPickColor=function(e){return this._batchTexture.getPickColor(e)};var UFe=new G;mo.prototype.applyStyle=function(e){if(!u(e)){this.setAllColor(q9),this.setAllShow(Y9);return}let t=this._content,n=this.featuresLength;for(let i=0;i<n;++i){let o=t.getFeature(i),r=u(e.color)?x(e.color.evaluateColor(o,UFe),q9):q9,s=u(e.show)?x(e.show.evaluate(o),Y9):Y9;this.setColor(i,r),this.setShow(i,s)}};function zFe(e,t){let n=e.typedArray,i=e.componentCount;return i===1?n[t]:e.type.unpack(n,t*i)}function HFe(e,t,n){let i=e.typedArray,o=e.componentCount;o===1?i[t]=n:e.type.pack(n,i,t*o)}mo.prototype.isClass=function(e,t){let n=this._batchTableHierarchy;return u(n)?n.isClass(e,t):!1};mo.prototype.isExactClass=function(e,t){return this.getExactClassName(e)===t};mo.prototype.getExactClassName=function(e){let t=this._batchTableHierarchy;if(u(t))return t.getClassName(e)};mo.prototype.hasProperty=function(e,t){return u(this._properties[t])||u(this._batchTableHierarchy)&&this._batchTableHierarchy.hasProperty(e,t)};mo.prototype.hasPropertyBySemantic=function(){return!1};mo.prototype.getPropertyIds=function(e,t){t=u(t)?t:[],t.length=0;let n=Object.keys(this._properties);return t.push.apply(t,n),u(this._batchTableHierarchy)&&t.push.apply(t,this._batchTableHierarchy.getPropertyIds(e,n)),t};mo.prototype.getPropertyBySemantic=function(e,t){};mo.prototype.getProperty=function(e,t){if(u(this._batchTableBinaryProperties)){let i=this._batchTableBinaryProperties[t];if(u(i))return zFe(i,e)}let n=this._properties[t];if(u(n))return Ge(n[e],!0);if(u(this._batchTableHierarchy)){let i=this._batchTableHierarchy.getProperty(e,t);if(u(i))return i}};mo.prototype.setProperty=function(e,t,n){let i=this.featuresLength;if(u(this._batchTableBinaryProperties)){let r=this._batchTableBinaryProperties[t];if(u(r)){HFe(r,e,n);return}}if(u(this._batchTableHierarchy)&&this._batchTableHierarchy.setProperty(e,t,n))return;let o=this._properties[t];u(o)||(this._properties[t]=new Array(i),o=this._properties[t]),o[e]=Ge(n,!0)};function GFe(e){return e._batchTexture.textureDimensions.y===1?`uniform vec4 tile_textureStep; 
vec2 computeSt(float batchId) 
{ 
    float stepX = tile_textureStep.x; 
    float centerX = tile_textureStep.y; 
    return vec2(centerX + (batchId * stepX), 0.5); 
} 
`:`uniform vec4 tile_textureStep; 
uniform vec2 tile_textureDimensions; 
vec2 computeSt(float batchId) 
{ 
    float stepX = tile_textureStep.x; 
    float centerX = tile_textureStep.y; 
    float stepY = tile_textureStep.z; 
    float centerY = tile_textureStep.w; 
    float xId = mod(batchId, tile_textureDimensions.x); 
    float yId = floor(batchId / tile_textureDimensions.x); 
    return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); 
} 
`}mo.prototype.getVertexShaderCallback=function(e,t,n){if(this.featuresLength===0)return;let i=this;return function(o){let r=yie(o,n,!1),s;return Vt.maximumVertexTextureImageUnits>0?(s="",e&&(s+=`uniform bool tile_translucentCommand; 
`),s+=`uniform sampler2D tile_batchTexture; 
out vec4 tile_featureColor; 
out vec2 tile_featureSt; 
void main() 
{ 
    vec2 st = computeSt(${t}); 
    vec4 featureProperties = texture(tile_batchTexture, st); 
    tile_color(featureProperties); 
    float show = ceil(featureProperties.a); 
    gl_Position *= show; 
`,e&&(s+=`    bool isStyleTranslucent = (featureProperties.a != 1.0); 
    if (czm_pass == czm_passTranslucent) 
    { 
        if (!isStyleTranslucent && !tile_translucentCommand) 
        { 
            gl_Position *= 0.0; 
        } 
    } 
    else 
    { 
        if (isStyleTranslucent) 
        { 
            gl_Position *= 0.0; 
        } 
    } 
`),s+=`    tile_featureColor = featureProperties; 
    tile_featureSt = st; 
}`):s=`out vec2 tile_featureSt; 
void main() 
{ 
    tile_color(vec4(1.0)); 
    tile_featureSt = computeSt(${t}); 
}`,`${r}
${GFe(i)}${s}`}};function _ie(e,t){return e=ze.replaceMain(e,"tile_main"),t?`${e}uniform float tile_colorBlend; 
void tile_color(vec4 tile_featureColor) 
{ 
    tile_main(); 
    tile_featureColor = czm_gammaCorrect(tile_featureColor); 
    out_FragColor.a *= tile_featureColor.a; 
    float highlight = ceil(tile_colorBlend); 
    out_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); 
} 
`:`${e}void tile_color(vec4 tile_featureColor) 
{ 
    tile_main(); 
} 
`}function WFe(e,t){let n=`texture(${t}`,i=0,o=e.indexOf(n,i),r;for(;o>-1;){let s=0;for(let l=o;l<e.length;++l){let f=e.charAt(l);if(f==="(")++s;else if(f===")"&&(--s,s===0)){r=l+1;break}}let c=`tile_diffuse_final(${e.slice(o,r)}, tile_diffuse)`;e=e.slice(0,o)+c+e.slice(r),i=o+c.length,o=e.indexOf(n,i)}return e}function yie(e,t,n){if(!u(t))return _ie(e,n);let i=new RegExp(`(uniform|attribute|in)\\s+(vec[34]|sampler2D)\\s+${t};`),o=e.match(i);if(!u(o))return _ie(e,n);let r=o[0],s=o[2];e=ze.replaceMain(e,"tile_main"),e=e.replace(r,"");let a=`bool isWhite(vec3 color) 
{ 
    return all(greaterThan(color, vec3(1.0 - czm_epsilon3))); 
} 
vec4 tile_diffuse_final(vec4 sourceDiffuse, vec4 tileDiffuse) 
{ 
    vec4 blendDiffuse = mix(sourceDiffuse, tileDiffuse, tile_colorBlend); 
    vec4 diffuse = isWhite(tileDiffuse.rgb) ? sourceDiffuse : blendDiffuse; 
    return vec4(diffuse.rgb, sourceDiffuse.a); 
} 
`,c=`    tile_featureColor = czm_gammaCorrect(tile_featureColor); 
    out_FragColor.a *= tile_featureColor.a; 
    float highlight = ceil(tile_colorBlend); 
    out_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); 
`,l;if(s==="vec3"||s==="vec4"){let f=s==="vec3"?`vec4(${t}, 1.0)`:t,d=s==="vec3"?"tile_diffuse.xyz":"tile_diffuse";i=new RegExp(t,"g"),e=e.replace(i,d),l=`    vec4 source = ${f}; 
    tile_diffuse = tile_diffuse_final(source, tile_featureColor); 
    tile_main(); 
`}else s==="sampler2D"&&(e=WFe(e,t),l=`    tile_diffuse = tile_featureColor; 
    tile_main(); 
`);return e=`uniform float tile_colorBlend; 
vec4 tile_diffuse = vec4(1.0); 
${a}${r}
${e}
void tile_color(vec4 tile_featureColor) 
{ 
${l}`,n&&(e+=c),e+=`} 
`,e}mo.prototype.getFragmentShaderCallback=function(e,t,n){if(this.featuresLength!==0)return function(i){return i=yie(i,t,!0),Vt.maximumVertexTextureImageUnits>0?(i+=`uniform sampler2D tile_pickTexture; 
in vec2 tile_featureSt; 
in vec4 tile_featureColor; 
void main() 
{ 
    tile_color(tile_featureColor); 
`,n&&(i+=`    out_FragColor.rgb *= out_FragColor.a; 
`),i+="}"):(e&&(i+=`uniform bool tile_translucentCommand; 
`),i+=`uniform sampler2D tile_pickTexture; 
uniform sampler2D tile_batchTexture; 
in vec2 tile_featureSt; 
void main() 
{ 
    vec4 featureProperties = texture(tile_batchTexture, tile_featureSt); 
    if (featureProperties.a == 0.0) { 
        discard; 
    } 
`,e&&(i+=`    bool isStyleTranslucent = (featureProperties.a != 1.0); 
    if (czm_pass == czm_passTranslucent) 
    { 
        if (!isStyleTranslucent && !tile_translucentCommand) 
        { 
            discard; 
        } 
    } 
    else 
    { 
        if (isStyleTranslucent) 
        { 
            discard; 
        } 
    } 
`),i+=`    tile_color(featureProperties); 
`,n&&(i+=`    out_FragColor.rgb *= out_FragColor.a; 
`),i+=`} 
`),i}};mo.prototype.getClassificationFragmentShaderCallback=function(){if(this.featuresLength!==0)return function(e){return e=ze.replaceMain(e,"tile_main"),Vt.maximumVertexTextureImageUnits>0?e+=`uniform sampler2D tile_pickTexture;
in vec2 tile_featureSt; 
in vec4 tile_featureColor; 
void main() 
{ 
    tile_main(); 
    out_FragColor = tile_featureColor; 
    out_FragColor.rgb *= out_FragColor.a; 
}`:e+=`uniform sampler2D tile_batchTexture; 
uniform sampler2D tile_pickTexture;
in vec2 tile_featureSt; 
void main() 
{ 
    tile_main(); 
    vec4 featureProperties = texture(tile_batchTexture, tile_featureSt); 
    if (featureProperties.a == 0.0) { 
        discard; 
    } 
    out_FragColor = featureProperties; 
    out_FragColor.rgb *= out_FragColor.a; 
} 
`,e}};function jFe(e){let t=e._content.tileset,n=t.colorBlendMode,i=t.colorBlendAmount;if(n===nu.HIGHLIGHT)return 0;if(n===nu.REPLACE)return 1;if(n===nu.MIX)return R.clamp(i,R.EPSILON4,1)}mo.prototype.getUniformMapCallback=function(){if(this.featuresLength===0)return;let e=this;return function(t){return bt(t,{tile_batchTexture:function(){return x(e._batchTexture.batchTexture,e._batchTexture.defaultTexture)},tile_textureDimensions:function(){return e._batchTexture.textureDimensions},tile_textureStep:function(){return e._batchTexture.textureStep},tile_colorBlend:function(){return jFe(e)},tile_pickTexture:function(){return e._batchTexture.pickTexture}})}};mo.prototype.getPickId=function(){return"texture(tile_pickTexture, tile_featureSt)"};var tg={ALL_OPAQUE:0,ALL_TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2};mo.prototype.addDerivedCommands=function(e,t){let n=e.commandList,i=n.length,o=this._content._tile,r=o._finalResolution,s=o.tileset,a=s.isSkippingLevelOfDetail&&s.hasMixedContent&&e.context.stencilBuffer,c=qFe(this);for(let l=t;l<i;++l){let f=n[l];if(f.pass===we.COMPUTE)continue;let d=f.derivedCommands.tileset;(!u(d)||f.dirty)&&(d={},f.derivedCommands.tileset=d,d.originalCommand=YFe(f),f.dirty=!1);let p=d.originalCommand;c!==tg.ALL_OPAQUE&&f.pass!==we.TRANSLUCENT&&(u(d.translucent)||(d.translucent=XFe(p))),c!==tg.ALL_TRANSLUCENT&&f.pass!==we.TRANSLUCENT&&(u(d.opaque)||(d.opaque=KFe(p)),a&&(r||(u(d.zback)||(d.zback=$Fe(e.context,p)),s._backfaceCommands.push(d.zback)),(!u(d.stencil)||o._selectionDepth!==JFe(d.stencil))&&(f.renderState.depthMask?d.stencil=QFe(p,o._selectionDepth):d.stencil=d.opaque)));let g=a?d.stencil:d.opaque,m=d.translucent;f.pass!==we.TRANSLUCENT?(c===tg.ALL_OPAQUE&&(n[l]=g),c===tg.ALL_TRANSLUCENT&&(n[l]=m),c===tg.OPAQUE_AND_TRANSLUCENT&&(n[l]=g,n.push(m))):n[l]=p}};function qFe(e){let t=e._batchTexture.translucentFeaturesLength;return t===0?tg.ALL_OPAQUE:t===e.featuresLength?tg.ALL_TRANSLUCENT:tg.OPAQUE_AND_TRANSLUCENT}function YFe(e){let t=Qe.shallowClone(e),n=t.pass===we.TRANSLUCENT;return t.uniformMap=u(t.uniformMap)?t.uniformMap:{},t.uniformMap.tile_translucentCommand=function(){return n},t}function XFe(e){let t=Qe.shallowClone(e);return t.pass=we.TRANSLUCENT,t.renderState=eBe(e.renderState),t}function KFe(e){let t=Qe.shallowClone(e);return t.renderState=tBe(e.renderState),t}function ZFe(e,t){let n=e.shaderCache.getDerivedShaderProgram(t,"zBackfaceLogDepth");if(!u(n)){let i=t.fragmentShaderSource.clone();i.defines=u(i.defines)?i.defines.slice(0):[],i.defines.push("POLYGON_OFFSET"),n=e.shaderCache.createDerivedShaderProgram(t,"zBackfaceLogDepth",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:i,attributeLocations:t._attributeLocations})}return n}function $Fe(e,t){let n=Qe.shallowClone(t),i=Ge(n.renderState,!0);i.cull.enabled=!0,i.cull.face=Ci.FRONT,i.colorMask={red:!1,green:!1,blue:!1,alpha:!1},i.polygonOffset={enabled:!0,factor:5,units:5},i.stencilTest=Ut.setCesium3DTileBit(),i.stencilMask=Ut.CESIUM_3D_TILE_MASK,n.renderState=Ue.fromCache(i),n.castShadows=!1,n.receiveShadows=!1,n.uniformMap=Ge(t.uniformMap);let o=new H(5,5);return n.uniformMap.u_polygonOffset=function(){return o},n.shaderProgram=ZFe(e,t.shaderProgram),n}function QFe(e,t){let n=Qe.shallowClone(e),i=Ge(n.renderState,!0);return i.stencilTest.enabled=!0,i.stencilTest.mask=Ut.SKIP_LOD_MASK,i.stencilTest.reference=Ut.CESIUM_3D_TILE_MASK|t<<Ut.SKIP_LOD_BIT_SHIFT,i.stencilTest.frontFunction=Un.GREATER_OR_EQUAL,i.stencilTest.frontOperation.zPass=mt.REPLACE,i.stencilTest.backFunction=Un.GREATER_OR_EQUAL,i.stencilTest.backOperation.zPass=mt.REPLACE,i.stencilMask=Ut.CESIUM_3D_TILE_MASK|Ut.SKIP_LOD_MASK,n.renderState=Ue.fromCache(i),n}function JFe(e){return(e.renderState.stencilTest.reference&Ut.SKIP_LOD_MASK)>>>Ut.SKIP_LOD_BIT_SHIFT}function eBe(e){let t=Ge(e,!0);return t.cull.enabled=!1,t.depthTest.enabled=!0,t.depthMask=!1,t.blending=un.ALPHA_BLEND,t.stencilTest=Ut.setCesium3DTileBit(),t.stencilMask=Ut.CESIUM_3D_TILE_MASK,Ue.fromCache(t)}function tBe(e){let t=Ge(e,!0);return t.stencilTest=Ut.setCesium3DTileBit(),t.stencilMask=Ut.CESIUM_3D_TILE_MASK,Ue.fromCache(t)}mo.prototype.update=function(e,t){this._batchTexture.update(e,t)};mo.prototype.isDestroyed=function(){return!1};mo.prototype.destroy=function(){return this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),ue(this)};var ng=mo;function nBe(e){this.offset=e.offset,this.count=e.count,this.color=e.color,this.batchIds=e.batchIds}var mp=nBe;var Vv=`in vec3 position;
in float a_batchId;

uniform mat4 u_modifiedModelViewProjection;

void main()
{
    gl_Position = czm_depthClamp(u_modifiedModelViewProjection * vec4(position, 1.0));
}
`;function ff(e,t){this._content=e,this._batchId=t,this._color=void 0}Object.defineProperties(ff.prototype,{show:{get:function(){return this._content.batchTable.getShow(this._batchId)},set:function(e){this._content.batchTable.setShow(this._batchId,e)}},color:{get:function(){return u(this._color)||(this._color=new G),this._content.batchTable.getColor(this._batchId,this._color)},set:function(e){this._content.batchTable.setColor(this._batchId,e)}},polylinePositions:{get:function(){if(u(this._content.getPolylinePositions))return this._content.getPolylinePositions(this._batchId)}},content:{get:function(){return this._content}},tileset:{get:function(){return this._content.tileset}},primitive:{get:function(){return this._content.tileset}},featureId:{get:function(){return this._batchId}},pickId:{get:function(){return this._content.batchTable.getPickColor(this._batchId)}}});ff.prototype.hasProperty=function(e){return this._content.batchTable.hasProperty(this._batchId,e)};ff.prototype.getPropertyIds=function(e){return this._content.batchTable.getPropertyIds(this._batchId,e)};ff.prototype.getProperty=function(e){return this._content.batchTable.getProperty(this._batchId,e)};ff.getPropertyInherited=function(e,t,n){let i=e.batchTable;if(u(i)){if(i.hasPropertyBySemantic(t,n))return i.getPropertyBySemantic(t,n);if(i.hasProperty(t,n))return i.getProperty(t,n)}let o=e.metadata;if(u(o)){if(o.hasPropertyBySemantic(n))return o.getPropertyBySemantic(n);if(o.hasProperty(n))return o.getProperty(n)}let r=e.tile,s=r.metadata;if(u(s)){if(s.hasPropertyBySemantic(n))return s.getPropertyBySemantic(n);if(s.hasProperty(n))return s.getProperty(n)}let a;if(u(r.implicitSubtree)&&(a=r.implicitSubtree.metadata),u(a)){if(a.hasPropertyBySemantic(n))return a.getPropertyBySemantic(n);if(a.hasProperty(n))return a.getProperty(n)}let c=u(e.group)?e.group.metadata:void 0;if(u(c)){if(c.hasPropertyBySemantic(n))return c.getPropertyBySemantic(n);if(c.hasProperty(n))return c.getProperty(n)}let l=e.tileset.metadata;if(u(l)){if(l.hasPropertyBySemantic(n))return l.getPropertyBySemantic(n);if(l.hasProperty(n))return l.getProperty(n)}};ff.prototype.getPropertyInherited=function(e){return ff.getPropertyInherited(this._content,this._batchId,e)};ff.prototype.setProperty=function(e,t){this._content.batchTable.setProperty(this._batchId,e,t),this._content.featurePropertiesDirty=!0};ff.prototype.isExactClass=function(e){return this._content.batchTable.isExactClass(this._batchId,e)};ff.prototype.isClass=function(e){return this._content.batchTable.isClass(this._batchId,e)};ff.prototype.getExactClassName=function(){return this._content.batchTable.getExactClassName(this._batchId)};var ta=ff;var X9=class{add(t,n,i){if(typeof arguments[0]!="string")for(let o in arguments[0])this.add(o,arguments[0][o],arguments[1]);else(Array.isArray(t)?t:[t]).forEach(function(o){this[o]=this[o]||[],n&&this[o][i?"unshift":"push"](n)},this)}run(t,n){this[t]=this[t]||[],this[t].forEach(function(i){i.call(n&&n.context?n.context:n,n)})}},K9=class{constructor(t){this.jsep=t,this.registered={}}register(...t){t.forEach(n=>{if(typeof n!="object"||!n.name||!n.init)throw new Error("Invalid JSEP plugin format");this.registered[n.name]||(n.init(this.jsep),this.registered[n.name]=n)})}},bl=class e{static get version(){return"1.4.0"}static toString(){return"JavaScript Expression Parser (JSEP) v"+e.version}static addUnaryOp(t){return e.max_unop_len=Math.max(t.length,e.max_unop_len),e.unary_ops[t]=1,e}static addBinaryOp(t,n,i){return e.max_binop_len=Math.max(t.length,e.max_binop_len),e.binary_ops[t]=n,i?e.right_associative.add(t):e.right_associative.delete(t),e}static addIdentifierChar(t){return e.additional_identifier_chars.add(t),e}static addLiteral(t,n){return e.literals[t]=n,e}static removeUnaryOp(t){return delete e.unary_ops[t],t.length===e.max_unop_len&&(e.max_unop_len=e.getMaxKeyLen(e.unary_ops)),e}static removeAllUnaryOps(){return e.unary_ops={},e.max_unop_len=0,e}static removeIdentifierChar(t){return e.additional_identifier_chars.delete(t),e}static removeBinaryOp(t){return delete e.binary_ops[t],t.length===e.max_binop_len&&(e.max_binop_len=e.getMaxKeyLen(e.binary_ops)),e.right_associative.delete(t),e}static removeAllBinaryOps(){return e.binary_ops={},e.max_binop_len=0,e}static removeLiteral(t){return delete e.literals[t],e}static removeAllLiterals(){return e.literals={},e}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(t){this.expr=t,this.index=0}static parse(t){return new e(t).parse()}static getMaxKeyLen(t){return Math.max(0,...Object.keys(t).map(n=>n.length))}static isDecimalDigit(t){return t>=48&&t<=57}static binaryPrecedence(t){return e.binary_ops[t]||0}static isIdentifierStart(t){return t>=65&&t<=90||t>=97&&t<=122||t>=128&&!e.binary_ops[String.fromCharCode(t)]||e.additional_identifier_chars.has(String.fromCharCode(t))}static isIdentifierPart(t){return e.isIdentifierStart(t)||e.isDecimalDigit(t)}throwError(t){let n=new Error(t+" at character "+this.index);throw n.index=this.index,n.description=t,n}runHook(t,n){if(e.hooks[t]){let i={context:this,node:n};return e.hooks.run(t,i),i.node}return n}searchHook(t){if(e.hooks[t]){let n={context:this};return e.hooks[t].find(function(i){return i.call(n.context,n),n.node}),n.node}}gobbleSpaces(){let t=this.code;for(;t===e.SPACE_CODE||t===e.TAB_CODE||t===e.LF_CODE||t===e.CR_CODE;)t=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");let t=this.gobbleExpressions(),n=t.length===1?t[0]:{type:e.COMPOUND,body:t};return this.runHook("after-all",n)}gobbleExpressions(t){let n=[],i,o;for(;this.index<this.expr.length;)if(i=this.code,i===e.SEMCOL_CODE||i===e.COMMA_CODE)this.index++;else if(o=this.gobbleExpression())n.push(o);else if(this.index<this.expr.length){if(i===t)break;this.throwError('Unexpected "'+this.char+'"')}return n}gobbleExpression(){let t=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",t)}gobbleBinaryOp(){this.gobbleSpaces();let t=this.expr.substr(this.index,e.max_binop_len),n=t.length;for(;n>0;){if(e.binary_ops.hasOwnProperty(t)&&(!e.isIdentifierStart(this.code)||this.index+t.length<this.expr.length&&!e.isIdentifierPart(this.expr.charCodeAt(this.index+t.length))))return this.index+=n,t;t=t.substr(0,--n)}return!1}gobbleBinaryExpression(){let t,n,i,o,r,s,a,c,l;if(s=this.gobbleToken(),!s||(n=this.gobbleBinaryOp(),!n))return s;for(r={value:n,prec:e.binaryPrecedence(n),right_a:e.right_associative.has(n)},a=this.gobbleToken(),a||this.throwError("Expected expression after "+n),o=[s,r,a];n=this.gobbleBinaryOp();){if(i=e.binaryPrecedence(n),i===0){this.index-=n.length;break}r={value:n,prec:i,right_a:e.right_associative.has(n)},l=n;let f=d=>r.right_a&&d.right_a?i>d.prec:i<=d.prec;for(;o.length>2&&f(o[o.length-2]);)a=o.pop(),n=o.pop().value,s=o.pop(),t={type:e.BINARY_EXP,operator:n,left:s,right:a},o.push(t);t=this.gobbleToken(),t||this.throwError("Expected expression after "+l),o.push(r,t)}for(c=o.length-1,t=o[c];c>1;)t={type:e.BINARY_EXP,operator:o[c-1].value,left:o[c-2],right:t},c-=2;return t}gobbleToken(){let t,n,i,o;if(this.gobbleSpaces(),o=this.searchHook("gobble-token"),o)return this.runHook("after-token",o);if(t=this.code,e.isDecimalDigit(t)||t===e.PERIOD_CODE)return this.gobbleNumericLiteral();if(t===e.SQUOTE_CODE||t===e.DQUOTE_CODE)o=this.gobbleStringLiteral();else if(t===e.OBRACK_CODE)o=this.gobbleArray();else{for(n=this.expr.substr(this.index,e.max_unop_len),i=n.length;i>0;){if(e.unary_ops.hasOwnProperty(n)&&(!e.isIdentifierStart(this.code)||this.index+n.length<this.expr.length&&!e.isIdentifierPart(this.expr.charCodeAt(this.index+n.length)))){this.index+=i;let r=this.gobbleToken();return r||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:e.UNARY_EXP,operator:n,argument:r,prefix:!0})}n=n.substr(0,--i)}e.isIdentifierStart(t)?(o=this.gobbleIdentifier(),e.literals.hasOwnProperty(o.name)?o={type:e.LITERAL,value:e.literals[o.name],raw:o.name}:o.name===e.this_str&&(o={type:e.THIS_EXP})):t===e.OPAREN_CODE&&(o=this.gobbleGroup())}return o?(o=this.gobbleTokenProperty(o),this.runHook("after-token",o)):this.runHook("after-token",!1)}gobbleTokenProperty(t){this.gobbleSpaces();let n=this.code;for(;n===e.PERIOD_CODE||n===e.OBRACK_CODE||n===e.OPAREN_CODE||n===e.QUMARK_CODE;){let i;if(n===e.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==e.PERIOD_CODE)break;i=!0,this.index+=2,this.gobbleSpaces(),n=this.code}this.index++,n===e.OBRACK_CODE?(t={type:e.MEMBER_EXP,computed:!0,object:t,property:this.gobbleExpression()},t.property||this.throwError('Unexpected "'+this.char+'"'),this.gobbleSpaces(),n=this.code,n!==e.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):n===e.OPAREN_CODE?t={type:e.CALL_EXP,arguments:this.gobbleArguments(e.CPAREN_CODE),callee:t}:(n===e.PERIOD_CODE||i)&&(i&&this.index--,this.gobbleSpaces(),t={type:e.MEMBER_EXP,computed:!1,object:t,property:this.gobbleIdentifier()}),i&&(t.optional=!0),this.gobbleSpaces(),n=this.code}return t}gobbleNumericLiteral(){let t="",n,i;for(;e.isDecimalDigit(this.code);)t+=this.expr.charAt(this.index++);if(this.code===e.PERIOD_CODE)for(t+=this.expr.charAt(this.index++);e.isDecimalDigit(this.code);)t+=this.expr.charAt(this.index++);if(n=this.char,n==="e"||n==="E"){for(t+=this.expr.charAt(this.index++),n=this.char,(n==="+"||n==="-")&&(t+=this.expr.charAt(this.index++));e.isDecimalDigit(this.code);)t+=this.expr.charAt(this.index++);e.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+t+this.char+")")}return i=this.code,e.isIdentifierStart(i)?this.throwError("Variable names cannot start with a number ("+t+this.char+")"):(i===e.PERIOD_CODE||t.length===1&&t.charCodeAt(0)===e.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:e.LITERAL,value:parseFloat(t),raw:t}}gobbleStringLiteral(){let t="",n=this.index,i=this.expr.charAt(this.index++),o=!1;for(;this.index<this.expr.length;){let r=this.expr.charAt(this.index++);if(r===i){o=!0;break}else if(r==="\\")switch(r=this.expr.charAt(this.index++),r){case"n":t+=`
`;break;case"r":t+="\r";break;case"t":t+="	";break;case"b":t+="\b";break;case"f":t+="\f";break;case"v":t+="\v";break;default:t+=r}else t+=r}return o||this.throwError('Unclosed quote after "'+t+'"'),{type:e.LITERAL,value:t,raw:this.expr.substring(n,this.index)}}gobbleIdentifier(){let t=this.code,n=this.index;for(e.isIdentifierStart(t)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(t=this.code,e.isIdentifierPart(t));)this.index++;return{type:e.IDENTIFIER,name:this.expr.slice(n,this.index)}}gobbleArguments(t){let n=[],i=!1,o=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let r=this.code;if(r===t){i=!0,this.index++,t===e.CPAREN_CODE&&o&&o>=n.length&&this.throwError("Unexpected token "+String.fromCharCode(t));break}else if(r===e.COMMA_CODE){if(this.index++,o++,o!==n.length){if(t===e.CPAREN_CODE)this.throwError("Unexpected token ,");else if(t===e.CBRACK_CODE)for(let s=n.length;s<o;s++)n.push(null)}}else if(n.length!==o&&o!==0)this.throwError("Expected comma");else{let s=this.gobbleExpression();(!s||s.type===e.COMPOUND)&&this.throwError("Expected comma"),n.push(s)}}return i||this.throwError("Expected "+String.fromCharCode(t)),n}gobbleGroup(){this.index++;let t=this.gobbleExpressions(e.CPAREN_CODE);if(this.code===e.CPAREN_CODE)return this.index++,t.length===1?t[0]:t.length?{type:e.SEQUENCE_EXP,expressions:t}:!1;this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:e.ARRAY_EXP,elements:this.gobbleArguments(e.CBRACK_CODE)}}},iBe=new X9;Object.assign(bl,{hooks:iBe,plugins:new K9(bl),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"??":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10,"**":11},right_associative:new Set(["**"]),additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"});bl.max_unop_len=bl.getMaxKeyLen(bl.unary_ops);bl.max_binop_len=bl.getMaxKeyLen(bl.binary_ops);var ig=e=>new bl(e).parse(),oBe=Object.getOwnPropertyNames(class{});Object.getOwnPropertyNames(bl).filter(e=>!oBe.includes(e)&&ig[e]===void 0).forEach(e=>{ig[e]=bl[e]});ig.Jsep=bl;var rBe="ConditionalExpression",sBe={name:"ternary",init(e){e.hooks.add("after-expression",function(n){if(n.node&&this.code===e.QUMARK_CODE){this.index++;let i=n.node,o=this.gobbleExpression();if(o||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===e.COLON_CODE){this.index++;let r=this.gobbleExpression();if(r||this.throwError("Expected expression"),n.node={type:rBe,test:i,consequent:o,alternate:r},i.operator&&e.binary_ops[i.operator]<=.9){let s=i;for(;s.right.operator&&e.binary_ops[s.right.operator]<=.9;)s=s.right;n.node.test=s.right,s.right=n.node,n.node=i}}else this.throwError("Expected :")}})}};ig.plugins.register(sBe);var aBe={VARIABLE:0,UNARY:1,BINARY:2,TERNARY:3,CONDITIONAL:4,MEMBER:5,FUNCTION_CALL:6,ARRAY:7,REGEX:8,VARIABLE_IN_STRING:9,LITERAL_NULL:10,LITERAL_BOOLEAN:11,LITERAL_NUMBER:12,LITERAL_STRING:13,LITERAL_COLOR:14,LITERAL_VECTOR:15,LITERAL_REGEX:16,LITERAL_UNDEFINED:17,BUILTIN_VARIABLE:18},pt=Object.freeze(aBe);function pd(e,t){this._expression=e,e=bBe(e,t),e=ABe(CBe(e)),ig.addBinaryOp("=~",0),ig.addBinaryOp("!~",0);let n;try{n=ig(e)}catch(i){throw new ce(i)}this._runtimeAst=Ai(this,n)}Object.defineProperties(pd.prototype,{expression:{get:function(){return this._expression}}});var Pn={arrayIndex:0,arrayArray:[[]],cartesian2Index:0,cartesian3Index:0,cartesian4Index:0,cartesian2Array:[new H],cartesian3Array:[new h],cartesian4Array:[new oe],reset:function(){this.arrayIndex=0,this.cartesian2Index=0,this.cartesian3Index=0,this.cartesian4Index=0},getArray:function(){this.arrayIndex>=this.arrayArray.length&&this.arrayArray.push([]);let e=this.arrayArray[this.arrayIndex++];return e.length=0,e},getCartesian2:function(){return this.cartesian2Index>=this.cartesian2Array.length&&this.cartesian2Array.push(new H),this.cartesian2Array[this.cartesian2Index++]},getCartesian3:function(){return this.cartesian3Index>=this.cartesian3Array.length&&this.cartesian3Array.push(new h),this.cartesian3Array[this.cartesian3Index++]},getCartesian4:function(){return this.cartesian4Index>=this.cartesian4Array.length&&this.cartesian4Array.push(new oe),this.cartesian4Array[this.cartesian4Index++]}};pd.prototype.evaluate=function(e,t){Pn.reset();let n=this._runtimeAst.evaluate(e);return t instanceof G&&n instanceof oe?G.fromCartesian4(n,t):n instanceof H||n instanceof h||n instanceof oe?n.clone(t):n};pd.prototype.evaluateColor=function(e,t){Pn.reset();let n=this._runtimeAst.evaluate(e);return G.fromCartesian4(n,t)};pd.prototype.getShaderFunction=function(e,t,n,i){let o=this.getShaderExpression(t,n);return o=`${i} ${e}
{
    return ${o};
}
`,o};pd.prototype.getShaderExpression=function(e,t){return this._runtimeAst.getShaderExpression(e,t)};pd.prototype.getVariables=function(){let e=[];return this._runtimeAst.getVariables(e),e=e.filter(function(t,n,i){return i.indexOf(t)===n}),e};var cBe=["!","-","+"],xie=["+","-","*","/","%","===","!==",">",">=","<","<=","&&","||","!~","=~"],ZL=/\${(.*?)}/g,lBe=/\\/g,uBe="@#%",fBe=/@#%/g,$L=new G,QL={abs:Bs(Math.abs),sqrt:Bs(Math.sqrt),cos:Bs(Math.cos),sin:Bs(Math.sin),tan:Bs(Math.tan),acos:Bs(Math.acos),asin:Bs(Math.asin),atan:Bs(Math.atan),radians:Bs(R.toRadians),degrees:Bs(R.toDegrees),sign:Bs(R.sign),floor:Bs(Math.floor),ceil:Bs(Math.ceil),round:Bs(Math.round),exp:Bs(Math.exp),exp2:Bs(hBe),log:Bs(Math.log),log2:Bs(mBe),fract:Bs(dBe),length:pBe,normalize:_Be},JL={atan2:XL(Math.atan2,!1),pow:XL(Math.pow,!1),min:XL(Math.min,!0),max:XL(Math.max,!0),distance:gBe,dot:yBe,cross:xBe},Q9={clamp:bie(R.clamp,!0),mix:bie(R.lerp,!0)};function dBe(e){return e-Math.floor(e)}function hBe(e){return Math.pow(2,e)}function mBe(e){return R.log2(e)}function Bs(e){return function(t,n){if(typeof n=="number")return e(n);if(n instanceof H)return H.fromElements(e(n.x),e(n.y),Pn.getCartesian2());if(n instanceof h)return h.fromElements(e(n.x),e(n.y),e(n.z),Pn.getCartesian3());if(n instanceof oe)return oe.fromElements(e(n.x),e(n.y),e(n.z),e(n.w),Pn.getCartesian4());throw new ce(`Function "${t}" requires a vector or number argument. Argument is ${n}.`)}}function XL(e,t){return function(n,i,o){if(t&&typeof o=="number"){if(typeof i=="number")return e(i,o);if(i instanceof H)return H.fromElements(e(i.x,o),e(i.y,o),Pn.getCartesian2());if(i instanceof h)return h.fromElements(e(i.x,o),e(i.y,o),e(i.z,o),Pn.getCartesian3());if(i instanceof oe)return oe.fromElements(e(i.x,o),e(i.y,o),e(i.z,o),e(i.w,o),Pn.getCartesian4())}if(typeof i=="number"&&typeof o=="number")return e(i,o);if(i instanceof H&&o instanceof H)return H.fromElements(e(i.x,o.x),e(i.y,o.y),Pn.getCartesian2());if(i instanceof h&&o instanceof h)return h.fromElements(e(i.x,o.x),e(i.y,o.y),e(i.z,o.z),Pn.getCartesian3());if(i instanceof oe&&o instanceof oe)return oe.fromElements(e(i.x,o.x),e(i.y,o.y),e(i.z,o.z),e(i.w,o.w),Pn.getCartesian4());throw new ce(`Function "${n}" requires vector or number arguments of matching types. Arguments are ${i} and ${o}.`)}}function bie(e,t){return function(n,i,o,r){if(t&&typeof r=="number"){if(typeof i=="number"&&typeof o=="number")return e(i,o,r);if(i instanceof H&&o instanceof H)return H.fromElements(e(i.x,o.x,r),e(i.y,o.y,r),Pn.getCartesian2());if(i instanceof h&&o instanceof h)return h.fromElements(e(i.x,o.x,r),e(i.y,o.y,r),e(i.z,o.z,r),Pn.getCartesian3());if(i instanceof oe&&o instanceof oe)return oe.fromElements(e(i.x,o.x,r),e(i.y,o.y,r),e(i.z,o.z,r),e(i.w,o.w,r),Pn.getCartesian4())}if(typeof i=="number"&&typeof o=="number"&&typeof r=="number")return e(i,o,r);if(i instanceof H&&o instanceof H&&r instanceof H)return H.fromElements(e(i.x,o.x,r.x),e(i.y,o.y,r.y),Pn.getCartesian2());if(i instanceof h&&o instanceof h&&r instanceof h)return h.fromElements(e(i.x,o.x,r.x),e(i.y,o.y,r.y),e(i.z,o.z,r.z),Pn.getCartesian3());if(i instanceof oe&&o instanceof oe&&r instanceof oe)return oe.fromElements(e(i.x,o.x,r.x),e(i.y,o.y,r.y),e(i.z,o.z,r.z),e(i.w,o.w,r.w),Pn.getCartesian4());throw new ce(`Function "${n}" requires vector or number arguments of matching types. Arguments are ${i}, ${o}, and ${r}.`)}}function pBe(e,t){if(typeof t=="number")return Math.abs(t);if(t instanceof H)return H.magnitude(t);if(t instanceof h)return h.magnitude(t);if(t instanceof oe)return oe.magnitude(t);throw new ce(`Function "${e}" requires a vector or number argument. Argument is ${t}.`)}function _Be(e,t){if(typeof t=="number")return 1;if(t instanceof H)return H.normalize(t,Pn.getCartesian2());if(t instanceof h)return h.normalize(t,Pn.getCartesian3());if(t instanceof oe)return oe.normalize(t,Pn.getCartesian4());throw new ce(`Function "${e}" requires a vector or number argument. Argument is ${t}.`)}function gBe(e,t,n){if(typeof t=="number"&&typeof n=="number")return Math.abs(t-n);if(t instanceof H&&n instanceof H)return H.distance(t,n);if(t instanceof h&&n instanceof h)return h.distance(t,n);if(t instanceof oe&&n instanceof oe)return oe.distance(t,n);throw new ce(`Function "${e}" requires vector or number arguments of matching types. Arguments are ${t} and ${n}.`)}function yBe(e,t,n){if(typeof t=="number"&&typeof n=="number")return t*n;if(t instanceof H&&n instanceof H)return H.dot(t,n);if(t instanceof h&&n instanceof h)return h.dot(t,n);if(t instanceof oe&&n instanceof oe)return oe.dot(t,n);throw new ce(`Function "${e}" requires vector or number arguments of matching types. Arguments are ${t} and ${n}.`)}function xBe(e,t,n){if(t instanceof h&&n instanceof h)return h.cross(t,n,Pn.getCartesian3());throw new ce(`Function "${e}" requires vec3 arguments. Arguments are ${t} and ${n}.`)}function Ct(e,t,n,i,o){this._type=e,this._value=t,this._left=n,this._right=i,this._test=o,this.evaluate=void 0,OBe(this)}function bBe(e,t){if(!u(t))return e;for(let n in t)if(t.hasOwnProperty(n)){let i=new RegExp(`\\$\\{${n}\\}`,"g"),o=`(${t[n]})`;u(o)&&(e=e.replace(i,o))}return e}function CBe(e){return e.replace(lBe,uBe)}function $9(e){return e.replace(fBe,"\\")}function ABe(e){let t=e,n="",i=t.indexOf("${");for(;i>=0;){let o=t.indexOf("'"),r=t.indexOf('"'),s;if(o>=0&&o<i)s=t.indexOf("'",o+1),n+=t.substr(0,s+1),t=t.substr(s+1),i=t.indexOf("${");else if(r>=0&&r<i)s=t.indexOf('"',r+1),n+=t.substr(0,s+1),t=t.substr(s+1),i=t.indexOf("${");else{n+=t.substr(0,i);let a=t.indexOf("}");if(a<0)throw new ce("Unmatched {.");n+=`czm_${t.substr(i+2,a-(i+2))}`,t=t.substr(a+1),i=t.indexOf("${")}}return n+=t,n}function TBe(e){let t=typeof e.value;if(e.value===null)return new Ct(pt.LITERAL_NULL,null);if(t==="boolean")return new Ct(pt.LITERAL_BOOLEAN,e.value);if(t==="number")return new Ct(pt.LITERAL_NUMBER,e.value);if(t==="string")return e.value.indexOf("${")>=0?new Ct(pt.VARIABLE_IN_STRING,e.value):new Ct(pt.LITERAL_STRING,$9(e.value))}function EBe(e,t){let n=t.arguments,i=n.length,o,r,s,a;if(t.callee.type==="MemberExpression"){o=t.callee.property.name;let c=t.callee.object;if(o==="test"||o==="exec"){if(!u(c.callee)||c.callee.name!=="regExp")throw new ce(`${o} is not a function.`);return i===0?o==="test"?new Ct(pt.LITERAL_BOOLEAN,!1):new Ct(pt.LITERAL_NULL,null):(s=Ai(e,c),a=Ai(e,n[0]),new Ct(pt.FUNCTION_CALL,o,s,a))}else if(o==="toString")return r=Ai(e,c),new Ct(pt.FUNCTION_CALL,o,r);throw new ce(`Unexpected function call "${o}".`)}if(o=t.callee.name,o==="color"){if(i===0)return new Ct(pt.LITERAL_COLOR,o);if(r=Ai(e,n[0]),u(n[1])){let c=Ai(e,n[1]);return new Ct(pt.LITERAL_COLOR,o,[r,c])}return new Ct(pt.LITERAL_COLOR,o,[r])}else if(o==="rgb"||o==="hsl"){if(i<3)throw new ce(`${o} requires three arguments.`);return r=[Ai(e,n[0]),Ai(e,n[1]),Ai(e,n[2])],new Ct(pt.LITERAL_COLOR,o,r)}else if(o==="rgba"||o==="hsla"){if(i<4)throw new ce(`${o} requires four arguments.`);return r=[Ai(e,n[0]),Ai(e,n[1]),Ai(e,n[2]),Ai(e,n[3])],new Ct(pt.LITERAL_COLOR,o,r)}else if(o==="vec2"||o==="vec3"||o==="vec4"){r=new Array(i);for(let c=0;c<i;++c)r[c]=Ai(e,n[c]);return new Ct(pt.LITERAL_VECTOR,o,r)}else{if(o==="isNaN"||o==="isFinite")return i===0?o==="isNaN"?new Ct(pt.LITERAL_BOOLEAN,!0):new Ct(pt.LITERAL_BOOLEAN,!1):(r=Ai(e,n[0]),new Ct(pt.UNARY,o,r));if(o==="isExactClass"||o==="isClass"){if(i<1||i>1)throw new ce(`${o} requires exactly one argument.`);return r=Ai(e,n[0]),new Ct(pt.UNARY,o,r)}else if(o==="getExactClassName"){if(i>0)throw new ce(`${o} does not take any argument.`);return new Ct(pt.UNARY,o)}else if(u(QL[o])){if(i!==1)throw new ce(`${o} requires exactly one argument.`);return r=Ai(e,n[0]),new Ct(pt.UNARY,o,r)}else if(u(JL[o])){if(i!==2)throw new ce(`${o} requires exactly two arguments.`);return s=Ai(e,n[0]),a=Ai(e,n[1]),new Ct(pt.BINARY,o,s,a)}else if(u(Q9[o])){if(i!==3)throw new ce(`${o} requires exactly three arguments.`);s=Ai(e,n[0]),a=Ai(e,n[1]);let c=Ai(e,n[2]);return new Ct(pt.TERNARY,o,s,a,c)}else{if(o==="Boolean")return i===0?new Ct(pt.LITERAL_BOOLEAN,!1):(r=Ai(e,n[0]),new Ct(pt.UNARY,o,r));if(o==="Number")return i===0?new Ct(pt.LITERAL_NUMBER,0):(r=Ai(e,n[0]),new Ct(pt.UNARY,o,r));if(o==="String")return i===0?new Ct(pt.LITERAL_STRING,""):(r=Ai(e,n[0]),new Ct(pt.UNARY,o,r));if(o==="regExp")return SBe(e,t)}}throw new ce(`Unexpected function call "${o}".`)}function SBe(e,t){let n=t.arguments;if(n.length===0)return new Ct(pt.LITERAL_REGEX,new RegExp);let i=Ai(e,n[0]),o;if(n.length>1){let r=Ai(e,n[1]);if(Z9(i)&&Z9(r)){try{o=new RegExp($9(String(i._value)),r._value)}catch(s){throw new ce(s)}return new Ct(pt.LITERAL_REGEX,o)}return new Ct(pt.REGEX,i,r)}if(Z9(i)){try{o=new RegExp($9(String(i._value)))}catch(r){throw new ce(r)}return new Ct(pt.LITERAL_REGEX,o)}return new Ct(pt.REGEX,i)}function vBe(e){if(PBe(e.name)){let t=RBe(e.name);return t.substr(0,8)==="tiles3d_"?new Ct(pt.BUILTIN_VARIABLE,t):new Ct(pt.VARIABLE,t)}else{if(e.name==="NaN")return new Ct(pt.LITERAL_NUMBER,NaN);if(e.name==="Infinity")return new Ct(pt.LITERAL_NUMBER,1/0);if(e.name==="undefined")return new Ct(pt.LITERAL_UNDEFINED,void 0)}throw new ce(`${e.name} is not defined.`)}function wBe(e){let t=e.property.name;if(t==="PI")return new Ct(pt.LITERAL_NUMBER,Math.PI);if(t==="E")return new Ct(pt.LITERAL_NUMBER,Math.E)}function DBe(e){if(e.property.name==="POSITIVE_INFINITY")return new Ct(pt.LITERAL_NUMBER,Number.POSITIVE_INFINITY)}function IBe(e,t){if(t.object.name==="Math")return wBe(t);if(t.object.name==="Number")return DBe(t);let n,i=Ai(e,t.object);return t.computed?(n=Ai(e,t.property),new Ct(pt.MEMBER,"brackets",i,n)):(n=new Ct(pt.LITERAL_STRING,t.property.name),new Ct(pt.MEMBER,"dot",i,n))}function Z9(e){return e._type>=pt.LITERAL_NULL}function PBe(e){return e.substr(0,4)==="czm_"}function RBe(e){return e.substr(4)}function Ai(e,t){let n,i,o,r;if(t.type==="Literal")n=TBe(t);else if(t.type==="CallExpression")n=EBe(e,t);else if(t.type==="Identifier")n=vBe(t);else if(t.type==="UnaryExpression"){i=t.operator;let s=Ai(e,t.argument);if(cBe.indexOf(i)>-1)n=new Ct(pt.UNARY,i,s);else throw new ce(`Unexpected operator "${i}".`)}else if(t.type==="BinaryExpression")if(i=t.operator,o=Ai(e,t.left),r=Ai(e,t.right),xie.indexOf(i)>-1)n=new Ct(pt.BINARY,i,o,r);else throw new ce(`Unexpected operator "${i}".`);else if(t.type==="LogicalExpression")i=t.operator,o=Ai(e,t.left),r=Ai(e,t.right),xie.indexOf(i)>-1&&(n=new Ct(pt.BINARY,i,o,r));else if(t.type==="ConditionalExpression"){let s=Ai(e,t.test);o=Ai(e,t.consequent),r=Ai(e,t.alternate),n=new Ct(pt.CONDITIONAL,"?",o,r,s)}else if(t.type==="MemberExpression")n=IBe(e,t);else if(t.type==="ArrayExpression"){let s=[];for(let a=0;a<t.elements.length;a++)s[a]=Ai(e,t.elements[a]);n=new Ct(pt.ARRAY,s)}else throw t.type==="Compound"?new ce("Provide exactly one expression."):new ce("Cannot parse expression.");return n}function OBe(e){e._type===pt.CONDITIONAL?e.evaluate=e._evaluateConditional:e._type===pt.FUNCTION_CALL?e._value==="test"?e.evaluate=e._evaluateRegExpTest:e._value==="exec"?e.evaluate=e._evaluateRegExpExec:e._value==="toString"&&(e.evaluate=e._evaluateToString):e._type===pt.UNARY?e._value==="!"?e.evaluate=e._evaluateNot:e._value==="-"?e.evaluate=e._evaluateNegative:e._value==="+"?e.evaluate=e._evaluatePositive:e._value==="isNaN"?e.evaluate=e._evaluateNaN:e._value==="isFinite"?e.evaluate=e._evaluateIsFinite:e._value==="isExactClass"?e.evaluate=e._evaluateIsExactClass:e._value==="isClass"?e.evaluate=e._evaluateIsClass:e._value==="getExactClassName"?e.evaluate=e._evaluateGetExactClassName:e._value==="Boolean"?e.evaluate=e._evaluateBooleanConversion:e._value==="Number"?e.evaluate=e._evaluateNumberConversion:e._value==="String"?e.evaluate=e._evaluateStringConversion:u(QL[e._value])&&(e.evaluate=LBe(e._value)):e._type===pt.BINARY?e._value==="+"?e.evaluate=e._evaluatePlus:e._value==="-"?e.evaluate=e._evaluateMinus:e._value==="*"?e.evaluate=e._evaluateTimes:e._value==="/"?e.evaluate=e._evaluateDivide:e._value==="%"?e.evaluate=e._evaluateMod:e._value==="==="?e.evaluate=e._evaluateEqualsStrict:e._value==="!=="?e.evaluate=e._evaluateNotEqualsStrict:e._value==="<"?e.evaluate=e._evaluateLessThan:e._value==="<="?e.evaluate=e._evaluateLessThanOrEquals:e._value===">"?e.evaluate=e._evaluateGreaterThan:e._value===">="?e.evaluate=e._evaluateGreaterThanOrEquals:e._value==="&&"?e.evaluate=e._evaluateAnd:e._value==="||"?e.evaluate=e._evaluateOr:e._value==="=~"?e.evaluate=e._evaluateRegExpMatch:e._value==="!~"?e.evaluate=e._evaluateRegExpNotMatch:u(JL[e._value])&&(e.evaluate=NBe(e._value)):e._type===pt.TERNARY?e.evaluate=FBe(e._value):e._type===pt.MEMBER?e._value==="brackets"?e.evaluate=e._evaluateMemberBrackets:e.evaluate=e._evaluateMemberDot:e._type===pt.ARRAY?e.evaluate=e._evaluateArray:e._type===pt.VARIABLE?e.evaluate=e._evaluateVariable:e._type===pt.VARIABLE_IN_STRING?e.evaluate=e._evaluateVariableString:e._type===pt.LITERAL_COLOR?e.evaluate=e._evaluateLiteralColor:e._type===pt.LITERAL_VECTOR?e.evaluate=e._evaluateLiteralVector:e._type===pt.LITERAL_STRING?e.evaluate=e._evaluateLiteralString:e._type===pt.REGEX?e.evaluate=e._evaluateRegExp:e._type===pt.BUILTIN_VARIABLE?e._value==="tiles3d_tileset_time"&&(e.evaluate=MBe):e.evaluate=e._evaluateLiteral}function MBe(e){return u(e)?e.content.tileset.timeSinceLoad:0}function LBe(e){let t=QL[e];return function(n){let i=this._left.evaluate(n);return t(e,i)}}function NBe(e){let t=JL[e];return function(n){let i=this._left.evaluate(n),o=this._right.evaluate(n);return t(e,i,o)}}function FBe(e){let t=Q9[e];return function(n){let i=this._left.evaluate(n),o=this._right.evaluate(n),r=this._test.evaluate(n);return t(e,i,o,r)}}function eN(e,t){if(u(e))return e.getPropertyInherited(t)}Ct.prototype._evaluateLiteral=function(){return this._value};Ct.prototype._evaluateLiteralColor=function(e){let t=$L,n=this._left;if(this._value==="color")u(n)?n.length>1?(G.fromCssColorString(n[0].evaluate(e),t),t.alpha=n[1].evaluate(e)):G.fromCssColorString(n[0].evaluate(e),t):G.fromBytes(255,255,255,255,t);else if(this._value==="rgb")G.fromBytes(n[0].evaluate(e),n[1].evaluate(e),n[2].evaluate(e),255,t);else if(this._value==="rgba"){let i=n[3].evaluate(e)*255;G.fromBytes(n[0].evaluate(e),n[1].evaluate(e),n[2].evaluate(e),i,t)}else this._value==="hsl"?G.fromHsl(n[0].evaluate(e),n[1].evaluate(e),n[2].evaluate(e),1,t):this._value==="hsla"&&G.fromHsl(n[0].evaluate(e),n[1].evaluate(e),n[2].evaluate(e),n[3].evaluate(e),t);return oe.fromColor(t,Pn.getCartesian4())};Ct.prototype._evaluateLiteralVector=function(e){let t=Pn.getArray(),n=this._value,i=this._left,o=i.length;for(let a=0;a<o;++a){let c=i[a].evaluate(e);if(typeof c=="number")t.push(c);else if(c instanceof H)t.push(c.x,c.y);else if(c instanceof h)t.push(c.x,c.y,c.z);else if(c instanceof oe)t.push(c.x,c.y,c.z,c.w);else throw new ce(`${n} argument must be a vector or number. Argument is ${c}.`)}let r=t.length,s=parseInt(n.charAt(3));if(r===0)throw new ce(`Invalid ${n} constructor. No valid arguments.`);if(r<s&&r>1)throw new ce(`Invalid ${n} constructor. Not enough arguments.`);if(r>s&&o>1)throw new ce(`Invalid ${n} constructor. Too many arguments.`);if(r===1){let a=t[0];t.push(a,a,a)}if(n==="vec2")return H.fromArray(t,0,Pn.getCartesian2());if(n==="vec3")return h.fromArray(t,0,Pn.getCartesian3());if(n==="vec4")return oe.fromArray(t,0,Pn.getCartesian4())};Ct.prototype._evaluateLiteralString=function(){return this._value};Ct.prototype._evaluateVariableString=function(e){let t=this._value,n=ZL.exec(t);for(;n!==null;){let i=n[0],o=n[1],r=eN(e,o);u(r)||(r=""),t=t.replace(i,r),n=ZL.exec(t)}return t};Ct.prototype._evaluateVariable=function(e){return eN(e,this._value)};function $y(e){return e._value==="feature"}Ct.prototype._evaluateMemberDot=function(e){if($y(this._left))return eN(e,this._right.evaluate(e));let t=this._left.evaluate(e);if(!u(t))return;let n=this._right.evaluate(e);if(t instanceof H||t instanceof h||t instanceof oe){if(n==="r")return t.x;if(n==="g")return t.y;if(n==="b")return t.z;if(n==="a")return t.w}return t[n]};Ct.prototype._evaluateMemberBrackets=function(e){if($y(this._left))return eN(e,this._right.evaluate(e));let t=this._left.evaluate(e);if(!u(t))return;let n=this._right.evaluate(e);if(t instanceof H||t instanceof h||t instanceof oe){if(n===0||n==="r")return t.x;if(n===1||n==="g")return t.y;if(n===2||n==="b")return t.z;if(n===3||n==="a")return t.w}return t[n]};Ct.prototype._evaluateArray=function(e){let t=[];for(let n=0;n<this._value.length;n++)t[n]=this._value[n].evaluate(e);return t};Ct.prototype._evaluateNot=function(e){let t=this._left.evaluate(e);if(typeof t!="boolean")throw new ce(`Operator "!" requires a boolean argument. Argument is ${t}.`);return!t};Ct.prototype._evaluateNegative=function(e){let t=this._left.evaluate(e);if(t instanceof H)return H.negate(t,Pn.getCartesian2());if(t instanceof h)return h.negate(t,Pn.getCartesian3());if(t instanceof oe)return oe.negate(t,Pn.getCartesian4());if(typeof t=="number")return-t;throw new ce(`Operator "-" requires a vector or number argument. Argument is ${t}.`)};Ct.prototype._evaluatePositive=function(e){let t=this._left.evaluate(e);if(!(t instanceof H||t instanceof h||t instanceof oe||typeof t=="number"))throw new ce(`Operator "+" requires a vector or number argument. Argument is ${t}.`);return t};Ct.prototype._evaluateLessThan=function(e){let t=this._left.evaluate(e),n=this._right.evaluate(e);if(typeof t!="number"||typeof n!="number")throw new ce(`Operator "<" requires number arguments. Arguments are ${t} and ${n}.`);return t<n};Ct.prototype._evaluateLessThanOrEquals=function(e){let t=this._left.evaluate(e),n=this._right.evaluate(e);if(typeof t!="number"||typeof n!="number")throw new ce(`Operator "<=" requires number arguments. Arguments are ${t} and ${n}.`);return t<=n};Ct.prototype._evaluateGreaterThan=function(e){let t=this._left.evaluate(e),n=this._right.evaluate(e);if(typeof t!="number"||typeof n!="number")throw new ce(`Operator ">" requires number arguments. Arguments are ${t} and ${n}.`);return t>n};Ct.prototype._evaluateGreaterThanOrEquals=function(e){let t=this._left.evaluate(e),n=this._right.evaluate(e);if(typeof t!="number"||typeof n!="number")throw new ce(`Operator ">=" requires number arguments. Arguments are ${t} and ${n}.`);return t>=n};Ct.prototype._evaluateOr=function(e){let t=this._left.evaluate(e);if(typeof t!="boolean")throw new ce(`Operator "||" requires boolean arguments. First argument is ${t}.`);if(t)return!0;let n=this._right.evaluate(e);if(typeof n!="boolean")throw new ce(`Operator "||" requires boolean arguments. Second argument is ${n}.`);return t||n};Ct.prototype._evaluateAnd=function(e){let t=this._left.evaluate(e);if(typeof t!="boolean")throw new ce(`Operator "&&" requires boolean arguments. First argument is ${t}.`);if(!t)return!1;let n=this._right.evaluate(e);if(typeof n!="boolean")throw new ce(`Operator "&&" requires boolean arguments. Second argument is ${n}.`);return t&&n};Ct.prototype._evaluatePlus=function(e){let t=this._left.evaluate(e),n=this._right.evaluate(e);if(n instanceof H&&t instanceof H)return H.add(t,n,Pn.getCartesian2());if(n instanceof h&&t instanceof h)return h.add(t,n,Pn.getCartesian3());if(n instanceof oe&&t instanceof oe)return oe.add(t,n,Pn.getCartesian4());if(typeof t=="string"||typeof n=="string")return t+n;if(typeof t=="number"&&typeof n=="number")return t+n;throw new ce(`Operator "+" requires vector or number arguments of matching types, or at least one string argument. Arguments are ${t} and ${n}.`)};Ct.prototype._evaluateMinus=function(e){let t=this._left.evaluate(e),n=this._right.evaluate(e);if(n instanceof H&&t instanceof H)return H.subtract(t,n,Pn.getCartesian2());if(n instanceof h&&t instanceof h)return h.subtract(t,n,Pn.getCartesian3());if(n instanceof oe&&t instanceof oe)return oe.subtract(t,n,Pn.getCartesian4());if(typeof t=="number"&&typeof n=="number")return t-n;throw new ce(`Operator "-" requires vector or number arguments of matching types. Arguments are ${t} and ${n}.`)};Ct.prototype._evaluateTimes=function(e){let t=this._left.evaluate(e),n=this._right.evaluate(e);if(n instanceof H&&t instanceof H)return H.multiplyComponents(t,n,Pn.getCartesian2());if(n instanceof H&&typeof t=="number")return H.multiplyByScalar(n,t,Pn.getCartesian2());if(t instanceof H&&typeof n=="number")return H.multiplyByScalar(t,n,Pn.getCartesian2());if(n instanceof h&&t instanceof h)return h.multiplyComponents(t,n,Pn.getCartesian3());if(n instanceof h&&typeof t=="number")return h.multiplyByScalar(n,t,Pn.getCartesian3());if(t instanceof h&&typeof n=="number")return h.multiplyByScalar(t,n,Pn.getCartesian3());if(n instanceof oe&&t instanceof oe)return oe.multiplyComponents(t,n,Pn.getCartesian4());if(n instanceof oe&&typeof t=="number")return oe.multiplyByScalar(n,t,Pn.getCartesian4());if(t instanceof oe&&typeof n=="number")return oe.multiplyByScalar(t,n,Pn.getCartesian4());if(typeof t=="number"&&typeof n=="number")return t*n;throw new ce(`Operator "*" requires vector or number arguments. If both arguments are vectors they must be matching types. Arguments are ${t} and ${n}.`)};Ct.prototype._evaluateDivide=function(e){let t=this._left.evaluate(e),n=this._right.evaluate(e);if(n instanceof H&&t instanceof H)return H.divideComponents(t,n,Pn.getCartesian2());if(t instanceof H&&typeof n=="number")return H.divideByScalar(t,n,Pn.getCartesian2());if(n instanceof h&&t instanceof h)return h.divideComponents(t,n,Pn.getCartesian3());if(t instanceof h&&typeof n=="number")return h.divideByScalar(t,n,Pn.getCartesian3());if(n instanceof oe&&t instanceof oe)return oe.divideComponents(t,n,Pn.getCartesian4());if(t instanceof oe&&typeof n=="number")return oe.divideByScalar(t,n,Pn.getCartesian4());if(typeof t=="number"&&typeof n=="number")return t/n;throw new ce(`Operator "/" requires vector or number arguments of matching types, or a number as the second argument. Arguments are ${t} and ${n}.`)};Ct.prototype._evaluateMod=function(e){let t=this._left.evaluate(e),n=this._right.evaluate(e);if(n instanceof H&&t instanceof H)return H.fromElements(t.x%n.x,t.y%n.y,Pn.getCartesian2());if(n instanceof h&&t instanceof h)return h.fromElements(t.x%n.x,t.y%n.y,t.z%n.z,Pn.getCartesian3());if(n instanceof oe&&t instanceof oe)return oe.fromElements(t.x%n.x,t.y%n.y,t.z%n.z,t.w%n.w,Pn.getCartesian4());if(typeof t=="number"&&typeof n=="number")return t%n;throw new ce(`Operator "%" requires vector or number arguments of matching types. Arguments are ${t} and ${n}.`)};Ct.prototype._evaluateEqualsStrict=function(e){let t=this._left.evaluate(e),n=this._right.evaluate(e);return n instanceof H&&t instanceof H||n instanceof h&&t instanceof h||n instanceof oe&&t instanceof oe?t.equals(n):t===n};Ct.prototype._evaluateNotEqualsStrict=function(e){let t=this._left.evaluate(e),n=this._right.evaluate(e);return n instanceof H&&t instanceof H||n instanceof h&&t instanceof h||n instanceof oe&&t instanceof oe?!t.equals(n):t!==n};Ct.prototype._evaluateConditional=function(e){let t=this._test.evaluate(e);if(typeof t!="boolean")throw new ce(`Conditional argument of conditional expression must be a boolean. Argument is ${t}.`);return t?this._left.evaluate(e):this._right.evaluate(e)};Ct.prototype._evaluateNaN=function(e){return isNaN(this._left.evaluate(e))};Ct.prototype._evaluateIsFinite=function(e){return isFinite(this._left.evaluate(e))};Ct.prototype._evaluateIsExactClass=function(e){return u(e)?e.isExactClass(this._left.evaluate(e)):!1};Ct.prototype._evaluateIsClass=function(e){return u(e)?e.isClass(this._left.evaluate(e)):!1};Ct.prototype._evaluateGetExactClassName=function(e){if(u(e))return e.getExactClassName()};Ct.prototype._evaluateBooleanConversion=function(e){return!!this._left.evaluate(e)};Ct.prototype._evaluateNumberConversion=function(e){return Number(this._left.evaluate(e))};Ct.prototype._evaluateStringConversion=function(e){return String(this._left.evaluate(e))};Ct.prototype._evaluateRegExp=function(e){let t=this._value.evaluate(e),n="";u(this._left)&&(n=this._left.evaluate(e));let i;try{i=new RegExp(t,n)}catch(o){throw new ce(o)}return i};Ct.prototype._evaluateRegExpTest=function(e){let t=this._left.evaluate(e),n=this._right.evaluate(e);if(!(t instanceof RegExp&&typeof n=="string"))throw new ce(`RegExp.test requires the first argument to be a RegExp and the second argument to be a string. Arguments are ${t} and ${n}.`);return t.test(n)};Ct.prototype._evaluateRegExpMatch=function(e){let t=this._left.evaluate(e),n=this._right.evaluate(e);if(t instanceof RegExp&&typeof n=="string")return t.test(n);if(n instanceof RegExp&&typeof t=="string")return n.test(t);throw new ce(`Operator "=~" requires one RegExp argument and one string argument. Arguments are ${t} and ${n}.`)};Ct.prototype._evaluateRegExpNotMatch=function(e){let t=this._left.evaluate(e),n=this._right.evaluate(e);if(t instanceof RegExp&&typeof n=="string")return!t.test(n);if(n instanceof RegExp&&typeof t=="string")return!n.test(t);throw new ce(`Operator "!~" requires one RegExp argument and one string argument. Arguments are ${t} and ${n}.`)};Ct.prototype._evaluateRegExpExec=function(e){let t=this._left.evaluate(e),n=this._right.evaluate(e);if(!(t instanceof RegExp&&typeof n=="string"))throw new ce(`RegExp.exec requires the first argument to be a RegExp and the second argument to be a string. Arguments are ${t} and ${n}.`);let i=t.exec(n);return u(i)?i[1]:null};Ct.prototype._evaluateToString=function(e){let t=this._left.evaluate(e);if(t instanceof RegExp||t instanceof H||t instanceof h||t instanceof oe)return String(t);throw new ce(`Unexpected function call "${this._value}".`)};function Cie(e){let t=e._left,n=t.length;for(let a=0;a<n;++a)if(t[a]._type!==pt.LITERAL_NUMBER)return;let i=t[0]._value,o=t[1]._value,r=t[2]._value,s=n===4?t[3]._value:1;return G.fromHsl(i,o,r,s,$L)}function Aie(e){let t=e._left,n=t.length;for(let o=0;o<n;++o)if(t[o]._type!==pt.LITERAL_NUMBER)return;let i=$L;return i.red=t[0]._value/255,i.green=t[1]._value/255,i.blue=t[2]._value/255,i.alpha=n===4?t[3]._value:1,i}function og(e){return e%1===0?e.toFixed(1):e.toString()}function BBe(e){let t=og(e.red),n=og(e.green),i=og(e.blue);return`vec3(${t}, ${n}, ${i})`}function KL(e){let t=og(e.red),n=og(e.green),i=og(e.blue),o=og(e.alpha);return`vec4(${t}, ${n}, ${i}, ${o})`}function Tie(e,t,n,i){let o=e.length,r=new Array(o);for(let s=0;s<o;++s)r[s]=e[s].getShaderExpression(t,n,i);return r}function Eie(e,t){return u(t[e])?t[e]:pd.NULL_SENTINEL}pd.NULL_SENTINEL="czm_infinity";Ct.prototype.getShaderExpression=function(e,t,n){let i,o,r,s,a=this._type,c=this._value;u(this._left)&&(Array.isArray(this._left)?o=Tie(this._left,e,t,this):o=this._left.getShaderExpression(e,t,this)),u(this._right)&&(r=this._right.getShaderExpression(e,t,this)),u(this._test)&&(s=this._test.getShaderExpression(e,t,this)),Array.isArray(this._value)&&(c=Tie(this._value,e,t,this));let l,f,d;switch(a){case pt.VARIABLE:return $y(this)?void 0:Eie(c,e);case pt.UNARY:if(c==="Boolean")return`bool(${o})`;if(c==="Number")return`float(${o})`;if(c==="round")return`floor(${o} + 0.5)`;if(u(QL[c]))return`${c}(${o})`;if(c==="isNaN")return`(${o} != ${o})`;if(c==="isFinite")return`(abs(${o}) < czm_infinity)`;if(c==="String"||c==="isExactClass"||c==="isClass"||c==="getExactClassName")throw new ce(`Error generating style shader: "${c}" is not supported.`);return c+o;case pt.BINARY:return c==="%"?`mod(${o}, ${r})`:c==="==="?`(${o} == ${r})`:c==="!=="?`(${o} != ${r})`:c==="atan2"?`atan(${o}, ${r})`:u(JL[c])?`${c}(${o}, ${r})`:`(${o} ${c} ${r})`;case pt.TERNARY:if(u(Q9[c]))return`${c}(${o}, ${r}, ${s})`;break;case pt.CONDITIONAL:return`(${s} ? ${o} : ${r})`;case pt.MEMBER:return $y(this._left)?Eie(r,e):r==="r"||r==="x"||r==="0.0"?`${o}[0]`:r==="g"||r==="y"||r==="1.0"?`${o}[1]`:r==="b"||r==="z"||r==="2.0"?`${o}[2]`:r==="a"||r==="w"||r==="3.0"?`${o}[3]`:`${o}[int(${r})]`;case pt.FUNCTION_CALL:throw new ce(`Error generating style shader: "${c}" is not supported.`);case pt.ARRAY:if(c.length===4)return`vec4(${c[0]}, ${c[1]}, ${c[2]}, ${c[3]})`;if(c.length===3)return`vec3(${c[0]}, ${c[1]}, ${c[2]})`;if(c.length===2)return`vec2(${c[0]}, ${c[1]})`;throw new ce("Error generating style shader: Invalid array length. Array length should be 2, 3, or 4.");case pt.REGEX:throw new ce("Error generating style shader: Regular expressions are not supported.");case pt.VARIABLE_IN_STRING:throw new ce("Error generating style shader: Converting a variable to a string is not supported.");case pt.LITERAL_NULL:return pd.NULL_SENTINEL;case pt.LITERAL_BOOLEAN:return c?"true":"false";case pt.LITERAL_NUMBER:return og(c);case pt.LITERAL_STRING:if(u(n)&&n._type===pt.MEMBER&&(c==="r"||c==="g"||c==="b"||c==="a"||c==="x"||c==="y"||c==="z"||c==="w"||$y(n._left)))return c;if(i=G.fromCssColorString(c,$L),u(i))return BBe(i);throw new ce("Error generating style shader: String literals are not supported.");case pt.LITERAL_COLOR:if(l=o,c==="color"){if(u(l)){if(l.length>1){let p=l[0],g=l[1];return g!=="1.0"&&(t.translucent=!0),`vec4(${p}, ${g})`}}else return"vec4(1.0)";return`vec4(${l[0]}, 1.0)`}else{if(c==="rgb")return i=Aie(this),u(i)?KL(i):`vec4(${l[0]} / 255.0, ${l[1]} / 255.0, ${l[2]} / 255.0, 1.0)`;if(c==="rgba")return l[3]!=="1.0"&&(t.translucent=!0),i=Aie(this),u(i)?KL(i):`vec4(${l[0]} / 255.0, ${l[1]} / 255.0, ${l[2]} / 255.0, ${l[3]})`;if(c==="hsl")return i=Cie(this),u(i)?KL(i):`vec4(czm_HSLToRGB(vec3(${l[0]}, ${l[1]}, ${l[2]})), 1.0)`;if(c==="hsla")return i=Cie(this),u(i)?(i.alpha!==1&&(t.translucent=!0),KL(i)):(l[3]!=="1.0"&&(t.translucent=!0),`vec4(czm_HSLToRGB(vec3(${l[0]}, ${l[1]}, ${l[2]})), ${l[3]})`)}break;case pt.LITERAL_VECTOR:f=o.length,d=`${c}(`;for(let p=0;p<f;++p)d+=o[p],p<f-1&&(d+=", ");return d+=")",d;case pt.LITERAL_REGEX:throw new ce("Error generating style shader: Regular expressions are not supported.");case pt.LITERAL_UNDEFINED:return pd.NULL_SENTINEL;case pt.BUILTIN_VARIABLE:if(c==="tiles3d_tileset_time")return c}};Ct.prototype.getVariables=function(e,t){let n,i,o,r=this._type,s=this._value;if(u(this._left))if(Array.isArray(this._left))for(n=this._left,i=n.length,o=0;o<i;++o)n[o].getVariables(e,this);else this._left.getVariables(e,this);if(u(this._right)&&this._right.getVariables(e,this),u(this._test)&&this._test.getVariables(e,this),Array.isArray(this._value))for(n=this._value,i=n.length,o=0;o<i;++o)n[o].getVariables(e,this);let a;switch(r){case pt.VARIABLE:$y(this)||e.push(s);break;case pt.VARIABLE_IN_STRING:for(a=ZL.exec(s);a!==null;)e.push(a[1]),a=ZL.exec(s);break;case pt.LITERAL_STRING:u(t)&&t._type===pt.MEMBER&&$y(t._left)&&e.push(s);break}};var _d=pd;function pp(e){e=x(e,x.EMPTY_OBJECT),this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._positions=e.positions,this._vertexBatchIds=e.vertexBatchIds,this._indices=e.indices,this._indexCounts=e.indexCounts,this._indexOffsets=e.indexOffsets,this._batchedIndices=e.batchedIndices,this._boundingVolume=e.boundingVolume,this._boundingVolumes=e.boundingVolumes,this._center=x(e.center,h.ZERO),this._va=void 0,this._sp=void 0,this._spStencil=void 0,this._spPick=void 0,this._uniformMap=void 0,this._vaSwap=void 0,this._rsStencilDepthPass=void 0,this._rsStencilDepthPass3DTiles=void 0,this._rsColorPass=void 0,this._rsPickPass=void 0,this._rsWireframe=void 0,this._commands=[],this._commandsIgnoreShow=[],this._pickCommands=[],this._constantColor=G.clone(G.WHITE),this._highlightColor=this._constantColor,this._batchDirty=!0,this._pickCommandsDirty=!0,this._framesSinceLastRebatch=0,this._updatingAllCommands=!1,this._trianglesLength=this._indices.length/3,this._geometryByteLength=this._indices.byteLength+this._positions.byteLength+this._vertexBatchIds.byteLength,this.debugWireframe=!1,this._debugWireframe=this.debugWireframe,this._wireframeDirty=!1,this.forceRebatch=!1,this.classificationType=x(e.classificationType,Vn.BOTH),this._vertexShaderSource=e._vertexShaderSource,this._fragmentShaderSource=e._fragmentShaderSource,this._attributeLocations=e._attributeLocations,this._uniformMap=e._uniformMap,this._pickId=e._pickId,this._modelMatrix=e._modelMatrix,this._boundingSphere=e._boundingSphere,this._batchIdLookUp={};let t=this._batchIds.length;for(let n=0;n<t;++n){let i=this._batchIds[n];this._batchIdLookUp[i]=n}}Object.defineProperties(pp.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}}});var kBe={position:0,a_batchId:1};function VBe(e,t){if(u(e._va))return;let n=xt.createVertexBuffer({context:t,typedArray:e._positions,usage:ke.STATIC_DRAW}),i=xt.createVertexBuffer({context:t,typedArray:e._vertexBatchIds,usage:ke.STATIC_DRAW}),o=xt.createIndexBuffer({context:t,typedArray:e._indices,usage:ke.DYNAMIC_DRAW,indexDatatype:e._indices.BYTES_PER_ELEMENT===2?Be.UNSIGNED_SHORT:Be.UNSIGNED_INT}),r=[{index:0,vertexBuffer:n,componentDatatype:K.fromTypedArray(e._positions),componentsPerAttribute:3},{index:1,vertexBuffer:i,componentDatatype:K.fromTypedArray(e._vertexBatchIds),componentsPerAttribute:1}];e._va=new ii({context:t,attributes:r,indexBuffer:o}),t.webgl2&&(e._vaSwap=new ii({context:t,attributes:r,indexBuffer:xt.createIndexBuffer({context:t,sizeInBytes:o.sizeInBytes,usage:ke.DYNAMIC_DRAW,indexDatatype:o.indexDatatype})})),e._batchedPositions=void 0,e._transferrableBatchIds=void 0,e._vertexBatchIds=void 0}function UBe(e,t){if(u(e._sp))return;let n=e._batchTable,i=x(e._attributeLocations,kBe),o=e._pickId,r=e._vertexShaderSource,s=e._fragmentShaderSource;if(u(r)){e._sp=tn.fromCache({context:t,vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:i}),e._spStencil=e._sp,s=ze.replaceMain(s,"czm_non_pick_main"),s=`${s}void main() 
{ 
    czm_non_pick_main(); 
    out_FragColor = ${o}; 
} 
`,e._spPick=tn.fromCache({context:t,vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:i});return}let a=n.getVertexShaderCallback(!1,"a_batchId",void 0)(Vv),c=n.getFragmentShaderCallback(!1,void 0,!0)(Uy);o=n.getPickId();let l=new ze({sources:[a]}),f=new ze({defines:["VECTOR_TILE"],sources:[c]});e._sp=tn.fromCache({context:t,vertexShaderSource:l,fragmentShaderSource:f,attributeLocations:i}),l=new ze({sources:[Vv]}),f=new ze({defines:["VECTOR_TILE"],sources:[Uy]}),e._spStencil=tn.fromCache({context:t,vertexShaderSource:l,fragmentShaderSource:f,attributeLocations:i}),c=ze.replaceMain(c,"czm_non_pick_main"),c=`${c}
void main() 
{ 
    czm_non_pick_main(); 
    out_FragColor = ${o}; 
} 
`;let d=new ze({sources:[a]}),p=new ze({defines:["VECTOR_TILE"],sources:[c]});e._spPick=tn.fromCache({context:t,vertexShaderSource:d,fragmentShaderSource:p,attributeLocations:i})}function Sie(e){let t=e?Un.EQUAL:Un.ALWAYS;return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:!0,frontFunction:t,frontOperation:{fail:mt.KEEP,zFail:mt.DECREMENT_WRAP,zPass:mt.KEEP},backFunction:t,backOperation:{fail:mt.KEEP,zFail:mt.INCREMENT_WRAP,zPass:mt.KEEP},reference:Ut.CESIUM_3D_TILE_MASK,mask:Ut.CESIUM_3D_TILE_MASK},stencilMask:Ut.CLASSIFICATION_MASK,depthTest:{enabled:!0,func:wc.LESS_OR_EQUAL},depthMask:!1}}var zBe={stencilTest:{enabled:!0,frontFunction:Un.NOT_EQUAL,frontOperation:{fail:mt.ZERO,zFail:mt.ZERO,zPass:mt.ZERO},backFunction:Un.NOT_EQUAL,backOperation:{fail:mt.ZERO,zFail:mt.ZERO,zPass:mt.ZERO},reference:0,mask:Ut.CLASSIFICATION_MASK},stencilMask:Ut.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1,blending:un.PRE_MULTIPLIED_ALPHA_BLEND},HBe={stencilTest:{enabled:!0,frontFunction:Un.NOT_EQUAL,frontOperation:{fail:mt.ZERO,zFail:mt.ZERO,zPass:mt.ZERO},backFunction:Un.NOT_EQUAL,backOperation:{fail:mt.ZERO,zFail:mt.ZERO,zPass:mt.ZERO},reference:0,mask:Ut.CLASSIFICATION_MASK},stencilMask:Ut.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1};function GBe(e){u(e._rsStencilDepthPass)||(e._rsStencilDepthPass=Ue.fromCache(Sie(!1)),e._rsStencilDepthPass3DTiles=Ue.fromCache(Sie(!0)),e._rsColorPass=Ue.fromCache(zBe),e._rsPickPass=Ue.fromCache(HBe))}var Qy=new F,vie=new h;function WBe(e,t){if(u(e._uniformMap))return;let n={u_modifiedModelViewProjection:function(){let i=t.uniformState.view,o=t.uniformState.projection;return F.clone(i,Qy),F.multiplyByPoint(Qy,e._center,vie),F.setTranslation(Qy,vie,Qy),F.multiply(o,Qy,Qy),Qy},u_highlightColor:function(){return e._highlightColor}};e._uniformMap=e._batchTable.getUniformMapCallback()(n)}function J9(e,t,n,i,o,r,s){let a=e.constructor.BYTES_PER_ELEMENT,c=r.length;for(let l=0;l<c;++l){let f=r[l],d=s[f],p=i[d],g=o[d],m=new e.constructor(e.buffer,a*p,g);t.set(m,n),i[d]=n,n+=g}return n}function jBe(e,t){let n=e._indices,i=e._indexOffsets,o=e._indexCounts,r=e._batchIdLookUp,s=new n.constructor(n.length),a=t.pop(),c=[a],l=J9(n,s,0,i,o,a.batchIds,r);for(a.offset=0,a.count=l;t.length>0;){let f=t.pop();if(G.equals(f.color,a.color))l=J9(n,s,l,i,o,f.batchIds,r),a.batchIds=a.batchIds.concat(f.batchIds),a.count=l-a.offset;else{let d=l;l=J9(n,s,l,i,o,f.batchIds,r),f.offset=d,f.count=l-d,c.push(f),a=f}}e._va.indexBuffer.copyFromArrayView(s),e._indices=s,e._batchedIndices=c}function eW(e,t,n,i,o,r,s){let a=e.bytesPerIndex,c=r.length;for(let l=0;l<c;++l){let f=r[l],d=s[f],p=i[d],g=o[d];t.copyFromBuffer(e,p*a,n*a,g*a),i[d]=n,n+=g}return n}function qBe(e,t){let n=e._indexOffsets,i=e._indexCounts,o=e._batchIdLookUp,r=t.pop(),s=[r],a=e._va.indexBuffer,c=e._vaSwap.indexBuffer,l=eW(a,c,0,n,i,r.batchIds,o);for(r.offset=0,r.count=l;t.length>0;){let d=t.pop();if(G.equals(d.color,r.color))l=eW(a,c,l,n,i,d.batchIds,o),r.batchIds=r.batchIds.concat(d.batchIds),r.count=l-r.offset;else{let p=l;l=eW(a,c,l,n,i,d.batchIds,o),d.offset=p,d.count=l-p,s.push(d),r=d}}let f=e._va;e._va=e._vaSwap,e._vaSwap=f,e._batchedIndices=s}function YBe(e,t){return t.color.toRgba()-e.color.toRgba()}function XBe(e,t){if(!e._batchDirty)return!1;let n=e._batchedIndices,i=n.length,o=!1,r={};for(let s=0;s<i;++s){let c=n[s].color.toRgba();if(u(r[c])){o=!0;break}else r[c]=!0}if(!o)return e._batchDirty=!1,!1;if(o&&!e.forceRebatch&&e._framesSinceLastRebatch<120){++e._framesSinceLastRebatch;return}return n.sort(YBe),t.webgl2?qBe(e,n):jBe(e,n),e._framesSinceLastRebatch=0,e._batchDirty=!1,e._pickCommandsDirty=!0,e._wireframeDirty=!0,!0}function KBe(e,t){let n=XBe(e,t),i=e._commands,o=e._batchedIndices,r=o.length,s=r*2;if(u(i)&&!n&&i.length===s)return;i.length=s;let a=e._va,c=e._sp,l=x(e._modelMatrix,F.IDENTITY),f=e._uniformMap,d=e._boundingVolume;for(let p=0;p<r;++p){let g=o[p].offset,m=o[p].count,y=i[p*2];u(y)||(y=i[p*2]=new Qe({owner:e})),y.vertexArray=a,y.modelMatrix=l,y.offset=g,y.count=m,y.renderState=e._rsStencilDepthPass,y.shaderProgram=c,y.uniformMap=f,y.boundingVolume=d,y.cull=!1,y.pass=we.TERRAIN_CLASSIFICATION;let b=Qe.shallowClone(y,y.derivedCommands.tileset);b.renderState=e._rsStencilDepthPass3DTiles,b.pass=we.CESIUM_3D_TILE_CLASSIFICATION,y.derivedCommands.tileset=b;let C=i[p*2+1];u(C)||(C=i[p*2+1]=new Qe({owner:e})),C.vertexArray=a,C.modelMatrix=l,C.offset=g,C.count=m,C.renderState=e._rsColorPass,C.shaderProgram=c,C.uniformMap=f,C.boundingVolume=d,C.cull=!1,C.pass=we.TERRAIN_CLASSIFICATION;let A=Qe.shallowClone(C,C.derivedCommands.tileset);A.pass=we.CESIUM_3D_TILE_CLASSIFICATION,C.derivedCommands.tileset=A}e._commandsDirty=!0}function ZBe(e,t){if(e.classificationType===Vn.TERRAIN||!t.invertClassification||u(e._commandsIgnoreShow)&&!e._commandsDirty)return;let n=e._commands,i=e._commandsIgnoreShow,o=e._spStencil,r=n.length,s=i.length=r/2,a=0;for(let c=0;c<s;++c){let l=i[c]=Qe.shallowClone(n[a],i[c]);l.shaderProgram=o,l.pass=we.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,a+=2}e._commandsDirty=!1}function $Be(e){if(!e._pickCommandsDirty)return;let t=e._indexOffsets.length,n=e._pickCommands;n.length=t*2;let i=e._va,o=e._spStencil,r=e._spPick,s=x(e._modelMatrix,F.IDENTITY),a=e._uniformMap;for(let c=0;c<t;++c){let l=e._indexOffsets[c],f=e._indexCounts[c],d=u(e._boundingVolumes)?e._boundingVolumes[c]:e.boundingVolume,p=n[c*2];u(p)||(p=n[c*2]=new Qe({owner:e,pickOnly:!0})),p.vertexArray=i,p.modelMatrix=s,p.offset=l,p.count=f,p.renderState=e._rsStencilDepthPass,p.shaderProgram=o,p.uniformMap=a,p.boundingVolume=d,p.pass=we.TERRAIN_CLASSIFICATION;let g=Qe.shallowClone(p,p.derivedCommands.tileset);g.renderState=e._rsStencilDepthPass3DTiles,g.pass=we.CESIUM_3D_TILE_CLASSIFICATION,p.derivedCommands.tileset=g;let m=n[c*2+1];u(m)||(m=n[c*2+1]=new Qe({owner:e,pickOnly:!0})),m.vertexArray=i,m.modelMatrix=s,m.offset=l,m.count=f,m.renderState=e._rsPickPass,m.shaderProgram=r,m.uniformMap=a,m.boundingVolume=d,m.pass=we.TERRAIN_CLASSIFICATION;let y=Qe.shallowClone(m,m.derivedCommands.tileset);y.pass=we.CESIUM_3D_TILE_CLASSIFICATION,m.derivedCommands.tileset=y}e._pickCommandsDirty=!1}pp.prototype.createFeatures=function(e,t){let n=this._batchIds,i=n.length;for(let o=0;o<i;++o){let r=n[o];t[r]=new ta(e,r)}};pp.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:this._constantColor};function QBe(e,t){e._updatingAllCommands=!0;let n=e._batchIds,i=n.length,o;for(o=0;o<i;++o){let s=n[o],a=t[s];a.show=!0,a.color=G.WHITE}let r=e._batchedIndices;for(i=r.length,o=0;o<i;++o)r[o].color=G.clone(G.WHITE);e._updatingAllCommands=!1,e._batchDirty=!0}var JBe=new G,e3e=G.WHITE,t3e=!0,n3e=/\$/;pp.prototype.applyStyle=function(e,t){if(!u(e)){QBe(this,t);return}let n=e.color,i=n instanceof _d&&!n3e.test(n.expression);this._updatingAllCommands=i;let o=this._batchIds,r=o.length,s;for(s=0;s<r;++s){let a=o[s],c=t[a];c.color=u(e.color)?e.color.evaluateColor(c,JBe):e3e,c.show=u(e.show)?e.show.evaluate(c):t3e}if(i){let a=this._batchedIndices;for(r=a.length,s=0;s<r;++s)a[s].color=G.clone(G.WHITE);this._updatingAllCommands=!1,this._batchDirty=!0}};pp.prototype.updateCommands=function(e,t){if(this._updatingAllCommands)return;let n=this._batchIdLookUp,i=n[e];if(!u(i))return;let o=this._indexOffsets,r=this._indexCounts,s=o[i],a=r[i],c=this._batchedIndices,l=c.length,f;for(f=0;f<l;++f){let y=c[f].offset,b=c[f].count;if(s>=y&&s<y+b)break}c.push(new mp({color:G.clone(t),offset:s,count:a,batchIds:[e]}));let d=[],p=[],g=c[f].batchIds,m=g.length;for(let y=0;y<m;++y){let b=g[y];if(b===e)continue;let C=n[b];o[C]<s?d.push(b):p.push(b)}p.length!==0&&c.push(new mp({color:G.clone(c[f].color),offset:s+a,count:c[f].offset+c[f].count-(s+a),batchIds:p})),d.length!==0?(c[f].count=s-c[f].offset,c[f].batchIds=d):c.splice(f,1),this._batchDirty=!0};function wie(e,t,n,i){let o=e.classificationType,r=o!==Vn.CESIUM_3D_TILE,s=o!==Vn.TERRAIN,a=t.commandList,c=n.length,l,f;for(f=0;f<c;++f)r&&(l=n[f],l.pass=we.TERRAIN_CLASSIFICATION,a.push(l)),s&&(l=n[f].derivedCommands.tileset,l.pass=we.CESIUM_3D_TILE_CLASSIFICATION,a.push(l));if(!(!t.invertClassification||!u(i)))for(c=i.length,f=0;f<c;++f)a.push(i[f])}function i3e(e,t){let n=e.commandList,i=t.length;for(let o=0;o<i;o+=2){let r=t[o+1];r.pass=we.OPAQUE,n.push(r)}}function o3e(e){let t=e.debugWireframe===e._debugWireframe;if(t=t&&!(e.debugWireframe&&e._wireframeDirty),t)return;u(e._rsWireframe)||(e._rsWireframe=Ue.fromCache({}));let n,i;e.debugWireframe?(n=e._rsWireframe,i=Ne.LINES):(n=e._rsColorPass,i=Ne.TRIANGLES);let o=e._commands,r=o.length;for(let s=0;s<r;s+=2){let a=o[s+1];a.renderState=n,a.primitiveType=i}e._debugWireframe=e.debugWireframe,e._wireframeDirty=!1}pp.prototype.update=function(e){let t=e.context;VBe(this,t),UBe(this,t),GBe(this),WBe(this,t);let n=e.passes;n.render&&(KBe(this,t),ZBe(this,e),o3e(this),this._debugWireframe?i3e(e,this._commands):wie(this,e,this._commands,this._commandsIgnoreShow)),n.pick&&($Be(this),wie(this,e,this._pickCommands))};pp.prototype.isDestroyed=function(){return!1};pp.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaSwap=this._vaSwap&&this._vaSwap.destroy(),ue(this)};var rA=pp;function iu(e){this._boxes=e.boxes,this._boxBatchIds=e.boxBatchIds,this._cylinders=e.cylinders,this._cylinderBatchIds=e.cylinderBatchIds,this._ellipsoids=e.ellipsoids,this._ellipsoidBatchIds=e.ellipsoidBatchIds,this._spheres=e.spheres,this._sphereBatchIds=e.sphereBatchIds,this._modelMatrix=e.modelMatrix,this._batchTable=e.batchTable,this._boundingVolume=e.boundingVolume,this._center=e.center,u(this._center)||(u(this._boundingVolume)?this._center=h.clone(this._boundingVolume.center):this._center=h.clone(h.ZERO)),this._boundingVolumes=void 0,this._batchedIndices=void 0,this._indices=void 0,this._indexOffsets=void 0,this._indexCounts=void 0,this._positions=void 0,this._vertexBatchIds=void 0,this._batchIds=void 0,this._batchTableColors=void 0,this._packedBuffer=void 0,this._ready=!1,this._promise=void 0,this._error=void 0,this._verticesPromise=void 0,this._primitive=void 0,this.debugWireframe=!1,this.forceRebatch=!1,this.classificationType=Vn.BOTH}Object.defineProperties(iu.prototype,{trianglesLength:{get:function(){return u(this._primitive)?this._primitive.trianglesLength:0}},geometryByteLength:{get:function(){return u(this._primitive)?this._primitive.geometryByteLength:0}},ready:{get:function(){return this._ready}}});iu.packedBoxLength=F.packedLength+h.packedLength;iu.packedCylinderLength=F.packedLength+2;iu.packedEllipsoidLength=F.packedLength+h.packedLength;iu.packedSphereLength=h.packedLength+1;function r3e(e){let t=new Float64Array(F.packedLength+h.packedLength),n=0;return h.pack(e._center,t,n),n+=h.packedLength,F.pack(e._modelMatrix,t,n),t}function s3e(e,t){let n=0,i=t[n++],o=t[n++],r=e._boundingVolumes=new Array(o);for(let c=0;c<o;++c)r[c]=ae.unpack(t,n),n+=ae.packedLength;let s=t[n++],a=e._batchedIndices=new Array(s);for(let c=0;c<s;++c){let l=G.unpack(t,n);n+=G.packedLength;let f=t[n++],d=t[n++],p=t[n++],g=new Array(p);for(let m=0;m<p;++m)g[m]=t[n++];a[c]=new mp({color:l,offset:f,count:d,batchIds:g})}return i}var a3e=new xi("createVectorTileGeometries",5),c3e=new G;function l3e(e){if(!u(e._primitive)&&!u(e._verticesPromise)){let t=e._boxes,n=e._boxBatchIds,i=e._cylinders,o=e._cylinderBatchIds,r=e._ellipsoids,s=e._ellipsoidBatchIds,a=e._spheres,c=e._sphereBatchIds,l=e._batchTableColors,f=e._packedBuffer;if(!u(l)){let m=0;u(e._boxes)&&(t=e._boxes=t.slice(),n=e._boxBatchIds=n.slice(),m+=n.length),u(e._cylinders)&&(i=e._cylinders=i.slice(),o=e._cylinderBatchIds=o.slice(),m+=o.length),u(e._ellipsoids)&&(r=e._ellipsoids=r.slice(),s=e._ellipsoidBatchIds=s.slice(),m+=s.length),u(e._spheres)&&(a=e._sphere=a.slice(),c=e._sphereBatchIds=c.slice(),m+=c.length),l=e._batchTableColors=new Uint32Array(m);let y=e._batchTable;for(let b=0;b<m;++b){let C=y.getColor(b,c3e);l[b]=C.toRgba()}f=e._packedBuffer=r3e(e)}let d=[];u(t)&&d.push(t.buffer,n.buffer),u(i)&&d.push(i.buffer,o.buffer),u(r)&&d.push(r.buffer,s.buffer),u(a)&&d.push(a.buffer,c.buffer),d.push(l.buffer,f.buffer);let p={boxes:u(t)?t.buffer:void 0,boxBatchIds:u(t)?n.buffer:void 0,cylinders:u(i)?i.buffer:void 0,cylinderBatchIds:u(i)?o.buffer:void 0,ellipsoids:u(r)?r.buffer:void 0,ellipsoidBatchIds:u(r)?s.buffer:void 0,spheres:u(a)?a.buffer:void 0,sphereBatchIds:u(a)?c.buffer:void 0,batchTableColors:l.buffer,packedBuffer:f.buffer},g=e._verticesPromise=a3e.scheduleTask(p,d);return u(g)?g.then(function(m){if(e.isDestroyed())return;let y=new Float64Array(m.packedBuffer);s3e(e,y)===2?e._indices=new Uint16Array(m.indices):e._indices=new Uint32Array(m.indices),e._indexOffsets=new Uint32Array(m.indexOffsets),e._indexCounts=new Uint32Array(m.indexCounts),e._positions=new Float32Array(m.positions),e._vertexBatchIds=new Uint16Array(m.vertexBatchIds),e._batchIds=new Uint16Array(m.batchIds),u3e(e),e._ready=!0}).catch(m=>{e.isDestroyed()||(e._error=m)}):void 0}}function u3e(e){u(e._primitive)||(e._primitive=new rA({batchTable:e._batchTable,positions:e._positions,batchIds:e._batchIds,vertexBatchIds:e._vertexBatchIds,indices:e._indices,indexOffsets:e._indexOffsets,indexCounts:e._indexCounts,batchedIndices:e._batchedIndices,boundingVolume:e._boundingVolume,boundingVolumes:e._boundingVolumes,center:e._center,pickObject:x(e._pickObject,e)}),e._boxes=void 0,e._boxBatchIds=void 0,e._cylinders=void 0,e._cylinderBatchIds=void 0,e._ellipsoids=void 0,e._ellipsoidBatchIds=void 0,e._spheres=void 0,e._sphereBatchIds=void 0,e._center=void 0,e._modelMatrix=void 0,e._batchTable=void 0,e._boundingVolume=void 0,e._boundingVolumes=void 0,e._batchedIndices=void 0,e._indices=void 0,e._indexOffsets=void 0,e._indexCounts=void 0,e._positions=void 0,e._vertexBatchIds=void 0,e._batchIds=void 0,e._batchTableColors=void 0,e._packedBuffer=void 0,e._verticesPromise=void 0)}iu.prototype.createFeatures=function(e,t){this._primitive.createFeatures(e,t)};iu.prototype.applyDebugSettings=function(e,t){this._primitive.applyDebugSettings(e,t)};iu.prototype.applyStyle=function(e,t){this._primitive.applyStyle(e,t)};iu.prototype.updateCommands=function(e,t){this._primitive.updateCommands(e,t)};iu.prototype.update=function(e){if(!this._ready){if(u(this._promise)||(this._promise=l3e(this)),u(this._error)){let t=this._error;throw this._error=void 0,t}return}this._primitive.debugWireframe=this.debugWireframe,this._primitive.forceRebatch=this.forceRebatch,this._primitive.classificationType=this.classificationType,this._primitive.update(e)};iu.prototype.isDestroyed=function(){return!1};iu.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),ue(this)};var rg=iu;function Hh(e,t,n,i,o){this._tileset=e,this._tile=t,this._resource=n,this._geometries=void 0,this._metadata=void 0,this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,this._group=void 0,this._ready=!1,h3e(this,i,o)}Object.defineProperties(Hh.prototype,{featuresLength:{get:function(){return u(this._batchTable)?this._batchTable.featuresLength:0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return u(this._geometries)?this._geometries.trianglesLength:0}},geometryByteLength:{get:function(){return u(this._geometries)?this._geometries.geometryByteLength:0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return u(this._batchTable)?this._batchTable.batchTableByteLength:0}},innerContents:{get:function(){}},ready:{get:function(){return this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e}},batchTable:{get:function(){return this._batchTable}},group:{get:function(){return this._group},set:function(e){this._group=e}}});function f3e(e){return function(t,n){u(e._geometries)&&e._geometries.updateCommands(t,n)}}function d3e(e,t){let n,i,o,r,s,a=x(e.BOXES_LENGTH,0),c=x(e.CYLINDERS_LENGTH,0),l=x(e.ELLIPSOIDS_LENGTH,0),f=x(e.SPHERES_LENGTH,0);if(a>0&&u(e.BOX_BATCH_IDS)){let m=t.byteOffset+e.BOX_BATCH_IDS.byteOffset;n=new Uint16Array(t.buffer,m,a)}if(c>0&&u(e.CYLINDER_BATCH_IDS)){let m=t.byteOffset+e.CYLINDER_BATCH_IDS.byteOffset;i=new Uint16Array(t.buffer,m,c)}if(l>0&&u(e.ELLIPSOID_BATCH_IDS)){let m=t.byteOffset+e.ELLIPSOID_BATCH_IDS.byteOffset;o=new Uint16Array(t.buffer,m,l)}if(f>0&&u(e.SPHERE_BATCH_IDS)){let m=t.byteOffset+e.SPHERE_BATCH_IDS.byteOffset;r=new Uint16Array(t.buffer,m,f)}let d=u(n)||u(i)||u(o)||u(r),p=a>0&&!u(n)||c>0&&!u(i)||l>0&&!u(o)||f>0&&!u(r);if(d&&p)throw new ce("If one group of batch ids is defined, then all batch ids must be defined");if(!u(n)&&!u(i)&&!u(o)&&!u(r)){let m=0;if(!u(n)&&a>0)for(n=new Uint16Array(a),s=0;s<a;++s)n[s]=m++;if(!u(i)&&c>0)for(i=new Uint16Array(c),s=0;s<c;++s)i[s]=m++;if(!u(o)&&l>0)for(o=new Uint16Array(l),s=0;s<l;++s)o[s]=m++;if(!u(r)&&f>0)for(r=new Uint16Array(f),s=0;s<f;++s)r[s]=m++}return{boxes:n,cylinders:i,ellipsoids:o,spheres:r}}var Jy=Uint32Array.BYTES_PER_ELEMENT;function h3e(e,t,n){n=x(n,0);let i=new Uint8Array(t),o=new DataView(t);n+=Jy;let r=o.getUint32(n,!0);if(r!==1)throw new ce(`Only Geometry tile version 1 is supported.  Version ${r} is not.`);n+=Jy;let s=o.getUint32(n,!0);if(n+=Jy,s===0){e._ready=!0;return}let a=o.getUint32(n,!0);if(n+=Jy,a===0)throw new ce("Feature table must have a byte length greater than zero");let c=o.getUint32(n,!0);n+=Jy;let l=o.getUint32(n,!0);n+=Jy;let f=o.getUint32(n,!0);n+=Jy;let d=Uo(i,n,a);n+=a;let p=new Uint8Array(t,n,c);n+=c;let g,m;l>0&&(g=Uo(i,n,l),n+=l,f>0&&(m=new Uint8Array(t,n,f),m=new Uint8Array(m)));let y=x(d.BOXES_LENGTH,0),b=x(d.CYLINDERS_LENGTH,0),C=x(d.ELLIPSOIDS_LENGTH,0),A=x(d.SPHERES_LENGTH,0),T=y+b+C+A,E=new ng(e,T,g,m,f3e(e));if(e._batchTable=E,T===0)return;let v=e.tile.computedTransform,D;u(d.RTC_CENTER)&&(D=h.unpack(d.RTC_CENTER),F.multiplyByPoint(v,D,D));let O=d3e(d,p);if(y>0||b>0||C>0||A>0){let P,M,L,_;if(y>0){let S=p.byteOffset+d.BOXES.byteOffset;P=new Float32Array(p.buffer,S,rg.packedBoxLength*y)}if(b>0){let S=p.byteOffset+d.CYLINDERS.byteOffset;M=new Float32Array(p.buffer,S,rg.packedCylinderLength*b)}if(C>0){let S=p.byteOffset+d.ELLIPSOIDS.byteOffset;L=new Float32Array(p.buffer,S,rg.packedEllipsoidLength*C)}if(A>0){let S=p.byteOffset+d.SPHERES.byteOffset;_=new Float32Array(p.buffer,S,rg.packedSphereLength*A)}return e._geometries=new rg({boxes:P,boxBatchIds:O.boxes,cylinders:M,cylinderBatchIds:O.cylinders,ellipsoids:L,ellipsoidBatchIds:O.ellipsoids,spheres:_,sphereBatchIds:O.spheres,center:D,modelMatrix:v,batchTable:E,boundingVolume:e.tile.boundingVolume.boundingVolume}),e}return Promise.resolve(e)}function Die(e){let t=e.featuresLength;if(!u(e._features)&&t>0){let n=new Array(t);u(e._geometries)&&e._geometries.createFeatures(e,n),e._features=n}}Hh.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)};Hh.prototype.getFeature=function(e){return Die(this),this._features[e]};Hh.prototype.applyDebugSettings=function(e,t){u(this._geometries)&&this._geometries.applyDebugSettings(e,t)};Hh.prototype.applyStyle=function(e){Die(this),u(this._geometries)&&this._geometries.applyStyle(e,this._features)};Hh.prototype.update=function(e,t){u(this._geometries)&&(this._geometries.classificationType=this._tileset.classificationType,this._geometries.debugWireframe=this._tileset.debugWireframe,this._geometries.update(t)),u(this._batchTable)&&this._geometries.ready&&(this._batchTable.update(e,t),this._ready=!0)};Hh.prototype.pick=function(e,t,n){};Hh.prototype.isDestroyed=function(){return!1};Hh.prototype.destroy=function(){return this._geometries=this._geometries&&this._geometries.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),ue(this)};var tN=Hh;var tW={};tW.encode2D=function(e,t,n){let i=Math.pow(2,e),o={x:t,y:n},r,s,a,c=BigInt(0);for(a=i/2;a>0;a/=2)r=(o.x&a)>0?1:0,s=(o.y&a)>0?1:0,c+=BigInt((3*r^s)*a*a),Iie(i,o,r,s);return c};tW.decode2D=function(e,t){let n=Math.pow(2,e),i={x:0,y:0},o,r,s,a;for(s=1,a=t;s<n;s*=2)o=1&Number(a/BigInt(2)),r=1&Number(a^BigInt(o)),Iie(s,i,o,r),i.x+=s*o,i.y+=s*r,a/=BigInt(4);return[i.x,i.y]};function Iie(e,t,n,i){if(i!==0)return;n===1&&(t.x=e-1-t.x,t.y=e-1-t.y);let o=t.x;t.x=t.y,t.y=o}var Uv=tW;var ex=30,m3e=1<<ex,p3e=1<<ex+1>>>0,nW=2*ex+1,sg=4,Oie=[],Mie=[],_3e=[[0,1,3,2],[0,2,3,1],[3,2,0,1],[3,1,0,2]],ag=1,sA=2,nN=[ag,0,0,ag|sA];function qr(e){if(!Wt.supportsBigInt())throw new ce("S2 required BigInt support");this._cellId=e,this._level=qr.getLevel(e)}qr.fromToken=function(e){return new qr(qr.getIdFromToken(e))};qr.isValidId=function(e){return!(e<=0||e>>BigInt(nW)>5||!(e&~e+BigInt(1)&BigInt("0x1555555555555555")))};qr.isValidToken=function(e){return/^[0-9a-fA-F]{1,16}$/.test(e)?qr.isValidId(qr.getIdFromToken(e)):!1};qr.getIdFromToken=function(e){return BigInt("0x"+e+"0".repeat(16-e.length))};qr.getTokenFromId=function(e){let t=Math.floor(v3e(e)/4),n=e.toString(16).replace(/0*$/,"");return Array(17-t-n.length).join("0")+n};qr.getLevel=function(e){let t=0;for(;e!==BigInt(0)&&!(e&BigInt(1));)t++,e=e>>BigInt(1);return ex-(t>>1)};qr.prototype.getChild=function(e){let t=Fie(this._cellId)>>BigInt(2),n=this._cellId+BigInt(2*e+1-4)*t;return new qr(n)};qr.prototype.getParent=function(){let e=Fie(this._cellId)<<BigInt(2);return new qr(this._cellId&~e+BigInt(1)|e)};qr.prototype.getParentAtLevel=function(e){let t=E3e(e);return new qr(this._cellId&-t|t)};qr.prototype.getCenter=function(e){e=x(e,ee.WGS84);let t=g3e(this._cellId,this._level);t=h.normalize(t,t);let n=new de.fromCartesian(t,ee.UNIT_SPHERE);return de.toCartesian(n,e,new h)};qr.prototype.getVertex=function(e,t){t=x(t,ee.WGS84);let n=y3e(this._cellId,this._level,e);n=h.normalize(n,n);let i=new de.fromCartesian(n,ee.UNIT_SPHERE);return de.toCartesian(i,t,new h)};qr.fromFacePositionLevel=function(e,t,n){let i=(e<4?"0":"")+(e<2?"0":"")+e.toString(2),o=t.toString(2),r=Array(2*n-o.length+1).join("0"),s=Array(nW-2*n).join("0"),a=BigInt(`0b${i}${r}${o}1${s}`);return new qr(a)};function g3e(e,t){let n=x3e(e,t);return b3e(n[0],n[1],n[2])}function y3e(e,t,n){let i=Lie(e,t),o=C3e([i[1],i[2]],t),r=n>>1&1;return Nie(i[0],o[0][r^n&1],o[1][r])}function x3e(e,t){let n=Lie(e),i=n[0],o=n[1],r=n[2],s=t===30,a=!s&&(BigInt(o)^e>>BigInt(2))&BigInt(1),c=s?1:a?2:0,l=(o<<1)+c,f=(r<<1)+c;return[i,l,f]}function Lie(e){Oie.length===0&&T3e();let t=Number(e>>BigInt(nW)),n=t&ag,i=(1<<sg)-1,o=0,r=0;for(let s=7;s>=0;s--){let c=(1<<2*(s===7?ex-7*sg:sg))-1;n+=Number(e>>BigInt(s*2*sg+1)&BigInt(c))<<2,n=Mie[n];let l=s*sg;o+=n>>sg+2<<l,r+=(n>>2&i)<<l,n&=ag|sA}return[t,o,r]}function b3e(e,t,n){let i=Pie(t),o=Pie(n),r=iN(i),s=iN(o);return Nie(e,r,s)}function Nie(e,t,n){switch(e){case 0:return new h(1,t,n);case 1:return new h(-t,1,n);case 2:return new h(-t,-n,1);case 3:return new h(-1,-n,-t);case 4:return new h(n,-1,-t);default:return new h(n,t,-1)}}function iN(e){return e>=.5?1/3*(4*e*e-1):1/3*(1-4*(1-e)*(1-e))}function Pie(e){return 1/p3e*e}function C3e(e,t){let n=[[],[]],i=A3e(t);for(let o=0;o<2;++o){let r=e[o]&-i,s=r+i;n[o][0]=iN(Rie(r)),n[o][1]=iN(Rie(s))}return n}function A3e(e){return 1<<ex-e>>>0}function Rie(e){return 1/m3e*e}function cg(e,t,n,i,o,r){if(e===sg){let s=(t<<sg)+n;Oie[(s<<2)+i]=(o<<2)+r,Mie[(o<<2)+i]=(s<<2)+r}else{e++,t<<=1,n<<=1,o<<=2;let s=_3e[r];cg(e,t+(s[0]>>1),n+(s[0]&1),i,o,r^nN[0]),cg(e,t+(s[1]>>1),n+(s[1]&1),i,o+1,r^nN[1]),cg(e,t+(s[2]>>1),n+(s[2]&1),i,o+2,r^nN[2]),cg(e,t+(s[3]>>1),n+(s[3]&1),i,o+3,r^nN[3])}}function T3e(){cg(0,0,0,0,0,0),cg(0,0,0,ag,0,ag),cg(0,0,0,sA,0,sA),cg(0,0,0,ag|sA,0,ag|sA)}function Fie(e){return e&~e+BigInt(1)}function E3e(e){return BigInt(1)<<BigInt(2*(ex-e))}var S3e=[64,0,1,39,2,15,40,23,3,12,16,59,41,19,24,54,4,64,13,10,17,62,60,28,42,30,20,51,25,44,55,47,5,32,65,38,14,22,11,58,18,53,63,9,61,27,29,50,43,46,31,37,21,57,52,8,26,49,45,36,56,7,48,35,6,34,33,0];function v3e(e){return S3e[(-e&e)%BigInt(67)]}var lg=qr;function w3e(e,t){return u(e)&&u(e.extensions)&&u(e.extensions[t])}var si=w3e;function iW(e){let t=e.lengthBits,n=e.availableCount,i=e.constant,o=e.bitstream;if(u(i))n=t;else{let r=Math.ceil(t/8);if(o.length!==r)throw new ce(`Availability bitstream must be exactly ${r} bytes long to store ${t} bits. Actual bitstream was ${o.length} bytes long.`);let s=x(e.computeAvailableCountEnabled,!1);!u(n)&&s&&(n=D3e(o,t))}this._lengthBits=t,this._availableCount=n,this._constant=i,this._bitstream=o}function D3e(e,t){let n=0;for(let i=0;i<t;i++){let o=i>>3,r=i%8;n+=e[o]>>r&1}return n}Object.defineProperties(iW.prototype,{lengthBits:{get:function(){return this._lengthBits}},availableCount:{get:function(){return this._availableCount}}});iW.prototype.getBit=function(e){if(u(this._constant))return this._constant;let t=e>>3,n=e%8;return(this._bitstream[t]>>n&1)===1};var zv=iW;function _p(e){e=x(e,x.EMPTY_OBJECT);let t=e.metadataTable,n=e.class,i=e.entityId,o=e.propertyTableJson;this._class=n,this._metadataTable=t,this._entityId=i,this._extensions=o.extensions,this._extras=o.extras}Object.defineProperties(_p.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});_p.prototype.hasProperty=function(e){return this._metadataTable.hasProperty(e)};_p.prototype.hasPropertyBySemantic=function(e){return this._metadataTable.hasPropertyBySemantic(e)};_p.prototype.getPropertyIds=function(e){return this._metadataTable.getPropertyIds(e)};_p.prototype.getProperty=function(e){return this._metadataTable.getProperty(this._entityId,e)};_p.prototype.setProperty=function(e,t){return this._metadataTable.setProperty(this._entityId,e,t)};_p.prototype.getPropertyBySemantic=function(e){return this._metadataTable.getPropertyBySemantic(this._entityId,e)};_p.prototype.setPropertyBySemantic=function(e,t){return this._metadataTable.setPropertyBySemantic(this._entityId,e,t)};var Hv=_p;var oN={QUADTREE:"QUADTREE",OCTREE:"OCTREE"};oN.getBranchingFactor=function(e){switch(e){case oN.OCTREE:return 8;case oN.QUADTREE:return 4}};var ss=Object.freeze(oN);function na(){}Object.defineProperties(na.prototype,{class:{get:function(){he.throwInstantiationError()}}});na.prototype.hasProperty=function(e){he.throwInstantiationError()};na.prototype.hasPropertyBySemantic=function(e){he.throwInstantiationError()};na.prototype.getPropertyIds=function(e){he.throwInstantiationError()};na.prototype.getProperty=function(e){he.throwInstantiationError()};na.prototype.setProperty=function(e,t){he.throwInstantiationError()};na.prototype.getPropertyBySemantic=function(e){he.throwInstantiationError()};na.prototype.setPropertyBySemantic=function(e,t){he.throwInstantiationError()};na.hasProperty=function(e,t,n){if(u(t[e]))return!0;let i=n.properties;if(!u(i))return!1;let o=i[e];return!!(u(o)&&u(o.default))};na.hasPropertyBySemantic=function(e,t,n){let i=n.propertiesBySemantic;if(!u(i))return!1;let o=i[e];return u(o)};na.getPropertyIds=function(e,t,n){n=u(n)?n:[],n.length=0;for(let o in e)e.hasOwnProperty(o)&&u(e[o])&&n.push(o);let i=t.properties;if(u(i))for(let o in i)i.hasOwnProperty(o)&&!u(e[o])&&u(i[o].default)&&n.push(o);return n};na.getProperty=function(e,t,n){let i=n.properties[e],o=t[e];Array.isArray(o)&&(o=o.slice());let r=!0;if(o=i.handleNoData(o),!u(o)&&u(i.default))return o=Ge(i.default,!0),i.unpackVectorAndMatrixTypes(o,r);if(u(o))return o=i.normalize(o),o=i.applyValueTransform(o),i.unpackVectorAndMatrixTypes(o,r)};na.setProperty=function(e,t,n,i){if(!u(n[e]))return!1;Array.isArray(t)&&(t=t.slice());let o,r=i.properties;return u(r)&&(o=r[e]),u(o)&&(t=o.packVectorAndMatrixTypes(t,!0),t=o.unapplyValueTransform(t),t=o.unnormalize(t)),n[e]=t,!0};na.getPropertyBySemantic=function(e,t,n){let i=n.propertiesBySemantic;if(!u(i))return;let o=i[e];if(u(o))return na.getProperty(o.id,t,n)};na.setPropertyBySemantic=function(e,t,n,i){let o=i.propertiesBySemantic;if(!u(o))return!1;let r=i.propertiesBySemantic[e];return u(r)?na.setProperty(r.id,t,n,i):!1};var Bn=na;function gp(e){e=x(e,x.EMPTY_OBJECT);let t=e.subtreeMetadata,n=e.class,i=u(t.properties)?t.properties:{};this._class=n,this._properties=i,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(gp.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});gp.prototype.hasProperty=function(e){return Bn.hasProperty(e,this._properties,this._class)};gp.prototype.hasPropertyBySemantic=function(e){return Bn.hasPropertyBySemantic(e,this._properties,this._class)};gp.prototype.getPropertyIds=function(e){return Bn.getPropertyIds(this._properties,this._class,e)};gp.prototype.getProperty=function(e){return Bn.getProperty(e,this._properties,this._class)};gp.prototype.setProperty=function(e,t){return Bn.setProperty(e,t,this._properties,this._class)};gp.prototype.getPropertyBySemantic=function(e){return Bn.getPropertyBySemantic(e,this._properties,this._class)};gp.prototype.setPropertyBySemantic=function(e,t){return Bn.setPropertyBySemantic(e,t,this._properties,this._class)};var rN=gp;var Ft={INT8:"INT8",UINT8:"UINT8",INT16:"INT16",UINT16:"UINT16",INT32:"INT32",UINT32:"UINT32",INT64:"INT64",UINT64:"UINT64",FLOAT32:"FLOAT32",FLOAT64:"FLOAT64"};Ft.getMinimum=function(e){switch(e){case Ft.INT8:return-128;case Ft.UINT8:return 0;case Ft.INT16:return-32768;case Ft.UINT16:return 0;case Ft.INT32:return-2147483648;case Ft.UINT32:return 0;case Ft.INT64:return Wt.supportsBigInt()?BigInt("-9223372036854775808"):-Math.pow(2,63);case Ft.UINT64:return Wt.supportsBigInt()?BigInt(0):0;case Ft.FLOAT32:return-34028234663852886e22;case Ft.FLOAT64:return-Number.MAX_VALUE}};Ft.getMaximum=function(e){switch(e){case Ft.INT8:return 127;case Ft.UINT8:return 255;case Ft.INT16:return 32767;case Ft.UINT16:return 65535;case Ft.INT32:return 2147483647;case Ft.UINT32:return 4294967295;case Ft.INT64:return Wt.supportsBigInt()?BigInt("9223372036854775807"):Math.pow(2,63)-1;case Ft.UINT64:return Wt.supportsBigInt()?BigInt("18446744073709551615"):Math.pow(2,64)-1;case Ft.FLOAT32:return 34028234663852886e22;case Ft.FLOAT64:return Number.MAX_VALUE}};Ft.isIntegerType=function(e){switch(e){case Ft.INT8:case Ft.UINT8:case Ft.INT16:case Ft.UINT16:case Ft.INT32:case Ft.UINT32:case Ft.INT64:case Ft.UINT64:return!0;default:return!1}};Ft.isUnsignedIntegerType=function(e){switch(e){case Ft.UINT8:case Ft.UINT16:case Ft.UINT32:case Ft.UINT64:return!0;default:return!1}};Ft.isVectorCompatible=function(e){switch(e){case Ft.INT8:case Ft.UINT8:case Ft.INT16:case Ft.UINT16:case Ft.INT32:case Ft.UINT32:case Ft.FLOAT32:case Ft.FLOAT64:return!0;default:return!1}};Ft.normalize=function(e,t){return Math.max(Number(e)/Number(Ft.getMaximum(t)),-1)};Ft.unnormalize=function(e,t){let n=Ft.getMaximum(t),i=Ft.isUnsignedIntegerType(t)?0:-n;return e=R.sign(e)*Math.round(Math.abs(e)*Number(n)),(t===Ft.INT64||t===Ft.UINT64)&&Wt.supportsBigInt()&&(e=BigInt(e)),e>n?n:e<i?i:e};Ft.applyValueTransform=function(e,t,n){return n*e+t};Ft.unapplyValueTransform=function(e,t,n){return n===0?0:(e-t)/n};Ft.getSizeInBytes=function(e){switch(e){case Ft.INT8:case Ft.UINT8:return 1;case Ft.INT16:case Ft.UINT16:return 2;case Ft.INT32:case Ft.UINT32:return 4;case Ft.INT64:case Ft.UINT64:return 8;case Ft.FLOAT32:return 4;case Ft.FLOAT64:return 8}};Ft.fromComponentDatatype=function(e){switch(e){case K.BYTE:return Ft.INT8;case K.UNSIGNED_BYTE:return Ft.UINT8;case K.SHORT:return Ft.INT16;case K.UNSIGNED_SHORT:return Ft.UINT16;case K.INT:return Ft.INT32;case K.UNSIGNED_INT:return Ft.UINT32;case K.FLOAT:return Ft.FLOAT32;case K.DOUBLE:return Ft.FLOAT64}};Ft.toComponentDatatype=function(e){switch(e){case Ft.INT8:return K.BYTE;case Ft.UINT8:return K.UNSIGNED_BYTE;case Ft.INT16:return K.SHORT;case Ft.UINT16:return K.UNSIGNED_SHORT;case Ft.INT32:return K.INT;case Ft.UINT32:return K.UNSIGNED_INT;case Ft.FLOAT32:return K.FLOAT;case Ft.FLOAT64:return K.DOUBLE}};var Gt=Object.freeze(Ft);var zo={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4",BOOLEAN:"BOOLEAN",STRING:"STRING",ENUM:"ENUM"};zo.isVectorType=function(e){switch(e){case zo.VEC2:case zo.VEC3:case zo.VEC4:return!0;default:return!1}};zo.isMatrixType=function(e){switch(e){case zo.MAT2:case zo.MAT3:case zo.MAT4:return!0;default:return!1}};zo.getComponentCount=function(e){switch(e){case zo.SCALAR:case zo.STRING:case zo.ENUM:case zo.BOOLEAN:return 1;case zo.VEC2:return 2;case zo.VEC3:return 3;case zo.VEC4:return 4;case zo.MAT2:return 4;case zo.MAT3:return 9;case zo.MAT4:return 16}};zo.getMathType=function(e){switch(e){case zo.VEC2:return H;case zo.VEC3:return h;case zo.VEC4:return oe;case zo.MAT2:return Hi;case zo.MAT3:return J;case zo.MAT4:return F;default:return}};var Et=Object.freeze(zo);function va(e){e=x(e,x.EMPTY_OBJECT);let t=e.id,n=e.type,i=e.componentType,o=e.enumType,r=u(i)&&Gt.isIntegerType(i)&&x(e.normalized,!1);this._id=t,this._name=e.name,this._description=e.description,this._semantic=e.semantic,this._isLegacyExtension=e.isLegacyExtension,this._type=n,this._componentType=i,this._enumType=o,this._valueType=u(o)?o.valueType:i,this._isArray=x(e.isArray,!1),this._isVariableLengthArray=x(e.isVariableLengthArray,!1),this._arrayLength=e.arrayLength,this._min=Ge(e.min,!0),this._max=Ge(e.max,!0),this._normalized=r;let s=Ge(e.offset,!0),a=Ge(e.scale,!0),c=u(s)||u(a),l=!0;u(s)||(s=this.expandConstant(0,l)),u(a)||(a=this.expandConstant(1,l)),this._offset=s,this._scale=a,this._hasValueTransform=c,this._noData=Ge(e.noData,!0),this._default=Ge(e.default,!0),this._required=x(e.required,!0),this._extras=Ge(e.extras,!0),this._extensions=Ge(e.extensions,!0)}va.fromJson=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.id,n=e.property,i=I3e(n),o=P3e(n,e.enums),r;return u(i)?i?r=u(n.optional)?!n.optional:!0:r=x(n.required,!1):r=!1,new va({id:t,type:o.type,componentType:o.componentType,enumType:o.enumType,isArray:o.isArray,isVariableLengthArray:o.isVariableLengthArray,arrayLength:o.arrayLength,normalized:n.normalized,min:n.min,max:n.max,offset:n.offset,scale:n.scale,noData:n.noData,default:n.default,required:r,name:n.name,description:n.description,semantic:n.semantic,extras:n.extras,extensions:n.extensions,isLegacyExtension:i})};Object.defineProperties(va.prototype,{id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},type:{get:function(){return this._type}},enumType:{get:function(){return this._enumType}},componentType:{get:function(){return this._componentType}},valueType:{get:function(){return this._valueType}},isArray:{get:function(){return this._isArray}},isVariableLengthArray:{get:function(){return this._isVariableLengthArray}},arrayLength:{get:function(){return this._arrayLength}},normalized:{get:function(){return this._normalized}},max:{get:function(){return this._max}},min:{get:function(){return this._min}},noData:{get:function(){return this._noData}},default:{get:function(){return this._default}},required:{get:function(){return this._required}},semantic:{get:function(){return this._semantic}},hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});function I3e(e){if(e.type==="ARRAY")return!0;let t=e.type;if(t===Et.SCALAR||Et.isMatrixType(t)||Et.isVectorType(t))return!1;if(u(Gt[t]))return!0;if(u(e.noData)||u(e.scale)||u(e.offset)||u(e.required)||u(e.count)||u(e.array)||u(e.optional))return!1}function P3e(e,t){let n=e.type,i=e.componentType,o=n==="ARRAY",r,s,a;o?(r=!0,s=e.componentCount,a=!u(s)):e.array?(r=!0,s=e.count,a=!u(e.count)):(r=!1,s=void 0,a=!1);let c;if(u(e.enumType)&&(c=t[e.enumType]),n===Et.ENUM)return{type:n,componentType:void 0,enumType:c,valueType:c.valueType,isArray:r,isVariableLengthArray:a,arrayLength:s};if(o&&i===Et.ENUM)return{type:i,componentType:void 0,enumType:c,valueType:c.valueType,isArray:r,isVariableLengthArray:a,arrayLength:s};if(n===Et.SCALAR||Et.isMatrixType(n)||Et.isVectorType(n))return{type:n,componentType:i,enumType:void 0,valueType:i,isArray:r,isVariableLengthArray:a,arrayLength:s};if(n===Et.BOOLEAN||n===Et.STRING)return{type:n,componentType:void 0,enumType:void 0,valueType:void 0,isArray:r,isVariableLengthArray:a,arrayLength:s};if(o&&(i===Et.BOOLEAN||i===Et.STRING))return{type:i,componentType:void 0,enumType:void 0,valueType:void 0,isArray:r,isVariableLengthArray:a,arrayLength:s};if(u(i)&&u(Gt[i]))return{type:Et.SCALAR,componentType:i,enumType:void 0,valueType:i,isArray:r,isVariableLengthArray:a,arrayLength:s};if(u(Gt[n]))return{type:Et.SCALAR,componentType:n,enumType:void 0,valueType:n,isArray:r,isVariableLengthArray:a,arrayLength:s}}va.prototype.normalize=function(e){return this._normalized?oW(e,this._valueType,Gt.normalize):e};va.prototype.unnormalize=function(e){return this._normalized?oW(e,this._valueType,Gt.unnormalize):e};va.prototype.applyValueTransform=function(e){return!this._hasValueTransform||this._isVariableLengthArray?e:va.valueTransformInPlace(e,this._offset,this._scale,Gt.applyValueTransform)};va.prototype.unapplyValueTransform=function(e){return!this._hasValueTransform||this._isVariableLengthArray?e:va.valueTransformInPlace(e,this._offset,this._scale,Gt.unapplyValueTransform)};va.prototype.expandConstant=function(e,t){t=x(t,!1);let n=this._isArray,i=this._arrayLength,o=Et.getComponentCount(this._type),r=n&&o>1;if(!n&&o===1)return e;if(!n)return new Array(o).fill(e);if(!r)return new Array(i).fill(e);if(!t)return new Array(this._arrayLength*o).fill(e);let s=new Array(o).fill(e);return new Array(this._arrayLength).fill(s)};va.prototype.handleNoData=function(e){let t=this._noData;if(!u(t))return e;if(!Uie(e,t))return e};function Uie(e,t){if(!Array.isArray(e))return e===t;if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Uie(e[n],t[n]))return!1;return!0}va.prototype.unpackVectorAndMatrixTypes=function(e,t){t=x(t,!1);let n=Et.getMathType(this._type),i=this._isArray,o=Et.getComponentCount(this._type),r=i&&o>1;return u(n)?t&&r?e.map(function(s){return n.unpack(s)}):i?n.unpackArray(e):n.unpack(e):e};va.prototype.packVectorAndMatrixTypes=function(e,t){t=x(t,!1);let n=Et.getMathType(this._type),i=this._isArray,o=Et.getComponentCount(this._type),r=i&&o>1;return u(n)?t&&r?e.map(function(s){return n.pack(s,[])}):i?n.packArray(e,[]):n.pack(e,[]):e};va.prototype.validate=function(e){if(!(!u(e)&&u(this._default)))return this._required&&!u(e)?"required property must have a value":this._isArray?R3e(this,e):zie(this,e)};function R3e(e,t){if(!Array.isArray(t))return`value ${t} must be an array`;let n=t.length;if(!e._isVariableLengthArray&&n!==e._arrayLength)return"Array length does not match property.arrayLength";for(let i=0;i<n;i++){let o=zie(e,t[i]);if(u(o))return o}}function zie(e,t){let n=e._type,i=e._componentType,o=e._enumType,r=e._normalized;return Et.isVectorType(n)?O3e(t,n,i):Et.isMatrixType(n)?M3e(t,n,i):n===Et.STRING?L3e(t):n===Et.BOOLEAN?N3e(t):n===Et.ENUM?F3e(t,o):B3e(t,i,r)}function O3e(e,t,n){if(!Gt.isVectorCompatible(n))return`componentType ${n} is incompatible with vector type ${t}`;if(t===Et.VEC2&&!(e instanceof H))return`vector value ${e} must be a Cartesian2`;if(t===Et.VEC3&&!(e instanceof h))return`vector value ${e} must be a Cartesian3`;if(t===Et.VEC4&&!(e instanceof oe))return`vector value ${e} must be a Cartesian4`}function M3e(e,t,n){if(!Gt.isVectorCompatible(n))return`componentType ${n} is incompatible with matrix type ${t}`;if(t===Et.MAT2&&!(e instanceof Hi))return`matrix value ${e} must be a Matrix2`;if(t===Et.MAT3&&!(e instanceof J))return`matrix value ${e} must be a Matrix3`;if(t===Et.MAT4&&!(e instanceof F))return`matrix value ${e} must be a Matrix4`}function L3e(e){if(typeof e!="string")return sN(e,Et.STRING)}function N3e(e){if(typeof e!="boolean")return sN(e,Et.BOOLEAN)}function F3e(e,t){let n=typeof e;if(u(t))return n!=="string"||!u(t.valuesByName[e])?`value ${e} is not a valid enum name for ${t.id}`:void 0}function B3e(e,t,n){let i=typeof e;switch(t){case Gt.INT8:case Gt.UINT8:case Gt.INT16:case Gt.UINT16:case Gt.INT32:case Gt.UINT32:case Gt.FLOAT32:case Gt.FLOAT64:return i!=="number"?sN(e,t):isFinite(e)?kie(e,t,n):Vie(e,t);case Gt.INT64:case Gt.UINT64:return i!=="number"&&i!=="bigint"?sN(e,t):i==="number"&&!isFinite(e)?Vie(e,t):kie(e,t,n)}}function sN(e,t){return`value ${e} does not match type ${t}`}function Bie(e,t,n){let i=`value ${e} is out of range for type ${t}`;return n&&(i+=" (normalized)"),i}function kie(e,t,n){if(n){let i=Gt.isUnsignedIntegerType(t)?0:-1;return e<i||e>1?Bie(e,t,n):void 0}if(e<Gt.getMinimum(t)||e>Gt.getMaximum(t))return Bie(e,t,n)}function Vie(e,t){return`value ${e} of type ${t} must be finite`}function oW(e,t,n){if(!Array.isArray(e))return n(e,t);for(let i=0;i<e.length;i++)e[i]=oW(e[i],t,n);return e}va.valueTransformInPlace=function(e,t,n,i){if(!Array.isArray(e))return i(e,t,n);for(let o=0;o<e.length;o++)e[o]=va.valueTransformInPlace(e[o],t[o],n[o],i);return e};var tx=va;function Gv(e){e=x(e,x.EMPTY_OBJECT);let t=e.count,n=e.property,i=e.classProperty,o=e.bufferViews,r=i.type,s=i.isArray,a=i.isVariableLengthArray,c=i.valueType,l=i.enumType,f=r===Et.STRING,d=r===Et.BOOLEAN,p=0,g;if(a){let _=x(n.arrayOffsetType,n.offsetType);_=x(Gt[_],Gt.UINT32);let S=x(n.arrayOffsets,n.arrayOffsetBufferView);g=new rW(o[S],_,t+1),p+=g.typedArray.byteLength}let m=Et.getComponentCount(r),y;a?y=g.get(t)-g.get(0):s?y=t*i.arrayLength:y=t;let b=m*y,C;if(f){let _=x(n.stringOffsetType,n.offsetType);_=x(Gt[_],Gt.UINT32);let S=x(n.stringOffsets,n.stringOffsetBufferView);C=new rW(o[S],_,b+1),p+=C.typedArray.byteLength}(f||d)&&(c=Gt.UINT8);let A;f?A=C.get(b)-C.get(0):d?A=Math.ceil(b/8):A=b;let T=x(n.values,n.bufferView),E=new rW(o[T],c,A);p+=E.typedArray.byteLength;let v=n.offset,D=n.scale,O=i.hasValueTransform||u(v)||u(D);v=x(v,i.offset),D=x(D,i.scale),v=Hie(v),D=Hie(D);let P,M,L=this;f?P=function(_){return U3e(_,L._values,L._stringOffsets)}:d?(P=function(_){return z3e(_,L._values)},M=function(_,S){H3e(_,L._values,S)}):u(l)?(P=function(_){let S=L._values.get(_);return l.namesByValue[S]},M=function(_,S){let w=l.valuesByName[S];L._values.set(_,w)}):(P=function(_){return L._values.get(_)},M=function(_,S){L._values.set(_,S)}),this._arrayOffsets=g,this._stringOffsets=C,this._values=E,this._classProperty=i,this._count=t,this._vectorComponentCount=m,this._min=n.min,this._max=n.max,this._offset=v,this._scale=D,this._hasValueTransform=O,this._getValue=P,this._setValue=M,this._unpackedValues=void 0,this._extras=n.extras,this._extensions=n.extensions,this._byteLength=p}Object.defineProperties(Gv.prototype,{hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}},byteLength:{get:function(){return this._byteLength}}});Gv.prototype.get=function(e){let t=k3e(this,e);return t=this._classProperty.handleNoData(t),u(t)?(t=this._classProperty.normalize(t),t=Z3e(this,t),this._classProperty.unpackVectorAndMatrixTypes(t)):(t=this._classProperty.default,this._classProperty.unpackVectorAndMatrixTypes(t))};Gv.prototype.set=function(e,t){let n=this._classProperty;t=n.packVectorAndMatrixTypes(t),t=$3e(this,t),t=n.unnormalize(t),V3e(this,e,t)};Gv.prototype.getTypedArray=function(){if(u(this._values))return this._values.typedArray};function Hie(e){if(!Array.isArray(e))return e;let t=[];for(let n=0;n<e.length;n++){let i=e[n];Array.isArray(i)?t.push.apply(t,i):t.push(i)}return t}function k3e(e,t){Wie(e)&&jie(e);let n=e._classProperty,i=n.isArray,o=n.type,r=Et.getComponentCount(o);if(u(e._unpackedValues)){let s=e._unpackedValues[t];return i?Ge(s,!0):s}return!i&&r===1?e._getValue(t):Gie(e,n,t)}function Gie(e,t,n){let i,o;if(t.isVariableLengthArray){i=e._arrayOffsets.get(n),o=e._arrayOffsets.get(n+1)-i;let s=Et.getComponentCount(t.type);i*=s,o*=s}else{let a=x(t.arrayLength,1)*e._vectorComponentCount;i=n*a,o=a}let r=new Array(o);for(let s=0;s<o;s++)r[s]=e._getValue(i+s);return r}function V3e(e,t,n){X3e(e,t,n)&&jie(e);let i=e._classProperty,o=i.isArray,r=i.type,s=Et.getComponentCount(r);if(u(e._unpackedValues)){i.isArray&&(n=Ge(n,!0)),e._unpackedValues[t]=n;return}if(!o&&s===1){e._setValue(t,n);return}let a,c;if(i.isVariableLengthArray)a=e._arrayOffsets.get(t),c=e._arrayOffsets.get(t+1)-a;else{let f=x(i.arrayLength,1)*e._vectorComponentCount;a=t*f,c=f}for(let l=0;l<c;++l)e._setValue(a+l,n[l])}function U3e(e,t,n){let i=n.get(e),o=n.get(e+1)-i;return tu(t.typedArray,i,o)}function z3e(e,t){let n=e>>3,i=e%8;return(t.typedArray[n]>>i&1)===1}function H3e(e,t,n){let i=e>>3,o=e%8;n?t.typedArray[i]|=1<<o:t.typedArray[i]&=~(1<<o)}function G3e(e,t){let n=t.dataView,i=e*8,o=0,r=(n.getUint8(i+7)&128)>0,s=!0;for(let a=0;a<8;++a){let c=n.getUint8(i+a);r&&(s?c!==0&&(c=~(c-1)&255,s=!1):c=~c&255),o+=c*Math.pow(256,a)}return r&&(o=-o),o}function W3e(e,t){let n=t.dataView,i=e*8,o=BigInt(0),r=(n.getUint8(i+7)&128)>0,s=!0;for(let a=0;a<8;++a){let c=n.getUint8(i+a);r&&(s?c!==0&&(c=~(c-1)&255,s=!1):c=~c&255),o+=BigInt(c)*(BigInt(1)<<BigInt(a*8))}return r&&(o=-o),o}function j3e(e,t){let n=t.dataView,i=e*8,o=n.getUint32(i,!0),r=n.getUint32(i+4,!0);return o+4294967296*r}function q3e(e,t){let n=t.dataView,i=e*8,o=BigInt(n.getUint32(i,!0)),r=BigInt(n.getUint32(i+4,!0));return o+BigInt(4294967296)*r}function Y3e(e){switch(e){case Gt.INT8:return K.BYTE;case Gt.UINT8:return K.UNSIGNED_BYTE;case Gt.INT16:return K.SHORT;case Gt.UINT16:return K.UNSIGNED_SHORT;case Gt.INT32:return K.INT;case Gt.UINT32:return K.UNSIGNED_INT;case Gt.FLOAT32:return K.FLOAT;case Gt.FLOAT64:return K.DOUBLE}}function Wie(e){if(u(e._unpackedValues))return!1;let t=e._classProperty,n=t.type,i=t.valueType;return n===Et.STRING||i===Gt.INT64&&!Wt.supportsBigInt64Array()||i===Gt.UINT64&&!Wt.supportsBigUint64Array()}function X3e(e,t,n){if(Wie(e))return!0;let i=e._arrayOffsets;if(u(i)){let o=i.get(t+1)-i.get(t),r=n.length;if(o!==r)return!0}return!1}function jie(e){e._unpackedValues=K3e(e),e._arrayOffsets=void 0,e._stringOffsets=void 0,e._values=void 0}function K3e(e){let t=e._count,n=new Array(t),i=e._classProperty,o=i.isArray,r=i.type,s=Et.getComponentCount(r);if(!o&&s===1){for(let a=0;a<t;++a)n[a]=e._getValue(a);return n}for(let a=0;a<t;a++)n[a]=Gie(e,i,a);return n}function Z3e(e,t){let i=e._classProperty.isVariableLengthArray;return!e._hasValueTransform||i?t:tx.valueTransformInPlace(t,e._offset,e._scale,Gt.applyValueTransform)}function $3e(e,t){let i=e._classProperty.isVariableLengthArray;return!e._hasValueTransform||i?t:tx.valueTransformInPlace(t,e._offset,e._scale,Gt.unapplyValueTransform)}function rW(e,t,n){let i=this,o,r,s;if(t===Gt.INT64)Wt.supportsBigInt()?Wt.supportsBigInt64Array()?(o=new BigInt64Array(e.buffer,e.byteOffset,n),s=function(a,c){i.typedArray[a]=BigInt(c)}):(o=new Uint8Array(e.buffer,e.byteOffset,n*8),r=function(a){return W3e(a,i)}):(At("INT64 type is not fully supported on this platform. Values greater than 2^53 - 1 or less than -(2^53 - 1) may lose precision when read."),o=new Uint8Array(e.buffer,e.byteOffset,n*8),r=function(a){return G3e(a,i)});else if(t===Gt.UINT64)Wt.supportsBigInt()?Wt.supportsBigUint64Array()?(o=new BigUint64Array(e.buffer,e.byteOffset,n),s=function(a,c){i.typedArray[a]=BigInt(c)}):(o=new Uint8Array(e.buffer,e.byteOffset,n*8),r=function(a){return q3e(a,i)}):(At("UINT64 type is not fully supported on this platform. Values greater than 2^53 - 1 may lose precision when read."),o=new Uint8Array(e.buffer,e.byteOffset,n*8),r=function(a){return j3e(a,i)});else{let a=Y3e(t);o=K.createArrayBufferView(a,e.buffer,e.byteOffset,n),s=function(c,l){i.typedArray[c]=l}}u(r)||(r=function(a){return i.typedArray[a]}),this.typedArray=o,this.dataView=new DataView(o.buffer,o.byteOffset),this.get=r,this.set=s,this._componentType=t}var aN=Gv;function gd(e){e=x(e,x.EMPTY_OBJECT);let t=e.count,n=e.class,i=0,o={};if(u(e.properties)){for(let r in e.properties)if(e.properties.hasOwnProperty(r)){let s=new aN({count:t,property:e.properties[r],classProperty:n.properties[r],bufferViews:e.bufferViews});o[r]=s,i+=s.byteLength}}this._count=t,this._class=n,this._properties=o,this._byteLength=i}Object.defineProperties(gd.prototype,{count:{get:function(){return this._count}},class:{get:function(){return this._class}},byteLength:{get:function(){return this._byteLength}}});gd.prototype.hasProperty=function(e){return Bn.hasProperty(e,this._properties,this._class)};gd.prototype.hasPropertyBySemantic=function(e){return Bn.hasPropertyBySemantic(e,this._properties,this._class)};gd.prototype.getPropertyIds=function(e){return Bn.getPropertyIds(this._properties,this._class,e)};gd.prototype.getProperty=function(e,t){let n=this._properties[t],i;return u(n)?i=n.get(e):i=Q3e(this._class,t),i};gd.prototype.setProperty=function(e,t,n){let i=this._properties[t];return u(i)?(i.set(e,n),!0):!1};gd.prototype.getPropertyBySemantic=function(e,t){let n,i=this._class.propertiesBySemantic;if(u(i)&&(n=i[t]),u(n))return this.getProperty(e,n.id)};gd.prototype.setPropertyBySemantic=function(e,t,n){let i,o=this._class.propertiesBySemantic;return u(o)&&(i=o[t]),u(i)?this.setProperty(e,i.id,n):!1};gd.prototype.getPropertyTypedArray=function(e){let t=this._properties[e];if(u(t))return t.getTypedArray()};gd.prototype.getPropertyTypedArrayBySemantic=function(e){let t,n=this._class.propertiesBySemantic;if(u(n)&&(t=n[e]),u(t))return this.getPropertyTypedArray(t.id)};function Q3e(e,t){let n=e.properties;if(!u(n))return;let i=n[t];if(u(i)&&u(i.default)){let o=i.default;return i.isArray&&(o=Ge(o,!0)),o=i.normalize(o),i.unpackVectorAndMatrixTypes(o)}}var ou=gd;function ug(){}Object.defineProperties(ug.prototype,{cacheKey:{get:function(){he.throwInstantiationError()}}});ug.prototype.load=function(){he.throwInstantiationError()};ug.prototype.unload=function(){};ug.prototype.process=function(e){return!1};ug.prototype.getError=function(e,t){u(t)&&u(t.message)&&(e+=`
${t.message}`);let n=new ce(e);return u(t)&&(n.stack=`Original stack:
${t.stack}
Handler stack:
${n.stack}`),n};ug.prototype.isDestroyed=function(){return!1};ug.prototype.destroy=function(){return this.unload(),ue(this)};var Qi=ug;var J3e={UNLOADED:0,LOADING:1,LOADED:2,PROCESSING:3,READY:4,FAILED:5},_t=Object.freeze(J3e);function yp(e){e=x(e,x.EMPTY_OBJECT);let t=e.typedArray,n=e.resource,i=e.cacheKey;this._typedArray=t,this._resource=n,this._cacheKey=i,this._state=_t.UNLOADED,this._promise=void 0}u(Object.create)&&(yp.prototype=Object.create(Qi.prototype),yp.prototype.constructor=yp);Object.defineProperties(yp.prototype,{cacheKey:{get:function(){return this._cacheKey}},typedArray:{get:function(){return this._typedArray}}});yp.prototype.load=async function(){return u(this._promise)?this._promise:u(this._typedArray)?(this._promise=Promise.resolve(this),this._promise):(this._promise=eke(this),this._promise)};async function eke(e){let t=e._resource;e._state=_t.LOADING;try{let n=await yp._fetchArrayBuffer(t);return e.isDestroyed()?void 0:(e._typedArray=new Uint8Array(n),e._state=_t.READY,e)}catch(n){if(e.isDestroyed())return;e._state=_t.FAILED;let i=`Failed to load external buffer: ${t.url}`;throw e.getError(i,n)}}yp._fetchArrayBuffer=function(e){return e.fetchArrayBuffer()};yp.prototype.unload=function(){this._typedArray=void 0};var aA=yp;var Ren=function(){var e="b9H79TebbbeJq9Geueu9Geub9Gbb9Gvuuuuueu9Gduueu9Gluuuueu9Gvuuuuub9Gouuuuuub9Gluuuub9GiuuueuiKLdilevlevlooroowwvwbDDbelve9Weiiviebeoweuec:G:Qdkr;RiOo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9FW9U9J9V9KW9wWVtW949c919M9MWVbe8F9TW79O9V9Wt9FW9U9J9V9KW9wWVtW949c919M9MWV9c9V919U9KbdE9TW79O9V9Wt9FW9U9J9V9KW9wWVtW949wWV79P9V9UbiY9TW79O9V9Wt9FW9U9J9V9KW69U9KW949c919M9MWVbl8E9TW79O9V9Wt9FW9U9J9V9KW69U9KW949c919M9MWV9c9V919U9Kbv8A9TW79O9V9Wt9FW9U9J9V9KW69U9KW949wWV79P9V9UboE9TW79O9V9Wt9FW9U9J9V9KW69U9KW949tWG91W9U9JWbra9TW79O9V9Wt9FW9U9J9V9KW69U9KW949tWG91W9U9JW9c9V919U9KbwL9TW79O9V9Wt9FW9U9J9V9KWS9P2tWV9p9JtbDK9TW79O9V9Wt9FW9U9J9V9KWS9P2tWV9r919HtbqL9TW79O9V9Wt9FW9U9J9V9KWS9P2tWVT949WbkE9TW79O9V9Wt9F9V9Wt9P9T9P96W9wWVtW94J9H9J9OWbPa9TW79O9V9Wt9F9V9Wt9P9T9P96W9wWVtW94J9H9J9OW9ttV9P9Wbsa9TW79O9V9Wt9F9V9Wt9P9T9P96W9wWVtW94SWt9J9O9sW9T9H9WbzK9TW79O9V9Wt9F79W9Ht9P9H29t9VVt9sW9T9H9WbHl79IV9RbODwebcekdQXq;A9pLdbk;QqeKu8Jjjjjbcjo9Rgv8Kjjjjbcbhodnalcefae0mbabcbRbN:kjjbc:GeV86bbavcjdfcbcjdzNjjjb8AdnaiTmbavcjdfadalz:tjjjb8Akabaefhrabcefhwavalfcbcbcjdal9RalcFe0EzNjjjb8Aavavcjdfalz:tjjjbhDcj;abal9Uc;WFbGgecjdaecjd6Ehqcbhkindndnaiak9nmbaDcjlfcbcjdzNjjjb8Aaqaiak9Rakaqfai6Egxcsfgecl4cifcd4hmadakal2fhPdndndnaec9WGgsTmbcbhzaPhHawhOxekdnaxmbalheinaraw9Ram6miawcbamzNjjjbamfhwaecufgembxvkkcbhAaPhOinaDaAfRbbhCaDcjlfheaOhoaxhXinaeaoRbbgQaC9RgCcetaCcKtcK91cr4786bbaoalfhoaecefheaQhCaXcufgXmbkaraw9Ram6mdaOcefhOawcbamzNjjjbamfhwaAcefgAal9hmbxlkkindnaxTmbaDazfRbbhCaDcjlfheaHhoaxhXinaeaoRbbgQaC9RgCcetaCcKtcK91cr4786bbaoalfhoaecefheaQhCaXcufgXmbkkaraO9Ram6mearaOcbamzNjjjbgLamfgw9RcK6mecbhKaDcjlfhOinaDcjlfaKfhYcwhAczhQceheindndnaegXce9hmbcuhoaYRbbmecbhodninaogecsSmeaecefhoaOaefcefRbbTmbkkcucbaecs6EhoxekaXcethocuaXtc;:bGcFb7hCcbheinaoaCaOaefRbb9nfhoaecefgecz9hmbkkaoaQaoaQ6geEhQaXaAaeEhAaXcetheaXcl6mbkdndndndnaAcufPdiebkaLaKco4fgeaeRbbcdciaAclSEaKci4coGtV86bbaAcw9hmeawaY8Pbb83bbawcwfaYcwf8Pbb83bbawczfhwxdkaLaKco4fgeaeRbbceaKci4coGtV86bbkdncwaA9Tg8Ambinawcb86bbawcefhwxbkkcuaAtcu7hYcbhEaOh3ina3hea8AhCcbhoinaeRbbgQaYcFeGgXaQaX6EaoaAtVhoaecefheaCcufgCmbkawao86bba3a8Afh3awcefhwaEa8AfgEcz6mbkcbheindnaOaefRbbgoaX6mbawao86bbawcefhwkaecefgecz9hmbkkdnaKczfgKas9pmbaOczfhOaraw9RcL0mekkaKas6meawTmeaHcefhHawhOazcefgzalSmixbkkcbhoxikcbhoaraw9Ralcaalca0E6mddnalc8F0mbawcbcaal9RgezNjjjbaefhwkawaDcjdfalz:tjjjbalfab9RhoxdkaDaPaxcufal2falz:tjjjb8Aaxakfhkawmbkcbhokavcjof8Kjjjjbaok9heeuaecaaeca0Eabcj;abae9Uc;WFbGgdcjdadcjd6Egdfcufad9Uae2adcl4cifcd4adV2fcefkmbcbabBdN:kjjbk:zse5u8Jjjjjbc;ae9Rgl8Kjjjjbcbhvdnaici9UgocHfae0mbabcbyd:e:kjjbgrc;GeV86bbalc;abfcFecjezNjjjb8AalcUfgw9cu83ibalc8WfgD9cu83ibalcyfgq9cu83ibalcafgk9cu83ibalcKfgx9cu83ibalczfgm9cu83ibal9cu83iwal9cu83ibabaefc9WfhPabcefgsaofhednaiTmbcmcsarcb9kgzEhHcbhOcbhAcbhCcbhXcbhQindnaeaP9nmbcbhvxikaQcufhvadaCcdtfgLydbhKaLcwfydbhYaLclfydbh8AcbhEdndndninalc;abfavcsGcitfgoydlh3dndndnaoydbgoaK9hmba3a8ASmekdnaoa8A9hmba3aY9hmbaEcefhExekaoaY9hmea3aK9hmeaEcdfhEkaEc870mdaXcufhvaLaEciGcx2goc:y1jjbfydbcdtfydbh3aLaocN1jjbfydbcdtfydbh8AaLaoc:q1jjbfydbcdtfydbhKcbhodnindnalavcsGcdtfydba39hmbaohYxdkcuhYavcufhvaocefgocz9hmbkkaOa3aOSgvaYce9iaYaH9oVgoGfhOdndndncbcsavEaYaoEgvcs9hmbarce9imba3a3aAa3cefaASgvEgAcefSmecmcsavEhvkasavaEcdtc;WeGV86bbavcs9hmea3aA9Rgvcetavc8F917hvinaeavcFb0crtavcFbGV86bbaecefheavcje6hoavcr4hvaoTmbka3hAxvkcPhvasaEcdtcPV86bba3hAkavTmiavaH9omicdhocehEaQhYxlkavcufhvaEclfgEc;ab9hmbkkdnaLceaYaOSceta8AaOSEcx2gvc:q1jjbfydbcdtfydbgKTaLavcN1jjbfydbcdtfydbg8AceSGaLavc:y1jjbfydbcdtfydbg3cdSGaOcb9hGazGg5ce9hmbaw9cu83ibaD9cu83ibaq9cu83ibak9cu83ibax9cu83ibam9cu83ibal9cu83iwal9cu83ibcbhOkcbhEaXcufgvhodnindnalaocsGcdtfydba8A9hmbaEhYxdkcuhYaocufhoaEcefgEcz9hmbkkcbhodnindnalavcsGcdtfydba39hmbaohExdkcuhEavcufhvaocefgocz9hmbkkaOaKaOSg8EfhLdndnaYcm0mbaYcefhYxekcbcsa8AaLSgvEhYaLavfhLkdndnaEcm0mbaEcefhExekcbcsa3aLSgvEhEaLavfhLkc9:cua8EEh8FcbhvaEaYcltVgacFeGhodndndninavcj1jjbfRbbaoSmeavcefgvcz9hmbxdkka5aKaO9havcm0VVmbasavc;WeV86bbxekasa8F86bbaeaa86bbaecefhekdna8EmbaKaA9Rgvcetavc8F917hvinaeavcFb0gocrtavcFbGV86bbavcr4hvaecefheaombkaKhAkdnaYcs9hmba8AaA9Rgvcetavc8F917hvinaeavcFb0gocrtavcFbGV86bbavcr4hvaecefheaombka8AhAkdnaEcs9hmba3aA9Rgvcetavc8F917hvinaeavcFb0gocrtavcFbGV86bbavcr4hvaecefheaombka3hAkalaXcdtfaKBdbaXcefcsGhvdndnaYPzbeeeeeeeeeeeeeebekalavcdtfa8ABdbaXcdfcsGhvkdndnaEPzbeeeeeeeeeeeeeebekalavcdtfa3BdbavcefcsGhvkcihoalc;abfaQcitfgEaKBdlaEa8ABdbaQcefcsGhYcdhEavhXaLhOxekcdhoalaXcdtfa3BdbcehEaXcefcsGhXaQhYkalc;abfaYcitfgva8ABdlava3Bdbalc;abfaQaEfcsGcitfgva3BdlavaKBdbascefhsaQaofcsGhQaCcifgCai6mbkkcbhvaeaP0mbcbhvinaeavfavcj1jjbfRbb86bbavcefgvcz9hmbkaeab9Ravfhvkalc;aef8KjjjjbavkZeeucbhddninadcefgdc8F0meceadtae6mbkkadcrfcFeGcr9Uci2cdfabci9U2cHfkmbcbabBd:e:kjjbk:ydewu8Jjjjjbcz9Rhlcbhvdnaicvfae0mbcbhvabcbRb:e:kjjbc;qeV86bbal9cb83iwabcefhoabaefc98fhrdnaiTmbcbhwcbhDindnaoar6mbcbskadaDcdtfydbgqalcwfawaqav9Rgvavc8F91gv7av9Rc507gwcdtfgkydb9Rgvc8E91c9:Gavcdt7awVhvinaoavcFb0gecrtavcFbGV86bbavcr4hvaocefhoaembkakaqBdbaqhvaDcefgDai9hmbkkcbhvaoar0mbaocbBbbaoab9RclfhvkavkBeeucbhddninadcefgdc8F0meceadtae6mbkkadcwfcFeGcr9Uab2cvfk:bvli99dui99ludnaeTmbcuadcetcuftcu7:Yhvdndncuaicuftcu7:YgoJbbbZMgr:lJbbb9p9DTmbar:Ohwxekcjjjj94hwkcbhicbhDinalclfIdbgrJbbbbJbbjZalIdbgq:lar:lMalcwfIdbgk:lMgr:varJbbbb9BEgrNhxaqarNhrdndnakJbbbb9GTmbaxhqxekJbbjZar:l:tgqaq:maxJbbbb9GEhqJbbjZax:l:tgxax:marJbbbb9GEhrkdndnalcxfIdbgxJbbj:;axJbbj:;9GEgkJbbjZakJbbjZ9FEavNJbbbZJbbb:;axJbbbb9GEMgx:lJbbb9p9DTmbax:Ohmxekcjjjj94hmkdndnaqJbbj:;aqJbbj:;9GEgxJbbjZaxJbbjZ9FEaoNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:OhPxekcjjjj94hPkdndnarJbbj:;arJbbj:;9GEgqJbbjZaqJbbjZ9FEaoNJbbbZJbbb:;arJbbbb9GEMgr:lJbbb9p9DTmbar:Ohsxekcjjjj94hskdndnadcl9hmbabaifgzas86bbazcifam86bbazcdfaw86bbazcefaP86bbxekabaDfgzas87ebazcofam87ebazclfaw87ebazcdfaP87ebkalczfhlaiclfhiaDcwfhDaecufgembkkk;hlld99eud99eudnaeTmbdndncuaicuftcu7:YgvJbbbZMgo:lJbbb9p9DTmbao:Ohixekcjjjj94hikaic;8FiGhrinabcofcicdalclfIdb:lalIdb:l9EgialcwfIdb:lalaicdtfIdb:l9EEgialcxfIdb:lalaicdtfIdb:l9EEgiarV87ebdndnJbbj:;JbbjZalaicdtfIdbJbbbb9DEgoalaicd7cdtfIdbJ;Zl:1ZNNgwJbbj:;awJbbj:;9GEgDJbbjZaDJbbjZ9FEavNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohqxekcjjjj94hqkabcdfaq87ebdndnalaicefciGcdtfIdbJ;Zl:1ZNaoNgwJbbj:;awJbbj:;9GEgDJbbjZaDJbbjZ9FEavNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohqxekcjjjj94hqkabaq87ebdndnaoalaicufciGcdtfIdbJ;Zl:1ZNNgoJbbj:;aoJbbj:;9GEgwJbbjZawJbbjZ9FEavNJbbbZJbbb:;aoJbbbb9GEMgo:lJbbb9p9DTmbao:Ohixekcjjjj94hikabclfai87ebabcwfhbalczfhlaecufgembkkk;3viDue99eu8Jjjjjbcjd9Rgo8Kjjjjbadcd4hrdndndndnavcd9hmbadcl6meaohwarhDinawc:CuBdbawclfhwaDcufgDmbkaeTmiadcl6mdarcdthqalhkcbhxinaohwakhDarhminawawydbgPcbaDIdbgs:8cL4cFeGc:cufasJbbbb9BEgzaPaz9kEBdbaDclfhDawclfhwamcufgmmbkakaqfhkaxcefgxaeSmixbkkaeTmdxekaeTmekarcdthkavce9hhqadcl6hdcbhxindndndnaqmbadmdc:CuhDalhwarhminaDcbawIdbgs:8cL4cFeGc:cufasJbbbb9BEgPaDaP9kEhDawclfhwamcufgmmbxdkkc:CuhDdndnavPleddbdkadmdaohwalhmarhPinawcbamIdbgs:8cL4cFeGgzc;:bazc;:b9kEc:cufasJbbbb9BEBdbamclfhmawclfhwaPcufgPmbxdkkadmecbhwarhminaoawfcbalawfIdbgs:8cL4cFeGgPc8AaPc8A9kEc:cufasJbbbb9BEBdbawclfhwamcufgmmbkkadmbcbhwarhPinaDhmdnavceSmbaoawfydbhmkdndnalawfIdbgscjjj;8iamai9RcefgmcLt9R::NJbbbZJbbb:;asJbbbb9GEMgs:lJbbb9p9DTmbas:Ohzxekcjjjj94hzkabawfazcFFFrGamcKtVBdbawclfhwaPcufgPmbkkabakfhbalakfhlaxcefgxae9hmbkkaocjdf8Kjjjjbk;HqdCui998Jjjjjbc:qd9Rgv8Kjjjjbavc:Sefcbc;KbzNjjjb8AcbhodnadTmbcbhoaiTmbdnabae9hmbavcuadcdtgradcFFFFi0Ecbyd:m:kjjbHjjjjbbgeBd:SeavceBd:mdaeabarz:tjjjb8Akavc:GefcwfcbBdbav9cb83i:Geavc:Gefaeadaiavc:Sefz:njjjbavyd:Gehwadci9UgDcbyd:m:kjjbHjjjjbbhravc:Sefavyd:mdgqcdtfarBdbavaqcefgkBd:mdarcbaDzNjjjbhxavc:SefakcdtfcuaicdtaicFFFFi0Ecbyd:m:kjjbHjjjjbbgmBdbavaqcdfgPBd:mdawhramhkinakalIdbalarydbgscwascw6Ecdtfc;ebfIdbMUdbarclfhrakclfhkaicufgimbkavc:SefaPcdtfcuaDcdtadcFFFF970Ecbyd:m:kjjbHjjjjbbgPBdbdnadci6mbaehraPhkaDhiinakamarydbcdtfIdbamarclfydbcdtfIdbMamarcwfydbcdtfIdbMUdbarcxfhrakclfhkaicufgimbkkaqcifhoavc;qbfhzavhravyd:KehHavyd:OehOcbhscbhkcbhAcehCinarhXcihQaeakci2gLcdtfgrydbhdarclfydbhqabaAcx2fgicwfarcwfydbgKBdbaiclfaqBdbaiadBdbaxakfce86bbazaKBdwazaqBdlazadBdbaPakcdtfcbBdbdnasTmbcihQaXhiinazaQcdtfaiydbgrBdbaQaraK9harad9haraq9hGGfhQaiclfhiascufgsmbkkaAcefhAcbhsinaOaHaeasaLfcdtfydbcdtgifydbcdtfgKhrawaifgqydbgdhidnadTmbdninarydbakSmearclfhraicufgiTmdxbkkaraKadcdtfc98fydbBdbaqaqydbcufBdbkascefgsci9hmbkdndnaQTmbcuhkJbbbbhYcbhqavyd:KehKavyd:OehLindndnawazaqcdtfydbcdtgsfydbgrmbaqcefhqxekaqcs0hiamasfgdIdbh8AadalcbaqcefgqaiEcdtfIdbalarcwarcw6Ecdtfc;ebfIdbMgEUdbaEa8A:thEarcdthiaLaKasfydbcdtfhrinaParydbgscdtfgdaEadIdbMg8AUdba8AaYaYa8A9DgdEhYasakadEhkarclfhraic98fgimbkkaqaQ9hmbkakcu9hmekaCaD9pmdindnaxaCfRbbmbaChkxdkaDaCcefgC9hmbxikkaQczaQcz6EhsazhraXhzakcu9hmbkkaocdtavc:Seffc98fhrdninaoTmearydbcbyd1:kjjbH:bjjjbbarc98fhraocufhoxbkkavc:qdf8Kjjjjbk;IlevucuaicdtgvaicFFFFi0Egocbyd:m:kjjbHjjjjbbhralalyd9GgwcdtfarBdbalawcefBd9GabarBdbaocbyd:m:kjjbHjjjjbbhralalyd9GgocdtfarBdbalaocefBd9GabarBdlcuadcdtadcFFFFi0Ecbyd:m:kjjbHjjjjbbhralalyd9GgocdtfarBdbalaocefBd9GabarBdwabydbcbavzNjjjb8Aadci9UhDdnadTmbabydbhoaehladhrinaoalydbcdtfgvavydbcefBdbalclfhlarcufgrmbkkdnaiTmbabydbhlabydlhrcbhvaihoinaravBdbarclfhralydbavfhvalclfhlaocufgombkkdnadci6mbabydlhrabydwhvcbhlinaecwfydbhoaeclfydbhdaraeydbcdtfgwawydbgwcefBdbavawcdtfalBdbaradcdtfgdadydbgdcefBdbavadcdtfalBdbaraocdtfgoaoydbgocefBdbavaocdtfalBdbaecxfheaDalcefgl9hmbkkdnaiTmbabydlheabydbhlinaeaeydbalydb9RBdbalclfhlaeclfheaicufgimbkkkQbabaeadaic:01jjbz:mjjjbkQbabaeadaic:C:jjjbz:mjjjbk9DeeuabcFeaicdtzNjjjbhlcbhbdnadTmbindnalaeydbcdtfgiydbcu9hmbaiabBdbabcefhbkaeclfheadcufgdmbkkabk;Wkivuo99lu8Jjjjjbc;W;Gb9Rgl8Kjjjjbcbhvalcj;Gbfcbc;KbzNjjjb8AalcuadcdtadcFFFFi0Egocbyd:m:kjjbHjjjjbbgrBdj9GalceBd;G9GalcFFF;7rBdwal9cFFF;7;3FF:;Fb83dbalcFFF97Bd;S9Gal9cFFF;7FFF:;u83d;K9Gaicd4hwdndnadmbJFFuFhDJFFuuhqJFFuuhkJFFuFhxJFFuuhmJFFuFhPxekawcdthsaehzincbhiinalaifgHazaifIdbgDaHIdbgxaxaD9EEUdbalc;K;GbfaifgHaDaHIdbgxaxaD9DEUdbaiclfgicx9hmbkazasfhzavcefgvad9hmbkalIdwhqalId;S9GhDalIdlhkalId;O9GhxalIdbhmalId;K9GhPkdndnadTmbJbbbbJbbjZJbbbbaPam:tgPaPJbbbb9DEgPaxak:tgxaxaP9DEgxaDaq:tgDaDax9DEgD:vaDJbbbb9BEhDawcdthsarhHadhzindndnaDaeIdbam:tNJb;au9eNJbbbZMgx:lJbbb9p9DTmbax:Ohixekcjjjj94hikaicztaicwtcj;GiGVaicsGVc:p;G:dKGcH2c;d;H:WKGcv2c;j:KM;jbGhvdndnaDaeclfIdbak:tNJb;au9eNJbbbZMgx:lJbbb9p9DTmbax:Ohixekcjjjj94hikaicztaicwtcj;GiGVaicsGVc:p;G:dKGcH2c;d;H:WKGcq2cM;j:KMeGavVhvdndnaDaecwfIdbaq:tNJb;au9eNJbbbZMgx:lJbbb9p9DTmbax:Ohixekcjjjj94hikaHavaicztaicwtcj;GiGVaicsGVc:p;G:dKGcH2c;d;H:WKGcC2c:KM;j:KdGVBdbaeasfheaHclfhHazcufgzmbkalcbcj;GbzNjjjbhiarhHadheinaiaHydbgzcFrGcx2fgvavydbcefBdbaiazcq4cFrGcx2fgvavydlcefBdlaiazcC4cFrGcx2fgzazydwcefBdwaHclfhHaecufgembxdkkalcbcj;GbzNjjjb8AkcbhHcbhzcbhecbhvinalaHfgiydbhsaiazBdbaicwfgwydbhOawavBdbaiclfgiydbhwaiaeBdbasazfhzaOavfhvawaefheaHcxfgHcj;Gb9hmbkcbhHalaocbyd:m:kjjbHjjjjbbgiBd:e9GdnadTmbabhzinazaHBdbazclfhzadaHcefgH9hmbkabhHadhzinalaraHydbgecdtfydbcFrGcx2fgvavydbgvcefBdbaiavcdtfaeBdbaHclfhHazcufgzmbkaihHadhzinalaraHydbgecdtfydbcq4cFrGcx2fgvavydlgvcefBdlabavcdtfaeBdbaHclfhHazcufgzmbkabhHadhzinalaraHydbgecdtfydbcC4cFrGcx2fgvavydwgvcefBdwaiavcdtfaeBdbaHclfhHazcufgzmbkcbhHinabaiydbcdtfaHBdbaiclfhiadaHcefgH9hmbkkclhidninaic98Smealcj;Gbfaifydbcbyd1:kjjbH:bjjjbbaic98fhixbkkalc;W;Gbf8Kjjjjbk9teiucbcbyd:q:kjjbgeabcifc98GfgbBd:q:kjjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabk9teiucbcbyd:q:kjjbgeabcrfc94GfgbBd:q:kjjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik9:eiuZbhedndncbyd:q:kjjbgdaecztgi9nmbcuheadai9RcFFifcz4nbcuSmekadhekcbabae9Rcifc98Gcbyd:q:kjjbfgdBd:q:kjjbdnadZbcztge9nmbadae9RcFFifcz4nb8Akkk:Iddbcjwk:edb4:h9w9N94:P:gW:j9O:ye9Pbbbbbbebbbdbbbebbbdbbbbbbbdbbbbbbbebbbbbbb:l29hZ;69:9kZ;N;76Z;rg97Z;z;o9xZ8J;B85Z;:;u9yZ;b;k9HZ:2;Z9DZ9e:l9mZ59A8KZ:r;T3Z:A:zYZ79OHZ;j4::8::Y:D9V8:bbbb9s:49:Z8R:hBZ9M9M;M8:L;z;o8:;8:PG89q;x:J878R:hQ8::M:B;e87bbbbbbjZbbjZbbjZ:E;V;N8::Y:DsZ9i;H;68:xd;R8:;h0838:;W:NoZbbbb:WV9O8:uf888:9i;H;68:9c9G;L89;n;m9m89;D8Ko8:bbbbf:8tZ9m836ZS:2AZL;zPZZ818EZ9e:lxZ;U98F8:819E;68:bc:eqkzebbbebbbdbbba:vbb",t=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if(typeof WebAssembly!="object")return{supported:!1};var n,i=WebAssembly.instantiate(o(e),{}).then(function(g){n=g.instance,n.exports.__wasm_call_ctors(),n.exports.meshopt_encodeVertexVersion(0),n.exports.meshopt_encodeIndexVersion(1)});function o(g){for(var m=new Uint8Array(g.length),y=0;y<g.length;++y){var b=g.charCodeAt(y);m[y]=b>96?b-97:b>64?b-39:b+4}for(var C=0,y=0;y<g.length;++y)m[C++]=m[y]<60?t[m[y]]:(m[y]-60)*64+m[++y];return m.buffer.slice(0,C)}function r(g){if(!g)throw new Error("Assertion failed")}function s(g){return new Uint8Array(g.buffer,g.byteOffset,g.byteLength)}function a(g,m,y,b){var C=n.exports.sbrk,A=C(m.length*4),T=C(y*4),E=new Uint8Array(n.exports.memory.buffer),v=s(m);E.set(v,A),b&&b(A,A,m.length,y);var D=g(T,A,m.length,y);E=new Uint8Array(n.exports.memory.buffer);var O=new Uint32Array(y);new Uint8Array(O.buffer).set(E.subarray(T,T+y*4)),v.set(E.subarray(A,A+m.length*4)),C(A-C(0));for(var P=0;P<m.length;++P)m[P]=O[m[P]];return[O,D]}function c(g,m,y,b){var C=n.exports.sbrk,A=C(y*4),T=C(y*b),E=new Uint8Array(n.exports.memory.buffer);E.set(s(m),T),g(A,T,y,b),E=new Uint8Array(n.exports.memory.buffer);var v=new Uint32Array(y);return new Uint8Array(v.buffer).set(E.subarray(A,A+y*4)),C(A-C(0)),v}function l(g,m,y,b,C){var A=n.exports.sbrk,T=A(m),E=A(b*C),v=new Uint8Array(n.exports.memory.buffer);v.set(s(y),E);var D=g(T,m,E,b,C),O=new Uint8Array(D);return O.set(v.subarray(T,T+D)),A(T-A(0)),O}function f(g){for(var m=0,y=0;y<g.length;++y){var b=g[y];m=m<b?b:m}return m}function d(g,m){if(r(m==2||m==4),m==4)return new Uint32Array(g.buffer,g.byteOffset,g.byteLength/4);var y=new Uint16Array(g.buffer,g.byteOffset,g.byteLength/2);return new Uint32Array(y)}function p(g,m,y,b,C,A,T){var E=n.exports.sbrk,v=E(y*b),D=E(y*A),O=new Uint8Array(n.exports.memory.buffer);O.set(s(m),D),g(v,y,b,C,D,T);var P=new Uint8Array(y*b);return P.set(O.subarray(v,v+y*b)),E(v-E(0)),P}return{ready:i,supported:!0,reorderMesh:function(g,m,y){var b=m?y?n.exports.meshopt_optimizeVertexCacheStrip:n.exports.meshopt_optimizeVertexCache:void 0;return a(n.exports.meshopt_optimizeVertexFetchRemap,g,f(g)+1,b)},reorderPoints:function(g,m){return r(g instanceof Float32Array),r(g.length%m==0),r(m>=3),c(n.exports.meshopt_spatialSortRemap,g,g.length/m,m*4)},encodeVertexBuffer:function(g,m,y){r(y>0&&y<=256),r(y%4==0);var b=n.exports.meshopt_encodeVertexBufferBound(m,y);return l(n.exports.meshopt_encodeVertexBuffer,b,g,m,y)},encodeIndexBuffer:function(g,m,y){r(y==2||y==4),r(m%3==0);var b=d(g,y),C=n.exports.meshopt_encodeIndexBufferBound(m,f(b)+1);return l(n.exports.meshopt_encodeIndexBuffer,C,b,m,4)},encodeIndexSequence:function(g,m,y){r(y==2||y==4);var b=d(g,y),C=n.exports.meshopt_encodeIndexSequenceBound(m,f(b)+1);return l(n.exports.meshopt_encodeIndexSequence,C,b,m,4)},encodeGltfBuffer:function(g,m,y,b){var C={ATTRIBUTES:this.encodeVertexBuffer,TRIANGLES:this.encodeIndexBuffer,INDICES:this.encodeIndexSequence};return r(C[b]),C[b](g,m,y)},encodeFilterOct:function(g,m,y,b){return r(y==4||y==8),r(b>=1&&b<=16),p(n.exports.meshopt_encodeFilterOct,g,m,y,b,16)},encodeFilterQuat:function(g,m,y,b){return r(y==8),r(b>=4&&b<=16),p(n.exports.meshopt_encodeFilterQuat,g,m,y,b,16)},encodeFilterExp:function(g,m,y,b,C){r(y>0&&y%4==0),r(b>=1&&b<=24);var A={Separate:0,SharedVector:1,SharedComponent:2,Clamped:3};return p(n.exports.meshopt_encodeFilterExp,g,m,y,b,y,C?A[C]:1)}}}();var qie=function(){var e="b9H79Tebbbe8Fv9Gbb9Gvuuuuueu9Giuuub9Geueu9Giuuueuikqbeeedddillviebeoweuec:q:Odkr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbeY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVbdE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbiL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtblK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbol79IV9Rbrq;w8Wqdbk;esezu8Jjjjjbcj;eb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Radz1jjjbhwcj;abad9Uc;WFbGgocjdaocjd6EhDaicefhocbhqdnindndndnaeaq9nmbaDaeaq9RaqaDfae6Egkcsfglcl4cifcd4hxalc9WGgmTmecbhPawcjdfhsaohzinaraz9Rax6mvarazaxfgo9RcK6mvczhlcbhHinalgic9WfgOawcj;cbffhldndndndndnazaOco4fRbbaHcoG4ciGPlbedibkal9cb83ibalcwf9cb83ibxikalaoRblaoRbbgOco4gAaAciSgAE86bbawcj;cbfaifglcGfaoclfaAfgARbbaOcl4ciGgCaCciSgCE86bbalcVfaAaCfgARbbaOcd4ciGgCaCciSgCE86bbalc7faAaCfgARbbaOciGgOaOciSgOE86bbalctfaAaOfgARbbaoRbegOco4gCaCciSgCE86bbalc91faAaCfgARbbaOcl4ciGgCaCciSgCE86bbalc4faAaCfgARbbaOcd4ciGgCaCciSgCE86bbalc93faAaCfgARbbaOciGgOaOciSgOE86bbalc94faAaOfgARbbaoRbdgOco4gCaCciSgCE86bbalc95faAaCfgARbbaOcl4ciGgCaCciSgCE86bbalc96faAaCfgARbbaOcd4ciGgCaCciSgCE86bbalc97faAaCfgARbbaOciGgOaOciSgOE86bbalc98faAaOfgORbbaoRbigoco4gAaAciSgAE86bbalc99faOaAfgORbbaocl4ciGgAaAciSgAE86bbalc9:faOaAfgORbbaocd4ciGgAaAciSgAE86bbalcufaOaAfglRbbaociGgoaociSgoE86bbalaofhoxdkalaoRbwaoRbbgOcl4gAaAcsSgAE86bbawcj;cbfaifglcGfaocwfaAfgARbbaOcsGgOaOcsSgOE86bbalcVfaAaOfgORbbaoRbegAcl4gCaCcsSgCE86bbalc7faOaCfgORbbaAcsGgAaAcsSgAE86bbalctfaOaAfgORbbaoRbdgAcl4gCaCcsSgCE86bbalc91faOaCfgORbbaAcsGgAaAcsSgAE86bbalc4faOaAfgORbbaoRbigAcl4gCaCcsSgCE86bbalc93faOaCfgORbbaAcsGgAaAcsSgAE86bbalc94faOaAfgORbbaoRblgAcl4gCaCcsSgCE86bbalc95faOaCfgORbbaAcsGgAaAcsSgAE86bbalc96faOaAfgORbbaoRbvgAcl4gCaCcsSgCE86bbalc97faOaCfgORbbaAcsGgAaAcsSgAE86bbalc98faOaAfgORbbaoRbogAcl4gCaCcsSgCE86bbalc99faOaCfgORbbaAcsGgAaAcsSgAE86bbalc9:faOaAfgORbbaoRbrgocl4gAaAcsSgAE86bbalcufaOaAfglRbbaocsGgoaocsSgoE86bbalaofhoxekalao8Pbb83bbalcwfaocwf8Pbb83bbaoczfhokdnaiam9pmbaHcdfhHaiczfhlarao9RcL0mekkaiam6mvaoTmvdnakTmbawaPfRbbhHawcj;cbfhlashiakhOinaialRbbgzce4cbazceG9R7aHfgH86bbaiadfhialcefhlaOcufgOmbkkascefhsaohzaPcefgPad9hmbxikkcbc99arao9Radcaadca0ESEhoxlkaoaxad2fhCdnakmbadhlinaoTmlarao9Rax6mlaoaxfhoalcufglmbkaChoxekcbhmawcjdfhAinarao9Rax6miawamfRbbhHawcj;cbfhlaAhiakhOinaialRbbgzce4cbazceG9R7aHfgH86bbaiadfhialcefhlaOcufgOmbkaAcefhAaoaxfhoamcefgmad9hmbkaChokabaqad2fawcjdfakad2z1jjjb8Aawawcjdfakcufad2fadz1jjjb8Aakaqfhqaombkc9:hoxekc9:hokavcj;ebf8Kjjjjbaok;cseHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgwce0mbavc;abfcFecjez:jjjjb8AavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhDaicefgqarfhidnaeTmbcmcsawceSEhkcbhxcbhmcbhPcbhwcbhlindnaiaD9nmbc9:hoxikdndnaqRbbgoc;Ve0mbavc;abfalaocu7gscl4fcsGcitfgzydlhrazydbhzdnaocsGgHak9pmbavawasfcsGcdtfydbaxaHEhoaHThsdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkaxasfhxcdhHavawcdtfaoBdbawasfhwcehsalhOxdkdndnaHcsSmbaHc987aHamffcefhoxekaicefhoai8SbbgHcFeGhsdndnaHcu9mmbaohixekaicvfhiascFbGhscrhHdninao8SbbgOcFbGaHtasVhsaOcu9kmeaocefhoaHcrfgHc8J9hmbxdkkaocefhikasce4cbasceG9R7amfhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhHavawcdtfaoBdbcehsawcefhwalhOaohmxekdnaocpe0mbaxcefgHavawaDaocsGfRbbgocl49RcsGcdtfydbaocz6gzEhravawao9RcsGcdtfydbaHazfgAaocsGgHEhoaHThCdndnadcd9hmbabaPcetfgHax87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHaxBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfaxBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgOaxBdlaOarBdbavawazfgwcsGcdtfaoBdbalcefcsGhOawaCfhwaxhzaAaCfhxxekaxcbaiRbbgOEgzaoc;:eSgHfhraOcsGhCaOcl4hAdndnaOcs0mbarcefhoxekarhoavawaA9RcsGcdtfydbhrkdndnaCmbaocefhxxekaohxavawaO9RcsGcdtfydbhokdndnaHTmbaicefhHxekaicdfhHai8SbegscFeGhzdnascu9kmbaicofhXazcFbGhzcrhidninaH8SbbgscFbGaitazVhzascu9kmeaHcefhHaicrfgic8J9hmbkaXhHxekaHcefhHkazce4cbazceG9R7amfgmhzkdndnaAcsSmbaHhsxekaHcefhsaH8SbbgicFeGhrdnaicu9kmbaHcvfhXarcFbGhrcrhidninas8SbbgHcFbGaitarVhraHcu9kmeascefhsaicrfgic8J9hmbkaXhsxekascefhskarce4cbarceG9R7amfgmhrkdndnaCcsSmbashixekascefhias8SbbgocFeGhHdnaocu9kmbascvfhXaHcFbGhHcrhodninai8SbbgscFbGaotaHVhHascu9kmeaicefhiaocrfgoc8J9hmbkaXhixekaicefhikaHce4cbaHceG9R7amfgmhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfazBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgXazBdlaXarBdbavawaOcz6aAcsSVfgwcsGcdtfaoBdbawaCTaCcsSVfhwalcefcsGhOkaqcefhqavc;abfaOcitfgOarBdlaOaoBdbavc;abfalasfcsGcitfgraoBdlarazBdbawcsGhwalaHfcsGhlaPcifgPae6mbkkcbc99aiaDSEhokavc;aef8Kjjjjbaok:flevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:Lvoeue99dud99eud99dndnadcl9hmbaeTmeindndnabcdfgd8Sbb:Yab8Sbbgi:Ygl:l:tabcefgv8Sbbgo:Ygr:l:tgwJbb;:9cawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai86bbdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad86bbdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad86bbabclfhbaecufgembxdkkaeTmbindndnabclfgd8Ueb:Yab8Uebgi:Ygl:l:tabcdfgv8Uebgo:Ygr:l:tgwJb;:FSawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai87ebdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad87ebdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad87ebabcwfhbaecufgembkkk;oiliui99iue99dnaeTmbcbhiabhlindndnJ;Zl81Zalcof8UebgvciV:Y:vgoal8Ueb:YNgrJb;:FSNJbbbZJbbb:;arJbbbb9GEMgw:lJbbb9p9DTmbaw:OhDxekcjjjj94hDkalclf8Uebhqalcdf8UebhkabaiavcefciGfcetfaD87ebdndnaoak:YNgwJb;:FSNJbbbZJbbb:;awJbbbb9GEMgx:lJbbb9p9DTmbax:OhDxekcjjjj94hDkabaiavciGfgkcd7cetfaD87ebdndnaoaq:YNgoJb;:FSNJbbbZJbbb:;aoJbbbb9GEMgx:lJbbb9p9DTmbax:OhDxekcjjjj94hDkabaiavcufciGfcetfaD87ebdndnJbbjZararN:tawawN:taoaoN:tgrJbbbbarJbbbb9GE:rJb;:FSNJbbbZMgr:lJbbb9p9DTmbar:Ohvxekcjjjj94hvkabakcetfav87ebalcwfhlaiclfhiaecufgembkkk9mbdnadcd4ae2gdTmbinababydbgecwtcw91:Yaece91cjjj98Gcjjj;8if::NUdbabclfhbadcufgdmbkkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabkkkebcjwklzNbb",t="b9H79TebbbeKl9Gbb9Gvuuuuueu9Giuuub9Geueuikqbbebeedddilve9Weeeviebeoweuec:q:6dkr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbdY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVblE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtboK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbrL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbwl79IV9RbDq:p9sqlbzik9:evu8Jjjjjbcz9Rhbcbheincbhdcbhiinabcwfadfaicjuaead4ceGglE86bbaialfhiadcefgdcw9hmbkaec:q:yjjbfai86bbaecitc:q1jjbfab8Piw83ibaecefgecjd9hmbkk:N8JlHud97euo978Jjjjjbcj;kb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Rad;8qbbcj;abad9UhlaicefhodnaeTmbadTmbalc;WFbGglcjdalcjd6EhwcbhDinawaeaD9RaDawfae6Egqcsfglc9WGgkci2hxakcethmalcl4cifcd4hPabaDad2fhsakc;ab6hzcbhHincbhOaohAdndninaraA9RaP6meavcj;cbfaOak2fhCaAaPfhocbhidnazmbarao9Rc;Gb6mbcbhlinaCalfhidndndndndnaAalco4fRbbgXciGPlbedibkaipxbbbbbbbbbbbbbbbbpklbxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaiaopbbbpklbaoczfhokdndndndndnaXcd4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklzxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaiaopbbbpklzaoczfhokdndndndndnaXcl4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklaxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaiaopbbbpklaaoczfhokdndndndndnaXco4Plbedibkaipxbbbbbbbbbbbbbbbbpkl8WxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WaoclfaYpQbfaXc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WaocwfaYpQbfaXc:q:yjjbfRbbfhoxekaiaopbbbpkl8Waoczfhokalc;abfhialcjefak0meaihlarao9Rc;Fb0mbkkdnaiak9pmbaici4hlinarao9RcK6miaCaifhXdndndndndnaAaico4fRbbalcoG4ciGPlbedibkaXpxbbbbbbbbbbbbbbbbpkbbxikaXaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkbbaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaXaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkbbaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaXaopbbbpkbbaoczfhokalcdfhlaiczfgiak6mbkkaoTmeaohAaOcefgOclSmdxbkkc9:hoxlkdnakTmbavcjdfaHfhiavaHfpbdbhYcbhXinaiavcj;cbfaXfglpblbgLcep9TaLpxeeeeeeeeeeeeeeeegQp9op9Hp9rgLalakfpblbg8Acep9Ta8AaQp9op9Hp9rg8ApmbzeHdOiAlCvXoQrLgEalamfpblbg3cep9Ta3aQp9op9Hp9rg3alaxfpblbg5cep9Ta5aQp9op9Hp9rg5pmbzeHdOiAlCvXoQrLg8EpmbezHdiOAlvCXorQLgQaQpmbedibedibedibediaYp9UgYp9AdbbaiadfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfglaYaEa8EpmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaladfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfglaYaLa8ApmwKDYq8AkEx3m5P8Es8FgLa3a5pmwKDYq8AkEx3m5P8Es8Fg8ApmbezHdiOAlvCXorQLgQaQpmbedibedibedibedip9UgYp9AdbbaladfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfglaYaLa8ApmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaladfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfhiaXczfgXak6mbkkaHclfgHad6mbkasavcjdfaqad2;8qbbavavcjdfaqcufad2fad;8qbbaqaDfgDae6mbkkcbc99arao9Radcaadca0ESEhokavcj;kbf8Kjjjjbaokwbz:bjjjbk::seHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgwce0mbavc;abfcFecje;8kbavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhDaicefgqarfhidnaeTmbcmcsawceSEhkcbhxcbhmcbhPcbhwcbhlindnaiaD9nmbc9:hoxikdndnaqRbbgoc;Ve0mbavc;abfalaocu7gscl4fcsGcitfgzydlhrazydbhzdnaocsGgHak9pmbavawasfcsGcdtfydbaxaHEhoaHThsdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkaxasfhxcdhHavawcdtfaoBdbawasfhwcehsalhOxdkdndnaHcsSmbaHc987aHamffcefhoxekaicefhoai8SbbgHcFeGhsdndnaHcu9mmbaohixekaicvfhiascFbGhscrhHdninao8SbbgOcFbGaHtasVhsaOcu9kmeaocefhoaHcrfgHc8J9hmbxdkkaocefhikasce4cbasceG9R7amfhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhHavawcdtfaoBdbcehsawcefhwalhOaohmxekdnaocpe0mbaxcefgHavawaDaocsGfRbbgocl49RcsGcdtfydbaocz6gzEhravawao9RcsGcdtfydbaHazfgAaocsGgHEhoaHThCdndnadcd9hmbabaPcetfgHax87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHaxBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfaxBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgOaxBdlaOarBdbavawazfgwcsGcdtfaoBdbalcefcsGhOawaCfhwaxhzaAaCfhxxekaxcbaiRbbgOEgzaoc;:eSgHfhraOcsGhCaOcl4hAdndnaOcs0mbarcefhoxekarhoavawaA9RcsGcdtfydbhrkdndnaCmbaocefhxxekaohxavawaO9RcsGcdtfydbhokdndnaHTmbaicefhHxekaicdfhHai8SbegscFeGhzdnascu9kmbaicofhXazcFbGhzcrhidninaH8SbbgscFbGaitazVhzascu9kmeaHcefhHaicrfgic8J9hmbkaXhHxekaHcefhHkazce4cbazceG9R7amfgmhzkdndnaAcsSmbaHhsxekaHcefhsaH8SbbgicFeGhrdnaicu9kmbaHcvfhXarcFbGhrcrhidninas8SbbgHcFbGaitarVhraHcu9kmeascefhsaicrfgic8J9hmbkaXhsxekascefhskarce4cbarceG9R7amfgmhrkdndnaCcsSmbashixekascefhias8SbbgocFeGhHdnaocu9kmbascvfhXaHcFbGhHcrhodninai8SbbgscFbGaotaHVhHascu9kmeaicefhiaocrfgoc8J9hmbkaXhixekaicefhikaHce4cbaHceG9R7amfgmhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfazBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgXazBdlaXarBdbavawaOcz6aAcsSVfgwcsGcdtfaoBdbawaCTaCcsSVfhwalcefcsGhOkaqcefhqavc;abfaOcitfgOarBdlaOaoBdbavc;abfalasfcsGcitfgraoBdlarazBdbawcsGhwalaHfcsGhlaPcifgPae6mbkkcbc99aiaDSEhokavc;aef8Kjjjjbaok:flevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:wPliuo97eue978Jjjjjbca9Rhiaec98Ghldndnadcl9hmbdnalTmbcbhvabhdinadadpbbbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpkbbadczfhdavclfgval6mbkkalaeSmeaipxbbbbbbbbbbbbbbbbgqpklbaiabalcdtfgdaeciGglcdtgv;8qbbdnalTmbaiaipblbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDaqp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpklbkadaiav;8qbbskdnalTmbcbhvabhdinadczfgxaxpbbbgopxbbbbbbFFbbbbbbFFgkp9oadpbbbgDaopmbediwDqkzHOAKY8AEgwczp:Reczp:Sep;6egraDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eawczp:Sep;6egwp;Gearp;Gep;Kep;Legopxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegrpxb;:FSb;:FSb;:FSb;:FSararp;Meaoaop;Meawaqawamp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFFbbFFbbFFbbFFbbp9oaoawp;Meaqp;Keczp:Rep9qgoarawp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogrpmwDKYqk8AExm35Ps8E8Fp9qpkbbadaDakp9oaoarpmbezHdiOAlvCXorQLp9qpkbbadcafhdavclfgval6mbkkalaeSmbaiaeciGgvcitgdfcbcaad9R;8kbaiabalcitfglad;8qbbdnavTmbaiaipblzgopxbbbbbbFFbbbbbbFFgkp9oaipblbgDaopmbediwDqkzHOAKY8AEgwczp:Reczp:Sep;6egraDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eawczp:Sep;6egwp;Gearp;Gep;Kep;Legopxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegrpxb;:FSb;:FSb;:FSb;:FSararp;Meaoaop;Meawaqawamp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFFbbFFbbFFbbFFbbp9oaoawp;Meaqp;Keczp:Rep9qgoarawp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogrpmwDKYqk8AExm35Ps8E8Fp9qpklzaiaDakp9oaoarpmbezHdiOAlvCXorQLp9qpklbkalaiad;8qbbkk;4wllue97euv978Jjjjjbc8W9Rhidnaec98GglTmbcbhvabhoinaiaopbbbgraoczfgwpbbbgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklbaopxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaDakp;Mearp;Keamp9oaqakp;Mearp;Keczp:Rep9qgkpmbezHdiOAlvCXorQLgrp5baipblbpEb:T:j83ibaocwfarp5eaipblbpEe:T:j83ibawaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblbpEd:T:j83ibaocKfakp5eaipblbpEi:T:j83ibaocafhoavclfgval6mbkkdnalaeSmbaiaeciGgvcitgofcbcaao9R;8kbaiabalcitfgwao;8qbbdnavTmbaiaipblbgraipblzgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklaaipxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaDakp;Mearp;Keamp9oaqakp;Mearp;Keczp:Rep9qgkpmbezHdiOAlvCXorQLgrp5baipblapEb:T:j83ibaiarp5eaipblapEe:T:j83iwaiaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblapEd:T:j83izaiakp5eaipblapEi:T:j83iKkawaiao;8qbbkk:Pddiue978Jjjjjbc;ab9Rhidnadcd4ae2glc98GgvTmbcbheabhdinadadpbbbgocwp:Recwp:Sep;6eaocep:SepxbbjFbbjFbbjFbbjFp9opxbbjZbbjZbbjZbbjZp:Uep;Mepkbbadczfhdaeclfgeav6mbkkdnavalSmbaialciGgecdtgdVcbc;abad9R;8kbaiabavcdtfgvad;8qbbdnaeTmbaiaipblbgocwp:Recwp:Sep;6eaocep:SepxbbjFbbjFbbjFbbjFp9opxbbjZbbjZbbjZbbjZp:Uep;Mepklbkavaiad;8qbbkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaikkkebcjwklz:Dbb",n=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),i=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if(typeof WebAssembly!="object")return{supported:!1};var o=WebAssembly.validate(n)?a(t):a(e),r,s=WebAssembly.instantiate(o,{}).then(function(C){r=C.instance,r.exports.__wasm_call_ctors()});function a(C){for(var A=new Uint8Array(C.length),T=0;T<C.length;++T){var E=C.charCodeAt(T);A[T]=E>96?E-97:E>64?E-39:E+4}for(var v=0,T=0;T<C.length;++T)A[v++]=A[T]<60?i[A[T]]:(A[T]-60)*64+A[++T];return A.buffer.slice(0,v)}function c(C,A,T,E,v,D,O){var P=C.exports.sbrk,M=E+3&-4,L=P(M*v),_=P(D.length),S=new Uint8Array(C.exports.memory.buffer);S.set(D,_);var w=A(L,E,v,_,D.length);if(w==0&&O&&O(L,M,v),T.set(S.subarray(L,L+E*v)),P(L-P(0)),w!=0)throw new Error("Malformed buffer data: "+w)}var l={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},f={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"},d=[],p=0;function g(C){var A={object:new Worker(C),pending:0,requests:{}};return A.object.onmessage=function(T){var E=T.data;A.pending-=E.count,A.requests[E.id][E.action](E.value),delete A.requests[E.id]},A}function m(C){for(var A="self.ready = WebAssembly.instantiate(new Uint8Array(["+new Uint8Array(o)+"]), {}).then(function(result) { result.instance.exports.__wasm_call_ctors(); return result.instance; });self.onmessage = "+b.name+";"+c.toString()+b.toString(),T=new Blob([A],{type:"text/javascript"}),E=URL.createObjectURL(T),v=d.length;v<C;++v)d[v]=g(E);for(var v=C;v<d.length;++v)d[v].object.postMessage({});d.length=C,URL.revokeObjectURL(E)}function y(C,A,T,E,v){for(var D=d[0],O=1;O<d.length;++O)d[O].pending<D.pending&&(D=d[O]);return new Promise(function(P,M){var L=new Uint8Array(T),_=++p;D.pending+=C,D.requests[_]={resolve:P,reject:M},D.object.postMessage({id:_,count:C,size:A,source:L,mode:E,filter:v},[L.buffer])})}function b(C){var A=C.data;if(!A.id)return self.close();self.ready.then(function(T){try{var E=new Uint8Array(A.count*A.size);c(T,T.exports[A.mode],E,A.count,A.size,A.source,T.exports[A.filter]),self.postMessage({id:A.id,count:A.count,action:"resolve",value:E},[E.buffer])}catch(v){self.postMessage({id:A.id,count:A.count,action:"reject",value:v})}})}return{ready:s,supported:!0,useWorkers:function(C){m(C)},decodeVertexBuffer:function(C,A,T,E,v){c(r,r.exports.meshopt_decodeVertexBuffer,C,A,T,E,r.exports[l[v]])},decodeIndexBuffer:function(C,A,T,E){c(r,r.exports.meshopt_decodeIndexBuffer,C,A,T,E)},decodeIndexSequence:function(C,A,T,E){c(r,r.exports.meshopt_decodeIndexSequence,C,A,T,E)},decodeGltfBuffer:function(C,A,T,E,v,D){c(r,r.exports[f[v]],C,A,T,E,r.exports[l[D]])},decodeGltfBufferAsync:function(C,A,T,E,v){return d.length>0?y(C,A,T,f[E],l[v]):s.then(function(){var D=new Uint8Array(C*A);return c(r,r.exports[f[E]],D,C,A,T,r.exports[l[v]]),D})}}}();var Len=function(){var e="b9H79Tebbbe9Hk9Geueu9Geub9Gbb9Gsuuuuuuuuuuuu99uueu9Gvuuuuub9Gvuuuuue999Gquuuuuuu99uueu9Gwuuuuuu99ueu9Giuuue999Gluuuueu9GiuuueuizsdilvoirwDbqqbeqlve9Weiiviebeoweuecj:Pdkr:Tewo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bbz9TW79O9V9Wt9F79P9T9W29P9M95bl8E9TW79O9V9Wt9F79P9T9W29P9M959x9Pt9OcttV9P9I91tW7bvQ9TW79O9V9Wt9F79P9T9W29P9M959q9V9P9Ut7boX9TW79O9V9Wt9F79P9T9W29P9M959t9J9H2Wbra9TW79O9V9Wt9F9V9Wt9P9T9P96W9wWVtW94SWt9J9O9sW9T9H9Wbwl79IV9RbDDwebcekdmxq;UMesdbk:kfvKue99euY99Qu8Jjjjjbc;W;qb9Rgs8Kjjjjbcbhzascxfcbc;Kbz:ljjjb8AdnabaeSmbabaeadcdtz:kjjjb8AkdnamcdGTmbalcrfci4gHcbyd;S1jjbHjjjjbbheascxfasyd2gOcdtfaeBdbasaOcefBd2aecbaHz:ljjjbhAcbhlcbhednadTmbcbhlabheadhHinaAaeydbgOci4fgCaCRbbgCceaOcrGgOtV86bbaCcu7aO4ceGalfhlaeclfheaHcufgHmbkcualcdtalcFFFFi0Ehekaecbyd;S1jjbHjjjjbbhzascxfasyd2gecdtfazBdbasaecefBd2alcd4alfhOcehHinaHgecethHaeaO6mbkcbhXcuaecdtgOaecFFFFi0Ecbyd;S1jjbHjjjjbbhHascxfasyd2gCcdtfaHBdbasaCcefBd2aHcFeaOz:ljjjbhQdnadTmbaecufhCcbhLinabaXcdtfgKydbgAc:v;t;h;Ev2hOcbhedndninaQaOaCGgOcdtfgYydbgHcuSmeazaHcdtfydbaASmdaecefgeaOfhOaeaC9nmbxdkkazaLcdtfaABdbaYaLBdbaLhHaLcefhLkaKaHBdbaXcefgXad9hmbkkaQcbyd;O1jjbH:bjjjbbasasyd2cufBd2kcualcefgecdtaecFFFFi0Ecbyd;S1jjbHjjjjbbh8Aascxfasyd2gecdtfa8ABdbasa8ABdlasaecefBd2cuadcitadcFFFFe0Ecbyd;S1jjbHjjjjbbhEascxfasyd2gecdtfaEBdbasaEBdwasaecefBd2asclfabadalcbz:cjjjbcualcdtg3alcFFFFi0Eg5cbyd;S1jjbHjjjjbbhQascxfasyd2gecdtfaQBdbasaecefBd2a5cbyd;S1jjbHjjjjbbh8Eascxfasyd2gecdtfa8EBdbasaecefBd2alcd4alfhOcehHinaHgecethHaeaO6mbkcbhLcuaecdtgOaecFFFFi0Ecbyd;S1jjbHjjjjbbhHascxfasyd2gCcdtfaHBdbasaCcefBd2aHcFeaOz:ljjjbhXdnalTmbavcd4hCaecufhHinaLhednazTmbazaLcdtfydbhekaiaeaC2cdtfgeydlgOcH4aO7c:F:b:DD2aeydbgOcH4aO7c;D;O:B8J27aeydwgecH4ae7c:3F;N8N27aHGheaLcdth8FdndndndndnazTmbaza8FfhKcbhOinaXaecdtfgYydbgAcuSmlaiazaAcdtfydbaC2cdtfaiaKydbaC2cdtfcxz:ojjjbTmiaOcefgOaefaHGheaOaH9nmbxdkkaiaLaC2cdtfhKcbhOinaXaecdtfgYydbgAcuSmiaiaAaC2cdtfaKcxz:ojjjbTmdaOcefgOaefaHGheaOaH9nmbkkcbhYkaYydbgecu9hmekaYaLBdbaLhekaQa8FfaeBdbaLcefgLal9hmbkcbhea8EhHinaHaeBdbaHclfhHalaecefge9hmbkcbheaQhHa8EhOindnaeaHydbgCSmbaOa8EaCcdtfgCydbBdbaCaeBdbkaHclfhHaOclfhOalaecefge9hmbkkcbhaaXcbyd;O1jjbH:bjjjbbasasyd2cufBd2alcbyd;S1jjbHjjjjbbhXascxfasyd2gecdtfaXBdbasaecefBd2a5cbyd;S1jjbHjjjjbbheascxfasyd2gHcdtfaeBdbasaHcefBd2a5cbyd;S1jjbHjjjjbbhHascxfasyd2gOcdtfaHBdbasaOcefBd2aecFea3z:ljjjbhhaHcFea3z:ljjjbhgdnalTmbaEcwfh8Jindna8AaagOcefgacdtfydbgCa8AaOcdtgefydbgHSmbaCaH9Rh8FaEaHcitfh3agaefh8KahaefhLcbhAindndna3aAcitfydbgYaO9hmbaLaOBdba8KaOBdbxekdna8AaYcdtg8LfgeclfydbgHaeydbgeSmbaEaecitgCfydbaOSmeaHae9Rh8Maecu7aHfhKa8JaCfhHcbheinaKaeSmeaecefheaHydbhCaHcwfhHaCaO9hmbkaea8M6mekaga8LfgeaOaYaeydbcuSEBdbaLaYaOaLydbcuSEBdbkaAcefgAa8F9hmbkkaaal9hmbkaQhHa8EhOaghCahhAcbheindndnaeaHydbgY9hmbdnaeaOydbgY9hmbaAydbhYdnaCydbgKcu9hmbaYcu9hmbaXaefcb86bbxikaXaefhLdnaeaKSmbaeaYSmbaLce86bbxikaLcl86bbxdkdnaea8EaYcdtgKfydb9hmbdnaCydbgLcuSmbaeaLSmbaAydbg8FcuSmbaea8FSmbagaKfydbg3cuSmba3aYSmbahaKfydbgKcuSmbaKaYSmbdnaQaLcdtfydbgYaQaKcdtfydb9hmbaYaQa8FcdtfydbgKSmbaKaQa3cdtfydb9hmbaXaefcd86bbxlkaXaefcl86bbxikaXaefcl86bbxdkaXaefcl86bbxekaXaefaXaYfRbb86bbkaHclfhHaOclfhOaCclfhCaAclfhAalaecefge9hmbkdnaqTmbdndnazTmbazheaQhHalhOindnaqaeydbfRbbTmbaXaHydbfcl86bbkaeclfheaHclfhHaOcufgOmbxdkkaQhealhHindnaqRbbTmbaXaeydbfcl86bbkaqcefhqaeclfheaHcufgHmbkkaQhealhOaXhHindnaXaeydbfRbbcl9hmbaHcl86bbkaeclfheaHcefhHaOcufgOmbkkamceGTmbaXhealhHindnaeRbbce9hmbaecl86bbkaecefheaHcufgHmbkkcualcx2alc;v:Q;v:Qe0Ecbyd;S1jjbHjjjjbbhaascxfasyd2gecdtfaaBdbasaecefBd2aaaialavazz:djjjbh8NdndnaDmbcbhycbh8Jxekcbh8JawhecbhHindnaeIdbJbbbb9ETmbasc;Wbfa8JcdtfaHBdba8Jcefh8JkaeclfheaDaHcefgH9hmbkcua8Jal2gecdtaecFFFFi0Ecbyd;S1jjbHjjjjbbhyascxfasyd2gecdtfayBdbasaecefBd2alTmba8JTmbarcd4hLdnazTmba8JcdthicbhYayhKinaoazaYcdtfydbaL2cdtfhAasc;WbfheaKhHa8JhOinaHaAaeydbcdtgCfIdbawaCfIdbNUdbaeclfheaHclfhHaOcufgOmbkaKaifhKaYcefgYal9hmbxdkka8JcdthicbhYayhKinaoaYaL2cdtfhAasc;WbfheaKhHa8JhOinaHaAaeydbcdtgCfIdbawaCfIdbNUdbaeclfheaHclfhHaOcufgOmbkaKaifhKaYcefgYal9hmbkkcualc8S2gHalc;D;O;f8U0EgCcbyd;S1jjbHjjjjbbheascxfasyd2gOcdtfaeBdbasaOcefBd2aecbaHz:ljjjbhqdndndndna8JTmbaCcbyd;S1jjbHjjjjbbhvascxfasyd2gecdtfavBdbcehOasaecefBd2avcbaHz:ljjjb8Acua8Jal2gecltgHaecFFFFb0Ecbyd;S1jjbHjjjjbbhrascxfasyd2gecdtfarBdbasaecefBd2arcbaHz:ljjjb8AadmexikcbhvadTmecbhrkcbhAabhHindnaaaHclfydbgYcx2fgeIdbaaaHydbgKcx2fgOIdbg8P:tgIaaaHcwfydbgLcx2fgCIdlaOIdlg8R:tg8SNaCIdba8P:tgRaeIdla8R:tg8UN:tg8Va8VNa8UaCIdwaOIdwg8W:tg8XNa8SaeIdwa8W:tg8UN:tg8Sa8SNa8UaRNa8XaIN:tgIaINMM:rgRJbbbb9ETmba8VaR:vh8VaIaR:vhIa8SaR:vh8SkaqaQaKcdtfydbc8S2fgea8SaR:rgRa8SNNg8UaeIdbMUdbaeaIaRaINg8YNg8XaeIdlMUdlaea8VaRa8VNg8ZNg80aeIdwMUdwaea8Ya8SNg8YaeIdxMUdxaea8Za8SNg81aeIdzMUdzaea8ZaINg8ZaeIdCMUdCaea8SaRa8Va8WNa8Sa8PNa8RaINMM:mg8RNg8PNg8SaeIdKMUdKaeaIa8PNgIaeId3MUd3aea8Va8PNg8VaeIdaMUdaaea8Pa8RNg8PaeId8KMUd8KaeaRaeIdyMUdyaqaQaYcdtfydbc8S2fgea8UaeIdbMUdbaea8XaeIdlMUdlaea80aeIdwMUdwaea8YaeIdxMUdxaea81aeIdzMUdzaea8ZaeIdCMUdCaea8SaeIdKMUdKaeaIaeId3MUd3aea8VaeIdaMUdaaea8PaeId8KMUd8KaeaRaeIdyMUdyaqaQaLcdtfydbc8S2fgea8UaeIdbMUdbaea8XaeIdlMUdlaea80aeIdwMUdwaea8YaeIdxMUdxaea81aeIdzMUdzaea8ZaeIdCMUdCaea8SaeIdKMUdKaeaIaeId3MUd3aea8VaeIdaMUdaaea8PaeId8KMUd8KaeaRaeIdyMUdyaHcxfhHaAcifgAad6mbkcbhiabhKinabaicdtfhYcbhHinaXaYaHc:G1jjbfydbcdtfydbgOfRbbhedndnaXaKaHfydbgCfRbbgAc99fcFeGcpe0mbaeceSmbaecd9hmekdnaAcufcFeGce0mbahaCcdtfydbaO9hmekdnaecufcFeGce0mbagaOcdtfydbaC9hmekdnaAcv2aefcj1jjbfRbbTmbaQaOcdtfydbaQaCcdtfydb0mekJbbacJbbacJbbjZaeceSEaAceSEh8ZdnaaaYaHc:K1jjbfydbcdtfydbcx2fgeIdwaaaCcx2fgAIdwg8R:tg8VaaaOcx2fgLIdwa8R:tg8Sa8SNaLIdbaAIdbg8W:tgIaINaLIdlaAIdlg8U:tgRaRNMMg8PNa8Va8SNaeIdba8W:tg80aINaRaeIdla8U:tg8YNMMg8Xa8SN:tg8Va8VNa80a8PNa8XaIN:tg8Sa8SNa8Ya8PNa8XaRN:tgIaINMM:rgRJbbbb9ETmba8VaR:vh8VaIaR:vhIa8SaR:vh8SkaqaQaCcdtfydbc8S2fgea8Sa8Za8P:rNgRa8SNNg8XaeIdbMUdbaeaIaRaINg8ZNg80aeIdlMUdlaea8VaRa8VNg8PNg8YaeIdwMUdwaea8Za8SNg8ZaeIdxMUdxaea8Pa8SNg81aeIdzMUdzaea8PaINgBaeIdCMUdCaea8SaRa8Va8RNa8Sa8WNa8UaINMM:mg8RNg8PNg8SaeIdKMUdKaeaIa8PNgIaeId3MUd3aea8Va8PNg8VaeIdaMUdaaea8Pa8RNg8PaeId8KMUd8KaeaRaeIdyMUdyaqaQaOcdtfydbc8S2fgea8XaeIdbMUdbaea80aeIdlMUdlaea8YaeIdwMUdwaea8ZaeIdxMUdxaea81aeIdzMUdzaeaBaeIdCMUdCaea8SaeIdKMUdKaeaIaeId3MUd3aea8VaeIdaMUdaaea8PaeId8KMUd8KaeaRaeIdyMUdykaHclfgHcx9hmbkaKcxfhKaicifgiad6mbkdna8JTmbcbhKinJbbbbh8WaaabaKcdtfgeclfydbgLcx2fgHIdwaaaeydbgicx2fgOIdwg8Y:tgIaINaHIdbaOIdbg81:tg8Va8VNaHIdlaOIdlgB:tgRaRNMMg8Zaaaecwfydbg8Fcx2fgeIdwa8Y:tg8PNaIaIa8PNa8VaeIdba81:tg8RNaRaeIdlaB:tg8UNMMg8SN:tJbbbbJbbjZa8Za8Pa8PNa8Ra8RNa8Ua8UNMMg80Na8Sa8SN:tg8X:va8XJbbbb9BEg8XNh83a80aINa8Pa8SN:ta8XNhUa8Za8UNaRa8SN:ta8XNh85a80aRNa8Ua8SN:ta8XNh86a8Za8RNa8Va8SN:ta8XNh87a80a8VNa8Ra8SN:ta8XNh88a8Va8UNa8RaRN:tg8Sa8SNaRa8PNa8UaIN:tg8Sa8SNaIa8RNa8Pa8VN:tg8Sa8SNMM:rJbbbZNh8Sayaia8J2g3cdtfhHaya8Fa8J2gwcdtfhOayaLa8J2g8LcdtfhCa8Y:mh89aB:mh8:a81:mhZcbhAa8JhYJbbbbh8UJbbbbh8XJbbbbh8ZJbbbbh80Jbbbbh8YJbbbbh81JbbbbhBJbbbbhnJbbbbhcinasc;WbfaAfgecwfa8SaUaCIdbaHIdbg8P:tgRNa83aOIdba8P:tg8RNMgINUdbaeclfa8Sa86aRNa85a8RNMg8VNUdbaea8Sa88aRNa87a8RNMgRNUdbaecxfa8Sa89aINa8:a8VNa8PaZaRNMMMg8PNUdba8SaIa8VNNa80Mh80a8SaIaRNNa8YMh8Ya8Sa8VaRNNa81Mh81a8Sa8Pa8PNNa8WMh8Wa8SaIa8PNNa8UMh8Ua8Sa8Va8PNNa8XMh8Xa8SaRa8PNNa8ZMh8Za8SaIaINNaBMhBa8Sa8Va8VNNanMhna8SaRaRNNacMhcaHclfhHaCclfhCaOclfhOaAczfhAaYcufgYmbkavaic8S2fgeacaeIdbMUdbaeanaeIdlMUdlaeaBaeIdwMUdwaea81aeIdxMUdxaea8YaeIdzMUdzaea80aeIdCMUdCaea8ZaeIdKMUdKaea8XaeId3MUd3aea8UaeIdaMUdaaea8WaeId8KMUd8Kaea8SaeIdyMUdyavaLc8S2fgeacaeIdbMUdbaeanaeIdlMUdlaeaBaeIdwMUdwaea81aeIdxMUdxaea8YaeIdzMUdzaea80aeIdCMUdCaea8ZaeIdKMUdKaea8XaeId3MUd3aea8UaeIdaMUdaaea8WaeId8KMUd8Kaea8SaeIdyMUdyava8Fc8S2fgeacaeIdbMUdbaeanaeIdlMUdlaeaBaeIdwMUdwaea81aeIdxMUdxaea8YaeIdzMUdzaea80aeIdCMUdCaea8ZaeIdKMUdKaea8XaeId3MUd3aea8UaeIdaMUdaaea8WaeId8KMUd8Kaea8SaeIdyMUdyara3cltfhYcbhHa8JhCinaYaHfgeasc;WbfaHfgOIdbaeIdbMUdbaeclfgAaOclfIdbaAIdbMUdbaecwfgAaOcwfIdbaAIdbMUdbaecxfgeaOcxfIdbaeIdbMUdbaHczfhHaCcufgCmbkara8LcltfhYcbhHa8JhCinaYaHfgeasc;WbfaHfgOIdbaeIdbMUdbaeclfgAaOclfIdbaAIdbMUdbaecwfgAaOcwfIdbaAIdbMUdbaecxfgeaOcxfIdbaeIdbMUdbaHczfhHaCcufgCmbkarawcltfhYcbhHa8JhCinaYaHfgeasc;WbfaHfgOIdbaeIdbMUdbaeclfgAaOclfIdbaAIdbMUdbaecwfgAaOcwfIdbaAIdbMUdbaecxfgeaOcxfIdbaeIdbMUdbaHczfhHaCcufgCmbkaKcifgKad6mbkkcbhOxekcehOcbhrkcbh8FdndnamcwGg9cmbJbbbbh8ZcbhJcbhocbhCxekcbhea5cbyd;S1jjbHjjjjbbhCascxfasyd2gHcdtfaCBdbasaHcefBd2dnalTmbaChHinaHaeBdbaHclfhHalaecefge9hmbkkdnaOmbcbhiinabaicdtfhLcbhKinaQaLaKcdtgec:G1jjbfydbcdtfydbcdtfydbhHdnaCaQaLaefydbcdtfydbgOcdtfgAydbgeaOSmbinaAaCaegOcdtfgYydbgeBdbaYhAaOae9hmbkkdnaCaHcdtfgAydbgeaHSmbinaAaCaegHcdtfgYydbgeBdbaYhAaHae9hmbkkdnaOaHSmbaCaOaHaOaH0EcdtfaOaHaOaH6EBdbkaKcefgKci9hmbkaicifgiad6mbkkcbhJdnalTmbcbhYindnaQaYcdtgefydbaY9hmbaYhHdnaCaefgKydbgeaYSmbaKhOinaOaCaegHcdtfgAydbgeBdbaAhOaHae9hmbkkaKaHBdbkaYcefgYal9hmbkcbheaQhOaChHcbhJindndnaeaOydbgA9hmbdnaeaHydbgA9hmbaHaJBdbaJcefhJxdkaHaCaAcdtfydbBdbxekaHaCaAcdtfydbBdbkaOclfhOaHclfhHalaecefge9hmbkkcuaJcltgeaJcjjjjiGEcbyd;S1jjbHjjjjbbhoascxfasyd2gHcdtfaoBdbasaHcefBd2aocbaez:ljjjbhAdnalTmbaChOaahealhYinaecwfIdbh8SaeclfIdbhIaAaOydbcltfgHaeIdbaHIdbMUdbaHclfgKaIaKIdbMUdbaHcwfgKa8SaKIdbMUdbaHcxfgHaHIdbJbbjZMUdbaOclfhOaecxfheaYcufgYmbkkdnaJTmbaAheaJhHinaecxfgOIdbh8SaOcbBdbaeaeIdbJbbbbJbbjZa8S:va8SJbbbb9BEg8SNUdbaeclfgOa8SaOIdbNUdbaecwfgOa8SaOIdbNUdbaeczfheaHcufgHmbkkdnalTmbaChOaahealhYinaAaOydbcltfgHcxfgKaecwfIdbaHcwfIdb:tg8Sa8SNaeIdbaHIdb:tg8Sa8SNaeclfIdbaHclfIdb:tg8Sa8SNMMg8SaKIdbgIaIa8S9DEUdbaOclfhOaecxfheaYcufgYmbkkdnaJmbcbhJJFFuuh8ZxekaAcxfheaAhHaJhOinaHaeIdbUdbaeczfheaHclfhHaOcufgOmbkJFFuuh8ZaAheaJhHinaeIdbg8Sa8Za8Za8S9EEh8ZaeclfheaHcufgHmbkkasydlh9ednalTmba9eclfhea9eydbhAaXhHalhYcbhOincbaeydbgKaA9RaHRbbcpeGEaOfhOaHcefhHaeclfheaKhAaYcufgYmbkaOce4h8Fkcuada8F9RcifgTcx2aTc;v:Q;v:Qe0Ecbyd;S1jjbHjjjjbbhDascxfasyd2gecdtfaDBdbasaecefBd2cuaTcdtaTcFFFFi0Ecbyd;S1jjbHjjjjbbhSascxfasyd2gecdtfaSBdbasaecefBd2a5cbyd;S1jjbHjjjjbbh8Mascxfasyd2gecdtfa8MBdbasaecefBd2alcbyd;S1jjbHjjjjbbh9hascxfasyd2gecdtfa9hBdbasaecefBd2axaxNa8NJbbjZamclGEg83a83N:vhcJbbbbhndnadak9nmbdnaTci6mba8Jclth9iaDcwfh6JbbbbhBJbbbbhninasclfabadalaQz:cjjjbabh8FcbhEcbh5inaba5cdtfh3cbheindnaQa8FaefydbgOcdtgifydbgYaQa3aec:W1jjbfydbcdtfydbgHcdtgwfydbgKSmbaXaHfRbbgLcv2aXaOfRbbgAfc;a1jjbfRbbg8AaAcv2aLfg8Lc;a1jjbfRbbg8KVcFeGTmbdnaKaY9nmba8Lcj1jjbfRbbcFeGmekaAcufhYdnaAaL9hmbaYcFeGce0mbahaifydbaH9hmekdndnaAclSmbaLcl9hmekdnaYcFeGce0mbahaifydbaH9hmdkaLcufcFeGce0mbagawfydbaO9hmekaDaEcx2fgAaHaOa8KcFeGgYEBdlaAaOaHaYEBdbaAaYa8AGcb9hBdwaEcefhEkaeclfgecx9hmbkdna5cifg5ad9pmba8Fcxfh8FaEcifaT9nmekkaETmdcbhiinJbbbbJbbjZaqaQaDaicx2fgAydlgKaAydbgYaAydwgHEgLcdtfydbc8S2fgeIdyg8S:va8SJbbbb9BEaeIdwaaaYaKaHEg8Fcx2fgHIdwgRNaeIdzaHIdbg8PNaeIdaMg8Sa8SMMaRNaeIdlaHIdlg8RNaeIdCaRNaeId3Mg8Sa8SMMa8RNaeIdba8PNaeIdxa8RNaeIdKMg8Sa8SMMa8PNaeId8KMMM:lNh80JbbbbJbbjZaqaQaYcdtfydbc8S2fgeIdyg8S:va8SJbbbb9BEaeIdwaaaKcx2fgHIdwg8VNaeIdzaHIdbg8WNaeIdaMg8Sa8SMMa8VNaeIdlaHIdlg8UNaeIdCa8VNaeId3Mg8Sa8SMMa8UNaeIdba8WNaeIdxa8UNaeIdKMg8Sa8SMMa8WNaeId8KMMM:lNh8YaAcwfh3aAclfhwdna8JTmbavaYc8S2fgOIdwa8VNaOIdza8WNaOIdaMg8Sa8SMMa8VNaOIdla8UNaOIdCa8VNaOId3Mg8Sa8SMMa8UNaOIdba8WNaOIdxa8UNaOIdKMg8Sa8SMMa8WNaOId8KMMMh8SayaKa8J2cdtfhHaraYa8J2cltfheaOIdyh8Xa8JhOinaHIdbgIaIa8XNaecxfIdba8VaecwfIdbNa8WaeIdbNa8UaeclfIdbNMMMgIaIM:tNa8SMh8SaHclfhHaeczfheaOcufgOmbkavaLc8S2fgOIdwaRNaOIdza8PNaOIdaMgIaIMMaRNaOIdla8RNaOIdCaRNaOId3MgIaIMMa8RNaOIdba8PNaOIdxa8RNaOIdKMgIaIMMa8PNaOId8KMMMhIaya8Fa8J2cdtfhHaraLa8J2cltfheaOIdyh8Wa8JhOinaHIdbg8Va8Va8WNaecxfIdbaRaecwfIdbNa8PaeIdbNa8RaeclfIdbNMMMg8Va8VM:tNaIMhIaHclfhHaeczfheaOcufgOmbka80aI:lMh80a8Ya8S:lMh8YkawaKa8Fa8Ya809FgeEBdbaAaYaLaeEBdba3a8Ya80aeEUdbaicefgiaE9hmbkasc;Wbfcbcj;qbz:ljjjb8Aa6heaEhHinasc;WbfaeydbcA4cF8FGgOcFAaOcFA6EcdtfgOaOydbcefBdbaecxfheaHcufgHmbkcbhecbhHinasc;WbfaefgOydbhAaOaHBdbaAaHfhHaeclfgecj;qb9hmbkcbhea6hHinasc;WbfaHydbcA4cF8FGgOcFAaOcFA6EcdtfgOaOydbgOcefBdbaSaOcdtfaeBdbaHcxfhHaEaecefge9hmbkadak9RgOci9Uh9kdnalTmbcbhea8MhHinaHaeBdbaHclfhHalaecefge9hmbkkcbh0a9hcbalz:ljjjbh9maOcO9Uh9na9kce4h9oasydwh9pcbh8KcbhwdninaDaSawcdtfydbcx2fg3Idwg8Sac9Emea8Ka9k9pmeJFFuuhIdna9oaE9pmbaDaSa9ocdtfydbcx2fIdwJbb;aZNhIkdna8SaI9ETmba8San9ETmba8Ka9n0mdkdna9maQa3ydlgicdtg9qfydbgAfg9rRbba9maQa3ydbgLcdtg9sfydbgHfg9tRbbVmbaXaLfRbbh9udna9eaHcdtfgeclfydbgOaeydbgeSmbaOae9RhKa9paecitfheaaaAcx2fg8Lcwfh5a8Lclfh9vaaaHcx2fg8Acwfh9wa8Aclfh9xcbhHceh8Fdnindna8MaeydbcdtfydbgOaASmba8MaeclfydbcdtfydbgYaASmbaOaYSmbaaaYcx2fgYIdbaaaOcx2fgOIdbg8V:tg8Sa9xIdbaOIdlgR:tg8WNa8AIdba8V:tg8UaYIdlaR:tgIN:tg8Pa8Sa9vIdbaR:tg8XNa8LIdba8V:tg80aIN:tgRNaIa9wIdbaOIdwg8R:tg8YNa8WaYIdwa8R:tg8VN:tg8WaIa5Idba8R:tg81Na8Xa8VN:tgINa8Va8UNa8Ya8SN:tg8Ra8Va80Na81a8SN:tg8SNMMa8Pa8PNa8Wa8WNa8Ra8RNMMaRaRNaIaINa8Sa8SNMMN:rJbbj8:N9FmdkaecwfheaHcefgHaK6h8FaKaH9hmbkka8FceGTmba9ocefh9oxeka3cwfhHdndndndna9uc9:fPdebdkaLheina8MaecdtgefaiBdba8EaefydbgeaL9hmbxikkdnagahaha9sfydbaiSEa8Ea9sfydbgLcdtfydbgecu9hmba8Ea9qfydbheka8Ma9sfaiBdbaehika8MaLcdtfaiBdbka9tce86bba9rce86bbaHIdbg8Sanana8S9DEhna0cefh0cecda9uceSEa8Kfh8KkawcefgwaE9hmbkka0TmddnalTmbcbhKcbhiindna8MaicdtgefydbgOaiSmbaQaOcdtfydbh8FdnaiaQaefydb9hg3mbaqa8Fc8S2fgeaqaic8S2fgHIdbaeIdbMUdbaeaHIdlaeIdlMUdlaeaHIdwaeIdwMUdwaeaHIdxaeIdxMUdxaeaHIdzaeIdzMUdzaeaHIdCaeIdCMUdCaeaHIdKaeIdKMUdKaeaHId3aeId3MUd3aeaHIdaaeIdaMUdaaeaHId8KaeId8KMUd8KaeaHIdyaeIdyMUdyka8JTmbavaOc8S2fgeavaic8S2gwfgHIdbaeIdbMUdbaeaHIdlaeIdlMUdlaeaHIdwaeIdwMUdwaeaHIdxaeIdxMUdxaeaHIdzaeIdzMUdzaeaHIdCaeIdCMUdCaeaHIdKaeIdKMUdKaeaHId3aeId3MUd3aeaHIdaaeIdaMUdaaeaHId8KaeId8KMUd8KaeaHIdyaeIdyMUdya9iaO2hLarhHa8JhAinaHaLfgeaHaKfgOIdbaeIdbMUdbaeclfgYaOclfIdbaYIdbMUdbaecwfgYaOcwfIdbaYIdbMUdbaecxfgeaOcxfIdbaeIdbMUdbaHczfhHaAcufgAmbka3mbJbbbbJbbjZaqawfgeIdyg8S:va8SJbbbb9BEaeIdwaaa8Fcx2fgHIdwg8SNaeIdzaHIdbgINaeIdaMg8Va8VMMa8SNaeIdlaHIdlg8VNaeIdCa8SNaeId3Mg8Sa8SMMa8VNaeIdbaINaeIdxa8VNaeIdKMg8Sa8SMMaINaeId8KMMM:lNg8SaBaBa8S9DEhBkaKa9ifhKaicefgial9hmbkcbhHahheindnaeydbgOcuSmbdnaHa8MaOcdtgAfydbgO9hmbcuhOahaAfydbgAcuSmba8MaAcdtfydbhOkaeaOBdbkaeclfhealaHcefgH9hmbkcbhHagheindnaeydbgOcuSmbdnaHa8MaOcdtgAfydbgO9hmbcuhOagaAfydbgAcuSmba8MaAcdtfydbhOkaeaOBdbkaeclfhealaHcefgH9hmbkkaBana8JEhBcbhYabhecbhKindna8MaeydbcdtfydbgHa8MaeclfydbcdtfydbgOSmbaHa8MaecwfydbcdtfydbgASmbaOaASmbabaYcdtfgLaHBdbaLcwfaABdbaLclfaOBdbaYcifhYkaecxfheaKcifgKad6mbkdndna9cTmbaYak9nmba8ZaB9FTmbcbhdabhecbhHindnaoaCaeydbgOcdtfydbcdtfIdbaB9ETmbabadcdtfgAaOBdbaAclfaeclfydbBdbaAcwfaecwfydbBdbadcifhdkaecxfheaHcifgHaY6mbkJFFuuh8ZaJTmeaoheaJhHJFFuuh8SinaeIdbgIa8Sa8SaI9EEg8Va8SaIaB9EgOEh8Sa8Va8ZaOEh8ZaeclfheaHcufgHmbxdkkaYhdkadak0mbxdkkasclfabadalaQz:cjjjbkdndnadak0mbadhOxekdna9cmbadhOxekdna8Zac9FmbadhOxekina8ZJbb;aZNg8Saca8Sac9DEh8VJbbbbh8SdnaJTmbaoheaJhHinaeIdbgIa8SaIa8V9FEa8SaIa8S9EEh8SaeclfheaHcufgHmbkkcbhOabhecbhHindnaoaCaeydbgAcdtfydbcdtfIdba8V9ETmbabaOcdtfgYaABdbaYclfaeclfydbBdbaYcwfaecwfydbBdbaOcifhOkaecxfheaHcifgHad6mbkJFFuuh8ZdnaJTmbaoheaJhHJFFuuhIinaeIdbgRaIaIaR9EEg8PaIaRa8V9EgAEhIa8Pa8ZaAEh8ZaeclfheaHcufgHmbkkdnaOad9hmbadhOxdka8Sanana8S9DEhnaOak9nmeaOhda8Zac9FmbkkdnamcjjjjlGTmbazmbaOTmbcbhQabheinaXaeydbgAfRbbc3thKaecwfgLydbhHdndnahaAcdtg8FfydbaeclfgiydbgCSmbcbhYagaCcdtfydbaA9hmekcjjjj94hYkaeaKaYVaAVBdbaXaCfRbbc3thKdndnahaCcdtfydbaHSmbcbhYagaHcdtfydbaC9hmekcjjjj94hYkaiaKaYVaCVBdbaXaHfRbbc3thYdndnahaHcdtfydbaASmbcbhCaga8FfydbaH9hmekcjjjj94hCkaLaYaCVaHVBdbaecxfheaQcifgQaO6mbkkdnazTmbaOTmbaOheinabazabydbcdtfydbBdbabclfhbaecufgembkkdnaPTmbaPa83an:rNUdbkasyd2gecdtascxffc98fhHdninaeTmeaHydbcbyd;O1jjbH:bjjjbbaHc98fhHaecufhexbkkasc;W;qbf8KjjjjbaOk;Yieouabydlhvabydbclfcbaicdtz:ljjjbhoadci9UhrdnadTmbdnalTmbaehwadhDinaoalawydbcdtfydbcdtfgqaqydbcefBdbawclfhwaDcufgDmbxdkkaehwadhDinaoawydbcdtfgqaqydbcefBdbawclfhwaDcufgDmbkkdnaiTmbcbhDaohwinawydbhqawaDBdbawclfhwaqaDfhDaicufgimbkkdnadci6mbinaecwfydbhwaeclfydbhDaeydbhidnalTmbalawcdtfydbhwalaDcdtfydbhDalaicdtfydbhikavaoaicdtfgqydbcitfaDBdbavaqydbcitfawBdlaqaqydbcefBdbavaoaDcdtfgqydbcitfawBdbavaqydbcitfaiBdlaqaqydbcefBdbavaoawcdtfgwydbcitfaiBdbavawydbcitfaDBdlawawydbcefBdbaecxfhearcufgrmbkkabydbcbBdbk;Podvuv998Jjjjjbca9RgvcFFF;7rBd3av9cFFF;7;3FF:;Fb83dCavcFFF97Bdzav9cFFF;7FFF:;u83dwdnadTmbaicd4hodnabmbdnalTmbcbhrinaealarcdtfydbao2cdtfhwcbhiinavcCfaifgDawaifIdbgqaDIdbgkakaq9EEUdbavcwfaifgDaqaDIdbgkakaq9DEUdbaiclfgicx9hmbkarcefgrad9hmbxikkaocdthrcbhwincbhiinavcCfaifgDaeaifIdbgqaDIdbgkakaq9EEUdbavcwfaifgDaqaDIdbgkakaq9DEUdbaiclfgicx9hmbkaearfheawcefgwad9hmbxdkkdnalTmbcbhrinabarcx2fgiaealarcdtfydbao2cdtfgwIdbUdbaiawIdlUdlaiawIdwUdwcbhiinavcCfaifgDawaifIdbgqaDIdbgkakaq9EEUdbavcwfaifgDaqaDIdbgkakaq9DEUdbaiclfgicx9hmbkarcefgrad9hmbxdkkaocdthlcbhraehwinabarcx2fgiaearao2cdtfgDIdbUdbaiaDIdlUdlaiaDIdwUdwcbhiinavcCfaifgDawaifIdbgqaDIdbgkakaq9EEUdbavcwfaifgDaqaDIdbgkakaq9DEUdbaiclfgicx9hmbkawalfhwarcefgrad9hmbkkJbbbbavIdwavIdCgk:tgqaqJbbbb9DEgqavIdxavIdKgx:tgmamaq9DEgqavIdzavId3gm:tgPaPaq9DEhPdnabTmbadTmbJbbbbJbbjZaP:vaPJbbbb9BEhqinabaqabIdbak:tNUdbabclfgvaqavIdbax:tNUdbabcwfgvaqavIdbam:tNUdbabcxfhbadcufgdmbkkaPk8MbabaeadaialavcbcbcbcbcbaoarawaDz:bjjjbk8MbabaeadaialavaoarawaDaqakaxamaPz:bjjjbk:nCoDud99rue99lul998Jjjjjbc;Wb9Rgw8KjjjjbdndnarmbcbhDxekawcxfcbc;Kbz:ljjjb8Aawcuadcx2adc;v:Q;v:Qe0Ecbyd;S1jjbHjjjjbbgqBdxawceBd2aqaeadaicbz:djjjb8AawcuadcdtadcFFFFi0Egkcbyd;S1jjbHjjjjbbgxBdzawcdBd2adcd4adfhmceheinaegicetheaiam6mbkcbhPawcuaicdtgsaicFFFFi0Ecbyd;S1jjbHjjjjbbgzBdCawciBd2dndnar:ZgH:rJbbbZMgO:lJbbb9p9DTmbaO:Ohexekcjjjj94hekaicufhAc:bwhmcbhCadhXcbhQinaChLaeamgKcufaeaK9iEaPgDcefaeaD9kEhYdndnadTmbaYcuf:YhOaqhiaxheadhmindndnaiIdbaONJbbbZMg8A:lJbbb9p9DTmba8A:OhCxekcjjjj94hCkaCcCthCdndnaiclfIdbaONJbbbZMg8A:lJbbb9p9DTmba8A:OhExekcjjjj94hEkaEcqtaCVhCdndnaicwfIdbaONJbbbZMg8A:lJbbb9p9DTmba8A:OhExekcjjjj94hEkaeaCaEVBdbaicxfhiaeclfheamcufgmmbkazcFeasz:ljjjbh3cbh5cbh8Eindna3axa8EcdtfydbgCcm4aC7c:v;t;h;Ev2gics4ai7aAGgmcdtfgEydbgecuSmbaeaCSmbcehiina3amaifaAGgmcdtfgEydbgecuSmeaicefhiaeaC9hmbkkaEaCBdba5aecuSfh5a8Ecefg8Ead9hmbxdkkazcFeasz:ljjjb8Acbh5kaDaYa5ar0giEhPaLa5aiEhCdna5arSmbaYaKaiEgmaP9Rcd9imbdndnaQcl0mbdnaX:ZgOaL:Zg8A:taY:Yg8FaD:Y:tgaa8FaK:Y:tgha5:ZggaH:tNNNaOaH:tahNa8Aag:tNa8AaH:taaNagaO:tNM:va8FMJbbbZMgO:lJbbb9p9DTmbaO:Ohexdkcjjjj94hexekaPamfcd9Theka5aXaiEhXaQcefgQcs9hmekkdndnaCmbcihicbhDxekcbhiawakcbyd;S1jjbHjjjjbbg8EBdKawclBd2aPcuf:Yh8AdndnadTmbaqhiaxheadhmindndnaiIdba8ANJbbbZMgO:lJbbb9p9DTmbaO:OhCxekcjjjj94hCkaCcCthCdndnaiclfIdba8ANJbbbZMgO:lJbbb9p9DTmbaO:OhExekcjjjj94hEkaEcqtaCVhCdndnaicwfIdba8ANJbbbZMgO:lJbbb9p9DTmbaO:OhExekcjjjj94hEkaeaCaEVBdbaicxfhiaeclfheamcufgmmbkazcFeasz:ljjjbh3cbhDcbh5inaxa5cdtgYfydbgCcm4aC7c:v;t;h;Ev2gics4ai7hecbhidndnina3aeaAGgmcdtfgEydbgecuSmednaxaecdtgEfydbaCSmbaicefgiamfheaiaA9nmekka8EaEfydbhixekaEa5BdbaDhiaDcefhDka8EaYfaiBdba5cefg5ad9hmbkcuaDc32giaDc;j:KM;jb0EhexekazcFeasz:ljjjb8AcbhDcbhekawaecbyd;S1jjbHjjjjbbgeBd3awcvBd2aecbaiz:ljjjbhEavcd4hxdnadTmbdnalTmbaxcdth3a8EhCalheaqhmadhAinaEaCydbc32fgiamIdbaiIdbMUdbaiamclfIdbaiIdlMUdlaiamcwfIdbaiIdwMUdwaiaeIdbaiIdxMUdxaiaeclfIdbaiIdzMUdzaiaecwfIdbaiIdCMUdCaiaiIdKJbbjZMUdKaCclfhCaea3fheamcxfhmaAcufgAmbxdkka8EhmaqheadhCinaEamydbc32fgiaeIdbaiIdbMUdbaiaeclfIdbaiIdlMUdlaiaecwfIdbaiIdwMUdwaiaiIdxJbbbbMUdxaiaiIdzJbbbbMUdzaiaiIdCJbbbbMUdCaiaiIdKJbbjZMUdKamclfhmaecxfheaCcufgCmbkkdnaDTmbaEhiaDheinaiaiIdbJbbbbJbbjZaicKfIdbgO:vaOJbbbb9BEgONUdbaiclfgmaOamIdbNUdbaicwfgmaOamIdbNUdbaicxfgmaOamIdbNUdbaiczfgmaOamIdbNUdbaicCfgmaOamIdbNUdbaic3fhiaecufgembkkcbhCawcuaDcdtgYaDcFFFFi0Egicbyd;S1jjbHjjjjbbgeBdaawcoBd2awaicbyd;S1jjbHjjjjbbg3Bd8KaecFeaYz:ljjjbh5dnadTmbJbbjZJbbjZa8A:vaPceSEaoNgOaONh8Aaxcdthxalheina8Aaec;C1jjbalEgmIdwaEa8EydbgAc32fgiIdC:tgOaONamIdbaiIdx:tgOaONamIdlaiIdz:tgOaONMMNaqcwfIdbaiIdw:tgOaONaqIdbaiIdb:tgOaONaqclfIdbaiIdl:tgOaONMMMhOdndna5aAcdtgifgmydbcuSmba3aifIdbaO9ETmekamaCBdba3aifaOUdbka8Eclfh8EaeaxfheaqcxfhqadaCcefgC9hmbkkaba5aYz:kjjjb8AcrhikaicdthiinaiTmeaic98fgiawcxffydbcbyd;O1jjbH:bjjjbbxbkkawc;Wbf8KjjjjbaDk:Odieui99iu8Jjjjjbca9RgicFFF;7rBd3ai9cFFF;7;3FF:;Fb83dCaicFFF97Bdzai9cFFF;7FFF:;u83dwdndnaembJbbjFhlJbbjFhvJbbjFhoxekadcd4cdthrcbhwincbhdinaicCfadfgDabadfIdbglaDIdbgvaval9EEUdbaicwfadfgDalaDIdbgvaval9DEUdbadclfgdcx9hmbkabarfhbawcefgwae9hmbkaiIdzaiId3:thoaiIdxaiIdK:thvaiIdwaiIdC:thlkJbbbbalalJbbbb9DEglavaval9DEglaoaoal9DEk9DeeuabcFeaicdtz:ljjjbhlcbhbdnadTmbindnalaeydbcdtfgiydbcu9hmbaiabBdbabcefhbkaeclfheadcufgdmbkkabk9teiucbcbyd;W1jjbgeabcifc98GfgbBd;W1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabk9teiucbcbyd;W1jjbgeabcrfc94GfgbBd;W1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik9:eiuZbhedndncbyd;W1jjbgdaecztgi9nmbcuheadai9RcFFifcz4nbcuSmekadhekcbabae9Rcifc98Gcbyd;W1jjbfgdBd;W1jjbdnadZbcztge9nmbadae9RcFFifcz4nb8Akk6eiucbhidnadTmbdninabRbbglaeRbbgv9hmeaecefheabcefhbadcufgdmbxdkkalav9Rhikaikk:bedbcjwk9Oeeebeebebbeeebebbbbbebebbbbbbbbbebbbdbbbbbbbebbbebbbdbbbbbbbbbbbeeeeebebbebbebebbbeebbbbbbbbbbbbbbbbbbbbbc;OwkxebbbdbbbjNbb",t=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if(typeof WebAssembly!="object")return{supported:!1};var n,i=WebAssembly.instantiate(o(e),{}).then(function(m){n=m.instance,n.exports.__wasm_call_ctors()});function o(m){for(var y=new Uint8Array(m.length),b=0;b<m.length;++b){var C=m.charCodeAt(b);y[b]=C>96?C-97:C>64?C-39:C+4}for(var A=0,b=0;b<m.length;++b)y[A++]=y[b]<60?t[y[b]]:(y[b]-60)*64+y[++b];return y.buffer.slice(0,A)}function r(m){if(!m)throw new Error("Assertion failed")}function s(m){return new Uint8Array(m.buffer,m.byteOffset,m.byteLength)}function a(m,y,b){var C=n.exports.sbrk,A=C(y.length*4),T=C(b*4),E=new Uint8Array(n.exports.memory.buffer),v=s(y);E.set(v,A);var D=m(T,A,y.length,b);E=new Uint8Array(n.exports.memory.buffer);var O=new Uint32Array(b);new Uint8Array(O.buffer).set(E.subarray(T,T+b*4)),v.set(E.subarray(A,A+y.length*4)),C(A-C(0));for(var P=0;P<y.length;++P)y[P]=O[y[P]];return[O,D]}function c(m){for(var y=0,b=0;b<m.length;++b){var C=m[b];y=y<C?C:y}return y}function l(m,y,b,C,A,T,E,v,D){var O=n.exports.sbrk,P=O(4),M=O(b*4),L=O(A*T),_=O(b*4),S=new Uint8Array(n.exports.memory.buffer);S.set(s(C),L),S.set(s(y),_);var w=m(M,_,b,L,A,T,E,v,D,P);S=new Uint8Array(n.exports.memory.buffer);var I=new Uint32Array(w);s(I).set(S.subarray(M,M+w*4));var N=new Float32Array(1);return s(N).set(S.subarray(P,P+4)),O(P-O(0)),[I,N[0]]}function f(m,y,b,C,A,T,E,v,D,O,P,M,L){var _=n.exports.sbrk,S=_(4),w=_(b*4),I=_(A*T),N=_(A*v),k=_(D.length*4),z=_(b*4),V=O?_(A):0,U=new Uint8Array(n.exports.memory.buffer);U.set(s(C),I),U.set(s(E),N),U.set(s(D),k),U.set(s(y),z),O&&U.set(s(O),V);var B=m(w,z,b,I,A,T,N,v,k,D.length,V,P,M,L,S);U=new Uint8Array(n.exports.memory.buffer);var W=new Uint32Array(B);s(W).set(U.subarray(w,w+B*4));var j=new Float32Array(1);return s(j).set(U.subarray(S,S+4)),_(S-_(0)),[W,j[0]]}function d(m,y,b,C){var A=n.exports.sbrk,T=A(b*C),E=new Uint8Array(n.exports.memory.buffer);E.set(s(y),T);var v=m(T,b,C);return A(T-A(0)),v}function p(m,y,b,C,A,T,E,v){var D=n.exports.sbrk,O=D(v*4),P=D(b*C),M=D(b*T),L=new Uint8Array(n.exports.memory.buffer);L.set(s(y),P),A&&L.set(s(A),M);var _=m(O,P,b,C,M,T,E,v);L=new Uint8Array(n.exports.memory.buffer);var S=new Uint32Array(_);return s(S).set(L.subarray(O,O+_*4)),D(O-D(0)),S}var g={LockBorder:1,Sparse:2,ErrorAbsolute:4,Prune:8,_InternalDebug:1<<30};return{ready:i,supported:!0,useExperimentalFeatures:!1,compactMesh:function(m){r(m instanceof Uint32Array||m instanceof Int32Array||m instanceof Uint16Array||m instanceof Int16Array),r(m.length%3==0);var y=m.BYTES_PER_ELEMENT==4?m:new Uint32Array(m);return a(n.exports.meshopt_optimizeVertexFetchRemap,y,c(m)+1)},simplify:function(m,y,b,C,A,T){r(m instanceof Uint32Array||m instanceof Int32Array||m instanceof Uint16Array||m instanceof Int16Array),r(m.length%3==0),r(y instanceof Float32Array),r(y.length%b==0),r(b>=3),r(C>=0&&C<=m.length),r(C%3==0),r(A>=0);for(var E=0,v=0;v<(T?T.length:0);++v)r(T[v]in g),r(this.useExperimentalFeatures||T[v]!="Prune"),E|=g[T[v]];var D=m.BYTES_PER_ELEMENT==4?m:new Uint32Array(m),O=l(n.exports.meshopt_simplify,D,m.length,y,y.length/b,b*4,C,A,E);return O[0]=m instanceof Uint32Array?O[0]:new m.constructor(O[0]),O},simplifyWithAttributes:function(m,y,b,C,A,T,E,v,D,O){r(this.useExperimentalFeatures),r(m instanceof Uint32Array||m instanceof Int32Array||m instanceof Uint16Array||m instanceof Int16Array),r(m.length%3==0),r(y instanceof Float32Array),r(y.length%b==0),r(b>=3),r(C instanceof Float32Array),r(C.length%A==0),r(A>=0),r(E==null||E instanceof Uint8Array),r(E==null||E.length==y.length/b),r(v>=0&&v<=m.length),r(v%3==0),r(D>=0),r(Array.isArray(T)),r(A>=T.length),r(T.length<=32);for(var P=0;P<T.length;++P)r(T[P]>=0);for(var M=0,P=0;P<(O?O.length:0);++P)r(O[P]in g),M|=g[O[P]];var L=m.BYTES_PER_ELEMENT==4?m:new Uint32Array(m),_=f(n.exports.meshopt_simplifyWithAttributes,L,m.length,y,y.length/b,b*4,C,A*4,new Float32Array(T),E?new Uint8Array(E):null,v,D,M);return _[0]=m instanceof Uint32Array?_[0]:new m.constructor(_[0]),_},getScale:function(m,y){return r(m instanceof Float32Array),r(m.length%y==0),r(y>=3),d(n.exports.meshopt_simplifyScale,m,m.length/y,y*4)},simplifyPoints:function(m,y,b,C,A,T){return r(this.useExperimentalFeatures),r(m instanceof Float32Array),r(m.length%y==0),r(y>=3),r(b>=0&&b<=m.length/y),C?(r(C instanceof Float32Array),r(C.length%A==0),r(A>=3),r(m.length/y==C.length/A),p(n.exports.meshopt_simplifyPoints,m,m.length/y,y*4,C,A*4,T,b)):p(n.exports.meshopt_simplifyPoints,m,m.length/y,y*4,void 0,0,0,b)}}}();var Fen=function(){var e="b9H79Tebbbefx9Geueu9Geub9Gbb9Giuuueu9Gkuuuuuuuuuu99eu9Gvuuuuueu9Gkuuuuuuuuu9999eu9Gruuuuuuub9Gkuuuuuuuuuuueu9Gouuuuuub9Giuuub9GluuuubiOHdilvorwDqrkbiibeilve9Weiiviebeoweuec:q:Odkr:Yewo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9I919P29K9nW79O2Wt79c9V919U9KbeX9TW79O9V9Wt9F9I919P29K9nW79O2Wt7bd39TW79O9V9Wt9F9J9V9T9W91tWJ2917tWV9c9V919U9K7br39TW79O9V9Wt9F9J9V9T9W91tW9nW79O2Wt9c9V919U9K7bDL9TW79O9V9Wt9F9V9Wt9P9T9P96W9nW79O2Wtbql79IV9RbkDwebcekdsPq;L9kHdbkIbabaec9:fgefcufae9Ugeabci9Uadfcufad9Ugbaeab0Ek:oAlPue99eux998Jjjjjbc:We9Rgk8Kjjjjbakc;mbfcbc;Kbz:njjjb8AakcuaocdtgxaocFFFFi0Egmcbyd:e1jjbHjjjjbbgPBd9makceBd:SeakaPBdnakamcbyd:e1jjbHjjjjbbgsBd9qakcdBd:SeakasBd9eakcualcdtalcFFFFi0Ecbyd:e1jjbHjjjjbbgzBd9uakazBd9iakciBd:SeaPcbaxz:njjjbhHalci9UhOdnalTmbaihPalhAinaHaPydbcdtfgCaCydbcefBdbaPclfhPaAcufgAmbkkdnaoTmbcbhPashAaHhCaohXinaAaPBdbaAclfhAaCydbaPfhPaCclfhCaXcufgXmbkkdnalci6mbcbhPaihAinaAcwfydbhCaAclfydbhXasaAydbcdtfgQaQydbgQcefBdbazaQcdtfaPBdbasaXcdtfgXaXydbgXcefBdbazaXcdtfaPBdbasaCcdtfgCaCydbgCcefBdbazaCcdtfaPBdbaAcxfhAaOaPcefgP9hmbkkdnaoTmbaHhAashPaohCinaPaPydbaAydb9RBdbaAclfhAaPclfhPaCcufgCmbkkakamcbyd:e1jjbHjjjjbbgPBd9yakclBd:SeaPaHaxz:mjjjbhmakaOcbyd:e1jjbHjjjjbbgPBd9CakcvBd:SeaPcbaOz:njjjbhLakcuaOcK2alcjjjjd0Ecbyd:e1jjbHjjjjbbgKBd9GakcoBd:SeJbbbbhYdnalci6g8Ambarcd4hxaihAaKhPaOhrJbbbbhEinavaAclfydbax2cdtfgCIdlh3avaAydbax2cdtfgXIdlhYavaAcwfydbax2cdtfgQIdlh5aCIdwh8EaXIdwh8FaQIdwhaaPaCIdbghaXIdbggMaQIdbg8JMJbbnn:vUdbaPclfaXIdlaCIdlMaQIdlMJbbnn:vUdbaQIdwh8KaCIdwh8LaXIdwh8MaPcxfa3aY:tg3aaa8F:tgaNa5aY:tg5a8Ea8F:tg8EN:tgYJbbbbJbbjZahag:tgha5Na8Jag:tgga3N:tg8Fa8FNaYaYNa8EagNaaahN:tgYaYNMM:rgg:vagJbbbb9BEg3NUdbaPczfaYa3NUdbaPcCfa8Fa3NUdbaPcwfa8Ka8Ma8LMMJbbnn:vUdbaEagMhEaAcxfhAaPcKfhParcufgrmbkaEaO:Z:vJbbbZNhYkakcuaOcdtalcFFFF970Ecbyd:e1jjbHjjjjbbgCBd9KakcrBd:SeaYaD:ZN:rhYdna8AmbcbhPaChAinaAaPBdbaAclfhAaOaPcefgP9hmbkkaYJbbbZNh8MakcuaOcltalcFFFFd0Ecbyd:e1jjbHjjjjbbg8ABd9OakcwBd:Secba8AaKaCaOz:djjjb8Aakaocbyd:e1jjbHjjjjbbgPBd2aPcFeaoz:njjjbhrakc8Wfcwf9cb83ibak9cb83i8WcbhPJbbbbhEJbbbbh5Jbbbbh8EJbbbbhYJbbbbh8FJbbbbhgcbhlinJbbbbh3dnaPTmbJbbjZaP:Z:vh3kaka8Ea3NgaUdaaka5a3NghUd3akaEa3Ng8JUdKJbbbbh3dnagagNaYaYNa8Fa8FNMMg8KJbbbb9BmbJbbjZa8K:r:vh3kakaga3NUd8Saka8Fa3NUdyakaYa3NUd8Kdndndnakyd8WgQakydUgAakcKfaeaiakc;abfaKamara8Maqz:ejjjbgCcuSmbdnaPaD9pmbaAaraiaCcx2fgXydbfRbbcFeSfaraXclfydbfRbbcFeSfaraXcwfydbfRbbcFeSfaw9nmdkaQaAcbaeaiakc;abfaKamara8MJbbbbz:ejjjbgCcu9hmekakaaUdCakahUdzaka8JUdxakcuBdwakcFFF;7rBdla8AcbaKaLakcxfakcwfakclfz:fjjjbakydwgCcuSmekdnakc8WfaiaCcx2fgOydbgPaOclfydbgAaOcwfydbgXarabaeadalawaDz:gjjjbTmbalcefhlJbbbbhEJbbbbh5Jbbbbh8EJbbbbhYJbbbbh8FJbbbbhgkamaPcdtfgPaPydbcufBdbamaAcdtfgPaPydbcufBdbamaXcdtfgPaPydbcufBdbcbhXinazasaOaXcdtfydbcdtgAfydbcdtfgxhPaHaAfgvydbgQhAdnaQTmbdninaPydbaCSmeaPclfhPaAcufgATmdxbkkaPaxaQcdtfc98fydbBdbavavydbcufBdbkaXcefgXci9hmbkaKaCcK2fgPIdbh3aPIdlhaaPIdwhhaPIdxh8JaPIdzh8KaPIdCh8LaLaCfce86bbaga8LMhga8Fa8KMh8FaYa8JMhYa8EahMh8Ea5aaMh5aEa3MhEakyd88hPxekkdnaPTmbdnakyd80gAaPci2fgCciGTmbadaCfcbaPaAcu7fciGcefz:njjjb8AkabalcltfgPak8Pi8W83dbaPcwfakc8Wfcwf8Pib83dbalcefhlkcahPdninaPc98Smeakc;mbfaPfydbcbydj1jjbH:bjjjbbaPc98fhPxbkkakc:Wef8Kjjjjbalk;3vivuv99lu8Jjjjjbca9Rgv8Kjjjjbdndnalcw0mbaiydbhoaeabcitfgralcdtcufBdlaraoBdbdnalcd6mbaiclfhoalcufhwarcxfhrinaoydbhDarcuBdbarc98faDBdbarcwfhraoclfhoawcufgwmbkkalabfhrxekcbhDavczfcwfcbBdbav9cb83izavcwfcbBdbav9cb83ibJbbjZhqJbbjZhkinadaiaDcdtfydbcK2fhwcbhrinavczfarfgoawarfIdbgxaoIdbgm:tgPakNamMgmUdbavarfgoaPaxam:tNaoIdbMUdbarclfgrcx9hmbkJbbjZaqJbbjZMgq:vhkaDcefgDal9hmbkcbhoadcbcecdavIdlgxavIdwgm9GEgravIdbgPam9GEaraPax9GEgscdtgrfhzavczfarfIdbhxaihralhwinaiaocdtfgDydbhHaDarydbgOBdbaraHBdbarclfhraoazaOcK2fIdbax9Dfhoawcufgwmbkaeabcitfhrdndnaocv6mbaoalc98f6mekaraiydbBdbaralcdtcufBdlaiclfhoalcufhwarcxfhrinaoydbhDarcuBdbarc98faDBdbarcwfhraoclfhoawcufgwmbkalabfhrxekaraxUdbaeabcitfgrarydlc98GasVBdlabcefaeadaiaoz:djjjbhwararydlciGawabcu7fcdtVBdlawaeadaiaocdtfalao9Rz:djjjbhrkavcaf8Kjjjjbark;Bloeue99vue99Due99dndnaembcuhkxekJbbjZaq:thxaiabcdtfhmavydbhPavydlhsavydwhzcbhHJFFuuhOcvhbcuhkindnaPamaHcdtfydbcdtgvfydbgATmbazasavfydbcdtfhiindndnawalaiydbgCcx2fgvclfydbgXfRbbcFeSawavydbgQfRbbcFeSfawavcwfydbgLfRbbcFeSfgKmbcbhvxekcehvaraQcdtfydbgYceSmbcehvaraXcdtfydbg8AceSmbcehvaraLcdtfydbgEceSmbdna8AcdSaYcdSfaEcdSfcd6mbaKcefhvxekaKcdfhvkdnavab9kmbdndnadTmbaoaCcK2fgQIdwadIdw:tg3a3NaQIdbadIdb:tg3a3NaQIdladIdl:tg3a3NMM:raD:vaxNJbbjZMJ9VO:d86JbbjZaQIdCadIdCNaQIdxadIdxNaQIdzadIdzNMMaqN:tg3a3J9VO:d869DENh3xekaraQcdtfydbaraXcdtfydbfaraLcdtfydbfc99f:Zh3kaCakavab6a3aO9DVgQEhkavabaQEhba3aOaQEhOkaiclfhiaAcufgAmbkkaHcefgHae9hmbkkakk;bddlue99dndndnabaecitfgrydlgwciGgDci9hmbarclfhqxekinabcbawcd4gwalaDcdtfIdbabaecitfIdb:tgkJbbbb9FEgDaecefgefadaialavaoz:fjjjbak:laoIdb9FTmdabaDaw7aefgecitfgrydlgwciGgDci9hmbkarclfhqkabaecitfhecuhbindnaiaeydbgDfRbbmbadaDcK2fgrIdwalIdw:tgkakNarIdbalIdb:tgkakNarIdlalIdl:tgkakNMM:rgkaoIdb9DTmbaoakUdbavaDBdbaqydbhwkaecwfheabcefgbawcd46mbkkk;yleoudnaladfgkRbbcFeSalaefgxRbbgmcFeSfabydwgPfalaifgsRbbcFeSfaD0abydxaq9pVgzce9hmbavawcltfgmab8Pdb83dbamcwfabcwfgm8Pdb83dbdndnamydbmbcbhqxekcbhDaohminalamabydbcdtfydbfcFe86bbamclfhmaDcefgDabydwgq6mbkkdnabydxglci2gDabydlgmfgPciGTmbaraPfcbalamcu7fciGcefz:njjjb8Aabydxci2hDabydlhmabydwhqkab9cb83dwababydbaqfBdbabaDcifc98GamfBdlaxRbbhmcbhPkdnamcFeGcFe9hmbaxaP86bbababydwgmcefBdwaoabydbcdtfamcdtfaeBdbkdnakRbbcFe9hmbakabydw86bbababydwgmcefBdwaoabydbcdtfamcdtfadBdbkdnasRbbcFe9hmbasabydw86bbababydwgmcefBdwaoabydbcdtfamcdtfaiBdbkarabydlfabydxci2faxRbb86bbarabydlfabydxci2fcefakRbb86bbarabydlfabydxci2fcdfasRbb86bbababydxcefBdxazk;Ckovud99euv99eul998Jjjjjbc:G;ae9Rgo8KjjjjbdndnadTmbavcd4hrcbhwcbhDindnaiaeclfydbar2cdtfgvIdbaiaeydbar2cdtfgqIdbgk:tgxaiaecwfydbar2cdtfgmIdlaqIdlgP:tgsNamIdbak:tgzavIdlaP:tgPN:tgkakNaPamIdwaqIdwgH:tgONasavIdwaH:tgHN:tgPaPNaHazNaOaxN:tgxaxNMM:rgsJbbbb9Bmbaoc:G:qefawcx2fgAakas:vUdwaAaxas:vUdlaAaPas:vUdbaocafawc8K2fgAaq8Pdb83dbaAav8Pdb83dxaAam8Pdb83dKaAcwfaqcwfydbBdbaAcCfavcwfydbBdbaAcafamcwfydbBdbawcefhwkaecxfheaDcifgDad6mbkab9cb83dbabcyf9cb83dbabcaf9cb83dbabcKf9cb83dbabczf9cb83dbabcwf9cb83dbawTmeao9cb83iKao9cb83izaoczfaocafawci2z1jjjbaoIdKhCaoIdChXaoIdzhQao9cb83iwao9cb83ibaoaoc:G:qefawz1jjjbJbbjZhkaoIdwgPJbbbbJbbjZaPaPNaoIdbgPaPNaoIdlgsasNMM:rgx:vaxJbbbb9BEgzNhxasazNhsaPazNhzaoc:G:qefheawhvinaecwfIdbaxNaeIdbazNasaeclfIdbNMMgPakaPak9DEhkaecxfheavcufgvmbkabaCUdwabaXUdlabaQUdbabaoId3UdxdndnakJ;n;m;m899FmbJbbbbhPaoc:G:qefheaocafhvinaCavcwfIdb:taecwfIdbgHNaQavIdb:taeIdbgONaXavclfIdb:taeclfIdbgLNMMaxaHNazaONasaLNMM:vgHaPaHaP9EEhPavc8KfhvaecxfheawcufgwmbkabazUd3abc8KfaxUdbabcafasUdbabcKfaCaxaPN:tUdbabcCfaXasaPN:tUdbabaQazaPN:tUdzabJbbjZakakN:t:rgkUdydndnaxJbbj:;axJbbj:;9GEgPJbbjZaPJbbjZ9FEJbb;:9cNJbbbZJbbb:;axJbbbb9GEMgP:lJbbb9p9DTmbaP:Ohexekcjjjj94hekabc8Ufae86bbdndnasJbbj:;asJbbj:;9GEgPJbbjZaPJbbjZ9FEJbb;:9cNJbbbZJbbb:;asJbbbb9GEMgP:lJbbb9p9DTmbaP:Ohvxekcjjjj94hvkabcRfav86bbdndnazJbbj:;azJbbj:;9GEgPJbbjZaPJbbjZ9FEJbb;:9cNJbbbZJbbb:;azJbbbb9GEMgP:lJbbb9p9DTmbaP:Ohqxekcjjjj94hqkabaq86b8SdndnaecKtcK91:YJbb;:9c:vax:t:lavcKtcK91:YJbb;:9c:vas:t:laqcKtcK91:YJbb;:9c:vaz:t:lakMMMJbb;:9cNJbbjZMgk:lJbbb9p9DTmbak:Ohexekcjjjj94hekaecFbaecFb9iEhexekabcjjj;8iBdycFbhekabae86b8Vxekab9cb83dbabcyf9cb83dbabcaf9cb83dbabcKf9cb83dbabczf9cb83dbabcwf9cb83dbkaoc:G;aef8Kjjjjbk:mvdouq99cbhi8Jjjjjbca9RglczfcwfcbBdbal9cb83izalcwfcbBdbal9cb83ibdnadTmbcbhvinaeaifhocbhrinalczfarfgwavawydbgwaoarfIdbgDaearawcx2ffIdb9DEBdbalarfgwavawydbgwaDaearawcx2ffIdb9EEBdbarclfgrcx9hmbkaicxfhiavcefgvad9hmbkkJbbbbhDcbhrcbhicbhvinaealarfydbcx2fgwIdwaealczfarfydbcx2fgoIdw:tgqaqNawIdbaoIdb:tgqaqNawIdlaoIdl:tgqaqNMMgqaDaqaD9EgwEhDavaiawEhiarclfhravcefgvci9hmbkaealczfaicdtgvfydbcx2fgrIdwaealavfydbcx2fglIdwMJbbbZNhqarIdlalIdlMJbbbZNhkarIdbalIdbMJbbbZNhxaD:rJbbbZNhDdnadTmbindnaecwfIdbgmaq:tgPaPNaeIdbgsax:tgPaPNaeclfIdbgzak:tgPaPNMMgPaDaDN9ETmbaqaDaP:rgH:vJbbbZNJbbbZMgPNamJbbjZaP:tgONMhqakaPNazaONMhkaxaPNasaONMhxaDaHMJbbbZNhDkaecxfheadcufgdmbkkabaDUdxabaqUdwabakUdlabaxUdbkjeeiu8Jjjjjbcj8W9Rgr8Kjjjjbaici2hwdnaiTmbawceawce0EhDarhiinaiaeadRbbcdtfydbBdbadcefhdaiclfhiaDcufgDmbkkabarawaladaoz:hjjjbarcj8Wf8Kjjjjbk:Ylequ8Jjjjjbcjx9Rgl8Kjjjjbcbhvalcjqfcbaiz:njjjb8AdndnadTmbcjehoaehrincuhwarhDcuhqavhkdninawakaoalcjqfaDcefRbbfRbb9RcFeGci6aoalcjqfaDRbbfRbb9RcFeGci6faoalcjqfaDcdfRbbfRbb9RcFeGci6fgxaq9mgmEhwdnammbaxce0mdkaxaqaxaq9kEhqaDcifhDadakcefgk9hmbkkaeawci2fgDcdfRbbhqaDcefRbbhxaDRbbhkaeavci2fgDcifaDawav9Rci2z:qjjjb8Aakalcjqffaocefgo86bbaxalcjqffao86bbaDcdfaq86bbaDcefax86bbaDak86bbaqalcjqffao86bbarcifhravcefgvad9hmbkalcFeaiz:njjjbhoadci2gDceaDce0EhqcbhxindnaoaeRbbgkfgwRbbgDcFe9hmbawax86bbaocjdfaxcdtfabakcdtfydbBdbaxhDaxcefhxkaeaD86bbaecefheaqcufgqmbkaxcdthDxekcbhDkabalcjdfaDz:mjjjb8Aalcjxf8Kjjjjbk9teiucbcbyd11jjbgeabcifc98GfgbBd11jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabk9teiucbcbyd11jjbgeabcrfc94GfgbBd11jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik9:eiuZbhedndncbyd11jjbgdaecztgi9nmbcuheadai9RcFFifcz4nbcuSmekadhekcbabae9Rcifc98Gcbyd11jjbfgdBd11jjbdnadZbcztge9nmbadae9RcFFifcz4nb8Akk:;Deludndndnadch9pmbabaeSmdaeabadfgi9Rcbadcet9R0mekabaead;8qbbxekaeab7ciGhldndndnabae9pmbdnalTmbadhvabhixikdnabciGmbadhvabhixdkadTmiabaeRbb86bbadcufhvdnabcefgiciGmbaecefhexdkavTmiabaeRbe86beadc9:fhvdnabcdfgiciGmbaecdfhexdkavTmiabaeRbd86bdadc99fhvdnabcifgiciGmbaecifhexdkavTmiabaeRbi86biabclfhiaeclfheadc98fhvxekdnalmbdnaiciGTmbadTmlabadcufgifglaeaifRbb86bbdnalciGmbaihdxekaiTmlabadc9:fgifglaeaifRbb86bbdnalciGmbaihdxekaiTmlabadc99fgifglaeaifRbb86bbdnalciGmbaihdxekaiTmlabadc98fgdfaeadfRbb86bbkadcl6mbdnadc98fgocd4cefciGgiTmbaec98fhlabc98fhvinavadfaladfydbBdbadc98fhdaicufgimbkkaocx6mbaec9Wfhvabc9WfhoinaoadfgicxfavadfglcxfydbBdbaicwfalcwfydbBdbaiclfalclfydbBdbaialydbBdbadc9Wfgdci0mbkkadTmdadhidnadciGglTmbaecufhvabcufhoadhiinaoaifavaifRbb86bbaicufhialcufglmbkkadcl6mdaec98fhlabc98fhvinavaifgecifalaifgdcifRbb86bbaecdfadcdfRbb86bbaecefadcefRbb86bbaeadRbb86bbaic98fgimbxikkavcl6mbdnavc98fglcd4cefcrGgdTmbavadcdt9RhvinaiaeydbBdbaeclfheaiclfhiadcufgdmbkkalc36mbinaiaeydbBdbaiaeydlBdlaiaeydwBdwaiaeydxBdxaiaeydzBdzaiaeydCBdCaiaeydKBdKaiaeyd3Bd3aecafheaicafhiavc9Gfgvci0mbkkavTmbdndnavcrGgdmbavhlxekavc94GhlinaiaeRbb86bbaicefhiaecefheadcufgdmbkkavcw6mbinaiaeRbb86bbaiaeRbe86beaiaeRbd86bdaiaeRbi86biaiaeRbl86blaiaeRbv86bvaiaeRbo86boaiaeRbr86braicwfhiaecwfhealc94fglmbkkabkkAebcjwkxebbbdbbbzNbb",t=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if(typeof WebAssembly!="object")return{supported:!1};var n,i=WebAssembly.instantiate(o(e),{}).then(function(m){n=m.instance,n.exports.__wasm_call_ctors()});function o(m){for(var y=new Uint8Array(m.length),b=0;b<m.length;++b){var C=m.charCodeAt(b);y[b]=C>96?C-97:C>64?C-39:C+4}for(var A=0,b=0;b<m.length;++b)y[A++]=y[b]<60?t[y[b]]:(y[b]-60)*64+y[++b];return y.buffer.slice(0,A)}function r(m){if(!m)throw new Error("Assertion failed")}function s(m){return new Uint8Array(m.buffer,m.byteOffset,m.byteLength)}var a=48,c=16;function l(m,y){var b=m.meshlets[y*4+0],C=m.meshlets[y*4+1],A=m.meshlets[y*4+2],T=m.meshlets[y*4+3];return{vertices:m.vertices.subarray(b,b+A),triangles:m.triangles.subarray(C,C+T*3)}}function f(m,y,b,C,A,T,E){var v=n.exports.sbrk,D=n.exports.meshopt_buildMeshletsBound(m.length,A,T),O=v(D*c),P=v(D*A*4),M=v(D*T*3),L=v(m.byteLength),_=v(y.byteLength),S=new Uint8Array(n.exports.memory.buffer);S.set(s(m),L),S.set(s(y),_);var w=n.exports.meshopt_buildMeshlets(O,P,M,L,m.length,_,b,C,A,T,E);S=new Uint8Array(n.exports.memory.buffer);for(var I=S.subarray(O,O+w*c),N=new Uint32Array(I.buffer,I.byteOffset,I.byteLength/4).slice(),k=0;k<w;++k){var z=N[k*4+0],V=N[k*4+1],b=N[k*4+2],U=N[k*4+3];n.exports.meshopt_optimizeMeshlet(P+z*4,M+V,U,b)}var B=N[(w-1)*4+0],W=N[(w-1)*4+1],j=N[(w-1)*4+2],Q=N[(w-1)*4+3],q=B+j,X=W+(Q*3+3&-4),Z={meshlets:N,vertices:new Uint32Array(S.buffer,P,q).slice(),triangles:new Uint8Array(S.buffer,M,X*3).slice(),meshletCount:w};return v(O-v(0)),Z}function d(m){var y=new Float32Array(n.exports.memory.buffer,m,a/4);return{centerX:y[0],centerY:y[1],centerZ:y[2],radius:y[3],coneApexX:y[4],coneApexY:y[5],coneApexZ:y[6],coneAxisX:y[7],coneAxisY:y[8],coneAxisZ:y[9],coneCutoff:y[10]}}function p(m,y,b,C){var A=n.exports.sbrk,T=[],E=A(y.byteLength),v=A(m.vertices.byteLength),D=A(m.triangles.byteLength),O=A(a),P=new Uint8Array(n.exports.memory.buffer);P.set(s(y),E),P.set(s(m.vertices),v),P.set(s(m.triangles),D);for(var M=0;M<m.meshletCount;++M){var L=m.meshlets[M*4+0],_=m.meshlets[M*4+0+1],S=m.meshlets[M*4+0+3];n.exports.meshopt_computeMeshletBounds(O,v+L*4,D+_,S,E,b,C),T.push(d(O))}return A(E-A(0)),T}function g(m,y,b,C){var A=n.exports.sbrk,T=A(a),E=A(m.byteLength),v=A(y.byteLength),D=new Uint8Array(n.exports.memory.buffer);D.set(s(m),E),D.set(s(y),v),n.exports.meshopt_computeClusterBounds(T,E,m.length,v,b,C);var O=d(T);return A(T-A(0)),O}return{ready:i,supported:!0,buildMeshlets:function(m,y,b,C,A,T){r(m.length%3==0),r(y instanceof Float32Array),r(y.length%b==0),r(b>=3),r(C<=255||C>0),r(A<=512),r(A%4==0),T=T||0;var E=m.BYTES_PER_ELEMENT==4?m:new Uint32Array(m);return f(E,y,y.length/b,b*4,C,A,T)},computeClusterBounds:function(m,y,b){r(m.length%3==0),r(m.length/3<=512),r(y instanceof Float32Array),r(y.length%b==0),r(b>=3);var C=m.BYTES_PER_ELEMENT==4?m:new Uint32Array(m);return g(C,y,y.length/b,b*4)},computeMeshletBounds:function(m,y,b){return r(m.meshletCount!=0),r(y instanceof Float32Array),r(y.length%b==0),r(b>=3),p(m,y,y.length/b,b*4)},extractMeshlet:function(m,y){return r(y>=0&&y<m.meshletCount),l(m,y)}}}();function nx(e){e=x(e,x.EMPTY_OBJECT);let t=e.resourceCache,n=e.gltf,i=e.bufferViewId,o=e.gltfResource,r=e.baseResource,s=e.cacheKey,a=n.bufferViews[i],c=a.buffer,l=a.byteOffset,f=a.byteLength,d=!1,p,g,m,y;if(si(a,"EXT_meshopt_compression")){let C=a.extensions.EXT_meshopt_compression;c=C.buffer,l=x(C.byteOffset,0),f=C.byteLength,d=!0,p=C.byteStride,g=C.count,m=C.mode,y=x(C.filter,"NONE")}let b=n.buffers[c];this._hasMeshopt=d,this._meshoptByteStride=p,this._meshoptCount=g,this._meshoptMode=m,this._meshoptFilter=y,this._resourceCache=t,this._gltfResource=o,this._baseResource=r,this._buffer=b,this._bufferId=c,this._byteOffset=l,this._byteLength=f,this._cacheKey=s,this._bufferLoader=void 0,this._typedArray=void 0,this._state=_t.UNLOADED,this._promise=void 0}u(Object.create)&&(nx.prototype=Object.create(Qi.prototype),nx.prototype.constructor=nx);Object.defineProperties(nx.prototype,{cacheKey:{get:function(){return this._cacheKey}},typedArray:{get:function(){return this._typedArray}}});async function tke(e){try{let t=nke(e);if(e._bufferLoader=t,await t.load(),e.isDestroyed())return;let n=t.typedArray,i=new Uint8Array(n.buffer,n.byteOffset+e._byteOffset,e._byteLength);if(e.unload(),e._typedArray=i,e._hasMeshopt){let o=e._meshoptCount,r=e._meshoptByteStride,s=new Uint8Array(o*r);qie.decodeGltfBuffer(s,o,r,e._typedArray,e._meshoptMode,e._meshoptFilter),e._typedArray=s}return e._state=_t.READY,e}catch(t){if(e.isDestroyed())return;throw e.unload(),e._state=_t.FAILED,e.getError("Failed to load buffer view",t)}}nx.prototype.load=async function(){return u(this._promise)?this._promise:(this._state=_t.LOADING,this._promise=tke(this),this._promise)};function nke(e){let t=e._resourceCache,n=e._buffer;if(u(n.uri)){let o=e._baseResource.getDerivedResource({url:n.uri});return t.getExternalBufferLoader({resource:o})}return t.getEmbeddedBufferLoader({parentResource:e._gltfResource,bufferId:e._bufferId})}nx.prototype.unload=function(){u(this._bufferLoader)&&!this._bufferLoader.isDestroyed()&&this._resourceCache.unload(this._bufferLoader),this._bufferLoader=void 0,this._typedArray=void 0};var Wv=nx;function Nr(){}Nr._maxDecodingConcurrency=Math.max(Wt.hardwareConcurrency-1,1);Nr._decoderTaskProcessor=void 0;Nr._taskProcessorReady=!1;Nr._error=void 0;Nr._getDecoderTaskProcessor=function(){if(!u(Nr._decoderTaskProcessor)){let e=new xi("decodeDraco",Nr._maxDecodingConcurrency);e.initWebAssemblyModule({wasmBinaryFile:"ThirdParty/draco_decoder.wasm"}).then(function(t){t?Nr._taskProcessorReady=!0:Nr._error=new ce("Draco decoder could not be initialized.")}).catch(t=>{Nr._error=t}),Nr._decoderTaskProcessor=e}return Nr._decoderTaskProcessor};Nr.decodePointCloud=function(e){let t=Nr._getDecoderTaskProcessor();if(u(Nr._error))throw Nr._error;if(Nr._taskProcessorReady)return t.scheduleTask(e,[e.buffer.buffer])};Nr.decodeBufferView=function(e){let t=Nr._getDecoderTaskProcessor();if(u(Nr._error))throw Nr._error;if(Nr._taskProcessorReady)return t.scheduleTask(e,[e.array.buffer])};var fg=Nr;function dg(e){e=x(e,x.EMPTY_OBJECT);let t=e.resourceCache,n=e.gltf,i=e.draco,o=e.gltfResource,r=e.baseResource,s=e.cacheKey;this._resourceCache=t,this._gltfResource=o,this._baseResource=r,this._gltf=n,this._draco=i,this._cacheKey=s,this._bufferViewLoader=void 0,this._bufferViewTypedArray=void 0,this._decodePromise=void 0,this._decodedData=void 0,this._state=_t.UNLOADED,this._promise=void 0,this._dracoError=void 0}u(Object.create)&&(dg.prototype=Object.create(Qi.prototype),dg.prototype.constructor=dg);Object.defineProperties(dg.prototype,{cacheKey:{get:function(){return this._cacheKey}},decodedData:{get:function(){return this._decodedData}}});async function ike(e){let t=e._resourceCache;try{let n=t.getBufferViewLoader({gltf:e._gltf,bufferViewId:e._draco.bufferView,gltfResource:e._gltfResource,baseResource:e._baseResource});return e._bufferViewLoader=n,await n.load(),e.isDestroyed()?void 0:(e._bufferViewTypedArray=n.typedArray,e._state=_t.PROCESSING,e)}catch(n){if(e.isDestroyed())return;Yie(e,n)}}dg.prototype.load=async function(){return u(this._promise)?this._promise:(this._state=_t.LOADING,this._promise=ike(this),this._promise)};function Yie(e,t){throw e.unload(),e._state=_t.FAILED,e.getError("Failed to load Draco",t)}async function oke(e,t){try{let n=await t;return e.isDestroyed()?void 0:(e.unload(),e._decodedData={indices:n.indexArray,vertexAttributes:n.attributeData},e._state=_t.READY,e._baseResource)}catch(n){if(e.isDestroyed())return;e._dracoError=n}}dg.prototype.process=function(e){if(this._state===_t.READY)return!0;if(this._state!==_t.PROCESSING||(u(this._dracoError)&&Yie(this,this._dracoError),!u(this._bufferViewTypedArray))||u(this._decodePromise))return!1;let t=this._draco,i=this._gltf.bufferViews,o=t.bufferView,r=i[o],s=t.attributes,a={array:new Uint8Array(this._bufferViewTypedArray),bufferView:r,compressedAttributes:s,dequantizeInShader:!0},c=fg.decodeBufferView(a);if(!u(c))return!1;this._decodePromise=oke(this,c)};dg.prototype.unload=function(){u(this._bufferViewLoader)&&this._resourceCache.unload(this._bufferViewLoader),this._bufferViewLoader=void 0,this._bufferViewTypedArray=void 0,this._decodedData=void 0,this._gltf=void 0};var jv=dg;function rke(e){let t=e.uint8Array,n=e.format,i=e.request,o=x(e.flipY,!1),r=x(e.skipColorSpaceConversion,!1),s=new Blob([t],{type:n}),a;return De.supportsImageBitmapOptions().then(function(c){return c?Promise.resolve(De.createImageBitmapFromBlob(s,{flipY:o,premultiplyAlpha:!1,skipColorSpaceConversion:r})):(a=window.URL.createObjectURL(s),new De({url:a,request:i}).fetchImage({flipY:o,skipColorSpaceConversion:r}))}).then(function(c){return u(a)&&window.URL.revokeObjectURL(a),c}).catch(function(c){return u(a)&&window.URL.revokeObjectURL(a),Promise.reject(c)})}var cA=rke;function xp(e){e=x(e,x.EMPTY_OBJECT);let t=e.resourceCache,n=e.gltf,i=e.imageId,o=e.gltfResource,r=e.baseResource,s=e.cacheKey,a=n.images[i],c=a.bufferView,l=a.uri;this._resourceCache=t,this._gltfResource=o,this._baseResource=r,this._gltf=n,this._bufferViewId=c,this._uri=l,this._cacheKey=s,this._bufferViewLoader=void 0,this._image=void 0,this._mipLevels=void 0,this._state=_t.UNLOADED,this._promise=void 0}u(Object.create)&&(xp.prototype=Object.create(Qi.prototype),xp.prototype.constructor=xp);Object.defineProperties(xp.prototype,{cacheKey:{get:function(){return this._cacheKey}},image:{get:function(){return this._image}},mipLevels:{get:function(){return this._mipLevels}}});xp.prototype.load=function(){return u(this._promise)?this._promise:u(this._bufferViewId)?(this._promise=ske(this),this._promise):(this._promise=ake(this),this._promise)};function Xie(e){let t;return Array.isArray(e)&&(t=e.slice(1,e.length).map(function(n){return n.bufferView}),e=e[0]),{image:e,mipLevels:t}}async function ske(e){e._state=_t.LOADING;let t=e._resourceCache;try{let n=t.getBufferViewLoader({gltf:e._gltf,bufferViewId:e._bufferViewId,gltfResource:e._gltfResource,baseResource:e._baseResource});if(e._bufferViewLoader=n,await n.load(),e.isDestroyed())return;let i=n.typedArray,o=await lke(i);if(e.isDestroyed())return;let r=Xie(o);return e.unload(),e._image=r.image,e._mipLevels=r.mipLevels,e._state=_t.READY,e}catch(n){return e.isDestroyed()?void 0:Kie(e,n,"Failed to load embedded image")}}async function ake(e){e._state=_t.LOADING;let t=e._baseResource,n=e._uri,i=t.getDerivedResource({url:n});try{let o=await fke(i);if(e.isDestroyed())return;let r=Xie(o);return e.unload(),e._image=r.image,e._mipLevels=r.mipLevels,e._state=_t.READY,e}catch(o){return e.isDestroyed()?void 0:Kie(e,o,`Failed to load image: ${n}`)}}function Kie(e,t,n){return e.unload(),e._state=_t.FAILED,Promise.reject(e.getError(n,t))}function cke(e){let t=e.subarray(0,2),n=e.subarray(0,4),i=e.subarray(8,12);if(t[0]===255&&t[1]===216)return"image/jpeg";if(t[0]===137&&t[1]===80)return"image/png";if(t[0]===171&&t[1]===75)return"image/ktx2";if(n[0]===82&&n[1]===73&&n[2]===70&&n[3]===70&&i[0]===87&&i[1]===69&&i[2]===66&&i[3]===80)return"image/webp";throw new ce("Image format is not recognized")}async function lke(e){let t=cke(e);if(t==="image/ktx2"){let n=new Uint8Array(e);return jl(n)}return xp._loadImageFromTypedArray({uint8Array:e,format:t,flipY:!1,skipColorSpaceConversion:!0})}var uke=/(^data:image\/ktx2)|(\.ktx2$)/i;function fke(e){let t=e.getUrlComponent(!1,!0);return uke.test(t)?jl(e):e.fetchImage({skipColorSpaceConversion:!0,preferImageBitmap:!0})}xp.prototype.unload=function(){u(this._bufferViewLoader)&&!this._bufferViewLoader.isDestroyed()&&this._resourceCache.unload(this._bufferViewLoader),this._bufferViewLoader=void 0,this._uri=void 0,this._image=void 0,this._mipLevels=void 0,this._gltf=void 0};xp._loadImageFromTypedArray=cA;var qv=xp;var dke={TEXTURE:0,PROGRAM:1,BUFFER:2,NUMBER_OF_JOB_TYPES:3},Qa=Object.freeze(dke);function hg(e){e=x(e,x.EMPTY_OBJECT);let t=e.resourceCache,n=e.gltf,i=e.accessorId,o=e.gltfResource,r=e.baseResource,s=e.draco,a=e.cacheKey,c=x(e.asynchronous,!0),l=x(e.loadBuffer,!1),f=x(e.loadTypedArray,!1),d=n.accessors[i].componentType;this._resourceCache=t,this._gltfResource=o,this._baseResource=r,this._gltf=n,this._accessorId=i,this._indexDatatype=d,this._draco=s,this._cacheKey=a,this._asynchronous=c,this._loadBuffer=l,this._loadTypedArray=f,this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._typedArray=void 0,this._buffer=void 0,this._state=_t.UNLOADED,this._promise=void 0}u(Object.create)&&(hg.prototype=Object.create(Qi.prototype),hg.prototype.constructor=hg);Object.defineProperties(hg.prototype,{cacheKey:{get:function(){return this._cacheKey}},buffer:{get:function(){return this._buffer}},typedArray:{get:function(){return this._typedArray}},indexDatatype:{get:function(){return this._indexDatatype}}});var hke=new aW;hg.prototype.load=async function(){return u(this._promise)?this._promise:u(this._draco)?(this._promise=mke(this),this._promise):(this._promise=pke(this),this._promise)};async function mke(e){e._state=_t.LOADING;let t=e._resourceCache;try{let n=t.getDracoLoader({gltf:e._gltf,draco:e._draco,gltfResource:e._gltfResource,baseResource:e._baseResource});return e._dracoLoader=n,await n.load(),e.isDestroyed()?void 0:(e._state=_t.LOADED,e)}catch(n){if(e.isDestroyed())return;sW(e,n)}}async function pke(e){let t=e._gltf,n=e._accessorId,o=t.accessors[n].bufferView;e._state=_t.LOADING;let r=e._resourceCache;try{let s=r.getBufferViewLoader({gltf:t,bufferViewId:o,gltfResource:e._gltfResource,baseResource:e._baseResource});if(e._bufferViewLoader=s,await s.load(),e.isDestroyed())return;let a=s.typedArray;return e._typedArray=_ke(e,a),e._state=_t.PROCESSING,e}catch(s){if(e.isDestroyed())return;sW(e,s)}}function _ke(e,t){let n=e._gltf,i=e._accessorId,o=n.accessors[i],r=o.count,s=o.componentType,a=Be.getSizeInBytes(s),c=t.buffer,l=t.byteOffset+o.byteOffset;if(l%a!==0){let d=r*a,p=new Uint8Array(c,l,d);c=new Uint8Array(p).buffer,l=0,ys("index-buffer-unaligned",`The index array is not aligned to a ${a}-byte boundary.`)}let f;return s===Be.UNSIGNED_BYTE?f=new Uint8Array(c,l,r):s===Be.UNSIGNED_SHORT?f=new Uint16Array(c,l,r):s===Be.UNSIGNED_INT&&(f=new Uint32Array(c,l,r)),f}function sW(e,t){throw e.unload(),e._state=_t.FAILED,e.getError("Failed to load index buffer",t)}function aW(){this.typedArray=void 0,this.indexDatatype=void 0,this.context=void 0,this.buffer=void 0}aW.prototype.set=function(e,t,n){this.typedArray=e,this.indexDatatype=t,this.context=n};aW.prototype.execute=function(){this.buffer=Zie(this.typedArray,this.indexDatatype,this.context)};function Zie(e,t,n){let i=xt.createIndexBuffer({typedArray:e,context:n,usage:ke.STATIC_DRAW,indexDatatype:t});return i.vertexArrayDestroyable=!1,i}hg.prototype.process=function(e){if(this._state===_t.READY)return!0;if(this._state!==_t.LOADED&&this._state!==_t.PROCESSING)return!1;let t=this._typedArray,n=this._indexDatatype;if(u(this._dracoLoader))try{this._dracoLoader.process(e)&&(t=this._dracoLoader.decodedData.indices.typedArray,this._typedArray=t,n=K.fromTypedArray(t),this._indexDatatype=n)}catch(o){sW(this,o)}if(!u(t))return!1;let i;if(this._loadBuffer&&this._asynchronous){let o=hke;if(o.set(t,n,e.context),!e.jobScheduler.execute(o,Qa.BUFFER))return!1;i=o.buffer}else this._loadBuffer&&(i=Zie(t,n,e.context));return this.unload(),this._buffer=i,this._typedArray=this._loadTypedArray?t:void 0,this._state=_t.READY,this._resourceCache.statistics.addGeometryLoader(this),!0};hg.prototype.unload=function(){u(this._buffer)&&this._buffer.destroy();let e=this._resourceCache;u(this._bufferViewLoader)&&!this._bufferViewLoader.isDestroyed()&&e.unload(this._bufferViewLoader),u(this._dracoLoader)&&e.unload(this._dracoLoader),this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._typedArray=void 0,this._buffer=void 0,this._gltf=void 0};var Yv=hg;function gke(e,t,n){if(n=x(n,!1),n){let i=e.indexOf(t);if(i>-1)return i}return e.push(t),e.length-1}var ks=gke;function yke(e,t){return u(e.extensionsUsed)&&e.extensionsUsed.indexOf(t)>=0}var xr=yke;function Yt(){}Yt.objectLegacy=function(e,t){if(u(e)){for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){let i=e[n],o=t(i,n);if(u(o))return o}}};Yt.object=function(e,t){if(u(e)){let n=e.length;for(let i=0;i<n;i++){let o=e[i],r=t(o,i);if(u(r))return r}}};Yt.topLevel=function(e,t,n){let i=e[t];return u(i)&&!Array.isArray(i)?Yt.objectLegacy(i,n):Yt.object(i,n)};Yt.accessor=function(e,t){return Yt.topLevel(e,"accessors",t)};Yt.accessorWithSemantic=function(e,t,n){let i={};return Yt.mesh(e,function(o){return Yt.meshPrimitive(o,function(r){let s=Yt.meshPrimitiveAttribute(r,function(a,c){if(c.indexOf(t)===0&&!u(i[a])){i[a]=!0;let l=n(a);if(u(l))return l}});return u(s)?s:Yt.meshPrimitiveTarget(r,function(a){return Yt.meshPrimitiveTargetAttribute(a,function(c,l){if(l.indexOf(t)===0&&!u(i[c])){i[c]=!0;let f=n(c);if(u(f))return f}})})})})};Yt.accessorContainingVertexAttributeData=function(e,t){let n={};return Yt.mesh(e,function(i){return Yt.meshPrimitive(i,function(o){let r=Yt.meshPrimitiveAttribute(o,function(s){if(!u(n[s])){n[s]=!0;let a=t(s);if(u(a))return a}});return u(r)?r:Yt.meshPrimitiveTarget(o,function(s){return Yt.meshPrimitiveTargetAttribute(s,function(a){if(!u(n[a])){n[a]=!0;let c=t(a);if(u(c))return c}})})})})};Yt.accessorContainingIndexData=function(e,t){let n={};return Yt.mesh(e,function(i){return Yt.meshPrimitive(i,function(o){let r=o.indices;if(u(r)&&!u(n[r])){n[r]=!0;let s=t(r);if(u(s))return s}})})};Yt.animation=function(e,t){return Yt.topLevel(e,"animations",t)};Yt.animationChannel=function(e,t){let n=e.channels;return Yt.object(n,t)};Yt.animationSampler=function(e,t){let n=e.samplers;return Yt.object(n,t)};Yt.buffer=function(e,t){return Yt.topLevel(e,"buffers",t)};Yt.bufferView=function(e,t){return Yt.topLevel(e,"bufferViews",t)};Yt.camera=function(e,t){return Yt.topLevel(e,"cameras",t)};Yt.image=function(e,t){return Yt.topLevel(e,"images",t)};Yt.material=function(e,t){return Yt.topLevel(e,"materials",t)};Yt.materialValue=function(e,t){let n=e.values;u(e.extensions)&&u(e.extensions.KHR_techniques_webgl)&&(n=e.extensions.KHR_techniques_webgl.values);for(let i in n)if(Object.prototype.hasOwnProperty.call(n,i)){let o=t(n[i],i);if(u(o))return o}};Yt.mesh=function(e,t){return Yt.topLevel(e,"meshes",t)};Yt.meshPrimitive=function(e,t){let n=e.primitives;if(u(n)){let i=n.length;for(let o=0;o<i;o++){let r=n[o],s=t(r,o);if(u(s))return s}}};Yt.meshPrimitiveAttribute=function(e,t){let n=e.attributes;for(let i in n)if(Object.prototype.hasOwnProperty.call(n,i)){let o=t(n[i],i);if(u(o))return o}};Yt.meshPrimitiveTarget=function(e,t){let n=e.targets;if(u(n)){let i=n.length;for(let o=0;o<i;++o){let r=t(n[o],o);if(u(r))return r}}};Yt.meshPrimitiveTargetAttribute=function(e,t){for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){let i=e[n],o=t(i,n);if(u(o))return o}};Yt.node=function(e,t){return Yt.topLevel(e,"nodes",t)};Yt.nodeInTree=function(e,t,n){let i=e.nodes;if(u(i)){let o=t.length;for(let r=0;r<o;r++){let s=t[r],a=i[s];if(u(a)){let c=n(a,s);if(u(c))return c;let l=a.children;if(u(l)&&(c=Yt.nodeInTree(e,l,n),u(c)))return c}}}};Yt.nodeInScene=function(e,t,n){let i=t.nodes;if(u(i))return Yt.nodeInTree(e,i,n)};Yt.program=function(e,t){return xr(e,"KHR_techniques_webgl")?Yt.object(e.extensions.KHR_techniques_webgl.programs,t):Yt.topLevel(e,"programs",t)};Yt.sampler=function(e,t){return Yt.topLevel(e,"samplers",t)};Yt.scene=function(e,t){return Yt.topLevel(e,"scenes",t)};Yt.shader=function(e,t){return xr(e,"KHR_techniques_webgl")?Yt.object(e.extensions.KHR_techniques_webgl.shaders,t):Yt.topLevel(e,"shaders",t)};Yt.skin=function(e,t){return Yt.topLevel(e,"skins",t)};Yt.skinJoint=function(e,t){let n=e.joints;if(u(n)){let i=n.length;for(let o=0;o<i;o++){let r=n[o],s=t(r);if(u(s))return s}}};Yt.techniqueAttribute=function(e,t){let n=e.attributes;for(let i in n)if(Object.prototype.hasOwnProperty.call(n,i)){let o=t(n[i],i);if(u(o))return o}};Yt.techniqueUniform=function(e,t){let n=e.uniforms;for(let i in n)if(Object.prototype.hasOwnProperty.call(n,i)){let o=t(n[i],i);if(u(o))return o}};Yt.techniqueParameter=function(e,t){let n=e.parameters;for(let i in n)if(Object.prototype.hasOwnProperty.call(n,i)){let o=t(n[i],i);if(u(o))return o}};Yt.technique=function(e,t){return xr(e,"KHR_techniques_webgl")?Yt.object(e.extensions.KHR_techniques_webgl.techniques,t):Yt.topLevel(e,"techniques",t)};Yt.texture=function(e,t){return Yt.topLevel(e,"textures",t)};var Pe=Yt;function xke(e){switch(e){case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16}}var df=xke;function bke(e,t){let n=t.bufferView;if(u(n)){let i=e.bufferViews[n];if(u(i.byteStride)&&i.byteStride>0)return i.byteStride}return K.getSizeInBytes(t.componentType)*df(t.type)}var ru=bke;function Cke(e){Pe.accessor(e,function(n){u(n.bufferView)&&(n.byteOffset=x(n.byteOffset,0))}),Pe.bufferView(e,function(n){u(n.buffer)&&(n.byteOffset=x(n.byteOffset,0))}),Pe.mesh(e,function(n){Pe.meshPrimitive(n,function(i){if(i.mode=x(i.mode,te.TRIANGLES),!u(i.material)){u(e.materials)||(e.materials=[]);let o={name:"default"};i.material=ks(e.materials,o)}})}),Pe.accessorContainingVertexAttributeData(e,function(n){let i=e.accessors[n],o=i.bufferView;if(i.normalized=x(i.normalized,!1),u(o)){let r=e.bufferViews[o];r.byteStride=ru(e,i),r.target=te.ARRAY_BUFFER}}),Pe.accessorContainingIndexData(e,function(n){let o=e.accessors[n].bufferView;if(u(o)){let r=e.bufferViews[o];r.target=te.ELEMENT_ARRAY_BUFFER}}),Pe.material(e,function(n){let i=x(n.extensions,x.EMPTY_OBJECT),o=i.KHR_materials_common;if(u(o)){let c=o.technique,l=u(o.values)?o.values:{};o.values=l,l.ambient=u(l.ambient)?l.ambient:[0,0,0,1],l.emission=u(l.emission)?l.emission:[0,0,0,1],l.transparency=x(l.transparency,1),c!=="CONSTANT"&&(l.diffuse=u(l.diffuse)?l.diffuse:[0,0,0,1],c!=="LAMBERT"&&(l.specular=u(l.specular)?l.specular:[0,0,0,1],l.shininess=x(l.shininess,0))),o.transparent=x(o.transparent,!1),o.doubleSided=x(o.doubleSided,!1);return}n.emissiveFactor=x(n.emissiveFactor,[0,0,0]),n.alphaMode=x(n.alphaMode,"OPAQUE"),n.doubleSided=x(n.doubleSided,!1),n.alphaMode==="MASK"&&(n.alphaCutoff=x(n.alphaCutoff,.5));let r=i.KHR_techniques_webgl;u(r)&&Pe.materialValue(n,function(c){u(c.index)&&ix(c)}),ix(n.emissiveTexture),ix(n.normalTexture),ix(n.occlusionTexture);let s=n.pbrMetallicRoughness;u(s)&&(s.baseColorFactor=x(s.baseColorFactor,[1,1,1,1]),s.metallicFactor=x(s.metallicFactor,1),s.roughnessFactor=x(s.roughnessFactor,1),ix(s.baseColorTexture),ix(s.metallicRoughnessTexture));let a=i.KHR_materials_pbrSpecularGlossiness;u(a)&&(a.diffuseFactor=x(a.diffuseFactor,[1,1,1,1]),a.specularFactor=x(a.specularFactor,[1,1,1]),a.glossinessFactor=x(a.glossinessFactor,1),ix(a.specularGlossinessTexture))}),Pe.animation(e,function(n){Pe.animationSampler(n,function(i){i.interpolation=x(i.interpolation,"LINEAR")})});let t=Ake(e);return Pe.node(e,function(n,i){u(t[i])||u(n.translation)||u(n.rotation)||u(n.scale)?(n.translation=x(n.translation,[0,0,0]),n.rotation=x(n.rotation,[0,0,0,1]),n.scale=x(n.scale,[1,1,1])):n.matrix=x(n.matrix,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}),Pe.sampler(e,function(n){n.wrapS=x(n.wrapS,te.REPEAT),n.wrapT=x(n.wrapT,te.REPEAT)}),u(e.scenes)&&!u(e.scene)&&(e.scene=0),e}function Ake(e){let t={};return Pe.animation(e,function(n){Pe.animationChannel(n,function(i){let o=i.target,r=o.node,s=o.path;(s==="translation"||s==="rotation"||s==="scale")&&(t[r]=!0)})}),t}function ix(e){u(e)&&(e.texCoord=x(e.texCoord,0))}var cN=Cke;function Tke(e){return Pe.shader(e,function(t){lN(t)}),Pe.buffer(e,function(t){lN(t)}),Pe.image(e,function(t){lN(t)}),lN(e),e}function lN(e){e.extras=u(e.extras)?e.extras:{},e.extras._pipeline=u(e.extras._pipeline)?e.extras._pipeline:{}}var ox=Tke;function Eke(e,t){let n=e.extensionsRequired;if(u(n)){let i=n.indexOf(t);i>=0&&n.splice(i,1),n.length===0&&delete e.extensionsRequired}}var uN=Eke;function Ske(e,t){let n=e.extensionsUsed;if(u(n)){let i=n.indexOf(t);i>=0&&n.splice(i,1),uN(e,t),n.length===0&&delete e.extensionsUsed}}var lA=Ske;var vke=4;function wke(e){if(zh(e)!=="glTF")throw new ce("File is not valid binary glTF");let n=$ie(e,0,5),i=n[1];if(i!==1&&i!==2)throw new ce("Binary glTF version is not 1 or 2");return i===1?Dke(e,n):Ike(e,n)}function $ie(e,t,n){let i=new DataView(e.buffer),o=new Array(n);for(let r=0;r<n;++r)o[r]=i.getUint32(e.byteOffset+t+r*vke,!0);return o}function Dke(e,t){let n=t[2],i=t[3];if(t[4]!==0)throw new ce("Binary glTF scene format is not JSON");let r=20,s=r+i,a=tu(e,r,i),c=JSON.parse(a);ox(c);let l=e.subarray(s,n),f=c.buffers;if(u(f)&&Object.keys(f).length>0){let d=x(f.binary_glTF,f.KHR_binary_glTF);u(d)&&(d.extras._pipeline.source=l,delete d.uri)}return lA(c,"KHR_binary_glTF"),c}function Ike(e,t){let n=t[2],i=12,o,r;for(;i<n;){let s=$ie(e,i,2),a=s[0],c=s[1];i+=8;let l=e.subarray(i,i+a);if(i+=a,c===1313821514){let f=tu(l);o=JSON.parse(f),ox(o)}else c===5130562&&(r=l)}if(u(o)&&u(r)){let s=o.buffers;if(u(s)&&s.length>0){let a=s[0];a.extras._pipeline.source=r}}return o}var fN=wke;function Pke(e){return Pe.shader(e,function(t){dN(t)}),Pe.buffer(e,function(t){dN(t)}),Pe.image(e,function(t){dN(t)}),dN(e),e}function dN(e){u(e.extras)&&(u(e.extras._pipeline)&&delete e.extras._pipeline,Object.keys(e.extras).length===0&&delete e.extras)}var hN=Pke;function Rke(e,t){let n=e.extensionsUsed;u(n)||(n=[],e.extensionsUsed=n),ks(n,t,!0)}var yd=Rke;function Oke(e){switch(e){case K.BYTE:return function(t,n,i,o,r){for(let s=0;s<i;++s)r[s]=t.getInt8(n+s*o)};case K.UNSIGNED_BYTE:return function(t,n,i,o,r){for(let s=0;s<i;++s)r[s]=t.getUint8(n+s*o)};case K.SHORT:return function(t,n,i,o,r){for(let s=0;s<i;++s)r[s]=t.getInt16(n+s*o,!0)};case K.UNSIGNED_SHORT:return function(t,n,i,o,r){for(let s=0;s<i;++s)r[s]=t.getUint16(n+s*o,!0)};case K.INT:return function(t,n,i,o,r){for(let s=0;s<i;++s)r[s]=t.getInt32(n+s*o,!0)};case K.UNSIGNED_INT:return function(t,n,i,o,r){for(let s=0;s<i;++s)r[s]=t.getUint32(n+s*o,!0)};case K.FLOAT:return function(t,n,i,o,r){for(let s=0;s<i;++s)r[s]=t.getFloat32(n+s*o,!0)};case K.DOUBLE:return function(t,n,i,o,r){for(let s=0;s<i;++s)r[s]=t.getFloat64(n+s*o,!0)}}}var mg=Oke;function Mke(e,t){let n=e.bufferViews,i=e.buffers,o=t.bufferView,r=df(t.type);if(!u(t.bufferView))return{min:new Array(r).fill(0),max:new Array(r).fill(0)};let s=new Array(r).fill(Number.POSITIVE_INFINITY),a=new Array(r).fill(Number.NEGATIVE_INFINITY),c=n[o],l=c.buffer,d=i[l].extras._pipeline.source,p=t.count,g=ru(e,t),m=t.byteOffset+c.byteOffset+d.byteOffset,y=t.componentType,b=K.getSizeInBytes(y),C=new DataView(d.buffer),A=new Array(r),T=mg(y);for(let E=0;E<p;E++){T(C,m,r,b,A);for(let v=0;v<r;v++){let D=A[v];s[v]=Math.min(s[v],D),a[v]=Math.max(a[v],D)}m+=g}return{min:s,max:a}}var uA=Mke;var Lke=[te.FUNC_ADD,te.FUNC_ADD],Nke=[te.ONE,te.ZERO,te.ONE,te.ZERO];function Qie(e,t){let n=e.enable;return u(n)?n.indexOf(t)>-1:!1}var Fke=[te.ZERO,te.ONE,te.SRC_COLOR,te.ONE_MINUS_SRC_COLOR,te.SRC_ALPHA,te.ONE_MINUS_SRC_ALPHA,te.DST_ALPHA,te.ONE_MINUS_DST_ALPHA,te.DST_COLOR,te.ONE_MINUS_DST_COLOR];function Bke(e,t){if(!u(e))return t;for(let n=0;n<4;n++)if(Fke.indexOf(e[n])===-1)return t;return e}function kke(e){let t={},n={},i=e.techniques;return u(i)&&(Pe.technique(e,function(o,r){let s=o.states;if(u(s)){let a=n[r]={};if(Qie(s,te.BLEND)){a.alphaMode="BLEND";let c=s.functions;u(c)&&(u(c.blendEquationSeparate)||u(c.blendFuncSeparate))&&(t[r]={blendEquation:x(c.blendEquationSeparate,Lke),blendFactors:Bke(c.blendFuncSeparate,Nke)})}Qie(s,te.CULL_FACE)||(a.doubleSided=!0),delete o.states}}),Object.keys(t).length>0&&(u(e.extensions)||(e.extensions={}),yd(e,"KHR_blend")),Pe.material(e,function(o){if(u(o.technique)){let r=n[o.technique];Pe.objectLegacy(r,function(a,c){o[c]=a});let s=t[o.technique];u(s)&&(u(o.extensions)||(o.extensions={}),o.extensions.KHR_blend=s)}})),e}var mN=kke;function Vke(e,t){let n=e.extensionsRequired;u(n)||(n=[],e.extensionsRequired=n),ks(n,t,!0),yd(e,t)}var pN=Vke;function Uke(e){let t=e.techniques,n={},i={},o={};if(u(t)){let r={programs:[],shaders:[],techniques:[]},s=e.glExtensionsUsed;delete e.glExtensionsUsed,Pe.technique(e,function(a,c){let l={name:a.name,program:void 0,attributes:{},uniforms:{}},f;if(Pe.techniqueAttribute(a,function(d,p){f=a.parameters[d],l.attributes[p]={semantic:f.semantic}}),Pe.techniqueUniform(a,function(d,p){f=a.parameters[d],l.uniforms[p]={count:f.count,node:f.node,type:f.type,semantic:f.semantic,value:f.value},u(n[c])||(n[c]={}),n[c][d]=p}),u(o[a.program]))l.program=o[a.program];else{let d=e.programs[a.program],p={name:d.name,fragmentShader:void 0,vertexShader:void 0,glExtensions:s},g=e.shaders[d.fragmentShader];p.fragmentShader=ks(r.shaders,g,!0);let m=e.shaders[d.vertexShader];p.vertexShader=ks(r.shaders,m,!0),l.program=ks(r.programs,p),o[a.program]=l.program}i[c]=ks(r.techniques,l)}),r.techniques.length>0&&(u(e.extensions)||(e.extensions={}),e.extensions.KHR_techniques_webgl=r,yd(e,"KHR_techniques_webgl"),pN(e,"KHR_techniques_webgl"))}return Pe.material(e,function(r){if(u(r.technique)){let s={technique:i[r.technique]};Pe.objectLegacy(r.values,function(a,c){u(s.values)||(s.values={});let l=n[r.technique][c];u(l)&&(s.values[l]=a)}),u(r.extensions)||(r.extensions={}),r.extensions.KHR_techniques_webgl=s}delete r.technique,delete r.values}),delete e.techniques,delete e.programs,delete e.shaders,e}var _N=Uke;function zke(e,t){To.typeOf.object("material",e),To.defined("handler",t);let n=e.pbrMetallicRoughness;if(u(n)){if(u(n.baseColorTexture)){let r=n.baseColorTexture,s=t(r.index,r);if(u(s))return s}if(u(n.metallicRoughnessTexture)){let r=n.metallicRoughnessTexture,s=t(r.index,r);if(u(s))return s}}let{extensions:i}=e;if(u(i)){let r=i.KHR_materials_pbrSpecularGlossiness;if(u(r)){if(u(r.diffuseTexture)){let c=r.diffuseTexture,l=t(c.index,c);if(u(l))return l}if(u(r.specularGlossinessTexture)){let c=r.specularGlossinessTexture,l=t(c.index,c);if(u(l))return l}}let s=i.KHR_materials_specular;if(u(s)){let{specularTexture:c,specularColorTexture:l}=s;if(u(c)){let f=t(c.index,c);if(u(f))return f}if(u(l)){let f=t(l.index,l);if(u(f))return f}}let a=i.KHR_materials_common;if(u(a)&&u(a.values)){let{diffuse:c,ambient:l,emission:f,specular:d}=a.values;if(u(c)&&u(c.index)){let p=t(c.index,c);if(u(p))return p}if(u(l)&&u(l.index)){let p=t(l.index,l);if(u(p))return p}if(u(f)&&u(f.index)){let p=t(f.index,f);if(u(p))return p}if(u(d)&&u(d.index)){let p=t(d.index,d);if(u(p))return p}}}let o=Pe.materialValue(e,function(r){if(u(r.index)){let s=t(r.index,r);if(u(s))return s}});if(u(o))return o;if(u(e.emissiveTexture)){let r=e.emissiveTexture,s=t(r.index,r);if(u(s))return s}if(u(e.normalTexture)){let r=e.normalTexture,s=t(r.index,r);if(u(s))return s}if(u(e.occlusionTexture)){let r=e.occlusionTexture,s=t(r.index,r);if(u(s))return s}}var Xv=zke;var Jie=["mesh","node","material","accessor","bufferView","buffer","texture","sampler","image"];function Hke(e,t){return t=x(t,Jie),Jie.forEach(function(n){t.indexOf(n)>-1&&Wke(e,n)}),e}var Gke={accessor:"accessors",buffer:"buffers",bufferView:"bufferViews",image:"images",node:"nodes",material:"materials",mesh:"meshes",sampler:"samplers",texture:"textures"};function Wke(e,t){let n=Gke[t],i=e[n];if(u(i)){let o=0,r=Wh[t](e),s=i.length;for(let a=0;a<s;++a)r[a]||(Gh[t](e,a-o),o++)}}function Gh(){}Gh.accessor=function(e,t){e.accessors.splice(t,1),Pe.mesh(e,function(i){Pe.meshPrimitive(i,function(o){Pe.meshPrimitiveAttribute(o,function(a,c){a>t&&o.attributes[c]--}),Pe.meshPrimitiveTarget(o,function(a){Pe.meshPrimitiveTargetAttribute(a,function(c,l){c>t&&a[l]--})});let r=o.indices;u(r)&&r>t&&o.indices--;let s=o.extensions;u(s)&&u(s.CESIUM_primitive_outline)&&s.CESIUM_primitive_outline.indices>t&&--s.CESIUM_primitive_outline.indices})}),Pe.skin(e,function(i){u(i.inverseBindMatrices)&&i.inverseBindMatrices>t&&i.inverseBindMatrices--}),Pe.animation(e,function(i){Pe.animationSampler(i,function(o){u(o.input)&&o.input>t&&o.input--,u(o.output)&&o.output>t&&o.output--})})};Gh.buffer=function(e,t){e.buffers.splice(t,1),Pe.bufferView(e,function(i){u(i.buffer)&&i.buffer>t&&i.buffer--,u(i.extensions)&&u(i.extensions.EXT_meshopt_compression)&&i.extensions.EXT_meshopt_compression.buffer--})};Gh.bufferView=function(e,t){if(e.bufferViews.splice(t,1),Pe.accessor(e,function(i){u(i.bufferView)&&i.bufferView>t&&i.bufferView--}),Pe.shader(e,function(i){u(i.bufferView)&&i.bufferView>t&&i.bufferView--}),Pe.image(e,function(i){u(i.bufferView)&&i.bufferView>t&&i.bufferView--}),xr(e,"KHR_draco_mesh_compression")&&Pe.mesh(e,function(i){Pe.meshPrimitive(i,function(o){u(o.extensions)&&u(o.extensions.KHR_draco_mesh_compression)&&o.extensions.KHR_draco_mesh_compression.bufferView>t&&o.extensions.KHR_draco_mesh_compression.bufferView--})}),xr(e,"EXT_feature_metadata")){let o=e.extensions.EXT_feature_metadata.featureTables;for(let r in o)if(o.hasOwnProperty(r)){let a=o[r].properties;if(u(a)){for(let c in a)if(a.hasOwnProperty(c)){let l=a[c];u(l.bufferView)&&l.bufferView>t&&l.bufferView--,u(l.arrayOffsetBufferView)&&l.arrayOffsetBufferView>t&&l.arrayOffsetBufferView--,u(l.stringOffsetBufferView)&&l.stringOffsetBufferView>t&&l.stringOffsetBufferView--}}}}if(xr(e,"EXT_structural_metadata")){let o=e.extensions.EXT_structural_metadata.propertyTables;if(u(o)){let r=o.length;for(let s=0;s<r;++s){let c=o[s].properties;for(let l in c)if(c.hasOwnProperty(l)){let f=c[l];u(f.values)&&f.values>t&&f.values--,u(f.arrayOffsets)&&f.arrayOffsets>t&&f.arrayOffsets--,u(f.stringOffsets)&&f.stringOffsets>t&&f.stringOffsets--}}}}};Gh.image=function(e,t){e.images.splice(t,1),Pe.texture(e,function(i){u(i.source)&&i.source>t&&--i.source;let o=i.extensions;u(o)&&u(o.EXT_texture_webp)&&o.EXT_texture_webp.source>t?--i.extensions.EXT_texture_webp.source:u(o)&&u(o.KHR_texture_basisu)&&o.KHR_texture_basisu.source>t&&--i.extensions.KHR_texture_basisu.source})};Gh.mesh=function(e,t){e.meshes.splice(t,1),Pe.node(e,function(i){u(i.mesh)&&(i.mesh>t?i.mesh--:i.mesh===t&&delete i.mesh)})};Gh.node=function(e,t){e.nodes.splice(t,1),Pe.skin(e,function(i){u(i.skeleton)&&i.skeleton>t&&i.skeleton--,i.joints=i.joints.map(function(o){return o>t?o-1:o})}),Pe.animation(e,function(i){Pe.animationChannel(i,function(o){u(o.target)&&u(o.target.node)&&o.target.node>t&&o.target.node--})}),Pe.technique(e,function(i){Pe.techniqueUniform(i,function(o){u(o.node)&&o.node>t&&o.node--})}),Pe.node(e,function(i){u(i.children)&&(i.children=i.children.filter(function(o){return o!==t}).map(function(o){return o>t?o-1:o}))}),Pe.scene(e,function(i){i.nodes=i.nodes.filter(function(o){return o!==t}).map(function(o){return o>t?o-1:o})})};Gh.material=function(e,t){e.materials.splice(t,1),Pe.mesh(e,function(i){Pe.meshPrimitive(i,function(o){u(o.material)&&o.material>t&&o.material--})})};Gh.sampler=function(e,t){e.samplers.splice(t,1),Pe.texture(e,function(i){u(i.sampler)&&i.sampler>t&&--i.sampler})};Gh.texture=function(e,t){if(e.textures.splice(t,1),Pe.material(e,function(i){Xv(i,function(o,r){r.index>t&&--r.index})}),xr(e,"EXT_feature_metadata")){Pe.mesh(e,function(r){Pe.meshPrimitive(r,function(s){let a=s.extensions;if(u(a)&&u(a.EXT_feature_metadata)){let l=a.EXT_feature_metadata.featureIdTextures;if(u(l)){let f=l.length;for(let d=0;d<f;++d){let g=l[d].featureIds.texture;g.index>t&&--g.index}}}})});let o=e.extensions.EXT_feature_metadata.featureTextures;for(let r in o)if(o.hasOwnProperty(r)){let a=o[r].properties;if(u(a)){for(let c in a)if(a.hasOwnProperty(c)){let f=a[c].texture;f.index>t&&--f.index}}}}if(xr(e,"EXT_mesh_features")&&Pe.mesh(e,function(i){Pe.meshPrimitive(i,function(o){let r=o.extensions;if(u(r)&&u(r.EXT_mesh_features)){let a=r.EXT_mesh_features.featureIds;if(u(a)){let c=a.length;for(let l=0;l<c;++l){let f=a[l];u(f.texture)&&f.texture.index>t&&--f.texture.index}}}})}),xr(e,"EXT_structural_metadata")){let o=e.extensions.EXT_structural_metadata.propertyTextures;if(u(o)){let r=o.length;for(let s=0;s<r;++s){let c=o[s].properties;for(let l in c)if(c.hasOwnProperty(l)){let f=c[l];f.index>t&&--f.index}}}}};function Wh(){}Wh.accessor=function(e){let t={};return Pe.mesh(e,function(n){Pe.meshPrimitive(n,function(i){Pe.meshPrimitiveAttribute(i,function(r){t[r]=!0}),Pe.meshPrimitiveTarget(i,function(r){Pe.meshPrimitiveTargetAttribute(r,function(s){t[s]=!0})});let o=i.indices;u(o)&&(t[o]=!0)})}),Pe.skin(e,function(n){u(n.inverseBindMatrices)&&(t[n.inverseBindMatrices]=!0)}),Pe.animation(e,function(n){Pe.animationSampler(n,function(i){u(i.input)&&(t[i.input]=!0),u(i.output)&&(t[i.output]=!0)})}),xr(e,"EXT_mesh_gpu_instancing")&&Pe.node(e,function(n){u(n.extensions)&&u(n.extensions.EXT_mesh_gpu_instancing)&&Object.keys(n.extensions.EXT_mesh_gpu_instancing.attributes).forEach(function(i){let o=n.extensions.EXT_mesh_gpu_instancing.attributes[i];t[o]=!0})}),xr(e,"CESIUM_primitive_outline")&&Pe.mesh(e,function(n){Pe.meshPrimitive(n,function(i){let o=i.extensions;if(u(o)&&u(o.CESIUM_primitive_outline)){let s=o.CESIUM_primitive_outline.indices;u(s)&&(t[s]=!0)}})}),t};Wh.buffer=function(e){let t={};return Pe.bufferView(e,function(n){u(n.buffer)&&(t[n.buffer]=!0),u(n.extensions)&&u(n.extensions.EXT_meshopt_compression)&&(t[n.extensions.EXT_meshopt_compression.buffer]=!0)}),t};Wh.bufferView=function(e){let t={};if(Pe.accessor(e,function(n){u(n.bufferView)&&(t[n.bufferView]=!0)}),Pe.shader(e,function(n){u(n.bufferView)&&(t[n.bufferView]=!0)}),Pe.image(e,function(n){u(n.bufferView)&&(t[n.bufferView]=!0)}),xr(e,"KHR_draco_mesh_compression")&&Pe.mesh(e,function(n){Pe.meshPrimitive(n,function(i){u(i.extensions)&&u(i.extensions.KHR_draco_mesh_compression)&&(t[i.extensions.KHR_draco_mesh_compression.bufferView]=!0)})}),xr(e,"EXT_feature_metadata")){let i=e.extensions.EXT_feature_metadata.featureTables;for(let o in i)if(i.hasOwnProperty(o)){let s=i[o].properties;if(u(s)){for(let a in s)if(s.hasOwnProperty(a)){let c=s[a];u(c.bufferView)&&(t[c.bufferView]=!0),u(c.arrayOffsetBufferView)&&(t[c.arrayOffsetBufferView]=!0),u(c.stringOffsetBufferView)&&(t[c.stringOffsetBufferView]=!0)}}}}if(xr(e,"EXT_structural_metadata")){let i=e.extensions.EXT_structural_metadata.propertyTables;if(u(i)){let o=i.length;for(let r=0;r<o;++r){let a=i[r].properties;for(let c in a)if(a.hasOwnProperty(c)){let l=a[c];u(l.values)&&(t[l.values]=!0),u(l.arrayOffsets)&&(t[l.arrayOffsets]=!0),u(l.stringOffsets)&&(t[l.stringOffsets]=!0)}}}}return t};Wh.image=function(e){let t={};return Pe.texture(e,function(n){u(n.source)&&(t[n.source]=!0),u(n.extensions)&&u(n.extensions.EXT_texture_webp)?t[n.extensions.EXT_texture_webp.source]=!0:u(n.extensions)&&u(n.extensions.KHR_texture_basisu)&&(t[n.extensions.KHR_texture_basisu.source]=!0)}),t};Wh.mesh=function(e){let t={};return Pe.node(e,function(n){if(u(n.mesh&&u(e.meshes))){let i=e.meshes[n.mesh];u(i)&&u(i.primitives)&&i.primitives.length>0&&(t[n.mesh]=!0)}}),t};function eoe(e,t,n){let i=e.nodes[t];return u(i.mesh)||u(i.camera)||u(i.skin)||u(i.weights)||u(i.extras)||u(i.extensions)&&Object.keys(i.extensions).length!==0||u(n[t])?!1:!u(i.children)||i.children.filter(function(o){return!eoe(e,o,n)}).length===0}Wh.node=function(e){let t={};return Pe.skin(e,function(n){u(n.skeleton)&&(t[n.skeleton]=!0),Pe.skinJoint(n,function(i){t[i]=!0})}),Pe.animation(e,function(n){Pe.animationChannel(n,function(i){u(i.target)&&u(i.target.node)&&(t[i.target.node]=!0)})}),Pe.technique(e,function(n){Pe.techniqueUniform(n,function(i){u(i.node)&&(t[i.node]=!0)})}),Pe.node(e,function(n,i){eoe(e,i,t)||(t[i]=!0)}),t};Wh.material=function(e){let t={};return Pe.mesh(e,function(n){Pe.meshPrimitive(n,function(i){u(i.material)&&(t[i.material]=!0)})}),t};Wh.texture=function(e){let t={};if(Pe.material(e,function(n){Xv(n,function(i){t[i]=!0})}),xr(e,"EXT_feature_metadata")){Pe.mesh(e,function(o){Pe.meshPrimitive(o,function(r){let s=r.extensions;if(u(s)&&u(s.EXT_feature_metadata)){let c=s.EXT_feature_metadata.featureIdTextures;if(u(c)){let l=c.length;for(let f=0;f<l;++f){let p=c[f].featureIds.texture;t[p.index]=!0}}}})});let i=e.extensions.EXT_feature_metadata.featureTextures;for(let o in i)if(i.hasOwnProperty(o)){let s=i[o].properties;if(u(s)){for(let a in s)if(s.hasOwnProperty(a)){let l=s[a].texture;t[l.index]=!0}}}}if(xr(e,"EXT_mesh_features")&&Pe.mesh(e,function(n){Pe.meshPrimitive(n,function(i){let o=i.extensions;if(u(o)&&u(o.EXT_mesh_features)){let s=o.EXT_mesh_features.featureIds;if(u(s)){let a=s.length;for(let c=0;c<a;++c){let l=s[c];u(l.texture)&&(t[l.texture.index]=!0)}}}})}),xr(e,"EXT_structural_metadata")){let i=e.extensions.EXT_structural_metadata.propertyTextures;if(u(i)){let o=i.length;for(let r=0;r<o;++r){let a=i[r].properties;for(let c in a)if(a.hasOwnProperty(c)){let l=a[c];t[l.index]=!0}}}}return t};Wh.sampler=function(e){let t={};return Pe.texture(e,function(n){u(n.sampler)&&(t[n.sampler]=!0)}),t};var gN=Hke;function jke(e,t){let n={byteLength:t.length,extras:{_pipeline:{source:t}}},o={buffer:ks(e.buffers,n),byteOffset:0,byteLength:t.length};return ks(e.bufferViews,o)}var yN=jke;function qke(e,t){let n=ru(e,t),i=K.getSizeInBytes(t.componentType),o=df(t.type),r=t.count,s=new Array(o*r);if(!u(t.bufferView))return s.fill(0);let a=e.bufferViews[t.bufferView],c=e.buffers[a.buffer].extras._pipeline.source,l=t.byteOffset+a.byteOffset+c.byteOffset,f=new DataView(c.buffer),d=new Array(o),p=mg(t.componentType);for(let g=0;g<r;++g){p(f,l,o,i,d);for(let m=0;m<o;++m)s[g*o+m]=d[m];l+=n}return s}var xN=qke;function Yke(e){let t;return Pe.accessorWithSemantic(e,"JOINTS_0",function(n){let i=e.accessors[n];t=i.componentType,t===te.BYTE?bN(e,i,K.UNSIGNED_BYTE):t!==te.UNSIGNED_BYTE&&t!==te.UNSIGNED_SHORT&&bN(e,i,K.UNSIGNED_SHORT)}),Pe.accessorWithSemantic(e,"WEIGHTS_0",function(n){let i=e.accessors[n];t=i.componentType,t===te.BYTE?bN(e,i,K.UNSIGNED_BYTE):t===te.SHORT&&bN(e,i,K.UNSIGNED_SHORT)}),e}function bN(e,t,n){let i=K.createTypedArray(n,xN(e,t)),o=new Uint8Array(i.buffer);t.bufferView=yN(e,o),t.componentType=n,t.byteOffset=0}var CN=Yke;function Xke(e,t){return lA(e,t),t==="CESIUM_RTC"&&Kke(e),cW(e,t)}function Kke(e){Pe.technique(e,function(t){Pe.techniqueUniform(t,function(n){n.semantic==="CESIUM_RTC_MODELVIEW"&&(n.semantic="MODELVIEW")})})}function cW(e,t){if(Array.isArray(e)){let n=e.length;for(let i=0;i<n;++i)cW(e[i],t)}else if(e!==null&&typeof e=="object"&&e.constructor===Object){let n=e.extensions,i;u(n)&&(i=n[t],u(i)&&(delete n[t],Object.keys(n).length===0&&delete e.extensions));for(let o in e)Object.prototype.hasOwnProperty.call(e,o)&&cW(e[o],t);return i}}var fA=Xke;var AN={.8:t4e,"1.0":A4e,"2.0":void 0};function Zke(e,t){t=x(t,x.EMPTY_OBJECT);let n=t.targetVersion,i=e.version;e.asset=x(e.asset,{version:"1.0"}),e.asset.version=x(e.asset.version,"1.0"),i=x(i,e.asset.version).toString(),Object.prototype.hasOwnProperty.call(AN,i)||(u(i)&&(i=i.substring(0,3)),Object.prototype.hasOwnProperty.call(AN,i)||(i="1.0"));let o=AN[i];for(;u(o)&&i!==n;)o(e,t),i=e.asset.version,o=AN[i];return t.keepLegacyExtensions||(S4e(e,t),v4e(e)),e}function ioe(e){let t=e.materials;for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)){let i=t[n],o=i.instanceTechnique;u(o)&&(i.technique=o.technique,i.values=o.values,delete i.instanceTechnique)}}function $ke(e){let t=e.meshes;for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)){let o=t[n].primitives;if(u(o)){let r=o.length;for(let s=0;s<r;++s){let a=o[s],c=x(a.primitive,te.TRIANGLES);a.mode=x(a.mode,c),delete a.primitive}}}}function Qke(e){let t=e.nodes,n=new h,i=new Le;for(let o in t)if(Object.prototype.hasOwnProperty.call(t,o)){let r=t[o];if(u(r.rotation)){let a=r.rotation;h.fromArray(a,0,n),Le.fromAxisAngle(n,a[3],i),r.rotation=[i.x,i.y,i.z,i.w]}let s=r.instanceSkin;u(s)&&(r.skeletons=s.skeletons,r.skin=s.skin,r.meshes=s.meshes,delete r.instanceSkin)}}function Jke(e){let t=e.animations,n=e.accessors,i=e.bufferViews,o=e.buffers,r={},s=new h,a=new Le;for(let c in t)if(Object.prototype.hasOwnProperty.call(t,c)){let l=t[c],f=l.channels,d=l.parameters,p=l.samplers;if(u(f)){let g=f.length;for(let m=0;m<g;++m){let y=f[m];if(y.target.path==="rotation"){let b=d[p[y.sampler].output];if(u(r[b]))continue;r[b]=!0;let C=n[b],A=i[C.bufferView],E=o[A.buffer].extras._pipeline.source,v=E.byteOffset+A.byteOffset+C.byteOffset,D=C.componentType,O=C.count,P=df(C.type),M=C.count*P,L=K.createArrayBufferView(D,E.buffer,v,M);for(let _=0;_<O;_++){let S=_*P;h.unpack(L,S,s);let w=L[S+3];Le.fromAxisAngle(s,w,a),Le.pack(a,L,S)}}}}}}function e4e(e){let t=e.techniques;for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)){let i=t[n],o=i.passes;if(u(o)){let r=x(i.pass,"defaultPass");if(Object.prototype.hasOwnProperty.call(o,r)){let s=o[r],a=s.instanceProgram;i.attributes=x(i.attributes,a.attributes),i.program=x(i.program,a.program),i.uniforms=x(i.uniforms,a.uniforms),i.states=x(i.states,s.states)}delete i.passes,delete i.pass}}}function t4e(e){u(e.asset)||(e.asset={});let t=e.asset;if(t.version="1.0",typeof t.profile=="string"){let n=t.profile.split(" ");t.profile={api:n[0],version:n[1]}}else t.profile={};if(u(e.version)&&delete e.version,ioe(e),$ke(e),Qke(e),Jke(e),e4e(e),u(e.allExtensions)&&(e.extensionsUsed=e.allExtensions,delete e.allExtensions),u(e.lights)){let n=x(e.extensions,{});e.extensions=n;let i=x(n.KHR_materials_common,{});n.KHR_materials_common=i,i.lights=e.lights,delete e.lights,yd(e,"KHR_materials_common")}}function n4e(e){let t=e.animations;for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)){let i=t[n],o=i.parameters;if(u(o)){let r=i.samplers;for(let s in r)if(Object.prototype.hasOwnProperty.call(r,s)){let a=r[s];a.input=o[a.input],a.output=o[a.output]}delete i.parameters}}}function toe(e,t){let n=[];for(let i in e)if(Object.prototype.hasOwnProperty.call(e,i)){let o=e[i];t[i]=n.length,n.push(o),u(o.name)||(o.name=i)}return n}function i4e(e){let t,n={accessors:{},animations:{},buffers:{},bufferViews:{},cameras:{},images:{},materials:{},meshes:{},nodes:{},programs:{},samplers:{},scenes:{},shaders:{},skins:{},textures:{},techniques:{}},i,o={},r=e.nodes;for(let s in r)Object.prototype.hasOwnProperty.call(r,s)&&(i=r[s].jointName,u(i)&&(o[i]=s));for(let s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&u(n[s])){let a={},c=e[s];e[s]=toe(c,a),n[s]=a}for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(o[i]=n.nodes[o[i]]);u(e.scene)&&(e.scene=n.scenes[e.scene]),Pe.bufferView(e,function(s){u(s.buffer)&&(s.buffer=n.buffers[s.buffer])}),Pe.accessor(e,function(s){u(s.bufferView)&&(s.bufferView=n.bufferViews[s.bufferView])}),Pe.shader(e,function(s){let a=s.extensions;if(u(a)){let c=a.KHR_binary_glTF;u(c)&&(s.bufferView=n.bufferViews[c.bufferView],delete a.KHR_binary_glTF),Object.keys(a).length===0&&delete s.extensions}}),Pe.program(e,function(s){u(s.vertexShader)&&(s.vertexShader=n.shaders[s.vertexShader]),u(s.fragmentShader)&&(s.fragmentShader=n.shaders[s.fragmentShader])}),Pe.technique(e,function(s){u(s.program)&&(s.program=n.programs[s.program]),Pe.techniqueParameter(s,function(a){u(a.node)&&(a.node=n.nodes[a.node]);let c=a.value;typeof c=="string"&&(a.value={index:n.textures[c]})})}),Pe.mesh(e,function(s){Pe.meshPrimitive(s,function(a){u(a.indices)&&(a.indices=n.accessors[a.indices]),Pe.meshPrimitiveAttribute(a,function(c,l){a.attributes[l]=n.accessors[c]}),u(a.material)&&(a.material=n.materials[a.material])})}),Pe.node(e,function(s){let a=s.children;if(u(a)){let c=a.length;for(t=0;t<c;++t)a[t]=n.nodes[a[t]]}if(u(s.meshes)){let c=s.meshes,l=c.length;if(l>0)for(s.mesh=n.meshes[c[0]],t=1;t<l;++t){let f={mesh:n.meshes[c[t]]},d=ks(e.nodes,f);u(a)||(a=[],s.children=a),a.push(d)}delete s.meshes}if(u(s.camera)&&(s.camera=n.cameras[s.camera]),u(s.skin)&&(s.skin=n.skins[s.skin]),u(s.skeletons)){let c=s.skeletons;if(c.length>0&&u(s.skin)){let f=e.skins[s.skin];f.skeleton=n.nodes[c[0]]}delete s.skeletons}u(s.jointName)&&delete s.jointName}),Pe.skin(e,function(s){u(s.inverseBindMatrices)&&(s.inverseBindMatrices=n.accessors[s.inverseBindMatrices]);let a=s.jointNames;if(u(a)){let c=[],l=a.length;for(t=0;t<l;++t)c[t]=o[a[t]];s.joints=c,delete s.jointNames}}),Pe.scene(e,function(s){let a=s.nodes;if(u(a)){let c=a.length;for(t=0;t<c;++t)a[t]=n.nodes[a[t]]}}),Pe.animation(e,function(s){let a={};s.samplers=toe(s.samplers,a),Pe.animationSampler(s,function(c){c.input=n.accessors[c.input],c.output=n.accessors[c.output]}),Pe.animationChannel(s,function(c){c.sampler=a[c.sampler];let l=c.target;u(l)&&(l.node=n.nodes[l.id],delete l.id)})}),Pe.material(e,function(s){u(s.technique)&&(s.technique=n.techniques[s.technique]),Pe.materialValue(s,function(c,l){typeof c=="string"&&(s.values[l]={index:n.textures[c]})});let a=s.extensions;if(u(a)){let c=a.KHR_materials_common;u(c)&&u(c.values)&&Pe.materialValue(c,function(l,f){typeof l=="string"&&(c.values[f]={index:n.textures[l]})})}}),Pe.image(e,function(s){let a=s.extensions;if(u(a)){let c=a.KHR_binary_glTF;u(c)&&(s.bufferView=n.bufferViews[c.bufferView],s.mimeType=c.mimeType,delete a.KHR_binary_glTF),Object.keys(a).length===0&&delete s.extensions}}),Pe.texture(e,function(s){u(s.sampler)&&(s.sampler=n.samplers[s.sampler]),u(s.source)&&(s.source=n.images[s.source])})}function o4e(e){Pe.animation(e,function(t){Pe.animationSampler(t,function(n){delete n.name})})}function r4e(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t)){let n=e[t];Array.isArray(n)&&n.length===0&&delete e[t]}Pe.node(e,function(t){u(t.children)&&t.children.length===0&&delete t.children})}function s4e(e){let t=e.asset;delete t.profile,delete t.premultipliedAlpha}var a4e={CESIUM_RTC:!0,KHR_materials_common:!0,WEB3D_quantized_attributes:!0};function c4e(e){let t=e.extensionsUsed;if(e.extensionsRequired=x(e.extensionsRequired,[]),u(t)){let n=t.length;for(let i=0;i<n;++i){let o=t[i];u(a4e[o])&&e.extensionsRequired.push(o)}}}function l4e(e){Pe.buffer(e,function(t){delete t.type})}function u4e(e){Pe.texture(e,function(t){delete t.format,delete t.internalFormat,delete t.target,delete t.type})}function f4e(e){Pe.mesh(e,function(t){Pe.meshPrimitive(t,function(n){Pe.meshPrimitiveAttribute(n,function(i,o){o==="TEXCOORD"?n.attributes.TEXCOORD_0=i:o==="COLOR"&&(n.attributes.COLOR_0=i)}),delete n.attributes.TEXCOORD,delete n.attributes.COLOR})}),Pe.technique(e,function(t){Pe.techniqueParameter(t,function(n){let i=n.semantic;u(i)&&(i==="TEXCOORD"?n.semantic="TEXCOORD_0":i==="COLOR"&&(n.semantic="COLOR_0"))})})}var d4e={POSITION:!0,NORMAL:!0,TANGENT:!0},h4e={COLOR:"COLOR",JOINT:"JOINTS",JOINTS:"JOINTS",TEXCOORD:"TEXCOORD",WEIGHT:"WEIGHTS",WEIGHTS:"WEIGHTS"};function m4e(e){let t={};Pe.mesh(e,function(n){Pe.meshPrimitive(n,function(i){Pe.meshPrimitiveAttribute(i,function(o,r){if(r.charAt(0)!=="_"){let s=r.search(/_[0-9]+/g),a=r,c="_0";s>=0&&(a=r.substring(0,s),c=r.substring(s));let l,f=h4e[a];u(f)?(l=f+c,t[r]=l):u(d4e[a])||(l=`_${r}`,t[r]=l)}});for(let o in t)if(Object.prototype.hasOwnProperty.call(t,o)){let r=t[o],s=i.attributes[o];u(s)&&(delete i.attributes[o],i.attributes[r]=s)}})}),Pe.technique(e,function(n){Pe.techniqueParameter(n,function(i){let o=t[i.semantic];u(o)&&(i.semantic=o)})})}function p4e(e){Pe.camera(e,function(t){let n=t.perspective;if(u(n)){let i=n.aspectRatio;u(i)&&i===0&&delete n.aspectRatio;let o=n.yfov;u(o)&&o===0&&(n.yfov=1)}})}function uW(e,t){return u(t.byteStride)&&t.byteStride!==0?t.byteStride:ru(e,t)}function _4e(e){Pe.buffer(e,function(t){u(t.byteLength)||(t.byteLength=t.extras._pipeline.source.length)}),Pe.accessor(e,function(t){let n=t.bufferView;if(u(n)){let i=e.bufferViews[n],o=uW(e,t),r=t.byteOffset+t.count*o;i.byteLength=Math.max(x(i.byteLength,0),r)}})}function g4e(e){let t,n,i,o=e.bufferViews,r={};Pe.accessorContainingVertexAttributeData(e,function(a){let c=e.accessors[a];u(c.bufferView)&&(r[c.bufferView]=!0)});let s={};Pe.accessor(e,function(a){u(a.bufferView)&&(s[a.bufferView]=x(s[a.bufferView],[]),s[a.bufferView].push(a))});for(let a in s)if(Object.prototype.hasOwnProperty.call(s,a)){i=o[a];let c=s[a];c.sort(function(p,g){return p.byteOffset-g.byteOffset});let l=0,f=0,d=c.length;for(t=0;t<d;++t){let p=c[t],g=uW(e,p),m=p.byteOffset,y=p.count*g;delete p.byteStride;let b=t<d-1,C=b?uW(e,c[t+1]):void 0;if(g!==C){let A=Ge(i,!0);r[a]&&(A.byteStride=g),A.byteOffset+=l,A.byteLength=m+y-l;let T=ks(o,A);for(n=f;n<=t;++n)p=c[n],p.bufferView=T,p.byteOffset=p.byteOffset-l;l=b?c[t+1].byteOffset:void 0,f=t+1}}}gN(e,["accessor","bufferView","buffer"])}function y4e(e){Pe.accessorWithSemantic(e,"POSITION",function(t){let n=e.accessors[t];if(!u(n.min)||!u(n.max)){let i=uA(e,n);n.min=i.min,n.max=i.max}})}function ooe(e){return(!u(e.children)||e.children.length===0)&&(!u(e.meshes)||e.meshes.length===0)&&!u(e.camera)&&!u(e.skin)&&!u(e.skeletons)&&!u(e.jointName)&&(!u(e.translation)||h.fromArray(e.translation).equals(h.ZERO))&&(!u(e.scale)||h.fromArray(e.scale).equals(new h(1,1,1)))&&(!u(e.rotation)||oe.fromArray(e.rotation).equals(new oe(0,0,0,1)))&&(!u(e.matrix)||F.fromColumnMajorArray(e.matrix).equals(F.IDENTITY))&&!u(e.extensions)&&!u(e.extras)}function roe(e,t){Pe.scene(e,function(n){let i=n.nodes;if(u(i)){let o=i.length;for(let r=o;r>=0;--r)if(i[r]===t){i.splice(r,1);return}}}),Pe.node(e,function(n,i){if(u(n.children)){let o=n.children.indexOf(t);o>-1&&(n.children.splice(o,1),ooe(n)&&roe(e,i))}}),delete e.nodes[t]}function x4e(e){return Pe.node(e,function(t,n){ooe(t)&&roe(e,n)}),e}function b4e(e){Pe.animation(e,function(t){Pe.animationSampler(t,function(n){let i=e.accessors[n.input];if(!u(i.min)||!u(i.max)){let o=uA(e,i);i.min=o.min,i.max=o.max}})})}function C4e(e){Pe.accessor(e,function(t){if(u(t.min)||u(t.max)){let n=uA(e,t);u(t.min)&&(t.min=n.min),u(t.max)&&(t.max=n.max)}})}function A4e(e){e.asset=x(e.asset,{}),e.asset.version="2.0",ioe(e),n4e(e),x4e(e),i4e(e),o4e(e),s4e(e),c4e(e),_4e(e),g4e(e),y4e(e),b4e(e),C4e(e),l4e(e),u4e(e),f4e(e),m4e(e),CN(e),p4e(e),mN(e),_N(e),r4e(e)}var T4e=["u_tex","u_diffuse","u_emission","u_diffuse_tex"],E4e=["u_diffuse","u_diffuse_mat"];function fW(e){e.pbrMetallicRoughness=u(e.pbrMetallicRoughness)?e.pbrMetallicRoughness:{},e.pbrMetallicRoughness.roughnessFactor=1,e.pbrMetallicRoughness.metallicFactor=0}function dW(e){return u(e.index)}function hW(e){return Array.isArray(e)&&e.length===4}function soe(e){let t=new Array(4);t[3]=e[3];for(let n=0;n<3;n++){let i=e[n];i<=.04045?t[n]=e[n]*.07739938080495357:t[n]=Math.pow((i+.055)*.9478672985781991,2.4)}return t}function S4e(e,t){t=x(t,x.EMPTY_OBJECT);let n=x(t.baseColorTextureNames,T4e),i=x(t.baseColorFactorNames,E4e);Pe.material(e,function(o){Pe.materialValue(o,function(r,s){n.indexOf(s)!==-1&&dW(r)?(fW(o),o.pbrMetallicRoughness.baseColorTexture=r):i.indexOf(s)!==-1&&hW(r)&&(fW(o),o.pbrMetallicRoughness.baseColorFactor=soe(r))})}),fA(e,"KHR_techniques_webgl"),fA(e,"KHR_blend")}function lW(e,t){u(t)&&(hW(t)?e.pbrMetallicRoughness.baseColorFactor=soe(t):dW(t)&&(e.pbrMetallicRoughness.baseColorTexture=t))}function noe(e,t){u(t)&&(hW(t)?e.emissiveFactor=t.slice(0,3):dW(t)&&(e.emissiveTexture=t))}function v4e(e){Pe.material(e,function(t){let n=x(t.extensions,x.EMPTY_OBJECT).KHR_materials_common;if(!u(n))return;let i=x(n.values,{}),o=i.ambient,r=i.diffuse,s=i.emission,a=i.transparency,c=n.doubleSided,l=n.transparent;fW(t),n.technique==="CONSTANT"?(yd(e,"KHR_materials_unlit"),t.extensions=u(t.extensions)?t.extensions:{},t.extensions.KHR_materials_unlit={},lW(t,s),lW(t,o)):(lW(t,r),noe(t,o),noe(t,s)),u(c)&&(t.doubleSided=c),u(a)&&(u(t.pbrMetallicRoughness.baseColorFactor)?t.pbrMetallicRoughness.baseColorFactor[3]*=a:t.pbrMetallicRoughness.baseColorFactor=[1,1,1,a]),u(l)&&(t.alphaMode=l?"BLEND":"OPAQUE")}),fA(e,"KHR_materials_common")}var TN=Zke;var Jn={POSITION:"POSITION",NORMAL:"NORMAL",TANGENT:"TANGENT",TEXCOORD:"TEXCOORD",COLOR:"COLOR",JOINTS:"JOINTS",WEIGHTS:"WEIGHTS",FEATURE_ID:"_FEATURE_ID"};function w4e(e){switch(e){case Jn.POSITION:return"positionMC";case Jn.NORMAL:return"normalMC";case Jn.TANGENT:return"tangentMC";case Jn.TEXCOORD:return"texCoord";case Jn.COLOR:return"color";case Jn.JOINTS:return"joints";case Jn.WEIGHTS:return"weights";case Jn.FEATURE_ID:return"featureId"}}Jn.hasSetIndex=function(e){switch(e){case Jn.POSITION:case Jn.NORMAL:case Jn.TANGENT:return!1;case Jn.TEXCOORD:case Jn.COLOR:case Jn.JOINTS:case Jn.WEIGHTS:case Jn.FEATURE_ID:return!0}};Jn.fromGltfSemantic=function(e){let t=e,i=/^(\w+)_\d+$/.exec(e);switch(i!==null&&(t=i[1]),t){case"POSITION":return Jn.POSITION;case"NORMAL":return Jn.NORMAL;case"TANGENT":return Jn.TANGENT;case"TEXCOORD":return Jn.TEXCOORD;case"COLOR":return Jn.COLOR;case"JOINTS":return Jn.JOINTS;case"WEIGHTS":return Jn.WEIGHTS;case"_FEATURE_ID":return Jn.FEATURE_ID}};Jn.fromPntsSemantic=function(e){switch(e){case"POSITION":case"POSITION_QUANTIZED":return Jn.POSITION;case"RGBA":case"RGB":case"RGB565":return Jn.COLOR;case"NORMAL":case"NORMAL_OCT16P":return Jn.NORMAL;case"BATCH_ID":return Jn.FEATURE_ID}};Jn.getGlslType=function(e){switch(e){case Jn.POSITION:case Jn.NORMAL:case Jn.TANGENT:return"vec3";case Jn.TEXCOORD:return"vec2";case Jn.COLOR:return"vec4";case Jn.JOINTS:return"ivec4";case Jn.WEIGHTS:return"vec4";case Jn.FEATURE_ID:return"int"}};Jn.getVariableName=function(e,t){let n=w4e(e);return u(t)&&(n+=`_${t}`),n};var Tt=Object.freeze(Jn);function Ja(){}Ja.getError=function(e,t,n){let i=`Failed to load ${e}: ${t}`;u(n)&&u(n.message)&&(i+=`
${n.message}`);let o=new ce(i);return u(n)&&(o.stack=`Original stack:
${n.stack}
Handler stack:
${o.stack}`),o};Ja.getNodeTransform=function(e){return u(e.matrix)?e.matrix:F.fromTranslationQuaternionRotationScale(u(e.translation)?e.translation:h.ZERO,u(e.rotation)?e.rotation:Le.IDENTITY,u(e.scale)?e.scale:h.ONE)};Ja.getAttributeBySemantic=function(e,t,n){let i=e.attributes,o=i.length;for(let r=0;r<o;++r){let s=i[r],a=u(n)?s.setIndex===n:!0;if(s.semantic===t&&a)return s}};Ja.getAttributeByName=function(e,t){let n=e.attributes,i=n.length;for(let o=0;o<i;++o){let r=n[o];if(r.name===t)return r}};Ja.getFeatureIdsByLabel=function(e,t){for(let n=0;n<e.length;n++){let i=e[n];if(i.positionalLabel===t||i.label===t)return i}};Ja.hasQuantizedAttributes=function(e){if(!u(e))return!1;for(let t=0;t<e.length;t++){let n=e[t];if(u(n.quantization))return!0}return!1};Ja.getAttributeInfo=function(e){let t=e.semantic,n=e.setIndex,i,o=!1;u(t)?(i=Tt.getVariableName(t,n),o=!0):(i=e.name,i=i.replace(/^_/,""),i=i.toLowerCase());let r=/^color_\d+$/.test(i),s=e.type,a=rn.getGlslType(s);r&&(a="vec4");let c=u(e.quantization),l;return c&&(l=r?"vec4":rn.getGlslType(e.quantization.type)),{attribute:e,isQuantized:c,variableName:i,hasSemantic:o,glslType:a,quantizedGlslType:l}};var D4e=new h,I4e=new h;Ja.getPositionMinMax=function(e,t,n){let i=Ja.getAttributeBySemantic(e,"POSITION"),o=i.max,r=i.min;return u(n)&&u(t)&&(r=h.add(r,t,I4e),o=h.add(o,n,D4e)),{min:r,max:o}};Ja.getAxisCorrectionMatrix=function(e,t,n){return n=F.clone(F.IDENTITY,n),e===Vo.Y?n=F.clone(Vo.Y_UP_TO_Z_UP,n):e===Vo.X&&(n=F.clone(Vo.X_UP_TO_Z_UP,n)),t===Vo.Z&&(n=F.multiplyTransformation(n,Vo.Z_UP_TO_X_UP,n)),n};var P4e=new J;Ja.getCullFace=function(e,t){if(!Ne.isTriangles(t))return Ci.BACK;let n=F.getMatrix3(e,P4e);return J.determinant(n)<0?Ci.FRONT:Ci.BACK};Ja.sanitizeGlslIdentifier=function(e){let t=e.replaceAll(/[^A-Za-z0-9]+/g,"_");return t=t.replace(/^gl_/,""),/^\d/.test(t)&&(t=`_${t}`),t};Ja.supportedExtensions={AGI_articulations:!0,CESIUM_primitive_outline:!0,CESIUM_RTC:!0,EXT_feature_metadata:!0,EXT_instance_features:!0,EXT_mesh_features:!0,EXT_mesh_gpu_instancing:!0,EXT_meshopt_compression:!0,EXT_structural_metadata:!0,EXT_texture_webp:!0,KHR_blend:!0,KHR_draco_mesh_compression:!0,KHR_techniques_webgl:!0,KHR_materials_common:!0,KHR_materials_pbrSpecularGlossiness:!0,KHR_materials_specular:!0,KHR_materials_anisotropy:!0,KHR_materials_clearcoat:!0,KHR_materials_unlit:!0,KHR_mesh_quantization:!0,KHR_texture_basisu:!0,KHR_texture_transform:!0,WEB3D_quantized_attributes:!0};Ja.checkSupportedExtensions=function(e){let t=e.length;for(let n=0;n<t;n++){let i=e[n];if(!Ja.supportedExtensions[i])throw new ce(`Unsupported glTF Extension: ${i}`)}};var Zt=Ja;function pg(e){e=x(e,x.EMPTY_OBJECT);let t=e.resourceCache,n=e.gltfResource,i=e.baseResource,o=e.typedArray,r=e.gltfJson,s=e.cacheKey;this._resourceCache=t,this._gltfResource=n,this._baseResource=i,this._typedArray=o,this._gltfJson=r,this._cacheKey=s,this._gltf=void 0,this._bufferLoaders=[],this._state=_t.UNLOADED,this._promise=void 0}u(Object.create)&&(pg.prototype=Object.create(Qi.prototype),pg.prototype.constructor=pg);Object.defineProperties(pg.prototype,{cacheKey:{get:function(){return this._cacheKey}},gltf:{get:function(){return this._gltf}}});pg.prototype.load=async function(){return u(this._promise)?this._promise:(this._state=_t.LOADING,u(this._gltfJson)?(this._promise=aoe(this,this._gltfJson),this._promise):u(this._typedArray)?(this._promise=coe(this,this._typedArray),this._promise):(this._promise=R4e(this),this._promise))};async function R4e(e){let t;try{let n=await e._fetchGltf();if(e.isDestroyed())return;t=new Uint8Array(n)}catch(n){if(e.isDestroyed())return;mW(e,n)}return coe(e,t)}function mW(e,t){e.unload(),e._state=_t.FAILED;let n=`Failed to load glTF: ${e._gltfResource.url}`;throw e.getError(n,t)}async function O4e(e,t){if(u(t.asset)&&t.asset.version==="2.0"&&!xr(t,"KHR_techniques_webgl")&&!xr(t,"KHR_materials_common"))return Promise.resolve();let n=[];Pe.buffer(t,function(i){if(!u(i.extras._pipeline.source)&&u(i.uri)){let o=e._baseResource.getDerivedResource({url:i.uri}),s=e._resourceCache.getExternalBufferLoader({resource:o});e._bufferLoaders.push(s),n.push(s.load().then(function(){s.isDestroyed()||(i.extras._pipeline.source=s.typedArray)}))}}),await Promise.all(n),TN(t)}function M4e(e){let t=[];return Pe.buffer(e,function(n){let i=n.uri;!u(n.extras._pipeline.source)&&u(i)&&M_(i)&&(delete n.uri,t.push(De.fetchArrayBuffer(i).then(function(o){n.extras._pipeline.source=new Uint8Array(o)})))}),Promise.all(t)}function L4e(e,t){let n=[];return Pe.buffer(t,function(i,o){let r=i.extras._pipeline.source;if(u(r)&&!u(i.uri)){let a=e._resourceCache.getEmbeddedBufferLoader({parentResource:e._gltfResource,bufferId:o,typedArray:r});e._bufferLoaders.push(a),n.push(a.load())}}),Promise.all(n)}async function aoe(e,t){try{ox(t),await M4e(t),await O4e(e,t),cN(t),await L4e(e,t),hN(t);let n=t.asset.version;if(n!=="1.0"&&n!=="2.0")throw new ce(`Unsupported glTF version: ${n}`);let i=t.extensionsRequired;return u(i)&&Zt.checkSupportedExtensions(i),e._gltf=t,e._state=_t.READY,e}catch(n){if(e.isDestroyed())return;mW(e,n)}}async function coe(e,t){let n;try{zh(t)==="glTF"?n=fN(t):n=Uo(t)}catch(i){if(e.isDestroyed())return;mW(e,i)}return aoe(e,n)}pg.prototype.unload=function(){let e=this._bufferLoaders,t=e.length;for(let n=0;n<t;++n)e[n]=!e[n].isDestroyed()&&this._resourceCache.unload(e[n]);this._bufferLoaders.length=0,this._gltf=void 0};pg.prototype._fetchGltf=function(){return this._gltfResource.fetchArrayBuffer()};var Kv=pg;var N4e={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"},bp=Object.freeze(N4e);var So={};function F4e(){this.octEncoded=!1,this.octEncodedZXY=!1,this.normalizationRange=void 0,this.quantizedVolumeOffset=void 0,this.quantizedVolumeDimensions=void 0,this.quantizedVolumeStepSize=void 0,this.componentDatatype=void 0,this.type=void 0}function B4e(){this.name=void 0,this.semantic=void 0,this.setIndex=void 0,this.componentDatatype=void 0,this.type=void 0,this.normalized=!1,this.count=void 0,this.min=void 0,this.max=void 0,this.constant=void 0,this.quantization=void 0,this.typedArray=void 0,this.buffer=void 0,this.byteOffset=0,this.byteStride=void 0}function k4e(){this.indexDatatype=void 0,this.count=void 0,this.buffer=void 0,this.typedArray=void 0}function V4e(){this.featureCount=void 0,this.nullFeatureId=void 0,this.propertyTableId=void 0,this.setIndex=void 0,this.label=void 0,this.positionalLabel=void 0}function U4e(){this.featureCount=void 0,this.nullFeatureId=void 0,this.propertyTableId=void 0,this.offset=0,this.repeat=void 0,this.label=void 0,this.positionalLabel=void 0}function z4e(){this.featureCount=void 0,this.nullFeatureId=void 0,this.propertyTableId=void 0,this.textureReader=void 0,this.label=void 0,this.positionalLabel=void 0}function H4e(){this.attributes=[]}function G4e(){this.attributes=[],this.morphTargets=[],this.indices=void 0,this.material=void 0,this.primitiveType=void 0,this.featureIds=[],this.propertyTextureIds=[],this.propertyAttributeIds=[],this.outlineCoordinates=void 0}function W4e(){this.attributes=[],this.featureIds=[],this.transformInWorldSpace=!1}function j4e(){this.index=void 0,this.joints=[],this.inverseBindMatrices=[]}function q4e(){this.name=void 0,this.index=void 0,this.children=[],this.primitives=[],this.instances=void 0,this.skin=void 0,this.matrix=void 0,this.translation=void 0,this.rotation=void 0,this.scale=void 0,this.morphWeights=[],this.articulationName=void 0}function Y4e(){this.nodes=[]}var X4e={TRANSLATION:"translation",ROTATION:"rotation",SCALE:"scale",WEIGHTS:"weights"};function K4e(){this.input=[],this.interpolation=void 0,this.output=[]}function Z4e(){this.node=void 0,this.path=void 0}function $4e(){this.sampler=void 0,this.target=void 0}function Q4e(){this.name=void 0,this.samplers=[],this.channels=[]}function J4e(){this.name=void 0,this.type=void 0,this.minimumValue=void 0,this.maximumValue=void 0,this.initialValue=void 0}function eVe(){this.name=void 0,this.stages=[]}function loe(){this.credits=[]}function tVe(){this.asset=new loe,this.scene=void 0,this.nodes=[],this.skins=[],this.animations=[],this.articulations=[],this.structuralMetadata=void 0,this.upAxis=void 0,this.forwardAxis=void 0,this.transform=F.clone(F.IDENTITY),this.extensions={}}function nVe(){this.texture=void 0,this.index=void 0,this.texCoord=0,this.transform=J.clone(J.IDENTITY),this.scale=1,this.channels=void 0}function _g(){this.baseColorTexture=void 0,this.metallicRoughnessTexture=void 0,this.baseColorFactor=oe.clone(_g.DEFAULT_BASE_COLOR_FACTOR),this.metallicFactor=_g.DEFAULT_METALLIC_FACTOR,this.roughnessFactor=_g.DEFAULT_ROUGHNESS_FACTOR}_g.DEFAULT_BASE_COLOR_FACTOR=oe.ONE;_g.DEFAULT_METALLIC_FACTOR=1;_g.DEFAULT_ROUGHNESS_FACTOR=1;function rx(){this.diffuseTexture=void 0,this.specularGlossinessTexture=void 0,this.diffuseFactor=oe.clone(rx.DEFAULT_DIFFUSE_FACTOR),this.specularFactor=h.clone(rx.DEFAULT_SPECULAR_FACTOR),this.glossinessFactor=rx.DEFAULT_GLOSSINESS_FACTOR}rx.DEFAULT_DIFFUSE_FACTOR=oe.ONE;rx.DEFAULT_SPECULAR_FACTOR=h.ONE;rx.DEFAULT_GLOSSINESS_FACTOR=1;function Zv(){this.specularFactor=Zv.DEFAULT_SPECULAR_FACTOR,this.specularTexture=void 0,this.specularColorFactor=h.clone(Zv.DEFAULT_SPECULAR_COLOR_FACTOR),this.specularColorTexture=void 0}Zv.DEFAULT_SPECULAR_FACTOR=1;Zv.DEFAULT_SPECULAR_COLOR_FACTOR=h.ONE;function $v(){this.anisotropyStrength=$v.DEFAULT_ANISOTROPY_STRENGTH,this.anisotropyRotation=$v.DEFAULT_ANISOTROPY_ROTATION,this.anisotropyTexture=void 0}$v.DEFAULT_ANISOTROPY_STRENGTH=0;$v.DEFAULT_ANISOTROPY_ROTATION=0;function Qv(){this.clearcoatFactor=Qv.DEFAULT_CLEARCOAT_FACTOR,this.clearcoatTexture=void 0,this.clearcoatRoughnessFactor=Qv.DEFAULT_CLEARCOAT_ROUGHNESS_FACTOR,this.clearcoatRoughnessTexture=void 0,this.clearcoatNormalTexture=void 0}Qv.DEFAULT_CLEARCOAT_FACTOR=0;Qv.DEFAULT_CLEARCOAT_ROUGHNESS_FACTOR=0;function pW(){this.metallicRoughness=new _g,this.specularGlossiness=void 0,this.specular=void 0,this.anisotropy=void 0,this.clearcoat=void 0,this.emissiveTexture=void 0,this.normalTexture=void 0,this.occlusionTexture=void 0,this.emissiveFactor=h.clone(pW.DEFAULT_EMISSIVE_FACTOR),this.alphaMode=bp.OPAQUE,this.alphaCutoff=.5,this.doubleSided=!1,this.unlit=!1}pW.DEFAULT_EMISSIVE_FACTOR=h.ZERO;So.Quantization=F4e;So.Attribute=B4e;So.Indices=k4e;So.FeatureIdAttribute=V4e;So.FeatureIdTexture=z4e;So.FeatureIdImplicitRange=U4e;So.MorphTarget=H4e;So.Primitive=G4e;So.Instances=W4e;So.Skin=j4e;So.Node=q4e;So.Scene=Y4e;So.AnimatedPropertyType=Object.freeze(X4e);So.AnimationSampler=K4e;So.AnimationTarget=Z4e;So.AnimationChannel=$4e;So.Animation=Q4e;So.ArticulationStage=J4e;So.Articulation=eVe;So.Asset=loe;So.Components=tVe;So.TextureReader=nVe;So.MetallicRoughness=_g;So.SpecularGlossiness=rx;So.Specular=Zv;So.Anisotropy=$v;So.Clearcoat=Qv;So.Material=pW;var bn=So;var EN={};EN.getImageIdFromTexture=function(e){e=x(e,x.EMPTY_OBJECT);let{gltf:t,textureId:n,supportedImageFormats:i}=e,o=t.textures[n],r=o.extensions;if(u(r)){if(i.webp&&u(r.EXT_texture_webp))return r.EXT_texture_webp.source;if(i.basis&&u(r.KHR_texture_basisu))return r.KHR_texture_basisu.source}return o.source};EN.createSampler=function(e){e=x(e,x.EMPTY_OBJECT);let{gltf:t,textureInfo:n,compressedTextureNoMipmap:i=!1}=e,o=En.REPEAT,r=En.REPEAT,s=$t.LINEAR,a=mi.LINEAR,c=n.index,f=t.textures[c].sampler;if(u(f)){let d=t.samplers[f];o=x(d.wrapS,o),r=x(d.wrapT,r),s=x(d.minFilter,s),a=x(d.magFilter,a)}return i&&s!==$t.LINEAR&&s!==$t.NEAREST&&(s===$t.NEAREST_MIPMAP_NEAREST||s===$t.NEAREST_MIPMAP_LINEAR?s=$t.NEAREST:s=$t.LINEAR),new Qt({wrapS:o,wrapT:r,minificationFilter:s,magnificationFilter:a})};var iVe=new H(1,1);EN.createModelTextureReader=function(e){e=x(e,x.EMPTY_OBJECT);let{textureInfo:t,channels:n,texture:i}=e,o=x(t.texCoord,0),r,s=t.extensions?.KHR_texture_transform;if(u(s)){o=x(s.texCoord,o);let c=u(s.offset)?H.unpack(s.offset):H.ZERO,l=x(s.rotation,0),f=u(s.scale)?H.unpack(s.scale):iVe;l=-l,r=new J(Math.cos(l)*f.x,-Math.sin(l)*f.y,c.x,Math.sin(l)*f.x,Math.cos(l)*f.y,c.y,0,0,1)}let a=new bn.TextureReader;return a.index=t.index,a.texture=i,a.texCoord=o,a.scale=t.scale,a.transform=r,a.channels=n,a};var su=EN;function oVe(e){let t=document.createElement("canvas");return t.width=R.nextPowerOfTwo(e.width),t.height=R.nextPowerOfTwo(e.height),t.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height),t}var sx=oVe;function gg(e){e=x(e,x.EMPTY_OBJECT);let t=e.resourceCache,n=e.gltf,i=e.textureInfo,o=e.gltfResource,r=e.baseResource,s=e.supportedImageFormats,a=e.cacheKey,c=x(e.asynchronous,!0),l=i.index,f=su.getImageIdFromTexture({gltf:n,textureId:l,supportedImageFormats:s});this._resourceCache=t,this._gltf=n,this._textureInfo=i,this._imageId=f,this._gltfResource=o,this._baseResource=r,this._cacheKey=a,this._asynchronous=c,this._imageLoader=void 0,this._image=void 0,this._mipLevels=void 0,this._texture=void 0,this._state=_t.UNLOADED,this._promise=void 0}u(Object.create)&&(gg.prototype=Object.create(Qi.prototype),gg.prototype.constructor=gg);Object.defineProperties(gg.prototype,{cacheKey:{get:function(){return this._cacheKey}},texture:{get:function(){return this._texture}}});var rVe=new _W;async function sVe(e){let t=e._resourceCache;try{let n=t.getImageLoader({gltf:e._gltf,imageId:e._imageId,gltfResource:e._gltfResource,baseResource:e._baseResource});return e._imageLoader=n,await n.load(),e.isDestroyed()?void 0:(e._image=n.image,e._mipLevels=n.mipLevels,e._state=_t.LOADED,e)}catch(n){if(e.isDestroyed())return;throw e.unload(),e._state=_t.FAILED,e.getError("Failed to load texture",n)}}gg.prototype.load=async function(){return u(this._promise)?this._promise:(this._state=_t.LOADING,this._promise=sVe(this),this._promise)};function _W(){this.gltf=void 0,this.textureInfo=void 0,this.image=void 0,this.context=void 0,this.texture=void 0}_W.prototype.set=function(e,t,n,i,o){this.gltf=e,this.textureInfo=t,this.image=n,this.mipLevels=i,this.context=o};_W.prototype.execute=function(){this.texture=uoe(this.gltf,this.textureInfo,this.image,this.mipLevels,this.context)};function uoe(e,t,n,i,o){let r=n.internalFormat,s=!1;tt.isCompressedFormat(r)&&!u(i)&&(s=!0);let a=su.createSampler({gltf:e,textureInfo:t,compressedTextureNoMipmap:s}),c=a.minificationFilter,l=a.wrapS,f=a.wrapT,d=c===$t.NEAREST_MIPMAP_NEAREST||c===$t.NEAREST_MIPMAP_LINEAR||c===$t.LINEAR_MIPMAP_NEAREST||c===$t.LINEAR_MIPMAP_LINEAR,p=!u(r)&&d,g=p||l===En.REPEAT||l===En.MIRRORED_REPEAT||f===En.REPEAT||f===En.MIRRORED_REPEAT,m=!R.isPowerOfTwo(n.width)||!R.isPowerOfTwo(n.height),y=g&&m,b;return u(r)?(!o.webgl2&&tt.isCompressedFormat(r)&&m&&g&&console.warn("Compressed texture uses REPEAT or MIRRORED_REPEAT texture wrap mode and dimensions are not powers of two. The texture may be rendered incorrectly."),b=Ot.create({context:o,source:{arrayBufferView:n.bufferView,mipLevels:i},width:n.width,height:n.height,pixelFormat:n.internalFormat,sampler:a})):(y&&(n=sx(n)),b=Ot.create({context:o,source:n,sampler:a,flipY:!1,skipColorSpaceConversion:!0})),p&&b.generateMipmap(),b}gg.prototype.process=function(e){if(this._state===_t.READY)return!0;if(this._state!==_t.LOADED&&this._state!==_t.PROCESSING||u(this._texture)||!u(this._image))return!1;this._state=_t.PROCESSING;let t;if(this._asynchronous){let n=rVe;if(n.set(this._gltf,this._textureInfo,this._image,this._mipLevels,e.context),!e.jobScheduler.execute(n,Qa.TEXTURE))return;t=n.texture}else t=uoe(this._gltf,this._textureInfo,this._image,this._mipLevels,e.context);return this.unload(),this._texture=t,this._state=_t.READY,this._resourceCache.statistics.addTextureLoader(this),!0};gg.prototype.unload=function(){u(this._texture)&&this._texture.destroy(),u(this._imageLoader)&&!this._imageLoader.isDestroyed()&&this._resourceCache.unload(this._imageLoader),this._imageLoader=void 0,this._image=void 0,this._mipLevels=void 0,this._texture=void 0,this._gltf=void 0};var Jv=gg;function yg(e){e=x(e,x.EMPTY_OBJECT);let t=e.resourceCache,n=e.gltf,i=e.gltfResource,o=e.baseResource,r=e.bufferViewId,s=e.draco,a=e.attributeSemantic,c=e.accessorId,l=e.cacheKey,f=x(e.asynchronous,!0),d=x(e.loadBuffer,!1),p=x(e.loadTypedArray,!1);this._resourceCache=t,this._gltfResource=i,this._baseResource=o,this._gltf=n,this._bufferViewId=r,this._draco=s,this._attributeSemantic=a,this._accessorId=c,this._cacheKey=l,this._asynchronous=f,this._loadBuffer=d,this._loadTypedArray=p,this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._quantization=void 0,this._typedArray=void 0,this._buffer=void 0,this._state=_t.UNLOADED,this._promise=void 0}u(Object.create)&&(yg.prototype=Object.create(Qi.prototype),yg.prototype.constructor=yg);Object.defineProperties(yg.prototype,{cacheKey:{get:function(){return this._cacheKey}},buffer:{get:function(){return this._buffer}},typedArray:{get:function(){return this._typedArray}},quantization:{get:function(){return this._quantization}}});function aVe(e,t){return u(e)&&u(e.attributes)&&u(e.attributes[t])}yg.prototype.load=async function(){return u(this._promise)?this._promise:aVe(this._draco,this._attributeSemantic)?(this._promise=lVe(this),this._promise):(this._promise=fVe(this),this._promise)};function cVe(e,t,n,i){let r=(1<<e.quantizationBits)-1,s=1/r,a=new bn.Quantization;if(a.componentDatatype=t,a.octEncoded=e.octEncoded,a.octEncodedZXY=!0,a.type=i,a.octEncoded)a.type=rn.VEC2,a.normalizationRange=r;else{let c=rn.getMathType(i);if(c===Number){let l=e.range;a.quantizedVolumeOffset=e.minValues[0],a.quantizedVolumeDimensions=l,a.normalizationRange=r,a.quantizedVolumeStepSize=l*s}else{a.quantizedVolumeOffset=c.unpack(e.minValues),a.normalizationRange=c.unpack(new Array(n).fill(r));let l=new Array(n).fill(e.range);a.quantizedVolumeDimensions=c.unpack(l);let f=l.map(function(d){return d*s});a.quantizedVolumeStepSize=c.unpack(f)}}return a}async function lVe(e){e._state=_t.LOADING;let t=e._resourceCache;try{let n=t.getDracoLoader({gltf:e._gltf,draco:e._draco,gltfResource:e._gltfResource,baseResource:e._baseResource});return e._dracoLoader=n,await n.load(),e.isDestroyed()?void 0:(e._state=_t.LOADED,e)}catch{if(e.isDestroyed())return;gW(e)}}function uVe(e){e._state=_t.PROCESSING;let n=e._dracoLoader.decodedData.vertexAttributes,i=e._attributeSemantic,o=n[i],r=e._accessorId,a=e._gltf.accessors[r].type,c=o.array,l=o.data.quantization;u(l)&&(e._quantization=cVe(l,o.data.componentDatatype,o.data.componentsPerAttribute,a)),e._typedArray=new Uint8Array(c.buffer,c.byteOffset,c.byteLength)}async function fVe(e){e._state=_t.LOADING;let t=e._resourceCache;try{let n=t.getBufferViewLoader({gltf:e._gltf,bufferViewId:e._bufferViewId,gltfResource:e._gltfResource,baseResource:e._baseResource});return e._bufferViewLoader=n,await n.load(),e.isDestroyed()?void 0:(e._typedArray=n.typedArray,e._state=_t.PROCESSING,e)}catch(n){if(e.isDestroyed())return;gW(e,n)}}function gW(e,t){throw e.unload(),e._state=_t.FAILED,e.getError("Failed to load vertex buffer",t)}function yW(){this.typedArray=void 0,this.context=void 0,this.buffer=void 0}yW.prototype.set=function(e,t){this.typedArray=e,this.context=t};yW.prototype.execute=function(){this.buffer=foe(this.typedArray,this.context)};function foe(e,t){let n=xt.createVertexBuffer({typedArray:e,context:t,usage:ke.STATIC_DRAW});return n.vertexArrayDestroyable=!1,n}var dVe=new yW;yg.prototype.process=function(e){if(this._state===_t.READY)return!0;if(this._state!==_t.LOADED&&this._state!==_t.PROCESSING)return!1;if(u(this._dracoLoader)){try{if(!this._dracoLoader.process(e))return!1}catch(i){gW(this,i)}uVe(this)}let t,n=this._typedArray;if(this._loadBuffer&&this._asynchronous){let i=dVe;if(i.set(n,e.context),!e.jobScheduler.execute(i,Qa.BUFFER))return!1;t=i.buffer}else this._loadBuffer&&(t=foe(n,e.context));return this.unload(),this._buffer=t,this._typedArray=this._loadTypedArray?n:void 0,this._state=_t.READY,this._resourceCache.statistics.addGeometryLoader(this),!0};yg.prototype.unload=function(){u(this._buffer)&&this._buffer.destroy();let e=this._resourceCache;u(this._bufferViewLoader)&&!this._bufferViewLoader.isDestroyed()&&e.unload(this._bufferViewLoader),u(this._dracoLoader)&&e.unload(this._dracoLoader),this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._typedArray=void 0,this._buffer=void 0,this._gltf=void 0};var ew=yg;function tw(e){e=x(e,x.EMPTY_OBJECT);let t=e.id,n=x(e.properties,{}),i={};for(let o in n)if(n.hasOwnProperty(o)){let r=n[o];u(r.semantic)&&(i[r.semantic]=r)}this._id=t,this._name=e.name,this._description=e.description,this._properties=n,this._propertiesBySemantic=i,this._extras=Ge(e.extras,!0),this._extensions=Ge(e.extensions,!0)}tw.fromJson=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.id,n=e.class,i={};for(let o in n.properties)if(n.properties.hasOwnProperty(o)){let r=tx.fromJson({id:o,property:n.properties[o],enums:e.enums});i[o]=r}return new tw({id:t,name:n.name,description:n.description,properties:i,extras:n.extras,extensions:n.extensions})};Object.defineProperties(tw.prototype,{properties:{get:function(){return this._properties}},propertiesBySemantic:{get:function(){return this._propertiesBySemantic}},id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});tw.BATCH_TABLE_CLASS_NAME="_batchTable";var jh=tw;function SN(e){e=x(e,x.EMPTY_OBJECT);let t=e.value,n=e.name;this._value=t,this._name=n,this._description=e.description,this._extras=Ge(e.extras,!0),this._extensions=Ge(e.extensions,!0)}SN.fromJson=function(e){return new SN({value:e.value,name:e.name,description:e.description,extras:e.extras,extensions:e.extensions})};Object.defineProperties(SN.prototype,{value:{get:function(){return this._value}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});var vN=SN;function wN(e){e=x(e,x.EMPTY_OBJECT);let t=e.id,n=e.values,i={},o={},r=n.length;for(let a=0;a<r;++a){let c=n[a];i[c.value]=c.name,o[c.name]=c.value}let s=x(e.valueType,Gt.UINT16);this._values=n,this._namesByValue=i,this._valuesByName=o,this._valueType=s,this._id=t,this._name=e.name,this._description=e.description,this._extras=Ge(e.extras,!0),this._extensions=Ge(e.extensions,!0)}wN.fromJson=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.id,n=e.enum,i=n.values.map(function(o){return vN.fromJson(o)});return new wN({id:t,values:i,valueType:Gt[n.valueType],name:n.name,description:n.description,extras:n.extras,extensions:n.extensions})};Object.defineProperties(wN.prototype,{values:{get:function(){return this._values}},namesByValue:{get:function(){return this._namesByValue}},valuesByName:{get:function(){return this._valuesByName}},valueType:{get:function(){return this._valueType}},id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});var DN=wN;function IN(e){e=x(e,x.EMPTY_OBJECT);let t=x(e.classes,{}),n=x(e.enums,{});this._classes=t,this._enums=n,this._id=e.id,this._name=e.name,this._description=e.description,this._version=e.version,this._extras=Ge(e.extras,!0),this._extensions=Ge(e.extensions,!0)}IN.fromJson=function(e){let t={};if(u(e.enums))for(let i in e.enums)e.enums.hasOwnProperty(i)&&(t[i]=DN.fromJson({id:i,enum:e.enums[i]}));let n={};if(u(e.classes))for(let i in e.classes)e.classes.hasOwnProperty(i)&&(n[i]=jh.fromJson({id:i,class:e.classes[i],enums:t}));return new IN({id:e.id,name:e.name,description:e.description,version:e.version,classes:n,enums:t,extras:e.extras,extensions:e.extensions})};Object.defineProperties(IN.prototype,{classes:{get:function(){return this._classes}},enums:{get:function(){return this._enums}},id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},version:{get:function(){return this._version}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});var hf=IN;function ax(e){e=x(e,x.EMPTY_OBJECT);let t=e.schema,n=e.resource,i=e.cacheKey;this._schema=u(t)?hf.fromJson(t):void 0,this._resource=n,this._cacheKey=i,this._state=_t.UNLOADED,this._promise=void 0}u(Object.create)&&(ax.prototype=Object.create(Qi.prototype),ax.prototype.constructor=ax);Object.defineProperties(ax.prototype,{cacheKey:{get:function(){return this._cacheKey}},schema:{get:function(){return this._schema}}});ax.prototype.load=async function(){return u(this._promise)?this._promise:u(this._schema)?(this._promise=Promise.resolve(this),this._promise):(this._promise=hVe(this),this._promise)};async function hVe(e){let t=e._resource;e._state=_t.LOADING;try{let n=await t.fetchJson();return e.isDestroyed()?void 0:(e._schema=hf.fromJson(n),e._state=_t.READY,e)}catch(n){if(e.isDestroyed())return;e._state=_t.FAILED;let i=`Failed to load schema: ${t.url}`;throw e.getError(i,n)}}ax.prototype.unload=function(){this._schema=void 0};var nw=ax;var xd={};function dA(e){return Km(e.url)}function PN(e){let{byteOffset:t,byteLength:n}=e;if(si(e,"EXT_meshopt_compression")){let i=e.extensions.EXT_meshopt_compression;t=x(i.byteOffset,0),n=i.byteLength}return`${t}-${t+n}`}function mVe(e,t){let n=t.byteOffset+e.byteOffset,{componentType:i,type:o,count:r}=e;return`${n}-${i}-${o}-${r}`}function doe(e,t){return`${dA(e)}-buffer-id-${t}`}function iw(e,t,n,i){if(u(e.uri)){let o=i.getDerivedResource({url:e.uri});return dA(o)}return doe(n,t)}function xW(e,t,n,i){let o=t.bufferView,r=e.bufferViews[o],s=r.buffer,a=e.buffers[s],c=iw(a,s,n,i),l=PN(r);return`${c}-range-${l}`}function hoe(e,t,n,i){let o=e.images[t],r=o.bufferView,s=o.uri;if(u(s)){let p=i.getDerivedResource({url:s});return dA(p)}let a=e.bufferViews[r],c=a.buffer,l=e.buffers[c],f=iw(l,c,n,i),d=PN(a);return`${f}-range-${d}`}function pVe(e,t){let n=su.createSampler({gltf:e,textureInfo:t});return`${n.wrapS}-${n.wrapT}-${n.minificationFilter}-${n.magnificationFilter}`}xd.getSchemaCacheKey=function(e){let{schema:t,resource:n}=e;return u(t)?`embedded-schema:${JSON.stringify(t)}`:`external-schema:${dA(n)}`};xd.getExternalBufferCacheKey=function(e){e=x(e,x.EMPTY_OBJECT);let{resource:t}=e;return`external-buffer:${dA(t)}`};xd.getEmbeddedBufferCacheKey=function(e){e=x(e,x.EMPTY_OBJECT);let{parentResource:t,bufferId:n}=e;return`embedded-buffer:${doe(t,n)}`};xd.getGltfCacheKey=function(e){e=x(e,x.EMPTY_OBJECT);let{gltfResource:t}=e;return`gltf:${dA(t)}`};xd.getBufferViewCacheKey=function(e){e=x(e,x.EMPTY_OBJECT);let{gltf:t,bufferViewId:n,gltfResource:i,baseResource:o}=e,r=t.bufferViews[n],s=r.buffer,a=t.buffers[s];si(r,"EXT_meshopt_compression")&&(s=r.extensions.EXT_meshopt_compression.buffer);let c=iw(a,s,i,o),l=PN(r);return`buffer-view:${c}-range-${l}`};xd.getDracoCacheKey=function(e){e=x(e,x.EMPTY_OBJECT);let{gltf:t,draco:n,gltfResource:i,baseResource:o}=e;return`draco:${xW(t,n,i,o)}`};xd.getVertexBufferCacheKey=function(e){e=x(e,x.EMPTY_OBJECT);let{gltf:t,gltfResource:n,baseResource:i,frameState:o,bufferViewId:r,draco:s,attributeSemantic:a,dequantize:c=!1,loadBuffer:l=!1,loadTypedArray:f=!1}=e,d="";if(c&&(d+="-dequantize"),l&&(d+="-buffer",d+=`-context-${o.context.id}`),f&&(d+="-typed-array"),u(s))return`vertex-buffer:${xW(t,s,n,i)}-draco-${a}${d}`;let p=t.bufferViews[r],g=p.buffer,m=t.buffers[g],y=iw(m,g,n,i),b=PN(p);return`vertex-buffer:${y}-range-${b}${d}`};xd.getIndexBufferCacheKey=function(e){e=x(e,x.EMPTY_OBJECT);let{gltf:t,accessorId:n,gltfResource:i,baseResource:o,frameState:r,draco:s,loadBuffer:a=!1,loadTypedArray:c=!1}=e,l="";if(a&&(l+="-buffer",l+=`-context-${r.context.id}`),c&&(l+="-typed-array"),u(s))return`index-buffer:${xW(t,s,i,o)}-draco${l}`;let f=t.accessors[n],d=f.bufferView,p=t.bufferViews[d],g=p.buffer,m=t.buffers[g],y=iw(m,g,i,o),b=mVe(f,p);return`index-buffer:${y}-accessor-${b}${l}`};xd.getImageCacheKey=function(e){e=x(e,x.EMPTY_OBJECT);let{gltf:t,imageId:n,gltfResource:i,baseResource:o}=e;return`image:${hoe(t,n,i,o)}`};xd.getTextureCacheKey=function(e){e=x(e,x.EMPTY_OBJECT);let{gltf:t,textureInfo:n,gltfResource:i,baseResource:o,supportedImageFormats:r,frameState:s}=e,a=n.index,c=su.getImageIdFromTexture({gltf:t,textureId:a,supportedImageFormats:r}),l=hoe(t,c,i,o),f=pVe(t,n);return`texture:${l}-sampler-${f}-context-${s.context.id}`};var au=xd;function ow(){this.geometryByteLength=0,this.texturesByteLength=0,this._geometrySizes={},this._textureSizes={}}ow.prototype.clear=function(){this.geometryByteLength=0,this.texturesByteLength=0,this._geometrySizes={},this._textureSizes={}};ow.prototype.addGeometryLoader=function(e){let t=e.cacheKey;if(this._geometrySizes.hasOwnProperty(t))return;this._geometrySizes[t]=0;let n=e.buffer,i=e.typedArray,o=0;u(n)&&(o+=n.sizeInBytes),u(i)&&(o+=i.byteLength),this.geometryByteLength+=o,this._geometrySizes[t]=o};ow.prototype.addTextureLoader=function(e){let t=e.cacheKey;if(this._textureSizes.hasOwnProperty(t))return;this._textureSizes[t]=0;let n=e.texture.sizeInBytes;this.texturesByteLength+=e.texture.sizeInBytes,this._textureSizes[t]=n};ow.prototype.removeLoader=function(e){let t=e.cacheKey,n=this._geometrySizes[t];delete this._geometrySizes[t],u(n)&&(this.geometryByteLength-=n);let i=this._textureSizes[t];delete this._textureSizes[t],u(i)&&(this.texturesByteLength-=i)};var RN=ow;function Mn(){}Mn.cacheEntries={};Mn.statistics=new RN;function _Ve(e){this.referenceCount=1,this.resourceLoader=e,this._statisticsPromise=void 0}Mn.get=function(e){let t=Mn.cacheEntries[e];if(u(t))return++t.referenceCount,t.resourceLoader};Mn.add=function(e){let t=e.cacheKey;return Mn.cacheEntries[t]=new _Ve(e),e};Mn.unload=function(e){let t=e.cacheKey,n=Mn.cacheEntries[t];--n.referenceCount,n.referenceCount===0&&(Mn.statistics.removeLoader(e),e.destroy(),delete Mn.cacheEntries[t])};Mn.getSchemaLoader=function(e){e=x(e,x.EMPTY_OBJECT);let{schema:t,resource:n}=e,i=au.getSchemaCacheKey({schema:t,resource:n}),o=Mn.get(i);return u(o)?o:(o=new nw({schema:t,resource:n,cacheKey:i}),Mn.add(o))};Mn.getEmbeddedBufferLoader=function(e){e=x(e,x.EMPTY_OBJECT);let{parentResource:t,bufferId:n,typedArray:i}=e,o=au.getEmbeddedBufferCacheKey({parentResource:t,bufferId:n}),r=Mn.get(o);return u(r)?r:(r=new aA({typedArray:i,cacheKey:o}),Mn.add(r))};Mn.getExternalBufferLoader=function(e){e=x(e,x.EMPTY_OBJECT);let{resource:t}=e,n=au.getExternalBufferCacheKey({resource:t}),i=Mn.get(n);return u(i)?i:(i=new aA({resource:t,cacheKey:n}),Mn.add(i))};Mn.getGltfJsonLoader=function(e){e=x(e,x.EMPTY_OBJECT);let{gltfResource:t,baseResource:n,typedArray:i,gltfJson:o}=e,r=au.getGltfCacheKey({gltfResource:t}),s=Mn.get(r);return u(s)?s:(s=new Kv({resourceCache:Mn,gltfResource:t,baseResource:n,typedArray:i,gltfJson:o,cacheKey:r}),Mn.add(s))};Mn.getBufferViewLoader=function(e){e=x(e,x.EMPTY_OBJECT);let{gltf:t,bufferViewId:n,gltfResource:i,baseResource:o}=e,r=au.getBufferViewCacheKey({gltf:t,bufferViewId:n,gltfResource:i,baseResource:o}),s=Mn.get(r);return u(s)?s:(s=new Wv({resourceCache:Mn,gltf:t,bufferViewId:n,gltfResource:i,baseResource:o,cacheKey:r}),Mn.add(s))};Mn.getDracoLoader=function(e){e=x(e,x.EMPTY_OBJECT);let{gltf:t,draco:n,gltfResource:i,baseResource:o}=e,r=au.getDracoCacheKey({gltf:t,draco:n,gltfResource:i,baseResource:o}),s=Mn.get(r);return u(s)?s:(s=new jv({resourceCache:Mn,gltf:t,draco:n,gltfResource:i,baseResource:o,cacheKey:r}),Mn.add(s))};Mn.getVertexBufferLoader=function(e){e=x(e,x.EMPTY_OBJECT);let{gltf:t,gltfResource:n,baseResource:i,frameState:o,bufferViewId:r,draco:s,attributeSemantic:a,accessorId:c,asynchronous:l=!0,dequantize:f=!1,loadBuffer:d=!1,loadTypedArray:p=!1}=e,g=au.getVertexBufferCacheKey({gltf:t,gltfResource:n,baseResource:i,frameState:o,bufferViewId:r,draco:s,attributeSemantic:a,dequantize:f,loadBuffer:d,loadTypedArray:p}),m=Mn.get(g);return u(m)?m:(m=new ew({resourceCache:Mn,gltf:t,gltfResource:n,baseResource:i,bufferViewId:r,draco:s,attributeSemantic:a,accessorId:c,cacheKey:g,asynchronous:l,dequantize:f,loadBuffer:d,loadTypedArray:p}),Mn.add(m))};Mn.getIndexBufferLoader=function(e){e=x(e,x.EMPTY_OBJECT);let{gltf:t,accessorId:n,gltfResource:i,baseResource:o,frameState:r,draco:s,asynchronous:a=!0,loadBuffer:c=!1,loadTypedArray:l=!1}=e,f=au.getIndexBufferCacheKey({gltf:t,accessorId:n,gltfResource:i,baseResource:o,frameState:r,draco:s,loadBuffer:c,loadTypedArray:l}),d=Mn.get(f);return u(d)?d:(d=new Yv({resourceCache:Mn,gltf:t,accessorId:n,gltfResource:i,baseResource:o,draco:s,cacheKey:f,asynchronous:a,loadBuffer:c,loadTypedArray:l}),Mn.add(d))};Mn.getImageLoader=function(e){e=x(e,x.EMPTY_OBJECT);let{gltf:t,imageId:n,gltfResource:i,baseResource:o}=e,r=au.getImageCacheKey({gltf:t,imageId:n,gltfResource:i,baseResource:o}),s=Mn.get(r);return u(s)?s:(s=new qv({resourceCache:Mn,gltf:t,imageId:n,gltfResource:i,baseResource:o,cacheKey:r}),Mn.add(s))};Mn.getTextureLoader=function(e){e=x(e,x.EMPTY_OBJECT);let{gltf:t,textureInfo:n,gltfResource:i,baseResource:o,supportedImageFormats:r,frameState:s,asynchronous:a=!0}=e,c=au.getTextureCacheKey({gltf:t,textureInfo:n,gltfResource:i,baseResource:o,supportedImageFormats:r,frameState:s}),l=Mn.get(c);return u(l)?l:(l=new Jv({resourceCache:Mn,gltf:t,textureInfo:n,gltfResource:i,baseResource:o,supportedImageFormats:r,cacheKey:c,asynchronous:a}),Mn.add(l))};Mn.clearForSpecs=function(){let e=[ew,Yv,jv,Jv,qv,Wv,aA,nw,Kv],t,n=Mn.cacheEntries,i=[];for(t in n)n.hasOwnProperty(t)&&i.push(n[t]);i.sort(function(r,s){let a=e.indexOf(r.resourceLoader.constructor),c=e.indexOf(s.resourceLoader.constructor);return a-c});let o=i.length;for(let r=0;r<o;++r){let s=i[r];t=s.resourceLoader.cacheKey,u(n[t])&&(s.resourceLoader.destroy(),delete n[t])}Mn.statistics.clear()};var wi=Mn;function ia(e,t,n){this._resource=e,this._subtreeJson=void 0,this._bufferLoader=void 0,this._tileAvailability=void 0,this._contentAvailabilityBitstreams=[],this._childSubtreeAvailability=void 0,this._implicitCoordinates=n,this._subtreeLevels=t.subtreeLevels,this._subdivisionScheme=t.subdivisionScheme,this._branchingFactor=t.branchingFactor,this._metadata=void 0,this._tileMetadataTable=void 0,this._tilePropertyTableJson=void 0,this._contentMetadataTables=[],this._contentPropertyTableJsons=[],this._tileJumpBuffer=void 0,this._contentJumpBuffers=[],this._ready=!1}Object.defineProperties(ia.prototype,{ready:{get:function(){return this._ready}},metadata:{get:function(){return this._metadata}},tileMetadataTable:{get:function(){return this._tileMetadataTable}},tilePropertyTableJson:{get:function(){return this._tilePropertyTableJson}},contentMetadataTables:{get:function(){return this._contentMetadataTables}},contentPropertyTableJsons:{get:function(){return this._contentPropertyTableJsons}},implicitCoordinates:{get:function(){return this._implicitCoordinates}}});ia.prototype.tileIsAvailableAtIndex=function(e){return this._tileAvailability.getBit(e)};ia.prototype.tileIsAvailableAtCoordinates=function(e){let t=this.getTileIndex(e);return this.tileIsAvailableAtIndex(t)};ia.prototype.contentIsAvailableAtIndex=function(e,t){return t=x(t,0),this._contentAvailabilityBitstreams[t].getBit(e)};ia.prototype.contentIsAvailableAtCoordinates=function(e,t){let n=this.getTileIndex(e);return this.contentIsAvailableAtIndex(n,t)};ia.prototype.childSubtreeIsAvailableAtIndex=function(e){return this._childSubtreeAvailability.getBit(e)};ia.prototype.childSubtreeIsAvailableAtCoordinates=function(e){let t=this.getChildSubtreeIndex(e);return this.childSubtreeIsAvailableAtIndex(t)};ia.prototype.getLevelOffset=function(e){let t=this._branchingFactor;return(Math.pow(t,e)-1)/(t-1)};ia.prototype.getParentMortonIndex=function(e){let t=2;return this._subdivisionScheme===ss.OCTREE&&(t=3),e>>t};ia.fromSubtreeJson=async function(e,t,n,i,o){let r=new ia(e,i,o),s;u(t)?s={json:t,binary:void 0}:s=gVe(n);let a=s.json;r._subtreeJson=a;let c;if(si(a,"3DTILES_metadata"))c=a.extensions["3DTILES_metadata"];else if(u(a.tileMetadata)){let A=a.tileMetadata;c=a.propertyTables[A]}let l=[];if(u(a.contentMetadata)){let A=a.contentMetadata.length;for(let T=0;T<A;T++){let E=a.contentMetadata[T];l.push(a.propertyTables[E])}}let f,d=i.metadataSchema,p=a.subtreeMetadata;if(u(p)){let A=p.class,T=d.classes[A];f=new rN({subtreeMetadata:p,class:T})}r._metadata=f,r._tilePropertyTableJson=c,r._contentPropertyTableJsons=l;let g={constant:0};a.contentAvailabilityHeaders=[],si(a,"3DTILES_multiple_contents")?a.contentAvailabilityHeaders=a.extensions["3DTILES_multiple_contents"].contentAvailability:Array.isArray(a.contentAvailability)?a.contentAvailabilityHeaders=a.contentAvailability:a.contentAvailabilityHeaders.push(x(a.contentAvailability,g));let m=yVe(a.buffers),y=xVe(a.bufferViews,m);bVe(a,y),u(c)&&moe(c,y);for(let A=0;A<l.length;A++){let T=l[A];moe(T,y)}let b=await CVe(r,m,s.binary),C=TVe(y,b);return EVe(r,a,i,C),u(c)&&(SVe(r,i,C),wVe(r)),vVe(r,i,C),DVe(r),r._ready=!0,r};function gVe(e){let n=new DataView(e.buffer,e.byteOffset),i=8,o=n.getUint32(i,!0);i+=8;let r=n.getUint32(i,!0);i+=8;let s=Uo(e,i,o);i+=o;let a=e.subarray(i,i+r);return{json:s,binary:a}}function yVe(e){e=u(e)?e:[];for(let t=0;t<e.length;t++){let n=e[t];n.isExternal=u(n.uri),n.isActive=!1}return e}function xVe(e,t){e=u(e)?e:[];for(let n=0;n<e.length;n++){let i=e[n],o=t[i.buffer];i.bufferHeader=o,i.isActive=!1}return e}function bVe(e,t){let n,i=e.tileAvailability;u(i.bitstream)?n=t[i.bitstream]:u(i.bufferView)&&(n=t[i.bufferView]),u(n)&&(n.isActive=!0,n.bufferHeader.isActive=!0);let o=e.contentAvailabilityHeaders;for(let s=0;s<o.length;s++)n=void 0,u(o[s].bitstream)?n=t[o[s].bitstream]:u(o[s].bufferView)&&(n=t[o[s].bufferView]),u(n)&&(n.isActive=!0,n.bufferHeader.isActive=!0);n=void 0;let r=e.childSubtreeAvailability;u(r.bitstream)?n=t[r.bitstream]:u(r.bufferView)&&(n=t[r.bufferView]),u(n)&&(n.isActive=!0,n.bufferHeader.isActive=!0)}function moe(e,t){let n=e.properties,i;for(let o in n)if(n.hasOwnProperty(o)){let r=n[o],s=x(r.values,r.bufferView);i=t[s],i.isActive=!0,i.bufferHeader.isActive=!0;let a=x(r.stringOffsets,r.stringOffsetBufferView);u(a)&&(i=t[a],i.isActive=!0,i.bufferHeader.isActive=!0);let c=x(r.arrayOffsets,r.arrayOffsetBufferView);u(c)&&(i=t[c],i.isActive=!0,i.bufferHeader.isActive=!0)}}function CVe(e,t,n){let i=[];for(let o=0;o<t.length;o++){let r=t[o];if(!r.isActive)i.push(Promise.resolve(void 0));else if(r.isExternal){let s=AVe(e,r);i.push(s)}else i.push(Promise.resolve(n))}return Promise.all(i).then(function(o){let r={};for(let s=0;s<o.length;s++){let a=o[s];u(a)&&(r[s]=a)}return r})}async function AVe(e,t){let i=e._resource.getDerivedResource({url:t.uri}),o=wi.getExternalBufferLoader({resource:i});e._bufferLoader=o;try{await o.load()}catch(r){if(o.isDestroyed())return;throw r}return o.typedArray}function TVe(e,t){let n={};for(let i=0;i<e.length;i++){let o=e[i];if(!o.isActive)continue;let r=o.byteOffset,s=r+o.byteLength,c=t[o.buffer].subarray(r,s);n[i]=c}return n}function EVe(e,t,n,i){let o=n.branchingFactor,r=n.subtreeLevels,s=(Math.pow(o,r)-1)/(o-1),a=Math.pow(o,r),c=si(t,"3DTILES_metadata"),l=u(e._tilePropertyTableJson),f=c||l;e._tileAvailability=bW(t.tileAvailability,i,s,f);let d=e._contentPropertyTableJsons.length>0;f=f||d;for(let p=0;p<t.contentAvailabilityHeaders.length;p++){let g=bW(t.contentAvailabilityHeaders[p],i,s,f);e._contentAvailabilityBitstreams.push(g)}e._childSubtreeAvailability=bW(t.childSubtreeAvailability,i,a)}function bW(e,t,n,i){if(u(e.constant))return new zv({constant:!!e.constant,lengthBits:n,availableCount:e.availableCount});let o;return u(e.bitstream)?o=t[e.bitstream]:u(e.bufferView)&&(o=t[e.bufferView]),new zv({bitstream:o,lengthBits:n,availableCount:e.availableCount,computeAvailableCountEnabled:i})}function SVe(e,t,n){let i=e._tilePropertyTableJson,o=e._tileAvailability.availableCount,r=t.metadataSchema,s=i.class,a=r.classes[s];e._tileMetadataTable=new ou({class:a,count:o,properties:i.properties,bufferViews:n})}function vVe(e,t,n){let i=e._contentPropertyTableJsons,o=e._contentAvailabilityBitstreams,r=t.metadataSchema,s=e._contentMetadataTables;for(let a=0;a<i.length;a++){let c=i[a],f=o[a].availableCount,d=c.class,p=r.classes[d],g=new ou({class:p,count:f,properties:c.properties,bufferViews:n});s.push(g)}}function poe(e){let t=0,n=e.lengthBits,i=e.availableCount,o;i<256?o=new Uint8Array(n):i<65536?o=new Uint16Array(n):o=new Uint32Array(n);for(let r=0;r<e.lengthBits;r++)e.getBit(r)&&(o[r]=t,t++);return o}function wVe(e){let t=poe(e._tileAvailability);e._tileJumpBuffer=t}function DVe(e){let t=e._contentJumpBuffers,n=e._contentAvailabilityBitstreams;for(let i=0;i<n.length;i++){let o=n[i],r=poe(o);t.push(r)}}ia.prototype.getTileIndex=function(e){let t=e.level-this._implicitCoordinates.level;if(t<0||this._subtreeLevels<=t)throw new ce("level is out of bounds for this subtree");return e.getSubtreeCoordinates().getOffsetCoordinates(e).tileIndex};ia.prototype.getChildSubtreeIndex=function(e){if(e.level-this._implicitCoordinates.level!==this._implicitCoordinates.subtreeLevels)throw new ce("level is out of bounds for this subtree");return e.getParentSubtreeCoordinates().getOffsetCoordinates(e).mortonIndex};function IVe(e,t){if(!u(e._tileMetadataTable))return;let n=e.getTileIndex(t);if(e._tileAvailability.getBit(n))return e._tileJumpBuffer[n]}function PVe(e,t,n){let i=e._contentMetadataTables;if(!u(i))return;let o=i[n];if(!u(o))return;let r=e._contentAvailabilityBitstreams[n],s=e.getTileIndex(t);if(r.getBit(s))return e._contentJumpBuffers[n][s]}ia.prototype.getTileMetadataView=function(e){let t=IVe(this,e);if(!u(t))return;let n=this._tileMetadataTable;return new Hv({class:n.class,metadataTable:n,entityId:t,propertyTableJson:this._tilePropertyTableJson})};ia.prototype.getContentMetadataView=function(e,t){let n=PVe(this,e,t);if(!u(n))return;let i=this._contentMetadataTables[t],o=this._contentPropertyTableJsons[t];return new Hv({class:i.class,metadataTable:i,entityId:n,contentIndex:t,propertyTableJson:o})};ia.prototype.isDestroyed=function(){return!1};ia.prototype.destroy=function(){return u(this._bufferLoader)&&wi.unload(this._bufferLoader),ue(this)};var hA=ia;var RVe={ID:"ID",NAME:"NAME",DESCRIPTION:"DESCRIPTION",TILESET_TILE_COUNT:"TILESET_TILE_COUNT",TILE_BOUNDING_BOX:"TILE_BOUNDING_BOX",TILE_BOUNDING_REGION:"TILE_BOUNDING_REGION",TILE_BOUNDING_SPHERE:"TILE_BOUNDING_SPHERE",TILE_MINIMUM_HEIGHT:"TILE_MINIMUM_HEIGHT",TILE_MAXIMUM_HEIGHT:"TILE_MAXIMUM_HEIGHT",TILE_HORIZON_OCCLUSION_POINT:"TILE_HORIZON_OCCLUSION_POINT",TILE_GEOMETRIC_ERROR:"TILE_GEOMETRIC_ERROR",CONTENT_BOUNDING_BOX:"CONTENT_BOUNDING_BOX",CONTENT_BOUNDING_REGION:"CONTENT_BOUNDING_REGION",CONTENT_BOUNDING_SPHERE:"CONTENT_BOUNDING_SPHERE",CONTENT_MINIMUM_HEIGHT:"CONTENT_MINIMUM_HEIGHT",CONTENT_MAXIMUM_HEIGHT:"CONTENT_MAXIMUM_HEIGHT",CONTENT_HORIZON_OCCLUSION_POINT:"CONTENT_HORIZON_OCCLUSION_POINT"},mA=Object.freeze(RVe);var bd={};bd.parseAllBoundingVolumeSemantics=function(e){return{tile:{boundingVolume:bd.parseBoundingVolumeSemantic("TILE",e),minimumHeight:bd._parseMinimumHeight("TILE",e),maximumHeight:bd._parseMaximumHeight("TILE",e)},content:{boundingVolume:bd.parseBoundingVolumeSemantic("CONTENT",e),minimumHeight:bd._parseMinimumHeight("CONTENT",e),maximumHeight:bd._parseMaximumHeight("CONTENT",e)}}};bd.parseBoundingVolumeSemantic=function(e,t){let n=`${e}_BOUNDING_BOX`,i=t.getPropertyBySemantic(n);if(u(i))return{box:i};let o=`${e}_BOUNDING_REGION`,r=t.getPropertyBySemantic(o);if(u(r))return{region:r};let s=`${e}_BOUNDING_SPHERE`,a=t.getPropertyBySemantic(s);if(u(a))return{sphere:a}};bd._parseMinimumHeight=function(e,t){let n=`${e}_MINIMUM_HEIGHT`;return t.getPropertyBySemantic(n)};bd._parseMaximumHeight=function(e,t){let n=`${e}_MAXIMUM_HEIGHT`;return t.getPropertyBySemantic(n)};var pA=bd;function Nc(e,t,n){let i=t.implicitTileset,o=t.implicitCoordinates;this._implicitTileset=i,this._implicitCoordinates=o,this._implicitSubtree=void 0,this._tileset=e,this._tile=t,this._resource=n,this._metadata=void 0,this.featurePropertiesDirty=!1,this._group=void 0;let r=o.getTemplateValues(),s=i.subtreeUriTemplate.getDerivedResource({templateValues:r});this._url=s.getUrlComponent(!0),this._ready=!1}Object.defineProperties(Nc.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},ready:{get:function(){return this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._url}},metadata:{get:function(){},set:function(){}},batchTable:{get:function(){}},group:{get:function(){return this._group},set:function(e){this._group=e}}});Nc.fromSubtreeJson=async function(e,t,n,i,o,r){r=x(r,0);let s;u(o)&&(s=new Uint8Array(o,r));let a=t.implicitTileset,c=t.implicitCoordinates,l=await hA.fromSubtreeJson(n,i,s,a,c),f=new Nc(e,t,n);return f._implicitSubtree=l,OVe(f,l),f._ready=!0,f};function OVe(e,t){let n=e._tile,i=e._implicitCoordinates.childIndex,o=LVe(e,t,n,i),r=e._tileset.statistics;n.children.push(o.rootTile),r.numberOfTilesTotal++;let s=MVe(e,t,o.bottomRow);for(let a=0;a<s.length;a++){let c=s[a],l=c.tile,f=GVe(e,l,c.childIndex);l.children.push(f),r.numberOfTilesTotal++}}function MVe(e,t,n){let i=[],o=e._implicitTileset.branchingFactor;for(let r=0;r<n.length;r++){let s=n[r];if(u(s))for(let a=0;a<o;a++){let c=r*o+a;t.childSubtreeIsAvailableAtIndex(c)&&i.push({tile:s,childIndex:a})}}return i}function LVe(e,t,n,i){let s=_oe(e,t,n,i,0,!0),a=e._tileset.statistics,c=[s],l=[],f=e._implicitTileset;for(let d=1;d<f.subtreeLevels;d++){let p=t.getLevelOffset(d),g=f.branchingFactor*c.length;for(let m=0;m<g;m++){let y=p+m;if(!t.tileIsAvailableAtIndex(y)){l.push(void 0);continue}let b=t.getParentMortonIndex(m),C=c[b],A=m%f.branchingFactor,T=_oe(e,t,C,A,y);C.children.push(T),a.numberOfTilesTotal++,l.push(T)}c=l,l=[]}return{rootTile:s,bottomRow:c}}function goe(e,t,n){let i=mA.TILE_GEOMETRIC_ERROR;return u(e)&&e.hasPropertyBySemantic(i)?e.getPropertyBySemantic(i):t.geometricError/Math.pow(2,n.level)}function _oe(e,t,n,i,o,r){let s=e._implicitTileset,a;x(r,!1)?a=n.implicitCoordinates:a=n.implicitCoordinates.getChildCoordinates(i);let c,l,f;if(u(t.tilePropertyTableJson)){c=t.getTileMetadataView(a);let D=pA.parseAllBoundingVolumeSemantics(c);l=D.tile,f=D.content}let p=t.contentPropertyTableJsons.length,g=!1;for(let D=0;D<p;D++)if(t.contentIsAvailableAtCoordinates(a,D)){g=!0;break}let m=BVe(s,a,i,r,n,l),y=[];for(let D=0;D<s.contentCount;D++){if(!t.contentIsAvailableAtIndex(o,D))continue;let M={uri:s.contentUriTemplates[D].getDerivedResource({templateValues:a.getTemplateValues()}).url},L=kVe(m,f);u(L)&&(M.boundingVolume=L),y.push(bt(M,s.contentHeaders[D]))}let b=goe(c,s,a),C={boundingVolume:m,geometricError:b,refine:s.refine,contents:y},A=!0,T=Ge(s.tileHeader,A);delete T.boundingVolume,delete T.transform,delete T.metadata;let E=bt(C,T,A),v=Aoe(e,s.baseResource,E,n);return v.implicitCoordinates=a,v.implicitSubtree=t,v.metadata=c,v.hasImplicitContentMetadata=g,v}function ON(e,t){return u(e)&&u(t)&&(u(t.minimumHeight)||u(t.maximumHeight))&&(si(e,"3DTILES_bounding_volume_S2")||u(e.region))}function AW(e,t){u(t)&&(si(e,"3DTILES_bounding_volume_S2")?FVe(e.extensions["3DTILES_bounding_volume_S2"],t.minimumHeight,t.maximumHeight):u(e.region)&&NVe(e.region,t.minimumHeight,t.maximumHeight))}function NVe(e,t,n){u(t)&&(e[4]=t),u(n)&&(e[5]=n)}function FVe(e,t,n){u(t)&&(e.minimumHeight=t),u(n)&&(e.maximumHeight=n)}function BVe(e,t,n,i,o,r){let s;return!u(r)||!u(r.boundingVolume)||!ON(r.boundingVolume,r)&&ON(e.boundingVolume,r)?s=yoe(e,t,n,x(i,!1),o):s=r.boundingVolume,AW(s,r),s}function kVe(e,t){let n;return u(t)&&(n=t.boundingVolume),ON(n,t)?AW(n,t):ON(e,t)&&(n=Ge(e,!0),AW(n,t)),n}function yoe(e,t,n,i,o){let r=e.boundingVolume;return si(r,"3DTILES_bounding_volume_S2")?xoe(i,o,n,t.level,t.x,t.y,t.z):u(r.region)?{region:Coe(r.region,t.level,t.x,t.y,t.z)}:{box:boe(r.box,t.level,t.x,t.y,t.z)}}function xoe(e,t,n,i,o,r,s){let a=t._boundingVolume;if(e)return{extensions:{"3DTILES_bounding_volume_S2":{token:lg.getTokenFromId(a.s2Cell._cellId),minimumHeight:a.minimumHeight,maximumHeight:a.maximumHeight}}};let c=Number(t._boundingVolume.s2Cell._cellId>>BigInt(61)),l=c%2===0?Uv.encode2D(i,o,r):Uv.encode2D(i,r,o),f=lg.fromFacePositionLevel(c,BigInt(l),i),d,p;if(u(s)){let g=(a.maximumHeight+a.minimumHeight)/2;d=n<4?a.minimumHeight:g,p=n<4?g:a.maximumHeight}else d=a.minimumHeight,p=a.maximumHeight;return{extensions:{"3DTILES_bounding_volume_S2":{token:lg.getTokenFromId(f._cellId),minimumHeight:d,maximumHeight:p}}}}var VVe=new h,UVe=new h,CW=new h,zVe=new J;function boe(e,t,n,i,o){if(t===0)return e;let r=h.unpack(e,0,UVe),s=J.unpack(e,3,zVe),a=Math.pow(2,-t),c=-1+(2*n+1)*a,l=-1+(2*i+1)*a,f=0,d=h.fromElements(a,a,1,VVe);u(o)&&(f=-1+(2*o+1)*a,d.z=a);let p=h.fromElements(c,l,f,CW);p=J.multiplyByVector(s,p,CW),p=h.add(p,r,CW);let g=J.clone(s);g=J.multiplyByScale(g,d,g);let m=new Array(12);return h.pack(p,m),J.pack(g,m,3),m}var HVe=new se;function Coe(e,t,n,i,o){if(t===0)return e.slice();let r=se.unpack(e,0,HVe),s=e[4],a=e[5],c=Math.pow(2,-t),l=c*r.width,f=R.negativePiToPi(r.west+n*l),d=R.negativePiToPi(f+l),p=c*r.height,g=R.negativePiToPi(r.south+i*p),m=R.negativePiToPi(g+p),y=s,b=a;if(u(o)){let C=c*(a-s);y+=o*C,b=y+C}return[f,g,d,m,y,b]}function GVe(e,t,n){let i=e._implicitTileset,o=t.implicitCoordinates.getChildCoordinates(n),r=yoe(i,o,n,!1,t),s=goe(void 0,i,o),a=i.subtreeUriTemplate.getDerivedResource({templateValues:o.getTemplateValues()}).url,c={boundingVolume:r,geometricError:s,refine:i.refine,contents:[{uri:a}]},l=Aoe(e,i.baseResource,c,t);return l.implicitTileset=i,l.implicitCoordinates=o,l}function Aoe(e,t,n,i){let o=e._tile.constructor;return new o(e._tileset,t,n,i)}Nc.prototype.hasProperty=function(e,t){return!1};Nc.prototype.getFeature=function(e){};Nc.prototype.applyDebugSettings=function(e,t){};Nc.prototype.applyStyle=function(e){};Nc.prototype.update=function(e,t){};Nc.prototype.pick=function(e,t,n){};Nc.prototype.isDestroyed=function(){return!1};Nc.prototype.destroy=function(){return this._implicitSubtree=this._implicitSubtree&&this._implicitSubtree.destroy(),ue(this)};Nc._deriveBoundingBox=boe;Nc._deriveBoundingRegion=Coe;Nc._deriveBoundingVolumeS2=xoe;var rw=Nc;var WVe={NONE:0,REPEAT:1,MIRRORED_REPEAT:2},cu=Object.freeze(WVe);function _A(e,t){this._distance=t,this._normal=new Toe(e,this),this.onChangeCallback=void 0,this.index=-1}Object.defineProperties(_A.prototype,{distance:{get:function(){return this._distance},set:function(e){u(this.onChangeCallback)&&e!==this._distance&&this.onChangeCallback(this.index),this._distance=e}},normal:{get:function(){return this._normal},set:function(e){u(this.onChangeCallback)&&!h.equals(this._normal._cartesian3,e)&&this.onChangeCallback(this.index),h.clone(e,this._normal._cartesian3)}}});_A.fromPlane=function(e,t){return u(t)?(t.normal=e.normal,t.distance=e.distance):t=new _A(e.normal,e.distance),t};_A.clone=function(e,t){return u(t)?(t.normal=e.normal,t.distance=e.distance,t):new _A(e.normal,e.distance)};function Toe(e,t){this._clippingPlane=t,this._cartesian3=h.clone(e)}Object.defineProperties(Toe.prototype,{x:{get:function(){return this._cartesian3.x},set:function(e){u(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.x&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.x=e}},y:{get:function(){return this._cartesian3.y},set:function(e){u(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.y&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.y=e}},z:{get:function(){return this._cartesian3.z},set:function(e){u(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.z&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.z=e}}});var gA=_A;function ec(e){e=x(e,x.EMPTY_OBJECT),this._planes=[],this._dirtyIndex=-1,this._multipleDirtyPlanes=!1,this._enabled=x(e.enabled,!0),this.modelMatrix=F.clone(x(e.modelMatrix,F.IDENTITY)),this.edgeColor=G.clone(x(e.edgeColor,G.WHITE)),this.edgeWidth=x(e.edgeWidth,0),this.planeAdded=new me,this.planeRemoved=new me,this._owner=void 0;let t=x(e.unionClippingRegions,!1);this._unionClippingRegions=t,this._testIntersection=t?Doe:Ioe,this._uint8View=void 0,this._float32View=void 0,this._clippingPlanesTexture=void 0;let n=e.planes;if(u(n)){let i=n.length;for(let o=0;o<i;++o)this.add(n[o])}}function Doe(e){return e===qt.OUTSIDE}function Ioe(e){return e===qt.INSIDE}Object.defineProperties(ec.prototype,{length:{get:function(){return this._planes.length}},unionClippingRegions:{get:function(){return this._unionClippingRegions},set:function(e){this._unionClippingRegions!==e&&(this._unionClippingRegions=e,this._testIntersection=e?Doe:Ioe)}},enabled:{get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e)}},texture:{get:function(){return this._clippingPlanesTexture}},owner:{get:function(){return this._owner}},clippingPlanesState:{get:function(){return this._unionClippingRegions?this._planes.length:-this._planes.length}}});function Eoe(e,t){e._multipleDirtyPlanes=e._multipleDirtyPlanes||e._dirtyIndex!==-1&&e._dirtyIndex!==t,e._dirtyIndex=t}ec.prototype.add=function(e){let t=this._planes.length,n=this;e.onChangeCallback=function(i){Eoe(n,i)},e.index=t,Eoe(this,t),this._planes.push(e),this.planeAdded.raiseEvent(e,t)};ec.prototype.get=function(e){return this._planes[e]};function Poe(e,t){let n=e.length;for(let i=0;i<n;++i)if(cn.equals(e[i],t))return i;return-1}ec.prototype.contains=function(e){return Poe(this._planes,e)!==-1};ec.prototype.remove=function(e){let t=this._planes,n=Poe(t,e);if(n===-1)return!1;e instanceof gA&&(e.onChangeCallback=void 0,e.index=-1);let i=t.length-1;for(let o=n;o<i;++o){let r=t[o+1];t[o]=r,r instanceof gA&&(r.index=o)}return this._multipleDirtyPlanes=!0,t.length=i,this.planeRemoved.raiseEvent(e,n),!0};ec.prototype.removeAll=function(){let e=this._planes,t=e.length;for(let n=0;n<t;++n){let i=e[n];i instanceof gA&&(i.onChangeCallback=void 0,i.index=-1),this.planeRemoved.raiseEvent(i,n)}this._multipleDirtyPlanes=!0,this._planes=[]};var jVe=new oe,qVe=new oe;function Soe(e,t,n){let i=e._uint8View,o=e._planes,r=0;for(let s=t;s<n;++s){let a=o[s],c=Ln.octEncodeToCartesian4(a.normal,qVe);i[r]=c.x,i[r+1]=c.y,i[r+2]=c.z,i[r+3]=c.w;let l=oe.packFloat(a.distance,jVe);i[r+4]=l.x,i[r+5]=l.y,i[r+6]=l.z,i[r+7]=l.w,r+=8}}function voe(e,t,n){let i=e._float32View,o=e._planes,r=0;for(let s=t;s<n;++s){let a=o[s],c=a.normal;i[r]=c.x,i[r+1]=c.y,i[r+2]=c.z,i[r+3]=a.distance,r+=4}}function Roe(e,t){let n=Vt.maximumTextureSize;return t.x=Math.min(e,n),t.y=Math.ceil(e/t.x),t}var YVe=new H;ec.prototype.update=function(e){let t=this._clippingPlanesTexture,n=e.context,i=ec.useFloatTexture(n),o=i?this.length:this.length*2;if(u(t)){let s=t.width*t.height;(s<o||o<.25*s)&&(t.destroy(),t=void 0,this._clippingPlanesTexture=void 0)}if(this.length===0)return;if(!u(t)){let s=Roe(o,YVe);s.y*=2,i?(t=new Ot({context:n,width:s.x,height:s.y,pixelFormat:tt.RGBA,pixelDatatype:Ke.FLOAT,sampler:Qt.NEAREST,flipY:!1}),this._float32View=new Float32Array(s.x*s.y*4)):(t=new Ot({context:n,width:s.x,height:s.y,pixelFormat:tt.RGBA,pixelDatatype:Ke.UNSIGNED_BYTE,sampler:Qt.NEAREST,flipY:!1}),this._uint8View=new Uint8Array(s.x*s.y*4)),this._clippingPlanesTexture=t,this._multipleDirtyPlanes=!0}let r=this._dirtyIndex;if(!(!this._multipleDirtyPlanes&&r===-1)){if(this._multipleDirtyPlanes)i?(voe(this,0,this._planes.length),t.copyFrom({source:{width:t.width,height:t.height,arrayBufferView:this._float32View}})):(Soe(this,0,this._planes.length),t.copyFrom({source:{width:t.width,height:t.height,arrayBufferView:this._uint8View}}));else{let s=0,a=0;i?(a=Math.floor(r/t.width),s=Math.floor(r-a*t.width),voe(this,r,r+1),t.copyFrom({source:{width:1,height:1,arrayBufferView:this._float32View},xOffset:s,yOffset:a})):(a=Math.floor(r*2/t.width),s=Math.floor(r*2-a*t.width),Soe(this,r,r+1),t.copyFrom({source:{width:2,height:1,arrayBufferView:this._uint8View},xOffset:s,yOffset:a}))}this._multipleDirtyPlanes=!1,this._dirtyIndex=-1}};var XVe=new F,woe=new cn(h.UNIT_X,0);ec.prototype.computeIntersectionWithBoundingVolume=function(e,t){let n=this._planes,i=n.length,o=this.modelMatrix;u(t)&&(o=F.multiply(t,o,XVe));let r=qt.INSIDE;!this.unionClippingRegions&&i>0&&(r=qt.OUTSIDE);for(let s=0;s<i;++s){let a=n[s];cn.transform(a,o,woe);let c=e.intersectPlane(woe);if(c===qt.INTERSECTING)r=c;else if(this._testIntersection(c))return c}return r};ec.setOwner=function(e,t,n){e!==t[n]&&(t[n]=t[n]&&t[n].destroy(),u(e)&&(e._owner=t,t[n]=e))};ec.useFloatTexture=function(e){return e.floatingPointTexture};ec.getTextureResolution=function(e,t,n){let i=e.texture;if(u(i))return n.x=i.width,n.y=i.height,n;let o=ec.useFloatTexture(t)?e.length:e.length*2,r=Roe(o,n);return r.y*=2,r};ec.prototype.isDestroyed=function(){return!1};ec.prototype.destroy=function(){return this._clippingPlanesTexture=this._clippingPlanesTexture&&this._clippingPlanesTexture.destroy(),ue(this)};var As=ec;function SW(e,t,n=2){let i=t&&t.length,o=i?t[0]*n:e.length,r=Moe(e,0,o,n,!0),s=[];if(!r||r.next===r.prev)return s;let a,c,l;if(i&&(r=JVe(e,t,r,n)),e.length>80*n){a=1/0,c=1/0;let f=-1/0,d=-1/0;for(let p=n;p<o;p+=n){let g=e[p],m=e[p+1];g<a&&(a=g),m<c&&(c=m),g>f&&(f=g),m>d&&(d=m)}l=Math.max(f-a,d-c),l=l!==0?32767/l:0}return sw(r,s,n,a,c,l,0),s}function Moe(e,t,n,i,o){let r;if(o===uUe(e,t,n,i)>0)for(let s=t;s<n;s+=i)r=Ooe(s/i|0,e[s],e[s+1],r);else for(let s=n-i;s>=t;s-=i)r=Ooe(s/i|0,e[s],e[s+1],r);return r&&NN(r,r.next)&&(cw(r),r=r.next),r}function cx(e,t){if(!e)return e;t||(t=e);let n=e,i;do if(i=!1,!n.steiner&&(NN(n,n.next)||Fr(n.prev,n,n.next)===0)){if(cw(n),n=t=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==t);return t}function sw(e,t,n,i,o,r,s){if(!e)return;!s&&r&&oUe(e,i,o,r);let a=e;for(;e.prev!==e.next;){let c=e.prev,l=e.next;if(r?ZVe(e,i,o,r):KVe(e)){t.push(c.i,e.i,l.i),cw(e),e=l.next,a=l.next;continue}if(e=l,e===a){s?s===1?(e=$Ve(cx(e),t),sw(e,t,n,i,o,r,2)):s===2&&QVe(e,t,n,i,o,r):sw(cx(e),t,n,i,o,r,1);break}}}function KVe(e){let t=e.prev,n=e,i=e.next;if(Fr(t,n,i)>=0)return!1;let o=t.x,r=n.x,s=i.x,a=t.y,c=n.y,l=i.y,f=o<r?o<s?o:s:r<s?r:s,d=a<c?a<l?a:l:c<l?c:l,p=o>r?o>s?o:s:r>s?r:s,g=a>c?a>l?a:l:c>l?c:l,m=i.next;for(;m!==t;){if(m.x>=f&&m.x<=p&&m.y>=d&&m.y<=g&&yA(o,a,r,c,s,l,m.x,m.y)&&Fr(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function ZVe(e,t,n,i){let o=e.prev,r=e,s=e.next;if(Fr(o,r,s)>=0)return!1;let a=o.x,c=r.x,l=s.x,f=o.y,d=r.y,p=s.y,g=a<c?a<l?a:l:c<l?c:l,m=f<d?f<p?f:p:d<p?d:p,y=a>c?a>l?a:l:c>l?c:l,b=f>d?f>p?f:p:d>p?d:p,C=TW(g,m,t,n,i),A=TW(y,b,t,n,i),T=e.prevZ,E=e.nextZ;for(;T&&T.z>=C&&E&&E.z<=A;){if(T.x>=g&&T.x<=y&&T.y>=m&&T.y<=b&&T!==o&&T!==s&&yA(a,f,c,d,l,p,T.x,T.y)&&Fr(T.prev,T,T.next)>=0||(T=T.prevZ,E.x>=g&&E.x<=y&&E.y>=m&&E.y<=b&&E!==o&&E!==s&&yA(a,f,c,d,l,p,E.x,E.y)&&Fr(E.prev,E,E.next)>=0))return!1;E=E.nextZ}for(;T&&T.z>=C;){if(T.x>=g&&T.x<=y&&T.y>=m&&T.y<=b&&T!==o&&T!==s&&yA(a,f,c,d,l,p,T.x,T.y)&&Fr(T.prev,T,T.next)>=0)return!1;T=T.prevZ}for(;E&&E.z<=A;){if(E.x>=g&&E.x<=y&&E.y>=m&&E.y<=b&&E!==o&&E!==s&&yA(a,f,c,d,l,p,E.x,E.y)&&Fr(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function $Ve(e,t){let n=e;do{let i=n.prev,o=n.next.next;!NN(i,o)&&Loe(i,n,n.next,o)&&aw(i,o)&&aw(o,i)&&(t.push(i.i,n.i,o.i),cw(n),cw(n.next),n=e=o),n=n.next}while(n!==e);return cx(n)}function QVe(e,t,n,i,o,r){let s=e;do{let a=s.next.next;for(;a!==s.prev;){if(s.i!==a.i&&aUe(s,a)){let c=Noe(s,a);s=cx(s,s.next),c=cx(c,c.next),sw(s,t,n,i,o,r,0),sw(c,t,n,i,o,r,0);return}a=a.next}s=s.next}while(s!==e)}function JVe(e,t,n,i){let o=[];for(let r=0,s=t.length;r<s;r++){let a=t[r]*i,c=r<s-1?t[r+1]*i:e.length,l=Moe(e,a,c,i,!1);l===l.next&&(l.steiner=!0),o.push(sUe(l))}o.sort(eUe);for(let r=0;r<o.length;r++)n=tUe(o[r],n);return n}function eUe(e,t){return e.x-t.x}function tUe(e,t){let n=nUe(e,t);if(!n)return t;let i=Noe(n,e);return cx(i,i.next),cx(n,n.next)}function nUe(e,t){let n=t,i=e.x,o=e.y,r=-1/0,s;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){let d=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(d<=i&&d>r&&(r=d,s=n.x<n.next.x?n:n.next,d===i))return s}n=n.next}while(n!==t);if(!s)return null;let a=s,c=s.x,l=s.y,f=1/0;n=s;do{if(i>=n.x&&n.x>=c&&i!==n.x&&yA(o<l?i:r,o,c,l,o<l?r:i,o,n.x,n.y)){let d=Math.abs(o-n.y)/(i-n.x);aw(n,e)&&(d<f||d===f&&(n.x>s.x||n.x===s.x&&iUe(s,n)))&&(s=n,f=d)}n=n.next}while(n!==a);return s}function iUe(e,t){return Fr(e.prev,e,t.prev)<0&&Fr(t.next,e,e.next)<0}function oUe(e,t,n,i){let o=e;do o.z===0&&(o.z=TW(o.x,o.y,t,n,i)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,rUe(o)}function rUe(e){let t,n=1;do{let i=e,o;e=null;let r=null;for(t=0;i;){t++;let s=i,a=0;for(let l=0;l<n&&(a++,s=s.nextZ,!!s);l++);let c=n;for(;a>0||c>0&&s;)a!==0&&(c===0||!s||i.z<=s.z)?(o=i,i=i.nextZ,a--):(o=s,s=s.nextZ,c--),r?r.nextZ=o:e=o,o.prevZ=r,r=o;i=s}r.nextZ=null,n*=2}while(t>1);return e}function TW(e,t,n,i,o){return e=(e-n)*o|0,t=(t-i)*o|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function sUe(e){let t=e,n=e;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==e);return n}function yA(e,t,n,i,o,r,s,a){return(o-s)*(t-a)>=(e-s)*(r-a)&&(e-s)*(i-a)>=(n-s)*(t-a)&&(n-s)*(r-a)>=(o-s)*(i-a)}function aUe(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!cUe(e,t)&&(aw(e,t)&&aw(t,e)&&lUe(e,t)&&(Fr(e.prev,e,t.prev)||Fr(e,t.prev,t))||NN(e,t)&&Fr(e.prev,e,e.next)>0&&Fr(t.prev,t,t.next)>0)}function Fr(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function NN(e,t){return e.x===t.x&&e.y===t.y}function Loe(e,t,n,i){let o=LN(Fr(e,t,n)),r=LN(Fr(e,t,i)),s=LN(Fr(n,i,e)),a=LN(Fr(n,i,t));return!!(o!==r&&s!==a||o===0&&MN(e,n,t)||r===0&&MN(e,i,t)||s===0&&MN(n,e,i)||a===0&&MN(n,t,i))}function MN(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function LN(e){return e>0?1:e<0?-1:0}function cUe(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Loe(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function aw(e,t){return Fr(e.prev,e,e.next)<0?Fr(e,t,e.next)>=0&&Fr(e,e.prev,t)>=0:Fr(e,t,e.prev)<0||Fr(e,e.next,t)<0}function lUe(e,t){let n=e,i=!1,o=(e.x+t.x)/2,r=(e.y+t.y)/2;do n.y>r!=n.next.y>r&&n.next.y!==n.y&&o<(n.next.x-n.x)*(r-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==e);return i}function Noe(e,t){let n=EW(e.i,e.x,e.y),i=EW(t.i,t.x,t.y),o=e.next,r=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,i.next=n,n.prev=i,r.next=i,i.prev=r,i}function Ooe(e,t,n,i){let o=EW(e,t,n);return i?(o.next=i.next,o.prev=i,i.next.prev=o,i.next=o):(o.prev=o,o.next=o),o}function cw(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function EW(e,t,n){return{i:e,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function uUe(e,t,n,i){let o=0;for(let r=t,s=n-i;r<n;r+=i)o+=(e[s]-e[r])*(e[r+1]+e[s+1]),s=r;return o}var fUe=new h,dUe=new h,xg={};xg.computeArea2D=function(e){let t=e.length,n=0;for(let i=t-1,o=0;o<t;i=o++){let r=e[i],s=e[o];n+=r.x*s.y-s.x*r.y}return n*.5};xg.computeWindingOrder2D=function(e){return xg.computeArea2D(e)>0?xs.COUNTER_CLOCKWISE:xs.CLOCKWISE};xg.triangulate=function(e,t){let n=H.packArray(e);return SW(n,t,2)};var Voe=new h,Uoe=new h,zoe=new h,Foe=new h,Boe=new h,koe=new h,Cp=new h,Hoe=new H,Goe=new H,Woe=new H,xA=new H;xg.computeSubdivision=function(e,t,n,i,o){o=x(o,R.RADIANS_PER_DEGREE);let r=u(i),s=n.slice(0),a,c=t.length,l=new Array(c*3),f=new Array(c*2),d=0,p=0;for(a=0;a<c;a++){let T=t[a];if(l[d++]=T.x,l[d++]=T.y,l[d++]=T.z,r){let E=i[a];f[p++]=E.x,f[p++]=E.y}}let g=[],m={},y=e.maximumRadius,b=R.chordLength(o,y),C=b*b;for(;s.length>0;){let T=s.pop(),E=s.pop(),v=s.pop(),D=h.fromArray(l,v*3,Voe),O=h.fromArray(l,E*3,Uoe),P=h.fromArray(l,T*3,zoe),M,L,_;r&&(M=H.fromArray(f,v*2,Hoe),L=H.fromArray(f,E*2,Goe),_=H.fromArray(f,T*2,Woe));let S=h.multiplyByScalar(h.normalize(D,Foe),y,Foe),w=h.multiplyByScalar(h.normalize(O,Boe),y,Boe),I=h.multiplyByScalar(h.normalize(P,koe),y,koe),N=h.magnitudeSquared(h.subtract(S,w,Cp)),k=h.magnitudeSquared(h.subtract(w,I,Cp)),z=h.magnitudeSquared(h.subtract(I,S,Cp)),V=Math.max(N,k,z),U,B,W;V>C?N===V?(U=`${Math.min(v,E)} ${Math.max(v,E)}`,a=m[U],u(a)||(B=h.add(D,O,Cp),h.multiplyByScalar(B,.5,B),l.push(B.x,B.y,B.z),a=l.length/3-1,m[U]=a,r&&(W=H.add(M,L,xA),H.multiplyByScalar(W,.5,W),f.push(W.x,W.y))),s.push(v,a,T),s.push(a,E,T)):k===V?(U=`${Math.min(E,T)} ${Math.max(E,T)}`,a=m[U],u(a)||(B=h.add(O,P,Cp),h.multiplyByScalar(B,.5,B),l.push(B.x,B.y,B.z),a=l.length/3-1,m[U]=a,r&&(W=H.add(L,_,xA),H.multiplyByScalar(W,.5,W),f.push(W.x,W.y))),s.push(E,a,v),s.push(a,T,v)):z===V&&(U=`${Math.min(T,v)} ${Math.max(T,v)}`,a=m[U],u(a)||(B=h.add(P,D,Cp),h.multiplyByScalar(B,.5,B),l.push(B.x,B.y,B.z),a=l.length/3-1,m[U]=a,r&&(W=H.add(_,M,xA),H.multiplyByScalar(W,.5,W),f.push(W.x,W.y))),s.push(T,a,E),s.push(a,v,E)):(g.push(v),g.push(E),g.push(T))}let A={attributes:{position:new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:l})},indices:g,primitiveType:Ne.TRIANGLES};return r&&(A.attributes.st=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:f})),new ft(A)};var hUe=new de,mUe=new de,pUe=new de,vW=new de;xg.computeRhumbLineSubdivision=function(e,t,n,i,o){o=x(o,R.RADIANS_PER_DEGREE);let r=u(i),s=n.slice(0),a,c=t.length,l=new Array(c*3),f=new Array(c*2),d=0,p=0;for(a=0;a<c;a++){let v=t[a];if(l[d++]=v.x,l[d++]=v.y,l[d++]=v.z,r){let D=i[a];f[p++]=D.x,f[p++]=D.y}}let g=[],m={},y=e.maximumRadius,b=R.chordLength(o,y),C=new Ka(void 0,void 0,e),A=new Ka(void 0,void 0,e),T=new Ka(void 0,void 0,e);for(;s.length>0;){let v=s.pop(),D=s.pop(),O=s.pop(),P=h.fromArray(l,O*3,Voe),M=h.fromArray(l,D*3,Uoe),L=h.fromArray(l,v*3,zoe),_,S,w;r&&(_=H.fromArray(f,O*2,Hoe),S=H.fromArray(f,D*2,Goe),w=H.fromArray(f,v*2,Woe));let I=e.cartesianToCartographic(P,hUe),N=e.cartesianToCartographic(M,mUe),k=e.cartesianToCartographic(L,pUe);C.setEndPoints(I,N);let z=C.surfaceDistance;A.setEndPoints(N,k);let V=A.surfaceDistance;T.setEndPoints(k,I);let U=T.surfaceDistance,B=Math.max(z,V,U),W,j,Q,q,X;B>b?z===B?(W=`${Math.min(O,D)} ${Math.max(O,D)}`,a=m[W],u(a)||(j=C.interpolateUsingFraction(.5,vW),Q=(I.height+N.height)*.5,q=h.fromRadians(j.longitude,j.latitude,Q,e,Cp),l.push(q.x,q.y,q.z),a=l.length/3-1,m[W]=a,r&&(X=H.add(_,S,xA),H.multiplyByScalar(X,.5,X),f.push(X.x,X.y))),s.push(O,a,v),s.push(a,D,v)):V===B?(W=`${Math.min(D,v)} ${Math.max(D,v)}`,a=m[W],u(a)||(j=A.interpolateUsingFraction(.5,vW),Q=(N.height+k.height)*.5,q=h.fromRadians(j.longitude,j.latitude,Q,e,Cp),l.push(q.x,q.y,q.z),a=l.length/3-1,m[W]=a,r&&(X=H.add(S,w,xA),H.multiplyByScalar(X,.5,X),f.push(X.x,X.y))),s.push(D,a,O),s.push(a,v,O)):U===B&&(W=`${Math.min(v,O)} ${Math.max(v,O)}`,a=m[W],u(a)||(j=T.interpolateUsingFraction(.5,vW),Q=(k.height+I.height)*.5,q=h.fromRadians(j.longitude,j.latitude,Q,e,Cp),l.push(q.x,q.y,q.z),a=l.length/3-1,m[W]=a,r&&(X=H.add(w,_,xA),H.multiplyByScalar(X,.5,X),f.push(X.x,X.y))),s.push(v,a,D),s.push(a,O,D)):(g.push(O),g.push(D),g.push(v))}let E={attributes:{position:new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:l})},indices:g,primitiveType:Ne.TRIANGLES};return r&&(E.attributes.st=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:f})),new ft(E)};xg.scaleToGeodeticHeight=function(e,t,n,i){n=x(n,ee.default);let o=fUe,r=dUe;if(t=x(t,0),i=x(i,!0),u(e)){let s=e.length;for(let a=0;a<s;a+=3)h.fromArray(e,a,r),i&&(r=n.scaleToGeodeticSurface(r,r)),t!==0&&(o=n.geodeticSurfaceNormal(r,o),h.multiplyByScalar(o,t,o),h.add(r,o,r)),e[a]=r.x,e[a+1]=r.y,e[a+2]=r.z}return e};var ai=xg;function bg(){this._array=[],this._offset=0,this._length=0}Object.defineProperties(bg.prototype,{length:{get:function(){return this._length}}});bg.prototype.enqueue=function(e){this._array.push(e),this._length++};bg.prototype.dequeue=function(){if(this._length===0)return;let e=this._array,t=this._offset,n=e[t];return e[t]=void 0,t++,t>10&&t*2>e.length&&(this._array=e.slice(t),t=0),this._offset=t,this._length--,n};bg.prototype.peek=function(){if(this._length!==0)return this._array[this._offset]};bg.prototype.contains=function(e){return this._array.indexOf(e)!==-1};bg.prototype.clear=function(){this._array.length=this._offset=this._length=0};bg.prototype.sort=function(e){this._offset>0&&(this._array=this._array.slice(this._offset),this._offset=0),this._array.sort(e)};var lx=bg;var Ko={};Ko.computeHierarchyPackedLength=function(e,t){let n=0,i=[e];for(;i.length>0;){let o=i.pop();if(!u(o))continue;n+=2;let r=o.positions,s=o.holes;if(u(r)&&r.length>0&&(n+=r.length*t.packedLength),u(s)){let a=s.length;for(let c=0;c<a;++c)i.push(s[c])}}return n};Ko.packPolygonHierarchy=function(e,t,n,i){let o=[e];for(;o.length>0;){let r=o.pop();if(!u(r))continue;let s=r.positions,a=r.holes;if(t[n++]=u(s)?s.length:0,t[n++]=u(a)?a.length:0,u(s)){let c=s.length;for(let l=0;l<c;++l,n+=i.packedLength)i.pack(s[l],t,n)}if(u(a)){let c=a.length;for(let l=0;l<c;++l)o.push(a[l])}}return n};Ko.unpackPolygonHierarchy=function(e,t,n){let i=e[t++],o=e[t++],r=new Array(i),s=o>0?new Array(o):void 0;for(let a=0;a<i;++a,t+=n.packedLength)r[a]=n.unpack(e,t);for(let a=0;a<o;++a)s[a]=Ko.unpackPolygonHierarchy(e,t,n),t=s[a].startingIndex,delete s[a].startingIndex;return{positions:r,holes:s,startingIndex:t}};var ux=new H;function Yoe(e,t,n,i){return H.subtract(t,e,ux),H.multiplyByScalar(ux,n/i,ux),H.add(e,ux,ux),[ux.x,ux.y]}var Cg=new h;function _Ue(e,t,n,i){return h.subtract(t,e,Cg),h.multiplyByScalar(Cg,n/i,Cg),h.add(e,Cg,Cg),[Cg.x,Cg.y,Cg.z]}Ko.subdivideLineCount=function(e,t,n){let o=h.distance(e,t)/n,r=Math.max(0,Math.ceil(R.log2(o)));return Math.pow(2,r)};var BN=new de,kN=new de,gUe=new de,yUe=new h,FN=new Ka;Ko.subdivideRhumbLineCount=function(e,t,n,i){let o=e.cartesianToCartographic(t,BN),r=e.cartesianToCartographic(n,kN),a=new Ka(o,r,e).surfaceDistance/i,c=Math.max(0,Math.ceil(R.log2(a)));return Math.pow(2,c)};Ko.subdivideTexcoordLine=function(e,t,n,i,o,r){let s=Ko.subdivideLineCount(n,i,o),a=H.distance(e,t),c=a/s,l=r;l.length=s*2;let f=0;for(let d=0;d<s;d++){let p=Yoe(e,t,d*c,a);l[f++]=p[0],l[f++]=p[1]}return l};Ko.subdivideLine=function(e,t,n,i){let o=Ko.subdivideLineCount(e,t,n),r=h.distance(e,t),s=r/o;u(i)||(i=[]);let a=i;a.length=o*3;let c=0;for(let l=0;l<o;l++){let f=_Ue(e,t,l*s,r);a[c++]=f[0],a[c++]=f[1],a[c++]=f[2]}return a};Ko.subdivideTexcoordRhumbLine=function(e,t,n,i,o,r,s){let a=n.cartesianToCartographic(i,BN),c=n.cartesianToCartographic(o,kN);FN.setEndPoints(a,c);let l=FN.surfaceDistance/r,f=Math.max(0,Math.ceil(R.log2(l))),d=Math.pow(2,f),p=H.distance(e,t),g=p/d,m=s;m.length=d*2;let y=0;for(let b=0;b<d;b++){let C=Yoe(e,t,b*g,p);m[y++]=C[0],m[y++]=C[1]}return m};Ko.subdivideRhumbLine=function(e,t,n,i,o){let r=e.cartesianToCartographic(t,BN),s=e.cartesianToCartographic(n,kN),a=new Ka(r,s,e),c=a.surfaceDistance/i,l=Math.max(0,Math.ceil(R.log2(c))),f=Math.pow(2,l),d=a.surfaceDistance/f;u(o)||(o=[]);let p=o;p.length=f*3;let g=0;for(let m=0;m<f;m++){let y=a.interpolateUsingSurfaceDistance(m*d,gUe),b=e.cartographicToCartesian(y,yUe);p[g++]=b.x,p[g++]=b.y,p[g++]=b.z}return p};var xUe=new h,bUe=new h,CUe=new h,AUe=new h;Ko.scaleToGeodeticHeightExtruded=function(e,t,n,i,o){i=x(i,ee.default);let r=xUe,s=bUe,a=CUe,c=AUe;if(u(e)&&u(e.attributes)&&u(e.attributes.position)){let l=e.attributes.position.values,f=l.length/2;for(let d=0;d<f;d+=3)h.fromArray(l,d,a),i.geodeticSurfaceNormal(a,r),c=i.scaleToGeodeticSurface(a,c),s=h.multiplyByScalar(r,n,s),s=h.add(c,s,s),l[d+f]=s.x,l[d+1+f]=s.y,l[d+2+f]=s.z,o&&(c=h.clone(a,c)),s=h.multiplyByScalar(r,t,s),s=h.add(c,s,s),l[d]=s.x,l[d+1]=s.y,l[d+2]=s.z}return e};Ko.polygonOutlinesFromHierarchy=function(e,t,n){let i=[],o=new lx;o.enqueue(e);let r,s,a;for(;o.length!==0;){let c=o.dequeue(),l=c.positions;if(t)for(a=l.length,r=0;r<a;r++)n.scaleToGeodeticSurface(l[r],l[r]);if(l=Eo(l,h.equalsEpsilon,!0),l.length<3)continue;let f=c.holes?c.holes.length:0;for(r=0;r<f;r++){let d=c.holes[r],p=d.positions;if(t)for(a=p.length,s=0;s<a;++s)n.scaleToGeodeticSurface(p[s],p[s]);if(p=Eo(p,h.equalsEpsilon,!0),p.length<3)continue;i.push(p);let g=0;for(u(d.holes)&&(g=d.holes.length),s=0;s<g;s++)o.enqueue(d.holes[s])}i.push(l)}return i};var TUe=new de;function EUe(e,t,n){let i=n.cartesianToCartographic(e,BN),o=n.cartesianToCartographic(t,kN);if(Math.sign(i.latitude)===Math.sign(o.latitude))return;FN.setEndPoints(i,o);let r=FN.findIntersectionWithLatitude(0,TUe);if(!u(r))return;let s=Math.min(i.longitude,o.longitude),a=Math.max(i.longitude,o.longitude);if(Math.abs(a-s)>R.PI){let c=s;s=a,a=c}if(!(r.longitude<s||r.longitude>a))return n.cartographicToCartesian(r)}function SUe(e,t,n,i){if(i===nn.RHUMB)return EUe(e,t,n);let o=Qn.lineSegmentPlane(e,t,cn.ORIGIN_XY_PLANE);if(u(o))return n.scaleToGeodeticSurface(o,o)}var vUe=new de;function wUe(e,t,n){let i=[],o,r,s,a,c,l=0;for(;l<e.length;){o=e[l],r=e[(l+1)%e.length],s=R.sign(o.z),a=R.sign(r.z);let f=d=>t.cartesianToCartographic(d,vUe).longitude;if(s===0)i.push({position:l,type:s,visited:!1,next:a,theta:f(o)});else if(a!==0){if(c=SUe(o,r,t,n),++l,!u(c))continue;e.splice(l,0,c),i.push({position:l,type:s,visited:!1,next:a,theta:f(c)})}++l}return i}function Xoe(e,t,n,i,o,r,s){let a=[],c=r,l=d=>p=>p.position===d,f=[];do{let d=n[c];a.push(d);let p=i.findIndex(l(c)),g=i[p];if(!u(g)){++c;continue}let{visited:m,type:y,next:b}=g;if(g.visited=!0,y===0){if(b===0){let E=i[p-(s?1:-1)];if(E?.position===c+1)E.visited=!0;else{++c;continue}}if(!m&&s&&b>0||r===c&&!s&&b<0){++c;continue}}if(!(s?y>=0:y<=0)){++c;continue}m||f.push(c);let A=p+(s?1:-1),T=i[A];if(!u(T)){++c;continue}c=T.position}while(c<n.length&&c>=0&&c!==r&&a.length<n.length);e.splice(t,o,a);for(let d of f)t=Xoe(e,++t,n,i,0,d,!s);return t}Ko.splitPolygonsOnEquator=function(e,t,n,i){u(i)||(i=[]),i.splice(0,0,...e),i.length=e.length;let o=0;for(;o<i.length;){let r=i[o],s=r.slice();if(r.length<3){i[o]=s,++o;continue}let a=wUe(s,t,n);if(s.length===r.length||a.length<=1){i[o]=s,++o;continue}a.sort((l,f)=>l.theta-f.theta);let c=s[0].z>=0;o=Xoe(i,o,s,a,1,0,c)}return i};Ko.polygonsFromHierarchy=function(e,t,n,i,o,r){let s=[],a=[],c=new lx;c.enqueue(e);let l=u(r);for(;c.length!==0;){let f=c.dequeue(),d=f.positions,p=f.holes,g,m;if(i)for(m=d.length,g=0;g<m;g++)o.scaleToGeodeticSurface(d[g],d[g]);if(t||(d=Eo(d,h.equalsEpsilon,!0)),d.length<3)continue;let y=n(d);if(!u(y))continue;let b=[],C=ai.computeWindingOrder2D(y);if(C===xs.CLOCKWISE&&(y.reverse(),d=d.slice().reverse()),l){l=!1;let D=[d];if(D=r(D,D),D.length>1){for(let O of D)c.enqueue(new Za(O,p));continue}}let A=d.slice(),T=u(p)?p.length:0,E=[],v;for(g=0;g<T;g++){let D=p[g],O=D.positions;if(i)for(m=O.length,v=0;v<m;++v)o.scaleToGeodeticSurface(O[v],O[v]);if(t||(O=Eo(O,h.equalsEpsilon,!0)),O.length<3)continue;let P=n(O);if(!u(P))continue;C=ai.computeWindingOrder2D(P),C===xs.CLOCKWISE&&(P.reverse(),O=O.slice().reverse()),E.push(O),b.push(A.length),A=A.concat(O),y=y.concat(P);let M=0;for(u(D.holes)&&(M=D.holes.length),v=0;v<M;v++)c.enqueue(D.holes[v])}s.push({outerRing:d,holes:E}),a.push({positions:A,positions2D:y,holes:b})}return{hierarchy:s,polygons:a}};var DUe=new H,IUe=new h,PUe=new Le,RUe=new J;Ko.computeBoundingRectangle=function(e,t,n,i,o){let r=Le.fromAxisAngle(e,i,PUe),s=J.fromQuaternion(r,RUe),a=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,l=Number.POSITIVE_INFINITY,f=Number.NEGATIVE_INFINITY,d=n.length;for(let p=0;p<d;++p){let g=h.clone(n[p],IUe);J.multiplyByVector(s,g,g);let m=t(g,DUe);u(m)&&(a=Math.min(a,m.x),c=Math.max(c,m.x),l=Math.min(l,m.y),f=Math.max(f,m.y))}return o.x=a,o.y=l,o.width=c-a,o.height=f-l,o};Ko.createGeometryFromPositions=function(e,t,n,i,o,r,s){let a=ai.triangulate(t.positions2D,t.holes);a.length<3&&(a=[0,1,2]);let c=t.positions,l=u(n),f=l?n.positions:void 0;if(o){let d=c.length,p=new Array(d*3),g=0;for(let b=0;b<d;b++){let C=c[b];p[g++]=C.x,p[g++]=C.y,p[g++]=C.z}let m={attributes:{position:new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:p})},indices:a,primitiveType:Ne.TRIANGLES};l&&(m.attributes.st=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:H.packArray(f)}));let y=new ft(m);return r.normal?Nn.computeNormal(y):y}if(s===nn.GEODESIC)return ai.computeSubdivision(e,c,a,f,i);if(s===nn.RHUMB)return ai.computeRhumbLineSubdivision(e,c,a,f,i)};var joe=[],qoe=[],OUe=new h,MUe=new h;Ko.computeWallGeometry=function(e,t,n,i,o,r){let s,a,c,l,f,d,p,g,m,y=e.length,b=0,C=0,A=u(t),T=A?t.positions:void 0;if(o)for(a=y*3*2,s=new Array(a*2),A&&(m=y*2*2,g=new Array(m*2)),c=0;c<y;c++)l=e[c],f=e[(c+1)%y],s[b]=s[b+a]=l.x,++b,s[b]=s[b+a]=l.y,++b,s[b]=s[b+a]=l.z,++b,s[b]=s[b+a]=f.x,++b,s[b]=s[b+a]=f.y,++b,s[b]=s[b+a]=f.z,++b,A&&(d=T[c],p=T[(c+1)%y],g[C]=g[C+m]=d.x,++C,g[C]=g[C+m]=d.y,++C,g[C]=g[C+m]=p.x,++C,g[C]=g[C+m]=p.y,++C);else{let P=R.chordLength(i,n.maximumRadius),M=0;if(r===nn.GEODESIC)for(c=0;c<y;c++)M+=Ko.subdivideLineCount(e[c],e[(c+1)%y],P);else if(r===nn.RHUMB)for(c=0;c<y;c++)M+=Ko.subdivideRhumbLineCount(n,e[c],e[(c+1)%y],P);for(a=(M+y)*3,s=new Array(a*2),A&&(m=(M+y)*2,g=new Array(m*2)),c=0;c<y;c++){l=e[c],f=e[(c+1)%y];let L,_;A&&(d=T[c],p=T[(c+1)%y]),r===nn.GEODESIC?(L=Ko.subdivideLine(l,f,P,qoe),A&&(_=Ko.subdivideTexcoordLine(d,p,l,f,P,joe))):r===nn.RHUMB&&(L=Ko.subdivideRhumbLine(n,l,f,P,qoe),A&&(_=Ko.subdivideTexcoordRhumbLine(d,p,n,l,f,P,joe)));let S=L.length;for(let w=0;w<S;++w,++b)s[b]=L[w],s[b+a]=L[w];if(s[b]=f.x,s[b+a]=f.x,++b,s[b]=f.y,s[b+a]=f.y,++b,s[b]=f.z,s[b+a]=f.z,++b,A){let w=_.length;for(let I=0;I<w;++I,++C)g[C]=_[I],g[C+m]=_[I];g[C]=p.x,g[C+m]=p.x,++C,g[C]=p.y,g[C+m]=p.y,++C}}}y=s.length;let E=Be.createTypedArray(y/3,y-e.length*6),v=0;for(y/=6,c=0;c<y;c++){let P=c,M=P+1,L=P+y,_=L+1;l=h.fromArray(s,P*3,OUe),f=h.fromArray(s,M*3,MUe),!h.equalsEpsilon(l,f,R.EPSILON10,R.EPSILON10)&&(E[v++]=P,E[v++]=L,E[v++]=M,E[v++]=M,E[v++]=L,E[v++]=_)}let D={attributes:new hn({position:new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:s})}),indices:E,primitiveType:Ne.TRIANGLES};return A&&(D.attributes.st=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:g})),new ft(D)};var zn=Ko;function Br(e,t){this.position=e,u(this.position)||(this.position=new H),this.tangentPlane=t,u(this.tangentPlane)||(this.tangentPlane=Br.NORTH_POLE_TANGENT_PLANE)}Object.defineProperties(Br.prototype,{ellipsoid:{get:function(){return this.tangentPlane.ellipsoid}},x:{get:function(){return this.position.x}},y:{get:function(){return this.position.y}},conformalLatitude:{get:function(){let e=H.magnitude(this.position),t=2*this.ellipsoid.maximumRadius;return this.tangentPlane.plane.normal.z*(R.PI_OVER_TWO-2*Math.atan2(e,t))}},longitude:{get:function(){let e=R.PI_OVER_TWO+Math.atan2(this.y,this.x);return e>Math.PI&&(e-=R.TWO_PI),e}}});var bA=new de,LUe=new h;Br.prototype.getLatitude=function(e){u(e)||(e=ee.default),bA.latitude=this.conformalLatitude,bA.longitude=this.longitude,bA.height=0;let t=this.ellipsoid.cartographicToCartesian(bA,LUe);return e.cartesianToCartographic(t,bA),bA.latitude};var NUe=new _n,FUe=new h,BUe=new h;Br.fromCartesian=function(e,t){let n=R.signNotZero(e.z),i=Br.NORTH_POLE_TANGENT_PLANE,o=Br.SOUTH_POLE;n<0&&(i=Br.SOUTH_POLE_TANGENT_PLANE,o=Br.NORTH_POLE);let r=NUe;r.origin=i.ellipsoid.scaleToGeocentricSurface(e,r.origin),r.direction=h.subtract(r.origin,o,FUe),h.normalize(r.direction,r.direction);let s=Qn.rayPlane(r,i.plane,BUe),a=h.subtract(s,o,s),c=h.dot(i.xAxis,a),l=n*h.dot(i.yAxis,a);return u(t)?(t.position=new H(c,l),t.tangentPlane=i,t):new Br(new H(c,l),i)};Br.fromCartesianArray=function(e,t){let n=e.length;u(t)?t.length=n:t=new Array(n);for(let i=0;i<n;i++)t[i]=Br.fromCartesian(e[i],t[i]);return t};Br.clone=function(e,t){if(u(e))return u(t)?(t.position=e.position,t.tangentPlane=e.tangentPlane,t):new Br(e.position,e.tangentPlane)};Br.HALF_UNIT_SPHERE=Object.freeze(new ee(.5,.5,.5));Br.NORTH_POLE=Object.freeze(new h(0,0,.5));Br.SOUTH_POLE=Object.freeze(new h(0,0,-.5));Br.NORTH_POLE_TANGENT_PLANE=Object.freeze(new os(Br.NORTH_POLE,Br.HALF_UNIT_SPHERE));Br.SOUTH_POLE_TANGENT_PLANE=Object.freeze(new os(Br.SOUTH_POLE,Br.HALF_UNIT_SPHERE));var Fc=Br;var kUe=new de,Koe=new de;function VUe(e,t,n,i){let r=i.cartesianToCartographic(e,kUe).height,s=i.cartesianToCartographic(t,Koe);s.height=r,i.cartographicToCartesian(s,t);let a=i.cartesianToCartographic(n,Koe);a.height=r-100,i.cartographicToCartesian(a,n)}var Zoe=new qe,UUe=new h,zUe=new h,HUe=new h,GUe=new h,WUe=new h,jUe=new h,VN=new h,qh=new h,CA=new h,qUe=new H,YUe=new H,XUe=new h,$oe=new Le,KUe=new J,ZUe=new J;function wW(e){let t=e.vertexFormat,n=e.geometry,i=e.shadowVolume,o=n.attributes.position.values,r=u(n.attributes.st)?n.attributes.st.values:void 0,s=o.length,a=e.wall,c=e.top||a,l=e.bottom||a;if(t.st||t.normal||t.tangent||t.bitangent||i){let f=e.boundingRectangle,d=e.rotationAxis,p=e.projectTo2d,g=e.ellipsoid,m=e.stRotation,y=e.perPositionHeight,b=qUe;b.x=f.x,b.y=f.y;let C=t.st?new Float32Array(2*(s/3)):void 0,A;t.normal&&(y&&c&&!a?A=n.attributes.normal.values:A=new Float32Array(s));let T=t.tangent?new Float32Array(s):void 0,E=t.bitangent?new Float32Array(s):void 0,v=i?new Float32Array(s):void 0,D=0,O=0,P=zUe,M=HUe,L=GUe,_=!0,S=KUe,w=ZUe;if(m!==0){let k=Le.fromAxisAngle(d,m,$oe);S=J.fromQuaternion(k,S),k=Le.fromAxisAngle(d,-m,$oe),w=J.fromQuaternion(k,w)}else S=J.clone(J.IDENTITY,S),w=J.clone(J.IDENTITY,w);let I=0,N=0;c&&l&&(I=s/2,N=s/3,s/=2);for(let k=0;k<s;k+=3){let z=h.fromArray(o,k,XUe);if(t.st&&!u(r)){let V=J.multiplyByVector(S,z,UUe);V=g.scaleToGeodeticSurface(V,V);let U=p([V],YUe)[0];H.subtract(U,b,U);let B=R.clamp(U.x/f.width,0,1),W=R.clamp(U.y/f.height,0,1);l&&(C[D+N]=B,C[D+1+N]=W),c&&(C[D]=B,C[D+1]=W),D+=2}if(t.normal||t.tangent||t.bitangent||i){let V=O+1,U=O+2;if(a){if(k+3<s){let B=h.fromArray(o,k+3,WUe);if(_){let W=h.fromArray(o,k+s,jUe);y&&VUe(z,B,W,g),h.subtract(B,z,B),h.subtract(W,z,W),P=h.normalize(h.cross(W,B,P),P),_=!1}h.equalsEpsilon(B,z,R.EPSILON10)&&(_=!0)}(t.tangent||t.bitangent)&&(L=g.geodeticSurfaceNormal(z,L),t.tangent&&(M=h.normalize(h.cross(L,P,M),M)))}else P=g.geodeticSurfaceNormal(z,P),(t.tangent||t.bitangent)&&(y&&(VN=h.fromArray(A,O,VN),qh=h.cross(h.UNIT_Z,VN,qh),qh=h.normalize(J.multiplyByVector(w,qh,qh),qh),t.bitangent&&(CA=h.normalize(h.cross(VN,qh,CA),CA))),M=h.cross(h.UNIT_Z,P,M),M=h.normalize(J.multiplyByVector(w,M,M),M),t.bitangent&&(L=h.normalize(h.cross(P,M,L),L)));t.normal&&(e.wall?(A[O+I]=P.x,A[V+I]=P.y,A[U+I]=P.z):l&&(A[O+I]=-P.x,A[V+I]=-P.y,A[U+I]=-P.z),(c&&!y||a)&&(A[O]=P.x,A[V]=P.y,A[U]=P.z)),i&&(a&&(P=g.geodeticSurfaceNormal(z,P)),v[O+I]=-P.x,v[V+I]=-P.y,v[U+I]=-P.z),t.tangent&&(e.wall?(T[O+I]=M.x,T[V+I]=M.y,T[U+I]=M.z):l&&(T[O+I]=-M.x,T[V+I]=-M.y,T[U+I]=-M.z),c&&(y?(T[O]=qh.x,T[V]=qh.y,T[U]=qh.z):(T[O]=M.x,T[V]=M.y,T[U]=M.z))),t.bitangent&&(l&&(E[O+I]=L.x,E[V+I]=L.y,E[U+I]=L.z),c&&(y?(E[O]=CA.x,E[V]=CA.y,E[U]=CA.z):(E[O]=L.x,E[V]=L.y,E[U]=L.z))),O+=3}}t.st&&!u(r)&&(n.attributes.st=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:C})),t.normal&&(n.attributes.normal=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:A})),t.tangent&&(n.attributes.tangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:T})),t.bitangent&&(n.attributes.bitangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:E})),i&&(n.attributes.extrudeDirection=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:v}))}if(e.extrude&&u(e.offsetAttribute)){let f=o.length/3,d=new Uint8Array(f);if(e.offsetAttribute===an.TOP)c&&l||a?d=d.fill(1,0,f/2):c&&(d=d.fill(1));else{let p=e.offsetAttribute===an.NONE?0:1;d=d.fill(p)}n.attributes.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:d})}return n}var Qoe=[];function $Ue(e,t,n,i,o,r,s,a,c,l){let f={walls:[]},d;if(s||a){let A=zn.createGeometryFromPositions(e,t,n,i,r,c,l),T=A.attributes.position.values,E=A.indices,v,D;if(s&&a){let O=T.concat(T);v=O.length/3,D=Be.createTypedArray(v,E.length*2),D.set(E);let P=E.length,M=v/2;for(d=0;d<P;d+=3){let L=D[d]+M,_=D[d+1]+M,S=D[d+2]+M;D[d+P]=S,D[d+1+P]=_,D[d+2+P]=L}if(A.attributes.position.values=O,r&&c.normal){let L=A.attributes.normal.values;A.attributes.normal.values=new Float32Array(O.length),A.attributes.normal.values.set(L)}if(c.st&&u(n)){let L=A.attributes.st.values;A.attributes.st.values=new Float32Array(v*2),A.attributes.st.values=L.concat(L)}A.indices=D}else if(a){for(v=T.length/3,D=Be.createTypedArray(v,E.length),d=0;d<E.length;d+=3)D[d]=E[d+2],D[d+1]=E[d+1],D[d+2]=E[d];A.indices=D}f.topAndBottom=new vt({geometry:A})}let p=o.outerRing,g=os.fromPoints(p,e),m=g.projectPointsOntoPlane(p,Qoe),y=ai.computeWindingOrder2D(m);y===xs.CLOCKWISE&&(p=p.slice().reverse());let b=zn.computeWallGeometry(p,n,e,i,r,l);f.walls.push(new vt({geometry:b}));let C=o.holes;for(d=0;d<C.length;d++){let A=C[d];m=g.projectPointsOntoPlane(A,Qoe),y=ai.computeWindingOrder2D(m),y===xs.COUNTER_CLOCKWISE&&(A=A.slice().reverse()),b=zn.computeWallGeometry(A,n,e,i,r,l),f.walls.push(new vt({geometry:b}))}return f}function pf(e){let t=e.polygonHierarchy,n=x(e.vertexFormat,Ie.DEFAULT),i=x(e.ellipsoid,ee.default),o=x(e.granularity,R.RADIANS_PER_DEGREE),r=x(e.stRotation,0),s=e.textureCoordinates,a=x(e.perPositionHeight,!1),c=a&&u(e.extrudedHeight),l=x(e.height,0),f=x(e.extrudedHeight,l);if(!c){let d=Math.max(l,f);f=Math.min(l,f),l=d}this._vertexFormat=Ie.clone(n),this._ellipsoid=ee.clone(i),this._granularity=o,this._stRotation=r,this._height=l,this._extrudedHeight=f,this._closeTop=x(e.closeTop,!0),this._closeBottom=x(e.closeBottom,!0),this._polygonHierarchy=t,this._perPositionHeight=a,this._perPositionHeightExtrude=c,this._shadowVolume=x(e.shadowVolume,!1),this._workerName="createPolygonGeometry",this._offsetAttribute=e.offsetAttribute,this._arcType=x(e.arcType,nn.GEODESIC),this._rectangle=void 0,this._textureCoordinateRotationPoints=void 0,this._textureCoordinates=s,this.packedLength=zn.computeHierarchyPackedLength(t,h)+ee.packedLength+Ie.packedLength+(s?zn.computeHierarchyPackedLength(s,H):1)+12}pf.fromPositions=function(e){e=x(e,x.EMPTY_OBJECT);let t={polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,vertexFormat:e.vertexFormat,stRotation:e.stRotation,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,closeTop:e.closeTop,closeBottom:e.closeBottom,offsetAttribute:e.offsetAttribute,arcType:e.arcType,textureCoordinates:e.textureCoordinates};return new pf(t)};pf.pack=function(e,t,n){return n=x(n,0),n=zn.packPolygonHierarchy(e._polygonHierarchy,t,n,h),ee.pack(e._ellipsoid,t,n),n+=ee.packedLength,Ie.pack(e._vertexFormat,t,n),n+=Ie.packedLength,t[n++]=e._height,t[n++]=e._extrudedHeight,t[n++]=e._granularity,t[n++]=e._stRotation,t[n++]=e._perPositionHeightExtrude?1:0,t[n++]=e._perPositionHeight?1:0,t[n++]=e._closeTop?1:0,t[n++]=e._closeBottom?1:0,t[n++]=e._shadowVolume?1:0,t[n++]=x(e._offsetAttribute,-1),t[n++]=e._arcType,u(e._textureCoordinates)?n=zn.packPolygonHierarchy(e._textureCoordinates,t,n,H):t[n++]=-1,t[n++]=e.packedLength,t};var QUe=ee.clone(ee.UNIT_SPHERE),JUe=new Ie,eze={polygonHierarchy:{}};pf.unpack=function(e,t,n){t=x(t,0);let i=zn.unpackPolygonHierarchy(e,t,h);t=i.startingIndex,delete i.startingIndex;let o=ee.unpack(e,t,QUe);t+=ee.packedLength;let r=Ie.unpack(e,t,JUe);t+=Ie.packedLength;let s=e[t++],a=e[t++],c=e[t++],l=e[t++],f=e[t++]===1,d=e[t++]===1,p=e[t++]===1,g=e[t++]===1,m=e[t++]===1,y=e[t++],b=e[t++],C=e[t]===-1?void 0:zn.unpackPolygonHierarchy(e,t,H);u(C)?(t=C.startingIndex,delete C.startingIndex):t++;let A=e[t++];return u(n)||(n=new pf(eze)),n._polygonHierarchy=i,n._ellipsoid=ee.clone(o,n._ellipsoid),n._vertexFormat=Ie.clone(r,n._vertexFormat),n._height=s,n._extrudedHeight=a,n._granularity=c,n._stRotation=l,n._perPositionHeightExtrude=f,n._perPositionHeight=d,n._closeTop=p,n._closeBottom=g,n._shadowVolume=m,n._offsetAttribute=y===-1?void 0:y,n._arcType=b,n._textureCoordinates=C,n.packedLength=A,n};var tze=new H,nze=new H,ize=new Fc;function Joe(e,t,n,i,o,r){let s=e.longitude,a=s>=0?s:s+R.TWO_PI;o.westOverIdl=Math.min(o.westOverIdl,a),o.eastOverIdl=Math.max(o.eastOverIdl,a),r.west=Math.min(r.west,s),r.east=Math.max(r.east,s);let c=e.getLatitude(n),l=c;if(r.south=Math.min(r.south,c),r.north=Math.max(r.north,c),i!==nn.RHUMB){let p=H.subtract(t.position,e.position,tze),g=H.dot(t.position,p)/H.dot(p,p);if(g>0&&g<1){let m=H.add(t.position,H.multiplyByScalar(p,-g,p),nze),y=Fc.clone(t,ize);y.position=m;let b=y.getLatitude(n);r.south=Math.min(r.south,b),r.north=Math.max(r.north,b),Math.abs(c)>Math.abs(b)&&(l=b)}}let f=t.x*e.y-e.x*t.y,d=Math.sign(f);d!==0&&(d*=H.angleBetween(t.position,e.position)),l>=0&&(o.northAngle+=d),l<=0&&(o.southAngle+=d)}var ere=new Fc,oze=new Fc,mf={northAngle:0,southAngle:0,westOverIdl:0,eastOverIdl:0};pf.computeRectangleFromPositions=function(e,t,n,i){if(u(i)||(i=new se),e.length<3)return i;i.west=Number.POSITIVE_INFINITY,i.east=Number.NEGATIVE_INFINITY,i.south=Number.POSITIVE_INFINITY,i.north=Number.NEGATIVE_INFINITY,mf.northAngle=0,mf.southAngle=0,mf.westOverIdl=Number.POSITIVE_INFINITY,mf.eastOverIdl=Number.NEGATIVE_INFINITY;let o=e.length,r=Fc.fromCartesian(e[0],oze);for(let s=1;s<o;s++){let a=Fc.fromCartesian(e[s],ere);Joe(a,r,t,n,mf,i),r=Fc.clone(a,r)}return Joe(Fc.fromCartesian(e[0],ere),r,t,n,mf,i),i.east-i.west>mf.eastOverIdl-mf.westOverIdl&&(i.west=mf.westOverIdl,i.east=mf.eastOverIdl,i.east>R.PI&&(i.east=i.east-R.TWO_PI),i.west>R.PI&&(i.west=i.west-R.TWO_PI)),R.equalsEpsilon(Math.abs(mf.northAngle),R.TWO_PI,R.EPSILON10)&&(i.north=R.PI_OVER_TWO,i.east=R.PI,i.west=-R.PI),R.equalsEpsilon(Math.abs(mf.southAngle),R.TWO_PI,R.EPSILON10)&&(i.south=-R.PI_OVER_TWO,i.east=R.PI,i.west=-R.PI),i};var rze=new Fc;function sze(e,t,n){return e.height>=R.PI||e.width>=R.PI?Fc.fromCartesian(t[0],rze).tangentPlane:os.fromPoints(t,n)}var tre=new de;function aze(e,t,n){return(i,o)=>{if(e.height>=R.PI||e.width>=R.PI){if(e.south<0&&e.north>0){u(o)||(o=[]);for(let s=0;s<i.length;++s){let a=n.cartesianToCartographic(i[s],tre);o[s]=new H(a.longitude/R.PI,a.latitude/R.PI_OVER_TWO)}return o.length=i.length,o}return Fc.fromCartesianArray(i,o)}return os.fromPoints(t,n).projectPointsOntoPlane(i,o)}}function cze(e,t,n){if(e.height>=R.PI||e.width>=R.PI)return(o,r)=>{if(e.south<0&&e.north>0){let s=n.cartesianToCartographic(o,tre);return u(r)||(r=new H),r.x=s.longitude/R.PI,r.y=s.latitude/R.PI_OVER_TWO,r}return Fc.fromCartesian(o,r)};let i=os.fromPoints(t,n);return(o,r)=>i.projectPointsOntoPlane(o,r)}function lze(e,t,n,i){return(o,r)=>!i&&(e.height>=R.PI_OVER_TWO||e.width>=2*R.PI_OVER_THREE)?zn.splitPolygonsOnEquator(o,t,n,r):o}function uze(e,t,n,i){if(t.height>=R.PI||t.width>=R.PI)return qe.fromRectangle(t,void 0,Zoe);let o=e,r=os.fromPoints(o,n);return zn.computeBoundingRectangle(r.plane.normal,r.projectPointOntoPlane.bind(r),o,i,Zoe)}pf.createGeometry=function(e){let t=e._vertexFormat,n=e._ellipsoid,i=e._granularity,o=e._stRotation,r=e._polygonHierarchy,s=e._perPositionHeight,a=e._closeTop,c=e._closeBottom,l=e._arcType,f=e._textureCoordinates,d=u(f),p=r.positions;if(p.length<3)return;let g=e.rectangle,m=zn.polygonsFromHierarchy(r,d,aze(g,p,n),!s,n,lze(g,n,l,s)),y=m.hierarchy,b=m.polygons,C=function(I){return I},A=d?zn.polygonsFromHierarchy(f,!0,C,!1,n).polygons:void 0;if(y.length===0)return;let T=y[0].outerRing,E=uze(T,g,n,o),v=[],D=e._height,O=e._extrudedHeight,P=e._perPositionHeightExtrude||!R.equalsEpsilon(D,O,0,R.EPSILON2),M={perPositionHeight:s,vertexFormat:t,geometry:void 0,rotationAxis:sze(g,T,n).plane.normal,projectTo2d:cze(g,T,n),boundingRectangle:E,ellipsoid:n,stRotation:o,textureCoordinates:void 0,bottom:!1,top:!0,wall:!1,extrude:!1,arcType:l},L;if(P)for(M.extrude=!0,M.top=a,M.bottom=c,M.shadowVolume=e._shadowVolume,M.offsetAttribute=e._offsetAttribute,L=0;L<b.length;L++){let I=$Ue(n,b[L],d?A[L]:void 0,i,y[L],s,a,c,t,l),N;a&&c?(N=I.topAndBottom,M.geometry=zn.scaleToGeodeticHeightExtruded(N.geometry,D,O,n,s)):a?(N=I.topAndBottom,N.geometry.attributes.position.values=ai.scaleToGeodeticHeight(N.geometry.attributes.position.values,D,n,!s),M.geometry=N.geometry):c&&(N=I.topAndBottom,N.geometry.attributes.position.values=ai.scaleToGeodeticHeight(N.geometry.attributes.position.values,O,n,!0),M.geometry=N.geometry),(a||c)&&(M.wall=!1,N.geometry=wW(M),v.push(N));let k=I.walls;M.wall=!0;for(let z=0;z<k.length;z++){let V=k[z];M.geometry=zn.scaleToGeodeticHeightExtruded(V.geometry,D,O,n,s),V.geometry=wW(M),v.push(V)}}else for(L=0;L<b.length;L++){let I=new vt({geometry:zn.createGeometryFromPositions(n,b[L],d?A[L]:void 0,i,s,t,l)});if(I.geometry.attributes.position.values=ai.scaleToGeodeticHeight(I.geometry.attributes.position.values,D,n,!s),M.geometry=I.geometry,I.geometry=wW(M),u(e._offsetAttribute)){let N=I.geometry.attributes.position.values.length,k=e._offsetAttribute===an.NONE?0:1,z=new Uint8Array(N/3).fill(k);I.geometry.attributes.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:z})}v.push(I)}let _=Nn.combineInstances(v)[0];_.attributes.position.values=new Float64Array(_.attributes.position.values),_.indices=Be.createTypedArray(_.attributes.position.values.length/3,_.indices);let S=_.attributes,w=ae.fromVertices(S.position.values);return t.position||delete S.position,new ft({attributes:S,indices:_.indices,primitiveType:_.primitiveType,boundingSphere:w,offsetAttribute:e._offsetAttribute})};pf.createShadowVolume=function(e,t,n){let i=e._granularity,o=e._ellipsoid,r=t(i,o),s=n(i,o);return new pf({polygonHierarchy:e._polygonHierarchy,ellipsoid:o,stRotation:e._stRotation,granularity:i,perPositionHeight:!1,extrudedHeight:r,height:s,vertexFormat:Ie.POSITION_ONLY,shadowVolume:!0,arcType:e._arcType})};function fze(e){let t=-e._stRotation;if(t===0)return[0,0,0,1,1,0];let n=e._ellipsoid,i=e._polygonHierarchy.positions,o=e.rectangle;return ft._textureCoordinateRotationPoints(i,t,n,o)}Object.defineProperties(pf.prototype,{rectangle:{get:function(){if(!u(this._rectangle)){let e=this._polygonHierarchy.positions;this._rectangle=pf.computeRectangleFromPositions(e,this._ellipsoid,this._arcType)}return this._rectangle}},textureCoordinateRotationPoints:{get:function(){return u(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=fze(this)),this._textureCoordinateRotationPoints}}});var Ag=pf;function fx(e){this._ellipsoid=x(e.ellipsoid,ee.default),this._positions=[...e.positions]}Object.defineProperties(fx.prototype,{length:{get:function(){return this._positions.length}},positions:{get:function(){return this._positions}},ellipsoid:{get:function(){return this._ellipsoid}}});fx.clone=function(e,t){return u(t)?(t._ellipsoid=e.ellipsoid,t._positions.length=0,t._positions.push(...e.positions),t):new fx({positions:e.positions,ellipsoid:e.ellipsoid})};fx.equals=function(e,t){return e.ellipsoid.equals(t.ellipsoid)&&e.positions===t.positions};fx.prototype.computeRectangle=function(e){return Ag.computeRectangleFromPositions(this.positions,this.ellipsoid,void 0,e)};var dze=new se,nre=new h;fx.prototype.computeSphericalExtents=function(e){u(e)||(e=new se);let t=this.computeRectangle(dze),n=de.toCartesian(se.southwest(t),this.ellipsoid,nre),i=Math.sqrt(n.x*n.x+n.y*n.y),o=R.fastApproximateAtan2(i,n.z),r=R.fastApproximateAtan2(n.x,n.y);return e.south=o,e.west=r,n=de.toCartesian(se.northeast(t),this.ellipsoid,nre),i=Math.sqrt(n.x*n.x+n.y*n.y),o=R.fastApproximateAtan2(i,n.z),r=R.fastApproximateAtan2(n.x,n.y),e.north=o,e.east=r,e};var lw=fx;var UN=`in vec2 v_textureCoordinates;

uniform int u_polygonsLength;
uniform int u_extentsLength;
uniform highp sampler2D u_polygonTexture;
uniform highp sampler2D u_extentsTexture;

int getPolygonIndex(float dimension, vec2 coord) {
   vec2 uv = coord.xy * dimension;
   return int(floor(uv.y) * dimension + floor(uv.x));
}

vec2 getLookupUv(ivec2 dimensions, int i) {
    int pixY = i / dimensions.x;
    int pixX = i - (pixY * dimensions.x);
    float pixelWidth = 1.0 / float(dimensions.x);
    float pixelHeight = 1.0 / float(dimensions.y);
    float u = (float(pixX) + 0.5) * pixelWidth; // sample from center of pixel
    float v = (float(pixY) + 0.5) * pixelHeight;
    return vec2(u, v);
}

vec4 getExtents(int i) {
    return texture(u_extentsTexture, getLookupUv(textureSize(u_extentsTexture, 0), i));
}

ivec2 getPositionsLengthAndExtentsIndex(int i) {
    vec2 uv = getLookupUv(textureSize(u_polygonTexture, 0), i);
    vec4 value = texture(u_polygonTexture, uv);
    return ivec2(int(value.x), int(value.y));
}

vec2 getPolygonPosition(int i) {
    vec2 uv = getLookupUv(textureSize(u_polygonTexture, 0), i);
    return texture(u_polygonTexture, uv).xy;
}

vec2 getCoordinates(vec2 textureCoordinates, vec4 extents) {
    float latitude = mix(extents.x, extents.x + 1.0 / extents.z, textureCoordinates.y);
    float longitude = mix(extents.y, extents.y + 1.0 / extents.w, textureCoordinates.x);
    return vec2(latitude, longitude);
}

void main() {
    int lastPolygonIndex = 0;
    out_FragColor = vec4(1.0);

    // Get the relevant region of the texture
    float dimension = float(u_extentsLength);
    if (u_extentsLength > 2) {
        dimension = ceil(log2(float(u_extentsLength)));
    }
    int regionIndex = getPolygonIndex(dimension, v_textureCoordinates);

    for (int polygonIndex = 0; polygonIndex < u_polygonsLength; polygonIndex++) {
        ivec2 positionsLengthAndExtents = getPositionsLengthAndExtentsIndex(lastPolygonIndex);
        int positionsLength = positionsLengthAndExtents.x;
        int polygonExtentsIndex = positionsLengthAndExtents.y;
        lastPolygonIndex += 1;

         // Only compute signed distance for the relevant part of the atlas
         if (polygonExtentsIndex == regionIndex) {
            float clipAmount = czm_infinity;
            vec4 extents = getExtents(polygonExtentsIndex);
            vec2 textureOffset = vec2(mod(float(polygonExtentsIndex), dimension), floor(float(polygonExtentsIndex) / dimension)) / dimension;
            vec2 p = getCoordinates((v_textureCoordinates - textureOffset) * dimension, extents);
            float s = 1.0;

            // Check each edge for absolute distance
            for (int i = 0, j = positionsLength - 1; i < positionsLength; j = i, i++) {
                vec2 a = getPolygonPosition(lastPolygonIndex + i);
                vec2 b = getPolygonPosition(lastPolygonIndex + j);
 
                vec2 ab = b - a;
                vec2 pa = p - a;
                float t = dot(pa, ab) / dot(ab, ab);
                t = clamp(t, 0.0, 1.0);

                vec2 pq = pa - t * ab;
                float d = length(pq);

                // Inside / outside computation to determine sign
                bvec3 cond = bvec3(p.y >= a.y, 
                            p.y < b.y, 
                            ab.x * pa.y > ab.y * pa.x);
                if (all(cond) || all(not(cond))) s = -s;
                if (abs(d) < abs(clipAmount)) {
                    clipAmount = d;
                }
            }

            // Normalize the range to [0,1]
            vec4 result = (s * vec4(clipAmount * length(extents.zw))) / 2.0 + 0.5;
            // In the case where we've iterated through multiple polygons, take the minimum
            out_FragColor = min(out_FragColor, result);
         }

        lastPolygonIndex += positionsLength;
    }
}`;function Yr(e){e=x(e,x.EMPTY_OBJECT),this._polygons=[],this._totalPositions=0,this.enabled=x(e.enabled,!0),this.inverse=x(e.inverse,!1),this.polygonAdded=new me,this.polygonRemoved=new me,this._owner=void 0,this._float32View=void 0,this._extentsFloat32View=void 0,this._extentsCount=0,this._polygonsTexture=void 0,this._extentsTexture=void 0,this._signedDistanceTexture=void 0,this._signedDistanceComputeCommand=void 0;let t=e.polygons;if(u(t)){let n=t.length;for(let i=0;i<n;++i)this._polygons.push(t[i])}}Object.defineProperties(Yr.prototype,{length:{get:function(){return this._polygons.length}},totalPositions:{get:function(){return this._totalPositions}},extentsTexture:{get:function(){return this._extentsTexture}},extentsCount:{get:function(){return this._extentsCount}},pixelsNeededForExtents:{get:function(){return this.length}},pixelsNeededForPolygonPositions:{get:function(){return this.totalPositions+this.length}},clippingTexture:{get:function(){return this._signedDistanceTexture}},owner:{get:function(){return this._owner}},clippingPolygonsState:{get:function(){return this.inverse?-this.extentsCount:this.extentsCount}}});Yr.prototype.add=function(e){let t=this._polygons.length;return this._polygons.push(e),this.polygonAdded.raiseEvent(e,t),e};Yr.prototype.get=function(e){return this._polygons[e]};Yr.prototype.contains=function(e){return this._polygons.some(t=>lw.equals(t,e))};Yr.prototype.remove=function(e){let t=this._polygons,n=t.findIndex(i=>lw.equals(i,e));return n===-1?!1:(t.splice(n,1),this.polygonRemoved.raiseEvent(e,n),!0)};var hze=new se;function mze(e){let t=[],n=[],i=e.length;for(let r=0;r<i;++r){let a=e[r].computeSphericalExtents(),c=Math.max(a.height*2.5,.001),l=Math.max(a.width*2.5,.001),f=se.clone(a);f.south-=c,f.west-=l,f.north+=c,f.east+=l,f.south=Math.max(f.south,-Math.PI),f.west=Math.max(f.west,-Math.PI),f.north=Math.min(f.north,Math.PI),f.east=Math.min(f.east,Math.PI);let d=[r];for(let p=0;p<t.length;++p){let g=t[p];if(u(g)&&u(se.simpleIntersection(g,f))&&!se.equals(g,f)){let m=n[p];d.push(...m),m.reduce((y,b)=>se.union(e[b].computeSphericalExtents(hze),y,y),a),t[p]=void 0,n[p]=void 0,c=Math.max(a.height*2.5,.001),l=Math.max(a.width*2.5,.001),f=se.clone(a,f),f.south-=c,f.west-=l,f.north+=c,f.east+=l,f.south=Math.max(f.south,-Math.PI),f.west=Math.max(f.west,-Math.PI),f.north=Math.min(f.north,Math.PI),f.east=Math.min(f.east,Math.PI),p=-1}}t.push(f),n.push(d)}let o=new Map;return n.filter(u).forEach((r,s)=>r.forEach(a=>o.set(a,s))),{extentsList:t.filter(u),extentsIndexByPolygon:o}}Yr.prototype.removeAll=function(){let e=this._polygons,t=e.length;for(let n=0;n<t;++n){let i=e[n];this.polygonRemoved.raiseEvent(i,n)}this._polygons=[]};function pze(e){let t=e._float32View,n=e._extentsFloat32View,i=e._polygons,{extentsList:o,extentsIndexByPolygon:r}=mze(i),s=0;for(let[c,l]of i.entries()){let f=l.length;t[s++]=f,t[s++]=r.get(c);for(let d=0;d<f;++d){let p=l.positions[d],g=Math.hypot(p.x,p.y),m=R.fastApproximateAtan2(g,p.z),y=R.fastApproximateAtan2(p.x,p.y);t[s++]=m,t[s++]=y}}let a=0;for(let c of o){let l=1/(c.east-c.west),f=1/(c.north-c.south);n[a++]=c.south,n[a++]=c.west,n[a++]=f,n[a++]=l}e._extentsCount=o.length}var DW=new H;Yr.prototype.update=function(e){let t=e.context;if(!Yr.isSupported(e))throw new ce("ClippingPolygonCollections are only supported for WebGL 2.");let n=this._polygons.reduce((s,a)=>s+a.length,0);if(n===this.totalPositions||(this._totalPositions=n,this.length===0))return;u(this._signedDistanceComputeCommand)&&(this._signedDistanceComputeCommand.canceled=!0,this._signedDistanceComputeCommand=void 0);let i=this._polygonsTexture,o=this._extentsTexture,r=this._signedDistanceTexture;if(u(i)){let s=i.width*i.height;(s<this.pixelsNeededForPolygonPositions||this.pixelsNeededForPolygonPositions<.25*s)&&(i.destroy(),i=void 0,this._polygonsTexture=void 0)}if(!u(i)){let s=Yr.getTextureResolution(i,this.pixelsNeededForPolygonPositions,DW);i=new Ot({context:t,width:s.x,height:s.y,pixelFormat:tt.RG,pixelDatatype:Ke.FLOAT,sampler:Qt.NEAREST,flipY:!1}),this._float32View=new Float32Array(s.x*s.y*2),this._polygonsTexture=i}if(u(o)){let s=o.width*o.height;(s<this.pixelsNeededForExtents||this.pixelsNeededForExtents<.25*s)&&(o.destroy(),o=void 0,this._extentsTexture=void 0)}if(!u(o)){let s=Yr.getTextureResolution(o,this.pixelsNeededForExtents,DW);o=new Ot({context:t,width:s.x,height:s.y,pixelFormat:tt.RGBA,pixelDatatype:Ke.FLOAT,sampler:Qt.NEAREST,flipY:!1}),this._extentsFloat32View=new Float32Array(s.x*s.y*4),this._extentsTexture=o}if(pze(this),o.copyFrom({source:{width:o.width,height:o.height,arrayBufferView:this._extentsFloat32View}}),i.copyFrom({source:{width:i.width,height:i.height,arrayBufferView:this._float32View}}),!u(r)){let s=Yr.getClippingDistanceTextureResolution(this,DW);r=new Ot({context:t,width:s.x,height:s.y,pixelFormat:t.webgl2?tt.RED:tt.LUMINANCE,pixelDatatype:Ke.FLOAT,sampler:new Qt({wrapS:En.CLAMP_TO_EDGE,wrapT:En.CLAMP_TO_EDGE,minificationFilter:$t.LINEAR,magnificationFilter:mi.LINEAR}),flipY:!1}),this._signedDistanceTexture=r}this._signedDistanceComputeCommand=_ze(this)};Yr.prototype.queueCommands=function(e){u(this._signedDistanceComputeCommand)&&e.commandList.push(this._signedDistanceComputeCommand)};function _ze(e){let t=e._polygonsTexture,n=e._extentsTexture;return new cl({fragmentShaderSource:UN,outputTexture:e._signedDistanceTexture,uniformMap:{u_polygonsLength:function(){return e.length},u_extentsLength:function(){return e.extentsCount},u_extentsTexture:function(){return n},u_polygonTexture:function(){return t}},persists:!1,owner:e,postExecute:()=>{e._signedDistanceComputeCommand=void 0}})}var ire=new se,gze=new se;Yr.prototype.computeIntersectionWithBoundingVolume=function(e,t){let n=this._polygons,i=n.length,o=qt.OUTSIDE;this.inverse&&(o=qt.INSIDE);for(let r=0;r<i;++r){let a=n[r].computeRectangle(),c=e.rectangle;if(!u(c)&&u(e.boundingVolume?.computeCorners)){let f=e.boundingVolume.computeCorners();c=se.fromCartesianArray(f,t,ire)}u(c)||(c=se.fromBoundingSphere(e.boundingSphere,t,ire));let l=se.simpleIntersection(c,a,gze);u(l)&&(o=qt.INTERSECTING)}return o};Yr.setOwner=function(e,t,n){e!==t[n]&&(t[n]=t[n]&&t[n].destroy(),u(e)&&(e._owner=t,t[n]=e))};Yr.isSupported=function(e){return e?.context.webgl2};Yr.getTextureResolution=function(e,t,n){if(u(e))return n.x=e.width,n.y=e.height,n;let i=Vt.maximumTextureSize;return n.x=Math.min(t,i),n.y=Math.ceil(t/n.x),n.y*=2,n};Yr.getClippingDistanceTextureResolution=function(e,t){let n=e.signedDistanceTexture;return u(n)?(t.x=n.width,t.y=n.height,t):(t.x=Math.min(Vt.maximumTextureSize,4096),t.y=Math.min(Vt.maximumTextureSize,4096),t)};Yr.getClippingExtentsTextureResolution=function(e,t){let n=e.extentsTexture;return u(n)?(t.x=n.width,t.y=n.height,t):Yr.getTextureResolution(n,e.pixelsNeededForExtents,t)};Yr.prototype.isDestroyed=function(){return!1};Yr.prototype.destroy=function(){return u(this._signedDistanceComputeCommand)&&(this._signedDistanceComputeCommand.canceled=!0),this._polygonsTexture=this._polygonsTexture&&this._polygonsTexture.destroy(),this._extentsTexture=this._extentsTexture&&this._extentsTexture.destroy(),this._signedDistanceTexture=this._signedDistanceTexture&&this._signedDistanceTexture.destroy(),ue(this)};var Yh=Yr;var uw={NONE:0,SCENE_LIGHT:1,SUNLIGHT:2};uw.fromGlobeFlags=function(e){return e.enableLighting&&e.dynamicAtmosphereLighting?e.dynamicAtmosphereLightingFromSun?uw.SUNLIGHT:uw.SCENE_LIGHT:uw.NONE};var Tg=Object.freeze(uw);function ore(){this.lightIntensity=10,this.rayleighCoefficient=new h(55e-7,13e-6,284e-7),this.mieCoefficient=new h(21e-6,21e-6,21e-6),this.rayleighScaleHeight=1e4,this.mieScaleHeight=3200,this.mieAnisotropy=.9,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this.dynamicLighting=Tg.NONE}ore.requiresColorCorrect=function(e){return!(R.equalsEpsilon(e.hueShift,0,R.EPSILON7)&&R.equalsEpsilon(e.saturationShift,0,R.EPSILON7)&&R.equalsEpsilon(e.brightnessShift,0,R.EPSILON7))};var AA=ore;var Xh=`uniform vec3 u_radiiAndDynamicAtmosphereColor;

uniform float u_atmosphereLightIntensity;
uniform float u_atmosphereRayleighScaleHeight;
uniform float u_atmosphereMieScaleHeight;
uniform float u_atmosphereMieAnisotropy;
uniform vec3 u_atmosphereRayleighCoefficient;
uniform vec3 u_atmosphereMieCoefficient;

const float ATMOSPHERE_THICKNESS = 111e3; // The thickness of the atmosphere in meters.
const int PRIMARY_STEPS_MAX = 16; // Maximum number of times the ray from the camera to the world position (primary ray) is sampled.
const int LIGHT_STEPS_MAX = 4; // Maximum number of times the light is sampled from the light source's intersection with the atmosphere to a sample position on the primary ray.

/**
 * This function computes the colors contributed by Rayliegh and Mie scattering on a given ray, as well as
 * the transmittance value for the ray.
 *
 * @param {czm_ray} primaryRay The ray from the camera to the position.
 * @param {float} primaryRayLength The length of the primary ray.
 * @param {vec3} lightDirection The direction of the light to calculate the scattering from.
 * @param {vec3} rayleighColor The variable the Rayleigh scattering will be written to.
 * @param {vec3} mieColor The variable the Mie scattering will be written to.
 * @param {float} opacity The variable the transmittance will be written to.
 * @glslFunction
 */
void computeScattering(
    czm_ray primaryRay,
    float primaryRayLength,
    vec3 lightDirection,
    float atmosphereInnerRadius,
    out vec3 rayleighColor,
    out vec3 mieColor,
    out float opacity
) {

    // Initialize the default scattering amounts to 0.
    rayleighColor = vec3(0.0);
    mieColor = vec3(0.0);
    opacity = 0.0;

    float atmosphereOuterRadius = atmosphereInnerRadius + ATMOSPHERE_THICKNESS;

    vec3 origin = vec3(0.0);

    // Calculate intersection from the camera to the outer ring of the atmosphere.
    czm_raySegment primaryRayAtmosphereIntersect = czm_raySphereIntersectionInterval(primaryRay, origin, atmosphereOuterRadius);

    // Return empty colors if no intersection with the atmosphere geometry.
    if (primaryRayAtmosphereIntersect == czm_emptyRaySegment) {
        return;
    }

    // To deal with smaller values of PRIMARY_STEPS (e.g. 4)
    // we implement a split strategy: sky or horizon.
    // For performance reasons, instead of a if/else branch
    // a soft choice is implemented through a weight 0.0 <= w_stop_gt_lprl <= 1.0
    float x = 1e-7 * primaryRayAtmosphereIntersect.stop / length(primaryRayLength);
    // Value close to 0.0: close to the horizon
    // Value close to 1.0: above in the sky
    float w_stop_gt_lprl = 0.5 * (1.0 + czm_approximateTanh(x));

    // The ray should start from the first intersection with the outer atmopshere, or from the camera position, if it is inside the atmosphere.
    float start_0 = primaryRayAtmosphereIntersect.start;
    primaryRayAtmosphereIntersect.start = max(primaryRayAtmosphereIntersect.start, 0.0);
    // The ray should end at the exit from the atmosphere or at the distance to the vertex, whichever is smaller.
    primaryRayAtmosphereIntersect.stop = min(primaryRayAtmosphereIntersect.stop, length(primaryRayLength));

    // For the number of ray steps, distinguish inside or outside atmosphere (outer space)
    // (1) from outer space we have to use more ray steps to get a realistic rendering
    // (2) within atmosphere we need fewer steps for faster rendering
    float x_o_a = start_0 - ATMOSPHERE_THICKNESS; // ATMOSPHERE_THICKNESS used as an ad-hoc constant, no precise meaning here, only the order of magnitude matters
    float w_inside_atmosphere = 1.0 - 0.5 * (1.0 + czm_approximateTanh(x_o_a));
    int PRIMARY_STEPS = PRIMARY_STEPS_MAX - int(w_inside_atmosphere * 12.0); // Number of times the ray from the camera to the world position (primary ray) is sampled.
    int LIGHT_STEPS = LIGHT_STEPS_MAX - int(w_inside_atmosphere * 2.0); // Number of times the light is sampled from the light source's intersection with the atmosphere to a sample position on the primary ray.

    // Setup for sampling positions along the ray - starting from the intersection with the outer ring of the atmosphere.
    float rayPositionLength = primaryRayAtmosphereIntersect.start;
    // (1) Outside the atmosphere: constant rayStepLength
    // (2) Inside atmosphere: variable rayStepLength to compensate the rough rendering of the smaller number of ray steps
    float totalRayLength = primaryRayAtmosphereIntersect.stop - rayPositionLength;
    float rayStepLengthIncrease = w_inside_atmosphere * ((1.0 - w_stop_gt_lprl) * totalRayLength / (float(PRIMARY_STEPS * (PRIMARY_STEPS + 1)) / 2.0));
    float rayStepLength = max(1.0 - w_inside_atmosphere, w_stop_gt_lprl) * totalRayLength / max(7.0 * w_inside_atmosphere, float(PRIMARY_STEPS));

    vec3 rayleighAccumulation = vec3(0.0);
    vec3 mieAccumulation = vec3(0.0);
    vec2 opticalDepth = vec2(0.0);
    vec2 heightScale = vec2(u_atmosphereRayleighScaleHeight, u_atmosphereMieScaleHeight);

    // Sample positions on the primary ray.
    for (int i = 0; i < PRIMARY_STEPS_MAX; ++i) {

        // The loop should be: for (int i = 0; i < PRIMARY_STEPS; ++i) {...} but WebGL1 cannot
        // loop with non-constant condition, so it has to break early instead
        if (i >= PRIMARY_STEPS) {
            break;
        }

        // Calculate sample position along viewpoint ray.
        vec3 samplePosition = primaryRay.origin + primaryRay.direction * (rayPositionLength + rayStepLength);

        // Calculate height of sample position above ellipsoid.
        float sampleHeight = length(samplePosition) - atmosphereInnerRadius;

        // Calculate and accumulate density of particles at the sample position.
        vec2 sampleDensity = exp(-sampleHeight / heightScale) * rayStepLength;
        opticalDepth += sampleDensity;

        // Generate ray from the sample position segment to the light source, up to the outer ring of the atmosphere.
        czm_ray lightRay = czm_ray(samplePosition, lightDirection);
        czm_raySegment lightRayAtmosphereIntersect = czm_raySphereIntersectionInterval(lightRay, origin, atmosphereOuterRadius);

        float lightStepLength = lightRayAtmosphereIntersect.stop / float(LIGHT_STEPS);
        float lightPositionLength = 0.0;

        vec2 lightOpticalDepth = vec2(0.0);

        // Sample positions along the light ray, to accumulate incidence of light on the latest sample segment.
        for (int j = 0; j < LIGHT_STEPS_MAX; ++j) {

            // The loop should be: for (int j = 0; i < LIGHT_STEPS; ++j) {...} but WebGL1 cannot
            // loop with non-constant condition, so it has to break early instead
            if (j >= LIGHT_STEPS) {
                break;
            }

            // Calculate sample position along light ray.
            vec3 lightPosition = samplePosition + lightDirection * (lightPositionLength + lightStepLength * 0.5);

            // Calculate height of the light sample position above ellipsoid.
            float lightHeight = length(lightPosition) - atmosphereInnerRadius;

            // Calculate density of photons at the light sample position.
            lightOpticalDepth += exp(-lightHeight / heightScale) * lightStepLength;

            // Increment distance on light ray.
            lightPositionLength += lightStepLength;
        }

        // Compute attenuation via the primary ray and the light ray.
        vec3 attenuation = exp(-((u_atmosphereMieCoefficient * (opticalDepth.y + lightOpticalDepth.y)) + (u_atmosphereRayleighCoefficient * (opticalDepth.x + lightOpticalDepth.x))));

        // Accumulate the scattering.
        rayleighAccumulation += sampleDensity.x * attenuation;
        mieAccumulation += sampleDensity.y * attenuation;

        // Increment distance on primary ray.
        rayPositionLength += (rayStepLength += rayStepLengthIncrease);
    }

    // Compute the scattering amount.
    rayleighColor = u_atmosphereRayleighCoefficient * rayleighAccumulation;
    mieColor = u_atmosphereMieCoefficient * mieAccumulation;

    // Compute the transmittance i.e. how much light is passing through the atmosphere.
    opacity = length(exp(-((u_atmosphereMieCoefficient * opticalDepth.y) + (u_atmosphereRayleighCoefficient * opticalDepth.x))));
}

vec4 computeAtmosphereColor(
    vec3 positionWC,
    vec3 lightDirection,
    vec3 rayleighColor,
    vec3 mieColor,
    float opacity
) {
    // Setup the primary ray: from the camera position to the vertex position.
    vec3 cameraToPositionWC = positionWC - czm_viewerPositionWC;
    vec3 cameraToPositionWCDirection = normalize(cameraToPositionWC);

    float cosAngle = dot(cameraToPositionWCDirection, lightDirection);
    float cosAngleSq = cosAngle * cosAngle;

    float G = u_atmosphereMieAnisotropy;
    float GSq = G * G;

    // The Rayleigh phase function.
    float rayleighPhase = 3.0 / (50.2654824574) * (1.0 + cosAngleSq);
    // The Mie phase function.
    float miePhase = 3.0 / (25.1327412287) * ((1.0 - GSq) * (cosAngleSq + 1.0)) / (pow(1.0 + GSq - 2.0 * cosAngle * G, 1.5) * (2.0 + GSq));

    // The final color is generated by combining the effects of the Rayleigh and Mie scattering.
    vec3 rayleigh = rayleighPhase * rayleighColor;
    vec3 mie = miePhase * mieColor;

    vec3 color = (rayleigh + mie) * u_atmosphereLightIntensity;

    return vec4(color, opacity);
}
`;var zN=`uniform samplerCube u_radianceMap;

in vec2 v_textureCoordinates;


const float twoSqrtPi = 2.0 * sqrt(czm_pi);

// Coutesy of https://www.ppsloan.org/publications/StupidSH36.pdf
float computeShBasis(int index, vec3 s) {
    if (index == 0) { // l = 0, m = 0
        return 1.0 / twoSqrtPi;
    }
    
    if (index == 1) { // l = 1, m = -1
        return -sqrt(3.0) * s.y / twoSqrtPi;
    }

    if (index == 2) { // l = 1, m = 0
        return sqrt(3.0) * s.z / twoSqrtPi;
    }

    if (index == 3) { // l = 1, m = 1
        return -sqrt(3.0) * s.x / twoSqrtPi;
    }

    if (index == 4) { // l = 2, m = -2
        return sqrt(15.0) * s.y * s.x / twoSqrtPi;
    }

    if (index == 5) { // l = 2, m = -1
        return -sqrt(15.0) * s.y * s.z / twoSqrtPi;
    }

    if (index == 6) { // l = 2, m = 0
        return sqrt(5.0) * (3.0 * s.z * s.z - 1.0) / 2.0 / twoSqrtPi;
    }

    if (index == 7) { // l = 2, m = 1
        return -sqrt(15.0) * s.x * s.z / twoSqrtPi;
    }

    if (index == 8) { // l = 2, m = 2
        return sqrt(15.0) * (s.x * s.x - s.y * s.y) / 2.0 / twoSqrtPi;
    }

    return 0.0;
}

float vdcRadicalInverse(int i)
{
    float r;
    float base = 2.0;
    float value = 0.0;
    float invBase = 1.0 / base;
    float invBi = invBase;
    for (int x = 0; x < 100; x++)
    {
        if (i <= 0)
        {
            break;
        }
        r = mod(float(i), base);
        value += r * invBi;
        invBi *= invBase;
        i = int(float(i) * invBase);
    }
    return value;
}

vec2 hammersley2D(int i, int N)
{
    return vec2(float(i) / float(N), vdcRadicalInverse(i));
}

// Sample count is relatively low for the sake of performance, but should still be enough to capture directionality needed for third-order harmonics
const int samples = 256; 
const float solidAngle = 1.0 / float(samples);

void main() {
    // Get the current coefficient based on the uv
   vec2 uv = v_textureCoordinates.xy * 3.0;
   int coefficientIndex = int(floor(uv.y) * 3.0 + floor(uv.x));

    for (int i = 0; i < samples; ++i) {
        vec2 xi = hammersley2D(i, samples);
        float phi = czm_twoPi * xi.x;
        float cosTheta = 1.0 - 2.0 * sqrt(1.0 - xi.y * xi.y);
        float sinTheta = sqrt(1.0 - cosTheta * cosTheta);
        vec3 direction = normalize(vec3(sinTheta * cos(phi), cosTheta, sinTheta * sin(phi)));

        // Generate the spherical harmonics basis from the direction
        float Ylm = computeShBasis(coefficientIndex, direction);

        vec3 lookupDirection = -direction.xyz;
        lookupDirection.z = -lookupDirection.z;

        vec4 color = czm_textureCube(u_radianceMap, lookupDirection, 0.0);

        // Use the relevant function for this coefficient
        out_FragColor += Ylm * color * solidAngle * sinTheta;
    }
    
}
`;var HN=`precision highp float;

in vec2 v_textureCoordinates;

uniform vec3 u_faceDirection; // Current cubemap face
uniform vec3 u_positionWC;
uniform mat4 u_enuToFixedFrame;
uniform vec4 u_brightnessSaturationGammaIntensity;
uniform vec4 u_groundColor; // alpha component represent albedo

vec4 getCubeMapDirection(vec2 uv, vec3 faceDir) {
    vec2 scaledUV = uv * 2.0 - 1.0;

    if (faceDir.x != 0.0) {
        return vec4(faceDir.x,  scaledUV.x * faceDir.x, -scaledUV.y, 0.0);
    } else if (faceDir.y != 0.0) {
        return vec4(scaledUV.x, -scaledUV.y * faceDir.y, faceDir.y, 0.0);
    } else {
        return vec4(scaledUV.x * faceDir.z, -faceDir.z, -scaledUV.y, 0.0); 
    }
}

void main() {    
    float height = length(u_positionWC);
    float atmosphereInnerRadius = u_radiiAndDynamicAtmosphereColor.y;
    float ellipsoidHeight = max(height - atmosphereInnerRadius, 0.0);

    // Scale the position to ensure the sky color is present, even when underground.
    vec3 positionWC = u_positionWC / height * (ellipsoidHeight + atmosphereInnerRadius);

    float atmosphereOuterRadius = u_radiiAndDynamicAtmosphereColor.x;
    float atmosphereHeight = atmosphereOuterRadius - atmosphereInnerRadius;

    vec3 direction = (u_enuToFixedFrame * getCubeMapDirection(v_textureCoordinates, u_faceDirection)).xyz;
    vec3 normalizedDirection = normalize(direction);

    czm_ray ray = czm_ray(positionWC, normalizedDirection);
    czm_raySegment intersection = czm_raySphereIntersectionInterval(ray, vec3(0.0), atmosphereInnerRadius);
    if (!czm_isEmpty(intersection)) {
        intersection = czm_rayEllipsoidIntersectionInterval(ray, vec3(0.0), czm_ellipsoidInverseRadii);
    }

    bool onEllipsoid = intersection.start >= 0.0;
    float rayLength = czm_branchFreeTernary(onEllipsoid, intersection.start, atmosphereOuterRadius);

    // Compute sky color for each position on a sphere at radius centered around the provided position's origin
    vec3 skyPositionWC = positionWC + normalizedDirection * rayLength;

    float lightEnum = u_radiiAndDynamicAtmosphereColor.z;
    vec3 lightDirectionWC = normalize(czm_getDynamicAtmosphereLightDirection(skyPositionWC, lightEnum));
    vec3 mieColor;
    vec3 rayleighColor;
    float opacity;
    czm_computeScattering(
        ray,
        rayLength,
        lightDirectionWC,
        atmosphereInnerRadius, 
        rayleighColor,
        mieColor,
        opacity
    );

    vec4 atmopshereColor = czm_computeAtmosphereColor(ray, lightDirectionWC, rayleighColor, mieColor, opacity);

#ifdef ATMOSPHERE_COLOR_CORRECT
    const bool ignoreBlackPixels = true;
    atmopshereColor.rgb = czm_applyHSBShift(atmopshereColor.rgb, czm_atmosphereHsbShift, ignoreBlackPixels);
#endif

    vec3 lookupDirection = -normalizedDirection;
     // Flipping the X vector is a cheap way to get the inverse of czm_temeToPseudoFixed, since that's a rotation about Z.
    lookupDirection.x = -lookupDirection.x;
    lookupDirection = -normalize(czm_temeToPseudoFixed * lookupDirection);
    lookupDirection.x = -lookupDirection.x;

    // Values outside the atmopshere are rendered as black, when they should be treated as transparent
    float skyAlpha = clamp((1.0 - ellipsoidHeight / atmosphereHeight) * atmopshereColor.a, 0.0, 1.0);
    skyAlpha = czm_branchFreeTernary(length(atmopshereColor.rgb) <= czm_epsilon7, 0.0, skyAlpha); // Treat black as transparent

    // Blend starmap with atmopshere scattering
    float intensity = u_brightnessSaturationGammaIntensity.w;
    vec4 sceneSkyBoxColor = czm_textureCube(czm_environmentMap, lookupDirection);
    vec3 skyBackgroundColor = mix(czm_backgroundColor.rgb, sceneSkyBoxColor.rgb, sceneSkyBoxColor.a);
    vec4 combinedSkyColor = vec4(mix(skyBackgroundColor, atmopshereColor.rgb * intensity, skyAlpha), 1.0);

    // Compute ground color based on amount of reflected light, then blend it with ground atmosphere based on height
    vec3 up = normalize(positionWC);
    float occlusion = max(dot(lightDirectionWC, up), 0.05);
    vec4 groundColor = vec4(u_groundColor.rgb * u_groundColor.a * (vec3(intensity * occlusion) + atmopshereColor.rgb), 1.0);
    vec4 blendedGroundColor = mix(groundColor, atmopshereColor, clamp(ellipsoidHeight / atmosphereHeight, 0.0, 1.0));

    vec4 color = czm_branchFreeTernary(onEllipsoid, blendedGroundColor, combinedSkyColor);

    float brightness = u_brightnessSaturationGammaIntensity.x;
    float saturation = u_brightnessSaturationGammaIntensity.y;
    float gamma = u_brightnessSaturationGammaIntensity.z;

#ifdef ENVIRONMENT_COLOR_CORRECT
    color.rgb = mix(vec3(0.0), color.rgb, brightness);
    color.rgb = czm_saturation(color.rgb, saturation);
#endif
    color.rgb = pow(color.rgb, vec3(gamma)); // Normally this would be in the ifdef above, but there is a precision issue with the atmopshere scattering transmittance (alpha). Having this line is a workaround for that issue, even when gamma is 1.0.
    color.rgb = czm_gammaCorrect(color.rgb);

    out_FragColor = color;
}
`;var GN=`precision highp float;

in vec3 v_textureCoordinates;

uniform float u_roughness;
uniform samplerCube u_radianceTexture;
uniform vec3 u_faceDirection;

float vdcRadicalInverse(int i)
{
    float r;
    float base = 2.0;
    float value = 0.0;
    float invBase = 1.0 / base;
    float invBi = invBase;
    for (int x = 0; x < 100; x++)
    {
        if (i <= 0)
        {
            break;
        }
        r = mod(float(i), base);
        value += r * invBi;
        invBi *= invBase;
        i = int(float(i) * invBase);
    }
    return value;
}

vec2 hammersley2D(int i, int N)
{
    return vec2(float(i) / float(N), vdcRadicalInverse(i));
}

vec3 importanceSampleGGX(vec2 xi, float alphaRoughness, vec3 N)
{
    float alphaRoughnessSquared = alphaRoughness * alphaRoughness;
    float phi = czm_twoPi * xi.x;
    float cosTheta = sqrt((1.0 - xi.y) / (1.0 + (alphaRoughnessSquared - 1.0) * xi.y));
    float sinTheta = sqrt(1.0 - cosTheta * cosTheta);
    vec3 H = vec3(sinTheta * cos(phi), sinTheta * sin(phi), cosTheta);
    vec3 upVector = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
    vec3 tangentX = normalize(cross(upVector, N));
    vec3 tangentY = cross(N, tangentX);
    return tangentX * H.x + tangentY * H.y + N * H.z;
}

// Sample count is relatively low for the sake of performance, but should still be enough to prevent artifacting in lower roughnesses
const int samples = 128;

void main() {
    vec3 normal = u_faceDirection;
    vec3 V = normalize(v_textureCoordinates);
    float roughness = u_roughness;

    vec4 color = vec4(0.0);
    float weight = 0.0;
    for (int i = 0; i < samples; ++i) {
            vec2 xi = hammersley2D(i, samples);
            vec3 H = importanceSampleGGX(xi, roughness, V);
            vec3 L = 2.0 * dot(V, H) * H - V; // reflected vector

            float NdotL = max(dot(V, L), 0.0);
            if (NdotL > 0.0) {
                color += vec4(texture(u_radianceTexture, L).rgb, 1.0) * NdotL;
                weight += NdotL;
            }
        }
    out_FragColor = color / weight;
}
`;var WN=`in vec3 position;
out vec3 v_textureCoordinates;

uniform vec3 u_faceDirection;

vec3 getCubeMapDirection(vec2 uv, vec3 faceDir) {
    vec2 scaledUV = uv;

    if (faceDir.x != 0.0) {
        return vec3(faceDir.x, scaledUV.y, scaledUV.x * faceDir.x);
    } else if (faceDir.y != 0.0) {
        return vec3(scaledUV.x, -faceDir.y, -scaledUV.y * faceDir.y);
    } else {
        return vec3(scaledUV.x * faceDir.z, scaledUV.y, -faceDir.z); 
    }
}

void main() 
{
    v_textureCoordinates = getCubeMapDirection(position.xy, u_faceDirection);
    v_textureCoordinates.y = -v_textureCoordinates.y;
    v_textureCoordinates.z = -v_textureCoordinates.z;
    gl_Position = vec4(position, 1.0);
}
`;function Ap(e){this._position=void 0,this._radianceMapDirty=!1,this._radianceCommandsDirty=!1,this._convolutionsCommandsDirty=!1,this._irradianceCommandDirty=!1,this._irradianceTextureDirty=!1,this._sphericalHarmonicCoefficientsDirty=!1,this._shouldRegenerateShaders=!1,e=x(e,x.EMPTY_OBJECT);let t=x(e.mipmapLevels,10);this._mipmapLevels=t,this._radianceMapComputeCommands=new Array(6),this._convolutionComputeCommands=new Array((t-1)*6),this._irradianceComputeCommand=void 0,this._radianceMapFS=void 0,this._irradianceMapFS=void 0,this._convolveSP=void 0,this._va=void 0,this._radianceMapTextures=new Array(6),this._specularMapTextures=new Array((t-1)*6),this._radianceCubeMap=void 0,this._irradianceMapTexture=void 0,this._sphericalHarmonicCoefficients=new Array(9),this._lastTime=new $;let n=Math.pow(2,t-1);this._textureDimensions=new H(n,n),this._radiiAndDynamicAtmosphereColor=new h,this._sceneEnvironmentMap=void 0,this._backgroundColor=void 0,this._owner=void 0,this.enabled=x(e.enabled,!0),this.shouldUpdate=!0,this.maximumSecondsDifference=x(e.maximumSecondsDifference,60*60),this.maximumPositionEpsilon=x(e.maximumPositionEpsilon,1e3),this.atmosphereScatteringIntensity=x(e.atmosphereScatteringIntensity,2),this.gamma=x(e.gamma,1),this.brightness=x(e.brightness,1),this.saturation=x(e.saturation,1),this.groundColor=x(e.groundColor,Ap.AVERAGE_EARTH_GROUND_COLOR),this.groundAlbedo=x(e.groundAlbedo,.31)}Object.defineProperties(Ap.prototype,{owner:{get:function(){return this._owner}},shouldRegenerateShaders:{get:function(){return this._shouldRegenerateShaders}},position:{get:function(){return this._position},set:function(e){h.equalsEpsilon(e,this._position,0,this.maximumPositionEpsilon)||(this._position=h.clone(e,this._position),this.reset())}},radianceCubeMap:{get:function(){return this._radianceCubeMap}},maximumMipmapLevel:{get:function(){return this._mipmapLevels}},sphericalHarmonicCoefficients:{get:function(){return this._sphericalHarmonicCoefficients}}});Ap.setOwner=function(e,t,n){e!==t[n]&&(t[n]=t[n]&&t[n].destroy(),u(e)&&(e._owner=t,t[n]=e))};Ap.prototype.reset=function(){let e=this._radianceMapComputeCommands.length;for(let t=0;t<e;++t)this._radianceMapComputeCommands[t]=void 0;e=this._convolutionComputeCommands.length;for(let t=0;t<e;++t)this._convolutionComputeCommands[t]=void 0;u(this._irradianceComputeCommand)&&(this._irradianceComputeCommand=void 0),this._radianceMapDirty=!0,this._radianceCommandsDirty=!0};var yze=new h,xze=new h;function bze(e,t){let n=e._position,i=t.atmosphere,o=t.mapProjection.ellipsoid,r=o.scaleToGeodeticSurface(n,xze),s=1.025,a=yze,c=u(r)?h.magnitude(r):o.maximumRadius;return a.x=c*s,a.y=c,a.z=i.dynamicLighting,!h.equalsEpsilon(e._radiiAndDynamicAtmosphereColor,a)||t.environmentMap!==e._sceneEnvironmentMap||t.backgroundColor!==e._backgroundColor?(h.clone(a,e._radiiAndDynamicAtmosphereColor),e._sceneEnvironmentMap=t.environmentMap,e._backgroundColor=t.backgroundColor,!0):!1}var rre=new h,Cze=new F,Aze=new oe,Tze=new G;function Eze(e,t){let n=t.context,i=e._textureDimensions;if(u(e._radianceCubeMap)||(e._radianceCubeMap=new Or({context:n,width:i.x,height:i.y,pixelDatatype:Ke.UNSIGNED_BYTE,pixelFormat:tt.RGBA})),e._radianceCommandsDirty){let o=e._radianceMapFS;u(o)||(o=new ze({sources:[Xh,HN]}),e._radianceMapFS=o),AA.requiresColorCorrect(t.atmosphere)&&o.defines.push("ATMOSPHERE_COLOR_CORRECT");let r=e._position,s=e._radiiAndDynamicAtmosphereColor,a=t.mapProjection.ellipsoid,c=Lt.eastNorthUpToFixedFrame(r,a,Cze),l=Aze;l.x=e.brightness,l.y=e.saturation,l.z=e.gamma,l.w=e.atmosphereScatteringIntensity,(e.brightness!==1||e.saturation!==1||e.gamma!==1)&&o.defines.push("ENVIRONMENT_COLOR_CORRECT");let f=0;for(let d of Or.faceNames()){let p=e._radianceMapTextures[f];u(p)&&p.destroy(),p=new Ot({context:n,width:i.x,height:i.y,pixelDatatype:Ke.UNSIGNED_BYTE,pixelFormat:tt.RGBA}),e._radianceMapTextures[f]=p;let g=f,m=new cl({fragmentShaderSource:o,outputTexture:p,uniformMap:{u_radiiAndDynamicAtmosphereColor:()=>s,u_enuToFixedFrame:()=>c,u_faceDirection:()=>Or.getDirection(d,rre),u_positionWC:()=>r,u_brightnessSaturationGammaIntensity:()=>l,u_groundColor:()=>e.groundColor.withAlpha(e.groundAlbedo,Tze)},persists:!0,owner:e,postExecute:()=>{let y=e._radianceMapComputeCommands;if(!u(y[g]))return;y[g]=void 0;let b=new Hr({context:n,colorTextures:[e._radianceMapTextures[g]],destroyAttachments:!1});b._bind(),e._radianceCubeMap[d].copyFromFramebuffer(),b._unBind(),b.destroy(),y.some(u)||(e._convolutionsCommandsDirty=!0,e._shouldRegenerateShaders=!0)}});t.commandList.push(m),e._radianceMapComputeCommands[f]=m,f++}e._radianceCommandsDirty=!1}}function Sze(e,t){let n=e._radianceCubeMap;n.generateMipmap();let i=e._mipmapLevels,o=e._textureDimensions,r=o.x/2,s=o.y/2,a=t.context,c=0,l=(d,p,g,m)=>()=>{let y=e._convolutionComputeCommands;u(y[d])&&(y[d]=void 0,n.copyFace(t,p,g,m),c++,c===e._specularMapTextures.length&&(e._irradianceCommandDirty=!0,n.sampler=new Qt({minificationFilter:$t.LINEAR_MIPMAP_LINEAR}),e._shouldRegenerateShaders=!0))},f=0;for(let d=1;d<i;++d){for(let p of Or.faceNames()){let g=e._specularMapTextures[f]=new Ot({context:a,width:r,height:s,pixelDatatype:Ke.UNSIGNED_BYTE,pixelFormat:tt.RGBA}),m=e._va;u(m)||(m=Or.createVertexArray(a,p),e._va=m);let y=e._convolveSP;u(y)||(y=tn.fromCache({context:a,vertexShaderSource:WN,fragmentShaderSource:GN,attributeLocations:{positions:0}}),e._convolveSP=y);let b=new cl({shaderProgram:y,vertexArray:m,outputTexture:g,persists:!0,owner:e,uniformMap:{u_roughness:()=>d/(i-1),u_radianceTexture:()=>n,u_faceDirection:()=>Or.getDirection(p,rre)},postExecute:l(f,g,p,d)});e._convolutionComputeCommands[f]=b,t.commandList.push(b),++f}r/=2,s/=2}}var sre=new H(3,3);function vze(e,t){let n=t.context,i=sre,o=e._irradianceMapTexture;u(o)||(o=new Ot({context:n,width:i.x,height:i.y,pixelDatatype:Ke.FLOAT,pixelFormat:tt.RGBA}),e._irradianceMapTexture=o);let r=e._irradianceMapFS;u(r)||(r=new ze({sources:[zN]}),e._irradianceMapFS=r);let s=new cl({fragmentShaderSource:r,outputTexture:o,uniformMap:{u_radianceMap:()=>e._radianceCubeMap},postExecute:()=>{u(e._irradianceComputeCommand)&&(e._irradianceTextureDirty=!1,e._irradianceComputeCommand=void 0,e._sphericalHarmonicCoefficientsDirty=!0)}});e._irradianceComputeCommand=s,t.commandList.push(s),e._irradianceTextureDirty=!0}function wze(e,t){let n=t.context,i=new Hr({context:n,colorTextures:[e._irradianceMapTexture],destroyAttachments:!1}),o=sre,r=n.readPixels({x:0,y:0,width:o.x,height:o.y,framebuffer:i});for(let s=0;s<9;++s)e._sphericalHarmonicCoefficients[s]=h.unpack(r,s*4),h.multiplyByScalar(e._sphericalHarmonicCoefficients[s],e.atmosphereScatteringIntensity,e._sphericalHarmonicCoefficients[s]);i.destroy(),e._shouldRegenerateShaders=!0}Ap.prototype.update=function(e){let t=e.mode;if(!this.enabled||!this.shouldUpdate||!u(this._position)||t===ne.MORPHING){this._shouldRegenerateShaders=!1;return}let n=e.atmosphere.dynamicLighting;if((bze(this,e)||n===Tg.SUNLIGHT&&!$.equalsEpsilon(e.time,this._lastTime,this.maximumSecondsDifference))&&(this.reset(),this._lastTime=$.clone(e.time,this._lastTime)),this._radianceMapDirty&&(Eze(this,e),this._radianceMapDirty=!1),this._convolutionsCommandsDirty&&(Sze(this,e),this._convolutionsCommandsDirty=!1),this._irradianceCommandDirty&&(vze(this,e),this._irradianceCommandDirty=!1),this._irradianceTextureDirty){this._shouldRegenerateShaders=!1;return}if(this._sphericalHarmonicCoefficientsDirty){wze(this,e),this._sphericalHarmonicCoefficientsDirty=!1;return}this._shouldRegenerateShaders=!1};Ap.prototype.isDestroyed=function(){return!1};Ap.prototype.destroy=function(){let e=this._radianceMapComputeCommands.length;for(let t=0;t<e;++t)this._radianceMapComputeCommands[t]=void 0;e=this._convolutionComputeCommands.length;for(let t=0;t<e;++t)this._convolutionComputeCommands[t]=void 0;this._irradianceMapComputeCommand=void 0,e=this._radianceMapTextures.length;for(let t=0;t<e;++t)this._radianceMapTextures[t]=this._radianceMapTextures[t]&&this._radianceMapTextures[t].destroy();e=this._specularMapTextures.length;for(let t=0;t<e;++t)this._specularMapTextures[t]=this._specularMapTextures[t]&&this._specularMapTextures[t].destroy();return this._radianceCubeMap=this._radianceCubeMap&&this._radianceCubeMap.destroy(),this._irradianceMapTexture=this._irradianceMapTexture&&this._irradianceMapTexture.destroy(),ue(this)};Ap.AVERAGE_EARTH_GROUND_COLOR=Object.freeze(G.fromCssColorString("#717145"));var Eg=Ap;var fw={HIGHLIGHT:0,REPLACE:1,MIX:2};fw.getColorBlend=function(e,t){if(e===fw.HIGHLIGHT)return 0;if(e===fw.REPLACE)return 1;if(e===fw.MIX)return R.clamp(t,R.EPSILON4,1)};var Bc=Object.freeze(fw);var Dze={XTRANSLATE:"xTranslate",YTRANSLATE:"yTranslate",ZTRANSLATE:"zTranslate",XROTATE:"xRotate",YROTATE:"yRotate",ZROTATE:"zRotate",XSCALE:"xScale",YSCALE:"yScale",ZSCALE:"zScale",UNIFORMSCALE:"uniformScale"},kc=Object.freeze(Dze);var Ize={STEP:0,LINEAR:1,CUBICSPLINE:2},Kh=Object.freeze(Ize);var are={};function dw(e){this._count=e.count,this._properties=Ge(e.properties,!0)}dw.prototype.hasProperty=function(e){return Bn.hasProperty(e,this._properties,are)};dw.prototype.getPropertyIds=function(e){return Bn.getPropertyIds(this._properties,are,e)};dw.prototype.getProperty=function(e,t){let n=this._properties[t];if(u(n))return Ge(n[e],!0)};dw.prototype.setProperty=function(e,t,n){let i=this._properties[t];u(i)||(i=new Array(this._count),this._properties[t]=i),i[e]=Ge(n,!0)};var Sg=dw;function tc(e){e=x(e,x.EMPTY_OBJECT),this._name=e.name,this._id=e.id,this._count=e.count,this._extras=e.extras,this._extensions=e.extensions,this._metadataTable=e.metadataTable,this._jsonMetadataTable=e.jsonMetadataTable,this._batchTableHierarchy=e.batchTableHierarchy}Object.defineProperties(tc.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},count:{get:function(){return this._count}},class:{get:function(){if(u(this._metadataTable))return this._metadataTable.class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}},byteLength:{get:function(){let e=0;return u(this._metadataTable)&&(e+=this._metadataTable.byteLength),u(this._batchTableHierarchy)&&(e+=this._batchTableHierarchy.byteLength),e}}});tc.prototype.hasProperty=function(e,t){return!!(u(this._metadataTable)&&this._metadataTable.hasProperty(t)||u(this._batchTableHierarchy)&&this._batchTableHierarchy.hasProperty(e,t)||u(this._jsonMetadataTable)&&this._jsonMetadataTable.hasProperty(t))};tc.prototype.hasPropertyBySemantic=function(e,t){return u(this._metadataTable)?this._metadataTable.hasPropertyBySemantic(t):!1};tc.prototype.propertyExists=function(e){return!!(u(this._metadataTable)&&this._metadataTable.hasProperty(e)||u(this._batchTableHierarchy)&&this._batchTableHierarchy.propertyExists(e)||u(this._jsonMetadataTable)&&this._jsonMetadataTable.hasProperty(e))};tc.prototype.propertyExistsBySemantic=function(e){return u(this._metadataTable)?this._metadataTable.hasPropertyBySemantic(e):!1};var IW=[];tc.prototype.getPropertyIds=function(e,t){return t=u(t)?t:[],t.length=0,u(this._metadataTable)&&t.push.apply(t,this._metadataTable.getPropertyIds(IW)),u(this._batchTableHierarchy)&&t.push.apply(t,this._batchTableHierarchy.getPropertyIds(e,IW)),u(this._jsonMetadataTable)&&t.push.apply(t,this._jsonMetadataTable.getPropertyIds(IW)),t};tc.prototype.getProperty=function(e,t){let n;if(u(this._metadataTable)&&(n=this._metadataTable.getProperty(e,t),u(n))||u(this._batchTableHierarchy)&&(n=this._batchTableHierarchy.getProperty(e,t),u(n))||u(this._jsonMetadataTable)&&(n=this._jsonMetadataTable.getProperty(e,t),u(n)))return n};tc.prototype.setProperty=function(e,t,n){u(this._metadataTable)&&this._metadataTable.setProperty(e,t,n)||u(this._batchTableHierarchy)&&this._batchTableHierarchy.setProperty(e,t,n)||(u(this._jsonMetadataTable)||(this._jsonMetadataTable=new Sg({count:this._count,properties:{}})),this._jsonMetadataTable.setProperty(e,t,n))};tc.prototype.getPropertyBySemantic=function(e,t){if(u(this._metadataTable))return this._metadataTable.getPropertyBySemantic(e,t)};tc.prototype.setPropertyBySemantic=function(e,t,n){return u(this._metadataTable)?this._metadataTable.setPropertyBySemantic(e,t,n):!1};tc.prototype.getPropertyTypedArray=function(e){if(u(this._metadataTable))return this._metadataTable.getPropertyTypedArray(e)};tc.prototype.getPropertyTypedArrayBySemantic=function(e){if(u(this._metadataTable))return this._metadataTable.getPropertyTypedArrayBySemantic(e)};tc.prototype.isClass=function(e,t){let n=this._batchTableHierarchy;return u(n)?n.isClass(e,t):!1};tc.prototype.isExactClass=function(e,t){return this.getExactClassName(e)===t};tc.prototype.getExactClassName=function(e){let t=this._batchTableHierarchy;if(u(t))return t.getClassName(e)};var Cl=tc;function hw(e){e=x(e,x.EMPTY_OBJECT);let t=e.property,n=e.classProperty,i=e.textures,o=u(t.channels)?t.channels:[0],r=t,s=su.createModelTextureReader({textureInfo:r,channels:Oze(o),texture:i[r.index]});this._min=t.min,this._max=t.max;let a=t.offset,c=t.scale,l=n.hasValueTransform||u(a)||u(c);a=x(a,n.offset),c=x(c,n.scale),a=n.unpackVectorAndMatrixTypes(a),c=n.unpackVectorAndMatrixTypes(c),this._offset=a,this._scale=c,this._hasValueTransform=l,this._textureReader=s,this._classProperty=n,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(hw.prototype,{textureReader:{get:function(){return this._textureReader}},hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},classProperty:{get:function(){return this._classProperty}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});hw.prototype.isGpuCompatible=function(){let e=this._classProperty,t=e.type,n=e.componentType;return e.isArray?e.isVariableLengthArray?(At(`Property texture property ${e.id} is a variable-length array, which is not supported`),!1):e.arrayLength>4?(At(`Property texture property ${e.id} is an array of length ${e.arrayLength}, but may have at most a length of 4`),!1):t!==Et.SCALAR?(At(`Property texture property ${e.id} is an array of type ${t}, but only SCALAR is supported`),!1):n!==Gt.UINT8?(At(`Property texture property ${e.id} is an array with component type ${n}, but only UINT8 is supported`),!1):!0:Et.isVectorType(t)||t===Et.SCALAR?n!==Gt.UINT8?(At(`Property texture property ${e.id} has component type ${n}, but only UINT8 is supported`),!1):!0:(At(`Property texture property ${e.id} has an unsupported type`),!1)};var Pze=[void 0,"float","vec2","vec3","vec4"],Rze=[void 0,"int","ivec2","ivec3","ivec4"];hw.prototype.getGlslType=function(){let e=this._classProperty,t=Et.getComponentCount(e.type);return e.isArray&&(t=e.arrayLength),e.normalized?Pze[t]:Rze[t]};hw.prototype.unpackInShader=function(e){return this._classProperty.normalized?e:`${this.getGlslType()}(255.0 * ${e})`};function Oze(e){return e.map(function(t){return"rgba".charAt(t)}).join("")}var jN=hw;function PW(e){e=x(e,x.EMPTY_OBJECT);let t=e.propertyTexture,n=e.class,i=e.textures,o=t.extensions,r=t.extras,s={};if(u(t.properties))for(let a in t.properties)t.properties.hasOwnProperty(a)&&(s[a]=new jN({property:t.properties[a],classProperty:n.properties[a],textures:i}));this._name=e.name,this._id=e.id,this._class=n,this._properties=s,this._extras=r,this._extensions=o}Object.defineProperties(PW.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},class:{get:function(){return this._class}},properties:{get:function(){return this._properties}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});PW.prototype.getProperty=function(e){return this._properties[e]};var vg=PW;function cre(e){e=x(e,x.EMPTY_OBJECT);let t=e.property,n=e.classProperty;this._attribute=t.attribute,this._classProperty=n,this._min=t.min,this._max=t.max;let i=t.offset,o=t.scale,r=n.hasValueTransform||u(i)||u(o);i=x(i,n.offset),o=x(o,n.scale),i=n.unpackVectorAndMatrixTypes(i),o=n.unpackVectorAndMatrixTypes(o),this._offset=i,this._scale=o,this._hasValueTransform=r,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(cre.prototype,{attribute:{get:function(){return this._attribute}},hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},classProperty:{get:function(){return this._classProperty}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});var qN=cre;function RW(e){e=x(e,x.EMPTY_OBJECT);let t=e.propertyAttribute,n=e.class,i={};if(u(t.properties))for(let o in t.properties)t.properties.hasOwnProperty(o)&&(i[o]=new qN({property:t.properties[o],classProperty:n.properties[o]}));this._name=e.name,this._id=e.id,this._class=n,this._properties=i,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(RW.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},class:{get:function(){return this._class}},properties:{get:function(){return this._properties}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});RW.prototype.getProperty=function(e){return this._properties[e]};var TA=RW;function mw(e){e=x(e,x.EMPTY_OBJECT),this._schema=e.schema;let t=e.propertyTables;this._propertyTableCount=u(t)?t.length:0,this._propertyTables=t,this._propertyTextures=e.propertyTextures,this._propertyAttributes=e.propertyAttributes,this._statistics=e.statistics,this._extras=e.extras,this._extensions=e.extensions}Object.defineProperties(mw.prototype,{schema:{get:function(){return this._schema}},statistics:{get:function(){return this._statistics}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}},propertyTableCount:{get:function(){return this._propertyTableCount}},propertyTables:{get:function(){return this._propertyTables}},propertyTextures:{get:function(){return this._propertyTextures}},propertyAttributes:{get:function(){return this._propertyAttributes}},propertyTablesByteLength:{get:function(){if(!u(this._propertyTables))return 0;let e=0,t=this._propertyTables.length;for(let n=0;n<t;n++)e+=this._propertyTables[n].byteLength;return e}}});mw.prototype.getPropertyTable=function(e){return this._propertyTables[e]};mw.prototype.getPropertyTexture=function(e){return this._propertyTextures[e]};mw.prototype.getPropertyAttribute=function(e){return this._propertyAttributes[e]};var oa=mw;function Mze(e){e=x(e,x.EMPTY_OBJECT);let t=e.extension,n=e.schema,i=[];if(u(t.propertyTables))for(let s=0;s<t.propertyTables.length;s++){let a=t.propertyTables[s],c=n.classes[a.class],l=new ou({count:a.count,properties:a.properties,class:c,bufferViews:e.bufferViews});i.push(new Cl({id:s,name:a.name,count:a.count,metadataTable:l,extras:a.extras,extensions:a.extensions}))}let o=[];if(u(t.propertyTextures))for(let s=0;s<t.propertyTextures.length;s++){let a=t.propertyTextures[s];o.push(new vg({id:s,name:a.name,propertyTexture:a,class:n.classes[a.class],textures:e.textures}))}let r=[];if(u(t.propertyAttributes))for(let s=0;s<t.propertyAttributes.length;s++){let a=t.propertyAttributes[s];r.push(new TA({id:s,name:a.name,class:n.classes[a.class],propertyAttribute:a}))}return new oa({schema:n,propertyTables:i,propertyTextures:o,propertyAttributes:r,statistics:t.statistics,extras:t.extras,extensions:t.extensions})}var YN=Mze;function Lze(e){e=x(e,x.EMPTY_OBJECT);let t=e.extension,n=e.schema,i,o=[],r;if(u(t.featureTables))for(r=Object.keys(t.featureTables).sort(),i=0;i<r.length;i++){let a=r[i],c=t.featureTables[a],l=n.classes[c.class],f=new ou({count:c.count,properties:c.properties,class:l,bufferViews:e.bufferViews});o.push(new Cl({id:a,count:c.count,metadataTable:f,extras:c.extras,extensions:c.extensions}))}let s=[];if(u(t.featureTextures))for(r=Object.keys(t.featureTextures).sort(),i=0;i<r.length;i++){let a=r[i],c=t.featureTextures[a];s.push(new vg({id:a,propertyTexture:Nze(c),class:n.classes[c.class],textures:e.textures}))}return new oa({schema:n,propertyTables:o,propertyTextures:s,statistics:t.statistics,extras:t.extras,extensions:t.extensions})}function Nze(e){let t={class:e.class,properties:{}},n=e.properties;for(let i in n)if(n.hasOwnProperty(i)){let o=n[i],r={channels:Fze(o.channels),extras:o.extras,extensions:o.extensions};t.properties[i]=bt(o.texture,r,!0)}return t}function Fze(e){let t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]="rgba".indexOf(e[i]);return n}var XN=Lze;function wg(e){e=x(e,x.EMPTY_OBJECT);let{gltf:t,extension:n,extensionLegacy:i,gltfResource:o,baseResource:r,supportedImageFormats:s,frameState:a,cacheKey:c,asynchronous:l=!0}=e;this._gltfResource=o,this._baseResource=r,this._gltf=t,this._extension=n,this._extensionLegacy=i,this._supportedImageFormats=s,this._frameState=a,this._cacheKey=c,this._asynchronous=l,this._bufferViewLoaders=[],this._bufferViewIds=[],this._textureLoaders=[],this._textureIds=[],this._schemaLoader=void 0,this._structuralMetadata=void 0,this._state=_t.UNLOADED,this._promise=void 0}u(Object.create)&&(wg.prototype=Object.create(Qi.prototype),wg.prototype.constructor=wg);Object.defineProperties(wg.prototype,{cacheKey:{get:function(){return this._cacheKey}},structuralMetadata:{get:function(){return this._structuralMetadata}}});async function Bze(e){try{let t=Hze(e),n=Yze(e),i=Xze(e);return await Promise.all([t,n,i]),e.isDestroyed()?void 0:(e._gltf=void 0,e._state=_t.LOADED,e)}catch(t){if(e.isDestroyed())return;throw e.unload(),e._state=_t.FAILED,e.getError("Failed to load structural metadata",t)}}wg.prototype.load=function(){return u(this._promise)?this._promise:(this._state=_t.LOADING,this._promise=Bze(this),this._promise)};function kze(e,t){for(let n in e)if(e.hasOwnProperty(n)){let i=e[n],o=i.values,r=i.arrayOffsets,s=i.stringOffsets;u(o)&&(t[o]=!0),u(r)&&(t[r]=!0),u(s)&&(t[s]=!0)}}function Vze(e,t){for(let n in e)if(e.hasOwnProperty(n)){let i=e[n],o=i.bufferView,r=i.arrayOffsetBufferView,s=i.stringOffsetBufferView;u(o)&&(t[o]=!0),u(r)&&(t[r]=!0),u(s)&&(t[s]=!0)}}function Uze(e){let t=e.propertyTables,n={};if(u(t))for(let i=0;i<t.length;i++){let o=t[i];kze(o.properties,n)}return n}function zze(e){let t=e.featureTables,n={};if(u(t)){for(let i in t)if(t.hasOwnProperty(i)){let r=t[i].properties;u(r)&&Vze(r,n)}}return n}async function Hze(e){let t;u(e._extension)?t=Uze(e._extension):t=zze(e._extensionLegacy);let n=[];for(let i in t)if(t.hasOwnProperty(i)){let o=wi.getBufferViewLoader({gltf:e._gltf,bufferViewId:parseInt(i),gltfResource:e._gltfResource,baseResource:e._baseResource});e._bufferViewLoaders.push(o),e._bufferViewIds.push(i),n.push(o.load())}return Promise.all(n)}function Gze(e){let t={},n=e.propertyTextures;if(u(n))for(let i=0;i<n.length;i++){let r=n[i].properties;u(r)&&Wze(r,t)}return t}function Wze(e,t){for(let n in e)if(e.hasOwnProperty(n)){let i=e[n];t[i.index]=i}}function jze(e){let t={},n=e.featureTextures;if(u(n)){for(let i in n)if(n.hasOwnProperty(i)){let r=n[i].properties;u(r)&&qze(r,t)}}return t}function qze(e,t){for(let n in e)if(e.hasOwnProperty(n)){let o=e[n].texture;t[o.index]=o}}function Yze(e){let t;u(e._extension)?t=Gze(e._extension):t=jze(e._extensionLegacy);let n=e._gltf,i=e._gltfResource,o=e._baseResource,r=e._supportedImageFormats,s=e._frameState,a=e._asynchronous,c=[];for(let l in t)if(t.hasOwnProperty(l)){let f=wi.getTextureLoader({gltf:n,textureInfo:t[l],gltfResource:i,baseResource:o,supportedImageFormats:r,frameState:s,asynchronous:a});e._textureLoaders.push(f),e._textureIds.push(l),c.push(f.load())}return Promise.all(c)}async function Xze(e){let t=x(e._extension,e._extensionLegacy),n;if(u(t.schemaUri)){let i=e._baseResource.getDerivedResource({url:t.schemaUri});n=wi.getSchemaLoader({resource:i})}else n=wi.getSchemaLoader({schema:t.schema});if(e._schemaLoader=n,await n.load(),!n.isDestroyed())return n.schema}wg.prototype.process=function(e){if(this._state===_t.READY)return!0;if(this._state!==_t.LOADED)return!1;let t=this._textureLoaders,n=t.length,i=!0;for(let a=0;a<n;++a){let l=t[a].process(e);i=i&&l}if(!i)return!1;let o=this._schemaLoader.schema,r={};for(let a=0;a<this._bufferViewIds.length;++a){let c=this._bufferViewIds[a],l=this._bufferViewLoaders[a];if(!l.isDestroyed()){let f=new Uint8Array(l.typedArray);r[c]=f}}let s={};for(let a=0;a<this._textureIds.length;++a){let c=this._textureIds[a],l=t[a];l.isDestroyed()||(s[c]=l.texture)}return u(this._extension)?this._structuralMetadata=YN({extension:this._extension,schema:o,bufferViews:r,textures:s}):this._structuralMetadata=XN({extension:this._extensionLegacy,schema:o,bufferViews:r,textures:s}),lre(this),this._state=_t.READY,!0};function lre(e){let t=e._bufferViewLoaders,n=t.length;for(let i=0;i<n;++i)wi.unload(t[i]);e._bufferViewLoaders.length=0,e._bufferViewIds.length=0}function Kze(e){let t=e._textureLoaders,n=t.length;for(let i=0;i<n;++i)wi.unload(t[i]);e._textureLoaders.length=0,e._textureIds.length=0}wg.prototype.unload=function(){lre(this),Kze(this),u(this._schemaLoader)&&wi.unload(this._schemaLoader),this._schemaLoader=void 0,this._structuralMetadata=void 0};var KN=wg;var EA={TRANSLATION:"TRANSLATION",ROTATION:"ROTATION",SCALE:"SCALE",FEATURE_ID:"_FEATURE_ID"};EA.fromGltfSemantic=function(e){let t=e,i=/^(\w+)_\d+$/.exec(e);switch(i!==null&&(t=i[1]),t){case"TRANSLATION":return EA.TRANSLATION;case"ROTATION":return EA.ROTATION;case"SCALE":return EA.SCALE;case"_FEATURE_ID":return EA.FEATURE_ID}};var as=Object.freeze(EA);var Zze=65534,$ze=255;function ZN(e){e=x(e,x.EMPTY_OBJECT);let t=e.triangleIndices,n=e.outlineIndices,i=e.originalVertexCount;this._triangleIndices=t,this._originalVertexCount=i,this._edges=new dre(n,i),this._outlineCoordinatesTypedArray=void 0,this._extraVertices=[],Qze(this)}Object.defineProperties(ZN.prototype,{updatedTriangleIndices:{get:function(){return this._triangleIndices}},outlineCoordinates:{get:function(){return this._outlineCoordinatesTypedArray}}});function Qze(e){let t=e._triangleIndices,n=e._edges,i=[],o=e._extraVertices,r=e._originalVertexCount,s={};for(let a=0;a<t.length;a+=3){let c=t[a],l=t[a+1],f=t[a+2],d=!1,p=d||n.hasEdge(c,l),g=d||n.hasEdge(l,f),m=d||n.hasEdge(f,c),y=ure(i,c,l,f,p,g,m);for(;u(y);){let b=s[y];if(!u(b)){b=r+o.length;let C=y;for(;C>=r;)C=o[C-r];o.push(C),s[y]=b}b>Zze&&(t instanceof Uint16Array||t instanceof Uint8Array)?t=new Uint32Array(t):b>$ze&&t instanceof Uint8Array&&(t=new Uint16Array(t)),y===c?(c=b,t[a]=b):y===l?(l=b,t[a+1]=b):(f=b,t[a+2]=b),y=ure(i,c,l,f,p,g,m)}}e._triangleIndices=t,e._outlineCoordinatesTypedArray=new Float32Array(i)}function ure(e,t,n,i,o,r,s){let a=s?1:0,c=o?1:0,l=0,f=OW(e,t,a,c,l);if(f===0)return t;let d=0,p=o?1:0,g=r?1:0,m=OW(e,n,d,p,g);if(m===0)return n;let y=s?1:0,b=0,C=r?1:0,A=OW(e,i,y,b,C);if(A===0)return i;let T=f&m&A,E,v,D;if(T&1)E=0,v=1,D=2;else if(T&2)E=0,D=1,v=2;else if(T&4)v=0,E=1,D=2;else if(T&8)v=0,D=1,E=2;else if(T&16)D=0,E=1,v=2;else if(T&32)D=0,v=1,E=2;else{let L=MW(f),_=MW(m),S=MW(A);return L<_&&L<S?t:_<S?n:i}let O=t*3;e[O+E]=a,e[O+v]=c,e[O+D]=l;let P=n*3;e[P+E]=d,e[P+v]=p,e[P+D]=g;let M=i*3;e[M+E]=y,e[M+v]=b,e[M+D]=C}function OW(e,t,n,i,o){let r=t*3,s=e[r],a=e[r+1],c=e[r+2];return u(s)?(s===n&&a===i&&c===o)<<0|(s===n&&a===o&&c===i)<<1|(s===i&&a===n&&c===o)<<2|(s===i&&a===o&&c===n)<<3|(s===o&&a===n&&c===i)<<4|(s===o&&a===i&&c===n)<<5:63}function MW(e){return(e&1)+(e>>1&1)+(e>>2&1)+(e>>3&1)+(e>>4&1)+(e>>5&1)}ZN.prototype.updateAttribute=function(e){let t=this._extraVertices,n=e.length,i=n/this._originalVertexCount,o=t.length,r=e.constructor,s=new r(e.length+o*i);s.set(e);for(let a=0;a<o;a++){let c=t[a]*i,l=n+a*i;for(let f=0;f<i;f++)s[l+f]=s[c+f]}return s};ZN.createTexture=function(e){let t=e.cache.modelOutliningCache;if(u(t)||(t=e.cache.modelOutliningCache={}),u(t.outlineTexture))return t.outlineTexture;let n=Math.min(4096,Vt.maximumTextureSize),i=n,o=fre(i),r=[];for(;i>1;)i>>=1,r.push(fre(i));let s=new Ot({context:e,source:{arrayBufferView:o,mipLevels:r},width:n,height:1,pixelFormat:tt.LUMINANCE,sampler:new Qt({wrapS:En.CLAMP_TO_EDGE,wrapT:En.CLAMP_TO_EDGE,minificationFilter:$t.LINEAR_MIPMAP_LINEAR,magnificationFilter:mi.LINEAR})});return t.outlineTexture=s,s};function fre(e){let t=new Uint8Array(e);return t[e-1]=192,e===8?t[e-1]=96:e===4?t[e-1]=48:e===2?t[e-1]=24:e===1&&(t[e-1]=12),t}function dre(e,t){this._originalVertexCount=t,this._edges=new Set;for(let n=0;n<e.length;n+=2){let i=e[n],o=e[n+1],r=Math.min(i,o),s=Math.max(i,o),a=r*this._originalVertexCount+s;this._edges.add(a)}}dre.prototype.hasEdge=function(e,t){let n=Math.min(e,t),i=Math.max(e,t),o=n*this._originalVertexCount+i;return this._edges.has(o)};var SA=ZN;function hre(e){this.attribute=e,this.loadBuffer=!1,this.loadTypedArray=!1}function Jze(e){this.indices=e,this.loadBuffer=!1,this.loadTypedArray=!1}function $N(e){this.primitive=e,this.attributePlans=[],this.indicesPlan=void 0,this.needsOutlines=!1,this.outlineIndices=void 0}$N.prototype.postProcess=function(e){this.needsOutlines&&(e8e(this),n8e(this,e))};function e8e(e){let t=e.primitive,n=t.indices,i=t.attributes[0].count,o=new SA({triangleIndices:n.typedArray,outlineIndices:e.outlineIndices,originalVertexCount:i});n.typedArray=o.updatedTriangleIndices,n.indexDatatype=Be.fromTypedArray(n.typedArray);let r=t8e(o.outlineCoordinates),s=new hre(r);s.loadBuffer=!0,s.loadTypedArray=!1,e.attributePlans.push(s),t.outlineCoordinates=s.attribute;let a=e.attributePlans,c=e.attributePlans.length;for(let l=0;l<c;l++){let f=a[l].attribute;f.typedArray=o.updateAttribute(f.typedArray)}}function t8e(e){let t=new bn.Attribute;return t.name="_OUTLINE_COORDINATES",t.typedArray=e,t.componentDatatype=K.FLOAT,t.type=rn.VEC3,t.normalized=!1,t.count=e.length/3,t}function n8e(e,t){i8e(e.attributePlans,t),u(e.indicesPlan)&&o8e(e.indicesPlan,t)}function i8e(e,t){let n=e.length;for(let i=0;i<n;i++){let o=e[i],r=o.attribute,s=r.typedArray;if(o.loadBuffer){let a=xt.createVertexBuffer({typedArray:s,context:t,usage:ke.STATIC_DRAW});a.vertexArrayDestroyable=!1,r.buffer=a}o.loadTypedArray||(r.typedArray=void 0)}}function o8e(e,t){let n=e.indices;if(e.loadBuffer){let i=xt.createIndexBuffer({typedArray:n.typedArray,context:t,usage:ke.STATIC_DRAW,indexDatatype:n.indexDatatype});n.buffer=i,i.vertexArrayDestroyable=!1}e.loadTypedArray||(n.typedArray=void 0)}$N.AttributeLoadPlan=hre;$N.IndicesLoadPlan=Jze;var vA=$N;function r8e(e){e=x(e,x.EMPTY_OBJECT),this.webp=x(e.webp,!1),this.basis=x(e.basis,!1)}var QN=r8e;function mre(e){this._position=e.position,this._adjustmentParams=e.adjustmentParams}Object.defineProperties(mre.prototype,{position:{get:function(){return this._position}},adjustmentParams:{get:function(){return this._adjustmentParams}}});var JN=mre;function pre(e){this._position=e.position,this._adjustmentParams=e.adjustmentParams,this._covarianceMatrix=e.covarianceMatrix}Object.defineProperties(pre.prototype,{position:{get:function(){return this._position}},adjustmentParams:{get:function(){return this._adjustmentParams}},covarianceMatrix:{get:function(){return this._covarianceMatrix}}});var e2=pre;function _re(e){this._groupFlags=e.groupFlags,this._rotationThetas=e.rotationThetas,this._params=e.params}Object.defineProperties(_re.prototype,{groupFlags:{get:function(){return this._groupFlags}},rotationThetas:{get:function(){return this._rotationThetas}},params:{get:function(){return this._params}}});var t2=_re;var s8e={Direct:"Direct",Indirect:"Indirect"},dx=Object.freeze(s8e);function gre(e){this._storageType=e.storageType,this._anchorPointsIndirect=e.anchorPointsIndirect,this._anchorPointsDirect=e.anchorPointsDirect,this._intraTileCorrelationGroups=e.intraTileCorrelationGroups,this._covarianceDirect=e.covarianceDirect}Object.defineProperties(gre.prototype,{storageType:{get:function(){return this._storageType}},anchorPointsIndirect:{get:function(){return this._anchorPointsIndirect}},anchorPointsDirect:{get:function(){return this._anchorPointsDirect}},intraTileCorrelationGroups:{get:function(){return this._intraTileCorrelationGroups}},covarianceDirect:{get:function(){return this._covarianceDirect}}});var pw=gre;function yre(e){this._A=e.A,this._alpha=e.alpha,this._beta=e.beta,this._T=e.T}Object.defineProperties(yre.prototype,{A:{get:function(){return this._A}},alpha:{get:function(){return this._alpha}},beta:{get:function(){return this._beta}},T:{get:function(){return this._T}}});var n2=yre;function wA(){}function xre(e){return new J(e[0],e[1],e[3],e[1],e[2],e[4],e[3],e[4],e[5])}function a8e(e){let t=h.fromArray(e.position,0,new h),n=h.fromArray(e.adjustmentParams,0,new h);return new JN({position:t,adjustmentParams:n})}function c8e(e){let t=h.fromArray(e.position,0,new h),n=h.fromArray(e.adjustmentParams,0,new h),i=xre(e.covarianceMatrix);return new e2({position:t,adjustmentParams:n,covarianceMatrix:i})}function l8e(e){let t=e.groupFlags,n=h.fromArray(e.rotationThetas,0,new h),i=[];for(let r of e.params){let s=new n2({A:r.A,alpha:r.alpha,beta:r.beta,T:r.T});i.push(s)}return new t2({groupFlags:t,rotationThetas:n,params:i})}wA.load=function(e){let t=e.storageType;if(t===dx.Direct)return wA.loadDirect(e);if(t===dx.Indirect)return wA.loadIndirect(e);throw new ce(`Invalid storage type in NGA_gpm_local - expected 'Direct' or 'Indirect', but found ${t}`)};wA.loadDirect=function(e){let t=[],n=e.anchorPointsDirect;for(let r of n){let s=a8e(r);t.push(s)}let i=xre(e.covarianceDirectUpperTriangle);return new pw({storageType:dx.Direct,anchorPointsDirect:t,covarianceDirect:i})};wA.loadIndirect=function(e){let t=[],n=e.anchorPointsIndirect;for(let s of n){let a=c8e(s);t.push(a)}let i=e.intraTileCorrelationGroups,o=[];for(let s of i){let a=l8e(s);o.push(a)}return new pw({storageType:dx.Indirect,anchorPointsIndirect:t,intraTileCorrelationGroups:o})};var i2=wA;function bre(e){this._traits=e.traits,this._noData=e.noData,this._offset=e.offset,this._scale=e.scale,this._index=e.index,this._texCoord=e.texCoord}Object.defineProperties(bre.prototype,{traits:{get:function(){return this._traits}},noData:{get:function(){return this._noData}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},index:{get:function(){return this._index}},texCoord:{get:function(){return this._texCoord}}});var o2=bre;function Cre(e){this._min=e.min,this._max=e.max,this._source=e.source}Object.defineProperties(Cre.prototype,{min:{get:function(){return this._min}},max:{get:function(){return this._max}},source:{get:function(){return this._source}}});var r2=Cre;function Are(e){this._ppeTextures=e}Object.defineProperties(Are.prototype,{ppeTextures:{get:function(){return this._ppeTextures}}});var s2=Are;function br(e){e=x(e,x.EMPTY_OBJECT);let t=e.gltf,n=e.extension,i=e.gltfResource,o=e.baseResource,r=e.supportedImageFormats,s=e.frameState,a=e.cacheKey,c=x(e.asynchronous,!0);this._gltfResource=i,this._baseResource=o,this._gltf=t,this._extension=n,this._supportedImageFormats=r,this._frameState=s,this._cacheKey=a,this._asynchronous=c,this._textureLoaders=[],this._textureIds=[],this._meshPrimitiveGpmLocal=void 0,this._structuralMetadata=void 0,this._state=_t.UNLOADED,this._promise=void 0}u(Object.create)&&(br.prototype=Object.create(Qi.prototype),br.prototype.constructor=br);Object.defineProperties(br.prototype,{cacheKey:{get:function(){return this._cacheKey}},meshPrimitiveGpmLocal:{get:function(){return this._meshPrimitiveGpmLocal}},structuralMetadata:{get:function(){return this._structuralMetadata}}});br.prototype._loadResources=async function(){try{return await this._loadTextures(),this.isDestroyed()?void 0:(this._gltf=void 0,this._state=_t.LOADED,this)}catch(e){if(this.isDestroyed())return;throw this.unload(),this._state=_t.FAILED,this.getError("Failed to load GPM data",e)}};br.prototype.load=function(){return u(this._promise)?this._promise:(this._state=_t.LOADING,this._promise=this._loadResources(this),this._promise)};function u8e(e){let t={},n=e.ppeTextures;if(u(n))for(let i=0;i<n.length;i++){let o=n[i];t[o.index]=o}return t}br.prototype._loadTextures=function(){let e;u(this._extension)&&(e=u8e(this._extension));let t=this._gltf,n=this._gltfResource,i=this._baseResource,o=this._supportedImageFormats,r=this._frameState,s=this._asynchronous,a=[];for(let c in e)if(e.hasOwnProperty(c)){let l=wi.getTextureLoader({gltf:t,textureInfo:e[c],gltfResource:n,baseResource:i,supportedImageFormats:o,frameState:r,asynchronous:s});this._textureLoaders.push(l),this._textureIds.push(c),a.push(l.load())}return Promise.all(a)};br.ppeTexturesMetadataSchemaCache=new Map;br._createPpeTextureClassJson=function(e,t){let n=e.traits,i=n.source;return{name:`PPE texture class ${t}`,properties:{[i]:{name:"PPE",type:"SCALAR",componentType:"UINT8",normalized:!0,min:n.min,max:n.max}}}};br._obtainPpeTexturesMetadataSchema=function(e){let n=br._collectPpeTexturePropertyIdentifiers(e).toString(),i=br.ppeTexturesMetadataSchemaCache.get(n);if(u(i))return i;let r={id:`PPE_TEXTURE_SCHEMA_${br.ppeTexturesMetadataSchemaCache.size}`,classes:{}},s=e.ppeTextures;for(let a=0;a<s.length;a++){let c=s[a],l=`ppeTexture_${a}`,f=br._createPpeTextureClassJson(c,a);r.classes[l]=f}return i=hf.fromJson(r),br.ppeTexturesMetadataSchemaCache.set(n,i),i};br._collectPpeTexturePropertyIdentifiers=function(e){let t=[],n=e.ppeTextures;for(let i=0;i<n.length;i++){let o=n[i],r=br._createPpeTextureClassJson(o,i),s=JSON.stringify(r);t.push(s)}return t};br._convertToStructuralMetadata=function(e,t){let n=[],i=br._obtainPpeTexturesMetadataSchema(e),o=e.ppeTextures;for(let s=0;s<o.length;s++){let a=o[s],c=`ppeTexture_${s}`,f=a.traits.source,d=i.classes[c],p=(a.scale??1)*255,g={class:c,properties:{[f]:{index:a.index,texCoord:a.texCoord,offset:a.offset,scale:p}}};n.push(new vg({id:s,name:a.name,propertyTexture:g,class:d,textures:t}))}return new oa({schema:i,propertyTables:[],propertyTextures:n,propertyAttributes:[]})};br.prototype.process=function(e){if(this._state===_t.READY)return!0;if(this._state!==_t.LOADED)return!1;let t=this._textureLoaders,n=t.length,i=!0;for(let l=0;l<n;++l){let d=t[l].process(e);i=i&&d}if(!i)return!1;let o={};for(let l=0;l<this._textureIds.length;++l){let f=this._textureIds[l],d=t[l];d.isDestroyed()||(o[f]=d.texture)}let r=[],s=this._extension;if(u(s.ppeTextures)){let l=s.ppeTextures;for(let f of l){let d=f.traits,p=new r2({min:d.min,max:d.max,source:d.source}),g=new o2({traits:p,noData:f.noData,offset:f.offset,scale:f.scale,index:f.index,texCoord:f.texCoord});r.push(g)}}let a=new s2(r);this._meshPrimitiveGpmLocal=a;let c=br._convertToStructuralMetadata(a,o);return this._structuralMetadata=c,this._state=_t.READY,!0};br.prototype._unloadTextures=function(){let e=this._textureLoaders,t=e.length;for(let n=0;n<t;++n)wi.unload(e[n]);this._textureLoaders.length=0,this._textureIds.length=0};br.prototype.unload=function(){this._unloadTextures(),this._gltf=void 0,this._extension=void 0,this._structuralMetadata=void 0};var a2=br;var{Attribute:f8e,Indices:d8e,FeatureIdAttribute:Tre,FeatureIdTexture:Ere,FeatureIdImplicitRange:Sre,MorphTarget:h8e,Primitive:m8e,Instances:p8e,Skin:_8e,Node:g8e,AnimatedPropertyType:y8e,AnimationSampler:x8e,AnimationTarget:b8e,AnimationChannel:C8e,Animation:A8e,ArticulationStage:T8e,Articulation:E8e,Asset:S8e,Scene:v8e,Components:w8e,MetallicRoughness:D8e,SpecularGlossiness:I8e,Specular:P8e,Anisotropy:LW,Clearcoat:NW,Material:R8e}=bn,Io={NOT_LOADED:0,LOADING:1,LOADED:2,PROCESSING:3,POST_PROCESSING:4,PROCESSED:5,READY:6,FAILED:7,UNLOADED:8};function Cd(e){e=x(e,x.EMPTY_OBJECT);let{gltfResource:t,typedArray:n,releaseGltfJson:i=!1,asynchronous:o=!0,incrementallyLoadTextures:r=!0,upAxis:s=Vo.Y,forwardAxis:a=Vo.Z,loadAttributesAsTypedArray:c=!1,loadAttributesFor2D:l=!1,enablePick:f=!1,loadIndicesForWireframe:d=!1,loadPrimitiveOutline:p=!0,loadForClassification:g=!1,renameBatchIdSemantic:m=!1}=e,{baseResource:y=t.clone()}=e;this._gltfJson=e.gltfJson,this._gltfResource=t,this._baseResource=y,this._typedArray=n,this._releaseGltfJson=i,this._asynchronous=o,this._incrementallyLoadTextures=r,this._upAxis=s,this._forwardAxis=a,this._loadAttributesAsTypedArray=c,this._loadAttributesFor2D=l,this._enablePick=f,this._loadIndicesForWireframe=d,this._loadPrimitiveOutline=p,this._loadForClassification=g,this._renameBatchIdSemantic=m,this._sortedPropertyTableIds=void 0,this._sortedFeatureTextureIds=void 0,this._gltfJsonLoader=void 0,this._state=Io.NOT_LOADED,this._textureState=Io.NOT_LOADED,this._promise=void 0,this._processError=void 0,this._textureErrors=[],this._primitiveLoadPlans=[],this._loaderPromises=[],this._textureLoaders=[],this._texturesPromises=[],this._textureCallbacks=[],this._bufferViewLoaders=[],this._geometryLoaders=[],this._geometryCallbacks=[],this._structuralMetadataLoader=void 0,this._meshPrimitiveGpmLoader=void 0,this._loadResourcesPromise=void 0,this._resourcesLoaded=!1,this._texturesLoaded=!1,this._supportedImageFormats=void 0,this._postProcessBuffers=[],this._components=void 0}u(Object.create)&&(Cd.prototype=Object.create(Qi.prototype),Cd.prototype.constructor=Cd);Object.defineProperties(Cd.prototype,{cacheKey:{get:function(){}},components:{get:function(){return this._components}},gltfJson:{get:function(){return u(this._gltfJsonLoader)?this._gltfJsonLoader.gltf:this._gltfJson}},incrementallyLoadTextures:{get:function(){return this._incrementallyLoadTextures}},texturesLoaded:{get:function(){return this._texturesLoaded}}});async function O8e(e){e._state=Io.LOADING,e._textureState=Io.LOADING;try{let t=wi.getGltfJsonLoader({gltfResource:e._gltfResource,baseResource:e._baseResource,typedArray:e._typedArray,gltfJson:e._gltfJson});return e._gltfJsonLoader=t,await t.load(),e.isDestroyed()||e.isUnloaded()||t.isDestroyed()?void 0:(e._state=Io.LOADED,e._textureState=Io.LOADED,e)}catch(t){if(e.isDestroyed())return;e._state=Io.FAILED,e._textureState=Io.FAILED,c2(e,t)}}async function M8e(e,t){Wt.supportsWebP.initialized||await Wt.supportsWebP.initialize(),e._supportedImageFormats=new QN({webp:Wt.supportsWebP(),basis:t.context.supportsBasis});let n=F5e(e,t);return e._state=Io.PROCESSING,e._textureState=Io.PROCESSING,u(e._gltfJsonLoader)&&e._releaseGltfJson&&(wi.unload(e._gltfJsonLoader),e._gltfJsonLoader=void 0),n}Cd.prototype.load=async function(){return u(this._promise)?this._promise:(this._promise=O8e(this),this._promise)};function c2(e,t){throw e.unload(),e.getError("Failed to load glTF",t)}function L8e(e,t){let n=!0,i=e._geometryLoaders;for(let s=0;s<i.length;++s){let a=i[s].process(t);a&&u(e._geometryCallbacks[s])&&(e._geometryCallbacks[s](),e._geometryCallbacks[s]=void 0),n=n&&a}let o=e._structuralMetadataLoader;if(u(o)){let s=o.process(t);s&&(e._components.structuralMetadata=o.structuralMetadata),n=n&&s}let r=e._meshPrimitiveGpmLoader;if(u(r)){let s=r.process(t);s&&(u(e._components.structuralMetadata)&&At("structural-metadata-gpm","The model defines both the 'EXT_structural_metadata' extension and the 'NGA_gpm_local' extension. The data from the 'EXT_structural_metadata' extension will be replaced with the data from the 'NGA_gpm_local' extension, and will no longer be available for styling and picking."),e._components.structuralMetadata=r.structuralMetadata),n=n&&s}n&&(e._state=Io.POST_PROCESSING)}function N8e(e,t){let n=e._primitiveLoadPlans;for(let i=0;i<n.length;i++){let o=n[i];o.postProcess(t),o.needsOutlines&&F8e(e,o)}}function F8e(e,t){let n=e._postProcessBuffers,i=t.primitive,o=i.outlineCoordinates;u(o)&&n.push(o.buffer);let r=i.attributes;for(let a=0;a<r.length;a++){let c=r[a];u(c.buffer)&&n.push(c.buffer)}let s=i.indices;u(s)&&u(s.buffer)&&n.push(s.buffer)}Cd.prototype._process=function(e){return this._state===Io.READY?!0:(this._state===Io.PROCESSING&&L8e(this,e),this._resourcesLoaded&&this._state===Io.POST_PROCESSING&&(N8e(this,e.context),this._state=Io.PROCESSED),this._resourcesLoaded&&this._state===Io.PROCESSED?(Lre(this),this._typedArray=void 0,this._state=Io.READY,!0):!1)};Cd.prototype._processTextures=function(e){if(this._textureState===Io.READY)return!0;if(this._textureState!==Io.PROCESSING)return!1;let t=!0,n=this._textureLoaders;for(let i=0;i<n.length;++i){let o=n[i].process(e);o&&u(this._textureCallbacks[i])&&(this._textureCallbacks[i](),this._textureCallbacks[i]=void 0),t=t&&o}return t?(this._textureState=Io.READY,this._texturesLoaded=!0,!0):!1};Cd.prototype.process=function(e){if(this._state===Io.LOADED&&!u(this._loadResourcesPromise)&&(this._loadResourcesPromise=M8e(this,e).then(()=>{this._resourcesLoaded=!0}).catch(o=>{this._processError=o})),u(this._processError)){this._state=Io.FAILED;let o=this._processError;this._processError=void 0,c2(this,o)}let t=this._textureErrors.pop();if(u(t)){let o=this.getError("Failed to load glTF texture",t);throw o.name="TextureError",o}if(this._state===Io.FAILED)return!1;let n=!1;try{n=this._process(e)}catch(o){this._state=Io.FAILED,c2(this,o)}let i=!1;try{i=this._processTextures(e)}catch(o){this._textureState=Io.FAILED,c2(this,o)}return this._incrementallyLoadTextures?n:n&&i};function B8e(e,t,n,i,o,r,s){let a=e.gltfJson,l=a.accessors[t].bufferView;return wi.getVertexBufferLoader({gltf:a,gltfResource:e._gltfResource,baseResource:e._baseResource,frameState:s,bufferViewId:l,draco:i,attributeSemantic:n,accessorId:t,asynchronous:e._asynchronous,loadBuffer:o,loadTypedArray:r})}function k8e(e,t,n,i,o,r){return wi.getIndexBufferLoader({gltf:e.gltfJson,accessorId:t,gltfResource:e._gltfResource,baseResource:e._baseResource,frameState:r,draco:n,asynchronous:e._asynchronous,loadBuffer:i,loadTypedArray:o})}function V8e(e,t){let n=wi.getBufferViewLoader({gltf:e.gltfJson,bufferViewId:t,gltfResource:e._gltfResource,baseResource:e._baseResource});return e._bufferViewLoaders.push(n),n}function vre(e,t,n){let i=t.byteOffset,o=ru(e,t),r=t.count,s=df(t.type),a=t.componentType,c=K.getSizeInBytes(a),l=c*s,f=r*s;if(o===l)return n=new Uint8Array(n),K.createArrayBufferView(a,n.buffer,n.byteOffset+i,f);let d=K.createTypedArray(a,f),p=new DataView(n.buffer),g=new Array(s),m=mg(t.componentType);i=n.byteOffset+i;for(let y=0;y<r;++y){m(p,i,s,c,g);for(let b=0;b<s;++b)d[y*s+b]=g[b];i+=o}return d}function U8e(e,t){let n=e.type;if(n===rn.SCALAR)return t.fill(0);let i=rn.getMathType(n);return t.fill(i.clone(i.ZERO))}function z8e(e,t,n,i){let o=e.type,r=e.count;if(o===rn.SCALAR)for(let s=0;s<r;s++)n[s]=t[s];else if(o===rn.VEC4&&i)for(let s=0;s<r;s++)n[s]=Le.unpack(t,s*4);else{let s=rn.getMathType(o),a=rn.getNumberOfComponents(o);for(let c=0;c<r;c++)n[c]=s.unpack(t,c*a)}return n}async function H8e(e,t,n,i,o){let{gltfJson:r}=e;if(await t.load(),e.isDestroyed())return;let s=vre(r,n,t.typedArray);i=x(i,!1),z8e(n,s,o,i)}function l2(e,t,n){let i=new Array(t.count),o=t.bufferView;if(u(o)){let r=V8e(e,o),s=H8e(e,r,t,n,i);return e._loaderPromises.push(s),i}return U8e(t,i)}function lu(e,t){if(u(t))return e===Number?t[0]:e.unpack(t)}function G8e(e){return e===Number?0:new e}function W8e(e){switch(e){case K.BYTE:return 127;case K.UNSIGNED_BYTE:return 255;case K.SHORT:return 32767;case K.UNSIGNED_SHORT:return 65535;default:return 1}}var j8e={VEC2:new H(-1,-1),VEC3:new h(-1,-1,-1),VEC4:new oe(-1,-1,-1,-1)};function q8e(e,t){let n=W8e(e.componentDatatype),i=j8e[e.type],o=e.min;u(o)&&(o=t.divideByScalar(o,n,o),o=t.maximumByComponent(o,i,o));let r=e.max;u(r)&&(r=t.divideByScalar(r,n,r),r=t.maximumByComponent(r,i,r)),e.min=o,e.max=r}function Y8e(e,t,n){let i=e.decodeMatrix,o=lu(n,e.decodedMin),r=lu(n,e.decodedMax);u(o)&&u(r)&&(t.min=o,t.max=r);let s=new bn.Quantization;s.componentDatatype=t.componentDatatype,s.type=t.type,i.length===4?(s.quantizedVolumeOffset=i[2],s.quantizedVolumeStepSize=i[0]):i.length===9?(s.quantizedVolumeOffset=new H(i[6],i[7]),s.quantizedVolumeStepSize=new H(i[0],i[4])):i.length===16?(s.quantizedVolumeOffset=new h(i[12],i[13],i[14]),s.quantizedVolumeStepSize=new h(i[0],i[5],i[10])):i.length===25&&(s.quantizedVolumeOffset=new oe(i[20],i[21],i[22],i[23]),s.quantizedVolumeStepSize=new oe(i[0],i[6],i[12],i[18])),t.quantization=s}function X8e(e,t,n,i,o){let r=e.accessors[t],s=rn.getMathType(r.type),a=x(r.normalized,!1),c=new f8e;c.name=n,c.semantic=i,c.setIndex=o,c.constant=G8e(s),c.componentDatatype=r.componentType,c.normalized=a,c.count=r.count,c.type=r.type,c.min=lu(s,r.min),c.max=lu(s,r.max),c.byteOffset=r.byteOffset,c.byteStride=ru(e,r),si(r,"WEB3D_quantized_attributes")&&Y8e(r.extensions.WEB3D_quantized_attributes,c,s);let l=c.semantic===Tt.POSITION||c.semantic===Tt.NORMAL||c.semantic===Tt.TANGENT||c.semantic===Tt.TEXCOORD;return e.extensionsRequired?.includes("KHR_mesh_quantization")&&a&&l&&q8e(c,s),c}function wre(e){let n=/^\w+_(\d+)$/.exec(e);if(n!==null)return parseInt(n[1])}var K8e={gltfSemantic:void 0,renamedSemantic:void 0,modelSemantic:void 0};function FW(e,t,n){let i=n;e._renameBatchIdSemantic&&(n==="_BATCHID"||n==="BATCHID")&&(i="_FEATURE_ID_0");let o=t.fromGltfSemantic(i),r=K8e;return r.gltfSemantic=n,r.renamedSemantic=i,r.modelSemantic=o,r}function Z8e(e){let t=e===Tt.POSITION,n=e===Tt.FEATURE_ID,i=e===Tt.TEXCOORD;return t||n||i}function $8e(e,t,n,i){if(e.byteOffset=0,e.byteStride=void 0,e.quantization=t.quantization,n&&(e.buffer=t.buffer),i){let o=u(t.quantization)?t.quantization.componentDatatype:e.componentDatatype;e.typedArray=K.createArrayBufferView(o,t.typedArray.buffer)}}function Q8e(e,t,n,i,o,r){if(o&&(n.buffer=i.buffer),r){let s=i.typedArray;n.typedArray=vre(e,t,s),o||(n.byteOffset=0,n.byteStride=void 0)}}function Dre(e,t,n,i,o,r,s){let a=e.gltfJson,c=a.accessors[t],l=c.bufferView,f=n.gltfSemantic,d=n.renamedSemantic,p=n.modelSemantic,g=u(p)?wre(d):void 0,y=X8e(a,t,f,p,g);if(!u(i)&&!u(l))return y;let b=B8e(e,t,f,i,o,r,s),C=e._geometryLoaders.length;e._geometryLoaders.push(b);let A=b.load();return e._loaderPromises.push(A),e._geometryCallbacks[C]=()=>{u(i)&&u(i.attributes)&&u(i.attributes[f])?$8e(y,b,o,r):Q8e(a,c,y,b,o,r)},y}function Ire(e,t,n,i,o,r,s){let a=n.modelSemantic,c=a===Tt.POSITION,l=a===Tt.FEATURE_ID,f=c&&!o&&e._loadAttributesFor2D&&!s.scene3DOnly,d=c&&e._enablePick&&!s.context.webgl2,p=e._loadForClassification&&l,g=e._loadAttributesAsTypedArray,m=!g,y=g||f||d||p,A=Dre(e,t,n,i,r?!1:m,r?!0:y,s),T=new vA.AttributeLoadPlan(A);return T.loadBuffer=m,T.loadTypedArray=y,T}function J8e(e,t,n,i,o){let r=e.gltfJson.accessors,s=u(n.ROTATION),a=u(n.TRANSLATION)&&u(r[n.TRANSLATION].min)&&u(r[n.TRANSLATION].max),c=FW(e,as,i),l=c.modelSemantic,f=l===as.TRANSLATION||l===as.ROTATION||l===as.SCALE,d=l===as.TRANSLATION,p=e._loadAttributesAsTypedArray||s&&f||!o.context.instancedArrays,g=e._enablePick&&!o.context.webgl2,m=!p,y=e._loadAttributesFor2D&&!o.scene3DOnly;return Dre(e,t,c,void 0,m,p||d&&(!a||y||g),o)}function e5e(e,t,n,i,o,r){let s=e.gltfJson.accessors[t],a=s.bufferView;if(!u(n)&&!u(a))return;let c=new d8e;c.count=s.count;let l=e._loadAttributesAsTypedArray,f=(e._loadIndicesForWireframe||e._enablePick)&&!r.context.webgl2,d=e._loadForClassification&&i,g=!l,m=l||f||d,C=k8e(e,t,n,o?!1:g,o?!0:m,r),A=e._geometryLoaders.length;e._geometryLoaders.push(C);let T=C.load();e._loaderPromises.push(T),e._geometryCallbacks[A]=()=>{c.indexDatatype=C.indexDatatype,c.buffer=C.buffer,c.typedArray=C.typedArray};let E=new vA.IndicesLoadPlan(c);return E.loadBuffer=g,E.loadTypedArray=m,E}function Vc(e,t,n,i){let o=e.gltfJson,r=su.getImageIdFromTexture({gltf:o,textureId:t.index,supportedImageFormats:e._supportedImageFormats});if(!u(r))return;let s=wi.getTextureLoader({gltf:o,textureInfo:t,gltfResource:e._gltfResource,baseResource:e._baseResource,supportedImageFormats:e._supportedImageFormats,frameState:n,asynchronous:e._asynchronous}),a=su.createModelTextureReader({textureInfo:t}),c=e._textureLoaders.length;e._textureLoaders.push(s);let l=s.load().catch(f=>{if(!e.isDestroyed()){if(!e._incrementallyLoadTextures)throw f;e._textureState=Io.FAILED,e._textureErrors.push(f)}});return e._texturesPromises.push(l),e._textureCallbacks[c]=()=>{a.texture=s.texture,u(i)&&(a.texture.sampler=i)},a}function t5e(e,t,n){let{diffuseTexture:i,specularGlossinessTexture:o,diffuseFactor:r,specularFactor:s,glossinessFactor:a}=t,c=new I8e;return u(i)&&(c.diffuseTexture=Vc(e,i,n)),u(o)&&(c.specularGlossinessTexture=Vc(e,o,n)),c.diffuseFactor=lu(oe,r),c.specularFactor=lu(h,s),c.glossinessFactor=a,c}function n5e(e,t,n){let{baseColorTexture:i,metallicRoughnessTexture:o,baseColorFactor:r,metallicFactor:s,roughnessFactor:a}=t,c=new D8e;return u(i)&&(c.baseColorTexture=Vc(e,i,n)),u(o)&&(c.metallicRoughnessTexture=Vc(e,o,n)),c.baseColorFactor=lu(oe,r),c.metallicFactor=s,c.roughnessFactor=a,c}function i5e(e,t,n){let{specularFactor:i,specularTexture:o,specularColorFactor:r,specularColorTexture:s}=t,a=new P8e;return u(o)&&(a.specularTexture=Vc(e,o,n)),u(s)&&(a.specularColorTexture=Vc(e,s,n)),a.specularFactor=i,a.specularColorFactor=lu(h,r),a}function o5e(e,t,n){let{anisotropyStrength:i=LW.DEFAULT_ANISOTROPY_STRENGTH,anisotropyRotation:o=LW.DEFAULT_ANISOTROPY_ROTATION,anisotropyTexture:r}=t,s=new LW;return u(r)&&(s.anisotropyTexture=Vc(e,r,n)),s.anisotropyStrength=i,s.anisotropyRotation=o,s}function r5e(e,t,n){let{clearcoatFactor:i=NW.DEFAULT_CLEARCOAT_FACTOR,clearcoatTexture:o,clearcoatRoughnessFactor:r=NW.DEFAULT_CLEARCOAT_ROUGHNESS_FACTOR,clearcoatRoughnessTexture:s,clearcoatNormalTexture:a}=t,c=new NW;return u(o)&&(c.clearcoatTexture=Vc(e,o,n)),u(s)&&(c.clearcoatRoughnessTexture=Vc(e,s,n)),u(a)&&(c.clearcoatNormalTexture=Vc(e,a,n)),c.clearcoatFactor=i,c.clearcoatRoughnessFactor=r,c}function s5e(e,t,n){let i=new R8e,o=x(t.extensions,x.EMPTY_OBJECT),r=o.KHR_materials_pbrSpecularGlossiness,s=o.KHR_materials_specular,a=o.KHR_materials_anisotropy,c=o.KHR_materials_clearcoat,l=t.pbrMetallicRoughness;return i.unlit=u(o.KHR_materials_unlit),u(r)?i.specularGlossiness=t5e(e,r,n):(u(l)&&(i.metallicRoughness=n5e(e,l,n)),u(s)&&!i.unlit&&(i.specular=i5e(e,s,n)),u(a)&&!i.unlit&&(i.anisotropy=o5e(e,a,n)),u(c)&&!i.unlit&&(i.clearcoat=r5e(e,c,n))),u(t.emissiveTexture)&&(i.emissiveTexture=Vc(e,t.emissiveTexture,n)),u(t.normalTexture)&&!e._loadForClassification&&(i.normalTexture=Vc(e,t.normalTexture,n)),u(t.occlusionTexture)&&(i.occlusionTexture=Vc(e,t.occlusionTexture,n)),i.emissiveFactor=lu(h,t.emissiveFactor),i.alphaMode=t.alphaMode,i.alphaCutoff=t.alphaCutoff,i.doubleSided=t.doubleSided,i}function Pre(e,t){let n=new Tre;return n.featureCount=e.featureCount,n.nullFeatureId=e.nullFeatureId,n.propertyTableId=e.propertyTable,n.setIndex=e.attribute,n.label=e.label,n.positionalLabel=t,n}function Rre(e,t,n,i){let o=new Tre,r=e.featureIds;return o.featureCount=n,o.propertyTableId=t,o.setIndex=wre(r.attribute),o.positionalLabel=i,o}function Ore(e,t){let n=new Sre;return n.propertyTableId=e.propertyTable,n.featureCount=e.featureCount,n.nullFeatureId=e.nullFeatureId,n.label=e.label,n.positionalLabel=t,n.offset=0,n.repeat=1,n}function Mre(e,t,n,i){let o=new Sre,r=e.featureIds;o.propertyTableId=t,o.featureCount=n,o.offset=x(r.constant,0);let s=x(r.divisor,0);return o.repeat=s===0?void 0:s,o.positionalLabel=i,o}function a5e(e,t,n,i){let o=new Ere;o.featureCount=t.featureCount,o.nullFeatureId=t.nullFeatureId,o.propertyTableId=t.propertyTable,o.label=t.label,o.positionalLabel=i;let r=t.texture;o.textureReader=Vc(e,r,n,Qt.NEAREST);let a=(u(r.channels)?r.channels:[0]).map(function(c){return"rgba".charAt(c)}).join("");return o.textureReader.channels=a,o}function c5e(e,t,n,i,o,r){let s=new Ere,a=t.featureIds,c=a.texture;return s.featureCount=o,s.propertyTableId=n,s.textureReader=Vc(e,c,i,Qt.NEAREST),s.textureReader.channels=a.channels,s.positionalLabel=r,s}function l5e(e,t,n,i,o){let r=new h8e,s=void 0,a=!1;for(let c in t){if(!t.hasOwnProperty(c))continue;let l=t[c],f=FW(e,Tt,c),d=Ire(e,l,f,s,a,n,o);r.attributes.push(d.attribute),i.attributePlans.push(d)}return r}function u5e(e,t,n,i){let o=new m8e,r=new vA(o);e._primitiveLoadPlans.push(r);let s=t.material;u(s)&&(o.material=s5e(e,e.gltfJson.materials[s],i));let a=x(t.extensions,x.EMPTY_OBJECT),c=!1,l=a.CESIUM_primitive_outline;e._loadPrimitiveOutline&&u(l)&&(c=!0,r.needsOutlines=!0,r.outlineIndices=f5e(e,l,r));let f=e._loadForClassification,d=a.KHR_draco_mesh_compression,p=!1,g=t.attributes;if(u(g))for(let v in g){if(!g.hasOwnProperty(v))continue;let D=g[v],O=FW(e,Tt,v),P=O.modelSemantic;if(f&&!Z8e(P))continue;P===Tt.FEATURE_ID&&(p=!0);let M=Ire(e,D,O,d,n,c,i);r.attributePlans.push(M),o.attributes.push(M.attribute)}let m=t.targets;if(u(m)&&!f)for(let v=0;v<m.length;++v)o.morphTargets.push(l5e(e,m[v],c,r,i));let y=t.indices;if(u(y)){let v=e5e(e,y,d,p,c,i);u(v)&&(r.indicesPlan=v,o.indices=v.indices)}let b=a.EXT_structural_metadata,C=a.EXT_mesh_features,A=a.EXT_feature_metadata,T=u(A);u(C)?d5e(e,o,C,i):T&&h5e(e,o,A,i),u(b)?m5e(o,b):T&&p5e(e,o,A);let E=t.mode;if(f&&E!==Ne.TRIANGLES)throw new ce("Only triangle meshes can be used for classification.");return o.primitiveType=E,o}function f5e(e,t){let n=t.indices,i=e.gltfJson.accessors[n];return l2(e,i,!1)}function d5e(e,t,n,i){let o;u(n)&&u(n.featureIds)?o=n.featureIds:o=[];for(let r=0;r<o.length;r++){let s=o[r],a=`featureId_${r}`,c;u(s.texture)?c=a5e(e,s,i,a):u(s.attribute)?c=Pre(s,a):c=Ore(s,a),t.featureIds.push(c)}}function h5e(e,t,n,i){let{featureTables:o}=e.gltfJson.extensions.EXT_feature_metadata,r=0,s=n.featureIdAttributes;if(u(s))for(let c=0;c<s.length;++c){let l=s[c],f=l.featureTable,d=e._sortedPropertyTableIds.indexOf(f),p=o[f].count,g=`featureId_${r}`;r++;let m;u(l.featureIds.attribute)?m=Rre(l,d,p,g):m=Mre(l,d,p,g),t.featureIds.push(m)}let a=n.featureIdTextures;if(u(a))for(let c=0;c<a.length;++c){let l=a[c],f=l.featureTable,d=e._sortedPropertyTableIds.indexOf(f),p=o[f].count,g=`featureId_${r}`;r++;let m=c5e(e,l,d,i,p,g);t.featureIds.push(m)}}function m5e(e,t){u(t)&&(u(t.propertyTextures)&&(e.propertyTextureIds=t.propertyTextures),u(t.propertyAttributes)&&(e.propertyAttributeIds=t.propertyAttributes))}function p5e(e,t,n){u(n.featureTextures)&&(t.propertyTextureIds=n.featureTextures.map(function(i){return e._sortedFeatureTextureIds.indexOf(i)}))}function _5e(e,t,n){let i=t.EXT_mesh_gpu_instancing,o=new p8e,r=i.attributes;if(u(r))for(let l in r){if(!r.hasOwnProperty(l))continue;let f=r[l];o.attributes.push(J8e(e,f,r,l,n))}let s=x(i.extensions,x.EMPTY_OBJECT),a=t.EXT_instance_features,c=s.EXT_feature_metadata;return u(a)?g5e(o,a):u(c)&&y5e(e.gltfJson,o,c,e._sortedPropertyTableIds),o}function g5e(e,t){let n=t.featureIds;for(let i=0;i<n.length;i++){let o=n[i],r=`instanceFeatureId_${i}`,s;u(o.attribute)?s=Pre(o,r):s=Ore(o,r),e.featureIds.push(s)}}function y5e(e,t,n,i){let o=e.extensions.EXT_feature_metadata.featureTables,r=n.featureIdAttributes;if(u(r))for(let s=0;s<r.length;++s){let a=r[s],c=a.featureTable,l=i.indexOf(c),f=o[c].count,d=`instanceFeatureId_${s}`,p;u(a.featureIds.attribute)?p=Rre(a,l,f,d):p=Mre(a,l,f,d),t.featureIds.push(p)}}function x5e(e,t,n){let i=new g8e;i.name=t.name,i.matrix=lu(F,t.matrix),i.translation=lu(h,t.translation),i.rotation=lu(Le,t.rotation),i.scale=lu(h,t.scale);let o=x(t.extensions,x.EMPTY_OBJECT),r=o.EXT_mesh_gpu_instancing,s=o.AGI_articulations;if(u(r)){if(e._loadForClassification)throw new ce("Models with the EXT_mesh_gpu_instancing extension cannot be used for classification.");i.instances=_5e(e,o,n)}u(s)&&(i.articulationName=s.articulationName);let a=t.mesh;if(u(a)){let c=e.gltfJson.meshes[a],l=c.primitives;for(let p=0;p<l.length;++p)i.primitives.push(u5e(e,l[p],u(i.instances),n));let f=x(t.weights,c.weights),d=i.primitives[0].morphTargets;i.morphWeights=u(f)?f.slice():new Array(d.length).fill(0)}return i}function b5e(e,t){let n=e.gltfJson.nodes;if(!u(n))return[];let i=n.map(function(o,r){let s=x5e(e,o,t);return s.index=r,s});for(let o=0;o<i.length;++o){let r=n[o].children;if(u(r))for(let s=0;s<r.length;++s)i[o].children.push(i[r[s]])}return i}function C5e(e,t,n){let i=new _8e,o=t.joints;i.joints=o.map(s=>n[s]);let r=t.inverseBindMatrices;if(u(r)){let s=e.gltfJson.accessors[r];i.inverseBindMatrices=l2(e,s)}else i.inverseBindMatrices=new Array(o.length).fill(F.IDENTITY);return i}function A5e(e,t){let n=e.gltfJson.skins;if(e._loadForClassification||!u(n))return[];let i=n.map(function(r,s){let a=C5e(e,r,t);return a.index=s,a}),o=e.gltfJson.nodes;for(let r=0;r<t.length;++r){let s=o[r].skin;u(s)&&(t[r].skin=i[s])}return i}async function T5e(e,t,n,i){let o=new KN({gltf:e.gltfJson,extension:t,extensionLegacy:n,gltfResource:e._gltfResource,baseResource:e._baseResource,supportedImageFormats:e._supportedImageFormats,frameState:i,asynchronous:e._asynchronous});return e._structuralMetadataLoader=o,o.load()}async function E5e(e,t,n,i){let o=new a2({gltf:t,extension:n,gltfResource:e._gltfResource,baseResource:e._baseResource,supportedImageFormats:e._supportedImageFormats,frameState:i,asynchronous:e._asynchronous});return e._meshPrimitiveGpmLoader=o,o.load()}function S5e(e,t){let n=new x8e,i=e.gltfJson.accessors,o=i[t.input];n.input=l2(e,o);let r=t.interpolation;n.interpolation=x(Kh[r],Kh.LINEAR);let s=i[t.output];return n.output=l2(e,s,!0),n}function v5e(e,t){let n=new b8e,i=e.node;if(!u(i))return;n.node=t[i];let o=e.path.toUpperCase();return n.path=y8e[o],n}function w5e(e,t,n){let i=new C8e,o=e.sampler;return i.sampler=t[o],i.target=v5e(e.target,n),i}function D5e(e,t,n){let i=new A8e;i.name=t.name;let o=t.samplers.map(function(s,a){let c=S5e(e,s);return c.index=a,c}),r=t.channels.map(function(s){return w5e(s,o,n)});return i.samplers=o,i.channels=r,i}function I5e(e,t){let n=e.gltfJson.animations;return e._loadForClassification||!u(n)?[]:n.map(function(o,r){let s=D5e(e,o,t);return s.index=r,s})}function P5e(e){let t=new T8e;t.name=e.name;let n=e.type.toUpperCase();return t.type=kc[n],t.minimumValue=e.minimumValue,t.maximumValue=e.maximumValue,t.initialValue=e.initialValue,t}function R5e(e){let t=new E8e;return t.name=e.name,t.stages=e.stages.map(P5e),t}function O5e(e){let n=x(e.extensions,x.EMPTY_OBJECT).AGI_articulations?.articulations;return u(n)?n.map(R5e):[]}function M5e(e){let t;return u(e.scenes)&&u(e.scene)&&(t=e.scenes[e.scene].nodes),t=x(t,e.nodes),t=u(t)?t:[],t}function L5e(e,t){let n=new v8e,i=M5e(e);return n.nodes=i.map(function(o){return t[o]}),n}var N5e=new h;function F5e(e,t){let n=e.gltfJson,i=x(n.extensions,x.EMPTY_OBJECT),o=i.EXT_structural_metadata,r=i.EXT_feature_metadata,s=i.CESIUM_RTC;if(u(r)){let A=r.featureTables,T=r.featureTextures,E=u(A)?A:[],v=u(T)?T:[];e._sortedPropertyTableIds=Object.keys(E).sort(),e._sortedFeatureTextureIds=Object.keys(v).sort()}let a=b5e(e,t),c=A5e(e,a),l=I5e(e,a),f=O5e(n),d=L5e(n,a),p=new w8e,g=new S8e,m=n.asset.copyright;if(u(m)){let A=m.split(";").map(function(T){return new wt(T.trim())});g.credits=A}if(p.asset=g,p.scene=d,p.nodes=a,p.skins=c,p.animations=l,p.articulations=f,p.upAxis=e._upAxis,p.forwardAxis=e._forwardAxis,u(s)){let A=h.fromArray(s.center,0,N5e);p.transform=F.fromTranslation(A,p.transform)}if(e._components=p,u(o)||u(r)){let A=T5e(e,o,r,t);e._loaderPromises.push(A)}let y=i.NGA_gpm_local;if(u(y)){let A=i2.load(y);e._components.extensions.NGA_gpm_local=A}let b=n.meshes;if(u(b))for(let A of b){let T=A.primitives;if(u(T))for(let E of T){let v=E.extensions;if(u(v)){let D=v.NGA_gpm_local;if(u(D)){let O=E5e(e,n,D,t);e._loaderPromises.push(O)}}}}let C=[];return C.push.apply(C,e._loaderPromises),e._incrementallyLoadTextures||C.push.apply(C,e._texturesPromises),Promise.all(C)}function B5e(e){let t=e._textureLoaders;for(let n=0;n<t.length;++n)t[n]=!t[n].isDestroyed()&&wi.unload(t[n]);e._textureLoaders.length=0}function Lre(e){let t=e._bufferViewLoaders;for(let n=0;n<t.length;++n)t[n]=!t[n].isDestroyed()&&wi.unload(t[n]);e._bufferViewLoaders.length=0}function k5e(e){let t=e._geometryLoaders;for(let n=0;n<t.length;++n)t[n]=!t[n].isDestroyed()&&wi.unload(t[n]);e._geometryLoaders.length=0}function V5e(e){let t=e._postProcessBuffers;for(let n=0;n<t.length;n++){let i=t[n];i.isDestroyed()||i.destroy()}t.length=0}function U5e(e){u(e._structuralMetadataLoader)&&!e._structuralMetadataLoader.isDestroyed()&&(e._structuralMetadataLoader.destroy(),e._structuralMetadataLoader=void 0)}function z5e(e){u(e._meshPrimitiveGpmLoader)&&!e._meshPrimitiveGpmLoader.isDestroyed()&&(e._meshPrimitiveGpmLoader.destroy(),e._meshPrimitiveGpmLoader=void 0)}Cd.prototype.isUnloaded=function(){return this._state===Io.UNLOADED};Cd.prototype.unload=function(){u(this._gltfJsonLoader)&&!this._gltfJsonLoader.isDestroyed()&&wi.unload(this._gltfJsonLoader),this._gltfJsonLoader=void 0,B5e(this),Lre(this),k5e(this),V5e(this),U5e(this),z5e(this),this._components=void 0,this._typedArray=void 0,this._state=Io.UNLOADED};var Dg=Cd;var u2=`uniform sampler2D u_pointCloud_colorGBuffer;
uniform sampler2D u_pointCloud_depthGBuffer;
uniform vec2 u_distanceAndEdlStrength;
in vec2 v_textureCoordinates;

vec2 neighborContribution(float log2Depth, vec2 offset)
{
    float dist = u_distanceAndEdlStrength.x;
    vec2 texCoordOrig = v_textureCoordinates + offset * dist;
    vec2 texCoord0 = v_textureCoordinates + offset * floor(dist);
    vec2 texCoord1 = v_textureCoordinates + offset * ceil(dist);

    float depthOrLogDepth0 = czm_unpackDepth(texture(u_pointCloud_depthGBuffer, texCoord0));
    float depthOrLogDepth1 = czm_unpackDepth(texture(u_pointCloud_depthGBuffer, texCoord1));

    // ignore depth values that are the clear depth
    if (depthOrLogDepth0 == 0.0 || depthOrLogDepth1 == 0.0) {
        return vec2(0.0);
    }

    // interpolate the two adjacent depth values
    float depthMix = mix(depthOrLogDepth0, depthOrLogDepth1, fract(dist));
    vec4 eyeCoordinate = czm_windowToEyeCoordinates(texCoordOrig, depthMix);
    return vec2(max(0.0, log2Depth - log2(-eyeCoordinate.z / eyeCoordinate.w)), 1.0);
}

void main()
{
    float depthOrLogDepth = czm_unpackDepth(texture(u_pointCloud_depthGBuffer, v_textureCoordinates));

    vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, depthOrLogDepth);
    eyeCoordinate /= eyeCoordinate.w;

    float log2Depth = log2(-eyeCoordinate.z);

    if (depthOrLogDepth == 0.0) // 0.0 is the clear value for the gbuffer
    {
        discard;
    }

    vec4 color = texture(u_pointCloud_colorGBuffer, v_textureCoordinates);

    // sample from neighbors left, right, down, up
    vec2 texelSize = 1.0 / czm_viewport.zw;

    vec2 responseAndCount = vec2(0.0);

    responseAndCount += neighborContribution(log2Depth, vec2(-texelSize.x, 0.0));
    responseAndCount += neighborContribution(log2Depth, vec2(+texelSize.x, 0.0));
    responseAndCount += neighborContribution(log2Depth, vec2(0.0, -texelSize.y));
    responseAndCount += neighborContribution(log2Depth, vec2(0.0, +texelSize.y));

    float response = responseAndCount.x / responseAndCount.y;
    float strength = u_distanceAndEdlStrength.y;
    float shade = exp(-response * 300.0 * strength);
    color.rgb *= shade;
    out_FragColor = vec4(color);

    // Input and output depth are the same.
    gl_FragDepth = depthOrLogDepth;
}
`;function DA(){this._framebuffer=new pi({colorAttachmentsLength:2,depth:!0,supportsDepthTexture:!0}),this._drawCommand=void 0,this._clearCommand=void 0,this._strength=1,this._radius=1}Object.defineProperties(DA.prototype,{framebuffer:{get:function(){return this._framebuffer.framebuffer}},colorGBuffer:{get:function(){return this._framebuffer.getColorTexture(0)}},depthGBuffer:{get:function(){return this._framebuffer.getColorTexture(1)}}});function H5e(e){e._framebuffer.destroy(),e._drawCommand=void 0,e._clearCommand=void 0}var BW=new H;function G5e(e,t){let n=new ze({defines:["LOG_DEPTH_WRITE"],sources:[u2]}),i={u_pointCloud_colorGBuffer:function(){return e.colorGBuffer},u_pointCloud_depthGBuffer:function(){return e.depthGBuffer},u_distanceAndEdlStrength:function(){return BW.x=e._radius,BW.y=e._strength,BW}},o=Ue.fromCache({blending:un.ALPHA_BLEND,depthMask:!0,depthTest:{enabled:!0},stencilTest:Ut.setCesium3DTileBit(),stencilMask:Ut.CESIUM_3D_TILE_MASK});e._drawCommand=t.createViewportQuadCommand(n,{uniformMap:i,renderState:o,pass:we.CESIUM_3D_TILE,owner:e}),e._clearCommand=new ni({framebuffer:e.framebuffer,color:new G(0,0,0,0),depth:1,renderState:Ue.fromCache(),pass:we.CESIUM_3D_TILE,owner:e})}function W5e(e,t){let n=t.drawingBufferWidth,i=t.drawingBufferHeight;e._framebuffer.update(t,n,i),G5e(e,t)}function Nre(e){return e.drawBuffers&&e.fragmentDepth}DA.isSupported=Nre;function j5e(e,t){let n=e.shaderCache.getDerivedShaderProgram(t,"EC");if(!u(n)){let i=t._attributeLocations,o=t.fragmentShaderSource.clone();o.sources.splice(0,0,`layout (location = 0) out vec4 out_FragData_0;
layout (location = 1) out vec4 out_FragData_1;`),o.sources=o.sources.map(function(r){return r=ze.replaceMain(r,"czm_point_cloud_post_process_main"),r=r.replaceAll(/out_FragColor/g,"out_FragData_0"),r}),o.sources.push(`void main() 
{ 
    czm_point_cloud_post_process_main(); 
#ifdef LOG_DEPTH
    czm_writeLogDepth();
    out_FragData_1 = czm_packDepth(gl_FragDepth); 
#else
    out_FragData_1 = czm_packDepth(gl_FragCoord.z);
#endif
}`),n=e.shaderCache.createDerivedShaderProgram(t,"EC",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:o,attributeLocations:i})}return n}DA.prototype.update=function(e,t,n,i){if(!Nre(e.context))return;this._strength=n.eyeDomeLightingStrength,this._radius=n.eyeDomeLightingRadius*e.pixelRatio,W5e(this,e.context);let o,r=e.commandList,s=r.length;for(o=t;o<s;++o){let l=r[o];if(l.primitiveType!==Ne.POINTS||l.pass===we.TRANSLUCENT)continue;let f,d,p=l.derivedCommands.pointCloudProcessor;u(p)&&(f=p.command,d=p.originalShaderProgram),(!u(f)||l.dirty||d!==l.shaderProgram||f.framebuffer!==this.framebuffer)&&(f=Qe.shallowClone(l,f),f.framebuffer=this.framebuffer,f.shaderProgram=j5e(e.context,l.shaderProgram),f.castShadows=!1,f.receiveShadows=!1,u(p)||(p={command:f,originalShaderProgram:l.shaderProgram},l.derivedCommands.pointCloudProcessor=p),p.originalShaderProgram=l.shaderProgram),r[o]=f}let a=this._clearCommand,c=this._drawCommand;c.boundingVolume=i,r.push(c),r.push(a)};DA.prototype.isDestroyed=function(){return!1};DA.prototype.destroy=function(){return H5e(this),ue(this)};var Ig=DA;function Fre(e){let t=x(e,{});this.attenuation=x(t.attenuation,!1),this.geometricErrorScale=x(t.geometricErrorScale,1),this.maximumAttenuation=t.maximumAttenuation,this.baseResolution=t.baseResolution,this.eyeDomeLighting=x(t.eyeDomeLighting,!0),this.eyeDomeLightingStrength=x(t.eyeDomeLightingStrength,1),this.eyeDomeLightingRadius=x(t.eyeDomeLightingRadius,1),this.backFaceCulling=x(t.backFaceCulling,!1),this.normalShading=x(t.normalShading,!0)}Fre.isSupported=function(e){return Ig.isSupported(e.context)};var Tp=Fre;var wa={},q5e=new oe(0,0,0,1),nc=new oe,Y5e=new qe,kW=new H,VW=new H;wa.worldToWindowCoordinates=function(e,t,n){return wa.worldWithEyeOffsetToWindowCoordinates(e,t,h.ZERO,n)};var Bre=new oe,kre=new h;function _w(e,t,n,i){let o=n.viewMatrix,r=F.multiplyByVector(o,oe.fromElements(e.x,e.y,e.z,1,Bre),Bre),s=h.multiplyComponents(t,h.normalize(r,kre),kre);return r.x+=t.x+s.x,r.y+=t.y+s.y,r.z+=s.z,F.multiplyByVector(n.frustum.projectionMatrix,r,i)}var X5e=new de(Math.PI,R.PI_OVER_TWO),K5e=new h,Z5e=new h;wa.worldWithEyeOffsetToWindowCoordinates=function(e,t,n,i){let o=e.frameState,r=wa.computeActualEllipsoidPosition(o,t,q5e);if(!u(r))return;let s=e.canvas,a=Y5e;a.x=0,a.y=0,a.width=s.clientWidth,a.height=s.clientHeight;let c=e.camera,l=!1;if(o.mode===ne.SCENE2D){let f=e.mapProjection,d=X5e,p=f.project(d,K5e),g=h.clone(c.position,Z5e),m=c.frustum.clone(),y=F.computeViewportTransformation(a,0,1,new F),b=c.frustum.projectionMatrix,C=c.positionWC.y,A=h.fromElements(R.sign(C)*p.x-C,0,-c.positionWC.x),T=Lt.pointToGLWindowCoordinates(b,y,A);if(C===0||T.x<=0||T.x>=s.clientWidth)l=!0;else{if(T.x>s.clientWidth*.5){a.width=T.x,c.frustum.right=p.x-C,nc=_w(r,n,c,nc),wa.clipToGLWindowCoordinates(a,nc,kW),a.x+=T.x,c.position.x=-c.position.x;let E=c.frustum.right;c.frustum.right=-c.frustum.left,c.frustum.left=-E,nc=_w(r,n,c,nc),wa.clipToGLWindowCoordinates(a,nc,VW)}else{a.x+=T.x,a.width-=T.x,c.frustum.left=-p.x-C,nc=_w(r,n,c,nc),wa.clipToGLWindowCoordinates(a,nc,kW),a.x=a.x-a.width,c.position.x=-c.position.x;let E=c.frustum.left;c.frustum.left=-c.frustum.right,c.frustum.right=-E,nc=_w(r,n,c,nc),wa.clipToGLWindowCoordinates(a,nc,VW)}h.clone(g,c.position),c.frustum=m.clone(),i=H.clone(kW,i),(i.x<0||i.x>s.clientWidth)&&(i.x=VW.x)}}if(o.mode!==ne.SCENE2D||l){if(nc=_w(r,n,c,nc),nc.z<0&&!(c.frustum instanceof sn)&&!(c.frustum instanceof Gr))return;i=wa.clipToGLWindowCoordinates(a,nc,i)}return i.y=s.clientHeight-i.y,i};wa.worldToDrawingBufferCoordinates=function(e,t,n){if(n=wa.worldToWindowCoordinates(e,t,n),!!u(n))return wa.transformWindowToDrawingBuffer(e,n,n)};var Ep=new h,$5e=new de;wa.computeActualEllipsoidPosition=function(e,t,n){let i=e.mode;if(i===ne.SCENE3D)return h.clone(t,n);let o=e.mapProjection,r=o.ellipsoid.cartesianToCartographic(t,$5e);if(!u(r))return;if(o.project(r,Ep),i===ne.COLUMBUS_VIEW)return h.fromElements(Ep.z,Ep.x,Ep.y,n);if(i===ne.SCENE2D)return h.fromElements(0,Ep.x,Ep.y,n);let s=e.morphTime;return h.fromElements(R.lerp(Ep.z,t.x,s),R.lerp(Ep.x,t.y,s),R.lerp(Ep.y,t.z,s),n)};var Vre=new h,Ure=new h,zre=new F;wa.clipToGLWindowCoordinates=function(e,t,n){return h.divideByScalar(t,t.w,Vre),F.computeViewportTransformation(e,0,1,zre),F.multiplyByPoint(zre,Vre,Ure),H.fromCartesian3(Ure,n)};wa.transformWindowToDrawingBuffer=function(e,t,n){let i=e.canvas,o=e.drawingBufferWidth/i.clientWidth,r=e.drawingBufferHeight/i.clientHeight;return H.fromElements(t.x*o,t.y*r,n)};var Q5e=new oe,Hre=new oe;wa.drawingBufferToWorldCoordinates=function(e,t,n,i){let r=e.context.uniformState,s=r.currentFrustum,a=s.x,c=s.y;if(e.frameState.useLogDepth){let g=n*r.log2FarDepthFromNearPlusOne,m=Math.pow(2,g)-1;n=c*(1-a/(m+a))/(c-a)}let l=e.view.passState.viewport,f=oe.clone(oe.UNIT_W,Q5e);f.x=(t.x-l.x)/l.width*2-1,f.y=(t.y-l.y)/l.height*2-1,f.z=n*2-1,f.w=1;let d,p=e.camera.frustum;if(u(p.fovy)){d=F.multiplyByVector(r.inverseViewProjection,f,Hre);let g=1/d.w;h.multiplyByScalar(d,g,d)}else{let g=p.offCenterFrustum;u(g)&&(p=g),d=Hre,d.x=(f.x*(p.right-p.left)+p.left+p.right)*.5,d.y=(f.y*(p.top-p.bottom)+p.bottom+p.top)*.5,d.z=(f.z*(a-c)-a-c)*.5,d.w=1,d=F.multiplyByVector(r.inverseView,d,d)}return h.fromCartesian4(d,i)};var Wi=wa;var IA={};IA._deprecationWarning=ys;var Sp=Uint32Array.BYTES_PER_ELEMENT;IA.parse=function(e,t){let n=x(t,0);t=n;let i=new Uint8Array(e),o=new DataView(e);t+=Sp;let r=o.getUint32(t,!0);if(r!==1)throw new ce(`Only Batched 3D Model version 1 is supported.  Version ${r} is not.`);t+=Sp;let s=o.getUint32(t,!0);t+=Sp;let a=o.getUint32(t,!0);t+=Sp;let c=o.getUint32(t,!0);t+=Sp;let l=o.getUint32(t,!0);t+=Sp;let f=o.getUint32(t,!0);t+=Sp;let d;l>=570425344?(t-=Sp*2,d=a,l=c,f=0,a=0,c=0,IA._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchLength] [batchTableByteLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/main/specification/TileFormats/Batched3DModel.")):f>=570425344&&(t-=Sp,d=l,l=a,f=c,a=0,c=0,IA._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchTableJsonByteLength] [batchTableBinaryByteLength] [batchLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/main/specification/TileFormats/Batched3DModel."));let p;a===0?p={BATCH_LENGTH:x(d,0)}:(p=Uo(i,t,a),t+=a);let g=new Uint8Array(e,t,c);t+=c;let m,y;l>0&&(m=Uo(i,t,l),t+=l,f>0&&(y=new Uint8Array(e,t,f),y=new Uint8Array(y),t+=f));let b=n+s-t;if(b===0)throw new ce("glTF byte length must be greater than 0.");let C;return t%4===0?C=new Uint8Array(e,t,b):(IA._deprecationWarning("b3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),C=new Uint8Array(i.subarray(t,t+b))),{batchLength:d,featureTableJson:p,featureTableBinary:g,batchTableJson:m,batchTableBinary:y,gltf:C}};var f2=IA;function gw(e,t){this.json=e,this.buffer=t,this._cachedTypedArrays={},this.featuresLength=0}function Gre(e,t,n,i,o,r){let s=e._cachedTypedArrays,a=s[t];return u(a)||(a=K.createArrayBufferView(n,e.buffer.buffer,e.buffer.byteOffset+r,o*i),s[t]=a),a}function J5e(e,t,n,i){let o=e._cachedTypedArrays,r=o[t];return u(r)||(r=K.createTypedArray(n,i),o[t]=r),r}gw.prototype.getGlobalProperty=function(e,t,n){let i=this.json[e];if(u(i))return u(i.byteOffset)?(t=x(t,K.UNSIGNED_INT),n=x(n,1),Gre(this,e,t,n,1,i.byteOffset)):i};gw.prototype.hasProperty=function(e){return u(this.json[e])};gw.prototype.getPropertyArray=function(e,t,n){let i=this.json[e];if(u(i))return u(i.byteOffset)?(u(i.componentType)&&(t=K.fromName(i.componentType)),Gre(this,e,t,n,this.featuresLength,i.byteOffset)):J5e(this,e,t,i)};gw.prototype.getProperty=function(e,t,n,i,o){let r=this.json[e];if(!u(r))return;let s=this.getPropertyArray(e,t,n);if(n===1)return s[i];for(let a=0;a<n;++a)o[a]=s[n*i+a];return o};var Zh=gw;function yw(e){let t=e.count,n=e.batchTable,i=e.binaryBody,o=x(e.parseAsPropertyAttributes,!1),r=e.customAttributeOutput,s=eHe(n),a;u(s.jsonProperties)&&(a=new Sg({count:t,properties:s.jsonProperties}));let c;u(s.hierarchy)&&(c=new oA({extension:s.hierarchy,binaryBody:i}));let l=jh.BATCH_TABLE_CLASS_NAME,f=s.binaryProperties,d,p,g;if(o){let b=nHe(t,l,f,i,r);g=b.transcodedSchema,p=[new TA({propertyAttribute:b.propertyAttributeJson,class:b.transcodedClass})]}else{let b=tHe(t,l,f,i);g=b.transcodedSchema;let C=b.featureTableJson;d=new ou({count:C.count,properties:C.properties,class:b.transcodedClass,bufferViews:b.bufferViewsTypedArrays}),p=[]}let m=[];if(u(d)||u(a)||u(c)){let b=new Cl({id:0,name:"Batch Table",count:t,metadataTable:d,jsonMetadataTable:a,batchTableHierarchy:c});m.push(b)}let y={schema:g,propertyTables:m,propertyAttributes:p,extensions:s.extensions,extras:s.extras};return new oa(y)}function eHe(e){let t=e.HIERARCHY,n=e.extras,i=e.extensions,o;u(t)?(yw._deprecationWarning("batchTableHierarchyExtension","The batch table HIERARCHY property has been moved to an extension. Use extensions.3DTILES_batch_table_hierarchy instead."),o=t):u(i)&&(o=i["3DTILES_batch_table_hierarchy"]);let r,s={};for(let a in e){if(!e.hasOwnProperty(a)||a==="HIERARCHY"||a==="extensions"||a==="extras")continue;let c=e[a];Array.isArray(c)?(r=u(r)?r:{},r[a]=c):s[a]=c}return{binaryProperties:s,jsonProperties:r,hierarchy:o,extras:n,extensions:i}}function tHe(e,t,n,i){let o={},r={},s={},a=0;for(let d in n){if(!n.hasOwnProperty(d))continue;if(!u(i))throw new ce(`Property ${d} requires a batch table binary.`);let p=n[d],g=uf(p);r[d]={bufferView:a},o[d]=Wre(p),s[a]=g.createArrayBufferView(i.buffer,i.byteOffset+p.byteOffset,e),a++}let c={classes:{}};c.classes[t]={properties:o};let l=hf.fromJson(c);return{featureTableJson:{class:t,count:e,properties:r},bufferViewsTypedArrays:s,transcodedSchema:l,transcodedClass:l.classes[t]}}function nHe(e,t,n,i,o){let r={},s={},a=0;for(let d in n){if(!n.hasOwnProperty(d))continue;let p=n[d];if(!u(i)&&!u(p.typedArray))throw new ce(`Property ${d} requires a batch table binary.`);let g=Zt.sanitizeGlslIdentifier(d);(g===""||r.hasOwnProperty(g))&&(g=`property_${a}`,a++);let m=Wre(p);m.name=d,r[g]=m;let y=g.toUpperCase();y.startsWith("_")||(y=`_${y}`);let b=p.typedArray;u(b)||(b=uf(p).createArrayBufferView(i.buffer,i.byteOffset+p.byteOffset,e));let C=new bn.Attribute;C.name=y,C.count=e,C.type=p.type;let A=K.fromTypedArray(b);(A===K.INT||A===K.UNSIGNED_INT||A===K.DOUBLE)&&(yw._oneTimeWarning("Cast pnts property to floats",`Point cloud property "${y}" will be cast to a float array because INT, UNSIGNED_INT, and DOUBLE are not valid WebGL vertex attribute types. Some precision may be lost.`),b=new Float32Array(b)),C.componentDatatype=K.fromTypedArray(b),C.typedArray=b,o.push(C),s[g]={attribute:y}}let c={classes:{}};c.classes[t]={properties:r};let l=hf.fromJson(c);return{class:t,propertyAttributeJson:{properties:s},transcodedSchema:l,transcodedClass:l.classes[t]}}function Wre(e){let t=iHe(e.componentType);return{type:e.type,componentType:t}}function iHe(e){switch(e){case"BYTE":return"INT8";case"UNSIGNED_BYTE":return"UINT8";case"SHORT":return"INT16";case"UNSIGNED_SHORT":return"UINT16";case"INT":return"INT32";case"UNSIGNED_INT":return"UINT32";case"FLOAT":return"FLOAT32";case"DOUBLE":return"FLOAT64"}}yw._deprecationWarning=ys;yw._oneTimeWarning=At;var Pg=yw;var hx={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,FAILED:4},oHe=bn.FeatureIdAttribute;function Rg(e){e=x(e,x.EMPTY_OBJECT);let t=e.b3dmResource,n=e.baseResource,i=e.arrayBuffer,o=x(e.byteOffset,0),r=x(e.releaseGltfJson,!1),s=x(e.asynchronous,!0),a=x(e.incrementallyLoadTextures,!0),c=x(e.upAxis,Vo.Y),l=x(e.forwardAxis,Vo.X),f=x(e.loadAttributesAsTypedArray,!1),d=x(e.loadAttributesFor2D,!1),p=x(e.enablePick,!1),g=x(e.loadIndicesForWireframe,!1),m=x(e.loadPrimitiveOutline,!0),y=x(e.loadForClassification,!1);n=u(n)?n:t.clone(),this._b3dmResource=t,this._baseResource=n,this._arrayBuffer=i,this._byteOffset=o,this._releaseGltfJson=r,this._asynchronous=s,this._incrementallyLoadTextures=a,this._upAxis=c,this._forwardAxis=l,this._loadAttributesAsTypedArray=f,this._loadAttributesFor2D=d,this._enablePick=p,this._loadIndicesForWireframe=g,this._loadPrimitiveOutline=m,this._loadForClassification=y,this._state=hx.UNLOADED,this._promise=void 0,this._gltfLoader=void 0,this._batchLength=0,this._propertyTable=void 0,this._batchTable=void 0,this._components=void 0,this._transform=F.IDENTITY}u(Object.create)&&(Rg.prototype=Object.create(Qi.prototype),Rg.prototype.constructor=Rg);Object.defineProperties(Rg.prototype,{texturesLoaded:{get:function(){return this._gltfLoader?.texturesLoaded}},cacheKey:{get:function(){}},components:{get:function(){return this._components}}});Rg.prototype.load=function(){if(u(this._promise))return this._promise;let e=f2.parse(this._arrayBuffer,this._byteOffset),t=e.batchLength,n=e.featureTableJson,i=e.featureTableBinary,o=e.batchTableJson,r=e.batchTableBinary,s=new Zh(n,i);t=s.getGlobalProperty("BATCH_LENGTH"),this._batchLength=t;let a=s.getGlobalProperty("RTC_CENTER",K.FLOAT,3);u(a)&&(this._transform=F.fromTranslation(h.fromArray(a))),this._batchTable={json:o,binary:r};let c=new Dg({typedArray:e.gltf,upAxis:this._upAxis,forwardAxis:this._forwardAxis,gltfResource:this._b3dmResource,baseResource:this._baseResource,releaseGltfJson:this._releaseGltfJson,incrementallyLoadTextures:this._incrementallyLoadTextures,loadAttributesAsTypedArray:this._loadAttributesAsTypedArray,loadAttributesFor2D:this._loadAttributesFor2D,enablePick:this._enablePick,loadIndicesForWireframe:this._loadIndicesForWireframe,loadPrimitiveOutline:this._loadPrimitiveOutline,loadForClassification:this._loadForClassification,renameBatchIdSemantic:!0});this._gltfLoader=c,this._state=hx.LOADING;let l=this;return this._promise=c.load().then(function(){if(!l.isDestroyed())return l._state=hx.PROCESSING,l}).catch(function(f){if(!l.isDestroyed())return rHe(l,f)}),this._promise};function rHe(e,t){return e.unload(),e._state=hx.FAILED,t=e.getError("Failed to load b3dm",t),Promise.reject(t)}Rg.prototype.process=function(e){if(this._state===hx.READY)return!0;if(this._state!==hx.PROCESSING||!this._gltfLoader.process(e))return!1;let n=this._gltfLoader.components;return n.transform=F.multiplyTransformation(this._transform,n.transform,n.transform),sHe(this,n),this._components=n,this._arrayBuffer=void 0,this._state=hx.READY,!0};function sHe(e,t){let n=e._batchTable,i=e._batchLength;if(i===0)return;let o;if(u(n.json))o=Pg({count:i,batchTable:n.json,binaryBody:n.binary});else{let a=new Cl({name:jh.BATCH_TABLE_CLASS_NAME,count:i});o=new oa({schema:{},propertyTables:[a]})}let r=t.scene.nodes,s=r.length;for(let a=0;a<s;a++)jre(r[a]);t.structuralMetadata=o}function jre(e){let t=e.children.length;for(let i=0;i<t;i++)jre(e.children[i]);let n=e.primitives.length;for(let i=0;i<n;i++){let o=e.primitives[i],r=Zt.getAttributeBySemantic(o,Tt.FEATURE_ID);if(u(r)){r.setIndex=0;let s=new oHe;s.propertyTableId=0,s.setIndex=0,s.positionalLabel="featureId_0",o.featureIds.push(s)}}}Rg.prototype.unload=function(){u(this._gltfLoader)&&!this._gltfLoader.isDestroyed()&&this._gltfLoader.unload(),this._components=void 0,this._arrayBuffer=void 0};var d2=Rg;function Og(e){e=x(e,x.EMPTY_OBJECT),this._geoJson=e.geoJson,this._components=void 0}u(Object.create)&&(Og.prototype=Object.create(Qi.prototype),Og.prototype.constructor=Og);Object.defineProperties(Og.prototype,{cacheKey:{get:function(){}},components:{get:function(){return this._components}}});Og.prototype.load=function(){return Promise.resolve(this)};Og.prototype.process=function(e){return u(this._components)||(this._components=xHe(this._geoJson,e),this._geoJson=void 0),!0};function aHe(){this.lines=void 0,this.points=void 0,this.properties=void 0}function cHe(){this.features=[]}function UW(e){let t=e[0],n=e[1],i=x(e[2],0);return new h(t,n,i)}function zW(e){let t=e.length,n=new Array(t);for(let o=0;o<t;o++)n[o]=UW(e[o]);return[n]}function lHe(e){let t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=zW(e[i])[0];return n}function qre(e){let t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=zW(e[i])[0];return n}function uHe(e){let t=e.length,n=[];for(let i=0;i<t;i++)Array.prototype.push.apply(n,qre(e[i]));return n}function fHe(e){return[UW(e)]}function dHe(e){let t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=UW(e[i]);return n}var hHe={LineString:zW,MultiLineString:lHe,MultiPolygon:uHe,Polygon:qre,MultiPoint:dHe,Point:fHe},mHe={LineString:Ne.LINES,MultiLineString:Ne.LINES,MultiPolygon:Ne.LINES,Polygon:Ne.LINES,MultiPoint:Ne.POINTS,Point:Ne.POINTS};function Yre(e,t){if(!u(e.geometry))return;let n=e.geometry.type,i=hHe[n],o=mHe[n],r=e.geometry.coordinates;if(!u(i)||!u(r))return;let s=new aHe;o===Ne.LINES?s.lines=i(r):o===Ne.POINTS&&(s.points=i(r)),s.properties=e.properties,t.features.push(s)}function pHe(e,t){let n=e.features,i=n.length;for(let o=0;o<i;o++)Yre(n[o],t)}var _He={FeatureCollection:pHe,Feature:Yre},h2=new h;function gHe(e,t,n){let i=0,o=0,r=e.length;for(let M=0;M<r;M++){let L=e[M];if(u(L.lines)){let _=L.lines.length;for(let S=0;S<_;S++){let w=L.lines[S];i+=w.length,o+=(w.length-1)*2}}}let s=new Float32Array(i*3),a=new Float32Array(i),c=Be.createTypedArray(i,o),l=Be.fromTypedArray(c),f=new h(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),d=new h(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),p=0,g=0;for(let M=0;M<r;M++){let L=e[M];if(!u(L.lines))continue;let _=L.lines.length;for(let S=0;S<_;S++){let w=L.lines[S],I=w.length;for(let N=0;N<I;N++){let k=w[N],z=h.fromDegrees(k.x,k.y,k.z,ee.WGS84,h2),V=F.multiplyByPoint(t,z,h2);h.minimumByComponent(f,V,f),h.maximumByComponent(d,V,d),h.pack(V,s,p*3),a[p]=M,N<I-1&&(c[g*2]=p,c[g*2+1]=p+1,g++),p++}}}let m=xt.createVertexBuffer({typedArray:s,context:n.context,usage:ke.STATIC_DRAW});m.vertexArrayDestroyable=!1;let y=xt.createVertexBuffer({typedArray:a,context:n.context,usage:ke.STATIC_DRAW});y.vertexArrayDestroyable=!1;let b=xt.createIndexBuffer({typedArray:c,context:n.context,usage:ke.STATIC_DRAW,indexDatatype:l});b.vertexArrayDestroyable=!1;let C=new bn.Attribute;C.semantic=Tt.POSITION,C.componentDatatype=K.FLOAT,C.type=rn.VEC3,C.count=i,C.min=f,C.max=d,C.buffer=m;let A=new bn.Attribute;A.semantic=Tt.FEATURE_ID,A.setIndex=0,A.componentDatatype=K.FLOAT,A.type=rn.SCALAR,A.count=i,A.buffer=y;let T=[C,A],E=new bn.Material;E.unlit=!0;let v=new bn.Indices;v.indexDatatype=l,v.count=c.length,v.buffer=b;let D=new bn.FeatureIdAttribute;D.featureCount=r,D.propertyTableId=0,D.setIndex=0,D.positionalLabel="featureId_0";let O=[D],P=new bn.Primitive;return P.attributes=T,P.indices=v,P.featureIds=O,P.primitiveType=Ne.LINES,P.material=E,P}function yHe(e,t,n){let i=0,o=e.length;for(let T=0;T<o;T++){let E=e[T];u(E.points)&&(i+=E.points.length)}let r=new Float32Array(i*3),s=new Float32Array(i),a=new h(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),c=new h(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),l=0;for(let T=0;T<o;T++){let E=e[T];if(!u(E.points))continue;let v=E.points.length;for(let D=0;D<v;D++){let O=E.points[D],P=h.fromDegrees(O.x,O.y,O.z,ee.WGS84,h2),M=F.multiplyByPoint(t,P,h2);h.minimumByComponent(a,M,a),h.maximumByComponent(c,M,c),h.pack(M,r,l*3),s[l]=T,l++}}let f=xt.createVertexBuffer({typedArray:r,context:n.context,usage:ke.STATIC_DRAW});f.vertexArrayDestroyable=!1;let d=xt.createVertexBuffer({typedArray:s,context:n.context,usage:ke.STATIC_DRAW});d.vertexArrayDestroyable=!1;let p=new bn.Attribute;p.semantic=Tt.POSITION,p.componentDatatype=K.FLOAT,p.type=rn.VEC3,p.count=i,p.min=a,p.max=c,p.buffer=f;let g=new bn.Attribute;g.semantic=Tt.FEATURE_ID,g.setIndex=0,g.componentDatatype=K.FLOAT,g.type=rn.SCALAR,g.count=i,g.buffer=d;let m=[p,g],y=new bn.Material;y.unlit=!0;let b=new bn.FeatureIdAttribute;b.featureCount=o,b.propertyTableId=0,b.setIndex=0,b.positionalLabel="featureId_0";let C=[b],A=new bn.Primitive;return A.attributes=m,A.featureIds=C,A.primitiveType=Ne.POINTS,A.material=y,A}function xHe(e,t){let n=new cHe,i=_He[e.type];u(i)&&i(e,n);let o=n.features,r=o.length;if(r===0)throw new ce("GeoJSON must have at least one feature");let s={};for(let M=0;M<r;M++){let L=o[M],_=x(L.properties,x.EMPTY_OBJECT);for(let S in _)_.hasOwnProperty(S)&&(u(s[S])||(s[S]=new Array(r)))}for(let M=0;M<r;M++){let L=o[M];for(let _ in s)if(s.hasOwnProperty(_)){let S=x(L.properties[_],"");s[_][M]=S}}let a=new Sg({count:r,properties:s}),l=[new Cl({id:0,count:r,jsonMetadataTable:a})],f=hf.fromJson({}),d=new oa({schema:f,propertyTables:l}),p=new h(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),g=new h(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),m=!1,y=!1;for(let M=0;M<r;M++){let L=o[M];if(u(L.lines)){m=!0;let _=L.lines.length;for(let S=0;S<_;S++){let w=L.lines[S],I=w.length;for(let N=0;N<I;N++)h.minimumByComponent(p,w[N],p),h.maximumByComponent(g,w[N],g)}}if(u(L.points)){y=!0;let _=L.points.length;for(let S=0;S<_;S++){let w=L.points[S];h.minimumByComponent(p,w,p),h.maximumByComponent(g,w,g)}}}let b=h.midpoint(p,g,new h),C=h.fromDegrees(b.x,b.y,b.z,ee.WGS84,new h),A=Lt.eastNorthUpToFixedFrame(C,ee.WGS84,new F),T=F.inverseTransformation(A,new F),E=[];m&&E.push(gHe(o,T,t)),y&&E.push(yHe(o,T,t));let v=new bn.Node;v.index=0,v.primitives=E;let D=[v],O=new bn.Scene;O.nodes=D;let P=new bn.Components;return P.scene=O,P.nodes=D,P.transform=A,P.structuralMetadata=d,P}Og.prototype.unload=function(){this._components=void 0};var m2=Og;var p2={};p2._deprecationWarning=ys;var Mg=Uint32Array.BYTES_PER_ELEMENT;p2.parse=function(e,t){let n=x(t,0);t=n;let i=new Uint8Array(e),o=new DataView(e);t+=Mg;let r=o.getUint32(t,!0);if(r!==1)throw new ce(`Only Instanced 3D Model version 1 is supported. Version ${r} is not.`);t+=Mg;let s=o.getUint32(t,!0);t+=Mg;let a=o.getUint32(t,!0);if(a===0)throw new ce("featureTableJsonByteLength is zero, the feature table must be defined.");t+=Mg;let c=o.getUint32(t,!0);t+=Mg;let l=o.getUint32(t,!0);t+=Mg;let f=o.getUint32(t,!0);t+=Mg;let d=o.getUint32(t,!0);if(d!==1&&d!==0)throw new ce(`Only glTF format 0 (uri) or 1 (embedded) are supported. Format ${d} is not.`);t+=Mg;let p=Uo(i,t,a);t+=a;let g=new Uint8Array(e,t,c);t+=c;let m,y;l>0&&(m=Uo(i,t,l),t+=l,f>0&&(y=new Uint8Array(e,t,f),y=new Uint8Array(y),t+=f));let b=n+s-t;if(b===0)throw new ce("glTF byte length must be greater than 0.");let C;return t%4===0?C=new Uint8Array(e,t,b):(p2._deprecationWarning("i3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),C=new Uint8Array(i.subarray(t,t+b))),{gltfFormat:d,featureTableJson:p,featureTableBinary:g,batchTableJson:m,batchTableBinary:y,gltf:C}};var _2=p2;var vp={NOT_LOADED:0,LOADING:1,PROCESSING:2,POST_PROCESSING:3,READY:4,FAILED:5,UNLOADED:6},g2=bn.Attribute,bHe=bn.FeatureIdAttribute,Kre=bn.Instances;function wp(e){e=x(e,x.EMPTY_OBJECT);let t=e.i3dmResource,n=e.arrayBuffer,i=e.baseResource,o=x(e.byteOffset,0),r=x(e.releaseGltfJson,!1),s=x(e.asynchronous,!0),a=x(e.incrementallyLoadTextures,!0),c=x(e.upAxis,Vo.Y),l=x(e.forwardAxis,Vo.X),f=x(e.loadAttributesAsTypedArray,!1),d=x(e.loadIndicesForWireframe,!1),p=x(e.loadPrimitiveOutline,!0),g=x(e.enablePick,!1);i=u(i)?i:t.clone(),this._i3dmResource=t,this._baseResource=i,this._arrayBuffer=n,this._byteOffset=o,this._releaseGltfJson=r,this._asynchronous=s,this._incrementallyLoadTextures=a,this._upAxis=c,this._forwardAxis=l,this._loadAttributesAsTypedArray=f,this._loadIndicesForWireframe=d,this._loadPrimitiveOutline=p,this._enablePick=g,this._state=vp.NOT_LOADED,this._promise=void 0,this._gltfLoader=void 0,this._buffers=[],this._components=void 0,this._transform=F.IDENTITY,this._batchTable=void 0,this._featureTable=void 0,this._instancesLength=0}u(Object.create)&&(wp.prototype=Object.create(Qi.prototype),wp.prototype.constructor=wp);Object.defineProperties(wp.prototype,{texturesLoaded:{get:function(){return this._gltfLoader?.texturesLoaded}},cacheKey:{get:function(){}},components:{get:function(){return this._components}}});wp.prototype.load=function(){if(u(this._promise))return this._promise;let e=_2.parse(this._arrayBuffer,this._byteOffset),t=e.featureTableJson,n=e.featureTableBinary,i=e.batchTableJson,o=e.batchTableBinary,r=e.gltfFormat,s=new Zh(t,n);this._featureTable=s;let a=s.getGlobalProperty("INSTANCES_LENGTH");if(s.featuresLength=a,!u(a))throw new ce("Feature table global property: INSTANCES_LENGTH must be defined");this._instancesLength=a;let c=s.getGlobalProperty("RTC_CENTER",K.FLOAT,3);u(c)&&(this._transform=F.fromTranslation(h.fromArray(c))),this._batchTable={json:i,binary:o};let l={upAxis:this._upAxis,forwardAxis:this._forwardAxis,releaseGltfJson:this._releaseGltfJson,incrementallyLoadTextures:this._incrementallyLoadTextures,loadAttributesAsTypedArray:this._loadAttributesAsTypedArray,enablePick:this._enablePick,loadIndicesForWireframe:this._loadIndicesForWireframe,loadPrimitiveOutline:this._loadPrimitiveOutline};if(r===0){let d=tu(e.gltf);d=d.replace(/[\s\0]+$/,"");let p=this._baseResource.getDerivedResource({url:d});l.gltfResource=p,l.baseResource=p}else l.gltfResource=this._i3dmResource,l.typedArray=e.gltf;let f=new Dg(l);return this._gltfLoader=f,this._state=vp.LOADING,this._promise=f.load().then(()=>{if(!this.isDestroyed())return this._state=vp.PROCESSING,this}).catch(d=>{if(!this.isDestroyed())throw CHe(this,d)}),this._promise};function CHe(e,t){return e.unload(),e._state=vp.FAILED,e.getError("Failed to load i3dm",t)}wp.prototype.process=function(e){if(this._state===vp.READY)return!0;let t=this._gltfLoader,n=!1;if(this._state===vp.PROCESSING&&(n=t.process(e)),!n)return!1;let i=t.components;return i.transform=F.multiplyTransformation(this._transform,i.transform,i.transform),EHe(this,i,e),AHe(this,i),this._components=i,this._arrayBuffer=void 0,this._state=vp.READY,!0};function AHe(e,t){let n=e._batchTable,i=e._instancesLength;if(i===0)return;let o;if(u(n.json))o=Pg({count:i,batchTable:n.json,binaryBody:n.binary});else{let r=new Cl({name:jh.BATCH_TABLE_CLASS_NAME,count:i});o=new oa({schema:{},propertyTables:[r]})}t.structuralMetadata=o}var y2=new h,HW=new Array(4),THe=new F;function EHe(e,t,n){let i,o=e._featureTable,r=e._instancesLength;if(r===0)return;let s=o.getGlobalProperty("RTC_CENTER",K.FLOAT,3),a=o.getGlobalProperty("EAST_NORTH_UP"),c=o.hasProperty("NORMAL_UP")||o.hasProperty("NORMAL_UP_OCT32P")||a,l=o.hasProperty("SCALE")||o.hasProperty("SCALE_NON_UNIFORM"),f=vHe(o,r),d;c&&(d=new Float32Array(4*r));let p;l&&(p=new Float32Array(3*r));let g=new Float32Array(r),m=h.unpackArray(f),y=new h,b=new h,C=new h,A=new h,T=new J,E=new Le,v=new Array(4),D=new h,O=new Array(3),P=new F;if(!u(s)||h.equals(h.unpack(s),h.ZERO)){let V=ae.fromPoints(m);for(i=0;i<m.length;i++)h.subtract(m[i],V.center,y2),f[3*i+0]=y2.x,f[3*i+1]=y2.y,f[3*i+2]=y2.z;let U=F.fromTranslation(V.center,THe);t.transform=F.multiplyTransformation(U,t.transform,t.transform)}for(i=0;i<r;i++){y=h.clone(m[i]),u(s)&&h.add(y,h.unpack(s),y),c&&(wHe(o,a,i,E,y,C,b,A,T,P),Le.pack(E,v,0),d[4*i+0]=v[0],d[4*i+1]=v[1],d[4*i+2]=v[2],d[4*i+3]=v[3]),l&&(DHe(o,i,D),h.pack(D,O,0),p[3*i+0]=O[0],p[3*i+1]=O[1],p[3*i+2]=O[2]);let V=o.getProperty("BATCH_ID",K.UNSIGNED_SHORT,1,i);u(V)||(V=i),g[i]=V}let M=new Kre;M.transformInWorldSpace=!0;let L=e._buffers,_=new g2;if(_.name="Instance Translation",_.semantic=as.TRANSLATION,_.componentDatatype=K.FLOAT,_.type=rn.VEC3,_.count=r,_.typedArray=f,!c){let V=xt.createVertexBuffer({context:n.context,typedArray:f,usage:ke.STATIC_DRAW});V.vertexArrayDestroyable=!1,L.push(V),_.buffer=V}if(M.attributes.push(_),c){let V=new g2;V.name="Instance Rotation",V.semantic=as.ROTATION,V.componentDatatype=K.FLOAT,V.type=rn.VEC4,V.count=r,V.typedArray=d,M.attributes.push(V)}if(l){let V=new g2;if(V.name="Instance Scale",V.semantic=as.SCALE,V.componentDatatype=K.FLOAT,V.type=rn.VEC3,V.count=r,c)V.typedArray=p;else{let U=xt.createVertexBuffer({context:n.context,typedArray:p,usage:ke.STATIC_DRAW});U.vertexArrayDestroyable=!1,L.push(U),V.buffer=U}M.attributes.push(V)}let S=new g2;S.name="Instance Feature ID",S.setIndex=0,S.semantic=as.FEATURE_ID,S.componentDatatype=K.FLOAT,S.type=rn.SCALAR,S.count=r;let w=xt.createVertexBuffer({context:n.context,typedArray:g,usage:ke.STATIC_DRAW});w.vertexArrayDestroyable=!1,L.push(w),S.buffer=w,M.attributes.push(S);let I=new bHe;I.propertyTableId=0,I.setIndex=0,I.positionalLabel="instanceFeatureId_0",M.featureIds.push(I);let N=t.nodes,k=N.length,z=!1;for(i=0;i<k;i++){let V=N[i];V.primitives.length>0&&(V.instances=z?SHe(M):M,z=!0)}}function SHe(e){let t=new Kre;t.transformInWorldSpace=e.transformInWorldSpace;let n=e.attributes,i=n.length;for(let o=0;o<i;o++){let r=Ge(n[o],!1);t.attributes.push(r)}return t.featureIds=e.featureIds,t}function vHe(e,t){if(e.hasProperty("POSITION"))return e.getPropertyArray("POSITION",K.FLOAT,3);if(e.hasProperty("POSITION_QUANTIZED")){let n=e.getPropertyArray("POSITION_QUANTIZED",K.UNSIGNED_SHORT,3),i=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",K.FLOAT,3);if(!u(i))throw new ce("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");let o=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",K.FLOAT,3);if(!u(o))throw new ce("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");let r=new Float32Array(n.length);for(let s=0;s<n.length/3;s++)for(let a=0;a<3;a++){let c=3*s+a;r[c]=n[c]/65535*o[a]+i[a]}return r}else throw new ce("Either POSITION or POSITION_QUANTIZED must be defined for each instance.")}var Xre=new Array(4);function wHe(e,t,n,i,o,r,s,a,c,l){let f=e.getProperty("NORMAL_UP",K.FLOAT,3,n,HW),d=e.getProperty("NORMAL_RIGHT",K.FLOAT,3,n,Xre),p=!1;if(u(f)){if(!u(d))throw new ce("To define a custom orientation, both NORMAL_UP and NORMAL_RIGHT must be defined.");h.unpack(f,0,r),h.unpack(d,0,s),p=!0}else{let g=e.getProperty("NORMAL_UP_OCT32P",K.UNSIGNED_SHORT,2,n,HW),m=e.getProperty("NORMAL_RIGHT_OCT32P",K.UNSIGNED_SHORT,2,n,Xre);if(u(g)){if(!u(m))throw new ce("To define a custom orientation with oct-encoded vectors, both NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P must be defined.");Ln.octDecodeInRange(g[0],g[1],65535,r),Ln.octDecodeInRange(m[0],m[1],65535,s),p=!0}else t?(Lt.eastNorthUpToFixedFrame(o,ee.WGS84,l),F.getMatrix3(l,c)):J.clone(J.IDENTITY,c)}p&&(h.cross(s,r,a),h.normalize(a,a),J.setColumn(c,0,s,c),J.setColumn(c,1,r,c),J.setColumn(c,2,a,c)),Le.fromRotationMatrix(c,i)}function DHe(e,t,n){n=h.fromElements(1,1,1,n);let i=e.getProperty("SCALE",K.FLOAT,1,t);u(i)&&h.multiplyByScalar(n,i,n);let o=e.getProperty("SCALE_NON_UNIFORM",K.FLOAT,3,t,HW);u(o)&&(n.x*=o[0],n.y*=o[1],n.z*=o[2])}function IHe(e){let t=e._buffers,n=t.length;for(let i=0;i<n;i++){let o=t[i];o.isDestroyed()||o.destroy()}t.length=0}wp.prototype.isUnloaded=function(){return this._state===vp.UNLOADED};wp.prototype.unload=function(){u(this._gltfLoader)&&!this._gltfLoader.isDestroyed()&&this._gltfLoader.unload(),IHe(this),this._components=void 0,this._arrayBuffer=void 0,this._state=vp.UNLOADED};var x2=wp;var PHe={STOPPED:0,ANIMATING:1},$h=Object.freeze(PHe);function PA(){this.times=void 0,this.points=void 0,he.throwInstantiationError()}PA.getPointType=function(e){if(typeof e=="number")return Number;if(e instanceof h)return h;if(e instanceof Le)return Le};PA.prototype.evaluate=he.throwInstantiationError;PA.prototype.findTimeInterval=function(e,t){let n=this.times,i=n.length;if(t=x(t,0),e>=n[t]){if(t+1<i&&e<n[t+1])return t;if(t+2<i&&e<n[t+2])return t+1}else if(t-1>=0&&e>=n[t-1])return t-1;let o;if(e>n[t])for(o=t;o<i-1&&!(e>=n[o]&&e<n[o+1]);++o);else for(o=t-1;o>=0&&!(e>=n[o]&&e<n[o+1]);--o);return o===i-1&&(o=i-2),o};PA.prototype.wrapTime=function(e){let t=this.times,n=t[t.length-1],i=t[0],o=n-i,r;return e<i&&(r=Math.floor((i-e)/o)+1,e+=r*o),e>n&&(r=Math.floor((e-n)/o)+1,e-=r*o),e};PA.prototype.clampTime=function(e){let t=this.times;return R.clamp(e,t[0],t[t.length-1])};var ao=PA;function RA(e){this._value=e,this._valueType=ao.getPointType(e)}Object.defineProperties(RA.prototype,{value:{get:function(){return this._value}}});RA.prototype.findTimeInterval=function(e){};RA.prototype.wrapTime=function(e){return 0};RA.prototype.clampTime=function(e){return 0};RA.prototype.evaluate=function(e,t){let n=this._value,i=this._valueType;return i===Number?n:i.clone(n,t)};var b2=RA;function OA(e){e=x(e,x.EMPTY_OBJECT);let t=e.points,n=e.times;this._times=n,this._points=t,this._pointType=ao.getPointType(t[0]),this._lastTimeIndex=0}Object.defineProperties(OA.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}});OA.prototype.findTimeInterval=ao.prototype.findTimeInterval;OA.prototype.wrapTime=ao.prototype.wrapTime;OA.prototype.clampTime=ao.prototype.clampTime;OA.prototype.evaluate=function(e,t){let n=this.points,i=this.times,o=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex),r=(e-i[o])/(i[o+1]-i[o]);return this._pointType===Number?(1-r)*n[o]+r*n[o+1]:(u(t)||(t=new h),h.lerp(n[o],n[o+1],r,t))};var mx=OA;var Zre={};Zre.solve=function(e,t,n,i){let o=new Array(n.length),r=new Array(i.length),s=new Array(i.length),a;for(a=0;a<r.length;a++)r[a]=new h,s[a]=new h;o[0]=n[0]/t[0],r[0]=h.multiplyByScalar(i[0],1/t[0],r[0]);let c;for(a=1;a<o.length;++a)c=1/(t[a]-o[a-1]*e[a-1]),o[a]=n[a]*c,r[a]=h.subtract(i[a],h.multiplyByScalar(r[a-1],e[a-1],r[a]),r[a]),r[a]=h.multiplyByScalar(r[a],c,r[a]);for(c=1/(t[a]-o[a-1]*e[a-1]),r[a]=h.subtract(i[a],h.multiplyByScalar(r[a-1],e[a-1],r[a]),r[a]),r[a]=h.multiplyByScalar(r[a],c,r[a]),s[s.length-1]=r[r.length-1],a=s.length-2;a>=0;--a)s[a]=h.subtract(r[a],h.multiplyByScalar(s[a+1],o[a],s[a]),s[a]);return s};var xw=Zre;var $re=[],Qre=[],Jre=[],ese=[];function RHe(e,t,n){let i=$re,o=Jre,r=Qre,s=ese;i.length=o.length=e.length-1,r.length=s.length=e.length;let a;i[0]=r[0]=1,o[0]=0;let c=s[0];for(u(c)||(c=s[0]=new h),h.clone(t,c),a=1;a<i.length-1;++a)i[a]=o[a]=1,r[a]=4,c=s[a],u(c)||(c=s[a]=new h),h.subtract(e[a+1],e[a-1],c),h.multiplyByScalar(c,3,c);return i[a]=0,o[a]=1,r[a]=4,c=s[a],u(c)||(c=s[a]=new h),h.subtract(e[a+1],e[a-1],c),h.multiplyByScalar(c,3,c),r[a+1]=1,c=s[a+1],u(c)||(c=s[a+1]=new h),h.clone(n,c),xw.solve(i,r,o,s)}function OHe(e){let t=$re,n=Jre,i=Qre,o=ese;t.length=n.length=e.length-1,i.length=o.length=e.length;let r;t[0]=n[0]=1,i[0]=2;let s=o[0];for(u(s)||(s=o[0]=new h),h.subtract(e[1],e[0],s),h.multiplyByScalar(s,3,s),r=1;r<t.length;++r)t[r]=n[r]=1,i[r]=4,s=o[r],u(s)||(s=o[r]=new h),h.subtract(e[r+1],e[r-1],s),h.multiplyByScalar(s,3,s);return i[r]=2,s=o[r],u(s)||(s=o[r]=new h),h.subtract(e[r],e[r-1],s),h.multiplyByScalar(s,3,s),xw.solve(t,i,n,o)}function Al(e){e=x(e,x.EMPTY_OBJECT);let t=e.points,n=e.times,i=e.inTangents,o=e.outTangents;this._times=n,this._points=t,this._pointType=ao.getPointType(t[0]),this._inTangents=i,this._outTangents=o,this._lastTimeIndex=0}Object.defineProperties(Al.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},inTangents:{get:function(){return this._inTangents}},outTangents:{get:function(){return this._outTangents}}});Al.createC1=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.times,n=e.points,i=e.tangents,o=i.slice(0,i.length-1),r=i.slice(1,i.length);return new Al({times:t,points:n,inTangents:r,outTangents:o})};Al.createNaturalCubic=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.times,n=e.points;if(n.length<3)return new mx({points:n,times:t});let i=OHe(n),o=i.slice(0,i.length-1),r=i.slice(1,i.length);return new Al({times:t,points:n,inTangents:r,outTangents:o})};Al.createClampedCubic=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.times,n=e.points,i=e.firstTangent,o=e.lastTangent,r=ao.getPointType(n[0]);if(n.length<3)return new mx({points:n,times:t});let s=RHe(n,i,o),a=s.slice(0,s.length-1),c=s.slice(1,s.length);return new Al({times:t,points:n,inTangents:c,outTangents:a})};Al.hermiteCoefficientMatrix=new F(2,-3,0,1,-2,3,0,0,1,-2,1,0,1,-1,0,0);Al.prototype.findTimeInterval=ao.prototype.findTimeInterval;var MHe=new oe,MA=new h;Al.prototype.wrapTime=ao.prototype.wrapTime;Al.prototype.clampTime=ao.prototype.clampTime;Al.prototype.evaluate=function(e,t){let n=this.points,i=this.times,o=this.inTangents,r=this.outTangents;this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex);let s=this._lastTimeIndex,a=i[s+1]-i[s],c=(e-i[s])/a,l=MHe;l.z=c,l.y=c*c,l.x=l.y*c,l.w=1;let f=F.multiplyByVector(Al.hermiteCoefficientMatrix,l,l);f.z*=a,f.w*=a;let d=this._pointType;return d===Number?n[s]*f.x+n[s+1]*f.y+r[s]*f.z+o[s]*f.w:(u(t)||(t=new d),t=d.multiplyByScalar(n[s],f.x,t),d.multiplyByScalar(n[s+1],f.y,MA),d.add(t,MA,t),d.multiplyByScalar(r[s],f.z,MA),d.add(t,MA,t),d.multiplyByScalar(o[s],f.w,MA),d.add(t,MA,t))};var px=Al;function LA(e){e=x(e,x.EMPTY_OBJECT);let t=e.points,n=e.times;this._times=n,this._points=t,this._pointType=ao.getPointType(t[0]),this._lastTimeIndex=0}Object.defineProperties(LA.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}});LA.prototype.findTimeInterval=ao.prototype.findTimeInterval;LA.prototype.wrapTime=ao.prototype.wrapTime;LA.prototype.clampTime=ao.prototype.clampTime;LA.prototype.evaluate=function(e,t){let n=this.points;this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex);let i=this._lastTimeIndex,o=this._pointType;return o===Number?n[i]:(u(t)||(t=new o),o.clone(n[i],t))};var C2=LA;function LHe(e){let t=e.points,n=e.times;return function(i,o){u(o)||(o=new Le);let r=e._lastTimeIndex=e.findTimeInterval(i,e._lastTimeIndex),s=(i-n[r])/(n[r+1]-n[r]),a=t[r],c=t[r+1];return Le.fastSlerp(a,c,s,o)}}function NA(e){e=x(e,x.EMPTY_OBJECT);let t=e.points,n=e.times;this._times=n,this._points=t,this._evaluateFunction=LHe(this),this._lastTimeIndex=0}Object.defineProperties(NA.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}});NA.prototype.findTimeInterval=ao.prototype.findTimeInterval;NA.prototype.wrapTime=ao.prototype.wrapTime;NA.prototype.clampTime=ao.prototype.clampTime;NA.prototype.evaluate=function(e,t){return this._evaluateFunction(e,t)};var A2=NA;var FA=bn.AnimatedPropertyType;function GW(e){e=x(e,x.EMPTY_OBJECT);let t=e.channel,n=e.runtimeAnimation,i=e.runtimeNode;this._channel=t,this._runtimeAnimation=n,this._runtimeNode=i,this._splines=[],this._path=void 0,VHe(this)}Object.defineProperties(GW.prototype,{channel:{get:function(){return this._channel}},runtimeAnimation:{get:function(){return this._runtimeAnimation}},runtimeNode:{get:function(){return this._runtimeNode}},splines:{get:function(){return this._splines}}});function NHe(e,t){let n=[],i=[],o=[],r=t.length;for(let s=0;s<r;s+=3)i.push(t[s]),n.push(t[s+1]),o.push(t[s+2]);return i.splice(0,1),o.length=o.length-1,new px({times:e,points:n,inTangents:i,outTangents:o})}function tse(e,t,n,i){if(e.length===1&&t.length===1)return new b2(t[0]);switch(n){case Kh.STEP:return new C2({times:e,points:t});case Kh.CUBICSPLINE:return NHe(e,t);case Kh.LINEAR:return i===FA.ROTATION?new A2({times:e,points:t}):new mx({times:e,points:t})}}function FHe(e,t,n,i,o){let r=[];if(i===FA.WEIGHTS){let a=t.length/o,c,l;for(c=0;c<o;c++){let f=new Array(a),d=c;if(n===Kh.CUBICSPLINE)for(l=0;l<a;l+=3)f[l]=t[d],f[l+1]=t[d+o],f[l+2]=t[d+2*o],d+=o*3;else for(l=0;l<a;l++)f[l]=t[d],d+=o;r.push(tse(e,f,n,i))}}else r.push(tse(e,t,n,i));return r}var BHe=new h,kHe=new Le;function VHe(e){let t=e._channel,n=t.sampler,i=n.input,o=n.output,r=n.interpolation,a=t.target.path,c=e._runtimeNode,l=u(c.morphWeights)?c.morphWeights.length:1,f=FHe(i,o,r,a,l);e._splines=f,e._path=a}GW.prototype.animate=function(e){let t=this._splines,n=this._path,i=this._runtimeAnimation.model,o=this._runtimeNode;if(n===FA.WEIGHTS){let r=o.morphWeights,s=r.length;for(let a=0;a<s;a++){let c=t[a],l=i.clampAnimations?c.clampTime(e):c.wrapTime(e);r[a]=c.evaluate(l)}}else{if(o.userAnimated)return;{let r=t[0],s=i.clampAnimations?r.clampTime(e):r.wrapTime(e);n===FA.TRANSLATION||n===FA.SCALE?o[n]=r.evaluate(s,BHe):n===FA.ROTATION&&(o[n]=r.evaluate(s,kHe))}}};var T2=GW;function WW(e,t,n){this._animation=t,this._name=t.name,this._runtimeChannels=void 0,this._startTime=$.clone(n.startTime),this._delay=x(n.delay,0),this._stopTime=$.clone(n.stopTime),this.removeOnStop=x(n.removeOnStop,!1),this._multiplier=x(n.multiplier,1),this._reverse=x(n.reverse,!1),this._loop=x(n.loop,cu.NONE),this._animationTime=n.animationTime,this._prevAnimationDelta=void 0,this.start=new me,this.update=new me,this.stop=new me,this._state=$h.STOPPED,this._computedStartTime=void 0,this._duration=void 0;let i=this;this._raiseStartEvent=function(){i.start.raiseEvent(e,i)},this._updateEventTime=0,this._raiseUpdateEvent=function(){i.update.raiseEvent(e,i,i._updateEventTime)},this._raiseStopEvent=function(){i.stop.raiseEvent(e,i)},this._model=e,this._localStartTime=void 0,this._localStopTime=void 0,UHe(this)}Object.defineProperties(WW.prototype,{animation:{get:function(){return this._animation}},name:{get:function(){return this._name}},runtimeChannels:{get:function(){return this._runtimeChannels}},model:{get:function(){return this._model}},localStartTime:{get:function(){return this._localStartTime}},localStopTime:{get:function(){return this._localStopTime}},startTime:{get:function(){return this._startTime}},delay:{get:function(){return this._delay}},stopTime:{get:function(){return this._stopTime}},multiplier:{get:function(){return this._multiplier}},reverse:{get:function(){return this._reverse}},loop:{get:function(){return this._loop}},animationTime:{get:function(){return this._animationTime}}});function UHe(e){let t=Number.MAX_VALUE,n=-Number.MAX_VALUE,i=e._model.sceneGraph,r=e._animation.channels,s=r.length,a=[];for(let c=0;c<s;c++){let l=r[c],f=l.target;if(!u(f))continue;let d=f.node.index,p=i._runtimeNodes[d],g=new T2({channel:l,runtimeAnimation:e,runtimeNode:p}),m=l.sampler.input;t=Math.min(t,m[0]),n=Math.max(n,m[m.length-1]),a.push(g)}e._runtimeChannels=a,e._localStartTime=t,e._localStopTime=n}WW.prototype.animate=function(e){let t=this._runtimeChannels,n=t.length;for(let i=0;i<n;i++)t[i].animate(e)};var E2=WW;function Dp(e){this.animationAdded=new me,this.animationRemoved=new me,this.animateWhilePaused=!1,this._model=e,this._runtimeAnimations=[],this._previousTime=void 0}Object.defineProperties(Dp.prototype,{length:{get:function(){return this._runtimeAnimations.length}},model:{get:function(){return this._model}}});function jW(e,t,n){let i=e._model,o=new E2(i,t,n);return e._runtimeAnimations.push(o),e.animationAdded.raiseEvent(i,o),o}Dp.prototype.add=function(e){e=x(e,x.EMPTY_OBJECT);let n=this._model.sceneGraph.components.animations,i=e.index;if(u(i))return jW(this,n[i],e);let o=n.length;for(let r=0;r<o;++r)if(n[r].name===e.name){i=r;break}return jW(this,n[i],e)};Dp.prototype.addAll=function(e){e=x(e,x.EMPTY_OBJECT);let n=this._model.sceneGraph.components.animations,i=[],o=n.length;for(let r=0;r<o;++r){let s=jW(this,n[r],e);i.push(s)}return i};Dp.prototype.remove=function(e){if(!u(e))return!1;let t=this._runtimeAnimations,n=t.indexOf(e);return n!==-1?(t.splice(n,1),this.animationRemoved.raiseEvent(this._model,e),!0):!1};Dp.prototype.removeAll=function(){let e=this._model,t=this._runtimeAnimations,n=t.length;this._runtimeAnimations.length=0;for(let i=0;i<n;++i)this.animationRemoved.raiseEvent(e,t[i])};Dp.prototype.contains=function(e){return u(e)?this._runtimeAnimations.indexOf(e)!==-1:!1};Dp.prototype.get=function(e){return this._runtimeAnimations[e]};var S2=[];function zHe(e,t,n){return function(){e.animationRemoved.raiseEvent(t,n)}}Dp.prototype.update=function(e){let t=this._runtimeAnimations,n=t.length;if(n===0)return this._previousTime=void 0,!1;if(!this.animateWhilePaused&&$.equals(e.time,this._previousTime))return!1;this._previousTime=$.clone(e.time,this._previousTime);let i=!1,o=e.time,r=this._model;for(let s=0;s<n;++s){let a=t[s];u(a._computedStartTime)||(a._computedStartTime=$.addSeconds(x(a.startTime,o),a.delay,new $)),u(a._duration)||(a._duration=a.localStopTime*(1/a.multiplier));let c=a._computedStartTime,l=a._duration,f=a.stopTime,d=$.lessThanOrEquals(c,o),p=u(f)&&$.greaterThan(o,f),g=0;if(l!==0){let b=$.secondsDifference(p?f:o,c);g=u(a._animationTime)?a._animationTime(l,b):b/l}let m=a.loop===cu.REPEAT||a.loop===cu.MIRRORED_REPEAT,y=(d||m&&!u(a.startTime))&&(g<=1||m)&&!p;if(g===a._prevAnimationDelta){let b=a._state===$h.STOPPED;if(y!==b)continue}if(a._prevAnimationDelta=g,y||a._state===$h.ANIMATING){if(y&&a._state===$h.STOPPED&&(a._state=$h.ANIMATING,a.start.numberOfListeners>0&&e.afterRender.push(a._raiseStartEvent)),a.loop===cu.REPEAT)g=g-Math.floor(g);else if(a.loop===cu.MIRRORED_REPEAT){let C=Math.floor(g),A=g-C;g=C%2===1?1-A:A}a.reverse&&(g=1-g);let b=g*l*a.multiplier;b=R.clamp(b,a.localStartTime,a.localStopTime),a.animate(b),a.update.numberOfListeners>0&&(a._updateEventTime=b,e.afterRender.push(a._raiseUpdateEvent)),i=!0,y||(a._state=$h.STOPPED,a.stop.numberOfListeners>0&&e.afterRender.push(a._raiseStopEvent),a.removeOnStop&&S2.push(a))}}n=S2.length;for(let s=0;s<n;++s){let a=S2[s];t.splice(t.indexOf(a),1),e.afterRender.push(zHe(this,r,a))}return S2.length=0,i};var v2=Dp;function _x(e){this._model=e.model,this._featureTable=e.featureTable,this._featureId=e.featureId,this._color=void 0}Object.defineProperties(_x.prototype,{show:{get:function(){return this._featureTable.getShow(this._featureId)},set:function(e){this._featureTable.setShow(this._featureId,e)}},color:{get:function(){return u(this._color)||(this._color=new G),this._featureTable.getColor(this._featureId,this._color)},set:function(e){this._featureTable.setColor(this._featureId,e)}},primitive:{get:function(){return this._model}},featureTable:{get:function(){return this._featureTable}},featureId:{get:function(){return this._featureId}}});_x.prototype.hasProperty=function(e){return this._featureTable.hasProperty(this._featureId,e)};_x.prototype.getProperty=function(e){return this._featureTable.getProperty(this._featureId,e)};_x.prototype.getPropertyInherited=function(e){return this._featureTable.hasPropertyBySemantic(this._featureId,e)?this._featureTable.getPropertyBySemantic(this._featureId,e):this._featureTable.getProperty(this._featureId,e)};_x.prototype.getPropertyIds=function(e){return this._featureTable.getPropertyIds(e)};_x.prototype.setProperty=function(e,t){return this._featureTable.setProperty(this._featureId,e,t)};var w2=_x;var bw={ALL_OPAQUE:0,ALL_TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2};bw.getStyleCommandsNeeded=function(e,t){return t===0?bw.ALL_OPAQUE:t===e?bw.ALL_TRANSLUCENT:bw.OPAQUE_AND_TRANSLUCENT};var Qh=Object.freeze(bw);var Lg={GLTF:"GLTF",TILE_GLTF:"TILE_GLTF",TILE_B3DM:"B3DM",TILE_I3DM:"I3DM",TILE_PNTS:"PNTS",TILE_GEOJSON:"TILE_GEOJSON"};Lg.is3DTiles=function(e){switch(e){case Lg.TILE_GLTF:case Lg.TILE_B3DM:case Lg.TILE_I3DM:case Lg.TILE_PNTS:case Lg.TILE_GEOJSON:return!0;case Lg.GLTF:return!1}};var Cr=Object.freeze(Lg);function kr(e){let t=e.model,n=e.propertyTable;this._propertyTable=n,this._model=t,this._features=void 0,this._featuresLength=0,this._batchTexture=void 0,this._styleCommandsNeededDirty=!1,this._styleCommandsNeeded=Qh.ALL_OPAQUE,HHe(this)}Object.defineProperties(kr.prototype,{batchTexture:{get:function(){return this._batchTexture}},featuresLength:{get:function(){return this._featuresLength}},batchTextureByteLength:{get:function(){return u(this._batchTexture)?this._batchTexture.byteLength:0}},styleCommandsNeededDirty:{get:function(){return this._styleCommandsNeededDirty}}});function HHe(e){let t=e._model,n=Cr.is3DTiles(t.type),i=e._propertyTable.count;if(i===0)return;let o,r=new Array(i);if(n){let s=t.content;for(o=0;o<i;o++)r[o]=new ta(s,o)}else for(o=0;o<i;o++)r[o]=new w2({model:t,featureId:o,featureTable:e});e._features=r,e._featuresLength=i,e._batchTexture=new xl({featuresLength:i,owner:e,statistics:n?t.content.tileset.statistics:void 0})}kr.prototype.update=function(e){this._styleCommandsNeededDirty=!1,this._batchTexture.update(void 0,e);let t=Qh.getStyleCommandsNeeded(this._featuresLength,this._batchTexture.translucentFeaturesLength);this._styleCommandsNeeded!==t&&(this._styleCommandsNeededDirty=!0,this._styleCommandsNeeded=t)};kr.prototype.setShow=function(e,t){this._batchTexture.setShow(e,t)};kr.prototype.setAllShow=function(e){this._batchTexture.setAllShow(e)};kr.prototype.getShow=function(e){return this._batchTexture.getShow(e)};kr.prototype.setColor=function(e,t){this._batchTexture.setColor(e,t)};kr.prototype.setAllColor=function(e){this._batchTexture.setAllColor(e)};kr.prototype.getColor=function(e,t){return this._batchTexture.getColor(e,t)};kr.prototype.getPickColor=function(e){return this._batchTexture.getPickColor(e)};kr.prototype.getFeature=function(e){return this._features[e]};kr.prototype.hasProperty=function(e,t){return this._propertyTable.hasProperty(e,t)};kr.prototype.hasPropertyBySemantic=function(e,t){return this._propertyTable.hasPropertyBySemantic(e,t)};kr.prototype.getProperty=function(e,t){return this._propertyTable.getProperty(e,t)};kr.prototype.getPropertyBySemantic=function(e,t){return this._propertyTable.getPropertyBySemantic(e,t)};kr.prototype.getPropertyIds=function(e){return this._propertyTable.getPropertyIds(e)};kr.prototype.setProperty=function(e,t,n){return this._propertyTable.setProperty(e,t,n)};kr.prototype.isClass=function(e,t){return this._propertyTable.isClass(e,t)};kr.prototype.isExactClass=function(e,t){return this._propertyTable.isExactClass(e,t)};kr.prototype.getExactClassName=function(e){return this._propertyTable.getExactClassName(e)};var GHe=new G;kr.prototype.applyStyle=function(e){if(!u(e)){this.setAllColor(xl.DEFAULT_COLOR_VALUE),this.setAllShow(xl.DEFAULT_SHOW_VALUE);return}for(let t=0;t<this._featuresLength;t++){let n=this.getFeature(t),i=u(e.color)?x(e.color.evaluateColor(n,GHe),xl.DEFAULT_COLOR_VALUE):xl.DEFAULT_COLOR_VALUE,o=u(e.show)?x(e.show.evaluate(n),xl.DEFAULT_SHOW_VALUE):xl.DEFAULT_SHOW_VALUE;this.setColor(t,i),this.setShow(t,o)}};kr.prototype.isDestroyed=function(){return!1};kr.prototype.destroy=function(e){this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),ue(this)};var D2=kr;var nse={name:"TilesetPipelineStage"};nse.process=function(e,t,n){if(t.hasSkipLevelOfDetail(n)){e.shaderBuilder.addDefine("POLYGON_OFFSET",void 0,_e.FRAGMENT);let r={u_polygonOffset:function(){return H.ZERO}};e.uniformMap=bt(r,e.uniformMap),e.hasSkipLevelOfDetail=!0}let i=e.renderStateOptions;i.stencilTest=Ut.setCesium3DTileBit(),i.stencilMask=Ut.CESIUM_3D_TILE_MASK};var I2=nse;var P2=`// robust iterative solution without trig functions
// https://github.com/0xfaded/ellipse_demo/issues/1
// https://stackoverflow.com/questions/22959698/distance-from-given-point-to-given-ellipse
//
// This version uses only a single iteration for best performance. For fog
// rendering, the difference is negligible.
vec2 nearestPointOnEllipseFast(vec2 pos, vec2 radii) {
    vec2 p = abs(pos);
    vec2 inverseRadii = 1.0 / radii;
    vec2 evoluteScale = (radii.x * radii.x - radii.y * radii.y) * vec2(1.0, -1.0) * inverseRadii;

    // We describe the ellipse parametrically: v = radii * vec2(cos(t), sin(t))
    // but store the cos and sin of t in a vec2 for efficiency.
    // Initial guess: t = cos(pi/4)
    vec2 tTrigs = vec2(0.70710678118);
    vec2 v = radii * tTrigs;

    // Find the evolute of the ellipse (center of curvature) at v.
    vec2 evolute = evoluteScale * tTrigs * tTrigs * tTrigs;
    // Find the (approximate) intersection of p - evolute with the ellipsoid.
    vec2 q = normalize(p - evolute) * length(v - evolute);
    // Update the estimate of t.
    tTrigs = (q + evolute) * inverseRadii;
    tTrigs = normalize(clamp(tTrigs, 0.0, 1.0));
    v = radii * tTrigs;

    return v * sign(pos);
}

vec3 computeEllipsoidPositionWC(vec3 positionMC) {
    // Get the world-space position and project onto a meridian plane of
    // the ellipsoid
    vec3 positionWC = (czm_model * vec4(positionMC, 1.0)).xyz;

    vec2 positionEllipse = vec2(length(positionWC.xy), positionWC.z);
    vec2 nearestPoint = nearestPointOnEllipseFast(positionEllipse, czm_ellipsoidRadii.xz);

    // Reconstruct a 3D point in world space
    return vec3(nearestPoint.x * normalize(positionWC.xy), nearestPoint.y);
}

void applyFog(inout vec4 color, vec4 groundAtmosphereColor, vec3 lightDirection, float distanceToCamera) {

    vec3 fogColor = groundAtmosphereColor.rgb;

    // If there is dynamic lighting, apply that to the fog.
    const float NONE = 0.0;
    if (czm_atmosphereDynamicLighting != NONE) {
        float darken = clamp(dot(normalize(czm_viewerPositionWC), lightDirection), czm_fogMinimumBrightness, 1.0);
        fogColor *= darken;
    }

    // Tonemap if HDR rendering is disabled
    #ifndef HDR
        fogColor.rgb = czm_pbrNeutralTonemapping(fogColor.rgb);
        fogColor.rgb = czm_inverseGamma(fogColor.rgb);
    #endif

    vec3 withFog = czm_fog(distanceToCamera, color.rgb, fogColor, czm_fogVisualDensityScalar);
    color = vec4(withFog, color.a);
}

void atmosphereStage(inout vec4 color, in ProcessedAttributes attributes) {
    vec3 rayleighColor;
    vec3 mieColor;
    float opacity;

    vec3 positionWC;
    vec3 lightDirection;

    // When the camera is in space, compute the position per-fragment for
    // more accurate ground atmosphere. All other cases will use
    //
    // The if condition will be added in https://github.com/CesiumGS/cesium/issues/11717
    if (false) {
        positionWC = computeEllipsoidPositionWC(attributes.positionMC);
        lightDirection = czm_getDynamicAtmosphereLightDirection(positionWC, czm_atmosphereDynamicLighting);

        // The fog color is derived from the ground atmosphere color
        czm_computeGroundAtmosphereScattering(
            positionWC,
            lightDirection,
            rayleighColor,
            mieColor,
            opacity
        );
    } else {
        positionWC = attributes.positionWC;
        lightDirection = czm_getDynamicAtmosphereLightDirection(positionWC, czm_atmosphereDynamicLighting);
        rayleighColor = v_atmosphereRayleighColor;
        mieColor = v_atmosphereMieColor;
        opacity = v_atmosphereOpacity;
    }

    //color correct rayleigh and mie colors
    const bool ignoreBlackPixels = true;
    rayleighColor = czm_applyHSBShift(rayleighColor, czm_atmosphereHsbShift, ignoreBlackPixels);
    mieColor = czm_applyHSBShift(mieColor, czm_atmosphereHsbShift, ignoreBlackPixels);

    vec4 groundAtmosphereColor = czm_computeAtmosphereColor(positionWC, lightDirection, rayleighColor, mieColor, opacity);

    if (u_isInFog) {
        float distanceToCamera = length(attributes.positionEC);
        applyFog(color, groundAtmosphereColor, lightDirection, distanceToCamera);
    } else {
        // Ground atmosphere
    }
}
`;var R2=`void atmosphereStage(ProcessedAttributes attributes) {
    vec3 lightDirection = czm_getDynamicAtmosphereLightDirection(v_positionWC, czm_atmosphereDynamicLighting);

    czm_computeGroundAtmosphereScattering(
        // This assumes the geometry stage came before this.
        v_positionWC,
        lightDirection,
        v_atmosphereRayleighColor,
        v_atmosphereMieColor,
        v_atmosphereOpacity
    );
}
`;var ise={name:"AtmospherePipelineStage"};ise.process=function(e,t,n){let i=e.shaderBuilder;i.addDefine("HAS_ATMOSPHERE",void 0,_e.BOTH),i.addDefine("COMPUTE_POSITION_WC_ATMOSPHERE",void 0,_e.BOTH),i.addVarying("vec3","v_atmosphereRayleighColor"),i.addVarying("vec3","v_atmosphereMieColor"),i.addVarying("float","v_atmosphereOpacity"),i.addVertexLines([R2]),i.addFragmentLines([P2]),i.addUniform("bool","u_isInFog",_e.FRAGMENT),e.uniformMap.u_isInFog=function(){let o=h.distance(n.camera.positionWC,t.boundingSphere.center);return R.fog(o,n.fog.density)>R.EPSILON3}};var O2=ise;var M2=`#ifdef DIFFUSE_IBL
vec3 sampleDiffuseEnvironment(vec3 cubeDir)
{
    #ifdef CUSTOM_SPHERICAL_HARMONICS
        return czm_sphericalHarmonics(cubeDir, model_sphericalHarmonicCoefficients); 
    #else
        return czm_sphericalHarmonics(cubeDir, czm_sphericalHarmonicCoefficients); 
    #endif
}
#endif

#ifdef SPECULAR_IBL
vec3 sampleSpecularEnvironment(vec3 cubeDir, float roughness)
{
    #ifdef CUSTOM_SPECULAR_IBL
        float lod = roughness * model_specularEnvironmentMapsMaximumLOD;
        return czm_textureCube(model_specularEnvironmentMaps, cubeDir, lod).rgb;
    #else
        float lod = roughness * czm_specularEnvironmentMapsMaximumLOD;
        return czm_textureCube(czm_specularEnvironmentMaps, cubeDir, lod).rgb;
    #endif
}
vec3 computeSpecularIBL(vec3 cubeDir, float NdotV, vec3 f0, float roughness)
{
    // see https://bruop.github.io/ibl/ at Single Scattering Results
    // Roughness dependent fresnel, from Fdez-Aguera
    vec3 f90 = max(vec3(1.0 - roughness), f0);
    vec3 F = fresnelSchlick2(f0, f90, NdotV);

    vec2 brdfLut = texture(czm_brdfLut, vec2(NdotV, roughness)).rg;
    vec3 specularSample = sampleSpecularEnvironment(cubeDir, roughness);

    return specularSample * (F * brdfLut.x + brdfLut.y);
}
#endif

#if defined(DIFFUSE_IBL) || defined(SPECULAR_IBL)
/**
 * Compute the light contributions from environment maps and spherical harmonic coefficients.
 * See Fdez-Aguera, https://www.jcgt.org/published/0008/01/03/paper.pdf, for explanation
 * of the single- and multi-scattering terms.
 *
 * @param {vec3} viewDirectionEC Unit vector pointing from the fragment to the eye position.
 * @param {vec3} normalEC The surface normal in eye coordinates.
 * @param {czm_modelMaterial} The material properties.
 * @return {vec3} The computed HDR color.
 */
vec3 textureIBL(vec3 viewDirectionEC, vec3 normalEC, czm_modelMaterial material) {
    vec3 f0 = material.specular;
    float roughness = material.roughness;
    float specularWeight = 1.0;
    #ifdef USE_SPECULAR
        specularWeight = material.specularWeight;
    #endif
    float NdotV = clamp(dot(normalEC, viewDirectionEC), 0.0, 1.0);

    // see https://bruop.github.io/ibl/ at Single Scattering Results
    // Roughness dependent fresnel, from Fdez-Aguera
    vec3 f90 = max(vec3(1.0 - roughness), f0);
    vec3 singleScatterFresnel = fresnelSchlick2(f0, f90, NdotV);

    vec2 brdfLut = texture(czm_brdfLut, vec2(NdotV, roughness)).rg;
    vec3 FssEss = specularWeight * (singleScatterFresnel * brdfLut.x + brdfLut.y);

    #ifdef DIFFUSE_IBL
        vec3 normalMC = normalize(model_iblReferenceFrameMatrix * normalEC);
        vec3 irradiance = sampleDiffuseEnvironment(normalMC);

        vec3 averageFresnel = f0 + (1.0 - f0) / 21.0;
        float Ems = specularWeight * (1.0 - brdfLut.x - brdfLut.y);
        vec3 FmsEms = FssEss * averageFresnel * Ems / (1.0 - averageFresnel * Ems);
        vec3 dielectricScattering = (1.0 - FssEss - FmsEms) * material.diffuse;
        vec3 diffuseContribution = irradiance * (FmsEms + dielectricScattering) * model_iblFactor.x;
    #else
        vec3 diffuseContribution = vec3(0.0);
    #endif

    #ifdef USE_ANISOTROPY
        // Bend normal to account for anisotropic distortion of specular reflection
        vec3 anisotropyDirection = material.anisotropicB;
        vec3 anisotropicTangent = cross(anisotropyDirection, viewDirectionEC);
        vec3 anisotropicNormal = cross(anisotropicTangent, anisotropyDirection);
        float bendFactor = 1.0 - material.anisotropyStrength * (1.0 - roughness);
        float bendFactorPow4 = bendFactor * bendFactor * bendFactor * bendFactor;
        vec3 bentNormal = normalize(mix(anisotropicNormal, normalEC, bendFactorPow4));
        vec3 reflectEC = reflect(-viewDirectionEC, bentNormal);
    #else
        vec3 reflectEC = reflect(-viewDirectionEC, normalEC);
    #endif

    #ifdef SPECULAR_IBL
        vec3 reflectMC = normalize(model_iblReferenceFrameMatrix * reflectEC);
        vec3 radiance = sampleSpecularEnvironment(reflectMC, roughness);
        vec3 specularContribution = radiance * FssEss * model_iblFactor.y;
    #else
        vec3 specularContribution = vec3(0.0);
    #endif

    return diffuseContribution + specularContribution;
}
#endif
`;var ose={name:"ImageBasedLightingPipelineStage"},WHe=new H;ose.process=function(e,t,n){let i=t.imageBasedLighting,o=t.environmentMapManager,r=e.shaderBuilder,s;u(i.specularEnvironmentMaps)||(s=o.radianceCubeMap);let a=i.sphericalHarmonicCoefficients??o.sphericalHarmonicCoefficients;r.addDefine("USE_IBL_LIGHTING",void 0,_e.FRAGMENT),r.addUniform("vec2","model_iblFactor",_e.FRAGMENT),kh.isSupported(n.context)&&((i.useSphericalHarmonics||i.useSpecularEnvironmentMaps||i.enabled)&&r.addUniform("mat3","model_iblReferenceFrameMatrix",_e.FRAGMENT),u(s)&&r.addDefine("COMPUTE_POSITION_WC_ATMOSPHERE",void 0,_e.BOTH),u(a)&&u(a[0])?(r.addDefine("DIFFUSE_IBL",void 0,_e.FRAGMENT),r.addDefine("CUSTOM_SPHERICAL_HARMONICS",void 0,_e.FRAGMENT),r.addUniform("vec3","model_sphericalHarmonicCoefficients[9]",_e.FRAGMENT)):i.useDefaultSphericalHarmonics&&r.addDefine("DIFFUSE_IBL",void 0,_e.FRAGMENT),u(i.specularEnvironmentCubeMap)&&i.specularEnvironmentCubeMap.ready||u(s)?(r.addDefine("SPECULAR_IBL",void 0,_e.FRAGMENT),r.addDefine("CUSTOM_SPECULAR_IBL",void 0,_e.FRAGMENT),r.addUniform("samplerCube","model_specularEnvironmentMaps",_e.FRAGMENT),r.addUniform("float","model_specularEnvironmentMapsMaximumLOD",_e.FRAGMENT)):t.useDefaultSpecularMaps&&r.addDefine("SPECULAR_IBL",void 0,_e.FRAGMENT)),r.addFragmentLines(M2);let c={model_iblFactor:function(){return H.multiplyByScalar(i.imageBasedLightingFactor,o?.intensity||1,WHe)},model_iblReferenceFrameMatrix:function(){return t._iblReferenceFrameMatrix},model_sphericalHarmonicCoefficients:function(){return a},model_specularEnvironmentMaps:function(){return i.specularEnvironmentCubeMap.texture},model_specularEnvironmentMapsMaximumLOD:function(){return i.specularEnvironmentCubeMap.maximumMipmapLevel}};u(s)&&(c.model_specularEnvironmentMaps=function(){return s},c.model_specularEnvironmentMapsMaximumLOD=function(){return o.maximumMipmapLevel}),e.uniformMap=bt(c,e.uniformMap)};var L2=ose;var jHe=R.EPSILON16;function YW(e){e=x(e,x.EMPTY_OBJECT);let t=e.stage,n=e.runtimeArticulation;this._stage=t,this._runtimeArticulation=n,this._name=t.name,this._type=t.type,this._minimumValue=t.minimumValue,this._maximumValue=t.maximumValue,this._currentValue=t.initialValue}Object.defineProperties(YW.prototype,{stage:{get:function(){return this._stage}},runtimeArticulation:{get:function(){return this._runtimeArticulation}},name:{get:function(){return this._name}},type:{get:function(){return this._type}},minimumValue:{get:function(){return this._minimumValue}},maximumValue:{get:function(){return this._maximumValue}},currentValue:{get:function(){return this._currentValue},set:function(e){e=R.clamp(e,this.minimumValue,this.maximumValue),R.equalsEpsilon(this._currentValue,e,jHe)||(this._currentValue=e,this.runtimeArticulation._dirty=!0)}}});var qHe=new h,qW=new J;YW.prototype.applyStageToMatrix=function(e){let t=this.type,n=this.currentValue,i=qHe,o;switch(t){case kc.XROTATE:o=J.fromRotationX(R.toRadians(n),qW),e=F.multiplyByMatrix3(e,o,e);break;case kc.YROTATE:o=J.fromRotationY(R.toRadians(n),qW),e=F.multiplyByMatrix3(e,o,e);break;case kc.ZROTATE:o=J.fromRotationZ(R.toRadians(n),qW),e=F.multiplyByMatrix3(e,o,e);break;case kc.XTRANSLATE:i.x=n,i.y=0,i.z=0,e=F.multiplyByTranslation(e,i,e);break;case kc.YTRANSLATE:i.x=0,i.y=n,i.z=0,e=F.multiplyByTranslation(e,i,e);break;case kc.ZTRANSLATE:i.x=0,i.y=0,i.z=n,e=F.multiplyByTranslation(e,i,e);break;case kc.XSCALE:i.x=n,i.y=1,i.z=1,e=F.multiplyByScale(e,i,e);break;case kc.YSCALE:i.x=1,i.y=n,i.z=1,e=F.multiplyByScale(e,i,e);break;case kc.ZSCALE:i.x=1,i.y=1,i.z=n,e=F.multiplyByScale(e,i,e);break;case kc.UNIFORMSCALE:e=F.multiplyByUniformScale(e,n,e);break;default:break}return e};var N2=YW;function F2(e){e=x(e,x.EMPTY_OBJECT);let t=e.articulation,n=e.sceneGraph;this._articulation=t,this._sceneGraph=n,this._name=t.name,this._runtimeStages=[],this._runtimeStagesByName={},this._runtimeNodes=[],this._dirty=!0,YHe(this)}Object.defineProperties(F2.prototype,{articulation:{get:function(){return this._articulation}},sceneGraph:{get:function(){return this._sceneGraph}},name:{get:function(){return this._name}},runtimeStages:{get:function(){return this._runtimeStages}},runtimeNodes:{get:function(){return this._runtimeNodes}}});function YHe(e){let n=e.articulation.stages,i=n.length,o=e._runtimeStages,r=e._runtimeStagesByName;for(let s=0;s<i;s++){let a=n[s],c=new N2({stage:a,runtimeArticulation:e});o.push(c);let l=a.name;r[l]=c}}F2.prototype.setArticulationStage=function(e,t){let n=this._runtimeStagesByName[e];u(n)&&(n.currentValue=t)};var XHe=new F,KHe=new F;F2.prototype.apply=function(){if(!this._dirty)return;this._dirty=!1;let e=F.clone(F.IDENTITY,XHe),t,n=this._runtimeStages,i=n.length;for(t=0;t<i;t++)e=n[t].applyStageToMatrix(e);let o=this._runtimeNodes,r=o.length;for(t=0;t<r;t++){let s=o[t],a=F.multiplyTransformation(s.originalTransform,e,KHe);s.transform=a}};var B2=F2;var k2=`void modelColorStage(inout czm_modelMaterial material)
{
    material.diffuse = mix(material.diffuse, model_color.rgb, model_colorBlend);
    float highlight = ceil(model_colorBlend);
    material.diffuse *= mix(model_color.rgb, vec3(1.0), highlight);
    material.alpha *= model_color.a;
}
`;var BA={name:"ModelColorPipelineStage",COLOR_UNIFORM_NAME:"model_color",COLOR_BLEND_UNIFORM_NAME:"model_colorBlend"};BA.process=function(e,t,n){let i=e.shaderBuilder;i.addDefine("HAS_MODEL_COLOR",void 0,_e.FRAGMENT),i.addFragmentLines(k2);let o={},r=t.color;r.alpha===0&&!t.hasSilhouette(n)&&(e.renderStateOptions.colorMask={red:!1,green:!1,blue:!1,alpha:!1}),r.alpha<1&&(e.alphaOptions.pass=we.TRANSLUCENT),i.addUniform("vec4",BA.COLOR_UNIFORM_NAME,_e.FRAGMENT),o[BA.COLOR_UNIFORM_NAME]=function(){return t.color},i.addUniform("float",BA.COLOR_BLEND_UNIFORM_NAME,_e.FRAGMENT),o[BA.COLOR_BLEND_UNIFORM_NAME]=function(){return Bc.getColorBlend(t.colorBlendMode,t.colorBlendAmount)},e.uniformMap=bt(o,e.uniformMap)};var gx=BA;var V2=`#ifdef USE_CLIPPING_PLANES_FLOAT_TEXTURE
vec4 getClippingPlane(
    highp sampler2D packedClippingPlanes,
    int clippingPlaneNumber,
    mat4 transform
) {
    int pixY = clippingPlaneNumber / CLIPPING_PLANES_TEXTURE_WIDTH;
    int pixX = clippingPlaneNumber - (pixY * CLIPPING_PLANES_TEXTURE_WIDTH);
    float pixelWidth = 1.0 / float(CLIPPING_PLANES_TEXTURE_WIDTH);
    float pixelHeight = 1.0 / float(CLIPPING_PLANES_TEXTURE_HEIGHT);
    float u = (float(pixX) + 0.5) * pixelWidth; // sample from center of pixel
    float v = (float(pixY) + 0.5) * pixelHeight;
    vec4 plane = texture(packedClippingPlanes, vec2(u, v));
    return czm_transformPlane(plane, transform);
}
#else
// Handle uint8 clipping texture instead
vec4 getClippingPlane(
    highp sampler2D packedClippingPlanes,
    int clippingPlaneNumber,
    mat4 transform
) {
    int clippingPlaneStartIndex = clippingPlaneNumber * 2; // clipping planes are two pixels each
    int pixY = clippingPlaneStartIndex / CLIPPING_PLANES_TEXTURE_WIDTH;
    int pixX = clippingPlaneStartIndex - (pixY * CLIPPING_PLANES_TEXTURE_WIDTH);
    float pixelWidth = 1.0 / float(CLIPPING_PLANES_TEXTURE_WIDTH);
    float pixelHeight = 1.0 / float(CLIPPING_PLANES_TEXTURE_HEIGHT);
    float u = (float(pixX) + 0.5) * pixelWidth; // sample from center of pixel
    float v = (float(pixY) + 0.5) * pixelHeight;
    vec4 oct32 = texture(packedClippingPlanes, vec2(u, v)) * 255.0;
    vec2 oct = vec2(oct32.x * 256.0 + oct32.y, oct32.z * 256.0 + oct32.w);
    vec4 plane;
    plane.xyz = czm_octDecode(oct, 65535.0);
    plane.w = czm_unpackFloat(texture(packedClippingPlanes, vec2(u + pixelWidth, v)));
    return czm_transformPlane(plane, transform);
}
#endif

float clip(vec4 fragCoord, sampler2D clippingPlanes, mat4 clippingPlanesMatrix) {
    vec4 position = czm_windowToEyeCoordinates(fragCoord);
    vec3 clipNormal = vec3(0.0);
    vec3 clipPosition = vec3(0.0);
    float pixelWidth = czm_metersPerPixel(position);
    
    #ifdef UNION_CLIPPING_REGIONS
    float clipAmount; // For union planes, we want to get the min distance. So we set the initial value to the first plane distance in the loop below.
    #else
    float clipAmount = 0.0;
    bool clipped = true;
    #endif

    for (int i = 0; i < CLIPPING_PLANES_LENGTH; ++i) {
        vec4 clippingPlane = getClippingPlane(clippingPlanes, i, clippingPlanesMatrix);
        clipNormal = clippingPlane.xyz;
        clipPosition = -clippingPlane.w * clipNormal;
        float amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;
        
        #ifdef UNION_CLIPPING_REGIONS
        clipAmount = czm_branchFreeTernary(i == 0, amount, min(amount, clipAmount));
        if (amount <= 0.0) {
            discard;
        }
        #else
        clipAmount = max(amount, clipAmount);
        clipped = clipped && (amount <= 0.0);
        #endif
    }

    #ifndef UNION_CLIPPING_REGIONS
    if (clipped) {
        discard;
    }
    #endif
    
    return clipAmount;
}

void modelClippingPlanesStage(inout vec4 color)
{
    float clipDistance = clip(gl_FragCoord, model_clippingPlanes, model_clippingPlanesMatrix);
    vec4 clippingPlanesEdgeColor = vec4(1.0);
    clippingPlanesEdgeColor.rgb = model_clippingPlanesEdgeStyle.rgb;
    float clippingPlanesEdgeWidth = model_clippingPlanesEdgeStyle.a;
    
    if (clipDistance > 0.0 && clipDistance < clippingPlanesEdgeWidth) {
        color = clippingPlanesEdgeColor;
    }
}
`;var rse={name:"ModelClippingPlanesPipelineStage"},ZHe=new H;rse.process=function(e,t,n){let i=t.clippingPlanes,o=n.context,r=e.shaderBuilder;r.addDefine("HAS_CLIPPING_PLANES",void 0,_e.FRAGMENT),r.addDefine("CLIPPING_PLANES_LENGTH",i.length,_e.FRAGMENT),i.unionClippingRegions&&r.addDefine("UNION_CLIPPING_REGIONS",void 0,_e.FRAGMENT),As.useFloatTexture(o)&&r.addDefine("USE_CLIPPING_PLANES_FLOAT_TEXTURE",void 0,_e.FRAGMENT);let s=As.getTextureResolution(i,o,ZHe);r.addDefine("CLIPPING_PLANES_TEXTURE_WIDTH",s.x,_e.FRAGMENT),r.addDefine("CLIPPING_PLANES_TEXTURE_HEIGHT",s.y,_e.FRAGMENT),r.addUniform("sampler2D","model_clippingPlanes",_e.FRAGMENT),r.addUniform("vec4","model_clippingPlanesEdgeStyle",_e.FRAGMENT),r.addUniform("mat4","model_clippingPlanesMatrix",_e.FRAGMENT),r.addFragmentLines(V2);let a={model_clippingPlanes:function(){return i.texture},model_clippingPlanesEdgeStyle:function(){let c=G.clone(i.edgeColor);return c.alpha=i.edgeWidth,c},model_clippingPlanesMatrix:function(){return t._clippingPlanesMatrix}};e.uniformMap=bt(a,e.uniformMap)};var U2=rse;var z2=`void modelClippingPolygonsStage(ProcessedAttributes attributes)
{
    vec2 sphericalLatLong = czm_approximateSphericalCoordinates(v_positionWC);
    sphericalLatLong.y = czm_branchFreeTernary(sphericalLatLong.y < czm_pi, sphericalLatLong.y, sphericalLatLong.y - czm_twoPi);

    vec2 minDistance = vec2(czm_infinity);
    v_regionIndex = -1;
    v_clippingPosition = vec2(czm_infinity);

    for (int regionIndex = 0; regionIndex < CLIPPING_POLYGON_REGIONS_LENGTH; regionIndex++) {
        vec4 extents = czm_unpackClippingExtents(model_clippingExtents, regionIndex);
        vec2 rectUv = (sphericalLatLong.yx - extents.yx) * extents.wz;

        vec2 clamped = clamp(rectUv, vec2(0.0), vec2(1.0));
        vec2 distance = abs(rectUv - clamped) * extents.wz;
        
        if (minDistance.x > distance.x || minDistance.y > distance.y) {
            minDistance = distance;
            v_clippingPosition = rectUv;
        }

        float threshold = 0.01;
        if (rectUv.x > threshold && rectUv.y > threshold && rectUv.x < 1.0 - threshold && rectUv.y < 1.0 - threshold) {
            v_regionIndex = regionIndex;
        }
    }
}
`;var H2=`void modelClippingPolygonsStage()
{
    vec2 clippingPosition = v_clippingPosition;
    int regionIndex = v_regionIndex;
    czm_clipPolygons(model_clippingDistance, CLIPPING_POLYGON_REGIONS_LENGTH, clippingPosition, regionIndex);
}
`;var sse={name:"ModelClippingPolygonsPipelineStage"};sse.process=function(e,t,n){let i=t.clippingPolygons,o=e.shaderBuilder;o.addDefine("ENABLE_CLIPPING_POLYGONS",void 0,_e.BOTH),i.inverse&&o.addDefine("CLIPPING_INVERSE",void 0,_e.FRAGMENT),o.addDefine("CLIPPING_POLYGON_REGIONS_LENGTH",i.extentsCount,_e.BOTH),o.addUniform("sampler2D","model_clippingDistance",_e.FRAGMENT),o.addUniform("sampler2D","model_clippingExtents",_e.VERTEX),o.addVarying("vec2","v_clippingPosition"),o.addVarying("int","v_regionIndex","flat"),o.addVertexLines(z2),o.addFragmentLines(H2);let r={model_clippingDistance:function(){return i.clippingTexture},model_clippingExtents:function(){return i.extentsTexture}};e.uniformMap=bt(r,e.uniformMap)};var G2=sse;function ase(e,t){this._model=e,this._runtimeNode=t}Object.defineProperties(ase.prototype,{name:{get:function(){return this._runtimeNode._name}},id:{get:function(){return this._runtimeNode._id}},show:{get:function(){return this._runtimeNode.show},set:function(e){this._runtimeNode.show=e}},matrix:{get:function(){return this._runtimeNode.transform},set:function(e){u(e)?(this._runtimeNode.transform=e,this._runtimeNode.userAnimated=!0,this._model._userAnimationDirty=!0):(this._runtimeNode.transform=this.originalMatrix,this._runtimeNode.userAnimated=!1)}},originalMatrix:{get:function(){return this._runtimeNode.originalTransform}}});var W2=ase;var j2=`mat4 getInstancingTransform()
{
    mat4 instancingTransform;

    #ifdef HAS_INSTANCE_MATRICES
    instancingTransform = mat4(
        a_instancingTransformRow0.x, a_instancingTransformRow1.x, a_instancingTransformRow2.x, 0.0, // Column 1
        a_instancingTransformRow0.y, a_instancingTransformRow1.y, a_instancingTransformRow2.y, 0.0, // Column 2
        a_instancingTransformRow0.z, a_instancingTransformRow1.z, a_instancingTransformRow2.z, 0.0, // Column 3
        a_instancingTransformRow0.w, a_instancingTransformRow1.w, a_instancingTransformRow2.w, 1.0  // Column 4
    );
    #else
    vec3 translation = vec3(0.0, 0.0, 0.0);
    vec3 scale = vec3(1.0, 1.0, 1.0);
    
        #ifdef HAS_INSTANCE_TRANSLATION
        translation = a_instanceTranslation;
        #endif
        #ifdef HAS_INSTANCE_SCALE
        scale = a_instanceScale;
        #endif

    instancingTransform = mat4(
        scale.x, 0.0, 0.0, 0.0,
        0.0, scale.y, 0.0, 0.0,
        0.0, 0.0, scale.z, 0.0,
        translation.x, translation.y, translation.z, 1.0
    ); 
    #endif

    return instancingTransform;
}

#ifdef USE_2D_INSTANCING
mat4 getInstancingTransform2D()
{
    mat4 instancingTransform2D;

    #ifdef HAS_INSTANCE_MATRICES
    instancingTransform2D = mat4(
        a_instancingTransform2DRow0.x, a_instancingTransform2DRow1.x, a_instancingTransform2DRow2.x, 0.0, // Column 1
        a_instancingTransform2DRow0.y, a_instancingTransform2DRow1.y, a_instancingTransform2DRow2.y, 0.0, // Column 2
        a_instancingTransform2DRow0.z, a_instancingTransform2DRow1.z, a_instancingTransform2DRow2.z, 0.0, // Column 3
        a_instancingTransform2DRow0.w, a_instancingTransform2DRow1.w, a_instancingTransform2DRow2.w, 1.0  // Column 4
    );
    #else
    vec3 translation2D = vec3(0.0, 0.0, 0.0);
    vec3 scale = vec3(1.0, 1.0, 1.0);
    
        #ifdef HAS_INSTANCE_TRANSLATION
        translation2D = a_instanceTranslation2D;
        #endif
        #ifdef HAS_INSTANCE_SCALE
        scale = a_instanceScale;
        #endif

    instancingTransform2D = mat4(
        scale.x, 0.0, 0.0, 0.0,
        0.0, scale.y, 0.0, 0.0,
        0.0, 0.0, scale.z, 0.0,
        translation2D.x, translation2D.y, translation2D.z, 1.0
    ); 
    #endif

    return instancingTransform2D;
}
#endif
`;var q2=`void instancingStage(inout ProcessedAttributes attributes) 
{
    vec3 positionMC = attributes.positionMC;
    
    mat4 instancingTransform = getInstancingTransform();
    
    attributes.positionMC = (instancingTransform * vec4(positionMC, 1.0)).xyz;

    #ifdef HAS_NORMALS
    vec3 normalMC = attributes.normalMC;
    attributes.normalMC = (instancingTransform * vec4(normalMC, 0.0)).xyz;
    #endif

    #ifdef USE_2D_INSTANCING
    mat4 instancingTransform2D = getInstancingTransform2D();
    attributes.position2D = (instancingTransform2D * vec4(positionMC, 1.0)).xyz;
    #endif
}
`;var Y2=`void legacyInstancingStage(
    inout ProcessedAttributes attributes,
    out mat4 instanceModelView,
    out mat3 instanceModelViewInverseTranspose)
{
    vec3 positionMC = attributes.positionMC;

    mat4 instancingTransform = getInstancingTransform();
 
    mat4 instanceModel = instancingTransform * u_instance_nodeTransform;
    instanceModelView = u_instance_modifiedModelView;
    instanceModelViewInverseTranspose = mat3(u_instance_modifiedModelView * instanceModel);

    attributes.positionMC = (instanceModel * vec4(positionMC, 1.0)).xyz;
    
    #ifdef USE_2D_INSTANCING
    mat4 instancingTransform2D = getInstancingTransform2D();
    attributes.position2D = (instancingTransform2D * vec4(positionMC, 1.0)).xyz;
    #endif
}
`;var X2=new F,$He=new F,QHe=new F,lse={name:"InstancingPipelineStage",_getInstanceTransformsAsMatrices:mse,_transformsToTypedArray:KW};lse.process=function(e,t,n){let i=t.instances,o=i.attributes[0].count,r=e.shaderBuilder;r.addDefine("HAS_INSTANCING"),r.addVertexLines(j2);let s=e.model,a=s.sceneGraph,c=e.runtimeNode,l=n.mode!==ne.SCENE3D&&!n.scene3DOnly&&s._projectTo2D,f=s._enablePick&&!n.context.webgl2,d=[];h6e(e,n,i,d,l,f),_6e(e,n,i,d);let p={};if(i.transformInWorldSpace?(r.addDefine("USE_LEGACY_INSTANCING",void 0,_e.VERTEX),r.addUniform("mat4","u_instance_modifiedModelView",_e.VERTEX),r.addUniform("mat4","u_instance_nodeTransform",_e.VERTEX),p.u_instance_modifiedModelView=function(){let g=F.multiplyTransformation(s.modelMatrix,a.components.transform,X2);return l?F.multiplyTransformation(n.context.uniformState.view3D,g,X2):(n.mode!==ne.SCENE3D&&(g=Lt.basisTo2D(n.mapProjection,g,X2)),F.multiplyTransformation(n.context.uniformState.view,g,X2))},p.u_instance_nodeTransform=function(){return F.multiplyTransformation(a.axisCorrectionMatrix,c.computedTransform,$He)},r.addVertexLines(Y2)):r.addVertexLines(q2),l){r.addDefine("USE_2D_INSTANCING",void 0,_e.VERTEX),r.addUniform("mat4","u_modelView2D",_e.VERTEX);let g=n.context,m=F.fromTranslation(c.instancingReferencePoint2D,new F);p.u_modelView2D=function(){return F.multiplyTransformation(g.uniformState.view,m,QHe)}}e.uniformMap=bt(p,e.uniformMap),e.instanceCount=o,e.attributes.push.apply(e.attributes,d)};var Cw=new F,JHe=new h;function e6e(e,t,n,i,o){let r=F.multiplyTransformation(t,e,Cw);return r=F.multiplyTransformation(r,n,Cw),o=Lt.basisTo2D(i.mapProjection,r,o),o}function t6e(e,t,n,i,o){let r=F.fromTranslation(e,Cw),s=F.multiplyTransformation(t,r,Cw);s=F.multiplyTransformation(s,n,Cw);let a=F.getTranslation(s,JHe);return o=Wi.computeActualEllipsoidPosition(i,a,o),o}function use(e,t,n){let i=e.model,o=i.sceneGraph;e.runtimeNode.node.instances.transformInWorldSpace?(t=F.multiplyTransformation(i.modelMatrix,o.components.transform,t),n=F.multiplyTransformation(o.axisCorrectionMatrix,e.runtimeNode.computedTransform,n)):(t=F.clone(o.computedModelMatrix,t),t=F.multiplyTransformation(t,e.runtimeNode.computedTransform,t),n=F.clone(F.IDENTITY,n))}var fse=new F,dse=new F,n6e=new F,i6e=new h;function o6e(e,t,n,i){let o=fse,r=dse;use(t,o,r);let a=t.runtimeNode.instancingReferencePoint2D,c=e.length;for(let l=0;l<c;l++){let f=e[l],d=e6e(f,o,r,n,n6e),p=F.getTranslation(d,i6e),g=h.subtract(p,a,p);i[l]=F.setTranslation(d,g,i[l])}return i}function r6e(e,t,n,i){let o=fse,r=dse;use(t,o,r);let a=t.runtimeNode.instancingReferencePoint2D,c=e.length;for(let l=0;l<c;l++){let f=e[l],d=t6e(f,o,r,n,f);i[l]=h.subtract(d,a,i[l])}return i}var s6e=new h,a6e=new h;function hse(e,t){let n=e.runtimeNode,i=e.model.sceneGraph.computedModelMatrix,o=F.multiplyByPoint(i,n.instancingTranslationMin,s6e),r=Wi.computeActualEllipsoidPosition(t,o,o),s=F.multiplyByPoint(i,n.instancingTranslationMax,a6e),a=Wi.computeActualEllipsoidPosition(t,s,s);n.instancingReferencePoint2D=h.lerp(r,a,.5,new h)}function KW(e){let n=e.length,i=new Float32Array(n*12);for(let o=0;o<n;o++){let r=e[o],s=12*o;i[s+0]=r[0],i[s+1]=r[4],i[s+2]=r[8],i[s+3]=r[12],i[s+4]=r[1],i[s+5]=r[5],i[s+6]=r[9],i[s+7]=r[13],i[s+8]=r[2],i[s+9]=r[6],i[s+10]=r[10],i[s+11]=r[14]}return i}function c6e(e){let n=e.length,i=new Float32Array(n*3);for(let o=0;o<n;o++){let r=e[o],s=3*o;i[s+0]=r[0],i[s+1]=r[4],i[s+2]=r[8]}return i}var l6e=new h,u6e=new Le,f6e=new h;function mse(e,t,n){let i=new Array(t),o=Zt.getAttributeBySemantic(e,as.TRANSLATION),r=Zt.getAttributeBySemantic(e,as.ROTATION),s=Zt.getAttributeBySemantic(e,as.SCALE),a=new h(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),c=new h(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),l=u(o),f=u(r),d=u(s),p=l?o.typedArray:new Float32Array(t*3),g=f?r.typedArray:new Float32Array(t*4);f&&r.normalized&&(g=Ln.dequantize(g,r.componentDatatype,r.type,t));let m;d?m=s.typedArray:(m=new Float32Array(t*3),m.fill(1));for(let b=0;b<t;b++){let C=new h(p[b*3],p[b*3+1],p[b*3+2],l6e);h.maximumByComponent(a,C,a),h.minimumByComponent(c,C,c);let A=new Le(g[b*4],g[b*4+1],g[b*4+2],f?g[b*4+3]:1,u6e),T=new h(m[b*3],m[b*3+1],m[b*3+2],f6e),E=F.fromTranslationQuaternionRotationScale(C,A,T,new F);i[b]=E}let y=n.runtimeNode;return y.instancingTranslationMin=c,y.instancingTranslationMax=a,l&&(o.typedArray=void 0),f&&(r.typedArray=void 0),d&&(s.typedArray=void 0),i}function d6e(e,t,n){let i=new Array(t),o=e.typedArray,r=new h(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),s=new h(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let c=0;c<t;c++){let l=new h(o[c*3],o[c*3+1],o[c*3+2]);i[c]=l,h.minimumByComponent(r,l,r),h.maximumByComponent(s,l,s)}let a=n.runtimeNode;return a.instancingTranslationMin=r,a.instancingTranslationMax=s,e.typedArray=void 0,i}function ZW(e,t){let n=xt.createVertexBuffer({context:t.context,typedArray:e,usage:ke.STATIC_DRAW});return n.vertexArrayDestroyable=!1,n}function h6e(e,t,n,i,o,r){let s=Zt.getAttributeBySemantic(n,as.ROTATION);u(s)?m6e(e,n,i,t,o,r):p6e(e,n,i,t,o)}function m6e(e,t,n,i,o,r){let s=e.shaderBuilder,a=t.attributes[0].count,c=e.model,l=e.runtimeNode;s.addDefine("HAS_INSTANCE_MATRICES");let f="Transform",d,p=l.instancingTransformsBuffer;if(!u(p)){d=mse(t,a,e);let b=KW(d);p=ZW(b,i),c._modelResources.push(p),r&&(l.transformsTypedArray=b),l.instancingTransformsBuffer=p}if(cse(e,p,n,f),!o)return;let g=Ge(i);g.mode=ne.COLUMBUS_VIEW,hse(e,g);let m=l.instancingTransformsBuffer2D;if(!u(m)){let b=o6e(d,e,g,d),C=KW(b);m=ZW(C,i),c._modelResources.push(m),l.instancingTransformsBuffer2D=m}cse(e,m,n,"Transform2D")}function p6e(e,t,n,i,o,r){let s=e.shaderBuilder,a=e.runtimeNode,c=Zt.getAttributeBySemantic(t,as.TRANSLATION),l=Zt.getAttributeBySemantic(t,as.SCALE);if(u(l)&&(s.addDefine("HAS_INSTANCE_SCALE"),XW(e,l.buffer,l.byteOffset,l.byteStride,n,"Scale")),!u(c))return;let f,d=c.typedArray;if(u(d)?f=d6e(c,c.count,e):u(a.instancingTranslationMin)||(a.instancingTranslationMin=c.min,a.instancingTranslationMax=c.max),s.addDefine("HAS_INSTANCE_TRANSLATION"),XW(e,c.buffer,c.byteOffset,c.byteStride,n,"Translation"),!o&&!r)return;let g=Ge(i);g.mode=ne.COLUMBUS_VIEW,hse(e,g);let m=a.instancingTranslationBuffer2D;if(!u(m)){let A=r6e(f,e,g,f),T=c6e(A);r&&(a.transformsTypedArray=T),m=ZW(T,i),e.model._modelResources.push(m),a.instancingTranslationBuffer2D=m}if(!o)return;XW(e,m,0,void 0,n,"Translation2D")}function cse(e,t,n,i){let r=K.getSizeInBytes(K.FLOAT),s=r*12,a=[{index:e.attributeIndex++,vertexBuffer:t,componentsPerAttribute:4,componentDatatype:K.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:s,instanceDivisor:1},{index:e.attributeIndex++,vertexBuffer:t,componentsPerAttribute:4,componentDatatype:K.FLOAT,normalize:!1,offsetInBytes:r*4,strideInBytes:s,instanceDivisor:1},{index:e.attributeIndex++,vertexBuffer:t,componentsPerAttribute:4,componentDatatype:K.FLOAT,normalize:!1,offsetInBytes:r*8,strideInBytes:s,instanceDivisor:1}],c=e.shaderBuilder;c.addAttribute("vec4",`a_instancing${i}Row0`),c.addAttribute("vec4",`a_instancing${i}Row1`),c.addAttribute("vec4",`a_instancing${i}Row2`),n.push.apply(n,a)}function XW(e,t,n,i,o,r){o.push({index:e.attributeIndex++,vertexBuffer:t,componentsPerAttribute:3,componentDatatype:K.FLOAT,normalize:!1,offsetInBytes:n,strideInBytes:i,instanceDivisor:1}),e.shaderBuilder.addAttribute("vec3",`a_instance${r}`)}function _6e(e,t,n,i){let o=n.attributes,r=e.shaderBuilder;for(let s=0;s<o.length;s++){let a=o[s];a.semantic===as.FEATURE_ID&&(a.setIndex>=e.featureIdVertexAttributeSetIndex&&(e.featureIdVertexAttributeSetIndex=a.setIndex+1),i.push({index:e.attributeIndex++,vertexBuffer:a.buffer,componentsPerAttribute:rn.getNumberOfComponents(a.type),componentDatatype:a.componentDatatype,normalize:!1,offsetInBytes:a.byteOffset,strideInBytes:a.byteStride,instanceDivisor:1}),r.addAttribute("float",`a_instanceFeatureId_${a.setIndex}`))}}var K2=lse;var $W={};$W.name="ModelMatrixUpdateStage";$W.update=function(e,t,n){let i=n.mode!==ne.SCENE3D;if(!(i&&t._model._projectTo2D)&&e._transformDirty){let o=i?t._computedModelMatrix2D:t._computedModelMatrix;pse(e,t,o,e.transformToRoot),e._transformDirty=!1}};function g6e(e,t,n){e.modelMatrix=F.multiplyTransformation(t,n,e.modelMatrix),e.cullFace=Zt.getCullFace(e.modelMatrix,e.primitiveType)}function pse(e,t,n,i){let o;i=F.multiplyTransformation(i,e.transform,new F),e.updateComputedTransform();let r=e.runtimePrimitives.length;for(o=0;o<r;o++){let a=e.runtimePrimitives[o];g6e(a.drawCommand,n,i)}let s=e.children.length;for(o=0;o<s;o++){let a=t._runtimeNodes[e.children[o]];a._transformToRoot=F.clone(i,a._transformToRoot),pse(a,t,n,i),a._transformDirty=!1}}var Z2=$W;var _se={name:"NodeStatisticsPipelineStage",_countInstancingAttributes:gse,_countGeneratedBuffers:yse};_se.process=function(e,t,n){let i=e.model.statistics,o=t.instances,r=e.runtimeNode;gse(i,o),yse(i,r)};function gse(e,t){if(!u(t))return;let n=t.attributes,i=n.length;for(let o=0;o<i;o++){let r=n[o];u(r.buffer)&&e.addBuffer(r.buffer,!1)}}function yse(e,t){u(t.instancingTransformsBuffer)&&e.addBuffer(t.instancingTransformsBuffer,!1),u(t.instancingTransformsBuffer2D)&&e.addBuffer(t.instancingTransformsBuffer2D,!1),u(t.instancingTranslationBuffer2D)&&e.addBuffer(t.instancingTranslationBuffer2D,!1)}var $2=_se;function kA(e){e=x(e,x.EMPTY_OBJECT);let t=e.node,n=e.transform,i=e.transformToRoot,o=e.sceneGraph,r=e.children;this._node=t,this._name=t.name,this._id=t.index,this._sceneGraph=o,this._children=r,this._originalTransform=F.clone(n,this._originalTransform),this._transform=F.clone(n,this._transform),this._transformToRoot=F.clone(i,this._transformToRoot),this._computedTransform=new F,this._transformDirty=!1,this._transformParameters=void 0,this._morphWeights=[],this._runtimeSkin=void 0,this._computedJointMatrices=[],this.show=!0,this.userAnimated=!1,this.pipelineStages=[],this.runtimePrimitives=[],this.updateStages=[],this.instancingTranslationMin=void 0,this.instancingTranslationMax=void 0,this.instancingTransformsBuffer=void 0,this.instancingTransformsBuffer2D=void 0,this.instancingTranslationBuffer2D=void 0,this.instancingReferencePoint2D=void 0,y6e(this)}Object.defineProperties(kA.prototype,{node:{get:function(){return this._node}},sceneGraph:{get:function(){return this._sceneGraph}},children:{get:function(){return this._children}},transform:{get:function(){return this._transform},set:function(e){this._transformDirty=!0,this._transform=F.clone(e,this._transform)}},transformToRoot:{get:function(){return this._transformToRoot}},computedTransform:{get:function(){return this._computedTransform}},originalTransform:{get:function(){return this._originalTransform}},translation:{get:function(){return u(this._transformParameters)?this._transformParameters.translation:void 0},set:function(e){let t=this._transformParameters,n=t.translation;h.equals(n,e)||(t.translation=h.clone(e,t.translation),QW(this,t))}},rotation:{get:function(){return u(this._transformParameters)?this._transformParameters.rotation:void 0},set:function(e){let t=this._transformParameters,n=t.rotation;Le.equals(n,e)||(t.rotation=Le.clone(e,t.rotation),QW(this,t))}},scale:{get:function(){return u(this._transformParameters)?this._transformParameters.scale:void 0},set:function(e){let t=this._transformParameters,n=t.scale;h.equals(n,e)||(t.scale=h.clone(e,t.scale),QW(this,t))}},morphWeights:{get:function(){return this._morphWeights},set:function(e){let t=e.length;for(let n=0;n<t;n++)this._morphWeights[n]=e[n]}},runtimeSkin:{get:function(){return this._runtimeSkin}},computedJointMatrices:{get:function(){return this._computedJointMatrices}}});function y6e(e){let t=e.transform,n=e.transformToRoot,i=e._computedTransform;e._computedTransform=F.multiply(n,t,i);let o=e.node;u(o.matrix)||(e._transformParameters=new Yy(o.translation,o.rotation,o.scale)),u(o.morphWeights)&&(e._morphWeights=o.morphWeights.slice());let r=o.articulationName;if(u(r)){let c=e.sceneGraph._runtimeArticulations[r];u(c)&&c.runtimeNodes.push(e)}}function QW(e,t){e._transformDirty=!0,e._transform=F.fromTranslationRotationScale(t,e._transform)}kA.prototype.getChild=function(e){return this.sceneGraph._runtimeNodes[this.children[e]]};kA.prototype.configurePipeline=function(){let e=this.node,t=this.pipelineStages;t.length=0;let n=this.updateStages;n.length=0,u(e.instances)&&t.push(K2),t.push($2),n.push(Z2)};kA.prototype.updateComputedTransform=function(){this._computedTransform=F.multiply(this._transformToRoot,this._transform,this._computedTransform)};kA.prototype.updateJointMatrices=function(){let e=this._runtimeSkin;if(!u(e))return;e.updateJointMatrices();let t=this._computedJointMatrices,n=e.jointMatrices,i=n.length;for(let o=0;o<i;o++){u(t[o])||(t[o]=new F);let r=F.multiplyTransformation(this.transformToRoot,this.transform,t[o]),s=F.inverseTransformation(r,t[o]);t[o]=F.multiplyTransformation(s,n[o],t[o])}};var Q2=kA;var xse={name:"AlphaPipelineStage"};xse.process=function(e,t,n){let i=e.alphaOptions,o=e.model;i.pass=x(i.pass,o.opaquePass);let r=e.renderStateOptions;i.pass===we.TRANSLUCENT&&(r.cull.enabled=!1,r.depthMask=!1,r.blending=un.ALPHA_BLEND);let s=e.shaderBuilder,a=e.uniformMap;u(i.alphaCutoff)&&(s.addDefine("ALPHA_MODE_MASK",void 0,_e.FRAGMENT),s.addUniform("float","u_alphaCutoff",_e.FRAGMENT),a.u_alphaCutoff=function(){return i.alphaCutoff})};var J2=xse;var bse={name:"BatchTexturePipelineStage"};bse.process=function(e,t,n){let i=e.shaderBuilder,o={},r=e.model,s=r.featureTables[r.featureTableId],a=s.featuresLength;i.addUniform("int","model_featuresLength"),o.model_featuresLength=function(){return a};let c=s.batchTexture;i.addUniform("sampler2D","model_batchTexture"),o.model_batchTexture=function(){return x(c.batchTexture,c.defaultTexture)},i.addUniform("vec4","model_textureStep"),o.model_textureStep=function(){return c.textureStep},c.textureDimensions.y>1&&(i.addDefine("MULTILINE_BATCH_TEXTURE"),i.addUniform("vec2","model_textureDimensions"),o.model_textureDimensions=function(){return c.textureDimensions}),e.uniformMap=bt(o,e.uniformMap)};var eF=bse;var Cse={name:"ClassificationPipelineStage"};Cse.process=function(e,t,n){e.shaderBuilder.addDefine("HAS_CLASSIFICATION",void 0,_e.BOTH);let o=e.runtimePrimitive;u(o.batchLengths)||x6e(t,o)};function x6e(e,t){let n=Zt.getAttributeBySemantic(e,Tt.POSITION);if(!u(n))throw new ce("Primitives must have a position attribute to be used for classification.");let i,o=e.indices,r=u(o);r&&(i=o.typedArray,o.typedArray=void 0);let s=r?o.count:n.count,a=Zt.getAttributeBySemantic(e,Tt.FEATURE_ID,0);if(!u(a)){t.batchLengths=[s],t.batchOffsets=[0];return}let c=a.typedArray;a.typedArray=void 0;let l=[],f=[0],d=r?i[0]:0,p=c[d],g=0;for(let y=1;y<s;y++){let b=r?i[y]:y,C=c[b];if(C!==p){let A=y-g,T=y;l.push(A),f.push(T),g=T,p=C}}let m=s-g;l.push(m),t.batchLengths=l,t.batchOffsets=f}var tF=Cse;var nF=`void filterByPassType(inout vec3 positionMC, vec4 featureColor)
{
    bool styleTranslucent = (featureColor.a != 1.0);
    // Only render translucent features in the translucent pass (if the style or the original command has translucency).
    if (czm_pass == czm_passTranslucent && !styleTranslucent && !model_commandTranslucent)
    {
        // If the model has a translucent silhouette, it needs to render during the silhouette color command,
        // (i.e. the command where model_silhouettePass = true), even if the model isn't translucent.
        #ifdef HAS_SILHOUETTE
        positionMC *= float(model_silhouettePass);
        #else
        positionMC *= 0.0;
        #endif
    }
    // If the current pass is not the translucent pass and the style is not translucent, don't render the feature.
    else if (czm_pass != czm_passTranslucent && styleTranslucent)
    {
        positionMC *= 0.0;
    }
}

void cpuStylingStage(inout vec3 positionMC, inout SelectedFeature feature)
{
    float show = ceil(feature.color.a);
    positionMC *= show;

    #if defined(HAS_SELECTED_FEATURE_ID_ATTRIBUTE) && !defined(HAS_CLASSIFICATION)
    filterByPassType(positionMC, feature.color);
    #endif
}
`;var iF=`void filterByPassType(vec4 featureColor)
{
    bool styleTranslucent = (featureColor.a != 1.0);
    // Only render translucent features in the translucent pass (if the style or the original command has translucency).
    if (czm_pass == czm_passTranslucent && !styleTranslucent && !model_commandTranslucent)
    {   
        // If the model has a translucent silhouette, it needs to render during the silhouette color command,
        // (i.e. the command where model_silhouettePass = true), even if the model isn't translucent.
        #ifdef HAS_SILHOUETTE
        if(!model_silhouettePass) {
            discard;
        }
        #else
        discard;
        #endif
    }
    // If the current pass is not the translucent pass and the style is not translucent, don't render the feature.
    else if (czm_pass != czm_passTranslucent && styleTranslucent)
    {
        discard;
    }
}

void cpuStylingStage(inout czm_modelMaterial material, SelectedFeature feature)
{
    vec4 featureColor = feature.color;
    if (featureColor.a == 0.0)
    {
        discard;
    }

    // If a feature ID vertex attribute is used, the pass type filter is applied in the vertex shader.
    // So, we only apply in in the fragment shader if the feature ID texture is used.
    #if defined(HAS_SELECTED_FEATURE_ID_TEXTURE) && !defined(HAS_CLASSIFICATION)
    filterByPassType(featureColor);
    #endif

    featureColor = czm_gammaCorrect(featureColor);

    // Classification models compute the diffuse differently.
    #ifdef HAS_CLASSIFICATION
    material.diffuse = featureColor.rgb * featureColor.a;
    #else
    float highlight = ceil(model_colorBlend);
    material.diffuse *= mix(featureColor.rgb, vec3(1.0), highlight);
    #endif
    
    material.alpha *= featureColor.a;
}
`;var Ase={name:"CPUStylingPipelineStage"};Ase.process=function(e,t,n){let i=e.model,o=e.shaderBuilder;o.addVertexLines(nF),o.addFragmentLines(iF),o.addDefine("USE_CPU_STYLING",void 0,_e.BOTH),u(i.color)||(o.addUniform("float",gx.COLOR_BLEND_UNIFORM_NAME,_e.FRAGMENT),e.uniformMap[gx.COLOR_BLEND_UNIFORM_NAME]=function(){return Bc.getColorBlend(i.colorBlendMode,i.colorBlendAmount)}),o.addUniform("bool","model_commandTranslucent",_e.BOTH),e.uniformMap.model_commandTranslucent=function(){return e.alphaOptions.pass===we.TRANSLUCENT}};var oF=Ase;var Tse={MODIFY_MATERIAL:"MODIFY_MATERIAL",REPLACE_MATERIAL:"REPLACE_MATERIAL"};Tse.getDefineName=function(e){return`CUSTOM_SHADER_${e}`};var Ng=Object.freeze(Tse);var rF=`void customShaderStage(
    inout czm_modelVertexOutput vsOutput, 
    inout ProcessedAttributes attributes, 
    FeatureIds featureIds,
    Metadata metadata,
    MetadataClass metadataClass,
    MetadataStatistics metadataStatistics
) {
    // VertexInput and initializeInputStruct() are dynamically generated in JS, 
    // see CustomShaderPipelineStage.js
    VertexInput vsInput;
    initializeInputStruct(vsInput, attributes);
    vsInput.featureIds = featureIds;
    vsInput.metadata = metadata;
    vsInput.metadataClass = metadataClass;
    vsInput.metadataStatistics = metadataStatistics;
    vertexMain(vsInput, vsOutput);
    attributes.positionMC = vsOutput.positionMC;
}
`;var sF=`void customShaderStage(
    inout czm_modelMaterial material,
    ProcessedAttributes attributes,
    FeatureIds featureIds,
    Metadata metadata,
    MetadataClass metadataClass,
    MetadataStatistics metadataStatistics
) {
    // FragmentInput and initializeInputStruct() are dynamically generated in JS, 
    // see CustomShaderPipelineStage.js
    FragmentInput fsInput;
    initializeInputStruct(fsInput, attributes);
    fsInput.featureIds = featureIds;
    fsInput.metadata = metadata;
    fsInput.metadataClass = metadataClass;
    fsInput.metadataStatistics = metadataStatistics;
    fragmentMain(fsInput, material);
}
`;var aF=`void featureIdStage(out FeatureIds featureIds, ProcessedAttributes attributes) {
  initializeFeatureIds(featureIds, attributes);
  initializeFeatureIdAliases(featureIds);
}
`;var cF=`void featureIdStage(out FeatureIds featureIds, ProcessedAttributes attributes) 
{
  initializeFeatureIds(featureIds, attributes);
  initializeFeatureIdAliases(featureIds);
  setFeatureIdVaryings();
}
`;var Ni={name:"FeatureIdPipelineStage",STRUCT_ID_FEATURE_IDS_VS:"FeatureIdsVS",STRUCT_ID_FEATURE_IDS_FS:"FeatureIdsFS",STRUCT_NAME_FEATURE_IDS:"FeatureIds",FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS:"initializeFeatureIdsVS",FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS:"initializeFeatureIdsFS",FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_VS:"initializeFeatureIdAliasesVS",FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_FS:"initializeFeatureIdAliasesFS",FUNCTION_SIGNATURE_INITIALIZE_FEATURE_IDS:"void initializeFeatureIds(out FeatureIds featureIds, ProcessedAttributes attributes)",FUNCTION_SIGNATURE_INITIALIZE_FEATURE_ID_ALIASES:"void initializeFeatureIdAliases(inout FeatureIds featureIds)",FUNCTION_ID_SET_FEATURE_ID_VARYINGS:"setFeatureIdVaryings",FUNCTION_SIGNATURE_SET_FEATURE_ID_VARYINGS:"void setFeatureIdVaryings()"};Ni.process=function(e,t,n){let i=e.shaderBuilder;b6e(i);let o=e.runtimeNode.node.instances;u(o)&&C6e(e,o,n),A6e(e,t,n),i.addVertexLines(cF),i.addFragmentLines(aF)};function b6e(e){e.addStruct(Ni.STRUCT_ID_FEATURE_IDS_VS,Ni.STRUCT_NAME_FEATURE_IDS,_e.VERTEX),e.addStruct(Ni.STRUCT_ID_FEATURE_IDS_FS,Ni.STRUCT_NAME_FEATURE_IDS,_e.FRAGMENT),e.addFunction(Ni.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,Ni.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_IDS,_e.VERTEX),e.addFunction(Ni.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,Ni.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_IDS,_e.FRAGMENT),e.addFunction(Ni.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_VS,Ni.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_ID_ALIASES,_e.VERTEX),e.addFunction(Ni.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_FS,Ni.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_ID_ALIASES,_e.FRAGMENT),e.addFunction(Ni.FUNCTION_ID_SET_FEATURE_ID_VARYINGS,Ni.FUNCTION_SIGNATURE_SET_FEATURE_ID_VARYINGS,_e.VERTEX)}function C6e(e,t,n){let i=t.featureIds,o=t.attributes[0].count;for(let r=0;r<i.length;r++){let s=i[r],a=s.positionalLabel;s instanceof bn.FeatureIdAttribute?T6e(e,s,a):Ese(e,s,a,o,1,n);let c=s.label;u(c)&&Sse(e,a,c,_e.BOTH)}}function A6e(e,t,n){let i=t.featureIds,r=Zt.getAttributeBySemantic(t,Tt.POSITION).count;for(let s=0;s<i.length;s++){let a=i[s],c=a.positionalLabel,l=_e.BOTH;a instanceof bn.FeatureIdAttribute?E6e(e,a,c):a instanceof bn.FeatureIdImplicitRange?Ese(e,a,c,r,void 0,n):(S6e(e,a,c,s,n),l=_e.FRAGMENT);let f=a.label;u(f)&&Sse(e,c,f,l)}}function T6e(e,t,n){let i=e.shaderBuilder;i.addStructField(Ni.STRUCT_ID_FEATURE_IDS_VS,"int",n),i.addStructField(Ni.STRUCT_ID_FEATURE_IDS_FS,"int",n);let o=t.setIndex,r=n.replace(/_\d+$/,"_"),s=`a_${r}${o}`,a=`v_${r}${o}`,c=`featureIds.${n} = int(czm_round(${s}));`,l=`featureIds.${n} = int(czm_round(${a}));`;i.addFunctionLines(Ni.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,[c]),i.addFunctionLines(Ni.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,[l]),i.addVarying("float",a),i.addFunctionLines(Ni.FUNCTION_ID_SET_FEATURE_ID_VARYINGS,[`${a} = ${s};`])}function E6e(e,t,n){let i=e.shaderBuilder;i.addStructField(Ni.STRUCT_ID_FEATURE_IDS_VS,"int",n),i.addStructField(Ni.STRUCT_ID_FEATURE_IDS_FS,"int",n);let o=t.setIndex,r=n.replace(/_\d+$/,"_"),s=[`featureIds.${n} = int(czm_round(attributes.${r}${o}));`];i.addFunctionLines(Ni.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,s),i.addFunctionLines(Ni.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,s)}function Ese(e,t,n,i,o,r){v6e(e,t,i,o,r);let s=e.shaderBuilder,a=`a_implicit_${n}`;s.addAttribute("float",a);let c=`v_implicit_${n}`;s.addVarying("float",c),s.addStructField(Ni.STRUCT_ID_FEATURE_IDS_VS,"int",n),s.addStructField(Ni.STRUCT_ID_FEATURE_IDS_FS,"int",n),s.addFunctionLines(Ni.FUNCTION_ID_SET_FEATURE_ID_VARYINGS,[`${c} = ${a};`]),s.addFunctionLines(Ni.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,[`featureIds.${n} = int(czm_round(${a}));`]),s.addFunctionLines(Ni.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,[`featureIds.${n} = int(czm_round(${c}));`])}function S6e(e,t,n,i,o){let r=`u_featureIdTexture_${i}`,s=e.uniformMap,a=t.textureReader;s[r]=function(){return x(a.texture,o.context.defaultTexture)};let c=a.channels,l=e.shaderBuilder;l.addStructField(Ni.STRUCT_ID_FEATURE_IDS_FS,"int",n),l.addUniform("sampler2D",r,_e.FRAGMENT);let d=`v_texCoord_${a.texCoord}`,p=d,g=a.transform;if(u(g)&&!J.equals(g,J.IDENTITY)){let b=`${r}Transform`;l.addUniform("mat3",b,_e.FRAGMENT),s[b]=function(){return g},p=`vec2(${b} * vec3(${d}, 1.0))`}let m=`texture(${r}, ${p}).${c}`,y=`featureIds.${n} = czm_unpackUint(${m});`;l.addFunctionLines(Ni.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,[y])}function Sse(e,t,n,i){let o=e.shaderBuilder,r=_e.includesVertexShader(i);r&&o.addStructField(Ni.STRUCT_ID_FEATURE_IDS_VS,"int",n),o.addStructField(Ni.STRUCT_ID_FEATURE_IDS_FS,"int",n);let s=[`featureIds.${n} = featureIds.${t};`];r&&o.addFunctionLines(Ni.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_VS,s),o.addFunctionLines(Ni.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_FS,s)}function v6e(e,t,n,i,o){let r=e.model,s,a;if(u(t.repeat)){let l=w6e(t,n);s=xt.createVertexBuffer({context:o.context,typedArray:l,usage:ke.STATIC_DRAW}),s.vertexArrayDestroyable=!1,r._pipelineResources.push(s),r.statistics.addBuffer(s,!1)}else a=[t.offset];let c={index:e.attributeIndex++,instanceDivisor:i,value:a,vertexBuffer:s,normalize:!1,componentsPerAttribute:1,componentDatatype:K.FLOAT,strideInBytes:K.getSizeInBytes(K.FLOAT),offsetInBytes:0};e.attributes.push(c)}function w6e(e,t){let n=e.offset,i=e.repeat,o=new Float32Array(t);for(let r=0;r<t;r++)o[r]=n+Math.floor(r/i);return o}var yx=Ni;var lF=`void metadataStage(
  out Metadata metadata,
  out MetadataClass metadataClass,
  out MetadataStatistics metadataStatistics,
  ProcessedAttributes attributes
  )
{
  initializeMetadata(metadata, metadataClass, metadataStatistics, attributes);
}
`;var uF=`void metadataStage(
  out Metadata metadata,
  out MetadataClass metadataClass,
  out MetadataStatistics metadataStatistics,
  ProcessedAttributes attributes
  )
{
  initializeMetadata(metadata, metadataClass, metadataStatistics, attributes);
  setMetadataVaryings();
}
`;var Ti={name:"MetadataPipelineStage",STRUCT_ID_METADATA_VS:"MetadataVS",STRUCT_ID_METADATA_FS:"MetadataFS",STRUCT_NAME_METADATA:"Metadata",STRUCT_ID_METADATA_CLASS_VS:"MetadataClassVS",STRUCT_ID_METADATA_CLASS_FS:"MetadataClassFS",STRUCT_NAME_METADATA_CLASS:"MetadataClass",STRUCT_ID_METADATA_STATISTICS_VS:"MetadataStatisticsVS",STRUCT_ID_METADATA_STATISTICS_FS:"MetadataStatisticsFS",STRUCT_NAME_METADATA_STATISTICS:"MetadataStatistics",FUNCTION_ID_INITIALIZE_METADATA_VS:"initializeMetadataVS",FUNCTION_ID_INITIALIZE_METADATA_FS:"initializeMetadataFS",FUNCTION_SIGNATURE_INITIALIZE_METADATA:"void initializeMetadata(out Metadata metadata, out MetadataClass metadataClass, out MetadataStatistics metadataStatistics, ProcessedAttributes attributes)",FUNCTION_ID_SET_METADATA_VARYINGS:"setMetadataVaryings",FUNCTION_SIGNATURE_SET_METADATA_VARYINGS:"void setMetadataVaryings()",METADATA_CLASS_FIELDS:[{specName:"noData",shaderName:"noData"},{specName:"default",shaderName:"defaultValue"},{specName:"min",shaderName:"minValue"},{specName:"max",shaderName:"maxValue"}],METADATA_STATISTICS_FIELDS:[{specName:"min",shaderName:"minValue"},{specName:"max",shaderName:"maxValue"},{specName:"mean",shaderName:"mean",type:"float"},{specName:"median",shaderName:"median"},{specName:"standardDeviation",shaderName:"standardDeviation",type:"float"},{specName:"variance",shaderName:"variance",type:"float"},{specName:"sum",shaderName:"sum"}]};Ti.process=function(e,t,n){let{shaderBuilder:i,model:o}=e,{structuralMetadata:r={},content:s}=o,a=s?.tileset.metadataExtension?.statistics,c=D6e(r.propertyAttributes,t,a),l=P6e(r.propertyTextures,a),f=c.concat(l);O6e(i,f),N6e(i),i.addVertexLines(uF),i.addFragmentLines(lF);for(let d=0;d<c.length;d++){let p=c[d];F6e(e,p)}for(let d=0;d<l.length;d++){let p=l[d];k6e(e,p)}};function D6e(e,t,n){return u(e)?e.flatMap(i=>I6e(i,t,n)):[]}function I6e(e,t,n){let{getAttributeByName:i,getAttributeInfo:o,sanitizeGlslIdentifier:r}=Zt,s=e.class.id,a=n?.classes[s],c=Object.entries(e.properties),l=new Array(c.length);for(let f=0;f<c.length;f++){let[d,p]=c[f],g=i(t,p.attribute),{glslType:m,variableName:y}=o(g);l[f]={metadataVariable:r(d),property:p,type:p.classProperty.type,glslType:m,variableName:y,propertyStatistics:a?.properties[d],shaderDestination:_e.BOTH}}return l}function P6e(e,t){return u(e)?e.flatMap(n=>R6e(n,t)):[]}function R6e(e,t){let{sanitizeGlslIdentifier:n}=Zt,i=e.class.id,o=t?.classes[i],r=Object.entries(e.properties).filter(([a,c])=>c.isGpuCompatible()),s=new Array(r.length);for(let a=0;a<r.length;a++){let[c,l]=r[a];s[a]={metadataVariable:n(c),property:l,type:l.classProperty.type,glslType:l.getGlslType(),propertyStatistics:o?.properties[c],shaderDestination:_e.FRAGMENT}}return s}function O6e(e,t){let n=new Set,i=new Set;for(let a=0;a<t.length;a++){let{type:c,glslType:l,propertyStatistics:f}=t[a];n.add(l),u(f)&&c!==Et.ENUM&&i.add(l)}let o=Ti.METADATA_CLASS_FIELDS;for(let a of n){let c=`${a}MetadataClass`;s(c,a,o)}let r=Ti.METADATA_STATISTICS_FIELDS;for(let a of i){let c=`${a}MetadataStatistics`;s(c,a,r)}function s(a,c,l){e.addStruct(a,a,_e.BOTH);for(let f=0;f<l.length;f++){let{shaderName:d}=l[f],p=l[f].type==="float"?L6e(c):c;e.addStructField(a,p,d)}}}var M6e={int:"float",ivec2:"vec2",ivec3:"vec3",ivec4:"vec4"};function L6e(e){let t=M6e[e];return u(t)?t:e}function N6e(e){e.addStruct(Ti.STRUCT_ID_METADATA_VS,Ti.STRUCT_NAME_METADATA,_e.VERTEX),e.addStruct(Ti.STRUCT_ID_METADATA_FS,Ti.STRUCT_NAME_METADATA,_e.FRAGMENT),e.addStruct(Ti.STRUCT_ID_METADATA_CLASS_VS,Ti.STRUCT_NAME_METADATA_CLASS,_e.VERTEX),e.addStruct(Ti.STRUCT_ID_METADATA_CLASS_FS,Ti.STRUCT_NAME_METADATA_CLASS,_e.FRAGMENT),e.addStruct(Ti.STRUCT_ID_METADATA_STATISTICS_VS,Ti.STRUCT_NAME_METADATA_STATISTICS,_e.VERTEX),e.addStruct(Ti.STRUCT_ID_METADATA_STATISTICS_FS,Ti.STRUCT_NAME_METADATA_STATISTICS,_e.FRAGMENT),e.addFunction(Ti.FUNCTION_ID_INITIALIZE_METADATA_VS,Ti.FUNCTION_SIGNATURE_INITIALIZE_METADATA,_e.VERTEX),e.addFunction(Ti.FUNCTION_ID_INITIALIZE_METADATA_FS,Ti.FUNCTION_SIGNATURE_INITIALIZE_METADATA,_e.FRAGMENT),e.addFunction(Ti.FUNCTION_ID_SET_METADATA_VARYINGS,Ti.FUNCTION_SIGNATURE_SET_METADATA_VARYINGS,_e.VERTEX)}function F6e(e,t){B6e(e,t),vse(e.shaderBuilder,t),wse(e.shaderBuilder,t)}function B6e(e,t){let{shaderBuilder:n}=e,{metadataVariable:i,property:o,glslType:r}=t,s=Ise({valueExpression:`attributes.${t.variableName}`,renderResources:e,glslType:r,metadataVariable:i,shaderDestination:_e.BOTH,property:o});n.addStructField(Ti.STRUCT_ID_METADATA_VS,r,i),n.addStructField(Ti.STRUCT_ID_METADATA_FS,r,i);let a=`metadata.${i} = ${s};`;n.addFunctionLines(Ti.FUNCTION_ID_INITIALIZE_METADATA_VS,[a]),n.addFunctionLines(Ti.FUNCTION_ID_INITIALIZE_METADATA_FS,[a])}function k6e(e,t){V6e(e,t),vse(e.shaderBuilder,t),wse(e.shaderBuilder,t)}function V6e(e,t){let{shaderBuilder:n,uniformMap:i}=e,{metadataVariable:o,glslType:r,property:s}=t,{texCoord:a,channels:c,index:l,texture:f,transform:d}=s.textureReader,p=`u_propertyTexture_${l}`;i.hasOwnProperty(p)||(n.addUniform("sampler2D",p,_e.FRAGMENT),i[p]=()=>f),n.addStructField(Ti.STRUCT_ID_METADATA_FS,r,o);let g=`attributes.texCoord_${a}`,m=g;if(u(d)&&!J.equals(d,J.IDENTITY)){let T=`${p}Transform`;n.addUniform("mat3",T,_e.FRAGMENT),i[T]=function(){return d},m=`vec2(${T} * vec3(${g}, 1.0))`}let y=`texture(${p}, ${m}).${c}`,b=s.unpackInShader(y),C=Ise({valueExpression:b,renderResources:e,glslType:r,metadataVariable:o,shaderDestination:_e.FRAGMENT,property:s}),A=`metadata.${o} = ${C};`;n.addFunctionLines(Ti.FUNCTION_ID_INITIALIZE_METADATA_FS,[A])}function vse(e,t){let{classProperty:n}=t.property,{metadataVariable:i,glslType:o,shaderDestination:r}=t,s=Dse(Ti.METADATA_CLASS_FIELDS,n,`metadataClass.${i}`,o),a=`${o}MetadataClass`;e.addStructField(Ti.STRUCT_ID_METADATA_CLASS_FS,a,i),e.addFunctionLines(Ti.FUNCTION_ID_INITIALIZE_METADATA_FS,s),_e.includesVertexShader(r)&&(e.addStructField(Ti.STRUCT_ID_METADATA_CLASS_VS,a,i),e.addFunctionLines(Ti.FUNCTION_ID_INITIALIZE_METADATA_VS,s))}function wse(e,t){let{propertyStatistics:n}=t;if(!u(n))return;let{metadataVariable:i,type:o,glslType:r}=t;if(o===Et.ENUM)return;let s=Ti.METADATA_STATISTICS_FIELDS,a=`metadataStatistics.${i}`,c=Dse(s,n,a,r),l=`${r}MetadataStatistics`;e.addStructField(Ti.STRUCT_ID_METADATA_STATISTICS_FS,l,i),e.addFunctionLines(Ti.FUNCTION_ID_INITIALIZE_METADATA_FS,c),_e.includesVertexShader(t.shaderDestination)&&(e.addStructField(Ti.STRUCT_ID_METADATA_STATISTICS_VS,l,i),e.addFunctionLines(Ti.FUNCTION_ID_INITIALIZE_METADATA_VS,c))}function Dse(e,t,n,i){function o(r){let s=t[r.specName];if(u(s))return`${n}.${r.shaderName} = ${i}(${s});`}return u(t)?e.map(o).filter(u):[]}function Ise(e){let{valueExpression:t,property:n}=e;if(!n.hasValueTransform)return t;let i=e.metadataVariable,o=`u_${i}_offset`,r=`u_${i}_scale`,{shaderBuilder:s,uniformMap:a}=e.renderResources,{glslType:c,shaderDestination:l}=e;s.addUniform(c,o,l),s.addUniform(c,r,l);let{offset:f,scale:d}=n;return a[o]=()=>f,a[r]=()=>d,`czm_valueTransform(${o}, ${r}, ${t})`}var Ad=Ti;var U6e={INHERIT:0,OPAQUE:1,TRANSLUCENT:2},xx=Object.freeze(U6e);var ra={name:"CustomShaderPipelineStage",STRUCT_ID_ATTRIBUTES_VS:"AttributesVS",STRUCT_ID_ATTRIBUTES_FS:"AttributesFS",STRUCT_NAME_ATTRIBUTES:"Attributes",STRUCT_ID_VERTEX_INPUT:"VertexInput",STRUCT_NAME_VERTEX_INPUT:"VertexInput",STRUCT_ID_FRAGMENT_INPUT:"FragmentInput",STRUCT_NAME_FRAGMENT_INPUT:"FragmentInput",FUNCTION_ID_INITIALIZE_INPUT_STRUCT_VS:"initializeInputStructVS",FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_VS:"void initializeInputStruct(out VertexInput vsInput, ProcessedAttributes attributes)",FUNCTION_ID_INITIALIZE_INPUT_STRUCT_FS:"initializeInputStructFS",FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_FS:"void initializeInputStruct(out FragmentInput fsInput, ProcessedAttributes attributes)",_oneTimeWarning:At};ra.process=function(e,t,n){let{shaderBuilder:i,model:o,alphaOptions:r}=e,{customShader:s}=o,{lightingModel:a,translucencyMode:c}=s;u(a)&&(e.lightingOptions.lightingModel=a),c===xx.TRANSLUCENT?r.pass=we.TRANSLUCENT:c===xx.OPAQUE&&(r.pass=void 0);let l=X6e(s,t);if(!l.customShaderEnabled)return;if(Q6e(i,s,l),l.shouldComputePositionWC&&i.addDefine("COMPUTE_POSITION_WC_CUSTOM_SHADER",void 0,_e.BOTH),u(s.vertexShaderText)&&i.addDefine("HAS_CUSTOM_VERTEX_SHADER",void 0,_e.VERTEX),u(s.fragmentShaderText)){i.addDefine("HAS_CUSTOM_FRAGMENT_SHADER",void 0,_e.FRAGMENT);let p=Ng.getDefineName(s.mode);i.addDefine(p,void 0,_e.FRAGMENT)}let f=s.uniforms;for(let p in f)if(f.hasOwnProperty(p)){let g=f[p];i.addUniform(g.type,p)}let d=s.varyings;for(let p in d)if(d.hasOwnProperty(p)){let g=d[p];i.addVarying(g,p)}e.uniformMap=bt(e.uniformMap,s.uniformMap)};function z6e(e){let t={};for(let n=0;n<e.length;n++){let i=Zt.getAttributeInfo(e[n]);t[i.variableName]=i}return t}var H6e={position:"vec3",normal:"vec3",tangent:"vec3",bitangent:"vec3",texCoord:"vec2",color:"vec4",joints:"ivec4",weights:"vec4"},G6e={position:"vec3(0.0)",normal:"vec3(0.0, 0.0, 1.0)",tangent:"vec3(1.0, 0.0, 0.0)",bitangent:"vec3(0.0, 1.0, 0.0)",texCoord:"vec2(0.0)",color:"vec4(1.0)",joints:"ivec4(0)",weights:"vec4(0.0)"};function Pse(e){let t=e.replace(/_[0-9]+$/,"");t=t.replace(/(MC|EC)$/,"");let n=H6e[t],i=G6e[t];if(u(n))return{attributeField:[n,e],value:i}}function W6e(e,t){if(!u(e.vertexShaderText))return{enabled:!1};let n=e.usedVariablesVertex.attributeSet,i=Rse(t,n,!1),o=Ose(t,n,!1),r,s=[],a=[];for(let c in i){if(!i.hasOwnProperty(c))continue;let f=[i[c].glslType,c];s.push(f),r=`vsInput.attributes.${c} = attributes.${c};`,a.push(r)}for(let c=0;c<o.length;c++){let l=o[c],f=Pse(l);if(!u(f))return ra._oneTimeWarning("CustomShaderPipelineStage.incompatiblePrimitiveVS",`Primitive is missing attribute ${l}, disabling custom vertex shader`),{enabled:!1};s.push(f.attributeField),r=`vsInput.attributes.${l} = ${f.value};`,a.push(r)}return{enabled:!0,attributeFields:s,initializationLines:a}}function j6e(e){let t=[],n=[],i=e.usedVariablesFragment.attributeSet;return i.hasOwnProperty("positionWC")&&(t.push(["vec3","positionWC"]),n.push("fsInput.attributes.positionWC = attributes.positionWC;")),i.hasOwnProperty("positionEC")&&(t.push(["vec3","positionEC"]),n.push("fsInput.attributes.positionEC = attributes.positionEC;")),{attributeFields:t,initializationLines:n}}function q6e(e,t){if(!u(e.fragmentShaderText))return{enabled:!1};let n=e.usedVariablesFragment.attributeSet,i=Rse(t,n,!0),o=Ose(t,n,!0),r,s=[],a=[];for(let l in i){if(!i.hasOwnProperty(l))continue;let d=[i[l].glslType,l];s.push(d),r=`fsInput.attributes.${l} = attributes.${l};`,a.push(r)}for(let l=0;l<o.length;l++){let f=o[l],d=Pse(f);if(!u(d))return ra._oneTimeWarning("CustomShaderPipelineStage.incompatiblePrimitiveFS",`Primitive is missing attribute ${f}, disabling custom fragment shader.`),{enabled:!1};s.push(d.attributeField),r=`fsInput.attributes.${f} = ${d.value};`,a.push(r)}let c=j6e(e);return{enabled:!0,attributeFields:s.concat(c.attributeFields),initializationLines:c.initializationLines.concat(a)}}var Y6e={positionWC:!0,positionEC:!0};function Rse(e,t,n){let i={};for(let o in e){if(!e.hasOwnProperty(o))continue;let r=e[o],s=o;n&&o==="normalMC"?s="normalEC":n&&o==="tangentMC"&&(s="tangentEC",r.glslType="vec3"),t.hasOwnProperty(s)&&(i[s]=r)}return i}function Ose(e,t,n){let i=[];for(let o in t){if(!t.hasOwnProperty(o)||Y6e.hasOwnProperty(o))continue;let r=o;n&&o==="normalEC"?r="normalMC":n&&o==="tangentEC"&&(r="tangentMC"),e.hasOwnProperty(r)||i.push(o)}return i}function X6e(e,t){let n=z6e(t.attributes),i=W6e(e,n),o=q6e(e,n),s=e.usedVariablesFragment.attributeSet.hasOwnProperty("positionWC")&&o.enabled;return{vertexLines:i,fragmentLines:o,customShaderEnabled:i.enabled||o.enabled,shouldComputePositionWC:s}}function K6e(e,t){let n=ra.STRUCT_ID_ATTRIBUTES_VS;e.addStruct(n,ra.STRUCT_NAME_ATTRIBUTES,_e.VERTEX);let{attributeFields:i,initializationLines:o}=t;for(let s=0;s<i.length;s++){let[a,c]=i[s];e.addStructField(n,a,c)}n=ra.STRUCT_ID_VERTEX_INPUT,e.addStruct(n,ra.STRUCT_NAME_VERTEX_INPUT,_e.VERTEX),e.addStructField(n,ra.STRUCT_NAME_ATTRIBUTES,"attributes"),e.addStructField(n,yx.STRUCT_NAME_FEATURE_IDS,"featureIds"),e.addStructField(n,Ad.STRUCT_NAME_METADATA,"metadata"),e.addStructField(n,Ad.STRUCT_NAME_METADATA_CLASS,"metadataClass"),e.addStructField(n,Ad.STRUCT_NAME_METADATA_STATISTICS,"metadataStatistics");let r=ra.FUNCTION_ID_INITIALIZE_INPUT_STRUCT_VS;e.addFunction(r,ra.FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_VS,_e.VERTEX),e.addFunctionLines(r,o)}function Z6e(e,t){let n=ra.STRUCT_ID_ATTRIBUTES_FS;e.addStruct(n,ra.STRUCT_NAME_ATTRIBUTES,_e.FRAGMENT);let{attributeFields:i,initializationLines:o}=t;for(let s=0;s<i.length;s++){let[a,c]=i[s];e.addStructField(n,a,c)}n=ra.STRUCT_ID_FRAGMENT_INPUT,e.addStruct(n,ra.STRUCT_NAME_FRAGMENT_INPUT,_e.FRAGMENT),e.addStructField(n,ra.STRUCT_NAME_ATTRIBUTES,"attributes"),e.addStructField(n,yx.STRUCT_NAME_FEATURE_IDS,"featureIds"),e.addStructField(n,Ad.STRUCT_NAME_METADATA,"metadata"),e.addStructField(n,Ad.STRUCT_NAME_METADATA_CLASS,"metadataClass"),e.addStructField(n,Ad.STRUCT_NAME_METADATA_STATISTICS,"metadataStatistics");let r=ra.FUNCTION_ID_INITIALIZE_INPUT_STRUCT_FS;e.addFunction(r,ra.FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_FS,_e.FRAGMENT),e.addFunctionLines(r,o)}var $6e=[];function Q6e(e,t,n){let{vertexLines:i,fragmentLines:o}=n,r=$6e;i.enabled&&(K6e(e,i),r.length=0,r.push("#line 0",t.vertexShaderText,rF),e.addVertexLines(r)),o.enabled&&(Z6e(e,o),r.length=0,r.push("#line 0",t.fragmentShaderText,sF),e.addFragmentLines(r))}var fF=ra;var Aw={name:"DequantizationPipelineStage",FUNCTION_ID_DEQUANTIZATION_STAGE_VS:"dequantizationStage",FUNCTION_SIGNATURE_DEQUANTIZATION_STAGE_VS:"void dequantizationStage(inout ProcessedAttributes attributes)"};Aw.process=function(e,t,n){let i=e.shaderBuilder,o=e.model,r=u(o.classificationType);i.addDefine("USE_DEQUANTIZATION",void 0,_e.VERTEX),i.addFunction(Aw.FUNCTION_ID_DEQUANTIZATION_STAGE_VS,Aw.FUNCTION_SIGNATURE_DEQUANTIZATION_STAGE_VS,_e.VERTEX);let s=t.attributes;for(let a=0;a<s.length;a++){let c=s[a],l=c.quantization;if(!u(l))continue;let f=c.semantic===Tt.POSITION,d=c.semantic===Tt.TEXCOORD;if(r&&!f&&!d)continue;let p=Zt.getAttributeInfo(c);eGe(i,p),J6e(e,p)}};function J6e(e,t){let n=e.shaderBuilder,i=e.uniformMap,o=t.variableName,r=t.attribute.quantization;if(r.octEncoded){let s=`model_normalizationRange_${o}`;n.addUniform("float",s,_e.VERTEX),i[s]=function(){return r.normalizationRange}}else{let s=`model_quantizedVolumeOffset_${o}`,a=`model_quantizedVolumeStepSize_${o}`,c=t.glslType;n.addUniform(c,s,_e.VERTEX),n.addUniform(c,a,_e.VERTEX);let l=r.quantizedVolumeOffset,f=r.quantizedVolumeStepSize;/^color_\d+$/.test(o)&&(l=Mse(l,0),f=Mse(f,1)),i[s]=function(){return l},i[a]=function(){return f}}}function Mse(e,t){return e instanceof oe?e:new oe(e.x,e.y,e.z,t)}function eGe(e,t){let n=t.variableName,i=t.attribute.quantization,o;i.octEncoded?o=tGe(n,i):o=nGe(n),e.addFunctionLines(Aw.FUNCTION_ID_DEQUANTIZATION_STAGE_VS,[o])}function tGe(e,t){let n=`attributes.${e}`,i=`a_quantized_${e}`,o=`model_normalizationRange_${e}`,r=t.octEncodedZXY?".zxy":".xyz";return`${n} = czm_octDecode(${i}, ${o})${r};`}function nGe(e){let t=`attributes.${e}`,n=`a_quantized_${e}`,i=`model_quantizedVolumeOffset_${e}`,o=`model_quantizedVolumeStepSize_${e}`;return`${t} = ${i} + ${n} * ${o};`}var dF=Aw;var hF=`void geometryStage(out ProcessedAttributes attributes)
{
  attributes.positionMC = v_positionMC;
  attributes.positionEC = v_positionEC;

  #if defined(COMPUTE_POSITION_WC_CUSTOM_SHADER) || defined(COMPUTE_POSITION_WC_STYLE) || defined(COMPUTE_POSITION_WC_ATMOSPHERE)
  attributes.positionWC = v_positionWC;
  #endif

  #ifdef HAS_NORMALS
  // renormalize after interpolation
  attributes.normalEC = normalize(v_normalEC);
  #endif

  #ifdef HAS_TANGENTS
  attributes.tangentEC = normalize(v_tangentEC);
  #endif

  #ifdef HAS_BITANGENTS
  attributes.bitangentEC = normalize(v_bitangentEC);
  #endif

  // Everything else is dynamically generated in GeometryPipelineStage
  setDynamicVaryings(attributes);
}
`;var mF=`vec4 geometryStage(inout ProcessedAttributes attributes, mat4 modelView, mat3 normal)
{
    vec4 computedPosition;

    // Compute positions in different coordinate systems
    vec3 positionMC = attributes.positionMC;
    v_positionMC = positionMC;
    v_positionEC = (modelView * vec4(positionMC, 1.0)).xyz;

    #if defined(USE_2D_POSITIONS) || defined(USE_2D_INSTANCING)
    vec3 position2D = attributes.position2D;
    vec3 positionEC = (u_modelView2D * vec4(position2D, 1.0)).xyz;
    computedPosition = czm_projection * vec4(positionEC, 1.0);
    #else
    computedPosition = czm_projection * vec4(v_positionEC, 1.0);
    #endif

    // Sometimes the custom shader and/or style needs this
    #if defined(COMPUTE_POSITION_WC_CUSTOM_SHADER) || defined(COMPUTE_POSITION_WC_STYLE) || defined(COMPUTE_POSITION_WC_ATMOSPHERE) || defined(ENABLE_CLIPPING_POLYGONS)
    // Note that this is a 32-bit position which may result in jitter on small
    // scales.
    v_positionWC = (czm_model * vec4(positionMC, 1.0)).xyz;
    #endif

    #ifdef HAS_NORMALS
    v_normalEC = normalize(normal * attributes.normalMC);
    #endif

    #ifdef HAS_TANGENTS
    v_tangentEC = normalize(normal * attributes.tangentMC);
    #endif

    #ifdef HAS_BITANGENTS
    v_bitangentEC = normalize(normal * attributes.bitangentMC);
    #endif

    // All other varyings need to be dynamically generated in
    // GeometryPipelineStage
    setDynamicVaryings(attributes);

    return computedPosition;
}
`;var Tw=`vec2 computeSt(float featureId)
{
    float stepX = model_textureStep.x;
    float centerX = model_textureStep.y;

    #ifdef MULTILINE_BATCH_TEXTURE
    float stepY = model_textureStep.z;
    float centerY = model_textureStep.w;

    float xId = mod(featureId, model_textureDimensions.x); 
    float yId = floor(featureId / model_textureDimensions.x);
    
    return vec2(centerX + (xId * stepX), centerY + (yId * stepY));
    #else
    return vec2(centerX + (featureId * stepX), 0.5);
    #endif
}

void selectedFeatureIdStage(out SelectedFeature feature, FeatureIds featureIds)
{   
    int featureId = featureIds.SELECTED_FEATURE_ID;


    if (featureId < model_featuresLength)
    {
        vec2 featureSt = computeSt(float(featureId));

        feature.id = featureId;
        feature.st = featureSt;
        feature.color = texture(model_batchTexture, featureSt);
    }
    // Floating point comparisons can be unreliable in GLSL, so we
    // increment the feature ID to make sure it's always greater
    // then the model_featuresLength - a condition we check for in the
    // pick ID, to avoid sampling the pick texture if the feature ID is
    // greater than the number of features.
    else
    {
        feature.id = model_featuresLength + 1;
        feature.st = vec2(0.0);
        feature.color = vec4(1.0);
    }

    #ifdef HAS_NULL_FEATURE_ID
    if (featureId == model_nullFeatureId) {
        feature.id = featureId;
        feature.st = vec2(0.0);
        feature.color = vec4(1.0);
    }
    #endif
}
`;var Ew={name:"SelectedFeatureIdPipelineStage",STRUCT_ID_SELECTED_FEATURE:"SelectedFeature",STRUCT_NAME_SELECTED_FEATURE:"SelectedFeature"};Ew.process=function(e,t,n){let i=e.shaderBuilder;e.hasPropertyTable=!0;let o=e.model,r=e.runtimeNode.node,s=iGe(o,r,t),a=s.shaderDestination;i.addDefine("HAS_SELECTED_FEATURE_ID",void 0,a),i.addDefine("SELECTED_FEATURE_ID",s.variableName,a),i.addDefine(s.featureIdDefine,void 0,a),oGe(i);let c=s.featureIds.nullFeatureId,l=e.uniformMap;u(c)&&(i.addDefine("HAS_NULL_FEATURE_ID",void 0,a),i.addUniform("int","model_nullFeatureId",a),l.model_nullFeatureId=function(){return c}),s.shaderDestination===_e.BOTH&&i.addVertexLines(Tw),i.addFragmentLines(Tw)};function Lse(e){return e instanceof bn.FeatureIdTexture?"HAS_SELECTED_FEATURE_ID_TEXTURE":"HAS_SELECTED_FEATURE_ID_ATTRIBUTE"}function Nse(e){return e instanceof bn.FeatureIdTexture?_e.FRAGMENT:_e.BOTH}function iGe(e,t,n){let i,o;return u(t.instances)&&(o=Zt.getFeatureIdsByLabel(t.instances.featureIds,e.instanceFeatureIdLabel),u(o))?(i=x(o.label,o.positionalLabel),{featureIds:o,variableName:i,shaderDestination:Nse(o),featureIdDefine:Lse(o)}):(o=Zt.getFeatureIdsByLabel(n.featureIds,e.featureIdLabel),i=x(o.label,o.positionalLabel),{featureIds:o,variableName:i,shaderDestination:Nse(o),featureIdDefine:Lse(o)})}function oGe(e){e.addStructField(Ew.STRUCT_ID_SELECTED_FEATURE,"int","id"),e.addStructField(Ew.STRUCT_ID_SELECTED_FEATURE,"vec2","st"),e.addStructField(Ew.STRUCT_ID_SELECTED_FEATURE,"vec4","color")}var bx=Ew;var Vs={name:"GeometryPipelineStage",STRUCT_ID_PROCESSED_ATTRIBUTES_VS:"ProcessedAttributesVS",STRUCT_ID_PROCESSED_ATTRIBUTES_FS:"ProcessedAttributesFS",STRUCT_NAME_PROCESSED_ATTRIBUTES:"ProcessedAttributes",FUNCTION_ID_INITIALIZE_ATTRIBUTES:"initializeAttributes",FUNCTION_SIGNATURE_INITIALIZE_ATTRIBUTES:"void initializeAttributes(out ProcessedAttributes attributes)",FUNCTION_ID_SET_DYNAMIC_VARYINGS_VS:"setDynamicVaryingsVS",FUNCTION_ID_SET_DYNAMIC_VARYINGS_FS:"setDynamicVaryingsFS",FUNCTION_SIGNATURE_SET_DYNAMIC_VARYINGS:"void setDynamicVaryings(inout ProcessedAttributes attributes)"};Vs.process=function(e,t,n){let{shaderBuilder:i,model:o}=e;i.addStruct(Vs.STRUCT_ID_PROCESSED_ATTRIBUTES_VS,"ProcessedAttributes",_e.VERTEX),i.addStruct(Vs.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"ProcessedAttributes",_e.FRAGMENT),i.addStruct(bx.STRUCT_ID_SELECTED_FEATURE,bx.STRUCT_NAME_SELECTED_FEATURE,_e.BOTH),i.addFunction(Vs.FUNCTION_ID_INITIALIZE_ATTRIBUTES,Vs.FUNCTION_SIGNATURE_INITIALIZE_ATTRIBUTES,_e.VERTEX),i.addVarying("vec3","v_positionWC"),i.addVarying("vec3","v_positionEC"),i.addStructField(Vs.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"vec3","positionWC"),i.addStructField(Vs.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"vec3","positionEC"),i.addFunction(Vs.FUNCTION_ID_SET_DYNAMIC_VARYINGS_VS,Vs.FUNCTION_SIGNATURE_SET_DYNAMIC_VARYINGS,_e.VERTEX),i.addFunction(Vs.FUNCTION_ID_SET_DYNAMIC_VARYINGS_FS,Vs.FUNCTION_SIGNATURE_SET_DYNAMIC_VARYINGS,_e.FRAGMENT),o.type===Cr.TILE_PNTS&&i.addDefine("HAS_SRGB_COLOR",void 0,_e.FRAGMENT);let r=n.mode!==ne.SCENE3D&&!n.scene3DOnly&&o._projectTo2D,s=u(e.runtimeNode.node.instances),a=r&&!s,c=t.attributes.length;for(let l=0;l<c;l++){let f=t.attributes[l],d=rn.getAttributeLocationCount(f.type),p=f.semantic===Tt.POSITION,g;d>1?(g=e.attributeIndex,e.attributeIndex+=d):p&&!a?g=0:g=e.attributeIndex++,rGe(e,f,g,d,r,s)}mGe(i,t.attributes),t.primitiveType===Ne.POINTS&&i.addDefine("PRIMITIVE_TYPE_POINTS"),i.addVertexLines(mF),i.addFragmentLines(hF)};function rGe(e,t,n,i,o,r){let s=e.shaderBuilder,a=Zt.getAttributeInfo(t),c=o&&!r;i>1?cGe(e,t,n,i):aGe(e,t,n,c),uGe(s,a,c),lGe(s,a),u(t.semantic)&&sGe(s,t),fGe(s,a,o),dGe(s,a,c),hGe(s,a)}function sGe(e,t){let{semantic:n,setIndex:i}=t;switch(n){case Tt.NORMAL:e.addDefine("HAS_NORMALS");break;case Tt.TANGENT:e.addDefine("HAS_TANGENTS");break;case Tt.FEATURE_ID:e.addDefine(`HAS${n}_${i}`);break;case Tt.TEXCOORD:case Tt.COLOR:e.addDefine(`HAS_${n}_${i}`)}}function aGe(e,t,n,i){let{quantization:o,semantic:r,setIndex:s}=t,{type:a,componentDatatype:c}=u(o)?o:t;r===Tt.FEATURE_ID&&s>=e.featureIdVertexAttributeSetIndex&&(e.featureIdVertexAttributeSetIndex=s+1);let l=r===Tt.POSITION,f=l?0:n,d=rn.getNumberOfComponents(a),p={index:f,value:u(t.buffer)?void 0:t.constant,vertexBuffer:t.buffer,count:t.count,componentsPerAttribute:d,componentDatatype:c,offsetInBytes:t.byteOffset,strideInBytes:t.byteStride,normalize:t.normalized};if(e.attributes.push(p),!l||!i)return;let g=e.runtimePrimitive.positionBuffer2D,m={index:n,vertexBuffer:g,count:t.count,componentsPerAttribute:d,componentDatatype:K.FLOAT,offsetInBytes:0,strideInBytes:void 0,normalize:t.normalized};e.attributes.push(m)}function cGe(e,t,n,i){let{quantization:o,normalized:r}=t,{type:s,componentDatatype:a}=u(o)?o:t,l=rn.getNumberOfComponents(s)/i,f=K.getSizeInBytes(a),d=l*f,p=t.byteStride;for(let g=0;g<i;g++){let m=t.byteOffset+g*d,y={index:n+g,vertexBuffer:t.buffer,componentsPerAttribute:l,componentDatatype:a,offsetInBytes:m,strideInBytes:p,normalize:r};e.attributes.push(y)}}function lGe(e,t){let n=t.variableName,i=`v_${n}`,o;n==="normalMC"?(i="v_normalEC",o=t.glslType):n==="tangentMC"?(o="vec3",i="v_tangentEC"):o=t.glslType,e.addVarying(o,i)}function uGe(e,t,n){let i=t.attribute.semantic,o=t.variableName,r,s;t.isQuantized?(r=`a_quantized_${o}`,s=t.quantizedGlslType):(r=`a_${o}`,s=t.glslType);let a=i===Tt.POSITION;a?e.setPositionAttribute(s,r):e.addAttribute(s,r),a&&n&&e.addAttribute("vec3","a_position2D")}function fGe(e,t,n){let i=Vs.STRUCT_ID_PROCESSED_ATTRIBUTES_VS,o=Vs.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,{variableName:r,glslType:s}=t;r==="tangentMC"?(e.addStructField(i,"vec3","tangentMC"),e.addStructField(i,"float","tangentSignMC"),e.addStructField(o,"vec3","tangentEC")):r==="normalMC"?(e.addStructField(i,"vec3","normalMC"),e.addStructField(o,"vec3","normalEC")):(e.addStructField(i,s,r),e.addStructField(o,s,r)),r==="positionMC"&&n&&e.addStructField(i,"vec3","position2D")}function dGe(e,t,n){let i=Vs.FUNCTION_ID_INITIALIZE_ATTRIBUTES,o=t.variableName;if(o==="positionMC"&&n&&e.addFunctionLines(i,["attributes.position2D = a_position2D;"]),t.isQuantized)return;let s=[];o==="tangentMC"?(s.push("attributes.tangentMC = a_tangentMC.xyz;"),s.push("attributes.tangentSignMC = a_tangentMC.w;")):s.push(`attributes.${o} = a_${o};`),e.addFunctionLines(i,s)}function hGe(e,t){let{semantic:n,setIndex:i}=t.attribute;if(u(n)&&!u(i))return;let o=Vs.FUNCTION_ID_SET_DYNAMIC_VARYINGS_VS,r=t.variableName,s=`v_${r} = attributes.${r};`;e.addFunctionLines(o,[s]),o=Vs.FUNCTION_ID_SET_DYNAMIC_VARYINGS_FS,s=`attributes.${r} = v_${r};`,e.addFunctionLines(o,[s])}function mGe(e,t){let n=!1,i=!1;for(let o=0;o<t.length;o++){let r=t[o];r.semantic===Tt.NORMAL?n=!0:r.semantic===Tt.TANGENT&&(i=!0)}!n||!i||(e.addDefine("HAS_BITANGENTS"),e.addVarying("vec3","v_bitangentEC"),e.addStructField(Vs.STRUCT_ID_PROCESSED_ATTRIBUTES_VS,"vec3","bitangentMC"),e.addStructField(Vs.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"vec3","bitangentEC"))}var pF=Vs;var _F=`#ifdef USE_IBL_LIGHTING
vec3 computeIBL(vec3 position, vec3 normal, vec3 lightDirection, vec3 lightColorHdr, czm_modelMaterial material)
{
    #if defined(DIFFUSE_IBL) || defined(SPECULAR_IBL)
        // Environment maps were provided, use them for IBL
        vec3 viewDirection = -normalize(position);
        vec3 iblColor = textureIBL(viewDirection, normal, material);
        return iblColor;
    #endif
    
    return vec3(0.0);
}
#endif

#ifdef USE_CLEARCOAT
vec3 addClearcoatReflection(vec3 baseLayerColor, vec3 position, vec3 lightDirection, vec3 lightColorHdr, czm_modelMaterial material)
{
    vec3 viewDirection = -normalize(position);
    vec3 halfwayDirection = normalize(viewDirection + lightDirection);
    vec3 normal = material.clearcoatNormal;
    float NdotL = clamp(dot(normal, lightDirection), 0.001, 1.0);

    // clearcoatF0 = vec3(pow((ior - 1.0) / (ior + 1.0), 2.0)), but without KHR_materials_ior, ior is a constant 1.5.
    vec3 f0 = vec3(0.04);
    vec3 f90 = vec3(1.0);
    // Note: clearcoat Fresnel computed with dot(n, v) instead of dot(v, h).
    // This is to make it energy conserving with a simple layering function.
    float NdotV = clamp(dot(normal, viewDirection), 0.0, 1.0);
    vec3 F = fresnelSchlick2(f0, f90, NdotV);

    // compute specular reflection from direct lighting
    float roughness = material.clearcoatRoughness;
    float alphaRoughness = roughness * roughness;
    float directStrength = computeDirectSpecularStrength(normal, lightDirection, viewDirection, halfwayDirection, alphaRoughness);
    vec3 directReflection = F * directStrength * NdotL;
    vec3 color = lightColorHdr * directReflection;

    #ifdef SPECULAR_IBL
        // Find the direction in which to sample the environment map
        vec3 reflectMC = normalize(model_iblReferenceFrameMatrix * reflect(-viewDirection, normal));
        vec3 iblColor = computeSpecularIBL(reflectMC, NdotV, f0, roughness);
        color += iblColor * material.occlusion;
    #endif

    float clearcoatFactor = material.clearcoatFactor;
    vec3 clearcoatColor = color * clearcoatFactor;

    // Dim base layer based on transmission loss through clearcoat
    return baseLayerColor * (1.0 - clearcoatFactor * F) + clearcoatColor;
}
#endif

#if defined(LIGHTING_PBR) && defined(HAS_NORMALS)
vec3 computePbrLighting(in czm_modelMaterial material, in vec3 position)
{
    #ifdef USE_CUSTOM_LIGHT_COLOR
        vec3 lightColorHdr = model_lightColorHdr;
    #else
        vec3 lightColorHdr = czm_lightColorHdr;
    #endif

    vec3 viewDirection = -normalize(position);
    vec3 normal = material.normalEC;
    vec3 lightDirection = normalize(czm_lightDirectionEC);

    vec3 directLighting = czm_pbrLighting(viewDirection, normal, lightDirection, material);
    vec3 directColor = lightColorHdr * directLighting;

    // Accumulate colors from base layer
    vec3 color = directColor + material.emissive;
    #ifdef USE_IBL_LIGHTING
        color += computeIBL(position, normal, lightDirection, lightColorHdr, material);
    #endif

    #ifdef USE_CLEARCOAT
        color = addClearcoatReflection(color, position, lightDirection, lightColorHdr, material);
    #endif

    return color;
}
#endif

/**
 * Compute the material color under the current lighting conditions.
 * All other material properties are passed through so further stages
 * have access to them.
 *
 * @param {czm_modelMaterial} material The material properties from {@MaterialStageFS}
 * @param {ProcessedAttributes} attributes
 */
void lightingStage(inout czm_modelMaterial material, ProcessedAttributes attributes)
{
    #ifdef LIGHTING_PBR
        #ifdef HAS_NORMALS
            vec3 color = computePbrLighting(material, attributes.positionEC);
        #else
            vec3 color = material.diffuse * material.occlusion + material.emissive;
        #endif
        // In HDR mode, the frame buffer is in linear color space. The
        // post-processing stages (see PostProcessStageCollection) will handle
        // tonemapping. However, if HDR is not enabled, we must tonemap else large
        // values may be clamped to 1.0
        #ifndef HDR
            color = czm_pbrNeutralTonemapping(color);
        #endif
    #else // unlit
        vec3 color = material.diffuse;
    #endif

    #ifdef HAS_POINT_CLOUD_COLOR_STYLE
        // The colors resulting from point cloud styles are adjusted differently.
        color = czm_gammaCorrect(color);
    #elif !defined(HDR)
        // If HDR is not enabled, the frame buffer stores sRGB colors rather than
        // linear colors so the linear value must be converted.
        color = czm_linearToSrgb(color);
    #endif

    material.diffuse = color;
}
`;var pGe={UNLIT:0,PBR:1},Ip=Object.freeze(pGe);var Fse={name:"LightingPipelineStage"};Fse.process=function(e,t){let{model:n,lightingOptions:i,shaderBuilder:o}=e;if(u(n.lightColor)){o.addDefine("USE_CUSTOM_LIGHT_COLOR",void 0,_e.FRAGMENT),o.addUniform("vec3","model_lightColorHdr",_e.FRAGMENT);let s=e.uniformMap;s.model_lightColorHdr=function(){return n.lightColor}}let{lightingModel:r}=i;r===Ip.PBR?o.addDefine("LIGHTING_PBR",void 0,_e.FRAGMENT):o.addDefine("LIGHTING_UNLIT",void 0,_e.FRAGMENT),o.addFragmentLines(_F)};var gF=Fse;var yF=`// If the style color is white, it implies the feature has not been styled.
bool isDefaultStyleColor(vec3 color)
{
    return all(greaterThan(color, vec3(1.0 - czm_epsilon3)));
}

vec3 blend(vec3 sourceColor, vec3 styleColor, float styleColorBlend)
{
    vec3 blendColor = mix(sourceColor, styleColor, styleColorBlend);
    vec3 color = isDefaultStyleColor(styleColor.rgb) ? sourceColor : blendColor;
    return color;
}

vec2 computeTextureTransform(vec2 texCoord, mat3 textureTransform)
{
    return vec2(textureTransform * vec3(texCoord, 1.0));
}

#ifdef HAS_NORMAL_TEXTURE
vec2 getNormalTexCoords()
{
    vec2 texCoord = TEXCOORD_NORMAL;
    #ifdef HAS_NORMAL_TEXTURE_TRANSFORM
        texCoord = vec2(u_normalTextureTransform * vec3(texCoord, 1.0));
    #endif
    return texCoord;
}
#endif

#if defined(HAS_NORMAL_TEXTURE) || defined(HAS_CLEARCOAT_NORMAL_TEXTURE)
vec3 computeTangent(in vec3 position, in vec2 normalTexCoords)
{
    vec2 tex_dx = dFdx(normalTexCoords);
    vec2 tex_dy = dFdy(normalTexCoords);
    float determinant = tex_dx.x * tex_dy.y - tex_dy.x * tex_dx.y;
    vec3 tangent = tex_dy.t * dFdx(position) - tex_dx.t * dFdy(position);
    return tangent / determinant;
}
#endif

#ifdef USE_ANISOTROPY
struct NormalInfo {
    vec3 tangent;
    vec3 bitangent;
    vec3 normal;
    vec3 geometryNormal;
};

NormalInfo getNormalInfo(ProcessedAttributes attributes)
{
    vec3 geometryNormal = attributes.normalEC;
    #ifdef HAS_NORMAL_TEXTURE
        vec2 normalTexCoords = getNormalTexCoords();
    #endif

    #ifdef HAS_BITANGENTS
        vec3 tangent = attributes.tangentEC;
        vec3 bitangent = attributes.bitangentEC;
    #else // Assume HAS_NORMAL_TEXTURE
        vec3 tangent = computeTangent(attributes.positionEC, normalTexCoords);
        tangent = normalize(tangent - geometryNormal * dot(geometryNormal, tangent));
        vec3 bitangent = normalize(cross(geometryNormal, tangent));
    #endif

    #ifdef HAS_NORMAL_TEXTURE
        mat3 tbn = mat3(tangent, bitangent, geometryNormal);
        vec3 normalSample = texture(u_normalTexture, normalTexCoords).rgb;
        normalSample = 2.0 * normalSample - 1.0;
        #ifdef HAS_NORMAL_TEXTURE_SCALE
            normalSample.xy *= u_normalTextureScale;
        #endif
        vec3 normal = normalize(tbn * normalSample);
    #else
        vec3 normal = geometryNormal;
    #endif

    #ifdef HAS_DOUBLE_SIDED_MATERIAL
        if (czm_backFacing()) {
            tangent *= -1.0;
            bitangent *= -1.0;
            normal *= -1.0;
            geometryNormal *= -1.0;
        }
    #endif

    NormalInfo normalInfo;
    normalInfo.tangent = tangent;
    normalInfo.bitangent = bitangent;
    normalInfo.normal = normal;
    normalInfo.geometryNormal = geometryNormal;

    return normalInfo;
}
#endif

#if defined(HAS_NORMAL_TEXTURE) && !defined(HAS_WIREFRAME)
vec3 getNormalFromTexture(ProcessedAttributes attributes, vec3 geometryNormal)
{
    vec2 normalTexCoords = getNormalTexCoords();

    // If HAS_BITANGENTS is set, then HAS_TANGENTS is also set
    #ifdef HAS_BITANGENTS
        vec3 t = attributes.tangentEC;
        vec3 b = attributes.bitangentEC;
    #else
        vec3 t = computeTangent(attributes.positionEC, normalTexCoords);
        t = normalize(t - geometryNormal * dot(geometryNormal, t));
        vec3 b = normalize(cross(geometryNormal, t));
    #endif

    mat3 tbn = mat3(t, b, geometryNormal);
    vec3 normalSample = texture(u_normalTexture, normalTexCoords).rgb;
    normalSample = 2.0 * normalSample - 1.0;
    #ifdef HAS_NORMAL_TEXTURE_SCALE
        normalSample.xy *= u_normalTextureScale;
    #endif
    return normalize(tbn * normalSample);
}
#endif

#ifdef HAS_CLEARCOAT_NORMAL_TEXTURE
vec3 getClearcoatNormalFromTexture(ProcessedAttributes attributes, vec3 geometryNormal)
{
    vec2 normalTexCoords = TEXCOORD_CLEARCOAT_NORMAL;
    #ifdef HAS_CLEARCOAT_NORMAL_TEXTURE_TRANSFORM
        normalTexCoords = vec2(u_clearcoatNormalTextureTransform * vec3(normalTexCoords, 1.0));
    #endif

    // If HAS_BITANGENTS is set, then HAS_TANGENTS is also set
    #ifdef HAS_BITANGENTS
        vec3 t = attributes.tangentEC;
        vec3 b = attributes.bitangentEC;
    #else
        vec3 t = computeTangent(attributes.positionEC, normalTexCoords);
        t = normalize(t - geometryNormal * dot(geometryNormal, t));
        vec3 b = normalize(cross(geometryNormal, t));
    #endif

    mat3 tbn = mat3(t, b, geometryNormal);
    vec3 normalSample = texture(u_clearcoatNormalTexture, normalTexCoords).rgb;
    normalSample = 2.0 * normalSample - 1.0;
    #ifdef HAS_CLEARCOAT_NORMAL_TEXTURE_SCALE
        normalSample.xy *= u_clearcoatNormalTextureScale;
    #endif
    return normalize(tbn * normalSample);
}
#endif

#ifdef HAS_NORMALS
vec3 computeNormal(ProcessedAttributes attributes)
{
    // Geometry normal. This is already normalized 
    vec3 normal = attributes.normalEC;

    #if defined(HAS_NORMAL_TEXTURE) && !defined(HAS_WIREFRAME)
        normal = getNormalFromTexture(attributes, normal);
    #endif

    #ifdef HAS_DOUBLE_SIDED_MATERIAL
        if (czm_backFacing()) {
            normal = -normal;
        }
    #endif

    return normal;
}
#endif

#ifdef HAS_BASE_COLOR_TEXTURE
vec4 getBaseColorFromTexture()
{
    vec2 baseColorTexCoords = TEXCOORD_BASE_COLOR;
    #ifdef HAS_BASE_COLOR_TEXTURE_TRANSFORM
        baseColorTexCoords = computeTextureTransform(baseColorTexCoords, u_baseColorTextureTransform);
    #endif

    vec4 baseColorWithAlpha = czm_srgbToLinear(texture(u_baseColorTexture, baseColorTexCoords));

    #ifdef HAS_BASE_COLOR_FACTOR
        baseColorWithAlpha *= u_baseColorFactor;
    #endif

    return baseColorWithAlpha;
}
#endif

#ifdef HAS_EMISSIVE_TEXTURE
vec3 getEmissiveFromTexture()
{
    vec2 emissiveTexCoords = TEXCOORD_EMISSIVE;
    #ifdef HAS_EMISSIVE_TEXTURE_TRANSFORM
        emissiveTexCoords = computeTextureTransform(emissiveTexCoords, u_emissiveTextureTransform);
    #endif

    vec3 emissive = czm_srgbToLinear(texture(u_emissiveTexture, emissiveTexCoords).rgb);
    #ifdef HAS_EMISSIVE_FACTOR
        emissive *= u_emissiveFactor;
    #endif

    return emissive;
}
#endif

#if defined(LIGHTING_PBR) && defined(USE_SPECULAR_GLOSSINESS)
void setSpecularGlossiness(inout czm_modelMaterial material)
{
    #ifdef HAS_SPECULAR_GLOSSINESS_TEXTURE
        vec2 specularGlossinessTexCoords = TEXCOORD_SPECULAR_GLOSSINESS;
        #ifdef HAS_SPECULAR_GLOSSINESS_TEXTURE_TRANSFORM
            specularGlossinessTexCoords = computeTextureTransform(specularGlossinessTexCoords, u_specularGlossinessTextureTransform);
        #endif

        vec4 specularGlossiness = czm_srgbToLinear(texture(u_specularGlossinessTexture, specularGlossinessTexCoords));
        vec3 specular = specularGlossiness.rgb;
        float glossiness = specularGlossiness.a;
        #ifdef HAS_LEGACY_SPECULAR_FACTOR
            specular *= u_legacySpecularFactor;
        #endif

        #ifdef HAS_GLOSSINESS_FACTOR
            glossiness *= u_glossinessFactor;
        #endif
    #else
        #ifdef HAS_LEGACY_SPECULAR_FACTOR
            vec3 specular = clamp(u_legacySpecularFactor, vec3(0.0), vec3(1.0));
        #else
            vec3 specular = vec3(1.0);
        #endif

        #ifdef HAS_GLOSSINESS_FACTOR
            float glossiness = clamp(u_glossinessFactor, 0.0, 1.0);
        #else
            float glossiness = 1.0;
        #endif
    #endif

    #ifdef HAS_DIFFUSE_TEXTURE
        vec2 diffuseTexCoords = TEXCOORD_DIFFUSE;
        #ifdef HAS_DIFFUSE_TEXTURE_TRANSFORM
            diffuseTexCoords = computeTextureTransform(diffuseTexCoords, u_diffuseTextureTransform);
        #endif

        vec4 diffuse = czm_srgbToLinear(texture(u_diffuseTexture, diffuseTexCoords));
        #ifdef HAS_DIFFUSE_FACTOR
            diffuse *= u_diffuseFactor;
        #endif
    #elif defined(HAS_DIFFUSE_FACTOR)
        vec4 diffuse = clamp(u_diffuseFactor, vec4(0.0), vec4(1.0));
    #else
        vec4 diffuse = vec4(1.0);
    #endif

    material.diffuse = diffuse.rgb * (1.0 - czm_maximumComponent(specular));
    // the specular glossiness extension's alpha overrides anything set
    // by the base material.
    material.alpha = diffuse.a;

    material.specular = specular;

    // glossiness is the opposite of roughness, but easier for artists to use.
    material.roughness = 1.0 - glossiness;
}
#elif defined(LIGHTING_PBR)
float setMetallicRoughness(inout czm_modelMaterial material)
{
    #ifdef HAS_METALLIC_ROUGHNESS_TEXTURE
        vec2 metallicRoughnessTexCoords = TEXCOORD_METALLIC_ROUGHNESS;
        #ifdef HAS_METALLIC_ROUGHNESS_TEXTURE_TRANSFORM
            metallicRoughnessTexCoords = computeTextureTransform(metallicRoughnessTexCoords, u_metallicRoughnessTextureTransform);
        #endif

        vec3 metallicRoughness = texture(u_metallicRoughnessTexture, metallicRoughnessTexCoords).rgb;
        float metalness = clamp(metallicRoughness.b, 0.0, 1.0);
        float roughness = clamp(metallicRoughness.g, 0.0, 1.0);
        #ifdef HAS_METALLIC_FACTOR
            metalness = clamp(metalness * u_metallicFactor, 0.0, 1.0);
        #endif

        #ifdef HAS_ROUGHNESS_FACTOR
            roughness = clamp(roughness * u_roughnessFactor, 0.0, 1.0);
        #endif
    #else
        #ifdef HAS_METALLIC_FACTOR
            float metalness = clamp(u_metallicFactor, 0.0, 1.0);
        #else
            float metalness = 1.0;
        #endif

        #ifdef HAS_ROUGHNESS_FACTOR
            float roughness = clamp(u_roughnessFactor, 0.0, 1.0);
        #else
            float roughness = 1.0;
        #endif
    #endif

    // dielectrics use f0 = 0.04, metals use albedo as f0
    const vec3 REFLECTANCE_DIELECTRIC = vec3(0.04);
    vec3 f0 = mix(REFLECTANCE_DIELECTRIC, material.baseColor.rgb, metalness);

    material.specular = f0;

    // diffuse only applies to dielectrics.
    material.diffuse = mix(material.baseColor.rgb, vec3(0.0), metalness);

    // This is perceptual roughness. The square of this value is used for direct lighting
    material.roughness = roughness;

    return metalness;
}
#ifdef USE_SPECULAR
void setSpecular(inout czm_modelMaterial material, in float metalness)
{
    #ifdef HAS_SPECULAR_TEXTURE
        vec2 specularTexCoords = TEXCOORD_SPECULAR;
        #ifdef HAS_SPECULAR_TEXTURE_TRANSFORM
            specularTexCoords = computeTextureTransform(specularTexCoords, u_specularTextureTransform);
        #endif
        float specularWeight = texture(u_specularTexture, specularTexCoords).a;
        #ifdef HAS_SPECULAR_FACTOR
            specularWeight *= u_specularFactor;
        #endif
    #else
        #ifdef HAS_SPECULAR_FACTOR
            float specularWeight = u_specularFactor;
        #else
            float specularWeight = 1.0;
        #endif
    #endif

    #ifdef HAS_SPECULAR_COLOR_TEXTURE
        vec2 specularColorTexCoords = TEXCOORD_SPECULAR_COLOR;
        #ifdef HAS_SPECULAR_COLOR_TEXTURE_TRANSFORM
            specularColorTexCoords = computeTextureTransform(specularColorTexCoords, u_specularColorTextureTransform);
        #endif
        vec3 specularColorSample = texture(u_specularColorTexture, specularColorTexCoords).rgb;
        vec3 specularColorFactor = czm_srgbToLinear(specularColorSample);
        #ifdef HAS_SPECULAR_COLOR_FACTOR
            specularColorFactor *= u_specularColorFactor;
        #endif
    #else
        #ifdef HAS_SPECULAR_COLOR_FACTOR
            vec3 specularColorFactor = u_specularColorFactor;
        #else
            vec3 specularColorFactor = vec3(1.0);
        #endif
    #endif
    material.specularWeight = specularWeight;
    vec3 f0 = material.specular;
    vec3 dielectricSpecularF0 = min(f0 * specularColorFactor, vec3(1.0));
    material.specular = mix(dielectricSpecularF0, material.baseColor.rgb, metalness);
}
#endif
#ifdef USE_ANISOTROPY
void setAnisotropy(inout czm_modelMaterial material, in NormalInfo normalInfo)
{
    mat2 rotation = mat2(u_anisotropy.xy, -u_anisotropy.y, u_anisotropy.x);
    float anisotropyStrength = u_anisotropy.z;

    vec2 direction = vec2(1.0, 0.0);
    #ifdef HAS_ANISOTROPY_TEXTURE
        vec2 anisotropyTexCoords = TEXCOORD_ANISOTROPY;
        #ifdef HAS_ANISOTROPY_TEXTURE_TRANSFORM
            anisotropyTexCoords = computeTextureTransform(anisotropyTexCoords, u_anisotropyTextureTransform);
        #endif
        vec3 anisotropySample = texture(u_anisotropyTexture, anisotropyTexCoords).rgb;
        direction = anisotropySample.rg * 2.0 - vec2(1.0);
        anisotropyStrength *= anisotropySample.b;
    #endif

    direction = rotation * direction;
    mat3 tbn = mat3(normalInfo.tangent, normalInfo.bitangent, normalInfo.normal);
    vec3 anisotropicT = tbn * normalize(vec3(direction, 0.0));
    vec3 anisotropicB = cross(normalInfo.geometryNormal, anisotropicT);

    material.anisotropicT = anisotropicT;
    material.anisotropicB = anisotropicB;
    material.anisotropyStrength = anisotropyStrength;
}
#endif
#ifdef USE_CLEARCOAT
void setClearcoat(inout czm_modelMaterial material, in ProcessedAttributes attributes)
{
    #ifdef HAS_CLEARCOAT_TEXTURE
        vec2 clearcoatTexCoords = TEXCOORD_CLEARCOAT;
        #ifdef HAS_CLEARCOAT_TEXTURE_TRANSFORM
            clearcoatTexCoords = computeTextureTransform(clearcoatTexCoords, u_clearcoatTextureTransform);
        #endif
        float clearcoatFactor = texture(u_clearcoatTexture, clearcoatTexCoords).r;
        #ifdef HAS_CLEARCOAT_FACTOR
            clearcoatFactor *= u_clearcoatFactor;
        #endif
    #else
        #ifdef HAS_CLEARCOAT_FACTOR
            float clearcoatFactor = u_clearcoatFactor;
        #else
            // PERFORMANCE_IDEA: this case should turn the whole extension off
            float clearcoatFactor = 0.0;
        #endif
    #endif

    #ifdef HAS_CLEARCOAT_ROUGHNESS_TEXTURE
        vec2 clearcoatRoughnessTexCoords = TEXCOORD_CLEARCOAT_ROUGHNESS;
        #ifdef HAS_CLEARCOAT_ROUGHNESS_TEXTURE_TRANSFORM
            clearcoatRoughnessTexCoords = computeTextureTransform(clearcoatRoughnessTexCoords, u_clearcoatRoughnessTextureTransform);
        #endif
        float clearcoatRoughness = texture(u_clearcoatRoughnessTexture, clearcoatRoughnessTexCoords).g;
        #ifdef HAS_CLEARCOAT_ROUGHNESS_FACTOR
            clearcoatRoughness *= u_clearcoatRoughnessFactor;
        #endif
    #else
        #ifdef HAS_CLEARCOAT_ROUGHNESS_FACTOR
            float clearcoatRoughness = u_clearcoatRoughnessFactor;
        #else
            float clearcoatRoughness = 0.0;
        #endif
    #endif

    material.clearcoatFactor = clearcoatFactor;
    // This is perceptual roughness. The square of this value is used for direct lighting
    material.clearcoatRoughness = clearcoatRoughness;
    #ifdef HAS_CLEARCOAT_NORMAL_TEXTURE
        material.clearcoatNormal = getClearcoatNormalFromTexture(attributes, attributes.normalEC);
    #else
        material.clearcoatNormal = attributes.normalEC;
    #endif
}
#endif
#endif

void materialStage(inout czm_modelMaterial material, ProcessedAttributes attributes, SelectedFeature feature)
{
    #ifdef USE_ANISOTROPY
        NormalInfo normalInfo = getNormalInfo(attributes);
        material.normalEC = normalInfo.normal;
    #elif defined(HAS_NORMALS)
        material.normalEC = computeNormal(attributes);
    #endif

    vec4 baseColorWithAlpha = vec4(1.0);
    // Regardless of whether we use PBR, set a base color
    #ifdef HAS_BASE_COLOR_TEXTURE
        baseColorWithAlpha = getBaseColorFromTexture();
    #elif defined(HAS_BASE_COLOR_FACTOR)
        baseColorWithAlpha = u_baseColorFactor;
    #endif

    #ifdef HAS_POINT_CLOUD_COLOR_STYLE
        baseColorWithAlpha = v_pointCloudColor;
    #elif defined(HAS_COLOR_0)
        vec4 color = attributes.color_0;
        // .pnts files store colors in the sRGB color space
        #ifdef HAS_SRGB_COLOR
            color = czm_srgbToLinear(color);
        #endif
        baseColorWithAlpha *= color;
    #endif

    #ifdef USE_CPU_STYLING
        baseColorWithAlpha.rgb = blend(baseColorWithAlpha.rgb, feature.color.rgb, model_colorBlend);
    #endif
    material.baseColor = baseColorWithAlpha;
    material.diffuse = baseColorWithAlpha.rgb;
    material.alpha = baseColorWithAlpha.a;

    #ifdef HAS_OCCLUSION_TEXTURE
        vec2 occlusionTexCoords = TEXCOORD_OCCLUSION;
        #ifdef HAS_OCCLUSION_TEXTURE_TRANSFORM
            occlusionTexCoords = computeTextureTransform(occlusionTexCoords, u_occlusionTextureTransform);
        #endif
        material.occlusion = texture(u_occlusionTexture, occlusionTexCoords).r;
    #endif

    #ifdef HAS_EMISSIVE_TEXTURE
        material.emissive = getEmissiveFromTexture();
    #elif defined(HAS_EMISSIVE_FACTOR)
        material.emissive = u_emissiveFactor;
    #endif

    #if defined(LIGHTING_PBR) && defined(USE_SPECULAR_GLOSSINESS)
        setSpecularGlossiness(material);
    #elif defined(LIGHTING_PBR)
        float metalness = setMetallicRoughness(material);
        #ifdef USE_SPECULAR
            setSpecular(material, metalness);
        #endif
        #ifdef USE_ANISOTROPY
            setAnisotropy(material, normalInfo);
        #endif
        #ifdef USE_CLEARCOAT
            setClearcoat(material, attributes);
        #endif
    #endif
}
`;var{Material:_Ge,MetallicRoughness:JW,SpecularGlossiness:e7,Specular:Bse,Clearcoat:kse}=bn,Vse={name:"MaterialPipelineStage",_processTexture:Tl,_processTextureTransform:Use};Vse.process=function(e,t,n){let i=t.material,{model:o,uniformMap:r,shaderBuilder:s}=e,a=u(o.classificationType),c=a,{defaultTexture:l,defaultNormalTexture:f,defaultEmissiveTexture:d}=n.context;yGe(i,r,s,l,f,d,c),u(i.specularGlossiness)?xGe(i.specularGlossiness,r,s,l,c):(u(i.specular)&&Zt.supportedExtensions.KHR_materials_specular&&bGe(i.specular,r,s,l,c),u(i.anisotropy)&&Zt.supportedExtensions.KHR_materials_anisotropy&&AGe(i.anisotropy,r,s,l,c),u(i.clearcoat)&&Zt.supportedExtensions.KHR_materials_clearcoat&&TGe(i.clearcoat,r,s,l,c),EGe(i.metallicRoughness,r,s,l,c));let p=Zt.getAttributeBySemantic(t,Tt.NORMAL),g=e.lightingOptions;i.unlit||!p||a?g.lightingModel=Ip.UNLIT:g.lightingModel=Ip.PBR;let m=o.backFaceCulling&&!i.doubleSided;e.renderStateOptions.cull.enabled=m;let y=e.alphaOptions;i.alphaMode===bp.BLEND?y.pass=we.TRANSLUCENT:i.alphaMode===bp.MASK&&(y.alphaCutoff=i.alphaCutoff),s.addFragmentLines(yF),i.doubleSided&&s.addDefine("HAS_DOUBLE_SIDED_MATERIAL",void 0,_e.BOTH)};function Use(e,t,n,i,o){let r=`HAS_${o}_TEXTURE_TRANSFORM`;e.addDefine(r,void 0,_e.FRAGMENT);let s=`${i}Transform`;e.addUniform("mat3",s,_e.FRAGMENT),t[s]=function(){return n.transform}}function gGe(e,t,n,i,o){let r=`HAS_${o}_TEXTURE_SCALE`;e.addDefine(r,void 0,_e.FRAGMENT);let s=`${i}Scale`;e.addUniform("float",s,_e.FRAGMENT),t[s]=function(){return n.scale}}function Tl(e,t,n,i,o,r){e.addUniform("sampler2D",i,_e.FRAGMENT),t[i]=function(){return x(n.texture,r)};let s=`HAS_${o}_TEXTURE`;e.addDefine(s,void 0,_e.FRAGMENT);let c=`v_texCoord_${n.texCoord}`,l=`TEXCOORD_${o}`;e.addDefine(l,c,_e.FRAGMENT);let f=n.transform;u(f)&&!J.equals(f,J.IDENTITY)&&Use(e,t,n,i,o);let{scale:d}=n;u(d)&&d!==1&&gGe(e,t,n,i,o)}function yGe(e,t,n,i,o,r,s){let{emissiveFactor:a,emissiveTexture:c,normalTexture:l,occlusionTexture:f}=e;u(a)&&!h.equals(a,_Ge.DEFAULT_EMISSIVE_FACTOR)&&(n.addUniform("vec3","u_emissiveFactor",_e.FRAGMENT),t.u_emissiveFactor=function(){return e.emissiveFactor},n.addDefine("HAS_EMISSIVE_FACTOR",void 0,_e.FRAGMENT),u(c)&&!s&&Tl(n,t,c,"u_emissiveTexture","EMISSIVE",r)),u(l)&&!s&&Tl(n,t,l,"u_normalTexture","NORMAL",o),u(f)&&!s&&Tl(n,t,f,"u_occlusionTexture","OCCLUSION",i)}function xGe(e,t,n,i,o){let{diffuseTexture:r,diffuseFactor:s,specularGlossinessTexture:a,specularFactor:c,glossinessFactor:l}=e;n.addDefine("USE_SPECULAR_GLOSSINESS",void 0,_e.FRAGMENT),u(r)&&!o&&Tl(n,t,r,"u_diffuseTexture","DIFFUSE",i),u(s)&&!oe.equals(s,e7.DEFAULT_DIFFUSE_FACTOR)&&(n.addUniform("vec4","u_diffuseFactor",_e.FRAGMENT),t.u_diffuseFactor=function(){return e.diffuseFactor},n.addDefine("HAS_DIFFUSE_FACTOR",void 0,_e.FRAGMENT)),u(a)&&!o&&Tl(n,t,a,"u_specularGlossinessTexture","SPECULAR_GLOSSINESS",i),u(c)&&!h.equals(c,e7.DEFAULT_SPECULAR_FACTOR)&&(n.addUniform("vec3","u_legacySpecularFactor",_e.FRAGMENT),t.u_legacySpecularFactor=function(){return e.specularFactor},n.addDefine("HAS_LEGACY_SPECULAR_FACTOR",void 0,_e.FRAGMENT)),u(l)&&l!==e7.DEFAULT_GLOSSINESS_FACTOR&&(n.addUniform("float","u_glossinessFactor",_e.FRAGMENT),t.u_glossinessFactor=function(){return e.glossinessFactor},n.addDefine("HAS_GLOSSINESS_FACTOR",void 0,_e.FRAGMENT))}function bGe(e,t,n,i,o){let{specularTexture:r,specularFactor:s,specularColorTexture:a,specularColorFactor:c}=e;n.addDefine("USE_SPECULAR",void 0,_e.FRAGMENT),u(r)&&!o&&Tl(n,t,r,"u_specularTexture","SPECULAR",i),u(s)&&s!==Bse.DEFAULT_SPECULAR_FACTOR&&(n.addUniform("float","u_specularFactor",_e.FRAGMENT),t.u_specularFactor=function(){return e.specularFactor},n.addDefine("HAS_SPECULAR_FACTOR",void 0,_e.FRAGMENT)),u(a)&&!o&&Tl(n,t,a,"u_specularColorTexture","SPECULAR_COLOR",i),u(c)&&!h.equals(c,Bse.DEFAULT_SPECULAR_COLOR_FACTOR)&&(n.addUniform("vec3","u_specularColorFactor",_e.FRAGMENT),t.u_specularColorFactor=function(){return e.specularColorFactor},n.addDefine("HAS_SPECULAR_COLOR_FACTOR",void 0,_e.FRAGMENT))}var CGe=new h;function AGe(e,t,n,i,o){let{anisotropyStrength:r,anisotropyRotation:s,anisotropyTexture:a}=e;n.addDefine("USE_ANISOTROPY",void 0,_e.FRAGMENT),u(a)&&!o&&Tl(n,t,a,"u_anisotropyTexture","ANISOTROPY",i);let c=Math.cos(s),l=Math.sin(s);n.addUniform("vec3","u_anisotropy",_e.FRAGMENT),t.u_anisotropy=function(){return h.fromElements(c,l,r,CGe)}}function TGe(e,t,n,i,o){let{clearcoatFactor:r,clearcoatTexture:s,clearcoatRoughnessFactor:a,clearcoatRoughnessTexture:c,clearcoatNormalTexture:l}=e;n.addDefine("USE_CLEARCOAT",void 0,_e.FRAGMENT),u(r)&&r!==kse.DEFAULT_CLEARCOAT_FACTOR&&(n.addUniform("float","u_clearcoatFactor",_e.FRAGMENT),t.u_clearcoatFactor=function(){return e.clearcoatFactor},n.addDefine("HAS_CLEARCOAT_FACTOR",void 0,_e.FRAGMENT)),u(s)&&!o&&Tl(n,t,s,"u_clearcoatTexture","CLEARCOAT",i),u(a)&&r!==kse.DEFAULT_CLEARCOAT_ROUGHNESS_FACTOR&&(n.addUniform("float","u_clearcoatRoughnessFactor",_e.FRAGMENT),t.u_clearcoatRoughnessFactor=function(){return e.clearcoatRoughnessFactor},n.addDefine("HAS_CLEARCOAT_ROUGHNESS_FACTOR",void 0,_e.FRAGMENT)),u(c)&&!o&&Tl(n,t,c,"u_clearcoatRoughnessTexture","CLEARCOAT_ROUGHNESS",i),u(l)&&!o&&Tl(n,t,l,"u_clearcoatNormalTexture","CLEARCOAT_NORMAL",i)}function EGe(e,t,n,i,o){n.addDefine("USE_METALLIC_ROUGHNESS",void 0,_e.FRAGMENT);let r=e.baseColorTexture;u(r)&&!o&&Tl(n,t,r,"u_baseColorTexture","BASE_COLOR",i);let s=e.baseColorFactor;u(s)&&!oe.equals(s,JW.DEFAULT_BASE_COLOR_FACTOR)&&(n.addUniform("vec4","u_baseColorFactor",_e.FRAGMENT),t.u_baseColorFactor=function(){return e.baseColorFactor},n.addDefine("HAS_BASE_COLOR_FACTOR",void 0,_e.FRAGMENT));let a=e.metallicRoughnessTexture;u(a)&&!o&&Tl(n,t,a,"u_metallicRoughnessTexture","METALLIC_ROUGHNESS",i);let c=e.metallicFactor;u(c)&&c!==JW.DEFAULT_METALLIC_FACTOR&&(n.addUniform("float","u_metallicFactor",_e.FRAGMENT),t.u_metallicFactor=function(){return e.metallicFactor},n.addDefine("HAS_METALLIC_FACTOR",void 0,_e.FRAGMENT));let l=e.roughnessFactor;u(l)&&l!==JW.DEFAULT_ROUGHNESS_FACTOR&&(n.addUniform("float","u_roughnessFactor",_e.FRAGMENT),t.u_roughnessFactor=function(){return e.roughnessFactor},n.addDefine("HAS_ROUGHNESS_FACTOR",void 0,_e.FRAGMENT))}var xF=Vse;var Uc={name:"MetadataPickingPipelineStage",METADATA_PICKING_ENABLED:"METADATA_PICKING_ENABLED",METADATA_PICKING_VALUE_TYPE:"METADATA_PICKING_VALUE_TYPE",METADATA_PICKING_VALUE_STRING:"METADATA_PICKING_VALUE_STRING",METADATA_PICKING_VALUE_COMPONENT_X:"METADATA_PICKING_VALUE_COMPONENT_X",METADATA_PICKING_VALUE_COMPONENT_Y:"METADATA_PICKING_VALUE_COMPONENT_Y",METADATA_PICKING_VALUE_COMPONENT_Z:"METADATA_PICKING_VALUE_COMPONENT_Z",METADATA_PICKING_VALUE_COMPONENT_W:"METADATA_PICKING_VALUE_COMPONENT_W"};Uc.process=function(e,t,n){let i=e.shaderBuilder;i.addDefine(Uc.METADATA_PICKING_VALUE_TYPE,"float",_e.FRAGMENT),i.addDefine(Uc.METADATA_PICKING_VALUE_STRING,"0.0",_e.FRAGMENT),i.addDefine(Uc.METADATA_PICKING_VALUE_COMPONENT_X,"0.0",_e.FRAGMENT),i.addDefine(Uc.METADATA_PICKING_VALUE_COMPONENT_Y,"0.0",_e.FRAGMENT),i.addDefine(Uc.METADATA_PICKING_VALUE_COMPONENT_Z,"0.0",_e.FRAGMENT),i.addDefine(Uc.METADATA_PICKING_VALUE_COMPONENT_W,"0.0",_e.FRAGMENT),i.addFunction("metadataPickingStage","void metadataPickingStage(Metadata metadata, MetadataClass metadataClass, inout vec4 metadataValues)",_e.FRAGMENT),i.addFunctionLines("metadataPickingStage",[`${Uc.METADATA_PICKING_VALUE_TYPE} value = ${Uc.METADATA_PICKING_VALUE_TYPE}(${Uc.METADATA_PICKING_VALUE_STRING});`,`metadataValues.x = ${Uc.METADATA_PICKING_VALUE_COMPONENT_X};`,`metadataValues.y = ${Uc.METADATA_PICKING_VALUE_COMPONENT_Y};`,`metadataValues.z = ${Uc.METADATA_PICKING_VALUE_COMPONENT_Z};`,`metadataValues.w = ${Uc.METADATA_PICKING_VALUE_COMPONENT_W};`],_e.FRAGMENT)};var _f=Uc;var bF=`void morphTargetsStage(inout ProcessedAttributes attributes) 
{
    vec3 positionMC = attributes.positionMC;
    attributes.positionMC = getMorphedPosition(positionMC);

    #ifdef HAS_NORMALS
    vec3 normalMC = attributes.normalMC;
    attributes.normalMC = getMorphedNormal(normalMC);
    #endif

    #ifdef HAS_TANGENTS
    vec3 tangentMC = attributes.tangentMC;
    attributes.tangentMC = getMorphedTangent(tangentMC);
    #endif
}`;var Da={name:"MorphTargetsPipelineStage",FUNCTION_ID_GET_MORPHED_POSITION:"getMorphedPosition",FUNCTION_SIGNATURE_GET_MORPHED_POSITION:"vec3 getMorphedPosition(in vec3 position)",FUNCTION_ID_GET_MORPHED_NORMAL:"getMorphedNormal",FUNCTION_SIGNATURE_GET_MORPHED_NORMAL:"vec3 getMorphedNormal(in vec3 normal)",FUNCTION_ID_GET_MORPHED_TANGENT:"getMorphedTangent",FUNCTION_SIGNATURE_GET_MORPHED_TANGENT:"vec3 getMorphedTangent(in vec3 tangent)"};Da.process=function(e,t){let n=e.shaderBuilder;n.addDefine("HAS_MORPH_TARGETS",void 0,_e.VERTEX),PGe(n);let i=t.morphTargets.length;for(let a=0;a<i;a++){let c=t.morphTargets[a].attributes,l=c.length;for(let f=0;f<l;f++){let d=c[f],p=d.semantic;p!==Tt.POSITION&&p!==Tt.NORMAL&&p!==Tt.TANGENT||(vGe(e,d,e.attributeIndex,a),e.attributeIndex++)}}RGe(n);let r=e.runtimeNode.morphWeights.length;n.addUniform("float",`u_morphWeights[${r}]`,_e.VERTEX),n.addVertexLines(bF);let s={u_morphWeights:function(){return e.runtimeNode.morphWeights}};e.uniformMap=bt(s,e.uniformMap)};var SGe={attributeString:void 0,functionId:void 0};function vGe(e,t,n,i){let o=e.shaderBuilder;wGe(e,t,n);let r=DGe(t,SGe);IGe(o,r,i)}function wGe(e,t,n){let i={index:n,value:u(t.buffer)?void 0:t.constant,vertexBuffer:t.buffer,componentsPerAttribute:rn.getNumberOfComponents(t.type),componentDatatype:t.componentDatatype,offsetInBytes:t.byteOffset,strideInBytes:t.byteStride,normalize:t.normalized};e.attributes.push(i)}function DGe(e,t){switch(e.semantic){case Tt.POSITION:t.attributeString="Position",t.functionId=Da.FUNCTION_ID_GET_MORPHED_POSITION;break;case Tt.NORMAL:t.attributeString="Normal",t.functionId=Da.FUNCTION_ID_GET_MORPHED_NORMAL;break;case Tt.TANGENT:t.attributeString="Tangent",t.functionId=Da.FUNCTION_ID_GET_MORPHED_TANGENT;break;default:break}return t}function IGe(e,t,n){let i=t.attributeString,o=`a_target${i}_${n}`,r=`morphed${i} += u_morphWeights[${n}] * a_target${i}_${n};`;e.addAttribute("vec3",o),e.addFunctionLines(t.functionId,[r])}function PGe(e){e.addFunction(Da.FUNCTION_ID_GET_MORPHED_POSITION,Da.FUNCTION_SIGNATURE_GET_MORPHED_POSITION,_e.VERTEX),e.addFunctionLines(Da.FUNCTION_ID_GET_MORPHED_POSITION,["vec3 morphedPosition = position;"]),e.addFunction(Da.FUNCTION_ID_GET_MORPHED_NORMAL,Da.FUNCTION_SIGNATURE_GET_MORPHED_NORMAL,_e.VERTEX),e.addFunctionLines(Da.FUNCTION_ID_GET_MORPHED_NORMAL,["vec3 morphedNormal = normal;"]),e.addFunction(Da.FUNCTION_ID_GET_MORPHED_TANGENT,Da.FUNCTION_SIGNATURE_GET_MORPHED_TANGENT,_e.VERTEX),e.addFunctionLines(Da.FUNCTION_ID_GET_MORPHED_TANGENT,["vec3 morphedTangent = tangent;"])}function RGe(e){e.addFunctionLines(Da.FUNCTION_ID_GET_MORPHED_POSITION,["return morphedPosition;"]),e.addFunctionLines(Da.FUNCTION_ID_GET_MORPHED_NORMAL,["return morphedNormal;"]),e.addFunctionLines(Da.FUNCTION_ID_GET_MORPHED_TANGENT,["return morphedTangent;"])}var CF=Da;var zse={name:"PickingPipelineStage"};zse.process=function(e,t,n){let i=n.context,o=e.runtimeNode,r=e.shaderBuilder,s=e.model,a=o.node.instances;if(e.hasPropertyTable)OGe(e,t,a,i);else if(u(a))MGe(e,i);else{let c=Hse(e),l=i.createPickId(c);s._pipelineResources.push(l),s._pickIds.push(l),r.addUniform("vec4","czm_pickColor",_e.FRAGMENT);let f=e.uniformMap;f.czm_pickColor=function(){return l.color},e.pickId="czm_pickColor"}};function Hse(e,t){let n=e.model;if(u(n.pickObject))return n.pickObject;let i={model:n,node:e.runtimeNode,primitive:e.runtimePrimitive},o;if(Cr.is3DTiles(n.type)){let r=n.content;o={content:r,primitive:r.tileset,detail:i}}else o={primitive:n,detail:i};return o.id=n.id,u(t)&&(o.instanceId=t),o}function OGe(e,t,n){let i=e.model,o,r,s=i.featureIdLabel,a=i.instanceFeatureIdLabel;u(i.featureTableId)?o=i.featureTableId:u(n)?(r=Zt.getFeatureIdsByLabel(n.featureIds,a),o=r.propertyTableId):(r=Zt.getFeatureIdsByLabel(t.featureIds,s),o=r.propertyTableId);let c=i.featureTables[o];e.shaderBuilder.addUniform("sampler2D","model_pickTexture",_e.FRAGMENT);let f=c.batchTexture;e.uniformMap.model_pickTexture=function(){return x(f.pickTexture,f.defaultTexture)},e.pickId="((selectedFeature.id < int(model_featuresLength)) ? texture(model_pickTexture, selectedFeature.st) : vec4(0.0))"}function MGe(e,t){let n=e.instanceCount,i=new Array(n),o=new Uint8Array(n*4),r=e.model,s=r._pipelineResources;for(let d=0;d<n;d++){let p=Hse(e,d),g=t.createPickId(p);s.push(g),i[d]=g;let m=g.color;o[d*4+0]=G.floatToByte(m.red),o[d*4+1]=G.floatToByte(m.green),o[d*4+2]=G.floatToByte(m.blue),o[d*4+3]=G.floatToByte(m.alpha)}r._pickIds=i;let a=xt.createVertexBuffer({context:t,typedArray:o,usage:ke.STATIC_DRAW});a.vertexArrayDestroyable=!1,r.statistics.addBuffer(a,!1),s.push(a);let l={index:e.attributeIndex++,vertexBuffer:a,componentsPerAttribute:4,componentDatatype:K.UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0,instanceDivisor:1};e.attributes.push(l);let f=e.shaderBuilder;f.addDefine("USE_PICKING",void 0,_e.BOTH),f.addAttribute("vec4","a_pickColor"),f.addVarying("vec4","v_pickColor"),e.pickId="v_pickColor"}var AF=zse;var LGe={ADD:0,REPLACE:1},Zo=Object.freeze(LGe);var TF=`float getPointSizeFromAttenuation(vec3 positionEC) {
  // Variables are packed into a single vector to minimize gl.uniformXXX() calls
  float pointSize = model_pointCloudParameters.x;
  float geometricError = model_pointCloudParameters.y;
  float depthMultiplier = model_pointCloudParameters.z;

  float depth = -positionEC.z;
  return min((geometricError / depth) * depthMultiplier, pointSize);
}

#ifdef HAS_POINT_CLOUD_SHOW_STYLE
float pointCloudShowStylingStage(in ProcessedAttributes attributes, in Metadata metadata) {
  float tiles3d_tileset_time = model_pointCloudParameters.w;
  return float(getShowFromStyle(attributes, metadata, tiles3d_tileset_time));
}
#endif

#ifdef HAS_POINT_CLOUD_COLOR_STYLE
vec4 pointCloudColorStylingStage(in ProcessedAttributes attributes, in Metadata metadata) {
  float tiles3d_tileset_time = model_pointCloudParameters.w;
  return getColorFromStyle(attributes, metadata, tiles3d_tileset_time);
}
#endif

#ifdef HAS_POINT_CLOUD_POINT_SIZE_STYLE
float pointCloudPointSizeStylingStage(in ProcessedAttributes attributes, in Metadata metadata) {
  float tiles3d_tileset_time = model_pointCloudParameters.w;
  return float(getPointSizeFromStyle(attributes, metadata, tiles3d_tileset_time));
}
#elif defined(HAS_POINT_CLOUD_ATTENUATION)
float pointCloudPointSizeStylingStage(in ProcessedAttributes attributes, in Metadata metadata) {
  return getPointSizeFromAttenuation(v_positionEC);
}
#endif

#ifdef HAS_POINT_CLOUD_BACK_FACE_CULLING
float pointCloudBackFaceCullingStage() {
  #if defined(HAS_NORMALS) && !defined(HAS_DOUBLE_SIDED_MATERIAL)
  // This needs to be computed in eye coordinates so we can't use attributes.normalMC
  return step(-v_normalEC.z, 0.0);
  #else
  return 1.0;
  #endif
}
#endif`;var NGe=new oe,Wse={name:"PointCloudStylingPipelineStage"};Wse.process=function(e,t,n){let i=e.shaderBuilder,o=e.model,r=o.style,s=o.structuralMetadata,a=u(s)?s.propertyAttributes:void 0,c=u(o.featureTableId)&&o.featureTables[o.featureTableId].featuresLength>0,l=!u(a)&&c;if(u(r)&&!l){let y=VGe(a),b=UGe(r,y);zGe(i,b);let A=HGe(b).indexOf("normalMC")>=0,T=Zt.getAttributeBySemantic(t,Tt.NORMAL);if(A&&!T)throw new ce("Style references the NORMAL semantic but the point cloud does not have normals");i.addDefine("COMPUTE_POSITION_WC_STYLE",void 0,_e.VERTEX),b.styleTranslucent&&(e.alphaOptions.pass=we.TRANSLUCENT)}let f=o.pointCloudShading;f.attenuation&&i.addDefine("HAS_POINT_CLOUD_ATTENUATION",void 0,_e.VERTEX),f.backFaceCulling&&i.addDefine("HAS_POINT_CLOUD_BACK_FACE_CULLING",void 0,_e.VERTEX);let d,p,g;Cr.is3DTiles(o.type)&&(p=!0,d=o.content,g=d.tile.refine===Zo.ADD),i.addUniform("vec4","model_pointCloudParameters",_e.VERTEX),i.addVertexLines(TF);let m=e.uniformMap;m.model_pointCloudParameters=function(){let y=NGe,b=1;p&&(b=g?5:d.tileset.memoryAdjustedScreenSpaceError),y.x=x(f.maximumAttenuation,b),y.x*=n.pixelRatio;let C=FGe(e,t,f,d);y.y=C*f.geometricErrorScale;let A=n.context,T=n.camera.frustum,E;return n.mode===ne.SCENE2D||T instanceof sn?E=Number.POSITIVE_INFINITY:E=A.drawingBufferHeight/n.camera.frustum.sseDenominator,y.z=E,p&&(y.w=d.tileset.timeSinceLoad),y}};var Gse=new h;function FGe(e,t,n,i){if(u(i)){let f=i.tile.geometricError;if(f>0)return f}if(u(n.baseResolution))return n.baseResolution;let o=Zt.getAttributeBySemantic(t,Tt.POSITION),r=o.count,s=e.runtimeNode.transform,a=h.subtract(o.max,o.min,Gse);a=F.multiplyByPointAsVector(s,a,Gse);let c=a.x*a.y*a.z;return R.cbrt(c/r)}var BGe={colorStyleFunction:void 0,showStyleFunction:void 0,pointSizeStyleFunction:void 0,styleTranslucent:!1},kGe={POSITION:"attributes.positionMC",POSITION_ABSOLUTE:"v_positionWC",COLOR:"attributes.color_0",NORMAL:"attributes.normalMC"};function VGe(e){let t=Ge(kGe);if(!u(e))return t;for(let n=0;n<e.length;n++){let o=e[n].properties;for(let r in o)o.hasOwnProperty(r)&&(t[r]=`metadata.${r}`)}return t}var t7="ProcessedAttributes attributes, Metadata metadata, float tiles3d_tileset_time";function UGe(e,t){let n=BGe,i={translucent:!1};return n.colorStyleFunction=e.getColorShaderFunction(`getColorFromStyle(${t7})`,t,i),n.showStyleFunction=e.getShowShaderFunction(`getShowFromStyle(${t7})`,t,i),n.pointSizeStyleFunction=e.getPointSizeShaderFunction(`getPointSizeFromStyle(${t7})`,t,i),n.styleTranslucent=u(n.colorStyleFunction)&&i.translucent,n}function zGe(e,t){let n=t.colorStyleFunction;u(n)&&(e.addDefine("HAS_POINT_CLOUD_COLOR_STYLE",void 0,_e.BOTH),e.addVertexLines(n),e.addVarying("vec4","v_pointCloudColor"));let i=t.showStyleFunction;u(i)&&(e.addDefine("HAS_POINT_CLOUD_SHOW_STYLE",void 0,_e.VERTEX),e.addVertexLines(i));let o=t.pointSizeStyleFunction;u(o)&&(e.addDefine("HAS_POINT_CLOUD_POINT_SIZE_STYLE",void 0,_e.VERTEX),e.addVertexLines(o))}function n7(e,t){let n=/attributes\.(\w+)/g,i=n.exec(e);for(;i!==null;){let o=i[1];t.indexOf(o)===-1&&t.push(o),i=n.exec(e)}}function HGe(e){let t=e.colorStyleFunction,n=e.showStyleFunction,i=e.pointSizeStyleFunction,o=[];return u(t)&&n7(t,o),u(n)&&n7(n,o),u(i)&&n7(i,o),o}var EF=Wse;var SF=`void primitiveOutlineStage() {
    v_outlineCoordinates = a_outlineCoordinates;
}
`;var vF=`void primitiveOutlineStage(inout czm_modelMaterial material) {
    if (!model_showOutline) {
        return;
    }

    float outlineX = 
        texture(model_outlineTexture, vec2(v_outlineCoordinates.x, 0.5)).r;
    float outlineY = 
        texture(model_outlineTexture, vec2(v_outlineCoordinates.y, 0.5)).r;
    float outlineZ = 
        texture(model_outlineTexture, vec2(v_outlineCoordinates.z, 0.5)).r;
    float outlineness = max(outlineX, max(outlineY, outlineZ));

    material.diffuse = mix(material.diffuse, model_outlineColor.rgb, model_outlineColor.a * outlineness);
}

`;var jse={name:"PrimitiveOutlinePipelineStage"};jse.process=function(e,t,n){let i=e.shaderBuilder,o=e.uniformMap;i.addDefine("HAS_PRIMITIVE_OUTLINE",void 0,_e.BOTH),i.addAttribute("vec3","a_outlineCoordinates"),i.addVarying("vec3","v_outlineCoordinates");let r=t.outlineCoordinates,s={index:e.attributeIndex++,vertexBuffer:r.buffer,componentsPerAttribute:rn.getNumberOfComponents(r.type),componentDatatype:r.componentDatatype,offsetInBytes:r.byteOffset,strideInBytes:r.byteStride,normalize:r.normalized};e.attributes.push(s),i.addUniform("sampler2D","model_outlineTexture",_e.FRAGMENT);let a=SA.createTexture(n.context);o.model_outlineTexture=function(){return a};let c=e.model;i.addUniform("vec4","model_outlineColor",_e.FRAGMENT),o.model_outlineColor=function(){return c.outlineColor},i.addUniform("bool","model_showOutline",_e.FRAGMENT),o.model_showOutline=function(){return c.showOutline},i.addVertexLines(SF),i.addFragmentLines(vF)};var wF=jse;var qse={name:"PrimitiveStatisticsPipelineStage",_countGeometry:Yse,_count2DPositions:Xse,_countMorphTargetAttributes:Kse,_countMaterialTextures:Zse,_countFeatureIdTextures:$se,_countBinaryMetadata:Qse};qse.process=function(e,t,n){let i=e.model,o=i.statistics;Yse(o,t),Xse(o,e.runtimePrimitive),Kse(o,t),Zse(o,t.material),$se(o,t.featureIds),Qse(o,i)};function Yse(e,t){let n=u(t.indices)?t.indices.count:Zt.getAttributeBySemantic(t,"POSITION").count,i=t.primitiveType;i===Ne.POINTS?e.pointsLength+=n:Ne.isTriangles(i)&&(e.trianglesLength+=GGe(i,n));let o=t.attributes,r=o.length;for(let c=0;c<r;c++){let l=o[c];if(u(l.buffer)){let f=u(l.typedArray);e.addBuffer(l.buffer,f)}}let s=t.outlineCoordinates;u(s)&&u(s.buffer)&&e.addBuffer(s.buffer,!1);let a=t.indices;if(u(a)&&u(a.buffer)){let c=u(a.typedArray);e.addBuffer(a.buffer,c)}}function GGe(e,t){switch(e){case Ne.TRIANGLES:return t/3;case Ne.TRIANGLE_STRIP:case Ne.TRIANGLE_FAN:return Math.max(t-2,0);default:return 0}}function Xse(e,t){let n=t.positionBuffer2D;u(n)&&e.addBuffer(n,!0)}function Kse(e,t){let n=t.morphTargets;if(!u(n))return;let i=!1,o=n.length;for(let r=0;r<o;r++){let s=n[r].attributes,a=s.length;for(let c=0;c<a;c++){let l=s[c];u(l.buffer)&&e.addBuffer(l.buffer,i)}}}function Zse(e,t){let n=WGe(t),i=n.length;for(let o=0;o<i;o++){let r=n[o];u(r)&&u(r.texture)&&e.addTexture(r.texture)}}function WGe(e){let t=e.metallicRoughness,n=[e.emissiveTexture,e.normalTexture,e.occlusionTexture,t.baseColorTexture,t.metallicRoughnessTexture],i=e.specularGlossiness;return u(i)&&(n.push(i.diffuseTexture),n.push(i.specularGlossinessTexture)),n}function $se(e,t){let n=t.length;for(let i=0;i<n;i++){let o=t[i];if(o instanceof bn.FeatureIdTexture){let r=o.textureReader;u(r.texture)&&e.addTexture(r.texture)}}}function Qse(e,t){let n=t.structuralMetadata;u(n)&&(jGe(e,n),e.propertyTablesByteLength+=n.propertyTablesByteLength);let i=t.featureTables;if(!u(i))return;let o=i.length;for(let r=0;r<o;r++){let s=i[r];e.addBatchTexture(s.batchTexture)}}function jGe(e,t){let n=t.propertyTextures;if(!u(n))return;let i=n.length;for(let o=0;o<i;o++){let s=n[o].properties;for(let a in s)if(s.hasOwnProperty(a)){let l=s[a].textureReader;u(l.texture)&&e.addTexture(l.texture)}}}var DF=qse;var qGe=new F,YGe=new F,Jse={name:"SceneMode2DPipelineStage"};Jse.process=function(e,t,n){let i=Zt.getAttributeBySemantic(t,Tt.POSITION),o=e.shaderBuilder,r=e.model,s=r.sceneGraph.computedModelMatrix,a=e.runtimeNode.computedTransform,c=F.multiplyTransformation(s,a,qGe),l=ZGe(e,c,n),f=e.runtimePrimitive;f.boundingSphere2D=l;let d=e.runtimeNode.node.instances;if(u(d))return;if(u(i.typedArray)){let y=JGe(i,c,l,n);f.positionBuffer2D=y,r._modelResources.push(y),i.typedArray=void 0}o.addDefine("USE_2D_POSITIONS",void 0,_e.VERTEX),o.addUniform("mat4","u_modelView2D",_e.VERTEX);let p=F.fromTranslation(l.center,new F),g=n.context,m={u_modelView2D:function(){return F.multiplyTransformation(g.uniformState.view,p,YGe)}};e.uniformMap=bt(m,e.uniformMap)};var XGe=new h,KGe=new h;function ZGe(e,t,n){let i=F.multiplyByPoint(t,e.positionMin,XGe),o=Wi.computeActualEllipsoidPosition(n,i,i),r=F.multiplyByPoint(t,e.positionMax,KGe),s=Wi.computeActualEllipsoidPosition(n,r,r);return ae.fromCornerPoints(o,s,new ae)}var eae=new h;function $Ge(e,t){let n=e.length,i=new Float32Array(n),o=t.quantizedVolumeOffset,r=t.quantizedVolumeStepSize;for(let s=0;s<n;s+=3){let a=h.fromArray(e,s,eae),c=h.multiplyComponents(a,r,a),l=h.add(c,o,c);i[s]=l.x,i[s+1]=l.y,i[s+2]=l.z}return i}function QGe(e,t,n,i){let o;u(e.quantization)?o=$Ge(e.typedArray,e.quantization):o=e.typedArray.slice();let r=e.byteOffset/Float32Array.BYTES_PER_ELEMENT,s=o.length,a=u(e.byteStride)?e.byteStride/Float32Array.BYTES_PER_ELEMENT:3;for(let c=r;c<s;c+=a){let l=h.fromArray(o,c,eae);if(isNaN(l.x)||isNaN(l.y)||isNaN(l.z))continue;let f=F.multiplyByPoint(t,l,l),d=Wi.computeActualEllipsoidPosition(i,f,f),p=h.subtract(d,n,d);o[c]=p.x,o[c+1]=p.y,o[c+2]=p.z}return o}function JGe(e,t,n,i){let o=Ge(i);o.mode=ne.COLUMBUS_VIEW;let r=n.center,s=QGe(e,t,r,o),a=xt.createVertexBuffer({context:i.context,typedArray:s,usage:ke.STATIC_DRAW});return a.vertexArrayDestroyable=!1,a}var IF=Jse;var PF=`void skinningStage(inout ProcessedAttributes attributes) 
{
    mat4 skinningMatrix = getSkinningMatrix();
    mat3 skinningMatrixMat3 = mat3(skinningMatrix);

    vec4 positionMC = vec4(attributes.positionMC, 1.0);
    attributes.positionMC = vec3(skinningMatrix * positionMC);

    #ifdef HAS_NORMALS
    vec3 normalMC = attributes.normalMC;
    attributes.normalMC = skinningMatrixMat3 * normalMC;
    #endif

    #ifdef HAS_TANGENTS
    vec3 tangentMC = attributes.tangentMC;
    attributes.tangentMC = skinningMatrixMat3 * tangentMC;
    #endif
}`;var Cx={name:"SkinningPipelineStage",FUNCTION_ID_GET_SKINNING_MATRIX:"getSkinningMatrix",FUNCTION_SIGNATURE_GET_SKINNING_MATRIX:"mat4 getSkinningMatrix()"};Cx.process=function(e,t){let n=e.shaderBuilder;n.addDefine("HAS_SKINNING",void 0,_e.VERTEX),t9e(n,t);let i=e.runtimeNode,o=i.computedJointMatrices;n.addUniform("mat4",`u_jointMatrices[${o.length}]`,_e.VERTEX),n.addVertexLines(PF);let r={u_jointMatrices:function(){return i.computedJointMatrices}};e.uniformMap=bt(r,e.uniformMap)};function e9e(e){let t=-1,n=e.attributes,i=n.length;for(let o=0;o<i;o++){let r=n[o];(r.semantic===Tt.JOINTS||r.semantic===Tt.WEIGHTS)&&(t=Math.max(t,r.setIndex))}return t}function t9e(e,t){e.addFunction(Cx.FUNCTION_ID_GET_SKINNING_MATRIX,Cx.FUNCTION_SIGNATURE_GET_SKINNING_MATRIX,_e.VERTEX),e.addFunctionLines(Cx.FUNCTION_ID_GET_SKINNING_MATRIX,["mat4 skinnedMatrix = mat4(0);"]);let i,o,r=["x","y","z","w"],s=e9e(t);for(i=0;i<=s;i++)for(o=0;o<=3;o++){let c=r[o],l=`skinnedMatrix += a_weights_${i}.${c} * u_jointMatrices[int(a_joints_${i}.${c})];`;e.addFunctionLines(Cx.FUNCTION_ID_GET_SKINNING_MATRIX,[l])}e.addFunctionLines(Cx.FUNCTION_ID_GET_SKINNING_MATRIX,["return skinnedMatrix;"])}var RF=Cx;var OF=`void verticalExaggerationStage(
  inout ProcessedAttributes attributes
) {
  // Compute the distance from the camera to the local center of curvature.
  vec4 vertexPositionENU = czm_modelToEnu * vec4(attributes.positionMC, 1.0);
  vec2 vertexAzimuth = normalize(vertexPositionENU.xy);
  // Curvature = 1 / radius of curvature.
  float azimuthalCurvature = dot(vertexAzimuth * vertexAzimuth, czm_eyeEllipsoidCurvature);
  float eyeToCenter = 1.0 / azimuthalCurvature + czm_eyeHeight;

  // Compute the approximate ellipsoid normal at the vertex position.
  // Uses a circular approximation for the Earth curvature along the geodesic.
  vec3 vertexPositionEC = (czm_modelView * vec4(attributes.positionMC, 1.0)).xyz;
  vec3 centerToVertex = eyeToCenter * czm_eyeEllipsoidNormalEC + vertexPositionEC;
  vec3 vertexNormal = normalize(centerToVertex);

  // Estimate the (sine of the) angle between the camera direction and the vertex normal
  float verticalDistance = dot(vertexPositionEC, czm_eyeEllipsoidNormalEC);
  float horizontalDistance = length(vertexPositionEC - verticalDistance * czm_eyeEllipsoidNormalEC);
  float sinTheta = horizontalDistance / (eyeToCenter + verticalDistance);
  bool isSmallAngle = clamp(sinTheta, 0.0, 0.05) == sinTheta;

  // Approximate the change in height above the ellipsoid, from camera to vertex position.
  float exactVersine = 1.0 - dot(czm_eyeEllipsoidNormalEC, vertexNormal);
  float smallAngleVersine = 0.5 * sinTheta * sinTheta;
  float versine = isSmallAngle ? smallAngleVersine : exactVersine;
  float dHeight = dot(vertexPositionEC, vertexNormal) - eyeToCenter * versine;
  float vertexHeight = czm_eyeHeight + dHeight;

  // Transform the approximate vertex normal to model coordinates.
  vec3 vertexNormalMC = (czm_inverseModelView * vec4(vertexNormal, 0.0)).xyz;
  vertexNormalMC = normalize(vertexNormalMC);

  // Compute the exaggeration and apply it along the approximate vertex normal.
  float stretch = u_verticalExaggerationAndRelativeHeight.x;
  float shift = u_verticalExaggerationAndRelativeHeight.y;
  float exaggeration = (vertexHeight - shift) * (stretch - 1.0);
  attributes.positionMC += exaggeration * vertexNormalMC;
}
`;var tae={name:"VerticalExaggerationPipelineStage"},n9e=new H;tae.process=function(e,t,n){let{shaderBuilder:i,uniformMap:o}=e;i.addVertexLines(OF),i.addDefine("HAS_VERTICAL_EXAGGERATION",void 0,_e.VERTEX),i.addUniform("vec2","u_verticalExaggerationAndRelativeHeight",_e.VERTEX),o.u_verticalExaggerationAndRelativeHeight=function(){return H.fromElements(n.verticalExaggeration,n.verticalExaggerationRelativeHeight,n9e)}};var MF=tae;var i7={};function i9e(e){let t=Be.createTypedArray(e,e*2),n=e,i=0;for(let o=0;o<n;o+=3)t[i++]=o,t[i++]=o+1,t[i++]=o+1,t[i++]=o+2,t[i++]=o+2,t[i++]=o;return t}function o9e(e,t){let n=t.length,i=Be.createTypedArray(e,n*2),o=0;for(let r=0;r<n;r+=3){let s=t[r],a=t[r+1],c=t[r+2];i[o++]=s,i[o++]=a,i[o++]=a,i[o++]=c,i[o++]=c,i[o++]=s}return i}function r9e(e){let t=e-2,n=2+t*4,i=Be.createTypedArray(e,n),o=0;i[o++]=0,i[o++]=1;for(let r=0;r<t;r++)i[o++]=r+1,i[o++]=r+2,i[o++]=r+2,i[o++]=r;return i}function s9e(e,t){let i=t.length-2,o=2+i*4,r=Be.createTypedArray(e,o),s=0;r[s++]=t[0],r[s++]=t[1];for(let a=0;a<i;a++){let c=t[a],l=t[a+1],f=t[a+2];r[s++]=l,r[s++]=f,r[s++]=f,r[s++]=c}return r}function a9e(e){let t=e-2,n=2+t*4,i=Be.createTypedArray(e,n),o=0;i[o++]=0,i[o++]=1;for(let r=0;r<t;r++)i[o++]=r+1,i[o++]=r+2,i[o++]=r+2,i[o++]=0;return i}function c9e(e,t){let i=t.length-2,o=2+i*4,r=Be.createTypedArray(e,o),s=0,a=t[0];r[s++]=a,r[s++]=t[1];for(let c=0;c<i;c++){let l=t[c+1],f=t[c+2];r[s++]=l,r[s++]=f,r[s++]=f,r[s++]=a}return r}i7.createWireframeIndices=function(e,t,n){let i=u(n);if(e===Ne.TRIANGLES)return i?o9e(t,n):i9e(t);if(e===Ne.TRIANGLE_STRIP)return i?s9e(t,n):r9e(t);if(e===Ne.TRIANGLE_FAN)return i?c9e(t,n):a9e(t)};i7.getWireframeIndicesCount=function(e,t){return e===Ne.TRIANGLES?t*2:e===Ne.TRIANGLE_STRIP||e===Ne.TRIANGLE_FAN?2+(t-2)*4:t};var Sw=i7;var nae={name:"WireframePipelineStage"};nae.process=function(e,t,n){e.shaderBuilder.addDefine("HAS_WIREFRAME",void 0,_e.FRAGMENT);let o=e.model,r=l9e(t,e.indices,n);o._pipelineResources.push(r),e.wireframeIndexBuffer=r,o.statistics.addBuffer(r,!1);let a=e.primitiveType,c=e.count;e.primitiveType=Ne.LINES,e.count=Sw.getWireframeIndicesCount(a,c)};function l9e(e,t,n){let o=Zt.getAttributeBySemantic(e,Tt.POSITION).count,r=n.context.webgl2,s;if(u(t)){let f=t.buffer,d=t.count;u(f)&&r?(s=f.sizeInBytes===d?new Uint8Array(d):Be.createTypedArray(o,d),f.getBufferData(s)):s=t.typedArray}let a=e.primitiveType,c=Sw.createWireframeIndices(a,o,s),l=Be.fromSizeInBytes(c.BYTES_PER_ELEMENT);return xt.createIndexBuffer({context:n.context,typedArray:c,usage:ke.STATIC_DRAW,indexDatatype:l})}var LF=nae;function iae(e){e=x(e,x.EMPTY_OBJECT);let t=e.primitive,n=e.node,i=e.model;this.primitive=t,this.node=n,this.model=i,this.pipelineStages=[],this.drawCommand=void 0,this.boundingSphere=void 0,this.boundingSphere2D=void 0,this.positionBuffer2D=void 0,this.batchLengths=void 0,this.batchOffsets=void 0,this.updateStages=[]}iae.prototype.configurePipeline=function(e){let t=this.pipelineStages;t.length=0;let n=this.primitive,i=this.node,o=this.model,r=o.customShader,s=o.style,a=e.context.webgl2,l=e.mode!==ne.SCENE3D&&!e.scene3DOnly&&o._projectTo2D,f=e.verticalExaggeration!==1&&o.hasVerticalExaggeration,d=u(n.morphTargets)&&n.morphTargets.length>0,p=u(i.skin),g=u(r),y=!(g&&u(r.fragmentShaderText))||r.mode!==Ng.REPLACE_MATERIAL,b=Zt.hasQuantizedAttributes(n.attributes),C=o.debugWireframe&&Ne.isTriangles(n.primitiveType)&&(o._enableDebugWireframe||a),A=o.pointCloudShading,T=u(A)&&A.attenuation,E=u(A)&&A.backFaceCulling,v=n.primitiveType===Ne.POINTS&&(u(s)||T||E),D=o._enableShowOutline&&u(n.outlineCoordinates),O=u9e(o,i,n),P=u(o.classificationType);l&&t.push(IF),t.push(pF),C&&t.push(LF),P&&t.push(tF),d&&t.push(CF),p&&t.push(RF),v&&t.push(EF),b&&t.push(dF),y&&t.push(xF),t.push(yx),t.push(Ad),t.push(_f),O.hasPropertyTable&&(t.push(bx),t.push(eF),t.push(oF)),f&&t.push(MF),g&&t.push(fF),t.push(gF),o.allowPicking&&t.push(AF),D&&t.push(wF),t.push(J2),t.push(DF)};function u9e(e,t,n){let i;return u(t.instances)&&(i=Zt.getFeatureIdsByLabel(t.instances.featureIds,e.instanceFeatureIdLabel),u(i))?{hasFeatureIds:!0,hasPropertyTable:u(i.propertyTableId)}:(i=Zt.getFeatureIdsByLabel(n.featureIds,e.featureIdLabel),u(i)?{hasFeatureIds:!0,hasPropertyTable:u(i.propertyTableId)}:{hasFeatureIds:!1,hasPropertyTable:!1})}var NF=iae;function o7(e){e=x(e,x.EMPTY_OBJECT),this._sceneGraph=e.sceneGraph;let t=e.skin;this._skin=t,this._inverseBindMatrices=void 0,this._joints=[],this._jointMatrices=[],f9e(this)}Object.defineProperties(o7.prototype,{skin:{get:function(){return this._skin}},sceneGraph:{get:function(){return this._sceneGraph}},inverseBindMatrices:{get:function(){return this._inverseBindMatrices}},joints:{get:function(){return this._joints}},jointMatrices:{get:function(){return this._jointMatrices}}});function f9e(e){let t=e.skin,n=t.inverseBindMatrices;e._inverseBindMatrices=n;let i=t.joints,o=i.length,r=e.sceneGraph._runtimeNodes,s=e.joints,a=e._jointMatrices;for(let c=0;c<o;c++){let l=i[c].index,f=r[l];s.push(f);let d=n[c],p=oae(f,d,new F);a.push(p)}}function oae(e,t,n){let i=F.multiplyTransformation(e.transformToRoot,e.transform,n);return n=F.multiplyTransformation(i,t,n),n}o7.prototype.updateJointMatrices=function(){let e=this._jointMatrices,t=e.length;for(let n=0;n<t;n++){let i=this.joints[n],o=this.inverseBindMatrices[n];e[n]=oae(i,o,e[n])}};var FF=o7;function d9e(){this.pass=void 0,this.alphaCutoff=void 0}var BF=d9e;function h9e(e){this.shaderBuilder=new wC,this.model=e,this.uniformMap={},this.alphaOptions=new BF,this.renderStateOptions=Ue.getState(Ue.fromCache({depthTest:{enabled:!0,func:wc.LESS_OR_EQUAL}})),this.hasSilhouette=!1,this.hasSkipLevelOfDetail=!1}var kF=h9e;var VF=`void silhouetteStage(inout vec4 color) {
    if(model_silhouettePass) {
        color = czm_gammaCorrect(model_silhouetteColor);
    }
}`;var UF=`void silhouetteStage(in ProcessedAttributes attributes, inout vec4 positionClip) {
     #ifdef HAS_NORMALS
     if(model_silhouettePass) {
          vec3 normal = normalize(czm_normal3D * attributes.normalMC);
          normal.x *= czm_projection[0][0];
          normal.y *= czm_projection[1][1];
          positionClip.xy += normal.xy * positionClip.w * model_silhouetteSize * czm_pixelRatio / czm_viewport.z;
    }
    #endif
}
`;var zF={name:"ModelSilhouettePipelineStage"};zF.silhouettesLength=0;zF.process=function(e,t,n){u(t._silhouetteId)||(t._silhouetteId=++zF.silhouettesLength);let i=e.shaderBuilder;i.addDefine("HAS_SILHOUETTE",void 0,_e.BOTH),i.addVertexLines(UF),i.addFragmentLines(VF),i.addUniform("vec4","model_silhouetteColor",_e.FRAGMENT),i.addUniform("float","model_silhouetteSize",_e.VERTEX),i.addUniform("bool","model_silhouettePass",_e.BOTH);let o={model_silhouetteColor:function(){return t.silhouetteColor},model_silhouetteSize:function(){return t.silhouetteSize},model_silhouettePass:function(){return!1}};e.uniformMap=bt(o,e.uniformMap),e.hasSilhouette=!0};var HF=zF;var GF=`void modelSplitterStage()
{
    // Don't split when rendering the shadow map, because it is rendered from
    // the perspective of a totally different camera.
#ifndef SHADOW_MAP
    if (model_splitDirection < 0.0 && gl_FragCoord.x > czm_splitPosition) discard;
    if (model_splitDirection > 0.0 && gl_FragCoord.x < czm_splitPosition) discard;
#endif
}
`;var WF={name:"ModelSplitterPipelineStage",SPLIT_DIRECTION_UNIFORM_NAME:"model_splitDirection"};WF.process=function(e,t,n){let i=e.shaderBuilder;i.addDefine("HAS_MODEL_SPLITTER",void 0,_e.FRAGMENT),i.addFragmentLines(GF);let o={};i.addUniform("float",WF.SPLIT_DIRECTION_UNIFORM_NAME,_e.FRAGMENT),o[WF.SPLIT_DIRECTION_UNIFORM_NAME]=function(){return t.splitDirection},e.uniformMap=bt(o,e.uniformMap)};var jF=WF;function m9e(e,t){this.model=e.model,this.shaderBuilder=e.shaderBuilder.clone(),this.uniformMap=Ge(e.uniformMap),this.alphaOptions=Ge(e.alphaOptions),this.renderStateOptions=Ge(e.renderStateOptions,!0),this.hasSilhouette=e.hasSilhouette,this.hasSkipLevelOfDetail=e.hasSkipLevelOfDetail,this.runtimeNode=t,this.attributes=[],this.attributeIndex=1,this.featureIdVertexAttributeSetIndex=0,this.instanceCount=0}var qF=m9e;function p9e(e){e=x(e,x.EMPTY_OBJECT),this.lightingModel=x(e.lightingModel,Ip.UNLIT)}var YF=p9e;function _9e(e,t){this.model=e.model,this.runtimeNode=e.runtimeNode,this.attributes=e.attributes.slice(),this.attributeIndex=e.attributeIndex,this.featureIdVertexAttributeSetIndex=e.featureIdVertexAttributeSetIndex,this.uniformMap=Ge(e.uniformMap),this.alphaOptions=Ge(e.alphaOptions),this.renderStateOptions=Ge(e.renderStateOptions,!0),this.hasSilhouette=e.hasSilhouette,this.hasSkipLevelOfDetail=e.hasSkipLevelOfDetail,this.shaderBuilder=e.shaderBuilder.clone(),this.instanceCount=e.instanceCount,this.runtimePrimitive=t;let n=t.primitive;this.count=u(n.indices)?n.indices.count:Zt.getAttributeBySemantic(n,"POSITION").count,this.hasPropertyTable=!1,this.indices=n.indices,this.wireframeIndexBuffer=void 0,this.primitiveType=n.primitiveType;let i=Zt.getPositionMinMax(n,this.runtimeNode.instancingTranslationMin,this.runtimeNode.instancingTranslationMax);this.positionMin=h.clone(i.min,new h),this.positionMax=h.clone(i.max,new h),this.boundingSphere=ae.fromCornerPoints(this.positionMin,this.positionMax,new ae),this.lightingOptions=new YF,this.pickId=void 0}var XF=_9e;function s7(e){e=x(e,x.EMPTY_OBJECT);let t=e.command,n=e.primitiveRenderResources,i=n.model;this._command=t,this._model=i,this._runtimePrimitive=n.runtimePrimitive,this._modelMatrix=t.modelMatrix,this._boundingVolume=t.boundingVolume,this._cullFace=t.renderState.cull.face;let o=i.classificationType;this._classificationType=o,this._classifiesTerrain=o!==Vn.CESIUM_3D_TILE,this._classifies3DTiles=o!==Vn.TERRAIN,this._useDebugWireframe=i._enableDebugWireframe&&i.debugWireframe,this._pickId=n.pickId,this._commandListTerrain=[],this._commandList3DTiles=[],this._commandListIgnoreShow=[],this._commandListDebugWireframe=[],this._commandListTerrainPicking=[],this._commandList3DTilesPicking=[],b9e(this)}function g9e(e){return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:!0,frontFunction:e,frontOperation:{fail:mt.KEEP,zFail:mt.DECREMENT_WRAP,zPass:mt.KEEP},backFunction:e,backOperation:{fail:mt.KEEP,zFail:mt.INCREMENT_WRAP,zPass:mt.KEEP},reference:Ut.CESIUM_3D_TILE_MASK,mask:Ut.CESIUM_3D_TILE_MASK},stencilMask:Ut.CLASSIFICATION_MASK,depthTest:{enabled:!0,func:wc.LESS_OR_EQUAL},depthMask:!1}}var y9e={stencilTest:{enabled:!0,frontFunction:Un.NOT_EQUAL,frontOperation:{fail:mt.ZERO,zFail:mt.ZERO,zPass:mt.ZERO},backFunction:Un.NOT_EQUAL,backOperation:{fail:mt.ZERO,zFail:mt.ZERO,zPass:mt.ZERO},reference:0,mask:Ut.CLASSIFICATION_MASK},stencilMask:Ut.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1,blending:un.PRE_MULTIPLIED_ALPHA_BLEND},x9e={stencilTest:{enabled:!0,frontFunction:Un.NOT_EQUAL,frontOperation:{fail:mt.ZERO,zFail:mt.ZERO,zPass:mt.ZERO},backFunction:Un.NOT_EQUAL,backOperation:{fail:mt.ZERO,zFail:mt.ZERO,zPass:mt.ZERO},reference:0,mask:Ut.CLASSIFICATION_MASK},stencilMask:Ut.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1},aae=[];function b9e(e){let t=e._command,n=aae;if(e._useDebugWireframe){t.pass=we.OPAQUE,n.length=0,n.push(t),e._commandListDebugWireframe=vw(e,n,e._commandListDebugWireframe);let r=e._commandListDebugWireframe,s=r.length;for(let a=0;a<s;a++){let c=r[a];c.count*=2,c.offset*=2}return}let o=e.model.allowPicking;if(e._classifiesTerrain){let r=we.TERRAIN_CLASSIFICATION,s=r7(t,r),a=rae(t,r);n.length=0,n.push(s,a),e._commandListTerrain=vw(e,n,e._commandListTerrain),o&&(e._commandListTerrainPicking=sae(e,n,e._commandListTerrainPicking))}if(e._classifies3DTiles){let r=we.CESIUM_3D_TILE_CLASSIFICATION,s=r7(t,r),a=rae(t,r);n.length=0,n.push(s,a),e._commandList3DTiles=vw(e,n,e._commandList3DTiles),o&&(e._commandList3DTilesPicking=sae(e,n,e._commandList3DTilesPicking))}}function vw(e,t,n){let i=e._runtimePrimitive,o=i.batchLengths,r=i.batchOffsets,s=o.length,a=t.length;for(let c=0;c<s;c++){let l=o[c],f=r[c];for(let d=0;d<a;d++){let p=t[d],g=Qe.shallowClone(p);g.count=l,g.offset=f,n.push(g)}}return n}function r7(e,t){let n=Qe.shallowClone(e);n.cull=!1,n.pass=t;let i=t===we.TERRAIN_CLASSIFICATION?Un.ALWAYS:Un.EQUAL,o=g9e(i);return n.renderState=Ue.fromCache(o),n}function rae(e,t){let n=Qe.shallowClone(e);return n.cull=!1,n.pass=t,n.renderState=Ue.fromCache(y9e),n}var C9e=[];function sae(e,t,n){let i=Ue.fromCache(x9e),o=t[0],r=t[1],s=Qe.shallowClone(o);s.cull=!0,s.pickOnly=!0;let a=Qe.shallowClone(r);a.cull=!0,a.pickOnly=!0,a.renderState=i,a.pickId=e._pickId;let c=C9e;return c.length=0,c.push(s,a),vw(e,c,n)}Object.defineProperties(s7.prototype,{command:{get:function(){return this._command}},runtimePrimitive:{get:function(){return this._runtimePrimitive}},batchLengths:{get:function(){return this._runtimePrimitive.batchLengths}},batchOffsets:{get:function(){return this._runtimePrimitive.batchOffsets}},model:{get:function(){return this._model}},classificationType:{get:function(){return this._classificationType}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix=F.clone(e,this._modelMatrix);let t=this._runtimePrimitive.boundingSphere;this._boundingVolume=ae.transform(t,this._modelMatrix,this._boundingVolume)}},boundingVolume:{get:function(){return this._boundingVolume}},cullFace:{get:function(){return this._cullFace},set:function(e){this._cullFace=e}}});s7.prototype.pushCommands=function(e,t){let n=e.passes;if(n.render){if(this._useDebugWireframe){t.push.apply(t,this._commandListDebugWireframe);return}if(this._classifiesTerrain&&t.push.apply(t,this._commandListTerrain),this._classifies3DTiles&&t.push.apply(t,this._commandList3DTiles),e.invertClassification&&this._classifies3DTiles){if(this._commandListIgnoreShow.length===0){let o=we.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,r=r7(this._command,o),s=aae;s.length=0,s.push(r),this._commandListIgnoreShow=vw(this,s,this._commandListIgnoreShow)}t.push.apply(t,this._commandListIgnoreShow)}}return n.pick&&(this._classifiesTerrain&&t.push.apply(t,this._commandListTerrainPicking),this._classifies3DTiles&&t.push.apply(t,this._commandList3DTilesPicking)),t};var KF=s7;function ZF(e){e=x(e,x.EMPTY_OBJECT);let t=e.command,n=e.primitiveRenderResources,i=n.model;this._model=i;let o=n.runtimePrimitive;this._runtimePrimitive=o;let r=t.pass===we.TRANSLUCENT,a=!o.primitive.material.doubleSided&&!r,c=n.hasSilhouette,l=!r&&!c,f=n.hasSkipLevelOfDetail&&!r,d=c;this._command=t,this._modelMatrix=F.clone(t.modelMatrix),this._boundingVolume=ae.clone(t.boundingVolume),this._modelMatrix2D=new F,this._boundingVolume2D=new ae,this._modelMatrix2DDirty=!1,this._backFaceCulling=t.renderState.cull.enabled,this._cullFace=t.renderState.cull.face,this._shadows=i.shadows,this._debugShowBoundingVolume=t.debugShowBoundingVolume,this._usesBackFaceCulling=a,this._needsTranslucentCommand=l,this._needsSkipLevelOfDetailCommands=f,this._needsSilhouetteCommands=d,this._originalCommand=void 0,this._translucentCommand=void 0,this._skipLodBackfaceCommand=void 0,this._skipLodStencilCommand=void 0,this._silhouetteModelCommand=void 0,this._silhouetteColorCommand=void 0,this._derivedCommands=[],this._has2DCommands=!1,A9e(this)}function Pp(e){this.command=e.command,this.updateShadows=e.updateShadows,this.updateBackFaceCulling=e.updateBackFaceCulling,this.updateCullFace=e.updateCullFace,this.updateDebugShowBoundingVolume=e.updateDebugShowBoundingVolume,this.is2D=x(e.is2D,!1),this.derivedCommand2D=void 0}Pp.clone=function(e){return new Pp({command:e.command,updateShadows:e.updateShadows,updateBackFaceCulling:e.updateBackFaceCulling,updateCullFace:e.updateCullFace,updateDebugShowBoundingVolume:e.updateDebugShowBoundingVolume,is2D:e.is2D,derivedCommand2D:e.derivedCommand2D})};function A9e(e){let t=e._command;t.modelMatrix=e._modelMatrix,t.boundingVolume=e._boundingVolume;let n=e._model,i=e._usesBackFaceCulling,o=e._derivedCommands;e._originalCommand=new Pp({command:t,updateShadows:!0,updateBackFaceCulling:i,updateCullFace:i,updateDebugShowBoundingVolume:!0,is2D:!1}),o.push(e._originalCommand),e._needsTranslucentCommand&&(e._translucentCommand=new Pp({command:I9e(t),updateShadows:!0,updateBackFaceCulling:!1,updateCullFace:!1,updateDebugShowBoundingVolume:!0}),o.push(e._translucentCommand)),e._needsSkipLevelOfDetailCommands&&(e._skipLodBackfaceCommand=new Pp({command:N9e(t),updateShadows:!1,updateBackFaceCulling:!1,updateCullFace:i,updateDebugShowBoundingVolume:!1}),e._skipLodStencilCommand=new Pp({command:F9e(t,n),updateShadows:!0,updateBackFaceCulling:i,updateCullFace:i,updateDebugShowBoundingVolume:!0}),o.push(e._skipLodBackfaceCommand),o.push(e._skipLodStencilCommand)),e._needsSilhouetteCommands&&(e._silhouetteModelCommand=new Pp({command:P9e(t,n),updateShadows:!0,updateBackFaceCulling:i,updateCullFace:i,updateDebugShowBoundingVolume:!0}),e._silhouetteColorCommand=new Pp({command:R9e(t,n),updateShadows:!1,updateBackFaceCulling:!1,updateCullFace:!1,updateDebugShowBoundingVolume:!1}),o.push(e._silhouetteModelCommand),o.push(e._silhouetteColorCommand))}Object.defineProperties(ZF.prototype,{command:{get:function(){return this._command}},runtimePrimitive:{get:function(){return this._runtimePrimitive}},model:{get:function(){return this._model}},primitiveType:{get:function(){return this._command.primitiveType}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix=F.clone(e,this._modelMatrix),this._modelMatrix2DDirty=!0,this._boundingVolume=ae.transform(this.runtimePrimitive.boundingSphere,this._modelMatrix,this._boundingVolume)}},boundingVolume:{get:function(){return this._boundingVolume}},shadows:{get:function(){return this._shadows},set:function(e){this._shadows=e,E9e(this)}},backFaceCulling:{get:function(){return this._backFaceCulling},set:function(e){this._backFaceCulling!==e&&(this._backFaceCulling=e,S9e(this))}},cullFace:{get:function(){return this._cullFace},set:function(e){this._cullFace!==e&&(this._cullFace=e,v9e(this))}},debugShowBoundingVolume:{get:function(){return this._debugShowBoundingVolume},set:function(e){this._debugShowBoundingVolume!==e&&(this._debugShowBoundingVolume=e,w9e(this))}}});function T9e(e,t){let n=e._modelMatrix;e._modelMatrix2D=F.clone(n,e._modelMatrix2D),e._modelMatrix2D[13]-=R.sign(n[13])*2*R.PI*t.mapProjection.ellipsoid.maximumRadius,e._boundingVolume2D=ae.transform(e.runtimePrimitive.boundingSphere,e._modelMatrix2D,e._boundingVolume2D)}function E9e(e){let t=e.shadows,n=xn.castShadows(t),i=xn.receiveShadows(t),o=e._derivedCommands;for(let r=0;r<o.length;++r){let s=o[r];if(s.updateShadows){let a=s.command;a.castShadows=n,a.receiveShadows=i}}}function S9e(e){let t=e.backFaceCulling,n=e._derivedCommands;for(let i=0;i<n.length;++i){let o=n[i];if(o.updateBackFaceCulling){let r=o.command,s=Ge(r.renderState,!0);s.cull.enabled=t,r.renderState=Ue.fromCache(s)}}}function v9e(e){let t=e.cullFace,n=e._derivedCommands;for(let i=0;i<n.length;++i){let o=n[i];if(o.updateCullFace){let r=o.command,s=Ge(r.renderState,!0);s.cull.face=t,r.renderState=Ue.fromCache(s)}}}function w9e(e){let t=e.debugShowBoundingVolume,n=e._derivedCommands;for(let i=0;i<n.length;++i){let o=n[i];if(o.updateDebugShowBoundingVolume){let r=o.command;r.debugShowBoundingVolume=t}}}ZF.prototype.pushCommands=function(e,t){let n=cae(this,e);n&&!this._has2DCommands&&(D9e(this),this._has2DCommands=!0,this._modelMatrix2DDirty=!0),this._modelMatrix2DDirty&&(T9e(this,e),this._modelMatrix2DDirty=!1);let i=this.model.styleCommandsNeeded;if(!(this._needsTranslucentCommand&&u(i)&&(i!==Qh.ALL_OPAQUE&&UA(t,this._translucentCommand,n),i===Qh.ALL_TRANSLUCENT))){if(this._needsSkipLevelOfDetailCommands){let{tileset:o,tile:r}=this._model.content;if(o.hasMixedContent){r._finalResolution||UA(o._backfaceCommands,this._skipLodBackfaceCommand,n),O9e(this,r,n),UA(t,this._skipLodStencilCommand,n);return}}if(this._needsSilhouetteCommands){UA(t,this._silhouetteModelCommand,n);return}return UA(t,this._originalCommand,n),t}};ZF.prototype.pushSilhouetteCommands=function(e,t){let n=cae(this,e);return UA(t,this._silhouetteColorCommand,n),t};function UA(e,t,n){e.push(t.command),n&&e.push(t.derivedCommand2D.command)}function cae(e,t){if(t.mode!==ne.SCENE2D||e.model._projectTo2D)return!1;let i=e.model.sceneGraph._boundingSphere2D,o=i.center.y-i.radius,r=i.center.y+i.radius,s=t.mapProjection.ellipsoid.maximumRadius*R.PI;return o<s&&r>s||o<-s&&r>-s}function VA(e,t){if(!u(t))return;let n=Pp.clone(t),i=Qe.shallowClone(t.command);return i.modelMatrix=e._modelMatrix2D,i.boundingVolume=e._boundingVolume2D,n.command=i,n.updateShadows=!1,n.is2D=!0,t.derivedCommand2D=n,e._derivedCommands.push(n),n}function D9e(e){VA(e,e._originalCommand),VA(e,e._translucentCommand),VA(e,e._skipLodBackfaceCommand),VA(e,e._skipLodStencilCommand),VA(e,e._silhouetteModelCommand),VA(e,e._silhouetteColorCommand)}function I9e(e){let t=Qe.shallowClone(e);t.pass=we.TRANSLUCENT;let n=Ge(e.renderState,!0);return n.cull.enabled=!1,n.depthMask=!1,n.blending=un.ALPHA_BLEND,t.renderState=Ue.fromCache(n),t}function P9e(e,t){let n=t._silhouetteId%255,i=Qe.shallowClone(e),o=Ge(e.renderState,!0);return o.stencilTest={enabled:!0,frontFunction:te.ALWAYS,backFunction:te.ALWAYS,reference:n,mask:-1,frontOperation:{fail:te.KEEP,zFail:te.KEEP,zPass:te.REPLACE},backOperation:{fail:te.KEEP,zFail:te.KEEP,zPass:te.REPLACE}},t.isInvisible()&&(o.colorMask={red:!1,green:!1,blue:!1,alpha:!1}),i.renderState=Ue.fromCache(o),i}function R9e(e,t){let n=t._silhouetteId%255,i=Qe.shallowClone(e),o=Ge(e.renderState,!0);o.cull.enabled=!1,(e.pass===we.TRANSLUCENT||t.silhouetteColor.alpha<1)&&(i.pass=we.TRANSLUCENT,o.depthMask=!1,o.blending=un.ALPHA_BLEND),o.stencilTest={enabled:!0,frontFunction:te.NOTEQUAL,backFunction:te.NOTEQUAL,reference:n,mask:-1,frontOperation:{fail:te.KEEP,zFail:te.KEEP,zPass:te.KEEP},backOperation:{fail:te.KEEP,zFail:te.KEEP,zPass:te.KEEP}};let s=Ge(e.uniformMap);return s.model_silhouettePass=function(){return!0},i.renderState=Ue.fromCache(o),i.uniformMap=s,i.castShadows=!1,i.receiveShadows=!1,i}function O9e(e,t,n){let i=e._skipLodStencilCommand,o=i.command,r=t._selectionDepth,s=M9e(o);if(r!==s){let a=L9e(r),c=Ge(o.renderState,!0);c.stencilTest.reference=a,o.renderState=Ue.fromCache(c),n&&(i.derivedCommand2D.renderState=c)}}function M9e(e){return(e.renderState.stencilTest.reference&Ut.SKIP_LOD_MASK)>>>Ut.SKIP_LOD_BIT_SHIFT}function L9e(e){return Ut.CESIUM_3D_TILE_MASK|e<<Ut.SKIP_LOD_BIT_SHIFT}function N9e(e){let t=Qe.shallowClone(e),n=Ge(e.renderState,!0);n.cull.enabled=!0,n.cull.face=Ci.FRONT,n.colorMask={red:!1,green:!1,blue:!1,alpha:!1},n.polygonOffset={enabled:!0,factor:5,units:5};let i=Ge(t.uniformMap),o=new H(5,5);return i.u_polygonOffset=function(){return o},t.renderState=Ue.fromCache(n),t.uniformMap=i,t.castShadows=!1,t.receiveShadows=!1,t}function F9e(e){let t=Qe.shallowClone(e),n=Ge(e.renderState,!0),{stencilTest:i}=n;return i.enabled=!0,i.mask=Ut.SKIP_LOD_MASK,i.reference=Ut.CESIUM_3D_TILE_MASK,i.frontFunction=Un.GREATER_OR_EQUAL,i.frontOperation.zPass=mt.REPLACE,i.backFunction=Un.GREATER_OR_EQUAL,i.backOperation.zPass=mt.REPLACE,n.stencilMask=Ut.CESIUM_3D_TILE_MASK|Ut.SKIP_LOD_MASK,t.renderState=Ue.fromCache(n),t}var $F=ZF;var QF=`precision highp float;

czm_modelVertexOutput defaultVertexOutput(vec3 positionMC) {
    czm_modelVertexOutput vsOutput;
    vsOutput.positionMC = positionMC;
    vsOutput.pointSize = 1.0;
    return vsOutput;
}

void main()
{
    // Initialize the attributes struct with all
    // attributes except quantized ones.
    ProcessedAttributes attributes;
    initializeAttributes(attributes);

    // Dequantize the quantized ones and add them to the
    // attributes struct.
    #ifdef USE_DEQUANTIZATION
    dequantizationStage(attributes);
    #endif

    #ifdef HAS_MORPH_TARGETS
    morphTargetsStage(attributes);
    #endif

    #ifdef HAS_SKINNING
    skinningStage(attributes);
    #endif

    #ifdef HAS_PRIMITIVE_OUTLINE
    primitiveOutlineStage();
    #endif

    // Compute the bitangent according to the formula in the glTF spec.
    // Normal and tangents can be affected by morphing and skinning, so
    // the bitangent should not be computed until their values are finalized.
    #ifdef HAS_BITANGENTS
    attributes.bitangentMC = normalize(cross(attributes.normalMC, attributes.tangentMC) * attributes.tangentSignMC);
    #endif

    FeatureIds featureIds;
    featureIdStage(featureIds, attributes);

    #ifdef HAS_SELECTED_FEATURE_ID
    SelectedFeature feature;
    selectedFeatureIdStage(feature, featureIds);
    // Handle any show properties that come from the style.
    cpuStylingStage(attributes.positionMC, feature);
    #endif

    #if defined(USE_2D_POSITIONS) || defined(USE_2D_INSTANCING)
    // The scene mode 2D pipeline stage and instancing stage add a different
    // model view matrix to accurately project the model to 2D. However, the
    // output positions and normals should be transformed by the 3D matrices
    // to keep the data the same for the fragment shader.
    mat4 modelView = czm_modelView3D;
    mat3 normal = czm_normal3D;
    #else
    // These are used for individual model projection because they will
    // automatically change based on the scene mode.
    mat4 modelView = czm_modelView;
    mat3 normal = czm_normal;
    #endif

    // Update the position for this instance in place
    #ifdef HAS_INSTANCING

        // The legacy instance stage is used when rendering i3dm models that
        // encode instances transforms in world space, as opposed to glTF models
        // that use EXT_mesh_gpu_instancing, where instance transforms are encoded
        // in object space.
        #ifdef USE_LEGACY_INSTANCING
        mat4 instanceModelView;
        mat3 instanceModelViewInverseTranspose;

        legacyInstancingStage(attributes, instanceModelView, instanceModelViewInverseTranspose);

        modelView = instanceModelView;
        normal = instanceModelViewInverseTranspose;
        #else
        instancingStage(attributes);
        #endif

        #ifdef USE_PICKING
        v_pickColor = a_pickColor;
        #endif

    #endif

    Metadata metadata;
    MetadataClass metadataClass;
    MetadataStatistics metadataStatistics;
    metadataStage(metadata, metadataClass, metadataStatistics, attributes);

    #ifdef HAS_VERTICAL_EXAGGERATION
    verticalExaggerationStage(attributes);
    #endif

    #ifdef HAS_CUSTOM_VERTEX_SHADER
    czm_modelVertexOutput vsOutput = defaultVertexOutput(attributes.positionMC);
    customShaderStage(vsOutput, attributes, featureIds, metadata, metadataClass, metadataStatistics);
    #endif

    // Compute the final position in each coordinate system needed.
    // This returns the value that will be assigned to gl_Position.
    vec4 positionClip = geometryStage(attributes, modelView, normal);

    // This must go after the geometry stage as it needs v_positionWC
    #ifdef HAS_ATMOSPHERE
    atmosphereStage(attributes);
    #endif

    #ifdef ENABLE_CLIPPING_POLYGONS
    modelClippingPolygonsStage(attributes);
    #endif

    #ifdef HAS_SILHOUETTE
    silhouetteStage(attributes, positionClip);
    #endif

    #ifdef HAS_POINT_CLOUD_SHOW_STYLE
    float show = pointCloudShowStylingStage(attributes, metadata);
    #else
    float show = 1.0;
    #endif

    #ifdef HAS_POINT_CLOUD_BACK_FACE_CULLING
    show *= pointCloudBackFaceCullingStage();
    #endif

    #ifdef HAS_POINT_CLOUD_COLOR_STYLE
    v_pointCloudColor = pointCloudColorStylingStage(attributes, metadata);
    #endif

    #ifdef PRIMITIVE_TYPE_POINTS
        #ifdef HAS_CUSTOM_VERTEX_SHADER
        gl_PointSize = vsOutput.pointSize;
        #elif defined(HAS_POINT_CLOUD_POINT_SIZE_STYLE) || defined(HAS_POINT_CLOUD_ATTENUATION)
        gl_PointSize = pointCloudPointSizeStylingStage(attributes, metadata);
        #else
        gl_PointSize = 1.0;
        #endif

        gl_PointSize *= show;
    #endif

    gl_Position = show * positionClip;
}
`;var JF=`
precision highp float;
czm_modelMaterial defaultModelMaterial()
{
    czm_modelMaterial material;
    material.diffuse = vec3(0.0);
    material.specular = vec3(1.0);
    material.roughness = 1.0;
    material.occlusion = 1.0;
    material.normalEC = vec3(0.0, 0.0, 1.0);
    material.emissive = vec3(0.0);
    material.alpha = 1.0;
    return material;
}

vec4 handleAlpha(vec3 color, float alpha)
{
    #ifdef ALPHA_MODE_MASK
    if (alpha < u_alphaCutoff) {
        discard;
    }
    #endif

    return vec4(color, alpha);
}

SelectedFeature selectedFeature;

void main()
{
    #ifdef HAS_MODEL_SPLITTER
    modelSplitterStage();
    #endif

    czm_modelMaterial material = defaultModelMaterial();

    ProcessedAttributes attributes;
    geometryStage(attributes);

    FeatureIds featureIds;
    featureIdStage(featureIds, attributes);

    Metadata metadata;
    MetadataClass metadataClass;
    MetadataStatistics metadataStatistics;
    metadataStage(metadata, metadataClass, metadataStatistics, attributes);

    //========================================================================
    // When not picking metadata START
    #ifndef METADATA_PICKING_ENABLED

    #ifdef HAS_SELECTED_FEATURE_ID
    selectedFeatureIdStage(selectedFeature, featureIds);
    #endif

    #ifndef CUSTOM_SHADER_REPLACE_MATERIAL
    materialStage(material, attributes, selectedFeature);
    #endif

    #ifdef HAS_CUSTOM_FRAGMENT_SHADER
    customShaderStage(material, attributes, featureIds, metadata, metadataClass, metadataStatistics);
    #endif

    lightingStage(material, attributes);

    #ifdef HAS_SELECTED_FEATURE_ID
    cpuStylingStage(material, selectedFeature);
    #endif

    #ifdef HAS_MODEL_COLOR
    modelColorStage(material);
    #endif

    #ifdef HAS_PRIMITIVE_OUTLINE
    primitiveOutlineStage(material);
    #endif

    vec4 color = handleAlpha(material.diffuse, material.alpha);

    // When not picking metadata END
    //========================================================================
    #else 
    //========================================================================
    // When picking metadata START

    vec4 metadataValues = vec4(0.0, 0.0, 0.0, 0.0);
    metadataPickingStage(metadata, metadataClass, metadataValues);
    vec4 color = metadataValues;

    #endif
    // When picking metadata END
    //========================================================================

    #ifdef HAS_CLIPPING_PLANES
    modelClippingPlanesStage(color);
    #endif

    #ifdef ENABLE_CLIPPING_POLYGONS
    modelClippingPolygonsStage();
    #endif

    //========================================================================
    // When not picking metadata START
    #ifndef METADATA_PICKING_ENABLED

    #if defined(HAS_SILHOUETTE) && defined(HAS_NORMALS)
    silhouetteStage(color);
    #endif

    #ifdef HAS_ATMOSPHERE
    atmosphereStage(color, attributes);
    #endif

    #endif
    // When not picking metadata END
    //========================================================================

    out_FragColor = color;
}
`;function lae(){}lae.buildModelDrawCommand=function(e,t){let n=e.shaderBuilder,i=B9e(e,n,t),o=k9e(e,i,t),r=e.model;return u(r.classificationType)?new KF({primitiveRenderResources:e,command:o}):new $F({primitiveRenderResources:e,command:o})};function B9e(e,t,n){t.addVertexLines(QF),t.addFragmentLines(JF);let i=e.model,o=t.buildShaderProgram(n.context);return i._pipelineResources.push(o),o}function k9e(e,t,n){let i=V9e(e),o=new ii({context:n.context,indexBuffer:i,attributes:e.attributes}),r=e.model;r._pipelineResources.push(o);let s=e.alphaOptions.pass,a=r.sceneGraph,c=n.mode===ne.SCENE3D,l,f;if(!c&&!n.scene3DOnly&&r._projectTo2D)l=F.multiplyTransformation(a._computedModelMatrix,e.runtimeNode.computedTransform,new F),f=e.runtimePrimitive.boundingSphere2D;else{let C=c?a._computedModelMatrix:a._computedModelMatrix2D;l=F.multiplyTransformation(C,e.runtimeNode.computedTransform,new F),f=ae.transform(e.boundingSphere,l)}let d=Ge(Ue.fromCache(e.renderStateOptions),!0);d.cull.face=Zt.getCullFace(l,e.primitiveType),d=Ue.fromCache(d);let p=u(r.classificationType),g=p?!1:xn.castShadows(r.shadows),m=p?!1:xn.receiveShadows(r.shadows),y=p?void 0:e.pickId;return new Qe({boundingVolume:f,modelMatrix:l,uniformMap:e.uniformMap,renderState:d,vertexArray:o,shaderProgram:t,cull:r.cull,pass:s,count:e.count,owner:r,pickId:y,pickMetadataAllowed:!0,instanceCount:e.instanceCount,primitiveType:e.primitiveType,debugShowBoundingVolume:r.debugShowBoundingVolume,castShadows:g,receiveShadows:m})}function V9e(e){let t=e.wireframeIndexBuffer;if(u(t))return t;let n=e.indices;if(u(n))return n.buffer}var eB=lae;function uu(e){e=x(e,x.EMPTY_OBJECT);let t=e.modelComponents;this._model=e.model,this._components=t,this._pipelineStages=[],this._updateStages=[],this._runtimeNodes=[],this._rootNodes=[],this._skinnedNodes=[],this._runtimeSkins=[],this.modelPipelineStages=[],this._boundingSphere=void 0,this._boundingSphere2D=void 0,this._computedModelMatrix=F.clone(F.IDENTITY),this._computedModelMatrix2D=F.clone(F.IDENTITY),this._axisCorrectionMatrix=Zt.getAxisCorrectionMatrix(t.upAxis,t.forwardAxis,new F),this._runtimeArticulations={},U9e(this)}Object.defineProperties(uu.prototype,{components:{get:function(){return this._components}},computedModelMatrix:{get:function(){return this._computedModelMatrix}},axisCorrectionMatrix:{get:function(){return this._axisCorrectionMatrix}},boundingSphere:{get:function(){return this._boundingSphere}}});function U9e(e){let t=e._components,n=t.scene,o=e._model.modelMatrix;uae(e,o);let r=t.articulations,s=r.length,a=e._runtimeArticulations;for(let A=0;A<s;A++){let T=r[A],E=new B2({articulation:T,sceneGraph:e}),v=E.name;a[v]=E}let c=t.nodes,l=c.length;e._runtimeNodes=new Array(l);let d=n.nodes.length,p=F.IDENTITY;for(let A=0;A<d;A++){let T=n.nodes[A],E=fae(e,T,p);e._rootNodes.push(E)}let g=t.skins,m=e._runtimeSkins,y=g.length;for(let A=0;A<y;A++){let T=g[A];m.push(new FF({skin:T,sceneGraph:e}))}let b=e._skinnedNodes,C=b.length;for(let A=0;A<C;A++){let T=b[A],E=e._runtimeNodes[T],D=c[T].skin.index;E._runtimeSkin=m[D],E.updateJointMatrices()}e.applyArticulations()}function uae(e,t){let n=e._components,i=e._model;e._computedModelMatrix=F.multiplyTransformation(t,n.transform,e._computedModelMatrix),e._computedModelMatrix=F.multiplyTransformation(e._computedModelMatrix,e._axisCorrectionMatrix,e._computedModelMatrix),e._computedModelMatrix=F.multiplyByUniformScale(e._computedModelMatrix,i.computedScale,e._computedModelMatrix)}var z9e=new h;function H9e(e,t){let n=e._computedModelMatrix,i=F.getTranslation(n,z9e);if(!h.equals(i,h.ZERO))e._computedModelMatrix2D=Lt.basisTo2D(t.mapProjection,n,e._computedModelMatrix2D);else{let o=e.boundingSphere.center,r=Lt.ellipsoidTo2DModelMatrix(t.mapProjection,o,e._computedModelMatrix2D);e._computedModelMatrix2D=F.multiply(r,n,e._computedModelMatrix2D)}e._boundingSphere2D=ae.transform(e._boundingSphere,e._computedModelMatrix2D,e._boundingSphere2D)}function fae(e,t,n){let i=[],o=Zt.getNodeTransform(t),r=t.children.length;for(let f=0;f<r;f++){let d=t.children[f],p=F.multiplyTransformation(n,o,new F),g=fae(e,d,p);i.push(g)}let s=new Q2({node:t,transform:o,transformToRoot:n,children:i,sceneGraph:e}),a=t.primitives.length;for(let f=0;f<a;f++)s.runtimePrimitives.push(new NF({primitive:t.primitives[f],node:t,model:e._model}));let c=t.index;e._runtimeNodes[c]=s,u(t.skin)&&e._skinnedNodes.push(c);let l=t.name;if(u(l)){let f=e._model,d=new W2(f,s);f._nodesByName[l]=d}return c}var G9e=new h,W9e=new h,j9e=new h,q9e=new h;uu.prototype.buildDrawCommands=function(e){let t=this._model,n=new kF(t);t.statistics.clear(),this.configurePipeline(e);let i=this.modelPipelineStages,o,r,s;for(o=0;o<i.length;o++)i[o].process(n,t,e);let a=h.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,G9e),c=h.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,W9e);for(o=0;o<this._runtimeNodes.length;o++){let l=this._runtimeNodes[o];if(!u(l))continue;l.configurePipeline();let f=l.pipelineStages,d=new qF(n,l);for(r=0;r<f.length;r++)f[r].process(d,l.node,e);let p=l.computedTransform;for(r=0;r<l.runtimePrimitives.length;r++){let g=l.runtimePrimitives[r];g.configurePipeline(e);let m=g.pipelineStages,y=new XF(d,g);for(s=0;s<m.length;s++)m[s].process(y,g.primitive,e);g.boundingSphere=ae.clone(y.boundingSphere,new ae);let b=F.multiplyByPoint(p,y.positionMin,j9e),C=F.multiplyByPoint(p,y.positionMax,q9e);h.minimumByComponent(a,b,a),h.maximumByComponent(c,C,c);let A=eB.buildModelDrawCommand(y,e);g.drawCommand=A}}this._boundingSphere=ae.fromCornerPoints(a,c,new ae),this._boundingSphere=ae.transformWithoutScale(this._boundingSphere,this._axisCorrectionMatrix,this._boundingSphere),this._boundingSphere=ae.transform(this._boundingSphere,this._components.transform,this._boundingSphere),t._boundingSphere=ae.transform(this._boundingSphere,t.modelMatrix,t._boundingSphere),t._initialRadius=t._boundingSphere.radius,t._boundingSphere.radius*=t._clampedScale};uu.prototype.configurePipeline=function(e){let t=this.modelPipelineStages;t.length=0;let n=this._model,i=e.fog.enabled&&e.fog.renderable;u(n.color)&&t.push(gx),!u(n.classificationType)&&(n.imageBasedLighting.enabled&&t.push(L2),n.isClippingEnabled()&&t.push(U2),n.isClippingPolygonsEnabled()&&t.push(G2),n.hasSilhouette(e)&&t.push(HF),u(n.splitDirection)&&n.splitDirection!==Wr.NONE&&t.push(jF),Cr.is3DTiles(n.type)&&t.push(I2),i&&t.push(O2))};uu.prototype.update=function(e,t){let n,i,o;for(n=0;n<this._runtimeNodes.length;n++){let r=this._runtimeNodes[n];if(!u(r))continue;for(i=0;i<r.updateStages.length;i++)r.updateStages[i].update(r,this,e);let s=e.mode!==ne.SCENE3D&&this._model._projectTo2D;for(t&&!s&&this.updateJointMatrices(),i=0;i<r.runtimePrimitives.length;i++){let a=r.runtimePrimitives[i];for(o=0;o<a.updateStages.length;o++)a.updateStages[o].update(a,this)}}};uu.prototype.updateModelMatrix=function(e,t){uae(this,e),t.mode!==ne.SCENE3D&&H9e(this,t);let n=this._rootNodes;for(let i=0;i<n.length;i++){let o=this._runtimeNodes[n[i]];o._transformDirty=!0}};uu.prototype.updateJointMatrices=function(){let e=this._skinnedNodes,t=e.length;for(let n=0;n<t;n++){let i=e[n];this._runtimeNodes[i].updateJointMatrices()}};function dae(e,t,n,i,o){if(n&&!t.show)return;let r=t.children.length;for(let c=0;c<r;c++){let l=t.getChild(c);dae(e,l,n,i,o)}let s=t.runtimePrimitives,a=s.length;for(let c=0;c<a;c++){let l=s[c];i(l,o)}}function tB(e,t,n,i){let o=e._rootNodes,r=o.length;for(let s=0;s<r;s++){let a=o[s],c=e._runtimeNodes[a];dae(e,c,t,n,i)}}var Y9e={backFaceCulling:void 0};uu.prototype.updateBackFaceCulling=function(e){let t=Y9e;t.backFaceCulling=e,tB(this,!1,X9e,t)};function X9e(e,t){let n=e.drawCommand;n.backFaceCulling=t.backFaceCulling}var K9e={shadowMode:void 0};uu.prototype.updateShadows=function(e){let t=K9e;t.shadowMode=e,tB(this,!1,Z9e,t)};function Z9e(e,t){let n=e.drawCommand;n.shadows=t.shadowMode}var $9e={debugShowBoundingVolume:void 0};uu.prototype.updateShowBoundingVolume=function(e){let t=$9e;t.debugShowBoundingVolume=e,tB(this,!1,Q9e,t)};function Q9e(e,t){let n=e.drawCommand;n.debugShowBoundingVolume=t.debugShowBoundingVolume}var hae=[],J9e={frameState:void 0,hasSilhouette:void 0};uu.prototype.pushDrawCommands=function(e){let t=hae;t.length=0;let n=J9e;n.hasSilhouette=this._model.hasSilhouette(e),n.frameState=e,tB(this,!0,eWe,n),e.commandList.push.apply(e.commandList,t)};function eWe(e,t){let n=t.frameState,i=t.hasSilhouette,o=n.passes,r=hae,s=e.drawCommand;s.pushCommands(n,n.commandList),i&&!o.pick&&s.pushSilhouetteCommands(n,r)}uu.prototype.setArticulationStage=function(e,t){let n=e.split(" ");if(n.length!==2)return;let i=n[0],o=n[1],r=this._runtimeArticulations[i];u(r)&&r.setArticulationStage(o,t)};uu.prototype.applyArticulations=function(){let e=this._runtimeArticulations;for(let t in e)e.hasOwnProperty(t)&&e[t].apply()};var nB=uu;function zA(){this.pointsLength=0,this.trianglesLength=0,this.geometryByteLength=0,this.texturesByteLength=0,this.propertyTablesByteLength=0,this._bufferIdSet={},this._textureIdSet={},this._batchTextureIdMap=new St}Object.defineProperties(zA.prototype,{batchTexturesByteLength:{get:function(){let e=this._batchTextureIdMap.length,t=this._batchTextureIdMap.values,n=0;for(let i=0;i<e;i++)n+=t[i].byteLength;return n}}});zA.prototype.clear=function(){this.pointsLength=0,this.trianglesLength=0,this.geometryByteLength=0,this.texturesByteLength=0,this.propertyTablesByteLength=0,this._bufferIdSet={},this._textureIdSet={},this._batchTextureIdMap.removeAll()};zA.prototype.addBuffer=function(e,t){if(!this._bufferIdSet.hasOwnProperty(e._id)){let n=t?2:1;this.geometryByteLength+=e.sizeInBytes*n}this._bufferIdSet[e._id]=!0};zA.prototype.addTexture=function(e){this._textureIdSet.hasOwnProperty(e._id)||(this.texturesByteLength+=e.sizeInBytes),this._textureIdSet[e._id]=!0};zA.prototype.addBatchTexture=function(e){this._batchTextureIdMap.contains(e._id)||this._batchTextureIdMap.set(e._id,e)};var iB=zA;var gae=Dr(qI(),1);var mae={},Ax=Uint32Array.BYTES_PER_ELEMENT;mae.parse=function(e,t){t=x(t,0);let n=new Uint8Array(e),i=new DataView(e);t+=Ax;let o=i.getUint32(t,!0);if(o!==1)throw new ce(`Only Point Cloud tile version 1 is supported.  Version ${o} is not.`);t+=Ax,t+=Ax;let r=i.getUint32(t,!0);if(r===0)throw new ce("Feature table must have a byte length greater than zero");t+=Ax;let s=i.getUint32(t,!0);t+=Ax;let a=i.getUint32(t,!0);t+=Ax;let c=i.getUint32(t,!0);t+=Ax;let l=Uo(n,t,r);t+=r;let f=new Uint8Array(e,t,s);t+=s;let d,p;a>0&&(d=Uo(n,t,a),t+=a,c>0&&(p=new Uint8Array(e,t,c),t+=c));let g=new Zh(l,f),m=g.getGlobalProperty("POINTS_LENGTH");if(g.featuresLength=m,!u(m))throw new ce("Feature table global property: POINTS_LENGTH must be defined");let y=g.getGlobalProperty("RTC_CENTER",K.FLOAT,3);u(y)&&(y=h.unpack(y));let b=tWe(g,d);if(b.rtcCenter=y,b.pointsLength=m,!b.hasPositions){let C=nWe(g);b.positions=C,b.hasPositions=b.hasPositions||u(C)}if(!b.hasPositions)throw new ce("Either POSITION or POSITION_QUANTIZED must be defined.");if(!b.hasNormals){let C=oWe(g);b.normals=C,b.hasNormals=b.hasNormals||u(C)}if(!b.hasColors){let C=iWe(g);b.colors=C,b.hasColors=b.hasColors||u(C),b.hasConstantColor=u(b.constantColor),b.isTranslucent=u(C)&&C.isTranslucent}if(!b.hasBatchIds){let C=rWe(g);b.batchIds=C,b.hasBatchIds=b.hasBatchIds||u(C)}if(b.hasBatchIds){let C=g.getGlobalProperty("BATCH_LENGTH");if(!u(C))throw new ce("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");b.batchLength=C}return u(p)&&(p=new Uint8Array(p),b.batchTableJson=d,b.batchTableBinary=p),b};function tWe(e,t){let n=e.json,i,o,r,s=u(n.extensions)?n.extensions["3DTILES_draco_point_compression"]:void 0,a=u(t)&&u(t.extensions)?t.extensions["3DTILES_draco_point_compression"]:void 0;u(a)&&(r=a.properties);let c,l,f,d,p;if(u(s)){o=s.properties;let m=s.byteOffset,y=s.byteLength;if(!u(o)||!u(m)||!u(y))throw new ce("Draco properties, byteOffset, and byteLength must be defined");i=e.buffer.slice(m,m+y),c=u(o.POSITION),l=u(o.RGB)||u(o.RGBA),f=u(o.NORMAL),d=u(o.BATCH_ID),p=u(o.RGBA)}let g;return u(i)&&(g={buffer:i,featureTableProperties:o,batchTableProperties:r,properties:bt(o,r),dequantizeInShader:!0}),{draco:g,hasPositions:c,hasColors:l,isTranslucent:p,hasNormals:f,hasBatchIds:d}}function nWe(e){let t=e.json,n;if(u(t.POSITION))return n=e.getPropertyArray("POSITION",K.FLOAT,3),{name:Tt.POSITION,semantic:Tt.POSITION,typedArray:n,isQuantized:!1,componentDatatype:K.FLOAT,type:rn.VEC3};if(u(t.POSITION_QUANTIZED)){n=e.getPropertyArray("POSITION_QUANTIZED",K.UNSIGNED_SHORT,3);let i=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",K.FLOAT,3);if(!u(i))throw new ce("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");let o=65535,r=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",K.FLOAT,3);if(!u(r))throw new ce("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");return{name:Tt.POSITION,semantic:Tt.POSITION,typedArray:n,isQuantized:!0,componentDatatype:K.FLOAT,type:rn.VEC3,quantizedRange:o,quantizedVolumeOffset:h.unpack(r),quantizedVolumeScale:h.unpack(i),quantizedComponentDatatype:K.UNSIGNED_SHORT,quantizedType:rn.VEC3}}}function iWe(e){let t=e.json,n;if(u(t.RGBA))return n=e.getPropertyArray("RGBA",K.UNSIGNED_BYTE,4),{name:Tt.COLOR,semantic:Tt.COLOR,setIndex:0,typedArray:n,componentDatatype:K.UNSIGNED_BYTE,type:rn.VEC4,normalized:!0,isRGB565:!1,isTranslucent:!0};if(u(t.RGB))return n=e.getPropertyArray("RGB",K.UNSIGNED_BYTE,3),{name:"COLOR",semantic:Tt.COLOR,setIndex:0,typedArray:n,componentDatatype:K.UNSIGNED_BYTE,type:rn.VEC3,normalized:!0,isRGB565:!1,isTranslucent:!1};if(u(t.RGB565))return n=e.getPropertyArray("RGB565",K.UNSIGNED_SHORT,1),{name:"COLOR",semantic:Tt.COLOR,setIndex:0,typedArray:n,componentDatatype:K.FLOAT,type:rn.VEC3,normalized:!1,isRGB565:!0,isTranslucent:!1};if(u(t.CONSTANT_RGBA)){let i=e.getGlobalProperty("CONSTANT_RGBA",K.UNSIGNED_BYTE,4),o=i[3],r=G.fromBytes(i[0],i[1],i[2],o),s=o<255;return{name:Tt.COLOR,semantic:Tt.COLOR,setIndex:0,constantColor:r,componentDatatype:K.FLOAT,type:rn.VEC4,isQuantized:!1,isTranslucent:s}}}function oWe(e){let t=e.json,n;if(u(t.NORMAL))return n=e.getPropertyArray("NORMAL",K.FLOAT,3),{name:Tt.NORMAL,semantic:Tt.NORMAL,typedArray:n,octEncoded:!1,octEncodedZXY:!1,componentDatatype:K.FLOAT,type:rn.VEC3};if(u(t.NORMAL_OCT16P))return n=e.getPropertyArray("NORMAL_OCT16P",K.UNSIGNED_BYTE,2),{name:Tt.NORMAL,semantic:Tt.NORMAL,typedArray:n,octEncoded:!0,octEncodedZXY:!1,quantizedRange:(1<<8)-1,quantizedType:rn.VEC2,quantizedComponentDatatype:K.UNSIGNED_BYTE,componentDatatype:K.FLOAT,type:rn.VEC3}}function rWe(e){let t=e.json;if(u(t.BATCH_ID)){let n=e.getPropertyArray("BATCH_ID",K.UNSIGNED_SHORT,1);return{name:Tt.FEATURE_ID,semantic:Tt.FEATURE_ID,setIndex:0,typedArray:n,componentDatatype:K.fromTypedArray(n),type:rn.SCALAR}}}var HA=mae;var sWe=bn.Components,aWe=bn.Scene,cWe=bn.Node,lWe=bn.Primitive,uWe=bn.Attribute,pae=bn.Quantization,fWe=bn.FeatureIdAttribute,dWe=bn.Material,hWe=bn.MetallicRoughness;function Fg(e){e=x(e,x.EMPTY_OBJECT);let t=e.arrayBuffer,n=x(e.byteOffset,0);this._arrayBuffer=t,this._byteOffset=n,this._loadAttributesFor2D=x(e.loadAttributesFor2D,!1),this._parsedContent=void 0,this._decodePromise=void 0,this._decodedAttributes=void 0,this._promise=void 0,this._error=void 0,this._state=_t.UNLOADED,this._buffers=[],this._components=void 0,this._transform=F.IDENTITY}u(Object.create)&&(Fg.prototype=Object.create(Qi.prototype),Fg.prototype.constructor=Fg);Object.defineProperties(Fg.prototype,{cacheKey:{get:function(){}},components:{get:function(){return this._components}},transform:{get:function(){return this._transform}}});Fg.prototype.load=function(){if(u(this._promise))return this._promise;this._parsedContent=HA.parse(this._arrayBuffer,this._byteOffset),this._state=_t.PROCESSING,this._promise=Promise.resolve(this)};Fg.prototype.process=function(e){if(u(this._error)){let t=this._error;throw this._error=void 0,t}if(this._state===_t.READY)return!0;if(this._state===_t.PROCESSING){if(u(this._decodePromise))return!1;this._decodePromise=mWe(this,e.context)}return!1};function mWe(e,t){let i=e._parsedContent.draco,o;if(u(i)?o=fg.decodePointCloud(i,t):o=Promise.resolve(),!!u(o))return e._decodePromise=o,o.then(function(r){if(!e.isDestroyed())return u(r)&&pWe(e,i,r),vWe(e,t),e._state=_t.READY,e}).catch(function(r){e.unload(),e._state=_t.FAILED;let s="Failed to load Draco pnts";e._error=e.getError(s,r)})}function pWe(e,t,n){e._state=_t.READY;let i=e._parsedContent,o;if(u(n.POSITION)){if(o={name:"POSITION",semantic:Tt.POSITION,typedArray:n.POSITION.array,componentDatatype:K.FLOAT,type:rn.VEC3,isQuantized:!1},u(n.POSITION.data.quantization)){let a=n.POSITION.data.quantization,c=a.range,l=h.fromElements(c,c,c),f=h.unpack(a.minValues),d=(1<<a.quantizationBits)-1;o.isQuantized=!0,o.quantizedRange=d,o.quantizedVolumeOffset=f,o.quantizedVolumeScale=l,o.quantizedComponentDatatype=d<=255?K.UNSIGNED_BYTE:K.UNSIGNED_SHORT,o.quantizedType=rn.VEC3}i.positions=o}if(u(n.NORMAL)){if(o={name:"NORMAL",semantic:Tt.NORMAL,typedArray:n.NORMAL.array,componentDatatype:K.FLOAT,type:rn.VEC3,isQuantized:!1,octEncoded:!1,octEncodedZXY:!1},u(n.NORMAL.data.quantization)){let a=(1<<n.NORMAL.data.quantization.quantizationBits)-1;o.quantizedRange=a,o.octEncoded=!0,o.octEncodedZXY=!0,o.quantizedComponentDatatype=K.UNSIGNED_BYTE,o.quantizedType=rn.VEC2}i.normals=o}if(u(n.RGBA)?i.colors={name:"COLOR",semantic:Tt.COLOR,setIndex:0,typedArray:n.RGBA.array,componentDatatype:K.UNSIGNED_BYTE,type:rn.VEC4,normalized:!0,isTranslucent:!0}:u(n.RGB)&&(i.colors={name:"COLOR",semantic:Tt.COLOR,setIndex:0,typedArray:n.RGB.array,componentDatatype:K.UNSIGNED_BYTE,type:rn.VEC3,normalized:!0,isTranslucent:!1}),u(n.BATCH_ID)){let a=n.BATCH_ID.array;i.batchIds={name:"_FEATURE_ID",semantic:Tt.FEATURE_ID,setIndex:0,typedArray:a,componentDatatype:K.fromTypedArray(a),type:rn.SCALAR}}let r=i.batchTableJson,s=t.batchTableProperties;for(let a in s)if(s.hasOwnProperty(a)){let c=n[a];u(r)||(r={}),i.hasDracoBatchTable=!0;let l=c.data;r[a]={byteOffset:l.byteOffset,type:_We(l.componentsPerAttribute),componentType:gWe(l.componentDatatype),typedArray:c.array}}i.batchTableJson=r}function _We(e){switch(e){case 1:return"SCALAR";case 2:return"VEC2";case 3:return"VEC3";case 4:return"VEC4"}}function gWe(e){switch(e){case te.BYTE:return"BYTE";case te.UNSIGNED_BYTE:return"UNSIGNED_BYTE";case te.SHORT:return"SHORT";case te.UNSIGNED_SHORT:return"UNSIGNED_SHORT";case te.INT:return"INT";case te.UNSIGNED_INT:return"UNSIGNED_INT";case te.DOUBLE:return"DOUBLE";case te.FLOAT:return"FLOAT"}}function ww(e,t,n){let i=t.typedArray,o;if(t.octEncoded&&(o=new pae,o.octEncoded=t.octEncoded,o.octEncodedZXY=t.octEncodedZXY,o.normalizationRange=t.quantizedRange,o.type=t.quantizedType,o.componentDatatype=t.quantizedComponentDatatype),t.isQuantized){o=new pae;let a=t.quantizedRange;o.normalizationRange=a,o.quantizedVolumeOffset=h.ZERO;let c=t.quantizedVolumeScale;o.quantizedVolumeDimensions=c,o.quantizedVolumeStepSize=h.divideByScalar(c,a,new h),o.componentDatatype=t.quantizedComponentDatatype,o.type=t.quantizedType}let r=new uWe;if(r.name=t.name,r.semantic=t.semantic,r.setIndex=t.setIndex,r.componentDatatype=t.componentDatatype,r.type=t.type,r.normalized=x(t.normalized,!1),r.min=t.min,r.max=t.max,r.quantization=o,t.isRGB565&&(i=Ln.decodeRGB565(i)),u(t.constantColor)){let a=new Array(4);r.constant=G.pack(t.constantColor,a)}else{let a=xt.createVertexBuffer({typedArray:i,context:n,usage:ke.STATIC_DRAW});a.vertexArrayDestroyable=!1,e._buffers.push(a),r.buffer=a}let s=e._loadAttributesFor2D;return r.semantic===Tt.POSITION&&s&&(r.typedArray=i),r}var _ae,oB;function yWe(e){if(!u(oB)){_ae=new gae.default(0),oB=new Array(e);for(let t=0;t<e;++t)oB[t]=_ae.random()}return oB}var xWe=new h,bWe=new h,CWe=new h;function AWe(e){let t=e.typedArray,n=20,i=t.length/3,o=Math.min(i,n),r=yWe(n),s=Number.MAX_VALUE,a=-Number.MAX_VALUE,c=h.fromElements(s,s,s,xWe),l=h.fromElements(a,a,a,bWe),f,d,p;if(e.isQuantized)c=h.ZERO,l=e.quantizedVolumeScale;else for(f=0;f<o;++f)d=Math.floor(r[f]*i),p=h.unpack(t,d*3,CWe),h.minimumByComponent(c,p,c),h.maximumByComponent(l,p,l);e.min=h.clone(c),e.max=h.clone(l)}var TWe={name:Tt.COLOR,semantic:Tt.COLOR,setIndex:0,constantColor:G.DARKGRAY,componentDatatype:K.FLOAT,type:rn.VEC4,isQuantized:!1,isTranslucent:!1};function EWe(e,t,n){let i=[],o,r=t.positions;return u(r)&&(AWe(r),o=ww(e,r,n),o.count=t.pointsLength,i.push(o)),u(t.normals)&&(o=ww(e,t.normals,n),i.push(o)),u(t.colors)?(o=ww(e,t.colors,n),i.push(o)):(o=ww(e,TWe,n),i.push(o)),u(t.batchIds)&&(o=ww(e,t.batchIds,n),i.push(o)),i}function SWe(e,t){let n=e.batchLength,i=e.pointsLength,o=e.batchTableBinary,r=!u(e.batchIds);if(u(o)||e.hasDracoBatchTable){let s=x(n,i);return Pg({count:s,batchTable:e.batchTableJson,binaryBody:o,parseAsPropertyAttributes:r,customAttributeOutput:t})}return new oa({schema:{},propertyTables:[]})}function vWe(e,t){let n=e._parsedContent,i=new hWe;i.metallicFactor=0,i.roughnessFactor=.9;let o=new dWe;o.metallicRoughness=i;let r=n.colors;u(r)&&r.isTranslucent&&(o.alphaMode=bp.BLEND);let s=!u(n.normals);o.unlit=s;let a=new lWe;if(a.attributes=EWe(e,n,t),a.primitiveType=Ne.POINTS,a.material=o,u(n.batchIds)){let g=new fWe;g.propertyTableId=0,g.setIndex=0,g.positionalLabel="featureId_0",a.featureIds.push(g)}let c=new cWe;c.index=0,c.primitives=[a];let l=new aWe;l.nodes=[c],l.upAxis=Vo.Z,l.forwardAxis=Vo.X;let f=new sWe;f.scene=l,f.nodes=[c];let d=[];f.structuralMetadata=SWe(n,d),d.length>0&&wWe(e,a,d,t),u(n.rtcCenter)&&(f.transform=F.multiplyByTranslation(f.transform,n.rtcCenter,f.transform));let p=n.positions;u(p)&&p.isQuantized&&(f.transform=F.multiplyByTranslation(f.transform,p.quantizedVolumeOffset,f.transform)),e._components=f,e._parsedContent=void 0,e._arrayBuffer=void 0}function wWe(e,t,n,i){let o=t.attributes,r=n.length;for(let s=0;s<r;s++){let a=n[s],c=xt.createVertexBuffer({typedArray:a.typedArray,context:i,usage:ke.STATIC_DRAW});c.vertexArrayDestroyable=!1,e._buffers.push(c),a.buffer=c,a.typedArray=void 0,o.push(a)}t.propertyAttributeIds=[0]}Fg.prototype.unload=function(){let e=this._buffers;for(let t=0;t<e.length;t++)e[t].destroy();e.length=0,this._components=void 0,this._parsedContent=void 0,this._arrayBuffer=void 0};var rB=Fg;var DWe=new h,IWe=new h,PWe=new h,RWe=new F,OWe=new F,MWe=new F,LWe=new de,NWe=new ae;function Dw(e,t,n,i,o,r,s){if(!e._ready||n.mode===ne.MORPHING)return;let a=Number.MAX_VALUE,c=e.sceneGraph,l=c._runtimeNodes;for(let f=0;f<l.length;f++){let d=l[f],p=d.node,g=F.clone(d.computedTransform,RWe),m=F.clone(c.computedModelMatrix,OWe),y=p.instances;u(y)&&y.transformInWorldSpace&&(m=F.multiplyTransformation(e.modelMatrix,c.components.transform,m),g=F.multiplyTransformation(c.axisCorrectionMatrix,d.computedTransform,g));let b=F.multiplyTransformation(m,g,MWe);n.mode!==ne.SCENE3D&&(b=Lt.basisTo2D(n.mapProjection,b,b));let C=[];if(u(y)){let T=y.attributes[0].count,E=y.attributes[0].componentDatatype,v=12,D=d.transformsTypedArray;if(!u(D)){let O=d.instancingTransformsBuffer;u(O)&&n.context.webgl2&&(D=K.createTypedArray(E,T*v),O.getBufferData(D))}if(u(D))for(let O=0;O<T;O++){let P=O*v,M=new F(D[P],D[P+1],D[P+2],D[P+3],D[P+4],D[P+5],D[P+6],D[P+7],D[P+8],D[P+9],D[P+10],D[P+11],0,0,0,1);y.transformInWorldSpace?(F.multiplyTransformation(M,g,M),F.multiplyTransformation(m,M,M)):F.multiplyTransformation(M,b,M),C.push(M)}}C.length===0&&C.push(b);let A=d.runtimePrimitives.length;for(let T=0;T<A;T++){let E=d.runtimePrimitives[T],v=E.primitive;if(u(E.boundingSphere)&&!u(y)){let j=ae.transform(E.boundingSphere,b,NWe),Q=Qn.raySphere(t,j);if(!u(Q))continue}let D=Zt.getAttributeBySemantic(v,Tt.POSITION),O=D.byteOffset,P=D.byteStride,M=D.count;if(!u(v.indices))continue;let L=v.indices.typedArray;if(!u(L)){let j=v.indices.buffer,Q=v.indices.count,q=v.indices.indexDatatype;u(j)&&n.context.webgl2&&(q===Be.UNSIGNED_BYTE?L=new Uint8Array(Q):q===Be.UNSIGNED_SHORT?L=new Uint16Array(Q):q===Be.UNSIGNED_INT&&(L=new Uint32Array(Q)),j.getBufferData(L))}let _=D.typedArray,S=D.componentDatatype,w=D.type,I=D.quantization;u(I)&&(S=D.quantization.componentDatatype,w=D.quantization.type);let N=rn.getNumberOfComponents(w),k=K.getSizeInBytes(S),z=!u(_)&&u(P)&&P!==N*k,V=N,U=0;z&&(V=P/k,U=O/k);let B=M*V;if(!u(_)){let j=D.buffer;u(j)&&n.context.webgl2&&(_=K.createTypedArray(S,B),j.getBufferData(_,z?0:O,0,B)),I&&D.normalized&&(_=Ln.dequantize(_,S,w,M))}if(!u(L)||!u(_))return;r=x(r,ee.default),i=x(i,1),o=x(o,0);let W=L.length;for(let j=0;j<W;j+=3){let Q=L[j],q=L[j+1],X=L[j+2];for(let Z of C){let fe=a7(_,Q,U,V,I,Z,i,o,r,DWe),xe=a7(_,q,U,V,I,Z,i,o,r,IWe),re=a7(_,X,U,V,I,Z,i,o,r,PWe),pe=Qn.rayTriangleParametric(t,fe,xe,re,x(e.backFaceCulling,!0));u(pe)&&pe<a&&pe>=0&&(a=pe)}}}}if(a!==Number.MAX_VALUE){if(s=_n.getPoint(t,a,s),n.mode!==ne.SCENE3D){h.fromElements(s.y,s.z,s.x,s);let f=n.mapProjection,d=f.ellipsoid,p=f.unproject(s,LWe);d.cartographicToCartesian(p,s)}return s}}function a7(e,t,n,i,o,r,s,a,c,l){let f=n+t*i;if(l.x=e[f],l.y=e[f+1],l.z=e[f+2],u(o))if(o.octEncoded){if(l=Ln.octDecodeInRange(l,o.normalizationRange,l),o.octEncodedZXY){let d=l.x;l.x=l.z,l.z=l.y,l.y=d}}else l=h.multiplyComponents(l,o.quantizedVolumeStepSize,l),l=h.add(l,o.quantizedVolumeOffset,l);return l=F.multiplyByPoint(r,l,l),s!==1&&Mr.getPosition(l,c,s,a,l),l}function co(e){e=x(e,x.EMPTY_OBJECT),this._loader=e.loader,this._resource=e.resource,this.type=x(e.type,Cr.GLTF),this.modelMatrix=F.clone(x(e.modelMatrix,F.IDENTITY)),this._modelMatrix=F.clone(this.modelMatrix),this._scale=x(e.scale,1),this._minimumPixelSize=x(e.minimumPixelSize,0),this._maximumScale=e.maximumScale,this._clampedScale=u(this._maximumScale)?Math.min(this._scale,this._maximumScale):this._scale,this._computedScale=this._clampedScale,this._updateModelMatrix=!1,this.referenceMatrix=void 0,this._iblReferenceFrameMatrix=J.clone(J.IDENTITY),this._resourcesLoaded=!1,this._drawCommandsBuilt=!1,this._ready=!1,this._customShader=e.customShader,this._content=e.content,this._texturesLoaded=!1,this._defaultTexture=void 0,this._activeAnimations=new v2(this),this._clampAnimations=x(e.clampAnimations,!0),this._userAnimationDirty=!1,this._id=e.id,this._idDirty=!1,this._color=G.clone(e.color),this._colorBlendMode=x(e.colorBlendMode,Bc.HIGHLIGHT),this._colorBlendAmount=x(e.colorBlendAmount,.5);let t=x(e.silhouetteColor,G.RED);this._silhouetteColor=G.clone(t),this._silhouetteSize=x(e.silhouetteSize,0),this._silhouetteDirty=!1,this._silhouetteId=void 0,this._cull=x(e.cull,!0),this._opaquePass=x(e.opaquePass,we.OPAQUE),this._allowPicking=x(e.allowPicking,!0),this._show=x(e.show,!0),this._style=void 0,this._styleDirty=!1,this._styleCommandsNeeded=void 0;let n=x(e.featureIdLabel,"featureId_0");typeof n=="number"&&(n=`featureId_${n}`),this._featureIdLabel=n;let i=x(e.instanceFeatureIdLabel,"instanceFeatureId_0");typeof i=="number"&&(i=`instanceFeatureId_${i}`),this._instanceFeatureIdLabel=i,this._featureTables=[],this._featureTableId=void 0,this._featureTableIdDirty=!0,this._pipelineResources=[],this._modelResources=[],this._pickIds=[],this._boundingSphere=new ae,this._initialRadius=void 0,this._heightReference=x(e.heightReference,Xe.NONE),this._heightDirty=this._heightReference!==Xe.NONE,this._removeUpdateHeightCallback=void 0,this._enableVerticalExaggeration=x(e.enableVerticalExaggeration,!0),this._hasVerticalExaggeration=!1,this._clampedModelMatrix=void 0;let o=e.scene;u(o)&&u(o.terrainProviderChanged)&&(this._terrainProviderChangedCallback=o.terrainProviderChanged.addEventListener(()=>{this._heightDirty=!0})),this._scene=o,this._distanceDisplayCondition=e.distanceDisplayCondition;let r=new Tp(e.pointCloudShading);this._pointCloudShading=r,this._attenuation=r.attenuation,this._pointCloudBackFaceCulling=r.backFaceCulling;let s=e.clippingPlanes;u(s)&&s.owner===void 0?As.setOwner(s,this,"_clippingPlanes"):this._clippingPlanes=s,this._clippingPlanesState=0,this._clippingPlanesMatrix=F.clone(F.IDENTITY);let a=e.clippingPolygons;u(a)&&a.owner===void 0?Yh.setOwner(a,this,"_clippingPolygons"):this._clippingPolygons=a,this._clippingPolygonsState=0,this._lightColor=h.clone(e.lightColor),this._imageBasedLighting=u(e.imageBasedLighting)?e.imageBasedLighting:new nA,this._shouldDestroyImageBasedLighting=!u(e.imageBasedLighting),this._environmentMapManager=void 0;let c=new Eg(e.environmentMapOptions);Eg.setOwner(c,this,"_environmentMapManager"),this._backFaceCulling=x(e.backFaceCulling,!0),this._backFaceCullingDirty=!1,this._shadows=x(e.shadows,xn.ENABLED),this._shadowsDirty=!1,this._debugShowBoundingVolumeDirty=!1,this._debugShowBoundingVolume=x(e.debugShowBoundingVolume,!1),this._enableDebugWireframe=x(e.enableDebugWireframe,!1),this._enableShowOutline=x(e.enableShowOutline,!0),this._debugWireframe=x(e.debugWireframe,!1),this._debugWireframe===!0&&this._enableDebugWireframe===!1&&this.type===Cr.GLTF&&At("model-debug-wireframe-ignored","enableDebugWireframe must be set to true in Model.fromGltf, otherwise debugWireframe will be ignored.");let l=e.credit;typeof l=="string"&&(l=new wt(l)),this._credits=[],this._credit=l,this._resourceCredits=[],this._gltfCredits=[],this._showCreditsOnScreen=x(e.showCreditsOnScreen,!1),this._showCreditsOnScreenDirty=!0,this._splitDirection=x(e.splitDirection,Wr.NONE),this._enableShowOutline=x(e.enableShowOutline,!0),this.showOutline=x(e.showOutline,!0),this.outlineColor=x(e.outlineColor,G.BLACK),this._classificationType=e.classificationType,this._statistics=new iB,this._sceneMode=void 0,this._projectTo2D=x(e.projectTo2D,!1),this._enablePick=x(e.enablePick,!1),this._fogRenderable=void 0,this._skipLevelOfDetail=!1,this._ignoreCommands=x(e.ignoreCommands,!1),this._errorEvent=new me,this._readyEvent=new me,this._texturesReadyEvent=new me,this._sceneGraph=void 0,this._nodesByName={},this.pickObject=e.pickObject}function c7(e,t){if(e._errorEvent.numberOfListeners>0){e._errorEvent.raiseEvent(t);return}console.log(t)}function FWe(e,t){let n=e._featureTables,i=t.propertyTables,o=i.length;for(let r=0;r<o;r++){let s=i[r],a=new D2({model:e,propertyTable:s});n.push(a)}return n}function BWe(e,t){let n=t._featureIdLabel,i=t._instanceFeatureIdLabel,o,r,s,a;for(o=0;o<e.nodes.length;o++)if(a=e.nodes[o],u(a.instances)&&(s=Zt.getFeatureIdsByLabel(a.instances.featureIds,i),u(s)&&u(s.propertyTableId)))return s.propertyTableId;for(o=0;o<e.nodes.length;o++)for(a=e.nodes[o],r=0;r<a.primitives.length;r++){let c=a.primitives[r],l=Zt.getFeatureIdsByLabel(c.featureIds,n);if(u(l))return l.propertyTableId}if(t._featureTables.length===1)return 0}function f7(e,t){if(!u(e)&&!u(t))return!1;if(u(e)!==u(t))return!0;let n=e.alpha,i=t.alpha;return Math.floor(n)!==Math.floor(i)||Math.ceil(n)!==Math.ceil(i)}Object.defineProperties(co.prototype,{ready:{get:function(){return this._ready}},errorEvent:{get:function(){return this._errorEvent}},readyEvent:{get:function(){return this._readyEvent}},incrementallyLoadTextures:{get:function(){return x(this._loader.incrementallyLoadTextures,!1)}},texturesReadyEvent:{get:function(){return this._texturesReadyEvent}},loader:{get:function(){return this._loader}},statistics:{get:function(){return this._statistics}},activeAnimations:{get:function(){return this._activeAnimations}},clampAnimations:{get:function(){return this._clampAnimations},set:function(e){this._clampAnimations=e}},cull:{get:function(){return this._cull}},opaquePass:{get:function(){return this._opaquePass}},pointCloudShading:{get:function(){return this._pointCloudShading},set:function(e){e!==this._pointCloudShading&&this.resetDrawCommands(),this._pointCloudShading=e}},customShader:{get:function(){return this._customShader},set:function(e){e!==this._customShader&&this.resetDrawCommands(),this._customShader=e}},sceneGraph:{get:function(){return this._sceneGraph}},content:{get:function(){return this._content}},heightReference:{get:function(){return this._heightReference},set:function(e){e!==this._heightReference&&(this._heightDirty=!0),this._heightReference=e}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){this._distanceDisplayCondition=Nt.clone(e,this._distanceDisplayCondition)}},structuralMetadata:{get:function(){return this._sceneGraph.components.structuralMetadata}},featureTableId:{get:function(){return this._featureTableId},set:function(e){this._featureTableId=e}},featureTables:{get:function(){return this._featureTables},set:function(e){this._featureTables=e}},id:{get:function(){return this._id},set:function(e){e!==this._id&&(this._idDirty=!0),this._id=e}},allowPicking:{get:function(){return this._allowPicking}},style:{get:function(){return this._style},set:function(e){this._style=e,this._styleDirty=!0}},color:{get:function(){return this._color},set:function(e){f7(e,this._color)&&this.resetDrawCommands(),this._color=G.clone(e,this._color)}},colorBlendMode:{get:function(){return this._colorBlendMode},set:function(e){this._colorBlendMode=e}},colorBlendAmount:{get:function(){return this._colorBlendAmount},set:function(e){this._colorBlendAmount=e}},silhouetteColor:{get:function(){return this._silhouetteColor},set:function(e){if(!G.equals(e,this._silhouetteColor)){let t=f7(e,this._silhouetteColor);this._silhouetteDirty=this._silhouetteDirty||t}this._silhouetteColor=G.clone(e,this._silhouetteColor)}},silhouetteSize:{get:function(){return this._silhouetteSize},set:function(e){if(e!==this._silhouetteSize){let t=this._silhouetteSize,n=e>0&&t===0||e===0&&t>0;this._silhouetteDirty=this._silhouetteDirty||n,this._backFaceCullingDirty=this._backFaceCullingDirty||n}this._silhouetteSize=e}},boundingSphere:{get:function(){let e=u(this._clampedModelMatrix)?this._clampedModelMatrix:this.modelMatrix;return bae(this,e),this._boundingSphere}},debugShowBoundingVolume:{get:function(){return this._debugShowBoundingVolume},set:function(e){this._debugShowBoundingVolume!==e&&(this._debugShowBoundingVolumeDirty=!0),this._debugShowBoundingVolume=e}},debugWireframe:{get:function(){return this._debugWireframe},set:function(e){this._debugWireframe!==e&&this.resetDrawCommands(),this._debugWireframe=e,this._debugWireframe===!0&&this._enableDebugWireframe===!1&&this.type===Cr.GLTF&&At("model-debug-wireframe-ignored","enableDebugWireframe must be set to true in Model.fromGltfAsync, otherwise debugWireframe will be ignored.")}},show:{get:function(){return this._show},set:function(e){this._show=e}},featureIdLabel:{get:function(){return this._featureIdLabel},set:function(e){typeof e=="number"&&(e=`featureId_${e}`),e!==this._featureIdLabel&&(this._featureTableIdDirty=!0),this._featureIdLabel=e}},instanceFeatureIdLabel:{get:function(){return this._instanceFeatureIdLabel},set:function(e){typeof e=="number"&&(e=`instanceFeatureId_${e}`),e!==this._instanceFeatureIdLabel&&(this._featureTableIdDirty=!0),this._instanceFeatureIdLabel=e}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){e!==this._clippingPlanes&&(As.setOwner(e,this,"_clippingPlanes"),this.resetDrawCommands())}},clippingPolygons:{get:function(){return this._clippingPolygons},set:function(e){e!==this._clippingPolygons&&(Yh.setOwner(e,this,"_clippingPolygons"),this.resetDrawCommands())}},enableVerticalExaggeration:{get:function(){return this._enableVerticalExaggeration},set:function(e){e!==this._enableVerticalExaggeration&&this.resetDrawCommands(),this._enableVerticalExaggeration=e}},hasVerticalExaggeration:{get:function(){return this._hasVerticalExaggeration}},lightColor:{get:function(){return this._lightColor},set:function(e){u(e)!==u(this._lightColor)&&this.resetDrawCommands(),this._lightColor=h.clone(e,this._lightColor)}},imageBasedLighting:{get:function(){return this._imageBasedLighting},set:function(e){e!==this._imageBasedLighting&&(this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=e,this._shouldDestroyImageBasedLighting=!1,this.resetDrawCommands())}},environmentMapManager:{get:function(){return this._environmentMapManager},set:function(e){e!==this.environmentMapManager&&(Eg.setOwner(e,this,"_environmentMapManager"),this.resetDrawCommands())}},backFaceCulling:{get:function(){return this._backFaceCulling},set:function(e){e!==this._backFaceCulling&&(this._backFaceCullingDirty=!0),this._backFaceCulling=e}},scale:{get:function(){return this._scale},set:function(e){e!==this._scale&&(this._updateModelMatrix=!0),this._scale=e}},computedScale:{get:function(){return this._computedScale}},minimumPixelSize:{get:function(){return this._minimumPixelSize},set:function(e){e!==this._minimumPixelSize&&(this._updateModelMatrix=!0),this._minimumPixelSize=e}},maximumScale:{get:function(){return this._maximumScale},set:function(e){e!==this._maximumScale&&(this._updateModelMatrix=!0),this._maximumScale=e}},shadows:{get:function(){return this._shadows},set:function(e){e!==this._shadows&&(this._shadowsDirty=!0),this._shadows=e}},credit:{get:function(){return this._credit}},showCreditsOnScreen:{get:function(){return this._showCreditsOnScreen},set:function(e){this._showCreditsOnScreen!==e&&(this._showCreditsOnScreenDirty=!0),this._showCreditsOnScreen=e}},splitDirection:{get:function(){return this._splitDirection},set:function(e){this._splitDirection!==e&&this.resetDrawCommands(),this._splitDirection=e}},classificationType:{get:function(){return this._classificationType}},pickIds:{get:function(){return this._pickIds}},styleCommandsNeeded:{get:function(){return this._styleCommandsNeeded}}});co.prototype.getNode=function(e){return this._nodesByName[e]};co.prototype.setArticulationStage=function(e,t){this._sceneGraph.setArticulationStage(e,t)};co.prototype.applyArticulations=function(){this._sceneGraph.applyArticulations()};co.prototype.getExtension=function(e){return this._loader.components.extensions[e]};co.prototype.makeStyleDirty=function(){this._styleDirty=!0};co.prototype.resetDrawCommands=function(){this._drawCommandsBuilt=!1};var kWe=new F,VWe=new J,UWe=new F;co.prototype.update=function(e){let t=!1;try{t=zWe(this,e)}catch(n){if(!this._loader.incrementallyLoadTextures&&n.name==="TextureError")c7(this,n);else{let i=Zt.getError("model",this._resource,n);c7(this,i)}}if(HWe(this,e),GWe(this,e),WWe(this,e),!this._resourcesLoaded&&t){this._resourcesLoaded=!0;let n=this._loader.components;if(!u(n)){if(this._loader.isUnloaded())return;let r=Zt.getError("model",this._resource,new ce("Failed to load model."));c7(r),this._rejectLoad=this._rejectLoad&&this._rejectLoad(r)}let i=n.structuralMetadata;u(i)&&i.propertyTableCount>0&&FWe(this,i);let o=new nB({model:this,modelComponents:n});this._sceneGraph=o,this._gltfCredits=o.components.asset.credits}if(!(!this._resourcesLoaded||e.mode===ne.MORPHING)){if(jWe(this),qWe(this),YWe(this,e),XWe(this),KWe(this,e),ZWe(this,e),$We(this,e),QWe(this,e),JWe(this,e),e7e(this,e),t7e(this,e),this._defaultTexture=e.context.defaultTexture,n7e(this,e),i7e(this,e),o7e(this),r7e(this,e),l7e(this,e),!this._ready){e.afterRender.push(()=>{this._ready=!0,this._readyEvent.raiseEvent(this)});return}this._loader.incrementallyLoadTextures&&!this._texturesLoaded&&this._loader.texturesLoaded&&(this.resetDrawCommands(),this._texturesLoaded=!0,this._texturesReadyEvent.raiseEvent(this)),a7e(this),u7e(this,e),f7e(this),d7e(this,e)}};function zWe(e,t){return!e._resourcesLoaded||e._loader.incrementallyLoadTextures&&!e._texturesLoaded?(t.afterRender.push(()=>!0),e._loader.process(t)):!0}function HWe(e,t){u(e._customShader)&&e._customShader.update(t)}function GWe(e,t){let n=e._environmentMapManager,i=t.passes.pick||t.passes.pickVoxel;e._ready&&n.owner===e&&!i&&(n.position=e._boundingSphere.center,n.shouldUpdate=!u(e._imageBasedLighting.sphericalHarmonicCoefficients)||!u(e._imageBasedLighting.specularEnvironmentMaps),n.update(t),n.shouldRegenerateShaders&&e.resetDrawCommands())}function WWe(e,t){e._imageBasedLighting.update(t),e._imageBasedLighting.shouldRegenerateShaders&&e.resetDrawCommands()}function jWe(e){if(!e._featureTableIdDirty)return;e._featureTableIdDirty=!1;let t=e._sceneGraph.components,n=t.structuralMetadata;u(n)&&n.propertyTableCount>0&&(e.featureTableId=BWe(t,e),e._styleDirty=!0,e.resetDrawCommands())}function qWe(e){e._styleDirty&&(e.applyStyle(e._style),e._styleDirty=!1)}function YWe(e,t){let n=e._featureTables,i=n.length,o=!1;for(let r=0;r<i;r++)n[r].update(t),n[r].styleCommandsNeededDirty&&(o=!0);o&&xae(e)}function xae(e){let t=e.featureTables[e.featureTableId];e._styleCommandsNeeded=Qh.getStyleCommandsNeeded(t.featuresLength,t.batchTexture.translucentFeaturesLength)}function XWe(e){let t=e.pointCloudShading;t.attenuation!==e._attenuation&&(e.resetDrawCommands(),e._attenuation=t.attenuation),t.backFaceCulling!==e._pointCloudBackFaceCulling&&(e.resetDrawCommands(),e._pointCloudBackFaceCulling=t.backFaceCulling)}function KWe(e,t){e._silhouetteDirty&&(Cae(t)&&e.resetDrawCommands(),e._silhouetteDirty=!1)}function ZWe(e,t){let n=e.hasSkipLevelOfDetail(t);n!==e._skipLevelOfDetail&&(e.resetDrawCommands(),e._skipLevelOfDetail=n)}function $We(e,t){let n=0;e.isClippingEnabled()&&(e._clippingPlanes.owner===e&&e._clippingPlanes.update(t),n=e._clippingPlanes.clippingPlanesState),n!==e._clippingPlanesState&&(e.resetDrawCommands(),e._clippingPlanesState=n)}function QWe(e,t){let n=0;e.isClippingPolygonsEnabled()&&(e._clippingPolygons.owner===e&&(e._clippingPolygons.update(t),e._clippingPolygons.queueCommands(t)),n=e._clippingPolygons.clippingPolygonsState),n!==e._clippingPolygonsState&&(e.resetDrawCommands(),e._clippingPolygonsState=n)}function JWe(e,t){t.mode!==e._sceneMode&&(e._projectTo2D?e.resetDrawCommands():e._updateModelMatrix=!0,e._sceneMode=t.mode)}function e7e(e,t){let n=t.fog.enabled&&t.fog.renderable;n!==e._fogRenderable&&(e.resetDrawCommands(),e._fogRenderable=n)}function t7e(e,t){if(e.enableVerticalExaggeration){let n=t.verticalExaggeration!==1;e.hasVerticalExaggeration!==n&&(e.resetDrawCommands(),e._hasVerticalExaggeration=n)}else e.hasVerticalExaggeration&&(e.resetDrawCommands(),e._hasVerticalExaggeration=!1)}function n7e(e,t){e._drawCommandsBuilt||(e.destroyPipelineResources(),e._sceneGraph.buildDrawCommands(t),e._drawCommandsBuilt=!0)}function i7e(e,t){F.equals(e.modelMatrix,e._modelMatrix)||(e._updateModelMatrix=!0,e._modelMatrix=F.clone(e.modelMatrix,e._modelMatrix))}var Bg=new h,l7=new de;function o7e(e){if(!e._updateModelMatrix&&!e._heightDirty&&e._minimumPixelSize===0)return;u(e._removeUpdateHeightCallback)&&(e._removeUpdateHeightCallback(),e._removeUpdateHeightCallback=void 0);let t=e._scene;if(!u(t)||e.heightReference===Xe.NONE){e._clampedModelMatrix=void 0;return}let n=x(t.ellipsoid,ee.default),i=e.modelMatrix;Bg.x=i[12],Bg.y=i[13],Bg.z=i[14];let o=n.cartesianToCartographic(Bg);u(e._clampedModelMatrix)||(e._clampedModelMatrix=F.clone(i,new F)),e._removeUpdateHeightCallback=t.updateHeight(o,yae(e,n,o),e.heightReference);let r=t.getHeight(o,e.heightReference);if(u(r)){let s=yae(e,n,o);de.clone(o,l7),l7.height=r,s(l7)}e._heightDirty=!1,e._updateModelMatrix=!0}function r7e(e,t){if(!e._updateModelMatrix&&e._minimumPixelSize===0)return;let n=u(e._clampedModelMatrix)?e._clampedModelMatrix:e.modelMatrix;bae(e,n),s7e(e,n,t)}function bae(e,t){e._clampedScale=u(e._maximumScale)?Math.min(e._scale,e._maximumScale):e._scale,e._boundingSphere.center=h.multiplyByScalar(e._sceneGraph.boundingSphere.center,e._clampedScale,e._boundingSphere.center),e._boundingSphere.radius=e._initialRadius*e._clampedScale,e._boundingSphere=ae.transform(e._boundingSphere,t,e._boundingSphere)}function s7e(e,t,n){let i=e.scale;if(e.minimumPixelSize!==0&&!e._projectTo2D){let o=n.context,r=Math.max(o.drawingBufferWidth,o.drawingBufferHeight);F.getTranslation(t,Bg),e._sceneMode!==ne.SCENE3D&&Wi.computeActualEllipsoidPosition(n,Bg,Bg);let s=e._boundingSphere.radius,a=h7e(Bg,s,n),c=1/a;Math.min(c*(2*s),r)<e.minimumPixelSize&&(i=e.minimumPixelSize*a/(2*e._initialRadius))}e._computedScale=u(e.maximumScale)?Math.min(e.maximumScale,i):i}function a7e(e){if(!e._idDirty)return;e._idDirty=!1;let t=e._id,n=e._pickIds,i=n.length;for(let o=0;o<i;++o)n[o].object.id=t}var c7e=new J(1,0,0,0,0,1,0,-1,0);function l7e(e,t){let n=u(e._clampedModelMatrix)?e._clampedModelMatrix:e.modelMatrix,i=x(e.referenceMatrix,n),o=t.context,r=VWe,s=kWe;if(s=F.multiply(o.uniformState.view3D,i,s),r=F.getRotation(s,r),r=J.transpose(r,r),e._iblReferenceFrameMatrix=J.multiply(c7e,r,e._iblReferenceFrameMatrix),e.isClippingEnabled()){let a=UWe;a=F.multiply(o.uniformState.view3D,i,a),a=F.multiply(a,e._clippingPlanes.modelMatrix,a),e._clippingPlanesMatrix=F.inverseTranspose(a,e._clippingPlanesMatrix)}}function u7e(e,t){let n=e._sceneGraph;if(e._updateModelMatrix||e._minimumPixelSize!==0){let o=u(e._clampedModelMatrix)?e._clampedModelMatrix:e.modelMatrix;n.updateModelMatrix(o,t),e._updateModelMatrix=!1}e._backFaceCullingDirty&&(n.updateBackFaceCulling(e._backFaceCulling),e._backFaceCullingDirty=!1),e._shadowsDirty&&(n.updateShadows(e._shadows),e._shadowsDirty=!1),e._debugShowBoundingVolumeDirty&&(n.updateShowBoundingVolume(e._debugShowBoundingVolume),e._debugShowBoundingVolumeDirty=!1);let i=!1;u(e.classificationType)||(i=e._userAnimationDirty||e._activeAnimations.update(t)),n.update(t,i),e._userAnimationDirty=!1}function f7e(e){if(!e._showCreditsOnScreenDirty)return;e._showCreditsOnScreenDirty=!1,e._credits.length=0;let t=e._showCreditsOnScreen;if(u(e._credit)){let s=wt.clone(e._credit);s.showOnScreen=s.showOnScreen||t,e._credits.push(s)}let n=e._resourceCredits,i=n.length;for(let s=0;s<i;s++){let a=wt.clone(n[s]);a.showOnScreen=a.showOnScreen||t,e._credits.push(a)}let o=e._gltfCredits,r=o.length;for(let s=0;s<r;s++){let a=wt.clone(o[s]);a.showOnScreen=a.showOnScreen||t,e._credits.push(a)}}function d7e(e,t){let n=p7e(e,t),i=e.isInvisible(),o=e.hasSilhouette(t),r=e._show&&e._computedScale!==0&&n&&(!i||o),s=t.passes,a=s.render||s.pick&&e.allowPicking;r&&!e._ignoreCommands&&a&&(_7e(e,t),e._sceneGraph.pushDrawCommands(t))}var u7=new ae;function h7e(e,t,n){return u7.center=e,u7.radius=t,n.camera.getPixelSize(u7,n.context.drawingBufferWidth,n.context.drawingBufferHeight)}var sB=new h;function yae(e,t,n){return function(i){DC(e.heightReference)&&(i.height+=n.height),t.cartographicToCartesian(i,sB);let o=e._clampedModelMatrix;F.clone(e.modelMatrix,o),o[12]=sB.x,o[13]=sB.y,o[14]=sB.z,e._heightDirty=!0}}var m7e=new h;function p7e(e,t){let n=e.distanceDisplayCondition;if(!u(n))return!0;let i=n.near*n.near,o=n.far*n.far,r;if(t.mode===ne.SCENE2D){let a=(t.camera.frustum.right-t.camera.frustum.left)*.5;r=a*a}else{let s=F.getTranslation(e.modelMatrix,m7e);Wi.computeActualEllipsoidPosition(t,s,s),r=h.distanceSquared(s,t.camera.positionWC)}return r>=i&&r<=o}function _7e(e,t){let n=t.creditDisplay,i=e._credits,o=i.length;for(let r=0;r<o;r++)n.addCreditToNextFrame(i[r])}co.prototype.isTranslucent=function(){let e=this.color;return u(e)&&e.alpha>0&&e.alpha<1};co.prototype.isInvisible=function(){let e=this.color;return u(e)&&e.alpha===0};function Cae(e){return e.context.stencilBuffer}co.prototype.hasSilhouette=function(e){return Cae(e)&&this._silhouetteSize>0&&this._silhouetteColor.alpha>0&&!u(this._classificationType)};co.prototype.hasSkipLevelOfDetail=function(e){if(!Cr.is3DTiles(this.type))return!1;let t=e.context.stencilBuffer,n=this._content.tileset;return t&&n.isSkippingLevelOfDetail};co.prototype.isClippingEnabled=function(){let e=this._clippingPlanes;return u(e)&&e.enabled&&e.length!==0};co.prototype.pick=function(e,t,n,i,o){return Dw(this,e,t,n,i,o)};co.prototype.isClippingPolygonsEnabled=function(){let e=this._clippingPolygons;return u(e)&&e.enabled&&e.length!==0};co.prototype.isDestroyed=function(){return!1};co.prototype.destroy=function(){let e=this._loader;u(e)&&e.destroy();let t=this._featureTables;if(u(t)){let r=t.length;for(let s=0;s<r;s++)t[s].destroy()}this.destroyPipelineResources(),this.destroyModelResources(),u(this._removeUpdateHeightCallback)&&(this._removeUpdateHeightCallback(),this._removeUpdateHeightCallback=void 0),u(this._terrainProviderChangedCallback)&&(this._terrainProviderChangedCallback(),this._terrainProviderChangedCallback=void 0);let n=this._clippingPlanes;u(n)&&!n.isDestroyed()&&n.owner===this&&n.destroy(),this._clippingPlanes=void 0;let i=this._clippingPolygons;u(i)&&!i.isDestroyed()&&i.owner===this&&i.destroy(),this._clippingPolygons=void 0,this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=void 0;let o=this._environmentMapManager;!o.isDestroyed()&&o.owner===this&&o.destroy(),this._environmentMapManager=void 0,ue(this)};co.prototype.destroyPipelineResources=function(){let e=this._pipelineResources;for(let t=0;t<e.length;t++)e[t].destroy();this._pipelineResources.length=0,this._pickIds.length=0};co.prototype.destroyModelResources=function(){let e=this._modelResources;for(let t=0;t<e.length;t++)e[t].destroy();this._modelResources.length=0};co.fromGltfAsync=async function(e){e=x(e,x.EMPTY_OBJECT);let t=x(e.url,e.gltf),n={releaseGltfJson:e.releaseGltfJson,asynchronous:e.asynchronous,incrementallyLoadTextures:e.incrementallyLoadTextures,upAxis:e.upAxis,forwardAxis:e.forwardAxis,loadAttributesFor2D:e.projectTo2D,enablePick:e.enablePick,loadIndicesForWireframe:e.enableDebugWireframe,loadPrimitiveOutline:e.enableShowOutline,loadForClassification:u(e.classificationType)},i=x(e.basePath,""),o=De.createIfNeeded(i);u(t.asset)?(n.gltfJson=t,n.baseResource=o,n.gltfResource=o):t instanceof Uint8Array?(n.typedArray=t,n.baseResource=o,n.gltfResource=o):n.gltfResource=De.createIfNeeded(t);let r=new Dg(n),a=u(e.content)?Cr.TILE_GLTF:Cr.GLTF,c=n.gltfResource,l=Iw(r,a,e);l.resource=c,l.environmentMapOptions=e.environmentMapOptions;try{await r.load()}catch(g){throw r.destroy(),Zt.getError("model",c,g)}let f=e.gltfCallback;u(f)&&f(r.gltfJson);let d=new co(l),p=d._resource.credits;if(u(p)){let g=p.length;for(let m=0;m<g;m++)d._resourceCredits.push(wt.clone(p[m]))}return d};co.fromB3dm=async function(e){let t={b3dmResource:e.resource,arrayBuffer:e.arrayBuffer,byteOffset:e.byteOffset,releaseGltfJson:e.releaseGltfJson,asynchronous:e.asynchronous,incrementallyLoadTextures:e.incrementallyLoadTextures,upAxis:e.upAxis,forwardAxis:e.forwardAxis,loadAttributesFor2D:e.projectTo2D,enablePick:e.enablePick,loadIndicesForWireframe:e.enableDebugWireframe,loadPrimitiveOutline:e.enableShowOutline,loadForClassification:u(e.classificationType)},n=new d2(t);try{await n.load();let i=Iw(n,Cr.TILE_B3DM,e);return new co(i)}catch(i){throw n.destroy(),i}};co.fromPnts=async function(e){let t={arrayBuffer:e.arrayBuffer,byteOffset:e.byteOffset,loadAttributesFor2D:e.projectTo2D},n=new rB(t);try{await n.load();let i=Iw(n,Cr.TILE_PNTS,e);return new co(i)}catch(i){throw n.destroy(),i}};co.fromI3dm=async function(e){let t={i3dmResource:e.resource,arrayBuffer:e.arrayBuffer,byteOffset:e.byteOffset,releaseGltfJson:e.releaseGltfJson,asynchronous:e.asynchronous,incrementallyLoadTextures:e.incrementallyLoadTextures,upAxis:e.upAxis,forwardAxis:e.forwardAxis,loadAttributesFor2D:e.projectTo2D,enablePick:e.enablePick,loadIndicesForWireframe:e.enableDebugWireframe,loadPrimitiveOutline:e.enableShowOutline},n=new x2(t);try{await n.load();let i=Iw(n,Cr.TILE_I3DM,e);return new co(i)}catch(i){throw n.destroy(),i}};co.fromGeoJson=async function(e){let t={geoJson:e.geoJson},n=new m2(t),i=Iw(n,Cr.TILE_GEOJSON,e);return new co(i)};var g7e=new G;co.prototype.applyColorAndShow=function(e){let t=G.clone(this._color,g7e),n=u(e)&&u(e.color),i=u(e)&&u(e.show);this._color=n?e.color.evaluateColor(void 0,this._color):G.clone(G.WHITE,this._color),this._show=i?e.show.evaluate(void 0):!0,f7(t,this._color)&&this.resetDrawCommands()};co.prototype.applyStyle=function(e){let t=this.type===Cr.TILE_PNTS,n=u(this.featureTableId)&&this.featureTables[this.featureTableId].featuresLength>0,i=u(this.structuralMetadata)?this.structuralMetadata.propertyAttributes:void 0,o=u(i)&&u(i[0]);if(t&&(!n||o)){this.resetDrawCommands();return}n?(this.featureTables[this.featureTableId].applyStyle(e),xae(this,e)):(this.applyColorAndShow(e),this._styleCommandsNeeded=void 0)};function Iw(e,t,n){return{loader:e,type:t,resource:n.resource,show:n.show,modelMatrix:n.modelMatrix,scale:n.scale,enableVerticalExaggeration:n.enableVerticalExaggeration,minimumPixelSize:n.minimumPixelSize,maximumScale:n.maximumScale,id:n.id,allowPicking:n.allowPicking,clampAnimations:n.clampAnimations,shadows:n.shadows,debugShowBoundingVolume:n.debugShowBoundingVolume,enableDebugWireframe:n.enableDebugWireframe,debugWireframe:n.debugWireframe,cull:n.cull,opaquePass:n.opaquePass,customShader:n.customShader,content:n.content,heightReference:n.heightReference,scene:n.scene,distanceDisplayCondition:n.distanceDisplayCondition,color:n.color,colorBlendAmount:n.colorBlendAmount,colorBlendMode:n.colorBlendMode,silhouetteColor:n.silhouetteColor,silhouetteSize:n.silhouetteSize,enableShowOutline:n.enableShowOutline,showOutline:n.showOutline,outlineColor:n.outlineColor,clippingPlanes:n.clippingPlanes,clippingPolygons:n.clippingPolygons,lightColor:n.lightColor,imageBasedLighting:n.imageBasedLighting,backFaceCulling:n.backFaceCulling,credit:n.credit,showCreditsOnScreen:n.showCreditsOnScreen,splitDirection:n.splitDirection,projectTo2D:n.projectTo2D,enablePick:n.enablePick,featureIdLabel:n.featureIdLabel,instanceFeatureIdLabel:n.instanceFeatureIdLabel,pointCloudShading:n.pointCloudShading,classificationType:n.classificationType,pickObject:n.pickObject}}var Jh=co;function cs(e,t,n){this._tileset=e,this._tile=t,this._resource=n,this._model=void 0,this._metadata=void 0,this._group=void 0,this._ready=!1}Object.defineProperties(cs.prototype,{featuresLength:{get:function(){let e=this._model,t=e.featureTables,n=e.featureTableId;return u(t)&&u(t[n])?t[n].featuresLength:0}},pointsLength:{get:function(){return this._model.statistics.pointsLength}},trianglesLength:{get:function(){return this._model.statistics.trianglesLength}},geometryByteLength:{get:function(){return this._model.statistics.geometryByteLength}},texturesByteLength:{get:function(){return this._model.statistics.texturesByteLength}},batchTableByteLength:{get:function(){let e=this._model.statistics;return e.propertyTablesByteLength+e.batchTexturesByteLength}},innerContents:{get:function(){}},ready:{get:function(){return this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){let e=this._model,t=e.featureTables,n=e.featureTableId;if(u(t)&&u(t[n]))return t[n]}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e}},group:{get:function(){return this._group},set:function(e){this._group=e}}});cs.prototype.getExtension=function(e){return this._model.getExtension(e)};cs.prototype.getFeature=function(e){let t=this._model,n=t.featureTableId;return t.featureTables[n].getFeature(e)};cs.prototype.hasProperty=function(e,t){let n=this._model,i=n.featureTableId;return u(i)?n.featureTables[i].hasProperty(e,t):!1};cs.prototype.applyDebugSettings=function(e,t){t=e?t:G.WHITE,this.featuresLength===0?this._model.color=t:u(this.batchTable)&&this.batchTable.setAllColor(t)};cs.prototype.applyStyle=function(e){this._model.style=e};cs.prototype.update=function(e,t){let n=this._model,i=this._tile;n.colorBlendAmount=e.colorBlendAmount,n.colorBlendMode=e.colorBlendMode,n.modelMatrix=i.computedTransform,n.customShader=e.customShader,n.featureIdLabel=e.featureIdLabel,n.instanceFeatureIdLabel=e.instanceFeatureIdLabel,n.lightColor=e.lightColor,n.imageBasedLighting=e.imageBasedLighting,n.backFaceCulling=e.backFaceCulling,n.shadows=e.shadows,n.showCreditsOnScreen=e.showCreditsOnScreen,n.splitDirection=e.splitDirection,n.debugWireframe=e.debugWireframe,n.showOutline=e.showOutline,n.outlineColor=e.outlineColor,n.pointCloudShading=e.pointCloudShading;let o=e.clippingPlanes;n.referenceMatrix=e.clippingPlanesOriginMatrix,u(o)&&i.clippingPlanesDirty&&(n._clippingPlanes=o.enabled&&i._isClipped?o:void 0);let r=e.environmentMapManager;n.environmentMapManager!==o&&(n._environmentMapManager=r),u(o)&&u(n._clippingPlanes)&&n._clippingPlanes!==o&&(n._clippingPlanes=o,n._clippingPlanesState=0);let s=e.clippingPolygons;u(s)&&i.clippingPolygonsDirty&&(n._clippingPolygons=s.enabled&&i._isClippedByPolygon?s:void 0),u(s)&&u(n._clippingPolygons)&&n._clippingPolygons!==s&&(n._clippingPolygons=s,n._clippingPolygonsState=0),n.update(t),!this._ready&&n.ready&&(n.activeAnimations.addAll({loop:cu.REPEAT}),this._ready=!0)};cs.prototype.isDestroyed=function(){return!1};cs.prototype.destroy=function(){return this._model=this._model&&this._model.destroy(),ue(this)};cs.fromGltf=async function(e,t,n,i){let o=new cs(e,t,n),s=Pw(e,t,o,{gltf:i,basePath:n}),a=e.vectorClassificationOnly?void 0:e.classificationType;s.classificationType=a;let c=await Jh.fromGltfAsync(s);return o._model=c,o};cs.fromB3dm=async function(e,t,n,i,o){let r=new cs(e,t,n),a=Pw(e,t,r,{arrayBuffer:i,byteOffset:o,resource:n}),c=e.vectorClassificationOnly?void 0:e.classificationType;a.classificationType=c;let l=await Jh.fromB3dm(a);return r._model=l,r};cs.fromI3dm=async function(e,t,n,i,o){let r=new cs(e,t,n),a=Pw(e,t,r,{arrayBuffer:i,byteOffset:o,resource:n}),c=await Jh.fromI3dm(a);return r._model=c,r};cs.fromPnts=async function(e,t,n,i,o){let r=new cs(e,t,n),a=Pw(e,t,r,{arrayBuffer:i,byteOffset:o,resource:n}),c=await Jh.fromPnts(a);return r._model=c,r};cs.fromGeoJson=async function(e,t,n,i){let o=new cs(e,t,n),s=Pw(e,t,o,{geoJson:i,resource:n}),a=await Jh.fromGeoJson(s);return o._model=a,o};cs.prototype.pick=function(e,t,n){if(!u(this._model)||!this._ready)return;let i=t.verticalExaggeration,o=t.verticalExaggerationRelativeHeight;return this._model.pick(e,t,i,o,ee.WGS84,n)};function Pw(e,t,n,i){let o={cull:!1,releaseGltfJson:!0,opaquePass:we.CESIUM_3D_TILE,modelMatrix:t.computedTransform,upAxis:e._modelUpAxis,forwardAxis:e._modelForwardAxis,incrementallyLoadTextures:!1,customShader:e.customShader,content:n,colorBlendMode:e.colorBlendMode,colorBlendAmount:e.colorBlendAmount,lightColor:e.lightColor,imageBasedLighting:e.imageBasedLighting,featureIdLabel:e.featureIdLabel,instanceFeatureIdLabel:e.instanceFeatureIdLabel,pointCloudShading:e.pointCloudShading,clippingPlanes:e.clippingPlanes,backFaceCulling:e.backFaceCulling,shadows:e.shadows,showCreditsOnScreen:e.showCreditsOnScreen,splitDirection:e.splitDirection,enableDebugWireframe:e._enableDebugWireframe,debugWireframe:e.debugWireframe,projectTo2D:e._projectTo2D,enablePick:e._enablePick,enableShowOutline:e._enableShowOutline,showOutline:e.showOutline,outlineColor:e.outlineColor};return bt(i,o)}var Rp=cs;function gf(e,t,n){this._tileset=e,this._tile=t,this._resource=n,this.featurePropertiesDirty=!1,this._metadata=void 0,this._group=void 0,this._ready=!1}Object.defineProperties(gf.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},ready:{get:function(){return this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e}},group:{get:function(){return this._group},set:function(e){this._group=e}}});gf.fromJson=function(e,t,n,i){let o=new gf(e,t,n);return o._tileset.loadTileset(o._resource,i,o._tile),o._ready=!0,o};gf.prototype.hasProperty=function(e,t){return!1};gf.prototype.getFeature=function(e){};gf.prototype.applyDebugSettings=function(e,t){};gf.prototype.applyStyle=function(e){};gf.prototype.update=function(e,t){};gf.prototype.pick=function(e,t,n){};gf.prototype.isDestroyed=function(){return!1};gf.prototype.destroy=function(){return ue(this)};var aB=gf;var cB=`uniform sampler2D u_atlas;

#ifdef VECTOR_TILE
uniform vec4 u_highlightColor;
#endif

in vec2 v_textureCoordinates;
in vec4 v_pickColor;
in vec4 v_color;
in float v_splitDirection;

#ifdef SDF
in vec4 v_outlineColor;
in float v_outlineWidth;
#endif

#ifdef FRAGMENT_DEPTH_CHECK
in vec4 v_textureCoordinateBounds;                  // the min and max x and y values for the texture coordinates
in vec4 v_originTextureCoordinateAndTranslate;      // texture coordinate at the origin, billboard translate (used for label glyphs)
in vec4 v_compressed;                               // x: eyeDepth, y: applyTranslate & enableDepthCheck, z: dimensions, w: imageSize
in mat2 v_rotationMatrix;

const float SHIFT_LEFT12 = 4096.0;
const float SHIFT_LEFT1 = 2.0;

const float SHIFT_RIGHT12 = 1.0 / 4096.0;
const float SHIFT_RIGHT1 = 1.0 / 2.0;

float getGlobeDepth(vec2 adjustedST, vec2 depthLookupST, bool applyTranslate, vec2 dimensions, vec2 imageSize)
{
    vec2 lookupVector = imageSize * (depthLookupST - adjustedST);
    lookupVector = v_rotationMatrix * lookupVector;
    vec2 labelOffset = (dimensions - imageSize) * (depthLookupST - vec2(0.0, v_originTextureCoordinateAndTranslate.y)); // aligns label glyph with bounding rectangle.  Will be zero for billboards because dimensions and imageSize will be equal

    vec2 translation = v_originTextureCoordinateAndTranslate.zw;

    if (applyTranslate)
    {
        // this is only needed for labels where the horizontal origin is not LEFT
        // it moves the label back to where the "origin" should be since all label glyphs are set to HorizontalOrigin.LEFT
        translation += (dimensions * v_originTextureCoordinateAndTranslate.xy * vec2(1.0, 0.0));
    }

    vec2 st = ((lookupVector - translation + labelOffset) + gl_FragCoord.xy) / czm_viewport.zw;
    float logDepthOrDepth = czm_unpackDepth(texture(czm_globeDepthTexture, st));

    if (logDepthOrDepth == 0.0)
    {
        return 0.0; // not on the globe
    }

    vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);
    return eyeCoordinate.z / eyeCoordinate.w;
}
#endif


#ifdef SDF

// Get the distance from the edge of a glyph at a given position sampling an SDF texture.
float getDistance(vec2 position)
{
    return texture(u_atlas, position).r;
}

// Samples the sdf texture at the given position and produces a color based on the fill color and the outline.
vec4 getSDFColor(vec2 position, float outlineWidth, vec4 outlineColor, float smoothing)
{
    float distance = getDistance(position);

    if (outlineWidth > 0.0)
    {
        // Don't get the outline edge exceed the SDF_EDGE
        float outlineEdge = clamp(SDF_EDGE - outlineWidth, 0.0, SDF_EDGE);
        float outlineFactor = smoothstep(SDF_EDGE - smoothing, SDF_EDGE + smoothing, distance);
        vec4 sdfColor = mix(outlineColor, v_color, outlineFactor);
        float alpha = smoothstep(outlineEdge - smoothing, outlineEdge + smoothing, distance);
        return vec4(sdfColor.rgb, sdfColor.a * alpha);
    }
    else
    {
        float alpha = smoothstep(SDF_EDGE - smoothing, SDF_EDGE + smoothing, distance);
        return vec4(v_color.rgb, v_color.a * alpha);
    }
}
#endif

void main()
{
    if (v_splitDirection < 0.0 && gl_FragCoord.x > czm_splitPosition) discard;
    if (v_splitDirection > 0.0 && gl_FragCoord.x < czm_splitPosition) discard;
    
    vec4 color = texture(u_atlas, v_textureCoordinates);

#ifdef SDF
    float outlineWidth = v_outlineWidth;
    vec4 outlineColor = v_outlineColor;

    // Get the current distance
    float distance = getDistance(v_textureCoordinates);

#if (__VERSION__ == 300 || defined(GL_OES_standard_derivatives))
    float smoothing = fwidth(distance);
    // Get an offset that is approximately half the distance to the neighbor pixels
    // 0.354 is approximately half of 1/sqrt(2)
    vec2 sampleOffset = 0.354 * vec2(dFdx(v_textureCoordinates) + dFdy(v_textureCoordinates));

    // Sample the center point
    vec4 center = getSDFColor(v_textureCoordinates, outlineWidth, outlineColor, smoothing);

    // Sample the 4 neighbors
    vec4 color1 = getSDFColor(v_textureCoordinates + vec2(sampleOffset.x, sampleOffset.y), outlineWidth, outlineColor, smoothing);
    vec4 color2 = getSDFColor(v_textureCoordinates + vec2(-sampleOffset.x, sampleOffset.y), outlineWidth, outlineColor, smoothing);
    vec4 color3 = getSDFColor(v_textureCoordinates + vec2(-sampleOffset.x, -sampleOffset.y), outlineWidth, outlineColor, smoothing);
    vec4 color4 = getSDFColor(v_textureCoordinates + vec2(sampleOffset.x, -sampleOffset.y), outlineWidth, outlineColor, smoothing);

    // Equally weight the center sample and the 4 neighboring samples
    color = (center + color1 + color2 + color3 + color4)/5.0;
#else
    // If no derivatives available (IE 10?), just do a single sample
    float smoothing = 1.0/32.0;
    color = getSDFColor(v_textureCoordinates, outlineWidth, outlineColor, smoothing);
#endif

    color = czm_gammaCorrect(color);
#else
    color = czm_gammaCorrect(color);
    color *= czm_gammaCorrect(v_color);
#endif

// Fully transparent parts of the billboard are not pickable.
#if !defined(OPAQUE) && !defined(TRANSLUCENT)
    if (color.a < 0.005)   // matches 0/255 and 1/255
    {
        discard;
    }
#else
// The billboard is rendered twice. The opaque pass discards translucent fragments
// and the translucent pass discards opaque fragments.
#ifdef OPAQUE
    if (color.a < 0.995)   // matches < 254/255
    {
        discard;
    }
#else
    if (color.a >= 0.995)  // matches 254/255 and 255/255
    {
        discard;
    }
#endif
#endif

#ifdef VECTOR_TILE
    color *= u_highlightColor;
#endif
    out_FragColor = color;

#ifdef LOG_DEPTH
    czm_writeLogDepth();
#endif

#ifdef FRAGMENT_DEPTH_CHECK
    float temp = v_compressed.y;

    temp = temp * SHIFT_RIGHT1;

    float temp2 = (temp - floor(temp)) * SHIFT_LEFT1;
    bool enableDepthTest = temp2 != 0.0;
    bool applyTranslate = floor(temp) != 0.0;

    if (enableDepthTest) {
        temp = v_compressed.z;
        temp = temp * SHIFT_RIGHT12;

        vec2 dimensions;
        dimensions.y = (temp - floor(temp)) * SHIFT_LEFT12;
        dimensions.x = floor(temp);

        temp = v_compressed.w;
        temp = temp * SHIFT_RIGHT12;

        vec2 imageSize;
        imageSize.y = (temp - floor(temp)) * SHIFT_LEFT12;
        imageSize.x = floor(temp);

        vec2 adjustedST = v_textureCoordinates - v_textureCoordinateBounds.xy;
        adjustedST = adjustedST / vec2(v_textureCoordinateBounds.z - v_textureCoordinateBounds.x, v_textureCoordinateBounds.w - v_textureCoordinateBounds.y);

        float epsilonEyeDepth = v_compressed.x + czm_epsilon1;
        float globeDepth1 = getGlobeDepth(adjustedST, v_originTextureCoordinateAndTranslate.xy, applyTranslate, dimensions, imageSize);

        // negative values go into the screen
        if (globeDepth1 != 0.0 && globeDepth1 > epsilonEyeDepth)
        {
            float globeDepth2 = getGlobeDepth(adjustedST, vec2(0.0, 1.0), applyTranslate, dimensions, imageSize); // top left corner
            if (globeDepth2 != 0.0 && globeDepth2 > epsilonEyeDepth)
            {
                float globeDepth3 = getGlobeDepth(adjustedST, vec2(1.0, 1.0), applyTranslate, dimensions, imageSize); // top right corner
                if (globeDepth3 != 0.0 && globeDepth3 > epsilonEyeDepth)
                {
                    discard;
                }
            }
        }
    }
#endif

}
`;var lB=`#ifdef INSTANCED
in vec2 direction;
#endif
in vec4 positionHighAndScale;
in vec4 positionLowAndRotation;
in vec4 compressedAttribute0;                       // pixel offset, translate, horizontal origin, vertical origin, show, direction, texture coordinates (texture offset)
in vec4 compressedAttribute1;                       // aligned axis, translucency by distance, image width
in vec4 compressedAttribute2;                       // label horizontal origin, image height, color, pick color, size in meters, valid aligned axis, 13 bits free
in vec4 eyeOffset;                                  // eye offset in meters, 4 bytes free (texture range)
in vec4 scaleByDistance;                            // near, nearScale, far, farScale
in vec4 pixelOffsetScaleByDistance;                 // near, nearScale, far, farScale
in vec4 compressedAttribute3;                       // distance display condition near, far, disableDepthTestDistance, dimensions
in vec2 sdf;                                        // sdf outline color (rgb) and width (w)
in float splitDirection;                            // splitDirection
#if defined(VERTEX_DEPTH_CHECK) || defined(FRAGMENT_DEPTH_CHECK)
in vec4 textureCoordinateBoundsOrLabelTranslate;    // the min and max x and y values for the texture coordinates
#endif
#ifdef VECTOR_TILE
in float a_batchId;
#endif

out vec2 v_textureCoordinates;
#ifdef FRAGMENT_DEPTH_CHECK
out vec4 v_textureCoordinateBounds;
out vec4 v_originTextureCoordinateAndTranslate;
out vec4 v_compressed;                                 // x: eyeDepth, y: applyTranslate & enableDepthCheck, z: dimensions, w: imageSize
out mat2 v_rotationMatrix;
#endif

out vec4 v_pickColor;
out vec4 v_color;
out float v_splitDirection;
#ifdef SDF
out vec4 v_outlineColor;
out float v_outlineWidth;
#endif

const float UPPER_BOUND = 32768.0;

const float SHIFT_LEFT16 = 65536.0;
const float SHIFT_LEFT12 = 4096.0;
const float SHIFT_LEFT8 = 256.0;
const float SHIFT_LEFT7 = 128.0;
const float SHIFT_LEFT5 = 32.0;
const float SHIFT_LEFT3 = 8.0;
const float SHIFT_LEFT2 = 4.0;
const float SHIFT_LEFT1 = 2.0;

const float SHIFT_RIGHT12 = 1.0 / 4096.0;
const float SHIFT_RIGHT8 = 1.0 / 256.0;
const float SHIFT_RIGHT7 = 1.0 / 128.0;
const float SHIFT_RIGHT5 = 1.0 / 32.0;
const float SHIFT_RIGHT3 = 1.0 / 8.0;
const float SHIFT_RIGHT2 = 1.0 / 4.0;
const float SHIFT_RIGHT1 = 1.0 / 2.0;

vec4 addScreenSpaceOffset(vec4 positionEC, vec2 imageSize, float scale, vec2 direction, vec2 origin, vec2 translate, vec2 pixelOffset, vec3 alignedAxis, bool validAlignedAxis, float rotation, bool sizeInMeters, out mat2 rotationMatrix, out float mpp)
{
    // Note the halfSize cannot be computed in JavaScript because it is sent via
    // compressed vertex attributes that coerce it to an integer.
    vec2 halfSize = imageSize * scale * 0.5;
    halfSize *= ((direction * 2.0) - 1.0);

    vec2 originTranslate = origin * abs(halfSize);

#if defined(ROTATION) || defined(ALIGNED_AXIS)
    if (validAlignedAxis || rotation != 0.0)
    {
        float angle = rotation;
        if (validAlignedAxis)
        {
            vec4 projectedAlignedAxis = czm_modelView3D * vec4(alignedAxis, 0.0);
            angle += sign(-projectedAlignedAxis.x) * acos(sign(projectedAlignedAxis.y) * (projectedAlignedAxis.y * projectedAlignedAxis.y) /
                    (projectedAlignedAxis.x * projectedAlignedAxis.x + projectedAlignedAxis.y * projectedAlignedAxis.y));
        }

        float cosTheta = cos(angle);
        float sinTheta = sin(angle);
        rotationMatrix = mat2(cosTheta, sinTheta, -sinTheta, cosTheta);
        halfSize = rotationMatrix * halfSize;
    }
    else
    {
        rotationMatrix = mat2(1.0, 0.0, 0.0, 1.0);
    }
#endif

    mpp = czm_metersPerPixel(positionEC);
    positionEC.xy += (originTranslate + halfSize) * czm_branchFreeTernary(sizeInMeters, 1.0, mpp);
    positionEC.xy += (translate + pixelOffset) * mpp;

    return positionEC;
}

#ifdef VERTEX_DEPTH_CHECK
float getGlobeDepth(vec4 positionEC)
{
    vec4 posWC = czm_eyeToWindowCoordinates(positionEC);

    float globeDepth = czm_unpackDepth(texture(czm_globeDepthTexture, posWC.xy / czm_viewport.zw));

    if (globeDepth == 0.0)
    {
        return 0.0; // not on the globe
    }

    vec4 eyeCoordinate = czm_windowToEyeCoordinates(posWC.xy, globeDepth);
    return eyeCoordinate.z / eyeCoordinate.w;
}
#endif
void main()
{
    // Modifying this shader may also require modifications to Billboard._computeScreenSpacePosition

    // unpack attributes
    vec3 positionHigh = positionHighAndScale.xyz;
    vec3 positionLow = positionLowAndRotation.xyz;
    float scale = positionHighAndScale.w;

#if defined(ROTATION) || defined(ALIGNED_AXIS)
    float rotation = positionLowAndRotation.w;
#else
    float rotation = 0.0;
#endif

    float compressed = compressedAttribute0.x;

    vec2 pixelOffset;
    pixelOffset.x = floor(compressed * SHIFT_RIGHT7);
    compressed -= pixelOffset.x * SHIFT_LEFT7;
    pixelOffset.x -= UPPER_BOUND;

    vec2 origin;
    origin.x = floor(compressed * SHIFT_RIGHT5);
    compressed -= origin.x * SHIFT_LEFT5;

    origin.y = floor(compressed * SHIFT_RIGHT3);
    compressed -= origin.y * SHIFT_LEFT3;

#ifdef FRAGMENT_DEPTH_CHECK
    vec2 depthOrigin = origin.xy;
#endif
    origin -= vec2(1.0);

    float show = floor(compressed * SHIFT_RIGHT2);
    compressed -= show * SHIFT_LEFT2;

#ifdef INSTANCED
    vec2 textureCoordinatesBottomLeft = czm_decompressTextureCoordinates(compressedAttribute0.w);
    vec2 textureCoordinatesRange = czm_decompressTextureCoordinates(eyeOffset.w);
    vec2 textureCoordinates = textureCoordinatesBottomLeft + direction * textureCoordinatesRange;
#else
    vec2 direction;
    direction.x = floor(compressed * SHIFT_RIGHT1);
    direction.y = compressed - direction.x * SHIFT_LEFT1;

    vec2 textureCoordinates = czm_decompressTextureCoordinates(compressedAttribute0.w);
#endif

    float temp = compressedAttribute0.y  * SHIFT_RIGHT8;
    pixelOffset.y = -(floor(temp) - UPPER_BOUND);

    vec2 translate;
    translate.y = (temp - floor(temp)) * SHIFT_LEFT16;

    temp = compressedAttribute0.z * SHIFT_RIGHT8;
    translate.x = floor(temp) - UPPER_BOUND;

    translate.y += (temp - floor(temp)) * SHIFT_LEFT8;
    translate.y -= UPPER_BOUND;

    temp = compressedAttribute1.x * SHIFT_RIGHT8;
    float temp2 = floor(compressedAttribute2.w * SHIFT_RIGHT2);

    vec2 imageSize = vec2(floor(temp), temp2);

#ifdef FRAGMENT_DEPTH_CHECK
    float labelHorizontalOrigin = floor(compressedAttribute2.w - (temp2 * SHIFT_LEFT2));
    float applyTranslate = 0.0;
    if (labelHorizontalOrigin != 0.0) // is a billboard, so set apply translate to false
    {
        applyTranslate = 1.0;
        labelHorizontalOrigin -= 2.0;
        depthOrigin.x = labelHorizontalOrigin + 1.0;
    }

    depthOrigin = vec2(1.0) - (depthOrigin * 0.5);
#endif

#ifdef EYE_DISTANCE_TRANSLUCENCY
    vec4 translucencyByDistance;
    translucencyByDistance.x = compressedAttribute1.z;
    translucencyByDistance.z = compressedAttribute1.w;

    translucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;

    temp = compressedAttribute1.y * SHIFT_RIGHT8;
    translucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;
#endif

#if defined(VERTEX_DEPTH_CHECK) || defined(FRAGMENT_DEPTH_CHECK)
    temp = compressedAttribute3.w;
    temp = temp * SHIFT_RIGHT12;

    vec2 dimensions;
    dimensions.y = (temp - floor(temp)) * SHIFT_LEFT12;
    dimensions.x = floor(temp);
#endif

#ifdef ALIGNED_AXIS
    vec3 alignedAxis = czm_octDecode(floor(compressedAttribute1.y * SHIFT_RIGHT8));
    temp = compressedAttribute2.z * SHIFT_RIGHT5;
    bool validAlignedAxis = (temp - floor(temp)) * SHIFT_LEFT1 > 0.0;
#else
    vec3 alignedAxis = vec3(0.0);
    bool validAlignedAxis = false;
#endif

    vec4 pickColor;
    vec4 color;

    temp = compressedAttribute2.y;
    temp = temp * SHIFT_RIGHT8;
    pickColor.b = (temp - floor(temp)) * SHIFT_LEFT8;
    temp = floor(temp) * SHIFT_RIGHT8;
    pickColor.g = (temp - floor(temp)) * SHIFT_LEFT8;
    pickColor.r = floor(temp);

    temp = compressedAttribute2.x;
    temp = temp * SHIFT_RIGHT8;
    color.b = (temp - floor(temp)) * SHIFT_LEFT8;
    temp = floor(temp) * SHIFT_RIGHT8;
    color.g = (temp - floor(temp)) * SHIFT_LEFT8;
    color.r = floor(temp);

    temp = compressedAttribute2.z * SHIFT_RIGHT8;
    bool sizeInMeters = floor((temp - floor(temp)) * SHIFT_LEFT7) > 0.0;
    temp = floor(temp) * SHIFT_RIGHT8;

    pickColor.a = (temp - floor(temp)) * SHIFT_LEFT8;
    pickColor /= 255.0;

    color.a = floor(temp);
    color /= 255.0;

    ///////////////////////////////////////////////////////////////////////////

    vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);
    vec4 positionEC = czm_modelViewRelativeToEye * p;

#if defined(FRAGMENT_DEPTH_CHECK) || defined(VERTEX_DEPTH_CHECK)
    float eyeDepth = positionEC.z;
#endif

    positionEC = czm_eyeOffset(positionEC, eyeOffset.xyz);
    positionEC.xyz *= show;

    ///////////////////////////////////////////////////////////////////////////

#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(EYE_DISTANCE_PIXEL_OFFSET) || defined(DISTANCE_DISPLAY_CONDITION) || defined(DISABLE_DEPTH_DISTANCE)
    float lengthSq;
    if (czm_sceneMode == czm_sceneMode2D)
    {
        // 2D camera distance is a special case
        // treat all billboards as flattened to the z=0.0 plane
        lengthSq = czm_eyeHeight2D.y;
    }
    else
    {
        lengthSq = dot(positionEC.xyz, positionEC.xyz);
    }
#endif

#ifdef EYE_DISTANCE_SCALING
    float distanceScale = czm_nearFarScalar(scaleByDistance, lengthSq);
    scale *= distanceScale;
    translate *= distanceScale;
    // push vertex behind near plane for clipping
    if (scale == 0.0)
    {
        positionEC.xyz = vec3(0.0);
    }
#endif

    float translucency = 1.0;
#ifdef EYE_DISTANCE_TRANSLUCENCY
    translucency = czm_nearFarScalar(translucencyByDistance, lengthSq);
    // push vertex behind near plane for clipping
    if (translucency == 0.0)
    {
        positionEC.xyz = vec3(0.0);
    }
#endif

#ifdef EYE_DISTANCE_PIXEL_OFFSET
    float pixelOffsetScale = czm_nearFarScalar(pixelOffsetScaleByDistance, lengthSq);
    pixelOffset *= pixelOffsetScale;
#endif

#ifdef DISTANCE_DISPLAY_CONDITION
    float nearSq = compressedAttribute3.x;
    float farSq = compressedAttribute3.y;
    if (lengthSq < nearSq || lengthSq > farSq)
    {
        positionEC.xyz = vec3(0.0);
    }
#endif

    mat2 rotationMatrix;
    float mpp;

#ifdef DISABLE_DEPTH_DISTANCE
    float disableDepthTestDistance = compressedAttribute3.z;
#endif

#ifdef VERTEX_DEPTH_CHECK
if (lengthSq < disableDepthTestDistance) {
    float depthsilon = 10.0;

    vec2 labelTranslate = textureCoordinateBoundsOrLabelTranslate.xy;
    vec4 pEC1 = addScreenSpaceOffset(positionEC, dimensions, scale, vec2(0.0), origin, labelTranslate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);
    float globeDepth1 = getGlobeDepth(pEC1);

    if (globeDepth1 != 0.0 && pEC1.z + depthsilon < globeDepth1)
    {
        vec4 pEC2 = addScreenSpaceOffset(positionEC, dimensions, scale, vec2(0.0, 1.0), origin, labelTranslate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);
        float globeDepth2 = getGlobeDepth(pEC2);

        if (globeDepth2 != 0.0 && pEC2.z + depthsilon < globeDepth2)
        {
            vec4 pEC3 = addScreenSpaceOffset(positionEC, dimensions, scale, vec2(1.0), origin, labelTranslate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);
            float globeDepth3 = getGlobeDepth(pEC3);
            if (globeDepth3 != 0.0 && pEC3.z + depthsilon < globeDepth3)
            {
                positionEC.xyz = vec3(0.0);
            }
        }
    }
}
#endif

    positionEC = addScreenSpaceOffset(positionEC, imageSize, scale, direction, origin, translate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);
    gl_Position = czm_projection * positionEC;
    v_textureCoordinates = textureCoordinates;

#ifdef LOG_DEPTH
    czm_vertexLogDepth();
#endif

#ifdef DISABLE_DEPTH_DISTANCE
    if (disableDepthTestDistance == 0.0 && czm_minimumDisableDepthTestDistance != 0.0)
    {
        disableDepthTestDistance = czm_minimumDisableDepthTestDistance;
    }

    if (disableDepthTestDistance != 0.0)
    {
        // Don't try to "multiply both sides" by w.  Greater/less-than comparisons won't work for negative values of w.
        float zclip = gl_Position.z / gl_Position.w;
        bool clipped = (zclip < -1.0 || zclip > 1.0);
        if (!clipped && (disableDepthTestDistance < 0.0 || (lengthSq > 0.0 && lengthSq < disableDepthTestDistance)))
        {
            // Position z on the near plane.
            gl_Position.z = -gl_Position.w;
#ifdef LOG_DEPTH
            v_depthFromNearPlusOne = 1.0;
#endif
        }
    }
#endif

#ifdef FRAGMENT_DEPTH_CHECK
    if (sizeInMeters) {
        translate /= mpp;
        dimensions /= mpp;
        imageSize /= mpp;
    }

#if defined(ROTATION) || defined(ALIGNED_AXIS)
    v_rotationMatrix = rotationMatrix;
#else
    v_rotationMatrix = mat2(1.0, 0.0, 0.0, 1.0);
#endif

    float enableDepthCheck = 0.0;
    if (lengthSq < disableDepthTestDistance)
    {
        enableDepthCheck = 1.0;
    }

    float dw = floor(clamp(dimensions.x, 0.0, SHIFT_LEFT12));
    float dh = floor(clamp(dimensions.y, 0.0, SHIFT_LEFT12));

    float iw = floor(clamp(imageSize.x, 0.0, SHIFT_LEFT12));
    float ih = floor(clamp(imageSize.y, 0.0, SHIFT_LEFT12));

    v_compressed.x = eyeDepth;
    v_compressed.y = applyTranslate * SHIFT_LEFT1 + enableDepthCheck;
    v_compressed.z = dw * SHIFT_LEFT12 + dh;
    v_compressed.w = iw * SHIFT_LEFT12 + ih;
    v_originTextureCoordinateAndTranslate.xy = depthOrigin;
    v_originTextureCoordinateAndTranslate.zw = translate;
    v_textureCoordinateBounds = textureCoordinateBoundsOrLabelTranslate;

#endif

#ifdef SDF
    vec4 outlineColor;
    float outlineWidth;

    temp = sdf.x;
    temp = temp * SHIFT_RIGHT8;
    outlineColor.b = (temp - floor(temp)) * SHIFT_LEFT8;
    temp = floor(temp) * SHIFT_RIGHT8;
    outlineColor.g = (temp - floor(temp)) * SHIFT_LEFT8;
    outlineColor.r = floor(temp);

    temp = sdf.y;
    temp = temp * SHIFT_RIGHT8;
    float temp3 = (temp - floor(temp)) * SHIFT_LEFT8;
    temp = floor(temp) * SHIFT_RIGHT8;
    outlineWidth = (temp - floor(temp)) * SHIFT_LEFT8;
    outlineColor.a = floor(temp);
    outlineColor /= 255.0;

    v_outlineWidth = outlineWidth / 255.0;
    v_outlineColor = outlineColor;
    v_outlineColor.a *= translucency;
#endif

    v_pickColor = pickColor;

    v_color = color;
    v_color.a *= translucency;
    v_splitDirection = splitDirection;
}
`;function _i(e,t){e=x(e,x.EMPTY_OBJECT);let n=e.translucencyByDistance,i=e.pixelOffsetScaleByDistance,o=e.scaleByDistance,r=e.distanceDisplayCondition;u(n)&&(n=kt.clone(n)),u(i)&&(i=kt.clone(i)),u(o)&&(o=kt.clone(o)),u(r)&&(r=Nt.clone(r)),this._show=x(e.show,!0),this._position=h.clone(x(e.position,h.ZERO)),this._actualPosition=h.clone(this._position),this._pixelOffset=H.clone(x(e.pixelOffset,H.ZERO)),this._translate=new H(0,0),this._eyeOffset=h.clone(x(e.eyeOffset,h.ZERO)),this._heightReference=x(e.heightReference,Xe.NONE),this._verticalOrigin=x(e.verticalOrigin,On.CENTER),this._horizontalOrigin=x(e.horizontalOrigin,bi.CENTER),this._scale=x(e.scale,1),this._color=G.clone(x(e.color,G.WHITE)),this._rotation=x(e.rotation,0),this._alignedAxis=h.clone(x(e.alignedAxis,h.ZERO)),this._width=e.width,this._height=e.height,this._scaleByDistance=o,this._translucencyByDistance=n,this._pixelOffsetScaleByDistance=i,this._sizeInMeters=x(e.sizeInMeters,!1),this._distanceDisplayCondition=r,this._disableDepthTestDistance=e.disableDepthTestDistance,this._id=e.id,this._collection=x(e.collection,t),this._pickId=void 0,this._pickPrimitive=x(e._pickPrimitive,this),this._billboardCollection=t,this._dirty=!1,this._index=-1,this._batchIndex=void 0,this._imageIndex=-1,this._imageIndexPromise=void 0,this._imageId=void 0,this._image=void 0,this._imageSubRegion=void 0,this._imageWidth=void 0,this._imageHeight=void 0,this._labelDimensions=void 0,this._labelHorizontalOrigin=void 0,this._labelTranslate=void 0;let s=e.image,a=e.imageId;u(s)&&(u(a)||(typeof s=="string"?a=s:u(s.src)?a=s.src:a=Hn()),this._imageId=a,this._image=s),u(e.imageSubRegion)&&(this._imageId=a,this._imageSubRegion=e.imageSubRegion),u(this._billboardCollection._textureAtlas)&&this._loadImage(),this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=ne.SCENE3D,this._clusterShow=!0,this._outlineColor=G.clone(x(e.outlineColor,G.BLACK)),this._outlineWidth=x(e.outlineWidth,0),this._updateClamping(),this._splitDirection=x(e.splitDirection,Wr.NONE)}var Aae=_i.SHOW_INDEX=0,fB=_i.POSITION_INDEX=1,vae=_i.PIXEL_OFFSET_INDEX=2,y7e=_i.EYE_OFFSET_INDEX=3,x7e=_i.HORIZONTAL_ORIGIN_INDEX=4,b7e=_i.VERTICAL_ORIGIN_INDEX=5,C7e=_i.SCALE_INDEX=6,dB=_i.IMAGE_INDEX_INDEX=7,Tae=_i.COLOR_INDEX=8,A7e=_i.ROTATION_INDEX=9,T7e=_i.ALIGNED_AXIS_INDEX=10,E7e=_i.SCALE_BY_DISTANCE_INDEX=11,S7e=_i.TRANSLUCENCY_BY_DISTANCE_INDEX=12,v7e=_i.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX=13,w7e=_i.DISTANCE_DISPLAY_CONDITION=14,D7e=_i.DISABLE_DEPTH_DISTANCE=15;_i.TEXTURE_COORDINATE_BOUNDS=16;var Eae=_i.SDF_INDEX=17,I7e=_i.SPLIT_DIRECTION_INDEX=18;_i.NUMBER_OF_PROPERTIES=19;function Po(e,t){let n=e._billboardCollection;u(n)&&(n._updateBillboard(e,t),e._dirty=!0)}Object.defineProperties(_i.prototype,{show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,Po(this,Aae))}},position:{get:function(){return this._position},set:function(e){let t=this._position;h.equals(t,e)||(h.clone(e,t),h.clone(e,this._actualPosition),this._updateClamping(),Po(this,fB))}},heightReference:{get:function(){return this._heightReference},set:function(e){let t=this._heightReference;e!==t&&(this._heightReference=e,this._updateClamping(),Po(this,fB))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){let t=this._pixelOffset;H.equals(t,e)||(H.clone(e,t),Po(this,vae))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){let t=this._scaleByDistance;kt.equals(t,e)||(this._scaleByDistance=kt.clone(e,t),Po(this,E7e))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){let t=this._translucencyByDistance;kt.equals(t,e)||(this._translucencyByDistance=kt.clone(e,t),Po(this,S7e))}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){let t=this._pixelOffsetScaleByDistance;kt.equals(t,e)||(this._pixelOffsetScaleByDistance=kt.clone(e,t),Po(this,v7e))}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){let t=this._eyeOffset;h.equals(t,e)||(h.clone(e,t),Po(this,y7e))}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){this._horizontalOrigin!==e&&(this._horizontalOrigin=e,Po(this,x7e))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){this._verticalOrigin!==e&&(this._verticalOrigin=e,Po(this,b7e))}},scale:{get:function(){return this._scale},set:function(e){this._scale!==e&&(this._scale=e,Po(this,C7e))}},color:{get:function(){return this._color},set:function(e){let t=this._color;G.equals(t,e)||(G.clone(e,t),Po(this,Tae))}},rotation:{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,Po(this,A7e))}},alignedAxis:{get:function(){return this._alignedAxis},set:function(e){let t=this._alignedAxis;h.equals(t,e)||(h.clone(e,t),Po(this,T7e))}},width:{get:function(){return x(this._width,this._imageWidth)},set:function(e){this._width!==e&&(this._width=e,Po(this,dB))}},height:{get:function(){return x(this._height,this._imageHeight)},set:function(e){this._height!==e&&(this._height=e,Po(this,dB))}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(e){this._sizeInMeters!==e&&(this._sizeInMeters=e,Po(this,Tae))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){Nt.equals(e,this._distanceDisplayCondition)||(this._distanceDisplayCondition=Nt.clone(e,this._distanceDisplayCondition),Po(this,w7e))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){this._disableDepthTestDistance!==e&&(this._disableDepthTestDistance=e,Po(this,D7e))}},id:{get:function(){return this._id},set:function(e){this._id=e,u(this._pickId)&&(this._pickId.object.id=e)}},pickPrimitive:{get:function(){return this._pickPrimitive},set:function(e){this._pickPrimitive=e,u(this._pickId)&&(this._pickId.object.primitive=e)}},pickId:{get:function(){return this._pickId}},image:{get:function(){return this._imageId},set:function(e){u(e)?typeof e=="string"?this.setImage(e,e):e instanceof De?this.setImage(e.url,e):u(e.src)?this.setImage(e.src,e):this.setImage(Hn(),e):(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=void 0,this._image=void 0,this._imageIndexPromise=void 0,Po(this,dB))}},ready:{get:function(){return this._imageIndex!==-1}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=h.clone(e,this._actualClampedPosition),Po(this,fB)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){this._clusterShow!==e&&(this._clusterShow=e,Po(this,Aae))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){let t=this._outlineColor;G.equals(t,e)||(G.clone(e,t),Po(this,Eae))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,Po(this,Eae))}},splitDirection:{get:function(){return this._splitDirection},set:function(e){this._splitDirection!==e&&(this._splitDirection=e,Po(this,I7e))}}});_i.prototype.getPickId=function(e){return u(this._pickId)||(this._pickId=e.createPickId({primitive:this._pickPrimitive,collection:this._collection,id:this._id})),this._pickId};_i.prototype._updateClamping=function(){_i._updateClamping(this._billboardCollection,this)};var hB=new de;_i._updateClamping=function(e,t){let n=e._scene;if(!u(n))return;let i=x(n.ellipsoid,ee.default),o=n.frameState.mode,r=o!==t._mode;if(t._mode=o,(t._heightReference===Xe.NONE||r)&&u(t._removeCallbackFunc)&&(t._removeCallbackFunc(),t._removeCallbackFunc=void 0,t._clampedPosition=void 0),t._heightReference===Xe.NONE||!u(t._position))return;u(t._removeCallbackFunc)&&t._removeCallbackFunc();let s=i.cartesianToCartographic(t._position);if(!u(s)){t._actualClampedPosition=void 0;return}function a(l){let f=i.cartographicToCartesian(l,t._clampedPosition);DC(t._heightReference)&&(t._mode===ne.SCENE3D?(l.height+=s.height,i.cartographicToCartesian(l,f)):f.x+=s.height),t._clampedPosition=f}t._removeCallbackFunc=n.updateHeight(s,a,t._heightReference),de.clone(s,hB);let c=n.getHeight(s,t._heightReference);u(c)&&(hB.height=c),a(hB)};_i.prototype._loadImage=function(){let e=this._billboardCollection._textureAtlas,t=this._imageId,n=this._image,i=this._imageSubRegion,o,r=this;function s(c){if(r._imageId!==t||r._image!==n||!qe.equals(r._imageSubRegion,i))return;let l=e.textureCoordinates[c];r._imageWidth=e.texture.width*l.width,r._imageHeight=e.texture.height*l.height,r._imageIndex=c,r._ready=!0,r._image=void 0,r._imageIndexPromise=void 0,Po(r,dB);let f=r._billboardCollection._scene;u(f)&&f.frameState.afterRender.push(()=>!0)}if(u(n)&&(o=e.addImage(t,n)),u(i)&&(o=e.addSubRegion(t,i)),this._imageIndexPromise=o,!u(o))return;let a=e.getImageIndex(t);if(u(a)&&!u(i)){s(a);return}o.then(s).catch(function(c){console.error(`Error loading image for billboard: ${c}`),r._imageIndexPromise=void 0})};_i.prototype.setImage=function(e,t){this._imageId!==e&&(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=e,this._image=t,u(this._billboardCollection._textureAtlas)&&this._loadImage())};_i.prototype.setImageSubRegion=function(e,t){this._imageId===e&&qe.equals(this._imageSubRegion,t)||(this._imageIndex=-1,this._imageId=e,this._imageSubRegion=qe.clone(t),u(this._billboardCollection._textureAtlas)&&this._loadImage())};_i.prototype._setTranslate=function(e){let t=this._translate;H.equals(t,e)||(H.clone(e,t),Po(this,vae))};_i.prototype._getActualPosition=function(){return u(this._clampedPosition)?this._clampedPosition:this._actualPosition};_i.prototype._setActualPosition=function(e){u(this._clampedPosition)||h.clone(e,this._actualPosition),Po(this,fB)};var Sae=new oe;_i._computeActualPosition=function(e,t,n,i){return u(e._clampedPosition)?(n.mode!==e._mode&&e._updateClamping(),e._clampedPosition):n.mode===ne.SCENE3D?t:(F.multiplyByPoint(i,t,Sae),Wi.computeActualEllipsoidPosition(n,Sae))};var wae=new h;_i._computeScreenSpacePosition=function(e,t,n,i,o,r){let s=F.multiplyByPoint(e,t,wae),a=Wi.worldWithEyeOffsetToWindowCoordinates(o,s,n,r);if(u(a))return H.add(a,i,a),a};var uB=new H(0,0);_i.prototype.computeScreenSpacePosition=function(e,t){let n=this._billboardCollection;u(t)||(t=new H),H.clone(this._pixelOffset,uB),H.add(uB,this._translate,uB);let i=n.modelMatrix,o=this._position;if(u(this._clampedPosition)&&(o=this._clampedPosition,e.mode!==ne.SCENE3D)){let s=e.mapProjection,a=s.ellipsoid,c=s.unproject(o,hB);o=a.cartographicToCartesian(c,wae),i=F.IDENTITY}return _i._computeScreenSpacePosition(i,o,this._eyeOffset,uB,e,t)};_i.getScreenSpaceBoundingBox=function(e,t,n){let i=e.width,o=e.height,r=e.scale;i*=r,o*=r;let s=t.x;e.horizontalOrigin===bi.RIGHT?s-=i:e.horizontalOrigin===bi.CENTER&&(s-=i*.5);let a=t.y;return e.verticalOrigin===On.BOTTOM||e.verticalOrigin===On.BASELINE?a-=o:e.verticalOrigin===On.CENTER&&(a-=o*.5),u(n)||(n=new qe),n.x=s,n.y=a,n.width=i,n.height=o,n};_i.prototype.equals=function(e){return this===e||u(e)&&this._id===e._id&&h.equals(this._position,e._position)&&this._imageId===e._imageId&&this._show===e._show&&this._scale===e._scale&&this._verticalOrigin===e._verticalOrigin&&this._horizontalOrigin===e._horizontalOrigin&&this._heightReference===e._heightReference&&qe.equals(this._imageSubRegion,e._imageSubRegion)&&G.equals(this._color,e._color)&&H.equals(this._pixelOffset,e._pixelOffset)&&H.equals(this._translate,e._translate)&&h.equals(this._eyeOffset,e._eyeOffset)&&kt.equals(this._scaleByDistance,e._scaleByDistance)&&kt.equals(this._translucencyByDistance,e._translucencyByDistance)&&kt.equals(this._pixelOffsetScaleByDistance,e._pixelOffsetScaleByDistance)&&Nt.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance&&this._splitDirection===e._splitDirection};_i.prototype._destroy=function(){u(this._customData)&&(this._billboardCollection._scene.globe._surface.removeTileCustomData(this._customData),this._customData=void 0),u(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this.image=void 0,this._pickId=this._pickId&&this._pickId.destroy(),this._billboardCollection=void 0};var po=_i;var P7e={OPAQUE:0,TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2},Ro=Object.freeze(P7e);var R7e={FONT_SIZE:48,PADDING:10,RADIUS:8,CUTOFF:.25},sa=Object.freeze(R7e);function Op(e,t,n,i,o){this.bottomLeft=x(e,H.ZERO),this.topRight=x(t,H.ZERO),this.childNode1=n,this.childNode2=i,this.imageIndex=o}var O7e=new H(16,16);function kg(e){e=x(e,x.EMPTY_OBJECT);let t=x(e.borderWidthInPixels,1),n=x(e.initialSize,O7e);this._context=e.context,this._pixelFormat=x(e.pixelFormat,tt.RGBA),this._borderWidthInPixels=t,this._textureCoordinates=[],this._guid=Hn(),this._idHash={},this._indexHash={},this._initialSize=n,this._root=void 0}Object.defineProperties(kg.prototype,{borderWidthInPixels:{get:function(){return this._borderWidthInPixels}},textureCoordinates:{get:function(){return this._textureCoordinates}},texture:{get:function(){return u(this._texture)||(this._texture=new Ot({context:this._context,width:this._initialSize.x,height:this._initialSize.y,pixelFormat:this._pixelFormat})),this._texture}},numberOfImages:{get:function(){return this._textureCoordinates.length}},guid:{get:function(){return this._guid}}});function M7e(e,t){let n=e._context,i=e.numberOfImages,o=2,r=e._borderWidthInPixels;if(i>0){let s=e._texture.width,a=e._texture.height,c=o*(s+t.width+r),l=o*(a+t.height+r),f=s/c,d=a/l,p=new Op(new H(s+r,r),new H(c,a)),g=new Op(new H,new H(c,a),e._root,p),m=new Op(new H(r,a+r),new H(c,l)),y=new Op(new H,new H(c,l),g,m);for(let A=0;A<e._textureCoordinates.length;A++){let T=e._textureCoordinates[A];u(T)&&(T.x*=f,T.y*=d,T.width*=f,T.height*=d)}let b=new Ot({context:e._context,width:c,height:l,pixelFormat:e._pixelFormat}),C=new Hr({context:n,colorTextures:[e._texture],destroyAttachments:!1});C._bind(),b.copyFromFramebuffer(0,0,0,0,c,l),C._unBind(),C.destroy(),e._texture=e._texture&&e._texture.destroy(),e._texture=b,e._root=y}else{let s=o*(t.width+2*r),a=o*(t.height+2*r);s<e._initialSize.x&&(s=e._initialSize.x),a<e._initialSize.y&&(a=e._initialSize.y),e._texture=e._texture&&e._texture.destroy(),e._texture=new Ot({context:e._context,width:s,height:a,pixelFormat:e._pixelFormat}),e._root=new Op(new H(r,r),new H(s,a))}}function mB(e,t,n){if(u(t)){if(!u(t.childNode1)&&!u(t.childNode2)){if(u(t.imageIndex))return;let i=t.topRight.x-t.bottomLeft.x,o=t.topRight.y-t.bottomLeft.y,r=i-n.width,s=o-n.height;if(r<0||s<0)return;if(r===0&&s===0)return t;if(r>s){t.childNode1=new Op(new H(t.bottomLeft.x,t.bottomLeft.y),new H(t.bottomLeft.x+n.width,t.topRight.y));let a=t.bottomLeft.x+n.width+e._borderWidthInPixels;a<t.topRight.x&&(t.childNode2=new Op(new H(a,t.bottomLeft.y),new H(t.topRight.x,t.topRight.y)))}else{t.childNode1=new Op(new H(t.bottomLeft.x,t.bottomLeft.y),new H(t.topRight.x,t.bottomLeft.y+n.height));let a=t.bottomLeft.y+n.height+e._borderWidthInPixels;a<t.topRight.y&&(t.childNode2=new Op(new H(t.bottomLeft.x,a),new H(t.topRight.x,t.topRight.y)))}return mB(e,t.childNode1,n)}return mB(e,t.childNode1,n)||mB(e,t.childNode2,n)}}function Dae(e,t,n){let i=mB(e,e._root,t);if(u(i)){i.imageIndex=n;let o=e._texture.width,r=e._texture.height,s=i.topRight.x-i.bottomLeft.x,a=i.topRight.y-i.bottomLeft.y,c=i.bottomLeft.x/o,l=i.bottomLeft.y/r,f=s/o,d=a/r;e._textureCoordinates[n]=new qe(c,l,f,d),e._texture.copyFrom({source:t,xOffset:i.bottomLeft.x,yOffset:i.bottomLeft.y})}else M7e(e,t),Dae(e,t,n);e._guid=Hn()}function Iae(e,t){if(!u(e)||e.isDestroyed())return-1;let n=e.numberOfImages;return Dae(e,t,n),n}kg.prototype.getImageIndex=function(e){return this._indexHash[e]};kg.prototype.addImageSync=function(e,t){let n=this._indexHash[e];return u(n)||(n=Iae(this,t),this._idHash[e]=Promise.resolve(n),this._indexHash[e]=n),n};kg.prototype.addImage=function(e,t){let n=this._idHash[e];if(u(n))return n;typeof t=="function"?t=t(e):(typeof t=="string"||t instanceof De)&&(t=De.createIfNeeded(t).fetchImage());let i=this;return n=Promise.resolve(t).then(function(o){let r=Iae(i,o);return i._indexHash[e]=r,r}),this._idHash[e]=n,n};kg.prototype.addSubRegion=function(e,t){let n=this._idHash[e];if(!u(n))throw new ce(`image with id "${e}" not found in the atlas.`);let i=this;return Promise.resolve(n).then(function(o){if(o===-1)return-1;let r=i._texture.width,s=i._texture.height,a=i._textureCoordinates[o],c=a.x+t.x/r,l=a.y+t.y/s,f=t.width/r,d=t.height/s,p=i._textureCoordinates.push(new qe(c,l,f,d))-1;return i._indexHash[e]=p,i._guid=Hn(),p})};kg.prototype.isDestroyed=function(){return!1};kg.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),ue(this)};var Tx=kg;var L7e=po.SHOW_INDEX,Ow=po.POSITION_INDEX,Pae=po.PIXEL_OFFSET_INDEX,Rae=po.EYE_OFFSET_INDEX,N7e=po.HORIZONTAL_ORIGIN_INDEX,F7e=po.VERTICAL_ORIGIN_INDEX,B7e=po.SCALE_INDEX,Rw=po.IMAGE_INDEX_INDEX,Oae=po.COLOR_INDEX,k7e=po.ROTATION_INDEX,V7e=po.ALIGNED_AXIS_INDEX,Mae=po.SCALE_BY_DISTANCE_INDEX,Lae=po.TRANSLUCENCY_BY_DISTANCE_INDEX,Nae=po.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX,Fae=po.DISTANCE_DISPLAY_CONDITION,U7e=po.DISABLE_DEPTH_DISTANCE,z7e=po.TEXTURE_COORDINATE_BOUNDS,Bae=po.SDF_INDEX,kae=po.SPLIT_DIRECTION_INDEX,y7=po.NUMBER_OF_PROPERTIES,lo,H7e={positionHighAndScale:0,positionLowAndRotation:1,compressedAttribute0:2,compressedAttribute1:3,compressedAttribute2:4,eyeOffset:5,scaleByDistance:6,pixelOffsetScaleByDistance:7,compressedAttribute3:8,textureCoordinateBoundsOrLabelTranslate:9,a_batchId:10,sdf:11,splitDirection:12},G7e={direction:0,positionHighAndScale:1,positionLowAndRotation:2,compressedAttribute0:3,compressedAttribute1:4,compressedAttribute2:5,eyeOffset:6,scaleByDistance:7,pixelOffsetScaleByDistance:8,compressedAttribute3:9,textureCoordinateBoundsOrLabelTranslate:10,a_batchId:11,sdf:12,splitDirection:13};function bf(e){e=x(e,x.EMPTY_OBJECT),this._scene=e.scene,this._batchTable=e.batchTable,this._textureAtlas=void 0,this._textureAtlasGUID=void 0,this._destroyTextureAtlas=!0,this._sp=void 0,this._spTranslucent=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!1,this._shaderRotation=!1,this._compiledShaderRotation=!1,this._shaderAlignedAxis=!1,this._compiledShaderAlignedAxis=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._shaderPixelOffsetScaleByDistance=!1,this._compiledShaderPixelOffsetScaleByDistance=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._shaderClampToGround=!1,this._compiledShaderClampToGround=!1,this._propertiesChanged=new Uint32Array(y7),this._maxSize=0,this._maxEyeOffset=0,this._maxScale=1,this._maxPixelOffset=0,this._allHorizontalCenter=!0,this._allVerticalCenter=!0,this._allSizedInMeters=!0,this._baseVolume=new ae,this._baseVolumeWC=new ae,this._baseVolume2D=new ae,this._boundingVolume=new ae,this._boundingVolumeDirty=!1,this._colorCommands=[],this.show=x(e.show,!0),this.modelMatrix=F.clone(x(e.modelMatrix,F.IDENTITY)),this._modelMatrix=F.clone(F.IDENTITY),this.debugShowBoundingVolume=x(e.debugShowBoundingVolume,!1),this.debugShowTextureAtlas=x(e.debugShowTextureAtlas,!1),this.blendOption=x(e.blendOption,Ro.OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=ne.SCENE3D,this._buffersUsage=[ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW],this._highlightColor=G.clone(G.WHITE);let t=this;this._uniforms={u_atlas:function(){return t._textureAtlas.texture},u_highlightColor:function(){return t._highlightColor}};let n=this._scene;u(n)&&u(n.terrainProviderChanged)&&(this._removeCallbackFunc=n.terrainProviderChanged.addEventListener(function(){let i=this._billboards,o=i.length;for(let r=0;r<o;++r)u(i[r])&&i[r]._updateClamping()},this))}Object.defineProperties(bf.prototype,{length:{get:function(){return x7(this),this._billboards.length}},textureAtlas:{get:function(){return this._textureAtlas},set:function(e){this._textureAtlas!==e&&(this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._textureAtlas=e,this._createVertexArray=!0)}},destroyTextureAtlas:{get:function(){return this._destroyTextureAtlas},set:function(e){this._destroyTextureAtlas=e}}});function Vae(e){let t=e.length;for(let n=0;n<t;++n)e[n]&&e[n]._destroy()}bf.prototype.add=function(e){let t=new po(e,this);return t._index=this._billboards.length,this._billboards.push(t),this._createVertexArray=!0,t};bf.prototype.remove=function(e){return this.contains(e)?(this._billboards[e._index]=void 0,this._billboardsRemoved=!0,this._createVertexArray=!0,e._destroy(),!0):!1};bf.prototype.removeAll=function(){Vae(this._billboards),this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!0};function x7(e){if(e._billboardsRemoved){e._billboardsRemoved=!1;let t=[],n=e._billboards,i=n.length;for(let o=0,r=0;o<i;++o){let s=n[o];u(s)&&(s._index=r++,t.push(s))}e._billboards=t}}bf.prototype._updateBillboard=function(e,t){e._dirty||(this._billboardsToUpdate[this._billboardsToUpdateIndex++]=e),++this._propertiesChanged[t]};bf.prototype.contains=function(e){return u(e)&&e._billboardCollection===this};bf.prototype.get=function(e){return x7(this),this._billboards[e]};var d7;function W7e(e){let n=e.cache.billboardCollection_indexBufferBatched;if(u(n))return n;let i=16384*6-6,o=new Uint16Array(i);for(let r=0,s=0;r<i;r+=6,s+=4)o[r]=s,o[r+1]=s+1,o[r+2]=s+2,o[r+3]=s+0,o[r+4]=s+2,o[r+5]=s+3;return n=xt.createIndexBuffer({context:e,typedArray:o,usage:ke.STATIC_DRAW,indexDatatype:Be.UNSIGNED_SHORT}),n.vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferBatched=n,n}function j7e(e){let t=e.cache.billboardCollection_indexBufferInstanced;return u(t)||(t=xt.createIndexBuffer({context:e,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:ke.STATIC_DRAW,indexDatatype:Be.UNSIGNED_SHORT}),t.vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferInstanced=t),t}function q7e(e){let t=e.cache.billboardCollection_vertexBufferInstanced;return u(t)||(t=xt.createVertexBuffer({context:e,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:ke.STATIC_DRAW}),t.vertexArrayDestroyable=!1,e.cache.billboardCollection_vertexBufferInstanced=t),t}bf.prototype.computeNewBuffersUsage=function(){let e=this._buffersUsage,t=!1,n=this._propertiesChanged;for(let i=0;i<y7;++i){let o=n[i]===0?ke.STATIC_DRAW:ke.STREAM_DRAW;t=t||e[i]!==o,e[i]=o}return t};function Y7e(e,t,n,i,o,r){let s=[{index:lo.positionHighAndScale,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:n[Ow]},{index:lo.positionLowAndRotation,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:n[Ow]},{index:lo.compressedAttribute0,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:n[Pae]},{index:lo.compressedAttribute1,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:n[Lae]},{index:lo.compressedAttribute2,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:n[Oae]},{index:lo.eyeOffset,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:n[Rae]},{index:lo.scaleByDistance,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:n[Mae]},{index:lo.pixelOffsetScaleByDistance,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:n[Nae]},{index:lo.compressedAttribute3,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:n[Fae]},{index:lo.textureCoordinateBoundsOrLabelTranslate,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:n[z7e]},{index:lo.splitDirection,componentsPerAttribute:1,componentDatatype:K.FLOAT,usage:n[kae]}];i&&s.push({index:lo.direction,componentsPerAttribute:2,componentDatatype:K.FLOAT,vertexBuffer:q7e(e)}),u(o)&&s.push({index:lo.a_batchId,componentsPerAttribute:1,componentDatatype:K.FLOAT,bufferUsage:ke.STATIC_DRAW}),r&&s.push({index:lo.sdf,componentsPerAttribute:2,componentDatatype:K.FLOAT,usage:n[Bae]});let a=i?t:4*t;return new G_(e,s,a,i)}var h7=new Gn;function Uae(e,t,n,i,o){let r,s=i[lo.positionHighAndScale],a=i[lo.positionLowAndRotation],c=o._getActualPosition();e._mode===ne.SCENE3D&&(ae.expand(e._baseVolume,c,e._baseVolume),e._boundingVolumeDirty=!0),Gn.fromCartesian(c,h7);let l=o.scale,f=o.rotation;f!==0&&(e._shaderRotation=!0),e._maxScale=Math.max(e._maxScale,l);let d=h7.high,p=h7.low;e._instanced?(r=o._index,s(r,d.x,d.y,d.z,l),a(r,p.x,p.y,p.z,f)):(r=o._index*4,s(r+0,d.x,d.y,d.z,l),s(r+1,d.x,d.y,d.z,l),s(r+2,d.x,d.y,d.z,l),s(r+3,d.x,d.y,d.z,l),a(r+0,p.x,p.y,p.z,f),a(r+1,p.x,p.y,p.z,f),a(r+2,p.x,p.y,p.z,f),a(r+3,p.x,p.y,p.z,f))}var xf=new H,yf=32768,GA=65536,m7=4096,em=256,X7e=128,K7e=32,Z7e=8,zae=4,$7e=1/256,Hae=0,Gae=2,Wae=3,jae=1;function qae(e,t,n,i,o){let r,s=i[lo.compressedAttribute0],a=o.pixelOffset,c=a.x,l=a.y,f=o._translate,d=f.x,p=f.y;e._maxPixelOffset=Math.max(e._maxPixelOffset,Math.abs(c+d),Math.abs(-l+p));let g=o.horizontalOrigin,m=o._verticalOrigin,y=o.show&&o.clusterShow;o.color.alpha===0&&(y=!1),m===On.BASELINE&&(m=On.BOTTOM),e._allHorizontalCenter=e._allHorizontalCenter&&g===bi.CENTER,e._allVerticalCenter=e._allVerticalCenter&&m===On.CENTER;let b=0,C=0,A=0,T=0,E=o._imageIndex;if(E!==-1){let z=n[E];b=z.x,C=z.y,A=z.width,T=z.height}let v=b+A,D=C+T,O=Math.floor(R.clamp(c,-yf,yf)+yf)*X7e;O+=(g+1)*K7e,O+=(m+1)*Z7e,O+=(y?1:0)*zae;let P=Math.floor(R.clamp(l,-yf,yf)+yf)*em,M=Math.floor(R.clamp(d,-yf,yf)+yf)*em,L=(R.clamp(p,-yf,yf)+yf)*$7e,_=Math.floor(L),S=Math.floor((L-_)*em);P+=_,M+=S,xf.x=b,xf.y=C;let w=Ln.compressTextureCoordinates(xf);xf.x=v;let I=Ln.compressTextureCoordinates(xf);xf.y=D;let N=Ln.compressTextureCoordinates(xf);xf.x=b;let k=Ln.compressTextureCoordinates(xf);e._instanced?(r=o._index,s(r,O,P,M,w)):(r=o._index*4,s(r+0,O+Hae,P,M,w),s(r+1,O+Gae,P,M,I),s(r+2,O+Wae,P,M,N),s(r+3,O+jae,P,M,k))}function Yae(e,t,n,i,o){let r,s=i[lo.compressedAttribute1],a=o.alignedAxis;h.equals(a,h.ZERO)||(e._shaderAlignedAxis=!0);let c=0,l=1,f=1,d=1,p=o.translucencyByDistance;u(p)&&(c=p.near,l=p.nearValue,f=p.far,d=p.farValue,(l!==1||d!==1)&&(e._shaderTranslucencyByDistance=!0));let g=0,m=o._imageIndex;m!==-1&&(g=n[m].width);let y=e._textureAtlas.texture.width,b=Math.round(x(o.width,y*g));e._maxSize=Math.max(e._maxSize,b);let C=R.clamp(b,0,GA),A=0;Math.abs(h.magnitudeSquared(a)-1)<R.EPSILON6&&(A=Ln.octEncodeFloat(a)),l=R.clamp(l,0,1),l=l===1?255:l*255|0,C=C*em+l,d=R.clamp(d,0,1),d=d===1?255:d*255|0,A=A*em+d,e._instanced?(r=o._index,s(r,C,A,c,f)):(r=o._index*4,s(r+0,C,A,c,f),s(r+1,C,A,c,f),s(r+2,C,A,c,f),s(r+3,C,A,c,f))}function _7(e,t,n,i,o){let r,s=i[lo.compressedAttribute2],a=o.color,c=u(e._batchTable)?G.WHITE:o.getPickId(t.context).color,l=o.sizeInMeters?1:0,f=Math.abs(h.magnitudeSquared(o.alignedAxis)-1)<R.EPSILON6?1:0;e._allSizedInMeters=e._allSizedInMeters&&l===1;let d=0,p=o._imageIndex;p!==-1&&(d=n[p].height);let g=e._textureAtlas.texture.dimensions,m=Math.round(x(o.height,g.y*d));e._maxSize=Math.max(e._maxSize,m);let y=x(o._labelHorizontalOrigin,-2);y+=2;let b=m*zae+y,C=G.floatToByte(a.red),A=G.floatToByte(a.green),T=G.floatToByte(a.blue),E=C*GA+A*em+T;C=G.floatToByte(c.red),A=G.floatToByte(c.green),T=G.floatToByte(c.blue);let v=C*GA+A*em+T,D=G.floatToByte(a.alpha)*GA+G.floatToByte(c.alpha)*em;D+=l*2+f,e._instanced?(r=o._index,s(r,E,v,D,b)):(r=o._index*4,s(r+0,E,v,D,b),s(r+1,E,v,D,b),s(r+2,E,v,D,b),s(r+3,E,v,D,b))}function g7(e,t,n,i,o){let r,s=i[lo.eyeOffset],a=o.eyeOffset,c=a.z;if(o._heightReference!==Xe.NONE&&(c*=1.005),e._maxEyeOffset=Math.max(e._maxEyeOffset,Math.abs(a.x),Math.abs(a.y),Math.abs(c)),e._instanced){let l=0,f=0,d=o._imageIndex;if(d!==-1){let g=n[d];l=g.width,f=g.height}xf.x=l,xf.y=f;let p=Ln.compressTextureCoordinates(xf);r=o._index,s(r,a.x,a.y,c,p)}else r=o._index*4,s(r+0,a.x,a.y,c,0),s(r+1,a.x,a.y,c,0),s(r+2,a.x,a.y,c,0),s(r+3,a.x,a.y,c,0)}function Xae(e,t,n,i,o){let r,s=i[lo.scaleByDistance],a=0,c=1,l=1,f=1,d=o.scaleByDistance;u(d)&&(a=d.near,c=d.nearValue,l=d.far,f=d.farValue,(c!==1||f!==1)&&(e._shaderScaleByDistance=!0)),e._instanced?(r=o._index,s(r,a,c,l,f)):(r=o._index*4,s(r+0,a,c,l,f),s(r+1,a,c,l,f),s(r+2,a,c,l,f),s(r+3,a,c,l,f))}function Kae(e,t,n,i,o){let r,s=i[lo.pixelOffsetScaleByDistance],a=0,c=1,l=1,f=1,d=o.pixelOffsetScaleByDistance;u(d)&&(a=d.near,c=d.nearValue,l=d.far,f=d.farValue,(c!==1||f!==1)&&(e._shaderPixelOffsetScaleByDistance=!0)),e._instanced?(r=o._index,s(r,a,c,l,f)):(r=o._index*4,s(r+0,a,c,l,f),s(r+1,a,c,l,f),s(r+2,a,c,l,f),s(r+3,a,c,l,f))}function Zae(e,t,n,i,o){let r,s=i[lo.compressedAttribute3],a=0,c=Number.MAX_VALUE,l=o.distanceDisplayCondition;u(l)&&(a=l.near,c=l.far,a*=a,c*=c,e._shaderDistanceDisplayCondition=!0);let f=o.disableDepthTestDistance,d=tf(o.heightReference)&&t.context.depthTexture;u(f)||(f=d?5e3:0),f*=f,(d||f>0)&&(e._shaderDisableDepthDistance=!0,f===Number.POSITIVE_INFINITY&&(f=-1));let p,g;if(u(o._labelDimensions))g=o._labelDimensions.x,p=o._labelDimensions.y;else{let C=0,A=0,T=o._imageIndex;if(T!==-1){let v=n[T];C=v.height,A=v.width}p=Math.round(x(o.height,e._textureAtlas.texture.dimensions.y*C));let E=e._textureAtlas.texture.width;g=Math.round(x(o.width,E*A))}let m=Math.floor(R.clamp(g,0,m7)),y=Math.floor(R.clamp(p,0,m7)),b=m*m7+y;e._instanced?(r=o._index,s(r,a,c,f,b)):(r=o._index*4,s(r+0,a,c,f,b),s(r+1,a,c,f,b),s(r+2,a,c,f,b),s(r+3,a,c,f,b))}function $ae(e,t,n,i,o){if(tf(o.heightReference)){let m=e._scene,y=t.context,b=t.globeTranslucencyState.translucent,C=u(m.globe)&&m.globe.depthTestAgainstTerrain;e._shaderClampToGround=y.depthTexture&&!b&&C}let r,s=i[lo.textureCoordinateBoundsOrLabelTranslate];if(Vt.maximumVertexTextureImageUnits>0){let m=0,y=0;u(o._labelTranslate)&&(m=o._labelTranslate.x,y=o._labelTranslate.y),e._instanced?(r=o._index,s(r,m,y,0,0)):(r=o._index*4,s(r+0,m,y,0,0),s(r+1,m,y,0,0),s(r+2,m,y,0,0),s(r+3,m,y,0,0));return}let a=0,c=0,l=0,f=0,d=o._imageIndex;if(d!==-1){let m=n[d];a=m.x,c=m.y,l=m.width,f=m.height}let p=a+l,g=c+f;e._instanced?(r=o._index,s(r,a,c,p,g)):(r=o._index*4,s(r+0,a,c,p,g),s(r+1,a,c,p,g),s(r+2,a,c,p,g),s(r+3,a,c,p,g))}function Q7e(e,t,n,i,o){if(!u(e._batchTable))return;let r=i[lo.a_batchId],s=o._batchIndex,a;e._instanced?(a=o._index,r(a,s)):(a=o._index*4,r(a+0,s),r(a+1,s),r(a+2,s),r(a+3,s))}function Qae(e,t,n,i,o){if(!e._sdf)return;let r,s=i[lo.sdf],a=o.outlineColor,c=o.outlineWidth,l=G.floatToByte(a.red),f=G.floatToByte(a.green),d=G.floatToByte(a.blue),p=l*GA+f*em+d,g=c/sa.RADIUS,m=G.floatToByte(a.alpha)*GA+G.floatToByte(g)*em;e._instanced?(r=o._index,s(r,p,m)):(r=o._index*4,s(r+0,p+Hae,m),s(r+1,p+Gae,m),s(r+2,p+Wae,m),s(r+3,p+jae,m))}function Jae(e,t,n,i,o){let r=i[lo.splitDirection],s=0,a=o.splitDirection;u(a)&&(s=a);let c;e._instanced?(c=o._index,r(c,s)):(c=o._index*4,r(c+0,s),r(c+1,s),r(c+2,s),r(c+3,s))}function J7e(e,t,n,i,o){Uae(e,t,n,i,o),qae(e,t,n,i,o),Yae(e,t,n,i,o),_7(e,t,n,i,o),g7(e,t,n,i,o),Xae(e,t,n,i,o),Kae(e,t,n,i,o),Zae(e,t,n,i,o),$ae(e,t,n,i,o),Q7e(e,t,n,i,o),Qae(e,t,n,i,o),Jae(e,t,n,i,o)}function p7(e,t,n,i,o,r){let s;i.mode===ne.SCENE3D?(s=e._baseVolume,e._boundingVolumeDirty=!0):s=e._baseVolume2D;let a=[];for(let c=0;c<n;++c){let l=t[c],f=l.position,d=po._computeActualPosition(l,f,i,o);u(d)&&(l._setActualPosition(d),r?a.push(d):ae.expand(s,d,s))}r&&ae.fromPoints(a,s)}function eje(e,t){let n=t.mode,i=e._billboards,o=e._billboardsToUpdate,r=e._modelMatrix;e._createVertexArray||e._mode!==n||n!==ne.SCENE3D&&!F.equals(r,e.modelMatrix)?(e._mode=n,F.clone(e.modelMatrix,r),e._createVertexArray=!0,(n===ne.SCENE3D||n===ne.SCENE2D||n===ne.COLUMBUS_VIEW)&&p7(e,i,i.length,t,r,!0)):n===ne.MORPHING?p7(e,i,i.length,t,r,!0):(n===ne.SCENE2D||n===ne.COLUMBUS_VIEW)&&p7(e,o,e._billboardsToUpdateIndex,t,r,!1)}function tje(e,t,n){let i=1;(!e._allSizedInMeters||e._maxPixelOffset!==0)&&(i=t.camera.getPixelSize(n,t.context.drawingBufferWidth,t.context.drawingBufferHeight));let o=i*e._maxScale*e._maxSize*2;e._allHorizontalCenter&&e._allVerticalCenter&&(o*=.5);let r=i*e._maxPixelOffset+e._maxEyeOffset;n.radius+=o+r}function nje(e,t){let i=t.createViewportQuadCommand(`uniform sampler2D billboard_texture; 
in vec2 v_textureCoordinates; 
void main() 
{ 
    out_FragColor = texture(billboard_texture, v_textureCoordinates); 
} 
`,{uniformMap:{billboard_texture:function(){return e._textureAtlas.texture}}});return i.pass=we.OVERLAY,i}var ije=[];bf.prototype.update=function(e){if(x7(this),!this.show)return;let t=this._billboards,n=t.length,i=e.context;this._instanced=i.instancedArrays,lo=this._instanced?G7e:H7e,d7=this._instanced?j7e:W7e;let o=this._textureAtlas;if(!u(o)){o=this._textureAtlas=new Tx({context:i});for(let P=0;P<n;++P)t[P]._loadImage()}let r=o.textureCoordinates;if(r.length===0)return;eje(this,e),t=this._billboards,n=t.length;let s=this._billboardsToUpdate,a=this._billboardsToUpdateIndex,c=this._propertiesChanged,l=o.guid,f=this._createVertexArray||this._textureAtlasGUID!==l;this._textureAtlasGUID=l;let d,p=e.passes,g=p.pick;if(f||!g&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(let P=0;P<y7;++P)c[P]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),n>0){this._vaf=Y7e(i,n,this._buffersUsage,this._instanced,this._batchTable,this._sdf),d=this._vaf.writers;for(let P=0;P<n;++P){let M=this._billboards[P];M._dirty=!1,J7e(this,e,r,d,M)}this._vaf.commit(d7(i))}this._billboardsToUpdateIndex=0}else if(a>0){let P=ije;P.length=0,(c[Ow]||c[k7e]||c[B7e])&&P.push(Uae),(c[Rw]||c[Pae]||c[N7e]||c[F7e]||c[L7e])&&(P.push(qae),this._instanced&&P.push(g7)),(c[Rw]||c[V7e]||c[Lae])&&(P.push(Yae),P.push(_7)),(c[Rw]||c[Oae])&&P.push(_7),c[Rae]&&P.push(g7),c[Mae]&&P.push(Xae),c[Nae]&&P.push(Kae),(c[Fae]||c[U7e]||c[Rw]||c[Ow])&&P.push(Zae),(c[Rw]||c[Ow])&&P.push($ae),c[Bae]&&P.push(Qae),c[kae]&&P.push(Jae);let M=P.length;if(d=this._vaf.writers,a/n>.1){for(let L=0;L<a;++L){let _=s[L];_._dirty=!1;for(let S=0;S<M;++S)P[S](this,e,r,d,_)}this._vaf.commit(d7(i))}else{for(let L=0;L<a;++L){let _=s[L];_._dirty=!1;for(let S=0;S<M;++S)P[S](this,e,r,d,_);this._instanced?this._vaf.subCommit(_._index,1):this._vaf.subCommit(_._index*4,4)}this._vaf.endSubCommits()}this._billboardsToUpdateIndex=0}if(a>n*1.5&&(s.length=n),!u(this._vaf)||!u(this._vaf.va))return;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,ae.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));let m,y=F.IDENTITY;e.mode===ne.SCENE3D?(y=this.modelMatrix,m=ae.clone(this._baseVolumeWC,this._boundingVolume)):m=ae.clone(this._baseVolume2D,this._boundingVolume),tje(this,e,m);let b=this._blendOption!==this.blendOption;if(this._blendOption=this.blendOption,b){this._blendOption===Ro.OPAQUE||this._blendOption===Ro.OPAQUE_AND_TRANSLUCENT?this._rsOpaque=Ue.fromCache({depthTest:{enabled:!0,func:te.LESS},depthMask:!0}):this._rsOpaque=void 0;let P=this._blendOption===Ro.TRANSLUCENT;this._blendOption===Ro.TRANSLUCENT||this._blendOption===Ro.OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=Ue.fromCache({depthTest:{enabled:!0,func:P?te.LEQUAL:te.LESS},depthMask:P,blending:un.ALPHA_BLEND}):this._rsTranslucent=void 0}this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||e.minimumDisableDepthTestDistance!==0;let C,A,T,E,v,D=Vt.maximumVertexTextureImageUnits>0;if(b||this._shaderRotation!==this._compiledShaderRotation||this._shaderAlignedAxis!==this._compiledShaderAlignedAxis||this._shaderScaleByDistance!==this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance!==this._compiledShaderTranslucencyByDistance||this._shaderPixelOffsetScaleByDistance!==this._compiledShaderPixelOffsetScaleByDistance||this._shaderDistanceDisplayCondition!==this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance||this._shaderClampToGround!==this._compiledShaderClampToGround||this._sdf!==this._compiledSDF){C=lB,A=cB,v=[],u(this._batchTable)&&(v.push("VECTOR_TILE"),C=this._batchTable.getVertexShaderCallback(!1,"a_batchId",void 0)(C),A=this._batchTable.getFragmentShaderCallback(!1,void 0)(A)),T=new ze({defines:v,sources:[C]}),this._instanced&&T.defines.push("INSTANCED"),this._shaderRotation&&T.defines.push("ROTATION"),this._shaderAlignedAxis&&T.defines.push("ALIGNED_AXIS"),this._shaderScaleByDistance&&T.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&T.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderPixelOffsetScaleByDistance&&T.defines.push("EYE_DISTANCE_PIXEL_OFFSET"),this._shaderDistanceDisplayCondition&&T.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&T.defines.push("DISABLE_DEPTH_DISTANCE"),this._shaderClampToGround&&(D?T.defines.push("VERTEX_DEPTH_CHECK"):T.defines.push("FRAGMENT_DEPTH_CHECK"));let P=1-sa.CUTOFF;this._sdf&&T.defines.push("SDF");let M=u(this._batchTable)?"VECTOR_TILE":"";this._blendOption===Ro.OPAQUE_AND_TRANSLUCENT&&(E=new ze({defines:["OPAQUE",M],sources:[A]}),this._shaderClampToGround&&(D?E.defines.push("VERTEX_DEPTH_CHECK"):E.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(E.defines.push("SDF"),E.defines.push(`SDF_EDGE ${P}`)),this._sp=tn.replaceCache({context:i,shaderProgram:this._sp,vertexShaderSource:T,fragmentShaderSource:E,attributeLocations:lo}),E=new ze({defines:["TRANSLUCENT",M],sources:[A]}),this._shaderClampToGround&&(D?E.defines.push("VERTEX_DEPTH_CHECK"):E.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(E.defines.push("SDF"),E.defines.push(`SDF_EDGE ${P}`)),this._spTranslucent=tn.replaceCache({context:i,shaderProgram:this._spTranslucent,vertexShaderSource:T,fragmentShaderSource:E,attributeLocations:lo})),this._blendOption===Ro.OPAQUE&&(E=new ze({defines:[M],sources:[A]}),this._shaderClampToGround&&(D?E.defines.push("VERTEX_DEPTH_CHECK"):E.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(E.defines.push("SDF"),E.defines.push(`SDF_EDGE ${P}`)),this._sp=tn.replaceCache({context:i,shaderProgram:this._sp,vertexShaderSource:T,fragmentShaderSource:E,attributeLocations:lo})),this._blendOption===Ro.TRANSLUCENT&&(E=new ze({defines:[M],sources:[A]}),this._shaderClampToGround&&(D?E.defines.push("VERTEX_DEPTH_CHECK"):E.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(E.defines.push("SDF"),E.defines.push(`SDF_EDGE ${P}`)),this._spTranslucent=tn.replaceCache({context:i,shaderProgram:this._spTranslucent,vertexShaderSource:T,fragmentShaderSource:E,attributeLocations:lo})),this._compiledShaderRotation=this._shaderRotation,this._compiledShaderAlignedAxis=this._shaderAlignedAxis,this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderPixelOffsetScaleByDistance=this._shaderPixelOffsetScaleByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance,this._compiledShaderClampToGround=this._shaderClampToGround,this._compiledSDF=this._sdf}let O=e.commandList;if(p.render||p.pick){let P=this._colorCommands,M=this._blendOption===Ro.OPAQUE,L=this._blendOption===Ro.OPAQUE_AND_TRANSLUCENT,_=this._vaf.va,S=_.length,w=this._uniforms,I;u(this._batchTable)?(w=this._batchTable.getUniformMapCallback()(w),I=this._batchTable.getPickId()):I="v_pickColor",P.length=S;let N=L?S*2:S;for(let k=0;k<N;++k){let z=P[k];u(z)||(z=P[k]=new Qe);let V=M||L&&k%2===0;z.pass=V||!L?we.OPAQUE:we.TRANSLUCENT,z.owner=this;let U=L?Math.floor(k/2):k;z.boundingVolume=m,z.modelMatrix=y,z.count=_[U].indicesCount,z.shaderProgram=V?this._sp:this._spTranslucent,z.uniformMap=w,z.vertexArray=_[U].va,z.renderState=V?this._rsOpaque:this._rsTranslucent,z.debugShowBoundingVolume=this.debugShowBoundingVolume,z.pickId=I,this._instanced&&(z.count=6,z.instanceCount=n),O.push(z)}this.debugShowTextureAtlas&&(u(this.debugCommand)||(this.debugCommand=nje(this,e.context)),O.push(this.debugCommand))}};bf.prototype.isDestroyed=function(){return!1};bf.prototype.destroy=function(){return u(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),Vae(this._billboards),ue(this)};var Cf=bf;function oje(e,t,n,i,o){return function(){let r=document.createElement("canvas"),s=o+2*i;r.height=r.width=s;let a=r.getContext("2d");return a.clearRect(0,0,s,s),i!==0&&(a.beginPath(),a.arc(s/2,s/2,s/2,0,2*Math.PI,!0),a.closePath(),a.fillStyle=n,a.fill(),e<1&&(a.save(),a.globalCompositeOperation="destination-out",a.beginPath(),a.arc(s/2,s/2,o/2,0,2*Math.PI,!0),a.closePath(),a.fillStyle="black",a.fill(),a.restore())),a.beginPath(),a.arc(s/2,s/2,o/2,0,2*Math.PI,!0),a.closePath(),a.fillStyle=t,a.fill(),r}}var WA=oje;function aa(e,t,n,i,o){this._content=e,this._billboard=n,this._label=i,this._polyline=o,this._batchId=t,this._billboardImage=void 0,this._billboardColor=void 0,this._billboardOutlineColor=void 0,this._billboardOutlineWidth=void 0,this._billboardSize=void 0,this._pointSize=void 0,this._color=void 0,this._pointSize=void 0,this._pointOutlineColor=void 0,this._pointOutlineWidth=void 0,this._heightOffset=void 0,this._pickIds=new Array(3),jA(this)}var rje=new de;Object.defineProperties(aa.prototype,{show:{get:function(){return this._label.show},set:function(e){this._label.show=e,this._billboard.show=e,this._polyline.show=e}},color:{get:function(){return this._color},set:function(e){this._color=G.clone(e,this._color),jA(this)}},pointSize:{get:function(){return this._pointSize},set:function(e){this._pointSize=e,jA(this)}},pointOutlineColor:{get:function(){return this._pointOutlineColor},set:function(e){this._pointOutlineColor=G.clone(e,this._pointOutlineColor),jA(this)}},pointOutlineWidth:{get:function(){return this._pointOutlineWidth},set:function(e){this._pointOutlineWidth=e,jA(this)}},labelColor:{get:function(){return this._label.fillColor},set:function(e){this._label.fillColor=e,this._polyline.show=this._label.show&&e.alpha>0}},labelOutlineColor:{get:function(){return this._label.outlineColor},set:function(e){this._label.outlineColor=e}},labelOutlineWidth:{get:function(){return this._label.outlineWidth},set:function(e){this._label.outlineWidth=e}},font:{get:function(){return this._label.font},set:function(e){this._label.font=e}},labelStyle:{get:function(){return this._label.style},set:function(e){this._label.style=e}},labelText:{get:function(){return this._label.text},set:function(e){u(e)||(e=""),this._label.text=e}},backgroundColor:{get:function(){return this._label.backgroundColor},set:function(e){this._label.backgroundColor=e}},backgroundPadding:{get:function(){return this._label.backgroundPadding},set:function(e){this._label.backgroundPadding=e}},backgroundEnabled:{get:function(){return this._label.showBackground},set:function(e){this._label.showBackground=e}},scaleByDistance:{get:function(){return this._label.scaleByDistance},set:function(e){this._label.scaleByDistance=e,this._billboard.scaleByDistance=e}},translucencyByDistance:{get:function(){return this._label.translucencyByDistance},set:function(e){this._label.translucencyByDistance=e,this._billboard.translucencyByDistance=e}},distanceDisplayCondition:{get:function(){return this._label.distanceDisplayCondition},set:function(e){this._label.distanceDisplayCondition=e,this._polyline.distanceDisplayCondition=e,this._billboard.distanceDisplayCondition=e}},heightOffset:{get:function(){return this._heightOffset},set:function(e){let t=x(this._heightOffset,0),n=this._content.tileset.ellipsoid,i=n.cartesianToCartographic(this._billboard.position,rje);i.height=i.height-t+e;let o=n.cartographicToCartesian(i);this._billboard.position=o,this._label.position=this._billboard.position,this._polyline.positions=[this._polyline.positions[0],o],this._heightOffset=e}},anchorLineEnabled:{get:function(){return this._polyline.show},set:function(e){this._polyline.show=e}},anchorLineColor:{get:function(){return this._polyline.material.uniforms.color},set:function(e){this._polyline.material.uniforms.color=G.clone(e,this._polyline.material.uniforms.color)}},image:{get:function(){return this._billboardImage},set:function(e){let t=this._billboardImage!==e;this._billboardImage=e,t&&jA(this)}},disableDepthTestDistance:{get:function(){return this._label.disableDepthTestDistance},set:function(e){this._label.disableDepthTestDistance=e,this._billboard.disableDepthTestDistance=e}},horizontalOrigin:{get:function(){return this._billboard.horizontalOrigin},set:function(e){this._billboard.horizontalOrigin=e}},verticalOrigin:{get:function(){return this._billboard.verticalOrigin},set:function(e){this._billboard.verticalOrigin=e}},labelHorizontalOrigin:{get:function(){return this._label.horizontalOrigin},set:function(e){this._label.horizontalOrigin=e}},labelVerticalOrigin:{get:function(){return this._label.verticalOrigin},set:function(e){this._label.verticalOrigin=e}},content:{get:function(){return this._content}},tileset:{get:function(){return this._content.tileset}},primitive:{get:function(){return this._content.tileset}},pickIds:{get:function(){let e=this._pickIds;return e[0]=this._billboard.pickId,e[1]=this._label.pickId,e[2]=this._polyline.pickId,e}}});aa.defaultColor=G.WHITE;aa.defaultPointOutlineColor=G.BLACK;aa.defaultPointOutlineWidth=0;aa.defaultPointSize=8;function jA(e){let t=e._billboard;if(u(e._billboardImage)&&e._billboardImage!==t.image){t.image=e._billboardImage;return}if(u(e._billboardImage))return;let n=x(e._color,aa.defaultColor),i=x(e._pointOutlineColor,aa.defaultPointOutlineColor),o=x(e._pointOutlineWidth,aa.defaultPointOutlineWidth),r=x(e._pointSize,aa.defaultPointSize),s=e._billboardColor,a=e._billboardOutlineColor,c=e._billboardOutlineWidth,l=e._billboardSize;if(G.equals(n,s)&&G.equals(i,a)&&o===c&&r===l)return;e._billboardColor=G.clone(n,e._billboardColor),e._billboardOutlineColor=G.clone(i,e._billboardOutlineColor),e._billboardOutlineWidth=o,e._billboardSize=r;let f=n.alpha,d=n.toCssColorString(),p=i.toCssColorString(),g=JSON.stringify([d,r,p,o]);t.setImage(g,WA(f,d,p,o,r))}aa.prototype.hasProperty=function(e){return this._content.batchTable.hasProperty(this._batchId,e)};aa.prototype.getPropertyIds=function(e){return this._content.batchTable.getPropertyIds(this._batchId,e)};aa.prototype.getProperty=function(e){return this._content.batchTable.getProperty(this._batchId,e)};aa.prototype.getPropertyInherited=function(e){return ta.getPropertyInherited(this._content,this._batchId,e)};aa.prototype.setProperty=function(e,t){this._content.batchTable.setProperty(this._batchId,e,t),this._content.featurePropertiesDirty=!0};aa.prototype.isExactClass=function(e){return this._content.batchTable.isExactClass(this._batchId,e)};aa.prototype.isClass=function(e){return this._content.batchTable.isClass(this._batchId,e)};aa.prototype.getExactClassName=function(){return this._content.batchTable.getExactClassName(this._batchId)};var Vg=aa;function sje(e,t,n,i,o){let r=e.measureText(t);if(!!/\S/.test(t)){let a=document.defaultView.getComputedStyle(e.canvas).getPropertyValue("font-size").replace("px",""),c=document.createElement("canvas"),l=100,f=r.width+l|0,d=3*a,p=d/2;c.width=f,c.height=d;let g=c.getContext("2d");g.font=n,g.fillStyle="white",g.fillRect(0,0,c.width+1,c.height+1),i&&(g.strokeStyle="black",g.lineWidth=e.lineWidth,g.strokeText(t,l/2,p)),o&&(g.fillStyle="black",g.fillText(t,l/2,p));let m=g.getImageData(0,0,f,d).data,y=m.length,b=f*4,C,A,T,E;for(C=0;C<y;++C)if(m[C]!==255){T=C/b|0;break}for(C=y-1;C>=0;--C)if(m[C]!==255){E=C/b|0;break}let v=-1;for(C=0;C<f&&v===-1;++C)for(A=0;A<d;++A){let D=C*4+A*b;if(m[D]!==255||m[D+1]!==255||m[D+2]!==255||m[D+3]!==255){v=C;break}}return{width:r.width,height:E-T,ascent:p-T,descent:E-p,minx:v-l/2}}return{width:r.width,height:0,ascent:0,descent:0,minx:0}}var Ex;function aje(e,t){if(e==="")return;t=x(t,x.EMPTY_OBJECT);let n=x(t.font,"10px sans-serif"),i=x(t.stroke,!1),o=x(t.fill,!0),r=x(t.strokeWidth,1),s=x(t.backgroundColor,G.TRANSPARENT),a=x(t.padding,0),c=a*2,l=document.createElement("canvas");l.width=1,l.height=1,l.style.font=n;let f=l.getContext("2d",{willReadFrequently:!0});u(Ex)||(u(f.imageSmoothingEnabled)?Ex="imageSmoothingEnabled":u(f.mozImageSmoothingEnabled)?Ex="mozImageSmoothingEnabled":u(f.webkitImageSmoothingEnabled)?Ex="webkitImageSmoothingEnabled":u(f.msImageSmoothingEnabled)&&(Ex="msImageSmoothingEnabled")),f.font=n,f.lineJoin="round",f.lineWidth=r,f[Ex]=!1,l.style.visibility="hidden",document.body.appendChild(l);let d=sje(f,e,n,i,o);l.dimensions=d,document.body.removeChild(l),l.style.visibility="";let p=-d.minx,g=Math.ceil(d.width)+p+c,m=d.height+c,y=m-d.ascent+a,b=m-y+c;if(l.width=g,l.height=m,f.font=n,f.lineJoin="round",f.lineWidth=r,f[Ex]=!1,s!==G.TRANSPARENT&&(f.fillStyle=s.toCssColorString(),f.fillRect(0,0,l.width,l.height)),i){let C=x(t.strokeColor,G.BLACK);f.strokeStyle=C.toCssColorString(),f.strokeText(e,p+a,b)}if(o){let C=x(t.fillColor,G.WHITE);f.fillStyle=C.toCssColorString(),f.fillText(e,p+a,b)}return l}var qA=aje;var uce=Dr(ice(),1);var lje={FILL:0,OUTLINE:1,FILL_AND_OUTLINE:2},$o=Object.freeze(lje);var oce={},rce=0,uje=256,fje=new G(.165,.165,.165,.8),dje=new H(7,5),ls=Object.freeze({LTR:0,RTL:1,WEAK:2,BRACKETS:3});function Sx(e){!e._rebindAllGlyphs&&!e._repositionAllGlyphs&&e._labelCollection._labelsToUpdate.push(e),e._rebindAllGlyphs=!0}function Lw(e){!e._rebindAllGlyphs&&!e._repositionAllGlyphs&&e._labelCollection._labelsToUpdate.push(e),e._repositionAllGlyphs=!0}function Nw(e,t){return document.defaultView.getComputedStyle(e,null).getPropertyValue(t)}function ace(e){let t=oce[e._font];if(!u(t)){let n=document.createElement("div");n.style.position="absolute",n.style.opacity=0,n.style.font=e._font,document.body.appendChild(n);let i=parseFloat(Nw(n,"line-height"));isNaN(i)&&(i=void 0),t={family:Nw(n,"font-family"),size:Nw(n,"font-size").replace("px",""),style:Nw(n,"font-style"),weight:Nw(n,"font-weight"),lineHeight:i},document.body.removeChild(n),rce<uje&&(oce[e._font]=t,rce++)}e._fontFamily=t.family,e._fontSize=t.size,e._fontStyle=t.style,e._fontWeight=t.weight,e._lineHeight=t.lineHeight}function Mp(e,t){e=x(e,x.EMPTY_OBJECT);let n=e.translucencyByDistance,i=e.pixelOffsetScaleByDistance,o=e.scaleByDistance,r=e.distanceDisplayCondition;u(n)&&(n=kt.clone(n)),u(i)&&(i=kt.clone(i)),u(o)&&(o=kt.clone(o)),u(r)&&(r=Nt.clone(r)),this._renderedText=void 0,this._text=void 0,this._show=x(e.show,!0),this._font=x(e.font,"30px sans-serif"),this._fillColor=G.clone(x(e.fillColor,G.WHITE)),this._outlineColor=G.clone(x(e.outlineColor,G.BLACK)),this._outlineWidth=x(e.outlineWidth,1),this._showBackground=x(e.showBackground,!1),this._backgroundColor=G.clone(x(e.backgroundColor,fje)),this._backgroundPadding=H.clone(x(e.backgroundPadding,dje)),this._style=x(e.style,$o.FILL),this._verticalOrigin=x(e.verticalOrigin,On.BASELINE),this._horizontalOrigin=x(e.horizontalOrigin,bi.LEFT),this._pixelOffset=H.clone(x(e.pixelOffset,H.ZERO)),this._eyeOffset=h.clone(x(e.eyeOffset,h.ZERO)),this._position=h.clone(x(e.position,h.ZERO)),this._scale=x(e.scale,1),this._id=e.id,this._translucencyByDistance=n,this._pixelOffsetScaleByDistance=i,this._scaleByDistance=o,this._heightReference=x(e.heightReference,Xe.NONE),this._distanceDisplayCondition=r,this._disableDepthTestDistance=e.disableDepthTestDistance,this._labelCollection=t,this._glyphs=[],this._backgroundBillboard=void 0,this._batchIndex=void 0,this._rebindAllGlyphs=!0,this._repositionAllGlyphs=!0,this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=void 0,this._clusterShow=!0,this.text=x(e.text,""),this._relativeSize=1,ace(this),this._updateClamping()}Object.defineProperties(Mp.prototype,{show:{get:function(){return this._show},set:function(e){if(this._show!==e){this._show=e;let t=this._glyphs;for(let i=0,o=t.length;i<o;i++){let r=t[i].billboard;u(r)&&(r.show=e)}let n=this._backgroundBillboard;u(n)&&(n.show=e)}}},position:{get:function(){return this._position},set:function(e){let t=this._position;if(!h.equals(t,e)){h.clone(e,t);let n=this._glyphs;for(let o=0,r=n.length;o<r;o++){let s=n[o].billboard;u(s)&&(s.position=e)}let i=this._backgroundBillboard;u(i)&&(i.position=e),this._updateClamping()}}},heightReference:{get:function(){return this._heightReference},set:function(e){if(e!==this._heightReference){this._heightReference=e;let t=this._glyphs;for(let i=0,o=t.length;i<o;i++){let r=t[i].billboard;u(r)&&(r.heightReference=e)}let n=this._backgroundBillboard;u(n)&&(n.heightReference=e),Lw(this),this._updateClamping()}}},text:{get:function(){return this._text},set:function(e){if(this._text!==e){this._text=e;let t=e.replace(/\u00ad/g,"");this._renderedText=Mp.enableRightToLeftDetection?yje(t):t,Sx(this)}}},font:{get:function(){return this._font},set:function(e){this._font!==e&&(this._font=e,Sx(this),ace(this))}},fillColor:{get:function(){return this._fillColor},set:function(e){let t=this._fillColor;G.equals(t,e)||(G.clone(e,t),Sx(this))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){let t=this._outlineColor;G.equals(t,e)||(G.clone(e,t),Sx(this))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,Sx(this))}},showBackground:{get:function(){return this._showBackground},set:function(e){this._showBackground!==e&&(this._showBackground=e,Sx(this))}},backgroundColor:{get:function(){return this._backgroundColor},set:function(e){let t=this._backgroundColor;if(!G.equals(t,e)){G.clone(e,t);let n=this._backgroundBillboard;u(n)&&(n.color=t)}}},backgroundPadding:{get:function(){return this._backgroundPadding},set:function(e){let t=this._backgroundPadding;H.equals(t,e)||(H.clone(e,t),Lw(this))}},style:{get:function(){return this._style},set:function(e){this._style!==e&&(this._style=e,Sx(this))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){let t=this._pixelOffset;if(!H.equals(t,e)){H.clone(e,t);let n=this._glyphs;for(let o=0,r=n.length;o<r;o++){let s=n[o];u(s.billboard)&&(s.billboard.pixelOffset=e)}let i=this._backgroundBillboard;u(i)&&(i.pixelOffset=e)}}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){let t=this._translucencyByDistance;if(!kt.equals(t,e)){this._translucencyByDistance=kt.clone(e,t);let n=this._glyphs;for(let o=0,r=n.length;o<r;o++){let s=n[o];u(s.billboard)&&(s.billboard.translucencyByDistance=e)}let i=this._backgroundBillboard;u(i)&&(i.translucencyByDistance=e)}}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){let t=this._pixelOffsetScaleByDistance;if(!kt.equals(t,e)){this._pixelOffsetScaleByDistance=kt.clone(e,t);let n=this._glyphs;for(let o=0,r=n.length;o<r;o++){let s=n[o];u(s.billboard)&&(s.billboard.pixelOffsetScaleByDistance=e)}let i=this._backgroundBillboard;u(i)&&(i.pixelOffsetScaleByDistance=e)}}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){let t=this._scaleByDistance;if(!kt.equals(t,e)){this._scaleByDistance=kt.clone(e,t);let n=this._glyphs;for(let o=0,r=n.length;o<r;o++){let s=n[o];u(s.billboard)&&(s.billboard.scaleByDistance=e)}let i=this._backgroundBillboard;u(i)&&(i.scaleByDistance=e)}}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){let t=this._eyeOffset;if(!h.equals(t,e)){h.clone(e,t);let n=this._glyphs;for(let o=0,r=n.length;o<r;o++){let s=n[o];u(s.billboard)&&(s.billboard.eyeOffset=e)}let i=this._backgroundBillboard;u(i)&&(i.eyeOffset=e)}}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){this._horizontalOrigin!==e&&(this._horizontalOrigin=e,Lw(this))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){if(this._verticalOrigin!==e){this._verticalOrigin=e;let t=this._glyphs;for(let i=0,o=t.length;i<o;i++){let r=t[i];u(r.billboard)&&(r.billboard.verticalOrigin=e)}let n=this._backgroundBillboard;u(n)&&(n.verticalOrigin=e),Lw(this)}}},scale:{get:function(){return this._scale},set:function(e){if(this._scale!==e){this._scale=e;let t=this._glyphs;for(let i=0,o=t.length;i<o;i++){let r=t[i];u(r.billboard)&&(r.billboard.scale=e*this._relativeSize)}let n=this._backgroundBillboard;u(n)&&(n.scale=e*this._relativeSize),Lw(this)}}},totalScale:{get:function(){return this._scale*this._relativeSize}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(!Nt.equals(e,this._distanceDisplayCondition)){this._distanceDisplayCondition=Nt.clone(e,this._distanceDisplayCondition);let t=this._glyphs;for(let i=0,o=t.length;i<o;i++){let r=t[i];u(r.billboard)&&(r.billboard.distanceDisplayCondition=e)}let n=this._backgroundBillboard;u(n)&&(n.distanceDisplayCondition=e)}}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){if(this._disableDepthTestDistance!==e){this._disableDepthTestDistance=e;let t=this._glyphs;for(let i=0,o=t.length;i<o;i++){let r=t[i];u(r.billboard)&&(r.billboard.disableDepthTestDistance=e)}let n=this._backgroundBillboard;u(n)&&(n.disableDepthTestDistance=e)}}},id:{get:function(){return this._id},set:function(e){if(this._id!==e){this._id=e;let t=this._glyphs;for(let i=0,o=t.length;i<o;i++){let r=t[i];u(r.billboard)&&(r.billboard.id=e)}let n=this._backgroundBillboard;u(n)&&(n.id=e)}}},pickId:{get:function(){if(!(this._glyphs.length===0||!u(this._glyphs[0].billboard)))return this._glyphs[0].billboard.pickId}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=h.clone(e,this._actualClampedPosition);let t=this._glyphs;for(let i=0,o=t.length;i<o;i++){let r=t[i];u(r.billboard)&&(r.billboard._clampedPosition=e)}let n=this._backgroundBillboard;u(n)&&(n._clampedPosition=e)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){if(this._clusterShow!==e){this._clusterShow=e;let t=this._glyphs;for(let i=0,o=t.length;i<o;i++){let r=t[i];u(r.billboard)&&(r.billboard.clusterShow=e)}let n=this._backgroundBillboard;u(n)&&(n.clusterShow=e)}}}});Mp.prototype._updateClamping=function(){po._updateClamping(this._labelCollection,this)};Mp.prototype.computeScreenSpacePosition=function(e,t){u(t)||(t=new H);let i=this._labelCollection.modelMatrix,o=u(this._actualClampedPosition)?this._actualClampedPosition:this._position;return po._computeScreenSpacePosition(i,o,this._eyeOffset,this._pixelOffset,e,t)};Mp.getScreenSpaceBoundingBox=function(e,t,n){let i=0,o=0,r=0,s=0,a=e.totalScale,c=e._backgroundBillboard;if(u(c))i=t.x+c._translate.x,o=t.y-c._translate.y,r=c.width*a,s=c.height*a,e.verticalOrigin===On.BOTTOM||e.verticalOrigin===On.BASELINE?o-=s:e.verticalOrigin===On.CENTER&&(o-=s*.5);else{i=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY;let l=0,f=0,d=e._glyphs,p=d.length;for(let g=0;g<p;++g){let m=d[g],y=m.billboard;if(!u(y))continue;let b=t.x+y._translate.x,C=t.y-y._translate.y,A=m.dimensions.width*a,T=m.dimensions.height*a;e.verticalOrigin===On.BOTTOM||e.verticalOrigin===On.BASELINE?C-=T:e.verticalOrigin===On.CENTER&&(C-=T*.5),e._verticalOrigin===On.TOP?C+=sa.PADDING*a:(e._verticalOrigin===On.BOTTOM||e._verticalOrigin===On.BASELINE)&&(C-=sa.PADDING*a),i=Math.min(i,b),o=Math.min(o,C),l=Math.max(l,b+A),f=Math.max(f,C+T)}r=l-i,s=f-o}return u(n)||(n=new qe),n.x=i,n.y=o,n.width=r,n.height=s,n};Mp.prototype.equals=function(e){return this===e||u(e)&&this._show===e._show&&this._scale===e._scale&&this._outlineWidth===e._outlineWidth&&this._showBackground===e._showBackground&&this._style===e._style&&this._verticalOrigin===e._verticalOrigin&&this._horizontalOrigin===e._horizontalOrigin&&this._heightReference===e._heightReference&&this._renderedText===e._renderedText&&this._font===e._font&&h.equals(this._position,e._position)&&G.equals(this._fillColor,e._fillColor)&&G.equals(this._outlineColor,e._outlineColor)&&G.equals(this._backgroundColor,e._backgroundColor)&&H.equals(this._backgroundPadding,e._backgroundPadding)&&H.equals(this._pixelOffset,e._pixelOffset)&&h.equals(this._eyeOffset,e._eyeOffset)&&kt.equals(this._translucencyByDistance,e._translucencyByDistance)&&kt.equals(this._pixelOffsetScaleByDistance,e._pixelOffsetScaleByDistance)&&kt.equals(this._scaleByDistance,e._scaleByDistance)&&Nt.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance&&this._id===e._id};Mp.prototype.isDestroyed=function(){return!1};Mp.enableRightToLeftDetection=!1;function hje(e,t){let n=/[a-zA-Z0-9]/,i=/[()[\]{}<>]/,o=[],r="",s=ls.LTR,a="",c=e.length;for(let l=0;l<c;++l){let f=e.charAt(l);t.test(f)?a=ls.RTL:n.test(f)?a=ls.LTR:i.test(f)?a=ls.BRACKETS:a=ls.WEAK,l===0&&(s=a),s===a&&a!==ls.BRACKETS?r+=f:(r!==""&&o.push({Type:s,Word:r}),s=a,r=f)}return o.push({Type:a,Word:r}),o}function mje(e){return e.split("").reverse().join("")}function Fw(e,t,n){return e.slice(0,t)+n+e.slice(t)}function pje(e){switch(e){case"(":return")";case")":return"(";case"[":return"]";case"]":return"[";case"{":return"}";case"}":return"{";case"<":return">";case">":return"<"}}var _je="\u05D0-\u05EA",gje="\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF",sce=new RegExp(`[${_je}${gje}]`);function yje(e){let t=e.split(`
`),n="";for(let i=0;i<t.length;i++){let o=t[i],r=sce.test(o.charAt(0)),s=hje(o,sce),a=0,c="";for(let l=0;l<s.length;++l){let f=s[l],d=f.Type===ls.BRACKETS?pje(f.Word):mje(f.Word);r?f.Type===ls.RTL?(c=d+c,a=0):f.Type===ls.LTR?(c=Fw(c,a,f.Word),a+=f.Word.length):(f.Type===ls.WEAK||f.Type===ls.BRACKETS)&&(f.Type===ls.WEAK&&s[l-1].Type===ls.BRACKETS?c=d+c:s[l-1].Type===ls.RTL?(c=d+c,a=0):s.length>l+1?s[l+1].Type===ls.RTL?(c=d+c,a=0):(c=Fw(c,a,f.Word),a+=f.Word.length):c=Fw(c,0,d)):f.Type===ls.RTL?c=Fw(c,a,d):f.Type===ls.LTR?(c+=f.Word,a=c.length):(f.Type===ls.WEAK||f.Type===ls.BRACKETS)&&(l>0&&s[l-1].Type===ls.RTL?s.length>l+1?s[l+1].Type===ls.RTL?c=Fw(c,a,d):(c+=f.Word,a=c.length):c+=f.Word:(c+=f.Word,a=c.length))}n+=c,i<t.length-1&&(n+=`
`)}return n}var vx=Mp;var fce=Dr(cce(),1);function bje(){this.textureInfo=void 0,this.dimensions=void 0,this.billboard=void 0}function Cje(e,t,n){this.labelCollection=e,this.index=t,this.dimensions=n}var Aje=1.2,dce="ID_WHITE_PIXEL",b7=new H(4,4),Tje=new qe(1,1,1,1);function Eje(e){let t=document.createElement("canvas");t.width=b7.x,t.height=b7.y;let n=t.getContext("2d");return n.fillStyle="#fff",n.fillRect(0,0,t.width,t.height),e.addImage(dce,t)}var Af={};function Sje(e,t,n,i,o,r,s){return Af.font=t,Af.fillColor=n,Af.strokeColor=i,Af.strokeWidth=o,Af.padding=sa.PADDING,s===On.CENTER?Af.textBaseline="middle":s===On.TOP?Af.textBaseline="top":Af.textBaseline="bottom",Af.fill=r===$o.FILL||r===$o.FILL_AND_OUTLINE,Af.stroke=r===$o.OUTLINE||r===$o.FILL_AND_OUTLINE,Af.backgroundColor=G.BLACK,qA(e,Af)}function C7(e,t){t.textureInfo=void 0,t.dimensions=void 0;let n=t.billboard;u(n)&&(n.show=!1,n.image=void 0,u(n._removeCallbackFunc)&&(n._removeCallbackFunc(),n._removeCallbackFunc=void 0),e._spareBillboards.push(n),t.billboard=void 0)}function vje(e,t,n,i){i.index=e.addImageSync(t,n)}var wje=new fce.default;function Dje(e,t){let n=t._renderedText,i=wje.splitGraphemes(n),o=i.length,r=t._glyphs,s=r.length,a,c,l;if(t._relativeSize=t._fontSize/sa.FONT_SIZE,o<s)for(c=o;c<s;++c)C7(e,r[c]);r.length=o;let f=t.show&&t._showBackground&&n.split(`
`).join("").length>0,d=t._backgroundBillboard,p=e._backgroundBillboardCollection;f?(u(d)||(d=p.add({collection:e,image:dce,imageSubRegion:Tje}),t._backgroundBillboard=d),d.color=t._backgroundColor,d.show=t._show,d.position=t._position,d.eyeOffset=t._eyeOffset,d.pixelOffset=t._pixelOffset,d.horizontalOrigin=bi.LEFT,d.verticalOrigin=t._verticalOrigin,d.heightReference=t._heightReference,d.scale=t.totalScale,d.pickPrimitive=t,d.id=t._id,d.translucencyByDistance=t._translucencyByDistance,d.pixelOffsetScaleByDistance=t._pixelOffsetScaleByDistance,d.scaleByDistance=t._scaleByDistance,d.distanceDisplayCondition=t._distanceDisplayCondition,d.disableDepthTestDistance=t._disableDepthTestDistance,d.clusterShow=t.clusterShow):u(d)&&(p.remove(d),t._backgroundBillboard=d=void 0);let g=e._glyphTextureCache;for(l=0;l<o;++l){let m=i[l],y=t._verticalOrigin,b=JSON.stringify([m,t._fontFamily,t._fontStyle,t._fontWeight,+y]),C=g[b];if(!u(C)){let A=`${t._fontStyle} ${t._fontWeight} ${sa.FONT_SIZE}px ${t._fontFamily}`,T=Sje(m,A,G.WHITE,G.WHITE,0,$o.FILL,y);if(C=new Cje(e,-1,T.dimensions),g[b]=C,T.width>0&&T.height>0){let E=(0,uce.default)(T,{cutoff:sa.CUTOFF,radius:sa.RADIUS}),v=T.getContext("2d"),D=T.width,O=T.height,P=v.getImageData(0,0,D,O);for(let M=0;M<D;M++)for(let L=0;L<O;L++){let _=L*D+M,S=E[_]*255,w=_*4;P.data[w+0]=S,P.data[w+1]=S,P.data[w+2]=S,P.data[w+3]=S}v.putImageData(P,0,0),m!==" "&&vje(e._textureAtlas,b,T,C)}}if(a=r[l],u(a)?C.index===-1?C7(e,a):u(a.textureInfo)&&(a.textureInfo=void 0):(a=new bje,r[l]=a),a.textureInfo=C,a.dimensions=C.dimensions,C.index!==-1){let A=a.billboard,T=e._spareBillboards;u(A)||(T.length>0?A=T.pop():(A=e._billboardCollection.add({collection:e}),A._labelDimensions=new H,A._labelTranslate=new H),a.billboard=A),A.show=t._show,A.position=t._position,A.eyeOffset=t._eyeOffset,A.pixelOffset=t._pixelOffset,A.horizontalOrigin=bi.LEFT,A.verticalOrigin=t._verticalOrigin,A.heightReference=t._heightReference,A.scale=t.totalScale,A.pickPrimitive=t,A.id=t._id,A.image=b,A.translucencyByDistance=t._translucencyByDistance,A.pixelOffsetScaleByDistance=t._pixelOffsetScaleByDistance,A.scaleByDistance=t._scaleByDistance,A.distanceDisplayCondition=t._distanceDisplayCondition,A.disableDepthTestDistance=t._disableDepthTestDistance,A._batchIndex=t._batchIndex,A.outlineColor=t.outlineColor,t.style===$o.FILL_AND_OUTLINE?(A.color=t._fillColor,A.outlineWidth=t.outlineWidth):t.style===$o.FILL?(A.color=t._fillColor,A.outlineWidth=0):t.style===$o.OUTLINE&&(A.color=G.TRANSPARENT,A.outlineWidth=t.outlineWidth)}}t._repositionAllGlyphs=!0}function lce(e,t,n){return t===bi.CENTER?-e/2:t===bi.RIGHT?-(e+n.x):n.x}var cr=new H,Ije=new H;function Pje(e){let t=e._glyphs,n=e._renderedText,i,o,r=0,s=0,a=[],c=Number.NEGATIVE_INFINITY,l=0,f=1,d,p=t.length,g=e._backgroundBillboard,m=H.clone(u(g)?e._backgroundPadding:H.ZERO,Ije);for(m.x/=e._relativeSize,m.y/=e._relativeSize,d=0;d<p;++d)n.charAt(d)===`
`?(a.push(r),++f,r=0):(i=t[d],o=i.dimensions,l=Math.max(l,o.height-o.descent),c=Math.max(c,o.descent),r+=o.width-o.minx,d<p-1&&(r+=t[d+1].dimensions.minx),s=Math.max(s,r));a.push(r);let y=l+c,b=e.totalScale,C=e._horizontalOrigin,A=e._verticalOrigin,T=0,E=a[T],v=lce(E,C,m),D=(u(e._lineHeight)?e._lineHeight:Aje*e._fontSize)/e._relativeSize,O=D*(f-1),P=s,M=y+O;u(g)&&(P+=m.x*2,M+=m.y*2,g._labelHorizontalOrigin=C),cr.x=v*b,cr.y=0;let L=!0,_=0;for(d=0;d<p;++d)if(n.charAt(d)===`
`)++T,_+=D,E=a[T],v=lce(E,C,m),cr.x=v*b,L=!0;else if(i=t[d],o=i.dimensions,A===On.TOP?(cr.y=o.height-l-m.y,cr.y+=sa.PADDING):A===On.CENTER?cr.y=(O+o.height-l)/2:A===On.BASELINE?(cr.y=O,cr.y-=sa.PADDING):(cr.y=O+c+m.y,cr.y-=sa.PADDING),cr.y=(cr.y-o.descent-_)*b,L&&(cr.x-=sa.PADDING*b,L=!1),u(i.billboard)&&(i.billboard._setTranslate(cr),i.billboard._labelDimensions.x=P,i.billboard._labelDimensions.y=M,i.billboard._labelHorizontalOrigin=C),d<p-1){let S=t[d+1];cr.x+=(o.width-o.minx+S.dimensions.minx)*b}if(u(g)&&n.split(`
`).join("").length>0&&(C===bi.CENTER?v=-s/2-m.x:C===bi.RIGHT?v=-(s+m.x*2):v=0,cr.x=v*b,A===On.TOP?cr.y=y-l-c:A===On.CENTER?cr.y=(y-l)/2-c:A===On.BASELINE?cr.y=-m.y-c:cr.y=0,cr.y=cr.y*b,g.width=P,g.height=M,g._setTranslate(cr),g._labelTranslate=H.clone(cr,g._labelTranslate)),tf(e.heightReference))for(d=0;d<p;++d){i=t[d];let S=i.billboard;u(S)&&(S._labelTranslate=H.clone(cr,S._labelTranslate))}}function hce(e,t){let n=t._glyphs;for(let i=0,o=n.length;i<o;++i)C7(e,n[i]);u(t._backgroundBillboard)&&(e._backgroundBillboardCollection.remove(t._backgroundBillboard),t._backgroundBillboard=void 0),t._labelCollection=void 0,u(t._removeCallbackFunc)&&t._removeCallbackFunc(),ue(t)}function tm(e){e=x(e,x.EMPTY_OBJECT),this._scene=e.scene,this._batchTable=e.batchTable,this._textureAtlas=void 0,this._backgroundTextureAtlas=void 0,this._backgroundBillboardCollection=new Cf({scene:this._scene}),this._backgroundBillboardCollection.destroyTextureAtlas=!1,this._billboardCollection=new Cf({scene:this._scene,batchTable:this._batchTable}),this._billboardCollection.destroyTextureAtlas=!1,this._billboardCollection._sdf=!0,this._spareBillboards=[],this._glyphTextureCache={},this._labels=[],this._labelsToUpdate=[],this._totalGlyphCount=0,this._highlightColor=G.clone(G.WHITE),this.show=x(e.show,!0),this.modelMatrix=F.clone(x(e.modelMatrix,F.IDENTITY)),this.debugShowBoundingVolume=x(e.debugShowBoundingVolume,!1),this.blendOption=x(e.blendOption,Ro.OPAQUE_AND_TRANSLUCENT)}Object.defineProperties(tm.prototype,{length:{get:function(){return this._labels.length}}});tm.prototype.add=function(e){let t=new vx(e,this);return this._labels.push(t),this._labelsToUpdate.push(t),t};tm.prototype.remove=function(e){if(u(e)&&e._labelCollection===this){let t=this._labels.indexOf(e);if(t!==-1)return this._labels.splice(t,1),hce(this,e),!0}return!1};tm.prototype.removeAll=function(){let e=this._labels;for(let t=0,n=e.length;t<n;++t)hce(this,e[t]);e.length=0};tm.prototype.contains=function(e){return u(e)&&e._labelCollection===this};tm.prototype.get=function(e){return this._labels[e]};tm.prototype.update=function(e){if(!this.show)return;let t=this._billboardCollection,n=this._backgroundBillboardCollection;t.modelMatrix=this.modelMatrix,t.debugShowBoundingVolume=this.debugShowBoundingVolume,n.modelMatrix=this.modelMatrix,n.debugShowBoundingVolume=this.debugShowBoundingVolume;let i=e.context;u(this._textureAtlas)||(this._textureAtlas=new Tx({context:i}),t.textureAtlas=this._textureAtlas),u(this._backgroundTextureAtlas)||(this._backgroundTextureAtlas=new Tx({context:i,initialSize:b7}),n.textureAtlas=this._backgroundTextureAtlas,Eje(this._backgroundTextureAtlas));let o=this._labelsToUpdate.length;for(let s=0;s<o;++s){let a=this._labelsToUpdate[s];if(a.isDestroyed())continue;let c=a._glyphs.length;a._rebindAllGlyphs&&(Dje(this,a),a._rebindAllGlyphs=!1),a._repositionAllGlyphs&&(Pje(a),a._repositionAllGlyphs=!1);let l=a._glyphs.length-c;this._totalGlyphCount+=l}let r=n.length>0?Ro.TRANSLUCENT:this.blendOption;t.blendOption=r,n.blendOption=r,t._highlightColor=this._highlightColor,n._highlightColor=this._highlightColor,this._labelsToUpdate.length=0,n.update(e),t.update(e)};tm.prototype.isDestroyed=function(){return!1};tm.prototype.destroy=function(){return this.removeAll(),this._billboardCollection=this._billboardCollection.destroy(),this._textureAtlas=this._textureAtlas&&this._textureAtlas.destroy(),this._backgroundBillboardCollection=this._backgroundBillboardCollection.destroy(),this._backgroundTextureAtlas=this._backgroundTextureAtlas&&this._backgroundTextureAtlas.destroy(),ue(this)};var Lp=tm;var _B=`in vec3 position3DHigh;
in vec3 position3DLow;
in vec3 position2DHigh;
in vec3 position2DLow;
in vec3 prevPosition3DHigh;
in vec3 prevPosition3DLow;
in vec3 prevPosition2DHigh;
in vec3 prevPosition2DLow;
in vec3 nextPosition3DHigh;
in vec3 nextPosition3DLow;
in vec3 nextPosition2DHigh;
in vec3 nextPosition2DLow;
in vec4 texCoordExpandAndBatchIndex;

out vec2  v_st;
out float v_width;
out vec4 v_pickColor;
out float v_polylineAngle;

void main()
{
    float texCoord = texCoordExpandAndBatchIndex.x;
    float expandDir = texCoordExpandAndBatchIndex.y;
    bool usePrev = texCoordExpandAndBatchIndex.z < 0.0;
    float batchTableIndex = texCoordExpandAndBatchIndex.w;

    vec2 widthAndShow = batchTable_getWidthAndShow(batchTableIndex);
    float width = widthAndShow.x + 0.5;
    float show = widthAndShow.y;

    if (width < 1.0)
    {
        show = 0.0;
    }

    vec4 pickColor = batchTable_getPickColor(batchTableIndex);

    vec4 p, prev, next;
    if (czm_morphTime == 1.0)
    {
        p = czm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz);
        prev = czm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz);
        next = czm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz);
    }
    else if (czm_morphTime == 0.0)
    {
        p = czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy);
        prev = czm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy);
        next = czm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy);
    }
    else
    {
        p = czm_columbusViewMorph(
                czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy),
                czm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz),
                czm_morphTime);
        prev = czm_columbusViewMorph(
                czm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy),
                czm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz),
                czm_morphTime);
        next = czm_columbusViewMorph(
                czm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy),
                czm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz),
                czm_morphTime);
    }

    #ifdef DISTANCE_DISPLAY_CONDITION
        vec3 centerHigh = batchTable_getCenterHigh(batchTableIndex);
        vec4 centerLowAndRadius = batchTable_getCenterLowAndRadius(batchTableIndex);
        vec3 centerLow = centerLowAndRadius.xyz;
        float radius = centerLowAndRadius.w;
        vec2 distanceDisplayCondition = batchTable_getDistanceDisplayCondition(batchTableIndex);

        float lengthSq;
        if (czm_sceneMode == czm_sceneMode2D)
        {
            lengthSq = czm_eyeHeight2D.y;
        }
        else
        {
            vec4 center = czm_translateRelativeToEye(centerHigh.xyz, centerLow.xyz);
            lengthSq = max(0.0, dot(center.xyz, center.xyz) - radius * radius);
        }

        float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x;
        float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y;
        if (lengthSq < nearSq || lengthSq > farSq)
        {
            show = 0.0;
        }
    #endif

    float polylineAngle;
    vec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, polylineAngle);
    gl_Position = czm_viewportOrthographic * positionWC * show;

    v_st.s = texCoord;
    v_st.t = czm_writeNonPerspective(clamp(expandDir, 0.0, 1.0), gl_Position.w);

    v_width = width;
    v_pickColor = pickColor;
    v_polylineAngle = polylineAngle;
}
`;var zc={};zc.numberOfPoints=function(e,t,n){let i=h.distance(e,t);return Math.ceil(i/n)};zc.numberOfPointsRhumbLine=function(e,t,n){let i=Math.pow(e.longitude-t.longitude,2)+Math.pow(e.latitude-t.latitude,2);return Math.max(1,Math.ceil(Math.sqrt(i/(n*n))))};var Rje=new de;zc.extractHeights=function(e,t){let n=e.length,i=new Array(n);for(let o=0;o<n;o++){let r=e[o];i[o]=t.cartesianToCartographic(r,Rje).height}return i};var Oje=new F,Mje=new h,mce=new h,Lje=new cn(h.UNIT_X,0),pce=new h,Nje=new cn(h.UNIT_X,0),Fje=new h,Bje=new h,T7=[];function gce(e,t,n){let i=T7;i.length=e;let o;if(t===n){for(o=0;o<e;o++)i[o]=t;return i}let s=(n-t)/e;for(o=0;o<e;o++){let a=t+o*s;i[o]=a}return i}var yB=new de,gB=new de,Ug=new h,E7=new h,kje=new h,A7=new Y_,Bw=new Ka;function Vje(e,t,n,i,o,r,s,a){let c=i.scaleToGeodeticSurface(e,E7),l=i.scaleToGeodeticSurface(t,kje),f=zc.numberOfPoints(e,t,n),d=i.cartesianToCartographic(c,yB),p=i.cartesianToCartographic(l,gB),g=gce(f,o,r);A7.setEndPoints(d,p);let m=A7.surfaceDistance/f,y=a;d.height=o;let b=i.cartographicToCartesian(d,Ug);h.pack(b,s,y),y+=3;for(let C=1;C<f;C++){let A=A7.interpolateUsingSurfaceDistance(C*m,gB);A.height=g[C],b=i.cartographicToCartesian(A,Ug),h.pack(b,s,y),y+=3}return y}function Uje(e,t,n,i,o,r,s,a){let c=i.cartesianToCartographic(e,yB),l=i.cartesianToCartographic(t,gB),f=zc.numberOfPointsRhumbLine(c,l,n);c.height=0,l.height=0;let d=gce(f,o,r);Bw.ellipsoid.equals(i)||(Bw=new Ka(void 0,void 0,i)),Bw.setEndPoints(c,l);let p=Bw.surfaceDistance/f,g=a;c.height=o;let m=i.cartographicToCartesian(c,Ug);h.pack(m,s,g),g+=3;for(let y=1;y<f;y++){let b=Bw.interpolateUsingSurfaceDistance(y*p,gB);b.height=d[y],m=i.cartographicToCartesian(b,Ug),h.pack(m,s,g),g+=3}return g}zc.wrapLongitude=function(e,t){let n=[],i=[];if(u(e)&&e.length>0){t=x(t,F.IDENTITY);let o=F.inverseTransformation(t,Oje),r=F.multiplyByPoint(o,h.ZERO,Mje),s=h.normalize(F.multiplyByPointAsVector(o,h.UNIT_Y,mce),mce),a=cn.fromPointNormal(r,s,Lje),c=h.normalize(F.multiplyByPointAsVector(o,h.UNIT_X,pce),pce),l=cn.fromPointNormal(r,c,Nje),f=1;n.push(h.clone(e[0]));let d=n[0],p=e.length;for(let g=1;g<p;++g){let m=e[g];if(cn.getPointDistance(l,d)<0||cn.getPointDistance(l,m)<0){let y=Qn.lineSegmentPlane(d,m,a,Fje);if(u(y)){let b=h.multiplyByScalar(s,5e-9,Bje);cn.getPointDistance(a,d)<0&&h.negate(b,b),n.push(h.add(y,b,new h)),i.push(f+1),h.negate(b,b),n.push(h.add(y,b,new h)),f=1}}n.push(h.clone(e[g])),f++,d=m}i.push(f)}return{positions:n,lengths:i}};zc.generateArc=function(e){u(e)||(e={});let t=e.positions,n=t.length,i=x(e.ellipsoid,ee.default),o=x(e.height,0),r=Array.isArray(o);if(n<1)return[];if(n===1){let y=i.scaleToGeodeticSurface(t[0],E7);if(o=r?o[0]:o,o!==0){let b=i.geodeticSurfaceNormal(y,Ug);h.multiplyByScalar(b,o,b),h.add(y,b,y)}return[y.x,y.y,y.z]}let s=e.minDistance;if(!u(s)){let y=x(e.granularity,R.RADIANS_PER_DEGREE);s=R.chordLength(y,i.maximumRadius)}let a=0,c;for(c=0;c<n-1;c++)a+=zc.numberOfPoints(t[c],t[c+1],s);let l=(a+1)*3,f=new Array(l),d=0;for(c=0;c<n-1;c++){let y=t[c],b=t[c+1],C=r?o[c]:o,A=r?o[c+1]:o;d=Vje(y,b,s,i,C,A,f,d)}T7.length=0;let p=t[n-1],g=i.cartesianToCartographic(p,yB);g.height=r?o[n-1]:o;let m=i.cartographicToCartesian(g,Ug);return h.pack(m,f,l-3),f};var _ce=new de,zje=new de;zc.generateRhumbArc=function(e){u(e)||(e={});let t=e.positions,n=t.length,i=x(e.ellipsoid,ee.default),o=x(e.height,0),r=Array.isArray(o);if(n<1)return[];if(n===1){let C=i.scaleToGeodeticSurface(t[0],E7);if(o=r?o[0]:o,o!==0){let A=i.geodeticSurfaceNormal(C,Ug);h.multiplyByScalar(A,o,A),h.add(C,A,C)}return[C.x,C.y,C.z]}let s=x(e.granularity,R.RADIANS_PER_DEGREE),a=0,c,l=i.cartesianToCartographic(t[0],_ce),f;for(c=0;c<n-1;c++)f=i.cartesianToCartographic(t[c+1],zje),a+=zc.numberOfPointsRhumbLine(l,f,s),l=de.clone(f,_ce);let d=(a+1)*3,p=new Array(d),g=0;for(c=0;c<n-1;c++){let C=t[c],A=t[c+1],T=r?o[c]:o,E=r?o[c+1]:o;g=Uje(C,A,s,i,T,E,p,g)}T7.length=0;let m=t[n-1],y=i.cartesianToCartographic(m,yB);y.height=r?o[n-1]:o;let b=i.cartographicToCartesian(y,Ug);return h.pack(b,p,d-3),p};zc.generateCartesianArc=function(e){let t=zc.generateArc(e),n=t.length/3,i=new Array(n);for(let o=0;o<n;o++)i[o]=h.unpack(t,o*3);return i};zc.generateCartesianRhumbArc=function(e){let t=zc.generateRhumbArc(e),n=t.length/3,i=new Array(n);for(let o=0;o<n;o++)i[o]=h.unpack(t,o*3);return i};var Fi=zc;function fu(e,t){e=x(e,x.EMPTY_OBJECT),this._show=x(e.show,!0),this._width=x(e.width,1),this._loop=x(e.loop,!1),this._distanceDisplayCondition=e.distanceDisplayCondition,this._material=e.material,u(this._material)||(this._material=Zi.fromType(Zi.ColorType,{color:new G(1,1,1,1)}));let n=e.positions;u(n)||(n=[]),this._positions=n,this._actualPositions=Eo(n,h.equalsEpsilon),this._loop&&this._actualPositions.length>2&&(this._actualPositions===this._positions&&(this._actualPositions=n.slice()),this._actualPositions.push(h.clone(this._actualPositions[0]))),this._length=this._actualPositions.length,this._id=e.id;let i;u(t)&&(i=F.clone(t.modelMatrix)),this._modelMatrix=i,this._segments=Fi.wrapLongitude(this._actualPositions,i),this._actualLength=void 0,this._propertiesChanged=new Uint32Array(xce),this._polylineCollection=t,this._dirty=!1,this._pickId=void 0,this._boundingVolume=ae.fromPoints(this._actualPositions),this._boundingVolumeWC=ae.transform(this._boundingVolume,this._modelMatrix),this._boundingVolume2D=new ae}var yce=fu.POSITION_INDEX=0,Hje=fu.SHOW_INDEX=1,Gje=fu.WIDTH_INDEX=2,Wje=fu.MATERIAL_INDEX=3,kw=fu.POSITION_SIZE_INDEX=4,jje=fu.DISTANCE_DISPLAY_CONDITION=5,xce=fu.NUMBER_OF_PROPERTIES=6;function Np(e,t){++e._propertiesChanged[t];let n=e._polylineCollection;u(n)&&(n._updatePolyline(e,t),e._dirty=!0)}Object.defineProperties(fu.prototype,{show:{get:function(){return this._show},set:function(e){e!==this._show&&(this._show=e,Np(this,Hje))}},positions:{get:function(){return this._positions},set:function(e){let t=Eo(e,h.equalsEpsilon);this._loop&&t.length>2&&(t===e&&(t=e.slice()),t.push(h.clone(t[0]))),(this._actualPositions.length!==t.length||this._actualPositions.length!==this._length)&&Np(this,kw),this._positions=e,this._actualPositions=t,this._length=t.length,this._boundingVolume=ae.fromPoints(this._actualPositions,this._boundingVolume),this._boundingVolumeWC=ae.transform(this._boundingVolume,this._modelMatrix,this._boundingVolumeWC),Np(this,yce),this.update()}},material:{get:function(){return this._material},set:function(e){this._material!==e&&(this._material=e,Np(this,Wje))}},width:{get:function(){return this._width},set:function(e){let t=this._width;e!==t&&(this._width=e,Np(this,Gje))}},loop:{get:function(){return this._loop},set:function(e){if(e!==this._loop){let t=this._actualPositions;e?t.length>2&&!h.equals(t[0],t[t.length-1])&&(t.length===this._positions.length&&(this._actualPositions=t=this._positions.slice()),t.push(h.clone(t[0]))):t.length>2&&h.equals(t[0],t[t.length-1])&&(t.length-1===this._positions.length?this._actualPositions=this._positions:t.pop()),this._loop=e,Np(this,kw)}}},id:{get:function(){return this._id},set:function(e){this._id=e,u(this._pickId)&&(this._pickId.object.id=e)}},pickId:{get:function(){return this._pickId}},isDestroyed:{get:function(){return!u(this._polylineCollection)}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){Nt.equals(e,this._distanceDisplayCondition)||(this._distanceDisplayCondition=Nt.clone(e,this._distanceDisplayCondition),Np(this,jje))}}});fu.prototype.update=function(){let e=F.IDENTITY;u(this._polylineCollection)&&(e=this._polylineCollection.modelMatrix);let t=this._segments.positions.length,n=this._segments.lengths,i=this._propertiesChanged[yce]>0||this._propertiesChanged[kw]>0;if((!F.equals(e,this._modelMatrix)||i)&&(this._segments=Fi.wrapLongitude(this._actualPositions,e),this._boundingVolumeWC=ae.transform(this._boundingVolume,e,this._boundingVolumeWC)),this._modelMatrix=F.clone(e,this._modelMatrix),this._segments.positions.length!==t)Np(this,kw);else{let o=n.length;for(let r=0;r<o;++r)if(n[r]!==this._segments.lengths[r]){Np(this,kw);break}}};fu.prototype.getPickId=function(e){return u(this._pickId)||(this._pickId=e.createPickId({primitive:this,collection:this._polylineCollection,id:this._id})),this._pickId};fu.prototype._clean=function(){this._dirty=!1;let e=this._propertiesChanged;for(let t=0;t<xce-1;++t)e[t]=0};fu.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._material=this._material&&this._material.destroy(),this._polylineCollection=void 0};var Td=fu;var qje=Td.SHOW_INDEX,Yje=Td.WIDTH_INDEX,v7=Td.POSITION_INDEX,Xje=Td.MATERIAL_INDEX,bce=Td.POSITION_SIZE_INDEX,Kje=Td.DISTANCE_DISPLAY_CONDITION,wce=Td.NUMBER_OF_PROPERTIES,El={texCoordExpandAndBatchIndex:0,position3DHigh:1,position3DLow:2,position2DHigh:3,position2DLow:4,prevPosition3DHigh:5,prevPosition3DLow:6,prevPosition2DHigh:7,prevPosition2DLow:8,nextPosition3DHigh:9,nextPosition3DLow:10,nextPosition2DHigh:11,nextPosition2DLow:12};function Ed(e){e=x(e,x.EMPTY_OBJECT),this.show=x(e.show,!0),this.modelMatrix=F.clone(x(e.modelMatrix,F.IDENTITY)),this._modelMatrix=F.clone(F.IDENTITY),this.debugShowBoundingVolume=x(e.debugShowBoundingVolume,!1),this._opaqueRS=void 0,this._translucentRS=void 0,this._colorCommands=[],this._polylinesUpdated=!1,this._polylinesRemoved=!1,this._createVertexArray=!1,this._propertiesChanged=new Uint32Array(wce),this._polylines=[],this._polylineBuckets={},this._positionBufferUsage={bufferUsage:ke.STATIC_DRAW,frameCount:0},this._mode=void 0,this._polylinesToUpdate=[],this._vertexArrays=[],this._positionBuffer=void 0,this._texCoordExpandAndBatchIndexBuffer=void 0,this._batchTable=void 0,this._createBatchTable=!1,this._useHighlightColor=!1,this._highlightColor=G.clone(G.WHITE);let t=this;this._uniformMap={u_highlightColor:function(){return t._highlightColor}}}Object.defineProperties(Ed.prototype,{length:{get:function(){return w7(this),this._polylines.length}}});Ed.prototype.add=function(e){let t=new Td(e,this);return t._index=this._polylines.length,this._polylines.push(t),this._createVertexArray=!0,this._createBatchTable=!0,t};Ed.prototype.remove=function(e){if(this.contains(e)){if(this._polylinesRemoved=!0,this._createVertexArray=!0,this._createBatchTable=!0,u(e._bucket)){let t=e._bucket;t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy()}return e._destroy(),!0}return!1};Ed.prototype.removeAll=function(){D7(this),Oce(this),this._polylineBuckets={},this._polylinesRemoved=!1,this._polylines.length=0,this._polylinesToUpdate.length=0,this._createVertexArray=!0};Ed.prototype.contains=function(e){return u(e)&&e._polylineCollection===this};Ed.prototype.get=function(e){return w7(this),this._polylines[e]};function Zje(e,t){u(e._batchTable)&&e._batchTable.destroy();let n=[{functionName:"batchTable_getWidthAndShow",componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:2},{functionName:"batchTable_getPickColor",componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0},{functionName:"batchTable_getCenterHigh",componentDatatype:K.FLOAT,componentsPerAttribute:3},{functionName:"batchTable_getCenterLowAndRadius",componentDatatype:K.FLOAT,componentsPerAttribute:4},{functionName:"batchTable_getDistanceDisplayCondition",componentDatatype:K.FLOAT,componentsPerAttribute:2}];e._batchTable=new LC(t,n,e._polylines.length)}var Dce=new Gn,Ice=new oe,Pce=new H;Ed.prototype.update=function(e){if(w7(this),this._polylines.length===0||!this.show)return;nqe(this,e);let t=e.context,n=e.mapProjection,i,o=this._propertiesChanged;if(this._createBatchTable){if(Vt.maximumVertexTextureImageUnits===0)throw new ce("Vertex texture fetch support is required to render polylines. The maximum number of vertex texture image units must be greater than zero.");Zje(this,t),this._createBatchTable=!1}if(this._createVertexArray||Qje(this))Tce(this,t,n);else if(this._polylinesUpdated){let c=this._polylinesToUpdate;if(this._mode!==ne.SCENE3D){let l=c.length;for(let f=0;f<l;++f)i=c[f],i.update()}if(o[bce]||o[Xje])Tce(this,t,n);else{let l=c.length,f=this._polylineBuckets;for(let d=0;d<l;++d){i=c[d],o=i._propertiesChanged;let p=i._bucket,g=0;for(let m in f)if(f.hasOwnProperty(m)){if(f[m]===p){o[v7]&&p.writeUpdate(g,i,this._positionBuffer,n);break}g+=f[m].lengthOfPositions}if((o[qje]||o[Yje])&&this._batchTable.setBatchedAttribute(i._index,0,new H(i._width,i._show)),this._batchTable.attributes.length>2){if(o[v7]||o[bce]){let m=e.mode===ne.SCENE2D?i._boundingVolume2D:i._boundingVolumeWC,y=Gn.fromCartesian(m.center,Dce),b=oe.fromElements(y.low.x,y.low.y,y.low.z,m.radius,Ice);this._batchTable.setBatchedAttribute(i._index,2,y.high),this._batchTable.setBatchedAttribute(i._index,3,b)}if(o[Kje]){let m=Pce;m.x=0,m.y=Number.MAX_VALUE;let y=i.distanceDisplayCondition;u(y)&&(m.x=y.near,m.y=y.far),this._batchTable.setBatchedAttribute(i._index,4,m)}}i._clean()}}c.length=0,this._polylinesUpdated=!1}o=this._propertiesChanged;for(let c=0;c<wce;++c)o[c]=0;let r=F.IDENTITY;e.mode===ne.SCENE3D&&(r=this.modelMatrix);let s=e.passes,a=e.morphTime!==0;if((!u(this._opaqueRS)||this._opaqueRS.depthTest.enabled!==a)&&(this._opaqueRS=Ue.fromCache({depthMask:a,depthTest:{enabled:a}})),(!u(this._translucentRS)||this._translucentRS.depthTest.enabled!==a)&&(this._translucentRS=Ue.fromCache({blending:un.ALPHA_BLEND,depthMask:!a,depthTest:{enabled:a}})),this._batchTable.update(e),s.render||s.pick){let c=this._colorCommands;$je(this,e,c,r)}};var Vw=new ae,Cce=new ae;function $je(e,t,n,i){let o=t.context,r=t.commandList,s=n.length,a=0,c=!0,l=e._vertexArrays,f=e.debugShowBoundingVolume,p=e._batchTable.getUniformMapCallback(),g=l.length;for(let m=0;m<g;++m){let y=l[m],b=y.buckets,C=b.length;for(let A=0;A<C;++A){let T=b[A],E=T.offset,v=T.bucket.shaderProgram,D=T.bucket.polylines,O=D.length,P,M,L=0,_,S;for(let w=0;w<O;++w){let I=D[w],N=eqe(I._material);if(N!==P){if(u(P)&&L>0){let U=M.isTranslucent();a>=s?(_=new Qe({owner:e}),n.push(_)):_=n[a],++a,S=bt(p(M._uniforms),e._uniformMap),_.boundingVolume=ae.clone(Vw,_.boundingVolume),_.modelMatrix=i,_.shaderProgram=v,_.vertexArray=y.va,_.renderState=U?e._translucentRS:e._opaqueRS,_.pass=U?we.TRANSLUCENT:we.OPAQUE,_.debugShowBoundingVolume=f,_.pickId="v_pickColor",_.uniformMap=S,_.count=L,_.offset=E,E+=L,L=0,c=!0,r.push(_)}M=I._material,M.update(o),P=N}let k=I._locatorBuckets,z=k.length;for(let U=0;U<z;++U){let B=k[U];B.locator===T&&(L+=B.count)}let V;t.mode===ne.SCENE3D?V=I._boundingVolumeWC:t.mode===ne.COLUMBUS_VIEW?V=I._boundingVolume2D:t.mode===ne.SCENE2D?u(I._boundingVolume2D)&&(V=ae.clone(I._boundingVolume2D,Cce),V.center.x=0):u(I._boundingVolumeWC)&&u(I._boundingVolume2D)&&(V=ae.union(I._boundingVolumeWC,I._boundingVolume2D,Cce)),c?(c=!1,ae.clone(V,Vw)):ae.union(V,Vw,Vw)}u(P)&&L>0&&(a>=s?(_=new Qe({owner:e}),n.push(_)):_=n[a],++a,S=bt(p(M._uniforms),e._uniformMap),_.boundingVolume=ae.clone(Vw,_.boundingVolume),_.modelMatrix=i,_.shaderProgram=v,_.vertexArray=y.va,_.renderState=M.isTranslucent()?e._translucentRS:e._opaqueRS,_.pass=M.isTranslucent()?we.TRANSLUCENT:we.OPAQUE,_.debugShowBoundingVolume=f,_.pickId="v_pickColor",_.uniformMap=S,_.count=L,_.offset=E,c=!0,r.push(_)),P=void 0}}n.length=a}Ed.prototype.isDestroyed=function(){return!1};Ed.prototype.destroy=function(){return Rce(this),D7(this),Oce(this),this._batchTable=this._batchTable&&this._batchTable.destroy(),ue(this)};function Qje(e){let t=!1,n=e._propertiesChanged,i=e._positionBufferUsage;return n[v7]?(i.bufferUsage!==ke.STREAM_DRAW&&(t=!0,i.bufferUsage=ke.STREAM_DRAW),i.frameCount=100):i.bufferUsage!==ke.STATIC_DRAW&&(i.frameCount===0?(t=!0,i.bufferUsage=ke.STATIC_DRAW):i.frameCount--),t}var Ace=[0,0,0];function Tce(e,t,n){e._createVertexArray=!1,D7(e),Rce(e),tqe(e);let i=[[]],o=i[0],r=e._batchTable,s=e._useHighlightColor,a=[0],c=0,l=[[]],f=0,d=e._polylineBuckets,p,g;for(p in d)d.hasOwnProperty(p)&&(g=d[p],g.updateShader(t,r,s),f+=g.lengthOfPositions);if(f>0){let m=e._mode,y=new Float32Array(6*f*3),b=new Float32Array(f*4),C,A=0,T=0,E=0;for(p in d)if(d.hasOwnProperty(p)){g=d[p],g.write(y,b,A,T,E,r,t,n),m===ne.MORPHING&&(u(C)||(C=new Float32Array(6*f*3)),g.writeForMorph(C,A));let S=g.lengthOfPositions;A+=6*S*3,T+=S*4,E+=S*4,c=g.updateIndices(i,a,l,c)}let v=e._positionBufferUsage.bufferUsage,D=ke.STATIC_DRAW;e._positionBuffer=xt.createVertexBuffer({context:t,typedArray:y,usage:v});let O;u(C)&&(O=xt.createVertexBuffer({context:t,typedArray:C,usage:v})),e._texCoordExpandAndBatchIndexBuffer=xt.createVertexBuffer({context:t,typedArray:b,usage:D});let P=3*Float32Array.BYTES_PER_ELEMENT,M=4*Float32Array.BYTES_PER_ELEMENT,L=0,_=i.length;for(let S=0;S<_;++S)if(o=i[S],o.length>0){let w=new Uint16Array(o),I=xt.createIndexBuffer({context:t,typedArray:w,usage:ke.STATIC_DRAW,indexDatatype:Be.UNSIGNED_SHORT});L+=a[S];let N=6*(S*(P*R.SIXTY_FOUR_KILOBYTES)-L*P),k=P+N,z=P+k,V=P+z,U=P+V,B=P+U,W=S*(M*R.SIXTY_FOUR_KILOBYTES)-L*M,j=[{index:El.position3DHigh,componentsPerAttribute:3,componentDatatype:K.FLOAT,offsetInBytes:N,strideInBytes:6*P},{index:El.position3DLow,componentsPerAttribute:3,componentDatatype:K.FLOAT,offsetInBytes:k,strideInBytes:6*P},{index:El.position2DHigh,componentsPerAttribute:3,componentDatatype:K.FLOAT,offsetInBytes:N,strideInBytes:6*P},{index:El.position2DLow,componentsPerAttribute:3,componentDatatype:K.FLOAT,offsetInBytes:k,strideInBytes:6*P},{index:El.prevPosition3DHigh,componentsPerAttribute:3,componentDatatype:K.FLOAT,offsetInBytes:z,strideInBytes:6*P},{index:El.prevPosition3DLow,componentsPerAttribute:3,componentDatatype:K.FLOAT,offsetInBytes:V,strideInBytes:6*P},{index:El.prevPosition2DHigh,componentsPerAttribute:3,componentDatatype:K.FLOAT,offsetInBytes:z,strideInBytes:6*P},{index:El.prevPosition2DLow,componentsPerAttribute:3,componentDatatype:K.FLOAT,offsetInBytes:V,strideInBytes:6*P},{index:El.nextPosition3DHigh,componentsPerAttribute:3,componentDatatype:K.FLOAT,offsetInBytes:U,strideInBytes:6*P},{index:El.nextPosition3DLow,componentsPerAttribute:3,componentDatatype:K.FLOAT,offsetInBytes:B,strideInBytes:6*P},{index:El.nextPosition2DHigh,componentsPerAttribute:3,componentDatatype:K.FLOAT,offsetInBytes:U,strideInBytes:6*P},{index:El.nextPosition2DLow,componentsPerAttribute:3,componentDatatype:K.FLOAT,offsetInBytes:B,strideInBytes:6*P},{index:El.texCoordExpandAndBatchIndex,componentsPerAttribute:4,componentDatatype:K.FLOAT,vertexBuffer:e._texCoordExpandAndBatchIndexBuffer,offsetInBytes:W}],Q,q,X,Z;m===ne.SCENE3D?(q=e._positionBuffer,Q="vertexBuffer",X=Ace,Z="value"):m===ne.SCENE2D||m===ne.COLUMBUS_VIEW?(q=Ace,Q="value",X=e._positionBuffer,Z="vertexBuffer"):(q=O,Q="vertexBuffer",X=e._positionBuffer,Z="vertexBuffer"),j[0][Q]=q,j[1][Q]=q,j[2][Z]=X,j[3][Z]=X,j[4][Q]=q,j[5][Q]=q,j[6][Z]=X,j[7][Z]=X,j[8][Q]=q,j[9][Q]=q,j[10][Z]=X,j[11][Z]=X;let fe=new ii({context:t,attributes:j,indexBuffer:I});e._vertexArrays.push({va:fe,buckets:l[S]})}}}function Jje(e,t){return t instanceof Ot?t.id:t}var xB=[];function eqe(e){let t=Zi._uniformList[e.type],n=t.length;xB.length=2*n;let i=0;for(let o=0;o<n;++o){let r=t[o];xB[i]=r,xB[i+1]=e._uniforms[r](),i+=2}return`${e.type}:${JSON.stringify(xB,Jje)}`}function tqe(e){let t=e._mode,n=e._modelMatrix,i=e._polylineBuckets={},o=e._polylines,r=o.length;for(let s=0;s<r;++s){let a=o[s];if(a._actualPositions.length>1){a.update();let c=a.material,l=i[c.type];u(l)||(l=i[c.type]=new nm(c,t,n)),l.addPolyline(a)}}}function nqe(e,t){let n=t.mode;(e._mode!==n||!F.equals(e._modelMatrix,e.modelMatrix))&&(e._mode=n,e._modelMatrix=F.clone(e.modelMatrix),e._createVertexArray=!0)}function w7(e){if(e._polylinesRemoved){e._polylinesRemoved=!1;let t=[],n=[],i=0,o,r=e._polylines.length;for(let s=0;s<r;++s)o=e._polylines[s],o.isDestroyed||(o._index=i++,n.push(o),t.push(o));e._polylines=t,e._polylinesToUpdate=n}}function D7(e){let t=e._polylines,n=t.length;for(let i=0;i<n;++i)if(!t[i].isDestroyed){let o=t[i]._bucket;u(o)&&(o.shaderProgram=o.shaderProgram&&o.shaderProgram.destroy())}}function Rce(e){let t=e._vertexArrays.length;for(let n=0;n<t;++n)e._vertexArrays[n].va.destroy();e._vertexArrays.length=0}Ed.prototype._updatePolyline=function(e,t){this._polylinesUpdated=!0,e._dirty||this._polylinesToUpdate.push(e),++this._propertiesChanged[t]};function Oce(e){let t=e._polylines,n=t.length;for(let i=0;i<n;++i)t[i].isDestroyed||t[i]._destroy()}function S7(e,t,n){this.count=e,this.offset=t,this.bucket=n}function nm(e,t,n){this.polylines=[],this.lengthOfPositions=0,this.material=e,this.shaderProgram=void 0,this.mode=t,this.modelMatrix=n}nm.prototype.addPolyline=function(e){this.polylines.push(e),e._actualLength=this.getPolylinePositionsLength(e),this.lengthOfPositions+=e._actualLength,e._bucket=this};nm.prototype.updateShader=function(e,t,n){if(u(this.shaderProgram))return;let i=["DISTANCE_DISPLAY_CONDITION"];n&&i.push("VECTOR_TILE"),this.material.shaderSource.search(/in\s+float\s+v_polylineAngle;/g)!==-1&&i.push("POLYLINE_DASH"),Wt.isInternetExplorer()||i.push("CLIP_POLYLINE");let o=new ze({defines:i,sources:[`in vec4 v_pickColor;
`,this.material.shaderSource,UC]}),r=t.getVertexShaderCallback()(_B),s=new ze({defines:i,sources:[rf,r]});this.shaderProgram=tn.fromCache({context:e,vertexShaderSource:s,fragmentShaderSource:o,attributeLocations:El})};function Mce(e){return h.dot(h.UNIT_X,e._boundingVolume.center)<0||e._boundingVolume.intersectPlane(cn.ORIGIN_ZX_PLANE)===qt.INTERSECTING}nm.prototype.getPolylinePositionsLength=function(e){let t;if(this.mode===ne.SCENE3D||!Mce(e))return t=e._actualPositions.length,t*4-4;let n=0,i=e._segments.lengths;t=i.length;for(let o=0;o<t;++o)n+=i[o]*4-4;return n};var Ts=new h,Tf=new h,Ef=new h,bB=new h,iqe=new oe,oqe=new H;nm.prototype.write=function(e,t,n,i,o,r,s,a){let c=this.mode,l=a.ellipsoid.maximumRadius*R.PI,f=this.polylines,d=f.length;for(let p=0;p<d;++p){let g=f[p],m=g.width,y=g.show&&m>0,b=g._index,C=this.getSegments(g,a),A=C.positions,T=C.lengths,E=A.length,v=g.getPickId(s).color,D=0,O=0,P;for(let z=0;z<E;++z){z===0?g._loop?P=A[E-2]:(P=bB,h.subtract(A[0],A[1],P),h.add(A[0],P,P)):P=A[z-1],h.clone(P,Tf),h.clone(A[z],Ts),z===E-1?g._loop?P=A[1]:(P=bB,h.subtract(A[E-1],A[E-2],P),h.add(A[E-1],P,P)):P=A[z+1],h.clone(P,Ef);let V=T[D];z===O+V&&(O+=V,++D);let U=z-O===0,B=z===O+T[D]-1;c===ne.SCENE2D&&(Tf.z=0,Ts.z=0,Ef.z=0),(c===ne.SCENE2D||c===ne.MORPHING)&&(U||B)&&l-Math.abs(Ts.x)<1&&((Ts.x<0&&Tf.x>0||Ts.x>0&&Tf.x<0)&&h.clone(Ts,Tf),(Ts.x<0&&Ef.x>0||Ts.x>0&&Ef.x<0)&&h.clone(Ts,Ef));let W=U?2:0,j=B?2:4;for(let Q=W;Q<j;++Q){Gn.writeElements(Ts,e,n),Gn.writeElements(Tf,e,n+6),Gn.writeElements(Ef,e,n+12);let q=Q-2<0?-1:1;t[o]=z/(E-1),t[o+1]=2*(Q%2)-1,t[o+2]=q,t[o+3]=b,n+=6*3,o+=4}}let M=iqe;M.x=G.floatToByte(v.red),M.y=G.floatToByte(v.green),M.z=G.floatToByte(v.blue),M.w=G.floatToByte(v.alpha);let L=oqe;L.x=m,L.y=y?1:0;let _=c===ne.SCENE2D?g._boundingVolume2D:g._boundingVolumeWC,S=Gn.fromCartesian(_.center,Dce),w=S.high,I=oe.fromElements(S.low.x,S.low.y,S.low.z,_.radius,Ice),N=Pce;N.x=0,N.y=Number.MAX_VALUE;let k=g.distanceDisplayCondition;u(k)&&(N.x=k.near,N.y=k.far),r.setBatchedAttribute(b,0,L),r.setBatchedAttribute(b,1,M),r.attributes.length>2&&(r.setBatchedAttribute(b,2,w),r.setBatchedAttribute(b,3,I),r.setBatchedAttribute(b,4,N))}};var rqe=new h,sqe=new h,aqe=new h,Ece=new h;nm.prototype.writeForMorph=function(e,t){let n=this.modelMatrix,i=this.polylines,o=i.length;for(let r=0;r<o;++r){let s=i[r],a=s._segments.positions,c=s._segments.lengths,l=a.length,f=0,d=0;for(let p=0;p<l;++p){let g;p===0?s._loop?g=a[l-2]:(g=Ece,h.subtract(a[0],a[1],g),h.add(a[0],g,g)):g=a[p-1],g=F.multiplyByPoint(n,g,sqe);let m=F.multiplyByPoint(n,a[p],rqe),y;p===l-1?s._loop?y=a[1]:(y=Ece,h.subtract(a[l-1],a[l-2],y),h.add(a[l-1],y,y)):y=a[p+1],y=F.multiplyByPoint(n,y,aqe);let b=c[f];p===d+b&&(d+=b,++f);let C=p-d===0,A=p===d+c[f]-1,T=C?2:0,E=A?2:4;for(let v=T;v<E;++v)Gn.writeElements(m,e,t),Gn.writeElements(g,e,t+6),Gn.writeElements(y,e,t+12),t+=6*3}}};var cqe=new Array(1);nm.prototype.updateIndices=function(e,t,n,i){let o=n.length-1,r=new S7(0,i,this);n[o].push(r);let s=0,a=e[e.length-1],c=0;a.length>0&&(c=a[a.length-1]+1);let l=this.polylines,f=l.length;for(let d=0;d<f;++d){let p=l[d];p._locatorBuckets=[];let g;if(this.mode===ne.SCENE3D){g=cqe;let y=p._actualPositions.length;if(y>0)g[0]=y;else continue}else g=p._segments.lengths;let m=g.length;if(m>0){let y=0;for(let b=0;b<m;++b){let C=g[b]-1;for(let A=0;A<C;++A)c+4>R.SIXTY_FOUR_KILOBYTES&&(p._locatorBuckets.push({locator:r,count:y}),y=0,t.push(4),a=[],e.push(a),c=0,r.count=s,s=0,i=0,r=new S7(0,0,this),n[++o]=[r]),a.push(c,c+2,c+1),a.push(c+1,c+2,c+3),y+=6,s+=6,i+=6,c+=4}p._locatorBuckets.push({locator:r,count:y}),c+4>R.SIXTY_FOUR_KILOBYTES&&(t.push(0),a=[],e.push(a),c=0,r.count=s,i=0,s=0,r=new S7(0,0,this),n[++o]=[r])}p._clean()}return r.count=s,i};nm.prototype.getPolylineStartIndex=function(e){let t=this.polylines,n=0,i=t.length;for(let o=0;o<i;++o){let r=t[o];if(r===e)break;n+=r._actualLength}return n};var YA={positions:void 0,lengths:void 0},Sce=new Array(1),lqe=new h,uqe=new de;nm.prototype.getSegments=function(e,t){let n=e._actualPositions;if(this.mode===ne.SCENE3D)return Sce[0]=n.length,YA.positions=n,YA.lengths=Sce,YA;Mce(e)&&(n=e._segments.positions);let i=t.ellipsoid,o=[],r=this.modelMatrix,s=n.length,a,c=lqe;for(let l=0;l<s;++l)a=n[l],c=F.multiplyByPoint(r,a,c),o.push(t.project(i.cartesianToCartographic(c,uqe)));if(o.length>0){e._boundingVolume2D=ae.fromPoints(o,e._boundingVolume2D);let l=e._boundingVolume2D.center;e._boundingVolume2D.center=new h(l.z,l.x,l.y)}return YA.positions=o,YA.lengths=e._segments.lengths,YA};var vce;nm.prototype.writeUpdate=function(e,t,n,i){let o=this.mode,r=i.ellipsoid.maximumRadius*R.PI,s=t._actualLength;if(s){e+=this.getPolylineStartIndex(t);let a=vce,c=6*s*3;!u(a)||a.length<c?a=vce=new Float32Array(c):a.length>c&&(a=new Float32Array(a.buffer,0,c));let l=this.getSegments(t,i),f=l.positions,d=l.lengths,p=0,g=0,m=0,y;s=f.length;for(let b=0;b<s;++b){b===0?t._loop?y=f[s-2]:(y=bB,h.subtract(f[0],f[1],y),h.add(f[0],y,y)):y=f[b-1],h.clone(y,Tf),h.clone(f[b],Ts),b===s-1?t._loop?y=f[1]:(y=bB,h.subtract(f[s-1],f[s-2],y),h.add(f[s-1],y,y)):y=f[b+1],h.clone(y,Ef);let C=d[g];b===m+C&&(m+=C,++g);let A=b-m===0,T=b===m+d[g]-1;o===ne.SCENE2D&&(Tf.z=0,Ts.z=0,Ef.z=0),(o===ne.SCENE2D||o===ne.MORPHING)&&(A||T)&&r-Math.abs(Ts.x)<1&&((Ts.x<0&&Tf.x>0||Ts.x>0&&Tf.x<0)&&h.clone(Ts,Tf),(Ts.x<0&&Ef.x>0||Ts.x>0&&Ef.x<0)&&h.clone(Ts,Ef));let E=A?2:0,v=T?2:4;for(let D=E;D<v;++D)Gn.writeElements(Ts,a,p),Gn.writeElements(Tf,a,p+6),Gn.writeElements(Ef,a,p+12),p+=6*3}n.copyFromArrayView(a,6*3*Float32Array.BYTES_PER_ELEMENT*e)}};var im=Ed;function zg(e){this._positions=e.positions,this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._rectangle=e.rectangle,this._minHeight=e.minimumHeight,this._maxHeight=e.maximumHeight,this._billboardCollection=new Cf({batchTable:e.batchTable}),this._labelCollection=new Lp({batchTable:e.batchTable}),this._polylineCollection=new im,this._polylineCollection._useHighlightColor=!0,this._packedBuffer=void 0,this._ready=!1,this._promise=void 0,this._error=void 0}Object.defineProperties(zg.prototype,{ready:{get:function(){return this._ready}},pointsLength:{get:function(){return this._billboardCollection.length}},texturesByteLength:{get:function(){let e=this._billboardCollection.textureAtlas.texture.sizeInBytes,t=this._labelCollection._textureAtlas.texture.sizeInBytes;return e+t}}});function fqe(e,t){let n=e._rectangle,i=e._minHeight,o=e._maxHeight,r=2+se.packedLength+ee.packedLength,s=new Float64Array(r),a=0;return s[a++]=i,s[a++]=o,se.pack(n,s,a),a+=se.packedLength,ee.pack(t,s,a),s}var dqe=new xi("createVectorTilePoints",5),hqe=new h;function mqe(e,t){let n=e._positions,i=e._packedBuffer;u(i)||(n=e._positions=n.slice(),e._batchIds=e._batchIds.slice(),i=e._packedBuffer=fqe(e,t));let o=[n.buffer,i.buffer],r={positions:n.buffer,packedBuffer:i.buffer},s=dqe.scheduleTask(r,o);if(u(s))return s.then(a=>{if(e.isDestroyed())return;e._positions=new Float64Array(a.positions);let c=e._billboardCollection,l=e._labelCollection,f=e._polylineCollection;n=e._positions;let d=e._batchIds,p=n.length/3;for(let g=0;g<p;++g){let m=d[g],y=h.unpack(n,g*3,hqe),b=c.add();b.position=y,b._batchIndex=m;let C=l.add();C.text=" ",C.position=y,C._batchIndex=m;let A=f.add();A.positions=[h.clone(y),h.clone(y)]}e._positions=void 0,e._packedBuffer=void 0,e._ready=!0}).catch(a=>{e.isDestroyed()||(e._error=a)})}zg.prototype.createFeatures=function(e,t){let n=this._billboardCollection,i=this._labelCollection,o=this._polylineCollection,r=this._batchIds,s=r.length;for(let a=0;a<s;++a){let c=r[a],l=n.get(a),f=i.get(a),d=o.get(a);t[c]=new Vg(e,c,l,f,d)}};zg.prototype.applyDebugSettings=function(e,t){e?(G.clone(t,this._billboardCollection._highlightColor),G.clone(t,this._labelCollection._highlightColor),G.clone(t,this._polylineCollection._highlightColor)):(G.clone(G.WHITE,this._billboardCollection._highlightColor),G.clone(G.WHITE,this._labelCollection._highlightColor),G.clone(G.WHITE,this._polylineCollection._highlightColor))};function pqe(e,t){let n=e._batchIds,i=n.length;for(let o=0;o<i;++o){let r=n[o],s=t[r];s.show=!0,s.pointSize=Vg.defaultPointSize,s.color=Vg.defaultColor,s.pointOutlineColor=Vg.defaultPointOutlineColor,s.pointOutlineWidth=Vg.defaultPointOutlineWidth,s.labelColor=G.WHITE,s.labelOutlineColor=G.WHITE,s.labelOutlineWidth=1,s.font="30px sans-serif",s.labelStyle=$o.FILL,s.labelText=void 0,s.backgroundColor=new G(.165,.165,.165,.8),s.backgroundPadding=new H(7,5),s.backgroundEnabled=!1,s.scaleByDistance=void 0,s.translucencyByDistance=void 0,s.distanceDisplayCondition=void 0,s.heightOffset=0,s.anchorLineEnabled=!1,s.anchorLineColor=G.WHITE,s.image=void 0,s.disableDepthTestDistance=0,s.horizontalOrigin=bi.CENTER,s.verticalOrigin=On.CENTER,s.labelHorizontalOrigin=bi.RIGHT,s.labelVerticalOrigin=On.BASELINE}}var _qe=new G,gqe=new G,yqe=new G,xqe=new G,bqe=new G,Cqe=new G,Uw=new kt,zw=new kt,I7=new Nt;zg.prototype.applyStyle=function(e,t){if(!u(e)){pqe(this,t);return}let n=this._batchIds,i=n.length;for(let o=0;o<i;++o){let r=n[o],s=t[r];if(u(e.show)&&(s.show=e.show.evaluate(s)),u(e.pointSize)&&(s.pointSize=e.pointSize.evaluate(s)),u(e.color)&&(s.color=e.color.evaluateColor(s,_qe)),u(e.pointOutlineColor)&&(s.pointOutlineColor=e.pointOutlineColor.evaluateColor(s,gqe)),u(e.pointOutlineWidth)&&(s.pointOutlineWidth=e.pointOutlineWidth.evaluate(s)),u(e.labelColor)&&(s.labelColor=e.labelColor.evaluateColor(s,yqe)),u(e.labelOutlineColor)&&(s.labelOutlineColor=e.labelOutlineColor.evaluateColor(s,xqe)),u(e.labelOutlineWidth)&&(s.labelOutlineWidth=e.labelOutlineWidth.evaluate(s)),u(e.font)&&(s.font=e.font.evaluate(s)),u(e.labelStyle)&&(s.labelStyle=e.labelStyle.evaluate(s)),u(e.labelText)?s.labelText=e.labelText.evaluate(s):s.labelText=void 0,u(e.backgroundColor)&&(s.backgroundColor=e.backgroundColor.evaluateColor(s,bqe)),u(e.backgroundPadding)&&(s.backgroundPadding=e.backgroundPadding.evaluate(s)),u(e.backgroundEnabled)&&(s.backgroundEnabled=e.backgroundEnabled.evaluate(s)),u(e.scaleByDistance)){let a=e.scaleByDistance.evaluate(s);u(a)?(Uw.near=a.x,Uw.nearValue=a.y,Uw.far=a.z,Uw.farValue=a.w,s.scaleByDistance=Uw):s.scaleByDistance=void 0}else s.scaleByDistance=void 0;if(u(e.translucencyByDistance)){let a=e.translucencyByDistance.evaluate(s);u(a)?(zw.near=a.x,zw.nearValue=a.y,zw.far=a.z,zw.farValue=a.w,s.translucencyByDistance=zw):s.translucencyByDistance=void 0}else s.translucencyByDistance=void 0;if(u(e.distanceDisplayCondition)){let a=e.distanceDisplayCondition.evaluate(s);u(a)?(I7.near=a.x,I7.far=a.y,s.distanceDisplayCondition=I7):s.distanceDisplayCondition=void 0}else s.distanceDisplayCondition=void 0;u(e.heightOffset)&&(s.heightOffset=e.heightOffset.evaluate(s)),u(e.anchorLineEnabled)&&(s.anchorLineEnabled=e.anchorLineEnabled.evaluate(s)),u(e.anchorLineColor)&&(s.anchorLineColor=e.anchorLineColor.evaluateColor(s,Cqe)),u(e.image)?s.image=e.image.evaluate(s):s.image=void 0,u(e.disableDepthTestDistance)&&(s.disableDepthTestDistance=e.disableDepthTestDistance.evaluate(s)),u(e.horizontalOrigin)&&(s.horizontalOrigin=e.horizontalOrigin.evaluate(s)),u(e.verticalOrigin)&&(s.verticalOrigin=e.verticalOrigin.evaluate(s)),u(e.labelHorizontalOrigin)&&(s.labelHorizontalOrigin=e.labelHorizontalOrigin.evaluate(s)),u(e.labelVerticalOrigin)&&(s.labelVerticalOrigin=e.labelVerticalOrigin.evaluate(s))}};zg.prototype.update=function(e){if(!this._ready){if(u(this._promise)||(this._promise=mqe(this,e.mapProjection.ellipsoid)),u(this._error)){let t=this._error;throw this._error=void 0,t}return}this._polylineCollection.update(e),this._billboardCollection.update(e),this._labelCollection.update(e)};zg.prototype.isDestroyed=function(){return!1};zg.prototype.destroy=function(){return this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),this._labelCollection=this._labelCollection&&this._labelCollection.destroy(),this._polylineCollection=this._polylineCollection&&this._polylineCollection.destroy(),ue(this)};var CB=zg;function Fp(e){this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._positions=e.positions,this._counts=e.counts,this._indices=e.indices,this._indexCounts=e.indexCounts,this._indexOffsets=void 0,this._batchTableColors=void 0,this._packedBuffer=void 0,this._batchedPositions=void 0,this._transferrableBatchIds=void 0,this._vertexBatchIds=void 0,this._ellipsoid=x(e.ellipsoid,ee.WGS84),this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._polygonMinimumHeights=e.polygonMinimumHeights,this._polygonMaximumHeights=e.polygonMaximumHeights,this._center=x(e.center,h.ZERO),this._rectangle=e.rectangle,this._center=void 0,this._boundingVolume=e.boundingVolume,this._boundingVolumes=void 0,this._batchedIndices=void 0,this._ready=!1,this._promise=void 0,this._error=void 0,this._primitive=void 0,this.debugWireframe=!1,this.forceRebatch=!1,this.classificationType=Vn.BOTH}Object.defineProperties(Fp.prototype,{trianglesLength:{get:function(){return u(this._primitive)?this._primitive.trianglesLength:0}},geometryByteLength:{get:function(){return u(this._primitive)?this._primitive.geometryByteLength:0}},ready:{get:function(){return this._ready}}});function Aqe(e){let t=new Float64Array(3+h.packedLength+ee.packedLength+se.packedLength),n=0;return t[n++]=e._indices.BYTES_PER_ELEMENT,t[n++]=e._minimumHeight,t[n++]=e._maximumHeight,h.pack(e._center,t,n),n+=h.packedLength,ee.pack(e._ellipsoid,t,n),n+=ee.packedLength,se.pack(e._rectangle,t,n),t}function Tqe(e,t){let n=1,i=t[n++],o=e._boundingVolumes=new Array(i);for(let a=0;a<i;++a)o[a]=wn.unpack(t,n),n+=wn.packedLength;let r=t[n++],s=e._batchedIndices=new Array(r);for(let a=0;a<r;++a){let c=G.unpack(t,n);n+=G.packedLength;let l=t[n++],f=t[n++],d=t[n++],p=new Array(d);for(let g=0;g<d;++g)p[g]=t[n++];s[a]=new mp({color:c,offset:l,count:f,batchIds:p})}}var Eqe=new xi("createVectorTilePolygons",5),Sqe=new G;function vqe(e){if(u(e._primitive))return;let t=e._positions,n=e._counts,i=e._indexCounts,o=e._indices,r=e._transferrableBatchIds,s=e._batchTableColors,a=e._packedBuffer;if(!u(s)){t=e._positions=e._positions.slice(),n=e._counts=e._counts.slice(),i=e._indexCounts=e._indexCounts.slice(),o=e._indices=e._indices.slice(),e._center=e._ellipsoid.cartographicToCartesian(se.center(e._rectangle)),r=e._transferrableBatchIds=new Uint32Array(e._batchIds),s=e._batchTableColors=new Uint32Array(r.length);let g=e._batchTable,m=s.length;for(let y=0;y<m;++y){let b=g.getColor(y,Sqe);s[y]=b.toRgba()}a=e._packedBuffer=Aqe(e)}let c=[t.buffer,n.buffer,i.buffer,o.buffer,r.buffer,s.buffer,a.buffer],l={packedBuffer:a.buffer,positions:t.buffer,counts:n.buffer,indexCounts:i.buffer,indices:o.buffer,batchIds:r.buffer,batchTableColors:s.buffer},f=e._polygonMinimumHeights,d=e._polygonMaximumHeights;u(f)&&u(d)&&(f=f.slice(),d=d.slice(),c.push(f.buffer,d.buffer),l.minimumHeights=f,l.maximumHeights=d);let p=Eqe.scheduleTask(l,c);if(u(p))return p.then(g=>{if(e.isDestroyed())return;e._positions=void 0,e._counts=void 0,e._polygonMinimumHeights=void 0,e._polygonMaximumHeights=void 0;let m=new Float64Array(g.packedBuffer),y=m[0];Tqe(e,m),e._indices=Be.getSizeInBytes(y)===2?new Uint16Array(g.indices):new Uint32Array(g.indices),e._indexOffsets=new Uint32Array(g.indexOffsets),e._indexCounts=new Uint32Array(g.indexCounts),e._batchedPositions=new Float32Array(g.positions),e._vertexBatchIds=new Uint16Array(g.batchIds),wqe(e),e._ready=!0}).catch(g=>{e.isDestroyed()||(e._error=g)})}function wqe(e){u(e._primitive)||(e._primitive=new rA({batchTable:e._batchTable,positions:e._batchedPositions,batchIds:e._batchIds,vertexBatchIds:e._vertexBatchIds,indices:e._indices,indexOffsets:e._indexOffsets,indexCounts:e._indexCounts,batchedIndices:e._batchedIndices,boundingVolume:e._boundingVolume,boundingVolumes:e._boundingVolumes,center:e._center}),e._batchTable=void 0,e._batchIds=void 0,e._positions=void 0,e._counts=void 0,e._indices=void 0,e._indexCounts=void 0,e._indexOffsets=void 0,e._batchTableColors=void 0,e._packedBuffer=void 0,e._batchedPositions=void 0,e._transferrableBatchIds=void 0,e._vertexBatchIds=void 0,e._ellipsoid=void 0,e._minimumHeight=void 0,e._maximumHeight=void 0,e._polygonMinimumHeights=void 0,e._polygonMaximumHeights=void 0,e._center=void 0,e._rectangle=void 0,e._boundingVolume=void 0,e._boundingVolumes=void 0,e._batchedIndices=void 0)}Fp.prototype.createFeatures=function(e,t){this._primitive.createFeatures(e,t)};Fp.prototype.applyDebugSettings=function(e,t){this._primitive.applyDebugSettings(e,t)};Fp.prototype.applyStyle=function(e,t){this._primitive.applyStyle(e,t)};Fp.prototype.updateCommands=function(e,t){this._primitive.updateCommands(e,t)};Fp.prototype.update=function(e){if(!this._ready){if(u(this._promise)||(this._promise=vqe(this)),u(this._error)){let t=this._error;throw this._error=void 0,t}return}this._primitive.debugWireframe=this.debugWireframe,this._primitive.forceRebatch=this.forceRebatch,this._primitive.classificationType=this.classificationType,this._primitive.update(e)};Fp.prototype.isDestroyed=function(){return!1};Fp.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),ue(this)};var AB=Fp;var TB=`in vec4 currentPosition;
in vec4 previousPosition;
in vec4 nextPosition;
in vec2 expandAndWidth;
in float a_batchId;

uniform mat4 u_modifiedModelView;

void main()
{
    float expandDir = expandAndWidth.x;
    float width = abs(expandAndWidth.y) + 0.5;
    bool usePrev = expandAndWidth.y < 0.0;

    vec4 p = u_modifiedModelView * currentPosition;
    vec4 prev = u_modifiedModelView * previousPosition;
    vec4 next = u_modifiedModelView * nextPosition;

    float angle;
    vec4 positionWC = getPolylineWindowCoordinatesEC(p, prev, next, expandDir, width, usePrev, angle);
    gl_Position = czm_viewportOrthographic * positionWC;
}
`;function Sd(e){this._positions=e.positions,this._widths=e.widths,this._counts=e.counts,this._batchIds=e.batchIds,this._ellipsoid=x(e.ellipsoid,ee.WGS84),this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._center=e.center,this._rectangle=e.rectangle,this._boundingVolume=e.boundingVolume,this._batchTable=e.batchTable,this._va=void 0,this._sp=void 0,this._rs=void 0,this._uniformMap=void 0,this._command=void 0,this._transferrableBatchIds=void 0,this._packedBuffer=void 0,this._keepDecodedPositions=e.keepDecodedPositions,this._decodedPositions=void 0,this._decodedPositionOffsets=void 0,this._currentPositions=void 0,this._previousPositions=void 0,this._nextPositions=void 0,this._expandAndWidth=void 0,this._vertexBatchIds=void 0,this._indices=void 0,this._constantColor=G.clone(G.WHITE),this._highlightColor=this._constantColor,this._trianglesLength=0,this._geometryByteLength=0,this._ready=!1,this._promise=void 0,this._error=void 0}Object.defineProperties(Sd.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},ready:{get:function(){return this._ready}}});function Dqe(e){let t=e._rectangle,n=e._minimumHeight,i=e._maximumHeight,o=e._ellipsoid,r=e._center,s=2+se.packedLength+ee.packedLength+h.packedLength,a=new Float64Array(s),c=0;return a[c++]=n,a[c++]=i,se.pack(t,a,c),c+=se.packedLength,ee.pack(o,a,c),c+=ee.packedLength,h.pack(r,a,c),a}var Iqe=new xi("createVectorTilePolylines",5),XA={previousPosition:0,currentPosition:1,nextPosition:2,expandAndWidth:3,a_batchId:4};function Pqe(e,t){if(u(e._va))return;let n=e._positions,i=e._widths,o=e._counts,r=e._transferrableBatchIds,s=e._packedBuffer;u(s)||(n=e._positions=n.slice(),i=e._widths=i.slice(),o=e._counts=o.slice(),r=e._transferrableBatchIds=e._batchIds.slice(),s=e._packedBuffer=Dqe(e));let a=[n.buffer,i.buffer,o.buffer,r.buffer,s.buffer],c={positions:n.buffer,widths:i.buffer,counts:o.buffer,batchIds:r.buffer,packedBuffer:s.buffer,keepDecodedPositions:e._keepDecodedPositions},l=Iqe.scheduleTask(c,a);if(u(l))return l.then(function(f){if(e.isDestroyed())return;e._keepDecodedPositions&&(e._decodedPositions=new Float64Array(f.decodedPositions),e._decodedPositionOffsets=new Uint32Array(f.decodedPositionOffsets)),e._currentPositions=new Float32Array(f.currentPositions),e._previousPositions=new Float32Array(f.previousPositions),e._nextPositions=new Float32Array(f.nextPositions),e._expandAndWidth=new Float32Array(f.expandAndWidth),e._vertexBatchIds=new Uint16Array(f.batchIds);let d=f.indexDatatype;e._indices=d===Be.UNSIGNED_SHORT?new Uint16Array(f.indices):new Uint32Array(f.indices),Rqe(e,t),e._ready=!0}).catch(f=>{e.isDestroyed()||(e._error=f)})}function Rqe(e,t){if(!u(e._va)){let n=e._currentPositions,i=e._previousPositions,o=e._nextPositions,r=e._expandAndWidth,s=e._vertexBatchIds,a=e._indices,c=i.byteLength+n.byteLength+o.byteLength;c+=r.byteLength+s.byteLength+a.byteLength,e._trianglesLength=a.length/3,e._geometryByteLength=c;let l=xt.createVertexBuffer({context:t,typedArray:i,usage:ke.STATIC_DRAW}),f=xt.createVertexBuffer({context:t,typedArray:n,usage:ke.STATIC_DRAW}),d=xt.createVertexBuffer({context:t,typedArray:o,usage:ke.STATIC_DRAW}),p=xt.createVertexBuffer({context:t,typedArray:r,usage:ke.STATIC_DRAW}),g=xt.createVertexBuffer({context:t,typedArray:s,usage:ke.STATIC_DRAW}),m=xt.createIndexBuffer({context:t,typedArray:a,usage:ke.STATIC_DRAW,indexDatatype:a.BYTES_PER_ELEMENT===2?Be.UNSIGNED_SHORT:Be.UNSIGNED_INT}),y=[{index:XA.previousPosition,vertexBuffer:l,componentDatatype:K.FLOAT,componentsPerAttribute:3},{index:XA.currentPosition,vertexBuffer:f,componentDatatype:K.FLOAT,componentsPerAttribute:3},{index:XA.nextPosition,vertexBuffer:d,componentDatatype:K.FLOAT,componentsPerAttribute:3},{index:XA.expandAndWidth,vertexBuffer:p,componentDatatype:K.FLOAT,componentsPerAttribute:2},{index:XA.a_batchId,vertexBuffer:g,componentDatatype:K.UNSIGNED_SHORT,componentsPerAttribute:1}];e._va=new ii({context:t,attributes:y,indexBuffer:m}),e._positions=void 0,e._widths=void 0,e._counts=void 0,e._ellipsoid=void 0,e._minimumHeight=void 0,e._maximumHeight=void 0,e._rectangle=void 0,e._transferrableBatchIds=void 0,e._packedBuffer=void 0,e._currentPositions=void 0,e._previousPositions=void 0,e._nextPositions=void 0,e._expandAndWidth=void 0,e._vertexBatchIds=void 0,e._indices=void 0}}var Hw=new F,Lce=new h;function Oqe(e,t){u(e._uniformMap)||(e._uniformMap={u_modifiedModelView:function(){let n=t.uniformState.view;return F.clone(n,Hw),F.multiplyByPoint(Hw,e._center,Lce),F.setTranslation(Hw,Lce,Hw),Hw},u_highlightColor:function(){return e._highlightColor}})}function Mqe(e){if(u(e._rs))return;let t={enabled:!0,factor:-5,units:-5};e._rs=Ue.fromCache({blending:un.ALPHA_BLEND,depthMask:!1,depthTest:{enabled:!0},polygonOffset:t})}var Lqe=`uniform vec4 u_highlightColor; 
void main()
{
    out_FragColor = u_highlightColor;
}
`;function Nqe(e,t){if(u(e._sp))return;let n=e._batchTable,i=n.getVertexShaderCallback(!1,"a_batchId",void 0)(TB),o=n.getFragmentShaderCallback(!1,void 0,!1)(Lqe),r=new ze({defines:["VECTOR_TILE",Wt.isInternetExplorer()?"":"CLIP_POLYLINE"],sources:[rf,i]}),s=new ze({defines:["VECTOR_TILE"],sources:[o]});e._sp=tn.fromCache({context:t,vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:XA})}function Fqe(e,t){if(!u(e._command)){let n=e._batchTable.getUniformMapCallback()(e._uniformMap);e._command=new Qe({owner:e,vertexArray:e._va,renderState:e._rs,shaderProgram:e._sp,uniformMap:n,boundingVolume:e._boundingVolume,pass:we.TRANSLUCENT,pickId:e._batchTable.getPickId()})}t.commandList.push(e._command)}Sd.getPolylinePositions=function(e,t){let n=e._batchIds,i=e._decodedPositions,o=e._decodedPositionOffsets;if(!u(n)||!u(i))return;let r,s,a=n.length,c=0,l=0;for(r=0;r<a;++r)n[r]===t&&(c+=o[r+1]-o[r]);if(c===0)return;let f=new Float64Array(c*3);for(r=0;r<a;++r)if(n[r]===t){let d=o[r],p=o[r+1]-d;for(s=0;s<p;++s){let g=(d+s)*3;f[l++]=i[g],f[l++]=i[g+1],f[l++]=i[g+2]}}return f};Sd.prototype.getPositions=function(e){return Sd.getPolylinePositions(this,e)};Sd.prototype.createFeatures=function(e,t){let n=this._batchIds,i=n.length;for(let o=0;o<i;++o){let r=n[o];t[r]=new ta(e,r)}};Sd.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:this._constantColor};function Bqe(e,t){let n=e._batchIds,i=n.length;for(let o=0;o<i;++o){let r=n[o],s=t[r];s.show=!0,s.color=G.WHITE}}var kqe=new G,Vqe=G.WHITE,Uqe=!0;Sd.prototype.applyStyle=function(e,t){if(!u(e)){Bqe(this,t);return}let n=this._batchIds,i=n.length;for(let o=0;o<i;++o){let r=n[o],s=t[r];s.color=u(e.color)?e.color.evaluateColor(s,kqe):Vqe,s.show=u(e.show)?e.show.evaluate(s):Uqe}};Sd.prototype.update=function(e){let t=e.context;if(!this._ready){if(u(this._promise)||(this._promise=Pqe(this,t)),u(this._error)){let i=this._error;throw this._error=void 0,i}return}Oqe(this,t),Nqe(this,t),Mqe(this);let n=e.passes;(n.render||n.pick)&&Fqe(this,e)};Sd.prototype.isDestroyed=function(){return!1};Sd.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),ue(this)};var KA=Sd;var EB=`in vec3 startEllipsoidNormal;
in vec3 endEllipsoidNormal;
in vec4 startPositionAndHeight;
in vec4 endPositionAndHeight;
in vec4 startFaceNormalAndVertexCorner;
in vec4 endFaceNormalAndHalfWidth;
in float a_batchId;

uniform mat4 u_modifiedModelView;
uniform vec2 u_minimumMaximumVectorHeights;

out vec4 v_startPlaneEC;
out vec4 v_endPlaneEC;
out vec4 v_rightPlaneEC;
out float v_halfWidth;
out vec3 v_volumeUpEC;

void main()
{
    // vertex corner IDs
    //          3-----------7
    //         /|   left   /|
    //        / | 1       / |
    //       2-----------6  5  end
    //       | /         | /
    // start |/  right   |/
    //       0-----------4
    //
    float isEnd = floor(startFaceNormalAndVertexCorner.w * 0.251); // 0 for front, 1 for end
    float isTop = floor(startFaceNormalAndVertexCorner.w * mix(0.51, 0.19, isEnd)); // 0 for bottom, 1 for top

    vec3 forward = endPositionAndHeight.xyz - startPositionAndHeight.xyz;
    vec3 right = normalize(cross(forward, startEllipsoidNormal));

    vec4 position = vec4(startPositionAndHeight.xyz, 1.0);
    position.xyz += forward * isEnd;

    v_volumeUpEC = czm_normal * normalize(cross(right, forward));

    // Push for volume height
    float offset;
    vec3 ellipsoidNormal = mix(startEllipsoidNormal, endEllipsoidNormal, isEnd);

    // offset height to create volume
    offset = mix(startPositionAndHeight.w, endPositionAndHeight.w, isEnd);
    offset = mix(u_minimumMaximumVectorHeights.y, u_minimumMaximumVectorHeights.x, isTop) - offset;
    position.xyz += offset * ellipsoidNormal;

    // move from RTC to EC
    position = u_modifiedModelView * position;
    right = czm_normal * right;

    // Push for width in a direction that is in the start or end plane and in a plane with right
    // N = normalEC ("right-facing" direction for push)
    // R = right
    // p = angle between N and R
    // w = distance to push along R if R == N
    // d = distance to push along N
    //
    //   N   R
    //  {  p| }      * cos(p) = dot(N, R) = w / d
    //  d  |  |w    * d = w / dot(N, R)
    //    { | }
    //       o---------- polyline segment ---->
    //
    vec3 scratchNormal = mix(-startFaceNormalAndVertexCorner.xyz, endFaceNormalAndHalfWidth.xyz, isEnd);
    scratchNormal = cross(scratchNormal, mix(startEllipsoidNormal, endEllipsoidNormal, isEnd));
    vec3 miterPushNormal = czm_normal * normalize(scratchNormal);

    offset = 2.0 * endFaceNormalAndHalfWidth.w * max(0.0, czm_metersPerPixel(position)); // offset = widthEC
    offset = offset / dot(miterPushNormal, right);
    position.xyz += miterPushNormal * (offset * sign(0.5 - mod(startFaceNormalAndVertexCorner.w, 2.0)));

    gl_Position = czm_depthClamp(czm_projection * position);

    position = u_modifiedModelView * vec4(startPositionAndHeight.xyz, 1.0);
    vec3 startNormalEC = czm_normal * startFaceNormalAndVertexCorner.xyz;
    v_startPlaneEC = vec4(startNormalEC, -dot(startNormalEC, position.xyz));
    v_rightPlaneEC = vec4(right, -dot(right, position.xyz));

    position = u_modifiedModelView * vec4(endPositionAndHeight.xyz, 1.0);
    vec3 endNormalEC = czm_normal * endFaceNormalAndHalfWidth.xyz;
    v_endPlaneEC = vec4(endNormalEC, -dot(endNormalEC, position.xyz));
    v_halfWidth = endFaceNormalAndHalfWidth.w;
}
`;var SB=`in vec4 v_startPlaneEC;
in vec4 v_endPlaneEC;
in vec4 v_rightPlaneEC;
in float v_halfWidth;
in vec3 v_volumeUpEC;

uniform vec4 u_highlightColor;
void main()
{
    float logDepthOrDepth = czm_branchFreeTernary(czm_sceneMode == czm_sceneMode2D, gl_FragCoord.z, czm_unpackDepth(texture(czm_globeDepthTexture, gl_FragCoord.xy / czm_viewport.zw)));

    // Discard for sky
    if (logDepthOrDepth == 0.0) {
#ifdef DEBUG_SHOW_VOLUME
        out_FragColor = vec4(0.0, 0.0, 1.0, 0.5);
        return;
#else // DEBUG_SHOW_VOLUME
        discard;
#endif // DEBUG_SHOW_VOLUME
    }

    vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);
    eyeCoordinate /= eyeCoordinate.w;

    float halfMaxWidth = v_halfWidth * czm_metersPerPixel(eyeCoordinate);

    // Expand halfMaxWidth if direction to camera is almost perpendicular with the volume's up direction
    halfMaxWidth += halfMaxWidth * (1.0 - dot(-normalize(eyeCoordinate.xyz), v_volumeUpEC));

    // Check distance of the eye coordinate against the right-facing plane
    float widthwiseDistance = czm_planeDistance(v_rightPlaneEC, eyeCoordinate.xyz);

    // Check eye coordinate against the mitering planes
    float distanceFromStart = czm_planeDistance(v_startPlaneEC, eyeCoordinate.xyz);
    float distanceFromEnd = czm_planeDistance(v_endPlaneEC, eyeCoordinate.xyz);

    if (abs(widthwiseDistance) > halfMaxWidth || distanceFromStart < 0.0 || distanceFromEnd < 0.0) {
#ifdef DEBUG_SHOW_VOLUME
        out_FragColor = vec4(logDepthOrDepth, 0.0, 0.0, 0.5);
        return;
#else // DEBUG_SHOW_VOLUME
        discard;
#endif // DEBUG_SHOW_VOLUME
    }
    out_FragColor = u_highlightColor;

    czm_writeDepthClamp();
}
`;function Bp(e){this._positions=e.positions,this._widths=e.widths,this._counts=e.counts,this._batchIds=e.batchIds,this._ellipsoid=x(e.ellipsoid,ee.WGS84),this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._center=e.center,this._rectangle=e.rectangle,this._batchTable=e.batchTable,this._va=void 0,this._sp=void 0,this._rs=void 0,this._uniformMap=void 0,this._command=void 0,this._transferrableBatchIds=void 0,this._packedBuffer=void 0,this._minimumMaximumVectorHeights=new H(di._defaultMinTerrainHeight,di._defaultMaxTerrainHeight),this._boundingVolume=wn.fromRectangle(e.rectangle,di._defaultMinTerrainHeight,di._defaultMaxTerrainHeight,this._ellipsoid),this._classificationType=e.classificationType,this._keepDecodedPositions=e.keepDecodedPositions,this._decodedPositions=void 0,this._decodedPositionOffsets=void 0,this._startEllipsoidNormals=void 0,this._endEllipsoidNormals=void 0,this._startPositionAndHeights=void 0,this._startFaceNormalAndVertexCornerIds=void 0,this._endPositionAndHeights=void 0,this._endFaceNormalAndHalfWidths=void 0,this._vertexBatchIds=void 0,this._indices=void 0,this._constantColor=G.clone(G.WHITE),this._highlightColor=this._constantColor,this._trianglesLength=0,this._geometryByteLength=0,this._ready=!1,this._promise=void 0,this._error=void 0}Object.defineProperties(Bp.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},ready:{get:function(){return this._ready}}});function zqe(e,t,n){let i=di.getMinimumMaximumHeights(t,n),o=i.minimumTerrainHeight,r=i.maximumTerrainHeight,s=e._minimumMaximumVectorHeights;s.x=o,s.y=r;let a=e._boundingVolume,c=e._rectangle;wn.fromRectangle(c,o,r,n,a)}function Hqe(e){let t=e._rectangle,n=e._minimumHeight,i=e._maximumHeight,o=e._ellipsoid,r=e._center,s=2+se.packedLength+ee.packedLength+h.packedLength,a=new Float64Array(s),c=0;return a[c++]=n,a[c++]=i,se.pack(t,a,c),c+=se.packedLength,ee.pack(o,a,c),c+=ee.packedLength,h.pack(r,a,c),a}var Gqe=new xi("createVectorTileClampedPolylines"),Hg={startEllipsoidNormal:0,endEllipsoidNormal:1,startPositionAndHeight:2,endPositionAndHeight:3,startFaceNormalAndVertexCorner:4,endFaceNormalAndHalfWidth:5,a_batchId:6};function Wqe(e,t){if(u(e._va))return;let n=e._positions,i=e._widths,o=e._counts,r=e._transferrableBatchIds,s=e._packedBuffer;u(s)||(n=e._positions=n.slice(),i=e._widths=i.slice(),o=e._counts=o.slice(),r=e._transferrableBatchIds=e._batchIds.slice(),s=e._packedBuffer=Hqe(e));let a=[n.buffer,i.buffer,o.buffer,r.buffer,s.buffer],c={positions:n.buffer,widths:i.buffer,counts:o.buffer,batchIds:r.buffer,packedBuffer:s.buffer,keepDecodedPositions:e._keepDecodedPositions},l=Gqe.scheduleTask(c,a);if(u(l))return l.then(function(f){if(e.isDestroyed())return;e._keepDecodedPositions&&(e._decodedPositions=new Float64Array(f.decodedPositions),e._decodedPositionOffsets=new Uint32Array(f.decodedPositionOffsets)),e._startEllipsoidNormals=new Float32Array(f.startEllipsoidNormals),e._endEllipsoidNormals=new Float32Array(f.endEllipsoidNormals),e._startPositionAndHeights=new Float32Array(f.startPositionAndHeights),e._startFaceNormalAndVertexCornerIds=new Float32Array(f.startFaceNormalAndVertexCornerIds),e._endPositionAndHeights=new Float32Array(f.endPositionAndHeights),e._endFaceNormalAndHalfWidths=new Float32Array(f.endFaceNormalAndHalfWidths),e._vertexBatchIds=new Uint16Array(f.vertexBatchIds);let d=f.indexDatatype;e._indices=d===Be.UNSIGNED_SHORT?new Uint16Array(f.indices):new Uint32Array(f.indices),jqe(e,t),e._ready=!0}).catch(f=>{e.isDestroyed()||(e._error=f)})}function jqe(e,t){if(!u(e._va)){let n=e._startEllipsoidNormals,i=e._endEllipsoidNormals,o=e._startPositionAndHeights,r=e._endPositionAndHeights,s=e._startFaceNormalAndVertexCornerIds,a=e._endFaceNormalAndHalfWidths,c=e._vertexBatchIds,l=e._indices,f=n.byteLength+i.byteLength;f+=o.byteLength+r.byteLength,f+=s.byteLength+a.byteLength,f+=c.byteLength+l.byteLength,e._trianglesLength=l.length/3,e._geometryByteLength=f;let d=xt.createVertexBuffer({context:t,typedArray:n,usage:ke.STATIC_DRAW}),p=xt.createVertexBuffer({context:t,typedArray:i,usage:ke.STATIC_DRAW}),g=xt.createVertexBuffer({context:t,typedArray:o,usage:ke.STATIC_DRAW}),m=xt.createVertexBuffer({context:t,typedArray:r,usage:ke.STATIC_DRAW}),y=xt.createVertexBuffer({context:t,typedArray:s,usage:ke.STATIC_DRAW}),b=xt.createVertexBuffer({context:t,typedArray:a,usage:ke.STATIC_DRAW}),C=xt.createVertexBuffer({context:t,typedArray:c,usage:ke.STATIC_DRAW}),A=xt.createIndexBuffer({context:t,typedArray:l,usage:ke.STATIC_DRAW,indexDatatype:l.BYTES_PER_ELEMENT===2?Be.UNSIGNED_SHORT:Be.UNSIGNED_INT}),T=[{index:Hg.startEllipsoidNormal,vertexBuffer:d,componentDatatype:K.FLOAT,componentsPerAttribute:3},{index:Hg.endEllipsoidNormal,vertexBuffer:p,componentDatatype:K.FLOAT,componentsPerAttribute:3},{index:Hg.startPositionAndHeight,vertexBuffer:g,componentDatatype:K.FLOAT,componentsPerAttribute:4},{index:Hg.endPositionAndHeight,vertexBuffer:m,componentDatatype:K.FLOAT,componentsPerAttribute:4},{index:Hg.startFaceNormalAndVertexCorner,vertexBuffer:y,componentDatatype:K.FLOAT,componentsPerAttribute:4},{index:Hg.endFaceNormalAndHalfWidth,vertexBuffer:b,componentDatatype:K.FLOAT,componentsPerAttribute:4},{index:Hg.a_batchId,vertexBuffer:C,componentDatatype:K.UNSIGNED_SHORT,componentsPerAttribute:1}];e._va=new ii({context:t,attributes:T,indexBuffer:A}),e._positions=void 0,e._widths=void 0,e._counts=void 0,e._ellipsoid=void 0,e._minimumHeight=void 0,e._maximumHeight=void 0,e._rectangle=void 0,e._transferrableBatchIds=void 0,e._packedBuffer=void 0,e._startEllipsoidNormals=void 0,e._endEllipsoidNormals=void 0,e._startPositionAndHeights=void 0,e._startFaceNormalAndVertexCornerIds=void 0,e._endPositionAndHeights=void 0,e._endFaceNormalAndHalfWidths=void 0,e._vertexBatchIds=void 0,e._indices=void 0}}var Gw=new F,Nce=new h;function qqe(e,t){u(e._uniformMap)||(e._uniformMap={u_modifiedModelView:function(){let n=t.uniformState.view;return F.clone(n,Gw),F.multiplyByPoint(Gw,e._center,Nce),F.setTranslation(Gw,Nce,Gw),Gw},u_highlightColor:function(){return e._highlightColor},u_minimumMaximumVectorHeights:function(){return e._minimumMaximumVectorHeights}})}function Fce(e){return Ue.fromCache({cull:{enabled:!0,face:Ci.FRONT},blending:un.PRE_MULTIPLIED_ALPHA_BLEND,depthMask:!1,stencilTest:{enabled:e,frontFunction:Un.EQUAL,frontOperation:{fail:mt.KEEP,zFail:mt.KEEP,zPass:mt.KEEP},backFunction:Un.EQUAL,backOperation:{fail:mt.KEEP,zFail:mt.KEEP,zPass:mt.KEEP},reference:Ut.CESIUM_3D_TILE_MASK,mask:Ut.CESIUM_3D_TILE_MASK}})}function Yqe(e){u(e._rs)||(e._rs=Fce(!1),e._rs3DTiles=Fce(!0))}function Xqe(e,t){if(u(e._sp))return;let n=e._batchTable,i=n.getVertexShaderCallback(!1,"a_batchId",void 0)(EB),o=n.getFragmentShaderCallback(!1,void 0,!0)(SB),r=new ze({defines:["VECTOR_TILE",Wt.isInternetExplorer()?"":"CLIP_POLYLINE"],sources:[rf,i]}),s=new ze({defines:["VECTOR_TILE"],sources:[o]});e._sp=tn.fromCache({context:t,vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:Hg})}function Kqe(e,t){let n=e._command;if(!u(e._command)){let o=e._batchTable.getUniformMapCallback()(e._uniformMap);n=e._command=new Qe({owner:e,vertexArray:e._va,renderState:e._rs,shaderProgram:e._sp,uniformMap:o,boundingVolume:e._boundingVolume,pass:we.TERRAIN_CLASSIFICATION,pickId:e._batchTable.getPickId()});let r=Qe.shallowClone(n,n.derivedCommands.tileset);r.renderState=e._rs3DTiles,r.pass=we.CESIUM_3D_TILE_CLASSIFICATION,n.derivedCommands.tileset=r}let i=e._classificationType;(i===Vn.TERRAIN||i===Vn.BOTH)&&t.commandList.push(n),(i===Vn.CESIUM_3D_TILE||i===Vn.BOTH)&&t.commandList.push(n.derivedCommands.tileset)}Bp.prototype.getPositions=function(e){return KA.getPolylinePositions(this,e)};Bp.prototype.createFeatures=function(e,t){let n=this._batchIds,i=n.length;for(let o=0;o<i;++o){let r=n[o];t[r]=new ta(e,r)}};Bp.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:this._constantColor};function Zqe(e,t){let n=e._batchIds,i=n.length;for(let o=0;o<i;++o){let r=n[o],s=t[r];s.show=!0,s.color=G.WHITE}}var $qe=new G,Qqe=G.WHITE,Jqe=!0;Bp.prototype.applyStyle=function(e,t){if(!u(e)){Zqe(this,t);return}let n=this._batchIds,i=n.length;for(let o=0;o<i;++o){let r=n[o],s=t[r];s.color=u(e.color)?e.color.evaluateColor(s,$qe):Qqe,s.show=u(e.show)?e.show.evaluate(s):Jqe}};function eYe(e){return di.initialize().then(function(){zqe(e,e._rectangle,e._ellipsoid)}).catch(t=>{e.isDestroyed()||(e._error=t)})}Bp.prototype.update=function(e){let t=e.context;if(!this._ready){if(u(this._promise)||(this._promise=eYe(this).then(Wqe(this,t))),u(this._error)){let i=this._error;throw this._error=void 0,i}return}qqe(this,t),Xqe(this,t),Yqe(this);let n=e.passes;(n.render||n.pick)&&Kqe(this,e)};Bp.prototype.isDestroyed=function(){return!1};Bp.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),ue(this)};var vB=Bp;var P7=32767,tYe=new de,nYe=new h;function iYe(e,t,n,i,o){let r=e.length/3,s=e.subarray(0,r),a=e.subarray(r,2*r),c=e.subarray(2*r,3*r);Ln.zigZagDeltaDecode(s,a,c);let l=new Float64Array(e.length);for(let f=0;f<r;++f){let d=s[f],p=a[f],g=c[f],m=R.lerp(t.west,t.east,d/P7),y=R.lerp(t.south,t.north,p/P7),b=R.lerp(n,i,g/P7),C=de.fromRadians(m,y,b,tYe),A=o.cartographicToCartesian(C,nYe);h.pack(A,l,f*3)}return l}var wB=iYe;function wd(e,t,n,i,o){this._tileset=e,this._tile=t,this._resource=n,this._polygons=void 0,this._polylines=void 0,this._points=void 0,this._metadata=void 0,this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,this._group=void 0,this._ready=!1,cYe(this,i,o)}Object.defineProperties(wd.prototype,{featuresLength:{get:function(){return u(this._batchTable)?this._batchTable.featuresLength:0}},pointsLength:{get:function(){return u(this._points)?this._points.pointsLength:0}},trianglesLength:{get:function(){let e=0;return u(this._polygons)&&(e+=this._polygons.trianglesLength),u(this._polylines)&&(e+=this._polylines.trianglesLength),e}},geometryByteLength:{get:function(){let e=0;return u(this._polygons)&&(e+=this._polygons.geometryByteLength),u(this._polylines)&&(e+=this._polylines.geometryByteLength),e}},texturesByteLength:{get:function(){return u(this._points)?this._points.texturesByteLength:0}},batchTableByteLength:{get:function(){return u(this._batchTable)?this._batchTable.batchTableByteLength:0}},innerContents:{get:function(){}},ready:{get:function(){return this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e}},batchTable:{get:function(){return this._batchTable}},group:{get:function(){return this._group},set:function(e){this._group=e}}});function oYe(e){return function(t,n){u(e._polygons)&&e._polygons.updateCommands(t,n)}}function rYe(e,t){let n,i,o,r,s=x(e.POLYGONS_LENGTH,0),a=x(e.POLYLINES_LENGTH,0),c=x(e.POINTS_LENGTH,0);if(s>0&&u(e.POLYGON_BATCH_IDS)){let p=t.byteOffset+e.POLYGON_BATCH_IDS.byteOffset;n=new Uint16Array(t.buffer,p,s)}if(a>0&&u(e.POLYLINE_BATCH_IDS)){let p=t.byteOffset+e.POLYLINE_BATCH_IDS.byteOffset;i=new Uint16Array(t.buffer,p,a)}if(c>0&&u(e.POINT_BATCH_IDS)){let p=t.byteOffset+e.POINT_BATCH_IDS.byteOffset;o=new Uint16Array(t.buffer,p,c)}let l=u(n)||u(i)||u(o),f=s>0&&!u(n)||a>0&&!u(i)||c>0&&!u(o);if(l&&f)throw new ce("If one group of batch ids is defined, then all batch ids must be defined");if(!u(n)&&!u(i)&&!u(o)){let p=0;if(!u(n)&&s>0)for(n=new Uint16Array(s),r=0;r<s;++r)n[r]=p++;if(!u(i)&&a>0)for(i=new Uint16Array(a),r=0;r<a;++r)i[r]=p++;if(!u(o)&&c>0)for(o=new Uint16Array(c),r=0;r<c;++r)o[r]=p++}return{polygons:n,polylines:i,points:o}}var vd=Uint32Array.BYTES_PER_ELEMENT;function sYe(e){return new KA(e)}function aYe(e){return new vB(e)}function cYe(e,t,n){n=x(n,0);let i=new Uint8Array(t),o=new DataView(t);n+=vd;let r=o.getUint32(n,!0);if(r!==1)throw new ce(`Only Vector tile version 1 is supported.  Version ${r} is not.`);n+=vd;let s=o.getUint32(n,!0);if(n+=vd,s===0){e._ready=!0;return}let a=o.getUint32(n,!0);if(n+=vd,a===0)throw new ce("Feature table must have a byte length greater than zero");let c=o.getUint32(n,!0);n+=vd;let l=o.getUint32(n,!0);n+=vd;let f=o.getUint32(n,!0);n+=vd;let d=o.getUint32(n,!0);n+=vd;let p=o.getUint32(n,!0);n+=vd;let g=o.getUint32(n,!0);n+=vd;let m=o.getUint32(n,!0);n+=vd;let y=Uo(i,n,a);n+=a;let b=new Uint8Array(t,n,c);n+=c;let C,A;l>0&&(C=Uo(i,n,l),n+=l,f>0&&(A=new Uint8Array(t,n,f),A=new Uint8Array(A),n+=f));let T=x(y.POLYGONS_LENGTH,0),E=x(y.POLYLINES_LENGTH,0),v=x(y.POINTS_LENGTH,0),D=T+E+v,O=new ng(e,D,C,A,oYe(e));if(e._batchTable=O,D===0)return;let P=new Zh(y,b),M=P.getGlobalProperty("REGION");if(!u(M))throw new ce("Feature table global property: REGION must be defined");let L=se.unpack(M),_=M[4],S=M[5],w=e._tile.computedTransform,I=P.getGlobalProperty("RTC_CENTER",K.FLOAT,3);u(I)?(I=h.unpack(I),F.multiplyByPoint(w,I,I)):(I=se.center(L),I.height=R.lerp(_,S,.5),I=ee.WGS84.cartographicToCartesian(I));let N=rYe(y,b);if(n+=(4-n%4)%4,T>0){P.featuresLength=T;let k=x(P.getPropertyArray("POLYGON_COUNTS",K.UNSIGNED_INT,1),P.getPropertyArray("POLYGON_COUNT",K.UNSIGNED_INT,1));if(!u(k))throw new ce("Feature table property: POLYGON_COUNTS must be defined when POLYGONS_LENGTH is greater than 0");let z=x(P.getPropertyArray("POLYGON_INDEX_COUNTS",K.UNSIGNED_INT,1),P.getPropertyArray("POLYGON_INDEX_COUNT",K.UNSIGNED_INT,1));if(!u(z))throw new ce("Feature table property: POLYGON_INDEX_COUNTS must be defined when POLYGONS_LENGTH is greater than 0");let V=k.reduce(function(q,X){return q+X*2},0),U=z.reduce(function(q,X){return q+X},0),B=new Uint32Array(t,n,U);n+=d;let W=new Uint16Array(t,n,V);n+=p;let j,Q;u(y.POLYGON_MINIMUM_HEIGHTS)&&u(y.POLYGON_MAXIMUM_HEIGHTS)&&(j=P.getPropertyArray("POLYGON_MINIMUM_HEIGHTS",K.FLOAT,1),Q=P.getPropertyArray("POLYGON_MAXIMUM_HEIGHTS",K.FLOAT,1)),e._polygons=new AB({positions:W,counts:k,indexCounts:z,indices:B,minimumHeight:_,maximumHeight:S,polygonMinimumHeights:j,polygonMaximumHeights:Q,center:I,rectangle:L,boundingVolume:e.tile.boundingVolume.boundingVolume,batchTable:O,batchIds:N.polygons,modelMatrix:w})}if(E>0){P.featuresLength=E;let k=x(P.getPropertyArray("POLYLINE_COUNTS",K.UNSIGNED_INT,1),P.getPropertyArray("POLYLINE_COUNT",K.UNSIGNED_INT,1));if(!u(k))throw new ce("Feature table property: POLYLINE_COUNTS must be defined when POLYLINES_LENGTH is greater than 0");let z=P.getPropertyArray("POLYLINE_WIDTHS",K.UNSIGNED_SHORT,1);if(!u(z)){z=new Uint16Array(E);for(let Q=0;Q<E;++Q)z[Q]=2}let V=k.reduce(function(Q,q){return Q+q*3},0),U=new Uint16Array(t,n,V);n+=g;let B=e._tileset,W=B.examineVectorLinesFunction;if(u(W)){let Q=wB(new Uint16Array(U),L,_,S,ee.WGS84);lYe(Q,k,N.polylines,O,e.url,W)}let j=sYe;u(B.classificationType)&&(j=aYe),e._polylines=j({positions:U,widths:z,counts:k,batchIds:N.polylines,minimumHeight:_,maximumHeight:S,center:I,rectangle:L,boundingVolume:e.tile.boundingVolume.boundingVolume,batchTable:O,classificationType:B.classificationType,keepDecodedPositions:B.vectorKeepDecodedPositions})}if(v>0){let k=new Uint16Array(t,n,v*3);n+=m,e._points=new CB({positions:k,batchIds:N.points,minimumHeight:_,maximumHeight:S,rectangle:L,batchTable:O})}}function R7(e){let t=e.featuresLength;if(!u(e._features)&&t>0){let n=new Array(t);u(e._polygons)&&e._polygons.createFeatures(e,n),u(e._polylines)&&e._polylines.createFeatures(e,n),u(e._points)&&e._points.createFeatures(e,n),e._features=n}}wd.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)};wd.prototype.getFeature=function(e){return u(this._features)||R7(this),this._features[e]};wd.prototype.applyDebugSettings=function(e,t){u(this._polygons)&&this._polygons.applyDebugSettings(e,t),u(this._polylines)&&this._polylines.applyDebugSettings(e,t),u(this._points)&&this._points.applyDebugSettings(e,t)};wd.prototype.applyStyle=function(e){u(this._features)||R7(this),u(this._polygons)&&this._polygons.applyStyle(e,this._features),u(this._polylines)&&this._polylines.applyStyle(e,this._features),u(this._points)&&this._points.applyStyle(e,this._features)};wd.prototype.update=function(e,t){let n=!0;u(this._polygons)&&(this._polygons.classificationType=this._tileset.classificationType,this._polygons.debugWireframe=this._tileset.debugWireframe,this._polygons.update(t),n=n&&this._polygons.ready),u(this._polylines)&&(this._polylines.update(t),n=n&&this._polylines.ready),u(this._points)&&(this._points.update(t),n=n&&this._points.ready),u(this._batchTable)&&n&&(u(this._features)||R7(this),this._batchTable.update(e,t),this._ready=!0)};wd.prototype.pick=function(e,t,n){};wd.prototype.getPolylinePositions=function(e){let t=this._polylines;if(u(t))return t.getPositions(e)};wd.prototype.isDestroyed=function(){return!1};wd.prototype.destroy=function(){return this._polygons=this._polygons&&this._polygons.destroy(),this._polylines=this._polylines&&this._polylines.destroy(),this._points=this._points&&this._points.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),ue(this)};function lYe(e,t,n,i,o,r){let s=t.length,a=0;for(let c=0;c<s;c++){let l=t[c]*3,f=e.slice(a,a+l);a+=l,r(f,n[c],o,i)}}var DB=wd;var Bce={b3dm:function(e,t,n,i,o){return Rp.fromB3dm(e,t,n,i,o)},pnts:function(e,t,n,i,o){return Rp.fromPnts(e,t,n,i,o)},i3dm:function(e,t,n,i,o){return Rp.fromI3dm(e,t,n,i,o)},cmpt:function(e,t,n,i,o){return YL.fromTileType(e,t,n,i,o,Bce)},externalTileset:function(e,t,n,i){return aB.fromJson(e,t,n,i)},geom:function(e,t,n,i,o){return new tN(e,t,n,i,o)},vctr:function(e,t,n,i,o){return new DB(e,t,n,i,o)},subt:function(e,t,n,i,o){return rw.fromSubtreeJson(e,t,n,void 0,i,o)},subtreeJson:function(e,t,n,i){return rw.fromSubtreeJson(e,t,n,i)},glb:function(e,t,n,i,o){if(i.byteLength<12)throw new ce("Invalid glb content");let a=new DataView(i,o).getUint32(8,!0),c=new Uint8Array(i,o,a);return Rp.fromGltf(e,t,n,c)},gltf:function(e,t,n,i){return Rp.fromGltf(e,t,n,i)},geoJson:function(e,t,n,i){return Rp.fromGeoJson(e,t,n,i)}},ZA=Bce;var uYe={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},Qo=Object.freeze(uYe);var Dd={BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",COMPOSITE:"cmpt",POINT_CLOUD:"pnts",VECTOR:"vctr",GEOMETRY:"geom",GLTF:"gltf",GLTF_BINARY:"glb",IMPLICIT_SUBTREE:"subt",IMPLICIT_SUBTREE_JSON:"subtreeJson",EXTERNAL_TILESET:"externalTileset",MULTIPLE_CONTENT:"multipleContent",GEOJSON:"geoJson",VOXEL_BINARY:"voxl",VOXEL_JSON:"voxelJson"};Dd.isBinaryFormat=function(e){switch(e){case Dd.BATCHED_3D_MODEL:case Dd.INSTANCED_3D_MODEL:case Dd.COMPOSITE:case Dd.POINT_CLOUD:case Dd.VECTOR:case Dd.GEOMETRY:case Dd.IMPLICIT_SUBTREE:case Dd.VOXEL_BINARY:case Dd.GLTF_BINARY:return!0;default:return!1}};var Us=Object.freeze(Dd);var fYe={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0},Id=Object.freeze(fYe);var zs={RENDER:0,PICK:1,SHADOW:2,PRELOAD:3,PRELOAD_FLIGHT:4,REQUEST_RENDER_MODE_DEFER_CHECK:5,MOST_DETAILED_PRELOAD:6,MOST_DETAILED_PICK:7,NUMBER_OF_PASSES:8},kp=new Array(zs.NUMBER_OF_PASSES);kp[zs.RENDER]=Object.freeze({pass:zs.RENDER,isRender:!0,requestTiles:!0,ignoreCommands:!1});kp[zs.PICK]=Object.freeze({pass:zs.PICK,isRender:!1,requestTiles:!1,ignoreCommands:!1});kp[zs.SHADOW]=Object.freeze({pass:zs.SHADOW,isRender:!1,requestTiles:!0,ignoreCommands:!1});kp[zs.PRELOAD]=Object.freeze({pass:zs.PRELOAD,isRender:!1,requestTiles:!0,ignoreCommands:!0});kp[zs.PRELOAD_FLIGHT]=Object.freeze({pass:zs.PRELOAD_FLIGHT,isRender:!1,requestTiles:!0,ignoreCommands:!0});kp[zs.REQUEST_RENDER_MODE_DEFER_CHECK]=Object.freeze({pass:zs.REQUEST_RENDER_MODE_DEFER_CHECK,isRender:!1,requestTiles:!0,ignoreCommands:!0});kp[zs.MOST_DETAILED_PRELOAD]=Object.freeze({pass:zs.MOST_DETAILED_PRELOAD,isRender:!1,requestTiles:!0,ignoreCommands:!0});kp[zs.MOST_DETAILED_PICK]=Object.freeze({pass:zs.MOST_DETAILED_PICK,isRender:!1,requestTiles:!1,ignoreCommands:!1});zs.getPassOptions=function(e){return kp[e]};var Ho=Object.freeze(zs);function om(e,t){this._tileset=e,this._tile=t,this.featurePropertiesDirty=!1}Object.defineProperties(om.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},ready:{get:function(){return!0}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){}},metadata:{get:function(){},set:function(e){}},batchTable:{get:function(){}},group:{get:function(){},set:function(e){}}});om.prototype.hasProperty=function(e,t){return!1};om.prototype.getFeature=function(e){};om.prototype.applyDebugSettings=function(e,t){};om.prototype.applyStyle=function(e){};om.prototype.update=function(e,t){};om.prototype.pick=function(e,t,n){};om.prototype.isDestroyed=function(){return!1};om.prototype.destroy=function(){return ue(this)};var Ww=om;function Vp(e){e=x(e,x.EMPTY_OBJECT);let t=e.content,n=e.class;this._class=n,this._properties=t.properties,this._extensions=t.extensions,this._extras=t.extras}Object.defineProperties(Vp.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});Vp.prototype.hasProperty=function(e){return Bn.hasProperty(e,this._properties,this._class)};Vp.prototype.hasPropertyBySemantic=function(e){return Bn.hasPropertyBySemantic(e,this._properties,this._class)};Vp.prototype.getPropertyIds=function(e){return Bn.getPropertyIds(this._properties,this._class,e)};Vp.prototype.getProperty=function(e){return Bn.getProperty(e,this._properties,this._class)};Vp.prototype.setProperty=function(e,t){return Bn.setProperty(e,t,this._properties,this._class)};Vp.prototype.getPropertyBySemantic=function(e){return Bn.getPropertyBySemantic(e,this._properties,this._class)};Vp.prototype.setPropertyBySemantic=function(e,t){return Bn.setPropertyBySemantic(e,t,this._properties,this._class)};var IB=Vp;function O7(e,t){let n=si(t,"3DTILES_metadata")?t.extensions["3DTILES_metadata"]:t.metadata;if(!u(n))return;if(!u(e.schema)){O7._oneTimeWarning("findContentMetadata-missing-root-schema","Could not find a metadata schema for content metadata. For tilesets that contain external tilesets, make sure the schema is added to the root tileset.json.");return}let i=x(e.schema.classes,x.EMPTY_OBJECT);if(u(n.class)){let o=i[n.class];return new IB({content:n,class:o})}}O7._oneTimeWarning=At;var $A=O7;function dYe(e,t){let n=e.metadataExtension;if(!u(n))return;let i=n.groups,o=si(t,"3DTILES_metadata")?t.extensions["3DTILES_metadata"].group:t.group;if(typeof o=="number")return i[o];let r=n.groupIds.findIndex(function(s){return s===o});return r>=0?i[r]:void 0}var QA=dYe;function Up(e){e=x(e,x.EMPTY_OBJECT);let t=e.tile,n=e.class;this._class=n,this._properties=t.properties,this._extensions=t.extensions,this._extras=t.extras}Object.defineProperties(Up.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});Up.prototype.hasProperty=function(e){return Bn.hasProperty(e,this._properties,this._class)};Up.prototype.hasPropertyBySemantic=function(e){return Bn.hasPropertyBySemantic(e,this._properties,this._class)};Up.prototype.getPropertyIds=function(e){return Bn.getPropertyIds(this._properties,this._class,e)};Up.prototype.getProperty=function(e){return Bn.getProperty(e,this._properties,this._class)};Up.prototype.setProperty=function(e,t){return Bn.setProperty(e,t,this._properties,this._class)};Up.prototype.getPropertyBySemantic=function(e){return Bn.getPropertyBySemantic(e,this._properties,this._class)};Up.prototype.setPropertyBySemantic=function(e,t){return Bn.setPropertyBySemantic(e,t,this._properties,this._class)};var PB=Up;function M7(e,t){let n=si(t,"3DTILES_metadata")?t.extensions["3DTILES_metadata"]:t.metadata;if(!u(n))return;if(!u(e.schema)){M7._oneTimeWarning("findTileMetadata-missing-root-schema","Could not find a metadata schema for tile metadata. For tilesets that contain external tilesets, make sure the schema is added to the root tileset.json.");return}let i=x(e.schema.classes,x.EMPTY_OBJECT);if(u(n.class)){let o=i[n.class];return new PB({tile:n,class:o})}}M7._oneTimeWarning=At;var RB=M7;function hYe(e){let t=new Uint8Array(e),n=zh(t);if(n==="glTF"&&(n="glb"),Us.isBinaryFormat(n))return{contentType:n,binaryPayload:t};let i=mYe(t);if(u(i.root))return{contentType:Us.EXTERNAL_TILESET,jsonPayload:i};if(u(i.asset))return{contentType:Us.GLTF,jsonPayload:i};if(u(i.tileAvailability))return{contentType:Us.IMPLICIT_SUBTREE_JSON,jsonPayload:i};if(u(i.type))return{contentType:Us.GEOJSON,jsonPayload:i};if(u(i.voxelTable))return{contentType:Us.VOXEL_JSON,jsonPayload:i};throw new ce("Invalid tile content.")}function mYe(e){let t;try{t=Uo(e)}catch{throw new ce("Invalid tile content.")}return t}var zp=hYe;function Sf(e,t,n,i){this._tileset=e,this._tile=t,this._tilesetResource=n,this._contents=[],this._contentsCreated=!1;let o=u(i.contents)?i.contents:i.content;this._innerContentHeaders=o,this._requestsInFlight=0,this._cancelCount=0;let r=this._innerContentHeaders.length;this._arrayFetchPromises=new Array(r),this._requests=new Array(r),this._ready=!1,this._innerContentResources=new Array(r),this._serverKeys=new Array(r);for(let s=0;s<r;s++){let a=n.getDerivedResource({url:o[s].uri}),c=Cc.getServerKey(a.getUrlComponent());this._innerContentResources[s]=a,this._serverKeys[s]=c}}Object.defineProperties(Sf.prototype,{featurePropertiesDirty:{get:function(){let e=this._contents,t=e.length;for(let n=0;n<t;++n)if(e[n].featurePropertiesDirty)return!0;return!1},set:function(e){let t=this._contents,n=t.length;for(let i=0;i<n;++i)t[i].featurePropertiesDirty=e}},featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){return this._contents}},ready:{get:function(){return this._contentsCreated?this._ready:!1}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){}},metadata:{get:function(){},set:function(){}},batchTable:{get:function(){}},group:{get:function(){},set:function(){}},innerContentUrls:{get:function(){return this._innerContentHeaders.map(function(e){return e.uri})}}});function L7(e,t){e._requestsInFlight+=t,e.tileset.statistics.numberOfPendingRequests+=t}function kce(e,t){e._cancelCount++,e._tile._contentState=t;let n=e.tileset.statistics;n.numberOfPendingRequests-=e._requestsInFlight,n.numberOfAttemptedRequests+=e._requestsInFlight,e._requestsInFlight=0;let i=e._innerContentHeaders.length;e._arrayFetchPromises=new Array(i)}Sf.prototype.requestInnerContents=function(){if(!pYe(this._serverKeys)){this.tileset.statistics.numberOfAttemptedRequests+=this._serverKeys.length;return}let e=this._innerContentHeaders;L7(this,e.length);let t=this._cancelCount;for(let n=0;n<e.length;n++)this._arrayFetchPromises[n]=_Ye(this,n,t,this._tile._contentState);return gYe(this)};function pYe(e){let t={};for(let n=0;n<e.length;n++){let i=e[n];u(t[i])?t[i]++:t[i]=1}for(let n in t)if(t.hasOwnProperty(n)&&!Cc.serverHasOpenSlots(n,t[n]))return!1;return Cc.heapHasOpenSlots(e.length)}function _Ye(e,t,n,i){let o=e._innerContentResources[t].clone(),r=e.tile,s=function(){return r._priority},a=e._serverKeys[t],c=new rr({throttle:!0,throttleByServer:!0,type:gs.TILES3D,priorityFunction:s,serverKey:a});o.request=c,e._requests[t]=c;let l=o.fetchArrayBuffer();if(u(l))return l.then(function(f){if(!(n<e._cancelCount)){if(o.request.cancelled||o.request.state===$n.CANCELLED){kce(e,i);return}return L7(e,-1),f}}).catch(function(f){if(!(n<e._cancelCount)){if(o.request.cancelled||o.request.state===$n.CANCELLED){kce(e,i);return}L7(e,-1),Vce(e,t,f)}})}async function gYe(e){let t=e._cancelCount,n=await Promise.all(e._arrayFetchPromises);if(t<e._cancelCount)return;let i=n.map((r,s)=>yYe(e,r,s)),o=await Promise.all(i);return e._contentsCreated=!0,e._contents=o.filter(u),o}async function yYe(e,t,n){if(u(t))try{let i=zp(t);if(i.contentType===Us.EXTERNAL_TILESET)throw new ce("External tilesets are disallowed inside multiple contents");e._disableSkipLevelOfDetail=e._disableSkipLevelOfDetail||i.contentType===Us.GEOMETRY||i.contentType===Us.VECTOR;let o=e._tileset,r=e._innerContentResources[n],s=e._tile,a,c=ZA[i.contentType];u(i.binaryPayload)?a=await Promise.resolve(c(o,s,r,i.binaryPayload.buffer,0)):a=await Promise.resolve(c(o,s,r,i.jsonPayload));let l=e._innerContentHeaders[n];if(s.hasImplicitContentMetadata){let d=s.implicitSubtree,p=s.implicitCoordinates;a.metadata=d.getContentMetadataView(p,n)}else s.hasImplicitContent||(a.metadata=$A(o,l));let f=QA(o,l);return u(f)&&(a.group=new iA({metadata:f})),a}catch(i){Vce(e,n,i)}}function Vce(e,t,n){let i=e._tileset,o=e._innerContentResources[t].url,r=u(n.message)?n.message:n.toString();i.tileFailed.numberOfListeners>0?i.tileFailed.raiseEvent({url:o,message:r}):(console.log(`A content failed to load: ${o}`),console.log(`Error: ${r}`))}Sf.prototype.cancelRequests=function(){for(let e=0;e<this._requests.length;e++){let t=this._requests[e];u(t)&&t.cancel()}};Sf.prototype.hasProperty=function(e,t){return!1};Sf.prototype.getFeature=function(e){};Sf.prototype.applyDebugSettings=function(e,t){let n=this._contents,i=n.length;for(let o=0;o<i;++o)n[o].applyDebugSettings(e,t)};Sf.prototype.applyStyle=function(e){let t=this._contents,n=t.length;for(let i=0;i<n;++i)t[i].applyStyle(e)};Sf.prototype.update=function(e,t){let n=this._contents,i=n.length,o=!0;for(let r=0;r<i;++r)n[r].update(e,t),o=o&&n[r].ready;!this._ready&&o&&(this._ready=!0)};Sf.prototype.pick=function(e,t,n){if(!this._ready)return;let i,o=Number.POSITIVE_INFINITY,r=this._contents,s=r.length;for(let a=0;a<s;++a){let c=r[a].pick(e,t,n);if(!u(c))continue;let l=h.distance(e.origin,c);l<o&&(i=c,o=l)}if(u(i))return n};Sf.prototype.isDestroyed=function(){return!1};Sf.prototype.destroy=function(){let e=this._contents,t=e.length;for(let n=0;n<t;++n)e[n].destroy();return ue(this)};var OB=Sf;var Uce=Math.cos,zce=Math.sin,xYe=Math.sqrt,N7={};N7.computePosition=function(e,t,n,i,o,r,s){let a=t.radiiSquared,c=e.nwCorner,l=e.boundingRectangle,f=c.latitude-e.granYCos*i+o*e.granXSin,d=Uce(f),p=zce(f),g=a.z*p,m=c.longitude+i*e.granYSin+o*e.granXCos,y=d*Uce(m),b=d*zce(m),C=a.x*y,A=a.y*b,T=xYe(C*y+A*b+g*p);if(r.x=C/T,r.y=A/T,r.z=g/T,n){let E=e.stNwCorner;u(E)?(f=E.latitude-e.stGranYCos*i+o*e.stGranXSin,m=E.longitude+i*e.stGranYSin+o*e.stGranXCos,s.x=(m-e.stWest)*e.lonScalar,s.y=(f-e.stSouth)*e.latScalar):(s.x=(m-l.west)*e.lonScalar,s.y=(f-l.south)*e.latScalar)}};var bYe=new Hi,vf=new h,CYe=new de,MB=new h,jw=new Oi;function Hce(e,t,n,i,o,r,s){let a=Math.cos(t),c=i*a,l=n*a,f=Math.sin(t),d=i*f,p=n*f;jw._ellipsoid=ee.default,vf=jw.project(e,vf),vf=h.subtract(vf,MB,vf);let g=Hi.fromRotation(t,bYe);vf=Hi.multiplyByVector(g,vf,vf),vf=h.add(vf,MB,vf),e=jw.unproject(vf,e),r-=1,s-=1;let m=e.latitude,y=m+r*p,b=m-c*s,C=m-c*s+r*p,A=Math.max(m,y,b,C),T=Math.min(m,y,b,C),E=e.longitude,v=E+r*l,D=E+s*d,O=E+s*d+r*l,P=Math.max(E,v,D,O),M=Math.min(E,v,D,O);return{north:A,south:T,east:P,west:M,granYCos:c,granYSin:d,granXCos:l,granXSin:p,nwCorner:e}}N7.computeOptions=function(e,t,n,i,o,r,s){let a=e.east,c=e.west,l=e.north,f=e.south,d=!1,p=!1;l===R.PI_OVER_TWO&&(d=!0),f===-R.PI_OVER_TWO&&(p=!0);let g,m=l-f;c>a?g=R.TWO_PI-c+a:g=a-c;let y=Math.ceil(g/t)+1,b=Math.ceil(m/t)+1,C=g/(y-1),A=m/(b-1),T=se.northwest(e,r),E=se.center(e,CYe);(n!==0||i!==0)&&(E.longitude<T.longitude&&(E.longitude+=R.TWO_PI),jw._ellipsoid=ee.default,MB=jw.project(E,MB));let v=A,D=C,O=0,P=0,M=se.clone(e,o),L={granYCos:v,granYSin:O,granXCos:D,granXSin:P,nwCorner:T,boundingRectangle:M,width:y,height:b,northCap:d,southCap:p};if(n!==0){let _=Hce(T,n,C,A,E,y,b);l=_.north,f=_.south,a=_.east,c=_.west,L.granYCos=_.granYCos,L.granYSin=_.granYSin,L.granXCos=_.granXCos,L.granXSin=_.granXSin,M.north=l,M.south=f,M.east=a,M.west=c}if(i!==0){n=n-i;let _=se.northwest(M,s),S=Hce(_,n,C,A,E,y,b);L.stGranYCos=S.granYCos,L.stGranXCos=S.granXCos,L.stGranYSin=S.granYSin,L.stGranXSin=S.granXSin,L.stNwCorner=_,L.stWest=S.west,L.stSouth=S.south}return L};var Hs=N7;var AYe=new ae,TYe=new ae,EYe=new h,SYe=new se;function Gce(e,t){let n=e._ellipsoid,i=t.height,o=t.width,r=t.northCap,s=t.southCap,a=i,c=2,l=0,f=4;r&&(c-=1,a-=1,l+=1,f-=2),s&&(c-=1,a-=1,l+=1,f-=2),l+=c*o+2*a-f;let d=new Float64Array(l*3),p=0,g=0,m,y=EYe;if(r)Hs.computePosition(t,n,!1,g,0,y),d[p++]=y.x,d[p++]=y.y,d[p++]=y.z;else for(m=0;m<o;m++)Hs.computePosition(t,n,!1,g,m,y),d[p++]=y.x,d[p++]=y.y,d[p++]=y.z;for(m=o-1,g=1;g<i;g++)Hs.computePosition(t,n,!1,g,m,y),d[p++]=y.x,d[p++]=y.y,d[p++]=y.z;if(g=i-1,!s)for(m=o-2;m>=0;m--)Hs.computePosition(t,n,!1,g,m,y),d[p++]=y.x,d[p++]=y.y,d[p++]=y.z;for(m=0,g=i-2;g>0;g--)Hs.computePosition(t,n,!1,g,m,y),d[p++]=y.x,d[p++]=y.y,d[p++]=y.z;let b=d.length/3*2,C=Be.createTypedArray(d.length/3,b),A=0;for(let E=0;E<d.length/3-1;E++)C[A++]=E,C[A++]=E+1;C[A++]=d.length/3-1,C[A++]=0;let T=new ft({attributes:new hn,primitiveType:Ne.LINES});return T.attributes.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:d}),T.indices=C,T}function vYe(e,t){let n=e._surfaceHeight,i=e._extrudedHeight,o=e._ellipsoid,r=Gce(e,t),s=t.height,a=t.width,c=ai.scaleToGeodeticHeight(r.attributes.position.values,n,o,!1),l=c.length,f=new Float64Array(l*2);f.set(c);let d=ai.scaleToGeodeticHeight(r.attributes.position.values,i,o);f.set(d,l),r.attributes.position.values=f;let p=t.northCap,g=t.southCap,m=4;p&&(m-=1),g&&(m-=1);let y=(f.length/3+m)*2,b=Be.createTypedArray(f.length/3,y);l=f.length/6;let C=0;for(let T=0;T<l-1;T++)b[C++]=T,b[C++]=T+1,b[C++]=T+l,b[C++]=T+l+1;b[C++]=l-1,b[C++]=0,b[C++]=l+l-1,b[C++]=l,b[C++]=0,b[C++]=l;let A;if(p)A=s-1;else{let T=a-1;b[C++]=T,b[C++]=T+l,A=a+s-2}if(b[C++]=A,b[C++]=A+l,!g){let T=a+A-1;b[C++]=T,b[C]=T+l}return r.indices=b,r}function eT(e){e=x(e,x.EMPTY_OBJECT);let t=e.rectangle,n=x(e.granularity,R.RADIANS_PER_DEGREE),i=x(e.ellipsoid,ee.default),o=x(e.rotation,0),r=x(e.height,0),s=x(e.extrudedHeight,r);this._rectangle=se.clone(t),this._granularity=n,this._ellipsoid=i,this._surfaceHeight=Math.max(r,s),this._rotation=o,this._extrudedHeight=Math.min(r,s),this._offsetAttribute=e.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}eT.packedLength=se.packedLength+ee.packedLength+5;eT.pack=function(e,t,n){return n=x(n,0),se.pack(e._rectangle,t,n),n+=se.packedLength,ee.pack(e._ellipsoid,t,n),n+=ee.packedLength,t[n++]=e._granularity,t[n++]=e._surfaceHeight,t[n++]=e._rotation,t[n++]=e._extrudedHeight,t[n]=x(e._offsetAttribute,-1),t};var Wce=new se,jce=ee.clone(ee.UNIT_SPHERE),JA={rectangle:Wce,ellipsoid:jce,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};eT.unpack=function(e,t,n){t=x(t,0);let i=se.unpack(e,t,Wce);t+=se.packedLength;let o=ee.unpack(e,t,jce);t+=ee.packedLength;let r=e[t++],s=e[t++],a=e[t++],c=e[t++],l=e[t];return u(n)?(n._rectangle=se.clone(i,n._rectangle),n._ellipsoid=ee.clone(o,n._ellipsoid),n._surfaceHeight=s,n._rotation=a,n._extrudedHeight=c,n._offsetAttribute=l===-1?void 0:l,n):(JA.granularity=r,JA.height=s,JA.rotation=a,JA.extrudedHeight=c,JA.offsetAttribute=l===-1?void 0:l,new eT(JA))};var wYe=new de;eT.createGeometry=function(e){let t=e._rectangle,n=e._ellipsoid,i=Hs.computeOptions(t,e._granularity,e._rotation,0,SYe,wYe),o,r;if(R.equalsEpsilon(t.north,t.south,R.EPSILON10)||R.equalsEpsilon(t.east,t.west,R.EPSILON10))return;let s=e._surfaceHeight,a=e._extrudedHeight,c=!R.equalsEpsilon(s,a,0,R.EPSILON2),l;if(c){if(o=vYe(e,i),u(e._offsetAttribute)){let p=o.attributes.position.values.length/3,g=new Uint8Array(p);e._offsetAttribute===an.TOP?g=g.fill(1,0,p/2):(l=e._offsetAttribute===an.NONE?0:1,g=g.fill(l)),o.attributes.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:g})}let f=ae.fromRectangle3D(t,n,s,TYe),d=ae.fromRectangle3D(t,n,a,AYe);r=ae.union(f,d)}else{if(o=Gce(e,i),o.attributes.position.values=ai.scaleToGeodeticHeight(o.attributes.position.values,s,n,!1),u(e._offsetAttribute)){let f=o.attributes.position.values.length;l=e._offsetAttribute===an.NONE?0:1;let d=new Uint8Array(f/3).fill(l);o.attributes.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:d})}r=ae.fromRectangle3D(t,n,s)}return new ft({attributes:o.attributes,indices:o.indices,primitiveType:Ne.LINES,boundingSphere:r,offsetAttribute:e._offsetAttribute})};var tT=eT;function iT(e){this.rectangle=se.clone(e.rectangle),this.minimumHeight=x(e.minimumHeight,0),this.maximumHeight=x(e.maximumHeight,0),this.southwestCornerCartesian=new h,this.northeastCornerCartesian=new h,this.westNormal=new h,this.southNormal=new h,this.eastNormal=new h,this.northNormal=new h;let t=x(e.ellipsoid,ee.WGS84);OYe(this,e.rectangle,t),this._orientedBoundingBox=void 0,this._boundingSphere=void 0,x(e.computeBoundingVolumes,!0)&&this.computeBoundingVolumes(t)}Object.defineProperties(iT.prototype,{boundingVolume:{get:function(){return this._orientedBoundingBox}},boundingSphere:{get:function(){return this._boundingSphere}}});iT.prototype.computeBoundingVolumes=function(e){this._orientedBoundingBox=wn.fromRectangle(this.rectangle,this.minimumHeight,this.maximumHeight,e),this._boundingSphere=ae.fromOrientedBoundingBox(this._orientedBoundingBox)};var qce=new h,LB=new h,Yce=new h,DYe=new h,IYe=new h,PYe=new h,RYe=new h,wf=new de,Xce=new cn(h.UNIT_X,0),nT=new _n;function OYe(e,t,n){n.cartographicToCartesian(se.southwest(t),e.southwestCornerCartesian),n.cartographicToCartesian(se.northeast(t),e.northeastCornerCartesian),wf.longitude=t.west,wf.latitude=(t.south+t.north)*.5,wf.height=0;let i=n.cartographicToCartesian(wf,PYe),o=h.cross(i,h.UNIT_Z,DYe);h.normalize(o,e.westNormal),wf.longitude=t.east;let r=n.cartographicToCartesian(wf,RYe),s=h.cross(h.UNIT_Z,r,qce);h.normalize(s,e.eastNormal);let a=h.subtract(i,r,qce);h.magnitude(a)===0&&(a=h.clone(o,a));let c=h.normalize(a,IYe),l=t.south,f;if(l>0){wf.longitude=(t.west+t.east)*.5,wf.latitude=l;let y=n.cartographicToCartesian(wf,nT.origin);h.clone(c,nT.direction);let b=cn.fromPointNormal(e.southwestCornerCartesian,e.westNormal,Xce);Qn.rayPlane(nT,b,e.southwestCornerCartesian),f=n.geodeticSurfaceNormal(y,LB)}else f=n.geodeticSurfaceNormalCartographic(se.southeast(t),LB);let d=h.cross(f,a,Yce);h.normalize(d,e.southNormal);let p=t.north,g;if(p<0){wf.longitude=(t.west+t.east)*.5,wf.latitude=p;let y=n.cartographicToCartesian(wf,nT.origin);h.negate(c,nT.direction);let b=cn.fromPointNormal(e.northeastCornerCartesian,e.eastNormal,Xce);Qn.rayPlane(nT,b,e.northeastCornerCartesian),g=n.geodeticSurfaceNormal(y,LB)}else g=n.geodeticSurfaceNormalCartographic(se.northwest(t),LB);let m=h.cross(a,g,Yce);h.normalize(m,e.northNormal)}var MYe=new h,LYe=new h,NYe=new h(0,-1,0),FYe=new h(0,0,-1),Kce=new h;function BYe(e,t){let n=t.camera,i=n.positionWC,o=n.positionCartographic,r=0;if(!se.contains(e.rectangle,o)){let l=e.southwestCornerCartesian,f=e.northeastCornerCartesian,d=e.westNormal,p=e.southNormal,g=e.eastNormal,m=e.northNormal;t.mode!==ne.SCENE3D&&(l=t.mapProjection.project(se.southwest(e.rectangle),MYe),l.z=l.y,l.y=l.x,l.x=0,f=t.mapProjection.project(se.northeast(e.rectangle),LYe),f.z=f.y,f.y=f.x,f.x=0,d=NYe,g=h.UNIT_Y,p=FYe,m=h.UNIT_Z);let y=h.subtract(i,l,Kce),b=h.dot(y,d),C=h.dot(y,p),A=h.subtract(i,f,Kce),T=h.dot(A,g),E=h.dot(A,m);b>0?r+=b*b:T>0&&(r+=T*T),C>0?r+=C*C:E>0&&(r+=E*E)}let s,a,c;if(t.mode===ne.SCENE3D?(s=o.height,a=e.minimumHeight,c=e.maximumHeight):(s=i.x,a=0,c=0),s>c){let l=s-c;r+=l*l}else if(s<a){let l=a-s;r+=l*l}return Math.sqrt(r)}iT.prototype.distanceToCamera=function(e){let t=BYe(this,e);if(e.mode===ne.SCENE3D&&u(this._orientedBoundingBox)){let n=Math.sqrt(this._orientedBoundingBox.distanceSquaredTo(e.camera.positionWC));return Math.max(t,n)}return t};iT.prototype.intersectPlane=function(e){return this._orientedBoundingBox.intersectPlane(e)};iT.prototype.createDebugVolume=function(e){let t=new F.clone(F.IDENTITY),n=new tT({rectangle:this.rectangle,height:this.minimumHeight,extrudedHeight:this.maximumHeight}),i=new vt({geometry:n,id:"outline",modelMatrix:t,attributes:{color:jt.fromColor(e)}});return new In({geometryInstances:i,appearance:new ln({translucent:!1,flat:!0}),asynchronous:!1})};var Pd=iT;var qw={},kYe=new h,Zce=new h,$ce=new h,Qce=new h,Jce=new wn;qw.validOutline=function(e){let n=wn.fromPoints(e,Jce).halfAxes,i=J.getColumn(n,0,Zce),o=J.getColumn(n,1,$ce),r=J.getColumn(n,2,Qce),s=h.magnitude(i),a=h.magnitude(o),c=h.magnitude(r);return!(s===0&&(a===0||c===0)||a===0&&c===0)};qw.computeProjectTo2DArguments=function(e,t,n,i){let o=wn.fromPoints(e,Jce),r=o.halfAxes,s=J.getColumn(r,0,Zce),a=J.getColumn(r,1,$ce),c=J.getColumn(r,2,Qce),l=h.magnitude(s),f=h.magnitude(a),d=h.magnitude(c),p=Math.min(l,f,d);if(l===0&&(f===0||d===0)||f===0&&d===0)return!1;let g,m;return(p===f||p===d)&&(g=s),p===l?g=a:p===d&&(m=a),(p===l||p===f)&&(m=c),h.normalize(g,n),h.normalize(m,i),h.clone(o.center,t),!0};function ele(e,t,n,i,o){let r=h.subtract(e,t,kYe),s=h.dot(n,r),a=h.dot(i,r);return H.fromElements(s,a,o)}qw.createProjectPointsTo2DFunction=function(e,t,n){return function(i){let o=new Array(i.length);for(let r=0;r<i.length;r++)o[r]=ele(i[r],e,t,n);return o}};qw.createProjectPointTo2DFunction=function(e,t,n){return function(i,o){return ele(i,e,t,n,o)}};var Gg=qw;function VYe(e){let t=e.length,n=new Float64Array(t*3),i=Be.createTypedArray(t,t*2),o=0,r=0;for(let a=0;a<t;a++){let c=e[a];n[o++]=c.x,n[o++]=c.y,n[o++]=c.z,i[r++]=a,i[r++]=(a+1)%t}let s=new hn({position:new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:n})});return new ft({attributes:s,indices:i,primitiveType:Ne.LINES})}function wx(e){e=x(e,x.EMPTY_OBJECT);let t=e.polygonHierarchy;this._polygonHierarchy=t,this._workerName="createCoplanarPolygonOutlineGeometry",this.packedLength=zn.computeHierarchyPackedLength(t,h)+1}wx.fromPositions=function(e){e=x(e,x.EMPTY_OBJECT);let t={polygonHierarchy:{positions:e.positions}};return new wx(t)};wx.pack=function(e,t,n){return n=x(n,0),n=zn.packPolygonHierarchy(e._polygonHierarchy,t,n,h),t[n]=e.packedLength,t};var UYe={polygonHierarchy:{}};wx.unpack=function(e,t,n){t=x(t,0);let i=zn.unpackPolygonHierarchy(e,t,h);t=i.startingIndex,delete i.startingIndex;let o=e[t];return u(n)||(n=new wx(UYe)),n._polygonHierarchy=i,n.packedLength=o,n};wx.createGeometry=function(e){let t=e._polygonHierarchy,n=t.positions;if(n=Eo(n,h.equalsEpsilon,!0),n.length<3||!Gg.validOutline(n))return;let o=zn.polygonOutlinesFromHierarchy(t,!1);if(o.length===0)return;let r=[];for(let c=0;c<o.length;c++){let l=new vt({geometry:VYe(o[c])});r.push(l)}let s=Nn.combineInstances(r)[0],a=ae.fromPoints(t.positions);return new ft({attributes:s.attributes,indices:s.indices,primitiveType:s.primitiveType,boundingSphere:a})};var Rd=wx;var NB=new de;function Yw(e){let t=lg.fromToken(e.token),n=x(e.minimumHeight,0),i=x(e.maximumHeight,0),o=x(e.ellipsoid,ee.WGS84);this.s2Cell=t,this.minimumHeight=n,this.maximumHeight=i,this.ellipsoid=o;let r=KYe(t,n,i,o);this._boundingPlanes=r;let s=JYe(r);this._vertices=s,this._edgeNormals=new Array(6),this._edgeNormals[0]=G7(r[0],s.slice(0,4));let a;for(a=0;a<4;a++)this._edgeNormals[0][a]=h.negate(this._edgeNormals[0][a],this._edgeNormals[0][a]);for(this._edgeNormals[1]=G7(r[1],s.slice(4,8)),a=0;a<4;a++)this._edgeNormals[2+a]=G7(r[2+a],[s[a%4],s[(a+1)%4],s[4+(a+1)%4],s[4+a]]);for(this._planeVertices=[this._vertices.slice(0,4),this._vertices.slice(4,8)],a=0;a<4;a++)this._planeVertices.push([this._vertices[a%4],this._vertices[(a+1)%4],this._vertices[4+(a+1)%4],this._vertices[4+a]]);let c=t.getCenter();NB=o.cartesianToCartographic(c,NB),NB.height=(i+n)/2,this.center=o.cartographicToCartesian(NB,c),this._boundingSphere=ae.fromPoints(s)}var zYe=new h,HYe=new de,GYe=new h,WYe=new de,jYe=new h,qYe=new h,YYe=new h,XYe=new h;function KYe(e,t,n,i){let o=new Array(6),r=e.getCenter(),s=i.geodeticSurfaceNormal(r,zYe),a=i.cartesianToCartographic(r,HYe);a.height=n;let c=i.cartographicToCartesian(a,GYe),l=cn.fromPointNormal(c,s);o[0]=l;let f=0,d,p=[],g,m;for(d=0;d<4;d++){g=e.getVertex(d),p[d]=g,m=i.cartesianToCartographic(g,WYe),m.height=t;let b=cn.getPointDistance(l,i.cartographicToCartesian(m,jYe));b<f&&(f=b)}let y=cn.clone(l);for(y.normal=h.negate(y.normal,y.normal),y.distance=y.distance*-1+f,o[1]=y,d=0;d<4;d++){g=p[d];let b=p[(d+1)%4],C=i.geodeticSurfaceNormal(g,qYe),A=h.subtract(b,g,XYe),T=h.cross(A,C,YYe);T=h.normalize(T,T),o[2+d]=cn.fromPointNormal(g,T)}return o}var Dx=new h,Ix=new h,Px=new h,F7=new h,B7=new h,k7=new h,ZYe=new h,$Ye=new h,QYe=new h,V7=new h,U7=new h,z7=new h,Wg=new h,rm=new J;function tle(e,t,n){Dx=e.normal,Ix=t.normal,Px=n.normal,F7=h.multiplyByScalar(e.normal,-e.distance,F7),B7=h.multiplyByScalar(t.normal,-t.distance,B7),k7=h.multiplyByScalar(n.normal,-n.distance,k7),V7=h.multiplyByScalar(h.cross(Ix,Px,ZYe),h.dot(F7,Dx),V7),U7=h.multiplyByScalar(h.cross(Px,Dx,$Ye),h.dot(B7,Ix),U7),z7=h.multiplyByScalar(h.cross(Dx,Ix,QYe),h.dot(k7,Px),z7),rm[0]=Dx.x,rm[1]=Ix.x,rm[2]=Px.x,rm[3]=Dx.y,rm[4]=Ix.y,rm[5]=Px.y,rm[6]=Dx.z,rm[7]=Ix.z,rm[8]=Px.z;let i=J.determinant(rm);return Wg=h.add(V7,U7,Wg),Wg=h.add(Wg,z7,Wg),new h(Wg.x/i,Wg.y/i,Wg.z/i)}function JYe(e){let t=new Array(8);for(let n=0;n<4;n++)t[n]=tle(e[0],e[2+(n+3)%4],e[2+n%4]),t[n+4]=tle(e[1],e[2+(n+3)%4],e[2+n%4]);return t}var H7=new h,oT=new h;function G7(e,t){let n=[];for(let i=0;i<4;i++)H7=h.subtract(t[(i+1)%4],t[i],H7),oT=h.cross(e.normal,H7,oT),oT=h.normalize(oT,oT),n[i]=h.clone(oT);return n}Object.defineProperties(Yw.prototype,{boundingVolume:{get:function(){return this}},boundingSphere:{get:function(){return this._boundingSphere}}});var W7=new h;Yw.prototype.distanceToCamera=function(e){let t=e.camera.positionWC,n=[],i=[],o;cn.getPointDistance(this._boundingPlanes[0],t)>0?(n.push(0),i.push(this._planeVertices[0]),o=this._edgeNormals[0]):cn.getPointDistance(this._boundingPlanes[1],t)>0&&(n.push(1),i.push(this._planeVertices[1]),o=this._edgeNormals[1]);let r,s;for(r=0;r<4;r++)s=2+r,cn.getPointDistance(this._boundingPlanes[s],t)>0&&(n.push(s),i.push(this._planeVertices[s]),o=this._edgeNormals[s]);if(n.length===0)return 0;let a,c;if(n.length===1)return c=this._boundingPlanes[n[0]],a=j7(cn.projectPointOntoPlane(c,t,W7),i[0],c,o),h.distance(a,t);if(n.length===2){if(n[0]===0){let p=[this._vertices[4*n[0]+(n[1]-2)],this._vertices[4*n[0]+(n[1]-2+1)%4]];return a=nle(t,p[0],p[1]),h.distance(a,t)}let f=Number.MAX_VALUE,d;for(r=0;r<2;r++)c=this._boundingPlanes[n[r]],a=j7(cn.projectPointOntoPlane(c,t,W7),i[r],c,this._edgeNormals[n[r]]),d=h.distanceSquared(a,t),d<f&&(f=d);return Math.sqrt(f)}else if(n.length>3)return a=j7(cn.projectPointOntoPlane(this._boundingPlanes[1],t,W7),this._planeVertices[1],this._boundingPlanes[1],this._edgeNormals[1]),h.distance(a,t);let l=n[1]===2&&n[2]===5?0:1;return n[0]===0?h.distance(t,this._vertices[(n[1]-2+l)%4]):h.distance(t,this._vertices[4+(n[1]-2+l)%4])};var eXe=new h,tXe=new h;function nle(e,t,n){let i=h.subtract(n,t,eXe),o=h.subtract(e,t,tXe),r=h.dot(i,o);if(r<=0)return t;let s=h.dot(i,i);return r>=s?n:(r=r/s,new h((1-r)*t.x+r*n.x,(1-r)*t.y+r*n.y,(1-r)*t.z+r*n.z))}var nXe=new cn(h.UNIT_X,0);function j7(e,t,n,i){let o=Number.MAX_VALUE,r,s,a;for(let c=0;c<t.length;c++){let l=cn.fromPointNormal(t[c],i[c],nXe);cn.getPointDistance(l,e)<0||(a=nle(e,t[c],t[(c+1)%4]),r=h.distance(e,a),r<o&&(o=r,s=a))}return u(s)?s:e}Yw.prototype.intersectPlane=function(e){let t=0,n=0;for(let i=0;i<this._vertices.length;i++)h.dot(e.normal,this._vertices[i])+e.distance<0?n++:t++;return t===this._vertices.length?qt.INSIDE:n===this._vertices.length?qt.OUTSIDE:qt.INTERSECTING};Yw.prototype.createDebugVolume=function(e){let t=new F.clone(F.IDENTITY),n=new Rd({polygonHierarchy:{positions:this._planeVertices[0]}}),i=Rd.createGeometry(n),o=new vt({geometry:i,id:"outline",modelMatrix:t,attributes:{color:jt.fromColor(e)}}),r=new Rd({polygonHierarchy:{positions:this._planeVertices[1]}}),s=Rd.createGeometry(r),a=new vt({geometry:s,id:"outline",modelMatrix:t,attributes:{color:jt.fromColor(e)}}),c=[];for(let l=0;l<4;l++){let f=new Rd({polygonHierarchy:{positions:this._planeVertices[2+l]}}),d=Rd.createGeometry(f);c[l]=new vt({geometry:d,id:"outline",modelMatrix:t,attributes:{color:jt.fromColor(e)}})}return new In({geometryInstances:[c[0],c[1],c[2],c[3],a,o],appearance:new ln({translucent:!1,flat:!0}),asynchronous:!1})};var FB=Yw;var iXe=new h(1,1,1),BB=Math.cos,kB=Math.sin;function rT(e){e=x(e,x.EMPTY_OBJECT);let t=x(e.radii,iXe),n=x(e.innerRadii,t),i=x(e.minimumClock,0),o=x(e.maximumClock,R.TWO_PI),r=x(e.minimumCone,0),s=x(e.maximumCone,R.PI),a=Math.round(x(e.stackPartitions,10)),c=Math.round(x(e.slicePartitions,8)),l=Math.round(x(e.subdivisions,128));this._radii=h.clone(t),this._innerRadii=h.clone(n),this._minimumClock=i,this._maximumClock=o,this._minimumCone=r,this._maximumCone=s,this._stackPartitions=a,this._slicePartitions=c,this._subdivisions=l,this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipsoidOutlineGeometry"}rT.packedLength=2*h.packedLength+8;rT.pack=function(e,t,n){return n=x(n,0),h.pack(e._radii,t,n),n+=h.packedLength,h.pack(e._innerRadii,t,n),n+=h.packedLength,t[n++]=e._minimumClock,t[n++]=e._maximumClock,t[n++]=e._minimumCone,t[n++]=e._maximumCone,t[n++]=e._stackPartitions,t[n++]=e._slicePartitions,t[n++]=e._subdivisions,t[n]=x(e._offsetAttribute,-1),t};var ile=new h,ole=new h,Hp={radii:ile,innerRadii:ole,minimumClock:void 0,maximumClock:void 0,minimumCone:void 0,maximumCone:void 0,stackPartitions:void 0,slicePartitions:void 0,subdivisions:void 0,offsetAttribute:void 0};rT.unpack=function(e,t,n){t=x(t,0);let i=h.unpack(e,t,ile);t+=h.packedLength;let o=h.unpack(e,t,ole);t+=h.packedLength;let r=e[t++],s=e[t++],a=e[t++],c=e[t++],l=e[t++],f=e[t++],d=e[t++],p=e[t];return u(n)?(n._radii=h.clone(i,n._radii),n._innerRadii=h.clone(o,n._innerRadii),n._minimumClock=r,n._maximumClock=s,n._minimumCone=a,n._maximumCone=c,n._stackPartitions=l,n._slicePartitions=f,n._subdivisions=d,n._offsetAttribute=p===-1?void 0:p,n):(Hp.minimumClock=r,Hp.maximumClock=s,Hp.minimumCone=a,Hp.maximumCone=c,Hp.stackPartitions=l,Hp.slicePartitions=f,Hp.subdivisions=d,Hp.offsetAttribute=p===-1?void 0:p,new rT(Hp))};rT.createGeometry=function(e){let t=e._radii;if(t.x<=0||t.y<=0||t.z<=0)return;let n=e._innerRadii;if(n.x<=0||n.y<=0||n.z<=0)return;let i=e._minimumClock,o=e._maximumClock,r=e._minimumCone,s=e._maximumCone,a=e._subdivisions,c=ee.fromCartesian3(t),l=e._slicePartitions+1,f=e._stackPartitions+1;l=Math.round(l*Math.abs(o-i)/R.TWO_PI),f=Math.round(f*Math.abs(s-r)/R.PI),l<2&&(l=2),f<2&&(f=2);let d=0,p=1,g=n.x!==t.x||n.y!==t.y||n.z!==t.z,m=!1,y=!1;g&&(p=2,r>0&&(m=!0,d+=l),s<Math.PI&&(y=!0,d+=l));let b=a*p*(f+l),C=new Float64Array(b*3),A=2*(b+d-(l+f)*p),T=Be.createTypedArray(b,A),E,v,D,O,P=0,M=new Array(f),L=new Array(f);for(E=0;E<f;E++)O=r+E*(s-r)/(f-1),M[E]=kB(O),L[E]=BB(O);let _=new Array(a),S=new Array(a);for(E=0;E<a;E++)D=i+E*(o-i)/(a-1),_[E]=kB(D),S[E]=BB(D);for(E=0;E<f;E++)for(v=0;v<a;v++)C[P++]=t.x*M[E]*S[v],C[P++]=t.y*M[E]*_[v],C[P++]=t.z*L[E];if(g)for(E=0;E<f;E++)for(v=0;v<a;v++)C[P++]=n.x*M[E]*S[v],C[P++]=n.y*M[E]*_[v],C[P++]=n.z*L[E];for(M.length=a,L.length=a,E=0;E<a;E++)O=r+E*(s-r)/(a-1),M[E]=kB(O),L[E]=BB(O);for(_.length=l,S.length=l,E=0;E<l;E++)D=i+E*(o-i)/(l-1),_[E]=kB(D),S[E]=BB(D);for(E=0;E<a;E++)for(v=0;v<l;v++)C[P++]=t.x*M[E]*S[v],C[P++]=t.y*M[E]*_[v],C[P++]=t.z*L[E];if(g)for(E=0;E<a;E++)for(v=0;v<l;v++)C[P++]=n.x*M[E]*S[v],C[P++]=n.y*M[E]*_[v],C[P++]=n.z*L[E];for(P=0,E=0;E<f*p;E++){let N=E*a;for(v=0;v<a-1;v++)T[P++]=N+v,T[P++]=N+v+1}let w=f*a*p;for(E=0;E<l;E++)for(v=0;v<a-1;v++)T[P++]=w+E+v*l,T[P++]=w+E+(v+1)*l;if(g)for(w=f*a*p+l*a,E=0;E<l;E++)for(v=0;v<a-1;v++)T[P++]=w+E+v*l,T[P++]=w+E+(v+1)*l;if(g){let N=f*a*p,k=N+a*l;if(m)for(E=0;E<l;E++)T[P++]=N+E,T[P++]=k+E;if(y)for(N+=a*l-l,k+=a*l-l,E=0;E<l;E++)T[P++]=N+E,T[P++]=k+E}let I=new hn({position:new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:C})});if(u(e._offsetAttribute)){let N=C.length,k=e._offsetAttribute===an.NONE?0:1,z=new Uint8Array(N/3).fill(k);I.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:z})}return new ft({attributes:I,indices:T,primitiveType:Ne.LINES,boundingSphere:ae.fromEllipsoid(c),offsetAttribute:e._offsetAttribute})};var Df=rT;function sT(e){let t=x(e.radius,1),i={radii:new h(t,t,t),stackPartitions:e.stackPartitions,slicePartitions:e.slicePartitions,subdivisions:e.subdivisions};this._ellipsoidGeometry=new Df(i),this._workerName="createSphereOutlineGeometry"}sT.packedLength=Df.packedLength;sT.pack=function(e,t,n){return Df.pack(e._ellipsoidGeometry,t,n)};var oXe=new Df,Rx={radius:void 0,radii:new h,stackPartitions:void 0,slicePartitions:void 0,subdivisions:void 0};sT.unpack=function(e,t,n){let i=Df.unpack(e,t,oXe);return Rx.stackPartitions=i._stackPartitions,Rx.slicePartitions=i._slicePartitions,Rx.subdivisions=i._subdivisions,u(n)?(h.clone(i._radii,Rx.radii),n._ellipsoidGeometry=new Df(Rx),n):(Rx.radius=i._radii.x,new sT(Rx))};sT.createGeometry=function(e){return Df.createGeometry(e._ellipsoidGeometry)};var jg=sT;function aT(e,t){t===0&&(t=R.EPSILON7),this._boundingSphere=new ae(e,t)}Object.defineProperties(aT.prototype,{center:{get:function(){return this._boundingSphere.center}},radius:{get:function(){return this._boundingSphere.radius}},boundingVolume:{get:function(){return this._boundingSphere}},boundingSphere:{get:function(){return this._boundingSphere}}});aT.prototype.distanceToCamera=function(e){let t=this._boundingSphere;return Math.max(0,h.distance(t.center,e.camera.positionWC)-t.radius)};aT.prototype.intersectPlane=function(e){return ae.intersectPlane(this._boundingSphere,e)};aT.prototype.update=function(e,t){h.clone(e,this._boundingSphere.center),this._boundingSphere.radius=t};aT.prototype.createDebugVolume=function(e){let t=new jg({radius:this.radius}),n=F.fromTranslation(this.center,new F.clone(F.IDENTITY)),i=new vt({geometry:t,id:"outline",modelMatrix:n,attributes:{color:jt.fromColor(e)}});return new In({geometryInstances:i,appearance:new ln({translucent:!1,flat:!0}),asynchronous:!1})};var qg=aT;var rXe=new h,sXe=new h,aXe=new h,cXe=new h;function Ox(e,t,n){n=h.cross(e,t,n);let i=h.magnitude(n);return h.multiplyByScalar(n,R.EPSILON7/i,n)}function q7(e,t){let n=h.normalize(e,cXe),i=h.equalsEpsilon(n,h.UNIT_X,R.EPSILON6)?h.UNIT_Y:h.UNIT_X;return Ox(e,i,t)}function rle(e){let t=J.getColumn(e,0,rXe),n=J.getColumn(e,1,sXe),i=J.getColumn(e,2,aXe),o=h.equals(t,h.ZERO),r=h.equals(n,h.ZERO),s=h.equals(i,h.ZERO);return!o&&!r&&!s?e:o&&r&&s?(e[0]=R.EPSILON7,e[4]=R.EPSILON7,e[8]=R.EPSILON7,e):(o&&!r&&!s?t=Ox(n,i,t):!o&&r&&!s?n=Ox(t,i,n):!o&&!r&&s?i=Ox(n,t,i):o?r?s||(t=q7(i,t),n=Ox(i,t,n)):(t=q7(n,t),i=Ox(n,t,i)):(n=q7(t,n),i=Ox(n,t,i)),J.setColumn(e,0,t,e),J.setColumn(e,1,n,e),J.setColumn(e,2,i,e),e)}function cT(e,t){t=rle(t),this._orientedBoundingBox=new wn(e,t),this._boundingSphere=ae.fromOrientedBoundingBox(this._orientedBoundingBox)}Object.defineProperties(cT.prototype,{boundingVolume:{get:function(){return this._orientedBoundingBox}},boundingSphere:{get:function(){return this._boundingSphere}}});cT.prototype.distanceToCamera=function(e){return Math.sqrt(this._orientedBoundingBox.distanceSquaredTo(e.camera.positionWC))};cT.prototype.intersectPlane=function(e){return this._orientedBoundingBox.intersectPlane(e)};cT.prototype.update=function(e,t){h.clone(e,this._orientedBoundingBox.center),t=rle(t),J.clone(t,this._orientedBoundingBox.halfAxes),ae.fromOrientedBoundingBox(this._orientedBoundingBox,this._boundingSphere)};cT.prototype.createDebugVolume=function(e){let t=new Ih({minimum:new h(-1,-1,-1),maximum:new h(1,1,1)}),n=F.fromRotationTranslation(this.boundingVolume.halfAxes,this.boundingVolume.center),i=new vt({geometry:t,id:"outline",modelMatrix:n,attributes:{color:jt.fromColor(e)}});return new In({geometryInstances:i,appearance:new ln({translucent:!1,flat:!0}),asynchronous:!1})};var If=cT;var Mx=Dr(mue(),1);function Jo(e,t,n,i){this._tileset=e,this._header=n;let o=u(n.contents),r=o&&n.contents.length>1||si(n,"3DTILES_multiple_contents"),s=o&&!r?n.contents[0]:n.content;this._contentHeader=s,this.transform=u(n.transform)?F.unpack(n.transform):F.clone(F.IDENTITY);let a=u(i)?i.computedTransform:e.modelMatrix,c=F.multiply(a,this.transform,new F),l=u(i)?i._initialTransform:F.IDENTITY;this._initialTransform=F.multiply(l,this.transform,new F),this.computedTransform=c,this.metadata=RB(e,n),this._verticalExaggeration=1,this._verticalExaggerationRelativeHeight=0,this._boundingVolume=this.createBoundingVolume(n.boundingVolume,c),this._boundingVolume2D=void 0;let f;u(s)&&u(s.boundingVolume)&&(f=this.createBoundingVolume(s.boundingVolume,c)),this._contentBoundingVolume=f,this._contentBoundingVolume2D=void 0;let d;u(n.viewerRequestVolume)&&(d=this.createBoundingVolume(n.viewerRequestVolume,c)),this._viewerRequestVolume=d,this.geometricError=n.geometricError,this._geometricError=n.geometricError,u(this._geometricError)||(this._geometricError=u(i)?i._geometricError:e._geometricError,Jo._deprecationWarning("geometricErrorUndefined","Required property geometricError is undefined for this tile. Using parent's geometric error instead.")),this.updateGeometricErrorScale();let p;u(n.refine)?((n.refine==="replace"||n.refine==="add")&&Jo._deprecationWarning("lowercase-refine",`This tile uses a lowercase refine "${n.refine}". Instead use "${n.refine.toUpperCase()}".`),p=n.refine.toUpperCase()==="REPLACE"?Zo.REPLACE:Zo.ADD):u(i)?p=i.refine:p=Zo.REPLACE,this.refine=p,this.children=[],this.parent=i;let g,m=!1,y,b,C;if(t=De.createIfNeeded(t),r)y=Qo.UNLOADED,b=t.clone();else if(u(s)){let v=s.uri;u(s.url)&&(Jo._deprecationWarning("contentUrl",'This tileset JSON uses the "content.url" property which has been deprecated. Use "content.uri" instead.'),v=s.url),v===""?(Jo._deprecationWarning("contentUriEmpty","content.uri property is an empty string, which creates a circular dependency, making this tileset invalid. Omit the content property instead"),g=new Ww(e,this),m=!0,y=Qo.READY):(y=Qo.UNLOADED,b=t.getDerivedResource({url:v}),C=Cc.getServerKey(b.getUrlComponent()))}else g=new Ww(e,this),m=!0,y=Qo.READY;this._content=g,this._contentResource=b,this._contentState=y,this._expiredContent=void 0,this._serverKey=C,this.hasEmptyContent=m,this.hasTilesetContent=!1,this.hasImplicitContent=!1,this.hasImplicitContentMetadata=!1,this.hasMultipleContents=r,this.cacheNode=void 0;let A=n.expire,T,E;u(A)&&(T=A.duration,u(A.date)&&(E=$.fromIso8601(A.date))),this.expireDuration=T,this.expireDate=E,this.lastStyleTime=0,this._optimChildrenWithinParent=Id.NOT_COMPUTED,this.clippingPlanesDirty=!1,this.clippingPolygonsDirty=!1,this.priorityDeferred=!1,this.implicitTileset=void 0,this.implicitCoordinates=void 0,this.implicitSubtree=void 0,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._screenSpaceErrorProgressiveResolution=0,this._visibilityPlaneMask=0,this._visible=!1,this._inRequestVolume=!1,this._finalResolution=!0,this._depth=0,this._stackLength=0,this._selectionDepth=0,this._updatedVisibilityFrame=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._wasSelectedLastFrame=!1,this._requestedFrame=0,this._ancestorWithContent=void 0,this._ancestorWithContentAvailable=void 0,this._refines=!1,this._shouldSelect=!1,this._isClipped=!0,this._isClippedByPolygon=!1,this._clippingPlanesState=0,this._clippingPolygonsState=0,this._debugBoundingVolume=void 0,this._debugContentBoundingVolume=void 0,this._debugViewerRequestVolume=void 0,this._debugColor=G.fromRandom({alpha:1}),this._debugColorizeTiles=!1,this._priority=0,this._priorityHolder=this,this._priorityProgressiveResolution=!1,this._priorityProgressiveResolutionScreenSpaceErrorLeaf=!1,this._priorityReverseScreenSpaceError=0,this._foveatedFactor=0,this._wasMinPriorityChild=!1,this._loadTimestamp=new $,this._commandsLength=0,this._color=void 0,this._colorDirty=!1,this._request=void 0}Jo._deprecationWarning=ys;Object.defineProperties(Jo.prototype,{tileset:{get:function(){return this._tileset}},content:{get:function(){return this._content}},boundingVolume:{get:function(){return this._boundingVolume}},contentBoundingVolume:{get:function(){return x(this._contentBoundingVolume,this._boundingVolume)}},boundingSphere:{get:function(){return this._boundingVolume.boundingSphere}},isVisible:{get:function(){return this._visible&&this._inRequestVolume}},extras:{get:function(){return this._header.extras}},color:{get:function(){return u(this._color)||(this._color=new G),G.clone(this._color)},set:function(e){this._color=G.clone(e,this._color),this._colorDirty=!0}},hasRenderableContent:{get:function(){return!this.hasEmptyContent&&!this.hasTilesetContent&&!this.hasImplicitContent}},contentAvailable:{get:function(){return this.contentReady&&this.hasRenderableContent||u(this._expiredContent)&&!this.contentFailed}},contentReady:{get:function(){return this._contentState===Qo.READY}},contentUnloaded:{get:function(){return this._contentState===Qo.UNLOADED}},hasUnloadedRenderableContent:{get:function(){return this.hasRenderableContent&&this.contentUnloaded}},contentExpired:{get:function(){return this._contentState===Qo.EXPIRED}},contentFailed:{get:function(){return this._contentState===Qo.FAILED}},commandsLength:{get:function(){return this._commandsLength}}});var Kg=new h;function lXe(e,t){let{tileset:n,boundingSphere:i}=e,{radius:o,center:r}=i,{camera:s}=t,a=h.multiplyByScalar(s.directionWC,e._centerZDepth,Kg),c=h.add(s.positionWC,a,Kg),l=h.subtract(c,r,Kg);if(h.magnitude(l)>o){let E=h.normalize(l,Kg),v=h.multiplyByScalar(E,o,Kg),D=h.add(r,v,Kg),O=h.subtract(D,s.positionWC,Kg),P=h.normalize(O,Kg);e._foveatedFactor=1-Math.abs(h.dot(s.directionWC,P))}else e._foveatedFactor=0;let p=e.refine===Zo.REPLACE,g=n.isSkippingLevelOfDetail;if(p&&!g||!n.foveatedScreenSpaceError||n.foveatedConeSize===1||e._priorityProgressiveResolution&&p&&g||n._pass===Ho.PRELOAD_FLIGHT||n._pass===Ho.PRELOAD)return!1;let m=1-Math.cos(s.frustum.fov*.5),y=n.foveatedConeSize*m;if(e._foveatedFactor<=y)return!1;let b=m-y,C=R.clamp((e._foveatedFactor-y)/b,0,1),A=n.foveatedInterpolationCallback(n.foveatedMinimumScreenSpaceErrorRelaxation,n.memoryAdjustedScreenSpaceError,C),T=e._screenSpaceError===0&&u(e.parent)?e.parent._screenSpaceError*.5:e._screenSpaceError;return n.memoryAdjustedScreenSpaceError-A<=T}var yue=new $;Jo.prototype.getScreenSpaceError=function(e,t,n){let i=this._tileset,o=x(n,1),r=u(this.parent)?this.parent.geometricError:i._scaledGeometricError,s=t?r:this.geometricError;if(s===0)return 0;let{camera:a,context:c}=e,l=a.frustum,f=c.drawingBufferWidth,d=c.drawingBufferHeight*o,p;if(e.mode===ne.SCENE2D||l instanceof sn){let g=l.offCenterFrustum;u(g)&&(l=g);let m=Math.max(l.top-l.bottom,l.right-l.left)/Math.max(f,d);p=s/m}else{let g=Math.max(this._distanceToCamera,R.EPSILON7),m=l.sseDenominator;if(p=s*d/(g*m),i.dynamicScreenSpaceError){let y=i._dynamicScreenSpaceErrorComputedDensity,b=i.dynamicScreenSpaceErrorFactor,C=R.fog(g,y)*b;p-=C}}return p/=e.pixelRatio,p};function uXe(e,t){if(e.progressiveResolutionHeightFraction<=0||e.progressiveResolutionHeightFraction>.5)return!1;let n=e.memoryAdjustedScreenSpaceError,i=t._screenSpaceErrorProgressiveResolution>n;t._priorityProgressiveResolutionScreenSpaceErrorLeaf=!1;let o=t.parent,r=t._screenSpaceErrorProgressiveResolution<=n,s=u(o)&&o._screenSpaceErrorProgressiveResolution>n;return r&&s&&(t._priorityProgressiveResolutionScreenSpaceErrorLeaf=!0,i=!0),i}function fXe(e,t){let n=t.parent,o=u(n)&&(!e.isSkippingLevelOfDetail||t._screenSpaceError===0||n.hasTilesetContent||n.hasImplicitContent)?n._screenSpaceError:t._screenSpaceError;return e.root._screenSpaceError-o}Jo.prototype.updateVisibility=function(e){let{parent:t,tileset:n}=this;if(this._updatedVisibilityFrame===n._updatedVisibilityFrame)return;let i=u(t)?t.computedTransform:n.modelMatrix,o=u(t)?t._visibilityPlaneMask:bs.MASK_INDETERMINATE;this.updateTransform(i,e),this._distanceToCamera=this.distanceToTile(e),this._centerZDepth=this.distanceToTileCenter(e),this._screenSpaceError=this.getScreenSpaceError(e,!1),this._screenSpaceErrorProgressiveResolution=this.getScreenSpaceError(e,!1,n.progressiveResolutionHeightFraction),this._visibilityPlaneMask=this.visibility(e,o),this._visible=this._visibilityPlaneMask!==bs.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(e),this._priorityReverseScreenSpaceError=fXe(n,this),this._priorityProgressiveResolution=uXe(n,this),this.priorityDeferred=lXe(this,e),this._updatedVisibilityFrame=n._updatedVisibilityFrame};Jo.prototype.updateExpiration=function(){if(u(this.expireDate)&&this.contentReady&&!this.hasEmptyContent&&!this.hasMultipleContents){let e=$.now(yue);$.lessThan(this.expireDate,e)&&(this._contentState=Qo.EXPIRED,this._expiredContent=this._content)}};function dXe(e){if(!u(e.expireDuration))return;let t=$.now(yue);$.addSeconds(t,e.expireDuration,t),u(e.expireDate)?$.lessThan(e.expireDate,t)&&$.clone(t,e.expireDate):e.expireDate=$.clone(t)}function hXe(e){return function(){return e._priority}}Jo.prototype.requestContent=function(){if(!this.hasEmptyContent)return this.hasMultipleContents?mXe(this):_Xe(this)};function mXe(e){let t=e._content,n=e._tileset;if(!u(t)){let o=si(e._header,"3DTILES_multiple_contents")?e._header.extensions["3DTILES_multiple_contents"]:e._header;t=new OB(n,e,e._contentResource.clone(),o),e._content=t}let i=t.requestInnerContents();if(u(i))return e._contentState=Qo.LOADING,i.then(o=>{if(!e.isDestroyed()&&u(o))return e._contentState=Qo.PROCESSING,t}).catch(o=>{if(!e.isDestroyed())throw e._contentState=Qo.FAILED,o})}async function pXe(e,t,n,i,o){let r=e._contentState;e._contentState=Qo.LOADING,++t.statistics.numberOfPendingRequests;let s;try{s=await o}catch(a){if(--t.statistics.numberOfPendingRequests,e.isDestroyed())return;if(n.cancelled||n.state===$n.CANCELLED){e._contentState=r,++t.statistics.numberOfAttemptedRequests;return}throw e._contentState=Qo.FAILED,a}if(e.isDestroyed()){--t.statistics.numberOfPendingRequests;return}if(n.cancelled||n.state===$n.CANCELLED){e._contentState=r,--t.statistics.numberOfPendingRequests,++t.statistics.numberOfAttemptedRequests;return}try{let a=await gXe(e,s);return--t.statistics.numberOfPendingRequests,e.isDestroyed()?void 0:(i&&(e.expireDate=void 0),e._content=a,e._contentState=Qo.PROCESSING,a)}catch(a){if(--t.statistics.numberOfPendingRequests,e.isDestroyed())return;throw e._contentState=Qo.FAILED,a}}function _Xe(e){let t=e._contentResource.clone(),n=e.contentExpired;n&&t.setQueryParameters({expired:e.expireDate.toString()});let i=new rr({throttle:!0,throttleByServer:!0,type:gs.TILES3D,priorityFunction:hXe(e),serverKey:e._serverKey});e._request=i,t.request=i;let o=e._tileset,r=t.fetchArrayBuffer();if(!u(r)){++o.statistics.numberOfAttemptedRequests;return}return pXe(e,o,i,n,r)}async function gXe(e,t){let n=zp(t),i=e._tileset;i._disableSkipLevelOfDetail=i._disableSkipLevelOfDetail||n.contentType===Us.GEOMETRY||n.contentType===Us.VECTOR,(n.contentType===Us.IMPLICIT_SUBTREE||n.contentType===Us.IMPLICIT_SUBTREE_JSON)&&(e.hasImplicitContent=!0),n.contentType===Us.EXTERNAL_TILESET&&(e.hasTilesetContent=!0);let o,r=ZA[n.contentType];if(e.isDestroyed())return;u(n.binaryPayload)?o=await Promise.resolve(r(i,e,e._contentResource,n.binaryPayload.buffer,0)):o=await Promise.resolve(r(i,e,e._contentResource,n.jsonPayload));let s=e._contentHeader;if(e.hasImplicitContentMetadata){let c=e.implicitSubtree,l=e.implicitCoordinates;o.metadata=c.getContentMetadataView(l,0)}else e.hasImplicitContent||(o.metadata=$A(i,s));let a=QA(i,s);return u(a)&&(o.group=new iA({metadata:a})),o}Jo.prototype.cancelRequests=function(){this.hasMultipleContents?this._content.cancelRequests():this._request.cancel()};Jo.prototype.unloadContent=function(){this.hasRenderableContent&&(this._content=this._content&&this._content.destroy(),this._contentState=Qo.UNLOADED,this.lastStyleTime=0,this.clippingPlanesDirty=this._clippingPlanesState===0,this._clippingPlanesState=0,this.clippingPolygonsDirty=this._clippingPolygonsState===0,this._clippingPolygonsState=0,this._debugColorizeTiles=!1,this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy(),this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy(),this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy())};var xue=new ae;function Z7(e,t){if(t.mode!==ne.SCENE3D&&!u(e._boundingVolume2D)){let n=e._boundingVolume.boundingSphere,i=ae.projectTo2D(n,t.mapProjection,xue);e._boundingVolume2D=new qg(i.center,i.radius)}return t.mode!==ne.SCENE3D?e._boundingVolume2D:e._boundingVolume}function yXe(e,t){if(t.mode!==ne.SCENE3D&&!u(e._contentBoundingVolume2D)){let n=e._contentBoundingVolume.boundingSphere,i=ae.projectTo2D(n,t.mapProjection,xue);e._contentBoundingVolume2D=new qg(i.center,i.radius)}return t.mode!==ne.SCENE3D?e._contentBoundingVolume2D:e._contentBoundingVolume}Jo.prototype.visibility=function(e,t){let n=e.cullingVolume,i=Z7(this,e),o=this._tileset,r=o.clippingPlanes;if(u(r)&&r.enabled){let a=r.computeIntersectionWithBoundingVolume(i,o.clippingPlanesOriginMatrix);if(this._isClipped=a!==qt.INSIDE,a===qt.OUTSIDE)return bs.MASK_OUTSIDE}let s=o.clippingPolygons;if(u(s)&&s.enabled){let a=s.computeIntersectionWithBoundingVolume(i);this._isClippedByPolygon=a!==qt.OUTSIDE}return n.computeVisibilityWithPlaneMask(i,t)};Jo.prototype.contentVisibility=function(e){if(!u(this._contentBoundingVolume))return qt.INSIDE;if(this._visibilityPlaneMask===bs.MASK_INSIDE)return qt.INSIDE;let t=e.cullingVolume,n=yXe(this,e),i=this._tileset,o=i.clippingPlanes;if(u(o)&&o.enabled){let s=o.computeIntersectionWithBoundingVolume(n,i.clippingPlanesOriginMatrix);if(this._isClipped=s!==qt.INSIDE,s===qt.OUTSIDE)return qt.OUTSIDE}let r=i.clippingPolygons;if(u(r)&&r.enabled){let s=r.computeIntersectionWithBoundingVolume(n);if(this._isClippedByPolygon=s!==qt.OUTSIDE,s===qt.INSIDE)return qt.OUTSIDE}return t.computeVisibility(n)};Jo.prototype.distanceToTile=function(e){return Z7(this,e).distanceToCamera(e)};var xXe=new h;Jo.prototype.distanceToTileCenter=function(e){let n=Z7(this,e).boundingVolume,i=h.subtract(n.center,e.camera.positionWC,xXe);return h.dot(e.camera.directionWC,i)};Jo.prototype.insideViewerRequestVolume=function(e){let t=this._viewerRequestVolume;return!u(t)||t.distanceToCamera(e)===0};var bue=new J,Cue=new h,bXe=new J,$7=new h,Aue=new se,Tue=new wn,K7=new F;function CXe(e,t,n){let i=h.fromElements(e[0],e[1],e[2],$7),o=J.fromArray(e,3,bXe);i=F.multiplyByPoint(t,i,i);let r=F.getMatrix3(t,bue);return o=J.multiply(r,o,o),u(n)?(n.update(i,o),n):new If(i,o)}function AXe(e,t,n,i){let o=se.unpack(e,0,Aue),r=e[4],s=e[5],a=wn.fromRectangle(o,r,s,ee.WGS84,Tue),c=a.center,l=a.halfAxes;t=F.multiplyTransformation(t,F.inverseTransformation(n,K7),K7),c=F.multiplyByPoint(t,c,c);let f=F.getMatrix3(t,bue);return l=J.multiply(f,l,l),u(i)&&i instanceof If?(i.update(c,l),i):new If(c,l)}function TXe(e,t,n,i){if(!F.equalsEpsilon(t,n,R.EPSILON8))return AXe(e,t,n,i);let o=se.unpack(e,0,Aue);return u(i)?(i.rectangle=se.clone(o,i.rectangle),i.minimumHeight=e[4],i.maximumHeight=e[5],i.computeBoundingVolumes(ee.WGS84),i):new Pd({rectangle:o,minimumHeight:e[4],maximumHeight:e[5]})}function EXe(e,t,n){let i=h.fromElements(e[0],e[1],e[2],$7),o=e[3];i=F.multiplyByPoint(t,i,i);let r=F.getScale(t,Cue),s=h.maximumComponent(r);return o*=s,u(n)?(n.update(i,o),n):new qg(i,o)}var SXe=Mx.default.enc.Utf8.parse("con2Gsf0LwAZwbyLLs+g3Q==");Jo.prototype.createBoundingVolume=function(e,t,n){let i=this.metadata,o;if(u(i)&&(o=pA.parseBoundingVolumeSemantic("TILE",i)),u(o)&&(e=o),!u(e))throw new ce("boundingVolume must be defined");if(si(e,"3DTILES_bounding_volume_S2"))return new FB(e.extensions["3DTILES_bounding_volume_S2"]);let r=e.sphere;if(typeof r=="string"){let l=Mx.default.AES.decrypt({ciphertext:Mx.default.enc.Base64.parse(r)},SXe,{mode:Mx.default.mode.ECB,padding:Mx.default.pad.Pkcs7});e.sphere=JSON.parse(l.toString(Mx.default.enc.Utf8))}let{box:s,region:a,sphere:c}=e;if(u(s)){let l=CXe(s,t,n);return this._verticalExaggeration!==1&&pue(l,this._verticalExaggeration,this._verticalExaggerationRelativeHeight),l}if(u(a)){let l=TXe(a,t,this._initialTransform,n);return this._verticalExaggeration===1||(l instanceof If?pue(l,this._verticalExaggeration,this._verticalExaggerationRelativeHeight):(l.minimumHeight=Mr.getHeight(l.minimumHeight,this._verticalExaggeration,this._verticalExaggerationRelativeHeight),l.maximumHeight=Mr.getHeight(l.maximumHeight,this._verticalExaggeration,this._verticalExaggerationRelativeHeight),l.computeBoundingVolumes(ee.WGS84))),l}if(u(c)){let l=EXe(c,t,n);if(this._verticalExaggeration!==1){let f=Mr.getPosition(l.center,ee.WGS84,this._verticalExaggeration,this._verticalExaggerationRelativeHeight,$7),d=l.radius*this._verticalExaggeration;l.update(f,d)}return l}throw new ce("boundingVolume must contain a sphere, region, or box")};var vXe=h.unpackArray(new Array(8*3).fill(0));function pue(e,t,n){let i=e.boundingVolume.computeCorners(vXe).map(r=>Mr.getPosition(r,ee.WGS84,t,n,r)),o=wn.fromPoints(i,Tue);e.update(o.center,o.halfAxes)}Jo.prototype.updateTransform=function(e,t){e=x(e,F.IDENTITY);let n=F.multiplyTransformation(e,this.transform,K7),i=!F.equals(n,this.computedTransform),o=u(t)&&(this._verticalExaggeration!==t.verticalExaggeration||this._verticalExaggerationRelativeHeight!==t.verticalExaggerationRelativeHeight);if(!i&&!o)return;i&&F.clone(n,this.computedTransform),o&&(this._verticalExaggeration=t.verticalExaggeration,this._verticalExaggerationRelativeHeight=t.verticalExaggerationRelativeHeight);let r=this._header,s=this._contentHeader;this._boundingVolume=this.createBoundingVolume(r.boundingVolume,this.computedTransform,this._boundingVolume),u(this._contentBoundingVolume)&&(this._contentBoundingVolume=this.createBoundingVolume(s.boundingVolume,this.computedTransform,this._contentBoundingVolume)),u(this._viewerRequestVolume)&&(this._viewerRequestVolume=this.createBoundingVolume(r.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)),this.updateGeometricErrorScale(),this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy(),this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy(),this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy()};Jo.prototype.updateGeometricErrorScale=function(){let e=F.getScale(this.computedTransform,Cue),t=h.maximumComponent(e);if(this.geometricError=this._geometricError*t,!u(this.parent)){let n=this._tileset;n._scaledGeometricError=n._geometricError*t}};function wXe(e,t,n,i){if(!i.isRender)return;let o=u(e._contentHeader)&&u(e._contentHeader.boundingVolume),r=t.debugShowBoundingVolume||t.debugShowContentBoundingVolume&&!o;if(r){let c;e._finalResolution?e.hasRenderableContent?c=G.WHITE:c=G.DARKGRAY:c=G.YELLOW,u(e._debugBoundingVolume)||(e._debugBoundingVolume=e._boundingVolume.createDebugVolume(c)),e._debugBoundingVolume.update(n);let l=e._debugBoundingVolume.getGeometryInstanceAttributes("outline");l.color=jt.toValue(c,l.color)}else!r&&u(e._debugBoundingVolume)&&(e._debugBoundingVolume=e._debugBoundingVolume.destroy());t.debugShowContentBoundingVolume&&o?(u(e._debugContentBoundingVolume)||(e._debugContentBoundingVolume=e._contentBoundingVolume.createDebugVolume(G.BLUE)),e._debugContentBoundingVolume.update(n)):!t.debugShowContentBoundingVolume&&u(e._debugContentBoundingVolume)&&(e._debugContentBoundingVolume=e._debugContentBoundingVolume.destroy()),t.debugShowViewerRequestVolume&&u(e._viewerRequestVolume)?(u(e._debugViewerRequestVolume)||(e._debugViewerRequestVolume=e._viewerRequestVolume.createDebugVolume(G.YELLOW)),e._debugViewerRequestVolume.update(n)):!t.debugShowViewerRequestVolume&&u(e._debugViewerRequestVolume)&&(e._debugViewerRequestVolume=e._debugViewerRequestVolume.destroy());let s=t.debugColorizeTiles&&!e._debugColorizeTiles||u(t._heatmap.tilePropertyName),a=!t.debugColorizeTiles&&e._debugColorizeTiles;s?(t._heatmap.colorize(e,n),e._debugColorizeTiles=!0,e.color=e._debugColor):a&&(e._debugColorizeTiles=!1,e.color=G.WHITE),e._colorDirty&&(e._colorDirty=!1,e._content.applyDebugSettings(!0,e._color)),a&&t.makeStyleDirty()}function DXe(e,t,n){let i=e._expiredContent;if(!e.hasMultipleContents&&u(i)){if(!e.contentReady){try{i.update(t,n)}catch{}return}e._expiredContent.destroy(),e._expiredContent=void 0}if(u(e.content))try{e.content.update(t,n)}catch(o){throw e._contentState=Qo.FAILED,o}}function IXe(e,t){let n=t.clippingPlanes,i=0;u(n)&&e._isClipped&&n.enabled&&(i=n.clippingPlanesState),i!==e._clippingPlanesState&&(e._clippingPlanesState=i,e.clippingPlanesDirty=!0)}function PXe(e,t){let n=t.clippingPolygons,i=0;u(n)&&e._isClippedByPolygon&&n.enabled&&(i=n.clippingPolygonsState),i!==e._clippingPolygonsState&&(e._clippingPolygonsState=i,e.clippingPolygonsDirty=!0)}Jo.prototype.update=function(e,t,n){let{commandList:i}=t,o=i.length;IXe(this,e),PXe(this,e),wXe(this,e,t,n),DXe(this,e,t);let r=i.length;this._commandsLength=r-o;for(let s=o;s<r;++s){let a=i[s],c=a.pass===we.TRANSLUCENT;a.depthForTranslucentClassification=c}this.clippingPlanesDirty=!1,this.clippingPolygonsDirty=!1};var _ue=[];Jo.prototype.process=function(e,t){!this.contentExpired&&!this.contentReady&&this._content.ready&&(dXe(this),this._selectedFrame=0,this.lastStyleTime=0,$.now(this._loadTimestamp),this._contentState=Qo.READY,!this.hasTilesetContent&&!this.hasImplicitContent&&(e._statistics.incrementLoadCounts(this.content),++e._statistics.numberOfTilesWithContentReady,++e._statistics.numberOfLoadedTilesTotal,e._cache.add(this)));let n=t.commandList;t.commandList=_ue;try{this._content.update(e,t)}catch(i){throw this._contentState=Qo.FAILED,i}_ue.length=0,t.commandList=n};function gue(e,t,n){let i=e*Math.pow(10,t);return parseInt(i)*Math.pow(10,n)}function T3(e,t,n){return Math.max(R.normalize(e,t,n)-R.EPSILON7,0)}Jo.prototype.updatePriority=function(){let e=this.tileset,t=e.preferLeaves,n=e._minimumPriority,i=e._maximumPriority,o=4,r=1,s=0,a=o,c=s+a,l=o,f=c+l,d=r,p=Math.pow(10,f),g=f+d,m=r,y=Math.pow(10,g),b=g+m,C=Math.pow(10,b),A=T3(this._depth,n.depth,i.depth);A=t?1-A:A;let E=!e.isSkippingLevelOfDetail&&this.refine===Zo.REPLACE?T3(this._priorityHolder._distanceToCamera,n.distance,i.distance):T3(this._priorityReverseScreenSpaceError,n.reverseScreenSpaceError,i.reverseScreenSpaceError),v=gue(E,a,s),D=this._priorityProgressiveResolution?0:p,O=T3(this._priorityHolder._foveatedFactor,n.foveatedFactor,i.foveatedFactor),P=gue(O,l,c),M=this.priorityDeferred?y:0,L=e._pass===Ho.PRELOAD_FLIGHT?0:C;this._priority=A+v+D+P+M+L};Jo.prototype.isDestroyed=function(){return!1};Jo.prototype.destroy=function(){return this._content=this._content&&this._content.destroy(),this._expiredContent=this._expiredContent&&!this._expiredContent.isDestroyed()&&this._expiredContent.destroy(),this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy(),this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy(),this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy(),ue(this)};var Od=Jo;function Wp(e){e=x(e,x.EMPTY_OBJECT);let t=e.id,n=e.group,i=e.class,o=u(n.properties)?n.properties:{};this._class=i,this._properties=o,this._id=t,this._extras=n.extras,this._extensions=n.extensions}Object.defineProperties(Wp.prototype,{class:{get:function(){return this._class}},id:{get:function(){return this._id}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});Wp.prototype.hasProperty=function(e){return Bn.hasProperty(e,this._properties,this._class)};Wp.prototype.hasPropertyBySemantic=function(e){return Bn.hasPropertyBySemantic(e,this._properties,this._class)};Wp.prototype.getPropertyIds=function(e){return Bn.getPropertyIds(this._properties,this._class,e)};Wp.prototype.getProperty=function(e){return Bn.getProperty(e,this._properties,this._class)};Wp.prototype.setProperty=function(e,t){return Bn.setProperty(e,t,this._properties,this._class)};Wp.prototype.getPropertyBySemantic=function(e){return Bn.getPropertyBySemantic(e,this._properties,this._class)};Wp.prototype.setPropertyBySemantic=function(e,t){return Bn.setPropertyBySemantic(e,t,this._properties,this._class)};var Kw=Wp;function jp(e){e=x(e,x.EMPTY_OBJECT);let t=e.tileset,n=e.class,i=u(t.properties)?t.properties:{};this._class=n,this._properties=i,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(jp.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});jp.prototype.hasProperty=function(e){return Bn.hasProperty(e,this._properties,this._class)};jp.prototype.hasPropertyBySemantic=function(e){return Bn.hasPropertyBySemantic(e,this._properties,this._class)};jp.prototype.getPropertyIds=function(e){return Bn.getPropertyIds(this._properties,this._class,e)};jp.prototype.getProperty=function(e){return Bn.getProperty(e,this._properties,this._class)};jp.prototype.setProperty=function(e,t){return Bn.setProperty(e,t,this._properties,this._class)};jp.prototype.getPropertyBySemantic=function(e){return Bn.getPropertyBySemantic(e,this._properties,this._class)};jp.prototype.setPropertyBySemantic=function(e,t){return Bn.setPropertyBySemantic(e,t,this._properties,this._class)};var E3=jp;function Eue(e){e=x(e,x.EMPTY_OBJECT);let t=e.metadataJson,n=e.schema,i=x(t.metadata,t.tileset),o;u(i)&&(o=new E3({tileset:i,class:n.classes[i.class]}));let r=[],s=[],a=t.groups;if(Array.isArray(a)){let c=a.length;for(let l=0;l<c;l++){let f=a[l];s.push(new Kw({group:f,class:n.classes[f.class]}))}}else if(u(a)){r=Object.keys(a).sort();let c=r.length;for(let l=0;l<c;l++){let f=r[l];if(a.hasOwnProperty(f)){let d=a[f];s.push(new Kw({id:f,group:a[f],class:n.classes[d.class]}))}}}this._schema=n,this._groups=s,this._groupIds=r,this._tileset=o,this._statistics=t.statistics,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(Eue.prototype,{schema:{get:function(){return this._schema}},groups:{get:function(){return this._groups}},groupIds:{get:function(){return this._groupIds}},tileset:{get:function(){return this._tileset}},statistics:{get:function(){return this._statistics}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});var lT=Eue;var Sue={},RXe=new h;Sue.checkChildrenWithinParent=function(e){let t=e.children,n=t.length,i=e.boundingVolume;if(i instanceof If||i instanceof Pd){let o=i._orientedBoundingBox;e._optimChildrenWithinParent=Id.USE_OPTIMIZATION;for(let r=0;r<n;++r){let a=t[r].boundingVolume;if(!(a instanceof If||a instanceof Pd)){e._optimChildrenWithinParent=Id.SKIP_OPTIMIZATION;break}let c=a._orientedBoundingBox,l=h.subtract(c.center,o.center,RXe),f=h.magnitude(l);h.divideByScalar(l,f,l);let d=Math.abs(o.halfAxes[0]*l.x)+Math.abs(o.halfAxes[1]*l.y)+Math.abs(o.halfAxes[2]*l.z)+Math.abs(o.halfAxes[3]*l.x)+Math.abs(o.halfAxes[4]*l.y)+Math.abs(o.halfAxes[5]*l.z)+Math.abs(o.halfAxes[6]*l.x)+Math.abs(o.halfAxes[7]*l.y)+Math.abs(o.halfAxes[8]*l.z),p=Math.abs(c.halfAxes[0]*l.x)+Math.abs(c.halfAxes[1]*l.y)+Math.abs(c.halfAxes[2]*l.z)+Math.abs(c.halfAxes[3]*l.x)+Math.abs(c.halfAxes[4]*l.y)+Math.abs(c.halfAxes[5]*l.z)+Math.abs(c.halfAxes[6]*l.x)+Math.abs(c.halfAxes[7]*l.y)+Math.abs(c.halfAxes[8]*l.z);if(d<=p+f){e._optimChildrenWithinParent=Id.SKIP_OPTIMIZATION;break}}}return e._optimChildrenWithinParent===Id.USE_OPTIMIZATION};var S3=Sue;function Zw(){this.head=void 0,this.tail=void 0,this._length=0}Object.defineProperties(Zw.prototype,{length:{get:function(){return this._length}}});function OXe(e,t,n){this.item=e,this.previous=t,this.next=n}Zw.prototype.add=function(e){let t=new OXe(e,this.tail,void 0);return u(this.tail)?(this.tail.next=t,this.tail=t):(this.head=t,this.tail=t),++this._length,t};function vue(e,t){u(t.previous)&&u(t.next)?(t.previous.next=t.next,t.next.previous=t.previous):u(t.previous)?(t.previous.next=void 0,e.tail=t.previous):u(t.next)?(t.next.previous=void 0,e.head=t.next):(e.head=void 0,e.tail=void 0),t.next=void 0,t.previous=void 0}Zw.prototype.remove=function(e){u(e)&&(vue(this,e),--this._length)};Zw.prototype.splice=function(e,t){if(e===t)return;vue(this,t);let n=e.next;e.next=t,this.tail===e?this.tail=t:n.previous=t,t.next=n,t.previous=e};var v3=Zw;function Lx(){this._list=new v3,this._sentinel=this._list.add(),this._trimTiles=!1}Lx.prototype.reset=function(){this._list.splice(this._list.tail,this._sentinel)};Lx.prototype.touch=function(e){let t=e.cacheNode;u(t)&&this._list.splice(this._sentinel,t)};Lx.prototype.add=function(e){u(e.cacheNode)||(e.cacheNode=this._list.add(e))};Lx.prototype.unloadTile=function(e,t,n){let i=t.cacheNode;u(i)&&(this._list.remove(i),t.cacheNode=void 0,n(e,t))};Lx.prototype.unloadTiles=function(e,t){let n=this._trimTiles;this._trimTiles=!1;let i=this._list,o=this._sentinel,r=i.head;for(;r!==o&&(e.totalMemoryUsageInBytes>e.cacheBytes||n);){let s=r.item;r=r.next,this.unloadTile(e,s,t)}};Lx.prototype.trim=function(){this._trimTiles=!0};var w3=Lx;function D3(e){this.tilePropertyName=e,this._minimum=Number.MAX_VALUE,this._maximum=-Number.MAX_VALUE,this._previousMinimum=Number.MAX_VALUE,this._previousMaximum=-Number.MAX_VALUE,this._referenceMinimum={},this._referenceMaximum={}}function J7(e,t){let n;return t==="_loadTimestamp"?n=$.toDate(e).getTime():n=e,n}D3.prototype.setReferenceMinimumMaximum=function(e,t,n){this._referenceMinimum[n]=J7(e,n),this._referenceMaximum[n]=J7(t,n)};function MXe(e,t){let n=e.tilePropertyName;if(u(n)){let i=J7(t[n],n);return u(i)?(e._maximum=Math.max(i,e._maximum),e._minimum=Math.min(i,e._minimum),i):(e.tilePropertyName=void 0,i)}}var Q7=[new G(.1,.1,.1,1),new G(.153,.278,.878,1),new G(.827,.231,.49,1),new G(.827,.188,.22,1),new G(1,.592,.259,1),new G(1,.843,0,1)];D3.prototype.colorize=function(e,t){let n=this.tilePropertyName;if(!u(n)||!e.contentAvailable||e._selectedFrame!==t.frameNumber)return;let i=MXe(this,e),o=this._previousMinimum,r=this._previousMaximum;if(o===Number.MAX_VALUE||r===-Number.MAX_VALUE)return;let s=r-o+R.EPSILON7,c=R.clamp(i-o,0,s)/s,l=Q7.length-1,f=c*l,d=Math.floor(f),p=Math.ceil(f),g=f-d,m=Q7[d],y=Q7[p],b=G.clone(G.WHITE);b.red=R.lerp(m.red,y.red,g),b.green=R.lerp(m.green,y.green,g),b.blue=R.lerp(m.blue,y.blue,g),e._debugColor=b};D3.prototype.resetMinimumMaximum=function(){let e=this.tilePropertyName;if(u(e)){let t=this._referenceMinimum[e],n=this._referenceMaximum[e],i=u(t)&&u(n);this._previousMinimum=i?t:this._minimum,this._previousMaximum=i?n:this._maximum,this._minimum=Number.MAX_VALUE,this._maximum=-Number.MAX_VALUE}};var I3=D3;function uT(){this.selected=0,this.visited=0,this.numberOfCommands=0,this.numberOfAttemptedRequests=0,this.numberOfPendingRequests=0,this.numberOfTilesProcessing=0,this.numberOfTilesWithContentReady=0,this.numberOfTilesTotal=0,this.numberOfLoadedTilesTotal=0,this.numberOfFeaturesSelected=0,this.numberOfFeaturesLoaded=0,this.numberOfPointsSelected=0,this.numberOfPointsLoaded=0,this.numberOfTrianglesSelected=0,this.numberOfTilesStyled=0,this.numberOfFeaturesStyled=0,this.numberOfTilesCulledWithChildrenUnion=0,this.geometryByteLength=0,this.texturesByteLength=0,this.batchTableByteLength=0}uT.prototype.clear=function(){this.selected=0,this.visited=0,this.numberOfCommands=0,this.numberOfAttemptedRequests=0,this.numberOfFeaturesSelected=0,this.numberOfPointsSelected=0,this.numberOfTrianglesSelected=0,this.numberOfTilesStyled=0,this.numberOfFeaturesStyled=0,this.numberOfTilesCulledWithChildrenUnion=0};function P3(e,t,n,i){let o=t.innerContents,r=t.pointsLength,s=t.trianglesLength,a=t.featuresLength,c=t.geometryByteLength,l=t.texturesByteLength,f=t.batchTableByteLength;if(i?(e.numberOfFeaturesLoaded+=n?-a:a,e.numberOfPointsLoaded+=n?-r:r,e.geometryByteLength+=n?-c:c,e.texturesByteLength+=n?-l:l,e.batchTableByteLength+=n?-f:f):(e.numberOfFeaturesSelected+=n?-a:a,e.numberOfPointsSelected+=n?-r:r,e.numberOfTrianglesSelected+=n?-s:s),u(o)){let d=o.length;for(let p=0;p<d;++p)P3(e,o[p],n,i)}}uT.prototype.incrementSelectionCounts=function(e){P3(this,e,!1,!1)};uT.prototype.incrementLoadCounts=function(e){P3(this,e,!1,!0)};uT.prototype.decrementLoadCounts=function(e){P3(this,e,!0,!0)};uT.clone=function(e,t){t.selected=e.selected,t.visited=e.visited,t.numberOfCommands=e.numberOfCommands,t.selected=e.selected,t.numberOfAttemptedRequests=e.numberOfAttemptedRequests,t.numberOfPendingRequests=e.numberOfPendingRequests,t.numberOfTilesProcessing=e.numberOfTilesProcessing,t.numberOfTilesWithContentReady=e.numberOfTilesWithContentReady,t.numberOfTilesTotal=e.numberOfTilesTotal,t.numberOfFeaturesSelected=e.numberOfFeaturesSelected,t.numberOfFeaturesLoaded=e.numberOfFeaturesLoaded,t.numberOfPointsSelected=e.numberOfPointsSelected,t.numberOfPointsLoaded=e.numberOfPointsLoaded,t.numberOfTrianglesSelected=e.numberOfTrianglesSelected,t.numberOfTilesStyled=e.numberOfTilesStyled,t.numberOfFeaturesStyled=e.numberOfFeaturesStyled,t.numberOfTilesCulledWithChildrenUnion=e.numberOfTilesCulledWithChildrenUnion,t.geometryByteLength=e.geometryByteLength,t.texturesByteLength=e.texturesByteLength,t.batchTableByteLength=e.batchTableByteLength};var Zg=uT;function $w(){this._style=void 0,this._styleDirty=!1,this._lastStyleTime=0}Object.defineProperties($w.prototype,{style:{get:function(){return this._style},set:function(e){e!==this._style&&(this._style=e,this._styleDirty=!0)}}});$w.prototype.makeDirty=function(){this._styleDirty=!0};$w.prototype.resetDirty=function(){this._styleDirty=!1};$w.prototype.applyStyle=function(e){if(!u(e.root)||u(this._style)&&!this._style._ready)return;let t=this._styleDirty;t&&++this._lastStyleTime;let n=this._lastStyleTime,i=e._statistics,o=t?e._selectedTiles:e._selectedTilesToStyle,r=o.length;for(let s=0;s<r;++s){let a=o[s];if(a.lastStyleTime!==n){let c=a.content;a.lastStyleTime=n,c.applyStyle(this._style),i.numberOfFeaturesStyled+=c.featuresLength,++i.numberOfTilesStyled}}};var R3=$w;function LXe(e,t,n){let i=si(t,"3DTILES_implicit_tiling")?t.extensions["3DTILES_implicit_tiling"]:t.implicitTiling;this.baseResource=e,this.geometricError=t.geometricError,this.metadataSchema=n;let o=t.boundingVolume;if(!u(o.box)&&!u(o.region)&&!si(o,"3DTILES_bounding_volume_S2")&&!si(o,"3DTILES_bounding_volume_cylinder"))throw new ce("Only box, region, 3DTILES_bounding_volume_S2, and 3DTILES_bounding_volume_cylinder are supported for implicit tiling");this.boundingVolume=o,this.refine=t.refine,this.subtreeUriTemplate=new De({url:i.subtrees.uri}),this.contentUriTemplates=[],this.contentHeaders=[];let r=NXe(t);for(let s=0;s<r.length;s++){let a=r[s];this.contentHeaders.push(Ge(a,!0));let c=new De({url:a.uri});this.contentUriTemplates.push(c)}this.contentCount=this.contentHeaders.length,this.tileHeader=FXe(t),this.subdivisionScheme=ss[i.subdivisionScheme],this.branchingFactor=ss.getBranchingFactor(this.subdivisionScheme),this.subtreeLevels=i.subtreeLevels,u(i.availableLevels)?this.availableLevels=i.availableLevels:this.availableLevels=i.maximumLevel+1}function NXe(e){if(si(e,"3DTILES_multiple_contents")){let t=e.extensions["3DTILES_multiple_contents"];return u(t.contents)?t.contents:t.content}return u(e.contents)?e.contents:u(e.content)?[e.content]:[]}function FXe(e){let t=Ge(e,!0);return u(t.extensions)&&(delete t.extensions["3DTILES_implicit_tiling"],delete t.extensions["3DTILES_multiple_contents"],Object.keys(t.extensions).length===0&&delete t.extensions),delete t.implicitTiling,delete t.contents,delete t.content,t}var fT=LXe;var Qw={};function wue(e){return e=(e^e<<8)&16711935,e=(e^e<<4)&252645135,e=(e^e<<2)&858993459,e=(e^e<<1)&1431655765,e}function ej(e){return e=(e^e<<16)&50331903,e=(e^e<<8)&50393103,e=(e^e<<4)&51130563,e=(e^e<<2)&153391689,e}function Due(e){return e&=1431655765,e=(e^e>>1)&858993459,e=(e^e>>2)&252645135,e=(e^e>>4)&16711935,e=(e^e>>8)&65535,e}function tj(e){return e&=153391689,e=(e^e>>2)&51130563,e=(e^e>>4)&50393103,e=(e^e>>8)&4278190335,e=(e^e>>16)&1023,e}Qw.encode2D=function(e,t){return(wue(e)|wue(t)<<1)>>>0};Qw.decode2D=function(e,t){return u(t)||(t=new Array(2)),t[0]=Due(e),t[1]=Due(e>>1),t};Qw.encode3D=function(e,t,n){return ej(e)|ej(t)<<1|ej(n)<<2};Qw.decode3D=function(e,t){return u(t)||(t=new Array(3)),t[0]=tj(e),t[1]=tj(e>>1),t[2]=tj(e>>2),t};var Nx=Qw;function Go(e){this.subdivisionScheme=e.subdivisionScheme,this.subtreeLevels=e.subtreeLevels,this.level=e.level,this.x=e.x,this.y=e.y,this.z=void 0,e.subdivisionScheme===ss.OCTREE&&(this.z=e.z)}Object.defineProperties(Go.prototype,{childIndex:{get:function(){let e=0;return e|=this.x&1,e|=(this.y&1)<<1,this.subdivisionScheme===ss.OCTREE&&(e|=(this.z&1)<<2),e}},mortonIndex:{get:function(){return this.subdivisionScheme===ss.OCTREE?Nx.encode3D(this.x,this.y,this.z):Nx.encode2D(this.x,this.y)}},tileIndex:{get:function(){let e=this.subdivisionScheme===ss.OCTREE?((1<<3*this.level)-1)/7:((1<<2*this.level)-1)/3,t=this.mortonIndex;return e+t}}});Go.prototype.getDescendantCoordinates=function(e){let t=this.level+e.level,n=(this.x<<e.level)+e.x,i=(this.y<<e.level)+e.y;if(this.subdivisionScheme===ss.OCTREE){let o=(this.z<<e.level)+e.z;return new Go({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:t,x:n,y:i,z:o})}return new Go({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:t,x:n,y:i})};Go.prototype.getAncestorCoordinates=function(e){let t=1<<e,n=this.level-e,i=Math.floor(this.x/t),o=Math.floor(this.y/t);if(this.subdivisionScheme===ss.OCTREE){let r=Math.floor(this.z/t);return new Go({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:n,x:i,y:o,z:r})}return new Go({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:n,x:i,y:o})};Go.prototype.getOffsetCoordinates=function(e){let t=e.level-this.level,n=1<<t,i=e.x%n,o=e.y%n;if(this.subdivisionScheme===ss.OCTREE){let r=e.z%n;return new Go({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:t,x:i,y:o,z:r})}return new Go({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:t,x:i,y:o})};Go.prototype.getChildCoordinates=function(e){let t=this.level+1,n=2*this.x+e%2,i=2*this.y+Math.floor(e/2)%2;if(this.subdivisionScheme===ss.OCTREE){let o=2*this.z+Math.floor(e/4)%2;return new Go({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:t,x:n,y:i,z:o})}return new Go({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:t,x:n,y:i})};Go.prototype.getSubtreeCoordinates=function(){return this.getAncestorCoordinates(this.level%this.subtreeLevels)};Go.prototype.getParentSubtreeCoordinates=function(){return this.getAncestorCoordinates(this.level%this.subtreeLevels+this.subtreeLevels)};Go.prototype.isAncestor=function(e){let t=e.level-this.level;if(t<=0)return!1;let n=e.x>>t,i=e.y>>t,o=this.x===n,r=this.y===i;if(this.subdivisionScheme===ss.OCTREE){let s=e.z>>t,a=this.z===s;return o&&r&&a}return o&&r};Go.prototype.isEqual=function(e){return this.subdivisionScheme===e.subdivisionScheme&&this.subtreeLevels===e.subtreeLevels&&this.level===e.level&&this.x===e.x&&this.y===e.y&&(this.subdivisionScheme===ss.OCTREE?this.z===e.z:!0)};Go.prototype.isImplicitTilesetRoot=function(){return this.level===0};Go.prototype.isSubtreeRoot=function(){return this.level%this.subtreeLevels===0};Go.prototype.isBottomOfSubtree=function(){return this.level%this.subtreeLevels===this.subtreeLevels-1};Go.prototype.getTemplateValues=function(){let e={level:this.level,x:this.x,y:this.y};return this.subdivisionScheme===ss.OCTREE&&(e.z=this.z),e};var Iue=[0,0,0];Go.fromMortonIndex=function(e,t,n,i){let o;return e===ss.OCTREE?(o=Nx.decode3D(i,Iue),new Go({subdivisionScheme:e,subtreeLevels:t,level:n,x:o[0],y:o[1],z:o[2]})):(o=Nx.decode2D(i,Iue),new Go({subdivisionScheme:e,subtreeLevels:t,level:n,x:o[0],y:o[1]}))};Go.fromTileIndex=function(e,t,n){let i,o,r;return e===ss.OCTREE?(i=Math.floor(R.log2(7*n+1)/3),o=((1<<3*i)-1)/7,r=n-o):(i=Math.floor(R.log2(3*n+1)/2),o=((1<<2*i)-1)/3,r=n-o),Go.fromMortonIndex(e,t,i,r)};var dT=Go;function qp(){}qp.selectTiles=function(e,t){he.throwInstantiationError()};qp.sortChildrenByDistanceToCamera=function(e,t){return t._distanceToCamera===0&&e._distanceToCamera===0?t._centerZDepth-e._centerZDepth:t._distanceToCamera-e._distanceToCamera};qp.canTraverse=function(e){return e.children.length===0?!1:e.hasTilesetContent||e.hasImplicitContent?!e.contentExpired:e._screenSpaceError>e.tileset.memoryAdjustedScreenSpaceError};qp.selectTile=function(e,t){if(e.contentVisibility(t)===qt.OUTSIDE)return;e._wasSelectedLastFrame=!0;let{content:n,tileset:i}=e;n.featurePropertiesDirty?(n.featurePropertiesDirty=!1,e.lastStyleTime=0,i._selectedTilesToStyle.push(e)):e._selectedFrame<t.frameNumber-1&&(i._selectedTilesToStyle.push(e),e._wasSelectedLastFrame=!1),e._selectedFrame=t.frameNumber,i._selectedTiles.push(e)};qp.visitTile=function(e,t){++e.tileset._statistics.visited,e._visitedFrame=t.frameNumber};qp.touchTile=function(e,t){e._touchedFrame!==t.frameNumber&&(e.tileset._cache.touch(e),e._touchedFrame=t.frameNumber)};qp.loadTile=function(e,t){let{tileset:n}=e;if(e._requestedFrame===t.frameNumber||!e.hasUnloadedRenderableContent&&!e.contentExpired||!BXe(e,t))return;let i=t.camera.timeSinceMoved<n.foveatedTimeDelay;e.priorityDeferred&&i||(e._requestedFrame=t.frameNumber,n._requestedTiles.push(e))};function BXe(e,t){let{tileset:n}=e;if(!n._cullRequestsWhileMoving)return!0;let{positionWCDeltaMagnitude:i,positionWCDeltaMagnitudeLastFrame:o}=t.camera,r=i!==0?i:o,s=Math.max(e.boundingSphere.radius*2,1);return n.cullRequestsWhileMovingMultiplier*r/s<1}qp.updateTile=function(e,t){Pue(e,t),e.updateExpiration(),e._wasMinPriorityChild=!1,e._priorityHolder=e,UXe(e),e._shouldSelect=!1,e._finalResolution=!0};function Pue(e,t){if(e.updateVisibility(t),!e.isVisible)return;let n=e.children.length>0;if((e.hasTilesetContent||e.hasImplicitContent)&&n){let r=e.children[0];Pue(r,t),e._visible=r._visible;return}if(kXe(e,t)){e._visible=!1;return}let i=e.refine===Zo.REPLACE,o=e._optimChildrenWithinParent===Id.USE_OPTIMIZATION;if(i&&o&&n&&!VXe(e,t)){++e.tileset._statistics.numberOfTilesCulledWithChildrenUnion,e._visible=!1;return}}function kXe(e,t){let{parent:n,tileset:i}=e;return!u(n)||n.hasTilesetContent||n.hasImplicitContent||n.refine!==Zo.ADD?!1:e.getScreenSpaceError(t,!0)<=i.memoryAdjustedScreenSpaceError}function VXe(e,t){let n=!1,i=e.children;for(let o=0;o<i.length;++o){let r=i[o];r.updateVisibility(t),n=n||r.isVisible}return n}function UXe(e){let t=e.tileset._minimumPriority,n=e.tileset._maximumPriority,i=e._priorityHolder;n.distance=Math.max(i._distanceToCamera,n.distance),t.distance=Math.min(i._distanceToCamera,t.distance),n.depth=Math.max(e._depth,n.depth),t.depth=Math.min(e._depth,t.depth),n.foveatedFactor=Math.max(i._foveatedFactor,n.foveatedFactor),t.foveatedFactor=Math.min(i._foveatedFactor,t.foveatedFactor),n.reverseScreenSpaceError=Math.max(e._priorityReverseScreenSpaceError,n.reverseScreenSpaceError),t.reverseScreenSpaceError=Math.min(e._priorityReverseScreenSpaceError,t.reverseScreenSpaceError)}var ca=qp;function Rue(){}var Jw={stack:new yl,stackMaximumLength:0};Rue.selectTiles=function(e,t){e._selectedTiles.length=0,e._requestedTiles.length=0,e.hasMixedContent=!1;let n=!0,i=e.root;if(i.updateVisibility(t),!i.isVisible)return n;let{touchTile:o,visitTile:r}=ca,s=Jw.stack;for(s.push(i);s.length>0;){Jw.stackMaximumLength=Math.max(Jw.stackMaximumLength,s.length);let a=s.pop(),c=a.refine===Zo.ADD,l=a.refine===Zo.REPLACE,f=zXe(a);f&&HXe(a,s,t),(c||l&&!f)&&(GXe(e,a),o(a,t),WXe(a,t),a.hasRenderableContent&&!a.contentAvailable&&(n=!1)),r(a,t)}return Jw.stack.trim(Jw.stackMaximumLength),n};function zXe(e){return e.children.length===0?!1:e.hasTilesetContent||e.hasImplicitContent?!e.contentExpired:(e.hasEmptyContent,!0)}function HXe(e,t,n){let{children:i}=e;for(let o=0;o<i.length;++o){let r=i[o];r.updateVisibility(n),r.isVisible&&t.push(r)}}function GXe(e,t){(t.hasUnloadedRenderableContent||t.contentExpired)&&(t._priority=0,e._requestedTiles.push(t))}function WXe(e,t){e.contentAvailable&&e.contentVisibility(t)!==qt.OUTSIDE&&e.tileset._selectedTiles.push(e)}var O3=Rue;function Oue(){}var e1={stack:new yl,stackMaximumLength:0},t1={stack:new yl,stackMaximumLength:0};Oue.selectTiles=function(e,t){if(e._requestedTiles.length=0,e.debugFreezeFrame)return;e._selectedTiles.length=0,e._selectedTilesToStyle.length=0,e._emptyTiles.length=0,e.hasMixedContent=!1;let n=e.root;if(ca.updateTile(n,t),!n.isVisible||n.getScreenSpaceError(t,!0)<=e.memoryAdjustedScreenSpaceError)return;qXe(n,t),e1.stack.trim(e1.stackMaximumLength),t1.stack.trim(t1.stackMaximumLength);let i=e._requestedTiles;for(let o=0;o<i.length;++o)i[o].updatePriority()};function nj(e,t){e.contentAvailable&&ca.selectTile(e,t)}function jXe(e,t,n){let i=e.refine===Zo.REPLACE,{tileset:o,children:r}=e,{updateTile:s,loadTile:a,touchTile:c}=ca;for(let m=0;m<r.length;++m)s(r[m],n);r.sort(ca.sortChildrenByDistanceToCamera);let l=i&&e.hasRenderableContent,f=!0,d=!1,p=-1,g=Number.MAX_VALUE;for(let m=0;m<r.length;++m){let y=r[m];if(y.isVisible?(t.push(y),y._foveatedFactor<g&&(p=m,g=y._foveatedFactor),d=!0):(l||o.loadSiblings)&&(y._foveatedFactor<g&&(p=m,g=y._foveatedFactor),a(y,n),c(y,n)),l){let b;y._inRequestVolume?y.hasRenderableContent?b=y.contentAvailable:b=YXe(y,n):b=!1,f=f&&b}}if(d||(f=!1),p!==-1&&i){let m=r[p];m._wasMinPriorityChild=!0;let y=(e._wasMinPriorityChild||e===o.root)&&g<=e._priorityHolder._foveatedFactor?e._priorityHolder:e;y._foveatedFactor=Math.min(m._foveatedFactor,y._foveatedFactor),y._distanceToCamera=Math.min(m._distanceToCamera,y._distanceToCamera);for(let b=0;b<r.length;++b)r[b]._priorityHolder=y}return f}function qXe(e,t){let{tileset:n}=e,{canTraverse:i,loadTile:o,visitTile:r,touchTile:s}=ca,a=e1.stack;for(a.push(e);a.length>0;){e1.stackMaximumLength=Math.max(e1.stackMaximumLength,a.length);let c=a.pop(),l=c.parent,f=!u(l)||l._refines;c._refines=i(c)?jXe(c,a,t)&&f:!1;let d=!c._refines&&f;c.hasRenderableContent?c.refine===Zo.ADD?(nj(c,t),o(c,t)):c.refine===Zo.REPLACE&&(o(c,t),d&&nj(c,t)):(n._emptyTiles.push(c),o(c,t),d&&nj(c,t)),r(c,t),s(c,t)}}function YXe(e,t){let{canTraverse:n,updateTile:i,loadTile:o,touchTile:r}=ca,s=!0,a=t1.stack;for(a.push(e);a.length>0;){t1.stackMaximumLength=Math.max(t1.stackMaximumLength,a.length);let c=a.pop(),l=c.children,f=l.length,d=!c.hasRenderableContent&&n(c);if(!d&&!c.contentAvailable&&(s=!1),i(c,t),c.isVisible||(o(c,t),r(c,t)),d)for(let p=0;p<f;++p){let g=l[p];a.push(g)}}return e.hasEmptyContent||s}var M3=Oue;function Mue(){}var n1={stack:new yl,stackMaximumLength:0},i1={stack:new yl,stackMaximumLength:0},Yp={stack:new yl,stackMaximumLength:0,ancestorStack:new yl,ancestorStackMaximumLength:0},XXe=2;Mue.selectTiles=function(e,t){if(e._requestedTiles.length=0,e.debugFreezeFrame)return;e._selectedTiles.length=0,e._selectedTilesToStyle.length=0,e._emptyTiles.length=0,e.hasMixedContent=!1;let n=e.root;if(ca.updateTile(n,t),!n.isVisible||n.getScreenSpaceError(t,!0)<=e.memoryAdjustedScreenSpaceError)return;eKe(n,t),tKe(n,t),n1.stack.trim(n1.stackMaximumLength),i1.stack.trim(i1.stackMaximumLength),Yp.stack.trim(Yp.stackMaximumLength),Yp.ancestorStack.trim(Yp.ancestorStackMaximumLength);let i=e._requestedTiles;for(let o=0;o<i.length;++o)i[o].updatePriority()};function KXe(e,t){let{updateTile:n,touchTile:i,selectTile:o}=ca,r=i1.stack;for(r.push(e);r.length>0;){i1.stackMaximumLength=Math.max(i1.stackMaximumLength,r.length);let a=r.pop().children;for(let c=0;c<a.length;++c){let l=a[c];l.isVisible&&(l.contentAvailable?(n(l,t),i(l,t),o(l,t)):l._depth-e._depth<XXe&&r.push(l))}}}function L3(e,t){let n=e.contentAvailable?e:e._ancestorWithContentAvailable;u(n)?n._shouldSelect=!0:KXe(e,t)}function ZXe(e,t){e._ancestorWithContent=void 0,e._ancestorWithContentAvailable=void 0;let{parent:n}=e;if(!u(n))return;let i=!n.hasUnloadedRenderableContent||n._requestedFrame===t.frameNumber;e._ancestorWithContent=i?n:n._ancestorWithContent,e._ancestorWithContentAvailable=n.contentAvailable?n:n._ancestorWithContentAvailable}function $Xe(e,t){let n=t._ancestorWithContent;return!e.immediatelyLoadDesiredLevelOfDetail&&(t._priorityProgressiveResolutionScreenSpaceErrorLeaf||u(n)&&t._screenSpaceError<n._screenSpaceError/e.skipScreenSpaceErrorFactor&&t._depth>n._depth+e.skipLevels)}function QXe(e,t,n){let{tileset:i,children:o}=e,{updateTile:r,loadTile:s,touchTile:a}=ca;for(let l=0;l<o.length;++l)r(o[l],n);o.sort(ca.sortChildrenByDistanceToCamera);let c=!1;for(let l=0;l<o.length;++l){let f=o[l];f.isVisible?(t.push(f),c=!0):i.loadSiblings&&(s(f,n),a(f,n))}return c}function JXe(e,t){let{tileset:n}=e;return n.immediatelyLoadDesiredLevelOfDetail?!1:u(e._ancestorWithContent)?e._screenSpaceError===0?e.parent._screenSpaceError>t:e._screenSpaceError>t:!0}function eKe(e,t){let{tileset:n}=e,i=n.immediatelyLoadDesiredLevelOfDetail?Number.MAX_VALUE:Math.max(n.baseScreenSpaceError,n.memoryAdjustedScreenSpaceError),{canTraverse:o,loadTile:r,visitTile:s,touchTile:a}=ca,c=n1.stack;for(c.push(e);c.length>0;){n1.stackMaximumLength=Math.max(n1.stackMaximumLength,c.length);let l=c.pop();ZXe(l,t);let f=l.parent,d=!u(f)||f._refines;l._refines=o(l)?QXe(l,c,t)&&d:!1;let p=!l._refines&&d;l.hasRenderableContent?l.refine===Zo.ADD?(L3(l,t),r(l,t)):l.refine===Zo.REPLACE&&(JXe(l,i)?(r(l,t),p&&L3(l,t)):p?(L3(l,t),r(l,t)):$Xe(n,l)&&r(l,t)):(n._emptyTiles.push(l),r(l,t),p&&L3(l,t)),s(l,t),a(l,t)}}function tKe(e,t){let{selectTile:n,canTraverse:i}=ca,{stack:o,ancestorStack:r}=Yp,s;for(o.push(e);o.length>0||r.length>0;){if(Yp.stackMaximumLength=Math.max(Yp.stackMaximumLength,o.length),Yp.ancestorStackMaximumLength=Math.max(Yp.ancestorStackMaximumLength,r.length),r.length>0){let l=r.peek();if(l._stackLength===o.length){r.pop(),l!==s&&(l._finalResolution=!1),n(l,t);continue}}let a=o.pop();if(!u(a))continue;let c=i(a);if(a._shouldSelect)if(a.refine===Zo.ADD)n(a,t);else{if(a._selectionDepth=r.length,a._selectionDepth>0&&(a.tileset.hasMixedContent=!0),s=a,!c){n(a,t);continue}r.push(a),a._stackLength=o.length}if(c){let l=a.children;for(let f=0;f<l.length;++f){let d=l[f];d.isVisible&&o.push(d)}}}}var N3=Mue;function er(e){e=x(e,x.EMPTY_OBJECT),this._url=void 0,this._basePath=void 0,this._root=void 0,this._resource=void 0,this._asset=void 0,this._properties=void 0,this._geometricError=void 0,this._scaledGeometricError=void 0,this._extensionsUsed=void 0,this._extensions=void 0,this._modelUpAxis=void 0,this._modelForwardAxis=void 0,this._cache=new w3,this._processingQueue=[],this._selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this._selectedTilesToStyle=[],this._loadTimestamp=void 0,this._timeSinceLoad=0,this._updatedVisibilityFrame=0,this._updatedModelMatrixFrame=0,this._modelMatrixChanged=!1,this._previousModelMatrix=void 0,this._extras=void 0,this._credits=void 0,this._showCreditsOnScreen=x(e.showCreditsOnScreen,!1),this._cullWithChildrenBounds=x(e.cullWithChildrenBounds,!0),this._allTilesAdditive=!0,this._hasMixedContent=!1,this._stencilClearCommand=void 0,this._backfaceCommands=new yl,this._maximumScreenSpaceError=x(e.maximumScreenSpaceError,16),this._memoryAdjustedScreenSpaceError=this._maximumScreenSpaceError,this._cacheBytes=x(e.cacheBytes,512*1024*1024);let t=x(e.maximumCacheOverflowBytes,512*1024*1024);this._maximumCacheOverflowBytes=t,this._styleEngine=new R3,this._styleApplied=!1,this._modelMatrix=u(e.modelMatrix)?F.clone(e.modelMatrix):F.clone(F.IDENTITY),this._addHeightCallbacks=[],this._statistics=new Zg,this._statisticsLast=new Zg,this._statisticsPerPass=new Array(Ho.NUMBER_OF_PASSES);for(let o=0;o<Ho.NUMBER_OF_PASSES;++o)this._statisticsPerPass[o]=new Zg;this._requestedTilesInFlight=[],this._maximumPriority={foveatedFactor:-Number.MAX_VALUE,depth:-Number.MAX_VALUE,distance:-Number.MAX_VALUE,reverseScreenSpaceError:-Number.MAX_VALUE},this._minimumPriority={foveatedFactor:Number.MAX_VALUE,depth:Number.MAX_VALUE,distance:Number.MAX_VALUE,reverseScreenSpaceError:Number.MAX_VALUE},this._heatmap=new I3(e.debugHeatmapTilePropertyName),this.cullRequestsWhileMoving=x(e.cullRequestsWhileMoving,!0),this._cullRequestsWhileMoving=!1,this.cullRequestsWhileMovingMultiplier=x(e.cullRequestsWhileMovingMultiplier,60),this.progressiveResolutionHeightFraction=R.clamp(x(e.progressiveResolutionHeightFraction,.3),0,.5),this.preferLeaves=x(e.preferLeaves,!1),this._tilesLoaded=!1,this._initialTilesLoaded=!1,this._tileDebugLabels=void 0,this._classificationType=e.classificationType,this._ellipsoid=x(e.ellipsoid,ee.WGS84),this._initialClippingPlanesOriginMatrix=F.IDENTITY,this._clippingPlanesOriginMatrix=void 0,this._clippingPlanesOriginMatrixDirty=!0,this._vectorClassificationOnly=x(e.vectorClassificationOnly,!1),this._vectorKeepDecodedPositions=x(e.vectorKeepDecodedPositions,!1),this.preloadWhenHidden=x(e.preloadWhenHidden,!1),this.preloadFlightDestinations=x(e.preloadFlightDestinations,!0),this._pass=void 0,this.dynamicScreenSpaceError=x(e.dynamicScreenSpaceError,!0),this.foveatedScreenSpaceError=x(e.foveatedScreenSpaceError,!0),this._foveatedConeSize=x(e.foveatedConeSize,.1),this._foveatedMinimumScreenSpaceErrorRelaxation=x(e.foveatedMinimumScreenSpaceErrorRelaxation,0),this.foveatedInterpolationCallback=x(e.foveatedInterpolationCallback,R.lerp),this.foveatedTimeDelay=x(e.foveatedTimeDelay,.2),this.dynamicScreenSpaceErrorDensity=x(e.dynamicScreenSpaceErrorDensity,2e-4),this.dynamicScreenSpaceErrorFactor=x(e.dynamicScreenSpaceErrorFactor,24),this.dynamicScreenSpaceErrorHeightFalloff=x(e.dynamicScreenSpaceErrorHeightFalloff,.25),this._dynamicScreenSpaceErrorComputedDensity=0,this.shadows=x(e.shadows,xn.ENABLED),this.show=x(e.show,!0),this.colorBlendMode=nu.HIGHLIGHT,this.colorBlendAmount=.5,this._pointCloudShading=new Tp(e.pointCloudShading),this._pointCloudEyeDomeLighting=new Ig,this.loadProgress=new me,this.allTilesLoaded=new me,this.initialTilesLoaded=new me,this.tileLoad=new me,this.tileUnload=new me,this.tileFailed=new me,this.tileVisible=new me,this.skipLevelOfDetail=x(e.skipLevelOfDetail,!1),this._disableSkipLevelOfDetail=!1,this.baseScreenSpaceError=x(e.baseScreenSpaceError,1024),this.skipScreenSpaceErrorFactor=x(e.skipScreenSpaceErrorFactor,16),this.skipLevels=x(e.skipLevels,1),this.immediatelyLoadDesiredLevelOfDetail=x(e.immediatelyLoadDesiredLevelOfDetail,!1),this.loadSiblings=x(e.loadSiblings,!1),this._clippingPlanes=void 0,u(e.clippingPlanes)&&As.setOwner(e.clippingPlanes,this,"_clippingPlanes"),this._clippingPolygons=void 0,u(e.clippingPolygons)&&Yh.setOwner(e.clippingPolygons,this,"_clippingPolygons"),u(e.imageBasedLighting)?(this._imageBasedLighting=e.imageBasedLighting,this._shouldDestroyImageBasedLighting=!1):(this._imageBasedLighting=new nA,this._shouldDestroyImageBasedLighting=!0),this._environmentMapManager=new Eg(e.environmentMapOptions),this.lightColor=e.lightColor,this.backFaceCulling=x(e.backFaceCulling,!0),this._enableShowOutline=x(e.enableShowOutline,!0),this.showOutline=x(e.showOutline,!0),this.outlineColor=x(e.outlineColor,G.BLACK),this.splitDirection=x(e.splitDirection,Wr.NONE),this.enableCollision=x(e.enableCollision,!1),this._projectTo2D=x(e.projectTo2D,!1),this._enablePick=x(e.enablePick,!1),this.debugFreezeFrame=x(e.debugFreezeFrame,!1),this.debugColorizeTiles=x(e.debugColorizeTiles,!1),this._enableDebugWireframe=x(e.enableDebugWireframe,!1),this.debugWireframe=x(e.debugWireframe,!1),this.debugWireframe===!0&&this._enableDebugWireframe===!1&&At("tileset-debug-wireframe-ignored","enableDebugWireframe must be set to true in the Cesium3DTileset constructor, otherwise debugWireframe will be ignored."),this.debugShowBoundingVolume=x(e.debugShowBoundingVolume,!1),this.debugShowContentBoundingVolume=x(e.debugShowContentBoundingVolume,!1),this.debugShowViewerRequestVolume=x(e.debugShowViewerRequestVolume,!1),this._tileDebugLabels=void 0,this.debugPickedTileLabelOnly=!1,this.debugPickedTile=void 0,this.debugPickPosition=void 0,this.debugShowGeometricError=x(e.debugShowGeometricError,!1),this.debugShowRenderingStatistics=x(e.debugShowRenderingStatistics,!1),this.debugShowMemoryUsage=x(e.debugShowMemoryUsage,!1),this.debugShowUrl=x(e.debugShowUrl,!1),this.examineVectorLinesFunction=void 0,this._metadataExtension=void 0,this._customShader=e.customShader;let n=x(e.featureIdLabel,"featureId_0");typeof n=="number"&&(n=`featureId_${n}`),this._featureIdLabel=n;let i=x(e.instanceFeatureIdLabel,"instanceFeatureId_0");typeof i=="number"&&(i=`instanceFeatureId_${i}`),this._instanceFeatureIdLabel=i}Object.defineProperties(er.prototype,{isCesium3DTileset:{get:function(){return!0}},asset:{get:function(){return this._asset}},extensions:{get:function(){return this._extensions}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){As.setOwner(e,this,"_clippingPlanes")}},clippingPolygons:{get:function(){return this._clippingPolygons},set:function(e){Yh.setOwner(e,this,"_clippingPolygons")}},properties:{get:function(){return this._properties}},tilesLoaded:{get:function(){return this._tilesLoaded}},resource:{get:function(){return this._resource}},basePath:{get:function(){return ys("Cesium3DTileset.basePath","Cesium3DTileset.basePath has been deprecated. All tiles are relative to the url of the tileset JSON file that contains them. Use the url property instead."),this._basePath}},style:{get:function(){return this._styleEngine.style},set:function(e){this._styleEngine.style=e}},customShader:{get:function(){return this._customShader},set:function(e){this._customShader=e}},hasMixedContent:{get:function(){return this._hasMixedContent},set:function(e){this._hasMixedContent=e}},isSkippingLevelOfDetail:{get:function(){return this.skipLevelOfDetail&&!u(this._classificationType)&&!this._disableSkipLevelOfDetail&&!this._allTilesAdditive}},metadataExtension:{get:function(){return this._metadataExtension}},metadata:{get:function(){if(u(this._metadataExtension))return this._metadataExtension.tileset}},schema:{get:function(){if(u(this._metadataExtension))return this._metadataExtension.schema}},maximumScreenSpaceError:{get:function(){return this._maximumScreenSpaceError},set:function(e){this._maximumScreenSpaceError=e,this._memoryAdjustedScreenSpaceError=e}},cacheBytes:{get:function(){return this._cacheBytes},set:function(e){this._cacheBytes=e}},maximumCacheOverflowBytes:{get:function(){return this._maximumCacheOverflowBytes},set:function(e){this._maximumCacheOverflowBytes=e}},memoryAdjustedScreenSpaceError:{get:function(){return this._memoryAdjustedScreenSpaceError}},pointCloudShading:{get:function(){return this._pointCloudShading},set:function(e){this._pointCloudShading=e}},root:{get:function(){return this._root}},boundingSphere:{get:function(){return this._root.updateTransform(this._modelMatrix),this._root.boundingSphere}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix=F.clone(e,this._modelMatrix)}},timeSinceLoad:{get:function(){return this._timeSinceLoad}},totalMemoryUsageInBytes:{get:function(){let e=this._statistics;return e.texturesByteLength+e.geometryByteLength+e.batchTableByteLength}},clippingPlanesOriginMatrix:{get:function(){return u(this._clippingPlanesOriginMatrix)?(this._clippingPlanesOriginMatrixDirty&&(F.multiply(this.root.computedTransform,this._initialClippingPlanesOriginMatrix,this._clippingPlanesOriginMatrix),this._clippingPlanesOriginMatrixDirty=!1),this._clippingPlanesOriginMatrix):F.IDENTITY}},styleEngine:{get:function(){return this._styleEngine}},statistics:{get:function(){return this._statistics}},classificationType:{get:function(){return this._classificationType}},ellipsoid:{get:function(){return this._ellipsoid}},foveatedConeSize:{get:function(){return this._foveatedConeSize},set:function(e){this._foveatedConeSize=e}},foveatedMinimumScreenSpaceErrorRelaxation:{get:function(){return this._foveatedMinimumScreenSpaceErrorRelaxation},set:function(e){this._foveatedMinimumScreenSpaceErrorRelaxation=e}},extras:{get:function(){return this._extras}},imageBasedLighting:{get:function(){return this._imageBasedLighting},set:function(e){e!==this._imageBasedLighting&&(this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=e,this._shouldDestroyImageBasedLighting=!1)}},environmentMapManager:{get:function(){return this._environmentMapManager}},vectorClassificationOnly:{get:function(){return this._vectorClassificationOnly}},vectorKeepDecodedPositions:{get:function(){return this._vectorKeepDecodedPositions}},showCreditsOnScreen:{get:function(){return this._showCreditsOnScreen},set:function(e){this._showCreditsOnScreen=e,zue(this)}},featureIdLabel:{get:function(){return this._featureIdLabel},set:function(e){typeof e=="number"&&(e=`featureId_${e}`),this._featureIdLabel=e}},instanceFeatureIdLabel:{get:function(){return this._instanceFeatureIdLabel},set:function(e){typeof e=="number"&&(e=`instanceFeatureId_${e}`),this._instanceFeatureIdLabel=e}}});er.fromIonAssetId=async function(e,t){let n=await cf.fromAssetId(e);return er.fromUrl(n,t)};er.fromUrl=async function(e,t){t=x(t,x.EMPTY_OBJECT);let n=De.createIfNeeded(e),i;n.extension==="json"?i=n.getBaseUri(!0):n.isDataUri&&(i="");let o=await er.loadJson(n),r=await nKe(n,o),s=new er(t);s._resource=n,s._url=n.url,s._basePath=i,s._metadataExtension=r,s._geometricError=o.geometricError,s._scaledGeometricError=o.geometricError;let a=o.asset;s._asset=a,s._extras=o.extras,zue(s);let c=u(o.asset.gltfUpAxis)?Vo.fromName(o.asset.gltfUpAxis):Vo.Y,l=x(t.modelUpAxis,c),f=x(t.modelForwardAxis,Vo.X);s._properties=o.properties,s._extensionsUsed=o.extensionsUsed,s._extensions=o.extensions,s._modelUpAxis=l,s._modelForwardAxis=f,s._root=s.loadTileset(n,o);let p=s._root.createBoundingVolume(o.root.boundingVolume,F.IDENTITY).boundingSphere.center,g=s._ellipsoid.cartesianToCartographic(p);return u(g)&&g.height>di._defaultMinTerrainHeight&&(s._initialClippingPlanesOriginMatrix=Lt.eastNorthUpToFixedFrame(p)),s._clippingPlanesOriginMatrix=F.clone(s._initialClippingPlanesOriginMatrix),s};er.loadJson=function(e){return De.createIfNeeded(e).fetchJson()};er.prototype.makeStyleDirty=function(){this._styleEngine.makeDirty()};er.prototype.loadTileset=function(e,t,n){let i=t.asset;if(!u(i))throw new ce("Tileset must have an asset property.");if(i.version!=="0.0"&&i.version!=="1.0"&&i.version!=="1.1")throw new ce("The tileset must be 3D Tiles version 0.0, 1.0, or 1.1");u(t.extensionsRequired)&&er.checkSupportedExtensions(t.extensionsRequired);let o=this._statistics,r=i.tilesetVersion;u(r)&&(this._basePath+=`?v=${r}`,e=e.clone(),e.setQueryParameters({v:r}));let s=Lue(this,e,t.root,n);u(n)&&(n.children.push(s),s._depth=n._depth+1);let a=[];for(a.push(s);a.length>0;){let c=a.pop();++o.numberOfTilesTotal,this._allTilesAdditive=this._allTilesAdditive&&c.refine===Zo.ADD;let l=c._header.children;if(u(l))for(let f=0;f<l.length;++f){let d=l[f],p=Lue(this,e,d,c);c.children.push(p),p._depth=c._depth+1,a.push(p)}this._cullWithChildrenBounds&&S3.checkChildrenWithinParent(c)}return s};function Lue(e,t,n,i){if(!(u(n.implicitTiling)||si(n,"3DTILES_implicit_tiling")))return new Od(e,t,n,i);let r=e.schema,s=new fT(t,n,r),a=new dT({subdivisionScheme:s.subdivisionScheme,subtreeLevels:s.subtreeLevels,level:0,x:0,y:0,z:0}),c=s.subtreeUriTemplate.getDerivedResource({templateValues:a.getTemplateValues()}).url,f=Ge(n,!0);f.contents=[{uri:c}],delete f.content,delete f.extensions;let d=new Od(e,t,f,i);return d.implicitTileset=s,d.implicitCoordinates=a,d}async function nKe(e,t){let n=si(t,"3DTILES_metadata")?t.extensions["3DTILES_metadata"]:t,i;if(u(n.schemaUri))e=e.getDerivedResource({url:n.schemaUri}),i=wi.getSchemaLoader({resource:e});else if(u(n.schema))i=wi.getSchemaLoader({schema:n.schema});else return;await i.load();let o=new lT({schema:i.schema,metadataJson:n});return wi.unload(i),o}var Nue=new h,iKe=new de,oKe=new F,rKe=new h,sKe=new h,aKe=new h,cKe=new h;function lKe(e,t){let n,i,o,r,s,a=t.camera,c=e._root,l=c.contentBoundingVolume;if(l instanceof Pd)n=h.normalize(a.positionWC,Nue),i=a.directionWC,o=a.positionCartographic.height,r=l.minimumHeight,s=l.maximumHeight;else{let y=F.inverseTransformation(c.computedTransform,oKe),b=t.mapProjection.ellipsoid,C=l.boundingVolume,A=F.multiplyByPoint(y,C.center,rKe);if(h.magnitude(A)>b.minimumRadius){let T=de.fromCartesian(A,b,iKe);n=h.normalize(a.positionWC,Nue),i=a.directionWC,o=a.positionCartographic.height,r=0,s=T.height*2}else{let T=F.multiplyByPoint(y,a.positionWC,sKe);if(n=h.UNIT_Z,i=F.multiplyByPointAsVector(y,a.directionWC,aKe),i=h.normalize(i,i),o=T.z,l instanceof If){let E=J.getColumn(C.halfAxes,2,cKe),v=h.magnitude(E);r=A.z-v,s=A.z+v}else if(l instanceof qg){let E=C.radius;r=A.z-E,s=A.z+E}}}let f=e.dynamicScreenSpaceErrorHeightFalloff,d=r+(s-r)*f,p=s,g=R.clamp((o-d)/(p-d),0,1),m=1-Math.abs(h.dot(i,n));m=m*(1-g),e._dynamicScreenSpaceErrorComputedDensity=e.dynamicScreenSpaceErrorDensity*m}function uKe(e,t){if(t.hasEmptyContent)return;let{statistics:n}=e,i=t.contentExpired,o=t.requestContent();u(o)&&(o.then(r=>{!u(r)||t.isDestroyed()||e.isDestroyed()||(e._processingQueue.push(t),++n.numberOfTilesProcessing)}).catch(r=>{kue(r,e,t)}),i&&(t.hasTilesetContent||t.hasImplicitContent?EKe(e,t):(n.decrementLoadCounts(t.content),--n.numberOfTilesWithContentReady)),e._requestedTilesInFlight.push(t))}function Bue(e,t){return e._priority-t._priority}er.prototype.postPassesUpdate=function(e){u(this._root)&&(fKe(this,e),vKe(this,e),this._cache.unloadTiles(this,Uue),this._styleApplied&&this._styleEngine.resetDirty(),this._styleApplied=!1)};er.prototype.prePassesUpdate=function(e){if(!u(this._root))return;yKe(this,e);let t=this._clippingPlanes;this._clippingPlanesOriginMatrixDirty=!0,u(t)&&t.enabled&&t.update(e);let n=this._clippingPolygons;u(n)&&n.enabled&&n.update(e),u(this._loadTimestamp)||(this._loadTimestamp=$.clone(e.time)),this._timeSinceLoad=Math.max($.secondsDifference(e.time,this._loadTimestamp)*1e3,0),this.dynamicScreenSpaceError&&lKe(this,e),e.newFrame&&this._cache.reset()};function fKe(e,t){let n=e._requestedTilesInFlight,i=0;for(let o=0;o<n.length;++o){let r=n[o],s=t.frameNumber-r._touchedFrame>=1;if(r._contentState!==Qo.LOADING){++i;continue}else if(s){r.cancelRequests(),++i;continue}i>0&&(n[o-i]=r)}n.length-=i}function dKe(e){let t=e._requestedTiles;t.sort(Bue);for(let n=0;n<t.length;++n)uKe(e,t[n])}function kue(e,t,n){if(t.isDestroyed())return;let i;n.isDestroyed()||(i=n._contentResource.url);let o=u(e.message)?e.message:e.toString();t.tileFailed.numberOfListeners>0?t.tileFailed.raiseEvent({url:i,message:o}):(console.log(`A 3D tile failed to load: ${i}`),console.log(`Error: ${o}`),console.log(e.stack))}function hKe(e){let t=e._processingQueue,n=0;for(let i=0;i<t.length;++i){let o=t[i];if(o.isDestroyed()||o._contentState!==Qo.PROCESSING){++n;continue}n>0&&(t[i-n]=o)}t.length-=n}var mKe=new de,pKe=new de,_Ke=new h;function gKe(e,t,n){if(!e.enableCollision||!e.show)return;let i=e._addHeightCallbacks,o=t.boundingSphere;for(let r of i){if(r.invoked||t._wasSelectedLastFrame)continue;let s=r.ellipsoid,a=de.clone(r.positionCartographic,mKe),c=de.fromCartesian(o.center,s,pKe);u(c)&&(a.height=c.height);let l=de.toCartesian(a,s,_Ke);h.distance(l,o.center)<=o.radius&&n.afterRender.push(()=>{u(r.callback)&&r.callback(a),r.invoked=!1})}}function yKe(e,t){hKe(e);let n=e._processingQueue,{cacheBytes:i,maximumCacheOverflowBytes:o,statistics:r}=e,s=i+o,a=!1;for(let c=0;c<n.length;++c){if(e.totalMemoryUsageInBytes>s){a=!0;break}let l=n[c];try{l.process(e,t),l.contentReady&&(--r.numberOfTilesProcessing,e.tileLoad.raiseEvent(l))}catch(f){--r.numberOfTilesProcessing,kue(f,e,l)}}e.totalMemoryUsageInBytes<i?bKe(e):a&&n.length>0&&xKe(e)}function xKe(e){e._memoryAdjustedScreenSpaceError*=1.02;let t=e._processingQueue;for(let n=0;n<t.length;++n)t[n].updatePriority();t.sort(Bue)}function bKe(e){e._memoryAdjustedScreenSpaceError=Math.max(e.memoryAdjustedScreenSpaceError/1.02,e.maximumScreenSpaceError)}var F3=new h,CKe={maximumFractionDigits:3};function Fue(e){let t=e/1048576;return t<1?t.toLocaleString(void 0,CKe):Math.round(t).toLocaleString()}function ij(e){let{halfAxes:t,radius:n,center:i}=e.boundingVolume.boundingVolume,o=h.clone(i,F3);if(u(t))o.x+=.75*(t[0]+t[3]+t[6]),o.y+=.75*(t[1]+t[4]+t[7]),o.z+=.75*(t[2]+t[5]+t[8]);else if(u(n)){let r=h.normalize(i,F3);r=h.multiplyByScalar(r,.75*n,F3),o=h.add(r,i,F3)}return o}function oj(e,t,n){let i="",o=0;if(t.debugShowGeometricError&&(i+=`
Geometric error: ${e.geometricError}`,o++),t.debugShowRenderingStatistics&&(i+=`
Commands: ${e.commandsLength}`,o++,e.content.pointsLength>0&&(i+=`
Points: ${e.content.pointsLength}`,o++),e.content.trianglesLength>0&&(i+=`
Triangles: ${e.content.trianglesLength}`,o++),i+=`
Features: ${e.content.featuresLength}`,o++),t.debugShowMemoryUsage&&(i+=`
Texture Memory: ${Fue(e.content.texturesByteLength)}`,i+=`
Geometry Memory: ${Fue(e.content.geometryByteLength)}`,o+=2),t.debugShowUrl)if(e.hasMultipleContents){i+=`
Urls:`;let s=e.content.innerContentUrls;for(let a=0;a<s.length;a++)i+=`
- ${s[a]}`;o+=s.length}else i+=`
Url: ${e._contentHeader.uri}`,o++;let r={text:i.substring(1),position:n,font:`${19-o}px sans-serif`,showBackground:!0,disableDepthTestDistance:Number.POSITIVE_INFINITY};return t._tileDebugLabels.add(r)}function AKe(e,t){let n=e._selectedTiles,i=n.length,o=e._emptyTiles,r=o.length;if(e._tileDebugLabels.removeAll(),e.debugPickedTileLabelOnly){if(u(e.debugPickedTile)){let s=u(e.debugPickPosition)?e.debugPickPosition:ij(e.debugPickedTile),a=oj(e.debugPickedTile,e,s);a.pixelOffset=new H(15,-15)}}else{for(let s=0;s<i;++s){let a=n[s];oj(a,e,ij(a))}for(let s=0;s<r;++s){let a=o[s];(a.hasTilesetContent||a.hasImplicitContent)&&oj(a,e,ij(a))}}e._tileDebugLabels.update(t)}function TKe(e,t,n){e._styleEngine.applyStyle(e),e._styleApplied=!0;let{commandList:i,context:o}=t,r=i.length,s=e._selectedTiles,a=e.isSkippingLevelOfDetail&&e._hasMixedContent&&o.stencilBuffer&&s.length>0;e._backfaceCommands.length=0,a&&(u(e._stencilClearCommand)||(e._stencilClearCommand=new ni({stencil:0,pass:we.CESIUM_3D_TILE,renderState:Ue.fromCache({stencilMask:Ut.SKIP_LOD_MASK})})),i.push(e._stencilClearCommand));let{statistics:c,tileVisible:l}=e,f=n.isRender,d=i.length;for(let m=0;m<s.length;++m){let y=s[m];f&&l.raiseEvent(y),gKe(e,y,t),y.update(e,t,n),c.incrementSelectionCounts(y.content),++c.selected}let p=e._emptyTiles;for(let m=0;m<p.length;++m)p[m].update(e,t,n);let g=i.length-d;if(e._backfaceCommands.trim(),a){let m=e._backfaceCommands.values,y=m.length;i.length+=y;for(let b=g-1;b>=0;--b)i[d+y+b]=i[d+b];for(let b=0;b<y;++b)i[d+b]=m[b]}g=i.length-r,c.numberOfCommands=g,f&&(e.pointCloudShading.attenuation&&e.pointCloudShading.eyeDomeLighting&&g>0&&e._pointCloudEyeDomeLighting.update(t,r,e.pointCloudShading,e.boundingSphere),e.debugShowGeometricError||e.debugShowRenderingStatistics||e.debugShowMemoryUsage||e.debugShowUrl?(u(e._tileDebugLabels)||(e._tileDebugLabels=new Lp),AKe(e,t)):e._tileDebugLabels=e._tileDebugLabels&&e._tileDebugLabels.destroy())}var Vue=[];function EKe(e,t){let n=t,i=Vue;for(i.push(t);i.length>0;){t=i.pop();let o=t.children;for(let r=0;r<o.length;++r)i.push(o[r]);t!==n&&(SKe(e,t),--e._statistics.numberOfTilesTotal)}n.children=[]}function Uue(e,t){e.tileUnload.raiseEvent(t),e._statistics.decrementLoadCounts(t.content),--e._statistics.numberOfTilesWithContentReady,t.unloadContent()}function SKe(e,t){e._cache.unloadTile(e,t,Uue),t.destroy()}er.prototype.trimLoadedTiles=function(){this._cache.trim()};function vKe(e,t){let n=e._statistics,i=e._statisticsLast,o=n.numberOfPendingRequests,r=n.numberOfTilesProcessing,s=i.numberOfPendingRequests,a=i.numberOfTilesProcessing;Zg.clone(n,i);let c=o!==s||r!==a;c&&t.afterRender.push(function(){return e.loadProgress.raiseEvent(o,r),!0}),e._tilesLoaded=n.numberOfPendingRequests===0&&n.numberOfTilesProcessing===0&&n.numberOfAttemptedRequests===0,c&&e._tilesLoaded&&(t.afterRender.push(function(){return e.allTilesLoaded.raiseEvent(),!0}),e._initialTilesLoaded||(e._initialTilesLoaded=!0,t.afterRender.push(function(){return e.initialTilesLoaded.raiseEvent(),!0})))}function wKe(e){e._heatmap.resetMinimumMaximum(),e._minimumPriority.depth=Number.MAX_VALUE,e._maximumPriority.depth=-Number.MAX_VALUE,e._minimumPriority.foveatedFactor=Number.MAX_VALUE,e._maximumPriority.foveatedFactor=-Number.MAX_VALUE,e._minimumPriority.distance=Number.MAX_VALUE,e._maximumPriority.distance=-Number.MAX_VALUE,e._minimumPriority.reverseScreenSpaceError=Number.MAX_VALUE,e._maximumPriority.reverseScreenSpaceError=-Number.MAX_VALUE}function DKe(e,t){t.frameNumber===e._updatedModelMatrixFrame&&u(e._previousModelMatrix)||(e._updatedModelMatrixFrame=t.frameNumber,e._modelMatrixChanged=!F.equals(e.modelMatrix,e._previousModelMatrix),e._modelMatrixChanged&&(e._previousModelMatrix=F.clone(e.modelMatrix,e._previousModelMatrix)))}function IKe(e,t,n,i){if(t.mode===ne.MORPHING||!u(e._root))return!1;let o=e._statistics;o.clear(),++e._updatedVisibilityFrame,wKe(e),DKe(e,t),e._cullRequestsWhileMoving=e.cullRequestsWhileMoving&&!e._modelMatrixChanged;let r=e.getTraversal(i).selectTiles(e,t);if(i.requestTiles&&dKe(e),TKe(e,t,i),Zg.clone(o,n),i.isRender){let s=e._credits;if(u(s)&&o.selected!==0)for(let a=0;a<s.length;++a){let c=s[a];t.creditDisplay.addCreditToNextFrame(c)}}return r}function zue(e){let t=e._credits;u(t)||(t=[]),t.length=0,u(e.resource.credits)&&e.resource.credits.forEach(i=>{t.push(wt.clone(i))});let n=e.asset.extras;if(u(n)&&u(n.cesium)&&u(n.cesium.credits)){let i=n.cesium.credits;for(let o=0;o<i.length;++o){let r=i[o];t.push(new wt(r.html))}}t.forEach(i=>i.showOnScreen=i.showOnScreen||e._showCreditsOnScreen),e._credits=t}er.prototype.getTraversal=function(e){let{pass:t}=e;return t===Ho.MOST_DETAILED_PRELOAD||t===Ho.MOST_DETAILED_PICK?O3:this.isSkippingLevelOfDetail?N3:M3};er.prototype.update=function(e){this.updateForPass(e,e.tilesetPassState)};er.prototype.updateForPass=function(e,t){let n=t.pass;if(n===Ho.PRELOAD&&(!this.preloadWhenHidden||this.show)||n===Ho.PRELOAD_FLIGHT&&(!this.preloadFlightDestinations||!this.show&&!this.preloadWhenHidden)||n===Ho.REQUEST_RENDER_MODE_DEFER_CHECK&&(!this._cullRequestsWhileMoving&&this.foveatedTimeDelay<=0||!this.show))return;let i=e.commandList,o=e.camera,r=e.cullingVolume;t.ready=!1;let s=Ho.getPassOptions(n),a=s.ignoreCommands,c=x(t.commandList,i),l=c.length;if(e.commandList=c,e.camera=x(t.camera,o),e.cullingVolume=x(t.cullingVolume,r),s.isRender){let p=this._environmentMapManager;u(this._root)&&(p.position=this.boundingSphere.center),p.update(e)}let f=this._clippingPolygons;u(f)&&f.enabled&&f.queueCommands(e);let d=this._statisticsPerPass[n];(this.show||a)&&(this._pass=n,t.ready=IKe(this,e,d,s)),a&&(c.length=l),e.commandList=i,e.camera=o,e.cullingVolume=r};er.prototype.hasExtension=function(e){return u(this._extensionsUsed)?this._extensionsUsed.indexOf(e)>-1:!1};er.prototype.isDestroyed=function(){return!1};er.prototype.destroy=function(){if(this._tileDebugLabels=this._tileDebugLabels&&this._tileDebugLabels.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),this._clippingPolygons=this._clippingPolygons&&this._clippingPolygons.destroy(),u(this._root)){let e=Vue;for(e.push(this._root);e.length>0;){let t=e.pop();t.destroy();let n=t.children;for(let i=0;i<n.length;++i)e.push(n[i])}}return this._root=void 0,this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=void 0,this._environmentMapManager.isDestroyed()||this._environmentMapManager.destroy(),this._environmentMapManager=void 0,ue(this)};er.supportedExtensions={"3DTILES_metadata":!0,"3DTILES_implicit_tiling":!0,"3DTILES_content_gltf":!0,"3DTILES_multiple_contents":!0,"3DTILES_bounding_volume_S2":!0,"3DTILES_batch_table_hierarchy":!0,"3DTILES_draco_point_compression":!0,MAXAR_content_geojson:!0};er.checkSupportedExtensions=function(e){for(let t=0;t<e.length;t++)if(!er.supportedExtensions[e[t]])throw new ce(`Unsupported 3D Tiles Extension: ${e[t]}`)};var PKe=new _n,RKe=new h,OKe=new de;er.prototype.getHeight=function(e,t){let n=t.ellipsoid;u(n)||(n=ee.WGS84);let i=PKe,o=n.cartographicToCartesian(e,i.direction);h.normalize(i.direction,i.direction),i.direction=h.normalize(o,i.direction),i.direction=h.negate(o,i.direction),i.origin=h.multiplyByScalar(i.direction,-2*n.maximumRadius,i.origin);let r=this.pick(i,t.frameState,RKe);if(u(r))return n.cartesianToCartographic(r,OKe)?.height};er.prototype.updateHeight=function(e,t,n){n=x(n,ee.WGS84);let i={positionCartographic:e,ellipsoid:n,callback:t,invoked:!1},o=()=>{let r=this._addHeightCallbacks,s=r.length;for(let a=0;a<s;++a)if(r[a]===i){r.splice(a,1);break}i.callback&&(i.callback=void 0)};return this._addHeightCallbacks.push(i),o};var MKe=new qa,LKe=new h;er.prototype.pick=function(e,t,n){if(!t.context.webgl2&&!this._enablePick)return;let i=this._selectedTiles,o=i.length,r=[];for(let c=0;c<o;++c){let l=i[c],f=Qn.raySphere(e,l.contentBoundingVolume.boundingSphere,MKe);!u(f)||!u(l.content)||r.push(l)}let s=r.length;r.sort((c,l)=>{let f=ae.distanceSquaredTo(c.contentBoundingVolume.boundingSphere,e.origin),d=ae.distanceSquaredTo(l.contentBoundingVolume.boundingSphere,e.origin);return f-d});let a;for(let c=0;c<s;++c){let f=r[c].content.pick(e,t,LKe);if(u(f))return a=h.clone(f,n),a}};var Ia=er;var NKe=new F;function $g(e,t){t.collectionChanged.addEventListener($g.prototype._onCollectionChanged,this),this._scene=e,this._primitives=e.primitives,this._entityCollection=t,this._tilesetHash={},this._entitiesToVisualize=new St,this._onCollectionChanged(t,t.values,[],[])}$g.prototype.update=function(e){let t=this._entitiesToVisualize.values,n=this._tilesetHash,i=this._primitives;for(let o=0,r=t.length;o<r;o++){let s=t[o],a=s._tileset,c,l=n[s.id],f=s.isShowing&&s.isAvailable(e)&&Y.getValueOrDefault(a._show,e,!0),d;f&&(d=s.computeModelMatrix(e,NKe),c=De.createIfNeeded(Y.getValueOrUndefined(a._uri,e)));let p=u(l)?l.tilesetPrimitive:void 0;if(!f){u(p)&&(p.show=!1);continue}(!u(l)||c.url!==l.url)&&(u(p)&&i.removeAndDestroy(p),delete n[s.id],FKe(c,n,s,i)),u(p)&&(p.show=!0,u(d)&&(p.modelMatrix=d),p.maximumScreenSpaceError=Y.getValueOrDefault(a.maximumScreenSpaceError,e,p.maximumScreenSpaceError))}return!0};$g.prototype.isDestroyed=function(){return!1};$g.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener($g.prototype._onCollectionChanged,this);let e=this._entitiesToVisualize.values,t=this._tilesetHash,n=this._primitives;for(let i=e.length-1;i>-1;i--)rj(this,e[i],t,n);return ue(this)};$g.prototype.getBoundingSphere=function(e,t){let n=this._tilesetHash[e.id];if(!u(n)||n.loadFail)return dt.FAILED;let i=n.tilesetPrimitive;return u(i)?i.show?(ae.clone(i.boundingSphere,t),dt.DONE):dt.FAILED:dt.PENDING};$g.prototype._onCollectionChanged=function(e,t,n,i){let o,r,s=this._entitiesToVisualize,a=this._tilesetHash,c=this._primitives;for(o=t.length-1;o>-1;o--)r=t[o],u(r._tileset)&&s.set(r.id,r);for(o=i.length-1;o>-1;o--)r=i[o],u(r._tileset)?s.set(r.id,r):(rj(this,r,a,c),s.remove(r.id));for(o=n.length-1;o>-1;o--)r=n[o],rj(this,r,a,c),s.remove(r.id)};function rj(e,t,n,i){let o=n[t.id];u(o)&&(u(o.tilesetPrimitive)&&i.removeAndDestroy(o.tilesetPrimitive),delete n[t.id])}async function FKe(e,t,n,i){t[n.id]={url:e.url,loadFail:!1};try{let o=await Ia.fromUrl(e);if(o.id=n,i.add(o),!u(t[n.id]))return;t[n.id].tilesetPrimitive=o}catch(o){console.error(o),t[n.id].loadFail=!0}}var B3=$g;var BKe=G.WHITE,kKe=G.BLACK,VKe=new H(2,2);function hT(e){e=x(e,x.EMPTY_OBJECT),this._definitionChanged=new me,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.evenColor=e.evenColor,this.oddColor=e.oddColor,this.repeat=e.repeat}Object.defineProperties(hT.prototype,{isConstant:{get:function(){return Y.isConstant(this._evenColor)&&Y.isConstant(this._oddColor)&&Y.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},evenColor:le("evenColor"),oddColor:le("oddColor"),repeat:le("repeat")});hT.prototype.getType=function(e){return"Checkerboard"};var UKe=new $;hT.prototype.getValue=function(e,t){return u(e)||(e=$.now(UKe)),u(t)||(t={}),t.lightColor=Y.getValueOrClonedDefault(this._evenColor,e,BKe,t.lightColor),t.darkColor=Y.getValueOrClonedDefault(this._oddColor,e,kKe,t.darkColor),t.repeat=Y.getValueOrDefault(this._repeat,e,VKe),t};hT.prototype.equals=function(e){return this===e||e instanceof hT&&Y.equals(this._evenColor,e._evenColor)&&Y.equals(this._oddColor,e._oddColor)&&Y.equals(this._repeat,e._repeat)};var o1=hT;var Hue={id:void 0};function r1(e){if(e._firing){e._refire=!0;return}if(e._suspendCount===0){let t=e._addedEntities,n=e._removedEntities,i=e._changedEntities;if(i.length!==0||t.length!==0||n.length!==0){e._firing=!0;do{e._refire=!1;let o=t.values.slice(0),r=n.values.slice(0),s=i.values.slice(0);t.removeAll(),n.removeAll(),i.removeAll(),e._collectionChanged.raiseEvent(e,o,r,s)}while(e._refire);e._firing=!1}}}function ic(e){this._owner=e,this._entities=new St,this._addedEntities=new St,this._removedEntities=new St,this._changedEntities=new St,this._suspendCount=0,this._collectionChanged=new me,this._id=Hn(),this._show=!0,this._firing=!1,this._refire=!1}ic.prototype.suspendEvents=function(){this._suspendCount++};ic.prototype.resumeEvents=function(){this._suspendCount--,r1(this)};Object.defineProperties(ic.prototype,{collectionChanged:{get:function(){return this._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._entities.values}},show:{get:function(){return this._show},set:function(e){if(e===this._show)return;this.suspendEvents();let t,n=[],i=this._entities.values,o=i.length;for(t=0;t<o;t++)n.push(i[t].isShowing);for(this._show=e,t=0;t<o;t++){let r=n[t],s=i[t];r!==s.isShowing&&s.definitionChanged.raiseEvent(s,"isShowing",s.isShowing,r)}this.resumeEvents()}},owner:{get:function(){return this._owner}}});ic.prototype.computeAvailability=function(){let e=He.MAXIMUM_VALUE,t=He.MINIMUM_VALUE,n=this._entities.values;for(let i=0,o=n.length;i<o;i++){let s=n[i].availability;if(u(s)){let a=s.start,c=s.stop;$.lessThan(a,e)&&!a.equals(He.MINIMUM_VALUE)&&(e=a),$.greaterThan(c,t)&&!c.equals(He.MAXIMUM_VALUE)&&(t=c)}}return He.MAXIMUM_VALUE.equals(e)&&(e=He.MINIMUM_VALUE),He.MINIMUM_VALUE.equals(t)&&(t=He.MAXIMUM_VALUE),new Sn({start:e,stop:t})};ic.prototype.add=function(e){e instanceof ar||(e=new ar(e));let t=e.id,n=this._entities;if(n.contains(t))throw new he(`An entity with id ${t} already exists in this collection.`);return e.entityCollection=this,n.set(t,e),this._removedEntities.remove(t)||this._addedEntities.set(t,e),e.definitionChanged.addEventListener(ic.prototype._onEntityDefinitionChanged,this),r1(this),e};ic.prototype.remove=function(e){return u(e)?this.removeById(e.id):!1};ic.prototype.contains=function(e){return this._entities.get(e.id)===e};ic.prototype.removeById=function(e){if(!u(e))return!1;let n=this._entities.get(e);return this._entities.remove(e)?(this._addedEntities.remove(e)||(this._removedEntities.set(e,n),this._changedEntities.remove(e)),this._entities.remove(e),n.definitionChanged.removeEventListener(ic.prototype._onEntityDefinitionChanged,this),r1(this),!0):!1};ic.prototype.removeAll=function(){let e=this._entities,t=e.length,n=e.values,i=this._addedEntities,o=this._removedEntities;for(let r=0;r<t;r++){let s=n[r],a=s.id,c=i.get(a);u(c)||(s.definitionChanged.removeEventListener(ic.prototype._onEntityDefinitionChanged,this),o.set(a,s))}e.removeAll(),i.removeAll(),this._changedEntities.removeAll(),r1(this)};ic.prototype.getById=function(e){return this._entities.get(e)};ic.prototype.getOrCreateEntity=function(e){let t=this._entities.get(e);return u(t)||(Hue.id=e,t=new ar(Hue),this.add(t)),t};ic.prototype._onEntityDefinitionChanged=function(e){let t=e.id;this._addedEntities.contains(t)||this._changedEntities.set(t,e),r1(this)};var la=ic;var k3={id:void 0},mT=new Array(2);function sj(e){let t=e.propertyNames,n=t.length;for(let i=0;i<n;i++)e[t[i]]=void 0;e._name=void 0,e._availability=void 0}function Gue(e,t,n,i){mT[0]=n,mT[1]=i.id,t[JSON.stringify(mT)]=i.definitionChanged.addEventListener(Vr.prototype._onDefinitionChanged,e)}function Wue(e,t,n,i){mT[0]=n,mT[1]=i.id;let o=JSON.stringify(mT);t[o](),t[o]=void 0}function Qg(e){if(e._shouldRecomposite=!0,e._suspendCount!==0)return;let t=e._collections,n=t.length,i=e._collectionsCopy,o=i.length,r,s,a,c,l,f=e._composite,d=new la(e),p=e._eventHash,g;for(r=0;r<o;r++)for(l=i[r],l.collectionChanged.removeEventListener(Vr.prototype._onCollectionChanged,e),a=l.values,g=l.id,c=a.length-1;c>-1;c--)s=a[c],Wue(e,p,g,s);for(r=n-1;r>=0;r--)for(l=t[r],l.collectionChanged.addEventListener(Vr.prototype._onCollectionChanged,e),a=l.values,g=l.id,c=a.length-1;c>-1;c--){s=a[c],Gue(e,p,g,s);let y=d.getById(s.id);u(y)||(y=f.getById(s.id),u(y)?sj(y):(k3.id=s.id,y=new ar(k3)),d.add(y)),y.merge(s)}e._collectionsCopy=t.slice(0),f.suspendEvents(),f.removeAll();let m=d.values;for(r=0;r<m.length;r++)f.add(m[r]);f.resumeEvents()}function Vr(e,t){this._owner=t,this._composite=new la(this),this._suspendCount=0,this._collections=u(e)?e.slice():[],this._collectionsCopy=[],this._id=Hn(),this._eventHash={},Qg(this),this._shouldRecomposite=!1}Object.defineProperties(Vr.prototype,{collectionChanged:{get:function(){return this._composite._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._composite.values}},owner:{get:function(){return this._owner}}});Vr.prototype.addCollection=function(e,t){u(t)?this._collections.splice(t,0,e):(t=this._collections.length,this._collections.push(e)),Qg(this)};Vr.prototype.removeCollection=function(e){let t=this._collections.indexOf(e);return t!==-1?(this._collections.splice(t,1),Qg(this),!0):!1};Vr.prototype.removeAllCollections=function(){this._collections.length=0,Qg(this)};Vr.prototype.containsCollection=function(e){return this._collections.indexOf(e)!==-1};Vr.prototype.contains=function(e){return this._composite.contains(e)};Vr.prototype.indexOfCollection=function(e){return this._collections.indexOf(e)};Vr.prototype.getCollection=function(e){return this._collections[e]};Vr.prototype.getCollectionsLength=function(){return this._collections.length};function V3(e,t){return e.indexOf(t)}function jue(e,t,n){let i=e._collections;if(t=R.clamp(t,0,i.length-1),n=R.clamp(n,0,i.length-1),t===n)return;let o=i[t];i[t]=i[n],i[n]=o,Qg(e)}Vr.prototype.raiseCollection=function(e){let t=V3(this._collections,e);jue(this,t,t+1)};Vr.prototype.lowerCollection=function(e){let t=V3(this._collections,e);jue(this,t,t-1)};Vr.prototype.raiseCollectionToTop=function(e){let t=V3(this._collections,e);t!==this._collections.length-1&&(this._collections.splice(t,1),this._collections.push(e),Qg(this))};Vr.prototype.lowerCollectionToBottom=function(e){let t=V3(this._collections,e);t!==0&&(this._collections.splice(t,1),this._collections.splice(0,0,e),Qg(this))};Vr.prototype.suspendEvents=function(){this._suspendCount++,this._composite.suspendEvents()};Vr.prototype.resumeEvents=function(){this._suspendCount--,this._shouldRecomposite&&this._suspendCount===0&&(Qg(this),this._shouldRecomposite=!1),this._composite.resumeEvents()};Vr.prototype.computeAvailability=function(){return this._composite.computeAvailability()};Vr.prototype.getById=function(e){return this._composite.getById(e)};Vr.prototype._onCollectionChanged=function(e,t,n){let i=this._collectionsCopy,o=i.length,r=this._composite;r.suspendEvents();let s,a,c,l,f=n.length,d=this._eventHash,p=e.id;for(s=0;s<f;s++){let m=n[s];Wue(this,d,p,m);let y=m.id;for(a=o-1;a>=0;a--)c=i[a].getById(y),u(c)&&(u(l)||(l=r.getById(y),sj(l)),l.merge(c));u(l)||r.removeById(y),l=void 0}let g=t.length;for(s=0;s<g;s++){let m=t[s];Gue(this,d,p,m);let y=m.id;for(a=o-1;a>=0;a--)c=i[a].getById(y),u(c)&&(u(l)||(l=r.getById(y),u(l)?sj(l):(k3.id=y,l=new ar(k3),r.add(l))),l.merge(c));l=void 0}r.resumeEvents()};Vr.prototype._onDefinitionChanged=function(e,t,n,i){let o=this._collections,r=this._composite,s=o.length,a=e.id,c=r.getById(a),l=c[t],f=!u(l),d=!0;for(let p=s-1;p>=0;p--){let g=o[p].getById(e.id);if(u(g)){let m=g[t];if(u(m)){if(d)if(d=!1,u(m.merge)&&u(m.clone))l=m.clone(l);else{l=m;break}l.merge(m)}}}f&&c.propertyNames.indexOf(t)===-1&&c.addProperty(t),c[t]=l};var que=Vr;function aj(){this._removalFunctions=[]}aj.prototype.add=function(e,t,n){let i=e.addEventListener(t,n);this._removalFunctions.push(i);let o=this;return function(){i();let r=o._removalFunctions;r.splice(r.indexOf(i),1)}};aj.prototype.removeAll=function(){let e=this._removalFunctions;for(let t=0,n=e.length;t<n;++t)e[t]();e.length=0};var Ar=aj;function uj(e,t){return $.compare(e.start,t.start)}function Ur(e){if(this._intervals=[],this._changedEvent=new me,u(e)){let t=e.length;for(let n=0;n<t;n++)this.addInterval(e[n])}}Object.defineProperties(Ur.prototype,{changedEvent:{get:function(){return this._changedEvent}},start:{get:function(){let e=this._intervals;return e.length===0?void 0:e[0].start}},isStartIncluded:{get:function(){let e=this._intervals;return e.length===0?!1:e[0].isStartIncluded}},stop:{get:function(){let e=this._intervals,t=e.length;return t===0?void 0:e[t-1].stop}},isStopIncluded:{get:function(){let e=this._intervals,t=e.length;return t===0?!1:e[t-1].isStopIncluded}},length:{get:function(){return this._intervals.length}},isEmpty:{get:function(){return this._intervals.length===0}}});Ur.prototype.equals=function(e,t){if(this===e)return!0;if(!(e instanceof Ur))return!1;let n=this._intervals,i=e._intervals,o=n.length;if(o!==i.length)return!1;for(let r=0;r<o;r++)if(!Sn.equals(n[r],i[r],t))return!1;return!0};Ur.prototype.get=function(e){return this._intervals[e]};Ur.prototype.removeAll=function(){this._intervals.length>0&&(this._intervals.length=0,this._changedEvent.raiseEvent(this))};Ur.prototype.findIntervalContainingDate=function(e){let t=this.indexOf(e);return t>=0?this._intervals[t]:void 0};Ur.prototype.findDataForIntervalContainingDate=function(e){let t=this.indexOf(e);return t>=0?this._intervals[t].data:void 0};Ur.prototype.contains=function(e){return this.indexOf(e)>=0};var cj=new Sn;Ur.prototype.indexOf=function(e){let t=this._intervals;cj.start=e,cj.stop=e;let n=No(t,cj,uj);return n>=0?t[n].isStartIncluded?n:n>0&&t[n-1].stop.equals(e)&&t[n-1].isStopIncluded?n-1:~n:(n=~n,n>0&&n-1<t.length&&Sn.contains(t[n-1],e)?n-1:~n)};Ur.prototype.findInterval=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.start,n=e.stop,i=e.isStartIncluded,o=e.isStopIncluded,r=this._intervals;for(let s=0,a=r.length;s<a;s++){let c=r[s];if((!u(t)||c.start.equals(t))&&(!u(n)||c.stop.equals(n))&&(!u(i)||c.isStartIncluded===i)&&(!u(o)||c.isStopIncluded===o))return r[s]}};Ur.prototype.addInterval=function(e,t){if(e.isEmpty)return;let n=this._intervals;if(n.length===0||$.greaterThan(e.start,n[n.length-1].stop)){n.push(e),this._changedEvent.raiseEvent(this);return}let i=No(n,e,uj);i<0?i=~i:i>0&&e.isStartIncluded&&n[i-1].isStartIncluded&&n[i-1].start.equals(e.start)?--i:i<n.length&&!e.isStartIncluded&&n[i].isStartIncluded&&n[i].start.equals(e.start)&&++i;let o;for(i>0&&(o=$.compare(n[i-1].stop,e.start),(o>0||o===0&&(n[i-1].isStopIncluded||e.isStartIncluded))&&((u(t)?t(n[i-1].data,e.data):n[i-1].data===e.data)?($.greaterThan(e.stop,n[i-1].stop)?e=new Sn({start:n[i-1].start,stop:e.stop,isStartIncluded:n[i-1].isStartIncluded,isStopIncluded:e.isStopIncluded,data:e.data}):e=new Sn({start:n[i-1].start,stop:n[i-1].stop,isStartIncluded:n[i-1].isStartIncluded,isStopIncluded:n[i-1].isStopIncluded||e.stop.equals(n[i-1].stop)&&e.isStopIncluded,data:e.data}),n.splice(i-1,1),--i):(o=$.compare(n[i-1].stop,e.stop),(o>0||o===0&&n[i-1].isStopIncluded&&!e.isStopIncluded)&&n.splice(i,0,new Sn({start:e.stop,stop:n[i-1].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:n[i-1].isStopIncluded,data:n[i-1].data})),n[i-1]=new Sn({start:n[i-1].start,stop:e.start,isStartIncluded:n[i-1].isStartIncluded,isStopIncluded:!e.isStartIncluded,data:n[i-1].data}))));i<n.length&&(o=$.compare(e.stop,n[i].start),o>0||o===0&&(e.isStopIncluded||n[i].isStartIncluded));)if(u(t)?t(n[i].data,e.data):n[i].data===e.data)e=new Sn({start:e.start,stop:$.greaterThan(n[i].stop,e.stop)?n[i].stop:e.stop,isStartIncluded:e.isStartIncluded,isStopIncluded:$.greaterThan(n[i].stop,e.stop)?n[i].isStopIncluded:e.isStopIncluded,data:e.data}),n.splice(i,1);else if(n[i]=new Sn({start:e.stop,stop:n[i].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:n[i].isStopIncluded,data:n[i].data}),n[i].isEmpty)n.splice(i,1);else break;n.splice(i,0,e),this._changedEvent.raiseEvent(this)};Ur.prototype.removeInterval=function(e){if(e.isEmpty)return!1;let t=this._intervals,n=No(t,e,uj);n<0&&(n=~n);let i=!1;for(n>0&&($.greaterThan(t[n-1].stop,e.start)||t[n-1].stop.equals(e.start)&&t[n-1].isStopIncluded&&e.isStartIncluded)&&(i=!0,($.greaterThan(t[n-1].stop,e.stop)||t[n-1].isStopIncluded&&!e.isStopIncluded&&t[n-1].stop.equals(e.stop))&&t.splice(n,0,new Sn({start:e.stop,stop:t[n-1].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:t[n-1].isStopIncluded,data:t[n-1].data})),t[n-1]=new Sn({start:t[n-1].start,stop:e.start,isStartIncluded:t[n-1].isStartIncluded,isStopIncluded:!e.isStartIncluded,data:t[n-1].data})),n<t.length&&!e.isStartIncluded&&t[n].isStartIncluded&&e.start.equals(t[n].start)&&(i=!0,t.splice(n,0,new Sn({start:t[n].start,stop:t[n].start,isStartIncluded:!0,isStopIncluded:!0,data:t[n].data})),++n);n<t.length&&$.greaterThan(e.stop,t[n].stop);)i=!0,t.splice(n,1);return n<t.length&&e.stop.equals(t[n].stop)&&(i=!0,!e.isStopIncluded&&t[n].isStopIncluded?n+1<t.length&&t[n+1].start.equals(e.stop)&&t[n].data===t[n+1].data?(t.splice(n,1),t[n]=new Sn({start:t[n].start,stop:t[n].stop,isStartIncluded:!0,isStopIncluded:t[n].isStopIncluded,data:t[n].data})):t[n]=new Sn({start:e.stop,stop:e.stop,isStartIncluded:!0,isStopIncluded:!0,data:t[n].data}):t.splice(n,1)),n<t.length&&($.greaterThan(e.stop,t[n].start)||e.stop.equals(t[n].start)&&e.isStopIncluded&&t[n].isStartIncluded)&&(i=!0,t[n]=new Sn({start:e.stop,stop:t[n].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:t[n].isStopIncluded,data:t[n].data})),i&&this._changedEvent.raiseEvent(this),i};Ur.prototype.intersect=function(e,t,n){let i=new Ur,o=0,r=0,s=this._intervals,a=e._intervals;for(;o<s.length&&r<a.length;){let c=s[o],l=a[r];if($.lessThan(c.stop,l.start))++o;else if($.lessThan(l.stop,c.start))++r;else{if(u(n)||u(t)&&t(c.data,l.data)||!u(t)&&l.data===c.data){let f=Sn.intersect(c,l,new Sn,n);f.isEmpty||i.addInterval(f,t)}$.lessThan(c.stop,l.stop)||c.stop.equals(l.stop)&&!c.isStopIncluded&&l.isStopIncluded?++o:++r}}return i};Ur.fromJulianDateArray=function(e,t){u(t)||(t=new Ur);let n=e.julianDates,i=n.length,o=e.dataCallback,r=x(e.isStartIncluded,!0),s=x(e.isStopIncluded,!0),a=x(e.leadingInterval,!1),c=x(e.trailingInterval,!1),l,f=0;a&&(++f,l=new Sn({start:He.MINIMUM_VALUE,stop:n[0],isStartIncluded:!0,isStopIncluded:!r}),l.data=u(o)?o(l,t.length):t.length,t.addInterval(l));for(let d=0;d<i-1;++d){let p=n[d],g=n[d+1];l=new Sn({start:p,stop:g,isStartIncluded:t.length===f?r:!0,isStopIncluded:d===i-2?s:!1}),l.data=u(o)?o(l,t.length):t.length,t.addInterval(l),p=g}return c&&(l=new Sn({start:n[i-1],stop:He.MAXIMUM_VALUE,isStartIncluded:!s,isStopIncluded:!0}),l.data=u(o)?o(l,t.length):t.length,t.addInterval(l)),t};var oc=new R_,s1=[0,31,28,31,30,31,30,31,31,30,31,30,31];function lj(e,t,n){u(n)||(n=new $),$.toGregorianDate(e,oc);let i=oc.millisecond+t.millisecond,o=oc.second+t.second,r=oc.minute+t.minute,s=oc.hour+t.hour,a=oc.day+t.day,c=oc.month+t.month,l=oc.year+t.year;for(i>=1e3&&(o+=Math.floor(i/1e3),i=i%1e3),o>=60&&(r+=Math.floor(o/60),o=o%60),r>=60&&(s+=Math.floor(r/60),r=r%60),s>=24&&(a+=Math.floor(s/24),s=s%24),s1[2]=gh(l)?29:28;a>s1[c]||c>=13;)a>s1[c]&&(a-=s1[c],++c),c>=13&&(--c,l+=Math.floor(c/12),c=c%12,++c),s1[2]=gh(l)?29:28;return oc.millisecond=i,oc.second=o,oc.minute=r,oc.hour=s,oc.day=a,oc.month=c,oc.year=l,$.fromGregorianDate(oc,n)}var zKe=new $,HKe=/P(?:([\d.,]+)Y)?(?:([\d.,]+)M)?(?:([\d.,]+)W)?(?:([\d.,]+)D)?(?:T(?:([\d.,]+)H)?(?:([\d.,]+)M)?(?:([\d.,]+)S)?)?/;function Yue(e,t){if(!u(e)||e.length===0)return!1;if(t.year=0,t.month=0,t.day=0,t.hour=0,t.minute=0,t.second=0,t.millisecond=0,e[0]==="P"){let n=e.match(HKe);if(!u(n))return!1;if(u(n[1])&&(t.year=Number(n[1].replace(",","."))),u(n[2])&&(t.month=Number(n[2].replace(",","."))),u(n[3])&&(t.day=Number(n[3].replace(",","."))*7),u(n[4])&&(t.day+=Number(n[4].replace(",","."))),u(n[5])&&(t.hour=Number(n[5].replace(",","."))),u(n[6])&&(t.minute=Number(n[6].replace(",","."))),u(n[7])){let i=Number(n[7].replace(",","."));t.second=Math.floor(i),t.millisecond=i%1*1e3}}else e[e.length-1]!=="Z"&&(e+="Z"),$.toGregorianDate($.fromIso8601(e,zKe),t);return t.year||t.month||t.day||t.hour||t.minute||t.second||t.millisecond}var a1=new R_;Ur.fromIso8601=function(e,t){let n=e.iso8601.split("/"),i=$.fromIso8601(n[0]),o=$.fromIso8601(n[1]),r=[];if(!Yue(n[2],a1))r.push(i,o);else{let s=$.clone(i);for(r.push(s);$.compare(s,o)<0;)s=lj(s,a1),$.compare(o,s)<=0&&$.clone(o,s),r.push(s)}return Ur.fromJulianDateArray({julianDates:r,isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)};Ur.fromIso8601DateArray=function(e,t){return Ur.fromJulianDateArray({julianDates:e.iso8601Dates.map(function(n){return $.fromIso8601(n)}),isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)};Ur.fromIso8601DurationArray=function(e,t){let n=e.epoch,i=e.iso8601Durations,o=x(e.relativeToPrevious,!1),r=[],s,a,c=i.length;for(let l=0;l<c;++l)(Yue(i[l],a1)||l===0)&&(o&&u(a)?s=lj(a,a1):s=lj(n,a1),r.push(s),a=s);return Ur.fromJulianDateArray({julianDates:r,isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)};var Xr=Ur;function GKe(e,t,n,i){function o(){n.raiseEvent(e)}let r=[];t.removeAll();let s=i.length;for(let a=0;a<s;a++){let c=i.get(a);u(c.data)&&r.indexOf(c.data)===-1&&t.add(c.data.definitionChanged,o)}}function Fx(){this._eventHelper=new Ar,this._definitionChanged=new me,this._intervals=new Xr,this._intervals.changedEvent.addEventListener(Fx.prototype._intervalsChanged,this)}Object.defineProperties(Fx.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}});var WKe=new $;Fx.prototype.getValue=function(e,t){u(e)||(e=$.now(WKe));let n=this._intervals.findDataForIntervalContainingDate(e);if(u(n))return n.getValue(e,t)};Fx.prototype.equals=function(e){return this===e||e instanceof Fx&&this._intervals.equals(e._intervals,Y.equals)};Fx.prototype._intervalsChanged=function(){GKe(this,this._eventHelper,this._definitionChanged,this._intervals),this._definitionChanged.raiseEvent(this)};var Hc=Fx;function Jg(){this._definitionChanged=new me,this._composite=new Hc,this._composite.definitionChanged.addEventListener(Jg.prototype._raiseDefinitionChanged,this)}Object.defineProperties(Jg.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite._intervals}}});Jg.prototype.getType=function(e){let t=this._composite._intervals.findDataForIntervalContainingDate(e);if(u(t))return t.getType(e)};var jKe=new $;Jg.prototype.getValue=function(e,t){u(e)||(e=$.now(jKe));let n=this._composite._intervals.findDataForIntervalContainingDate(e);if(u(n))return n.getValue(e,t)};Jg.prototype.equals=function(e){return this===e||e instanceof Jg&&this._composite.equals(e._composite,Y.equals)};Jg.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var c1=Jg;function e0(e){this._referenceFrame=x(e,Gi.FIXED),this._definitionChanged=new me,this._composite=new Hc,this._composite.definitionChanged.addEventListener(e0.prototype._raiseDefinitionChanged,this)}Object.defineProperties(e0.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite.intervals}},referenceFrame:{get:function(){return this._referenceFrame},set:function(e){this._referenceFrame=e}}});var qKe=new $;e0.prototype.getValue=function(e,t){return u(e)||(e=$.now(qKe)),this.getValueInReferenceFrame(e,Gi.FIXED,t)};e0.prototype.getValueInReferenceFrame=function(e,t,n){let i=this._composite._intervals.findDataForIntervalContainingDate(e);if(u(i))return i.getValueInReferenceFrame(e,t,n)};e0.prototype.equals=function(e){return this===e||e instanceof e0&&this._referenceFrame===e._referenceFrame&&this._composite.equals(e._composite,Y.equals)};e0.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var Pa=e0;var YKe={ROUNDED:0,MITERED:1,BEVELED:2},ki=Object.freeze(YKe);var ua=[new h,new h],XKe=new h,KKe=new h,ZKe=new h,$Ke=new h,QKe=new h,JKe=new h,eZe=new h,tZe=new h,nZe=new h,pT=new h,U3=new h,l1={},fj=new de;function iZe(e,t){let n=new Array(e.length);for(let i=0;i<e.length;i++){let o=e[i];fj=t.cartesianToCartographic(o,fj),n[i]=fj.height,e[i]=t.scaleToGeodeticSurface(o,o)}return n}function dj(e,t,n,i){let o=e[0],r=e[1],s=h.angleBetween(o,r),a=Math.ceil(s/i),c=new Array(a),l;if(t===n){for(l=0;l<a;l++)c[l]=t;return c.push(n),c}let d=(n-t)/a;for(l=1;l<a;l++){let p=t+l*d;c[l]=p}return c[0]=t,c.push(n),c}var z3=new h,H3=new h;function oZe(e,t,n,i){let o=new os(n,i),r=o.projectPointOntoPlane(h.add(n,e,z3),z3),s=o.projectPointOntoPlane(h.add(n,t,H3),H3),a=H.angleBetween(r,s);return s.x*r.y-s.y*r.x>=0?-a:a}var rZe=new h(-1,0,0),Bx=new F,sZe=new F,hj=new J,aZe=J.IDENTITY.clone(),cZe=new h,lZe=new oe,Xue=new h;function Xp(e,t,n,i,o,r,s,a){let c=cZe,l=lZe;Bx=Lt.eastNorthUpToFixedFrame(e,o,Bx),c=F.multiplyByPointAsVector(Bx,rZe,c),c=h.normalize(c,c);let f=oZe(c,t,e,o);hj=J.fromRotationZ(f,hj),Xue.z=r,Bx=F.multiplyTransformation(Bx,F.fromRotationTranslation(hj,Xue,sZe),Bx);let d=aZe;d[0]=s;for(let p=0;p<a;p++)for(let g=0;g<n.length;g+=3)l=h.fromArray(n,g,l),l=J.multiplyByVector(d,l,l),l=F.multiplyByPoint(Bx,l,l),i.push(l.x,l.y,l.z);return i}var uZe=new h;function mj(e,t,n,i,o,r,s){for(let a=0;a<e.length;a+=3){let c=h.fromArray(e,a,uZe);i=Xp(c,t,n,i,o,r[a/3],s,1)}return i}function fZe(e,t){let n=e.length,i=new Array(n*6),o=0,r=t.x+t.width/2,s=t.y+t.height/2,a=e[0];i[o++]=a.x-r,i[o++]=0,i[o++]=a.y-s;for(let c=1;c<n;c++){a=e[c];let l=a.x-r,f=a.y-s;i[o++]=l,i[o++]=0,i[o++]=f,i[o++]=l,i[o++]=0,i[o++]=f}return a=e[0],i[o++]=a.x-r,i[o++]=0,i[o++]=a.y-s,i}function Kue(e,t){let n=e.length,i=new Array(n*3),o=0,r=t.x+t.width/2,s=t.y+t.height/2;for(let a=0;a<n;a++)i[o++]=e[a].x-r,i[o++]=0,i[o++]=e[a].y-s;return i}var Zue=new Le,$ue=new h,Que=new J;function Jue(e,t,n,i,o,r,s,a,c,l){let f=h.angleBetween(h.subtract(t,e,pT),h.subtract(n,e,U3)),d=i===ki.BEVELED?0:Math.ceil(f/R.toRadians(5)),p;o?p=J.fromQuaternion(Le.fromAxisAngle(h.negate(e,pT),f/(d+1),Zue),Que):p=J.fromQuaternion(Le.fromAxisAngle(e,f/(d+1),Zue),Que);let g,m;if(t=h.clone(t,$ue),d>0){let y=l?2:1;for(let b=0;b<d;b++)t=J.multiplyByVector(p,t,t),g=h.subtract(t,e,pT),g=h.normalize(g,g),o||(g=h.negate(g,g)),m=r.scaleToGeodeticSurface(t,U3),s=Xp(m,g,a,s,r,c,1,y)}else g=h.subtract(t,e,pT),g=h.normalize(g,g),o||(g=h.negate(g,g)),m=r.scaleToGeodeticSurface(t,U3),s=Xp(m,g,a,s,r,c,1,1),n=h.clone(n,$ue),g=h.subtract(n,e,pT),g=h.normalize(g,g),o||(g=h.negate(g,g)),m=r.scaleToGeodeticSurface(n,U3),s=Xp(m,g,a,s,r,c,1,1);return s}l1.removeDuplicatesFromShape=function(e){let t=e.length,n=[];for(let i=t-1,o=0;o<t;i=o++){let r=e[i],s=e[o];H.equals(r,s)||n.push(s)}return n};l1.angleIsGreaterThanPi=function(e,t,n,i){let o=new os(n,i),r=o.projectPointOntoPlane(h.add(n,e,z3),z3),s=o.projectPointOntoPlane(h.add(n,t,H3),H3);return s.x*r.y-s.y*r.x>=0};var dZe=new h,hZe=new h;l1.computePositions=function(e,t,n,i,o){let r=i._ellipsoid,s=iZe(e,r),a=i._granularity,c=i._cornerType,l=o?fZe(t,n):Kue(t,n),f=o?Kue(t,n):void 0,d=n.height/2,p=n.width/2,g=e.length,m=[],y=o?[]:void 0,b=XKe,C=KKe,A=ZKe,T=$Ke,E=QKe,v=JKe,D=eZe,O=tZe,P=nZe,M=e[0],L=e[1];T=r.geodeticSurfaceNormal(M,T),b=h.subtract(L,M,b),b=h.normalize(b,b),O=h.cross(T,b,O),O=h.normalize(O,O);let _=s[0],S=s[1];o&&(y=Xp(M,O,f,y,r,_+d,1,1)),P=h.clone(M,P),M=L,C=h.negate(b,C);let w,I;for(let z=1;z<g-1;z++){let V=o?2:1;if(L=e[z+1],M.equals(L)){At("Positions are too close and are considered equivalent with rounding error.");continue}b=h.subtract(L,M,b),b=h.normalize(b,b),T=r.geodeticSurfaceNormal(M,T);let U=h.multiplyByScalar(T,h.dot(b,T),dZe);h.subtract(b,U,U),h.normalize(U,U);let B=h.multiplyByScalar(T,h.dot(C,T),hZe);if(h.subtract(C,B,B),h.normalize(B,B),!R.equalsEpsilon(Math.abs(h.dot(U,B)),1,R.EPSILON7)){A=h.add(b,C,A),A=h.normalize(A,A),A=h.cross(A,T,A),A=h.cross(T,A,A),A=h.normalize(A,A);let j=1/Math.max(.25,h.magnitude(h.cross(A,C,pT))),Q=l1.angleIsGreaterThanPi(b,C,M,r);Q?(E=h.add(M,h.multiplyByScalar(A,j*p,A),E),v=h.add(E,h.multiplyByScalar(O,p,v),v),ua[0]=h.clone(P,ua[0]),ua[1]=h.clone(v,ua[1]),w=dj(ua,_+d,S+d,a),I=Fi.generateArc({positions:ua,granularity:a,ellipsoid:r}),m=mj(I,O,l,m,r,w,1),O=h.cross(T,b,O),O=h.normalize(O,O),D=h.add(E,h.multiplyByScalar(O,p,D),D),c===ki.ROUNDED||c===ki.BEVELED?Jue(E,v,D,c,Q,r,m,l,S+d,o):(A=h.negate(A,A),m=Xp(M,A,l,m,r,S+d,j,V)),P=h.clone(D,P)):(E=h.add(M,h.multiplyByScalar(A,j*p,A),E),v=h.add(E,h.multiplyByScalar(O,-p,v),v),ua[0]=h.clone(P,ua[0]),ua[1]=h.clone(v,ua[1]),w=dj(ua,_+d,S+d,a),I=Fi.generateArc({positions:ua,granularity:a,ellipsoid:r}),m=mj(I,O,l,m,r,w,1),O=h.cross(T,b,O),O=h.normalize(O,O),D=h.add(E,h.multiplyByScalar(O,-p,D),D),c===ki.ROUNDED||c===ki.BEVELED?Jue(E,v,D,c,Q,r,m,l,S+d,o):m=Xp(M,A,l,m,r,S+d,j,V),P=h.clone(D,P)),C=h.negate(b,C)}else m=Xp(P,O,l,m,r,_+d,1,1),P=M;_=S,S=s[z+1],M=L}ua[0]=h.clone(P,ua[0]),ua[1]=h.clone(M,ua[1]),w=dj(ua,_+d,S+d,a),I=Fi.generateArc({positions:ua,granularity:a,ellipsoid:r}),m=mj(I,O,l,m,r,w,1),o&&(y=Xp(M,O,f,y,r,S+d,1,1)),g=m.length;let N=o?g+y.length:g,k=new Float64Array(N);return k.set(m),o&&k.set(y,g),k};var sm=l1;var _j={},_T=new h,ofe=new h,mZe=new h,efe=new h,Gc=[new h,new h],rfe=new h,sfe=new h,afe=new h,pZe=new h,_Ze=new h,gZe=new h,yZe=new h,xZe=new h,bZe=new h,CZe=new h,tfe=new Le,nfe=new J;function G3(e,t,n,i,o){let r=h.angleBetween(h.subtract(t,e,_T),h.subtract(n,e,ofe)),s=i===ki.BEVELED?1:Math.ceil(r/R.toRadians(5))+1,a=s*3,c=new Array(a);c[a-3]=n.x,c[a-2]=n.y,c[a-1]=n.z;let l;o?l=J.fromQuaternion(Le.fromAxisAngle(h.negate(e,_T),r/s,tfe),nfe):l=J.fromQuaternion(Le.fromAxisAngle(e,r/s,tfe),nfe);let f=0;t=h.clone(t,_T);for(let d=0;d<s;d++)t=J.multiplyByVector(l,t,t),c[f++]=t.x,c[f++]=t.y,c[f++]=t.z;return c}function AZe(e){let t=rfe,n=sfe,i=afe,o=e[1];n=h.fromArray(e[1],o.length-3,n),i=h.fromArray(e[0],0,i),t=h.midpoint(n,i,t);let r=G3(t,n,i,ki.ROUNDED,!1),s=e.length-1,a=e[s-1];o=e[s],n=h.fromArray(a,a.length-3,n),i=h.fromArray(o,0,i),t=h.midpoint(n,i,t);let c=G3(t,n,i,ki.ROUNDED,!1);return[r,c]}function ife(e,t,n,i){let o=_T;return i?o=h.add(e,t,o):(t=h.negate(t,t),o=h.add(e,t,o)),[o.x,o.y,o.z,n.x,n.y,n.z]}function pj(e,t,n,i){let o=new Array(e.length),r=new Array(e.length),s=h.multiplyByScalar(t,n,_T),a=h.negate(s,ofe),c=0,l=e.length-1;for(let f=0;f<e.length;f+=3){let d=h.fromArray(e,f,mZe),p=h.add(d,a,efe);o[c++]=p.x,o[c++]=p.y,o[c++]=p.z;let g=h.add(d,s,efe);r[l--]=g.z,r[l--]=g.y,r[l--]=g.x}return i.push(o,r),i}_j.addAttribute=function(e,t,n,i){let o=t.x,r=t.y,s=t.z;u(n)&&(e[n]=o,e[n+1]=r,e[n+2]=s),u(i)&&(e[i]=s,e[i-1]=r,e[i-2]=o)};var TZe=new h,EZe=new h;_j.computePositions=function(e){let t=e.granularity,n=e.positions,i=e.ellipsoid,o=e.width/2,r=e.cornerType,s=e.saveAttributes,a=rfe,c=sfe,l=afe,f=pZe,d=_Ze,p=gZe,g=yZe,m=xZe,y=bZe,b=CZe,C=[],A=s?[]:void 0,T=s?[]:void 0,E=n[0],v=n[1];c=h.normalize(h.subtract(v,E,c),c),a=i.geodeticSurfaceNormal(E,a),f=h.normalize(h.cross(a,c,f),f),s&&(A.push(f.x,f.y,f.z),T.push(a.x,a.y,a.z)),g=h.clone(E,g),E=v,l=h.negate(c,l);let D,O=[],P,M=n.length;for(P=1;P<M-1;P++){a=i.geodeticSurfaceNormal(E,a),v=n[P+1],c=h.normalize(h.subtract(v,E,c),c);let _=h.multiplyByScalar(a,h.dot(c,a),TZe);h.subtract(c,_,_),h.normalize(_,_);let S=h.multiplyByScalar(a,h.dot(l,a),EZe);if(h.subtract(l,S,S),h.normalize(S,S),!R.equalsEpsilon(Math.abs(h.dot(_,S)),1,R.EPSILON7)){d=h.normalize(h.add(c,l,d),d),d=h.cross(d,a,d),d=h.cross(a,d,d),d=h.normalize(d,d);let I=o/Math.max(.25,h.magnitude(h.cross(d,l,_T))),N=sm.angleIsGreaterThanPi(c,l,E,i);d=h.multiplyByScalar(d,I,d),N?(m=h.add(E,d,m),b=h.add(m,h.multiplyByScalar(f,o,b),b),y=h.add(m,h.multiplyByScalar(f,o*2,y),y),Gc[0]=h.clone(g,Gc[0]),Gc[1]=h.clone(b,Gc[1]),D=Fi.generateArc({positions:Gc,granularity:t,ellipsoid:i}),C=pj(D,f,o,C),s&&(A.push(f.x,f.y,f.z),T.push(a.x,a.y,a.z)),p=h.clone(y,p),f=h.normalize(h.cross(a,c,f),f),y=h.add(m,h.multiplyByScalar(f,o*2,y),y),g=h.add(m,h.multiplyByScalar(f,o,g),g),r===ki.ROUNDED||r===ki.BEVELED?O.push({leftPositions:G3(m,p,y,r,N)}):O.push({leftPositions:ife(E,h.negate(d,d),y,N)})):(y=h.add(E,d,y),b=h.add(y,h.negate(h.multiplyByScalar(f,o,b),b),b),m=h.add(y,h.negate(h.multiplyByScalar(f,o*2,m),m),m),Gc[0]=h.clone(g,Gc[0]),Gc[1]=h.clone(b,Gc[1]),D=Fi.generateArc({positions:Gc,granularity:t,ellipsoid:i}),C=pj(D,f,o,C),s&&(A.push(f.x,f.y,f.z),T.push(a.x,a.y,a.z)),p=h.clone(m,p),f=h.normalize(h.cross(a,c,f),f),m=h.add(y,h.negate(h.multiplyByScalar(f,o*2,m),m),m),g=h.add(y,h.negate(h.multiplyByScalar(f,o,g),g),g),r===ki.ROUNDED||r===ki.BEVELED?O.push({rightPositions:G3(y,p,m,r,N)}):O.push({rightPositions:ife(E,d,m,N)})),l=h.negate(c,l)}E=v}a=i.geodeticSurfaceNormal(E,a),Gc[0]=h.clone(g,Gc[0]),Gc[1]=h.clone(E,Gc[1]),D=Fi.generateArc({positions:Gc,granularity:t,ellipsoid:i}),C=pj(D,f,o,C),s&&(A.push(f.x,f.y,f.z),T.push(a.x,a.y,a.z));let L;return r===ki.ROUNDED&&(L=AZe(C)),{positions:C,corners:O,lefts:A,normals:T,endPositions:L}};var ji=_j;var ufe=new h,ffe=new h,W3=new h,j3=new h,SZe=new h,dfe=new h,t0=new h,gT=new h;function hfe(e,t){for(let n=0;n<e.length;n++)e[n]=t.scaleToGeodeticSurface(e[n],e[n]);return e}function Md(e,t,n,i,o,r){let s=e.normals,a=e.tangents,c=e.bitangents,l=h.normalize(h.cross(n,t,t0),t0);r.normal&&ji.addAttribute(s,t,i,o),r.tangent&&ji.addAttribute(a,l,i,o),r.bitangent&&ji.addAttribute(c,n,i,o)}function mfe(e,t,n){let i=e.positions,o=e.corners,r=e.endPositions,s=e.lefts,a=e.normals,c=new hn,l,f=0,d=0,p,g=0,m;for(p=0;p<i.length;p+=2)m=i[p].length-3,f+=m,g+=m*2,d+=i[p+1].length-3;for(f+=3,d+=3,p=0;p<o.length;p++){l=o[p];let Z=o[p].leftPositions;u(Z)?(m=Z.length,f+=m,g+=m):(m=o[p].rightPositions.length,d+=m,g+=m)}let y=u(r),b;y&&(b=r[0].length-3,f+=b,d+=b,b/=3,g+=b*6);let C=f+d,A=new Float64Array(C),T=t.normal?new Float32Array(C):void 0,E=t.tangent?new Float32Array(C):void 0,v=t.bitangent?new Float32Array(C):void 0,D={normals:T,tangents:E,bitangents:v},O=0,P=C-1,M,L,_,S,w=ufe,I=ffe,N,k,z=b/2,V=Be.createTypedArray(C/3,g),U=0;if(y){k=W3,N=j3;let Z=r[0];for(w=h.fromArray(a,0,w),I=h.fromArray(s,0,I),p=0;p<z;p++)k=h.fromArray(Z,(z-1-p)*3,k),N=h.fromArray(Z,(z+p)*3,N),ji.addAttribute(A,N,O),ji.addAttribute(A,k,void 0,P),Md(D,w,I,O,P,t),L=O/3,S=L+1,M=(P-2)/3,_=M-1,V[U++]=M,V[U++]=L,V[U++]=_,V[U++]=_,V[U++]=L,V[U++]=S,O+=3,P-=3}let B=0,W=0,j=i[B++],Q=i[B++];A.set(j,O),A.set(Q,P-Q.length+1),I=h.fromArray(s,W,I);let q,X;for(m=Q.length-3,p=0;p<m;p+=3)q=n.geodeticSurfaceNormal(h.fromArray(j,p,t0),t0),X=n.geodeticSurfaceNormal(h.fromArray(Q,m-p,gT),gT),w=h.normalize(h.add(q,X,w),w),Md(D,w,I,O,P,t),L=O/3,S=L+1,M=(P-2)/3,_=M-1,V[U++]=M,V[U++]=L,V[U++]=_,V[U++]=_,V[U++]=L,V[U++]=S,O+=3,P-=3;for(q=n.geodeticSurfaceNormal(h.fromArray(j,m,t0),t0),X=n.geodeticSurfaceNormal(h.fromArray(Q,m,gT),gT),w=h.normalize(h.add(q,X,w),w),W+=3,p=0;p<o.length;p++){let Z;l=o[p];let fe=l.leftPositions,xe=l.rightPositions,re,pe,ye=dfe,Se=W3,Te=j3;if(w=h.fromArray(a,W,w),u(fe)){for(Md(D,w,I,void 0,P,t),P-=3,re=S,pe=_,Z=0;Z<fe.length/3;Z++)ye=h.fromArray(fe,Z*3,ye),V[U++]=re,V[U++]=pe-Z-1,V[U++]=pe-Z,ji.addAttribute(A,ye,void 0,P),Se=h.fromArray(A,(pe-Z-1)*3,Se),Te=h.fromArray(A,re*3,Te),I=h.normalize(h.subtract(Se,Te,I),I),Md(D,w,I,void 0,P,t),P-=3;ye=h.fromArray(A,re*3,ye),Se=h.subtract(h.fromArray(A,pe*3,Se),ye,Se),Te=h.subtract(h.fromArray(A,(pe-Z)*3,Te),ye,Te),I=h.normalize(h.add(Se,Te,I),I),Md(D,w,I,O,void 0,t),O+=3}else{for(Md(D,w,I,O,void 0,t),O+=3,re=_,pe=S,Z=0;Z<xe.length/3;Z++)ye=h.fromArray(xe,Z*3,ye),V[U++]=re,V[U++]=pe+Z,V[U++]=pe+Z+1,ji.addAttribute(A,ye,O),Se=h.fromArray(A,re*3,Se),Te=h.fromArray(A,(pe+Z)*3,Te),I=h.normalize(h.subtract(Se,Te,I),I),Md(D,w,I,O,void 0,t),O+=3;ye=h.fromArray(A,re*3,ye),Se=h.subtract(h.fromArray(A,(pe+Z)*3,Se),ye,Se),Te=h.subtract(h.fromArray(A,pe*3,Te),ye,Te),I=h.normalize(h.negate(h.add(Te,Se,I),I),I),Md(D,w,I,void 0,P,t),P-=3}for(j=i[B++],Q=i[B++],j.splice(0,3),Q.splice(Q.length-3,3),A.set(j,O),A.set(Q,P-Q.length+1),m=Q.length-3,W+=3,I=h.fromArray(s,W,I),Z=0;Z<Q.length;Z+=3)q=n.geodeticSurfaceNormal(h.fromArray(j,Z,t0),t0),X=n.geodeticSurfaceNormal(h.fromArray(Q,m-Z,gT),gT),w=h.normalize(h.add(q,X,w),w),Md(D,w,I,O,P,t),S=O/3,L=S-1,_=(P-2)/3,M=_+1,V[U++]=M,V[U++]=L,V[U++]=_,V[U++]=_,V[U++]=L,V[U++]=S,O+=3,P-=3;O-=3,P+=3}if(w=h.fromArray(a,a.length-3,w),Md(D,w,I,O,P,t),y){O+=3,P-=3,k=W3,N=j3;let Z=r[1];for(p=0;p<z;p++)k=h.fromArray(Z,(b-p-1)*3,k),N=h.fromArray(Z,p*3,N),ji.addAttribute(A,k,void 0,P),ji.addAttribute(A,N,O),Md(D,w,I,O,P,t),S=O/3,L=S-1,_=(P-2)/3,M=_+1,V[U++]=M,V[U++]=L,V[U++]=_,V[U++]=_,V[U++]=L,V[U++]=S,O+=3,P-=3}if(c.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:A}),t.st){let Z=new Float32Array(C/3*2),fe,xe,re=0;if(y){f/=3,d/=3;let pe=Math.PI/(b+1);xe=1/(f-b+1),fe=1/(d-b+1);let ye,Se=b/2;for(p=Se+1;p<b+1;p++)ye=R.PI_OVER_TWO+pe*p,Z[re++]=fe*(1+Math.cos(ye)),Z[re++]=.5*(1+Math.sin(ye));for(p=1;p<d-b+1;p++)Z[re++]=p*fe,Z[re++]=0;for(p=b;p>Se;p--)ye=R.PI_OVER_TWO-p*pe,Z[re++]=1-fe*(1+Math.cos(ye)),Z[re++]=.5*(1+Math.sin(ye));for(p=Se;p>0;p--)ye=R.PI_OVER_TWO-pe*p,Z[re++]=1-xe*(1+Math.cos(ye)),Z[re++]=.5*(1+Math.sin(ye));for(p=f-b;p>0;p--)Z[re++]=p*xe,Z[re++]=1;for(p=1;p<Se+1;p++)ye=R.PI_OVER_TWO+pe*p,Z[re++]=xe*(1+Math.cos(ye)),Z[re++]=.5*(1+Math.sin(ye))}else{for(f/=3,d/=3,xe=1/(f-1),fe=1/(d-1),p=0;p<d;p++)Z[re++]=p*fe,Z[re++]=0;for(p=f;p>0;p--)Z[re++]=(p-1)*xe,Z[re++]=1}c.st=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:Z})}return t.normal&&(c.normal=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:D.normals})),t.tangent&&(c.tangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:D.tangents})),t.bitangent&&(c.bitangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:D.bitangents})),{attributes:c,indices:V}}function vZe(e,t){if(!t.normal&&!t.tangent&&!t.bitangent&&!t.st)return e;let n=e.position.values,i,o;(t.normal||t.bitangent)&&(i=e.normal.values,o=e.bitangent.values);let r=e.position.values.length/18,s=r*3,a=r*2,c=s*2,l;if(t.normal||t.bitangent||t.tangent){let f=t.normal?new Float32Array(s*6):void 0,d=t.tangent?new Float32Array(s*6):void 0,p=t.bitangent?new Float32Array(s*6):void 0,g=ufe,m=ffe,y=W3,b=j3,C=SZe,A=dfe,T=c;for(l=0;l<s;l+=3){let E=T+c;g=h.fromArray(n,l,g),m=h.fromArray(n,l+s,m),y=h.fromArray(n,(l+3)%s,y),m=h.subtract(m,g,m),y=h.subtract(y,g,y),b=h.normalize(h.cross(m,y,b),b),t.normal&&(ji.addAttribute(f,b,E),ji.addAttribute(f,b,E+3),ji.addAttribute(f,b,T),ji.addAttribute(f,b,T+3)),(t.tangent||t.bitangent)&&(A=h.fromArray(i,l,A),t.bitangent&&(ji.addAttribute(p,A,E),ji.addAttribute(p,A,E+3),ji.addAttribute(p,A,T),ji.addAttribute(p,A,T+3)),t.tangent&&(C=h.normalize(h.cross(A,b,C),C),ji.addAttribute(d,C,E),ji.addAttribute(d,C,E+3),ji.addAttribute(d,C,T),ji.addAttribute(d,C,T+3))),T+=6}if(t.normal){for(f.set(i),l=0;l<s;l+=3)f[l+s]=-i[l],f[l+s+1]=-i[l+1],f[l+s+2]=-i[l+2];e.normal.values=f}else e.normal=void 0;if(t.bitangent?(p.set(o),p.set(o,s),e.bitangent.values=p):e.bitangent=void 0,t.tangent){let E=e.tangent.values;d.set(E),d.set(E,s),e.tangent.values=d}}if(t.st){let f=e.st.values,d=new Float32Array(a*6);d.set(f),d.set(f,a);let p=a*2;for(let g=0;g<2;g++){for(d[p++]=f[0],d[p++]=f[1],l=2;l<a;l+=2){let m=f[l],y=f[l+1];d[p++]=m,d[p++]=y,d[p++]=m,d[p++]=y}d[p++]=f[0],d[p++]=f[1]}e.st.values=d}return e}function gj(e,t,n){n[t++]=e[0],n[t++]=e[1],n[t++]=e[2];for(let i=3;i<e.length;i+=3){let o=e[i],r=e[i+1],s=e[i+2];n[t++]=o,n[t++]=r,n[t++]=s,n[t++]=o,n[t++]=r,n[t++]=s}return n[t++]=e[0],n[t++]=e[1],n[t++]=e[2],n}function wZe(e,t){let n=new Ie({position:t.position,normal:t.normal||t.bitangent||e.shadowVolume,tangent:t.tangent,bitangent:t.normal||t.bitangent,st:t.st}),i=e.ellipsoid,o=ji.computePositions(e),r=mfe(o,n,i),s=e.height,a=e.extrudedHeight,c=r.attributes,l=r.indices,f=c.position.values,d=f.length,p=new Float64Array(d*6),g=new Float64Array(d);g.set(f);let m=new Float64Array(d*4);f=ai.scaleToGeodeticHeight(f,s,i),m=gj(f,0,m),g=ai.scaleToGeodeticHeight(g,a,i),m=gj(g,d*2,m),p.set(f),p.set(g,d),p.set(m,d*2),c.position.values=p,c=vZe(c,t);let y,b=d/3;if(e.shadowVolume){let M=c.normal.values;d=M.length;let L=new Float32Array(d*6);for(y=0;y<d;y++)M[y]=-M[y];L.set(M,d),L=gj(M,d*4,L),c.extrudeDirection=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:L}),t.normal||(c.normal=void 0)}if(u(e.offsetAttribute)){let M=new Uint8Array(b*6);if(e.offsetAttribute===an.TOP)M=M.fill(1,0,b).fill(1,b*2,b*4);else{let L=e.offsetAttribute===an.NONE?0:1;M=M.fill(L)}c.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:M})}let C=l.length,A=b+b,T=Be.createTypedArray(p.length/3,C*2+A*3);T.set(l);let E=C;for(y=0;y<C;y+=3){let M=l[y],L=l[y+1],_=l[y+2];T[E++]=_+b,T[E++]=L+b,T[E++]=M+b}let v,D,O,P;for(y=0;y<A;y+=2)v=y+A,D=v+A,O=v+1,P=D+1,T[E++]=v,T[E++]=D,T[E++]=O,T[E++]=O,T[E++]=D,T[E++]=P;return{attributes:c,indices:T}}var cfe=new h,u1=new h,Rf=new de;function lfe(e,t,n,i,o,r){let s=h.subtract(t,e,cfe);h.normalize(s,s);let a=n.geodeticSurfaceNormal(e,u1),c=h.cross(s,a,cfe);h.multiplyByScalar(c,i,c);let l=o.latitude,f=o.longitude,d=r.latitude,p=r.longitude;h.add(e,c,u1),n.cartesianToCartographic(u1,Rf);let g=Rf.latitude,m=Rf.longitude;l=Math.min(l,g),f=Math.min(f,m),d=Math.max(d,g),p=Math.max(p,m),h.subtract(e,c,u1),n.cartesianToCartographic(u1,Rf),g=Rf.latitude,m=Rf.longitude,l=Math.min(l,g),f=Math.min(f,m),d=Math.max(d,g),p=Math.max(p,m),o.latitude=l,o.longitude=f,r.latitude=d,r.longitude=p}var Pf=new h,f1=new h,Sl=new de,vl=new de;function pfe(e,t,n,i,o){e=hfe(e,t);let r=Eo(e,h.equalsEpsilon),s=r.length;if(s<2||n<=0)return new se;let a=n*.5;Sl.latitude=Number.POSITIVE_INFINITY,Sl.longitude=Number.POSITIVE_INFINITY,vl.latitude=Number.NEGATIVE_INFINITY,vl.longitude=Number.NEGATIVE_INFINITY;let c,l;if(i===ki.ROUNDED){let p=r[0];h.subtract(p,r[1],Pf),h.normalize(Pf,Pf),h.multiplyByScalar(Pf,a,Pf),h.add(p,Pf,f1),t.cartesianToCartographic(f1,Rf),c=Rf.latitude,l=Rf.longitude,Sl.latitude=Math.min(Sl.latitude,c),Sl.longitude=Math.min(Sl.longitude,l),vl.latitude=Math.max(vl.latitude,c),vl.longitude=Math.max(vl.longitude,l)}for(let p=0;p<s-1;++p)lfe(r[p],r[p+1],t,a,Sl,vl);let f=r[s-1];h.subtract(f,r[s-2],Pf),h.normalize(Pf,Pf),h.multiplyByScalar(Pf,a,Pf),h.add(f,Pf,f1),lfe(f,f1,t,a,Sl,vl),i===ki.ROUNDED&&(t.cartesianToCartographic(f1,Rf),c=Rf.latitude,l=Rf.longitude,Sl.latitude=Math.min(Sl.latitude,c),Sl.longitude=Math.min(Sl.longitude,l),vl.latitude=Math.max(vl.latitude,c),vl.longitude=Math.max(vl.longitude,l));let d=u(o)?o:new se;return d.north=vl.latitude,d.south=Sl.latitude,d.east=vl.longitude,d.west=Sl.longitude,d}function Zp(e){e=x(e,x.EMPTY_OBJECT);let t=e.positions,n=e.width,i=x(e.height,0),o=x(e.extrudedHeight,i);this._positions=t,this._ellipsoid=ee.clone(x(e.ellipsoid,ee.default)),this._vertexFormat=Ie.clone(x(e.vertexFormat,Ie.DEFAULT)),this._width=n,this._height=Math.max(i,o),this._extrudedHeight=Math.min(i,o),this._cornerType=x(e.cornerType,ki.ROUNDED),this._granularity=x(e.granularity,R.RADIANS_PER_DEGREE),this._shadowVolume=x(e.shadowVolume,!1),this._workerName="createCorridorGeometry",this._offsetAttribute=e.offsetAttribute,this._rectangle=void 0,this.packedLength=1+t.length*h.packedLength+ee.packedLength+Ie.packedLength+7}Zp.pack=function(e,t,n){n=x(n,0);let i=e._positions,o=i.length;t[n++]=o;for(let r=0;r<o;++r,n+=h.packedLength)h.pack(i[r],t,n);return ee.pack(e._ellipsoid,t,n),n+=ee.packedLength,Ie.pack(e._vertexFormat,t,n),n+=Ie.packedLength,t[n++]=e._width,t[n++]=e._height,t[n++]=e._extrudedHeight,t[n++]=e._cornerType,t[n++]=e._granularity,t[n++]=e._shadowVolume?1:0,t[n]=x(e._offsetAttribute,-1),t};var _fe=ee.clone(ee.UNIT_SPHERE),gfe=new Ie,Kp={positions:void 0,ellipsoid:_fe,vertexFormat:gfe,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,shadowVolume:void 0,offsetAttribute:void 0};Zp.unpack=function(e,t,n){t=x(t,0);let i=e[t++],o=new Array(i);for(let m=0;m<i;++m,t+=h.packedLength)o[m]=h.unpack(e,t);let r=ee.unpack(e,t,_fe);t+=ee.packedLength;let s=Ie.unpack(e,t,gfe);t+=Ie.packedLength;let a=e[t++],c=e[t++],l=e[t++],f=e[t++],d=e[t++],p=e[t++]===1,g=e[t];return u(n)?(n._positions=o,n._ellipsoid=ee.clone(r,n._ellipsoid),n._vertexFormat=Ie.clone(s,n._vertexFormat),n._width=a,n._height=c,n._extrudedHeight=l,n._cornerType=f,n._granularity=d,n._shadowVolume=p,n._offsetAttribute=g===-1?void 0:g,n):(Kp.positions=o,Kp.width=a,Kp.height=c,Kp.extrudedHeight=l,Kp.cornerType=f,Kp.granularity=d,Kp.shadowVolume=p,Kp.offsetAttribute=g===-1?void 0:g,new Zp(Kp))};Zp.computeRectangle=function(e,t){e=x(e,x.EMPTY_OBJECT);let n=e.positions,i=e.width,o=x(e.ellipsoid,ee.default),r=x(e.cornerType,ki.ROUNDED);return pfe(n,o,i,r,t)};Zp.createGeometry=function(e){let t=e._positions,n=e._width,i=e._ellipsoid;t=hfe(t,i);let o=Eo(t,h.equalsEpsilon);if(o.length<2||n<=0)return;let r=e._height,s=e._extrudedHeight,a=!R.equalsEpsilon(r,s,0,R.EPSILON2),c=e._vertexFormat,l={ellipsoid:i,positions:o,width:n,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!0},f;if(a)l.height=r,l.extrudedHeight=s,l.shadowVolume=e._shadowVolume,l.offsetAttribute=e._offsetAttribute,f=wZe(l,c);else{let g=ji.computePositions(l);if(f=mfe(g,c,i),f.attributes.position.values=ai.scaleToGeodeticHeight(f.attributes.position.values,r,i),u(e._offsetAttribute)){let m=e._offsetAttribute===an.NONE?0:1,y=f.attributes.position.values.length,b=new Uint8Array(y/3).fill(m);f.attributes.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:b})}}let d=f.attributes,p=ae.fromVertices(d.position.values,void 0,3);return c.position||(f.attributes.position.values=void 0),new ft({attributes:d,indices:f.indices,primitiveType:Ne.TRIANGLES,boundingSphere:p,offsetAttribute:e._offsetAttribute})};Zp.createShadowVolume=function(e,t,n){let i=e._granularity,o=e._ellipsoid,r=t(i,o),s=n(i,o);return new Zp({positions:e._positions,width:e._width,cornerType:e._cornerType,ellipsoid:o,granularity:i,extrudedHeight:r,height:s,vertexFormat:Ie.POSITION_ONLY,shadowVolume:!0})};Object.defineProperties(Zp.prototype,{rectangle:{get:function(){return u(this._rectangle)||(this._rectangle=pfe(this._positions,this._ellipsoid,this._width,this._cornerType)),this._rectangle}},textureCoordinateRotationPoints:{get:function(){return[0,0,0,1,1,0]}}});var yT=Zp;var yfe=new h,xfe=new h,DZe=new h;function IZe(e,t){for(let n=0;n<e.length;n++)e[n]=t.scaleToGeodeticSurface(e[n],e[n]);return e}function bfe(e,t){let n=[],i=e.positions,o=e.corners,r=e.endPositions,s=new hn,a,c=0,l=0,f,d=0,p;for(f=0;f<i.length;f+=2)p=i[f].length-3,c+=p,d+=p/3*4,l+=i[f+1].length-3;for(c+=3,l+=3,f=0;f<o.length;f++){a=o[f];let N=o[f].leftPositions;u(N)?(p=N.length,c+=p,d+=p/3*2):(p=o[f].rightPositions.length,l+=p,d+=p/3*2)}let g=u(r),m;g&&(m=r[0].length-3,c+=m,l+=m,m/=3,d+=m*4);let y=c+l,b=new Float64Array(y),C=0,A=y-1,T,E,v,D,O,P,M=m/2,L=Be.createTypedArray(y/3,d+4),_=0;if(L[_++]=C/3,L[_++]=(A-2)/3,g){n.push(C/3),P=yfe,O=xfe;let N=r[0];for(f=0;f<M;f++)P=h.fromArray(N,(M-1-f)*3,P),O=h.fromArray(N,(M+f)*3,O),ji.addAttribute(b,O,C),ji.addAttribute(b,P,void 0,A),E=C/3,D=E+1,T=(A-2)/3,v=T-1,L[_++]=T,L[_++]=v,L[_++]=E,L[_++]=D,C+=3,A-=3}let S=0,w=i[S++],I=i[S++];for(b.set(w,C),b.set(I,A-I.length+1),p=I.length-3,n.push(C/3,(A-2)/3),f=0;f<p;f+=3)E=C/3,D=E+1,T=(A-2)/3,v=T-1,L[_++]=T,L[_++]=v,L[_++]=E,L[_++]=D,C+=3,A-=3;for(f=0;f<o.length;f++){let N;a=o[f];let k=a.leftPositions,z=a.rightPositions,V,U=DZe;if(u(k)){for(A-=3,V=v,n.push(D),N=0;N<k.length/3;N++)U=h.fromArray(k,N*3,U),L[_++]=V-N-1,L[_++]=V-N,ji.addAttribute(b,U,void 0,A),A-=3;n.push(V-Math.floor(k.length/6)),t===ki.BEVELED&&n.push((A-2)/3+1),C+=3}else{for(C+=3,V=D,n.push(v),N=0;N<z.length/3;N++)U=h.fromArray(z,N*3,U),L[_++]=V+N,L[_++]=V+N+1,ji.addAttribute(b,U,C),C+=3;n.push(V+Math.floor(z.length/6)),t===ki.BEVELED&&n.push(C/3-1),A-=3}for(w=i[S++],I=i[S++],w.splice(0,3),I.splice(I.length-3,3),b.set(w,C),b.set(I,A-I.length+1),p=I.length-3,N=0;N<I.length;N+=3)D=C/3,E=D-1,v=(A-2)/3,T=v+1,L[_++]=T,L[_++]=v,L[_++]=E,L[_++]=D,C+=3,A-=3;C-=3,A+=3,n.push(C/3,(A-2)/3)}if(g){C+=3,A-=3,P=yfe,O=xfe;let N=r[1];for(f=0;f<M;f++)P=h.fromArray(N,(m-f-1)*3,P),O=h.fromArray(N,f*3,O),ji.addAttribute(b,P,void 0,A),ji.addAttribute(b,O,C),D=C/3,E=D-1,v=(A-2)/3,T=v+1,L[_++]=T,L[_++]=v,L[_++]=E,L[_++]=D,C+=3,A-=3;n.push(C/3)}else n.push(C/3,(A-2)/3);return L[_++]=C/3,L[_++]=(A-2)/3,s.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:b}),{attributes:s,indices:L,wallIndices:n}}function PZe(e){let t=e.ellipsoid,n=ji.computePositions(e),i=bfe(n,e.cornerType),o=i.wallIndices,r=e.height,s=e.extrudedHeight,a=i.attributes,c=i.indices,l=a.position.values,f=l.length,d=new Float64Array(f);d.set(l);let p=new Float64Array(f*2);if(l=ai.scaleToGeodeticHeight(l,r,t),d=ai.scaleToGeodeticHeight(d,s,t),p.set(l),p.set(d,f),a.position.values=p,f/=3,u(e.offsetAttribute)){let T=new Uint8Array(f*2);if(e.offsetAttribute===an.TOP)T=T.fill(1,0,f);else{let E=e.offsetAttribute===an.NONE?0:1;T=T.fill(E)}a.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:T})}let g,m=c.length,y=Be.createTypedArray(p.length/3,(m+o.length)*2);y.set(c);let b=m;for(g=0;g<m;g+=2){let T=c[g],E=c[g+1];y[b++]=T+f,y[b++]=E+f}let C,A;for(g=0;g<o.length;g++)C=o[g],A=C+f,y[b++]=C,y[b++]=A;return{attributes:a,indices:y}}function d1(e){e=x(e,x.EMPTY_OBJECT);let t=e.positions,n=e.width,i=x(e.height,0),o=x(e.extrudedHeight,i);this._positions=t,this._ellipsoid=ee.clone(x(e.ellipsoid,ee.default)),this._width=n,this._height=Math.max(i,o),this._extrudedHeight=Math.min(i,o),this._cornerType=x(e.cornerType,ki.ROUNDED),this._granularity=x(e.granularity,R.RADIANS_PER_DEGREE),this._offsetAttribute=e.offsetAttribute,this._workerName="createCorridorOutlineGeometry",this.packedLength=1+t.length*h.packedLength+ee.packedLength+6}d1.pack=function(e,t,n){n=x(n,0);let i=e._positions,o=i.length;t[n++]=o;for(let r=0;r<o;++r,n+=h.packedLength)h.pack(i[r],t,n);return ee.pack(e._ellipsoid,t,n),n+=ee.packedLength,t[n++]=e._width,t[n++]=e._height,t[n++]=e._extrudedHeight,t[n++]=e._cornerType,t[n++]=e._granularity,t[n]=x(e._offsetAttribute,-1),t};var Cfe=ee.clone(ee.UNIT_SPHERE),n0={positions:void 0,ellipsoid:Cfe,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};d1.unpack=function(e,t,n){t=x(t,0);let i=e[t++],o=new Array(i);for(let p=0;p<i;++p,t+=h.packedLength)o[p]=h.unpack(e,t);let r=ee.unpack(e,t,Cfe);t+=ee.packedLength;let s=e[t++],a=e[t++],c=e[t++],l=e[t++],f=e[t++],d=e[t];return u(n)?(n._positions=o,n._ellipsoid=ee.clone(r,n._ellipsoid),n._width=s,n._height=a,n._extrudedHeight=c,n._cornerType=l,n._granularity=f,n._offsetAttribute=d===-1?void 0:d,n):(n0.positions=o,n0.width=s,n0.height=a,n0.extrudedHeight=c,n0.cornerType=l,n0.granularity=f,n0.offsetAttribute=d===-1?void 0:d,new d1(n0))};d1.createGeometry=function(e){let t=e._positions,n=e._width,i=e._ellipsoid;t=IZe(t,i);let o=Eo(t,h.equalsEpsilon);if(o.length<2||n<=0)return;let r=e._height,s=e._extrudedHeight,a=!R.equalsEpsilon(r,s,0,R.EPSILON2),c={ellipsoid:i,positions:o,width:n,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!1},l;if(a)c.height=r,c.extrudedHeight=s,c.offsetAttribute=e._offsetAttribute,l=PZe(c);else{let p=ji.computePositions(c);if(l=bfe(p,c.cornerType),l.attributes.position.values=ai.scaleToGeodeticHeight(l.attributes.position.values,r,i),u(e._offsetAttribute)){let g=l.attributes.position.values.length,m=e._offsetAttribute===an.NONE?0:1,y=new Uint8Array(g/3).fill(m);l.attributes.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:y})}}let f=l.attributes,d=ae.fromVertices(f.position.values,void 0,3);return new ft({attributes:f,indices:l.indices,primitiveType:Ne.LINES,boundingSphere:d,offsetAttribute:e._offsetAttribute})};var q3=d1;var RZe=new Kn(0);function Wc(e){ri.call(this,e),this._zIndex=0,this._terrainOffsetProperty=void 0}u(Object.create)&&(Wc.prototype=Object.create(ri.prototype),Wc.prototype.constructor=Wc);Object.defineProperties(Wc.prototype,{zIndex:{get:function(){return this._zIndex}},terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}});Wc.prototype._isOnTerrain=function(e,t){return this._fillEnabled&&!u(t.height)&&!u(t.extrudedHeight)&&_l.isSupported(this._scene)};Wc.prototype._getIsClosed=function(e){let t=e.height,n=e.extrudedHeight;return t===0||u(n)&&n!==t};Wc.prototype._computeCenter=he.throwInstantiationError;Wc.prototype._onEntityPropertyChanged=function(e,t,n,i){if(ri.prototype._onEntityPropertyChanged.call(this,e,t,n,i),this._observedPropertyNames.indexOf(t)===-1)return;let o=this._entity[this._geometryPropertyName];if(!u(o))return;u(o.zIndex)&&(u(o.height)||u(o.extrudedHeight))&&At(At.geometryZIndex),this._zIndex=x(o.zIndex,RZe),u(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0);let r=o.heightReference,s=o.extrudedHeightReference;if(u(r)||u(s)){let a=new Fh(this._computeCenter.bind(this),!this._dynamic);this._terrainOffsetProperty=new eA(this._scene,a,r,s)}};Wc.prototype.destroy=function(){u(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0),ri.prototype.destroy.call(this)};Wc.getGeometryHeight=function(e,t){if(!u(e)){t!==Xe.NONE&&At(At.geometryHeightReference);return}return tf(t)?0:e};Wc.getGeometryExtrudedHeight=function(e,t){if(!u(e)){t!==Xe.NONE&&At(At.geometryExtrudedHeightReference);return}return tf(t)?Wc.CLAMP_TO_GROUND:e};Wc.CLAMP_TO_GROUND="clamp";Wc.computeGeometryOffsetAttribute=function(e,t,n,i){(!u(e)||!u(t))&&(t=Xe.NONE),(!u(n)||!u(i))&&(i=Xe.NONE);let o=0;if(t!==Xe.NONE&&o++,i===Xe.RELATIVE_TO_GROUND&&o++,o===2)return an.ALL;if(o===1)return an.TOP};var Wn=Wc;var Afe=new G,Tfe=h.ZERO,Efe=new h,Sfe=new se;function OZe(e){this.id=e,this.vertexFormat=void 0,this.positions=void 0,this.width=void 0,this.cornerType=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.offsetAttribute=void 0}function Ld(e,t){Wn.call(this,{entity:e,scene:t,geometryOptions:new OZe(e),geometryPropertyName:"corridor",observedPropertyNames:["availability","corridor"]}),this._onEntityPropertyChanged(e,"corridor",e.corridor,void 0)}u(Object.create)&&(Ld.prototype=Object.create(Wn.prototype),Ld.prototype.constructor=Ld);Ld.prototype.createFillGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i={show:new yn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:kn.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};if(this._materialProperty instanceof Ht){let o;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(o=this._materialProperty.color.getValue(e,Afe)),u(o)||(o=G.WHITE),i.color=jt.fromColor(o)}return u(this._options.offsetAttribute)&&(i.offset=to.fromCartesian3(Y.getValueOrDefault(this._terrainOffsetProperty,e,Tfe,Efe))),new vt({id:t,geometry:new yT(this._options),attributes:i})};Ld.prototype.createOutlineGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i=Y.getValueOrDefault(this._outlineColorProperty,e,G.BLACK,Afe),o={show:new yn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:jt.fromColor(i),distanceDisplayCondition:kn.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0};return u(this._options.offsetAttribute)&&(o.offset=to.fromCartesian3(Y.getValueOrDefault(this._terrainOffsetProperty,e,Tfe,Efe))),new vt({id:t,geometry:new q3(this._options),attributes:o})};Ld.prototype._computeCenter=function(e,t){let n=Y.getValueOrUndefined(this._entity.corridor.positions,e);if(!(!u(n)||n.length===0))return h.clone(n[Math.floor(n.length/2)],t)};Ld.prototype._isHidden=function(e,t){return!u(t.positions)||!u(t.width)||ri.prototype._isHidden.call(this,e,t)};Ld.prototype._isDynamic=function(e,t){return!t.positions.isConstant||!Y.isConstant(t.height)||!Y.isConstant(t.extrudedHeight)||!Y.isConstant(t.granularity)||!Y.isConstant(t.width)||!Y.isConstant(t.outlineWidth)||!Y.isConstant(t.cornerType)||!Y.isConstant(t.zIndex)||this._onTerrain&&!Y.isConstant(this._materialProperty)&&!(this._materialProperty instanceof Ht)};Ld.prototype._setStaticOptions=function(e,t){let n=Y.getValueOrUndefined(t.height,He.MINIMUM_VALUE),i=Y.getValueOrDefault(t.heightReference,He.MINIMUM_VALUE,Xe.NONE),o=Y.getValueOrUndefined(t.extrudedHeight,He.MINIMUM_VALUE),r=Y.getValueOrDefault(t.extrudedHeightReference,He.MINIMUM_VALUE,Xe.NONE);u(o)&&!u(n)&&(n=0);let s=this._options;s.vertexFormat=this._materialProperty instanceof Ht?ln.VERTEX_FORMAT:ho.MaterialSupport.TEXTURED.vertexFormat,s.positions=t.positions.getValue(He.MINIMUM_VALUE,s.positions),s.width=t.width.getValue(He.MINIMUM_VALUE),s.granularity=Y.getValueOrUndefined(t.granularity,He.MINIMUM_VALUE),s.cornerType=Y.getValueOrUndefined(t.cornerType,He.MINIMUM_VALUE),s.offsetAttribute=Wn.computeGeometryOffsetAttribute(n,i,o,r),s.height=Wn.getGeometryHeight(n,i),o=Wn.getGeometryExtrudedHeight(o,r),o===Wn.CLAMP_TO_GROUND&&(o=di.getMinimumMaximumHeights(yT.computeRectangle(s,Sfe)).minimumTerrainHeight),s.extrudedHeight=o};Ld.DynamicGeometryUpdater=xT;function xT(e,t,n){oi.call(this,e,t,n)}u(Object.create)&&(xT.prototype=Object.create(oi.prototype),xT.prototype.constructor=xT);xT.prototype._isHidden=function(e,t,n){let i=this._options;return!u(i.positions)||!u(i.width)||oi.prototype._isHidden.call(this,e,t,n)};xT.prototype._setOptions=function(e,t,n){let i=this._options,o=Y.getValueOrUndefined(t.height,n),r=Y.getValueOrDefault(t.heightReference,n,Xe.NONE),s=Y.getValueOrUndefined(t.extrudedHeight,n),a=Y.getValueOrDefault(t.extrudedHeightReference,n,Xe.NONE);u(s)&&!u(o)&&(o=0),i.positions=Y.getValueOrUndefined(t.positions,n),i.width=Y.getValueOrUndefined(t.width,n),i.granularity=Y.getValueOrUndefined(t.granularity,n),i.cornerType=Y.getValueOrUndefined(t.cornerType,n),i.offsetAttribute=Wn.computeGeometryOffsetAttribute(o,r,s,a),i.height=Wn.getGeometryHeight(o,r),s=Wn.getGeometryExtrudedHeight(s,a),s===Wn.CLAMP_TO_GROUND&&(s=di.getMinimumMaximumHeights(yT.computeRectangle(i,Sfe)).minimumTerrainHeight),i.extrudedHeight=s};var Y3=Ld;function X3(){he.throwInstantiationError()}Object.defineProperties(X3.prototype,{name:{get:he.throwInstantiationError},clock:{get:he.throwInstantiationError},entities:{get:he.throwInstantiationError},isLoading:{get:he.throwInstantiationError},changedEvent:{get:he.throwInstantiationError},errorEvent:{get:he.throwInstantiationError},loadingEvent:{get:he.throwInstantiationError},show:{get:he.throwInstantiationError},clustering:{get:he.throwInstantiationError}});X3.prototype.update=function(e){he.throwInstantiationError()};X3.setLoading=function(e,t){e._isLoading!==t&&(t?e._entityCollection.suspendEvents():e._entityCollection.resumeEvents(),e._isLoading=t,e._loading.raiseEvent(e,t))};var Kr=X3;function am(e,t){this._ellipsoid=e,this._cameraPosition=new h,this._cameraPositionInScaledSpace=new h,this._distanceToLimbInScaledSpaceSquared=0,u(t)&&(this.cameraPosition=t)}Object.defineProperties(am.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},cameraPosition:{get:function(){return this._cameraPosition},set:function(e){let n=this._ellipsoid.transformPositionToScaledSpace(e,this._cameraPositionInScaledSpace),i=h.magnitudeSquared(n)-1;h.clone(e,this._cameraPosition),this._cameraPositionInScaledSpace=n,this._distanceToLimbInScaledSpaceSquared=i}}});var vfe=new h;am.prototype.isPointVisible=function(e){let n=this._ellipsoid.transformPositionToScaledSpace(e,vfe);return xj(n,this._cameraPositionInScaledSpace,this._distanceToLimbInScaledSpaceSquared)};am.prototype.isScaledSpacePointVisible=function(e){return xj(e,this._cameraPositionInScaledSpace,this._distanceToLimbInScaledSpaceSquared)};var MZe=new h;am.prototype.isScaledSpacePointVisiblePossiblyUnderEllipsoid=function(e,t){let n=this._ellipsoid,i,o;return u(t)&&t<0&&n.minimumRadius>-t?(o=MZe,o.x=this._cameraPosition.x/(n.radii.x+t),o.y=this._cameraPosition.y/(n.radii.y+t),o.z=this._cameraPosition.z/(n.radii.z+t),i=o.x*o.x+o.y*o.y+o.z*o.z-1):(o=this._cameraPositionInScaledSpace,i=this._distanceToLimbInScaledSpaceSquared),xj(e,o,i)};am.prototype.computeHorizonCullingPoint=function(e,t,n){return Ife(this._ellipsoid,e,t,n)};var wfe=ee.clone(ee.UNIT_SPHERE);am.prototype.computeHorizonCullingPointPossiblyUnderEllipsoid=function(e,t,n,i){let o=Dfe(this._ellipsoid,n,wfe);return Ife(o,e,t,i)};am.prototype.computeHorizonCullingPointFromVertices=function(e,t,n,i,o){return Pfe(this._ellipsoid,e,t,n,i,o)};am.prototype.computeHorizonCullingPointFromVerticesPossiblyUnderEllipsoid=function(e,t,n,i,o,r){let s=Dfe(this._ellipsoid,o,wfe);return Pfe(s,e,t,n,i,r)};var LZe=[];am.prototype.computeHorizonCullingPointFromRectangle=function(e,t,n){let i=se.subsample(e,t,0,LZe),o=ae.fromPoints(i);if(!(h.magnitude(o.center)<.1*t.minimumRadius))return this.computeHorizonCullingPoint(o.center,i,n)};var NZe=new h;function Dfe(e,t,n){if(u(t)&&t<0&&e.minimumRadius>-t){let i=h.fromElements(e.radii.x+t,e.radii.y+t,e.radii.z+t,NZe);e=ee.fromCartesian3(i,n)}return e}function Ife(e,t,n,i){u(i)||(i=new h);let o=Mfe(e,t),r=0;for(let s=0,a=n.length;s<a;++s){let c=n[s],l=Rfe(e,c,o);if(l<0)return;r=Math.max(r,l)}return Ofe(o,r,i)}var K3=new h;function Pfe(e,t,n,i,o,r){u(r)||(r=new h),i=x(i,3),o=x(o,h.ZERO);let s=Mfe(e,t),a=0;for(let c=0,l=n.length;c<l;c+=i){K3.x=n[c]+o.x,K3.y=n[c+1]+o.y,K3.z=n[c+2]+o.z;let f=Rfe(e,K3,s);if(f<0)return;a=Math.max(a,f)}return Ofe(s,a,r)}function xj(e,t,n){let i=t,o=n,r=h.subtract(e,i,vfe),s=-h.dot(r,i);return!(o<0?s>0:s>o&&s*s/h.magnitudeSquared(r)>o)}var FZe=new h,BZe=new h;function Rfe(e,t,n){let i=e.transformPositionToScaledSpace(t,FZe),o=h.magnitudeSquared(i),r=Math.sqrt(o),s=h.divideByScalar(i,r,BZe);o=Math.max(1,o),r=Math.max(1,r);let a=h.dot(s,n),c=h.magnitude(h.cross(s,n,s)),l=1/r,f=Math.sqrt(o-1)*l;return 1/(a*l-c*f)}function Ofe(e,t,n){if(!(t<=0||t===1/0||t!==t))return h.multiplyByScalar(e,t,n)}var yj=new h;function Mfe(e,t){return h.equals(t,h.ZERO)?t:(e.transformPositionToScaledSpace(t,yj),h.normalize(yj,yj))}var i0=am;function Tr(e,t){e=x(e,x.EMPTY_OBJECT);let n=e.translucencyByDistance,i=e.scaleByDistance,o=e.distanceDisplayCondition;u(n)&&(n=kt.clone(n)),u(i)&&(i=kt.clone(i)),u(o)&&(o=Nt.clone(o)),this._show=x(e.show,!0),this._position=h.clone(x(e.position,h.ZERO)),this._actualPosition=h.clone(this._position),this._color=G.clone(x(e.color,G.WHITE)),this._outlineColor=G.clone(x(e.outlineColor,G.TRANSPARENT)),this._outlineWidth=x(e.outlineWidth,0),this._pixelSize=x(e.pixelSize,10),this._scaleByDistance=i,this._translucencyByDistance=n,this._distanceDisplayCondition=o,this._disableDepthTestDistance=x(e.disableDepthTestDistance,0),this._id=e.id,this._collection=x(e.collection,t),this._clusterShow=!0,this._pickId=void 0,this._pointPrimitiveCollection=t,this._dirty=!1,this._index=-1,this._splitDirection=x(e.splitDirection,Wr.NONE)}var Lfe=Tr.SHOW_INDEX=0,Bfe=Tr.POSITION_INDEX=1,kZe=Tr.COLOR_INDEX=2,VZe=Tr.OUTLINE_COLOR_INDEX=3,UZe=Tr.OUTLINE_WIDTH_INDEX=4,zZe=Tr.PIXEL_SIZE_INDEX=5,HZe=Tr.SCALE_BY_DISTANCE_INDEX=6,GZe=Tr.TRANSLUCENCY_BY_DISTANCE_INDEX=7,WZe=Tr.DISTANCE_DISPLAY_CONDITION_INDEX=8,jZe=Tr.DISABLE_DEPTH_DISTANCE_INDEX=9,qZe=Tr.SPLIT_DIRECTION_INDEX=10;Tr.NUMBER_OF_PROPERTIES=11;function du(e,t){let n=e._pointPrimitiveCollection;u(n)&&(n._updatePointPrimitive(e,t),e._dirty=!0)}Object.defineProperties(Tr.prototype,{show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,du(this,Lfe))}},position:{get:function(){return this._position},set:function(e){let t=this._position;h.equals(t,e)||(h.clone(e,t),h.clone(e,this._actualPosition),du(this,Bfe))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){let t=this._scaleByDistance;kt.equals(t,e)||(this._scaleByDistance=kt.clone(e,t),du(this,HZe))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){let t=this._translucencyByDistance;kt.equals(t,e)||(this._translucencyByDistance=kt.clone(e,t),du(this,GZe))}},pixelSize:{get:function(){return this._pixelSize},set:function(e){this._pixelSize!==e&&(this._pixelSize=e,du(this,zZe))}},color:{get:function(){return this._color},set:function(e){let t=this._color;G.equals(t,e)||(G.clone(e,t),du(this,kZe))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){let t=this._outlineColor;G.equals(t,e)||(G.clone(e,t),du(this,VZe))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,du(this,UZe))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){Nt.equals(this._distanceDisplayCondition,e)||(this._distanceDisplayCondition=Nt.clone(e,this._distanceDisplayCondition),du(this,WZe))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){this._disableDepthTestDistance!==e&&(this._disableDepthTestDistance=e,du(this,jZe))}},id:{get:function(){return this._id},set:function(e){this._id=e,u(this._pickId)&&(this._pickId.object.id=e)}},pickId:{get:function(){return this._pickId}},clusterShow:{get:function(){return this._clusterShow},set:function(e){this._clusterShow!==e&&(this._clusterShow=e,du(this,Lfe))}},splitDirection:{get:function(){return this._splitDirection},set:function(e){this._splitDirection!==e&&(this._splitDirection=e,du(this,qZe))}}});Tr.prototype.getPickId=function(e){return u(this._pickId)||(this._pickId=e.createPickId({primitive:this,collection:this._collection,id:this._id})),this._pickId};Tr.prototype._getActualPosition=function(){return this._actualPosition};Tr.prototype._setActualPosition=function(e){h.clone(e,this._actualPosition),du(this,Bfe)};var Nfe=new oe;Tr._computeActualPosition=function(e,t,n){return t.mode===ne.SCENE3D?e:(F.multiplyByPoint(n,e,Nfe),Wi.computeActualEllipsoidPosition(t,Nfe))};var Ffe=new oe;Tr._computeScreenSpacePosition=function(e,t,n,i){let o=F.multiplyByVector(e,oe.fromElements(t.x,t.y,t.z,1,Ffe),Ffe);return Wi.worldToWindowCoordinates(n,o,i)};Tr.prototype.computeScreenSpacePosition=function(e,t){let n=this._pointPrimitiveCollection;u(t)||(t=new H);let i=n.modelMatrix,o=Tr._computeScreenSpacePosition(i,this._actualPosition,e,t);if(u(o))return o.y=e.canvas.clientHeight-o.y,o};Tr.getScreenSpaceBoundingBox=function(e,t,n){let i=e.pixelSize,o=i*.5,r=t.x-o,s=t.y-o,a=i,c=i;return u(n)||(n=new qe),n.x=r,n.y=s,n.width=a,n.height=c,n};Tr.prototype.equals=function(e){return this===e||u(e)&&this._id===e._id&&h.equals(this._position,e._position)&&G.equals(this._color,e._color)&&this._pixelSize===e._pixelSize&&this._outlineWidth===e._outlineWidth&&this._show===e._show&&G.equals(this._outlineColor,e._outlineColor)&&kt.equals(this._scaleByDistance,e._scaleByDistance)&&kt.equals(this._translucencyByDistance,e._translucencyByDistance)&&Nt.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance&&this._splitDirection===e._splitDirection};Tr.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._pointPrimitiveCollection=void 0};var Ws=Tr;var kx=`in vec4 v_color;
in vec4 v_outlineColor;
in float v_innerPercent;
in float v_pixelDistance;
in vec4 v_pickColor;
in float v_splitDirection;

void main()
{
    if (v_splitDirection < 0.0 && gl_FragCoord.x > czm_splitPosition) discard;
    if (v_splitDirection > 0.0 && gl_FragCoord.x < czm_splitPosition) discard;

    // The distance in UV space from this fragment to the center of the point, at most 0.5.
    float distanceToCenter = length(gl_PointCoord - vec2(0.5));
    // The max distance stops one pixel shy of the edge to leave space for anti-aliasing.
    float maxDistance = max(0.0, 0.5 - v_pixelDistance);
    float wholeAlpha = 1.0 - smoothstep(maxDistance, 0.5, distanceToCenter);
    float innerAlpha = 1.0 - smoothstep(maxDistance * v_innerPercent, 0.5 * v_innerPercent, distanceToCenter);

    vec4 color = mix(v_outlineColor, v_color, innerAlpha);
    color.a *= wholeAlpha;

// Fully transparent parts of the billboard are not pickable.
#if !defined(OPAQUE) && !defined(TRANSLUCENT)
    if (color.a < 0.005)   // matches 0/255 and 1/255
    {
        discard;
    }
#else
// The billboard is rendered twice. The opaque pass discards translucent fragments
// and the translucent pass discards opaque fragments.
#ifdef OPAQUE
    if (color.a < 0.995)   // matches < 254/255
    {
        discard;
    }
#else
    if (color.a >= 0.995)  // matches 254/255 and 255/255
    {
        discard;
    }
#endif
#endif

    out_FragColor = czm_gammaCorrect(color);
    czm_writeLogDepth();
}
`;var Z3=`uniform float u_maxTotalPointSize;

in vec4 positionHighAndSize;
in vec4 positionLowAndOutline;
in vec4 compressedAttribute0;                                        // color, outlineColor, pick color
in vec4 compressedAttribute1;                                        // show, translucency by distance, some free space
in vec4 scaleByDistance;                                             // near, nearScale, far, farScale
in vec4 distanceDisplayConditionAndDisableDepthAndSplitDirection;    // near, far, disableDepthTestDistance, splitDirection

out vec4 v_color;
out vec4 v_outlineColor;
out float v_innerPercent;
out float v_pixelDistance;
out vec4 v_pickColor;
out float v_splitDirection;

const float SHIFT_LEFT8 = 256.0;
const float SHIFT_RIGHT8 = 1.0 / 256.0;

void main()
{
    // Modifying this shader may also require modifications to PointPrimitive._computeScreenSpacePosition

    // unpack attributes
    vec3 positionHigh = positionHighAndSize.xyz;
    vec3 positionLow = positionLowAndOutline.xyz;
    float outlineWidthBothSides = 2.0 * positionLowAndOutline.w;
    float totalSize = positionHighAndSize.w + outlineWidthBothSides;
    float outlinePercent = outlineWidthBothSides / totalSize;
    // Scale in response to browser-zoom.
    totalSize *= czm_pixelRatio;

    float temp = compressedAttribute1.x * SHIFT_RIGHT8;
    float show = floor(temp);

#ifdef EYE_DISTANCE_TRANSLUCENCY
    vec4 translucencyByDistance;
    translucencyByDistance.x = compressedAttribute1.z;
    translucencyByDistance.z = compressedAttribute1.w;

    translucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;

    temp = compressedAttribute1.y * SHIFT_RIGHT8;
    translucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;
#endif

    ///////////////////////////////////////////////////////////////////////////

    vec4 color;
    vec4 outlineColor;
    vec4 pickColor;

    // compressedAttribute0.z => pickColor.rgb

    temp = compressedAttribute0.z * SHIFT_RIGHT8;
    pickColor.b = (temp - floor(temp)) * SHIFT_LEFT8;
    temp = floor(temp) * SHIFT_RIGHT8;
    pickColor.g = (temp - floor(temp)) * SHIFT_LEFT8;
    pickColor.r = floor(temp);

    // compressedAttribute0.x => color.rgb

    temp = compressedAttribute0.x * SHIFT_RIGHT8;
    color.b = (temp - floor(temp)) * SHIFT_LEFT8;
    temp = floor(temp) * SHIFT_RIGHT8;
    color.g = (temp - floor(temp)) * SHIFT_LEFT8;
    color.r = floor(temp);

    // compressedAttribute0.y => outlineColor.rgb

    temp = compressedAttribute0.y * SHIFT_RIGHT8;
    outlineColor.b = (temp - floor(temp)) * SHIFT_LEFT8;
    temp = floor(temp) * SHIFT_RIGHT8;
    outlineColor.g = (temp - floor(temp)) * SHIFT_LEFT8;
    outlineColor.r = floor(temp);

    // compressedAttribute0.w => color.a, outlineColor.a, pickColor.a

    temp = compressedAttribute0.w * SHIFT_RIGHT8;
    pickColor.a = (temp - floor(temp)) * SHIFT_LEFT8;
    pickColor = pickColor / 255.0;

    temp = floor(temp) * SHIFT_RIGHT8;
    outlineColor.a = (temp - floor(temp)) * SHIFT_LEFT8;
    outlineColor /= 255.0;
    color.a = floor(temp);
    color /= 255.0;

    ///////////////////////////////////////////////////////////////////////////

    vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);
    vec4 positionEC = czm_modelViewRelativeToEye * p;

    ///////////////////////////////////////////////////////////////////////////

#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(DISTANCE_DISPLAY_CONDITION) || defined(DISABLE_DEPTH_DISTANCE)
    float lengthSq;
    if (czm_sceneMode == czm_sceneMode2D)
    {
        // 2D camera distance is a special case
        // treat all billboards as flattened to the z=0.0 plane
        lengthSq = czm_eyeHeight2D.y;
    }
    else
    {
        lengthSq = dot(positionEC.xyz, positionEC.xyz);
    }
#endif

#ifdef EYE_DISTANCE_SCALING
    totalSize *= czm_nearFarScalar(scaleByDistance, lengthSq);
#endif
    if (totalSize > 0.0) {
        // Add padding for anti-aliasing on both sides.
        totalSize += 3.0;
    }

    // Clamp to max point size.
    totalSize = min(totalSize, u_maxTotalPointSize);
    // If size is too small, push vertex behind near plane for clipping.
    // Note that context.minimumAliasedPointSize "will be at most 1.0".
    if (totalSize < 1.0)
    {
        positionEC.xyz = vec3(0.0);
        totalSize = 1.0;
    }

    float translucency = 1.0;
#ifdef EYE_DISTANCE_TRANSLUCENCY
    translucency = czm_nearFarScalar(translucencyByDistance, lengthSq);
    // push vertex behind near plane for clipping
    if (translucency < 0.004)
    {
        positionEC.xyz = vec3(0.0);
    }
#endif

#ifdef DISTANCE_DISPLAY_CONDITION
    float nearSq = distanceDisplayConditionAndDisableDepthAndSplitDirection.x;
    float farSq = distanceDisplayConditionAndDisableDepthAndSplitDirection.y;
    if (lengthSq < nearSq || lengthSq > farSq) {
        // push vertex behind camera to force it to be clipped
        positionEC.xyz = vec3(0.0, 0.0, 1.0);
    }
#endif

    gl_Position = czm_projection * positionEC;
    czm_vertexLogDepth();

#ifdef DISABLE_DEPTH_DISTANCE
    float disableDepthTestDistance = distanceDisplayConditionAndDisableDepthAndSplitDirection.z;
    if (disableDepthTestDistance == 0.0 && czm_minimumDisableDepthTestDistance != 0.0)
    {
        disableDepthTestDistance = czm_minimumDisableDepthTestDistance;
    }

    if (disableDepthTestDistance != 0.0)
    {
        // Don't try to "multiply both sides" by w.  Greater/less-than comparisons won't work for negative values of w.
        float zclip = gl_Position.z / gl_Position.w;
        bool clipped = (zclip < -1.0 || zclip > 1.0);
        if (!clipped && (disableDepthTestDistance < 0.0 || (lengthSq > 0.0 && lengthSq < disableDepthTestDistance)))
        {
            // Position z on the near plane.
            gl_Position.z = -gl_Position.w;
#ifdef LOG_DEPTH
            czm_vertexLogDepth(vec4(czm_currentFrustum.x));
#endif
        }
    }
#endif

    v_color = color;
    v_color.a *= translucency * show;
    v_outlineColor = outlineColor;
    v_outlineColor.a *= translucency * show;

    v_innerPercent = 1.0 - outlinePercent;
    v_pixelDistance = 2.0 / totalSize;
    gl_PointSize = totalSize * show;
    gl_Position *= show;

    v_pickColor = pickColor;
    v_splitDirection = distanceDisplayConditionAndDisableDepthAndSplitDirection.w;
}
`;var YZe=Ws.SHOW_INDEX,Aj=Ws.POSITION_INDEX,kfe=Ws.COLOR_INDEX,XZe=Ws.OUTLINE_COLOR_INDEX,KZe=Ws.OUTLINE_WIDTH_INDEX,ZZe=Ws.PIXEL_SIZE_INDEX,Vfe=Ws.SCALE_BY_DISTANCE_INDEX,Ufe=Ws.TRANSLUCENCY_BY_DISTANCE_INDEX,zfe=Ws.DISTANCE_DISPLAY_CONDITION_INDEX,$Ze=Ws.DISABLE_DEPTH_DISTANCE_INDEX,QZe=Ws.SPLIT_DIRECTION_INDEX,Tj=Ws.NUMBER_OF_PROPERTIES,rc={positionHighAndSize:0,positionLowAndOutline:1,compressedAttribute0:2,compressedAttribute1:3,scaleByDistance:4,distanceDisplayConditionAndDisableDepthAndSplitDirection:5};function Of(e){e=x(e,x.EMPTY_OBJECT),this._sp=void 0,this._spTranslucent=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._propertiesChanged=new Uint32Array(Tj),this._maxPixelSize=1,this._baseVolume=new ae,this._baseVolumeWC=new ae,this._baseVolume2D=new ae,this._boundingVolume=new ae,this._boundingVolumeDirty=!1,this._colorCommands=[],this.show=x(e.show,!0),this.modelMatrix=F.clone(x(e.modelMatrix,F.IDENTITY)),this._modelMatrix=F.clone(F.IDENTITY),this.debugShowBoundingVolume=x(e.debugShowBoundingVolume,!1),this.blendOption=x(e.blendOption,Ro.OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=ne.SCENE3D,this._maxTotalPointSize=1,this._buffersUsage=[ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW,ke.STATIC_DRAW];let t=this;this._uniforms={u_maxTotalPointSize:function(){return t._maxTotalPointSize}}}Object.defineProperties(Of.prototype,{length:{get:function(){return Ej(this),this._pointPrimitives.length}}});function Hfe(e){let t=e.length;for(let n=0;n<t;++n)e[n]&&e[n]._destroy()}Of.prototype.add=function(e){let t=new Ws(e,this);return t._index=this._pointPrimitives.length,this._pointPrimitives.push(t),this._createVertexArray=!0,t};Of.prototype.remove=function(e){return this.contains(e)?(this._pointPrimitives[e._index]=null,this._pointPrimitivesRemoved=!0,this._createVertexArray=!0,e._destroy(),!0):!1};Of.prototype.removeAll=function(){Hfe(this._pointPrimitives),this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!0};function Ej(e){if(e._pointPrimitivesRemoved){e._pointPrimitivesRemoved=!1;let t=[],n=e._pointPrimitives,i=n.length;for(let o=0,r=0;o<i;++o){let s=n[o];s&&(s._index=r++,t.push(s))}e._pointPrimitives=t}}Of.prototype._updatePointPrimitive=function(e,t){e._dirty||(this._pointPrimitivesToUpdate[this._pointPrimitivesToUpdateIndex++]=e),++this._propertiesChanged[t]};Of.prototype.contains=function(e){return u(e)&&e._pointPrimitiveCollection===this};Of.prototype.get=function(e){return Ej(this),this._pointPrimitives[e]};Of.prototype.computeNewBuffersUsage=function(){let e=this._buffersUsage,t=!1,n=this._propertiesChanged;for(let i=0;i<Tj;++i){let o=n[i]===0?ke.STATIC_DRAW:ke.STREAM_DRAW;t=t||e[i]!==o,e[i]=o}return t};function JZe(e,t,n){return new G_(e,[{index:rc.positionHighAndSize,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:n[Aj]},{index:rc.positionLowAndShow,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:n[Aj]},{index:rc.compressedAttribute0,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:n[kfe]},{index:rc.compressedAttribute1,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:n[Ufe]},{index:rc.scaleByDistance,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:n[Vfe]},{index:rc.distanceDisplayConditionAndDisableDepthAndSplitDirection,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:n[zfe]}],t)}var bj=new Gn;function Gfe(e,t,n,i){let o=i._index,r=i._getActualPosition();e._mode===ne.SCENE3D&&(ae.expand(e._baseVolume,r,e._baseVolume),e._boundingVolumeDirty=!0),Gn.fromCartesian(r,bj);let s=i.pixelSize,a=i.outlineWidth;e._maxPixelSize=Math.max(e._maxPixelSize,s+a);let c=n[rc.positionHighAndSize],l=bj.high;c(o,l.x,l.y,l.z,s);let f=n[rc.positionLowAndOutline],d=bj.low;f(o,d.x,d.y,d.z,a)}var $3=65536,h1=256;function Wfe(e,t,n,i){let o=i._index,r=i.color,s=i.getPickId(t).color,a=i.outlineColor,c=G.floatToByte(r.red),l=G.floatToByte(r.green),f=G.floatToByte(r.blue),d=c*$3+l*h1+f;c=G.floatToByte(a.red),l=G.floatToByte(a.green),f=G.floatToByte(a.blue);let p=c*$3+l*h1+f;c=G.floatToByte(s.red),l=G.floatToByte(s.green),f=G.floatToByte(s.blue);let g=c*$3+l*h1+f,m=G.floatToByte(r.alpha)*$3+G.floatToByte(a.alpha)*h1+G.floatToByte(s.alpha),y=n[rc.compressedAttribute0];y(o,d,p,g,m)}function jfe(e,t,n,i){let o=i._index,r=0,s=1,a=1,c=1,l=i.translucencyByDistance;u(l)&&(r=l.near,s=l.nearValue,a=l.far,c=l.farValue,(s!==1||c!==1)&&(e._shaderTranslucencyByDistance=!0));let f=i.show&&i.clusterShow;i.color.alpha===0&&i.outlineColor.alpha===0&&(f=!1),s=R.clamp(s,0,1),s=s===1?255:s*255|0;let d=(f?1:0)*h1+s;c=R.clamp(c,0,1),c=c===1?255:c*255|0;let p=c,g=n[rc.compressedAttribute1];g(o,d,p,r,a)}function qfe(e,t,n,i){let o=i._index,r=n[rc.scaleByDistance],s=0,a=1,c=1,l=1,f=i.scaleByDistance;u(f)&&(s=f.near,a=f.nearValue,c=f.far,l=f.farValue,(a!==1||l!==1)&&(e._shaderScaleByDistance=!0)),r(o,s,a,c,l)}function Yfe(e,t,n,i){let o=i._index,r=n[rc.distanceDisplayConditionAndDisableDepthAndSplitDirection],s=0,a=Number.MAX_VALUE,c=i.distanceDisplayCondition;u(c)&&(s=c.near,a=c.far,s*=s,a*=a,e._shaderDistanceDisplayCondition=!0);let l=i.disableDepthTestDistance;l*=l,l>0&&(e._shaderDisableDepthDistance=!0,l===Number.POSITIVE_INFINITY&&(l=-1));let f=0,d=i.splitDirection;u(d)&&(f=d),r(o,s,a,l,f)}function e$e(e,t,n,i){Gfe(e,t,n,i),Wfe(e,t,n,i),jfe(e,t,n,i),qfe(e,t,n,i),Yfe(e,t,n,i)}function Cj(e,t,n,i,o,r){let s;i.mode===ne.SCENE3D?(s=e._baseVolume,e._boundingVolumeDirty=!0):s=e._baseVolume2D;let a=[];for(let c=0;c<n;++c){let l=t[c],f=l.position,d=Ws._computeActualPosition(f,i,o);u(d)&&(l._setActualPosition(d),r?a.push(d):ae.expand(s,d,s))}r&&ae.fromPoints(a,s)}function t$e(e,t){let n=t.mode,i=e._pointPrimitives,o=e._pointPrimitivesToUpdate,r=e._modelMatrix;e._createVertexArray||e._mode!==n||n!==ne.SCENE3D&&!F.equals(r,e.modelMatrix)?(e._mode=n,F.clone(e.modelMatrix,r),e._createVertexArray=!0,(n===ne.SCENE3D||n===ne.SCENE2D||n===ne.COLUMBUS_VIEW)&&Cj(e,i,i.length,t,r,!0)):n===ne.MORPHING?Cj(e,i,i.length,t,r,!0):(n===ne.SCENE2D||n===ne.COLUMBUS_VIEW)&&Cj(e,o,e._pointPrimitivesToUpdateIndex,t,r,!1)}function n$e(e,t,n){let o=t.camera.getPixelSize(n,t.context.drawingBufferWidth,t.context.drawingBufferHeight)*e._maxPixelSize;n.radius+=o}var i$e=[];Of.prototype.update=function(e){if(Ej(this),!this.show)return;this._maxTotalPointSize=Vt.maximumAliasedPointSize,t$e(this,e);let n=this._pointPrimitives.length,i=this._pointPrimitivesToUpdate,o=this._pointPrimitivesToUpdateIndex,r=this._propertiesChanged,s=this._createVertexArray,a,c=e.context,l=e.passes,f=l.pick;if(s||!f&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(let v=0;v<Tj;++v)r[v]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),n>0){this._vaf=JZe(c,n,this._buffersUsage),a=this._vaf.writers;for(let v=0;v<n;++v){let D=this._pointPrimitives[v];D._dirty=!1,e$e(this,c,a,D)}this._vaf.commit()}this._pointPrimitivesToUpdateIndex=0}else if(o>0){let v=i$e;v.length=0,(r[Aj]||r[KZe]||r[ZZe])&&v.push(Gfe),(r[kfe]||r[XZe])&&v.push(Wfe),(r[YZe]||r[Ufe])&&v.push(jfe),r[Vfe]&&v.push(qfe),(r[zfe]||r[$Ze]||r[QZe])&&v.push(Yfe);let D=v.length;if(a=this._vaf.writers,o/n>.1){for(let O=0;O<o;++O){let P=i[O];P._dirty=!1;for(let M=0;M<D;++M)v[M](this,c,a,P)}this._vaf.commit()}else{for(let O=0;O<o;++O){let P=i[O];P._dirty=!1;for(let M=0;M<D;++M)v[M](this,c,a,P);this._vaf.subCommit(P._index,1)}this._vaf.endSubCommits()}this._pointPrimitivesToUpdateIndex=0}if(o>n*1.5&&(i.length=n),!u(this._vaf)||!u(this._vaf.va))return;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,ae.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));let d,p=F.IDENTITY;e.mode===ne.SCENE3D?(p=this.modelMatrix,d=ae.clone(this._baseVolumeWC,this._boundingVolume)):d=ae.clone(this._baseVolume2D,this._boundingVolume),n$e(this,e,d);let g=this._blendOption!==this.blendOption;this._blendOption=this.blendOption,g&&(this._blendOption===Ro.OPAQUE||this._blendOption===Ro.OPAQUE_AND_TRANSLUCENT?this._rsOpaque=Ue.fromCache({depthTest:{enabled:!0,func:te.LEQUAL},depthMask:!0}):this._rsOpaque=void 0,this._blendOption===Ro.TRANSLUCENT||this._blendOption===Ro.OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=Ue.fromCache({depthTest:{enabled:!0,func:te.LEQUAL},depthMask:!1,blending:un.ALPHA_BLEND}):this._rsTranslucent=void 0),this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||e.minimumDisableDepthTestDistance!==0;let m,y;(g||this._shaderScaleByDistance&&!this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance&&!this._compiledShaderTranslucencyByDistance||this._shaderDistanceDisplayCondition&&!this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance)&&(m=new ze({sources:[Z3]}),this._shaderScaleByDistance&&m.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&m.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderDistanceDisplayCondition&&m.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&m.defines.push("DISABLE_DEPTH_DISTANCE"),this._blendOption===Ro.OPAQUE_AND_TRANSLUCENT&&(y=new ze({defines:["OPAQUE"],sources:[kx]}),this._sp=tn.replaceCache({context:c,shaderProgram:this._sp,vertexShaderSource:m,fragmentShaderSource:y,attributeLocations:rc}),y=new ze({defines:["TRANSLUCENT"],sources:[kx]}),this._spTranslucent=tn.replaceCache({context:c,shaderProgram:this._spTranslucent,vertexShaderSource:m,fragmentShaderSource:y,attributeLocations:rc})),this._blendOption===Ro.OPAQUE&&(y=new ze({sources:[kx]}),this._sp=tn.replaceCache({context:c,shaderProgram:this._sp,vertexShaderSource:m,fragmentShaderSource:y,attributeLocations:rc})),this._blendOption===Ro.TRANSLUCENT&&(y=new ze({sources:[kx]}),this._spTranslucent=tn.replaceCache({context:c,shaderProgram:this._spTranslucent,vertexShaderSource:m,fragmentShaderSource:y,attributeLocations:rc})),this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance);let b,C,A,T,E=e.commandList;if(l.render||f){let v=this._colorCommands,D=this._blendOption===Ro.OPAQUE,O=this._blendOption===Ro.OPAQUE_AND_TRANSLUCENT;b=this._vaf.va,C=b.length,v.length=C;let P=O?C*2:C;for(T=0;T<P;++T){let M=D||O&&T%2===0;A=v[T],u(A)||(A=v[T]=new Qe),A.primitiveType=Ne.POINTS,A.pass=M||!O?we.OPAQUE:we.TRANSLUCENT,A.owner=this;let L=O?Math.floor(T/2):T;A.boundingVolume=d,A.modelMatrix=p,A.shaderProgram=M?this._sp:this._spTranslucent,A.uniformMap=this._uniforms,A.vertexArray=b[L].va,A.renderState=M?this._rsOpaque:this._rsTranslucent,A.debugShowBoundingVolume=this.debugShowBoundingVolume,A.pickId="v_pickColor",E.push(A)}}};Of.prototype.isDestroyed=function(){return!1};Of.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),Hfe(this._pointPrimitives),ue(this)};var m1=Of;var Xfe=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Sj=1,p1=8,g1=class e{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[n,i]=new Uint8Array(t,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");let o=i>>4;if(o!==Sj)throw new Error(`Got v${o} data when expected v${Sj}.`);let r=Xfe[i&15];if(!r)throw new Error("Unrecognized array type.");let[s]=new Uint16Array(t,2,1),[a]=new Uint32Array(t,4,1);return new e(a,s,r,t)}constructor(t,n=64,i=Float64Array,o){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=i,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;let r=Xfe.indexOf(this.ArrayType),s=t*2*this.ArrayType.BYTES_PER_ELEMENT,a=t*this.IndexArrayType.BYTES_PER_ELEMENT,c=(8-a%8)%8;if(r<0)throw new Error(`Unexpected typed array class: ${i}.`);o&&o instanceof ArrayBuffer?(this.data=o,this.ids=new this.IndexArrayType(this.data,p1,t),this.coords=new this.ArrayType(this.data,p1+a+c,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(p1+s+a+c),this.ids=new this.IndexArrayType(this.data,p1,t),this.coords=new this.ArrayType(this.data,p1+a+c,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(Sj<<4)+r]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}add(t,n){let i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=t,this.coords[this._pos++]=n,i}finish(){let t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return wj(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,n,i,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:r,coords:s,nodeSize:a}=this,c=[0,r.length-1,0],l=[];for(;c.length;){let f=c.pop()||0,d=c.pop()||0,p=c.pop()||0;if(d-p<=a){for(let b=p;b<=d;b++){let C=s[2*b],A=s[2*b+1];C>=t&&C<=i&&A>=n&&A<=o&&l.push(r[b])}continue}let g=p+d>>1,m=s[2*g],y=s[2*g+1];m>=t&&m<=i&&y>=n&&y<=o&&l.push(r[g]),(f===0?t<=m:n<=y)&&(c.push(p),c.push(g-1),c.push(1-f)),(f===0?i>=m:o>=y)&&(c.push(g+1),c.push(d),c.push(1-f))}return l}within(t,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:o,coords:r,nodeSize:s}=this,a=[0,o.length-1,0],c=[],l=i*i;for(;a.length;){let f=a.pop()||0,d=a.pop()||0,p=a.pop()||0;if(d-p<=s){for(let b=p;b<=d;b++)Kfe(r[2*b],r[2*b+1],t,n)<=l&&c.push(o[b]);continue}let g=p+d>>1,m=r[2*g],y=r[2*g+1];Kfe(m,y,t,n)<=l&&c.push(o[g]),(f===0?t-i<=m:n-i<=y)&&(a.push(p),a.push(g-1),a.push(1-f)),(f===0?t+i>=m:n+i>=y)&&(a.push(g+1),a.push(d),a.push(1-f))}return c}};function wj(e,t,n,i,o,r){if(o-i<=n)return;let s=i+o>>1;Zfe(e,t,s,i,o,r),wj(e,t,n,i,s-1,1-r),wj(e,t,n,s+1,o,1-r)}function Zfe(e,t,n,i,o,r){for(;o>i;){if(o-i>600){let l=o-i+1,f=n-i+1,d=Math.log(l),p=.5*Math.exp(2*d/3),g=.5*Math.sqrt(d*p*(l-p)/l)*(f-l/2<0?-1:1),m=Math.max(i,Math.floor(n-f*p/l+g)),y=Math.min(o,Math.floor(n+(l-f)*p/l+g));Zfe(e,t,n,m,y,r)}let s=t[2*n+r],a=i,c=o;for(_1(e,t,i,n),t[2*o+r]>s&&_1(e,t,i,o);a<c;){for(_1(e,t,a,c),a++,c--;t[2*a+r]<s;)a++;for(;t[2*c+r]>s;)c--}t[2*i+r]===s?_1(e,t,i,c):(c++,_1(e,t,c,o)),c<=n&&(i=c+1),n<=c&&(o=c-1)}}function _1(e,t,n,i){vj(e,n,i),vj(t,2*n,2*i),vj(t,2*n+1,2*i+1)}function vj(e,t,n){let i=e[t];e[t]=e[n],e[n]=i}function Kfe(e,t,n,i){let o=e-n,r=t-i;return o*o+r*r}function Nd(e){e=x(e,x.EMPTY_OBJECT),this._enabled=x(e.enabled,!1),this._pixelRange=x(e.pixelRange,80),this._minimumClusterSize=x(e.minimumClusterSize,2),this._clusterBillboards=x(e.clusterBillboards,!0),this._clusterLabels=x(e.clusterLabels,!0),this._clusterPoints=x(e.clusterPoints,!0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity={},this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._clusterDirty=!1,this._cluster=void 0,this._removeEventListener=void 0,this._clusterEvent=new me,this.show=x(e.show,!0)}function $fe(e,t){e.x-=t,e.y-=t,e.width+=t*2,e.height+=t*2}var o$e=new qe;function Qfe(e,t,n,i,o){if(u(e._labelCollection)&&i._clusterLabels?o=vx.getScreenSpaceBoundingBox(e,t,o):u(e._billboardCollection)&&i._clusterBillboards?o=po.getScreenSpaceBoundingBox(e,t,o):u(e._pointPrimitiveCollection)&&i._clusterPoints&&(o=Ws.getScreenSpaceBoundingBox(e,t,o)),$fe(o,n),i._clusterLabels&&!u(e._labelCollection)&&u(e.id)&&ede(i,e.id.id)&&u(e.id._label)){let r=i._collectionIndicesByEntity[e.id.id].labelIndex,s=i._labelCollection.get(r),a=vx.getScreenSpaceBoundingBox(s,t,o$e);$fe(a,n),o=qe.union(o,a,o)}return o}function r$e(e,t){if(e.clusterShow=!0,!u(e._labelCollection)&&u(e.id)&&ede(t,e.id.id)&&u(e.id._label)){let n=t._collectionIndicesByEntity[e.id.id].labelIndex,i=t._labelCollection.get(n);i.clusterShow=!0}}function Jfe(e,t,n,i){let o={billboard:i._clusterBillboardCollection.add(),label:i._clusterLabelCollection.add(),point:i._clusterPointCollection.add()};o.billboard.show=!1,o.point.show=!1,o.label.show=!0,o.label.text=t.toLocaleString(),o.label.id=n,o.billboard.position=o.label.position=o.point.position=e,i._clusterEvent.raiseEvent(n,o)}function ede(e,t){return u(e)&&u(e._collectionIndicesByEntity[t])&&u(e._collectionIndicesByEntity[t].labelIndex)}function Dj(e,t,n,i,o){if(!u(e))return;let r=e.length;for(let s=0;s<r;++s){let a=e.get(s);if(a.clusterShow=!1,!a.show||o._scene.mode===ne.SCENE3D&&!i.isPointVisible(a.position))continue;let c=o._clusterLabels&&u(a._labelCollection),l=o._clusterBillboards&&u(a.id._billboard),f=o._clusterPoints&&u(a.id._point);if(c&&(f||l))continue;let d=a.computeScreenSpacePosition(n);u(d)&&t.push({index:s,collection:e,clustered:!1,coord:d})}}var s$e=new qe,a$e=new qe,c$e=new qe;function l$e(e){return function(t){if(u(t)&&t<.05||!e.enabled)return;let n=e._scene,i=e._labelCollection,o=e._billboardCollection,r=e._pointCollection;if(!u(i)&&!u(o)&&!u(r)||!e._clusterBillboards&&!e._clusterLabels&&!e._clusterPoints)return;let s=e._clusterLabelCollection,a=e._clusterBillboardCollection,c=e._clusterPointCollection;u(s)?s.removeAll():s=e._clusterLabelCollection=new Lp({scene:n}),u(a)?a.removeAll():a=e._clusterBillboardCollection=new Cf({scene:n}),u(c)?c.removeAll():c=e._clusterPointCollection=new m1;let l=e._pixelRange,f=e._minimumClusterSize,d=e._previousClusters,p=[],g=e._previousHeight,m=n.camera.positionCartographic.height,y=n.ellipsoid,b=n.camera.positionWC,C=new i0(y,b),A=[];e._clusterLabels&&Dj(i,A,n,C,e),e._clusterBillboards&&Dj(o,A,n,C,e),e._clusterPoints&&Dj(r,A,n,C,e);let T,E,v,D,O,P,M,L,_,S,w,I;if(A.length>0){let N=new g1(A.length,64,Uint32Array);for(let k=0;k<A.length;++k)N.add(A[k].coord.x,A[k].coord.y);if(N.finish(),m<g)for(v=d.length,T=0;T<v;++T){let k=d[T];if(!C.isPointVisible(k.position))continue;let z=po._computeScreenSpacePosition(F.IDENTITY,k.position,h.ZERO,H.ZERO,n);if(!u(z))continue;let V=1-m/g,U=k.width=k.width*V,B=k.height=k.height*V;U=Math.max(U,k.minimumWidth),B=Math.max(B,k.minimumHeight);let W=z.x-U*.5,j=z.y-B*.5,Q=z.x+U,q=z.y+B;for(O=N.range(W,j,Q,q),P=O.length,S=0,_=[],E=0;E<P;++E)M=O[E],L=A[M],L.clustered||(++S,w=L.collection,I=L.index,_.push(w.get(I).id));if(S>=f)for(Jfe(k.position,S,_,e),p.push(k),E=0;E<P;++E)A[O[E]].clustered=!0}for(v=A.length,T=0;T<v;++T){let k=A[T];if(k.clustered)continue;k.clustered=!0,w=k.collection,I=k.index;let z=w.get(I);D=Qfe(z,k.coord,l,e,s$e);let V=qe.clone(D,a$e);O=N.range(D.x,D.y,D.x+D.width,D.y+D.height),P=O.length;let U=h.clone(z.position);for(S=1,_=[z.id],E=0;E<P;++E)if(M=O[E],L=A[M],!L.clustered){let B=L.collection.get(L.index),W=Qfe(B,L.coord,l,e,c$e);h.add(B.position,U,U),qe.union(V,W,V),++S,_.push(B.id)}if(S>=f){let B=h.multiplyByScalar(U,1/S,U);for(Jfe(B,S,_,e),p.push({position:B,width:V.width,height:V.height,minimumWidth:D.width,minimumHeight:D.height}),E=0;E<P;++E)A[O[E]].clustered=!0}else r$e(z,e)}}s.length===0&&(s.destroy(),e._clusterLabelCollection=void 0),a.length===0&&(a.destroy(),e._clusterBillboardCollection=void 0),c.length===0&&(c.destroy(),e._clusterPointCollection=void 0),e._previousClusters=p,e._previousHeight=m}}Nd.prototype._initialize=function(e){this._scene=e;let t=l$e(this);this._cluster=t,this._removeEventListener=e.camera.changed.addEventListener(t)};Object.defineProperties(Nd.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this._enabledDirty=e!==this._enabled,this._enabled=e}},pixelRange:{get:function(){return this._pixelRange},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._pixelRange,this._pixelRange=e}},minimumClusterSize:{get:function(){return this._minimumClusterSize},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._minimumClusterSize,this._minimumClusterSize=e}},clusterEvent:{get:function(){return this._clusterEvent}},clusterBillboards:{get:function(){return this._clusterBillboards},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterBillboards,this._clusterBillboards=e}},clusterLabels:{get:function(){return this._clusterLabels},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterLabels,this._clusterLabels=e}},clusterPoints:{get:function(){return this._clusterPoints},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterPoints,this._clusterPoints=e}}});function Pj(e,t,n,i){return function(o){let r=this[e];u(this._collectionIndicesByEntity)||(this._collectionIndicesByEntity={});let s=this._collectionIndicesByEntity[o.id];if(u(s)||(s=this._collectionIndicesByEntity[o.id]={billboardIndex:void 0,labelIndex:void 0,pointIndex:void 0}),u(r)&&u(s[i]))return r.get(s[i]);u(r)||(r=this[e]=new t({scene:this._scene}));let a,c,l=this[n];l.length>0?(a=l.shift(),c=r.get(a)):(c=r.add(),a=r.length-1),s[i]=a;let f=this;return Promise.resolve().then(function(){f._clusterDirty=!0}),c}}function Rj(e,t){let n=e._collectionIndicesByEntity[t];!u(n.billboardIndex)&&!u(n.labelIndex)&&!u(n.pointIndex)&&delete e._collectionIndicesByEntity[t]}Nd.prototype.getLabel=Pj("_labelCollection",Lp,"_unusedLabelIndices","labelIndex");Nd.prototype.removeLabel=function(e){let t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!u(this._labelCollection)||!u(t)||!u(t.labelIndex))return;let n=t.labelIndex;t.labelIndex=void 0,Rj(this,e.id);let i=this._labelCollection.get(n);i.show=!1,i.text="",i.id=void 0,this._unusedLabelIndices.push(n),this._clusterDirty=!0};Nd.prototype.getBillboard=Pj("_billboardCollection",Cf,"_unusedBillboardIndices","billboardIndex");Nd.prototype.removeBillboard=function(e){let t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!u(this._billboardCollection)||!u(t)||!u(t.billboardIndex))return;let n=t.billboardIndex;t.billboardIndex=void 0,Rj(this,e.id);let i=this._billboardCollection.get(n);i.id=void 0,i.show=!1,i.image=void 0,this._unusedBillboardIndices.push(n),this._clusterDirty=!0};Nd.prototype.getPoint=Pj("_pointCollection",m1,"_unusedPointIndices","pointIndex");Nd.prototype.removePoint=function(e){let t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!u(this._pointCollection)||!u(t)||!u(t.pointIndex))return;let n=t.pointIndex;t.pointIndex=void 0,Rj(this,e.id);let i=this._pointCollection.get(n);i.show=!1,i.id=void 0,this._unusedPointIndices.push(n),this._clusterDirty=!0};function Ij(e){if(!u(e))return;let t=e.length;for(let n=0;n<t;++n)e.get(n).clusterShow=!0}function u$e(e){e.enabled||(u(e._clusterLabelCollection)&&e._clusterLabelCollection.destroy(),u(e._clusterBillboardCollection)&&e._clusterBillboardCollection.destroy(),u(e._clusterPointCollection)&&e._clusterPointCollection.destroy(),e._clusterLabelCollection=void 0,e._clusterBillboardCollection=void 0,e._clusterPointCollection=void 0,Ij(e._labelCollection),Ij(e._billboardCollection),Ij(e._pointCollection))}Nd.prototype.update=function(e){if(!this.show)return;let t;u(this._labelCollection)&&this._labelCollection.length>0&&this._labelCollection.get(0)._glyphs.length===0&&(t=e.commandList,e.commandList=[],this._labelCollection.update(e),e.commandList=t),u(this._billboardCollection)&&this._billboardCollection.length>0&&!u(this._billboardCollection.get(0).width)&&(t=e.commandList,e.commandList=[],this._billboardCollection.update(e),e.commandList=t),this._enabledDirty&&(this._enabledDirty=!1,u$e(this),this._clusterDirty=!0),this._clusterDirty&&(this._clusterDirty=!1,this._cluster()),u(this._clusterLabelCollection)&&this._clusterLabelCollection.update(e),u(this._clusterBillboardCollection)&&this._clusterBillboardCollection.update(e),u(this._clusterPointCollection)&&this._clusterPointCollection.update(e),u(this._labelCollection)&&this._labelCollection.update(e),u(this._billboardCollection)&&this._billboardCollection.update(e),u(this._pointCollection)&&this._pointCollection.update(e)};Nd.prototype.destroy=function(){this._labelCollection=this._labelCollection&&this._labelCollection.destroy(),this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),this._pointCollection=this._pointCollection&&this._pointCollection.destroy(),this._clusterLabelCollection=this._clusterLabelCollection&&this._clusterLabelCollection.destroy(),this._clusterBillboardCollection=this._clusterBillboardCollection&&this._clusterBillboardCollection.destroy(),this._clusterPointCollection=this._clusterPointCollection&&this._clusterPointCollection.destroy(),u(this._removeEventListener)&&(this._removeEventListener(),this._removeEventListener=void 0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity=void 0,this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._pixelRangeDirty=!1,this._minimumClusterSizeDirty=!1};var Mf=Nd;function Oj(e){this._name=e,this._clock=void 0,this._changed=new me,this._error=new me,this._isLoading=!1,this._loading=new me,this._entityCollection=new la(this),this._entityCluster=new Mf}Object.defineProperties(Oj.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{get:function(){return this._clock},set:function(e){this._clock!==e&&(this._clock=e,this._changed.raiseEvent(this))}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading},set:function(e){Kr.setLoading(this,e)}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}}});Oj.prototype.update=function(e){return!0};var Q3=Oj;var tde={};tde.computePositions=function(e,t,n,i,o){let r=e*.5,s=-r,a=i+i,c=o?2*a:a,l=new Float64Array(c*3),f,d=0,p=0,g=o?a*3:0,m=o?(a+i)*3:i*3;for(f=0;f<i;f++){let y=f/i*R.TWO_PI,b=Math.cos(y),C=Math.sin(y),A=b*n,T=C*n,E=b*t,v=C*t;l[p+g]=A,l[p+g+1]=T,l[p+g+2]=s,l[p+m]=E,l[p+m+1]=v,l[p+m+2]=r,p+=3,o&&(l[d++]=A,l[d++]=T,l[d++]=s,l[d++]=E,l[d++]=v,l[d++]=r)}return l};var bT=tde;var Mj=new H,f$e=new h,d$e=new h,h$e=new h,m$e=new h;function $p(e){e=x(e,x.EMPTY_OBJECT);let t=e.length,n=e.topRadius,i=e.bottomRadius,o=x(e.vertexFormat,Ie.DEFAULT),r=x(e.slices,128);this._length=t,this._topRadius=n,this._bottomRadius=i,this._vertexFormat=Ie.clone(o),this._slices=r,this._offsetAttribute=e.offsetAttribute,this._workerName="createCylinderGeometry"}$p.packedLength=Ie.packedLength+5;$p.pack=function(e,t,n){return n=x(n,0),Ie.pack(e._vertexFormat,t,n),n+=Ie.packedLength,t[n++]=e._length,t[n++]=e._topRadius,t[n++]=e._bottomRadius,t[n++]=e._slices,t[n]=x(e._offsetAttribute,-1),t};var nde=new Ie,CT={vertexFormat:nde,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};$p.unpack=function(e,t,n){t=x(t,0);let i=Ie.unpack(e,t,nde);t+=Ie.packedLength;let o=e[t++],r=e[t++],s=e[t++],a=e[t++],c=e[t];return u(n)?(n._vertexFormat=Ie.clone(i,n._vertexFormat),n._length=o,n._topRadius=r,n._bottomRadius=s,n._slices=a,n._offsetAttribute=c===-1?void 0:c,n):(CT.length=o,CT.topRadius=r,CT.bottomRadius=s,CT.slices=a,CT.offsetAttribute=c===-1?void 0:c,new $p(CT))};$p.createGeometry=function(e){let t=e._length,n=e._topRadius,i=e._bottomRadius,o=e._vertexFormat,r=e._slices;if(t<=0||n<0||i<0||n===0&&i===0)return;let s=r+r,a=r+s,c=s+s,l=bT.computePositions(t,n,i,r,!0),f=o.st?new Float32Array(c*2):void 0,d=o.normal?new Float32Array(c*3):void 0,p=o.tangent?new Float32Array(c*3):void 0,g=o.bitangent?new Float32Array(c*3):void 0,m,y=o.normal||o.tangent||o.bitangent;if(y){let O=o.tangent||o.bitangent,P=0,M=0,L=0,_=Math.atan2(i-n,t),S=f$e;S.z=Math.sin(_);let w=Math.cos(_),I=h$e,N=d$e;for(m=0;m<r;m++){let k=m/r*R.TWO_PI,z=w*Math.cos(k),V=w*Math.sin(k);y&&(S.x=z,S.y=V,O&&(I=h.normalize(h.cross(h.UNIT_Z,S,I),I)),o.normal&&(d[P++]=S.x,d[P++]=S.y,d[P++]=S.z,d[P++]=S.x,d[P++]=S.y,d[P++]=S.z),o.tangent&&(p[M++]=I.x,p[M++]=I.y,p[M++]=I.z,p[M++]=I.x,p[M++]=I.y,p[M++]=I.z),o.bitangent&&(N=h.normalize(h.cross(S,I,N),N),g[L++]=N.x,g[L++]=N.y,g[L++]=N.z,g[L++]=N.x,g[L++]=N.y,g[L++]=N.z))}for(m=0;m<r;m++)o.normal&&(d[P++]=0,d[P++]=0,d[P++]=-1),o.tangent&&(p[M++]=1,p[M++]=0,p[M++]=0),o.bitangent&&(g[L++]=0,g[L++]=-1,g[L++]=0);for(m=0;m<r;m++)o.normal&&(d[P++]=0,d[P++]=0,d[P++]=1),o.tangent&&(p[M++]=1,p[M++]=0,p[M++]=0),o.bitangent&&(g[L++]=0,g[L++]=1,g[L++]=0)}let b=12*r-12,C=Be.createTypedArray(c,b),A=0,T=0;for(m=0;m<r-1;m++)C[A++]=T,C[A++]=T+2,C[A++]=T+3,C[A++]=T,C[A++]=T+3,C[A++]=T+1,T+=2;for(C[A++]=s-2,C[A++]=0,C[A++]=1,C[A++]=s-2,C[A++]=1,C[A++]=s-1,m=1;m<r-1;m++)C[A++]=s+m+1,C[A++]=s+m,C[A++]=s;for(m=1;m<r-1;m++)C[A++]=a,C[A++]=a+m,C[A++]=a+m+1;let E=0;if(o.st){let O=Math.max(n,i);for(m=0;m<c;m++){let P=h.fromArray(l,m*3,m$e);f[E++]=(P.x+O)/(2*O),f[E++]=(P.y+O)/(2*O)}}let v=new hn;o.position&&(v.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:l})),o.normal&&(v.normal=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:d})),o.tangent&&(v.tangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:p})),o.bitangent&&(v.bitangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:g})),o.st&&(v.st=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:f})),Mj.x=t*.5,Mj.y=Math.max(i,n);let D=new ae(h.ZERO,H.magnitude(Mj));if(u(e._offsetAttribute)){t=l.length;let O=e._offsetAttribute===an.NONE?0:1,P=new Uint8Array(t/3).fill(O);v.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:P})}return new ft({attributes:v,indices:C,primitiveType:Ne.TRIANGLES,boundingSphere:D,offsetAttribute:e._offsetAttribute})};var Lj;$p.getUnitCylinder=function(){return u(Lj)||(Lj=$p.createGeometry(new $p({topRadius:1,bottomRadius:1,length:1,vertexFormat:Ie.POSITION_ONLY}))),Lj};var J3=$p;var Nj=new H;function AT(e){e=x(e,x.EMPTY_OBJECT);let t=e.length,n=e.topRadius,i=e.bottomRadius,o=x(e.slices,128),r=Math.max(x(e.numberOfVerticalLines,16),0);this._length=t,this._topRadius=n,this._bottomRadius=i,this._slices=o,this._numberOfVerticalLines=r,this._offsetAttribute=e.offsetAttribute,this._workerName="createCylinderOutlineGeometry"}AT.packedLength=6;AT.pack=function(e,t,n){return n=x(n,0),t[n++]=e._length,t[n++]=e._topRadius,t[n++]=e._bottomRadius,t[n++]=e._slices,t[n++]=e._numberOfVerticalLines,t[n]=x(e._offsetAttribute,-1),t};var Vx={length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,numberOfVerticalLines:void 0,offsetAttribute:void 0};AT.unpack=function(e,t,n){t=x(t,0);let i=e[t++],o=e[t++],r=e[t++],s=e[t++],a=e[t++],c=e[t];return u(n)?(n._length=i,n._topRadius=o,n._bottomRadius=r,n._slices=s,n._numberOfVerticalLines=a,n._offsetAttribute=c===-1?void 0:c,n):(Vx.length=i,Vx.topRadius=o,Vx.bottomRadius=r,Vx.slices=s,Vx.numberOfVerticalLines=a,Vx.offsetAttribute=c===-1?void 0:c,new AT(Vx))};AT.createGeometry=function(e){let t=e._length,n=e._topRadius,i=e._bottomRadius,o=e._slices,r=e._numberOfVerticalLines;if(t<=0||n<0||i<0||n===0&&i===0)return;let s=o*2,a=bT.computePositions(t,n,i,o,!1),c=o*2,l;if(r>0){let y=Math.min(r,o);l=Math.round(o/y),c+=y}let f=Be.createTypedArray(s,c*2),d=0,p;for(p=0;p<o-1;p++)f[d++]=p,f[d++]=p+1,f[d++]=p+o,f[d++]=p+1+o;if(f[d++]=o-1,f[d++]=0,f[d++]=o+o-1,f[d++]=o,r>0)for(p=0;p<o;p+=l)f[d++]=p,f[d++]=p+o;let g=new hn;g.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:a}),Nj.x=t*.5,Nj.y=Math.max(i,n);let m=new ae(h.ZERO,H.magnitude(Nj));if(u(e._offsetAttribute)){t=a.length;let y=e._offsetAttribute===an.NONE?0:1,b=new Uint8Array(t/3).fill(y);g.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:b})}return new ft({attributes:g,indices:f,primitiveType:Ne.LINES,boundingSphere:m,offsetAttribute:e._offsetAttribute})};var ek=AT;var ide=h.ZERO,ode=new h,p$e=new h,rde=new G;function _$e(e){this.id=e,this.vertexFormat=void 0,this.length=void 0,this.topRadius=void 0,this.bottomRadius=void 0,this.slices=void 0,this.numberOfVerticalLines=void 0,this.offsetAttribute=void 0}function hu(e,t){ri.call(this,{entity:e,scene:t,geometryOptions:new _$e(e),geometryPropertyName:"cylinder",observedPropertyNames:["availability","position","orientation","cylinder"]}),this._onEntityPropertyChanged(e,"cylinder",e.cylinder,void 0)}u(Object.create)&&(hu.prototype=Object.create(ri.prototype),hu.prototype.constructor=hu);Object.defineProperties(hu.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}});hu.prototype.createFillGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i=new yn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),r=kn.fromDistanceDisplayCondition(o),s={show:i,distanceDisplayCondition:r,color:void 0,offset:void 0};if(this._materialProperty instanceof Ht){let a;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(a=this._materialProperty.color.getValue(e,rde)),u(a)||(a=G.WHITE),s.color=jt.fromColor(a)}return u(this._options.offsetAttribute)&&(s.offset=to.fromCartesian3(Y.getValueOrDefault(this._terrainOffsetProperty,e,ide,ode))),new vt({id:t,geometry:new J3(this._options),modelMatrix:t.computeModelMatrixForHeightReference(e,t.cylinder.heightReference,this._options.length*.5,this._scene.ellipsoid),attributes:s})};hu.prototype.createOutlineGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i=Y.getValueOrDefault(this._outlineColorProperty,e,G.BLACK,rde),o=this._distanceDisplayConditionProperty.getValue(e),r={show:new yn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:jt.fromColor(i),distanceDisplayCondition:kn.fromDistanceDisplayCondition(o),offset:void 0};return u(this._options.offsetAttribute)&&(r.offset=to.fromCartesian3(Y.getValueOrDefault(this._terrainOffsetProperty,e,ide,ode))),new vt({id:t,geometry:new ek(this._options),modelMatrix:t.computeModelMatrixForHeightReference(e,t.cylinder.heightReference,this._options.length*.5,this._scene.ellipsoid),attributes:r})};hu.prototype._computeCenter=function(e,t){return Y.getValueOrUndefined(this._entity.position,e,t)};hu.prototype._isHidden=function(e,t){return!u(e.position)||!u(t.length)||!u(t.topRadius)||!u(t.bottomRadius)||ri.prototype._isHidden.call(this,e,t)};hu.prototype._isDynamic=function(e,t){return!e.position.isConstant||!Y.isConstant(e.orientation)||!t.length.isConstant||!t.topRadius.isConstant||!t.bottomRadius.isConstant||!Y.isConstant(t.slices)||!Y.isConstant(t.outlineWidth)||!Y.isConstant(t.numberOfVerticalLines)};hu.prototype._setStaticOptions=function(e,t){let n=Y.getValueOrDefault(t.heightReference,He.MINIMUM_VALUE,Xe.NONE),i=this._options;i.vertexFormat=this._materialProperty instanceof Ht?ln.VERTEX_FORMAT:ho.MaterialSupport.TEXTURED.vertexFormat,i.length=t.length.getValue(He.MINIMUM_VALUE),i.topRadius=t.topRadius.getValue(He.MINIMUM_VALUE),i.bottomRadius=t.bottomRadius.getValue(He.MINIMUM_VALUE),i.slices=Y.getValueOrUndefined(t.slices,He.MINIMUM_VALUE),i.numberOfVerticalLines=Y.getValueOrUndefined(t.numberOfVerticalLines,He.MINIMUM_VALUE),i.offsetAttribute=n!==Xe.NONE?an.ALL:void 0};hu.prototype._onEntityPropertyChanged=J_;hu.DynamicGeometryUpdater=TT;function TT(e,t,n){oi.call(this,e,t,n)}u(Object.create)&&(TT.prototype=Object.create(oi.prototype),TT.prototype.constructor=TT);TT.prototype._isHidden=function(e,t,n){let i=this._options,o=Y.getValueOrUndefined(e.position,n,p$e);return!u(o)||!u(i.length)||!u(i.topRadius)||!u(i.bottomRadius)||oi.prototype._isHidden.call(this,e,t,n)};TT.prototype._setOptions=function(e,t,n){let i=Y.getValueOrDefault(t.heightReference,n,Xe.NONE),o=this._options;o.length=Y.getValueOrUndefined(t.length,n),o.topRadius=Y.getValueOrUndefined(t.topRadius,n),o.bottomRadius=Y.getValueOrUndefined(t.bottomRadius,n),o.slices=Y.getValueOrUndefined(t.slices,n),o.numberOfVerticalLines=Y.getValueOrUndefined(t.numberOfVerticalLines,n),o.offsetAttribute=i!==Xe.NONE?an.ALL:void 0};var tk=hu;var g$e={UNBOUNDED:0,CLAMPED:1,LOOP_STOP:2},Zr=Object.freeze(g$e);var y$e={TICK_DEPENDENT:0,SYSTEM_CLOCK_MULTIPLIER:1,SYSTEM_CLOCK:2},Ao=Object.freeze(y$e);var x$e={NONE:0,HOLD:1,EXTRAPOLATE:2},Lf=Object.freeze(x$e);var sde=Dr(Gl(),1);function b$e(e){let t=new sde.default(e);t.normalize();let n=t.path(),i=n.lastIndexOf("/");return i!==-1&&(n=n.substr(i+1)),n}var o0=b$e;var C$e=R.factorial;function Fj(e,t,n,i,o,r){let s=0,a,c,l;if(i>0){for(c=0;c<o;c++){for(a=!1,l=0;l<r.length&&!a;l++)c===r[l]&&(a=!0);a||(r.push(c),s+=Fj(e,t,n,i-1,o,r),r.splice(r.length-1,1))}return s}for(s=1,c=0;c<o;c++){for(a=!1,l=0;l<r.length&&!a;l++)c===r[l]&&(a=!0);a||(s*=e-n[t[c]])}return s}var nk={type:"Hermite"};nk.getRequiredDataPoints=function(e,t){return t=x(t,0),Math.max(Math.floor((e+1)/(t+1)),2)};nk.interpolateOrderZero=function(e,t,n,i,o){u(o)||(o=new Array(i));let r,s,a,c,l,f,d=t.length,p=new Array(i);for(r=0;r<i;r++){o[r]=0;let b=new Array(d);for(p[r]=b,s=0;s<d;s++)b[s]=[]}let g=d,m=new Array(g);for(r=0;r<g;r++)m[r]=r;let y=d-1;for(c=0;c<i;c++){for(s=0;s<g;s++)f=m[s]*i+c,p[c][0].push(n[f]);for(r=1;r<g;r++){let b=!1;for(s=0;s<g-r;s++){let C=t[m[s]],A=t[m[s+r]],T;A-C<=0?(f=m[s]*i+i*r+c,T=n[f],p[c][r].push(T/C$e(r))):(T=p[c][r-1][s+1]-p[c][r-1][s],p[c][r].push(T/(A-C))),b=b||T!==0}b||(y=r-1)}}for(a=0,l=0;a<=l;a++)for(r=a;r<=y;r++){let b=Fj(e,m,t,a,r,[]);for(c=0;c<i;c++){let C=p[c][r][0];o[c+a*i]+=C*b}}return o};var A$e=[];nk.interpolate=function(e,t,n,i,o,r,s){let a=i*(r+1);u(s)||(s=new Array(a));for(let C=0;C<a;C++)s[C]=0;let c=t.length,l=new Array(c*(o+1)),f;for(f=0;f<c;f++)for(let C=0;C<o+1;C++)l[f*(o+1)+C]=f;let d=l.length,p=A$e,g=T$e(p,l,t,n,i,o),m=[],y=d*(d+1)/2,b=Math.min(g,r);for(let C=0;C<=b;C++)for(f=C;f<=g;f++){m.length=0;let A=Fj(e,l,t,C,f,m),T=Math.floor(f*(1-f)/2)+d*f;for(let E=0;E<i;E++){let v=Math.floor(E*y),D=p[v+T];s[E+C*i]+=D*A}}return s};function T$e(e,t,n,i,o,r){let s,a,c=-1,l=t.length,f=l*(l+1)/2;for(let d=0;d<o;d++){let p=Math.floor(d*f);for(s=0;s<l;s++)a=t[s]*o*(r+1)+d,e[p+s]=i[a];for(let g=1;g<l;g++){let m=0,y=Math.floor(g*(1-g)/2)+l*g,b=!1;for(s=0;s<l-g;s++){let C=n[t[s]],A=n[t[s+g]],T,E;if(A-C<=0)a=t[s]*o*(r+1)+o*g+d,T=i[a],E=T/R.factorial(g),e[p+y+m]=E,m++;else{let v=Math.floor((g-1)*(2-g)/2)+l*(g-1);T=e[p+v+s+1]-e[p+v+s],E=T/(A-C),e[p+y+m]=E,m++}b=b||T!==0}b&&(c=Math.max(c,g))}}return c}var ik=nk;var Bj={type:"Lagrange"};Bj.getRequiredDataPoints=function(e){return Math.max(e+1,2)};Bj.interpolateOrderZero=function(e,t,n,i,o){u(o)||(o=new Array(i));let r,s,a=t.length;for(r=0;r<i;r++)o[r]=0;for(r=0;r<a;r++){let c=1;for(s=0;s<a;s++)if(s!==r){let l=t[r]-t[s];c*=(e-t[s])/l}for(s=0;s<i;s++)o[s]+=c*n[r*i+s]}return o};var ok=Bj;var kj={type:"Linear"};kj.getRequiredDataPoints=function(e){return 2};kj.interpolateOrderZero=function(e,t,n,i,o){u(o)||(o=new Array(i));let r,s,a,c=t[0],l=t[1];for(r=0;r<i;r++)s=n[r],a=n[r+i],o[r]=((a-s)*e+l*s-c*a)/(l-c);return o};var ET=kj;function sc(e,t,n){this.clock=x(e,0),this.cone=x(t,0),this.magnitude=x(n,1)}sc.fromCartesian3=function(e,t){let n=e.x,i=e.y,o=e.z,r=n*n+i*i;return u(t)||(t=new sc),t.clock=Math.atan2(i,n),t.cone=Math.atan2(Math.sqrt(r),o),t.magnitude=Math.sqrt(r+o*o),t};sc.clone=function(e,t){if(u(e))return u(t)?(t.clock=e.clock,t.cone=e.cone,t.magnitude=e.magnitude,t):new sc(e.clock,e.cone,e.magnitude)};sc.normalize=function(e,t){return u(t)?(t.clock=e.clock,t.cone=e.cone,t.magnitude=1,t):new sc(e.clock,e.cone,1)};sc.equals=function(e,t){return e===t||u(e)&&u(t)&&e.clock===t.clock&&e.cone===t.cone&&e.magnitude===t.magnitude};sc.equalsEpsilon=function(e,t,n){return n=x(n,0),e===t||u(e)&&u(t)&&Math.abs(e.clock-t.clock)<=n&&Math.abs(e.cone-t.cone)<=n&&Math.abs(e.magnitude-t.magnitude)<=n};sc.prototype.equals=function(e){return sc.equals(this,e)};sc.prototype.clone=function(e){return sc.clone(this,e)};sc.prototype.equalsEpsilon=function(e,t){return sc.equalsEpsilon(this,e,t)};sc.prototype.toString=function(){return`(${this.clock}, ${this.cone}, ${this.magnitude})`};var rk=sc;var D1=Dr(Gl(),1);var Vj;typeof performance<"u"&&typeof performance.now=="function"&&isFinite(performance.now())?Vj=function(){return performance.now()}:Vj=function(){return Date.now()};var Ei=Vj;function Uj(e){e=x(e,x.EMPTY_OBJECT);let t=e.currentTime,n=e.startTime,i=e.stopTime;u(t)?t=$.clone(t):u(n)?t=$.clone(n):u(i)?t=$.addDays(i,-1,new $):t=$.now(),u(n)?n=$.clone(n):n=$.clone(t),u(i)?i=$.clone(i):i=$.addDays(n,1,new $),this.startTime=n,this.stopTime=i,this.clockRange=x(e.clockRange,Zr.UNBOUNDED),this.canAnimate=x(e.canAnimate,!0),this.onTick=new me,this.onStop=new me,this._currentTime=void 0,this._multiplier=void 0,this._clockStep=void 0,this._shouldAnimate=void 0,this._lastSystemTime=Ei(),this.currentTime=t,this.multiplier=x(e.multiplier,1),this.shouldAnimate=x(e.shouldAnimate,!1),this.clockStep=x(e.clockStep,Ao.SYSTEM_CLOCK_MULTIPLIER)}Object.defineProperties(Uj.prototype,{currentTime:{get:function(){return this._currentTime},set:function(e){$.equals(this._currentTime,e)||(this._clockStep===Ao.SYSTEM_CLOCK&&(this._clockStep=Ao.SYSTEM_CLOCK_MULTIPLIER),this._currentTime=e)}},multiplier:{get:function(){return this._multiplier},set:function(e){this._multiplier!==e&&(this._clockStep===Ao.SYSTEM_CLOCK&&(this._clockStep=Ao.SYSTEM_CLOCK_MULTIPLIER),this._multiplier=e)}},clockStep:{get:function(){return this._clockStep},set:function(e){e===Ao.SYSTEM_CLOCK&&(this._multiplier=1,this._shouldAnimate=!0,this._currentTime=$.now()),this._clockStep=e}},shouldAnimate:{get:function(){return this._shouldAnimate},set:function(e){this._shouldAnimate!==e&&(this._clockStep===Ao.SYSTEM_CLOCK&&(this._clockStep=Ao.SYSTEM_CLOCK_MULTIPLIER),this._shouldAnimate=e)}}});Uj.prototype.tick=function(){let e=Ei(),t=$.clone(this._currentTime);if(this.canAnimate&&this._shouldAnimate){let n=this._clockStep;if(n===Ao.SYSTEM_CLOCK)t=$.now(t);else{let i=this._multiplier;if(n===Ao.TICK_DEPENDENT)t=$.addSeconds(t,i,t);else{let a=e-this._lastSystemTime;t=$.addSeconds(t,i*(a/1e3),t)}let o=this.clockRange,r=this.startTime,s=this.stopTime;if(o===Zr.CLAMPED)$.lessThan(t,r)?t=$.clone(r,t):$.greaterThan(t,s)&&(t=$.clone(s,t),this.onStop.raiseEvent(this));else if(o===Zr.LOOP_STOP)for($.lessThan(t,r)&&(t=$.clone(r,t));$.greaterThan(t,s);)t=$.addSeconds(r,$.secondsDifference(t,s),t),this.onStop.raiseEvent(this)}}return this._currentTime=t,this._lastSystemTime=e,this.onTick.raiseEvent(this),t};var cm=Uj;function Ux(){this._definitionChanged=new me,this._startTime=void 0,this._stopTime=void 0,this._currentTime=void 0,this._clockRange=void 0,this._clockStep=void 0,this._multiplier=void 0}Object.defineProperties(Ux.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},startTime:$l("startTime"),stopTime:$l("stopTime"),currentTime:$l("currentTime"),clockRange:$l("clockRange"),clockStep:$l("clockStep"),multiplier:$l("multiplier")});Ux.prototype.clone=function(e){return u(e)||(e=new Ux),e.startTime=this.startTime,e.stopTime=this.stopTime,e.currentTime=this.currentTime,e.clockRange=this.clockRange,e.clockStep=this.clockStep,e.multiplier=this.multiplier,e};Ux.prototype.equals=function(e){return this===e||u(e)&&$.equals(this.startTime,e.startTime)&&$.equals(this.stopTime,e.stopTime)&&$.equals(this.currentTime,e.currentTime)&&this.clockRange===e.clockRange&&this.clockStep===e.clockStep&&this.multiplier===e.multiplier};Ux.prototype.merge=function(e){this.startTime=x(this.startTime,e.startTime),this.stopTime=x(this.stopTime,e.stopTime),this.currentTime=x(this.currentTime,e.currentTime),this.clockRange=x(this.clockRange,e.clockRange),this.clockStep=x(this.clockStep,e.clockStep),this.multiplier=x(this.multiplier,e.multiplier)};Ux.prototype.getValue=function(e){return u(e)||(e=new cm),e.startTime=x(this.startTime,e.startTime),e.stopTime=x(this.stopTime,e.stopTime),e.currentTime=x(this.currentTime,e.currentTime),e.clockRange=x(this.clockRange,e.clockRange),e.multiplier=x(this.multiplier,e.multiplier),e.clockStep=x(this.clockStep,e.clockStep),e};var lm=Ux;var E$e=G.WHITE,S$e=.1,v$e=new H(8,8),w$e=new H(0,0),D$e=new H(1,1);function ST(e){e=x(e,x.EMPTY_OBJECT),this._definitionChanged=new me,this._color=void 0,this._colorSubscription=void 0,this._cellAlpha=void 0,this._cellAlphaSubscription=void 0,this._lineCount=void 0,this._lineCountSubscription=void 0,this._lineThickness=void 0,this._lineThicknessSubscription=void 0,this._lineOffset=void 0,this._lineOffsetSubscription=void 0,this.color=e.color,this.cellAlpha=e.cellAlpha,this.lineCount=e.lineCount,this.lineThickness=e.lineThickness,this.lineOffset=e.lineOffset}Object.defineProperties(ST.prototype,{isConstant:{get:function(){return Y.isConstant(this._color)&&Y.isConstant(this._cellAlpha)&&Y.isConstant(this._lineCount)&&Y.isConstant(this._lineThickness)&&Y.isConstant(this._lineOffset)}},definitionChanged:{get:function(){return this._definitionChanged}},color:le("color"),cellAlpha:le("cellAlpha"),lineCount:le("lineCount"),lineThickness:le("lineThickness"),lineOffset:le("lineOffset")});ST.prototype.getType=function(e){return"Grid"};var I$e=new $;ST.prototype.getValue=function(e,t){return u(e)||(e=$.now(I$e)),u(t)||(t={}),t.color=Y.getValueOrClonedDefault(this._color,e,E$e,t.color),t.cellAlpha=Y.getValueOrDefault(this._cellAlpha,e,S$e),t.lineCount=Y.getValueOrClonedDefault(this._lineCount,e,v$e,t.lineCount),t.lineThickness=Y.getValueOrClonedDefault(this._lineThickness,e,D$e,t.lineThickness),t.lineOffset=Y.getValueOrClonedDefault(this._lineOffset,e,w$e,t.lineOffset),t};ST.prototype.equals=function(e){return this===e||e instanceof ST&&Y.equals(this._color,e._color)&&Y.equals(this._cellAlpha,e._cellAlpha)&&Y.equals(this._lineCount,e._lineCount)&&Y.equals(this._lineThickness,e._lineThickness)&&Y.equals(this._lineOffset,e._lineOffset)};var y1=ST;function vT(e){this._definitionChanged=new me,this._color=void 0,this._colorSubscription=void 0,this.color=e}Object.defineProperties(vT.prototype,{isConstant:{get:function(){return Y.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:le("color")});vT.prototype.getType=function(e){return"PolylineArrow"};var P$e=new $;vT.prototype.getValue=function(e,t){return u(e)||(e=$.now(P$e)),u(t)||(t={}),t.color=Y.getValueOrClonedDefault(this._color,e,G.WHITE,t.color),t};vT.prototype.equals=function(e){return this===e||e instanceof vT&&Y.equals(this._color,e._color)};var x1=vT;var R$e=G.WHITE,O$e=G.TRANSPARENT,M$e=16,L$e=255;function wT(e){e=x(e,x.EMPTY_OBJECT),this._definitionChanged=new me,this._color=void 0,this._colorSubscription=void 0,this._gapColor=void 0,this._gapColorSubscription=void 0,this._dashLength=void 0,this._dashLengthSubscription=void 0,this._dashPattern=void 0,this._dashPatternSubscription=void 0,this.color=e.color,this.gapColor=e.gapColor,this.dashLength=e.dashLength,this.dashPattern=e.dashPattern}Object.defineProperties(wT.prototype,{isConstant:{get:function(){return Y.isConstant(this._color)&&Y.isConstant(this._gapColor)&&Y.isConstant(this._dashLength)&&Y.isConstant(this._dashPattern)}},definitionChanged:{get:function(){return this._definitionChanged}},color:le("color"),gapColor:le("gapColor"),dashLength:le("dashLength"),dashPattern:le("dashPattern")});wT.prototype.getType=function(e){return"PolylineDash"};var N$e=new $;wT.prototype.getValue=function(e,t){return u(e)||(e=$.now(N$e)),u(t)||(t={}),t.color=Y.getValueOrClonedDefault(this._color,e,R$e,t.color),t.gapColor=Y.getValueOrClonedDefault(this._gapColor,e,O$e,t.gapColor),t.dashLength=Y.getValueOrDefault(this._dashLength,e,M$e,t.dashLength),t.dashPattern=Y.getValueOrDefault(this._dashPattern,e,L$e,t.dashPattern),t};wT.prototype.equals=function(e){return this===e||e instanceof wT&&Y.equals(this._color,e._color)&&Y.equals(this._gapColor,e._gapColor)&&Y.equals(this._dashLength,e._dashLength)&&Y.equals(this._dashPattern,e._dashPattern)};var b1=wT;var F$e=G.WHITE,B$e=.25,k$e=1;function DT(e){e=x(e,x.EMPTY_OBJECT),this._definitionChanged=new me,this._color=void 0,this._colorSubscription=void 0,this._glowPower=void 0,this._glowPowerSubscription=void 0,this._taperPower=void 0,this._taperPowerSubscription=void 0,this.color=e.color,this.glowPower=e.glowPower,this.taperPower=e.taperPower}Object.defineProperties(DT.prototype,{isConstant:{get:function(){return Y.isConstant(this._color)&&Y.isConstant(this._glow)}},definitionChanged:{get:function(){return this._definitionChanged}},color:le("color"),glowPower:le("glowPower"),taperPower:le("taperPower")});DT.prototype.getType=function(e){return"PolylineGlow"};var V$e=new $;DT.prototype.getValue=function(e,t){return u(e)||(e=$.now(V$e)),u(t)||(t={}),t.color=Y.getValueOrClonedDefault(this._color,e,F$e,t.color),t.glowPower=Y.getValueOrDefault(this._glowPower,e,B$e,t.glowPower),t.taperPower=Y.getValueOrDefault(this._taperPower,e,k$e,t.taperPower),t};DT.prototype.equals=function(e){return this===e||e instanceof DT&&Y.equals(this._color,e._color)&&Y.equals(this._glowPower,e._glowPower)&&Y.equals(this._taperPower,e._taperPower)};var C1=DT;var U$e=G.WHITE,z$e=G.BLACK,H$e=1;function IT(e){e=x(e,x.EMPTY_OBJECT),this._definitionChanged=new me,this._color=void 0,this._colorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this.color=e.color,this.outlineColor=e.outlineColor,this.outlineWidth=e.outlineWidth}Object.defineProperties(IT.prototype,{isConstant:{get:function(){return Y.isConstant(this._color)&&Y.isConstant(this._outlineColor)&&Y.isConstant(this._outlineWidth)}},definitionChanged:{get:function(){return this._definitionChanged}},color:le("color"),outlineColor:le("outlineColor"),outlineWidth:le("outlineWidth")});IT.prototype.getType=function(e){return"PolylineOutline"};var G$e=new $;IT.prototype.getValue=function(e,t){return u(e)||(e=$.now(G$e)),u(t)||(t={}),t.color=Y.getValueOrClonedDefault(this._color,e,U$e,t.color),t.outlineColor=Y.getValueOrClonedDefault(this._outlineColor,e,z$e,t.outlineColor),t.outlineWidth=Y.getValueOrDefault(this._outlineWidth,e,H$e),t};IT.prototype.equals=function(e){return this===e||e instanceof IT&&Y.equals(this._color,e._color)&&Y.equals(this._outlineColor,e._outlineColor)&&Y.equals(this._outlineWidth,e._outlineWidth)};var zx=IT;function Qp(e,t){this._value=void 0,this._definitionChanged=new me,this._eventHelper=new Ar,this._referenceFrame=x(t,Gi.FIXED),this.setValue(e)}Object.defineProperties(Qp.prototype,{isConstant:{get:function(){let e=this._value;if(!u(e))return!0;let t=e.length;for(let n=0;n<t;n++)if(!Y.isConstant(e[n]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}});var W$e=new $;Qp.prototype.getValue=function(e,t){return u(e)||(e=$.now(W$e)),this.getValueInReferenceFrame(e,Gi.FIXED,t)};Qp.prototype.getValueInReferenceFrame=function(e,t,n){let i=this._value;if(!u(i))return;let o=i.length;u(n)||(n=new Array(o));let r=0,s=0;for(;r<o;){let c=i[r].getValueInReferenceFrame(e,t,n[r]);u(c)&&(n[s]=c,s++),r++}return n.length=s,n};Qp.prototype.setValue=function(e){let t=this._eventHelper;if(t.removeAll(),u(e)){this._value=e.slice();let n=e.length;for(let i=0;i<n;i++){let o=e[i];u(o)&&t.add(o.definitionChanged,Qp.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)};Qp.prototype.equals=function(e){return this===e||e instanceof Qp&&this._referenceFrame===e._referenceFrame&&Y.arrayEquals(this._value,e._value)};Qp.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var r0=Qp;function s0(e){this._value=void 0,this._definitionChanged=new me,this._eventHelper=new Ar,this.setValue(e)}Object.defineProperties(s0.prototype,{isConstant:{get:function(){let e=this._value;if(!u(e))return!0;let t=e.length;for(let n=0;n<t;n++)if(!Y.isConstant(e[n]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}}});var j$e=new $;s0.prototype.getValue=function(e,t){u(e)||(e=$.now(j$e));let n=this._value;if(!u(n))return;let i=n.length;u(t)||(t=new Array(i));let o=0,r=0;for(;o<i;){let a=this._value[o].getValue(e,t[o]);u(a)&&(t[r]=a,r++),o++}return t.length=r,t};s0.prototype.setValue=function(e){let t=this._eventHelper;if(t.removeAll(),u(e)){this._value=e.slice();let n=e.length;for(let i=0;i<n;i++){let o=e[i];u(o)&&t.add(o.definitionChanged,s0.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)};s0.prototype.equals=function(e){return this===e||e instanceof s0&&Y.arrayEquals(this._value,e._value)};s0.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var A1=s0;function Hx(e){let t=e._targetProperty;if(!u(t)){let n=e._targetEntity;if(!u(n)){if(n=e._targetCollection.getById(e._targetId),!u(n)){e._targetEntity=e._targetProperty=void 0;return}n.definitionChanged.addEventListener(mu.prototype._onTargetEntityDefinitionChanged,e),e._targetEntity=n}let i=e._targetPropertyNames;t=e._targetEntity;for(let o=0,r=i.length;o<r&&u(t);++o)t=t[i[o]];e._targetProperty=t}return t}function mu(e,t,n){this._targetCollection=e,this._targetId=t,this._targetPropertyNames=n,this._targetProperty=void 0,this._targetEntity=void 0,this._definitionChanged=new me,e.collectionChanged.addEventListener(mu.prototype._onCollectionChanged,this)}Object.defineProperties(mu.prototype,{isConstant:{get:function(){return Y.isConstant(Hx(this))}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){let e=Hx(this);return u(e)?e.referenceFrame:void 0}},targetId:{get:function(){return this._targetId}},targetCollection:{get:function(){return this._targetCollection}},targetPropertyNames:{get:function(){return this._targetPropertyNames}},resolvedProperty:{get:function(){return Hx(this)}}});mu.fromString=function(e,t){let n,i=[],o=!0,r=!1,s="";for(let a=0;a<t.length;++a){let c=t.charAt(a);r?(s+=c,r=!1):c==="\\"?r=!0:o&&c==="#"?(n=s,o=!1,s=""):!o&&c==="."?(i.push(s),s=""):s+=c}return i.push(s),new mu(e,n,i)};var q$e=new $;mu.prototype.getValue=function(e,t){let n=Hx(this);return u(e)||(e=$.now(q$e)),u(n)?n.getValue(e,t):void 0};mu.prototype.getValueInReferenceFrame=function(e,t,n){let i=Hx(this);return u(i)?i.getValueInReferenceFrame(e,t,n):void 0};mu.prototype.getType=function(e){let t=Hx(this);return u(t)?t.getType(e):void 0};mu.prototype.equals=function(e){if(this===e)return!0;let t=this._targetPropertyNames,n=e._targetPropertyNames;if(this._targetCollection!==e._targetCollection||this._targetId!==e._targetId||t.length!==n.length)return!1;let i=this._targetPropertyNames.length;for(let o=0;o<i;o++)if(t[o]!==n[o])return!1;return!0};mu.prototype._onTargetEntityDefinitionChanged=function(e,t,n,i){u(this._targetProperty)&&this._targetPropertyNames[0]===t&&(this._targetProperty=void 0,this._definitionChanged.raiseEvent(this))};mu.prototype._onCollectionChanged=function(e,t,n){let i=this._targetEntity;u(i)&&n.indexOf(i)!==-1?(i.definitionChanged.removeEventListener(mu.prototype._onTargetEntityDefinitionChanged,this),this._targetEntity=this._targetProperty=void 0):u(i)||(i=Hx(this),u(i)&&this._definitionChanged.raiseEvent(this))};var a0=mu;var Y$e={packedLength:1,pack:function(e,t,n){return n=x(n,0),t[n]=e,t},unpack:function(e,t,n){return t=x(t,0),e[t]},convertPackedArrayForInterpolation:function(e,t,n,i){u(i)||(i=[]),t=x(t,0),n=x(n,e.length);let o;for(let r=0,s=n-t+1;r<s;r++){let a=e[t+r];r===0||Math.abs(o-a)<Math.PI?i[r]=a:i[r]=a-R.TWO_PI,o=a}},unpackInterpolationResult:function(e,t,n,i,o){return o=e[0],o<0?o+R.TWO_PI:o}},Fd=Y$e;var ade={packedLength:1,pack:function(e,t,n){n=x(n,0),t[n]=e},unpack:function(e,t,n){return t=x(t,0),e[t]}};function cde(e,t,n){let i,o=e.length,r=n.length,s=o+r;if(e.length=s,o!==t){let a=o-1;for(i=s-1;i>=t;i--)e[i]=e[a--]}for(i=0;i<r;i++)e[t++]=n[i]}function lde(e,t){return e instanceof $?e:typeof e=="string"?$.fromIso8601(e):$.addSeconds(t,e,new $)}var zj=[],Hj=[];function sk(e,t,n,i,o){let r=0,s,a,c,l,f,d;for(;r<i.length;){f=lde(i[r],e),c=No(t,f,$.compare);let p=0,g=0;if(c<0){for(c=~c,l=c*o,a=void 0,d=t[c];r<i.length&&(f=lde(i[r],e),!(u(a)&&$.compare(a,f)>=0||u(d)&&$.compare(f,d)>=0));){for(zj[p++]=f,r=r+1,s=0;s<o;s++)Hj[g++]=i[r],r=r+1;a=f}p>0&&(Hj.length=g,cde(n,l,Hj),zj.length=p,cde(t,c,zj))}else{for(s=0;s<o;s++)r++,n[c*o+s]=i[r];r++}}}function Bd(e,t){let n=e;n===Number&&(n=ade);let i=n.packedLength,o=x(n.packedInterpolationLength,i),r=0,s;if(u(t)){let a=t.length;s=new Array(a);for(let c=0;c<a;c++){let l=t[c];l===Number&&(l=ade);let f=l.packedLength;i+=f,o+=x(l.packedInterpolationLength,f),s[c]=l}r=a}this._type=e,this._innerType=n,this._interpolationDegree=1,this._interpolationAlgorithm=ET,this._numberOfPoints=0,this._times=[],this._values=[],this._xTable=[],this._yTable=[],this._packedLength=i,this._packedInterpolationLength=o,this._updateTableLength=!0,this._interpolationResult=new Array(o),this._definitionChanged=new me,this._derivativeTypes=t,this._innerDerivativeTypes=s,this._inputOrder=r,this._forwardExtrapolationType=Lf.NONE,this._forwardExtrapolationDuration=0,this._backwardExtrapolationType=Lf.NONE,this._backwardExtrapolationDuration=0}Object.defineProperties(Bd.prototype,{isConstant:{get:function(){return this._values.length===0}},definitionChanged:{get:function(){return this._definitionChanged}},type:{get:function(){return this._type}},derivativeTypes:{get:function(){return this._derivativeTypes}},interpolationDegree:{get:function(){return this._interpolationDegree}},interpolationAlgorithm:{get:function(){return this._interpolationAlgorithm}},forwardExtrapolationType:{get:function(){return this._forwardExtrapolationType},set:function(e){this._forwardExtrapolationType!==e&&(this._forwardExtrapolationType=e,this._definitionChanged.raiseEvent(this))}},forwardExtrapolationDuration:{get:function(){return this._forwardExtrapolationDuration},set:function(e){this._forwardExtrapolationDuration!==e&&(this._forwardExtrapolationDuration=e,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationType:{get:function(){return this._backwardExtrapolationType},set:function(e){this._backwardExtrapolationType!==e&&(this._backwardExtrapolationType=e,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationDuration:{get:function(){return this._backwardExtrapolationDuration},set:function(e){this._backwardExtrapolationDuration!==e&&(this._backwardExtrapolationDuration=e,this._definitionChanged.raiseEvent(this))}}});var X$e=new $;Bd.prototype.getValue=function(e,t){u(e)||(e=$.now(X$e));let n=this._times,i=n.length;if(i===0)return;let o,r=this._innerType,s=this._values,a=No(n,e,$.compare);if(a<0){if(a=~a,a===0){let E=n[a];if(o=this._backwardExtrapolationDuration,this._backwardExtrapolationType===Lf.NONE||o!==0&&$.secondsDifference(E,e)>o)return;if(this._backwardExtrapolationType===Lf.HOLD)return r.unpack(s,0,t)}if(a>=i){a=i-1;let E=n[a];if(o=this._forwardExtrapolationDuration,this._forwardExtrapolationType===Lf.NONE||o!==0&&$.secondsDifference(e,E)>o)return;if(this._forwardExtrapolationType===Lf.HOLD)return a=i-1,r.unpack(s,a*r.packedLength,t)}let c=this._xTable,l=this._yTable,f=this._interpolationAlgorithm,d=this._packedInterpolationLength,p=this._inputOrder;if(this._updateTableLength){this._updateTableLength=!1;let E=Math.min(f.getRequiredDataPoints(this._interpolationDegree,p),i);E!==this._numberOfPoints&&(this._numberOfPoints=E,c.length=E,l.length=E*d)}let g=this._numberOfPoints-1;if(g<1)return;let m=0,y=i-1;if(y-m+1>=g+1){let E=a-(g/2|0)-1;E<m&&(E=m);let v=E+g;v>y&&(v=y,E=v-g,E<m&&(E=m)),m=E,y=v}let C=y-m+1;for(let E=0;E<C;++E)c[E]=$.secondsDifference(n[m+E],n[y]);if(u(r.convertPackedArrayForInterpolation))r.convertPackedArrayForInterpolation(s,m,y,l);else{let E=0,v=this._packedLength,D=m*v,O=(y+1)*v;for(;D<O;)l[E]=s[D],D++,E++}let A=$.secondsDifference(e,n[y]),T;if(p===0||!u(f.interpolate))T=f.interpolateOrderZero(A,c,l,d,this._interpolationResult);else{let E=Math.floor(d/(p+1));T=f.interpolate(A,c,l,E,p,p,this._interpolationResult)}return u(r.unpackInterpolationResult)?r.unpackInterpolationResult(T,s,m,y,t):r.unpack(T,0,t)}return r.unpack(s,a*this._packedLength,t)};Bd.prototype.setInterpolationOptions=function(e){if(!u(e))return;let t=!1,n=e.interpolationAlgorithm,i=e.interpolationDegree;u(n)&&this._interpolationAlgorithm!==n&&(this._interpolationAlgorithm=n,t=!0),u(i)&&this._interpolationDegree!==i&&(this._interpolationDegree=i,t=!0),t&&(this._updateTableLength=!0,this._definitionChanged.raiseEvent(this))};Bd.prototype.addSample=function(e,t,n){let i=this._innerDerivativeTypes,o=u(i),r=this._innerType,s=[];if(s.push(e),r.pack(t,s,s.length),o){let a=i.length;for(let c=0;c<a;c++)i[c].pack(n[c],s,s.length)}sk(void 0,this._times,this._values,s,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)};Bd.prototype.addSamples=function(e,t,n){let i=this._innerDerivativeTypes,o=u(i),r=this._innerType,s=e.length,a=[];for(let c=0;c<s;c++)if(a.push(e[c]),r.pack(t[c],a,a.length),o){let l=n[c],f=i.length;for(let d=0;d<f;d++)i[d].pack(l[d],a,a.length)}sk(void 0,this._times,this._values,a,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)};Bd.prototype.addSamplesPackedArray=function(e,t){sk(t,this._times,this._values,e,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)};Bd.prototype.removeSample=function(e){let t=No(this._times,e,$.compare);return t<0?!1:(ude(this,t,1),!0)};function ude(e,t,n){let i=e._packedLength;e._times.splice(t,n),e._values.splice(t*i,n*i),e._updateTableLength=!0,e._definitionChanged.raiseEvent(e)}Bd.prototype.removeSamples=function(e){let t=this._times,n=No(t,e.start,$.compare);n<0?n=~n:e.isStartIncluded||++n;let i=No(t,e.stop,$.compare);i<0?i=~i:e.isStopIncluded&&++i,ude(this,n,i-n)};Bd.prototype.equals=function(e){if(this===e)return!0;if(!u(e)||this._type!==e._type||this._interpolationDegree!==e._interpolationDegree||this._interpolationAlgorithm!==e._interpolationAlgorithm)return!1;let t=this._derivativeTypes,n=u(t),i=e._derivativeTypes,o=u(i);if(n!==o)return!1;let r,s;if(n){if(s=t.length,s!==i.length)return!1;for(r=0;r<s;r++)if(t[r]!==i[r])return!1}let a=this._times,c=e._times;if(s=a.length,s!==c.length)return!1;for(r=0;r<s;r++)if(!$.equals(a[r],c[r]))return!1;let l=this._values,f=e._values;for(s=l.length,r=0;r<s;r++)if(l[r]!==f[r])return!1;return!0};Bd._mergeNewSamples=sk;var Nf=Bd;function Ff(e,t){t=x(t,0);let n;if(t>0){n=new Array(t);for(let i=0;i<t;i++)n[i]=h}this._numberOfDerivatives=t,this._property=new Nf(h,n),this._definitionChanged=new me,this._referenceFrame=x(e,Gi.FIXED),this._property._definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this)},this)}Object.defineProperties(Ff.prototype,{isConstant:{get:function(){return this._property.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}},interpolationDegree:{get:function(){return this._property.interpolationDegree}},interpolationAlgorithm:{get:function(){return this._property.interpolationAlgorithm}},numberOfDerivatives:{get:function(){return this._numberOfDerivatives}},forwardExtrapolationType:{get:function(){return this._property.forwardExtrapolationType},set:function(e){this._property.forwardExtrapolationType=e}},forwardExtrapolationDuration:{get:function(){return this._property.forwardExtrapolationDuration},set:function(e){this._property.forwardExtrapolationDuration=e}},backwardExtrapolationType:{get:function(){return this._property.backwardExtrapolationType},set:function(e){this._property.backwardExtrapolationType=e}},backwardExtrapolationDuration:{get:function(){return this._property.backwardExtrapolationDuration},set:function(e){this._property.backwardExtrapolationDuration=e}}});var K$e=new $;Ff.prototype.getValue=function(e,t){return u(e)||(e=$.now(K$e)),this.getValueInReferenceFrame(e,Gi.FIXED,t)};Ff.prototype.getValueInReferenceFrame=function(e,t,n){if(n=this._property.getValue(e,n),u(n))return Oh.convertToReferenceFrame(e,n,this._referenceFrame,t,n)};Ff.prototype.setInterpolationOptions=function(e){this._property.setInterpolationOptions(e)};Ff.prototype.addSample=function(e,t,n){let i=this._numberOfDerivatives;this._property.addSample(e,t,n)};Ff.prototype.addSamples=function(e,t,n){this._property.addSamples(e,t,n)};Ff.prototype.addSamplesPackedArray=function(e,t){this._property.addSamplesPackedArray(e,t)};Ff.prototype.removeSample=function(e){return this._property.removeSample(e)};Ff.prototype.removeSamples=function(e){this._property.removeSamples(e)};Ff.prototype.equals=function(e){return this===e||e instanceof Ff&&Y.equals(this._property,e._property)&&this._referenceFrame===e._referenceFrame};var Ra=Ff;var Z$e={HORIZONTAL:0,VERTICAL:1},um=Object.freeze(Z$e);var $$e=um.HORIZONTAL,Q$e=G.WHITE,J$e=G.BLACK,eQe=0,tQe=1;function PT(e){e=x(e,x.EMPTY_OBJECT),this._definitionChanged=new me,this._orientation=void 0,this._orientationSubscription=void 0,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._offset=void 0,this._offsetSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.orientation=e.orientation,this.evenColor=e.evenColor,this.oddColor=e.oddColor,this.offset=e.offset,this.repeat=e.repeat}Object.defineProperties(PT.prototype,{isConstant:{get:function(){return Y.isConstant(this._orientation)&&Y.isConstant(this._evenColor)&&Y.isConstant(this._oddColor)&&Y.isConstant(this._offset)&&Y.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},orientation:le("orientation"),evenColor:le("evenColor"),oddColor:le("oddColor"),offset:le("offset"),repeat:le("repeat")});PT.prototype.getType=function(e){return"Stripe"};var nQe=new $;PT.prototype.getValue=function(e,t){return u(e)||(e=$.now(nQe)),u(t)||(t={}),t.horizontal=Y.getValueOrDefault(this._orientation,e,$$e)===um.HORIZONTAL,t.evenColor=Y.getValueOrClonedDefault(this._evenColor,e,Q$e,t.evenColor),t.oddColor=Y.getValueOrClonedDefault(this._oddColor,e,J$e,t.oddColor),t.offset=Y.getValueOrDefault(this._offset,e,eQe),t.repeat=Y.getValueOrDefault(this._repeat,e,tQe),t};PT.prototype.equals=function(e){return this===e||e instanceof PT&&Y.equals(this._orientation,e._orientation)&&Y.equals(this._evenColor,e._evenColor)&&Y.equals(this._oddColor,e._oddColor)&&Y.equals(this._offset,e._offset)&&Y.equals(this._repeat,e._repeat)};var T1=PT;function c0(e){this._definitionChanged=new me,this._intervals=new Xr,this._intervals.changedEvent.addEventListener(c0.prototype._intervalsChanged,this),this._referenceFrame=x(e,Gi.FIXED)}Object.defineProperties(c0.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}},referenceFrame:{get:function(){return this._referenceFrame}}});var iQe=new $;c0.prototype.getValue=function(e,t){return u(e)||(e=$.now(iQe)),this.getValueInReferenceFrame(e,Gi.FIXED,t)};c0.prototype.getValueInReferenceFrame=function(e,t,n){let i=this._intervals.findDataForIntervalContainingDate(e);if(u(i))return Oh.convertToReferenceFrame(e,i,this._referenceFrame,t,n)};c0.prototype.equals=function(e){return this===e||e instanceof c0&&this._intervals.equals(e._intervals,Y.equals)&&this._referenceFrame===e._referenceFrame};c0.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};var l0=c0;function Gx(){this._definitionChanged=new me,this._intervals=new Xr,this._intervals.changedEvent.addEventListener(Gx.prototype._intervalsChanged,this)}Object.defineProperties(Gx.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}});var oQe=new $;Gx.prototype.getValue=function(e,t){u(e)||(e=$.now(oQe));let n=this._intervals.findDataForIntervalContainingDate(e);return u(n)&&typeof n.clone=="function"?n.clone(t):n};Gx.prototype.equals=function(e){return this===e||e instanceof Gx&&this._intervals.equals(e._intervals,Y.equals)};Gx.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};var u0=Gx;function RT(e,t){this._position=void 0,this._subscription=void 0,this._definitionChanged=new me,this._normalize=x(t,!0),this.position=e}Object.defineProperties(RT.prototype,{isConstant:{get:function(){return Y.isConstant(this._position)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._position},set:function(e){let t=this._position;t!==e&&(u(t)&&this._subscription(),this._position=e,u(e)&&(this._subscription=e._definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this)},this)),this._definitionChanged.raiseEvent(this))}},normalize:{get:function(){return this._normalize},set:function(e){this._normalize!==e&&(this._normalize=e,this._definitionChanged.raiseEvent(this))}}});var rQe=new h,fde=new h,dde=new $,sQe=new $,Gj=1/60;RT.prototype.getValue=function(e,t){return this._getValue(e,t)};RT.prototype._getValue=function(e,t,n){u(e)||(e=$.now(sQe)),u(t)||(t=new h);let i=this._position;if(Y.isConstant(i))return this._normalize?void 0:h.clone(h.ZERO,t);let o=i.getValue(e,rQe),r=i.getValue($.addSeconds(e,Gj,dde),fde);if(!u(o)||!u(r)&&(r=o,o=i.getValue($.addSeconds(e,-Gj,dde),fde),!u(o)))return;if(h.equals(o,r))return this._normalize?void 0:h.clone(h.ZERO,t);u(n)&&o.clone(n);let s=h.subtract(r,o,t);return this._normalize?h.normalize(s,t):h.divideByScalar(s,Gj,t)};RT.prototype.equals=function(e){return this===e||e instanceof RT&&Y.equals(this._position,e._position)};var OT=RT;function E1(e,t){this._velocityVectorProperty=new OT(e,!0),this._subscription=void 0,this._ellipsoid=void 0,this._definitionChanged=new me,this.ellipsoid=x(t,ee.default);let n=this;this._velocityVectorProperty.definitionChanged.addEventListener(function(){n._definitionChanged.raiseEvent(n)})}Object.defineProperties(E1.prototype,{isConstant:{get:function(){return Y.isConstant(this._velocityVectorProperty)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._velocityVectorProperty.position},set:function(e){this._velocityVectorProperty.position=e}},ellipsoid:{get:function(){return this._ellipsoid},set:function(e){this._ellipsoid!==e&&(this._ellipsoid=e,this._definitionChanged.raiseEvent(this))}}});var hde=new h,aQe=new h,mde=new J,cQe=new $;E1.prototype.getValue=function(e,t){u(e)||(e=$.now(cQe));let n=this._velocityVectorProperty._getValue(e,aQe,hde);if(u(n))return Lt.rotationMatrixFromPositionVelocity(hde,n,this._ellipsoid,mde),Le.fromRotationMatrix(mde,t)};E1.prototype.equals=function(e){return this===e||e instanceof E1&&Y.equals(this._velocityVectorProperty,e._velocityVectorProperty)&&(this._ellipsoid===e._ellipsoid||this._ellipsoid.equals(e._ellipsoid))};var ak=E1;var Jp={COMPLETE:0,BELOW_ELLIPSOID_HORIZON:1,ABOVE_ELLIPSOID_HORIZON:2};Jp.validate=function(e){return e===Jp.COMPLETE||e===Jp.BELOW_ELLIPSOID_HORIZON||e===Jp.ABOVE_ELLIPSOID_HORIZON};Jp.toString=function(e){switch(e){case Jp.COMPLETE:return"COMPLETE";case Jp.BELOW_ELLIPSOID_HORIZON:return"BELOW_ELLIPSOID_HORIZON";case Jp.ABOVE_ELLIPSOID_HORIZON:return"ABOVE_ELLIPSOID_HORIZON";default:throw new he("SensorVolumePortionToDisplay value is not valid and cannot be converted to a String.")}};var S1=Jp;function f0(){}f0.packedLength=h.packedLength;f0.unpack=h.unpack;f0.pack=h.pack;var Wj;function v1(e,t){return t[0]==="#"&&(t=Wj+t),a0.fromString(e,t)}function pde(e,t,n){if(u(n.reference))return v1(t,n.reference);if(u(n.velocityReference)){let i=v1(t,n.velocityReference);switch(e){case h:case f0:return new OT(i,e===f0);case Le:return new ak(i)}}throw new ce(`${JSON.stringify(n)} is not valid CZML.`)}function lQe(e,t){return new Fh(function(n,i){return t(e.getValue(n,i))},e.isConstant)}var Vi=new h,jc=new rk,ac=new de,Wx=new Sn,ck=new Le;function uQe(e){let t=e.rgbaf;if(u(t))return t;let n=e.rgba;if(!u(n))return;let i=n.length;if(i===G.packedLength)return[G.byteToFloat(n[0]),G.byteToFloat(n[1]),G.byteToFloat(n[2]),G.byteToFloat(n[3])];t=new Array(i);for(let o=0;o<i;o+=5)t[o]=n[o],t[o+1]=G.byteToFloat(n[o+1]),t[o+2]=G.byteToFloat(n[o+2]),t[o+3]=G.byteToFloat(n[o+3]),t[o+4]=G.byteToFloat(n[o+4]);return t}function _de(e,t){let n=x(e.uri,e);return u(t)?t.getDerivedResource({url:n}):De.createIfNeeded(n)}function fQe(e){let t=e.wsen;if(u(t))return t;let n=e.wsenDegrees;if(!u(n))return;let i=n.length;if(i===se.packedLength)return[R.toRadians(n[0]),R.toRadians(n[1]),R.toRadians(n[2]),R.toRadians(n[3])];t=new Array(i);for(let o=0;o<i;o+=5)t[o]=n[o],t[o+1]=R.toRadians(n[o+1]),t[o+2]=R.toRadians(n[o+2]),t[o+3]=R.toRadians(n[o+3]),t[o+4]=R.toRadians(n[o+4]);return t}function dQe(e){let t=e.length;if(jc.magnitude=1,t===2)return jc.clock=e[0],jc.cone=e[1],h.fromSpherical(jc,Vi),[Vi.x,Vi.y,Vi.z];let n=new Array(t/3*4);for(let i=0,o=0;i<t;i+=3,o+=4)n[o]=e[i],jc.clock=e[i+1],jc.cone=e[i+2],h.fromSpherical(jc,Vi),n[o+1]=Vi.x,n[o+2]=Vi.y,n[o+3]=Vi.z;return n}function hQe(e){let t=e.length;if(t===3)return jc.clock=e[0],jc.cone=e[1],jc.magnitude=e[2],h.fromSpherical(jc,Vi),[Vi.x,Vi.y,Vi.z];let n=new Array(t);for(let i=0;i<t;i+=4)n[i]=e[i],jc.clock=e[i+1],jc.cone=e[i+2],jc.magnitude=e[i+3],h.fromSpherical(jc,Vi),n[i+1]=Vi.x,n[i+2]=Vi.y,n[i+3]=Vi.z;return n}function mQe(e){let t=e.length;if(t===3)return ac.longitude=e[0],ac.latitude=e[1],ac.height=e[2],ee.default.cartographicToCartesian(ac,Vi),[Vi.x,Vi.y,Vi.z];let n=new Array(t);for(let i=0;i<t;i+=4)n[i]=e[i],ac.longitude=e[i+1],ac.latitude=e[i+2],ac.height=e[i+3],ee.default.cartographicToCartesian(ac,Vi),n[i+1]=Vi.x,n[i+2]=Vi.y,n[i+3]=Vi.z;return n}function pQe(e){let t=e.length;if(t===3)return ac.longitude=R.toRadians(e[0]),ac.latitude=R.toRadians(e[1]),ac.height=e[2],ee.default.cartographicToCartesian(ac,Vi),[Vi.x,Vi.y,Vi.z];let n=new Array(t);for(let i=0;i<t;i+=4)n[i]=e[i],ac.longitude=R.toRadians(e[i+1]),ac.latitude=R.toRadians(e[i+2]),ac.height=e[i+3],ee.default.cartographicToCartesian(ac,Vi),n[i+1]=Vi.x,n[i+2]=Vi.y,n[i+3]=Vi.z;return n}function jj(e){let t=e.cartesian;if(u(t))return t;let n=e.cartesianVelocity;if(u(n))return n;let i=e.unitCartesian;if(u(i))return i;let o=e.unitSpherical;if(u(o))return dQe(o);let r=e.spherical;if(u(r))return hQe(r);let s=e.cartographicRadians;if(u(s))return mQe(s);let a=e.cartographicDegrees;if(u(a))return pQe(a);throw new ce(`${JSON.stringify(e)} is not a valid CZML interval.`)}function gde(e,t){h.unpack(e,t,Vi),h.normalize(Vi,Vi),h.pack(Vi,e,t)}function _Qe(e){let t=jj(e);if(t.length===3)return gde(t,0),t;for(let n=1;n<t.length;n+=4)gde(t,n);return t}function yde(e,t){Le.unpack(e,t,ck),Le.normalize(ck,ck),Le.pack(ck,e,t)}function gQe(e){let t=e.unitQuaternion;if(u(t)){if(t.length===4)return yde(t,0),t;for(let n=1;n<t.length;n+=5)yde(t,n)}return t}function xde(e){return typeof e=="boolean"?Boolean:typeof e=="number"?Number:typeof e=="string"?String:e.hasOwnProperty("array")?Array:e.hasOwnProperty("boolean")?Boolean:e.hasOwnProperty("boundingRectangle")?qe:e.hasOwnProperty("cartesian2")?H:e.hasOwnProperty("cartesian")||e.hasOwnProperty("spherical")||e.hasOwnProperty("cartographicRadians")||e.hasOwnProperty("cartographicDegrees")?h:e.hasOwnProperty("unitCartesian")||e.hasOwnProperty("unitSpherical")?f0:e.hasOwnProperty("rgba")||e.hasOwnProperty("rgbaf")?G:e.hasOwnProperty("arcType")?nn:e.hasOwnProperty("classificationType")?Vn:e.hasOwnProperty("colorBlendMode")?Bc:e.hasOwnProperty("cornerType")?ki:e.hasOwnProperty("heightReference")?Xe:e.hasOwnProperty("horizontalOrigin")?bi:e.hasOwnProperty("date")?$:e.hasOwnProperty("labelStyle")?$o:e.hasOwnProperty("number")?Number:e.hasOwnProperty("nearFarScalar")?kt:e.hasOwnProperty("distanceDisplayCondition")?Nt:e.hasOwnProperty("object")||e.hasOwnProperty("value")?Object:e.hasOwnProperty("unitQuaternion")?Le:e.hasOwnProperty("shadowMode")?xn:e.hasOwnProperty("string")?String:e.hasOwnProperty("stripeOrientation")?um:e.hasOwnProperty("wsen")||e.hasOwnProperty("wsenDegrees")?se:e.hasOwnProperty("uri")?D1.default:e.hasOwnProperty("verticalOrigin")?On:Object}function yQe(e,t,n){switch(e){case nn:return nn[x(t.arcType,t)];case Array:return t.array;case Boolean:return x(t.boolean,t);case qe:return t.boundingRectangle;case H:return t.cartesian2;case h:return jj(t);case f0:return _Qe(t);case G:return uQe(t);case Vn:return Vn[x(t.classificationType,t)];case Bc:return Bc[x(t.colorBlendMode,t)];case ki:return ki[x(t.cornerType,t)];case Xe:return Xe[x(t.heightReference,t)];case bi:return bi[x(t.horizontalOrigin,t)];case Image:return _de(t,n);case $:return $.fromIso8601(x(t.date,t));case $o:return $o[x(t.labelStyle,t)];case Number:return x(t.number,t);case kt:return t.nearFarScalar;case Nt:return t.distanceDisplayCondition;case Object:return x(x(t.object,t.value),t);case Le:return gQe(t);case Fd:return x(t.number,t);case S1:return S1[x(t.portionToDisplay,t)];case xn:return xn[x(x(t.shadowMode,t.shadows),t)];case String:return x(t.string,t);case um:return um[x(t.stripeOrientation,t)];case se:return fQe(t);case D1.default:return _de(t,n);case On:return On[x(t.verticalOrigin,t)];default:throw new ce(`Unknown CzmlDataSource interval type: ${e}`)}}var xQe={HERMITE:ik,LAGRANGE:ok,LINEAR:ET};function lk(e,t){let n=e.interpolationAlgorithm,i=e.interpolationDegree;(u(n)||u(i))&&t.setInterpolationOptions({interpolationAlgorithm:xQe[n],interpolationDegree:i});let o=e.forwardExtrapolationType;u(o)&&(t.forwardExtrapolationType=Lf[o]);let r=e.forwardExtrapolationDuration;u(r)&&(t.forwardExtrapolationDuration=r);let s=e.backwardExtrapolationType;u(s)&&(t.backwardExtrapolationType=Lf[s]);let a=e.backwardExtrapolationDuration;u(a)&&(t.backwardExtrapolationDuration=a)}var bde={iso8601:void 0};function lr(e){if(u(e))return bde.iso8601=e,Sn.fromIso8601(bde)}function qj(e){let t=He.MAXIMUM_INTERVAL.clone();return t.data=e,t}function Cde(e){let t=new Hc;return t.intervals.addInterval(qj(e)),t}function Ade(e){let t=new Pa(e.referenceFrame);return t.intervals.addInterval(qj(e)),t}function uk(e,t,n,i,o,r,s){let a=lr(i.interval);u(o)&&(u(a)?a=Sn.intersect(a,o,Wx):a=o);let c,l,f,d=!u(i.reference)&&!u(i.velocityReference),p=u(a)&&!a.equals(He.MAXIMUM_INTERVAL);if(i.delete===!0){if(!p){t[n]=void 0;return}return Mde(t[n],a)}let g=!1;if(d){if(l=yQe(e,i,r),!u(l))return;c=x(e.packedLength,1),f=x(l.length,1),g=!u(i.array)&&typeof l!="string"&&f>c&&e!==Object}let m=typeof e.unpack=="function"&&e!==Fd;if(!g&&!p){d?t[n]=new Kn(m?e.unpack(l,0):l):t[n]=pde(e,s,i);return}let y=t[n],b,C=i.epoch;if(u(C)&&(b=$.fromIso8601(C)),g&&!p){y instanceof Nf||(t[n]=y=new Nf(e)),y.addSamplesPackedArray(l,b),lk(i,y);return}let A;if(!g&&p){a=a.clone(),d?a.data=m?e.unpack(l,0):l:a.data=pde(e,s,i),u(y)||(t[n]=y=d?new u0:new Hc),d&&y instanceof u0?y.intervals.addInterval(a):y instanceof Hc?(d&&(a.data=new Kn(a.data)),y.intervals.addInterval(a)):(t[n]=y=Cde(y),d&&(a.data=new Kn(a.data)),y.intervals.addInterval(a));return}u(y)||(t[n]=y=new Hc),y instanceof Hc||(t[n]=y=Cde(y));let T=y.intervals;A=T.findInterval(a),(!u(A)||!(A.data instanceof Nf))&&(A=a.clone(),A.data=new Nf(e),T.addInterval(A)),A.data.addSamplesPackedArray(l,b),lk(i,A.data)}function Mde(e,t){if(e instanceof Nf){e.removeSamples(t);return}else if(e instanceof u0){e.intervals.removeInterval(t);return}else if(e instanceof Hc){let n=e.intervals;for(let i=0;i<n.length;++i){let o=Sn.intersect(n.get(i),t,Wx);o.isEmpty||Mde(o.data,t)}n.removeInterval(t);return}}function ge(e,t,n,i,o,r,s){if(u(i))if(Array.isArray(i))for(let a=0,c=i.length;a<c;++a)uk(e,t,n,i[a],o,r,s);else uk(e,t,n,i,o,r,s)}function Tde(e,t,n,i,o,r){let s=lr(n.interval);u(i)&&(u(s)?s=Sn.intersect(s,i,Wx):s=i);let a=u(n.cartesianVelocity)?1:0,c=h.packedLength*(a+1),l,f,d=!u(n.reference),p=u(s)&&!s.equals(He.MAXIMUM_INTERVAL);if(n.delete===!0){if(!p){e[t]=void 0;return}return Lde(e[t],s)}let g,m=!1;if(d&&(u(n.referenceFrame)&&(g=Gi[n.referenceFrame]),g=x(g,Gi.FIXED),l=jj(n),f=x(l.length,1),m=f>c),!m&&!p){d?e[t]=new gl(h.unpack(l),g):e[t]=v1(r,n.reference);return}let y=e[t],b,C=n.epoch;if(u(C)&&(b=$.fromIso8601(C)),m&&!p){(!(y instanceof Ra)||u(g)&&y.referenceFrame!==g)&&(e[t]=y=new Ra(g,a)),y.addSamplesPackedArray(l,b),lk(n,y);return}let A;if(!m&&p){s=s.clone(),d?s.data=h.unpack(l):s.data=v1(r,n.reference),u(y)||(d?y=new l0(g):y=new Pa(g),e[t]=y),d&&y instanceof l0&&u(g)&&y.referenceFrame===g?y.intervals.addInterval(s):y instanceof Pa?(d&&(s.data=new gl(s.data,g)),y.intervals.addInterval(s)):(e[t]=y=Ade(y),d&&(s.data=new gl(s.data,g)),y.intervals.addInterval(s));return}u(y)?y instanceof Pa||(e[t]=y=Ade(y)):e[t]=y=new Pa(g);let T=y.intervals;A=T.findInterval(s),(!u(A)||!(A.data instanceof Ra)||u(g)&&A.data.referenceFrame!==g)&&(A=s.clone(),A.data=new Ra(g,a),T.addInterval(A)),A.data.addSamplesPackedArray(l,b),lk(n,A.data)}function Lde(e,t){if(e instanceof Ra){e.removeSamples(t);return}else if(e instanceof l0){e.intervals.removeInterval(t);return}else if(e instanceof Pa){let n=e.intervals;for(let i=0;i<n.length;++i){let o=Sn.intersect(n.get(i),t,Wx);o.isEmpty||Lde(o.data,t)}n.removeInterval(t);return}}function Nde(e,t,n,i,o,r){if(u(n))if(Array.isArray(n))for(let s=0,a=n.length;s<a;++s)Tde(e,t,n[s],i,o,r);else Tde(e,t,n,i,o,r)}function Ede(e,t,n,i){u(n.references)?fk(e,t,n.references,n.interval,i,A1,Hc):(u(n.cartesian2)?n.array=H.unpackArray(n.cartesian2):u(n.cartesian)&&(n.array=H.unpackArray(n.cartesian)),u(n.array)&&ge(Array,e,t,n,void 0,void 0,i))}function Sde(e,t,n,i,o,r){let s=lr(n.interval);u(i)&&(u(s)?s=Sn.intersect(s,i,Wx):s=i);let a=e[t],c,l;if(u(s)){a instanceof c1||(a=new c1,e[t]=a);let d=a.intervals;l=d.findInterval({start:s.start,stop:s.stop}),u(l)?c=l.data:(l=s.clone(),d.addInterval(l))}else c=a;let f;u(n.solidColor)?(c instanceof Ht||(c=new Ht),f=n.solidColor,ge(G,c,"color",f.color,void 0,void 0,r)):u(n.grid)?(c instanceof y1||(c=new y1),f=n.grid,ge(G,c,"color",f.color,void 0,o,r),ge(Number,c,"cellAlpha",f.cellAlpha,void 0,o,r),ge(H,c,"lineCount",f.lineCount,void 0,o,r),ge(H,c,"lineThickness",f.lineThickness,void 0,o,r),ge(H,c,"lineOffset",f.lineOffset,void 0,o,r)):u(n.image)?(c instanceof jy||(c=new jy),f=n.image,ge(Image,c,"image",f.image,void 0,o,r),ge(H,c,"repeat",f.repeat,void 0,o,r),ge(G,c,"color",f.color,void 0,o,r),ge(Boolean,c,"transparent",f.transparent,void 0,o,r)):u(n.stripe)?(c instanceof T1||(c=new T1),f=n.stripe,ge(um,c,"orientation",f.orientation,void 0,o,r),ge(G,c,"evenColor",f.evenColor,void 0,o,r),ge(G,c,"oddColor",f.oddColor,void 0,o,r),ge(Number,c,"offset",f.offset,void 0,o,r),ge(Number,c,"repeat",f.repeat,void 0,o,r)):u(n.polylineOutline)?(c instanceof zx||(c=new zx),f=n.polylineOutline,ge(G,c,"color",f.color,void 0,o,r),ge(G,c,"outlineColor",f.outlineColor,void 0,o,r),ge(Number,c,"outlineWidth",f.outlineWidth,void 0,o,r)):u(n.polylineGlow)?(c instanceof C1||(c=new C1),f=n.polylineGlow,ge(G,c,"color",f.color,void 0,o,r),ge(Number,c,"glowPower",f.glowPower,void 0,o,r),ge(Number,c,"taperPower",f.taperPower,void 0,o,r)):u(n.polylineArrow)?(c instanceof x1||(c=new x1),f=n.polylineArrow,ge(G,c,"color",f.color,void 0,void 0,r)):u(n.polylineDash)?(c instanceof b1||(c=new b1),f=n.polylineDash,ge(G,c,"color",f.color,void 0,void 0,r),ge(G,c,"gapColor",f.gapColor,void 0,void 0,r),ge(Number,c,"dashLength",f.dashLength,void 0,o,r),ge(Number,c,"dashPattern",f.dashPattern,void 0,o,r)):u(n.checkerboard)&&(c instanceof o1||(c=new o1),f=n.checkerboard,ge(G,c,"evenColor",f.evenColor,void 0,o,r),ge(G,c,"oddColor",f.oddColor,void 0,o,r),ge(H,c,"repeat",f.repeat,void 0,o,r)),u(l)?l.data=c:e[t]=c}function pu(e,t,n,i,o,r){if(u(n))if(Array.isArray(n))for(let s=0,a=n.length;s<a;++s)Sde(e,t,n[s],i,o,r);else Sde(e,t,n,i,o,r)}function bQe(e,t,n,i){let o=t.name;u(o)&&(e.name=t.name)}function CQe(e,t,n,i){let o=t.description;u(o)&&ge(String,e,"description",o,void 0,i,n)}function AQe(e,t,n,i){let o=t.position;u(o)&&Nde(e,"position",o,void 0,i,n)}function TQe(e,t,n,i){let o=t.viewFrom;u(o)&&ge(h,e,"viewFrom",o,void 0,i,n)}function EQe(e,t,n,i){let o=t.orientation;u(o)&&ge(Le,e,"orientation",o,void 0,i,n)}function SQe(e,t,n,i){let o=t.properties;if(u(o)){u(e.properties)||(e.properties=new Ql);for(let r in o)if(o.hasOwnProperty(r)){e.properties.hasProperty(r)||e.properties.addProperty(r);let s=o[r];if(Array.isArray(s))for(let a=0,c=s.length;a<c;++a)uk(xde(s[a]),e.properties,r,s[a],void 0,i,n);else uk(xde(s),e.properties,r,s,void 0,i,n)}}}function fk(e,t,n,i,o,r,s){let a=n.map(function(c){return v1(o,c)});if(u(i)){i=lr(i);let c=e[t];if(!(c instanceof s)){let l=new s;l.intervals.addInterval(qj(c)),e[t]=c=l}i.data=new r(a),c.intervals.addInterval(i)}else e[t]=new r(a)}function vde(e,t,n,i){let o=n.references;u(o)?fk(e,t,o,n.interval,i,A1,Hc):ge(Array,e,t,n,void 0,void 0,i)}function wde(e,t,n,i){if(u(n))if(Array.isArray(n))for(let o=0,r=n.length;o<r;++o)vde(e,t,n[o],i);else vde(e,t,n,i)}function Dde(e,t,n,i){let o=n.references;u(o)?fk(e,t,o,n.interval,i,r0,Pa):(u(n.cartesian)?n.array=h.unpackArray(n.cartesian):u(n.cartographicRadians)?n.array=h.fromRadiansArrayHeights(n.cartographicRadians,ee.default):u(n.cartographicDegrees)&&(n.array=h.fromDegreesArrayHeights(n.cartographicDegrees,ee.default)),u(n.array)&&ge(Array,e,t,n,void 0,void 0,i))}function I1(e,t,n,i){if(u(n))if(Array.isArray(n))for(let o=0,r=n.length;o<r;++o)Dde(e,t,n[o],i);else Dde(e,t,n,i)}function vQe(e){return h.unpackArray(e)}function wQe(e){return h.fromRadiansArrayHeights(e,ee.default)}function DQe(e){return h.fromDegreesArrayHeights(e,ee.default)}function Ide(e,t,n,i){let o=n.references;if(u(o)){let r=o.map(function(s){let a={};return fk(a,"positions",s,n.interval,i,r0,Pa),a.positions});e[t]=new r0(r)}else u(n.cartesian)?n.array=n.cartesian.map(vQe):u(n.cartographicRadians)?n.array=n.cartographicRadians.map(wQe):u(n.cartographicDegrees)&&(n.array=n.cartographicDegrees.map(DQe)),u(n.array)&&ge(Array,e,t,n,void 0,void 0,i)}function IQe(e,t,n,i){if(u(n))if(Array.isArray(n))for(let o=0,r=n.length;o<r;++o)Ide(e,t,n[o],i);else Ide(e,t,n,i)}function PQe(e,t,n,i){if(u(n))if(Array.isArray(n))for(let o=0,r=n.length;o<r;o++)Ede(e,t,n[o],i);else Ede(e,t,n,i)}function RQe(e,t,n,i){let o=t.availability;if(!u(o))return;let r;if(Array.isArray(o))for(let s=0,a=o.length;s<a;++s)u(r)||(r=new Xr),r.addInterval(lr(o[s]));else r=new Xr,r.addInterval(lr(o));e.availability=r}function OQe(e,t,n,i,o){u(t)&&ge(f0,e,"alignedAxis",t,n,i,o)}function MQe(e,t,n,i){let o=t.billboard;if(!u(o))return;let r=lr(o.interval),s=e.billboard;u(s)||(e.billboard=s=new Sc),ge(Boolean,s,"show",o.show,r,i,n),ge(Image,s,"image",o.image,r,i,n),ge(Number,s,"scale",o.scale,r,i,n),ge(H,s,"pixelOffset",o.pixelOffset,r,i,n),ge(h,s,"eyeOffset",o.eyeOffset,r,i,n),ge(bi,s,"horizontalOrigin",o.horizontalOrigin,r,i,n),ge(On,s,"verticalOrigin",o.verticalOrigin,r,i,n),ge(Xe,s,"heightReference",o.heightReference,r,i,n),ge(G,s,"color",o.color,r,i,n),ge(Fd,s,"rotation",o.rotation,r,i,n),OQe(s,o.alignedAxis,r,i,n),ge(Boolean,s,"sizeInMeters",o.sizeInMeters,r,i,n),ge(Number,s,"width",o.width,r,i,n),ge(Number,s,"height",o.height,r,i,n),ge(kt,s,"scaleByDistance",o.scaleByDistance,r,i,n),ge(kt,s,"translucencyByDistance",o.translucencyByDistance,r,i,n),ge(kt,s,"pixelOffsetScaleByDistance",o.pixelOffsetScaleByDistance,r,i,n),ge(qe,s,"imageSubRegion",o.imageSubRegion,r,i,n),ge(Nt,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),ge(Number,s,"disableDepthTestDistance",o.disableDepthTestDistance,r,i,n)}function LQe(e,t,n,i){let o=t.box;if(!u(o))return;let r=lr(o.interval),s=e.box;u(s)||(e.box=s=new HC),ge(Boolean,s,"show",o.show,r,i,n),ge(h,s,"dimensions",o.dimensions,r,i,n),ge(Xe,s,"heightReference",o.heightReference,r,i,n),ge(Boolean,s,"fill",o.fill,r,i,n),pu(s,"material",o.material,r,i,n),ge(Boolean,s,"outline",o.outline,r,i,n),ge(G,s,"outlineColor",o.outlineColor,r,i,n),ge(Number,s,"outlineWidth",o.outlineWidth,r,i,n),ge(xn,s,"shadows",o.shadows,r,i,n),ge(Nt,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n)}function NQe(e,t,n,i){let o=t.corridor;if(!u(o))return;let r=lr(o.interval),s=e.corridor;u(s)||(e.corridor=s=new WC),ge(Boolean,s,"show",o.show,r,i,n),I1(s,"positions",o.positions,n),ge(Number,s,"width",o.width,r,i,n),ge(Number,s,"height",o.height,r,i,n),ge(Xe,s,"heightReference",o.heightReference,r,i,n),ge(Number,s,"extrudedHeight",o.extrudedHeight,r,i,n),ge(Xe,s,"extrudedHeightReference",o.extrudedHeightReference,r,i,n),ge(ki,s,"cornerType",o.cornerType,r,i,n),ge(Number,s,"granularity",o.granularity,r,i,n),ge(Boolean,s,"fill",o.fill,r,i,n),pu(s,"material",o.material,r,i,n),ge(Boolean,s,"outline",o.outline,r,i,n),ge(G,s,"outlineColor",o.outlineColor,r,i,n),ge(Number,s,"outlineWidth",o.outlineWidth,r,i,n),ge(xn,s,"shadows",o.shadows,r,i,n),ge(Nt,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),ge(Vn,s,"classificationType",o.classificationType,r,i,n),ge(Number,s,"zIndex",o.zIndex,r,i,n)}function FQe(e,t,n,i){let o=t.cylinder;if(!u(o))return;let r=lr(o.interval),s=e.cylinder;u(s)||(e.cylinder=s=new jC),ge(Boolean,s,"show",o.show,r,i,n),ge(Number,s,"length",o.length,r,i,n),ge(Number,s,"topRadius",o.topRadius,r,i,n),ge(Number,s,"bottomRadius",o.bottomRadius,r,i,n),ge(Xe,s,"heightReference",o.heightReference,r,i,n),ge(Boolean,s,"fill",o.fill,r,i,n),pu(s,"material",o.material,r,i,n),ge(Boolean,s,"outline",o.outline,r,i,n),ge(G,s,"outlineColor",o.outlineColor,r,i,n),ge(Number,s,"outlineWidth",o.outlineWidth,r,i,n),ge(Number,s,"numberOfVerticalLines",o.numberOfVerticalLines,r,i,n),ge(Number,s,"slices",o.slices,r,i,n),ge(xn,s,"shadows",o.shadows,r,i,n),ge(Nt,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n)}function BQe(e,t){let n=e.version;if(u(n)&&typeof n=="string"){let r=n.split(".");if(r.length===2){if(r[0]!=="1")throw new ce("Cesium only supports CZML version 1.");t._version=n}}if(!u(t._version))throw new ce("CZML version information invalid.  It is expected to be a property on the document object in the <Major>.<Minor> version format.");let i=t._documentPacket;u(e.name)&&(i.name=e.name);let o=e.clock;if(u(o)){let r=i.clock;u(r)?(r.interval=x(o.interval,r.interval),r.currentTime=x(o.currentTime,r.currentTime),r.range=x(o.range,r.range),r.step=x(o.step,r.step),r.multiplier=x(o.multiplier,r.multiplier)):i.clock={interval:o.interval,currentTime:o.currentTime,range:o.range,step:o.step,multiplier:o.multiplier}}}function kQe(e,t,n,i){let o=t.ellipse;if(!u(o))return;let r=lr(o.interval),s=e.ellipse;u(s)||(e.ellipse=s=new qC),ge(Boolean,s,"show",o.show,r,i,n),ge(Number,s,"semiMajorAxis",o.semiMajorAxis,r,i,n),ge(Number,s,"semiMinorAxis",o.semiMinorAxis,r,i,n),ge(Number,s,"height",o.height,r,i,n),ge(Xe,s,"heightReference",o.heightReference,r,i,n),ge(Number,s,"extrudedHeight",o.extrudedHeight,r,i,n),ge(Xe,s,"extrudedHeightReference",o.extrudedHeightReference,r,i,n),ge(Fd,s,"rotation",o.rotation,r,i,n),ge(Fd,s,"stRotation",o.stRotation,r,i,n),ge(Number,s,"granularity",o.granularity,r,i,n),ge(Boolean,s,"fill",o.fill,r,i,n),pu(s,"material",o.material,r,i,n),ge(Boolean,s,"outline",o.outline,r,i,n),ge(G,s,"outlineColor",o.outlineColor,r,i,n),ge(Number,s,"outlineWidth",o.outlineWidth,r,i,n),ge(Number,s,"numberOfVerticalLines",o.numberOfVerticalLines,r,i,n),ge(xn,s,"shadows",o.shadows,r,i,n),ge(Nt,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),ge(Vn,s,"classificationType",o.classificationType,r,i,n),ge(Number,s,"zIndex",o.zIndex,r,i,n)}function VQe(e,t,n,i){let o=t.ellipsoid;if(!u(o))return;let r=lr(o.interval),s=e.ellipsoid;u(s)||(e.ellipsoid=s=new YC),ge(Boolean,s,"show",o.show,r,i,n),ge(h,s,"radii",o.radii,r,i,n),ge(h,s,"innerRadii",o.innerRadii,r,i,n),ge(Number,s,"minimumClock",o.minimumClock,r,i,n),ge(Number,s,"maximumClock",o.maximumClock,r,i,n),ge(Number,s,"minimumCone",o.minimumCone,r,i,n),ge(Number,s,"maximumCone",o.maximumCone,r,i,n),ge(Xe,s,"heightReference",o.heightReference,r,i,n),ge(Boolean,s,"fill",o.fill,r,i,n),pu(s,"material",o.material,r,i,n),ge(Boolean,s,"outline",o.outline,r,i,n),ge(G,s,"outlineColor",o.outlineColor,r,i,n),ge(Number,s,"outlineWidth",o.outlineWidth,r,i,n),ge(Number,s,"stackPartitions",o.stackPartitions,r,i,n),ge(Number,s,"slicePartitions",o.slicePartitions,r,i,n),ge(Number,s,"subdivisions",o.subdivisions,r,i,n),ge(xn,s,"shadows",o.shadows,r,i,n),ge(Nt,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n)}function UQe(e,t,n,i){let o=t.label;if(!u(o))return;let r=lr(o.interval),s=e.label;u(s)||(e.label=s=new Mh),ge(Boolean,s,"show",o.show,r,i,n),ge(String,s,"text",o.text,r,i,n),ge(String,s,"font",o.font,r,i,n),ge($o,s,"style",o.style,r,i,n),ge(Number,s,"scale",o.scale,r,i,n),ge(Boolean,s,"showBackground",o.showBackground,r,i,n),ge(G,s,"backgroundColor",o.backgroundColor,r,i,n),ge(H,s,"backgroundPadding",o.backgroundPadding,r,i,n),ge(H,s,"pixelOffset",o.pixelOffset,r,i,n),ge(h,s,"eyeOffset",o.eyeOffset,r,i,n),ge(bi,s,"horizontalOrigin",o.horizontalOrigin,r,i,n),ge(On,s,"verticalOrigin",o.verticalOrigin,r,i,n),ge(Xe,s,"heightReference",o.heightReference,r,i,n),ge(G,s,"fillColor",o.fillColor,r,i,n),ge(G,s,"outlineColor",o.outlineColor,r,i,n),ge(Number,s,"outlineWidth",o.outlineWidth,r,i,n),ge(kt,s,"translucencyByDistance",o.translucencyByDistance,r,i,n),ge(kt,s,"pixelOffsetScaleByDistance",o.pixelOffsetScaleByDistance,r,i,n),ge(kt,s,"scaleByDistance",o.scaleByDistance,r,i,n),ge(Nt,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),ge(Number,s,"disableDepthTestDistance",o.disableDepthTestDistance,r,i,n)}function zQe(e,t,n,i){let o=t.model;if(!u(o))return;let r=lr(o.interval),s=e.model;u(s)||(e.model=s=new Z_),ge(Boolean,s,"show",o.show,r,i,n),ge(D1.default,s,"uri",o.gltf,r,i,n),ge(Number,s,"scale",o.scale,r,i,n),ge(Number,s,"minimumPixelSize",o.minimumPixelSize,r,i,n),ge(Number,s,"maximumScale",o.maximumScale,r,i,n),ge(Boolean,s,"incrementallyLoadTextures",o.incrementallyLoadTextures,r,i,n),ge(Boolean,s,"runAnimations",o.runAnimations,r,i,n),ge(Boolean,s,"clampAnimations",o.clampAnimations,r,i,n),ge(xn,s,"shadows",o.shadows,r,i,n),ge(Xe,s,"heightReference",o.heightReference,r,i,n),ge(G,s,"silhouetteColor",o.silhouetteColor,r,i,n),ge(Number,s,"silhouetteSize",o.silhouetteSize,r,i,n),ge(G,s,"color",o.color,r,i,n),ge(Bc,s,"colorBlendMode",o.colorBlendMode,r,i,n),ge(Number,s,"colorBlendAmount",o.colorBlendAmount,r,i,n),ge(Nt,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n);let a,c,l=o.nodeTransformations;if(u(l))if(Array.isArray(l))for(a=0,c=l.length;a<c;++a)Pde(s,l[a],r,i,n);else Pde(s,l,r,i,n);let f=o.articulations;if(u(f))if(Array.isArray(f))for(a=0,c=f.length;a<c;++a)Rde(s,f[a],r,i,n);else Rde(s,f,r,i,n)}function Pde(e,t,n,i,o){let r=lr(t.interval);u(n)&&(u(r)?r=Sn.intersect(r,n,Wx):r=n);let s=e.nodeTransformations,a=Object.keys(t);for(let c=0,l=a.length;c<l;++c){let f=a[c];if(f==="interval")continue;let d=t[f];if(!u(d))continue;u(s)||(e.nodeTransformations=s=new Ql),s.hasProperty(f)||s.addProperty(f);let p=s[f];u(p)||(s[f]=p=new XC),ge(h,p,"translation",d.translation,r,i,o),ge(Le,p,"rotation",d.rotation,r,i,o),ge(h,p,"scale",d.scale,r,i,o)}}function Rde(e,t,n,i,o){let r=lr(t.interval);u(n)&&(u(r)?r=Sn.intersect(r,n,Wx):r=n);let s=e.articulations,a=Object.keys(t);for(let c=0,l=a.length;c<l;++c){let f=a[c];if(f==="interval")continue;let d=t[f];u(d)&&(u(s)||(e.articulations=s=new Ql),s.hasProperty(f)||s.addProperty(f),ge(Number,s,f,d,r,i,o))}}function HQe(e,t,n,i){let o=t.path;if(!u(o))return;let r=lr(o.interval),s=e.path;u(s)||(e.path=s=new $_),ge(Boolean,s,"show",o.show,r,i,n),ge(Number,s,"leadTime",o.leadTime,r,i,n),ge(Number,s,"trailTime",o.trailTime,r,i,n),ge(Number,s,"width",o.width,r,i,n),ge(Number,s,"resolution",o.resolution,r,i,n),pu(s,"material",o.material,r,i,n),ge(Nt,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n)}function GQe(e,t,n,i){let o=t.point;if(!u(o))return;let r=lr(o.interval),s=e.point;u(s)||(e.point=s=new ZC),ge(Boolean,s,"show",o.show,r,i,n),ge(Number,s,"pixelSize",o.pixelSize,r,i,n),ge(Xe,s,"heightReference",o.heightReference,r,i,n),ge(G,s,"color",o.color,r,i,n),ge(G,s,"outlineColor",o.outlineColor,r,i,n),ge(Number,s,"outlineWidth",o.outlineWidth,r,i,n),ge(kt,s,"scaleByDistance",o.scaleByDistance,r,i,n),ge(kt,s,"translucencyByDistance",o.translucencyByDistance,r,i,n),ge(Nt,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),ge(Number,s,"disableDepthTestDistance",o.disableDepthTestDistance,r,i,n)}function w1(e){this.polygon=e,this._definitionChanged=new me}Object.defineProperties(w1.prototype,{isConstant:{get:function(){let e=this.polygon._positions,t=this.polygon._holes;return(!u(e)||e.isConstant)&&(!u(t)||t.isConstant)}},definitionChanged:{get:function(){return this._definitionChanged}}});w1.prototype.getValue=function(e,t){let n;u(this.polygon._positions)&&(n=this.polygon._positions.getValue(e));let i;return u(this.polygon._holes)&&(i=this.polygon._holes.getValue(e),u(i)&&(i=i.map(function(o){return new Za(o)}))),u(t)?(t.positions=n,t.holes=i,t):new Za(n,i)};w1.prototype.equals=function(e){return this===e||e instanceof w1&&Y.equals(this.polygon._positions,e.polygon._positions)&&Y.equals(this.polygon._holes,e.polygon._holes)};function WQe(e,t,n,i){let o=t.polygon;if(!u(o))return;let r=lr(o.interval),s=e.polygon;u(s)||(e.polygon=s=new Lh),ge(Boolean,s,"show",o.show,r,i,n),I1(s,"_positions",o.positions,n),IQe(s,"_holes",o.holes,n),(u(s._positions)||u(s._holes))&&(s.hierarchy=new w1(s)),ge(Number,s,"height",o.height,r,i,n),ge(Xe,s,"heightReference",o.heightReference,r,i,n),ge(Number,s,"extrudedHeight",o.extrudedHeight,r,i,n),ge(Xe,s,"extrudedHeightReference",o.extrudedHeightReference,r,i,n),ge(Fd,s,"stRotation",o.stRotation,r,i,n),ge(Number,s,"granularity",o.granularity,r,i,n),ge(Boolean,s,"fill",o.fill,r,i,n),pu(s,"material",o.material,r,i,n),ge(Boolean,s,"outline",o.outline,r,i,n),ge(G,s,"outlineColor",o.outlineColor,r,i,n),ge(Number,s,"outlineWidth",o.outlineWidth,r,i,n),ge(Boolean,s,"perPositionHeight",o.perPositionHeight,r,i,n),ge(Boolean,s,"closeTop",o.closeTop,r,i,n),ge(Boolean,s,"closeBottom",o.closeBottom,r,i,n),ge(nn,s,"arcType",o.arcType,r,i,n),ge(xn,s,"shadows",o.shadows,r,i,n),ge(Nt,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),ge(Vn,s,"classificationType",o.classificationType,r,i,n),ge(Number,s,"zIndex",o.zIndex,r,i,n)}function jQe(e){return e?nn.GEODESIC:nn.NONE}function qQe(e,t,n,i){let o=t.polyline;if(!u(o))return;let r=lr(o.interval),s=e.polyline;if(u(s)||(e.polyline=s=new Pc),ge(Boolean,s,"show",o.show,r,i,n),I1(s,"positions",o.positions,n),ge(Number,s,"width",o.width,r,i,n),ge(Number,s,"granularity",o.granularity,r,i,n),pu(s,"material",o.material,r,i,n),pu(s,"depthFailMaterial",o.depthFailMaterial,r,i,n),ge(nn,s,"arcType",o.arcType,r,i,n),ge(Boolean,s,"clampToGround",o.clampToGround,r,i,n),ge(xn,s,"shadows",o.shadows,r,i,n),ge(Nt,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),ge(Vn,s,"classificationType",o.classificationType,r,i,n),ge(Number,s,"zIndex",o.zIndex,r,i,n),u(o.followSurface)&&!u(o.arcType)){let a={};ge(Boolean,a,"followSurface",o.followSurface,r,i,n),s.arcType=lQe(a.followSurface,jQe)}}function YQe(e,t,n,i){let o=t.polylineVolume;if(!u(o))return;let r=lr(o.interval),s=e.polylineVolume;u(s)||(e.polylineVolume=s=new $C),I1(s,"positions",o.positions,n),PQe(s,"shape",o.shape,n),ge(Boolean,s,"show",o.show,r,i,n),ge(ki,s,"cornerType",o.cornerType,r,i,n),ge(Boolean,s,"fill",o.fill,r,i,n),pu(s,"material",o.material,r,i,n),ge(Boolean,s,"outline",o.outline,r,i,n),ge(G,s,"outlineColor",o.outlineColor,r,i,n),ge(Number,s,"outlineWidth",o.outlineWidth,r,i,n),ge(Number,s,"granularity",o.granularity,r,i,n),ge(xn,s,"shadows",o.shadows,r,i,n),ge(Nt,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n)}function XQe(e,t,n,i){let o=t.rectangle;if(!u(o))return;let r=lr(o.interval),s=e.rectangle;u(s)||(e.rectangle=s=new Nh),ge(Boolean,s,"show",o.show,r,i,n),ge(se,s,"coordinates",o.coordinates,r,i,n),ge(Number,s,"height",o.height,r,i,n),ge(Xe,s,"heightReference",o.heightReference,r,i,n),ge(Number,s,"extrudedHeight",o.extrudedHeight,r,i,n),ge(Xe,s,"extrudedHeightReference",o.extrudedHeightReference,r,i,n),ge(Fd,s,"rotation",o.rotation,r,i,n),ge(Fd,s,"stRotation",o.stRotation,r,i,n),ge(Number,s,"granularity",o.granularity,r,i,n),ge(Boolean,s,"fill",o.fill,r,i,n),pu(s,"material",o.material,r,i,n),ge(Boolean,s,"outline",o.outline,r,i,n),ge(G,s,"outlineColor",o.outlineColor,r,i,n),ge(Number,s,"outlineWidth",o.outlineWidth,r,i,n),ge(xn,s,"shadows",o.shadows,r,i,n),ge(Nt,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),ge(Vn,s,"classificationType",o.classificationType,r,i,n),ge(Number,s,"zIndex",o.zIndex,r,i,n)}function KQe(e,t,n,i){let o=t.tileset;if(!u(o))return;let r=lr(o.interval),s=e.tileset;u(s)||(e.tileset=s=new KC),ge(Boolean,s,"show",o.show,r,i,n),ge(D1.default,s,"uri",o.uri,r,i,n),ge(Number,s,"maximumScreenSpaceError",o.maximumScreenSpaceError,r,i,n)}function ZQe(e,t,n,i){let o=t.wall;if(!u(o))return;let r=lr(o.interval),s=e.wall;u(s)||(e.wall=s=new Q_),ge(Boolean,s,"show",o.show,r,i,n),I1(s,"positions",o.positions,n),wde(s,"minimumHeights",o.minimumHeights,n),wde(s,"maximumHeights",o.maximumHeights,n),ge(Number,s,"granularity",o.granularity,r,i,n),ge(Boolean,s,"fill",o.fill,r,i,n),pu(s,"material",o.material,r,i,n),ge(Boolean,s,"outline",o.outline,r,i,n),ge(G,s,"outlineColor",o.outlineColor,r,i,n),ge(Number,s,"outlineWidth",o.outlineWidth,r,i,n),ge(xn,s,"shadows",o.shadows,r,i,n),ge(Nt,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n)}function Ode(e,t,n,i,o){let r=e.id;if(u(r)||(r=Hn()),Wj=r,!u(o._version)&&r!=="document")throw new ce("The first CZML packet is required to be the document object.");if(e.delete===!0)t.removeById(r);else if(r==="document")BQe(e,o);else{let s=t.getOrCreateEntity(r),a=e.parent;u(a)&&(s.parent=t.getOrCreateEntity(a));for(let c=n.length-1;c>-1;c--)n[c](s,e,t,i)}Wj=void 0}function $Qe(e){let t,n=e._documentPacket.clock;if(!u(n)){if(!u(e._clock)){let o=e._entityCollection.computeAvailability();if(!o.start.equals(He.MINIMUM_VALUE)){let r=o.start,s=o.stop,a=$.secondsDifference(s,r),c=Math.round(a/120);return t=new lm,t.startTime=$.clone(r),t.stopTime=$.clone(s),t.clockRange=Zr.LOOP_STOP,t.multiplier=c,t.currentTime=$.clone(r),t.clockStep=Ao.SYSTEM_CLOCK_MULTIPLIER,e._clock=t,!0}}return!1}u(e._clock)?t=e._clock.clone():(t=new lm,t.startTime=He.MINIMUM_VALUE.clone(),t.stopTime=He.MAXIMUM_VALUE.clone(),t.currentTime=He.MINIMUM_VALUE.clone(),t.clockRange=Zr.LOOP_STOP,t.clockStep=Ao.SYSTEM_CLOCK_MULTIPLIER,t.multiplier=1);let i=lr(n.interval);return u(i)&&(t.startTime=i.start,t.stopTime=i.stop),u(n.currentTime)&&(t.currentTime=$.fromIso8601(n.currentTime)),u(n.range)&&(t.clockRange=x(Zr[n.range],Zr.LOOP_STOP)),u(n.step)&&(t.clockStep=x(Ao[n.step],Ao.SYSTEM_CLOCK_MULTIPLIER)),u(n.multiplier)&&(t.multiplier=n.multiplier),t.equals(e._clock)?!1:(e._clock=t.clone(e._clock),!0)}function Fde(e,t,n,i){n=x(n,x.EMPTY_OBJECT);let o=t,r=n.sourceUri,s=n.credit;if(typeof s=="string"&&(s=new wt(s)),e._credit=s,typeof t=="string"||t instanceof De){t=De.createIfNeeded(t),o=t.fetchJson(),r=x(r,t.clone());let a=e._resourceCredits,c=t.credits;if(u(c)){let l=c.length;for(let f=0;f<l;f++)a.push(c[f])}}return r=De.createIfNeeded(r),Kr.setLoading(e,!0),Promise.resolve(o).then(function(a){return QQe(e,a,r,i)}).catch(function(a){return Kr.setLoading(e,!1),e._error.raiseEvent(e,a),console.log(a),Promise.reject(a)})}function QQe(e,t,n,i){Kr.setLoading(e,!0);let o=e._entityCollection;i&&(e._version=void 0,e._documentPacket=new Bde,o.removeAll()),us._processCzml(t,o,n,void 0,e);let r=$Qe(e),s=e._documentPacket;return u(s.name)&&e._name!==s.name?(e._name=s.name,r=!0):!u(e._name)&&u(n)&&(e._name=o0(n.getUrlComponent()),r=!0),Kr.setLoading(e,!1),r&&e._changed.raiseEvent(e),e}function Bde(){this.name=void 0,this.clock=void 0}function us(e){this._name=e,this._changed=new me,this._error=new me,this._isLoading=!1,this._loading=new me,this._clock=void 0,this._documentPacket=new Bde,this._version=void 0,this._entityCollection=new la(this),this._entityCluster=new Mf,this._credit=void 0,this._resourceCredits=[]}us.load=function(e,t){return new us().load(e,t)};Object.defineProperties(us.prototype,{name:{get:function(){return this._name}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}},credit:{get:function(){return this._credit}}});us.updaters=[MQe,LQe,NQe,FQe,kQe,VQe,UQe,zQe,bQe,CQe,HQe,GQe,WQe,qQe,YQe,SQe,XQe,AQe,KQe,TQe,ZQe,EQe,RQe];us.registerUpdater=function(e){us.updaters.includes(e)||us.updaters.push(e)};us.unregisterUpdater=function(e){if(us.updaters.includes(e)){let t=us.updaters.indexOf(e);us.updaters.splice(t,1)}};us.prototype.process=function(e,t){return Fde(this,e,t,!1)};us.prototype.load=function(e,t){return Fde(this,e,t,!0)};us.prototype.update=function(e){return!0};us.processPacketData=ge;us.processPositionPacketData=Nde;us.processMaterialPacketData=pu;us._processCzml=function(e,t,n,i,o){if(i=x(i,us.updaters),Array.isArray(e))for(let r=0,s=e.length;r<s;++r)Ode(e[r],t,i,n,o);else Ode(e,t,i,n,o)};var dk=us;function qc(){this._dataSources=[],this._dataSourceAdded=new me,this._dataSourceRemoved=new me,this._dataSourceMoved=new me}Object.defineProperties(qc.prototype,{length:{get:function(){return this._dataSources.length}},dataSourceAdded:{get:function(){return this._dataSourceAdded}},dataSourceRemoved:{get:function(){return this._dataSourceRemoved}},dataSourceMoved:{get:function(){return this._dataSourceMoved}}});qc.prototype.add=function(e){let t=this,n=this._dataSources;return Promise.resolve(e).then(function(i){return n===t._dataSources&&(t._dataSources.push(i),t._dataSourceAdded.raiseEvent(t,i)),i})};qc.prototype.remove=function(e,t){t=x(t,!1);let n=this._dataSources.indexOf(e);return n!==-1?(this._dataSources.splice(n,1),this._dataSourceRemoved.raiseEvent(this,e),t&&typeof e.destroy=="function"&&e.destroy(),!0):!1};qc.prototype.removeAll=function(e){e=x(e,!1);let t=this._dataSources;for(let n=0,i=t.length;n<i;++n){let o=t[n];this._dataSourceRemoved.raiseEvent(this,o),e&&typeof o.destroy=="function"&&o.destroy()}this._dataSources=[]};qc.prototype.contains=function(e){return this.indexOf(e)!==-1};qc.prototype.indexOf=function(e){return this._dataSources.indexOf(e)};qc.prototype.get=function(e){return this._dataSources[e]};qc.prototype.getByName=function(e){return this._dataSources.filter(function(t){return t.name===e})};function hk(e,t){return e.indexOf(t)}function kde(e,t,n){let i=e._dataSources,o=i.length-1;if(t=R.clamp(t,0,o),n=R.clamp(n,0,o),t===n)return;let r=i[t];i[t]=i[n],i[n]=r,e.dataSourceMoved.raiseEvent(r,n,t)}qc.prototype.raise=function(e){let t=hk(this._dataSources,e);kde(this,t,t+1)};qc.prototype.lower=function(e){let t=hk(this._dataSources,e);kde(this,t,t-1)};qc.prototype.raiseToTop=function(e){let t=hk(this._dataSources,e);t!==this._dataSources.length-1&&(this._dataSources.splice(t,1),this._dataSources.push(e),this.dataSourceMoved.raiseEvent(e,this._dataSources.length-1,t))};qc.prototype.lowerToBottom=function(e){let t=hk(this._dataSources,e);t!==0&&(this._dataSources.splice(t,1),this._dataSources.splice(0,0,e),this.dataSourceMoved.raiseEvent(e,0,t))};qc.prototype.isDestroyed=function(){return!1};qc.prototype.destroy=function(){return this.removeAll(!0),ue(this)};var mk=qc;function fa(e){e=x(e,x.EMPTY_OBJECT),this._primitives=[],this._guid=Hn(),this._primitiveAdded=new me,this._primitiveRemoved=new me,this._zIndex=void 0,this.show=x(e.show,!0),this.destroyPrimitives=x(e.destroyPrimitives,!0)}Object.defineProperties(fa.prototype,{length:{get:function(){return this._primitives.length}},primitiveAdded:{get:function(){return this._primitiveAdded}},primitiveRemoved:{get:function(){return this._primitiveRemoved}}});fa.prototype.add=function(e,t){let n=u(t),i=e._external=e._external||{},o=i._composites=i._composites||{};return o[this._guid]={collection:this},n?this._primitives.splice(t,0,e):this._primitives.push(e),this._primitiveAdded.raiseEvent(e),e};fa.prototype.remove=function(e){if(this.contains(e)){let t=this._primitives.indexOf(e);if(t!==-1)return this._primitives.splice(t,1),delete e._external._composites[this._guid],this.destroyPrimitives&&e.destroy(),this._primitiveRemoved.raiseEvent(e),!0}return!1};fa.prototype.removeAndDestroy=function(e){let t=this.remove(e);return t&&!this.destroyPrimitives&&e.destroy(),t};fa.prototype.removeAll=function(){let e=this._primitives,t=e.length;for(let n=0;n<t;++n)delete e[n]._external._composites[this._guid],this.destroyPrimitives&&e[n].destroy(),this._primitiveRemoved.raiseEvent(e[n]);this._primitives=[]};fa.prototype.contains=function(e){return!!(u(e)&&e._external&&e._external._composites&&e._external._composites[this._guid])};function pk(e,t){return e._primitives.indexOf(t)}fa.prototype.raise=function(e){if(u(e)){let t=pk(this,e),n=this._primitives;if(t!==n.length-1){let i=n[t];n[t]=n[t+1],n[t+1]=i}}};fa.prototype.raiseToTop=function(e){if(u(e)){let t=pk(this,e),n=this._primitives;t!==n.length-1&&(n.splice(t,1),n.push(e))}};fa.prototype.lower=function(e){if(u(e)){let t=pk(this,e),n=this._primitives;if(t!==0){let i=n[t];n[t]=n[t-1],n[t-1]=i}}};fa.prototype.lowerToBottom=function(e){if(u(e)){let t=pk(this,e),n=this._primitives;t!==0&&(n.splice(t,1),n.unshift(e))}};fa.prototype.get=function(e){return this._primitives[e]};fa.prototype.update=function(e){if(!this.show)return;let t=this._primitives;for(let n=0;n<t.length;++n)t[n].update(e)};fa.prototype.prePassesUpdate=function(e){let t=this._primitives;for(let n=0;n<t.length;++n){let i=t[n];u(i.prePassesUpdate)&&i.prePassesUpdate(e)}};fa.prototype.updateForPass=function(e,t){let n=this._primitives;for(let i=0;i<n.length;++i){let o=n[i];u(o.updateForPass)&&o.updateForPass(e,t)}};fa.prototype.postPassesUpdate=function(e){let t=this._primitives;for(let n=0;n<t.length;++n){let i=t[n];u(i.postPassesUpdate)&&i.postPassesUpdate(e)}};fa.prototype.isDestroyed=function(){return!1};fa.prototype.destroy=function(){return this.removeAll(),ue(this)};var _u=fa;function fm(){this._length=0,this._collections={},this._collectionsArray=[],this.show=!0}Object.defineProperties(fm.prototype,{length:{get:function(){return this._length}}});fm.prototype.add=function(e,t){t=x(t,0);let n=this._collections[t];if(!u(n)){n=new _u({destroyPrimitives:!1}),n._zIndex=t,this._collections[t]=n;let i=this._collectionsArray,o=0;for(;o<i.length&&i[o]._zIndex<t;)o++;i.splice(o,0,n)}return n.add(e),this._length++,e._zIndex=t,e};fm.prototype.set=function(e,t){return t===e._zIndex||(this.remove(e,!0),this.add(e,t)),e};fm.prototype.remove=function(e,t){if(this.contains(e)){let n=e._zIndex,i=this._collections[n],o;return t?o=i.remove(e):o=i.removeAndDestroy(e),o&&this._length--,i.length===0&&(this._collectionsArray.splice(this._collectionsArray.indexOf(i),1),this._collections[n]=void 0,i.destroy()),o}return!1};fm.prototype.removeAll=function(){let e=this._collectionsArray;for(let t=0;t<e.length;t++){let n=e[t];n.destroyPrimitives=!0,n.destroy()}this._collections={},this._collectionsArray=[],this._length=0};fm.prototype.contains=function(e){if(!u(e))return!1;let t=this._collections[e._zIndex];return u(t)&&t.contains(e)};fm.prototype.update=function(e){if(!this.show)return;let t=this._collectionsArray;for(let n=0;n<t.length;n++)t[n].update(e)};fm.prototype.isDestroyed=function(){return!1};fm.prototype.destroy=function(){return this.removeAll(),ue(this)};var _k=fm;function MT(e,t){this._primitives=e,this._orderedGroundPrimitives=t,this._dynamicUpdaters=new St}MT.prototype.add=function(e,t){this._dynamicUpdaters.set(t.id,t.createDynamicUpdater(this._primitives,this._orderedGroundPrimitives))};MT.prototype.remove=function(e){let t=e.id,n=this._dynamicUpdaters.get(t);u(n)&&(this._dynamicUpdaters.remove(t),n.destroy())};MT.prototype.update=function(e){let t=this._dynamicUpdaters.values;for(let n=0,i=t.length;n<i;n++)t[n].update(e);return!0};MT.prototype.removeAllPrimitives=function(){let e=this._dynamicUpdaters.values;for(let t=0,n=e.length;t<n;t++)e[t].destroy();this._dynamicUpdaters.removeAll()};MT.prototype.getBoundingSphere=function(e,t){return e=this._dynamicUpdaters.get(e.id),u(e)&&u(e.getBoundingSphere)?e.getBoundingSphere(t):dt.FAILED};var LT=MT;var Xj={},gk=new h,Vde=new h,Ude=new Le,zde=new J;function NT(e,t,n,i,o,r,s,a,c,l){let f=e+t;h.multiplyByScalar(i,Math.cos(f),gk),h.multiplyByScalar(n,Math.sin(f),Vde),h.add(gk,Vde,gk);let d=Math.cos(e);d=d*d;let p=Math.sin(e);p=p*p;let m=r/Math.sqrt(s*d+o*p)/a;return Le.fromAxisAngle(gk,m,Ude),J.fromQuaternion(Ude,zde),J.multiplyByVector(zde,c,l),h.normalize(l,l),h.multiplyByScalar(l,a,l),l}var Hde=new h,Gde=new h,Yj=new h,JQe=new h;Xj.raisePositionsToHeight=function(e,t,n){let i=t.ellipsoid,o=t.height,r=t.extrudedHeight,s=n?e.length/3*2:e.length/3,a=new Float64Array(s*3),c=e.length,l=n?c:0;for(let f=0;f<c;f+=3){let d=f+1,p=f+2,g=h.fromArray(e,f,Hde);i.scaleToGeodeticSurface(g,g);let m=h.clone(g,Gde),y=i.geodeticSurfaceNormal(g,JQe),b=h.multiplyByScalar(y,o,Yj);h.add(g,b,g),n&&(h.multiplyByScalar(y,r,b),h.add(m,b,m),a[f+l]=m.x,a[d+l]=m.y,a[p+l]=m.z),a[f]=g.x,a[d]=g.y,a[p]=g.z}return a};var eJe=new h,tJe=new h,nJe=new h;Xj.computeEllipsePositions=function(e,t,n){let i=e.semiMinorAxis,o=e.semiMajorAxis,r=e.rotation,s=e.center,a=e.granularity*8,c=i*i,l=o*o,f=o*i,d=h.magnitude(s),p=h.normalize(s,eJe),g=h.cross(h.UNIT_Z,s,tJe);g=h.normalize(g,g);let m=h.cross(p,g,nJe),y=1+Math.ceil(R.PI_OVER_TWO/a),b=R.PI_OVER_TWO/(y-1),C=R.PI_OVER_TWO-y*b;C<0&&(y-=Math.ceil(Math.abs(C)/b));let A=2*(y*(y+2)),T=t?new Array(A*3):void 0,E=0,v=Hde,D=Gde,O=y*4*3,P=O-1,M=0,L=n?new Array(O):void 0,_,S,w,I,N;for(C=R.PI_OVER_TWO,v=NT(C,r,m,g,c,f,l,d,p,v),t&&(T[E++]=v.x,T[E++]=v.y,T[E++]=v.z),n&&(L[P--]=v.z,L[P--]=v.y,L[P--]=v.x),C=R.PI_OVER_TWO-b,_=1;_<y+1;++_){if(v=NT(C,r,m,g,c,f,l,d,p,v),D=NT(Math.PI-C,r,m,g,c,f,l,d,p,D),t){for(T[E++]=v.x,T[E++]=v.y,T[E++]=v.z,w=2*_+2,S=1;S<w-1;++S)I=S/(w-1),N=h.lerp(v,D,I,Yj),T[E++]=N.x,T[E++]=N.y,T[E++]=N.z;T[E++]=D.x,T[E++]=D.y,T[E++]=D.z}n&&(L[P--]=v.z,L[P--]=v.y,L[P--]=v.x,L[M++]=D.x,L[M++]=D.y,L[M++]=D.z),C=R.PI_OVER_TWO-(_+1)*b}for(_=y;_>1;--_){if(C=R.PI_OVER_TWO-(_-1)*b,v=NT(-C,r,m,g,c,f,l,d,p,v),D=NT(C+Math.PI,r,m,g,c,f,l,d,p,D),t){for(T[E++]=v.x,T[E++]=v.y,T[E++]=v.z,w=2*(_-1)+2,S=1;S<w-1;++S)I=S/(w-1),N=h.lerp(v,D,I,Yj),T[E++]=N.x,T[E++]=N.y,T[E++]=N.z;T[E++]=D.x,T[E++]=D.y,T[E++]=D.z}n&&(L[P--]=v.z,L[P--]=v.y,L[P--]=v.x,L[M++]=D.x,L[M++]=D.y,L[M++]=D.z)}C=R.PI_OVER_TWO,v=NT(-C,r,m,g,c,f,l,d,p,v);let k={};return t&&(T[E++]=v.x,T[E++]=v.y,T[E++]=v.z,k.positions=T,k.numPts=y),n&&(L[P--]=v.z,L[P--]=v.y,L[P--]=v.x,k.outerPositions=L),k};var gu=Xj;var FT=new h,Kj=new h,Zj=new h,Wde=new h,Es=new H,jde=new J,iJe=new J,$j=new Le,qde=new h,Yde=new h,Xde=new h,bk=new de,Kde=new h,Zde=new H,$de=new H;function Qde(e,t,n){let i=t.vertexFormat,o=t.center,r=t.semiMajorAxis,s=t.semiMinorAxis,a=t.ellipsoid,c=t.stRotation,l=n?e.length/3*2:e.length/3,f=t.shadowVolume,d=i.st?new Float32Array(l*2):void 0,p=i.normal?new Float32Array(l*3):void 0,g=i.tangent?new Float32Array(l*3):void 0,m=i.bitangent?new Float32Array(l*3):void 0,y=f?new Float32Array(l*3):void 0,b=0,C=qde,A=Yde,T=Xde,E=new Oi(a),v=E.project(a.cartesianToCartographic(o,bk),Kde),D=a.scaleToGeodeticSurface(o,FT);a.geodeticSurfaceNormal(D,D);let O=jde,P=iJe;if(c!==0){let N=Le.fromAxisAngle(D,c,$j);O=J.fromQuaternion(N,O),N=Le.fromAxisAngle(D,-c,$j),P=J.fromQuaternion(N,P)}else O=J.clone(J.IDENTITY,O),P=J.clone(J.IDENTITY,P);let M=H.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Zde),L=H.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,$de),_=e.length,S=n?_:0,w=S/3*2;for(let N=0;N<_;N+=3){let k=N+1,z=N+2,V=h.fromArray(e,N,FT);if(i.st){let U=J.multiplyByVector(O,V,Kj),B=E.project(a.cartesianToCartographic(U,bk),Zj);h.subtract(B,v,B),Es.x=(B.x+r)/(2*r),Es.y=(B.y+s)/(2*s),M.x=Math.min(Es.x,M.x),M.y=Math.min(Es.y,M.y),L.x=Math.max(Es.x,L.x),L.y=Math.max(Es.y,L.y),n&&(d[b+w]=Es.x,d[b+1+w]=Es.y),d[b++]=Es.x,d[b++]=Es.y}(i.normal||i.tangent||i.bitangent||f)&&(C=a.geodeticSurfaceNormal(V,C),f&&(y[N+S]=-C.x,y[k+S]=-C.y,y[z+S]=-C.z),(i.normal||i.tangent||i.bitangent)&&((i.tangent||i.bitangent)&&(A=h.normalize(h.cross(h.UNIT_Z,C,A),A),J.multiplyByVector(P,A,A)),i.normal&&(p[N]=C.x,p[k]=C.y,p[z]=C.z,n&&(p[N+S]=-C.x,p[k+S]=-C.y,p[z+S]=-C.z)),i.tangent&&(g[N]=A.x,g[k]=A.y,g[z]=A.z,n&&(g[N+S]=-A.x,g[k+S]=-A.y,g[z+S]=-A.z)),i.bitangent&&(T=h.normalize(h.cross(C,A,T),T),m[N]=T.x,m[k]=T.y,m[z]=T.z,n&&(m[N+S]=T.x,m[k+S]=T.y,m[z+S]=T.z))))}if(i.st){_=d.length;for(let N=0;N<_;N+=2)d[N]=(d[N]-M.x)/(L.x-M.x),d[N+1]=(d[N+1]-M.y)/(L.y-M.y)}let I=new hn;if(i.position){let N=gu.raisePositionsToHeight(e,t,n);I.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:N})}if(i.st&&(I.st=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:d})),i.normal&&(I.normal=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:p})),i.tangent&&(I.tangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:g})),i.bitangent&&(I.bitangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:m})),f&&(I.extrudeDirection=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:y})),n&&u(t.offsetAttribute)){let N=new Uint8Array(l);if(t.offsetAttribute===an.TOP)N=N.fill(1,0,l/2);else{let k=t.offsetAttribute===an.NONE?0:1;N=N.fill(k)}I.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:N})}return I}function Jde(e){let t=new Array(12*(e*(e+1))-6),n=0,i,o,r,s,a;for(i=0,r=1,s=0;s<3;s++)t[n++]=r++,t[n++]=i,t[n++]=r;for(s=2;s<e+1;++s){for(r=s*(s+1)-1,i=(s-1)*s-1,t[n++]=r++,t[n++]=i,t[n++]=r,o=2*s,a=0;a<o-1;++a)t[n++]=r,t[n++]=i++,t[n++]=i,t[n++]=r++,t[n++]=i,t[n++]=r;t[n++]=r++,t[n++]=i,t[n++]=r}for(o=e*2,++r,++i,s=0;s<o-1;++s)t[n++]=r,t[n++]=i++,t[n++]=i,t[n++]=r++,t[n++]=i,t[n++]=r;for(t[n++]=r,t[n++]=i++,t[n++]=i,t[n++]=r++,t[n++]=i++,t[n++]=i,++i,s=e-1;s>1;--s){for(t[n++]=i++,t[n++]=i,t[n++]=r,o=2*s,a=0;a<o-1;++a)t[n++]=r,t[n++]=i++,t[n++]=i,t[n++]=r++,t[n++]=i,t[n++]=r;t[n++]=i++,t[n++]=i++,t[n++]=r++}for(s=0;s<3;s++)t[n++]=i++,t[n++]=i,t[n++]=r;return t}var jx=new h;function oJe(e){let t=e.center;jx=h.multiplyByScalar(e.ellipsoid.geodeticSurfaceNormal(t,jx),e.height,jx),jx=h.add(t,jx,jx);let n=new ae(jx,e.semiMajorAxis),i=gu.computeEllipsePositions(e,!0,!1),o=i.positions,r=i.numPts,s=Qde(o,e,!1),a=Jde(r);return a=Be.createTypedArray(o.length/3,a),{boundingSphere:n,attributes:s,indices:a}}function rJe(e,t){let n=t.vertexFormat,i=t.center,o=t.semiMajorAxis,r=t.semiMinorAxis,s=t.ellipsoid,a=t.height,c=t.extrudedHeight,l=t.stRotation,f=e.length/3*2,d=new Float64Array(f*3),p=n.st?new Float32Array(f*2):void 0,g=n.normal?new Float32Array(f*3):void 0,m=n.tangent?new Float32Array(f*3):void 0,y=n.bitangent?new Float32Array(f*3):void 0,b=t.shadowVolume,C=b?new Float32Array(f*3):void 0,A=0,T=qde,E=Yde,v=Xde,D=new Oi(s),O=D.project(s.cartesianToCartographic(i,bk),Kde),P=s.scaleToGeodeticSurface(i,FT);s.geodeticSurfaceNormal(P,P);let M=Le.fromAxisAngle(P,l,$j),L=J.fromQuaternion(M,jde),_=H.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Zde),S=H.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,$de),w=e.length,I=w/3*2;for(let k=0;k<w;k+=3){let z=k+1,V=k+2,U=h.fromArray(e,k,FT),B;if(n.st){let j=J.multiplyByVector(L,U,Kj),Q=D.project(s.cartesianToCartographic(j,bk),Zj);h.subtract(Q,O,Q),Es.x=(Q.x+o)/(2*o),Es.y=(Q.y+r)/(2*r),_.x=Math.min(Es.x,_.x),_.y=Math.min(Es.y,_.y),S.x=Math.max(Es.x,S.x),S.y=Math.max(Es.y,S.y),p[A+I]=Es.x,p[A+1+I]=Es.y,p[A++]=Es.x,p[A++]=Es.y}U=s.scaleToGeodeticSurface(U,U),B=h.clone(U,Kj),T=s.geodeticSurfaceNormal(U,T),b&&(C[k+w]=-T.x,C[z+w]=-T.y,C[V+w]=-T.z);let W=h.multiplyByScalar(T,a,Wde);if(U=h.add(U,W,U),W=h.multiplyByScalar(T,c,W),B=h.add(B,W,B),n.position&&(d[k+w]=B.x,d[z+w]=B.y,d[V+w]=B.z,d[k]=U.x,d[z]=U.y,d[V]=U.z),n.normal||n.tangent||n.bitangent){v=h.clone(T,v);let j=h.fromArray(e,(k+3)%w,Wde);h.subtract(j,U,j);let Q=h.subtract(B,U,Zj);T=h.normalize(h.cross(Q,j,T),T),n.normal&&(g[k]=T.x,g[z]=T.y,g[V]=T.z,g[k+w]=T.x,g[z+w]=T.y,g[V+w]=T.z),n.tangent&&(E=h.normalize(h.cross(v,T,E),E),m[k]=E.x,m[z]=E.y,m[V]=E.z,m[k+w]=E.x,m[k+1+w]=E.y,m[k+2+w]=E.z),n.bitangent&&(y[k]=v.x,y[z]=v.y,y[V]=v.z,y[k+w]=v.x,y[z+w]=v.y,y[V+w]=v.z)}}if(n.st){w=p.length;for(let k=0;k<w;k+=2)p[k]=(p[k]-_.x)/(S.x-_.x),p[k+1]=(p[k+1]-_.y)/(S.y-_.y)}let N=new hn;if(n.position&&(N.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:d})),n.st&&(N.st=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:p})),n.normal&&(N.normal=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:g})),n.tangent&&(N.tangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:m})),n.bitangent&&(N.bitangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:y})),b&&(N.extrudeDirection=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:C})),u(t.offsetAttribute)){let k=new Uint8Array(f);if(t.offsetAttribute===an.TOP)k=k.fill(1,0,f/2);else{let z=t.offsetAttribute===an.NONE?0:1;k=k.fill(z)}N.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:k})}return N}function sJe(e){let t=e.length/3,n=Be.createTypedArray(t,t*6),i=0;for(let o=0;o<t;o++){let r=o,s=o+t,a=(r+1)%t,c=a+t;n[i++]=r,n[i++]=s,n[i++]=a,n[i++]=a,n[i++]=s,n[i++]=c}return n}var yk=new ae,xk=new ae;function aJe(e){let t=e.center,n=e.ellipsoid,i=e.semiMajorAxis,o=h.multiplyByScalar(n.geodeticSurfaceNormal(t,FT),e.height,FT);yk.center=h.add(t,o,yk.center),yk.radius=i,o=h.multiplyByScalar(n.geodeticSurfaceNormal(t,o),e.extrudedHeight,o),xk.center=h.add(t,o,xk.center),xk.radius=i;let r=gu.computeEllipsePositions(e,!0,!0),s=r.positions,a=r.numPts,c=r.outerPositions,l=ae.union(yk,xk),f=Qde(s,e,!0),d=Jde(a),p=d.length;d.length=p*2;let g=s.length/3;for(let E=0;E<p;E+=3)d[E+p]=d[E+2]+g,d[E+1+p]=d[E+1]+g,d[E+2+p]=d[E]+g;let m=Be.createTypedArray(g*2/3,d),y=new ft({attributes:f,indices:m,primitiveType:Ne.TRIANGLES}),b=rJe(c,e);d=sJe(c);let C=Be.createTypedArray(c.length*2/3,d),A=new ft({attributes:b,indices:C,primitiveType:Ne.TRIANGLES}),T=Nn.combineInstances([new vt({geometry:y}),new vt({geometry:A})]);return{boundingSphere:l,attributes:T[0].attributes,indices:T[0].indices}}function ehe(e,t,n,i,o,r,s){let c=gu.computeEllipsePositions({center:e,semiMajorAxis:t,semiMinorAxis:n,rotation:i,granularity:o},!1,!0).outerPositions,l=c.length/3,f=new Array(l);for(let p=0;p<l;++p)f[p]=h.fromArray(c,p*3);let d=se.fromCartesianArray(f,r,s);return d.width>R.PI&&(d.north=d.north>0?R.PI_OVER_TWO-R.EPSILON7:d.north,d.south=d.south<0?R.EPSILON7-R.PI_OVER_TWO:d.south,d.east=R.PI,d.west=-R.PI),d}function hm(e){e=x(e,x.EMPTY_OBJECT);let t=e.center,n=x(e.ellipsoid,ee.default),i=e.semiMajorAxis,o=e.semiMinorAxis,r=x(e.granularity,R.RADIANS_PER_DEGREE),s=x(e.vertexFormat,Ie.DEFAULT),a=x(e.height,0),c=x(e.extrudedHeight,a);this._center=h.clone(t),this._semiMajorAxis=i,this._semiMinorAxis=o,this._ellipsoid=ee.clone(n),this._rotation=x(e.rotation,0),this._stRotation=x(e.stRotation,0),this._height=Math.max(c,a),this._granularity=r,this._vertexFormat=Ie.clone(s),this._extrudedHeight=Math.min(c,a),this._shadowVolume=x(e.shadowVolume,!1),this._workerName="createEllipseGeometry",this._offsetAttribute=e.offsetAttribute,this._rectangle=void 0,this._textureCoordinateRotationPoints=void 0}hm.packedLength=h.packedLength+ee.packedLength+Ie.packedLength+9;hm.pack=function(e,t,n){return n=x(n,0),h.pack(e._center,t,n),n+=h.packedLength,ee.pack(e._ellipsoid,t,n),n+=ee.packedLength,Ie.pack(e._vertexFormat,t,n),n+=Ie.packedLength,t[n++]=e._semiMajorAxis,t[n++]=e._semiMinorAxis,t[n++]=e._rotation,t[n++]=e._stRotation,t[n++]=e._height,t[n++]=e._granularity,t[n++]=e._extrudedHeight,t[n++]=e._shadowVolume?1:0,t[n]=x(e._offsetAttribute,-1),t};var the=new h,nhe=new ee,ihe=new Ie,dm={center:the,ellipsoid:nhe,vertexFormat:ihe,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,stRotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,shadowVolume:void 0,offsetAttribute:void 0};hm.unpack=function(e,t,n){t=x(t,0);let i=h.unpack(e,t,the);t+=h.packedLength;let o=ee.unpack(e,t,nhe);t+=ee.packedLength;let r=Ie.unpack(e,t,ihe);t+=Ie.packedLength;let s=e[t++],a=e[t++],c=e[t++],l=e[t++],f=e[t++],d=e[t++],p=e[t++],g=e[t++]===1,m=e[t];return u(n)?(n._center=h.clone(i,n._center),n._ellipsoid=ee.clone(o,n._ellipsoid),n._vertexFormat=Ie.clone(r,n._vertexFormat),n._semiMajorAxis=s,n._semiMinorAxis=a,n._rotation=c,n._stRotation=l,n._height=f,n._granularity=d,n._extrudedHeight=p,n._shadowVolume=g,n._offsetAttribute=m===-1?void 0:m,n):(dm.height=f,dm.extrudedHeight=p,dm.granularity=d,dm.stRotation=l,dm.rotation=c,dm.semiMajorAxis=s,dm.semiMinorAxis=a,dm.shadowVolume=g,dm.offsetAttribute=m===-1?void 0:m,new hm(dm))};hm.computeRectangle=function(e,t){e=x(e,x.EMPTY_OBJECT);let n=e.center,i=x(e.ellipsoid,ee.default),o=e.semiMajorAxis,r=e.semiMinorAxis,s=x(e.granularity,R.RADIANS_PER_DEGREE),a=x(e.rotation,0);return ehe(n,o,r,a,s,i,t)};hm.createGeometry=function(e){if(e._semiMajorAxis<=0||e._semiMinorAxis<=0)return;let t=e._height,n=e._extrudedHeight,i=!R.equalsEpsilon(t,n,0,R.EPSILON2);e._center=e._ellipsoid.scaleToGeodeticSurface(e._center,e._center);let o={center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:e._ellipsoid,rotation:e._rotation,height:t,granularity:e._granularity,vertexFormat:e._vertexFormat,stRotation:e._stRotation},r;if(i)o.extrudedHeight=n,o.shadowVolume=e._shadowVolume,o.offsetAttribute=e._offsetAttribute,r=aJe(o);else if(r=oJe(o),u(e._offsetAttribute)){let s=r.attributes.position.values.length,a=e._offsetAttribute===an.NONE?0:1,c=new Uint8Array(s/3).fill(a);r.attributes.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:c})}return new ft({attributes:r.attributes,indices:r.indices,primitiveType:Ne.TRIANGLES,boundingSphere:r.boundingSphere,offsetAttribute:e._offsetAttribute})};hm.createShadowVolume=function(e,t,n){let i=e._granularity,o=e._ellipsoid,r=t(i,o),s=n(i,o);return new hm({center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:o,rotation:e._rotation,stRotation:e._stRotation,granularity:i,extrudedHeight:r,height:s,vertexFormat:Ie.POSITION_ONLY,shadowVolume:!0})};function cJe(e){let t=-e._stRotation;if(t===0)return[0,0,0,1,1,0];let i=gu.computeEllipsePositions({center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,rotation:e._rotation,granularity:e._granularity},!1,!0).outerPositions,o=i.length/3,r=new Array(o);for(let c=0;c<o;++c)r[c]=h.fromArray(i,c*3);let s=e._ellipsoid,a=e.rectangle;return ft._textureCoordinateRotationPoints(r,t,s,a)}Object.defineProperties(hm.prototype,{rectangle:{get:function(){return u(this._rectangle)||(this._rectangle=ehe(this._center,this._semiMajorAxis,this._semiMinorAxis,this._rotation,this._granularity,this._ellipsoid)),this._rectangle}},textureCoordinateRotationPoints:{get:function(){return u(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=cJe(this)),this._textureCoordinateRotationPoints}}});var wl=hm;var ohe=new h,qx=new h;function lJe(e){let t=e.center;qx=h.multiplyByScalar(e.ellipsoid.geodeticSurfaceNormal(t,qx),e.height,qx),qx=h.add(t,qx,qx);let n=new ae(qx,e.semiMajorAxis),i=gu.computeEllipsePositions(e,!1,!0).outerPositions,o=new hn({position:new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:gu.raisePositionsToHeight(i,e,!1)})}),r=i.length/3,s=Be.createTypedArray(r,r*2),a=0;for(let c=0;c<r;++c)s[a++]=c,s[a++]=(c+1)%r;return{boundingSphere:n,attributes:o,indices:s}}var Ck=new ae,Ak=new ae;function uJe(e){let t=e.center,n=e.ellipsoid,i=e.semiMajorAxis,o=h.multiplyByScalar(n.geodeticSurfaceNormal(t,ohe),e.height,ohe);Ck.center=h.add(t,o,Ck.center),Ck.radius=i,o=h.multiplyByScalar(n.geodeticSurfaceNormal(t,o),e.extrudedHeight,o),Ak.center=h.add(t,o,Ak.center),Ak.radius=i;let r=gu.computeEllipsePositions(e,!1,!0).outerPositions,s=new hn({position:new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:gu.raisePositionsToHeight(r,e,!0)})});r=s.position.values;let a=ae.union(Ck,Ak),c=r.length/3;if(u(e.offsetAttribute)){let m=new Uint8Array(c);if(e.offsetAttribute===an.TOP)m=m.fill(1,0,c/2);else{let y=e.offsetAttribute===an.NONE?0:1;m=m.fill(y)}s.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:m})}let l=x(e.numberOfVerticalLines,16);l=R.clamp(l,0,c/2);let f=Be.createTypedArray(c,c*2+l*2);c/=2;let d=0,p;for(p=0;p<c;++p)f[d++]=p,f[d++]=(p+1)%c,f[d++]=p+c,f[d++]=(p+1)%c+c;let g;if(l>0){let m=Math.min(l,c);g=Math.round(c/m);let y=Math.min(g*l,c);for(p=0;p<y;p+=g)f[d++]=p,f[d++]=p+c}return{boundingSphere:a,attributes:s,indices:f}}function BT(e){e=x(e,x.EMPTY_OBJECT);let t=e.center,n=x(e.ellipsoid,ee.default),i=e.semiMajorAxis,o=e.semiMinorAxis,r=x(e.granularity,R.RADIANS_PER_DEGREE),s=x(e.height,0),a=x(e.extrudedHeight,s);this._center=h.clone(t),this._semiMajorAxis=i,this._semiMinorAxis=o,this._ellipsoid=ee.clone(n),this._rotation=x(e.rotation,0),this._height=Math.max(a,s),this._granularity=r,this._extrudedHeight=Math.min(a,s),this._numberOfVerticalLines=Math.max(x(e.numberOfVerticalLines,16),0),this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipseOutlineGeometry"}BT.packedLength=h.packedLength+ee.packedLength+8;BT.pack=function(e,t,n){return n=x(n,0),h.pack(e._center,t,n),n+=h.packedLength,ee.pack(e._ellipsoid,t,n),n+=ee.packedLength,t[n++]=e._semiMajorAxis,t[n++]=e._semiMinorAxis,t[n++]=e._rotation,t[n++]=e._height,t[n++]=e._granularity,t[n++]=e._extrudedHeight,t[n++]=e._numberOfVerticalLines,t[n]=x(e._offsetAttribute,-1),t};var rhe=new h,she=new ee,e_={center:rhe,ellipsoid:she,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,numberOfVerticalLines:void 0,offsetAttribute:void 0};BT.unpack=function(e,t,n){t=x(t,0);let i=h.unpack(e,t,rhe);t+=h.packedLength;let o=ee.unpack(e,t,she);t+=ee.packedLength;let r=e[t++],s=e[t++],a=e[t++],c=e[t++],l=e[t++],f=e[t++],d=e[t++],p=e[t];return u(n)?(n._center=h.clone(i,n._center),n._ellipsoid=ee.clone(o,n._ellipsoid),n._semiMajorAxis=r,n._semiMinorAxis=s,n._rotation=a,n._height=c,n._granularity=l,n._extrudedHeight=f,n._numberOfVerticalLines=d,n._offsetAttribute=p===-1?void 0:p,n):(e_.height=c,e_.extrudedHeight=f,e_.granularity=l,e_.rotation=a,e_.semiMajorAxis=r,e_.semiMinorAxis=s,e_.numberOfVerticalLines=d,e_.offsetAttribute=p===-1?void 0:p,new BT(e_))};BT.createGeometry=function(e){if(e._semiMajorAxis<=0||e._semiMinorAxis<=0)return;let t=e._height,n=e._extrudedHeight,i=!R.equalsEpsilon(t,n,0,R.EPSILON2);e._center=e._ellipsoid.scaleToGeodeticSurface(e._center,e._center);let o={center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:e._ellipsoid,rotation:e._rotation,height:t,granularity:e._granularity,numberOfVerticalLines:e._numberOfVerticalLines},r;if(i)o.extrudedHeight=n,o.offsetAttribute=e._offsetAttribute,r=uJe(o);else if(r=lJe(o),u(e._offsetAttribute)){let s=r.attributes.position.values.length,a=e._offsetAttribute===an.NONE?0:1,c=new Uint8Array(s/3).fill(a);r.attributes.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:c})}return new ft({attributes:r.attributes,indices:r.indices,primitiveType:Ne.LINES,boundingSphere:r.boundingSphere,offsetAttribute:e._offsetAttribute})};var Bf=BT;var ahe=new G,che=h.ZERO,lhe=new h,uhe=new se;function fJe(e){this.id=e,this.vertexFormat=void 0,this.center=void 0,this.semiMajorAxis=void 0,this.semiMinorAxis=void 0,this.rotation=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.numberOfVerticalLines=void 0,this.offsetAttribute=void 0}function kd(e,t){Wn.call(this,{entity:e,scene:t,geometryOptions:new fJe(e),geometryPropertyName:"ellipse",observedPropertyNames:["availability","position","ellipse"]}),this._onEntityPropertyChanged(e,"ellipse",e.ellipse,void 0)}u(Object.create)&&(kd.prototype=Object.create(Wn.prototype),kd.prototype.constructor=kd);kd.prototype.createFillGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i={show:new yn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:kn.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};if(this._materialProperty instanceof Ht){let o;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(o=this._materialProperty.color.getValue(e,ahe)),u(o)||(o=G.WHITE),i.color=jt.fromColor(o)}return u(this._options.offsetAttribute)&&(i.offset=to.fromCartesian3(Y.getValueOrDefault(this._terrainOffsetProperty,e,che,lhe))),new vt({id:t,geometry:new wl(this._options),attributes:i})};kd.prototype.createOutlineGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i=Y.getValueOrDefault(this._outlineColorProperty,e,G.BLACK,ahe),o=this._distanceDisplayConditionProperty.getValue(e),r={show:new yn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:jt.fromColor(i),distanceDisplayCondition:kn.fromDistanceDisplayCondition(o),offset:void 0};return u(this._options.offsetAttribute)&&(r.offset=to.fromCartesian3(Y.getValueOrDefault(this._terrainOffsetProperty,e,che,lhe))),new vt({id:t,geometry:new Bf(this._options),attributes:r})};kd.prototype._computeCenter=function(e,t){return Y.getValueOrUndefined(this._entity.position,e,t)};kd.prototype._isHidden=function(e,t){let n=e.position;return!u(n)||!u(t.semiMajorAxis)||!u(t.semiMinorAxis)||ri.prototype._isHidden.call(this,e,t)};kd.prototype._isDynamic=function(e,t){return!e.position.isConstant||!t.semiMajorAxis.isConstant||!t.semiMinorAxis.isConstant||!Y.isConstant(t.rotation)||!Y.isConstant(t.height)||!Y.isConstant(t.extrudedHeight)||!Y.isConstant(t.granularity)||!Y.isConstant(t.stRotation)||!Y.isConstant(t.outlineWidth)||!Y.isConstant(t.numberOfVerticalLines)||!Y.isConstant(t.zIndex)||this._onTerrain&&!Y.isConstant(this._materialProperty)&&!(this._materialProperty instanceof Ht)};kd.prototype._setStaticOptions=function(e,t){let n=Y.getValueOrUndefined(t.height,He.MINIMUM_VALUE),i=Y.getValueOrDefault(t.heightReference,He.MINIMUM_VALUE,Xe.NONE),o=Y.getValueOrUndefined(t.extrudedHeight,He.MINIMUM_VALUE),r=Y.getValueOrDefault(t.extrudedHeightReference,He.MINIMUM_VALUE,Xe.NONE);u(o)&&!u(n)&&(n=0);let s=this._options;s.vertexFormat=this._materialProperty instanceof Ht?ln.VERTEX_FORMAT:ho.MaterialSupport.TEXTURED.vertexFormat,s.center=e.position.getValue(He.MINIMUM_VALUE,s.center),s.semiMajorAxis=t.semiMajorAxis.getValue(He.MINIMUM_VALUE,s.semiMajorAxis),s.semiMinorAxis=t.semiMinorAxis.getValue(He.MINIMUM_VALUE,s.semiMinorAxis),s.rotation=Y.getValueOrUndefined(t.rotation,He.MINIMUM_VALUE),s.granularity=Y.getValueOrUndefined(t.granularity,He.MINIMUM_VALUE),s.stRotation=Y.getValueOrUndefined(t.stRotation,He.MINIMUM_VALUE),s.numberOfVerticalLines=Y.getValueOrUndefined(t.numberOfVerticalLines,He.MINIMUM_VALUE),s.offsetAttribute=Wn.computeGeometryOffsetAttribute(n,i,o,r),s.height=Wn.getGeometryHeight(n,i),o=Wn.getGeometryExtrudedHeight(o,r),o===Wn.CLAMP_TO_GROUND&&(o=di.getMinimumMaximumHeights(wl.computeRectangle(s,uhe)).minimumTerrainHeight),s.extrudedHeight=o};kd.DynamicGeometryUpdater=kT;function kT(e,t,n){oi.call(this,e,t,n)}u(Object.create)&&(kT.prototype=Object.create(oi.prototype),kT.prototype.constructor=kT);kT.prototype._isHidden=function(e,t,n){let i=this._options;return!u(i.center)||!u(i.semiMajorAxis)||!u(i.semiMinorAxis)||oi.prototype._isHidden.call(this,e,t,n)};kT.prototype._setOptions=function(e,t,n){let i=this._options,o=Y.getValueOrUndefined(t.height,n),r=Y.getValueOrDefault(t.heightReference,n,Xe.NONE),s=Y.getValueOrUndefined(t.extrudedHeight,n),a=Y.getValueOrDefault(t.extrudedHeightReference,n,Xe.NONE);u(s)&&!u(o)&&(o=0),i.center=Y.getValueOrUndefined(e.position,n,i.center),i.semiMajorAxis=Y.getValueOrUndefined(t.semiMajorAxis,n),i.semiMinorAxis=Y.getValueOrUndefined(t.semiMinorAxis,n),i.rotation=Y.getValueOrUndefined(t.rotation,n),i.granularity=Y.getValueOrUndefined(t.granularity,n),i.stRotation=Y.getValueOrUndefined(t.stRotation,n),i.numberOfVerticalLines=Y.getValueOrUndefined(t.numberOfVerticalLines,n),i.offsetAttribute=Wn.computeGeometryOffsetAttribute(o,r,s,a),i.height=Wn.getGeometryHeight(o,r),s=Wn.getGeometryExtrudedHeight(s,a),s===Wn.CLAMP_TO_GROUND&&(s=di.getMinimumMaximumHeights(wl.computeRectangle(i,uhe)).minimumTerrainHeight),i.extrudedHeight=s};var Tk=kd;var dJe=new h,hJe=new h,mJe=new h,pJe=new h,_Je=new h,gJe=new h(1,1,1),fhe=Math.cos,dhe=Math.sin;function t_(e){e=x(e,x.EMPTY_OBJECT);let t=x(e.radii,gJe),n=x(e.innerRadii,t),i=x(e.minimumClock,0),o=x(e.maximumClock,R.TWO_PI),r=x(e.minimumCone,0),s=x(e.maximumCone,R.PI),a=Math.round(x(e.stackPartitions,64)),c=Math.round(x(e.slicePartitions,64)),l=x(e.vertexFormat,Ie.DEFAULT);this._radii=h.clone(t),this._innerRadii=h.clone(n),this._minimumClock=i,this._maximumClock=o,this._minimumCone=r,this._maximumCone=s,this._stackPartitions=a,this._slicePartitions=c,this._vertexFormat=Ie.clone(l),this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipsoidGeometry"}t_.packedLength=2*h.packedLength+Ie.packedLength+7;t_.pack=function(e,t,n){return n=x(n,0),h.pack(e._radii,t,n),n+=h.packedLength,h.pack(e._innerRadii,t,n),n+=h.packedLength,Ie.pack(e._vertexFormat,t,n),n+=Ie.packedLength,t[n++]=e._minimumClock,t[n++]=e._maximumClock,t[n++]=e._minimumCone,t[n++]=e._maximumCone,t[n++]=e._stackPartitions,t[n++]=e._slicePartitions,t[n]=x(e._offsetAttribute,-1),t};var hhe=new h,mhe=new h,phe=new Ie,d0={radii:hhe,innerRadii:mhe,vertexFormat:phe,minimumClock:void 0,maximumClock:void 0,minimumCone:void 0,maximumCone:void 0,stackPartitions:void 0,slicePartitions:void 0,offsetAttribute:void 0};t_.unpack=function(e,t,n){t=x(t,0);let i=h.unpack(e,t,hhe);t+=h.packedLength;let o=h.unpack(e,t,mhe);t+=h.packedLength;let r=Ie.unpack(e,t,phe);t+=Ie.packedLength;let s=e[t++],a=e[t++],c=e[t++],l=e[t++],f=e[t++],d=e[t++],p=e[t];return u(n)?(n._radii=h.clone(i,n._radii),n._innerRadii=h.clone(o,n._innerRadii),n._vertexFormat=Ie.clone(r,n._vertexFormat),n._minimumClock=s,n._maximumClock=a,n._minimumCone=c,n._maximumCone=l,n._stackPartitions=f,n._slicePartitions=d,n._offsetAttribute=p===-1?void 0:p,n):(d0.minimumClock=s,d0.maximumClock=a,d0.minimumCone=c,d0.maximumCone=l,d0.stackPartitions=f,d0.slicePartitions=d,d0.offsetAttribute=p===-1?void 0:p,new t_(d0))};t_.createGeometry=function(e){let t=e._radii;if(t.x<=0||t.y<=0||t.z<=0)return;let n=e._innerRadii;if(n.x<=0||n.y<=0||n.z<=0)return;let i=e._minimumClock,o=e._maximumClock,r=e._minimumCone,s=e._maximumCone,a=e._vertexFormat,c=e._slicePartitions+1,l=e._stackPartitions+1;c=Math.round(c*Math.abs(o-i)/R.TWO_PI),l=Math.round(l*Math.abs(s-r)/R.PI),c<2&&(c=2),l<2&&(l=2);let f,d,p=0,g=[r],m=[i];for(f=0;f<l;f++)g.push(r+f*(s-r)/(l-1));for(g.push(s),d=0;d<c;d++)m.push(i+d*(o-i)/(c-1));m.push(o);let y=g.length,b=m.length,C=0,A=1,T=n.x!==t.x||n.y!==t.y||n.z!==t.z,E=!1,v=!1,D=!1;T&&(A=2,r>0&&(E=!0,C+=c-1),s<Math.PI&&(v=!0,C+=c-1),(o-i)%R.TWO_PI?(D=!0,C+=(l-1)*2+1):C+=1);let O=b*y*A,P=new Float64Array(O*3),M=new Array(O).fill(!1),L=new Array(O).fill(!1),_=c*l*A,S=6*(_+C+1-(c+l)*A),w=Be.createTypedArray(_,S),I=a.normal?new Float32Array(O*3):void 0,N=a.tangent?new Float32Array(O*3):void 0,k=a.bitangent?new Float32Array(O*3):void 0,z=a.st?new Float32Array(O*2):void 0,V=new Array(y),U=new Array(y);for(f=0;f<y;f++)V[f]=dhe(g[f]),U[f]=fhe(g[f]);let B=new Array(b),W=new Array(b);for(d=0;d<b;d++)W[d]=fhe(m[d]),B[d]=dhe(m[d]);for(f=0;f<y;f++)for(d=0;d<b;d++)P[p++]=t.x*V[f]*W[d],P[p++]=t.y*V[f]*B[d],P[p++]=t.z*U[f];let j=O/2;if(T)for(f=0;f<y;f++)for(d=0;d<b;d++)P[p++]=n.x*V[f]*W[d],P[p++]=n.y*V[f]*B[d],P[p++]=n.z*U[f],M[j]=!0,f>0&&f!==y-1&&d!==0&&d!==b-1&&(L[j]=!0),j++;p=0;let Q,q;for(f=1;f<y-2;f++)for(Q=f*b,q=(f+1)*b,d=1;d<b-2;d++)w[p++]=q+d,w[p++]=q+d+1,w[p++]=Q+d+1,w[p++]=q+d,w[p++]=Q+d+1,w[p++]=Q+d;if(T){let Ze=y*b;for(f=1;f<y-2;f++)for(Q=Ze+f*b,q=Ze+(f+1)*b,d=1;d<b-2;d++)w[p++]=q+d,w[p++]=Q+d,w[p++]=Q+d+1,w[p++]=q+d,w[p++]=Q+d+1,w[p++]=q+d+1}let X,Z;if(T){if(E)for(Z=y*b,f=1;f<b-2;f++)w[p++]=f,w[p++]=f+1,w[p++]=Z+f+1,w[p++]=f,w[p++]=Z+f+1,w[p++]=Z+f;if(v)for(X=y*b-b,Z=y*b*A-b,f=1;f<b-2;f++)w[p++]=X+f+1,w[p++]=X+f,w[p++]=Z+f,w[p++]=X+f+1,w[p++]=Z+f,w[p++]=Z+f+1}if(D){for(f=1;f<y-2;f++)Z=b*y+b*f,X=b*f,w[p++]=Z,w[p++]=X+b,w[p++]=X,w[p++]=Z,w[p++]=Z+b,w[p++]=X+b;for(f=1;f<y-2;f++)Z=b*y+b*(f+1)-1,X=b*(f+1)-1,w[p++]=X+b,w[p++]=Z,w[p++]=X,w[p++]=X+b,w[p++]=Z+b,w[p++]=Z}let fe=new hn;a.position&&(fe.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:P}));let xe=0,re=0,pe=0,ye=0,Se=O/2,Te,Fe=ee.fromCartesian3(t),Ve=ee.fromCartesian3(n);if(a.st||a.normal||a.tangent||a.bitangent){for(f=0;f<O;f++){Te=M[f]?Ve:Fe;let Ze=h.fromArray(P,f*3,dJe),gt=Te.geodeticSurfaceNormal(Ze,hJe);if(L[f]&&h.negate(gt,gt),a.st){let lt=H.negate(gt,_Je);z[xe++]=Math.atan2(lt.y,lt.x)/R.TWO_PI+.5,z[xe++]=Math.asin(gt.z)/Math.PI+.5}if(a.normal&&(I[re++]=gt.x,I[re++]=gt.y,I[re++]=gt.z),a.tangent||a.bitangent){let lt=mJe,Oe=0,Mt;if(M[f]&&(Oe=Se),!E&&f>=Oe&&f<Oe+b*2?Mt=h.UNIT_X:Mt=h.UNIT_Z,h.cross(Mt,gt,lt),h.normalize(lt,lt),a.tangent&&(N[pe++]=lt.x,N[pe++]=lt.y,N[pe++]=lt.z),a.bitangent){let ut=h.cross(gt,lt,pJe);h.normalize(ut,ut),k[ye++]=ut.x,k[ye++]=ut.y,k[ye++]=ut.z}}}a.st&&(fe.st=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:z})),a.normal&&(fe.normal=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:I})),a.tangent&&(fe.tangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:N})),a.bitangent&&(fe.bitangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:k}))}if(u(e._offsetAttribute)){let Ze=P.length,gt=e._offsetAttribute===an.NONE?0:1,lt=new Uint8Array(Ze/3).fill(gt);fe.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:lt})}return new ft({attributes:fe,indices:w,primitiveType:Ne.TRIANGLES,boundingSphere:ae.fromEllipsoid(Fe),offsetAttribute:e._offsetAttribute})};var Qj;t_.getUnitEllipsoid=function(){return u(Qj)||(Qj=t_.createGeometry(new t_({radii:new h(1,1,1),vertexFormat:Ie.POSITION_ONLY}))),Qj};var da=t_;var yJe=new Ht(G.WHITE),Jj=h.ZERO,eq=new h,xJe=new h,bJe=new h,tq=new G,CJe=new h(1,1,1);function AJe(e){this.id=e,this.vertexFormat=void 0,this.radii=void 0,this.innerRadii=void 0,this.minimumClock=void 0,this.maximumClock=void 0,this.minimumCone=void 0,this.maximumCone=void 0,this.stackPartitions=void 0,this.slicePartitions=void 0,this.subdivisions=void 0,this.offsetAttribute=void 0}function yu(e,t){ri.call(this,{entity:e,scene:t,geometryOptions:new AJe(e),geometryPropertyName:"ellipsoid",observedPropertyNames:["availability","position","orientation","ellipsoid"]}),this._onEntityPropertyChanged(e,"ellipsoid",e.ellipsoid,void 0)}u(Object.create)&&(yu.prototype=Object.create(ri.prototype),yu.prototype.constructor=yu);Object.defineProperties(yu.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}});yu.prototype.createFillGeometryInstance=function(e,t,n){let i=this._entity,o=i.isAvailable(e),r,s=new yn(o&&i.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),a=this._distanceDisplayConditionProperty.getValue(e),c=kn.fromDistanceDisplayCondition(a),l={show:s,distanceDisplayCondition:c,color:void 0,offset:void 0};if(this._materialProperty instanceof Ht){let f;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||o)&&(f=this._materialProperty.color.getValue(e,tq)),u(f)||(f=G.WHITE),r=jt.fromColor(f),l.color=r}return u(this._options.offsetAttribute)&&(l.offset=to.fromCartesian3(Y.getValueOrDefault(this._terrainOffsetProperty,e,Jj,eq))),new vt({id:i,geometry:new da(this._options),modelMatrix:t?void 0:i.computeModelMatrixForHeightReference(e,i.ellipsoid.heightReference,this._options.radii.z*.5,this._scene.ellipsoid,n),attributes:l})};yu.prototype.createOutlineGeometryInstance=function(e,t,n){let i=this._entity,o=i.isAvailable(e),r=Y.getValueOrDefault(this._outlineColorProperty,e,G.BLACK,tq),s=this._distanceDisplayConditionProperty.getValue(e),a={show:new yn(o&&i.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:jt.fromColor(r),distanceDisplayCondition:kn.fromDistanceDisplayCondition(s),offset:void 0};return u(this._options.offsetAttribute)&&(a.offset=to.fromCartesian3(Y.getValueOrDefault(this._terrainOffsetProperty,e,Jj,eq))),new vt({id:i,geometry:new Df(this._options),modelMatrix:t?void 0:i.computeModelMatrixForHeightReference(e,i.ellipsoid.heightReference,this._options.radii.z*.5,this._scene.ellipsoid,n),attributes:a})};yu.prototype._computeCenter=function(e,t){return Y.getValueOrUndefined(this._entity.position,e,t)};yu.prototype._isHidden=function(e,t){return!u(e.position)||!u(t.radii)||ri.prototype._isHidden.call(this,e,t)};yu.prototype._isDynamic=function(e,t){return!e.position.isConstant||!Y.isConstant(e.orientation)||!t.radii.isConstant||!Y.isConstant(t.innerRadii)||!Y.isConstant(t.stackPartitions)||!Y.isConstant(t.slicePartitions)||!Y.isConstant(t.outlineWidth)||!Y.isConstant(t.minimumClock)||!Y.isConstant(t.maximumClock)||!Y.isConstant(t.minimumCone)||!Y.isConstant(t.maximumCone)||!Y.isConstant(t.subdivisions)};yu.prototype._setStaticOptions=function(e,t){let n=Y.getValueOrDefault(t.heightReference,He.MINIMUM_VALUE,Xe.NONE),i=this._options;i.vertexFormat=this._materialProperty instanceof Ht?ln.VERTEX_FORMAT:ho.MaterialSupport.TEXTURED.vertexFormat,i.radii=t.radii.getValue(He.MINIMUM_VALUE,i.radii),i.innerRadii=Y.getValueOrUndefined(t.innerRadii,i.radii),i.minimumClock=Y.getValueOrUndefined(t.minimumClock,He.MINIMUM_VALUE),i.maximumClock=Y.getValueOrUndefined(t.maximumClock,He.MINIMUM_VALUE),i.minimumCone=Y.getValueOrUndefined(t.minimumCone,He.MINIMUM_VALUE),i.maximumCone=Y.getValueOrUndefined(t.maximumCone,He.MINIMUM_VALUE),i.stackPartitions=Y.getValueOrUndefined(t.stackPartitions,He.MINIMUM_VALUE),i.slicePartitions=Y.getValueOrUndefined(t.slicePartitions,He.MINIMUM_VALUE),i.subdivisions=Y.getValueOrUndefined(t.subdivisions,He.MINIMUM_VALUE),i.offsetAttribute=n!==Xe.NONE?an.ALL:void 0};yu.prototype._onEntityPropertyChanged=J_;yu.DynamicGeometryUpdater=P1;function P1(e,t,n){oi.call(this,e,t,n),this._scene=e._scene,this._modelMatrix=new F,this._attributes=void 0,this._outlineAttributes=void 0,this._lastSceneMode=void 0,this._lastShow=void 0,this._lastOutlineShow=void 0,this._lastOutlineWidth=void 0,this._lastOutlineColor=void 0,this._lastOffset=new h,this._material={}}u(Object.create)&&(P1.prototype=Object.create(oi.prototype),P1.prototype.constructor=P1);P1.prototype.update=function(e){let t=this._entity,n=t.ellipsoid;if(!t.isShowing||!t.isAvailable(e)||!Y.getValueOrDefault(n.show,e,!0)){u(this._primitive)&&(this._primitive.show=!1),u(this._outlinePrimitive)&&(this._outlinePrimitive.show=!1);return}let i=Y.getValueOrUndefined(n.radii,e,xJe),o=u(i)?t.computeModelMatrixForHeightReference(e,n.heightReference,i.z*.5,this._scene.ellipsoid,this._modelMatrix):void 0;if(!u(o)||!u(i)){u(this._primitive)&&(this._primitive.show=!1),u(this._outlinePrimitive)&&(this._outlinePrimitive.show=!1);return}let r=Y.getValueOrDefault(n.fill,e,!0),s=Y.getValueOrDefault(n.outline,e,!1),a=Y.getValueOrClonedDefault(n.outlineColor,e,G.BLACK,tq),c=sr.getValue(e,x(n.material,yJe),this._material),l=Y.getValueOrUndefined(n.innerRadii,e,bJe),f=Y.getValueOrUndefined(n.minimumClock,e),d=Y.getValueOrUndefined(n.maximumClock,e),p=Y.getValueOrUndefined(n.minimumCone,e),g=Y.getValueOrUndefined(n.maximumCone,e),m=Y.getValueOrUndefined(n.stackPartitions,e),y=Y.getValueOrUndefined(n.slicePartitions,e),b=Y.getValueOrUndefined(n.subdivisions,e),C=Y.getValueOrDefault(n.outlineWidth,e,1),A=Y.getValueOrDefault(n.heightReference,e,Xe.NONE),T=A!==Xe.NONE?an.ALL:void 0,E=this._scene.mode,v=E===ne.SCENE3D&&A===Xe.NONE,D=this._options,O=this._geometryUpdater.shadowsProperty.getValue(e),M=this._geometryUpdater.distanceDisplayConditionProperty.getValue(e),L=Y.getValueOrDefault(this._geometryUpdater.terrainOffsetProperty,e,Jj,eq);if(!v||this._lastSceneMode!==E||!u(this._primitive)||D.stackPartitions!==m||D.slicePartitions!==y||u(l)&&!h.equals(D.innerRadii!==l)||D.minimumClock!==f||D.maximumClock!==d||D.minimumCone!==p||D.maximumCone!==g||D.subdivisions!==b||this._lastOutlineWidth!==C||D.offsetAttribute!==T){let S=this._primitives;S.removeAndDestroy(this._primitive),S.removeAndDestroy(this._outlinePrimitive),this._primitive=void 0,this._outlinePrimitive=void 0,this._lastSceneMode=E,this._lastOutlineWidth=C,D.stackPartitions=m,D.slicePartitions=y,D.subdivisions=b,D.offsetAttribute=T,D.radii=h.clone(v?CJe:i,D.radii),u(l)?v?D.innerRadii=h.fromElements(l.x/i.x,l.y/i.y,l.z/i.z,D.innerRadii):D.innerRadii=h.clone(l,D.innerRadii):D.innerRadii=void 0,D.minimumClock=f,D.maximumClock=d,D.minimumCone=p,D.maximumCone=g;let w=new ho({material:c,translucent:c.isTranslucent(),closed:!0});D.vertexFormat=w.vertexFormat;let I=this._geometryUpdater.createFillGeometryInstance(e,v,this._modelMatrix);this._primitive=S.add(new In({geometryInstances:I,appearance:w,asynchronous:!1,shadows:O}));let N=this._geometryUpdater.createOutlineGeometryInstance(e,v,this._modelMatrix);this._outlinePrimitive=S.add(new In({geometryInstances:N,appearance:new ln({flat:!0,translucent:N.attributes.color.value[3]!==255,renderState:{lineWidth:this._geometryUpdater._scene.clampLineWidth(C)}}),asynchronous:!1,shadows:O})),this._lastShow=r,this._lastOutlineShow=s,this._lastOutlineColor=G.clone(a,this._lastOutlineColor),this._lastDistanceDisplayCondition=M,this._lastOffset=h.clone(L,this._lastOffset)}else if(this._primitive.ready){let S=this._primitive,w=this._outlinePrimitive;S.show=!0,w.show=!0,S.appearance.material=c;let I=this._attributes;u(I)||(I=S.getGeometryInstanceAttributes(t),this._attributes=I),r!==this._lastShow&&(I.show=yn.toValue(r,I.show),this._lastShow=r);let N=this._outlineAttributes;u(N)||(N=w.getGeometryInstanceAttributes(t),this._outlineAttributes=N),s!==this._lastOutlineShow&&(N.show=yn.toValue(s,N.show),this._lastOutlineShow=s),G.equals(a,this._lastOutlineColor)||(N.color=jt.toValue(a,N.color),G.clone(a,this._lastOutlineColor)),Nt.equals(M,this._lastDistanceDisplayCondition)||(I.distanceDisplayCondition=kn.toValue(M,I.distanceDisplayCondition),N.distanceDisplayCondition=kn.toValue(M,N.distanceDisplayCondition),Nt.clone(M,this._lastDistanceDisplayCondition)),h.equals(L,this._lastOffset)||(I.offset=to.toValue(L,I.offset),N.offset=to.toValue(L,I.offset),h.clone(L,this._lastOffset))}v&&(i.x=Math.max(i.x,.001),i.y=Math.max(i.y,.001),i.z=Math.max(i.z,.001),o=F.multiplyByScale(o,i,o),this._primitive.modelMatrix=o,this._outlinePrimitive.modelMatrix=o)};var Ek=yu;function VT(e){e=x(e,x.EMPTY_OBJECT);let t=x(e.vertexFormat,Ie.DEFAULT);this._vertexFormat=t,this._workerName="createPlaneGeometry"}VT.packedLength=Ie.packedLength;VT.pack=function(e,t,n){return n=x(n,0),Ie.pack(e._vertexFormat,t,n),t};var _he=new Ie,TJe={vertexFormat:_he};VT.unpack=function(e,t,n){t=x(t,0);let i=Ie.unpack(e,t,_he);return u(n)?(n._vertexFormat=Ie.clone(i,n._vertexFormat),n):new VT(TJe)};var Sk=new h(-.5,-.5,0),vk=new h(.5,.5,0);VT.createGeometry=function(e){let t=e._vertexFormat,n=new hn,i,o;if(t.position){if(o=new Float64Array(4*3),o[0]=Sk.x,o[1]=Sk.y,o[2]=0,o[3]=vk.x,o[4]=Sk.y,o[5]=0,o[6]=vk.x,o[7]=vk.y,o[8]=0,o[9]=Sk.x,o[10]=vk.y,o[11]=0,n.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:o}),t.normal){let r=new Float32Array(12);r[0]=0,r[1]=0,r[2]=1,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=1,r[9]=0,r[10]=0,r[11]=1,n.normal=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:r})}if(t.st){let r=new Float32Array(8);r[0]=0,r[1]=0,r[2]=1,r[3]=0,r[4]=1,r[5]=1,r[6]=0,r[7]=1,n.st=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:r})}if(t.tangent){let r=new Float32Array(12);r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r[6]=1,r[7]=0,r[8]=0,r[9]=1,r[10]=0,r[11]=0,n.tangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:r})}if(t.bitangent){let r=new Float32Array(12);r[0]=0,r[1]=1,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=1,r[8]=0,r[9]=0,r[10]=1,r[11]=0,n.bitangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:r})}i=new Uint16Array(2*3),i[0]=0,i[1]=1,i[2]=2,i[3]=0,i[4]=2,i[5]=3}return new ft({attributes:n,indices:i,primitiveType:Ne.TRIANGLES,boundingSphere:new ae(h.ZERO,Math.sqrt(2))})};var wk=VT;function UT(){this._workerName="createPlaneOutlineGeometry"}UT.packedLength=0;UT.pack=function(e,t){return t};UT.unpack=function(e,t,n){return u(n)?n:new UT};var h0=new h(-.5,-.5,0),Dk=new h(.5,.5,0);UT.createGeometry=function(){let e=new hn,t=new Uint16Array(4*2),n=new Float64Array(4*3);return n[0]=h0.x,n[1]=h0.y,n[2]=h0.z,n[3]=Dk.x,n[4]=h0.y,n[5]=h0.z,n[6]=Dk.x,n[7]=Dk.y,n[8]=h0.z,n[9]=h0.x,n[10]=Dk.y,n[11]=h0.z,e.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:n}),t[0]=0,t[1]=1,t[2]=1,t[3]=2,t[4]=2,t[5]=3,t[6]=3,t[7]=0,new ft({attributes:e,indices:t,primitiveType:Ne.LINES,boundingSphere:new ae(h.ZERO,Math.sqrt(2))})};var Ik=UT;var EJe=new h,ghe=new G;function SJe(e){this.id=e,this.vertexFormat=void 0,this.plane=void 0,this.dimensions=void 0}function kf(e,t){ri.call(this,{entity:e,scene:t,geometryOptions:new SJe(e),geometryPropertyName:"plane",observedPropertyNames:["availability","position","orientation","plane"]}),this._onEntityPropertyChanged(e,"plane",e.plane,void 0)}u(Object.create)&&(kf.prototype=Object.create(ri.prototype),kf.prototype.constructor=kf);kf.prototype.createFillGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i,o,r=new yn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),s=this._distanceDisplayConditionProperty.getValue(e),a=kn.fromDistanceDisplayCondition(s);if(this._materialProperty instanceof Ht){let g;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(g=this._materialProperty.color.getValue(e,ghe)),u(g)||(g=G.WHITE),o=jt.fromColor(g),i={show:r,distanceDisplayCondition:a,color:o}}else i={show:r,distanceDisplayCondition:a};let c=t.plane,l=this._options,f=t.computeModelMatrix(e),d=Y.getValueOrDefault(c.plane,e,l.plane),p=Y.getValueOrUndefined(c.dimensions,e,l.dimensions);return l.plane=d,l.dimensions=p,f=nq(d,p,f,f),new vt({id:t,geometry:new wk(this._options),modelMatrix:f,attributes:i})};kf.prototype.createOutlineGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i=Y.getValueOrDefault(this._outlineColorProperty,e,G.BLACK,ghe),o=this._distanceDisplayConditionProperty.getValue(e),r=t.plane,s=this._options,a=t.computeModelMatrix(e),c=Y.getValueOrDefault(r.plane,e,s.plane),l=Y.getValueOrUndefined(r.dimensions,e,s.dimensions);return s.plane=c,s.dimensions=l,a=nq(c,l,a,a),new vt({id:t,geometry:new Ik,modelMatrix:a,attributes:{show:new yn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:jt.fromColor(i),distanceDisplayCondition:kn.fromDistanceDisplayCondition(o)}})};kf.prototype._isHidden=function(e,t){return!u(t.plane)||!u(t.dimensions)||!u(e.position)||ri.prototype._isHidden.call(this,e,t)};kf.prototype._getIsClosed=function(e){return!1};kf.prototype._isDynamic=function(e,t){return!e.position.isConstant||!Y.isConstant(e.orientation)||!t.plane.isConstant||!t.dimensions.isConstant||!Y.isConstant(t.outlineWidth)};kf.prototype._setStaticOptions=function(e,t){let n=this._materialProperty instanceof Ht,i=this._options;i.vertexFormat=n?ln.VERTEX_FORMAT:ho.MaterialSupport.TEXTURED.vertexFormat,i.plane=t.plane.getValue(He.MINIMUM_VALUE,i.plane),i.dimensions=t.dimensions.getValue(He.MINIMUM_VALUE,i.dimensions)};kf.DynamicGeometryUpdater=zT;function zT(e,t,n){oi.call(this,e,t,n)}u(Object.create)&&(zT.prototype=Object.create(oi.prototype),zT.prototype.constructor=zT);zT.prototype._isHidden=function(e,t,n){let i=this._options,o=Y.getValueOrUndefined(e.position,n,EJe);return!u(o)||!u(i.plane)||!u(i.dimensions)||oi.prototype._isHidden.call(this,e,t,n)};zT.prototype._setOptions=function(e,t,n){let i=this._options;i.plane=Y.getValueOrDefault(t.plane,n,i.plane),i.dimensions=Y.getValueOrUndefined(t.dimensions,n,i.dimensions)};var vJe=new h,wJe=new h,DJe=new h,IJe=new h,PJe=new J,RJe=new J,OJe=new F;function nq(e,t,n,i){let o=e.normal,r=e.distance,s=h.multiplyByScalar(o,-r,DJe),a=h.clone(h.UNIT_Z,wJe);R.equalsEpsilon(Math.abs(h.dot(a,o)),1,R.EPSILON8)&&(a=h.clone(h.UNIT_Y,a));let c=h.cross(a,o,vJe);a=h.cross(o,c,a),h.normalize(c,c),h.normalize(a,a);let l=PJe;J.setColumn(l,0,c,l),J.setColumn(l,1,a,l),J.setColumn(l,2,o,l);let f=h.fromElements(t.x,t.y,1,IJe),d=J.multiplyByScale(l,f,RJe),p=F.fromRotationTranslation(d,s,OJe);return F.multiplyTransformation(n,p,i)}kf.createPrimitiveMatrix=nq;var Pk=kf;var MJe=new h,LJe=new qe,NJe=new H,FJe=new H,BJe=new h,kJe=new h,VJe=new h,R1=new h,UJe=new h,zJe=new h,yhe=new Le,HJe=new J,GJe=new J,WJe=new h;function jJe(e,t,n,i,o,r,s,a,c){let l=e.positions,f=ai.triangulate(e.positions2D,e.holes);f.length<3&&(f=[0,1,2]);let d=Be.createTypedArray(l.length,f.length);d.set(f);let p=HJe;if(i!==0){let _=Le.fromAxisAngle(s,i,yhe);if(p=J.fromQuaternion(_,p),t.tangent||t.bitangent){_=Le.fromAxisAngle(s,-i,yhe);let S=J.fromQuaternion(_,GJe);a=h.normalize(J.multiplyByVector(S,a,a),a),t.bitangent&&(c=h.normalize(h.cross(s,a,c),c))}}else p=J.clone(J.IDENTITY,p);let g=FJe;t.st&&(g.x=n.x,g.y=n.y);let m=l.length,y=m*3,b=new Float64Array(y),C=t.normal?new Float32Array(y):void 0,A=t.tangent?new Float32Array(y):void 0,T=t.bitangent?new Float32Array(y):void 0,E=t.st?new Float32Array(m*2):void 0,v=0,D=0,O=0,P=0,M=0;for(let _=0;_<m;_++){let S=l[_];if(b[v++]=S.x,b[v++]=S.y,b[v++]=S.z,t.st)if(u(o)&&o.positions.length===m)E[M++]=o.positions[_].x,E[M++]=o.positions[_].y;else{let w=J.multiplyByVector(p,S,MJe),I=r(w,NJe);H.subtract(I,g,I);let N=R.clamp(I.x/n.width,0,1),k=R.clamp(I.y/n.height,0,1);E[M++]=N,E[M++]=k}t.normal&&(C[D++]=s.x,C[D++]=s.y,C[D++]=s.z),t.tangent&&(A[P++]=a.x,A[P++]=a.y,A[P++]=a.z),t.bitangent&&(T[O++]=c.x,T[O++]=c.y,T[O++]=c.z)}let L=new hn;return t.position&&(L.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:b})),t.normal&&(L.normal=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:C})),t.tangent&&(L.tangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:A})),t.bitangent&&(L.bitangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:T})),t.st&&(L.st=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:E})),new ft({attributes:L,indices:d,primitiveType:Ne.TRIANGLES})}function Yx(e){e=x(e,x.EMPTY_OBJECT);let t=e.polygonHierarchy,n=e.textureCoordinates,i=x(e.vertexFormat,Ie.DEFAULT);this._vertexFormat=Ie.clone(i),this._polygonHierarchy=t,this._stRotation=x(e.stRotation,0),this._ellipsoid=ee.clone(x(e.ellipsoid,ee.default)),this._workerName="createCoplanarPolygonGeometry",this._textureCoordinates=n,this.packedLength=zn.computeHierarchyPackedLength(t,h)+Ie.packedLength+ee.packedLength+(u(n)?zn.computeHierarchyPackedLength(n,H):1)+2}Yx.fromPositions=function(e){e=x(e,x.EMPTY_OBJECT);let t={polygonHierarchy:{positions:e.positions},vertexFormat:e.vertexFormat,stRotation:e.stRotation,ellipsoid:e.ellipsoid,textureCoordinates:e.textureCoordinates};return new Yx(t)};Yx.pack=function(e,t,n){return n=x(n,0),n=zn.packPolygonHierarchy(e._polygonHierarchy,t,n,h),ee.pack(e._ellipsoid,t,n),n+=ee.packedLength,Ie.pack(e._vertexFormat,t,n),n+=Ie.packedLength,t[n++]=e._stRotation,u(e._textureCoordinates)?n=zn.packPolygonHierarchy(e._textureCoordinates,t,n,H):t[n++]=-1,t[n++]=e.packedLength,t};var qJe=ee.clone(ee.UNIT_SPHERE),YJe=new Ie,XJe={polygonHierarchy:{}};Yx.unpack=function(e,t,n){t=x(t,0);let i=zn.unpackPolygonHierarchy(e,t,h);t=i.startingIndex,delete i.startingIndex;let o=ee.unpack(e,t,qJe);t+=ee.packedLength;let r=Ie.unpack(e,t,YJe);t+=Ie.packedLength;let s=e[t++],a=e[t]===-1?void 0:zn.unpackPolygonHierarchy(e,t,H);u(a)?(t=a.startingIndex,delete a.startingIndex):t++;let c=e[t++];return u(n)||(n=new Yx(XJe)),n._polygonHierarchy=i,n._ellipsoid=ee.clone(o,n._ellipsoid),n._vertexFormat=Ie.clone(r,n._vertexFormat),n._stRotation=s,n._textureCoordinates=a,n.packedLength=c,n};Yx.createGeometry=function(e){let t=e._vertexFormat,n=e._polygonHierarchy,i=e._stRotation,o=e._textureCoordinates,r=u(o),s=n.positions;if(s=Eo(s,h.equalsEpsilon,!0),s.length<3)return;let a=BJe,c=kJe,l=VJe,f=UJe,d=zJe;if(!Gg.computeProjectTo2DArguments(s,R1,f,d))return;if(a=h.cross(f,d,a),a=h.normalize(a,a),!h.equalsEpsilon(R1,h.ZERO,R.EPSILON6)){let M=e._ellipsoid.geodeticSurfaceNormal(R1,WJe);h.dot(a,M)<0&&(a=h.negate(a,a),f=h.negate(f,f))}let g=Gg.createProjectPointsTo2DFunction(R1,f,d),m=Gg.createProjectPointTo2DFunction(R1,f,d);t.tangent&&(c=h.clone(f,c)),t.bitangent&&(l=h.clone(d,l));let y=zn.polygonsFromHierarchy(n,r,g,!1),b=y.hierarchy,C=y.polygons,A=function(M){return M},T=r?zn.polygonsFromHierarchy(o,!0,A,!1).polygons:void 0;if(b.length===0)return;s=b[0].outerRing;let E=ae.fromPoints(s),v=zn.computeBoundingRectangle(a,m,s,i,LJe),D=[];for(let M=0;M<C.length;M++){let L=new vt({geometry:jJe(C[M],t,v,i,r?T[M]:void 0,m,a,c,l)});D.push(L)}let O=Nn.combineInstances(D)[0];O.attributes.position.values=new Float64Array(O.attributes.position.values),O.indices=Be.createTypedArray(O.attributes.position.values.length/3,O.indices);let P=O.attributes;return t.position||delete P.position,new ft({attributes:P,indices:O.indices,primitiveType:O.primitiveType,boundingSphere:E})};var Rk=Yx;var xhe=[],Ok=[];function KJe(e,t,n,i,o){let s=os.fromPoints(t,e).projectPointsOntoPlane(t,xhe);ai.computeWindingOrder2D(s)===xs.CLOCKWISE&&(s.reverse(),t=t.slice().reverse());let c,l,f=t.length,d=0;if(i)for(c=new Float64Array(f*2*3),l=0;l<f;l++){let m=t[l],y=t[(l+1)%f];c[d++]=m.x,c[d++]=m.y,c[d++]=m.z,c[d++]=y.x,c[d++]=y.y,c[d++]=y.z}else{let m=0;if(o===nn.GEODESIC)for(l=0;l<f;l++)m+=zn.subdivideLineCount(t[l],t[(l+1)%f],n);else if(o===nn.RHUMB)for(l=0;l<f;l++)m+=zn.subdivideRhumbLineCount(e,t[l],t[(l+1)%f],n);for(c=new Float64Array(m*3),l=0;l<f;l++){let y;o===nn.GEODESIC?y=zn.subdivideLine(t[l],t[(l+1)%f],n,Ok):o===nn.RHUMB&&(y=zn.subdivideRhumbLine(e,t[l],t[(l+1)%f],n,Ok));let b=y.length;for(let C=0;C<b;++C)c[d++]=y[C]}}f=c.length/3;let p=f*2,g=Be.createTypedArray(f,p);for(d=0,l=0;l<f-1;l++)g[d++]=l,g[d++]=l+1;return g[d++]=f-1,g[d++]=0,new vt({geometry:new ft({attributes:new hn({position:new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:c})}),indices:g,primitiveType:Ne.LINES})})}function ZJe(e,t,n,i,o){let s=os.fromPoints(t,e).projectPointsOntoPlane(t,xhe);ai.computeWindingOrder2D(s)===xs.CLOCKWISE&&(s.reverse(),t=t.slice().reverse());let c,l,f=t.length,d=new Array(f),p=0;if(i)for(c=new Float64Array(f*2*3*2),l=0;l<f;++l){d[l]=p/3;let b=t[l],C=t[(l+1)%f];c[p++]=b.x,c[p++]=b.y,c[p++]=b.z,c[p++]=C.x,c[p++]=C.y,c[p++]=C.z}else{let b=0;if(o===nn.GEODESIC)for(l=0;l<f;l++)b+=zn.subdivideLineCount(t[l],t[(l+1)%f],n);else if(o===nn.RHUMB)for(l=0;l<f;l++)b+=zn.subdivideRhumbLineCount(e,t[l],t[(l+1)%f],n);for(c=new Float64Array(b*3*2),l=0;l<f;++l){d[l]=p/3;let C;o===nn.GEODESIC?C=zn.subdivideLine(t[l],t[(l+1)%f],n,Ok):o===nn.RHUMB&&(C=zn.subdivideRhumbLine(e,t[l],t[(l+1)%f],n,Ok));let A=C.length;for(let T=0;T<A;++T)c[p++]=C[T]}}f=c.length/(3*2);let g=d.length,m=(f*2+g)*2,y=Be.createTypedArray(f+g,m);for(p=0,l=0;l<f;++l)y[p++]=l,y[p++]=(l+1)%f,y[p++]=l+f,y[p++]=(l+1)%f+f;for(l=0;l<g;l++){let b=d[l];y[p++]=b,y[p++]=b+f}return new vt({geometry:new ft({attributes:new hn({position:new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:c})}),indices:y,primitiveType:Ne.LINES})})}function Xx(e){let t=e.polygonHierarchy,n=x(e.ellipsoid,ee.default),i=x(e.granularity,R.RADIANS_PER_DEGREE),o=x(e.perPositionHeight,!1),r=o&&u(e.extrudedHeight),s=x(e.arcType,nn.GEODESIC),a=x(e.height,0),c=x(e.extrudedHeight,a);if(!r){let l=Math.max(a,c);c=Math.min(a,c),a=l}this._ellipsoid=ee.clone(n),this._granularity=i,this._height=a,this._extrudedHeight=c,this._arcType=s,this._polygonHierarchy=t,this._perPositionHeight=o,this._perPositionHeightExtrude=r,this._offsetAttribute=e.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=zn.computeHierarchyPackedLength(t,h)+ee.packedLength+8}Xx.pack=function(e,t,n){return n=x(n,0),n=zn.packPolygonHierarchy(e._polygonHierarchy,t,n,h),ee.pack(e._ellipsoid,t,n),n+=ee.packedLength,t[n++]=e._height,t[n++]=e._extrudedHeight,t[n++]=e._granularity,t[n++]=e._perPositionHeightExtrude?1:0,t[n++]=e._perPositionHeight?1:0,t[n++]=e._arcType,t[n++]=x(e._offsetAttribute,-1),t[n]=e.packedLength,t};var $Je=ee.clone(ee.UNIT_SPHERE),QJe={polygonHierarchy:{}};Xx.unpack=function(e,t,n){t=x(t,0);let i=zn.unpackPolygonHierarchy(e,t,h);t=i.startingIndex,delete i.startingIndex;let o=ee.unpack(e,t,$Je);t+=ee.packedLength;let r=e[t++],s=e[t++],a=e[t++],c=e[t++]===1,l=e[t++]===1,f=e[t++],d=e[t++],p=e[t];return u(n)||(n=new Xx(QJe)),n._polygonHierarchy=i,n._ellipsoid=ee.clone(o,n._ellipsoid),n._height=r,n._extrudedHeight=s,n._granularity=a,n._perPositionHeight=l,n._perPositionHeightExtrude=c,n._arcType=f,n._offsetAttribute=d===-1?void 0:d,n.packedLength=p,n};Xx.fromPositions=function(e){e=x(e,x.EMPTY_OBJECT);let t={polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,arcType:e.arcType,offsetAttribute:e.offsetAttribute};return new Xx(t)};Xx.createGeometry=function(e){let t=e._ellipsoid,n=e._granularity,i=e._polygonHierarchy,o=e._perPositionHeight,r=e._arcType,s=zn.polygonOutlinesFromHierarchy(i,!o,t);if(s.length===0)return;let a,c=[],l=R.chordLength(n,t.maximumRadius),f=e._height,d=e._extrudedHeight,p=e._perPositionHeightExtrude||!R.equalsEpsilon(f,d,0,R.EPSILON2),g,m;if(p)for(m=0;m<s.length;m++){if(a=ZJe(t,s[m],l,o,r),a.geometry=zn.scaleToGeodeticHeightExtruded(a.geometry,f,d,t,o),u(e._offsetAttribute)){let C=a.geometry.attributes.position.values.length/3,A=new Uint8Array(C);e._offsetAttribute===an.TOP?A=A.fill(1,0,C/2):(g=e._offsetAttribute===an.NONE?0:1,A=A.fill(g)),a.geometry.attributes.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:A})}c.push(a)}else for(m=0;m<s.length;m++){if(a=KJe(t,s[m],l,o,r),a.geometry.attributes.position.values=ai.scaleToGeodeticHeight(a.geometry.attributes.position.values,f,t,!o),u(e._offsetAttribute)){let C=a.geometry.attributes.position.values.length;g=e._offsetAttribute===an.NONE?0:1;let A=new Uint8Array(C/3).fill(g);a.geometry.attributes.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:A})}c.push(a)}let y=Nn.combineInstances(c)[0],b=ae.fromVertices(y.attributes.position.values);return new ft({attributes:y.attributes,indices:y.indices,primitiveType:y.primitiveType,boundingSphere:b,offsetAttribute:e._offsetAttribute})};var Mk=Xx;var bhe="Entity polygons cannot have both height and perPositionHeight.  height will be ignored",Che="heightReference is not supported for entity polygons with perPositionHeight. heightReference will be ignored",Ahe=new G,The=h.ZERO,Ehe=new h,She=new se,JJe=[],eet=new H;function tet(e){this.id=e,this.vertexFormat=void 0,this.polygonHierarchy=void 0,this.perPositionHeight=void 0,this.closeTop=void 0,this.closeBottom=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.offsetAttribute=void 0,this.arcType=void 0,this.textureCoordinates=void 0}function xu(e,t){Wn.call(this,{entity:e,scene:t,geometryOptions:new tet(e),geometryPropertyName:"polygon",observedPropertyNames:["availability","polygon"]}),this._onEntityPropertyChanged(e,"polygon",e.polygon,void 0)}u(Object.create)&&(xu.prototype=Object.create(Wn.prototype),xu.prototype.constructor=xu);xu.prototype.createFillGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i=this._options,o={show:new yn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:kn.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};if(this._materialProperty instanceof Ht){let s;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(s=this._materialProperty.color.getValue(e,Ahe)),u(s)||(s=G.WHITE),o.color=jt.fromColor(s)}u(i.offsetAttribute)&&(o.offset=to.fromCartesian3(Y.getValueOrDefault(this._terrainOffsetProperty,e,The,Ehe)));let r;return i.perPositionHeight&&!u(i.extrudedHeight)?r=new Rk(i):r=new Ag(i),new vt({id:t,geometry:r,attributes:o})};xu.prototype.createOutlineGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i=this._options,o=Y.getValueOrDefault(this._outlineColorProperty,e,G.BLACK,Ahe),r=this._distanceDisplayConditionProperty.getValue(e),s={show:new yn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:jt.fromColor(o),distanceDisplayCondition:kn.fromDistanceDisplayCondition(r),offset:void 0};u(i.offsetAttribute)&&(s.offset=to.fromCartesian3(Y.getValueOrDefault(this._terrainOffsetProperty,e,The,Ehe)));let a;return i.perPositionHeight&&!u(i.extrudedHeight)?a=new Rd(i):a=new Mk(i),new vt({id:t,geometry:a,attributes:s})};xu.prototype._computeCenter=function(e,t){let n=Y.getValueOrUndefined(this._entity.polygon.hierarchy,e);if(!u(n))return;let i=n.positions;if(i.length===0)return;let o=this._scene.ellipsoid,r=os.fromPoints(i,o),s=r.projectPointsOntoPlane(i,JJe),a=s.length,c=0,l=a-1,f=new H;for(let p=0;p<a;l=p++){let g=s[p],m=s[l],y=g.x*m.y-m.x*g.y,b=H.add(g,m,eet);b=H.multiplyByScalar(b,y,b),f=H.add(f,b,f),c+=y}let d=1/(c*3);return f=H.multiplyByScalar(f,d,f),r.projectPointOntoEllipsoid(f,t)};xu.prototype._isHidden=function(e,t){return!u(t.hierarchy)||ri.prototype._isHidden.call(this,e,t)};xu.prototype._isOnTerrain=function(e,t){let n=Wn.prototype._isOnTerrain.call(this,e,t),i=t.perPositionHeight,o=u(i)&&(i.isConstant?i.getValue(He.MINIMUM_VALUE):!0);return n&&!o};xu.prototype._isDynamic=function(e,t){return!t.hierarchy.isConstant||!Y.isConstant(t.height)||!Y.isConstant(t.extrudedHeight)||!Y.isConstant(t.granularity)||!Y.isConstant(t.stRotation)||!Y.isConstant(t.textureCoordinates)||!Y.isConstant(t.outlineWidth)||!Y.isConstant(t.perPositionHeight)||!Y.isConstant(t.closeTop)||!Y.isConstant(t.closeBottom)||!Y.isConstant(t.zIndex)||!Y.isConstant(t.arcType)||this._onTerrain&&!Y.isConstant(this._materialProperty)&&!(this._materialProperty instanceof Ht)};xu.prototype._setStaticOptions=function(e,t){let n=this._materialProperty instanceof Ht,i=this._options;i.vertexFormat=n?ln.VERTEX_FORMAT:ho.MaterialSupport.TEXTURED.vertexFormat;let o=t.hierarchy.getValue(He.MINIMUM_VALUE),r=Y.getValueOrUndefined(t.height,He.MINIMUM_VALUE),s=Y.getValueOrDefault(t.heightReference,He.MINIMUM_VALUE,Xe.NONE),a=Y.getValueOrUndefined(t.extrudedHeight,He.MINIMUM_VALUE),c=Y.getValueOrDefault(t.extrudedHeightReference,He.MINIMUM_VALUE,Xe.NONE),l=Y.getValueOrDefault(t.perPositionHeight,He.MINIMUM_VALUE,!1);r=Wn.getGeometryHeight(r,s);let f;if(l?(u(r)&&(r=void 0,At(bhe)),s!==Xe.NONE&&l&&(r=void 0,At(Che))):(u(a)&&!u(r)&&(r=0),f=Wn.computeGeometryOffsetAttribute(r,s,a,c)),i.polygonHierarchy=o,i.granularity=Y.getValueOrUndefined(t.granularity,He.MINIMUM_VALUE),i.stRotation=Y.getValueOrUndefined(t.stRotation,He.MINIMUM_VALUE),i.perPositionHeight=l,i.closeTop=Y.getValueOrDefault(t.closeTop,He.MINIMUM_VALUE,!0),i.closeBottom=Y.getValueOrDefault(t.closeBottom,He.MINIMUM_VALUE,!0),i.offsetAttribute=f,i.height=r,i.arcType=Y.getValueOrDefault(t.arcType,He.MINIMUM_VALUE,nn.GEODESIC),i.textureCoordinates=Y.getValueOrUndefined(t.textureCoordinates,He.MINIMUM_VALUE),a=Wn.getGeometryExtrudedHeight(a,c),a===Wn.CLAMP_TO_GROUND){let d=Ag.computeRectangleFromPositions(i.polygonHierarchy.positions,i.ellipsoid,i.arcType,She);a=di.getMinimumMaximumHeights(d).minimumTerrainHeight}i.extrudedHeight=a};xu.prototype._getIsClosed=function(e){let t=e.height,n=e.extrudedHeight,i=u(n)&&n!==t;return!e.perPositionHeight&&(!i&&t===0||i&&e.closeTop&&e.closeBottom)};xu.DynamicGeometryUpdater=HT;function HT(e,t,n){oi.call(this,e,t,n)}u(Object.create)&&(HT.prototype=Object.create(oi.prototype),HT.prototype.constructor=HT);HT.prototype._isHidden=function(e,t,n){return!u(this._options.polygonHierarchy)||oi.prototype._isHidden.call(this,e,t,n)};HT.prototype._setOptions=function(e,t,n){let i=this._options;i.polygonHierarchy=Y.getValueOrUndefined(t.hierarchy,n);let o=Y.getValueOrUndefined(t.height,n),r=Y.getValueOrDefault(t.heightReference,n,Xe.NONE),s=Y.getValueOrDefault(t.extrudedHeightReference,n,Xe.NONE),a=Y.getValueOrUndefined(t.extrudedHeight,n),c=Y.getValueOrUndefined(t.perPositionHeight,n);o=Wn.getGeometryHeight(o,s);let l;if(c?(u(o)&&(o=void 0,At(bhe)),r!==Xe.NONE&&c&&(o=void 0,At(Che))):(u(a)&&!u(o)&&(o=0),l=Wn.computeGeometryOffsetAttribute(o,r,a,s)),i.granularity=Y.getValueOrUndefined(t.granularity,n),i.stRotation=Y.getValueOrUndefined(t.stRotation,n),i.textureCoordinates=Y.getValueOrUndefined(t.textureCoordinates,n),i.perPositionHeight=Y.getValueOrUndefined(t.perPositionHeight,n),i.closeTop=Y.getValueOrDefault(t.closeTop,n,!0),i.closeBottom=Y.getValueOrDefault(t.closeBottom,n,!0),i.offsetAttribute=l,i.height=o,i.arcType=Y.getValueOrDefault(t.arcType,n,nn.GEODESIC),a=Wn.getGeometryExtrudedHeight(a,s),a===Wn.CLAMP_TO_GROUND){let f=Ag.computeRectangleFromPositions(i.polygonHierarchy.positions,i.ellipsoid,i.arcType,She);a=di.getMinimumMaximumHeights(f).minimumTerrainHeight}i.extrudedHeight=a};var Lk=xu;function net(e,t,n,i){let o=new hn;i.position&&(o.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:e}));let r=t.length,s=e.length/3,a=(s-r*2)/(r*2),c=ai.triangulate(t),l=(a-1)*r*6+c.length*2,f=Be.createTypedArray(s,l),d,p,g,m,y,b,C=r*2,A=0;for(d=0;d<a-1;d++){for(p=0;p<r-1;p++)g=p*2+d*r*2,b=g+C,m=g+1,y=m+C,f[A++]=m,f[A++]=g,f[A++]=y,f[A++]=y,f[A++]=g,f[A++]=b;g=r*2-2+d*r*2,m=g+1,y=m+C,b=g+C,f[A++]=m,f[A++]=g,f[A++]=y,f[A++]=y,f[A++]=g,f[A++]=b}if(i.st||i.tangent||i.bitangent){let v=new Float32Array(s*2),D=1/(a-1),O=1/n.height,P=n.height/2,M,L,_=0;for(d=0;d<a;d++){for(M=d*D,L=O*(t[0].y+P),v[_++]=M,v[_++]=L,p=1;p<r;p++)L=O*(t[p].y+P),v[_++]=M,v[_++]=L,v[_++]=M,v[_++]=L;L=O*(t[0].y+P),v[_++]=M,v[_++]=L}for(p=0;p<r;p++)M=0,L=O*(t[p].y+P),v[_++]=M,v[_++]=L;for(p=0;p<r;p++)M=(a-1)*D,L=O*(t[p].y+P),v[_++]=M,v[_++]=L;o.st=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:new Float32Array(v)})}let T=s-r*2;for(d=0;d<c.length;d+=3){let v=c[d]+T,D=c[d+1]+T,O=c[d+2]+T;f[A++]=v,f[A++]=D,f[A++]=O,f[A++]=O+r,f[A++]=D+r,f[A++]=v+r}let E=new ft({attributes:o,indices:f,boundingSphere:ae.fromVertices(e),primitiveType:Ne.TRIANGLES});if(i.normal&&(E=Nn.computeNormal(E)),i.tangent||i.bitangent){try{E=Nn.computeTangentAndBitangent(E)}catch{At("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}i.tangent||(E.attributes.tangent=void 0),i.bitangent||(E.attributes.bitangent=void 0),i.st||(E.attributes.st=void 0)}return E}function M1(e){e=x(e,x.EMPTY_OBJECT);let t=e.polylinePositions,n=e.shapePositions;this._positions=t,this._shape=n,this._ellipsoid=ee.clone(x(e.ellipsoid,ee.default)),this._cornerType=x(e.cornerType,ki.ROUNDED),this._vertexFormat=Ie.clone(x(e.vertexFormat,Ie.DEFAULT)),this._granularity=x(e.granularity,R.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeGeometry";let i=1+t.length*h.packedLength;i+=1+n.length*H.packedLength,this.packedLength=i+ee.packedLength+Ie.packedLength+2}M1.pack=function(e,t,n){n=x(n,0);let i,o=e._positions,r=o.length;for(t[n++]=r,i=0;i<r;++i,n+=h.packedLength)h.pack(o[i],t,n);let s=e._shape;for(r=s.length,t[n++]=r,i=0;i<r;++i,n+=H.packedLength)H.pack(s[i],t,n);return ee.pack(e._ellipsoid,t,n),n+=ee.packedLength,Ie.pack(e._vertexFormat,t,n),n+=Ie.packedLength,t[n++]=e._cornerType,t[n]=e._granularity,t};var vhe=ee.clone(ee.UNIT_SPHERE),whe=new Ie,O1={polylinePositions:void 0,shapePositions:void 0,ellipsoid:vhe,vertexFormat:whe,cornerType:void 0,granularity:void 0};M1.unpack=function(e,t,n){t=x(t,0);let i,o=e[t++],r=new Array(o);for(i=0;i<o;++i,t+=h.packedLength)r[i]=h.unpack(e,t);o=e[t++];let s=new Array(o);for(i=0;i<o;++i,t+=H.packedLength)s[i]=H.unpack(e,t);let a=ee.unpack(e,t,vhe);t+=ee.packedLength;let c=Ie.unpack(e,t,whe);t+=Ie.packedLength;let l=e[t++],f=e[t];return u(n)?(n._positions=r,n._shape=s,n._ellipsoid=ee.clone(a,n._ellipsoid),n._vertexFormat=Ie.clone(c,n._vertexFormat),n._cornerType=l,n._granularity=f,n):(O1.polylinePositions=r,O1.shapePositions=s,O1.cornerType=l,O1.granularity=f,new M1(O1))};var iet=new qe;M1.createGeometry=function(e){let t=e._positions,n=Eo(t,h.equalsEpsilon),i=e._shape;if(i=sm.removeDuplicatesFromShape(i),n.length<2||i.length<3)return;ai.computeWindingOrder2D(i)===xs.CLOCKWISE&&i.reverse();let o=qe.fromPoints(i,iet),r=sm.computePositions(n,i,o,e,!0);return net(r,i,o,e._vertexFormat)};var Nk=M1;function oet(e,t){let n=new hn;n.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:e});let i=t.length,o=n.position.values.length/3,s=e.length/3/i,a=Be.createTypedArray(o,2*i*(s+1)),c,l,f=0;c=0;let d=c*i;for(l=0;l<i-1;l++)a[f++]=l+d,a[f++]=l+d+1;for(a[f++]=i-1+d,a[f++]=d,c=s-1,d=c*i,l=0;l<i-1;l++)a[f++]=l+d,a[f++]=l+d+1;for(a[f++]=i-1+d,a[f++]=d,c=0;c<s-1;c++){let g=i*c,m=g+i;for(l=0;l<i;l++)a[f++]=l+g,a[f++]=l+m}return new ft({attributes:n,indices:Be.createTypedArray(o,a),boundingSphere:ae.fromVertices(e),primitiveType:Ne.LINES})}function N1(e){e=x(e,x.EMPTY_OBJECT);let t=e.polylinePositions,n=e.shapePositions;this._positions=t,this._shape=n,this._ellipsoid=ee.clone(x(e.ellipsoid,ee.default)),this._cornerType=x(e.cornerType,ki.ROUNDED),this._granularity=x(e.granularity,R.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeOutlineGeometry";let i=1+t.length*h.packedLength;i+=1+n.length*H.packedLength,this.packedLength=i+ee.packedLength+2}N1.pack=function(e,t,n){n=x(n,0);let i,o=e._positions,r=o.length;for(t[n++]=r,i=0;i<r;++i,n+=h.packedLength)h.pack(o[i],t,n);let s=e._shape;for(r=s.length,t[n++]=r,i=0;i<r;++i,n+=H.packedLength)H.pack(s[i],t,n);return ee.pack(e._ellipsoid,t,n),n+=ee.packedLength,t[n++]=e._cornerType,t[n]=e._granularity,t};var Dhe=ee.clone(ee.UNIT_SPHERE),L1={polylinePositions:void 0,shapePositions:void 0,ellipsoid:Dhe,height:void 0,cornerType:void 0,granularity:void 0};N1.unpack=function(e,t,n){t=x(t,0);let i,o=e[t++],r=new Array(o);for(i=0;i<o;++i,t+=h.packedLength)r[i]=h.unpack(e,t);o=e[t++];let s=new Array(o);for(i=0;i<o;++i,t+=H.packedLength)s[i]=H.unpack(e,t);let a=ee.unpack(e,t,Dhe);t+=ee.packedLength;let c=e[t++],l=e[t];return u(n)?(n._positions=r,n._shape=s,n._ellipsoid=ee.clone(a,n._ellipsoid),n._cornerType=c,n._granularity=l,n):(L1.polylinePositions=r,L1.shapePositions=s,L1.cornerType=c,L1.granularity=l,new N1(L1))};var ret=new qe;N1.createGeometry=function(e){let t=e._positions,n=Eo(t,h.equalsEpsilon),i=e._shape;if(i=sm.removeDuplicatesFromShape(i),n.length<2||i.length<3)return;ai.computeWindingOrder2D(i)===xs.CLOCKWISE&&i.reverse();let o=qe.fromPoints(i,ret),r=sm.computePositions(n,i,o,e,!1);return oet(r,i)};var Fk=N1;var Ihe=new G;function set(e){this.id=e,this.vertexFormat=void 0,this.polylinePositions=void 0,this.shapePositions=void 0,this.cornerType=void 0,this.granularity=void 0}function mm(e,t){ri.call(this,{entity:e,scene:t,geometryOptions:new set(e),geometryPropertyName:"polylineVolume",observedPropertyNames:["availability","polylineVolume"]}),this._onEntityPropertyChanged(e,"polylineVolume",e.polylineVolume,void 0)}u(Object.create)&&(mm.prototype=Object.create(ri.prototype),mm.prototype.constructor=mm);mm.prototype.createFillGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i,o,r=new yn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),s=this._distanceDisplayConditionProperty.getValue(e),a=kn.fromDistanceDisplayCondition(s);if(this._materialProperty instanceof Ht){let c;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(c=this._materialProperty.color.getValue(e,Ihe)),u(c)||(c=G.WHITE),o=jt.fromColor(c),i={show:r,distanceDisplayCondition:a,color:o}}else i={show:r,distanceDisplayCondition:a};return new vt({id:t,geometry:new Nk(this._options),attributes:i})};mm.prototype.createOutlineGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i=Y.getValueOrDefault(this._outlineColorProperty,e,G.BLACK,Ihe),o=this._distanceDisplayConditionProperty.getValue(e);return new vt({id:t,geometry:new Fk(this._options),attributes:{show:new yn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:jt.fromColor(i),distanceDisplayCondition:kn.fromDistanceDisplayCondition(o)}})};mm.prototype._isHidden=function(e,t){return!u(t.positions)||!u(t.shape)||ri.prototype._isHidden.call(this,e,t)};mm.prototype._isDynamic=function(e,t){return!t.positions.isConstant||!t.shape.isConstant||!Y.isConstant(t.granularity)||!Y.isConstant(t.outlineWidth)||!Y.isConstant(t.cornerType)};mm.prototype._setStaticOptions=function(e,t){let n=t.granularity,i=t.cornerType,o=this._options,r=this._materialProperty instanceof Ht;o.vertexFormat=r?ln.VERTEX_FORMAT:ho.MaterialSupport.TEXTURED.vertexFormat,o.polylinePositions=t.positions.getValue(He.MINIMUM_VALUE,o.polylinePositions),o.shapePositions=t.shape.getValue(He.MINIMUM_VALUE,o.shape),o.granularity=u(n)?n.getValue(He.MINIMUM_VALUE):void 0,o.cornerType=u(i)?i.getValue(He.MINIMUM_VALUE):void 0};mm.DynamicGeometryUpdater=GT;function GT(e,t,n){oi.call(this,e,t,n)}u(Object.create)&&(GT.prototype=Object.create(oi.prototype),GT.prototype.constructor=GT);GT.prototype._isHidden=function(e,t,n){let i=this._options;return!u(i.polylinePositions)||!u(i.shapePositions)||oi.prototype._isHidden.call(this,e,t,n)};GT.prototype._setOptions=function(e,t,n){let i=this._options;i.polylinePositions=Y.getValueOrUndefined(t.positions,n,i.polylinePositions),i.shapePositions=Y.getValueOrUndefined(t.shape,n),i.granularity=Y.getValueOrUndefined(t.granularity,n),i.cornerType=Y.getValueOrUndefined(t.cornerType,n)};var Bk=mm;var iq=new h,Ohe=new h,Mhe=new h,Lhe=new h,Nhe=new se,aet=new H,cet=new ae,uet=new ae;function Fhe(e,t){let n=new ft({attributes:new hn,primitiveType:Ne.TRIANGLES});return n.attributes.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:t.positions}),e.normal&&(n.attributes.normal=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:t.normals})),e.tangent&&(n.attributes.tangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:t.tangents})),e.bitangent&&(n.attributes.bitangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:t.bitangents})),n}function fet(e,t,n,i){let o=e.length,r=t.normal?new Float32Array(o):void 0,s=t.tangent?new Float32Array(o):void 0,a=t.bitangent?new Float32Array(o):void 0,c=0,l=Lhe,f=Mhe,d=Ohe;if(t.normal||t.tangent||t.bitangent)for(let p=0;p<o;p+=3){let g=h.fromArray(e,p,iq),m=c+1,y=c+2;d=n.geodeticSurfaceNormal(g,d),(t.tangent||t.bitangent)&&(h.cross(h.UNIT_Z,d,f),J.multiplyByVector(i,f,f),h.normalize(f,f),t.bitangent&&h.normalize(h.cross(d,f,l),l)),t.normal&&(r[c]=d.x,r[m]=d.y,r[y]=d.z),t.tangent&&(s[c]=f.x,s[m]=f.y,s[y]=f.z),t.bitangent&&(a[c]=l.x,a[m]=l.y,a[y]=l.z),c+=3}return Fhe(t,{positions:e,normals:r,tangents:s,bitangents:a})}var oq=new h,Bhe=new h;function det(e,t,n){let i=e.length,o=t.normal?new Float32Array(i):void 0,r=t.tangent?new Float32Array(i):void 0,s=t.bitangent?new Float32Array(i):void 0,a=0,c=0,l=0,f=!0,d=Lhe,p=Mhe,g=Ohe;if(t.normal||t.tangent||t.bitangent)for(let m=0;m<i;m+=6){let y=h.fromArray(e,m,iq),b=h.fromArray(e,(m+6)%i,oq);if(f){let C=h.fromArray(e,(m+3)%i,Bhe);h.subtract(b,y,b),h.subtract(C,y,C),g=h.normalize(h.cross(C,b,g),g),f=!1}h.equalsEpsilon(b,y,R.EPSILON10)&&(f=!0),(t.tangent||t.bitangent)&&(d=n.geodeticSurfaceNormal(y,d),t.tangent&&(p=h.normalize(h.cross(d,g,p),p))),t.normal&&(o[a++]=g.x,o[a++]=g.y,o[a++]=g.z,o[a++]=g.x,o[a++]=g.y,o[a++]=g.z),t.tangent&&(r[c++]=p.x,r[c++]=p.y,r[c++]=p.z,r[c++]=p.x,r[c++]=p.y,r[c++]=p.z),t.bitangent&&(s[l++]=d.x,s[l++]=d.y,s[l++]=d.z,s[l++]=d.x,s[l++]=d.y,s[l++]=d.z)}return Fhe(t,{positions:e,normals:o,tangents:r,bitangents:s})}function khe(e,t){let n=e._vertexFormat,i=e._ellipsoid,o=t.height,r=t.width,s=t.northCap,a=t.southCap,c=0,l=o,f=o,d=0;s&&(c=1,f-=1,d+=1),a&&(l-=1,f-=1,d+=1),d+=r*f;let p=n.position?new Float64Array(d*3):void 0,g=n.st?new Float32Array(d*2):void 0,m=0,y=0,b=iq,C=aet,A=Number.MAX_VALUE,T=Number.MAX_VALUE,E=-Number.MAX_VALUE,v=-Number.MAX_VALUE;for(let S=c;S<l;++S)for(let w=0;w<r;++w)Hs.computePosition(t,i,n.st,S,w,b,C),p[m++]=b.x,p[m++]=b.y,p[m++]=b.z,n.st&&(g[y++]=C.x,g[y++]=C.y,A=Math.min(A,C.x),T=Math.min(T,C.y),E=Math.max(E,C.x),v=Math.max(v,C.y));if(s&&(Hs.computePosition(t,i,n.st,0,0,b,C),p[m++]=b.x,p[m++]=b.y,p[m++]=b.z,n.st&&(g[y++]=C.x,g[y++]=C.y,A=C.x,T=C.y,E=C.x,v=C.y)),a&&(Hs.computePosition(t,i,n.st,o-1,0,b,C),p[m++]=b.x,p[m++]=b.y,p[m]=b.z,n.st&&(g[y++]=C.x,g[y]=C.y,A=Math.min(A,C.x),T=Math.min(T,C.y),E=Math.max(E,C.x),v=Math.max(v,C.y))),n.st&&(A<0||T<0||E>1||v>1))for(let S=0;S<g.length;S+=2)g[S]=(g[S]-A)/(E-A),g[S+1]=(g[S+1]-T)/(v-T);let D=fet(p,n,i,t.tangentRotationMatrix),O=6*(r-1)*(f-1);s&&(O+=3*(r-1)),a&&(O+=3*(r-1));let P=Be.createTypedArray(d,O),M=0,L=0,_;for(_=0;_<f-1;++_){for(let S=0;S<r-1;++S){let w=M,I=w+r,N=I+1,k=w+1;P[L++]=w,P[L++]=I,P[L++]=k,P[L++]=k,P[L++]=I,P[L++]=N,++M}++M}if(s||a){let S=d-1,w=d-1;s&&a&&(S=d-2);let I,N;if(M=0,s)for(_=0;_<r-1;_++)I=M,N=I+1,P[L++]=S,P[L++]=I,P[L++]=N,++M;if(a)for(M=(f-1)*r,_=0;_<r-1;_++)I=M,N=I+1,P[L++]=I,P[L++]=w,P[L++]=N,++M}return D.indices=P,n.st&&(D.attributes.st=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:g})),D}function WT(e,t,n,i,o){return e[t++]=i[n],e[t++]=i[n+1],e[t++]=i[n+2],e[t++]=o[n],e[t++]=o[n+1],e[t]=o[n+2],e}function jT(e,t,n,i){return e[t++]=i[n],e[t++]=i[n+1],e[t++]=i[n],e[t]=i[n+1],e}var rq=new Ie;function het(e,t){let n=e._shadowVolume,i=e._offsetAttribute,o=e._vertexFormat,r=e._extrudedHeight,s=e._surfaceHeight,a=e._ellipsoid,c=t.height,l=t.width,f;if(n){let Oe=Ie.clone(o,rq);Oe.normal=!0,e._vertexFormat=Oe}let d=khe(e,t);n&&(e._vertexFormat=o);let p=ai.scaleToGeodeticHeight(d.attributes.position.values,s,a,!1);p=new Float64Array(p);let g=p.length,m=g*2,y=new Float64Array(m);y.set(p);let b=ai.scaleToGeodeticHeight(d.attributes.position.values,r,a);y.set(b,g),d.attributes.position.values=y;let C=o.normal?new Float32Array(m):void 0,A=o.tangent?new Float32Array(m):void 0,T=o.bitangent?new Float32Array(m):void 0,E=o.st?new Float32Array(m/3*2):void 0,v,D;if(o.normal){for(D=d.attributes.normal.values,C.set(D),f=0;f<g;f++)D[f]=-D[f];C.set(D,g),d.attributes.normal.values=C}if(n){D=d.attributes.normal.values,o.normal||(d.attributes.normal=void 0);let Oe=new Float32Array(m);for(f=0;f<g;f++)D[f]=-D[f];Oe.set(D,g),d.attributes.extrudeDirection=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:Oe})}let O,P=u(i);if(P){let Oe=g/3*2,Mt=new Uint8Array(Oe);i===an.TOP?Mt=Mt.fill(1,0,Oe/2):(O=i===an.NONE?0:1,Mt=Mt.fill(O)),d.attributes.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:Mt})}if(o.tangent){let Oe=d.attributes.tangent.values;for(A.set(Oe),f=0;f<g;f++)Oe[f]=-Oe[f];A.set(Oe,g),d.attributes.tangent.values=A}if(o.bitangent){let Oe=d.attributes.bitangent.values;T.set(Oe),T.set(Oe,g),d.attributes.bitangent.values=T}o.st&&(v=d.attributes.st.values,E.set(v),E.set(v,g/3*2),d.attributes.st.values=E);let M=d.indices,L=M.length,_=g/3,S=Be.createTypedArray(m/3,L*2);for(S.set(M),f=0;f<L;f+=3)S[f+L]=M[f+2]+_,S[f+1+L]=M[f+1]+_,S[f+2+L]=M[f]+_;d.indices=S;let w=t.northCap,I=t.southCap,N=c,k=2,z=0,V=4,U=4;w&&(k-=1,N-=1,z+=1,V-=2,U-=1),I&&(k-=1,N-=1,z+=1,V-=2,U-=1),z+=k*l+2*N-V;let B=(z+U)*2,W=new Float64Array(B*3),j=n?new Float32Array(B*3):void 0,Q=P?new Uint8Array(B):void 0,q=o.st?new Float32Array(B*2):void 0,X=i===an.TOP;P&&!X&&(O=i===an.ALL?1:0,Q=Q.fill(O));let Z=0,fe=0,xe=0,re=0,pe=l*N,ye;for(f=0;f<pe;f+=l)ye=f*3,W=WT(W,Z,ye,p,b),Z+=6,o.st&&(q=jT(q,fe,f*2,v),fe+=4),n&&(xe+=3,j[xe++]=D[ye],j[xe++]=D[ye+1],j[xe++]=D[ye+2]),X&&(Q[re++]=1,re+=1);if(I){let Oe=w?pe+1:pe;for(ye=Oe*3,f=0;f<2;f++)W=WT(W,Z,ye,p,b),Z+=6,o.st&&(q=jT(q,fe,Oe*2,v),fe+=4),n&&(xe+=3,j[xe++]=D[ye],j[xe++]=D[ye+1],j[xe++]=D[ye+2]),X&&(Q[re++]=1,re+=1)}else for(f=pe-l;f<pe;f++)ye=f*3,W=WT(W,Z,ye,p,b),Z+=6,o.st&&(q=jT(q,fe,f*2,v),fe+=4),n&&(xe+=3,j[xe++]=D[ye],j[xe++]=D[ye+1],j[xe++]=D[ye+2]),X&&(Q[re++]=1,re+=1);for(f=pe-1;f>0;f-=l)ye=f*3,W=WT(W,Z,ye,p,b),Z+=6,o.st&&(q=jT(q,fe,f*2,v),fe+=4),n&&(xe+=3,j[xe++]=D[ye],j[xe++]=D[ye+1],j[xe++]=D[ye+2]),X&&(Q[re++]=1,re+=1);if(w){let Oe=pe;for(ye=Oe*3,f=0;f<2;f++)W=WT(W,Z,ye,p,b),Z+=6,o.st&&(q=jT(q,fe,Oe*2,v),fe+=4),n&&(xe+=3,j[xe++]=D[ye],j[xe++]=D[ye+1],j[xe++]=D[ye+2]),X&&(Q[re++]=1,re+=1)}else for(f=l-1;f>=0;f--)ye=f*3,W=WT(W,Z,ye,p,b),Z+=6,o.st&&(q=jT(q,fe,f*2,v),fe+=4),n&&(xe+=3,j[xe++]=D[ye],j[xe++]=D[ye+1],j[xe++]=D[ye+2]),X&&(Q[re++]=1,re+=1);let Se=det(W,o,a);o.st&&(Se.attributes.st=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:q})),n&&(Se.attributes.extrudeDirection=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:j})),P&&(Se.attributes.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:Q}));let Te=Be.createTypedArray(B,z*6),Fe,Ve,Ze,gt;g=W.length/3;let lt=0;for(f=0;f<g-1;f+=2){Fe=f,gt=(Fe+2)%g;let Oe=h.fromArray(W,Fe*3,oq),Mt=h.fromArray(W,gt*3,Bhe);h.equalsEpsilon(Oe,Mt,R.EPSILON10)||(Ve=(Fe+1)%g,Ze=(Ve+2)%g,Te[lt++]=Fe,Te[lt++]=Ve,Te[lt++]=gt,Te[lt++]=gt,Te[lt++]=Ve,Te[lt++]=Ze)}return Se.indices=Te,Se=Nn.combineInstances([new vt({geometry:d}),new vt({geometry:Se})]),Se[0]}var met=[new h,new h,new h,new h],Vhe=new de,pet=new de;function sq(e,t,n,i,o){if(n===0)return se.clone(e,o);let r=Hs.computeOptions(e,t,n,0,Nhe,Vhe),s=r.height,a=r.width,c=met;return Hs.computePosition(r,i,!1,0,0,c[0]),Hs.computePosition(r,i,!1,0,a-1,c[1]),Hs.computePosition(r,i,!1,s-1,0,c[2]),Hs.computePosition(r,i,!1,s-1,a-1,c[3]),se.fromCartesianArray(c,i,o)}function pm(e){e=x(e,x.EMPTY_OBJECT);let t=e.rectangle,n=x(e.height,0),i=x(e.extrudedHeight,n);this._rectangle=se.clone(t),this._granularity=x(e.granularity,R.RADIANS_PER_DEGREE),this._ellipsoid=ee.clone(x(e.ellipsoid,ee.default)),this._surfaceHeight=Math.max(n,i),this._rotation=x(e.rotation,0),this._stRotation=x(e.stRotation,0),this._vertexFormat=Ie.clone(x(e.vertexFormat,Ie.DEFAULT)),this._extrudedHeight=Math.min(n,i),this._shadowVolume=x(e.shadowVolume,!1),this._workerName="createRectangleGeometry",this._offsetAttribute=e.offsetAttribute,this._rotatedRectangle=void 0,this._textureCoordinateRotationPoints=void 0}pm.packedLength=se.packedLength+ee.packedLength+Ie.packedLength+7;pm.pack=function(e,t,n){return n=x(n,0),se.pack(e._rectangle,t,n),n+=se.packedLength,ee.pack(e._ellipsoid,t,n),n+=ee.packedLength,Ie.pack(e._vertexFormat,t,n),n+=Ie.packedLength,t[n++]=e._granularity,t[n++]=e._surfaceHeight,t[n++]=e._rotation,t[n++]=e._stRotation,t[n++]=e._extrudedHeight,t[n++]=e._shadowVolume?1:0,t[n]=x(e._offsetAttribute,-1),t};var Uhe=new se,zhe=ee.clone(ee.UNIT_SPHERE),m0={rectangle:Uhe,ellipsoid:zhe,vertexFormat:rq,granularity:void 0,height:void 0,rotation:void 0,stRotation:void 0,extrudedHeight:void 0,shadowVolume:void 0,offsetAttribute:void 0};pm.unpack=function(e,t,n){t=x(t,0);let i=se.unpack(e,t,Uhe);t+=se.packedLength;let o=ee.unpack(e,t,zhe);t+=ee.packedLength;let r=Ie.unpack(e,t,rq);t+=Ie.packedLength;let s=e[t++],a=e[t++],c=e[t++],l=e[t++],f=e[t++],d=e[t++]===1,p=e[t];return u(n)?(n._rectangle=se.clone(i,n._rectangle),n._ellipsoid=ee.clone(o,n._ellipsoid),n._vertexFormat=Ie.clone(r,n._vertexFormat),n._granularity=s,n._surfaceHeight=a,n._rotation=c,n._stRotation=l,n._extrudedHeight=f,n._shadowVolume=d,n._offsetAttribute=p===-1?void 0:p,n):(m0.granularity=s,m0.height=a,m0.rotation=c,m0.stRotation=l,m0.extrudedHeight=f,m0.shadowVolume=d,m0.offsetAttribute=p===-1?void 0:p,new pm(m0))};pm.computeRectangle=function(e,t){e=x(e,x.EMPTY_OBJECT);let n=e.rectangle,i=x(e.granularity,R.RADIANS_PER_DEGREE),o=x(e.ellipsoid,ee.default),r=x(e.rotation,0);return sq(n,i,r,o,t)};var _et=new J,Phe=new Le,get=new de;pm.createGeometry=function(e){if(R.equalsEpsilon(e._rectangle.north,e._rectangle.south,R.EPSILON10)||R.equalsEpsilon(e._rectangle.east,e._rectangle.west,R.EPSILON10))return;let t=e._rectangle,n=e._ellipsoid,i=e._rotation,o=e._stRotation,r=e._vertexFormat,s=Hs.computeOptions(t,e._granularity,i,o,Nhe,Vhe,pet),a=_et;if(o!==0||i!==0){let g=se.center(t,get),m=n.geodeticSurfaceNormalCartographic(g,oq);Le.fromAxisAngle(m,-o,Phe),J.fromQuaternion(Phe,a)}else J.clone(J.IDENTITY,a);let c=e._surfaceHeight,l=e._extrudedHeight,f=!R.equalsEpsilon(c,l,0,R.EPSILON2);s.lonScalar=1/e._rectangle.width,s.latScalar=1/e._rectangle.height,s.tangentRotationMatrix=a;let d,p;if(t=e._rectangle,f){d=het(e,s);let g=ae.fromRectangle3D(t,n,c,uet),m=ae.fromRectangle3D(t,n,l,cet);p=ae.union(g,m)}else{if(d=khe(e,s),d.attributes.position.values=ai.scaleToGeodeticHeight(d.attributes.position.values,c,n,!1),u(e._offsetAttribute)){let g=d.attributes.position.values.length,m=e._offsetAttribute===an.NONE?0:1,y=new Uint8Array(g/3).fill(m);d.attributes.applyOffset=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:1,values:y})}p=ae.fromRectangle3D(t,n,c)}return r.position||delete d.attributes.position,new ft({attributes:d.attributes,indices:d.indices,primitiveType:d.primitiveType,boundingSphere:p,offsetAttribute:e._offsetAttribute})};pm.createShadowVolume=function(e,t,n){let i=e._granularity,o=e._ellipsoid,r=t(i,o),s=n(i,o);return new pm({rectangle:e._rectangle,rotation:e._rotation,ellipsoid:o,stRotation:e._stRotation,granularity:i,extrudedHeight:s,height:r,vertexFormat:Ie.POSITION_ONLY,shadowVolume:!0})};var Rhe=new se,yet=[new H,new H,new H],xet=new Hi,bet=new de;function Cet(e){if(e._stRotation===0)return[0,0,0,1,1,0];let t=se.clone(e._rectangle,Rhe),n=e._granularity,i=e._ellipsoid,o=e._rotation-e._stRotation,r=sq(t,n,o,i,Rhe),s=yet;s[0].x=r.west,s[0].y=r.south,s[1].x=r.west,s[1].y=r.north,s[2].x=r.east,s[2].y=r.south;let a=e.rectangle,c=Hi.fromRotation(e._stRotation,xet),l=se.center(a,bet);for(let m=0;m<3;++m){let y=s[m];y.x-=l.longitude,y.y-=l.latitude,Hi.multiplyByVector(c,y,y),y.x+=l.longitude,y.y+=l.latitude,y.x=(y.x-a.west)/a.width,y.y=(y.y-a.south)/a.height}let f=s[0],d=s[1],p=s[2],g=new Array(6);return H.pack(f,g),H.pack(d,g,2),H.pack(p,g,4),g}Object.defineProperties(pm.prototype,{rectangle:{get:function(){return u(this._rotatedRectangle)||(this._rotatedRectangle=sq(this._rectangle,this._granularity,this._rotation,this._ellipsoid)),this._rotatedRectangle}},textureCoordinateRotationPoints:{get:function(){return u(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=Cet(this)),this._textureCoordinateRotationPoints}}});var qT=pm;var Hhe=new G,Ghe=h.ZERO,Whe=new h,jhe=new se,Aet=new se,Tet=new de;function Eet(e){this.id=e,this.vertexFormat=void 0,this.rectangle=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.rotation=void 0,this.offsetAttribute=void 0}function Vd(e,t){Wn.call(this,{entity:e,scene:t,geometryOptions:new Eet(e),geometryPropertyName:"rectangle",observedPropertyNames:["availability","rectangle"]}),this._onEntityPropertyChanged(e,"rectangle",e.rectangle,void 0)}u(Object.create)&&(Vd.prototype=Object.create(Wn.prototype),Vd.prototype.constructor=Vd);Vd.prototype.createFillGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i={show:new yn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:kn.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};if(this._materialProperty instanceof Ht){let o;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(o=this._materialProperty.color.getValue(e,Hhe)),u(o)||(o=G.WHITE),i.color=jt.fromColor(o)}return u(this._options.offsetAttribute)&&(i.offset=to.fromCartesian3(Y.getValueOrDefault(this._terrainOffsetProperty,e,Ghe,Whe))),new vt({id:t,geometry:new qT(this._options),attributes:i})};Vd.prototype.createOutlineGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i=Y.getValueOrDefault(this._outlineColorProperty,e,G.BLACK,Hhe),o=this._distanceDisplayConditionProperty.getValue(e),r={show:new yn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:jt.fromColor(i),distanceDisplayCondition:kn.fromDistanceDisplayCondition(o),offset:void 0};return u(this._options.offsetAttribute)&&(r.offset=to.fromCartesian3(Y.getValueOrDefault(this._terrainOffsetProperty,e,Ghe,Whe))),new vt({id:t,geometry:new tT(this._options),attributes:r})};Vd.prototype._computeCenter=function(e,t){let n=Y.getValueOrUndefined(this._entity.rectangle.coordinates,e,Aet);if(!u(n))return;let i=se.center(n,Tet);return de.toCartesian(i,ee.default,t)};Vd.prototype._isHidden=function(e,t){return!u(t.coordinates)||ri.prototype._isHidden.call(this,e,t)};Vd.prototype._isDynamic=function(e,t){return!t.coordinates.isConstant||!Y.isConstant(t.height)||!Y.isConstant(t.extrudedHeight)||!Y.isConstant(t.granularity)||!Y.isConstant(t.stRotation)||!Y.isConstant(t.rotation)||!Y.isConstant(t.outlineWidth)||!Y.isConstant(t.zIndex)||this._onTerrain&&!Y.isConstant(this._materialProperty)&&!(this._materialProperty instanceof Ht)};Vd.prototype._setStaticOptions=function(e,t){let n=this._materialProperty instanceof Ht,i=Y.getValueOrUndefined(t.height,He.MINIMUM_VALUE),o=Y.getValueOrDefault(t.heightReference,He.MINIMUM_VALUE,Xe.NONE),r=Y.getValueOrUndefined(t.extrudedHeight,He.MINIMUM_VALUE),s=Y.getValueOrDefault(t.extrudedHeightReference,He.MINIMUM_VALUE,Xe.NONE);u(r)&&!u(i)&&(i=0);let a=this._options;a.vertexFormat=n?ln.VERTEX_FORMAT:ho.MaterialSupport.TEXTURED.vertexFormat,a.rectangle=t.coordinates.getValue(He.MINIMUM_VALUE,a.rectangle),a.granularity=Y.getValueOrUndefined(t.granularity,He.MINIMUM_VALUE),a.stRotation=Y.getValueOrUndefined(t.stRotation,He.MINIMUM_VALUE),a.rotation=Y.getValueOrUndefined(t.rotation,He.MINIMUM_VALUE),a.offsetAttribute=Wn.computeGeometryOffsetAttribute(i,o,r,s),a.height=Wn.getGeometryHeight(i,o),r=Wn.getGeometryExtrudedHeight(r,s),r===Wn.CLAMP_TO_GROUND&&(r=di.getMinimumMaximumHeights(qT.computeRectangle(a,jhe)).minimumTerrainHeight),a.extrudedHeight=r};Vd.DynamicGeometryUpdater=YT;function YT(e,t,n){oi.call(this,e,t,n)}u(Object.create)&&(YT.prototype=Object.create(oi.prototype),YT.prototype.constructor=YT);YT.prototype._isHidden=function(e,t,n){return!u(this._options.rectangle)||oi.prototype._isHidden.call(this,e,t,n)};YT.prototype._setOptions=function(e,t,n){let i=this._options,o=Y.getValueOrUndefined(t.height,n),r=Y.getValueOrDefault(t.heightReference,n,Xe.NONE),s=Y.getValueOrUndefined(t.extrudedHeight,n),a=Y.getValueOrDefault(t.extrudedHeightReference,n,Xe.NONE);u(s)&&!u(o)&&(o=0),i.rectangle=Y.getValueOrUndefined(t.coordinates,n,i.rectangle),i.granularity=Y.getValueOrUndefined(t.granularity,n),i.stRotation=Y.getValueOrUndefined(t.stRotation,n),i.rotation=Y.getValueOrUndefined(t.rotation,n),i.offsetAttribute=Wn.computeGeometryOffsetAttribute(o,r,s,a),i.height=Wn.getGeometryHeight(o,r),s=Wn.getGeometryExtrudedHeight(s,a),s===Wn.CLAMP_TO_GROUND&&(s=di.getMinimumMaximumHeights(qT.computeRectangle(i,jhe)).minimumTerrainHeight),i.extrudedHeight=s};var kk=Vd;var qhe={};function vet(e,t){return R.equalsEpsilon(e.latitude,t.latitude,R.EPSILON10)&&R.equalsEpsilon(e.longitude,t.longitude,R.EPSILON10)}var wet=new de,Det=new de;function Iet(e,t,n,i){t=Eo(t,h.equalsEpsilon);let o=t.length;if(o<2)return;let r=u(i),s=u(n),a=new Array(o),c=new Array(o),l=new Array(o),f=t[0];a[0]=f;let d=e.cartesianToCartographic(f,wet);s&&(d.height=n[0]),c[0]=d.height,r?l[0]=i[0]:l[0]=0;let p=c[0],g=l[0],m=p===g,y=1;for(let b=1;b<o;++b){let C=t[b],A=e.cartesianToCartographic(C,Det);s&&(A.height=n[b]),m=m&&A.height===0,vet(d,A)?d.height<A.height&&(c[y-1]=A.height):(a[y]=C,c[y]=A.height,r?l[y]=i[b]:l[y]=0,m=m&&c[y]===l[y],de.clone(A,d),++y)}if(!(m||y<2))return a.length=y,c.length=y,l.length=y,{positions:a,topHeights:c,bottomHeights:l}}var Pet=new Array(2),Ret=new Array(2),Oet={positions:void 0,height:void 0,granularity:void 0,ellipsoid:void 0};qhe.computePositions=function(e,t,n,i,o,r){let s=Iet(e,t,n,i);if(!u(s))return;t=s.positions,n=s.topHeights,i=s.bottomHeights;let a=t.length,c=a-2,l,f,d=R.chordLength(o,e.maximumRadius),p=Oet;if(p.minDistance=d,p.ellipsoid=e,r){let g=0,m;for(m=0;m<a-1;m++)g+=Fi.numberOfPoints(t[m],t[m+1],d)+1;l=new Float64Array(g*3),f=new Float64Array(g*3);let y=Pet,b=Ret;p.positions=y,p.height=b;let C=0;for(m=0;m<a-1;m++){y[0]=t[m],y[1]=t[m+1],b[0]=n[m],b[1]=n[m+1];let A=Fi.generateArc(p);l.set(A,C),b[0]=i[m],b[1]=i[m+1],f.set(Fi.generateArc(p),C),C+=A.length}}else p.positions=t,p.height=n,l=new Float64Array(Fi.generateArc(p)),p.height=i,f=new Float64Array(Fi.generateArc(p));return{bottomPositions:f,topPositions:l,numCorners:c}};var XT=qhe;var aq=new h,Vk=new h,Met=new h,Yhe=new h,Let=new h,Net=new h,Fet=new h;function Kx(e){e=x(e,x.EMPTY_OBJECT);let t=e.positions,n=e.maximumHeights,i=e.minimumHeights,o=x(e.vertexFormat,Ie.DEFAULT),r=x(e.granularity,R.RADIANS_PER_DEGREE),s=x(e.ellipsoid,ee.default);this._positions=t,this._minimumHeights=i,this._maximumHeights=n,this._vertexFormat=Ie.clone(o),this._granularity=r,this._ellipsoid=ee.clone(s),this._workerName="createWallGeometry";let a=1+t.length*h.packedLength+2;u(i)&&(a+=i.length),u(n)&&(a+=n.length),this.packedLength=a+ee.packedLength+Ie.packedLength+1}Kx.pack=function(e,t,n){n=x(n,0);let i,o=e._positions,r=o.length;for(t[n++]=r,i=0;i<r;++i,n+=h.packedLength)h.pack(o[i],t,n);let s=e._minimumHeights;if(r=u(s)?s.length:0,t[n++]=r,u(s))for(i=0;i<r;++i)t[n++]=s[i];let a=e._maximumHeights;if(r=u(a)?a.length:0,t[n++]=r,u(a))for(i=0;i<r;++i)t[n++]=a[i];return ee.pack(e._ellipsoid,t,n),n+=ee.packedLength,Ie.pack(e._vertexFormat,t,n),n+=Ie.packedLength,t[n]=e._granularity,t};var Xhe=ee.clone(ee.UNIT_SPHERE),Khe=new Ie,F1={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:Xhe,vertexFormat:Khe,granularity:void 0};Kx.unpack=function(e,t,n){t=x(t,0);let i,o=e[t++],r=new Array(o);for(i=0;i<o;++i,t+=h.packedLength)r[i]=h.unpack(e,t);o=e[t++];let s;if(o>0)for(s=new Array(o),i=0;i<o;++i)s[i]=e[t++];o=e[t++];let a;if(o>0)for(a=new Array(o),i=0;i<o;++i)a[i]=e[t++];let c=ee.unpack(e,t,Xhe);t+=ee.packedLength;let l=Ie.unpack(e,t,Khe);t+=Ie.packedLength;let f=e[t];return u(n)?(n._positions=r,n._minimumHeights=s,n._maximumHeights=a,n._ellipsoid=ee.clone(c,n._ellipsoid),n._vertexFormat=Ie.clone(l,n._vertexFormat),n._granularity=f,n):(F1.positions=r,F1.minimumHeights=s,F1.maximumHeights=a,F1.granularity=f,new Kx(F1))};Kx.fromConstantHeights=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.positions,n,i,o=e.minimumHeight,r=e.maximumHeight,s=u(o),a=u(r);if(s||a){let l=t.length;n=s?new Array(l):void 0,i=a?new Array(l):void 0;for(let f=0;f<l;++f)s&&(n[f]=o),a&&(i[f]=r)}let c={positions:t,maximumHeights:i,minimumHeights:n,ellipsoid:e.ellipsoid,vertexFormat:e.vertexFormat};return new Kx(c)};Kx.createGeometry=function(e){let t=e._positions,n=e._minimumHeights,i=e._maximumHeights,o=e._vertexFormat,r=e._granularity,s=e._ellipsoid,a=XT.computePositions(s,t,i,n,r,!0);if(!u(a))return;let c=a.bottomPositions,l=a.topPositions,f=a.numCorners,d=l.length,p=d*2,g=o.position?new Float64Array(p):void 0,m=o.normal?new Float32Array(p):void 0,y=o.tangent?new Float32Array(p):void 0,b=o.bitangent?new Float32Array(p):void 0,C=o.st?new Float32Array(p/3*2):void 0,A=0,T=0,E=0,v=0,D=0,O=Fet,P=Net,M=Let,L=!0;d/=3;let _,S=0,w=1/(d-f-1);for(_=0;_<d;++_){let V=_*3,U=h.fromArray(l,V,aq),B=h.fromArray(c,V,Vk);if(o.position&&(g[A++]=B.x,g[A++]=B.y,g[A++]=B.z,g[A++]=U.x,g[A++]=U.y,g[A++]=U.z),o.st&&(C[D++]=S,C[D++]=0,C[D++]=S,C[D++]=1),o.normal||o.tangent||o.bitangent){let W=h.clone(h.ZERO,Yhe),j=h.subtract(U,s.geodeticSurfaceNormal(U,Vk),Vk);if(_+1<d&&(W=h.fromArray(l,V+3,Yhe)),L){let Q=h.subtract(W,U,Met),q=h.subtract(j,U,aq);O=h.normalize(h.cross(q,Q,O),O),L=!1}h.equalsEpsilon(U,W,R.EPSILON10)?L=!0:(S+=w,o.tangent&&(P=h.normalize(h.subtract(W,U,P),P)),o.bitangent&&(M=h.normalize(h.cross(O,P,M),M))),o.normal&&(m[T++]=O.x,m[T++]=O.y,m[T++]=O.z,m[T++]=O.x,m[T++]=O.y,m[T++]=O.z),o.tangent&&(y[v++]=P.x,y[v++]=P.y,y[v++]=P.z,y[v++]=P.x,y[v++]=P.y,y[v++]=P.z),o.bitangent&&(b[E++]=M.x,b[E++]=M.y,b[E++]=M.z,b[E++]=M.x,b[E++]=M.y,b[E++]=M.z)}}let I=new hn;o.position&&(I.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:g})),o.normal&&(I.normal=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:m})),o.tangent&&(I.tangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:y})),o.bitangent&&(I.bitangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:b})),o.st&&(I.st=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:C}));let N=p/3;p-=6*(f+1);let k=Be.createTypedArray(N,p),z=0;for(_=0;_<N-2;_+=2){let V=_,U=_+2,B=h.fromArray(g,V*3,aq),W=h.fromArray(g,U*3,Vk);if(h.equalsEpsilon(B,W,R.EPSILON10))continue;let j=_+1,Q=_+3;k[z++]=j,k[z++]=V,k[z++]=Q,k[z++]=Q,k[z++]=V,k[z++]=U}return new ft({attributes:I,indices:k,primitiveType:Ne.TRIANGLES,boundingSphere:new ae.fromVertices(g)})};var Uk=Kx;var Zhe=new h,$he=new h;function Zx(e){e=x(e,x.EMPTY_OBJECT);let t=e.positions,n=e.maximumHeights,i=e.minimumHeights,o=x(e.granularity,R.RADIANS_PER_DEGREE),r=x(e.ellipsoid,ee.default);this._positions=t,this._minimumHeights=i,this._maximumHeights=n,this._granularity=o,this._ellipsoid=ee.clone(r),this._workerName="createWallOutlineGeometry";let s=1+t.length*h.packedLength+2;u(i)&&(s+=i.length),u(n)&&(s+=n.length),this.packedLength=s+ee.packedLength+1}Zx.pack=function(e,t,n){n=x(n,0);let i,o=e._positions,r=o.length;for(t[n++]=r,i=0;i<r;++i,n+=h.packedLength)h.pack(o[i],t,n);let s=e._minimumHeights;if(r=u(s)?s.length:0,t[n++]=r,u(s))for(i=0;i<r;++i)t[n++]=s[i];let a=e._maximumHeights;if(r=u(a)?a.length:0,t[n++]=r,u(a))for(i=0;i<r;++i)t[n++]=a[i];return ee.pack(e._ellipsoid,t,n),n+=ee.packedLength,t[n]=e._granularity,t};var Qhe=ee.clone(ee.UNIT_SPHERE),B1={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:Qhe,granularity:void 0};Zx.unpack=function(e,t,n){t=x(t,0);let i,o=e[t++],r=new Array(o);for(i=0;i<o;++i,t+=h.packedLength)r[i]=h.unpack(e,t);o=e[t++];let s;if(o>0)for(s=new Array(o),i=0;i<o;++i)s[i]=e[t++];o=e[t++];let a;if(o>0)for(a=new Array(o),i=0;i<o;++i)a[i]=e[t++];let c=ee.unpack(e,t,Qhe);t+=ee.packedLength;let l=e[t];return u(n)?(n._positions=r,n._minimumHeights=s,n._maximumHeights=a,n._ellipsoid=ee.clone(c,n._ellipsoid),n._granularity=l,n):(B1.positions=r,B1.minimumHeights=s,B1.maximumHeights=a,B1.granularity=l,new Zx(B1))};Zx.fromConstantHeights=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.positions,n,i,o=e.minimumHeight,r=e.maximumHeight,s=u(o),a=u(r);if(s||a){let l=t.length;n=s?new Array(l):void 0,i=a?new Array(l):void 0;for(let f=0;f<l;++f)s&&(n[f]=o),a&&(i[f]=r)}let c={positions:t,maximumHeights:i,minimumHeights:n,ellipsoid:e.ellipsoid};return new Zx(c)};Zx.createGeometry=function(e){let t=e._positions,n=e._minimumHeights,i=e._maximumHeights,o=e._granularity,r=e._ellipsoid,s=XT.computePositions(r,t,i,n,o,!1);if(!u(s))return;let a=s.bottomPositions,c=s.topPositions,l=c.length,f=l*2,d=new Float64Array(f),p=0;l/=3;let g;for(g=0;g<l;++g){let A=g*3,T=h.fromArray(c,A,Zhe),E=h.fromArray(a,A,$he);d[p++]=E.x,d[p++]=E.y,d[p++]=E.z,d[p++]=T.x,d[p++]=T.y,d[p++]=T.z}let m=new hn({position:new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:d})}),y=f/3;f=2*y-4+y;let b=Be.createTypedArray(y,f),C=0;for(g=0;g<y-2;g+=2){let A=g,T=g+2,E=h.fromArray(d,A*3,Zhe),v=h.fromArray(d,T*3,$he);if(h.equalsEpsilon(E,v,R.EPSILON10))continue;let D=g+1,O=g+3;b[C++]=D,b[C++]=A,b[C++]=D,b[C++]=O,b[C++]=A,b[C++]=T}return b[C++]=y-2,b[C++]=y-1,new ft({attributes:m,indices:b,primitiveType:Ne.LINES,boundingSphere:new ae.fromVertices(d)})};var zk=Zx;var Jhe=new G;function Bet(e){this.id=e,this.vertexFormat=void 0,this.positions=void 0,this.minimumHeights=void 0,this.maximumHeights=void 0,this.granularity=void 0}function Ud(e,t){ri.call(this,{entity:e,scene:t,geometryOptions:new Bet(e),geometryPropertyName:"wall",observedPropertyNames:["availability","wall"]}),this._onEntityPropertyChanged(e,"wall",e.wall,void 0)}u(Object.create)&&(Ud.prototype=Object.create(ri.prototype),Ud.prototype.constructor=Ud);Ud.prototype.createFillGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i,o,r=new yn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),s=this._distanceDisplayConditionProperty.getValue(e),a=kn.fromDistanceDisplayCondition(s);if(this._materialProperty instanceof Ht){let c;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(c=this._materialProperty.color.getValue(e,Jhe)),u(c)||(c=G.WHITE),o=jt.fromColor(c),i={show:r,distanceDisplayCondition:a,color:o}}else i={show:r,distanceDisplayCondition:a};return new vt({id:t,geometry:new Uk(this._options),attributes:i})};Ud.prototype.createOutlineGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i=Y.getValueOrDefault(this._outlineColorProperty,e,G.BLACK,Jhe),o=this._distanceDisplayConditionProperty.getValue(e);return new vt({id:t,geometry:new zk(this._options),attributes:{show:new yn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:jt.fromColor(i),distanceDisplayCondition:kn.fromDistanceDisplayCondition(o)}})};Ud.prototype._isHidden=function(e,t){return!u(t.positions)||ri.prototype._isHidden.call(this,e,t)};Ud.prototype._getIsClosed=function(e){return!1};Ud.prototype._isDynamic=function(e,t){return!t.positions.isConstant||!Y.isConstant(t.minimumHeights)||!Y.isConstant(t.maximumHeights)||!Y.isConstant(t.outlineWidth)||!Y.isConstant(t.granularity)};Ud.prototype._setStaticOptions=function(e,t){let n=t.minimumHeights,i=t.maximumHeights,o=t.granularity,r=this._materialProperty instanceof Ht,s=this._options;s.vertexFormat=r?ln.VERTEX_FORMAT:ho.MaterialSupport.TEXTURED.vertexFormat,s.positions=t.positions.getValue(He.MINIMUM_VALUE,s.positions),s.minimumHeights=u(n)?n.getValue(He.MINIMUM_VALUE,s.minimumHeights):void 0,s.maximumHeights=u(i)?i.getValue(He.MINIMUM_VALUE,s.maximumHeights):void 0,s.granularity=u(o)?o.getValue(He.MINIMUM_VALUE):void 0};Ud.DynamicGeometryUpdater=KT;function KT(e,t,n){oi.call(this,e,t,n)}u(Object.create)&&(KT.prototype=Object.create(oi.prototype),KT.prototype.constructor=KT);KT.prototype._isHidden=function(e,t,n){return!u(this._options.positions)||oi.prototype._isHidden.call(this,e,t,n)};KT.prototype._setOptions=function(e,t,n){let i=this._options;i.positions=Y.getValueOrUndefined(t.positions,n,i.positions),i.minimumHeights=Y.getValueOrUndefined(t.minimumHeights,n,i.minimumHeights),i.maximumHeights=Y.getValueOrUndefined(t.maximumHeights,n,i.maximumHeights),i.granularity=Y.getValueOrUndefined(t.granularity,n)};var Hk=Ud;var $x=[zL,tk,Y3,Tk,Ek,Pk,Lk,Bk,kk,Hk];function Qx(e,t){this.entity=e,this.scene=t;let n=new Array($x.length),i=new me,o=new Ar;for(let r=0;r<n.length;r++){let s=new $x[r](e,t);o.add(s.geometryChanged,a=>{i.raiseEvent(a)}),n[r]=s}this.updaters=n,this.geometryChanged=i,this.eventHelper=o,this._removeEntitySubscription=e.definitionChanged.addEventListener(Qx.prototype._onEntityPropertyChanged,this)}Qx.prototype._onEntityPropertyChanged=function(e,t,n,i){let o=this.updaters;for(let r=0;r<o.length;r++)o[r]._onEntityPropertyChanged(e,t,n,i)};Qx.prototype.forEach=function(e){let t=this.updaters;for(let n=0;n<t.length;n++)e(t[n])};Qx.prototype.destroy=function(){this.eventHelper.removeAll();let e=this.updaters;for(let t=0;t<e.length;t++)e[t].destroy();this._removeEntitySubscription(),ue(this)};Qx.registerUpdater=function(e){$x.includes(e)||$x.push(e)};Qx.unregisterUpdater=function(e){if($x.includes(e)){let t=$x.indexOf(e);$x.splice(t,1)}};var ZT=Qx;var eme=new G,ket=new Nt,Vet=new Nt,Uet=h.ZERO,zet=new h;function zd(e,t,n,i,o,r,s){this.translucent=t,this.appearanceType=n,this.depthFailAppearanceType=i,this.depthFailMaterialProperty=o,this.depthFailMaterial=void 0,this.closed=r,this.shadows=s,this.primitives=e,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new St,this.updaters=new St,this.updatersWithAttributes=new St,this.attributes=new St,this.subscriptions=new St,this.showsUpdated=new St,this.itemsToRemove=[],this.invalidated=!1;let a;u(o)&&(a=o.definitionChanged.addEventListener(zd.prototype.onMaterialChanged,this)),this.removeMaterialSubscription=a}zd.prototype.onMaterialChanged=function(){this.invalidated=!0};zd.prototype.isMaterial=function(e){let t=this.depthFailMaterialProperty,n=e.depthFailMaterialProperty;return n===t?!0:u(t)?t.equals(n):!1};zd.prototype.add=function(e,t){let n=e.id;if(this.createPrimitive=!0,this.geometry.set(n,t),this.updaters.set(n,e),!e.hasConstantFill||!e.fillMaterialProperty.isConstant||!Y.isConstant(e.distanceDisplayConditionProperty)||!Y.isConstant(e.terrainOffsetProperty))this.updatersWithAttributes.set(n,e);else{let i=this;this.subscriptions.set(n,e.entity.definitionChanged.addEventListener(function(o,r,s,a){r==="isShowing"&&i.showsUpdated.set(e.id,e)}))}};zd.prototype.remove=function(e){let t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);let n=this.subscriptions.get(t);return u(n)&&(n(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1};zd.prototype.update=function(e){let t=!0,n=0,i=this.primitive,o=this.primitives,r;if(this.createPrimitive){let s=this.geometry.values;if(s.length>0){u(i)&&(u(this.oldPrimitive)?o.remove(i):this.oldPrimitive=i);let c;u(this.depthFailAppearanceType)&&(u(this.depthFailMaterialProperty)&&(this.depthFailMaterial=sr.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial)),c=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:this.translucent,closed:this.closed})),i=new In({show:!1,asynchronous:!0,geometryInstances:s.slice(),appearance:new this.appearanceType({translucent:this.translucent,closed:this.closed}),depthFailAppearance:c,shadows:this.shadows}),o.add(i),t=!1}else{u(i)&&(o.remove(i),i=void 0);let c=this.oldPrimitive;u(c)&&(o.remove(c),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=i,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(u(i)&&i.ready){i.show=!0,u(this.oldPrimitive)&&(o.remove(this.oldPrimitive),this.oldPrimitive=void 0),u(this.depthFailAppearanceType)&&!(this.depthFailMaterialProperty instanceof Ht)&&(this.depthFailMaterial=sr.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),this.primitive.depthFailAppearance.material=this.depthFailMaterial);let s=this.updatersWithAttributes.values,a=s.length,c=this.waitingOnCreate;for(r=0;r<a;r++){let l=s[r],f=this.geometry.get(l.id),d=this.attributes.get(f.id.id);if(u(d)||(d=i.getGeometryInstanceAttributes(f.id),this.attributes.set(f.id.id,d)),!l.fillMaterialProperty.isConstant||c){let b=l.fillMaterialProperty.color,C=Y.getValueOrDefault(b,e,G.WHITE,eme);G.equals(d._lastColor,C)||(d._lastColor=G.clone(C,d._lastColor),d.color=jt.toValue(C,d.color),(this.translucent&&d.color[3]===255||!this.translucent&&d.color[3]!==255)&&(this.itemsToRemove[n++]=l))}if(u(this.depthFailAppearanceType)&&l.depthFailMaterialProperty instanceof Ht&&(!l.depthFailMaterialProperty.isConstant||c)){let b=l.depthFailMaterialProperty.color,C=Y.getValueOrDefault(b,e,G.WHITE,eme);G.equals(d._lastDepthFailColor,C)||(d._lastDepthFailColor=G.clone(C,d._lastDepthFailColor),d.depthFailColor=jt.toValue(C,d.depthFailColor))}let p=l.entity.isShowing&&(l.hasConstantFill||l.isFilled(e)),g=d.show[0]===1;p!==g&&(d.show=yn.toValue(p,d.show));let m=l.distanceDisplayConditionProperty;if(!Y.isConstant(m)){let b=Y.getValueOrDefault(m,e,Vet,ket);Nt.equals(b,d._lastDistanceDisplayCondition)||(d._lastDistanceDisplayCondition=Nt.clone(b,d._lastDistanceDisplayCondition),d.distanceDisplayCondition=kn.toValue(b,d.distanceDisplayCondition))}let y=l.terrainOffsetProperty;if(!Y.isConstant(y)){let b=Y.getValueOrDefault(y,e,Uet,zet);h.equals(b,d._lastOffset)||(d._lastOffset=h.clone(b,d._lastOffset),d.offset=to.toValue(b,d.offset))}}this.updateShows(i),this.waitingOnCreate=!1}else u(i)&&!i.ready&&(t=!1);return this.itemsToRemove.length=n,t};zd.prototype.updateShows=function(e){let t=this.showsUpdated.values,n=t.length;for(let i=0;i<n;i++){let o=t[i],r=this.geometry.get(o.id),s=this.attributes.get(r.id.id);u(s)||(s=e.getGeometryInstanceAttributes(r.id),this.attributes.set(r.id.id,s));let a=o.entity.isShowing,c=s.show[0]===1;a!==c&&(s.show=yn.toValue(a,s.show),r.attributes.show.value[0]=s.show[0])}this.showsUpdated.removeAll()};zd.prototype.contains=function(e){return this.updaters.contains(e.id)};zd.prototype.getBoundingSphere=function(e,t){let n=this.primitive;if(!n.ready)return dt.PENDING;let i=n.getGeometryInstanceAttributes(e.entity);return!u(i)||!u(i.boundingSphere)||u(i.show)&&i.show[0]===0?dt.FAILED:(i.boundingSphere.clone(t),dt.DONE)};zd.prototype.destroy=function(){let e=this.primitive,t=this.primitives;u(e)&&t.remove(e);let n=this.oldPrimitive;u(n)&&t.remove(n),u(this.removeMaterialSubscription)&&this.removeMaterialSubscription()};function $T(e,t,n,i,o){this._solidItems=[],this._translucentItems=[],this._primitives=e,this._appearanceType=t,this._depthFailAppearanceType=n,this._closed=i,this._shadows=o}$T.prototype.add=function(e,t){let n,i,o=t.createFillGeometryInstance(e);o.attributes.color.value[3]===255?(n=this._solidItems,i=!1):(n=this._translucentItems,i=!0);let r=n.length;for(let a=0;a<r;a++){let c=n[a];if(c.isMaterial(t)){c.add(t,o);return}}let s=new zd(this._primitives,i,this._appearanceType,this._depthFailAppearanceType,t.depthFailMaterialProperty,this._closed,this._shadows);s.add(t,o),n.push(s)};function tme(e,t){let n=e.length;for(let i=n-1;i>=0;i--){let o=e[i];if(o.remove(t))return o.updaters.length===0&&(e.splice(i,1),o.destroy()),!0}return!1}$T.prototype.remove=function(e){tme(this._solidItems,e)||tme(this._translucentItems,e)};function nme(e,t,n){let i=!1,o=t.length;for(let r=0;r<o;++r){let s=t[r],a=s.itemsToRemove,c=a.length;if(c>0)for(r=0;r<c;r++){let l=a[r];s.remove(l),e.add(n,l),i=!0}}return i}function Gk(e,t,n,i){let o=t.length,r;for(r=o-1;r>=0;r--){let s=t[r];if(s.invalidated){t.splice(r,1);let a=s.updaters.values,c=a.length;for(let l=0;l<c;l++)e.add(n,a[l]);s.destroy()}}for(o=t.length,r=0;r<o;++r)i=t[r].update(n)&&i;return i}$T.prototype.update=function(e){let t=Gk(this,this._solidItems,e,!0);t=Gk(this,this._translucentItems,e,t)&&t;let n=nme(this,this._solidItems,e),i=nme(this,this._translucentItems,e);return(n||i)&&(t=Gk(this,this._solidItems,e,t)&&t,t=Gk(this,this._translucentItems,e,t)&&t),t};function ime(e,t,n){let i=e.length;for(let o=0;o<i;o++){let r=e[o];if(r.contains(t))return r.getBoundingSphere(t,n)}return dt.FAILED}$T.prototype.getBoundingSphere=function(e,t){let n=ime(this._solidItems,e,t);return n===dt.FAILED?ime(this._translucentItems,e,t):n};function ome(e){let t=e.length;for(let n=0;n<t;n++)e[n].destroy();e.length=0}$T.prototype.removeAllPrimitives=function(){ome(this._solidItems),ome(this._translucentItems)};var Hd=$T;var Het=new Nt,Get=new Nt,Wet=h.ZERO,jet=new h;function Gd(e,t,n,i,o,r,s){this.primitives=e,this.appearanceType=t,this.materialProperty=n,this.depthFailAppearanceType=i,this.depthFailMaterialProperty=o,this.closed=r,this.shadows=s,this.updaters=new St,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new St,this.material=void 0,this.depthFailMaterial=void 0,this.updatersWithAttributes=new St,this.attributes=new St,this.invalidated=!1,this.removeMaterialSubscription=n.definitionChanged.addEventListener(Gd.prototype.onMaterialChanged,this),this.subscriptions=new St,this.showsUpdated=new St}Gd.prototype.onMaterialChanged=function(){this.invalidated=!0};Gd.prototype.isMaterial=function(e){let t=this.materialProperty,n=e.fillMaterialProperty,i=this.depthFailMaterialProperty,o=e.depthFailMaterialProperty;if(n===t&&o===i)return!0;let r=u(t)&&t.equals(n);return r=(!u(i)&&!u(o)||u(i)&&i.equals(o))&&r,r};Gd.prototype.add=function(e,t){let n=t.id;if(this.updaters.set(n,t),this.geometry.set(n,t.createFillGeometryInstance(e)),!t.hasConstantFill||!t.fillMaterialProperty.isConstant||!Y.isConstant(t.distanceDisplayConditionProperty)||!Y.isConstant(t.terrainOffsetProperty))this.updatersWithAttributes.set(n,t);else{let i=this;this.subscriptions.set(n,t.entity.definitionChanged.addEventListener(function(o,r,s,a){r==="isShowing"&&i.showsUpdated.set(t.id,t)}))}this.createPrimitive=!0};Gd.prototype.remove=function(e){let t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);let n=this.subscriptions.get(t);return u(n)&&(n(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1};var qet=new G;Gd.prototype.update=function(e){let t=!0,n=this.primitive,i=this.primitives,o=this.geometry.values,r;if(this.createPrimitive){if(o.length>0){u(n)&&(u(this.oldPrimitive)?i.remove(n):this.oldPrimitive=n),this.material=sr.getValue(e,this.materialProperty,this.material);let a;u(this.depthFailMaterialProperty)&&(this.depthFailMaterial=sr.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),a=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:this.depthFailMaterial.isTranslucent(),closed:this.closed})),n=new In({show:!1,asynchronous:!0,geometryInstances:o.slice(),appearance:new this.appearanceType({material:this.material,translucent:this.material.isTranslucent(),closed:this.closed}),depthFailAppearance:a,shadows:this.shadows}),i.add(n),t=!1}else{u(n)&&(i.remove(n),n=void 0);let a=this.oldPrimitive;u(a)&&(i.remove(a),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=n,this.createPrimitive=!1}else if(u(n)&&n.ready){n.show=!0,u(this.oldPrimitive)&&(i.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.material=sr.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material,u(this.depthFailAppearanceType)&&!(this.depthFailMaterialProperty instanceof Ht)&&(this.depthFailMaterial=sr.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),this.primitive.depthFailAppearance.material=this.depthFailMaterial);let s=this.updatersWithAttributes.values,a=s.length;for(r=0;r<a;r++){let c=s[r],l=c.entity,f=this.geometry.get(c.id),d=this.attributes.get(f.id.id);if(u(d)||(d=n.getGeometryInstanceAttributes(f.id),this.attributes.set(f.id.id,d)),u(this.depthFailAppearanceType)&&this.depthFailMaterialProperty instanceof Ht&&!c.depthFailMaterialProperty.isConstant){let b=c.depthFailMaterialProperty.color,C=Y.getValueOrDefault(b,e,G.WHITE,qet);G.equals(d._lastDepthFailColor,C)||(d._lastDepthFailColor=G.clone(C,d._lastDepthFailColor),d.depthFailColor=jt.toValue(C,d.depthFailColor))}let p=l.isShowing&&(c.hasConstantFill||c.isFilled(e)),g=d.show[0]===1;p!==g&&(d.show=yn.toValue(p,d.show));let m=c.distanceDisplayConditionProperty;if(!Y.isConstant(m)){let b=Y.getValueOrDefault(m,e,Get,Het);Nt.equals(b,d._lastDistanceDisplayCondition)||(d._lastDistanceDisplayCondition=Nt.clone(b,d._lastDistanceDisplayCondition),d.distanceDisplayCondition=kn.toValue(b,d.distanceDisplayCondition))}let y=c.terrainOffsetProperty;if(!Y.isConstant(y)){let b=Y.getValueOrDefault(y,e,Wet,jet);h.equals(b,d._lastOffset)||(d._lastOffset=h.clone(b,d._lastOffset),d.offset=to.toValue(b,d.offset))}}this.updateShows(n)}else u(n)&&!n.ready&&(t=!1);return t};Gd.prototype.updateShows=function(e){let t=this.showsUpdated.values,n=t.length;for(let i=0;i<n;i++){let o=t[i],r=o.entity,s=this.geometry.get(o.id),a=this.attributes.get(s.id.id);u(a)||(a=e.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,a));let c=r.isShowing,l=a.show[0]===1;c!==l&&(a.show=yn.toValue(c,a.show),s.attributes.show.value[0]=a.show[0])}this.showsUpdated.removeAll()};Gd.prototype.contains=function(e){return this.updaters.contains(e.id)};Gd.prototype.getBoundingSphere=function(e,t){let n=this.primitive;if(!n.ready)return dt.PENDING;let i=n.getGeometryInstanceAttributes(e.entity);return!u(i)||!u(i.boundingSphere)||u(i.show)&&i.show[0]===0?dt.FAILED:(i.boundingSphere.clone(t),dt.DONE)};Gd.prototype.destroy=function(){let e=this.primitive,t=this.primitives;u(e)&&t.remove(e);let n=this.oldPrimitive;u(n)&&t.remove(n),this.removeMaterialSubscription()};function QT(e,t,n,i,o){this._items=[],this._primitives=e,this._appearanceType=t,this._depthFailAppearanceType=n,this._closed=i,this._shadows=o}QT.prototype.add=function(e,t){let n=this._items,i=n.length;for(let r=0;r<i;r++){let s=n[r];if(s.isMaterial(t)){s.add(e,t);return}}let o=new Gd(this._primitives,this._appearanceType,t.fillMaterialProperty,this._depthFailAppearanceType,t.depthFailMaterialProperty,this._closed,this._shadows);o.add(e,t),n.push(o)};QT.prototype.remove=function(e){let t=this._items,n=t.length;for(let i=n-1;i>=0;i--){let o=t[i];if(o.remove(e)){o.updaters.length===0&&(t.splice(i,1),o.destroy());break}}};QT.prototype.update=function(e){let t,n=this._items,i=n.length;for(t=i-1;t>=0;t--){let r=n[t];if(r.invalidated){n.splice(t,1);let s=r.updaters.values,a=s.length;for(let c=0;c<a;c++)this.add(e,s[c]);r.destroy()}}let o=!0;for(t=0;t<n.length;t++)o=n[t].update(e)&&o;return o};QT.prototype.getBoundingSphere=function(e,t){let n=this._items,i=n.length;for(let o=0;o<i;o++){let r=n[o];if(r.contains(e))return r.getBoundingSphere(e,t)}return dt.FAILED};QT.prototype.removeAllPrimitives=function(){let e=this._items,t=e.length;for(let n=0;n<t;n++)e[n].destroy();this._items.length=0};var Wd=QT;var sme=Dr(rme(),1);function Wk(){this._tree=new sme.default}function Jx(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.id=""}Jx.fromRectangleAndId=function(e,t,n){return n.minX=t.west,n.minY=t.south,n.maxX=t.east,n.maxY=t.north,n.id=e,n};Wk.prototype.insert=function(e,t){let n=Jx.fromRectangleAndId(e,t,new Jx);this._tree.insert(n)};function Yet(e,t){return e.id===t.id}var Xet=new Jx;Wk.prototype.remove=function(e,t){let n=Jx.fromRectangleAndId(e,t,Xet);this._tree.remove(n,Yet)};var Ket=new Jx;Wk.prototype.collides=function(e){let t=Jx.fromRectangleAndId("",e,Ket);return this._tree.collides(t)};var JT=Wk;var Zet=new G,$et=new Nt,Qet=new Nt;function n_(e,t,n,i){this.primitives=e,this.zIndex=i,this.classificationType=t,this.color=n,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new St,this.updaters=new St,this.updatersWithAttributes=new St,this.attributes=new St,this.subscriptions=new St,this.showsUpdated=new St,this.itemsToRemove=[],this.isDirty=!1,this.rectangleCollisionCheck=new JT}n_.prototype.overlapping=function(e){return this.rectangleCollisionCheck.collides(e)};n_.prototype.add=function(e,t){let n=e.id;if(this.createPrimitive=!0,this.geometry.set(n,t),this.updaters.set(n,e),this.rectangleCollisionCheck.insert(n,t.geometry.rectangle),!e.hasConstantFill||!e.fillMaterialProperty.isConstant||!Y.isConstant(e.distanceDisplayConditionProperty))this.updatersWithAttributes.set(n,e);else{let i=this;this.subscriptions.set(n,e.entity.definitionChanged.addEventListener(function(o,r,s,a){r==="isShowing"&&i.showsUpdated.set(e.id,e)}))}};n_.prototype.remove=function(e){let t=e.id,n=this.geometry.get(t);if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.rectangleCollisionCheck.remove(t,n.geometry.rectangle),this.updatersWithAttributes.remove(t);let i=this.subscriptions.get(t);return u(i)&&(i(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1};n_.prototype.update=function(e){let t=!0,n=0,i=this.primitive,o=this.primitives,r;if(this.createPrimitive){let s=this.geometry.values;if(s.length>0)u(i)&&(u(this.oldPrimitive)?o.remove(i):this.oldPrimitive=i),i=new _l({show:!1,asynchronous:!0,geometryInstances:s.slice(),classificationType:this.classificationType}),o.add(i,this.zIndex),t=!1;else{u(i)&&(o.remove(i),i=void 0);let c=this.oldPrimitive;u(c)&&(o.remove(c),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=i,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(u(i)&&i.ready){i.show=!0,u(this.oldPrimitive)&&(o.remove(this.oldPrimitive),this.oldPrimitive=void 0);let s=this.updatersWithAttributes.values,a=s.length,c=this.waitingOnCreate;for(r=0;r<a;r++){let l=s[r],f=this.geometry.get(l.id),d=this.attributes.get(f.id.id);if(u(d)||(d=i.getGeometryInstanceAttributes(f.id),this.attributes.set(f.id.id,d)),!l.fillMaterialProperty.isConstant||c){let y=l.fillMaterialProperty.color,b=Y.getValueOrDefault(y,e,G.WHITE,Zet);G.equals(d._lastColor,b)||(d._lastColor=G.clone(b,d._lastColor),d.color=jt.toValue(b,d.color))}let p=l.entity.isShowing&&(l.hasConstantFill||l.isFilled(e)),g=d.show[0]===1;p!==g&&(d.show=yn.toValue(p,d.show));let m=l.distanceDisplayConditionProperty;if(!Y.isConstant(m)){let y=Y.getValueOrDefault(m,e,Qet,$et);Nt.equals(y,d._lastDistanceDisplayCondition)||(d._lastDistanceDisplayCondition=Nt.clone(y,d._lastDistanceDisplayCondition),d.distanceDisplayCondition=kn.toValue(y,d.distanceDisplayCondition))}}this.updateShows(i),this.waitingOnCreate=!1}else u(i)&&!i.ready&&(t=!1);return this.itemsToRemove.length=n,t};n_.prototype.updateShows=function(e){let t=this.showsUpdated.values,n=t.length;for(let i=0;i<n;i++){let o=t[i],r=this.geometry.get(o.id),s=this.attributes.get(r.id.id);u(s)||(s=e.getGeometryInstanceAttributes(r.id),this.attributes.set(r.id.id,s));let a=o.entity.isShowing,c=s.show[0]===1;a!==c&&(s.show=yn.toValue(a,s.show),r.attributes.show.value[0]=s.show[0])}this.showsUpdated.removeAll()};n_.prototype.contains=function(e){return this.updaters.contains(e.id)};n_.prototype.getBoundingSphere=function(e,t){let n=this.primitive;if(!n.ready)return dt.PENDING;let i=n.getBoundingSphere(e.entity);return u(i)?(i.clone(t),dt.DONE):dt.FAILED};n_.prototype.removeAllPrimitives=function(){let e=this.primitives,t=this.primitive;u(t)&&(e.remove(t),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());let n=this.oldPrimitive;u(n)&&(e.remove(n),this.oldPrimitive=void 0)};function eE(e,t){this._batches=[],this._primitives=e,this._classificationType=t}eE.prototype.add=function(e,t){let n=t.createFillGeometryInstance(e),i=this._batches,o=Y.getValueOrDefault(t.zIndex,0),r,s=i.length;for(let a=0;a<s;++a){let c=i[a];if(c.zIndex===o&&!c.overlapping(n.geometry.rectangle)){r=c;break}}return u(r)||(r=new n_(this._primitives,this._classificationType,n.attributes.color.value,o),i.push(r)),r.add(t,n),r};eE.prototype.remove=function(e){let t=this._batches,n=t.length;for(let i=0;i<n;++i)if(t[i].remove(e))return};eE.prototype.update=function(e){let t,n,i=!0,o=this._batches,r=o.length;for(t=0;t<r;++t)i=o[t].update(e)&&i;for(t=0;t<r;++t){let s=o[t],a=s.itemsToRemove,c=a.length;for(let l=0;l<c;l++){n=a[l],s.remove(n);let f=this.add(e,n);s.isDirty=!0,f.isDirty=!0}}for(t=r-1;t>=0;--t){let s=o[t];s.isDirty&&(i=o[t].update(e)&&i,s.isDirty=!1),s.geometry.length===0&&o.splice(t,1)}return i};eE.prototype.getBoundingSphere=function(e,t){let n=this._batches,i=n.length;for(let o=0;o<i;++o){let r=n[o];if(r.contains(e))return r.getBoundingSphere(e,t)}return dt.FAILED};eE.prototype.removeAllPrimitives=function(){let e=this._batches,t=e.length;for(let n=0;n<t;++n)e[n].removeAllPrimitives()};var k1=eE;var Jet=new Nt,ett=new Nt;function Vf(e,t,n,i,o,r){this.primitives=e,this.classificationType=t,this.appearanceType=n,this.materialProperty=i,this.updaters=new St,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new St,this.material=void 0,this.updatersWithAttributes=new St,this.attributes=new St,this.invalidated=!1,this.removeMaterialSubscription=i.definitionChanged.addEventListener(Vf.prototype.onMaterialChanged,this),this.subscriptions=new St,this.showsUpdated=new St,this.usingSphericalTextureCoordinates=o,this.zIndex=r,this.rectangleCollisionCheck=new JT}Vf.prototype.onMaterialChanged=function(){this.invalidated=!0};Vf.prototype.overlapping=function(e){return this.rectangleCollisionCheck.collides(e)};Vf.prototype.isMaterial=function(e){let t=this.materialProperty,n=e.fillMaterialProperty;return n===t||n instanceof Ht&&t instanceof Ht?!0:u(t)&&t.equals(n)};Vf.prototype.add=function(e,t,n){let i=t.id;if(this.updaters.set(i,t),this.geometry.set(i,n),this.rectangleCollisionCheck.insert(i,n.geometry.rectangle),!t.hasConstantFill||!t.fillMaterialProperty.isConstant||!Y.isConstant(t.distanceDisplayConditionProperty))this.updatersWithAttributes.set(i,t);else{let o=this;this.subscriptions.set(i,t.entity.definitionChanged.addEventListener(function(r,s,a,c){s==="isShowing"&&o.showsUpdated.set(t.id,t)}))}this.createPrimitive=!0};Vf.prototype.remove=function(e){let t=e.id,n=this.geometry.get(t);if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.rectangleCollisionCheck.remove(t,n.geometry.rectangle),this.updatersWithAttributes.remove(t);let i=this.subscriptions.get(t);return u(i)&&(i(),this.subscriptions.remove(t)),!0}return!1};Vf.prototype.update=function(e){let t=!0,n=this.primitive,i=this.primitives,o=this.geometry.values,r;if(this.createPrimitive){if(o.length>0)u(n)&&(u(this.oldPrimitive)?i.remove(n):this.oldPrimitive=n),this.material=sr.getValue(e,this.materialProperty,this.material),n=new _l({show:!1,asynchronous:!0,geometryInstances:o.slice(),appearance:new this.appearanceType({material:this.material}),classificationType:this.classificationType}),i.add(n,this.zIndex),t=!1;else{u(n)&&(i.remove(n),n=void 0);let a=this.oldPrimitive;u(a)&&(i.remove(a),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=n,this.createPrimitive=!1}else if(u(n)&&n.ready){n.show=!0,u(this.oldPrimitive)&&(i.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.material=sr.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material;let s=this.updatersWithAttributes.values,a=s.length;for(r=0;r<a;r++){let c=s[r],l=c.entity,f=this.geometry.get(c.id),d=this.attributes.get(f.id.id);u(d)||(d=n.getGeometryInstanceAttributes(f.id),this.attributes.set(f.id.id,d));let p=l.isShowing&&(c.hasConstantFill||c.isFilled(e)),g=d.show[0]===1;p!==g&&(d.show=yn.toValue(p,d.show));let m=c.distanceDisplayConditionProperty;if(!Y.isConstant(m)){let y=Y.getValueOrDefault(m,e,ett,Jet);Nt.equals(y,d._lastDistanceDisplayCondition)||(d._lastDistanceDisplayCondition=Nt.clone(y,d._lastDistanceDisplayCondition),d.distanceDisplayCondition=kn.toValue(y,d.distanceDisplayCondition))}}this.updateShows(n)}else u(n)&&!n.ready&&(t=!1);return t};Vf.prototype.updateShows=function(e){let t=this.showsUpdated.values,n=t.length;for(let i=0;i<n;i++){let o=t[i],r=o.entity,s=this.geometry.get(o.id),a=this.attributes.get(s.id.id);u(a)||(a=e.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,a));let c=r.isShowing,l=a.show[0]===1;c!==l&&(a.show=yn.toValue(c,a.show),s.attributes.show.value[0]=a.show[0])}this.showsUpdated.removeAll()};Vf.prototype.contains=function(e){return this.updaters.contains(e.id)};Vf.prototype.getBoundingSphere=function(e,t){let n=this.primitive;if(!n.ready)return dt.PENDING;let i=n.getGeometryInstanceAttributes(e.entity);return!u(i)||!u(i.boundingSphere)||u(i.show)&&i.show[0]===0?dt.FAILED:(i.boundingSphere.clone(t),dt.DONE)};Vf.prototype.destroy=function(){let e=this.primitive,t=this.primitives;u(e)&&t.remove(e);let n=this.oldPrimitive;u(n)&&t.remove(n),this.removeMaterialSubscription()};function tE(e,t,n){this._items=[],this._primitives=e,this._classificationType=t,this._appearanceType=n}tE.prototype.add=function(e,t){let n=this._items,i=n.length,o=t.createFillGeometryInstance(e),r=of.shouldUseSphericalCoordinates(o.geometry.rectangle),s=Y.getValueOrDefault(t.zIndex,0);for(let c=0;c<i;++c){let l=n[c];if(l.isMaterial(t)&&l.usingSphericalTextureCoordinates===r&&l.zIndex===s&&!l.overlapping(o.geometry.rectangle)){l.add(e,t,o);return}}let a=new Vf(this._primitives,this._classificationType,this._appearanceType,t.fillMaterialProperty,r,s);a.add(e,t,o),n.push(a)};tE.prototype.remove=function(e){let t=this._items,n=t.length;for(let i=n-1;i>=0;i--){let o=t[i];if(o.remove(e)){o.updaters.length===0&&(t.splice(i,1),o.destroy());break}}};tE.prototype.update=function(e){let t,n=this._items,i=n.length;for(t=i-1;t>=0;t--){let r=n[t];if(r.invalidated){n.splice(t,1);let s=r.updaters.values,a=s.length;for(let c=0;c<a;c++)this.add(e,s[c]);r.destroy()}}let o=!0;for(t=0;t<n.length;t++)o=n[t].update(e)&&o;return o};tE.prototype.getBoundingSphere=function(e,t){let n=this._items,i=n.length;for(let o=0;o<i;o++){let r=n[o];if(r.contains(e))return r.getBoundingSphere(e,t)}return dt.FAILED};tE.prototype.removeAllPrimitives=function(){let e=this._items,t=e.length;for(let n=0;n<t;n++)e[n].destroy();this._items.length=0};var jk=tE;var ttt=new G,ntt=new Nt,itt=new Nt,ott=h.ZERO,rtt=new h;function i_(e,t,n,i){this.translucent=t,this.width=n,this.shadows=i,this.primitives=e,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new St,this.updaters=new St,this.updatersWithAttributes=new St,this.attributes=new St,this.itemsToRemove=[],this.subscriptions=new St,this.showsUpdated=new St}i_.prototype.add=function(e,t){let n=e.id;if(this.createPrimitive=!0,this.geometry.set(n,t),this.updaters.set(n,e),!e.hasConstantOutline||!e.outlineColorProperty.isConstant||!Y.isConstant(e.distanceDisplayConditionProperty)||!Y.isConstant(e.terrainOffsetProperty))this.updatersWithAttributes.set(n,e);else{let i=this;this.subscriptions.set(n,e.entity.definitionChanged.addEventListener(function(o,r,s,a){r==="isShowing"&&i.showsUpdated.set(e.id,e)}))}};i_.prototype.remove=function(e){let t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);let n=this.subscriptions.get(t);return u(n)&&(n(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1};i_.prototype.update=function(e){let t=!0,n=0,i=this.primitive,o=this.primitives,r;if(this.createPrimitive){let s=this.geometry.values;if(s.length>0)u(i)&&(u(this.oldPrimitive)?o.remove(i):this.oldPrimitive=i),i=new In({show:!1,asynchronous:!0,geometryInstances:s.slice(),appearance:new ln({flat:!0,translucent:this.translucent,renderState:{lineWidth:this.width}}),shadows:this.shadows}),o.add(i),t=!1;else{u(i)&&(o.remove(i),i=void 0);let c=this.oldPrimitive;u(c)&&(o.remove(c),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=i,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(u(i)&&i.ready){i.show=!0,u(this.oldPrimitive)&&(o.remove(this.oldPrimitive),this.oldPrimitive=void 0);let s=this.updatersWithAttributes.values,a=s.length,c=this.waitingOnCreate;for(r=0;r<a;r++){let l=s[r],f=this.geometry.get(l.id),d=this.attributes.get(f.id.id);if(u(d)||(d=i.getGeometryInstanceAttributes(f.id),this.attributes.set(f.id.id,d)),!l.outlineColorProperty.isConstant||c){let b=l.outlineColorProperty,C=Y.getValueOrDefault(b,e,G.WHITE,ttt);G.equals(d._lastColor,C)||(d._lastColor=G.clone(C,d._lastColor),d.color=jt.toValue(C,d.color),(this.translucent&&d.color[3]===255||!this.translucent&&d.color[3]!==255)&&(this.itemsToRemove[n++]=l))}let p=l.entity.isShowing&&(l.hasConstantOutline||l.isOutlineVisible(e)),g=d.show[0]===1;p!==g&&(d.show=yn.toValue(p,d.show));let m=l.distanceDisplayConditionProperty;if(!Y.isConstant(m)){let b=Y.getValueOrDefault(m,e,itt,ntt);Nt.equals(b,d._lastDistanceDisplayCondition)||(d._lastDistanceDisplayCondition=Nt.clone(b,d._lastDistanceDisplayCondition),d.distanceDisplayCondition=kn.toValue(b,d.distanceDisplayCondition))}let y=l.terrainOffsetProperty;if(!Y.isConstant(y)){let b=Y.getValueOrDefault(y,e,ott,rtt);h.equals(b,d._lastOffset)||(d._lastOffset=h.clone(b,d._lastOffset),d.offset=to.toValue(b,d.offset))}}this.updateShows(i),this.waitingOnCreate=!1}else u(i)&&!i.ready&&(t=!1);return this.itemsToRemove.length=n,t};i_.prototype.updateShows=function(e){let t=this.showsUpdated.values,n=t.length;for(let i=0;i<n;i++){let o=t[i],r=this.geometry.get(o.id),s=this.attributes.get(r.id.id);u(s)||(s=e.getGeometryInstanceAttributes(r.id),this.attributes.set(r.id.id,s));let a=o.entity.isShowing,c=s.show[0]===1;a!==c&&(s.show=yn.toValue(a,s.show),r.attributes.show.value[0]=s.show[0])}this.showsUpdated.removeAll()};i_.prototype.contains=function(e){return this.updaters.contains(e.id)};i_.prototype.getBoundingSphere=function(e,t){let n=this.primitive;if(!n.ready)return dt.PENDING;let i=n.getGeometryInstanceAttributes(e.entity);return!u(i)||!u(i.boundingSphere)||u(i.show)&&i.show[0]===0?dt.FAILED:(i.boundingSphere.clone(t),dt.DONE)};i_.prototype.removeAllPrimitives=function(){let e=this.primitives,t=this.primitive;u(t)&&(e.remove(t),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());let n=this.oldPrimitive;u(n)&&(e.remove(n),this.oldPrimitive=void 0)};function nE(e,t,n){this._primitives=e,this._scene=t,this._shadows=n,this._solidBatches=new St,this._translucentBatches=new St}nE.prototype.add=function(e,t){let n=t.createOutlineGeometryInstance(e),i=this._scene.clampLineWidth(t.outlineWidth),o,r;n.attributes.color.value[3]===255?(o=this._solidBatches,r=o.get(i),u(r)||(r=new i_(this._primitives,!1,i,this._shadows),o.set(i,r)),r.add(t,n)):(o=this._translucentBatches,r=o.get(i),u(r)||(r=new i_(this._primitives,!0,i,this._shadows),o.set(i,r)),r.add(t,n))};nE.prototype.remove=function(e){let t,n=this._solidBatches.values,i=n.length;for(t=0;t<i;t++)if(n[t].remove(e))return;let o=this._translucentBatches.values,r=o.length;for(t=0;t<r;t++)if(o[t].remove(e))return};nE.prototype.update=function(e){let t,n,i,o,r=this._solidBatches.values,s=r.length,a=this._translucentBatches.values,c=a.length,l,f=!0,d=!1;do{for(d=!1,n=0;n<s;n++){o=r[n],f=o.update(e),l=o.itemsToRemove;let p=l.length;if(p>0)for(d=!0,t=0;t<p;t++)i=l[t],o.remove(i),this.add(e,i)}for(n=0;n<c;n++){o=a[n],f=o.update(e),l=o.itemsToRemove;let p=l.length;if(p>0)for(d=!0,t=0;t<p;t++)i=l[t],o.remove(i),this.add(e,i)}}while(d);return f};nE.prototype.getBoundingSphere=function(e,t){let n,i=this._solidBatches.values,o=i.length;for(n=0;n<o;n++){let a=i[n];if(a.contains(e))return a.getBoundingSphere(e,t)}let r=this._translucentBatches.values,s=r.length;for(n=0;n<s;n++){let a=r[n];if(a.contains(e))return a.getBoundingSphere(e,t)}return dt.FAILED};nE.prototype.removeAllPrimitives=function(){let e,t=this._solidBatches.values,n=t.length;for(e=0;e<n;e++)t[e].removeAllPrimitives();let i=this._translucentBatches.values,o=i.length;for(e=0;e<o;e++)i[e].removeAllPrimitives()};var V1=nE;var stt=[];function Dl(e,t,n,i){n=x(n,e.primitives),i=x(i,e.groundPrimitives),this._scene=e,this._primitives=n,this._groundPrimitives=i,this._entityCollection=void 0,this._addedObjects=new St,this._removedObjects=new St,this._changedObjects=new St;let o=xn.NUMBER_OF_SHADOW_MODES;this._outlineBatches=new Array(o*2),this._closedColorBatches=new Array(o*2),this._closedMaterialBatches=new Array(o*2),this._openColorBatches=new Array(o*2),this._openMaterialBatches=new Array(o*2);let r=ar.supportsMaterialsforEntitiesOnTerrain(e);this._supportsMaterialsforEntitiesOnTerrain=r;let s;for(s=0;s<o;++s)this._outlineBatches[s]=new V1(n,e,s,!1),this._outlineBatches[o+s]=new V1(n,e,s,!0),this._closedColorBatches[s]=new Hd(n,ln,void 0,!0,s,!0),this._closedColorBatches[o+s]=new Hd(n,ln,void 0,!0,s,!1),this._closedMaterialBatches[s]=new Wd(n,ho,void 0,!0,s,!0),this._closedMaterialBatches[o+s]=new Wd(n,ho,void 0,!0,s,!1),this._openColorBatches[s]=new Hd(n,ln,void 0,!1,s,!0),this._openColorBatches[o+s]=new Hd(n,ln,void 0,!1,s,!1),this._openMaterialBatches[s]=new Wd(n,ho,void 0,!1,s,!0),this._openMaterialBatches[o+s]=new Wd(n,ho,void 0,!1,s,!1);let a=Vn.NUMBER_OF_CLASSIFICATION_TYPES,c=new Array(a),l=[];if(r)for(s=0;s<a;++s)l.push(new jk(i,s,ho)),c[s]=new k1(i,s);else for(s=0;s<a;++s)c[s]=new k1(i,s);this._groundColorBatches=c,this._groundMaterialBatches=l,this._dynamicBatch=new LT(n,i),this._batches=this._outlineBatches.concat(this._closedColorBatches,this._closedMaterialBatches,this._openColorBatches,this._openMaterialBatches,this._groundColorBatches,this._groundMaterialBatches,this._dynamicBatch),this._subscriptions=new St,this._updaterSets=new St,this._entityCollection=t,t.collectionChanged.addEventListener(Dl.prototype._onCollectionChanged,this),this._onCollectionChanged(t,t.values,stt)}Dl.registerUpdater=function(e){ZT.registerUpdater(e)};Dl.unregisterUpdater=function(e){ZT.unregisterUpdater(e)};Dl.prototype.update=function(e){let t=this._addedObjects,n=t.values,i=this._removedObjects,o=i.values,r=this._changedObjects,s=r.values,a,c,l,f,d=this;for(a=s.length-1;a>-1;a--)c=s[a],l=c.id,f=this._updaterSets.get(l),f.entity===c?f.forEach(function(y){d._removeUpdater(y),d._insertUpdaterIntoBatch(e,y)}):(o.push(c),n.push(c));for(a=o.length-1;a>-1;a--)c=o[a],l=c.id,f=this._updaterSets.get(l),f.forEach(this._removeUpdater.bind(this)),f.destroy(),this._updaterSets.remove(l),this._subscriptions.get(l)(),this._subscriptions.remove(l);for(a=n.length-1;a>-1;a--)c=n[a],l=c.id,f=new ZT(c,this._scene),this._updaterSets.set(l,f),f.forEach(function(y){d._insertUpdaterIntoBatch(e,y)}),this._subscriptions.set(l,f.geometryChanged.addEventListener(Dl._onGeometryChanged,this));t.removeAll(),i.removeAll(),r.removeAll();let p=!0,g=this._batches,m=g.length;for(a=0;a<m;a++)p=g[a].update(e)&&p;return p};var att=[],ctt=new ae;Dl.prototype.getBoundingSphere=function(e,t){let n=att,i=ctt,o=0,r=dt.DONE,s=this._batches,a=s.length,c=e.id,l=this._updaterSets.get(c).updaters;for(let f=0;f<l.length;f++){let d=l[f];for(let p=0;p<a;p++){if(r=s[p].getBoundingSphere(d,i),r===dt.PENDING)return dt.PENDING;r===dt.DONE&&(n[o]=ae.clone(i,n[o]),o++)}}return o===0?dt.FAILED:(n.length=o,ae.fromBoundingSpheres(n,t),dt.DONE)};Dl.prototype.isDestroyed=function(){return!1};Dl.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(Dl.prototype._onCollectionChanged,this),this._addedObjects.removeAll(),this._removedObjects.removeAll();let e,t=this._batches,n=t.length;for(e=0;e<n;e++)t[e].removeAllPrimitives();let i=this._subscriptions.values;for(n=i.length,e=0;e<n;e++)i[e]();this._subscriptions.removeAll();let o=this._updaterSets.values;for(n=o.length,e=0;e<n;e++)o[e].destroy();return this._updaterSets.removeAll(),ue(this)};Dl.prototype._removeUpdater=function(e){let t=this._batches,n=t.length;for(let i=0;i<n;i++)t[i].remove(e)};Dl.prototype._insertUpdaterIntoBatch=function(e,t){if(t.isDynamic){this._dynamicBatch.add(e,t);return}let n;(t.outlineEnabled||t.fillEnabled)&&(n=t.shadowsProperty.getValue(e));let i=xn.NUMBER_OF_SHADOW_MODES;if(t.outlineEnabled&&(u(t.terrainOffsetProperty)?this._outlineBatches[i+n].add(e,t):this._outlineBatches[n].add(e,t)),t.fillEnabled)if(t.onTerrain){let o=t.classificationTypeProperty.getValue(e);t.fillMaterialProperty instanceof Ht?this._groundColorBatches[o].add(e,t):this._groundMaterialBatches[o].add(e,t)}else t.isClosed?t.fillMaterialProperty instanceof Ht?u(t.terrainOffsetProperty)?this._closedColorBatches[i+n].add(e,t):this._closedColorBatches[n].add(e,t):u(t.terrainOffsetProperty)?this._closedMaterialBatches[i+n].add(e,t):this._closedMaterialBatches[n].add(e,t):t.fillMaterialProperty instanceof Ht?u(t.terrainOffsetProperty)?this._openColorBatches[i+n].add(e,t):this._openColorBatches[n].add(e,t):u(t.terrainOffsetProperty)?this._openMaterialBatches[i+n].add(e,t):this._openMaterialBatches[n].add(e,t)};Dl._onGeometryChanged=function(e){let t=this._removedObjects,n=this._changedObjects,i=e.entity,o=i.id;!u(t.get(o))&&!u(n.get(o))&&n.set(o,i)};Dl.prototype._onCollectionChanged=function(e,t,n){let i=this._addedObjects,o=this._removedObjects,r=this._changedObjects,s,a,c;for(s=n.length-1;s>-1;s--)c=n[s],a=c.id,i.remove(a)||(o.set(a,c),r.remove(a));for(s=t.length-1;s>-1;s--)c=t[s],a=c.id,o.remove(a)?r.set(a,c):i.set(a,c)};var qk=Dl;var ltt=1,utt="30px sans-serif",ftt=$o.FILL,dtt=G.WHITE,htt=G.BLACK,mtt=1,ptt=!1,_tt=new G(.165,.165,.165,.8),gtt=new H(7,5),ytt=H.ZERO,xtt=h.ZERO,btt=Xe.NONE,Ctt=bi.CENTER,Att=On.CENTER,Ttt=new h,Ett=new G,Stt=new G,vtt=new G,wtt=new H,Dtt=new h,Itt=new H,Ptt=new kt,Rtt=new kt,Ott=new kt,Mtt=new Nt;function ame(e){this.entity=e,this.label=void 0,this.index=void 0}function p0(e,t){t.collectionChanged.addEventListener(p0.prototype._onCollectionChanged,this),this._cluster=e,this._entityCollection=t,this._items=new St,this._onCollectionChanged(t,t.values,[],[])}p0.prototype.update=function(e){let t=this._items.values,n=this._cluster;for(let i=0,o=t.length;i<o;i++){let r=t[i],s=r.entity,a=s._label,c,l=r.label,f=s.isShowing&&s.isAvailable(e)&&Y.getValueOrDefault(a._show,e,!0),d;if(f&&(d=Y.getValueOrUndefined(s._position,e,Ttt),c=Y.getValueOrUndefined(a._text,e),f=u(d)&&u(c)),!f){uq(r,s,n);continue}Y.isConstant(s._position)||(n._clusterDirty=!0);let p=!1,g=Y.getValueOrDefault(a._heightReference,e,btt);u(l)||(l=n.getLabel(s),l.id=s,r.label=l,p=h.equals(l.position,d)&&l.heightReference===g),l.show=!0,l.position=d,l.text=c,l.scale=Y.getValueOrDefault(a._scale,e,ltt),l.font=Y.getValueOrDefault(a._font,e,utt),l.style=Y.getValueOrDefault(a._style,e,ftt),l.fillColor=Y.getValueOrDefault(a._fillColor,e,dtt,Ett),l.outlineColor=Y.getValueOrDefault(a._outlineColor,e,htt,Stt),l.outlineWidth=Y.getValueOrDefault(a._outlineWidth,e,mtt),l.showBackground=Y.getValueOrDefault(a._showBackground,e,ptt),l.backgroundColor=Y.getValueOrDefault(a._backgroundColor,e,_tt,vtt),l.backgroundPadding=Y.getValueOrDefault(a._backgroundPadding,e,gtt,wtt),l.pixelOffset=Y.getValueOrDefault(a._pixelOffset,e,ytt,Itt),l.eyeOffset=Y.getValueOrDefault(a._eyeOffset,e,xtt,Dtt),l.heightReference=g,l.horizontalOrigin=Y.getValueOrDefault(a._horizontalOrigin,e,Ctt),l.verticalOrigin=Y.getValueOrDefault(a._verticalOrigin,e,Att),l.translucencyByDistance=Y.getValueOrUndefined(a._translucencyByDistance,e,Ptt),l.pixelOffsetScaleByDistance=Y.getValueOrUndefined(a._pixelOffsetScaleByDistance,e,Rtt),l.scaleByDistance=Y.getValueOrUndefined(a._scaleByDistance,e,Ott),l.distanceDisplayCondition=Y.getValueOrUndefined(a._distanceDisplayCondition,e,Mtt),l.disableDepthTestDistance=Y.getValueOrUndefined(a._disableDepthTestDistance,e),p&&l._updateClamping()}return!0};p0.prototype.getBoundingSphere=function(e,t){let n=this._items.get(e.id);if(!u(n)||!u(n.label))return dt.FAILED;let i=n.label;return t.center=h.clone(x(i._clampedPosition,i.position),t.center),t.radius=0,dt.DONE};p0.prototype.isDestroyed=function(){return!1};p0.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(p0.prototype._onCollectionChanged,this);let e=this._entityCollection.values;for(let t=0;t<e.length;t++)this._cluster.removeLabel(e[t]);return ue(this)};p0.prototype._onCollectionChanged=function(e,t,n,i){let o,r,s=this._items,a=this._cluster;for(o=t.length-1;o>-1;o--)r=t[o],u(r._label)&&u(r._position)&&s.set(r.id,new ame(r));for(o=i.length-1;o>-1;o--)r=i[o],u(r._label)&&u(r._position)?s.contains(r.id)||s.set(r.id,new ame(r)):(uq(s.get(r.id),r,a),s.remove(r.id));for(o=n.length-1;o>-1;o--)r=n[o],uq(s.get(r.id),r,a),s.remove(r.id)};function uq(e,t,n){u(e)&&(e.label=void 0,n.removeLabel(t))}var Yk=p0;var Ltt=1,Ntt=!0,Ftt=0,Btt=!0,ktt=!0,Vtt=xn.ENABLED,Utt=Xe.NONE,ztt=G.RED,Htt=0,Gtt=G.WHITE,Wtt=Bc.HIGHLIGHT,jtt=.5,qtt=new H(1,1),Ytt=new F,Xtt=new F,cme=new G,lme=new Array(4),Ktt=new h;function _0(e,t){t.collectionChanged.addEventListener(_0.prototype._onCollectionChanged,this),this._scene=e,this._primitives=e.primitives,this._entityCollection=t,this._modelHash={},this._entitiesToVisualize=new St,this._onCollectionChanged(t,t.values,[],[])}async function Ztt(e,t,n,i){let o=e._primitives,r=e._modelHash;try{let s=await Jh.fromGltfAsync({url:n,incrementallyLoadTextures:i,scene:e._scene});if(e.isDestroyed()||!u(r[t.id]))return;s.id=t,o.add(s),r[t.id].modelPrimitive=s,s.errorEvent.addEventListener(a=>{u(r[t.id])&&(console.log(a),a.name!=="TextureError"&&s.incrementallyLoadTextures&&(r[t.id].loadFailed=!0))})}catch(s){if(e.isDestroyed()||!u(r[t.id]))return;console.log(s),r[t.id].loadFailed=!0}}_0.prototype.update=function(e){let t=this._entitiesToVisualize.values,n=this._modelHash,i=this._primitives;for(let o=0,r=t.length;o<r;o++){let s=t[o],a=s._model,c,l=n[s.id],f=s.isShowing&&s.isAvailable(e)&&Y.getValueOrDefault(a._show,e,!0),d;if(f&&(d=s.computeModelMatrix(e,Ytt),c=De.createIfNeeded(Y.getValueOrUndefined(a._uri,e)),f=u(d)&&u(c)),!f){u(l)&&l.modelPrimitive&&(l.modelPrimitive.show=!1);continue}if(!u(l)||c.url!==l.url){u(l?.modelPrimitive)&&(i.removeAndDestroy(l.modelPrimitive),delete n[s.id]),l={modelPrimitive:void 0,url:c.url,animationsRunning:!1,nodeTransformationsScratch:{},articulationsScratch:{},loadFailed:!1,modelUpdated:!1},n[s.id]=l;let m=Y.getValueOrDefault(a._incrementallyLoadTextures,e,Btt);Ztt(this,s,c,m)}let p=l.modelPrimitive;if(!u(p))continue;p.show=!0,p.scale=Y.getValueOrDefault(a._scale,e,Ltt),p.enableVerticalExaggeration=Y.getValueOrDefault(a._enableVerticalExaggeration,e,Ntt),p.minimumPixelSize=Y.getValueOrDefault(a._minimumPixelSize,e,Ftt),p.maximumScale=Y.getValueOrUndefined(a._maximumScale,e),p.modelMatrix=F.clone(d,p.modelMatrix),p.shadows=Y.getValueOrDefault(a._shadows,e,Vtt),p.heightReference=Y.getValueOrDefault(a._heightReference,e,Utt),p.distanceDisplayCondition=Y.getValueOrUndefined(a._distanceDisplayCondition,e),p.silhouetteColor=Y.getValueOrDefault(a._silhouetteColor,e,ztt,cme),p.silhouetteSize=Y.getValueOrDefault(a._silhouetteSize,e,Htt),p.color=Y.getValueOrDefault(a._color,e,Gtt,cme),p.colorBlendMode=Y.getValueOrDefault(a._colorBlendMode,e,Wtt),p.colorBlendAmount=Y.getValueOrDefault(a._colorBlendAmount,e,jtt),p.clippingPlanes=Y.getValueOrUndefined(a._clippingPlanes,e),p.clampAnimations=Y.getValueOrDefault(a._clampAnimations,e,ktt),p.imageBasedLighting.imageBasedLightingFactor=Y.getValueOrDefault(a._imageBasedLightingFactor,e,qtt);let g=Y.getValueOrUndefined(a._lightColor,e);if(u(g)&&(G.pack(g,lme,0),g=h.unpack(lme,0,Ktt)),p.lightColor=g,p.customShader=Y.getValueOrUndefined(a._customShader,e),n[s.id].modelUpdated=!0,p.ready){let m=Y.getValueOrDefault(a._runAnimations,e,!0);l.animationsRunning!==m&&(m?p.activeAnimations.addAll({loop:cu.REPEAT}):p.activeAnimations.removeAll(),l.animationsRunning=m);let y=Y.getValueOrUndefined(a._nodeTransformations,e,l.nodeTransformationsScratch);if(u(y)){let A=Object.keys(y);for(let T=0,E=A.length;T<E;++T){let v=A[T],D=y[v];if(!u(D))continue;let O=p.getNode(v);if(!u(O))continue;let P=F.fromTranslationRotationScale(D,Xtt);O.matrix=F.multiply(O.originalMatrix,P,P)}}let b=!1,C=Y.getValueOrUndefined(a._articulations,e,l.articulationsScratch);if(u(C)){let A=Object.keys(C);for(let T=0,E=A.length;T<E;++T){let v=A[T],D=C[v];u(D)&&(b=!0,p.setArticulationStage(v,D))}}b&&p.applyArticulations()}}return!0};_0.prototype.isDestroyed=function(){return!1};_0.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(_0.prototype._onCollectionChanged,this);let e=this._entitiesToVisualize.values,t=this._modelHash,n=this._primitives;for(let i=e.length-1;i>-1;i--)fq(this,e[i],t,n);return ue(this)};var Xk=new h,$tt=new de;_0.prototype.getBoundingSphere=function(e,t){let n=this._modelHash[e.id];if(!u(n))return dt.FAILED;if(n.loadFailed)return dt.FAILED;let i=n.modelPrimitive;if(!u(i)||!i.show)return dt.PENDING;if(!i.ready||!n.modelUpdated)return dt.PENDING;let o=this._scene,r=x(o.ellipsoid,ee.default);if(i.heightReference!==Xe.NONE){let a=i.modelMatrix;Xk.x=a[12],Xk.y=a[13],Xk.z=a[14];let c=r.cartesianToCartographic(Xk,$tt),l=o.getHeight(c,i.heightReference);return u(l)&&(tf(i.heightReference)?c.height=l:c.height+=l),ae.clone(i.boundingSphere,t),t.center=r.cartographicToCartesian(c),dt.DONE}return ae.clone(i.boundingSphere,t),dt.DONE};_0.prototype._onCollectionChanged=function(e,t,n,i){let o,r,s=this._entitiesToVisualize,a=this._modelHash,c=this._primitives;for(o=t.length-1;o>-1;o--)r=t[o],u(r._model)&&u(r._position)&&s.set(r.id,r);for(o=i.length-1;o>-1;o--)r=i[o],u(r._model)&&u(r._position)?(Qtt(r,a),s.set(r.id,r)):(fq(this,r,a,c),s.remove(r.id));for(o=n.length-1;o>-1;o--)r=n[o],fq(this,r,a,c),s.remove(r.id)};function fq(e,t,n,i){let o=n[t.id];u(o)&&(i.removeAndDestroy(o.modelPrimitive),delete n[t.id])}function Qtt(e,t){let n=t[e.id];u(n)&&(n.nodeTransformationsScratch={},n.articulationsScratch={})}var Kk=_0;function g0(e){this._definitionChanged=new me,this._value=void 0,this._removeSubscription=void 0,this.setValue(e)}Object.defineProperties(g0.prototype,{isConstant:{get:function(){return Y.isConstant(this._value)}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return u(this._value)?this._value.referenceFrame:Gi.FIXED}}});var Jtt=new $;g0.prototype.getValue=function(e,t){return u(e)||(e=$.now(Jtt)),this.getValueInReferenceFrame(e,Gi.FIXED,t)};g0.prototype.setValue=function(e){this._value!==e&&(this._value=e,u(this._removeSubscription)&&(this._removeSubscription(),this._removeSubscription=void 0),u(e)&&(this._removeSubscription=e.definitionChanged.addEventListener(this._raiseDefinitionChanged,this)),this._definitionChanged.raiseEvent(this))};g0.prototype.getValueInReferenceFrame=function(e,t,n){if(u(this._value))return n=this._value.getValueInReferenceFrame(e,t,n),u(n)?ee.default.scaleToGeodeticSurface(n,n):void 0};g0.prototype.equals=function(e){return this===e||e instanceof g0&&this._value===e._value};g0.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var o_=g0;var ent=60,tnt=1,fme=new Sn,dq=new Sn,hq=new Sn;function ume(e){this.entity=e,this.polyline=void 0,this.index=void 0,this.updater=void 0}function nnt(e,t,n,i,o,r,s,a,c){let l=a,f;f=e.getValueInReferenceFrame(t,r,c[l]),u(f)&&(c[l++]=f);let d=!u(o)||$.lessThanOrEquals(o,t)||$.greaterThanOrEquals(o,n),p=0,g=i.length,m=i[p],y=n,b=!1,C,A,T;for(;p<g;){if(!d&&$.greaterThanOrEquals(m,o)&&(f=e.getValueInReferenceFrame(o,r,c[l]),u(f)&&(c[l++]=f),d=!0),$.greaterThan(m,t)&&$.lessThan(m,y)&&!m.equals(o)&&(f=e.getValueInReferenceFrame(m,r,c[l]),u(f)&&(c[l++]=f)),p<g-1){if(s>0&&!b){let E=i[p+1],v=$.secondsDifference(E,m);b=v>s,b&&(C=Math.ceil(v/s),A=0,T=v/Math.max(C,2),C=Math.max(C-1,1))}if(b&&A<C){m=$.addSeconds(m,T,new $),A++;continue}}b=!1,p++,m=i[p]}return f=e.getValueInReferenceFrame(n,r,c[l]),u(f)&&(c[l++]=f),l}function int(e,t,n,i,o,r,s,a){let c,l=0,f=s,d=t,p=!u(i)||$.lessThanOrEquals(i,t)||$.greaterThanOrEquals(i,n);for(;$.lessThan(d,n);)!p&&$.greaterThanOrEquals(d,i)&&(p=!0,c=e.getValueInReferenceFrame(i,o,a[f]),u(c)&&(a[f]=c,f++)),c=e.getValueInReferenceFrame(d,o,a[f]),u(c)&&(a[f]=c,f++),l++,d=$.addSeconds(t,r*l,new $);return c=e.getValueInReferenceFrame(n,o,a[f]),u(c)&&(a[f]=c,f++),f}function ont(e,t,n,i,o,r,s,a){let c,l=0,f=s,d=t,p=Math.max(r,60),g=!u(i)||$.lessThanOrEquals(i,t)||$.greaterThanOrEquals(i,n);for(;$.lessThan(d,n);)!g&&$.greaterThanOrEquals(d,i)&&(g=!0,c=e.getValueInReferenceFrame(i,o,a[f]),u(c)&&(a[f]=c,f++)),c=e.getValueInReferenceFrame(d,o,a[f]),u(c)&&(a[f]=c,f++),l++,d=$.addSeconds(t,p*l,new $);return c=e.getValueInReferenceFrame(n,o,a[f]),u(c)&&(a[f]=c,f++),f}function rnt(e,t,n,i,o,r,s,a){hq.start=t,hq.stop=n;let c=s,l=e.intervals;for(let f=0;f<l.length;f++){let d=l.get(f);if(!Sn.intersect(d,hq,fme).isEmpty){let p=d.start;d.isStartIncluded||(d.isStopIncluded?p=d.stop:p=$.addSeconds(d.start,$.secondsDifference(d.stop,d.start)/2,new $));let g=e.getValueInReferenceFrame(p,o,a[c]);u(g)&&(a[c]=g,c++)}}return c}function snt(e,t,n,i,o,r,s,a){let c=e.getValueInReferenceFrame(t,o,a[s]);return u(c)&&(a[s++]=c),s}function ant(e,t,n,i,o,r,s,a){dq.start=t,dq.stop=n;let c=s,l=e.intervals;for(let f=0;f<l.length;f++){let d=l.get(f);if(!Sn.intersect(d,dq,fme).isEmpty){let p=d.start,g=d.stop,m=t;$.greaterThan(p,m)&&(m=p);let y=n;$.lessThan(g,y)&&(y=g),c=dme(d.data,m,y,i,o,r,c,a)}}return c}function dme(e,t,n,i,o,r,s,a){for(;e instanceof a0;)e=e.resolvedProperty;if(e instanceof Ra){let c=e._property._times;s=nnt(e,t,n,c,i,o,r,s,a)}else e instanceof HL?s=int(e,t,n,i,o,r,s,a):e instanceof Pa?s=ant(e,t,n,i,o,r,s,a):e instanceof l0?s=rnt(e,t,n,i,o,r,s,a):e instanceof gl||e instanceof o_&&Y.isConstant(e)?s=snt(e,t,n,i,o,r,s,a):s=ont(e,t,n,i,o,r,s,a);return s}function hme(e,t,n,i,o,r,s){u(s)||(s=[]);let a=dme(e,t,n,i,o,r,0,s);return s.length=a,s}var cnt=new J;function U1(e,t){this._unusedIndexes=[],this._polylineCollection=new im,this._scene=e,this._referenceFrame=t,e.primitives.add(this._polylineCollection)}U1.prototype.update=function(e){if(this._referenceFrame===Gi.INERTIAL){let t=Lt.computeIcrfToCentralBodyFixedMatrix(e,cnt);F.fromRotationTranslation(t,h.ZERO,this._polylineCollection.modelMatrix)}};U1.prototype.updateObject=function(e,t){let n=t.entity,i=n._path,o=n._position,r,s,a=i._show,c=t.polyline,l=n.isShowing&&n.isAvailable(e)&&(!u(a)||a.getValue(e));if(l){let d=Y.getValueOrUndefined(i._leadTime,e),p=Y.getValueOrUndefined(i._trailTime,e),g=n._availability,m=u(g),y=u(d),b=u(p);if(l=m||y&&b,l){if(b&&(r=$.addSeconds(e,-p,new $)),y&&(s=$.addSeconds(e,d,new $)),m){let C=g.start,A=g.stop;(!b||$.greaterThan(C,r))&&(r=C),(!y||$.lessThan(A,s))&&(s=A)}l=$.lessThan(r,s)}}if(!l){u(c)&&(this._unusedIndexes.push(t.index),t.polyline=void 0,c.show=!1,t.index=void 0);return}if(!u(c)){let d=this._unusedIndexes;if(d.length>0){let g=d.pop();c=this._polylineCollection.get(g),t.index=g}else t.index=this._polylineCollection.length,c=this._polylineCollection.add();c.id=n,t.polyline=c}let f=Y.getValueOrDefault(i._resolution,e,ent);c.show=!0,c.positions=hme(o,r,s,e,this._referenceFrame,f,c.positions.slice()),c.material=sr.getValue(e,i._material,c.material),c.width=Y.getValueOrDefault(i._width,e,tnt),c.distanceDisplayCondition=Y.getValueOrUndefined(i._distanceDisplayCondition,e,c.distanceDisplayCondition)};U1.prototype.removeObject=function(e){let t=e.polyline;u(t)&&(this._unusedIndexes.push(e.index),e.polyline=void 0,t.show=!1,t.id=void 0,e.index=void 0)};U1.prototype.destroy=function(){return this._scene.primitives.remove(this._polylineCollection),ue(this)};function y0(e,t){t.collectionChanged.addEventListener(y0.prototype._onCollectionChanged,this),this._scene=e,this._updaters={},this._entityCollection=t,this._items=new St,this._onCollectionChanged(t,t.values,[],[])}y0.prototype.update=function(e){let t=this._updaters;for(let i in t)t.hasOwnProperty(i)&&t[i].update(e);let n=this._items.values;if(n.length===0&&u(this._updaters)&&Object.keys(this._updaters).length>0){for(let i in t)t.hasOwnProperty(i)&&t[i].destroy();this._updaters={}}for(let i=0,o=n.length;i<o;i++){let r=n[i],a=r.entity._position,c=r.updater,l=Gi.FIXED;this._scene.mode===ne.SCENE3D&&(l=a.referenceFrame);let f=this._updaters[l];if(c===f&&u(f)){f.updateObject(e,r);continue}u(c)&&c.removeObject(r),u(f)||(f=new U1(this._scene,l),f.update(e),this._updaters[l]=f),r.updater=f,u(f)&&f.updateObject(e,r)}return!0};y0.prototype.isDestroyed=function(){return!1};y0.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(y0.prototype._onCollectionChanged,this);let e=this._updaters;for(let t in e)e.hasOwnProperty(t)&&e[t].destroy();return ue(this)};y0.prototype._onCollectionChanged=function(e,t,n,i){let o,r,s,a=this._items;for(o=t.length-1;o>-1;o--)r=t[o],u(r._path)&&u(r._position)&&a.set(r.id,new ume(r));for(o=i.length-1;o>-1;o--)r=i[o],u(r._path)&&u(r._position)?a.contains(r.id)||a.set(r.id,new ume(r)):(s=a.get(r.id),u(s)&&(u(s.updater)&&s.updater.removeObject(s),a.remove(r.id)));for(o=n.length-1;o>-1;o--)r=n[o],s=a.get(r.id),u(s)&&(u(s.updater)&&s.updater.removeObject(s),a.remove(r.id))};y0._subSample=hme;var Zk=y0;var mme=G.WHITE,pme=G.BLACK,_me=0,gme=1,yme=0,xme=Wr.NONE,bme=new G,lnt=new h,Cme=new G,Ame=new kt,Tme=new kt,Eme=new Nt;function Sme(e){this.entity=e,this.pointPrimitive=void 0,this.billboard=void 0,this.color=void 0,this.outlineColor=void 0,this.pixelSize=void 0,this.outlineWidth=void 0}function x0(e,t){t.collectionChanged.addEventListener(x0.prototype._onCollectionChanged,this),this._cluster=e,this._entityCollection=t,this._items=new St,this._onCollectionChanged(t,t.values,[],[])}x0.prototype.update=function(e){let t=this._items.values,n=this._cluster;for(let i=0,o=t.length;i<o;i++){let r=t[i],s=r.entity,a=s._point,c=r.pointPrimitive,l=r.billboard,f=Y.getValueOrDefault(a._heightReference,e,Xe.NONE),d=s.isShowing&&s.isAvailable(e)&&Y.getValueOrDefault(a._show,e,!0),p;if(d&&(p=Y.getValueOrUndefined(s._position,e,lnt),d=u(p)),!d){z1(r,s,n);continue}Y.isConstant(s._position)||(n._clusterDirty=!0);let g=!1,m=!1;if(f!==Xe.NONE&&!u(l)?(u(c)&&(z1(r,s,n),c=void 0),l=n.getBillboard(s),l.id=s,l.image=void 0,r.billboard=l,g=!0,m=h.equals(l.position,p)&&l.heightReference===f):f===Xe.NONE&&!u(c)&&(u(l)&&(z1(r,s,n),l=void 0),c=n.getPoint(s),c.id=s,r.pointPrimitive=c),u(c))c.show=!0,c.position=p,c.scaleByDistance=Y.getValueOrUndefined(a._scaleByDistance,e,Ame),c.translucencyByDistance=Y.getValueOrUndefined(a._translucencyByDistance,e,Tme),c.color=Y.getValueOrDefault(a._color,e,mme,bme),c.outlineColor=Y.getValueOrDefault(a._outlineColor,e,pme,Cme),c.outlineWidth=Y.getValueOrDefault(a._outlineWidth,e,_me),c.pixelSize=Y.getValueOrDefault(a._pixelSize,e,gme),c.distanceDisplayCondition=Y.getValueOrUndefined(a._distanceDisplayCondition,e,Eme),c.disableDepthTestDistance=Y.getValueOrDefault(a._disableDepthTestDistance,e,yme),c.splitDirection=Y.getValueOrDefault(a._splitDirection,e,xme);else if(u(l)){l.show=!0,l.position=p,l.scaleByDistance=Y.getValueOrUndefined(a._scaleByDistance,e,Ame),l.translucencyByDistance=Y.getValueOrUndefined(a._translucencyByDistance,e,Tme),l.distanceDisplayCondition=Y.getValueOrUndefined(a._distanceDisplayCondition,e,Eme),l.disableDepthTestDistance=Y.getValueOrDefault(a._disableDepthTestDistance,e,yme),l.splitDirection=Y.getValueOrDefault(a._splitDirection,e,xme),l.heightReference=f;let y=Y.getValueOrDefault(a._color,e,mme,bme),b=Y.getValueOrDefault(a._outlineColor,e,pme,Cme),C=Math.round(Y.getValueOrDefault(a._outlineWidth,e,_me)),A=Math.max(1,Math.round(Y.getValueOrDefault(a._pixelSize,e,gme)));if(C>0?(l.scale=1,g=g||C!==r.outlineWidth||A!==r.pixelSize||!G.equals(y,r.color)||!G.equals(b,r.outlineColor)):(l.scale=A/50,A=50,g=g||C!==r.outlineWidth||!G.equals(y,r.color)||!G.equals(b,r.outlineColor)),g){r.color=G.clone(y,r.color),r.outlineColor=G.clone(b,r.outlineColor),r.pixelSize=A,r.outlineWidth=C;let T=y.alpha,E=y.toCssColorString(),v=b.toCssColorString(),D=JSON.stringify([E,A,v,C]);l.setImage(D,WA(T,E,v,C,A))}m&&l._updateClamping()}}return!0};x0.prototype.getBoundingSphere=function(e,t){let n=this._items.get(e.id);if(!u(n)||!(u(n.pointPrimitive)||u(n.billboard)))return dt.FAILED;if(u(n.pointPrimitive))t.center=h.clone(n.pointPrimitive.position,t.center);else{let i=n.billboard;if(!u(i._clampedPosition))return dt.PENDING;t.center=h.clone(i._clampedPosition,t.center)}return t.radius=0,dt.DONE};x0.prototype.isDestroyed=function(){return!1};x0.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(x0.prototype._onCollectionChanged,this);let e=this._entityCollection.values;for(let t=0;t<e.length;t++)this._cluster.removePoint(e[t]);return ue(this)};x0.prototype._onCollectionChanged=function(e,t,n,i){let o,r,s=this._items,a=this._cluster;for(o=t.length-1;o>-1;o--)r=t[o],u(r._point)&&u(r._position)&&s.set(r.id,new Sme(r));for(o=i.length-1;o>-1;o--)r=i[o],u(r._point)&&u(r._position)?s.contains(r.id)||s.set(r.id,new Sme(r)):(z1(s.get(r.id),r,a),s.remove(r.id));for(o=n.length-1;o>-1;o--)r=n[o],z1(s.get(r.id),r,a),s.remove(r.id)};function z1(e,t,n){if(u(e)){let i=e.pointPrimitive;if(u(i)){e.pointPrimitive=void 0,n.removePoint(t);return}let o=e.billboard;u(o)&&(e.billboard=void 0,n.removeBillboard(t))}}var $k=x0;var Pme=[];function unt(e,t,n,i,o){let r=Pme;r.length=o;let s,a=n.red,c=n.green,l=n.blue,f=n.alpha,d=i.red,p=i.green,g=i.blue,m=i.alpha;if(G.equals(n,i)){for(s=0;s<o;s++)r[s]=G.clone(n);return r}let y=(d-a)/o,b=(p-c)/o,C=(g-l)/o,A=(m-f)/o;for(s=0;s<o;s++)r[s]=new G(a+s*y,c+s*b,l+s*C,f+s*A);return r}function H1(e){e=x(e,x.EMPTY_OBJECT);let t=e.positions,n=e.colors,i=x(e.width,1),o=x(e.colorsPerVertex,!1);this._positions=t,this._colors=n,this._width=i,this._colorsPerVertex=o,this._vertexFormat=Ie.clone(x(e.vertexFormat,Ie.DEFAULT)),this._arcType=x(e.arcType,nn.GEODESIC),this._granularity=x(e.granularity,R.RADIANS_PER_DEGREE),this._ellipsoid=ee.clone(x(e.ellipsoid,ee.default)),this._workerName="createPolylineGeometry";let r=1+t.length*h.packedLength;r+=u(n)?1+n.length*G.packedLength:1,this.packedLength=r+ee.packedLength+Ie.packedLength+4}H1.pack=function(e,t,n){n=x(n,0);let i,o=e._positions,r=o.length;for(t[n++]=r,i=0;i<r;++i,n+=h.packedLength)h.pack(o[i],t,n);let s=e._colors;for(r=u(s)?s.length:0,t[n++]=r,i=0;i<r;++i,n+=G.packedLength)G.pack(s[i],t,n);return ee.pack(e._ellipsoid,t,n),n+=ee.packedLength,Ie.pack(e._vertexFormat,t,n),n+=Ie.packedLength,t[n++]=e._width,t[n++]=e._colorsPerVertex?1:0,t[n++]=e._arcType,t[n]=e._granularity,t};var Rme=ee.clone(ee.UNIT_SPHERE),Ome=new Ie,eb={positions:void 0,colors:void 0,ellipsoid:Rme,vertexFormat:Ome,width:void 0,colorsPerVertex:void 0,arcType:void 0,granularity:void 0};H1.unpack=function(e,t,n){t=x(t,0);let i,o=e[t++],r=new Array(o);for(i=0;i<o;++i,t+=h.packedLength)r[i]=h.unpack(e,t);o=e[t++];let s=o>0?new Array(o):void 0;for(i=0;i<o;++i,t+=G.packedLength)s[i]=G.unpack(e,t);let a=ee.unpack(e,t,Rme);t+=ee.packedLength;let c=Ie.unpack(e,t,Ome);t+=Ie.packedLength;let l=e[t++],f=e[t++]===1,d=e[t++],p=e[t];return u(n)?(n._positions=r,n._colors=s,n._ellipsoid=ee.clone(a,n._ellipsoid),n._vertexFormat=Ie.clone(c,n._vertexFormat),n._width=l,n._colorsPerVertex=f,n._arcType=d,n._granularity=p,n):(eb.positions=r,eb.colors=s,eb.width=l,eb.colorsPerVertex=f,eb.arcType=d,eb.granularity=p,new H1(eb))};var vme=new h,wme=new h,Dme=new h,Ime=new h;H1.createGeometry=function(e){let t=e._width,n=e._vertexFormat,i=e._colors,o=e._colorsPerVertex,r=e._arcType,s=e._granularity,a=e._ellipsoid,c,l,f,d=[],p=Eo(e._positions,h.equalsEpsilon,!1,d);if(u(i)&&d.length>0){let N=0,k=d[0];i=i.filter(function(z,V){let U=!1;return o?U=V===k||V===0&&k===1:U=V+1===k,U?(N++,k=d[N],!1):!0})}let g=p.length;if(g<2||t<=0)return;if(r===nn.GEODESIC||r===nn.RHUMB){let N,k;r===nn.GEODESIC?(N=R.chordLength(s,a.maximumRadius),k=Fi.numberOfPoints):(N=s,k=Fi.numberOfPointsRhumbLine);let z=Fi.extractHeights(p,a);if(u(i)){let V=1;for(c=0;c<g-1;++c)V+=k(p[c],p[c+1],N);let U=new Array(V),B=0;for(c=0;c<g-1;++c){let W=p[c],j=p[c+1],Q=i[c],q=k(W,j,N);if(o&&c<V){let X=i[c+1],Z=unt(W,j,Q,X,q),fe=Z.length;for(l=0;l<fe;++l)U[B++]=Z[l]}else for(l=0;l<q;++l)U[B++]=G.clone(Q)}U[B]=G.clone(i[i.length-1]),i=U,Pme.length=0}r===nn.GEODESIC?p=Fi.generateCartesianArc({positions:p,minDistance:N,ellipsoid:a,height:z}):p=Fi.generateCartesianRhumbArc({positions:p,granularity:N,ellipsoid:a,height:z})}g=p.length;let m=g*4-4,y=new Float64Array(m*3),b=new Float64Array(m*3),C=new Float64Array(m*3),A=new Float32Array(m*2),T=n.st?new Float32Array(m*2):void 0,E=u(i)?new Uint8Array(m*4):void 0,v=0,D=0,O=0,P=0,M;for(l=0;l<g;++l){l===0?(M=vme,h.subtract(p[0],p[1],M),h.add(p[0],M,M)):M=p[l-1],h.clone(M,Dme),h.clone(p[l],wme),l===g-1?(M=vme,h.subtract(p[g-1],p[g-2],M),h.add(p[g-1],M,M)):M=p[l+1],h.clone(M,Ime);let N,k;u(E)&&(l!==0&&!o?N=i[l-1]:N=i[l],l!==g-1&&(k=i[l]));let z=l===0?2:0,V=l===g-1?2:4;for(f=z;f<V;++f){h.pack(wme,y,v),h.pack(Dme,b,v),h.pack(Ime,C,v),v+=3;let U=f-2<0?-1:1;if(A[D++]=2*(f%2)-1,A[D++]=U*t,n.st&&(T[O++]=l/(g-1),T[O++]=Math.max(A[D-2],0)),u(E)){let B=f<2?N:k;E[P++]=G.floatToByte(B.red),E[P++]=G.floatToByte(B.green),E[P++]=G.floatToByte(B.blue),E[P++]=G.floatToByte(B.alpha)}}}let L=new hn;L.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:y}),L.prevPosition=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:b}),L.nextPosition=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:C}),L.expandAndWidth=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:A}),n.st&&(L.st=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:T})),u(E)&&(L.color=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:4,values:E,normalize:!0}));let _=Be.createTypedArray(m,g*6-6),S=0,w=0,I=g-1;for(l=0;l<I;++l)_[w++]=S,_[w++]=S+2,_[w++]=S+1,_[w++]=S+1,_[w++]=S+2,_[w++]=S+3,S+=4;return new ft({attributes:L,indices:_,primitiveType:Ne.TRIANGLES,boundingSphere:ae.fromPoints(p),geometryType:ad.POLYLINES})};var b0=H1;var fnt=new Kn(0),Qk={},Mme=new G,dnt=new Ht(G.WHITE),hnt=new Kn(!0),mnt=new Kn(xn.DISABLED),pnt=new Kn(new Nt),_nt=new Kn(Vn.BOTH);function gnt(){this.vertexFormat=void 0,this.positions=void 0,this.width=void 0,this.arcType=void 0,this.granularity=void 0}function ynt(){this.positions=void 0,this.width=void 0,this.arcType=void 0,this.granularity=void 0}function jd(e,t){this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(jd.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._geometryChanged=new me,this._showProperty=void 0,this._materialProperty=void 0,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._classificationTypeProperty=void 0,this._depthFailMaterialProperty=void 0,this._geometryOptions=new gnt,this._groundGeometryOptions=new ynt,this._id=`polyline-${e.id}`,this._clampToGround=!1,this._supportsPolylinesOnTerrain=ar.supportsPolylinesOnTerrain(t),this._zIndex=0,this._onEntityPropertyChanged(e,"polyline",e.polyline,void 0)}Object.defineProperties(jd.prototype,{id:{get:function(){return this._id}},entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!u(this._entity.availability)&&Y.isConstant(this._showProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},depthFailMaterialProperty:{get:function(){return this._depthFailMaterialProperty}},outlineEnabled:{value:!1},hasConstantOutline:{value:!0},outlineColorProperty:{value:void 0},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},classificationTypeProperty:{get:function(){return this._classificationTypeProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:!1},geometryChanged:{get:function(){return this._geometryChanged}},arcType:{get:function(){return this._arcType}},clampToGround:{get:function(){return this._clampToGround&&this._supportsPolylinesOnTerrain}},zIndex:{get:function(){return this._zIndex}}});jd.prototype.isOutlineVisible=function(e){return!1};jd.prototype.isFilled=function(e){let t=this._entity,n=this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e);return x(n,!1)};jd.prototype.createFillGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i=new yn(n&&t.isShowing&&this._showProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),r=kn.fromDistanceDisplayCondition(o),s={show:i,distanceDisplayCondition:r},a;return this._materialProperty instanceof Ht&&(u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(a=this._materialProperty.color.getValue(e,Mme)),u(a)||(a=G.WHITE),s.color=jt.fromColor(a)),this.clampToGround?new vt({id:t,geometry:new VC(this._groundGeometryOptions),attributes:s}):(u(this._depthFailMaterialProperty)&&this._depthFailMaterialProperty instanceof Ht&&(u(this._depthFailMaterialProperty.color)&&(this._depthFailMaterialProperty.color.isConstant||n)&&(a=this._depthFailMaterialProperty.color.getValue(e,Mme)),u(a)||(a=G.WHITE),s.depthFailColor=jt.fromColor(a)),new vt({id:t,geometry:new b0(this._geometryOptions),attributes:s}))};jd.prototype.createOutlineGeometryInstance=function(e){};jd.prototype.isDestroyed=function(){return!1};jd.prototype.destroy=function(){this._entitySubscription(),ue(this)};jd.prototype._onEntityPropertyChanged=function(e,t,n,i){if(!(t==="availability"||t==="polyline"))return;let o=this._entity.polyline;if(!u(o)){this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this));return}let r=o.positions,s=o.show;if(u(s)&&s.isConstant&&!s.getValue(He.MINIMUM_VALUE)||!u(r)){this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this));return}let a=o.zIndex,c=x(o.material,dnt),l=c instanceof Ht;this._materialProperty=c,this._depthFailMaterialProperty=o.depthFailMaterial,this._showProperty=x(s,hnt),this._shadowsProperty=x(o.shadows,mnt),this._distanceDisplayConditionProperty=x(o.distanceDisplayCondition,pnt),this._classificationTypeProperty=x(o.classificationType,_nt),this._fillEnabled=!0,this._zIndex=x(a,fnt);let f=o.width,d=o.arcType,p=o.clampToGround,g=o.granularity;if(!r.isConstant||!Y.isConstant(f)||!Y.isConstant(d)||!Y.isConstant(g)||!Y.isConstant(p)||!Y.isConstant(a))this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this));else{let m=this._geometryOptions,y=r.getValue(He.MINIMUM_VALUE,m.positions);if(!u(y)||y.length<2){this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this));return}let b;l&&(!u(this._depthFailMaterialProperty)||this._depthFailMaterialProperty instanceof Ht)?b=rs.VERTEX_FORMAT:b=Sa.VERTEX_FORMAT,m.vertexFormat=b,m.positions=y,m.width=u(f)?f.getValue(He.MINIMUM_VALUE):void 0,m.arcType=u(d)?d.getValue(He.MINIMUM_VALUE):void 0,m.granularity=u(g)?g.getValue(He.MINIMUM_VALUE):void 0;let C=this._groundGeometryOptions;C.positions=y,C.width=m.width,C.arcType=m.arcType,C.granularity=m.granularity,this._clampToGround=u(p)?p.getValue(He.MINIMUM_VALUE):!1,!this._clampToGround&&u(a)&&At("Entity polylines must have clampToGround: true when using zIndex.  zIndex will be ignored."),this._dynamic=!1,this._geometryChanged.raiseEvent(this)}};jd.prototype.createDynamicUpdater=function(e,t){return new G1(e,t,this)};var iE={positions:void 0,granularity:void 0,height:void 0,ellipsoid:void 0};function G1(e,t,n){this._line=void 0,this._primitives=e,this._groundPrimitives=t,this._groundPolylinePrimitive=void 0,this._material=void 0,this._geometryUpdater=n,this._positions=[]}function Lme(e){if(u(e._line))return e._line;let t=e._primitives,n=e._geometryUpdater._scene.id+t._guid,i=Qk[n];!u(i)||i.isDestroyed()?(i=new im,Qk[n]=i,t.add(i)):t.contains(i)||t.add(i);let o=i.add();return o.id=e._geometryUpdater._entity,e._line=o,o}G1.prototype.update=function(e){let t=this._geometryUpdater,n=t._entity,i=n.polyline,o=i.positions,r=Y.getValueOrUndefined(o,e,this._positions);t._clampToGround=Y.getValueOrDefault(i._clampToGround,e,!1),t._groundGeometryOptions.positions=r,t._groundGeometryOptions.width=Y.getValueOrDefault(i._width,e,1),t._groundGeometryOptions.arcType=Y.getValueOrDefault(i._arcType,e,nn.GEODESIC),t._groundGeometryOptions.granularity=Y.getValueOrDefault(i._granularity,e,9999);let s=this._groundPrimitives;if(u(this._groundPolylinePrimitive)&&(s.remove(this._groundPolylinePrimitive),this._groundPolylinePrimitive=void 0),t.clampToGround){if(!n.isShowing||!n.isAvailable(e)||!Y.getValueOrDefault(i._show,e,!0)||!u(r)||r.length<2)return;let d=t.fillMaterialProperty,p;if(d instanceof Ht)p=new rs;else{let g=sr.getValue(e,d,this._material);p=new Sa({material:g,translucent:g.isTranslucent()}),this._material=g}this._groundPolylinePrimitive=s.add(new Rh({geometryInstances:t.createFillGeometryInstance(e),appearance:p,classificationType:t.classificationTypeProperty.getValue(e),asynchronous:!1}),Y.getValueOrUndefined(t.zIndex,e)),u(this._line)&&(this._line.show=!1);return}let a=Lme(this);if(!n.isShowing||!n.isAvailable(e)||!Y.getValueOrDefault(i._show,e,!0)){a.show=!1;return}if(!u(r)||r.length<2){a.show=!1;return}let c=nn.GEODESIC;c=Y.getValueOrDefault(i._arcType,e,c);let l=t._scene.globe,f=t._scene.ellipsoid;c!==nn.NONE&&u(l)&&(iE.ellipsoid=f,iE.positions=r,iE.granularity=Y.getValueOrUndefined(i._granularity,e),iE.height=Fi.extractHeights(r,f),c===nn.GEODESIC?r=Fi.generateCartesianArc(iE):r=Fi.generateCartesianRhumbArc(iE)),a.show=!0,a.positions=r.slice(),a.material=sr.getValue(e,t.fillMaterialProperty,a.material),a.width=Y.getValueOrDefault(i._width,e,1),a.distanceDisplayCondition=Y.getValueOrUndefined(i._distanceDisplayCondition,e,a.distanceDisplayCondition)};G1.prototype.getBoundingSphere=function(e){if(this._geometryUpdater.clampToGround){let t=this._groundPolylinePrimitive;if(u(t)&&t.show&&t.ready){let n=t.getGeometryInstanceAttributes(this._geometryUpdater._entity);if(u(n)&&u(n.boundingSphere))return ae.clone(n.boundingSphere,e),dt.DONE}return u(t)&&!t.ready?dt.PENDING:dt.DONE}else{let t=Lme(this);if(t.show&&t.positions.length>0)return ae.fromPoints(t.positions,e),dt.DONE}return dt.FAILED};G1.prototype.isDestroyed=function(){return!1};G1.prototype.destroy=function(){let t=this._geometryUpdater._scene.id+this._primitives._guid,n=Qk[t];u(n)&&(n.remove(this._line),n.length===0&&(this._primitives.removeAndDestroy(n),delete Qk[t])),u(this._groundPolylinePrimitive)&&this._groundPrimitives.remove(this._groundPolylinePrimitive),ue(this)};var Jk=jd;var xnt=new G,bnt=new Nt,Cnt=new Nt;function qd(e,t,n,i,o){let r;n instanceof Ht?r=rs:r=Sa,this.orderedGroundPrimitives=e,this.classificationType=t,this.appearanceType=r,this.materialProperty=n,this.updaters=new St,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new St,this.material=void 0,this.updatersWithAttributes=new St,this.attributes=new St,this.invalidated=!1,this.removeMaterialSubscription=n.definitionChanged.addEventListener(qd.prototype.onMaterialChanged,this),this.subscriptions=new St,this.showsUpdated=new St,this.zIndex=i,this._asynchronous=o}qd.prototype.onMaterialChanged=function(){this.invalidated=!0};qd.prototype.isMaterial=function(e){let t=this.materialProperty,n=e.fillMaterialProperty;return n===t||n instanceof Ht&&t instanceof Ht?!0:u(t)&&t.equals(n)};qd.prototype.add=function(e,t,n){let i=t.id;if(this.updaters.set(i,t),this.geometry.set(i,n),!t.hasConstantFill||!t.fillMaterialProperty.isConstant||!Y.isConstant(t.distanceDisplayConditionProperty))this.updatersWithAttributes.set(i,t);else{let o=this;this.subscriptions.set(i,t.entity.definitionChanged.addEventListener(function(r,s,a,c){s==="isShowing"&&o.showsUpdated.set(t.id,t)}))}this.createPrimitive=!0};qd.prototype.remove=function(e){let t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);let n=this.subscriptions.get(t);return u(n)&&(n(),this.subscriptions.remove(t)),!0}return!1};qd.prototype.update=function(e){let t=!0,n=this.primitive,i=this.orderedGroundPrimitives,o=this.geometry.values,r;if(this.createPrimitive){if(o.length>0)u(n)&&(u(this.oldPrimitive)?i.remove(n):this.oldPrimitive=n),n=new Rh({show:!1,asynchronous:this._asynchronous,geometryInstances:o.slice(),appearance:new this.appearanceType,classificationType:this.classificationType}),this.appearanceType===Sa&&(this.material=sr.getValue(e,this.materialProperty,this.material),n.appearance.material=this.material),i.add(n,this.zIndex),t=!1;else{u(n)&&(i.remove(n),n=void 0);let a=this.oldPrimitive;u(a)&&(i.remove(a),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=n,this.createPrimitive=!1}else if(u(n)&&n.ready){n.show=!0,u(this.oldPrimitive)&&(i.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.appearanceType===Sa&&(this.material=sr.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material);let s=this.updatersWithAttributes.values,a=s.length;for(r=0;r<a;r++){let c=s[r],l=c.entity,f=this.geometry.get(c.id),d=this.attributes.get(f.id.id);if(u(d)||(d=n.getGeometryInstanceAttributes(f.id),this.attributes.set(f.id.id,d)),!c.fillMaterialProperty.isConstant){let y=c.fillMaterialProperty.color,b=Y.getValueOrDefault(y,e,G.WHITE,xnt);G.equals(d._lastColor,b)||(d._lastColor=G.clone(b,d._lastColor),d.color=jt.toValue(b,d.color))}let p=l.isShowing&&(c.hasConstantFill||c.isFilled(e)),g=d.show[0]===1;p!==g&&(d.show=yn.toValue(p,d.show));let m=c.distanceDisplayConditionProperty;if(!Y.isConstant(m)){let y=Y.getValueOrDefault(m,e,Cnt,bnt);Nt.equals(y,d._lastDistanceDisplayCondition)||(d._lastDistanceDisplayCondition=Nt.clone(y,d._lastDistanceDisplayCondition),d.distanceDisplayCondition=kn.toValue(y,d.distanceDisplayCondition))}}this.updateShows(n)}else u(n)&&!n.ready&&(t=!1);return t};qd.prototype.updateShows=function(e){let t=this.showsUpdated.values,n=t.length;for(let i=0;i<n;i++){let o=t[i],r=o.entity,s=this.geometry.get(o.id),a=this.attributes.get(s.id.id);u(a)||(a=e.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,a));let c=r.isShowing,l=a.show[0]===1;c!==l&&(a.show=yn.toValue(c,a.show),s.attributes.show.value[0]=a.show[0])}this.showsUpdated.removeAll()};qd.prototype.contains=function(e){return this.updaters.contains(e.id)};qd.prototype.getBoundingSphere=function(e,t){let n=this.primitive;if(!n.ready)return dt.PENDING;let i=n.getGeometryInstanceAttributes(e.entity);return!u(i)||!u(i.boundingSphere)||u(i.show)&&i.show[0]===0?dt.FAILED:(i.boundingSphere.clone(t),dt.DONE)};qd.prototype.destroy=function(){let e=this.primitive,t=this.orderedGroundPrimitives;u(e)&&t.remove(e);let n=this.oldPrimitive;u(n)&&t.remove(n),this.removeMaterialSubscription()};function oE(e,t,n){this._items=[],this._orderedGroundPrimitives=e,this._classificationType=t,this._asynchronous=x(n,!0)}oE.prototype.add=function(e,t){let n=this._items,i=n.length,o=t.createFillGeometryInstance(e),r=Y.getValueOrDefault(t.zIndex,0);for(let a=0;a<i;++a){let c=n[a];if(c.isMaterial(t)&&c.zIndex===r){c.add(e,t,o);return}}let s=new qd(this._orderedGroundPrimitives,this._classificationType,t.fillMaterialProperty,r,this._asynchronous);s.add(e,t,o),n.push(s)};oE.prototype.remove=function(e){let t=this._items,n=t.length;for(let i=n-1;i>=0;i--){let o=t[i];if(o.remove(e)){o.updaters.length===0&&(t.splice(i,1),o.destroy());break}}};oE.prototype.update=function(e){let t,n=this._items,i=n.length;for(t=i-1;t>=0;t--){let r=n[t];if(r.invalidated){n.splice(t,1);let s=r.updaters.values,a=s.length;for(let c=0;c<a;c++)this.add(e,s[c]);r.destroy()}}let o=!0;for(t=0;t<n.length;t++)o=n[t].update(e)&&o;return o};oE.prototype.getBoundingSphere=function(e,t){let n=this._items,i=n.length;for(let o=0;o<i;o++){let r=n[o];if(r.contains(e))return r.getBoundingSphere(e,t)}return dt.FAILED};oE.prototype.removeAllPrimitives=function(){let e=this._items,t=e.length;for(let n=0;n<t;n++)e[n].destroy();this._items.length=0};var e4=oE;var Ant=[];function Nme(e,t){let n=e._batches,i=n.length;for(let o=0;o<i;o++)n[o].remove(t)}function Fme(e,t,n){if(n.isDynamic){e._dynamicBatch.add(t,n);return}if(n.clampToGround&&n.fillEnabled){let s=n.classificationTypeProperty.getValue(t);e._groundBatches[s].add(t,n);return}let i;n.fillEnabled&&(i=n.shadowsProperty.getValue(t));let o=0;u(n.depthFailMaterialProperty)&&(o=n.depthFailMaterialProperty instanceof Ht?1:2);let r;u(i)&&(r=i+o*xn.NUMBER_OF_SHADOW_MODES),n.fillEnabled&&(n.fillMaterialProperty instanceof Ht?e._colorBatches[r].add(t,n):e._materialBatches[r].add(t,n))}function _m(e,t,n,i){i=x(i,e.groundPrimitives),n=x(n,e.primitives),this._scene=e,this._primitives=n,this._entityCollection=void 0,this._addedObjects=new St,this._removedObjects=new St,this._changedObjects=new St;let o,r=xn.NUMBER_OF_SHADOW_MODES;for(this._colorBatches=new Array(r*3),this._materialBatches=new Array(r*3),o=0;o<r;++o)this._colorBatches[o]=new Hd(n,rs,void 0,!1,o),this._materialBatches[o]=new Wd(n,Sa,void 0,!1,o),this._colorBatches[o+r]=new Hd(n,rs,rs,!1,o),this._materialBatches[o+r]=new Wd(n,Sa,rs,!1,o),this._colorBatches[o+r*2]=new Hd(n,rs,Sa,!1,o),this._materialBatches[o+r*2]=new Wd(n,Sa,Sa,!1,o);this._dynamicBatch=new LT(n,i);let s=Vn.NUMBER_OF_CLASSIFICATION_TYPES;for(this._groundBatches=new Array(s),o=0;o<s;++o)this._groundBatches[o]=new e4(i,o);this._batches=this._colorBatches.concat(this._materialBatches,this._dynamicBatch,this._groundBatches),this._subscriptions=new St,this._updaters=new St,this._entityCollection=t,t.collectionChanged.addEventListener(_m.prototype._onCollectionChanged,this),this._onCollectionChanged(t,t.values,Ant)}_m.prototype.update=function(e){let t=this._addedObjects,n=t.values,i=this._removedObjects,o=i.values,r=this._changedObjects,s=r.values,a,c,l,f;for(a=s.length-1;a>-1;a--)c=s[a],l=c.id,f=this._updaters.get(l),f.entity===c?(Nme(this,f),Fme(this,e,f)):(o.push(c),n.push(c));for(a=o.length-1;a>-1;a--)c=o[a],l=c.id,f=this._updaters.get(l),Nme(this,f),f.destroy(),this._updaters.remove(l),this._subscriptions.get(l)(),this._subscriptions.remove(l);for(a=n.length-1;a>-1;a--)c=n[a],l=c.id,f=new Jk(c,this._scene),this._updaters.set(l,f),Fme(this,e,f),this._subscriptions.set(l,f.geometryChanged.addEventListener(_m._onGeometryChanged,this));t.removeAll(),i.removeAll(),r.removeAll();let d=!0,p=this._batches,g=p.length;for(a=0;a<g;a++)d=p[a].update(e)&&d;return d};var Tnt=[],Ent=new ae;_m.prototype.getBoundingSphere=function(e,t){let n=Tnt,i=Ent,o=0,r=dt.DONE,s=this._batches,a=s.length,c=this._updaters.get(e.id);for(let l=0;l<a;l++){if(r=s[l].getBoundingSphere(c,i),r===dt.PENDING)return dt.PENDING;r===dt.DONE&&(n[o]=ae.clone(i,n[o]),o++)}return o===0?dt.FAILED:(n.length=o,ae.fromBoundingSpheres(n,t),dt.DONE)};_m.prototype.isDestroyed=function(){return!1};_m.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(_m.prototype._onCollectionChanged,this),this._addedObjects.removeAll(),this._removedObjects.removeAll();let e,t=this._batches,n=t.length;for(e=0;e<n;e++)t[e].removeAllPrimitives();let i=this._subscriptions.values;for(n=i.length,e=0;e<n;e++)i[e]();return this._subscriptions.removeAll(),ue(this)};_m._onGeometryChanged=function(e){let t=this._removedObjects,n=this._changedObjects,i=e.entity,o=i.id;!u(t.get(o))&&!u(n.get(o))&&n.set(o,i)};_m.prototype._onCollectionChanged=function(e,t,n){let i=this._addedObjects,o=this._removedObjects,r=this._changedObjects,s,a,c;for(s=n.length-1;s>-1;s--)c=n[s],a=c.id,i.remove(a)||(o.set(a,c),r.remove(a));for(s=t.length-1;s>-1;s--)c=t[s],a=c.id,o.remove(a)?r.set(a,c):i.set(a,c)};var t4=_m;function Il(e){_l.initializeTerrainHeights(),Rh.initializeTerrainHeights();let t=e.scene,n=e.dataSourceCollection;this._eventHelper=new Ar,this._eventHelper.add(n.dataSourceAdded,this._onDataSourceAdded,this),this._eventHelper.add(n.dataSourceRemoved,this._onDataSourceRemoved,this),this._eventHelper.add(n.dataSourceMoved,this._onDataSourceMoved,this),this._eventHelper.add(t.postRender,this._postRender,this),this._dataSourceCollection=n,this._scene=t,this._visualizersCallback=x(e.visualizersCallback,Il.defaultVisualizersCallback);let i=!1,o=new _u,r=new _u;n.length>0&&(t.primitives.add(o),t.groundPrimitives.add(r),i=!0),this._primitives=o,this._groundPrimitives=r;for(let l=0,f=n.length;l<f;l++)this._onDataSourceAdded(n,n.get(l));let s=new Q3;this._onDataSourceAdded(void 0,s),this._defaultDataSource=s;let a,c;if(!i){let l=this,f=function(){t.primitives.add(o),t.groundPrimitives.add(r),a(),c(),l._removeDefaultDataSourceListener=void 0,l._removeDataSourceCollectionListener=void 0};a=s.entities.collectionChanged.addEventListener(f),c=n.dataSourceAdded.addEventListener(f)}this._removeDefaultDataSourceListener=a,this._removeDataSourceCollectionListener=c,this._ready=!1}var rE=[];Il.registerVisualizer=function(e){rE.includes(e)||rE.push(e)};Il.unregisterVisualizer=function(e){if(rE.includes(e)){let t=rE.indexOf(e);rE.splice(t,1)}};Il.defaultVisualizersCallback=function(e,t,n){let i=n.entities;return[new jM(t,i),new qk(e,i,n._primitives,n._groundPrimitives),new Yk(t,i),new Kk(e,i),new B3(e,i),new $k(t,i),new Zk(e,i),new t4(e,i,n._primitives,n._groundPrimitives),...rE.map(o=>new o(e,i))]};Object.defineProperties(Il.prototype,{scene:{get:function(){return this._scene}},dataSources:{get:function(){return this._dataSourceCollection}},defaultDataSource:{get:function(){return this._defaultDataSource}},ready:{get:function(){return this._ready}}});Il.prototype.isDestroyed=function(){return!1};Il.prototype.destroy=function(){this._eventHelper.removeAll();let e=this._dataSourceCollection;for(let t=0,n=e.length;t<n;++t)this._onDataSourceRemoved(this._dataSourceCollection,e.get(t));return this._onDataSourceRemoved(void 0,this._defaultDataSource),u(this._removeDefaultDataSourceListener)?(this._removeDefaultDataSourceListener(),this._removeDataSourceCollectionListener()):(this._scene.primitives.remove(this._primitives),this._scene.groundPrimitives.remove(this._groundPrimitives)),ue(this)};Il.prototype.update=function(e){if(!di.initialized)return this._ready=!1,!1;let t=!0,n,i,o,r,s=this._dataSourceCollection,a=s.length;for(n=0;n<a;n++){let c=s.get(n);for(u(c.update)&&(t=c.update(e)&&t),o=c._visualizers,r=o.length,i=0;i<r;i++)t=o[i].update(e)&&t}for(o=this._defaultDataSource._visualizers,r=o.length,i=0;i<r;i++)t=o[i].update(e)&&t;return!this._ready&&t&&this._scene.requestRender(),this._ready=t,t};Il.prototype._postRender=function(){let e=this._scene.frameState,t=this._dataSourceCollection,n=t.length;for(let i=0;i<n;i++){let o=t.get(i),r=o.credit;u(r)&&e.creditDisplay.addCreditToNextFrame(r);let s=o._resourceCredits;if(u(s)){let a=s.length;for(let c=0;c<a;c++)e.creditDisplay.addCreditToNextFrame(s[c])}}};var Snt=[],vnt=new ae;Il.prototype.getBoundingSphere=function(e,t,n){if(!this._ready&&!t)return dt.PENDING;let i,o,r=this._defaultDataSource;if(!r.entities.contains(e)){r=void 0;let p=this._dataSourceCollection;for(o=p.length,i=0;i<o;i++){let g=p.get(i);if(g.entities.contains(e)){r=g;break}}}if(!u(r))return dt.FAILED;let s=Snt,a=vnt,c=0,l=dt.DONE,f=r._visualizers,d=f.length;for(i=0;i<d;i++){let p=f[i];if(u(p.getBoundingSphere)){if(l=f[i].getBoundingSphere(e,a),!t&&l===dt.PENDING)return dt.PENDING;l===dt.DONE&&(s[c]=ae.clone(a,s[c]),c++)}}return c===0?dt.FAILED:(s.length=c,ae.fromBoundingSpheres(s,n),dt.DONE)};Il.prototype._onDataSourceAdded=function(e,t){let n=this._scene,i=this._primitives,o=this._groundPrimitives,r=i.add(new _u),s=o.add(new _k);t._primitives=r,t._groundPrimitives=s;let a=t.clustering;a._initialize(n),r.add(a),t._visualizers=this._visualizersCallback(n,a,t)};Il.prototype._onDataSourceRemoved=function(e,t){let n=this._primitives,i=this._groundPrimitives,o=t._primitives,r=t._groundPrimitives,s=t.clustering;o.remove(s);let a=t._visualizers,c=a.length;for(let l=0;l<c;l++)a[l].destroy();n.remove(o),i.remove(r),t._visualizers=void 0};Il.prototype._onDataSourceMoved=function(e,t,n){let i=this._primitives,o=this._groundPrimitives,r=e._primitives,s=e._groundPrimitives;t===n+1?(i.raise(r),o.raise(s)):t===n-1?(i.lower(r),o.lower(s)):t===0?(i.lowerToBottom(r),o.lowerToBottom(s),i.raise(r),o.raise(s)):(i.raiseToTop(r),o.raiseToTop(s))};var n4=Il;function mq(e,t,n){this.heading=x(e,0),this.pitch=x(t,0),this.range=x(n,0)}mq.clone=function(e,t){if(u(e))return u(t)||(t=new mq),t.heading=e.heading,t.pitch=e.pitch,t.range=e.range,t};var Yd=mq;var Bme=new J,kme=new J,Vme=new J,wnt=new F,i4=new h,Ume=new h,pq=new h,_q=new h,zme=new h,Hme=new h,sE=new $,Dnt=1.25;function Int(e,t,n,i,o,r,s){let a=e.scene.mode,c=o.getValue(r,e._lastCartesian);if(u(c)){let l=!1,f=!1,d,p,g;if(a===ne.SCENE3D){$.addSeconds(r,.001,sE);let A=o.getValue(sE,i4);if(u(A)||($.addSeconds(r,-.001,sE),A=o.getValue(sE,i4),f=!0),u(A)){let T=Lt.computeFixedToIcrfMatrix(r,Bme),E=Lt.computeFixedToIcrfMatrix(sE,kme),v;!u(T)||!u(E)?(v=Lt.computeTemeToPseudoFixedMatrix(r,Vme),T=J.transpose(v,Bme),E=Lt.computeTemeToPseudoFixedMatrix(sE,kme),J.transpose(E,E)):v=J.transpose(T,Vme);let D=J.multiplyByVector(T,c,zme),O=J.multiplyByVector(E,A,Hme);h.subtract(D,O,_q);let P=h.magnitude(_q)*1e3,M=R.GRAVITATIONALPARAMETER,L=-M/(P*P-2*M/h.magnitude(D));L<0||L>Dnt*s.maximumRadius?(d=Ume,h.normalize(c,d),h.negate(d,d),g=h.clone(h.UNIT_Z,pq),p=h.cross(g,d,i4),h.magnitude(p)>R.EPSILON7&&(h.normalize(d,d),h.normalize(p,p),g=h.cross(d,p,pq),h.normalize(g,g),l=!0)):h.equalsEpsilon(c,A,R.EPSILON7)||(g=Ume,h.normalize(D,g),h.normalize(O,O),p=h.cross(g,O,pq),f&&(p=h.multiplyByScalar(p,-1,p)),h.equalsEpsilon(p,h.ZERO,R.EPSILON7)||(d=h.cross(p,g,i4),J.multiplyByVector(v,d,d),J.multiplyByVector(v,p,p),J.multiplyByVector(v,g,g),h.normalize(d,d),h.normalize(p,p),h.normalize(g,g),l=!0))}}u(e.boundingSphere)&&(c=e.boundingSphere.center);let m,y,b;i&&(m=h.clone(t.position,_q),y=h.clone(t.direction,zme),b=h.clone(t.up,Hme));let C=wnt;l?(C[0]=d.x,C[1]=d.y,C[2]=d.z,C[3]=0,C[4]=p.x,C[5]=p.y,C[6]=p.z,C[7]=0,C[8]=g.x,C[9]=g.y,C[10]=g.z,C[11]=0,C[12]=c.x,C[13]=c.y,C[14]=c.z,C[15]=0):Lt.eastNorthUpToFixedFrame(c,s,C),t._setTransform(C),i&&(h.clone(m,t.position),h.clone(y,t.direction),h.clone(b,t.up),h.cross(y,b,t.right))}if(n){let l=a===ne.SCENE2D||h.equals(e._offset3D,h.ZERO)?void 0:e._offset3D;t.lookAtTransform(t.transform,l)}}function W1(e,t,n){this.entity=e,this.scene=t,this.ellipsoid=x(n,ee.default),this.boundingSphere=void 0,this._lastEntity=void 0,this._mode=void 0,this._lastCartesian=new h,this._defaultOffset3D=void 0,this._offset3D=new h}Object.defineProperties(W1,{defaultOffset3D:{get:function(){return this._defaultOffset3D},set:function(e){this._defaultOffset3D=h.clone(e,new h)}}});W1.defaultOffset3D=new h(-14e3,3500,3500);var o4=new Yd,Pnt=new h;W1.prototype.update=function(e,t){let n=this.scene,i=this.ellipsoid,o=n.mode;if(o===ne.MORPHING)return;let r=this.entity,s=r.position;if(!u(s))return;let a=r!==this._lastEntity,c=o!==this._mode,l=n.camera,f=a||c,d=!0;if(a){let p=r.viewFrom,g=u(p);if(!g&&u(t)){o4.pitch=-R.PI_OVER_FOUR,o4.range=0;let m=s.getValue(e,Pnt);if(u(m)){let y=2-1/Math.max(1,h.magnitude(m)/i.maximumRadius);o4.pitch*=y}l.viewBoundingSphere(t,o4),this.boundingSphere=t,f=!1,d=!1}else(!g||!u(p.getValue(e,this._offset3D)))&&h.clone(W1._defaultOffset3D,this._offset3D)}else!c&&this._mode!==ne.SCENE2D&&h.clone(l.position,this._offset3D);this._lastEntity=r,this._mode=o,Int(this,l,f,d,s,e,i)};var r4=W1;function d4(e){return h4(e.map(([t,n])=>new Array(t).fill(n,0,t)))}function h4(e){return e.reduce((t,n)=>t.concat(Array.isArray(n)?h4(n):n),[])}var Gme=[0,1,2,3].concat(...d4([[2,4],[2,5],[4,6],[4,7],[8,8],[8,9],[16,10],[16,11],[32,12],[32,13],[64,14],[64,15],[2,0],[1,16],[1,17],[2,18],[2,19],[4,20],[4,21],[8,22],[8,23],[16,24],[16,25],[32,26],[32,27],[64,28],[64,29]]));function ur(){let e=this;function t(o){let r=e.dyn_tree,s=e.stat_desc.static_tree,a=e.stat_desc.extra_bits,c=e.stat_desc.extra_base,l=e.stat_desc.max_length,f,d,p,g,m,y,b=0;for(g=0;g<=15;g++)o.bl_count[g]=0;for(r[o.heap[o.heap_max]*2+1]=0,f=o.heap_max+1;f<573;f++)d=o.heap[f],g=r[r[d*2+1]*2+1]+1,g>l&&(g=l,b++),r[d*2+1]=g,!(d>e.max_code)&&(o.bl_count[g]++,m=0,d>=c&&(m=a[d-c]),y=r[d*2],o.opt_len+=y*(g+m),s&&(o.static_len+=y*(s[d*2+1]+m)));if(b!==0){do{for(g=l-1;o.bl_count[g]===0;)g--;o.bl_count[g]--,o.bl_count[g+1]+=2,o.bl_count[l]--,b-=2}while(b>0);for(g=l;g!==0;g--)for(d=o.bl_count[g];d!==0;)p=o.heap[--f],!(p>e.max_code)&&(r[p*2+1]!=g&&(o.opt_len+=(g-r[p*2+1])*r[p*2],r[p*2+1]=g),d--)}}function n(o,r){let s=0;do s|=o&1,o>>>=1,s<<=1;while(--r>0);return s>>>1}function i(o,r,s){let a=[],c=0,l,f,d;for(l=1;l<=15;l++)a[l]=c=c+s[l-1]<<1;for(f=0;f<=r;f++)d=o[f*2+1],d!==0&&(o[f*2]=n(a[d]++,d))}e.build_tree=function(o){let r=e.dyn_tree,s=e.stat_desc.static_tree,a=e.stat_desc.elems,c,l,f=-1,d;for(o.heap_len=0,o.heap_max=573,c=0;c<a;c++)r[c*2]!==0?(o.heap[++o.heap_len]=f=c,o.depth[c]=0):r[c*2+1]=0;for(;o.heap_len<2;)d=o.heap[++o.heap_len]=f<2?++f:0,r[d*2]=1,o.depth[d]=0,o.opt_len--,s&&(o.static_len-=s[d*2+1]);for(e.max_code=f,c=Math.floor(o.heap_len/2);c>=1;c--)o.pqdownheap(r,c);d=a;do c=o.heap[1],o.heap[1]=o.heap[o.heap_len--],o.pqdownheap(r,1),l=o.heap[1],o.heap[--o.heap_max]=c,o.heap[--o.heap_max]=l,r[d*2]=r[c*2]+r[l*2],o.depth[d]=Math.max(o.depth[c],o.depth[l])+1,r[c*2+1]=r[l*2+1]=d,o.heap[1]=d++,o.pqdownheap(r,1);while(o.heap_len>=2);o.heap[--o.heap_max]=o.heap[1],t(o),i(r,e.max_code,o.bl_count)}}ur._length_code=[0,1,2,3,4,5,6,7].concat(...d4([[2,8],[2,9],[2,10],[2,11],[4,12],[4,13],[4,14],[4,15],[8,16],[8,17],[8,18],[8,19],[16,20],[16,21],[16,22],[16,23],[32,24],[32,25],[32,26],[31,27],[1,28]]));ur.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0];ur.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576];ur.d_code=function(e){return e<256?Gme[e]:Gme[256+(e>>>7)]};ur.extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0];ur.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];ur.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7];ur.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function Oa(e,t,n,i,o){let r=this;r.static_tree=e,r.extra_bits=t,r.extra_base=n,r.elems=i,r.max_length=o}var Rnt=[12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,19,275,147,403,83,339,211,467,51,307,179,435,115,371,243,499,11,267,139,395,75,331,203,459,43,299,171,427,107,363,235,491,27,283,155,411,91,347,219,475,59,315,187,443,123,379,251,507,7,263,135,391,71,327,199,455,39,295,167,423,103,359,231,487,23,279,151,407,87,343,215,471,55,311,183,439,119,375,247,503,15,271,143,399,79,335,207,463,47,303,175,431,111,367,239,495,31,287,159,415,95,351,223,479,63,319,191,447,127,383,255,511,0,64,32,96,16,80,48,112,8,72,40,104,24,88,56,120,4,68,36,100,20,84,52,116,3,131,67,195,35,163,99,227],Ont=d4([[144,8],[112,9],[24,7],[8,8]]);Oa.static_ltree=h4(Rnt.map((e,t)=>[e,Ont[t]]));var Mnt=[0,16,8,24,4,20,12,28,2,18,10,26,6,22,14,30,1,17,9,25,5,21,13,29,3,19,11,27,7,23],Lnt=d4([[30,5]]);Oa.static_dtree=h4(Mnt.map((e,t)=>[e,Lnt[t]]));Oa.static_l_desc=new Oa(Oa.static_ltree,ur.extra_lbits,257,286,15);Oa.static_d_desc=new Oa(Oa.static_dtree,ur.extra_dbits,0,30,15);Oa.static_bl_desc=new Oa(null,ur.extra_blbits,0,19,7);var Nnt=9,Fnt=8;function gm(e,t,n,i,o){let r=this;r.good_length=e,r.max_lazy=t,r.nice_length=n,r.max_chain=i,r.func=o}var jme=0,u4=1,tb=2,Xd=[new gm(0,0,0,0,jme),new gm(4,4,8,4,u4),new gm(4,5,16,8,u4),new gm(4,6,32,32,u4),new gm(4,4,16,16,tb),new gm(8,16,32,32,tb),new gm(8,16,128,128,tb),new gm(8,32,128,256,tb),new gm(32,128,258,1024,tb),new gm(32,258,258,4096,tb)],s4=["need dictionary","stream end","","","stream error","data error","","buffer error","",""],Uf=0,a4=1,j1=2,c4=3,Bnt=32,gq=42,l4=113,q1=666,yq=8,knt=0,xq=1,Vnt=2,Er=3,f4=258,bu=f4+Er+1;function Wme(e,t,n,i){let o=e[t*2],r=e[n*2];return o<r||o==r&&i[t]<=i[n]}function Unt(){let e=this,t,n,i,o,r,s,a,c,l,f,d,p,g,m,y,b,C,A,T,E,v,D,O,P,M,L,_,S,w,I,N,k,z,V=new ur,U=new ur,B=new ur;e.depth=[];let W,j,Q,q,X,Z;e.bl_count=[],e.heap=[],N=[],k=[],z=[];function fe(){l=2*r,d[g-1]=0;for(let Me=0;Me<g-1;Me++)d[Me]=0;L=Xd[_].max_lazy,w=Xd[_].good_length,I=Xd[_].nice_length,M=Xd[_].max_chain,v=0,C=0,O=0,A=P=Er-1,E=0,p=0}function xe(){let Me;for(Me=0;Me<286;Me++)N[Me*2]=0;for(Me=0;Me<30;Me++)k[Me*2]=0;for(Me=0;Me<19;Me++)z[Me*2]=0;N[256*2]=1,e.opt_len=e.static_len=0,j=Q=0}function re(){V.dyn_tree=N,V.stat_desc=Oa.static_l_desc,U.dyn_tree=k,U.stat_desc=Oa.static_d_desc,B.dyn_tree=z,B.stat_desc=Oa.static_bl_desc,X=0,Z=0,q=8,xe()}e.pqdownheap=function(Me,ot){let We=e.heap,Ye=We[ot],ht=ot<<1;for(;ht<=e.heap_len&&(ht<e.heap_len&&Wme(Me,We[ht+1],We[ht],e.depth)&&ht++,!Wme(Me,Ye,We[ht],e.depth));)We[ot]=We[ht],ot=ht,ht<<=1;We[ot]=Ye};function pe(Me,ot){let We=-1,Ye,ht=Me[0*2+1],zt=0,mn=7,bo=4;ht===0&&(mn=138,bo=3),Me[(ot+1)*2+1]=65535;for(let fo=0;fo<=ot;fo++)Ye=ht,ht=Me[(fo+1)*2+1],!(++zt<mn&&Ye==ht)&&(zt<bo?z[Ye*2]+=zt:Ye!==0?(Ye!=We&&z[Ye*2]++,z[16*2]++):zt<=10?z[17*2]++:z[18*2]++,zt=0,We=Ye,ht===0?(mn=138,bo=3):Ye==ht?(mn=6,bo=3):(mn=7,bo=4))}function ye(){let Me;for(pe(N,V.max_code),pe(k,U.max_code),B.build_tree(e),Me=18;Me>=3&&z[ur.bl_order[Me]*2+1]===0;Me--);return e.opt_len+=3*(Me+1)+5+5+4,Me}function Se(Me){e.pending_buf[e.pending++]=Me}function Te(Me){Se(Me&255),Se(Me>>>8&255)}function Fe(Me){Se(Me>>8&255),Se(Me&255&255)}function Ve(Me,ot){let We,Ye=ot;Z>16-Ye?(We=Me,X|=We<<Z&65535,Te(X),X=We>>>16-Z,Z+=Ye-16):(X|=Me<<Z&65535,Z+=Ye)}function Ze(Me,ot){let We=Me*2;Ve(ot[We]&65535,ot[We+1]&65535)}function gt(Me,ot){let We,Ye=-1,ht,zt=Me[0*2+1],mn=0,bo=7,fo=4;for(zt===0&&(bo=138,fo=3),We=0;We<=ot;We++)if(ht=zt,zt=Me[(We+1)*2+1],!(++mn<bo&&ht==zt)){if(mn<fo)do Ze(ht,z);while(--mn!==0);else ht!==0?(ht!=Ye&&(Ze(ht,z),mn--),Ze(16,z),Ve(mn-3,2)):mn<=10?(Ze(17,z),Ve(mn-3,3)):(Ze(18,z),Ve(mn-11,7));mn=0,Ye=ht,zt===0?(bo=138,fo=3):ht==zt?(bo=6,fo=3):(bo=7,fo=4)}}function lt(Me,ot,We){let Ye;for(Ve(Me-257,5),Ve(ot-1,5),Ve(We-4,4),Ye=0;Ye<We;Ye++)Ve(z[ur.bl_order[Ye]*2+1],3);gt(N,Me-1),gt(k,ot-1)}function Oe(){Z==16?(Te(X),X=0,Z=0):Z>=8&&(Se(X&255),X>>>=8,Z-=8)}function Mt(){Ve(xq<<1,3),Ze(256,Oa.static_ltree),Oe(),1+q+10-Z<9&&(Ve(xq<<1,3),Ze(256,Oa.static_ltree),Oe()),q=7}function ut(Me,ot){let We,Ye,ht;if(e.dist_buf[j]=Me,e.lc_buf[j]=ot&255,j++,Me===0?N[ot*2]++:(Q++,Me--,N[(ur._length_code[ot]+256+1)*2]++,k[ur.d_code(Me)*2]++),!(j&8191)&&_>2){for(We=j*8,Ye=v-C,ht=0;ht<30;ht++)We+=k[ht*2]*(5+ur.extra_dbits[ht]);if(We>>>=3,Q<Math.floor(j/2)&&We<Math.floor(Ye/2))return!0}return j==W-1}function at(Me,ot){let We,Ye,ht=0,zt,mn;if(j!==0)do We=e.dist_buf[ht],Ye=e.lc_buf[ht],ht++,We===0?Ze(Ye,Me):(zt=ur._length_code[Ye],Ze(zt+256+1,Me),mn=ur.extra_lbits[zt],mn!==0&&(Ye-=ur.base_length[zt],Ve(Ye,mn)),We--,zt=ur.d_code(We),Ze(zt,ot),mn=ur.extra_dbits[zt],mn!==0&&(We-=ur.base_dist[zt],Ve(We,mn)));while(ht<j);Ze(256,Me),q=Me[256*2+1]}function Kt(){Z>8?Te(X):Z>0&&Se(X&255),X=0,Z=0}function Ce(Me,ot,We){Kt(),q=8,We&&(Te(ot),Te(~ot)),e.pending_buf.set(c.subarray(Me,Me+ot),e.pending),e.pending+=ot}function Ae(Me,ot,We){Ve((knt<<1)+(We?1:0),3),Ce(Me,ot,!0)}function nt(Me,ot,We){let Ye,ht,zt=0;_>0?(V.build_tree(e),U.build_tree(e),zt=ye(),Ye=e.opt_len+3+7>>>3,ht=e.static_len+3+7>>>3,ht<=Ye&&(Ye=ht)):Ye=ht=ot+5,ot+4<=Ye&&Me!=-1?Ae(Me,ot,We):ht==Ye?(Ve((xq<<1)+(We?1:0),3),at(Oa.static_ltree,Oa.static_dtree)):(Ve((Vnt<<1)+(We?1:0),3),lt(V.max_code+1,U.max_code+1,zt+1),at(N,k)),xe(),We&&Kt()}function yi(Me){nt(C>=0?C:-1,v-C,Me),C=v,t.flush_pending()}function ct(){let Me,ot,We,Ye;do{if(Ye=l-O-v,Ye===0&&v===0&&O===0)Ye=r;else if(Ye==-1)Ye--;else if(v>=r+r-bu){c.set(c.subarray(r,r+r),0),D-=r,v-=r,C-=r,Me=g,We=Me;do ot=d[--We]&65535,d[We]=ot>=r?ot-r:0;while(--Me!==0);Me=r,We=Me;do ot=f[--We]&65535,f[We]=ot>=r?ot-r:0;while(--Me!==0);Ye+=r}if(t.avail_in===0)return;Me=t.read_buf(c,v+O,Ye),O+=Me,O>=Er&&(p=c[v]&255,p=(p<<b^c[v+1]&255)&y)}while(O<bu&&t.avail_in!==0)}function Si(Me){let ot=65535,We;for(ot>i-5&&(ot=i-5);;){if(O<=1){if(ct(),O===0&&Me==0)return Uf;if(O===0)break}if(v+=O,O=0,We=C+ot,(v===0||v>=We)&&(O=v-We,v=We,yi(!1),t.avail_out===0)||v-C>=r-bu&&(yi(!1),t.avail_out===0))return Uf}return yi(Me==4),t.avail_out===0?Me==4?j1:Uf:Me==4?c4:a4}function oo(Me){let ot=M,We=v,Ye,ht,zt=P,mn=v>r-bu?v-(r-bu):0,bo=I,fo=a,$s=v+f4,Rs=c[We+zt-1],li=c[We+zt];P>=w&&(ot>>=2),bo>O&&(bo=O);do if(Ye=Me,!(c[Ye+zt]!=li||c[Ye+zt-1]!=Rs||c[Ye]!=c[We]||c[++Ye]!=c[We+1])){We+=2,Ye++;do;while(c[++We]==c[++Ye]&&c[++We]==c[++Ye]&&c[++We]==c[++Ye]&&c[++We]==c[++Ye]&&c[++We]==c[++Ye]&&c[++We]==c[++Ye]&&c[++We]==c[++Ye]&&c[++We]==c[++Ye]&&We<$s);if(ht=f4-($s-We),We=$s-f4,ht>zt){if(D=Me,zt=ht,ht>=bo)break;Rs=c[We+zt-1],li=c[We+zt]}}while((Me=f[Me&fo]&65535)>mn&&--ot!==0);return zt<=O?zt:O}function Zs(Me){let ot=0,We;for(;;){if(O<bu){if(ct(),O<bu&&Me==0)return Uf;if(O===0)break}if(O>=Er&&(p=(p<<b^c[v+(Er-1)]&255)&y,ot=d[p]&65535,f[v&a]=d[p],d[p]=v),ot!==0&&(v-ot&65535)<=r-bu&&S!=2&&(A=oo(ot)),A>=Er)if(We=ut(v-D,A-Er),O-=A,A<=L&&O>=Er){A--;do v++,p=(p<<b^c[v+(Er-1)]&255)&y,ot=d[p]&65535,f[v&a]=d[p],d[p]=v;while(--A!==0);v++}else v+=A,A=0,p=c[v]&255,p=(p<<b^c[v+1]&255)&y;else We=ut(0,c[v]&255),O--,v++;if(We&&(yi(!1),t.avail_out===0))return Uf}return yi(Me==4),t.avail_out===0?Me==4?j1:Uf:Me==4?c4:a4}function jo(Me){let ot=0,We,Ye;for(;;){if(O<bu){if(ct(),O<bu&&Me==0)return Uf;if(O===0)break}if(O>=Er&&(p=(p<<b^c[v+(Er-1)]&255)&y,ot=d[p]&65535,f[v&a]=d[p],d[p]=v),P=A,T=D,A=Er-1,ot!==0&&P<L&&(v-ot&65535)<=r-bu&&(S!=2&&(A=oo(ot)),A<=5&&(S==1||A==Er&&v-D>4096)&&(A=Er-1)),P>=Er&&A<=P){Ye=v+O-Er,We=ut(v-1-T,P-Er),O-=P-1,P-=2;do++v<=Ye&&(p=(p<<b^c[v+(Er-1)]&255)&y,ot=d[p]&65535,f[v&a]=d[p],d[p]=v);while(--P!==0);if(E=0,A=Er-1,v++,We&&(yi(!1),t.avail_out===0))return Uf}else if(E!==0){if(We=ut(0,c[v-1]&255),We&&yi(!1),v++,O--,t.avail_out===0)return Uf}else E=1,v++,O--}return E!==0&&(We=ut(0,c[v-1]&255),E=0),yi(Me==4),t.avail_out===0?Me==4?j1:Uf:Me==4?c4:a4}function wr(Me){return Me.total_in=Me.total_out=0,Me.msg=null,e.pending=0,e.pending_out=0,n=l4,o=0,re(),fe(),0}e.deflateInit=function(Me,ot,We,Ye,ht,zt){return Ye||(Ye=yq),ht||(ht=Fnt),zt||(zt=0),Me.msg=null,ot==-1&&(ot=6),ht<1||ht>Nnt||Ye!=yq||We<9||We>15||ot<0||ot>9||zt<0||zt>2?-2:(Me.dstate=e,s=We,r=1<<s,a=r-1,m=ht+7,g=1<<m,y=g-1,b=Math.floor((m+Er-1)/Er),c=new Uint8Array(r*2),f=[],d=[],W=1<<ht+6,e.pending_buf=new Uint8Array(W*4),i=W*4,e.dist_buf=new Uint16Array(W),e.lc_buf=new Uint8Array(W),_=ot,S=zt,wr(Me))},e.deflateEnd=function(){return n!=gq&&n!=l4&&n!=q1?-2:(e.lc_buf=null,e.dist_buf=null,e.pending_buf=null,d=null,f=null,c=null,e.dstate=null,n==l4?-3:0)},e.deflateParams=function(Me,ot,We){let Ye=0;return ot==-1&&(ot=6),ot<0||ot>9||We<0||We>2?-2:(Xd[_].func!=Xd[ot].func&&Me.total_in!==0&&(Ye=Me.deflate(1)),_!=ot&&(_=ot,L=Xd[_].max_lazy,w=Xd[_].good_length,I=Xd[_].nice_length,M=Xd[_].max_chain),S=We,Ye)},e.deflateSetDictionary=function(Me,ot,We){let Ye=We,ht,zt=0;if(!ot||n!=gq)return-2;if(Ye<Er)return 0;for(Ye>r-bu&&(Ye=r-bu,zt=We-Ye),c.set(ot.subarray(zt,zt+Ye),0),v=Ye,C=Ye,p=c[0]&255,p=(p<<b^c[1]&255)&y,ht=0;ht<=Ye-Er;ht++)p=(p<<b^c[ht+(Er-1)]&255)&y,f[ht&a]=d[p],d[p]=ht;return 0},e.deflate=function(Me,ot){let We,Ye,ht,zt,mn;if(ot>4||ot<0)return-2;if(!Me.next_out||!Me.next_in&&Me.avail_in!==0||n==q1&&ot!=4)return Me.msg=s4[4],-2;if(Me.avail_out===0)return Me.msg=s4[7],-5;if(t=Me,zt=o,o=ot,n==gq&&(Ye=yq+(s-8<<4)<<8,ht=(_-1&255)>>1,ht>3&&(ht=3),Ye|=ht<<6,v!==0&&(Ye|=Bnt),Ye+=31-Ye%31,n=l4,Fe(Ye)),e.pending!==0){if(t.flush_pending(),t.avail_out===0)return o=-1,0}else if(t.avail_in===0&&ot<=zt&&ot!=4)return t.msg=s4[7],-5;if(n==q1&&t.avail_in!==0)return Me.msg=s4[7],-5;if(t.avail_in!==0||O!==0||ot!=0&&n!=q1){switch(mn=-1,Xd[_].func){case jme:mn=Si(ot);break;case u4:mn=Zs(ot);break;case tb:mn=jo(ot);break;default:}if((mn==j1||mn==c4)&&(n=q1),mn==Uf||mn==j1)return t.avail_out===0&&(o=-1),0;if(mn==a4){if(ot==1)Mt();else if(Ae(0,0,!1),ot==3)for(We=0;We<g;We++)d[We]=0;if(t.flush_pending(),t.avail_out===0)return o=-1,0}}return ot!=4?0:1}}function qme(){let e=this;e.next_in_index=0,e.next_out_index=0,e.avail_in=0,e.total_in=0,e.avail_out=0,e.total_out=0}qme.prototype={deflateInit(e,t){let n=this;return n.dstate=new Unt,t||(t=15),n.dstate.deflateInit(n,e,t)},deflate(e){let t=this;return t.dstate?t.dstate.deflate(t,e):-2},deflateEnd(){let e=this;if(!e.dstate)return-2;let t=e.dstate.deflateEnd();return e.dstate=null,t},deflateParams(e,t){let n=this;return n.dstate?n.dstate.deflateParams(n,e,t):-2},deflateSetDictionary(e,t){let n=this;return n.dstate?n.dstate.deflateSetDictionary(n,e,t):-2},read_buf(e,t,n){let i=this,o=i.avail_in;return o>n&&(o=n),o===0?0:(i.avail_in-=o,e.set(i.next_in.subarray(i.next_in_index,i.next_in_index+o),t),i.next_in_index+=o,i.total_in+=o,o)},flush_pending(){let e=this,t=e.dstate.pending;t>e.avail_out&&(t=e.avail_out),t!==0&&(e.next_out.set(e.dstate.pending_buf.subarray(e.dstate.pending_out,e.dstate.pending_out+t),e.next_out_index),e.next_out_index+=t,e.dstate.pending_out+=t,e.total_out+=t,e.avail_out-=t,e.dstate.pending-=t,e.dstate.pending===0&&(e.dstate.pending_out=0))}};function Yme(e){let t=this,n=new qme,i=znt(e&&e.chunkSize?e.chunkSize:64*1024),o=0,r=new Uint8Array(i),s=e?e.level:-1;typeof s>"u"&&(s=-1),n.deflateInit(s),n.next_out=r,t.append=function(a,c){let l,f,d=0,p=0,g=0,m=[];if(a.length){n.next_in_index=0,n.next_in=a,n.avail_in=a.length;do{if(n.next_out_index=0,n.avail_out=i,l=n.deflate(o),l!=0)throw new Error("deflating: "+n.msg);n.next_out_index&&(n.next_out_index==i?m.push(new Uint8Array(r)):m.push(r.subarray(0,n.next_out_index))),g+=n.next_out_index,c&&n.next_in_index>0&&n.next_in_index!=d&&(c(n.next_in_index),d=n.next_in_index)}while(n.avail_in>0||n.avail_out===0);return m.length>1?(f=new Uint8Array(g),m.forEach(function(y){f.set(y,p),p+=y.length})):f=m[0]?new Uint8Array(m[0]):new Uint8Array,f}},t.flush=function(){let a,c,l=0,f=0,d=[];do{if(n.next_out_index=0,n.avail_out=i,a=n.deflate(4),a!=1&&a!=0)throw new Error("deflating: "+n.msg);i-n.avail_out>0&&d.push(r.slice(0,n.next_out_index)),f+=n.next_out_index}while(n.avail_in>0||n.avail_out===0);return n.deflateEnd(),c=new Uint8Array(f),d.forEach(function(p){c.set(p,l),l+=p.length}),c}}function znt(e){return e+5*(Math.floor(e/16383)+1)}var Cu=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],hpe=1440,Hnt=0,Gnt=4,Wnt=9,jnt=5,qnt=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],Ynt=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],Xnt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Knt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],Znt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],$nt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],C0=15;function Tq(){let e=this,t,n,i,o,r,s;function a(l,f,d,p,g,m,y,b,C,A,T){let E,v,D,O,P,M,L,_,S,w,I,N,k,z,V;w=0,P=d;do i[l[f+w]]++,w++,P--;while(P!==0);if(i[0]==d)return y[0]=-1,b[0]=0,0;for(_=b[0],M=1;M<=C0&&i[M]===0;M++);for(L=M,_<M&&(_=M),P=C0;P!==0&&i[P]===0;P--);for(D=P,_>P&&(_=P),b[0]=_,z=1<<M;M<P;M++,z<<=1)if((z-=i[M])<0)return-3;if((z-=i[P])<0)return-3;for(i[P]+=z,s[1]=M=0,w=1,k=2;--P!==0;)s[k]=M+=i[w],k++,w++;P=0,w=0;do(M=l[f+w])!==0&&(T[s[M]++]=P),w++;while(++P<d);for(d=s[D],s[0]=P=0,w=0,O=-1,N=-_,r[0]=0,I=0,V=0;L<=D;L++)for(E=i[L];E--!==0;){for(;L>N+_;){if(O++,N+=_,V=D-N,V=V>_?_:V,(v=1<<(M=L-N))>E+1&&(v-=E+1,k=L,M<V))for(;++M<V&&!((v<<=1)<=i[++k]);)v-=i[k];if(V=1<<M,A[0]+V>hpe)return-3;r[O]=I=A[0],A[0]+=V,O!==0?(s[O]=P,o[0]=M,o[1]=_,M=P>>>N-_,o[2]=I-r[O-1]-M,C.set(o,(r[O-1]+M)*3)):y[0]=I}for(o[1]=L-N,w>=d?o[0]=192:T[w]<p?(o[0]=T[w]<256?0:96,o[2]=T[w++]):(o[0]=m[T[w]-p]+16+64,o[2]=g[T[w++]-p]),v=1<<L-N,M=P>>>N;M<V;M+=v)C.set(o,(I+M)*3);for(M=1<<L-1;P&M;M>>>=1)P^=M;for(P^=M,S=(1<<N)-1;(P&S)!=s[O];)O--,N-=_,S=(1<<N)-1}return z!==0&&D!=1?-5:0}function c(l){let f;for(t||(t=[],n=[],i=new Int32Array(C0+1),o=[],r=new Int32Array(C0),s=new Int32Array(C0+1)),n.length<l&&(n=[]),f=0;f<l;f++)n[f]=0;for(f=0;f<C0+1;f++)i[f]=0;for(f=0;f<3;f++)o[f]=0;r.set(i.subarray(0,C0),0),s.set(i.subarray(0,C0+1),0)}e.inflate_trees_bits=function(l,f,d,p,g){let m;return c(19),t[0]=0,m=a(l,0,19,19,null,null,d,f,p,t,n),m==-3?g.msg="oversubscribed dynamic bit lengths tree":(m==-5||f[0]===0)&&(g.msg="incomplete dynamic bit lengths tree",m=-3),m},e.inflate_trees_dynamic=function(l,f,d,p,g,m,y,b,C){let A;return c(288),t[0]=0,A=a(d,0,l,257,Xnt,Knt,m,p,b,t,n),A!=0||p[0]===0?(A==-3?C.msg="oversubscribed literal/length tree":A!=-4&&(C.msg="incomplete literal/length tree",A=-3),A):(c(288),A=a(d,l,f,0,Znt,$nt,y,g,b,t,n),A!=0||g[0]===0&&l>257?(A==-3?C.msg="oversubscribed distance tree":A==-5?(C.msg="incomplete distance tree",A=-3):A!=-4&&(C.msg="empty distance tree with lengths",A=-3),A):0)}}Tq.inflate_trees_fixed=function(e,t,n,i){return e[0]=Wnt,t[0]=jnt,n[0]=qnt,i[0]=Ynt,0};var m4=0,Xme=1,Kme=2,Zme=3,$me=4,Qme=5,Jme=6,bq=7,epe=8,p4=9;function Qnt(){let e=this,t,n=0,i,o=0,r=0,s=0,a=0,c=0,l=0,f=0,d,p=0,g,m=0;function y(b,C,A,T,E,v,D,O){let P,M,L,_,S,w,I,N,k,z,V,U,B,W,j,Q;I=O.next_in_index,N=O.avail_in,S=D.bitb,w=D.bitk,k=D.write,z=k<D.read?D.read-k-1:D.end-k,V=Cu[b],U=Cu[C];do{for(;w<20;)N--,S|=(O.read_byte(I++)&255)<<w,w+=8;if(P=S&V,M=A,L=T,Q=(L+P)*3,(_=M[Q])===0){S>>=M[Q+1],w-=M[Q+1],D.win[k++]=M[Q+2],z--;continue}do{if(S>>=M[Q+1],w-=M[Q+1],_&16){for(_&=15,B=M[Q+2]+(S&Cu[_]),S>>=_,w-=_;w<15;)N--,S|=(O.read_byte(I++)&255)<<w,w+=8;P=S&U,M=E,L=v,Q=(L+P)*3,_=M[Q];do if(S>>=M[Q+1],w-=M[Q+1],_&16){for(_&=15;w<_;)N--,S|=(O.read_byte(I++)&255)<<w,w+=8;if(W=M[Q+2]+(S&Cu[_]),S>>=_,w-=_,z-=B,k>=W)j=k-W,k-j>0&&2>k-j?(D.win[k++]=D.win[j++],D.win[k++]=D.win[j++],B-=2):(D.win.set(D.win.subarray(j,j+2),k),k+=2,j+=2,B-=2);else{j=k-W;do j+=D.end;while(j<0);if(_=D.end-j,B>_){if(B-=_,k-j>0&&_>k-j)do D.win[k++]=D.win[j++];while(--_!==0);else D.win.set(D.win.subarray(j,j+_),k),k+=_,j+=_,_=0;j=0}}if(k-j>0&&B>k-j)do D.win[k++]=D.win[j++];while(--B!==0);else D.win.set(D.win.subarray(j,j+B),k),k+=B,j+=B,B=0;break}else if(!(_&64))P+=M[Q+2],P+=S&Cu[_],Q=(L+P)*3,_=M[Q];else return O.msg="invalid distance code",B=O.avail_in-N,B=w>>3<B?w>>3:B,N+=B,I-=B,w-=B<<3,D.bitb=S,D.bitk=w,O.avail_in=N,O.total_in+=I-O.next_in_index,O.next_in_index=I,D.write=k,-3;while(!0);break}if(_&64)return _&32?(B=O.avail_in-N,B=w>>3<B?w>>3:B,N+=B,I-=B,w-=B<<3,D.bitb=S,D.bitk=w,O.avail_in=N,O.total_in+=I-O.next_in_index,O.next_in_index=I,D.write=k,1):(O.msg="invalid literal/length code",B=O.avail_in-N,B=w>>3<B?w>>3:B,N+=B,I-=B,w-=B<<3,D.bitb=S,D.bitk=w,O.avail_in=N,O.total_in+=I-O.next_in_index,O.next_in_index=I,D.write=k,-3);if(P+=M[Q+2],P+=S&Cu[_],Q=(L+P)*3,(_=M[Q])===0){S>>=M[Q+1],w-=M[Q+1],D.win[k++]=M[Q+2],z--;break}}while(!0)}while(z>=258&&N>=10);return B=O.avail_in-N,B=w>>3<B?w>>3:B,N+=B,I-=B,w-=B<<3,D.bitb=S,D.bitk=w,O.avail_in=N,O.total_in+=I-O.next_in_index,O.next_in_index=I,D.write=k,0}e.init=function(b,C,A,T,E,v){t=m4,l=b,f=C,d=A,p=T,g=E,m=v,i=null},e.proc=function(b,C,A){let T,E,v,D=0,O=0,P=0,M,L,_,S;for(P=C.next_in_index,M=C.avail_in,D=b.bitb,O=b.bitk,L=b.write,_=L<b.read?b.read-L-1:b.end-L;;)switch(t){case m4:if(_>=258&&M>=10&&(b.bitb=D,b.bitk=O,C.avail_in=M,C.total_in+=P-C.next_in_index,C.next_in_index=P,b.write=L,A=y(l,f,d,p,g,m,b,C),P=C.next_in_index,M=C.avail_in,D=b.bitb,O=b.bitk,L=b.write,_=L<b.read?b.read-L-1:b.end-L,A!=0)){t=A==1?bq:p4;break}r=l,i=d,o=p,t=Xme;case Xme:for(T=r;O<T;){if(M!==0)A=0;else return b.bitb=D,b.bitk=O,C.avail_in=M,C.total_in+=P-C.next_in_index,C.next_in_index=P,b.write=L,b.inflate_flush(C,A);M--,D|=(C.read_byte(P++)&255)<<O,O+=8}if(E=(o+(D&Cu[T]))*3,D>>>=i[E+1],O-=i[E+1],v=i[E],v===0){s=i[E+2],t=Jme;break}if(v&16){a=v&15,n=i[E+2],t=Kme;break}if(!(v&64)){r=v,o=E/3+i[E+2];break}if(v&32){t=bq;break}return t=p4,C.msg="invalid literal/length code",A=-3,b.bitb=D,b.bitk=O,C.avail_in=M,C.total_in+=P-C.next_in_index,C.next_in_index=P,b.write=L,b.inflate_flush(C,A);case Kme:for(T=a;O<T;){if(M!==0)A=0;else return b.bitb=D,b.bitk=O,C.avail_in=M,C.total_in+=P-C.next_in_index,C.next_in_index=P,b.write=L,b.inflate_flush(C,A);M--,D|=(C.read_byte(P++)&255)<<O,O+=8}n+=D&Cu[T],D>>=T,O-=T,r=f,i=g,o=m,t=Zme;case Zme:for(T=r;O<T;){if(M!==0)A=0;else return b.bitb=D,b.bitk=O,C.avail_in=M,C.total_in+=P-C.next_in_index,C.next_in_index=P,b.write=L,b.inflate_flush(C,A);M--,D|=(C.read_byte(P++)&255)<<O,O+=8}if(E=(o+(D&Cu[T]))*3,D>>=i[E+1],O-=i[E+1],v=i[E],v&16){a=v&15,c=i[E+2],t=$me;break}if(!(v&64)){r=v,o=E/3+i[E+2];break}return t=p4,C.msg="invalid distance code",A=-3,b.bitb=D,b.bitk=O,C.avail_in=M,C.total_in+=P-C.next_in_index,C.next_in_index=P,b.write=L,b.inflate_flush(C,A);case $me:for(T=a;O<T;){if(M!==0)A=0;else return b.bitb=D,b.bitk=O,C.avail_in=M,C.total_in+=P-C.next_in_index,C.next_in_index=P,b.write=L,b.inflate_flush(C,A);M--,D|=(C.read_byte(P++)&255)<<O,O+=8}c+=D&Cu[T],D>>=T,O-=T,t=Qme;case Qme:for(S=L-c;S<0;)S+=b.end;for(;n!==0;){if(_===0&&(L==b.end&&b.read!==0&&(L=0,_=L<b.read?b.read-L-1:b.end-L),_===0&&(b.write=L,A=b.inflate_flush(C,A),L=b.write,_=L<b.read?b.read-L-1:b.end-L,L==b.end&&b.read!==0&&(L=0,_=L<b.read?b.read-L-1:b.end-L),_===0)))return b.bitb=D,b.bitk=O,C.avail_in=M,C.total_in+=P-C.next_in_index,C.next_in_index=P,b.write=L,b.inflate_flush(C,A);b.win[L++]=b.win[S++],_--,S==b.end&&(S=0),n--}t=m4;break;case Jme:if(_===0&&(L==b.end&&b.read!==0&&(L=0,_=L<b.read?b.read-L-1:b.end-L),_===0&&(b.write=L,A=b.inflate_flush(C,A),L=b.write,_=L<b.read?b.read-L-1:b.end-L,L==b.end&&b.read!==0&&(L=0,_=L<b.read?b.read-L-1:b.end-L),_===0)))return b.bitb=D,b.bitk=O,C.avail_in=M,C.total_in+=P-C.next_in_index,C.next_in_index=P,b.write=L,b.inflate_flush(C,A);A=0,b.win[L++]=s,_--,t=m4;break;case bq:if(O>7&&(O-=8,M++,P--),b.write=L,A=b.inflate_flush(C,A),L=b.write,_=L<b.read?b.read-L-1:b.end-L,b.read!=b.write)return b.bitb=D,b.bitk=O,C.avail_in=M,C.total_in+=P-C.next_in_index,C.next_in_index=P,b.write=L,b.inflate_flush(C,A);t=epe;case epe:return A=1,b.bitb=D,b.bitk=O,C.avail_in=M,C.total_in+=P-C.next_in_index,C.next_in_index=P,b.write=L,b.inflate_flush(C,A);case p4:return A=-3,b.bitb=D,b.bitk=O,C.avail_in=M,C.total_in+=P-C.next_in_index,C.next_in_index=P,b.write=L,b.inflate_flush(C,A);default:return A=-2,b.bitb=D,b.bitk=O,C.avail_in=M,C.total_in+=P-C.next_in_index,C.next_in_index=P,b.write=L,b.inflate_flush(C,A)}},e.free=function(){}}var tpe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],aE=0,Cq=1,npe=2,ipe=3,ope=4,rpe=5,_4=6,g4=7,spe=8,nb=9;function Jnt(e,t){let n=this,i=aE,o=0,r=0,s=0,a,c=[0],l=[0],f=new Qnt,d=0,p=new Int32Array(hpe*3),g=0,m=new Tq;n.bitk=0,n.bitb=0,n.win=new Uint8Array(t),n.end=t,n.read=0,n.write=0,n.reset=function(y,b){b&&(b[0]=g),i==_4&&f.free(y),i=aE,n.bitk=0,n.bitb=0,n.read=n.write=0},n.reset(e,null),n.inflate_flush=function(y,b){let C,A,T;return A=y.next_out_index,T=n.read,C=(T<=n.write?n.write:n.end)-T,C>y.avail_out&&(C=y.avail_out),C!==0&&b==-5&&(b=0),y.avail_out-=C,y.total_out+=C,y.next_out.set(n.win.subarray(T,T+C),A),A+=C,T+=C,T==n.end&&(T=0,n.write==n.end&&(n.write=0),C=n.write-T,C>y.avail_out&&(C=y.avail_out),C!==0&&b==-5&&(b=0),y.avail_out-=C,y.total_out+=C,y.next_out.set(n.win.subarray(T,T+C),A),A+=C,T+=C),y.next_out_index=A,n.read=T,b},n.proc=function(y,b){let C,A,T,E,v,D,O,P;for(E=y.next_in_index,v=y.avail_in,A=n.bitb,T=n.bitk,D=n.write,O=D<n.read?n.read-D-1:n.end-D;;){let M,L,_,S,w,I,N,k;switch(i){case aE:for(;T<3;){if(v!==0)b=0;else return n.bitb=A,n.bitk=T,y.avail_in=v,y.total_in+=E-y.next_in_index,y.next_in_index=E,n.write=D,n.inflate_flush(y,b);v--,A|=(y.read_byte(E++)&255)<<T,T+=8}switch(C=A&7,d=C&1,C>>>1){case 0:A>>>=3,T-=3,C=T&7,A>>>=C,T-=C,i=Cq;break;case 1:M=[],L=[],_=[[]],S=[[]],Tq.inflate_trees_fixed(M,L,_,S),f.init(M[0],L[0],_[0],0,S[0],0),A>>>=3,T-=3,i=_4;break;case 2:A>>>=3,T-=3,i=ipe;break;case 3:return A>>>=3,T-=3,i=nb,y.msg="invalid block type",b=-3,n.bitb=A,n.bitk=T,y.avail_in=v,y.total_in+=E-y.next_in_index,y.next_in_index=E,n.write=D,n.inflate_flush(y,b)}break;case Cq:for(;T<32;){if(v!==0)b=0;else return n.bitb=A,n.bitk=T,y.avail_in=v,y.total_in+=E-y.next_in_index,y.next_in_index=E,n.write=D,n.inflate_flush(y,b);v--,A|=(y.read_byte(E++)&255)<<T,T+=8}if((~A>>>16&65535)!=(A&65535))return i=nb,y.msg="invalid stored block lengths",b=-3,n.bitb=A,n.bitk=T,y.avail_in=v,y.total_in+=E-y.next_in_index,y.next_in_index=E,n.write=D,n.inflate_flush(y,b);o=A&65535,A=T=0,i=o!==0?npe:d!==0?g4:aE;break;case npe:if(v===0||O===0&&(D==n.end&&n.read!==0&&(D=0,O=D<n.read?n.read-D-1:n.end-D),O===0&&(n.write=D,b=n.inflate_flush(y,b),D=n.write,O=D<n.read?n.read-D-1:n.end-D,D==n.end&&n.read!==0&&(D=0,O=D<n.read?n.read-D-1:n.end-D),O===0)))return n.bitb=A,n.bitk=T,y.avail_in=v,y.total_in+=E-y.next_in_index,y.next_in_index=E,n.write=D,n.inflate_flush(y,b);if(b=0,C=o,C>v&&(C=v),C>O&&(C=O),n.win.set(y.read_buf(E,C),D),E+=C,v-=C,D+=C,O-=C,(o-=C)!==0)break;i=d!==0?g4:aE;break;case ipe:for(;T<14;){if(v!==0)b=0;else return n.bitb=A,n.bitk=T,y.avail_in=v,y.total_in+=E-y.next_in_index,y.next_in_index=E,n.write=D,n.inflate_flush(y,b);v--,A|=(y.read_byte(E++)&255)<<T,T+=8}if(r=C=A&16383,(C&31)>29||(C>>5&31)>29)return i=nb,y.msg="too many length or distance symbols",b=-3,n.bitb=A,n.bitk=T,y.avail_in=v,y.total_in+=E-y.next_in_index,y.next_in_index=E,n.write=D,n.inflate_flush(y,b);if(C=258+(C&31)+(C>>5&31),!a||a.length<C)a=[];else for(P=0;P<C;P++)a[P]=0;A>>>=14,T-=14,s=0,i=ope;case ope:for(;s<4+(r>>>10);){for(;T<3;){if(v!==0)b=0;else return n.bitb=A,n.bitk=T,y.avail_in=v,y.total_in+=E-y.next_in_index,y.next_in_index=E,n.write=D,n.inflate_flush(y,b);v--,A|=(y.read_byte(E++)&255)<<T,T+=8}a[tpe[s++]]=A&7,A>>>=3,T-=3}for(;s<19;)a[tpe[s++]]=0;if(c[0]=7,C=m.inflate_trees_bits(a,c,l,p,y),C!=0)return b=C,b==-3&&(a=null,i=nb),n.bitb=A,n.bitk=T,y.avail_in=v,y.total_in+=E-y.next_in_index,y.next_in_index=E,n.write=D,n.inflate_flush(y,b);s=0,i=rpe;case rpe:for(;C=r,!(s>=258+(C&31)+(C>>5&31));){let z,V;for(C=c[0];T<C;){if(v!==0)b=0;else return n.bitb=A,n.bitk=T,y.avail_in=v,y.total_in+=E-y.next_in_index,y.next_in_index=E,n.write=D,n.inflate_flush(y,b);v--,A|=(y.read_byte(E++)&255)<<T,T+=8}if(C=p[(l[0]+(A&Cu[C]))*3+1],V=p[(l[0]+(A&Cu[C]))*3+2],V<16)A>>>=C,T-=C,a[s++]=V;else{for(P=V==18?7:V-14,z=V==18?11:3;T<C+P;){if(v!==0)b=0;else return n.bitb=A,n.bitk=T,y.avail_in=v,y.total_in+=E-y.next_in_index,y.next_in_index=E,n.write=D,n.inflate_flush(y,b);v--,A|=(y.read_byte(E++)&255)<<T,T+=8}if(A>>>=C,T-=C,z+=A&Cu[P],A>>>=P,T-=P,P=s,C=r,P+z>258+(C&31)+(C>>5&31)||V==16&&P<1)return a=null,i=nb,y.msg="invalid bit length repeat",b=-3,n.bitb=A,n.bitk=T,y.avail_in=v,y.total_in+=E-y.next_in_index,y.next_in_index=E,n.write=D,n.inflate_flush(y,b);V=V==16?a[P-1]:0;do a[P++]=V;while(--z!==0);s=P}}if(l[0]=-1,w=[],I=[],N=[],k=[],w[0]=9,I[0]=6,C=r,C=m.inflate_trees_dynamic(257+(C&31),1+(C>>5&31),a,w,I,N,k,p,y),C!=0)return C==-3&&(a=null,i=nb),b=C,n.bitb=A,n.bitk=T,y.avail_in=v,y.total_in+=E-y.next_in_index,y.next_in_index=E,n.write=D,n.inflate_flush(y,b);f.init(w[0],I[0],p,N[0],p,k[0]),i=_4;case _4:if(n.bitb=A,n.bitk=T,y.avail_in=v,y.total_in+=E-y.next_in_index,y.next_in_index=E,n.write=D,(b=f.proc(n,y,b))!=1)return n.inflate_flush(y,b);if(b=0,f.free(y),E=y.next_in_index,v=y.avail_in,A=n.bitb,T=n.bitk,D=n.write,O=D<n.read?n.read-D-1:n.end-D,d===0){i=aE;break}i=g4;case g4:if(n.write=D,b=n.inflate_flush(y,b),D=n.write,O=D<n.read?n.read-D-1:n.end-D,n.read!=n.write)return n.bitb=A,n.bitk=T,y.avail_in=v,y.total_in+=E-y.next_in_index,y.next_in_index=E,n.write=D,n.inflate_flush(y,b);i=spe;case spe:return b=1,n.bitb=A,n.bitk=T,y.avail_in=v,y.total_in+=E-y.next_in_index,y.next_in_index=E,n.write=D,n.inflate_flush(y,b);case nb:return b=-3,n.bitb=A,n.bitk=T,y.avail_in=v,y.total_in+=E-y.next_in_index,y.next_in_index=E,n.write=D,n.inflate_flush(y,b);default:return b=-2,n.bitb=A,n.bitk=T,y.avail_in=v,y.total_in+=E-y.next_in_index,y.next_in_index=E,n.write=D,n.inflate_flush(y,b)}}},n.free=function(y){n.reset(y,null),n.win=null,p=null},n.set_dictionary=function(y,b,C){n.win.set(y.subarray(b,b+C),0),n.read=n.write=C},n.sync_point=function(){return i==Cq?1:0}}var eit=32,tit=8,nit=0,ape=1,cpe=2,lpe=3,upe=4,fpe=5,Aq=6,Y1=7,dpe=12,A0=13,iit=[0,0,255,255];function oit(){let e=this;e.mode=0,e.method=0,e.was=[0],e.need=0,e.marker=0,e.wbits=0;function t(n){return!n||!n.istate?-2:(n.total_in=n.total_out=0,n.msg=null,n.istate.mode=Y1,n.istate.blocks.reset(n,null),0)}e.inflateEnd=function(n){return e.blocks&&e.blocks.free(n),e.blocks=null,0},e.inflateInit=function(n,i){return n.msg=null,e.blocks=null,i<8||i>15?(e.inflateEnd(n),-2):(e.wbits=i,n.istate.blocks=new Jnt(n,1<<i),t(n),0)},e.inflate=function(n,i){let o,r;if(!n||!n.istate||!n.next_in)return-2;let s=n.istate;for(i=i==Gnt?-5:0,o=-5;;)switch(s.mode){case nit:if(n.avail_in===0)return o;if(o=i,n.avail_in--,n.total_in++,((s.method=n.read_byte(n.next_in_index++))&15)!=tit){s.mode=A0,n.msg="unknown compression method",s.marker=5;break}if((s.method>>4)+8>s.wbits){s.mode=A0,n.msg="invalid win size",s.marker=5;break}s.mode=ape;case ape:if(n.avail_in===0)return o;if(o=i,n.avail_in--,n.total_in++,r=n.read_byte(n.next_in_index++)&255,((s.method<<8)+r)%31!==0){s.mode=A0,n.msg="incorrect header check",s.marker=5;break}if(!(r&eit)){s.mode=Y1;break}s.mode=cpe;case cpe:if(n.avail_in===0)return o;o=i,n.avail_in--,n.total_in++,s.need=(n.read_byte(n.next_in_index++)&255)<<24&4278190080,s.mode=lpe;case lpe:if(n.avail_in===0)return o;o=i,n.avail_in--,n.total_in++,s.need+=(n.read_byte(n.next_in_index++)&255)<<16&16711680,s.mode=upe;case upe:if(n.avail_in===0)return o;o=i,n.avail_in--,n.total_in++,s.need+=(n.read_byte(n.next_in_index++)&255)<<8&65280,s.mode=fpe;case fpe:return n.avail_in===0?o:(o=i,n.avail_in--,n.total_in++,s.need+=n.read_byte(n.next_in_index++)&255,s.mode=Aq,2);case Aq:return s.mode=A0,n.msg="need dictionary",s.marker=0,-2;case Y1:if(o=s.blocks.proc(n,o),o==-3){s.mode=A0,s.marker=0;break}if(o==0&&(o=i),o!=1)return o;o=i,s.blocks.reset(n,s.was),s.mode=dpe;case dpe:return n.avail_in=0,1;case A0:return-3;default:return-2}},e.inflateSetDictionary=function(n,i,o){let r=0,s=o;if(!n||!n.istate||n.istate.mode!=Aq)return-2;let a=n.istate;return s>=1<<a.wbits&&(s=(1<<a.wbits)-1,r=o-s),a.blocks.set_dictionary(i,r,s),a.mode=Y1,0},e.inflateSync=function(n){let i,o,r,s,a;if(!n||!n.istate)return-2;let c=n.istate;if(c.mode!=A0&&(c.mode=A0,c.marker=0),(i=n.avail_in)===0)return-5;for(o=n.next_in_index,r=c.marker;i!==0&&r<4;)n.read_byte(o)==iit[r]?r++:n.read_byte(o)!==0?r=0:r=4-r,o++,i--;return n.total_in+=o-n.next_in_index,n.next_in_index=o,n.avail_in=i,c.marker=r,r!=4?-3:(s=n.total_in,a=n.total_out,t(n),n.total_in=s,n.total_out=a,c.mode=Y1,0)},e.inflateSyncPoint=function(n){return!n||!n.istate||!n.istate.blocks?-2:n.istate.blocks.sync_point()}}function mpe(){}mpe.prototype={inflateInit(e){let t=this;return t.istate=new oit,e||(e=15),t.istate.inflateInit(t,e)},inflate(e){let t=this;return t.istate?t.istate.inflate(t,e):-2},inflateEnd(){let e=this;if(!e.istate)return-2;let t=e.istate.inflateEnd(e);return e.istate=null,t},inflateSync(){let e=this;return e.istate?e.istate.inflateSync(e):-2},inflateSetDictionary(e,t){let n=this;return n.istate?n.istate.inflateSetDictionary(n,e,t):-2},read_byte(e){return this.next_in[e]},read_buf(e,t){return this.next_in.subarray(e,e+t)}};function ppe(e){let t=this,n=new mpe,i=e&&e.chunkSize?Math.floor(e.chunkSize*2):128*1024,o=Hnt,r=new Uint8Array(i),s=!1;n.inflateInit(),n.next_out=r,t.append=function(a,c){let l=[],f,d,p=0,g=0,m=0;if(a.length!==0){n.next_in_index=0,n.next_in=a,n.avail_in=a.length;do{if(n.next_out_index=0,n.avail_out=i,n.avail_in===0&&!s&&(n.next_in_index=0,s=!0),f=n.inflate(o),s&&f===-5){if(n.avail_in!==0)throw new Error("inflating: bad input")}else if(f!==0&&f!==1)throw new Error("inflating: "+n.msg);if((s||f===1)&&n.avail_in===a.length)throw new Error("inflating: bad input");n.next_out_index&&(n.next_out_index===i?l.push(new Uint8Array(r)):l.push(r.subarray(0,n.next_out_index))),m+=n.next_out_index,c&&n.next_in_index>0&&n.next_in_index!=p&&(c(n.next_in_index),p=n.next_in_index)}while(n.avail_in>0||n.avail_out===0);return l.length>1?(d=new Uint8Array(m),l.forEach(function(y){d.set(y,g),g+=y.length})):d=l[0]?new Uint8Array(l[0]):new Uint8Array,d}},t.flush=function(){n.inflateEnd()}}var cE="/",Eq=new Date(2107,11,31),Sq=new Date(1980,0,1),Di=void 0,Au="undefined",r_="function";var X1=class{constructor(t){return class extends TransformStream{constructor(n,i){let o=new t(i);super({transform(r,s){s.enqueue(o.append(r))},flush(r){let s=o.flush();s&&r.enqueue(s)}})}}}};var rit=64,_pe=2;try{typeof navigator!=Au&&navigator.hardwareConcurrency&&(_pe=navigator.hardwareConcurrency)}catch{}var sit={chunkSize:512*1024,maxWorkers:_pe,terminateWorkerTimeout:5e3,useWebWorkers:!0,useCompressionStream:!0,workerScripts:Di,CompressionStreamNative:typeof CompressionStream!=Au&&CompressionStream,DecompressionStreamNative:typeof DecompressionStream!=Au&&DecompressionStream},E0=Object.assign({},sit);function K1(){return E0}function y4(e){return Math.max(e.chunkSize,rit)}function lE(e){let{baseURL:t,chunkSize:n,maxWorkers:i,terminateWorkerTimeout:o,useCompressionStream:r,useWebWorkers:s,Deflate:a,Inflate:c,CompressionStream:l,DecompressionStream:f,workerScripts:d}=e;if(T0("baseURL",t),T0("chunkSize",n),T0("maxWorkers",i),T0("terminateWorkerTimeout",o),T0("useCompressionStream",r),T0("useWebWorkers",s),a&&(E0.CompressionStream=new X1(a)),c&&(E0.DecompressionStream=new X1(c)),T0("CompressionStream",l),T0("DecompressionStream",f),d!==Di){let{deflate:p,inflate:g}=d;if((p||g)&&(E0.workerScripts||(E0.workerScripts={})),p){if(!Array.isArray(p))throw new Error("workerScripts.deflate must be an array");E0.workerScripts.deflate=p}if(g){if(!Array.isArray(g))throw new Error("workerScripts.inflate must be an array");E0.workerScripts.inflate=g}}}function T0(e,t){t!==Di&&(E0[e]=t)}var gpe=[];for(let e=0;e<256;e++){let t=e;for(let n=0;n<8;n++)t&1?t=t>>>1^3988292384:t=t>>>1;gpe[e]=t}var s_=class{constructor(t){this.crc=t||-1}append(t){let n=this.crc|0;for(let i=0,o=t.length|0;i<o;i++)n=n>>>8^gpe[(n^t[i])&255];this.crc=n}get(){return~this.crc}};var Z1=class extends TransformStream{constructor(){let t,n=new s_;super({transform(i,o){n.append(i),o.enqueue(i)},flush(){let i=new Uint8Array(4);new DataView(i.buffer).setUint32(0,n.get()),t.value=i}}),t=this}};function uE(e){if(typeof TextEncoder==Au){e=unescape(encodeURIComponent(e));let t=new Uint8Array(e.length);for(let n=0;n<t.length;n++)t[n]=e.charCodeAt(n);return t}else return new TextEncoder().encode(e)}var Yc={concat(e,t){if(e.length===0||t.length===0)return e.concat(t);let n=e[e.length-1],i=Yc.getPartial(n);return i===32?e.concat(t):Yc._shiftRight(t,i,n|0,e.slice(0,e.length-1))},bitLength(e){let t=e.length;if(t===0)return 0;let n=e[t-1];return(t-1)*32+Yc.getPartial(n)},clamp(e,t){if(e.length*32<t)return e;e=e.slice(0,Math.ceil(t/32));let n=e.length;return t=t&31,n>0&&t&&(e[n-1]=Yc.partial(t,e[n-1]&2147483648>>t-1,1)),e},partial(e,t,n){return e===32?t:(n?t|0:t<<32-e)+e*1099511627776},getPartial(e){return Math.round(e/1099511627776)||32},_shiftRight(e,t,n,i){for(i===void 0&&(i=[]);t>=32;t-=32)i.push(n),n=0;if(t===0)return i.concat(e);for(let s=0;s<e.length;s++)i.push(n|e[s]>>>t),n=e[s]<<32-t;let o=e.length?e[e.length-1]:0,r=Yc.getPartial(o);return i.push(Yc.partial(t+r&31,t+r>32?n:i.pop(),1)),i}},$1={bytes:{fromBits(e){let n=Yc.bitLength(e)/8,i=new Uint8Array(n),o;for(let r=0;r<n;r++)r&3||(o=e[r/4]),i[r]=o>>>24,o<<=8;return i},toBits(e){let t=[],n,i=0;for(n=0;n<e.length;n++)i=i<<8|e[n],(n&3)===3&&(t.push(i),i=0);return n&3&&t.push(Yc.partial(8*(n&3),i)),t}}},ype={};ype.sha1=class{constructor(e){let t=this;t.blockSize=512,t._init=[1732584193,4023233417,2562383102,271733878,3285377520],t._key=[1518500249,1859775393,2400959708,3395469782],e?(t._h=e._h.slice(0),t._buffer=e._buffer.slice(0),t._length=e._length):t.reset()}reset(){let e=this;return e._h=e._init.slice(0),e._buffer=[],e._length=0,e}update(e){let t=this;typeof e=="string"&&(e=$1.utf8String.toBits(e));let n=t._buffer=Yc.concat(t._buffer,e),i=t._length,o=t._length=i+Yc.bitLength(e);if(o>9007199254740991)throw new Error("Cannot hash more than 2^53 - 1 bits");let r=new Uint32Array(n),s=0;for(let a=t.blockSize+i-(t.blockSize+i&t.blockSize-1);a<=o;a+=t.blockSize)t._block(r.subarray(16*s,16*(s+1))),s+=1;return n.splice(0,16*s),t}finalize(){let e=this,t=e._buffer,n=e._h;t=Yc.concat(t,[Yc.partial(1,1)]);for(let i=t.length+2;i&15;i++)t.push(0);for(t.push(Math.floor(e._length/4294967296)),t.push(e._length|0);t.length;)e._block(t.splice(0,16));return e.reset(),n}_f(e,t,n,i){if(e<=19)return t&n|~t&i;if(e<=39)return t^n^i;if(e<=59)return t&n|t&i|n&i;if(e<=79)return t^n^i}_S(e,t){return t<<e|t>>>32-e}_block(e){let t=this,n=t._h,i=Array(80);for(let l=0;l<16;l++)i[l]=e[l];let o=n[0],r=n[1],s=n[2],a=n[3],c=n[4];for(let l=0;l<=79;l++){l>=16&&(i[l]=t._S(1,i[l-3]^i[l-8]^i[l-14]^i[l-16]));let f=t._S(5,o)+t._f(l,r,s,a)+c+i[l]+t._key[Math.floor(l/20)]|0;c=a,a=s,s=t._S(30,r),r=o,o=f}n[0]=n[0]+o|0,n[1]=n[1]+r|0,n[2]=n[2]+s|0,n[3]=n[3]+a|0,n[4]=n[4]+c|0}};var vq={};vq.aes=class{constructor(e){let t=this;t._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],t._tables[0][0][0]||t._precompute();let n=t._tables[0][4],i=t._tables[1],o=e.length,r,s,a,c=1;if(o!==4&&o!==6&&o!==8)throw new Error("invalid aes key size");for(t._key=[s=e.slice(0),a=[]],r=o;r<4*o+28;r++){let l=s[r-1];(r%o===0||o===8&&r%o===4)&&(l=n[l>>>24]<<24^n[l>>16&255]<<16^n[l>>8&255]<<8^n[l&255],r%o===0&&(l=l<<8^l>>>24^c<<24,c=c<<1^(c>>7)*283)),s[r]=s[r-o]^l}for(let l=0;r;l++,r--){let f=s[l&3?r:r-4];r<=4||l<4?a[l]=f:a[l]=i[0][n[f>>>24]]^i[1][n[f>>16&255]]^i[2][n[f>>8&255]]^i[3][n[f&255]]}}encrypt(e){return this._crypt(e,0)}decrypt(e){return this._crypt(e,1)}_precompute(){let e=this._tables[0],t=this._tables[1],n=e[4],i=t[4],o=[],r=[],s,a,c,l;for(let f=0;f<256;f++)r[(o[f]=f<<1^(f>>7)*283)^f]=f;for(let f=s=0;!n[f];f^=a||1,s=r[s]||1){let d=s^s<<1^s<<2^s<<3^s<<4;d=d>>8^d&255^99,n[f]=d,i[d]=f,l=o[c=o[a=o[f]]];let p=l*16843009^c*65537^a*257^f*16843008,g=o[d]*257^d*16843008;for(let m=0;m<4;m++)e[m][f]=g=g<<24^g>>>8,t[m][d]=p=p<<24^p>>>8}for(let f=0;f<5;f++)e[f]=e[f].slice(0),t[f]=t[f].slice(0)}_crypt(e,t){if(e.length!==4)throw new Error("invalid aes block size");let n=this._key[t],i=n.length/4-2,o=[0,0,0,0],r=this._tables[t],s=r[0],a=r[1],c=r[2],l=r[3],f=r[4],d=e[0]^n[0],p=e[t?3:1]^n[1],g=e[2]^n[2],m=e[t?1:3]^n[3],y=4,b,C,A;for(let T=0;T<i;T++)b=s[d>>>24]^a[p>>16&255]^c[g>>8&255]^l[m&255]^n[y],C=s[p>>>24]^a[g>>16&255]^c[m>>8&255]^l[d&255]^n[y+1],A=s[g>>>24]^a[m>>16&255]^c[d>>8&255]^l[p&255]^n[y+2],m=s[m>>>24]^a[d>>16&255]^c[p>>8&255]^l[g&255]^n[y+3],y+=4,d=b,p=C,g=A;for(let T=0;T<4;T++)o[t?3&-T:T]=f[d>>>24]<<24^f[p>>16&255]<<16^f[g>>8&255]<<8^f[m&255]^n[y++],b=d,d=p,p=g,g=m,m=b;return o}};var xpe={getRandomValues(e){let t=new Uint32Array(e.buffer),n=i=>{let o=987654321,r=4294967295;return function(){return o=36969*(o&65535)+(o>>16)&r,i=18e3*(i&65535)+(i>>16)&r,(((o<<16)+i&r)/4294967296+.5)*(Math.random()>.5?1:-1)}};for(let i=0,o;i<e.length;i+=4){let r=n((o||Math.random())*4294967296);o=r()*987654071,t[i/4]=r()*4294967296|0}return e}},wq={};wq.ctrGladman=class{constructor(e,t){this._prf=e,this._initIv=t,this._iv=t}reset(){this._iv=this._initIv}update(e){return this.calculate(this._prf,e,this._iv)}incWord(e){if((e>>24&255)===255){let t=e>>16&255,n=e>>8&255,i=e&255;t===255?(t=0,n===255?(n=0,i===255?i=0:++i):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=i}else e+=1<<24;return e}incCounter(e){(e[0]=this.incWord(e[0]))===0&&(e[1]=this.incWord(e[1]))}calculate(e,t,n){let i;if(!(i=t.length))return[];let o=Yc.bitLength(t);for(let r=0;r<i;r+=4){this.incCounter(n);let s=e.encrypt(n);t[r]^=s[0],t[r+1]^=s[1],t[r+2]^=s[2],t[r+3]^=s[3]}return Yc.clamp(t,o)}};var S0={importKey(e){return new S0.hmacSha1($1.bytes.toBits(e))},pbkdf2(e,t,n,i){if(n=n||1e4,i<0||n<0)throw new Error("invalid params to pbkdf2");let o=(i>>5)+1<<2,r,s,a,c,l,f=new ArrayBuffer(o),d=new DataView(f),p=0,g=Yc;for(t=$1.bytes.toBits(t),l=1;p<(o||1);l++){for(r=s=e.encrypt(g.concat(t,[l])),a=1;a<n;a++)for(s=e.encrypt(s),c=0;c<s.length;c++)r[c]^=s[c];for(a=0;p<(o||1)&&a<r.length;a++)d.setInt32(p,r[a]),p+=4}return f.slice(0,i/8)}};S0.hmacSha1=class{constructor(e){let t=this,n=t._hash=ype.sha1,i=[[],[]];t._baseHash=[new n,new n];let o=t._baseHash[0].blockSize/32;e.length>o&&(e=new n().update(e).finalize());for(let r=0;r<o;r++)i[0][r]=e[r]^909522486,i[1][r]=e[r]^1549556828;t._baseHash[0].update(i[0]),t._baseHash[1].update(i[1]),t._resultHash=new n(t._baseHash[0])}reset(){let e=this;e._resultHash=new e._hash(e._baseHash[0]),e._updated=!1}update(e){let t=this;t._updated=!0,t._resultHash.update(e)}digest(){let e=this,t=e._resultHash.finalize(),n=new e._hash(e._baseHash[1]).update(t).finalize();return e.reset(),n}encrypt(e){if(this._updated)throw new Error("encrypt on already updated hmac called!");return this.update(e),this.digest(e)}};var ait=typeof crypto!=Au&&typeof crypto.getRandomValues==r_,v0="Invalid password",ib="Invalid signature",a_="zipjs-abort-check-password";function x4(e){return ait?crypto.getRandomValues(e):xpe.getRandomValues(e)}var fE=16,cit="raw",Ape={name:"PBKDF2"},lit={name:"HMAC"},uit="SHA-1",fit=Object.assign({hash:lit},Ape),Dq=Object.assign({iterations:1e3,hash:{name:uit}},Ape),dit=["deriveBits"],J1=[8,12,16],Q1=[16,24,32],w0=10,hit=[0,0,0,0],A4=typeof crypto!=Au,nD=A4&&crypto.subtle,Tpe=A4&&typeof nD!=Au,ym=$1.bytes,mit=vq.aes,pit=wq.ctrGladman,_it=S0.hmacSha1,bpe=A4&&Tpe&&typeof nD.importKey==r_,Cpe=A4&&Tpe&&typeof nD.deriveBits==r_,b4=class extends TransformStream{constructor({password:t,rawPassword:n,signed:i,encryptionStrength:o,checkPasswordOnly:r}){super({start(){Object.assign(this,{ready:new Promise(s=>this.resolveReady=s),password:vpe(t,n),signed:i,strength:o-1,pending:new Uint8Array})},async transform(s,a){let c=this,{password:l,strength:f,resolveReady:d,ready:p}=c;l?(await git(c,f,l,zf(s,0,J1[f]+2)),s=zf(s,J1[f]+2),r?a.error(new Error(a_)):d()):await p;let g=new Uint8Array(s.length-w0-(s.length-w0)%fE);a.enqueue(Epe(c,s,g,0,w0,!0))},async flush(s){let{signed:a,ctr:c,hmac:l,pending:f,ready:d}=this;if(l&&c){await d;let p=zf(f,0,f.length-w0),g=zf(f,f.length-w0),m=new Uint8Array;if(p.length){let y=tD(ym,p);l.update(y);let b=c.update(y);m=eD(ym,b)}if(a){let y=zf(eD(ym,l.digest()),0,w0);for(let b=0;b<w0;b++)if(y[b]!=g[b])throw new Error(ib)}s.enqueue(m)}}})}},C4=class extends TransformStream{constructor({password:t,rawPassword:n,encryptionStrength:i}){let o;super({start(){Object.assign(this,{ready:new Promise(r=>this.resolveReady=r),password:vpe(t,n),strength:i-1,pending:new Uint8Array})},async transform(r,s){let a=this,{password:c,strength:l,resolveReady:f,ready:d}=a,p=new Uint8Array;c?(p=await yit(a,l,c),f()):await d;let g=new Uint8Array(p.length+r.length-r.length%fE);g.set(p,0),s.enqueue(Epe(a,r,g,p.length,0))},async flush(r){let{ctr:s,hmac:a,pending:c,ready:l}=this;if(a&&s){await l;let f=new Uint8Array;if(c.length){let d=s.update(tD(ym,c));a.update(d),f=eD(ym,d)}o.signature=eD(ym,a.digest()).slice(0,w0),r.enqueue(Iq(f,o.signature))}}}),o=this}};function Epe(e,t,n,i,o,r){let{ctr:s,hmac:a,pending:c}=e,l=t.length-o;c.length&&(t=Iq(c,t),n=Cit(n,l-l%fE));let f;for(f=0;f<=l-fE;f+=fE){let d=tD(ym,zf(t,f,f+fE));r&&a.update(d);let p=s.update(d);r||a.update(p),n.set(eD(ym,p),f+i)}return e.pending=zf(t,f),n}async function git(e,t,n,i){let o=await Spe(e,t,n,zf(i,0,J1[t])),r=zf(i,J1[t]);if(o[0]!=r[0]||o[1]!=r[1])throw new Error(v0)}async function yit(e,t,n){let i=x4(new Uint8Array(J1[t])),o=await Spe(e,t,n,i);return Iq(i,o)}async function Spe(e,t,n,i){e.password=null;let o=await xit(cit,n,fit,!1,dit),r=await bit(Object.assign({salt:i},Dq),o,8*(Q1[t]*2+2)),s=new Uint8Array(r),a=tD(ym,zf(s,0,Q1[t])),c=tD(ym,zf(s,Q1[t],Q1[t]*2)),l=zf(s,Q1[t]*2);return Object.assign(e,{keys:{key:a,authentication:c,passwordVerification:l},ctr:new pit(new mit(a),Array.from(hit)),hmac:new _it(c)}),l}async function xit(e,t,n,i,o){if(bpe)try{return await nD.importKey(e,t,n,i,o)}catch{return bpe=!1,S0.importKey(t)}else return S0.importKey(t)}async function bit(e,t,n){if(Cpe)try{return await nD.deriveBits(e,t,n)}catch{return Cpe=!1,S0.pbkdf2(t,e.salt,Dq.iterations,n)}else return S0.pbkdf2(t,e.salt,Dq.iterations,n)}function vpe(e,t){return t===Di?uE(e):t}function Iq(e,t){let n=e;return e.length+t.length&&(n=new Uint8Array(e.length+t.length),n.set(e,0),n.set(t,e.length)),n}function Cit(e,t){if(t&&t>e.length){let n=e;e=new Uint8Array(t),e.set(n,0)}return e}function zf(e,t,n){return e.subarray(t,n)}function eD(e,t){return e.fromBits(t)}function tD(e,t){return e.toBits(t)}var dE=12,T4=class extends TransformStream{constructor({password:t,passwordVerification:n,checkPasswordOnly:i}){super({start(){Object.assign(this,{password:t,passwordVerification:n}),Ppe(this,t)},transform(o,r){let s=this;if(s.password){let a=wpe(s,o.subarray(0,dE));if(s.password=null,a[dE-1]!=s.passwordVerification)throw new Error(v0);o=o.subarray(dE)}i?r.error(new Error(a_)):r.enqueue(wpe(s,o))}})}},E4=class extends TransformStream{constructor({password:t,passwordVerification:n}){super({start(){Object.assign(this,{password:t,passwordVerification:n}),Ppe(this,t)},transform(i,o){let r=this,s,a;if(r.password){r.password=null;let c=x4(new Uint8Array(dE));c[dE-1]=r.passwordVerification,s=new Uint8Array(i.length+c.length),s.set(Dpe(r,c),0),a=dE}else s=new Uint8Array(i.length),a=0;s.set(Dpe(r,i),a),o.enqueue(s)}})}};function wpe(e,t){let n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=Rpe(e)^t[i],Pq(e,n[i]);return n}function Dpe(e,t){let n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=Rpe(e)^t[i],Pq(e,t[i]);return n}function Ppe(e,t){let n=[305419896,591751049,878082192];Object.assign(e,{keys:n,crcKey0:new s_(n[0]),crcKey2:new s_(n[2])});for(let i=0;i<t.length;i++)Pq(e,t.charCodeAt(i))}function Pq(e,t){let[n,i,o]=e.keys;e.crcKey0.append([t]),n=~e.crcKey0.get(),i=Ipe(Math.imul(Ipe(i+Ope(n)),134775813)+1),e.crcKey2.append([i>>>24]),o=~e.crcKey2.get(),e.keys=[n,i,o]}function Rpe(e){let t=e.keys[2]|2;return Ope(Math.imul(t,t^1)>>>8)}function Ope(e){return e&255}function Ipe(e){return e&4294967295}var Mpe="deflate-raw",S4=class extends TransformStream{constructor(t,{chunkSize:n,CompressionStream:i,CompressionStreamNative:o}){super({});let{compressed:r,encrypted:s,useCompressionStream:a,zipCrypto:c,signed:l,level:f}=t,d=this,p,g,m=Lpe(super.readable);(!s||c)&&l&&(p=new Z1,m=xm(m,p)),r&&(m=Fpe(m,a,{level:f,chunkSize:n},o,i)),s&&(c?m=xm(m,new E4(t)):(g=new C4(t),m=xm(m,g))),Npe(d,m,()=>{let y;s&&!c&&(y=g.signature),(!s||c)&&l&&(y=new DataView(p.value.buffer).getUint32(0)),d.signature=y})}},v4=class extends TransformStream{constructor(t,{chunkSize:n,DecompressionStream:i,DecompressionStreamNative:o}){super({});let{zipCrypto:r,encrypted:s,signed:a,signature:c,compressed:l,useCompressionStream:f}=t,d,p,g=Lpe(super.readable);s&&(r?g=xm(g,new T4(t)):(p=new b4(t),g=xm(g,p))),l&&(g=Fpe(g,f,{chunkSize:n},o,i)),(!s||r)&&a&&(d=new Z1,g=xm(g,d)),Npe(this,g,()=>{if((!s||r)&&a){let m=new DataView(d.value.buffer);if(c!=m.getUint32(0,!1))throw new Error(ib)}})}};function Lpe(e){return xm(e,new TransformStream({transform(t,n){t&&t.length&&n.enqueue(t)}}))}function Npe(e,t,n){t=xm(t,new TransformStream({flush:n})),Object.defineProperty(e,"readable",{get(){return t}})}function Fpe(e,t,n,i,o){try{let r=t&&i?i:o;e=xm(e,new r(Mpe,n))}catch{if(t)try{e=xm(e,new o(Mpe,n))}catch{return e}else return e}return e}function xm(e,t){return e.pipeThrough(t)}var Bpe="message",kpe="start",Vpe="pull",Rq="data",Upe="ack",Oq="close",I4="deflate",P4="inflate";var w4=class extends TransformStream{constructor(t,n){super({});let i=this,{codecType:o}=t,r;o.startsWith(I4)?r=S4:o.startsWith(P4)&&(r=v4);let s=0,a=0,c=new r(t,n),l=super.readable,f=new TransformStream({transform(p,g){p&&p.length&&(a+=p.length,g.enqueue(p))},flush(){Object.assign(i,{inputSize:a})}}),d=new TransformStream({transform(p,g){p&&p.length&&(s+=p.length,g.enqueue(p))},flush(){let{signature:p}=c;Object.assign(i,{signature:p,outputSize:s,inputSize:a})}});Object.defineProperty(i,"readable",{get(){return l.pipeThrough(f).pipeThrough(c).pipeThrough(d)}})}},D4=class extends TransformStream{constructor(t){let n;super({transform:i,flush(o){n&&n.length&&o.enqueue(n)}});function i(o,r){if(n){let s=new Uint8Array(n.length+o.length);s.set(n),s.set(o,n.length),o=s,n=null}o.length>t?(r.enqueue(o.slice(0,t)),i(o.slice(t),r)):n=o}}};var Gpe=typeof Worker!=Au;var hE=class{constructor(t,{readable:n,writable:i},{options:o,config:r,streamOptions:s,useWebWorkers:a,transferStreams:c,scripts:l},f){let{signal:d}=s;return Object.assign(t,{busy:!0,readable:n.pipeThrough(new D4(r.chunkSize)).pipeThrough(new Lq(n,s),{signal:d}),writable:i,options:Object.assign({},o),scripts:l,transferStreams:c,terminate(){return new Promise(p=>{let{worker:g,busy:m}=t;g?(m?t.resolveTerminated=p:(g.terminate(),p()),t.interface=null):p()})},onTaskFinished(){let{resolveTerminated:p}=t;p&&(t.resolveTerminated=null,t.terminated=!0,t.worker.terminate(),p()),t.busy=!1,f(t)}}),(a&&Gpe?Ait:Wpe)(t,r)}},Lq=class extends TransformStream{constructor(t,{onstart:n,onprogress:i,size:o,onend:r}){let s=0;super({async start(){n&&await Mq(n,o)},async transform(a,c){s+=a.length,i&&await Mq(i,s,o),c.enqueue(a)},async flush(){t.size=s,r&&await Mq(r,s)}})}};async function Mq(e,...t){try{await e(...t)}catch{}}function Wpe(e,t){return{run:()=>Tit(e,t)}}function Ait(e,t){let{baseURL:n,chunkSize:i}=t;if(!e.interface){let o;try{o=vit(e.scripts[0],n,e)}catch{return Gpe=!1,Wpe(e,t)}Object.assign(e,{worker:o,interface:{run:()=>Eit(e,{chunkSize:i})}})}return e.interface}async function Tit({options:e,readable:t,writable:n,onTaskFinished:i},o){try{let r=new w4(e,o);await t.pipeThrough(r).pipeTo(n,{preventClose:!0,preventAbort:!0});let{signature:s,inputSize:a,outputSize:c}=r;return{signature:s,inputSize:a,outputSize:c}}finally{i()}}async function Eit(e,t){let n,i,o=new Promise((p,g)=>{n=p,i=g});Object.assign(e,{reader:null,writer:null,resolveResult:n,rejectResult:i,result:o});let{readable:r,options:s,scripts:a}=e,{writable:c,closed:l}=Sit(e.writable),f=R4({type:kpe,scripts:a.slice(1),options:s,config:t,readable:r,writable:c},e);f||Object.assign(e,{reader:r.getReader(),writer:c.getWriter()});let d=await o;return f||await c.getWriter().close(),await l,d}function Sit(e){let t,n=new Promise(o=>t=o);return{writable:new WritableStream({async write(o){let r=e.getWriter();await r.ready,await r.write(o),r.releaseLock()},close(){t()},abort(o){return e.getWriter().abort(o)}}),closed:n}}var zpe=!0,Hpe=!0;function vit(e,t,n){let i={type:"module"},o,r;typeof e==r_&&(e=e());try{o=new URL(e,t)}catch{o=e}if(zpe)try{r=new Worker(o)}catch{zpe=!1,r=new Worker(o,i)}else r=new Worker(o,i);return r.addEventListener(Bpe,s=>wit(s,n)),r}function R4(e,{worker:t,writer:n,onTaskFinished:i,transferStreams:o}){try{let{value:r,readable:s,writable:a}=e,c=[];if(r&&(r.byteLength<r.buffer.byteLength?e.value=r.buffer.slice(0,r.byteLength):e.value=r.buffer,c.push(e.value)),o&&Hpe?(s&&c.push(s),a&&c.push(a)):e.readable=e.writable=null,c.length)try{return t.postMessage(e,c),!0}catch{Hpe=!1,e.readable=e.writable=null,t.postMessage(e)}else t.postMessage(e)}catch(r){throw n&&n.releaseLock(),i(),r}}async function wit({data:e},t){let{type:n,value:i,messageId:o,result:r,error:s}=e,{reader:a,writer:c,resolveResult:l,rejectResult:f,onTaskFinished:d}=t;try{if(s){let{message:g,stack:m,code:y,name:b}=s,C=new Error(g);Object.assign(C,{stack:m,code:y,name:b}),p(C)}else{if(n==Vpe){let{value:g,done:m}=await a.read();R4({type:Rq,value:g,done:m,messageId:o},t)}n==Rq&&(await c.ready,await c.write(new Uint8Array(i)),R4({type:Upe,messageId:o},t)),n==Oq&&p(null,r)}}catch(g){R4({type:Oq,messageId:o},t),p(g)}function p(g,m){g?f(g):l(m),c&&c.releaseLock(),d()}}var ob=[],Nq=[];var jpe=0;async function O4(e,t){let{options:n,config:i}=t,{transferStreams:o,useWebWorkers:r,useCompressionStream:s,codecType:a,compressed:c,signed:l,encrypted:f}=n,{workerScripts:d,maxWorkers:p}=i;t.transferStreams=o||o===Di;let g=!c&&!l&&!f&&!t.transferStreams;return t.useWebWorkers=!g&&(r||r===Di&&i.useWebWorkers),t.scripts=t.useWebWorkers&&d?d[a]:[],n.useCompressionStream=s||s===Di&&i.useCompressionStream,(await m()).run();async function m(){let b=ob.find(C=>!C.busy);if(b)return qpe(b),new hE(b,e,t,y);if(ob.length<p){let C={indexWorker:jpe};return jpe++,ob.push(C),new hE(C,e,t,y)}else return new Promise(C=>Nq.push({resolve:C,stream:e,workerOptions:t}))}function y(b){if(Nq.length){let[{resolve:C,stream:A,workerOptions:T}]=Nq.splice(0,1);C(new hE(b,A,T,y))}else b.worker?(qpe(b),Dit(b,t)):ob=ob.filter(C=>C!=b)}}function Dit(e,t){let{config:n}=t,{terminateWorkerTimeout:i}=n;Number.isFinite(i)&&i>=0&&(e.terminated?e.terminated=!1:e.terminateTimeout=setTimeout(async()=>{ob=ob.filter(o=>o!=e);try{await e.terminate()}catch{}},i))}function qpe(e){let{terminateTimeout:t}=e;t&&(clearTimeout(t),e.terminateTimeout=null)}var Iit="Writer iterator completed too soon",Pit="text/plain";var Rit="Content-Type";var Oit=64*1024,kq="writable",mE=class{constructor(){this.size=0}init(){this.initialized=!0}},M4=class extends mE{get readable(){let t=this,{chunkSize:n=Oit}=t,i=new ReadableStream({start(){this.chunkOffset=0},async pull(o){let{offset:r=0,size:s,diskNumberStart:a}=i,{chunkOffset:c}=this;o.enqueue(await Ma(t,r+c,Math.min(n,s-c),a)),c+n>s?o.close():this.chunkOffset+=n}});return i}},Fq=class extends mE{constructor(){super();let t=this,n=new WritableStream({write(i){return t.writeUint8Array(i)}});Object.defineProperty(t,kq,{get(){return n}})}writeUint8Array(){}};var L4=class extends Fq{constructor(t){super(),Object.assign(this,{data:"data:"+(t||"")+";base64,",pending:[]})}writeUint8Array(t){let n=this,i=0,o=n.pending,r=n.pending.length;for(n.pending="",i=0;i<Math.floor((r+t.length)/3)*3-r;i++)o+=String.fromCharCode(t[i]);for(;i<t.length;i++)n.pending+=String.fromCharCode(t[i]);o.length>2?n.data+=btoa(o):n.pending=o}getData(){return this.data+btoa(this.pending)}},c_=class extends M4{constructor(t){super(),Object.assign(this,{blob:t,size:t.size})}async readUint8Array(t,n){let i=this,o=t+n,s=await(t||o<i.size?i.blob.slice(t,o):i.blob).arrayBuffer();return s.byteLength>n&&(s=s.slice(t,o)),new Uint8Array(s)}},iD=class extends mE{constructor(t){super();let n=this,i=new TransformStream,o=[];t&&o.push([Rit,t]),Object.defineProperty(n,kq,{get(){return i.writable}}),n.blob=new Response(i.readable,{headers:o}).blob()}getData(){return this.blob}},N4=class extends c_{constructor(t){super(new Blob([t],{type:Pit}))}},F4=class extends iD{constructor(t){super(t),Object.assign(this,{encoding:t,utf8:!t||t.toLowerCase()=="utf-8"})}async getData(){let{encoding:t,utf8:n}=this,i=await super.getData();if(i.text&&n)return i.text();{let o=new FileReader;return new Promise((r,s)=>{Object.assign(o,{onload:({target:a})=>r(a.result),onerror:()=>s(o.error)}),o.readAsText(i,t)})}}};var Bq=class extends M4{constructor(t){super(),this.readers=t}async init(){let t=this,{readers:n}=t;t.lastDiskNumber=0,t.lastDiskOffset=0,await Promise.all(n.map(async(i,o)=>{await i.init(),o!=n.length-1&&(t.lastDiskOffset+=i.size),t.size+=i.size})),super.init()}async readUint8Array(t,n,i=0){let o=this,{readers:r}=this,s,a=i;a==-1&&(a=r.length-1);let c=t;for(;c>=r[a].size;)c-=r[a].size,a++;let l=r[a],f=l.size;if(c+n<=f)s=await Ma(l,c,n);else{let d=f-c;s=new Uint8Array(n),s.set(await Ma(l,c,d)),s.set(await o.readUint8Array(t+d,n-d,i),d)}return o.lastDiskNumber=Math.max(a,o.lastDiskNumber),s}},B4=class extends mE{constructor(t,n=4294967295){super();let i=this;Object.assign(i,{diskNumber:0,diskOffset:0,size:0,maxSize:n,availableSize:n});let o,r,s,a=new WritableStream({async write(f){let{availableSize:d}=i;if(s)f.length>=d?(await c(f.slice(0,d)),await l(),i.diskOffset+=o.size,i.diskNumber++,s=null,await this.write(f.slice(d))):await c(f);else{let{value:p,done:g}=await t.next();if(g&&!p)throw new Error(Iit);o=p,o.size=0,o.maxSize&&(i.maxSize=o.maxSize),i.availableSize=i.maxSize,await Cm(o),r=p.writable,s=r.getWriter(),await this.write(f)}},async close(){await s.ready,await l()}});Object.defineProperty(i,kq,{get(){return a}});async function c(f){let d=f.length;d&&(await s.ready,await s.write(f),o.size+=d,i.size+=d,i.availableSize-=d)}async function l(){r.size=o.size,await s.close()}}};async function Cm(e,t){if(e.init&&!e.initialized)await e.init(t);else return Promise.resolve()}function k4(e){return Array.isArray(e)&&(e=new Bq(e)),e instanceof ReadableStream&&(e={readable:e}),e}function V4(e){e.writable===Di&&typeof e.next==r_&&(e=new B4(e)),e instanceof WritableStream&&(e={writable:e});let{writable:t}=e;return t.size===Di&&(t.size=0),e instanceof B4||Object.assign(e,{diskNumber:0,diskOffset:0,availableSize:1/0,maxSize:1/0}),e}function Ma(e,t,n,i){return e.readUint8Array(t,n,i)}var Ype="\0\u263A\u263B\u2665\u2666\u2663\u2660\u2022\u25D8\u25CB\u25D9\u2642\u2640\u266A\u266B\u263C\u25BA\u25C4\u2195\u203C\xB6\xA7\u25AC\u21A8\u2191\u2193\u2192\u2190\u221F\u2194\u25B2\u25BC !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u2302\xC7\xFC\xE9\xE2\xE4\xE0\xE5\xE7\xEA\xEB\xE8\xEF\xEE\xEC\xC4\xC5\xC9\xE6\xC6\xF4\xF6\xF2\xFB\xF9\xFF\xD6\xDC\xA2\xA3\xA5\u20A7\u0192\xE1\xED\xF3\xFA\xF1\xD1\xAA\xBA\xBF\u2310\xAC\xBD\xBC\xA1\xAB\xBB\u2591\u2592\u2593\u2502\u2524\u2561\u2562\u2556\u2555\u2563\u2551\u2557\u255D\u255C\u255B\u2510\u2514\u2534\u252C\u251C\u2500\u253C\u255E\u255F\u255A\u2554\u2569\u2566\u2560\u2550\u256C\u2567\u2568\u2564\u2565\u2559\u2558\u2552\u2553\u256B\u256A\u2518\u250C\u2588\u2584\u258C\u2590\u2580\u03B1\xDF\u0393\u03C0\u03A3\u03C3\xB5\u03C4\u03A6\u0398\u03A9\u03B4\u221E\u03C6\u03B5\u2229\u2261\xB1\u2265\u2264\u2320\u2321\xF7\u2248\xB0\u2219\xB7\u221A\u207F\xB2\u25A0 ".split(""),Mit=Ype.length==256;function Xpe(e){if(Mit){let t="";for(let n=0;n<e.length;n++)t+=Ype[e[n]];return t}else return new TextDecoder().decode(e)}function oD(e,t){return t&&t.trim().toLowerCase()=="cp437"?Xpe(e):new TextDecoder(t).decode(e)}var Vq="filename",Uq="rawFilename",zq="comment",Hq="rawComment",Gq="uncompressedSize",Wq="compressedSize",jq="offset",U4="diskNumberStart",pE="lastModDate",z4="rawLastModDate",rD="lastAccessDate",Kpe="rawLastAccessDate",sD="creationDate",Zpe="rawCreationDate",qq="internalFileAttribute",Yq="externalFileAttribute",Xq="msDosCompatible",H4="zip64",Kq="encrypted",Zq="version",$q="versionMadeBy",Qq="zipCrypto",Lit=[Vq,Uq,Wq,Gq,pE,z4,zq,Hq,rD,sD,jq,U4,U4,qq,Yq,Xq,H4,Kq,Zq,$q,Qq,"directory","bitFlag","signature","filenameUTF8","commentUTF8","compressionMethod","extraField","rawExtraField","extraFieldZip64","extraFieldUnicodePath","extraFieldUnicodeComment","extraFieldAES","extraFieldNTFS","extraFieldExtendedTimestamp"],D0=class{constructor(t){Lit.forEach(n=>this[n]=t[n])}};var Jq="File format is not recognized",kit="End of central directory not found",Vit="End of Zip64 central directory locator not found",Uit="Central directory header not found",zit="Local file header not found",Hit="Zip64 extra field not found",Git="File contains encrypted entry",Wit="Encryption method not supported",$pe="Compression method not supported",Qpe="Split zip file",Jpe="utf-8",e_e="cp437",jit=[[Gq,4294967295],[Wq,4294967295],[jq,4294967295],[U4,65535]],qit={[65535]:{getValue:fs,bytes:4},[4294967295]:{getValue:G4,bytes:8}},Z4=class{constructor(t,n={}){Object.assign(this,{reader:k4(t),options:n,config:K1()})}async*getEntriesGenerator(t={}){let n=this,{reader:i}=n,{config:o}=n;if(await Cm(i),(i.size===Di||!i.readUint8Array)&&(i=new c_(await new Response(i.readable).blob()),await Cm(i)),i.size<22)throw new Error(Jq);i.chunkSize=y4(o);let r=await $it(i,101010256,i.size,22,65535*16);if(!r){let L=await Ma(i,0,4),_=ma(L);throw fs(_)==134695760?new Error(Qpe):new Error(kit)}let s=ma(r),a=fs(s,12),c=fs(s,16),l=r.offset,f=ha(s,20),d=l+22+f,p=ha(s,4),g=i.lastDiskNumber||0,m=ha(s,6),y=ha(s,8),b=0,C=0;if(c==4294967295||a==4294967295||y==65535||m==65535){let L=await Ma(i,r.offset-20,20),_=ma(L);if(fs(_,0)==117853008){c=G4(_,8);let S=await Ma(i,c,56,-1),w=ma(S),I=r.offset-20-56;if(fs(w,0)!=101075792&&c!=I){let N=c;c=I,b=c-N,S=await Ma(i,c,56,-1),w=ma(S)}if(fs(w,0)!=101075792)throw new Error(Vit);p==65535&&(p=fs(w,16)),m==65535&&(m=fs(w,20)),y==65535&&(y=G4(w,32)),a==4294967295&&(a=G4(w,40)),c-=a}}if(c>=i.size&&(b=i.size-c-a-22,c=i.size-a-22),g!=p)throw new Error(Qpe);if(c<0)throw new Error(Jq);let A=0,T=await Ma(i,c,a,m),E=ma(T);if(a){let L=r.offset-a;if(fs(E,A)!=33639248&&c!=L){let _=c;c=L,b+=c-_,T=await Ma(i,c,a,m),E=ma(T)}}let v=r.offset-c-(i.lastDiskOffset||0);if(a!=v&&v>=0&&(a=v,T=await Ma(i,c,a,m),E=ma(T)),c<0||c>=i.size)throw new Error(Jq);let D=Xc(n,t,"filenameEncoding"),O=Xc(n,t,"commentEncoding");for(let L=0;L<y;L++){let _=new tY(i,o,n.options);if(fs(E,A)!=33639248)throw new Error(Uit);n_e(_,E,A+6);let S=!!_.bitFlag.languageEncodingFlag,w=A+46,I=w+_.filenameLength,N=I+_.extraFieldLength,k=ha(E,A+4),z=(k&0)==0,V=T.subarray(w,I),U=ha(E,A+32),B=N+U,W=T.subarray(N,B),j=S,Q=S,q=z&&(_E(E,A+38)&16)==16,X=fs(E,A+42)+b;Object.assign(_,{versionMadeBy:k,msDosCompatible:z,compressedSize:0,uncompressedSize:0,commentLength:U,directory:q,offset:X,diskNumberStart:ha(E,A+34),internalFileAttribute:ha(E,A+36),externalFileAttribute:fs(E,A+38),rawFilename:V,filenameUTF8:j,commentUTF8:Q,rawExtraField:T.subarray(I,N)});let Z=Xc(n,t,"decodeText")||oD,fe=j?Jpe:D||e_e,xe=Q?Jpe:O||e_e,re=Z(V,fe);re===Di&&(re=oD(V,fe));let pe=Z(W,xe);pe===Di&&(pe=oD(W,xe)),Object.assign(_,{rawComment:W,filename:re,comment:pe,directory:q||re.endsWith(cE)}),C=Math.max(X,C),await i_e(_,_,E,A+6),_.zipCrypto=_.encrypted&&!_.extraFieldAES;let ye=new D0(_);ye.getData=(Te,Fe)=>_.getData(Te,ye,Fe),A=B;let{onprogress:Se}=t;if(Se)try{await Se(L+1,y,new D0(_))}catch{}yield ye}let P=Xc(n,t,"extractPrependedData"),M=Xc(n,t,"extractAppendedData");return P&&(n.prependedData=C>0?await Ma(i,0,C):new Uint8Array),n.comment=f?await Ma(i,l+22,f):new Uint8Array,M&&(n.appendedData=d<i.size?await Ma(i,d,i.size-d):new Uint8Array),!0}async getEntries(t={}){let n=[];for await(let i of this.getEntriesGenerator(t))n.push(i);return n}async close(){}};var tY=class{constructor(t,n,i){Object.assign(this,{reader:t,config:n,options:i})}async getData(t,n,i={}){let o=this,{reader:r,offset:s,diskNumberStart:a,extraFieldAES:c,compressionMethod:l,config:f,bitFlag:d,signature:p,rawLastModDate:g,uncompressedSize:m,compressedSize:y}=o,b=n.localDirectory={},C=await Ma(r,s,30,a),A=ma(C),T=Xc(o,i,"password"),E=Xc(o,i,"rawPassword"),v=Xc(o,i,"passThrough");if(T=T&&T.length&&T,E=E&&E.length&&E,c&&c.originalCompressionMethod!=99)throw new Error($pe);if(l!=0&&l!=8&&!v)throw new Error($pe);if(fs(A,0)!=67324752)throw new Error(zit);n_e(b,A,4),b.rawExtraField=b.extraFieldLength?await Ma(r,s+30+b.filenameLength,b.extraFieldLength,a):new Uint8Array,await i_e(o,b,A,4,!0),Object.assign(n,{lastAccessDate:b.lastAccessDate,creationDate:b.creationDate});let D=o.encrypted&&b.encrypted&&!v,O=D&&!c;if(v||(n.zipCrypto=O),D){if(!O&&c.strength===Di)throw new Error(Wit);if(!T&&!E)throw new Error(Git)}let P=s+30+b.filenameLength+b.extraFieldLength,M=y,L=r.readable;Object.assign(L,{diskNumberStart:a,offset:P,size:M});let _=Xc(o,i,"signal"),S=Xc(o,i,"checkPasswordOnly");S&&(t=new WritableStream),t=V4(t),await Cm(t,v?y:m);let{writable:w}=t,{onstart:I,onprogress:N,onend:k}=i,z={options:{codecType:P4,password:T,rawPassword:E,zipCrypto:O,encryptionStrength:c&&c.strength,signed:Xc(o,i,"checkSignature")&&!v,passwordVerification:O&&(d.dataDescriptor?g>>>8&255:p>>>24&255),signature:p,compressed:l!=0&&!v,encrypted:o.encrypted&&!v,useWebWorkers:Xc(o,i,"useWebWorkers"),useCompressionStream:Xc(o,i,"useCompressionStream"),transferStreams:Xc(o,i,"transferStreams"),checkPasswordOnly:S},config:f,streamOptions:{signal:_,size:M,onstart:I,onprogress:N,onend:k}},V=0;try{({outputSize:V}=await O4({readable:L,writable:w},z))}catch(U){if(!S||U.message!=a_)throw U}finally{let U=Xc(o,i,"preventClose");w.size+=V,!U&&!w.locked&&await w.getWriter().close()}return S?Di:t.getData?t.getData():w}};function n_e(e,t,n){let i=e.rawBitFlag=ha(t,n+2),o=(i&1)==1,r=fs(t,n+6);Object.assign(e,{encrypted:o,version:ha(t,n),bitFlag:{level:(i&6)>>1,dataDescriptor:(i&8)==8,languageEncodingFlag:(i&2048)==2048},rawLastModDate:r,lastModDate:Qit(r),filenameLength:ha(t,n+22),extraFieldLength:ha(t,n+24)})}async function i_e(e,t,n,i,o){let{rawExtraField:r}=t,s=t.extraField=new Map,a=ma(new Uint8Array(r)),c=0;try{for(;c<r.length;){let C=ha(a,c),A=ha(a,c+2);s.set(C,{type:C,data:r.slice(c+4,c+4+A)}),c+=4+A}}catch{}let l=ha(n,i+4);Object.assign(t,{signature:fs(n,i+10),uncompressedSize:fs(n,i+18),compressedSize:fs(n,i+14)});let f=s.get(1);f&&(Yit(f,t),t.extraFieldZip64=f);let d=s.get(28789);d&&(await t_e(d,Vq,Uq,t,e),t.extraFieldUnicodePath=d);let p=s.get(25461);p&&(await t_e(p,zq,Hq,t,e),t.extraFieldUnicodeComment=p);let g=s.get(39169);g?(Xit(g,t,l),t.extraFieldAES=g):t.compressionMethod=l;let m=s.get(10);m&&(Kit(m,t),t.extraFieldNTFS=m);let y=s.get(21589);y&&(Zit(y,t,o),t.extraFieldExtendedTimestamp=y);let b=s.get(6534);b&&(t.extraFieldUSDZ=b)}function Yit(e,t){t.zip64=!0;let n=ma(e.data),i=jit.filter(([o,r])=>t[o]==r);for(let o=0,r=0;o<i.length;o++){let[s,a]=i[o];if(t[s]==a){let c=qit[a];t[s]=e[s]=c.getValue(n,r),r+=c.bytes}else if(e[s])throw new Error(Hit)}}async function t_e(e,t,n,i,o){let r=ma(e.data),s=new s_;s.append(o[n]);let a=ma(new Uint8Array(4));a.setUint32(0,s.get(),!0);let c=fs(r,1);Object.assign(e,{version:_E(r,0),[t]:oD(e.data.subarray(5)),valid:!o.bitFlag.languageEncodingFlag&&c==fs(a,0)}),e.valid&&(i[t]=e[t],i[t+"UTF8"]=!0)}function Xit(e,t,n){let i=ma(e.data),o=_E(i,4);Object.assign(e,{vendorVersion:_E(i,0),vendorId:_E(i,2),strength:o,originalCompressionMethod:n,compressionMethod:ha(i,5)}),t.compressionMethod=e.compressionMethod}function Kit(e,t){let n=ma(e.data),i=4,o;try{for(;i<e.data.length&&!o;){let r=ha(n,i),s=ha(n,i+2);r==1&&(o=e.data.slice(i+4,i+4+s)),i+=4+s}}catch{}try{if(o&&o.length==24){let r=ma(o),s=r.getBigUint64(0,!0),a=r.getBigUint64(8,!0),c=r.getBigUint64(16,!0);Object.assign(e,{rawLastModDate:s,rawLastAccessDate:a,rawCreationDate:c});let l=eY(s),f=eY(a),d=eY(c),p={lastModDate:l,lastAccessDate:f,creationDate:d};Object.assign(e,p),Object.assign(t,p)}}catch{}}function Zit(e,t,n){let i=ma(e.data),o=_E(i,0),r=[],s=[];n?((o&1)==1&&(r.push(pE),s.push(z4)),(o&2)==2&&(r.push(rD),s.push(Kpe)),(o&4)==4&&(r.push(sD),s.push(Zpe))):e.data.length>=5&&(r.push(pE),s.push(z4));let a=1;r.forEach((c,l)=>{if(e.data.length>=a+4){let f=fs(i,a);t[c]=e[c]=new Date(f*1e3);let d=s[l];e[d]=f}a+=4})}async function $it(e,t,n,i,o){let r=new Uint8Array(4),s=ma(r);Jit(s,0,t);let a=i+o;return await c(i)||await c(Math.min(a,n));async function c(l){let f=n-l,d=await Ma(e,f,l);for(let p=d.length-i;p>=0;p--)if(d[p]==r[0]&&d[p+1]==r[1]&&d[p+2]==r[2]&&d[p+3]==r[3])return{offset:f+p,buffer:d.slice(p,p+i).buffer}}}function Xc(e,t,n){return t[n]===Di?e.options[n]:t[n]}function Qit(e){let t=(e&4294901760)>>16,n=e&65535;try{return new Date(1980+((t&65024)>>9),((t&480)>>5)-1,t&31,(n&63488)>>11,(n&2016)>>5,(n&31)*2,0)}catch{}}function eY(e){return new Date(Number(e/BigInt(1e4)-BigInt(116444736e5)))}function _E(e,t){return e.getUint8(t)}function ha(e,t){return e.getUint16(t,!0)}function fs(e,t){return e.getUint32(t,!0)}function G4(e,t){return Number(e.getBigUint64(t,!0))}function Jit(e,t,n){e.setUint32(t,n,!0)}function ma(e){return new DataView(e.buffer)}var iot="File already exists",oot="Zip file comment exceeds 64KB",rot="File entry comment exceeds 64KB",sot="File entry name exceeds 64KB",s_e="Version exceeds 65535",aot="The strength must equal 1, 2, or 3",cot="Extra field type exceeds 65535",lot="Extra field data exceeds 64KB",pY="Zip64 is not supported (make sure 'keepOrder' is set to 'true')",uot="Undefined uncompressed size",a_e=new Uint8Array([7,0,2,0,65,69,3,0,0]),hY=0,c_e=[],J4=class{constructor(t,n={}){t=V4(t);let i=t.availableSize!==Di&&t.availableSize>0&&t.availableSize!==1/0&&t.maxSize!==Di&&t.maxSize>0&&t.maxSize!==1/0;Object.assign(this,{writer:t,addSplitZipSignature:i,options:n,config:K1(),files:new Map,filenames:new Set,offset:n.offset===Di?t.writable.size:n.offset,pendingEntriesSize:0,pendingAddFileCalls:new Set,bufferedWrites:0})}async add(t="",n,i={}){let o=this,{pendingAddFileCalls:r,config:s}=o;hY<s.maxWorkers?hY++:await new Promise(c=>c_e.push(c));let a;try{if(t=t.trim(),o.filenames.has(t))throw new Error(iot);return o.filenames.add(t),a=fot(o,t,n,i),r.add(a),await a}catch(c){throw o.filenames.delete(t),c}finally{r.delete(a);let c=c_e.shift();c?c():hY--}}async close(t=new Uint8Array,n={}){let i=this,{pendingAddFileCalls:o,writer:r}=this,{writable:s}=r;for(;o.size;)await Promise.allSettled(Array.from(o));return await bot(this,t,n),_o(i,n,"preventClose")||await s.getWriter().close(),r.getData?r.getData():s}};async function fot(e,t,n,i){t=t.trim(),i.directory&&!t.endsWith(cE)?t+=cE:i.directory=t.endsWith(cE);let o=_o(e,i,"encodeText",uE),r=o(t);if(r===Di&&(r=uE(t)),Yi(r)>65535)throw new Error(sot);let s=i.comment||"",a=o(s);if(a===Di&&(a=uE(s)),Yi(a)>65535)throw new Error(rot);let c=_o(e,i,Zq,20);if(c>65535)throw new Error(s_e);let l=_o(e,i,$q,20);if(l>65535)throw new Error(s_e);let f=_o(e,i,pE,new Date),d=_o(e,i,rD),p=_o(e,i,sD),g=_o(e,i,Xq,!0),m=_o(e,i,qq,0),y=_o(e,i,Yq,0),b=_o(e,i,"passThrough"),C,A;b||(C=_o(e,i,"password"),A=_o(e,i,"rawPassword"));let T=_o(e,i,"encryptionStrength",3),E=_o(e,i,Qq),v=_o(e,i,"extendedTimestamp",!0),D=_o(e,i,"keepOrder",!0),O=_o(e,i,"level"),P=_o(e,i,"useWebWorkers"),M=_o(e,i,"bufferedWrite"),L=_o(e,i,"dataDescriptorSignature",!1),_=_o(e,i,"signal"),S=_o(e,i,"useUnicodeFileNames",!0),w=_o(e,i,"useCompressionStream"),I=_o(e,i,"compressionMethod"),N=_o(e,i,"dataDescriptor",!0),k=_o(e,i,H4);if(!E&&(C!==Di||A!==Di)&&!(T>=1&&T<=3))throw new Error(aot);let z=new Uint8Array,{extraField:V}=i;if(V){let gt=0,lt=0;V.forEach(Oe=>gt+=4+Yi(Oe)),z=new Uint8Array(gt),V.forEach((Oe,Mt)=>{if(Mt>65535)throw new Error(cot);if(Yi(Oe)>65535)throw new Error(lot);Ss(z,new Uint16Array([Mt]),lt),Ss(z,new Uint16Array([Yi(Oe)]),lt+2),Ss(z,Oe,lt+4),lt+=4+Yi(Oe)})}let U=0,B=0,W=0;if(b&&({uncompressedSize:W}=i,W===Di))throw new Error(uot);let j=k===!0;n&&(n=k4(n),await Cm(n),b?U=l_e(W):n.size===Di?(N=!0,(k||k===Di)&&(k=!0,W=U=4294967296)):(W=n.size,U=l_e(W)));let{diskOffset:Q,diskNumber:q,maxSize:X}=e.writer,Z=j||W>4294967295,fe=j||U>4294967295,xe=j||e.offset+e.pendingEntriesSize-Q>4294967295,pe=_o(e,i,"supportZip64SplitFile",!0)&&j||q+Math.ceil(e.pendingEntriesSize/X)>65535;if(xe||Z||fe||pe){if(k===!1||!D)throw new Error(pY);k=!0}k=k||!1;let ye=_o(e,i,Kq),{signature:Se}=i;i=Object.assign({},i,{rawFilename:r,rawComment:a,version:c,versionMadeBy:l,lastModDate:f,lastAccessDate:d,creationDate:p,rawExtraField:z,zip64:k,zip64UncompressedSize:Z,zip64CompressedSize:fe,zip64Offset:xe,zip64DiskNumberStart:pe,password:C,rawPassword:A,level:!w&&e.config.CompressionStream===Di&&e.config.CompressionStreamNative===Di?0:O,useWebWorkers:P,encryptionStrength:T,extendedTimestamp:v,zipCrypto:E,bufferedWrite:M,keepOrder:D,useUnicodeFileNames:S,dataDescriptor:N,dataDescriptorSignature:L,signal:_,msDosCompatible:g,internalFileAttribute:m,externalFileAttribute:y,useCompressionStream:w,passThrough:b,encrypted:!!(C&&Yi(C)||A&&Yi(A))||b&&ye,signature:Se,compressionMethod:I});let Te=mot(i),Fe=_ot(i),Ve=Yi(Te.localHeaderArray,Fe.dataDescriptorArray);B=Ve+U,e.options.usdz&&(B+=B+64),e.pendingEntriesSize+=B;let Ze;try{Ze=await dot(e,t,n,{headerInfo:Te,dataDescriptorInfo:Fe,metadataSize:Ve},i)}finally{e.pendingEntriesSize-=B}return Object.assign(Ze,{name:t,comment:s,extraField:V}),new D0(Ze)}async function dot(e,t,n,i,o){let{files:r,writer:s}=e,{keepOrder:a,dataDescriptor:c,signal:l}=o,{headerInfo:f}=i,{usdz:d}=e.options,p=Array.from(r.values()).pop(),g={},m,y,b,C,A,T,E;r.set(t,g);try{let P;a&&(P=p&&p.lock,v()),(o.bufferedWrite||e.writerLocked||e.bufferedWrites&&a||!c)&&!d?(T=new TransformStream,E=new Response(T.readable).blob(),T.writable.size=0,m=!0,e.bufferedWrites++,await Cm(s)):(T=s,await D()),await Cm(T);let{writable:M}=s,{diskOffset:L}=s;if(e.addSplitZipSignature){delete e.addSplitZipSignature;let S=new Uint8Array(4),w=La(S);qi(w,0,134695760),await Am(M,S),e.offset+=4}d&&pot(i,e.offset-L),m||(await P,await O(M));let{diskNumber:_}=s;if(A=!0,g.diskNumberStart=_,g=await hot(n,T,g,i,e.config,o),A=!1,r.set(t,g),g.filename=t,m){await T.writable.getWriter().close();let S=await E;await P,await D(),C=!0,c||(S=await yot(g,S,M,o)),await O(M),g.diskNumberStart=s.diskNumber,L=s.diskOffset,await S.stream().pipeTo(M,{preventClose:!0,preventAbort:!0,signal:l}),M.size+=S.size,C=!1}if(g.offset=e.offset-L,g.zip64)xot(g,o);else if(g.offset>4294967295)throw new Error(pY);return e.offset+=g.size,g}catch(P){if(m&&C||!m&&A){if(e.hasCorruptedEntries=!0,P)try{P.corruptedEntry=!0}catch{}m?e.offset+=T.writable.size:e.offset=T.writable.size}throw r.delete(t),P}finally{m&&e.bufferedWrites--,b&&b(),y&&y()}function v(){g.lock=new Promise(P=>b=P)}async function D(){e.writerLocked=!0;let{lockWriter:P}=e;e.lockWriter=new Promise(M=>y=()=>{e.writerLocked=!1,M()}),await P}async function O(P){Yi(f.localHeaderArray)>s.availableSize&&(s.availableSize=0,await Am(P,new Uint8Array))}}async function hot(e,t,{diskNumberStart:n,lock:i},o,r,s){let{headerInfo:a,dataDescriptorInfo:c,metadataSize:l}=o,{localHeaderArray:f,headerArray:d,lastModDate:p,rawLastModDate:g,encrypted:m,compressed:y,version:b,compressionMethod:C,rawExtraFieldExtendedTimestamp:A,extraFieldExtendedTimestampFlag:T,rawExtraFieldNTFS:E,rawExtraFieldAES:v}=a,{dataDescriptorArray:D}=c,{rawFilename:O,lastAccessDate:P,creationDate:M,password:L,rawPassword:_,level:S,zip64:w,zip64UncompressedSize:I,zip64CompressedSize:N,zip64Offset:k,zip64DiskNumberStart:z,zipCrypto:V,dataDescriptor:U,directory:B,versionMadeBy:W,rawComment:j,rawExtraField:Q,useWebWorkers:q,onstart:X,onprogress:Z,onend:fe,signal:xe,encryptionStrength:re,extendedTimestamp:pe,msDosCompatible:ye,internalFileAttribute:Se,externalFileAttribute:Te,useCompressionStream:Fe,passThrough:Ve}=s,Ze={lock:i,versionMadeBy:W,zip64:w,directory:!!B,filenameUTF8:!0,rawFilename:O,commentUTF8:!0,rawComment:j,rawExtraFieldExtendedTimestamp:A,rawExtraFieldNTFS:E,rawExtraFieldAES:v,rawExtraField:Q,extendedTimestamp:pe,msDosCompatible:ye,internalFileAttribute:Se,externalFileAttribute:Te,diskNumberStart:n},{signature:gt,uncompressedSize:lt}=s,Oe=0;Ve||(lt=0);let{writable:Mt}=t;if(e){e.chunkSize=y4(r),await Am(Mt,f);let at=e.readable,Kt=at.size=e.size,Ce={options:{codecType:I4,level:S,rawPassword:_,password:L,encryptionStrength:re,zipCrypto:m&&V,passwordVerification:m&&V&&g>>8&255,signed:!Ve,compressed:y&&!Ve,encrypted:m&&!Ve,useWebWorkers:q,useCompressionStream:Fe,transferStreams:!1},config:r,streamOptions:{signal:xe,size:Kt,onstart:X,onprogress:Z,onend:fe}},Ae=await O4({readable:at,writable:Mt},Ce);Oe=Ae.outputSize,Ve||(lt=Ae.inputSize,gt=Ae.signature),Mt.size+=lt}else await Am(Mt,f);let ut;if(w){let at=4;I&&(at+=8),N&&(at+=8),k&&(at+=8),z&&(at+=4),ut=new Uint8Array(at)}else ut=new Uint8Array;return got({signature:gt,rawExtraFieldZip64:ut,compressedSize:Oe,uncompressedSize:lt,headerInfo:a,dataDescriptorInfo:c},s),U&&await Am(Mt,D),Object.assign(Ze,{uncompressedSize:lt,compressedSize:Oe,lastModDate:p,rawLastModDate:g,creationDate:M,lastAccessDate:P,encrypted:m,zipCrypto:V,size:l+Oe,compressionMethod:C,version:b,headerArray:d,signature:gt,rawExtraFieldZip64:ut,extraFieldExtendedTimestampFlag:T,zip64UncompressedSize:I,zip64CompressedSize:N,zip64Offset:k,zip64DiskNumberStart:z}),Ze}function mot(e){let{rawFilename:t,lastModDate:n,lastAccessDate:i,creationDate:o,level:r,zip64:s,zipCrypto:a,useUnicodeFileNames:c,dataDescriptor:l,directory:f,rawExtraField:d,encryptionStrength:p,extendedTimestamp:g,encrypted:m}=e,y=r!==0&&!f,{version:b,compressionMethod:C}=e,A;if(m&&!a){A=new Uint8Array(Yi(a_e)+2);let k=La(A);no(k,0,39169),Ss(A,a_e,2),eV(k,8,p)}else A=new Uint8Array;let T,E,v;if(g){E=new Uint8Array(9+(i?4:0)+(o?4:0));let k=La(E);no(k,0,21589),no(k,2,Yi(E)-4),v=1+(i?2:0)+(o?4:0),eV(k,4,v);let z=5;qi(k,z,Math.floor(n.getTime()/1e3)),z+=4,i&&(qi(k,z,Math.floor(i.getTime()/1e3)),z+=4),o&&qi(k,z,Math.floor(o.getTime()/1e3));try{T=new Uint8Array(36);let V=La(T),U=mY(n);no(V,0,10),no(V,2,32),no(V,8,1),no(V,10,24),Pl(V,12,U),Pl(V,20,mY(i)||U),Pl(V,28,mY(o)||U)}catch{T=new Uint8Array}}else T=E=new Uint8Array;let D=0;c&&(D=D|2048),l&&(D=D|8),C===Di&&(C=y?8:0),C==8&&(r>=1&&r<3&&(D=D|6),r>=3&&r<5&&(D=D|1),r===9&&(D=D|2)),s&&(b=b>45?b:45),m&&(D=D|1,a||(b=b>51?b:51,A[9]=C,C=99));let O=new Uint8Array(26),P=La(O);no(P,0,b),no(P,2,D),no(P,4,C);let M=new Uint32Array(1),L=La(M),_;n<Sq?_=Sq:n>Eq?_=Eq:_=n,no(L,0,(_.getHours()<<6|_.getMinutes())<<5|_.getSeconds()/2),no(L,2,(_.getFullYear()-1980<<4|_.getMonth()+1)<<5|_.getDate());let S=M[0];qi(P,6,S),no(P,22,Yi(t));let w=Yi(A,E,T,d);no(P,24,w);let I=new Uint8Array(30+Yi(t)+w),N=La(I);return qi(N,0,67324752),Ss(I,O,4),Ss(I,t,30),Ss(I,A,30+Yi(t)),Ss(I,E,30+Yi(t,A)),Ss(I,T,30+Yi(t,A,E)),Ss(I,d,30+Yi(t,A,E,T)),{localHeaderArray:I,headerArray:O,headerView:P,lastModDate:n,rawLastModDate:S,encrypted:m,compressed:y,version:b,compressionMethod:C,extraFieldExtendedTimestampFlag:v,rawExtraFieldExtendedTimestamp:E,rawExtraFieldNTFS:T,rawExtraFieldAES:A,extraFieldLength:w}}function pot(e,t){let{headerInfo:n}=e,{localHeaderArray:i,extraFieldLength:o}=n,r=La(i),s=64-(t+Yi(i))%64;s<4&&(s+=64);let a=new Uint8Array(s),c=La(a);no(c,0,6534),no(c,2,s-2);let l=i;n.localHeaderArray=i=new Uint8Array(Yi(l)+s),Ss(i,l),Ss(i,a,Yi(l)),r=La(i),no(r,28,o+s),e.metadataSize+=s}function _ot(e){let{zip64:t,dataDescriptor:n,dataDescriptorSignature:i}=e,o=new Uint8Array,r,s=0;return n&&(o=new Uint8Array(t?i?24:20:i?16:12),r=La(o),i&&(s=4,qi(r,0,134695760))),{dataDescriptorArray:o,dataDescriptorView:r,dataDescriptorOffset:s}}function got(e,t){let{signature:n,rawExtraFieldZip64:i,compressedSize:o,uncompressedSize:r,headerInfo:s,dataDescriptorInfo:a}=e,{headerView:c,encrypted:l}=s,{dataDescriptorView:f,dataDescriptorOffset:d}=a,{zip64:p,zip64UncompressedSize:g,zip64CompressedSize:m,zipCrypto:y,dataDescriptor:b}=t;if((!l||y)&&n!==Di&&(qi(c,10,n),b&&qi(f,d,n)),p){let C=La(i);no(C,0,1),no(C,2,Yi(i)-4);let A=4;g&&(qi(c,18,4294967295),Pl(C,A,BigInt(r)),A+=8),m&&(qi(c,14,4294967295),Pl(C,A,BigInt(o))),b&&(Pl(f,d+4,BigInt(o)),Pl(f,d+12,BigInt(r)))}else qi(c,14,o),qi(c,18,r),b&&(qi(f,d+4,o),qi(f,d+8,r))}async function yot(e,t,n,{zipCrypto:i}){let o;o=await t.slice(0,26).arrayBuffer(),o.byteLength!=26&&(o=o.slice(0,26));let r=new DataView(o);return(!e.encrypted||i)&&qi(r,14,e.signature),e.zip64?(qi(r,18,4294967295),qi(r,22,4294967295)):(qi(r,18,e.compressedSize),qi(r,22,e.uncompressedSize)),await Am(n,new Uint8Array(o)),t.slice(o.byteLength)}function xot(e,t){let{rawExtraFieldZip64:n,offset:i,diskNumberStart:o}=e,{zip64UncompressedSize:r,zip64CompressedSize:s,zip64Offset:a,zip64DiskNumberStart:c}=t,l=La(n),f=4;r&&(f+=8),s&&(f+=8),a&&(Pl(l,f,BigInt(i)),f+=8),c&&qi(l,f,o)}async function bot(e,t,n){let{files:i,writer:o}=e,{diskOffset:r,writable:s}=o,{diskNumber:a}=o,c=0,l=0,f=e.offset-r,d=i.size;for(let[,v]of i){let{rawFilename:D,rawExtraFieldZip64:O,rawExtraFieldAES:P,rawComment:M,rawExtraFieldNTFS:L,rawExtraField:_,extendedTimestamp:S,extraFieldExtendedTimestampFlag:w,lastModDate:I}=v,N;if(S){N=new Uint8Array(9);let k=La(N);no(k,0,21589),no(k,2,5),eV(k,4,w),qi(k,5,Math.floor(I.getTime()/1e3))}else N=new Uint8Array;v.rawExtraFieldCDExtendedTimestamp=N,l+=46+Yi(D,M,O,P,L,N,_)}let p=new Uint8Array(l),g=La(p);await Cm(o);let m=0;for(let[v,D]of Array.from(i.values()).entries()){let{offset:O,rawFilename:P,rawExtraFieldZip64:M,rawExtraFieldAES:L,rawExtraFieldCDExtendedTimestamp:_,rawExtraFieldNTFS:S,rawExtraField:w,rawComment:I,versionMadeBy:N,headerArray:k,directory:z,zip64:V,zip64UncompressedSize:U,zip64CompressedSize:B,zip64DiskNumberStart:W,zip64Offset:j,msDosCompatible:Q,internalFileAttribute:q,externalFileAttribute:X,diskNumberStart:Z,uncompressedSize:fe,compressedSize:xe}=D,re=Yi(M,L,_,S,w);qi(g,c,33639248),no(g,c+4,N);let pe=La(k);U||qi(pe,18,fe),B||qi(pe,14,xe),Ss(p,k,c+6),no(g,c+30,re),no(g,c+32,Yi(I)),no(g,c+34,V&&W?65535:Z),no(g,c+36,q),X?qi(g,c+38,X):z&&Q&&eV(g,c+38,16),qi(g,c+42,V&&j?4294967295:O),Ss(p,P,c+46),Ss(p,M,c+46+Yi(P)),Ss(p,L,c+46+Yi(P,M)),Ss(p,_,c+46+Yi(P,M,L)),Ss(p,S,c+46+Yi(P,M,L,_)),Ss(p,w,c+46+Yi(P,M,L,_,S)),Ss(p,I,c+46+Yi(P)+re);let ye=46+Yi(P,I)+re;if(c-m>o.availableSize&&(o.availableSize=0,await Am(s,p.slice(m,c)),m=c),c+=ye,n.onprogress)try{await n.onprogress(v+1,i.size,new D0(D))}catch{}}await Am(s,m?p.slice(m):p);let y=o.diskNumber,{availableSize:b}=o;b<22&&y++;let C=_o(e,n,H4);if(f>4294967295||l>4294967295||d>65535||y>65535){if(C===!1)throw new Error(pY);C=!0}let A=new Uint8Array(C?98:22),T=La(A);c=0,C&&(qi(T,0,101075792),Pl(T,4,BigInt(44)),no(T,12,45),no(T,14,45),qi(T,16,y),qi(T,20,a),Pl(T,24,BigInt(d)),Pl(T,32,BigInt(d)),Pl(T,40,BigInt(l)),Pl(T,48,BigInt(f)),qi(T,56,117853008),Pl(T,64,BigInt(f)+BigInt(l)),qi(T,72,y+1),_o(e,n,"supportZip64SplitFile",!0)&&(y=65535,a=65535),d=65535,f=4294967295,l=4294967295,c+=76),qi(T,c,101010256),no(T,c+4,y),no(T,c+6,a),no(T,c+8,d),no(T,c+10,d),qi(T,c+12,l),qi(T,c+16,f);let E=Yi(t);if(E)if(E<=65535)no(T,c+20,E);else throw new Error(oot);await Am(s,A),E&&await Am(s,t)}async function Am(e,t){let n=e.getWriter();try{await n.ready,e.size+=Yi(t),await n.write(t)}finally{n.releaseLock()}}function mY(e){if(e)return(BigInt(e.getTime())+BigInt(116444736e5))*BigInt(1e4)}function _o(e,t,n,i){let o=t[n]===Di?e.options[n]:t[n];return o===Di?i:o}function l_e(e){return e+5*(Math.floor(e/16383)+1)}function eV(e,t,n){e.setUint8(t,n)}function no(e,t,n){e.setUint16(t,n,!0)}function qi(e,t,n){e.setUint32(t,n,!0)}function Pl(e,t,n){e.setBigUint64(t,n,!0)}function Ss(e,t,n){e.set(t,n)}function La(e){return new DataView(e.buffer)}function Yi(...e){let t=0;return e.forEach(n=>n&&(t+=n.length)),t}lE({Deflate:Yme,Inflate:ppe});var _Y=32,Cot="http://www.opengis.net/kml/2.2",Zd="http://www.google.com/kml/ext/2.2",Aot="http://www.w3.org/2000/xmlns/";function tV(e){this._files={},this._promises=[],this._count=0,this._modelCallback=e}var Tot=/^data:image\/([^,;]+)/;tV.prototype.texture=function(e){let t=this,n;if(typeof e=="string"||e instanceof De){if(e=De.createIfNeeded(e),!e.isDataUri)return e.url;let i=e.url.match(Tot);n=`texture_${++this._count}`,u(i)&&(n+=`.${i[1]}`);let o=e.fetchBlob().then(function(r){t._files[n]=r});return this._promises.push(o),n}if(e instanceof HTMLCanvasElement){n=`texture_${++this._count}.png`;let i=new Promise(o=>{e.toBlob(function(r){t._files[n]=r,o()})});return this._promises.push(i),n}return""};function Eot(e,t){return function(n){e._files[t]=n}}tV.prototype.model=function(e,t){let n=this._modelCallback;if(!u(n))throw new ce("Encountered a model entity while exporting to KML, but no model callback was supplied.");let i={},o=n(e,t,i);for(let r in i)if(i.hasOwnProperty(r)){let s=Promise.resolve(i[r]);this._promises.push(s),s.then(Eot(this,r))}return o};Object.defineProperties(tV.prototype,{promise:{get:function(){return Promise.all(this._promises)}},files:{get:function(){return this._files}}});function nV(e){this._time=e}nV.prototype.get=function(e,t,n){let i;return u(e)&&(i=u(e.getValue)?e.getValue(this._time,n):e),x(i,t)};nV.prototype.getColor=function(e,t){let n=this.get(e,t);if(u(n))return sb(n)};nV.prototype.getMaterialType=function(e){if(u(e))return e.getType(this._time)};function gY(){this._ids={},this._styles={},this._count=0}gY.prototype.get=function(e){let t=this._ids,n=e.innerHTML;if(u(t[n]))return t[n];let i=`style-${++this._count}`;return e.setAttribute("id",i),i=`#${i}`,t[n]=i,this._styles[n]=e,i};gY.prototype.save=function(e){let t=this._styles,n=e.childNodes[0];for(let i in t)t.hasOwnProperty(i)&&e.insertBefore(t[i],n)};function h_e(){this._ids={}}h_e.prototype.get=function(e){if(!u(e))return this.get(Hn());let t=this._ids;return u(t[e])?`${e.toString()}-${++t[e]}`:(t[e]=0,e)};function yY(e){e=x(e,x.EMPTY_OBJECT);let t=e.entities,n=x(e.kmz,!1),i=yY._createState(e),o=t.values.filter(function(l){return!u(l.parent)}),r=i.kmlDoc,s=r.documentElement;s.setAttributeNS(Aot,"xmlns:gx",Zd);let a=r.createElement("Document");s.appendChild(a),p_e(i,a,o),i.styleCache.save(a);let c=i.externalFileHandler;return c.promise.then(function(){let f=new XMLSerializer().serializeToString(i.kmlDoc);return n?Sot(f,c.files):{kml:f,externalFiles:c.files}})}function Sot(e,t){let n=on("ThirdParty/Workers/z-worker-pako.js");lE({workerScripts:{deflate:[n,"./pako_deflate.min.js"],inflate:[n,"./pako_inflate.min.js"]}});let i=new iD,o=new J4(i);return o.add("doc.kml",new N4(e)).then(function(){let r=Object.keys(t);return m_e(o,r,t,0)}).then(function(){return o.close()}).then(function(r){return{kmz:r}})}function m_e(e,t,n,i){if(t.length===i)return;let o=t[i];return e.add(o,new c_(n[o])).then(function(){return m_e(e,t,n,i+1)})}yY._createState=function(e){let t=e.entities,n=new gY,i=t.computeAvailability(),o=u(e.time)?e.time:i.start,r=x(e.defaultAvailability,i),s=x(e.sampleDuration,60);r.start===He.MINIMUM_VALUE?r.stop===He.MAXIMUM_VALUE?r=new Sn:$.addSeconds(r.stop,-10*s,r.start):r.stop===He.MAXIMUM_VALUE&&$.addSeconds(r.start,10*s,r.stop);let a=new tV(e.modelCallback);return{kmlDoc:document.implementation.createDocument(Cot,"kml"),ellipsoid:x(e.ellipsoid,ee.default),idManager:new h_e,styleCache:n,externalFileHandler:a,time:o,valueGetter:new nV(o),sampleDuration:s,defaultAvailability:new Xr([r])}};function p_e(e,t,n){let i=e.kmlDoc,o=e.styleCache,r=e.valueGetter,s=e.idManager,a=n.length,c,l,f;for(let d=0;d<a;++d){let p=n[d];c=[],l=[],f=[],vot(e,p,l,f),wot(e,p.polyline,l,f),d_e(e,p.rectangle,l,f,c),d_e(e,p.polygon,l,f,c),Rot(e,p,p.model,l,f);let g,m=p.availability;u(m)&&(g=i.createElement("TimeSpan"),$.equals(m.start,He.MINIMUM_VALUE)||g.appendChild(fn(i,"begin",$.toIso8601(m.start))),$.equals(m.stop,He.MAXIMUM_VALUE)||g.appendChild(fn(i,"end",$.toIso8601(m.stop))));for(let C=0;C<c.length;++C){let A=c[C];A.setAttribute("id",s.get(p.id)),A.appendChild(fn(i,"name",p.name)),A.appendChild(fn(i,"visibility",p.show)),A.appendChild(fn(i,"description",p.description)),u(g)&&A.appendChild(g),t.appendChild(A)}let y=l.length;if(y>0){let C=i.createElement("Placemark");C.setAttribute("id",s.get(p.id));let A=p.name,T=p.label;if(u(T)){let v=i.createElement("LabelStyle"),D=r.get(T.text);A=u(D)&&D.length>0?D:A;let O=r.getColor(T.fillColor);u(O)&&(v.appendChild(fn(i,"color",O)),v.appendChild(fn(i,"colorMode","normal")));let P=r.get(T.scale);u(P)&&v.appendChild(fn(i,"scale",P)),f.push(v)}C.appendChild(fn(i,"name",A)),C.appendChild(fn(i,"visibility",p.show)),C.appendChild(fn(i,"description",p.description)),u(g)&&C.appendChild(g),t.appendChild(C);let E=f.length;if(E>0){let v=i.createElement("Style");for(let D=0;D<E;++D)v.appendChild(f[D]);C.appendChild(fn(i,"styleUrl",o.get(v)))}if(l.length===1)C.appendChild(l[0]);else if(l.length>1){let v=i.createElement("MultiGeometry");for(let D=0;D<y;++D)v.appendChild(l[D]);C.appendChild(v)}}let b=p._children;if(b.length>0){let C=i.createElement("Folder");C.setAttribute("id",s.get(p.id)),C.appendChild(fn(i,"name",p.name)),C.appendChild(fn(i,"visibility",p.show)),C.appendChild(fn(i,"description",p.description)),t.appendChild(C),p_e(e,C,b)}}}var Rl=new h,Kc=new de,Kd=new $;function vot(e,t,n,i){let o=e.kmlDoc,r=e.ellipsoid,s=e.valueGetter,a=x(t.billboard,t.point);if(!u(a)&&!u(t.path))return;let c=t.position;if(!c.isConstant){__e(e,t,a,n,i);return}s.get(c,void 0,Rl);let l=fn(o,"coordinates",rb(Rl,r)),f=o.createElement("Point"),d=o.createElement("altitudeMode");d.appendChild(ab(e,a.heightReference)),f.appendChild(d),f.appendChild(l),n.push(f);let p=a instanceof Sc?y_e(e,a):g_e(e,a);i.push(p)}function __e(e,t,n,i,o){let r=e.kmlDoc,s=e.ellipsoid,a=e.valueGetter,c,l=t.position,f=!0;l instanceof Pa?(c=l.intervals,f=!1):c=x(t.availability,e.defaultAvailability);let d=n instanceof Z_,p,g,m,y=[];for(p=0;p<c.length;++p){let C=c.get(p),A=f?l:C.data,T=r.createElement("altitudeMode");A instanceof o_?(A=A._value,T.appendChild(ab(e,Xe.CLAMP_TO_GROUND))):u(n)?T.appendChild(ab(e,n.heightReference)):T.appendChild(ab(e,Xe.NONE));let E=[],v=[];if(A.isConstant){a.get(A,void 0,Rl);let O=fn(r,"coordinates",rb(Rl,s));E.push($.toIso8601(C.start)),v.push(O),E.push($.toIso8601(C.stop)),v.push(O)}else if(A instanceof Ra)for(m=A._property._times,g=0;g<m.length;++g)E.push($.toIso8601(m[g])),A.getValueInReferenceFrame(m[g],Gi.FIXED,Rl),v.push(rb(Rl,s));else if(A instanceof Nf){m=A._times;let O=A._values;for(g=0;g<m.length;++g)E.push($.toIso8601(m[g])),h.fromArray(O,g*3,Rl),v.push(rb(Rl,s))}else{let O=e.sampleDuration;C.start.clone(Kd),C.isStartIncluded||$.addSeconds(Kd,O,Kd);let P=C.stop;for(;$.lessThan(Kd,P);)A.getValue(Kd,Rl),E.push($.toIso8601(Kd)),v.push(rb(Rl,s)),$.addSeconds(Kd,O,Kd);C.isStopIncluded&&$.equals(Kd,P)&&(A.getValue(Kd,Rl),E.push($.toIso8601(Kd)),v.push(rb(Rl,s)))}let D=r.createElementNS(Zd,"Track");D.appendChild(T);for(let O=0;O<E.length;++O){let P=fn(r,"when",E[O]),M=fn(r,"coord",v[O],Zd);D.appendChild(P),D.appendChild(M)}d&&D.appendChild(x_e(e,n)),y.push(D)}if(y.length===1)i.push(y[0]);else if(y.length>1){let C=r.createElementNS(Zd,"MultiTrack");for(p=0;p<y.length;++p)C.appendChild(y[p]);i.push(C)}if(u(n)&&!d){let C=n instanceof Sc?y_e(e,n):g_e(e,n);o.push(C)}let b=t.path;if(u(b)){let C=a.get(b.width),A=b.material;if(u(A)||u(C)){let T=r.createElement("LineStyle");u(C)&&T.appendChild(fn(r,"width",C)),xY(e,A,T),o.push(T)}}}function g_e(e,t){let n=e.kmlDoc,i=e.valueGetter,o=n.createElement("IconStyle"),r=i.getColor(t.color);u(r)&&(o.appendChild(fn(n,"color",r)),o.appendChild(fn(n,"colorMode","normal")));let s=i.get(t.pixelSize);return u(s)&&o.appendChild(fn(n,"scale",s/_Y)),o}function y_e(e,t){let n=e.kmlDoc,i=e.valueGetter,o=e.externalFileHandler,r=n.createElement("IconStyle"),s=i.get(t.image);if(u(s)){s=o.texture(s);let p=n.createElement("Icon");p.appendChild(fn(n,"href",s));let g=i.get(t.imageSubRegion);u(g)&&(p.appendChild(fn(n,"x",g.x,Zd)),p.appendChild(fn(n,"y",g.y,Zd)),p.appendChild(fn(n,"w",g.width,Zd)),p.appendChild(fn(n,"h",g.height,Zd))),r.appendChild(p)}let a=i.getColor(t.color);u(a)&&(r.appendChild(fn(n,"color",a)),r.appendChild(fn(n,"colorMode","normal")));let c=i.get(t.scale);u(c)&&r.appendChild(fn(n,"scale",c));let l=i.get(t.pixelOffset);if(u(l)){c=x(c,1),H.divideByScalar(l,c,l);let p=i.get(t.width,_Y),g=i.get(t.height,_Y),m=i.get(t.horizontalOrigin,bi.CENTER);m===bi.CENTER?l.x-=p*.5:m===bi.RIGHT&&(l.x-=p);let y=i.get(t.verticalOrigin,On.CENTER);y===On.TOP?l.y+=g:y===On.CENTER&&(l.y+=g*.5);let b=n.createElement("hotSpot");b.setAttribute("x",-l.x),b.setAttribute("y",l.y),b.setAttribute("xunits","pixels"),b.setAttribute("yunits","pixels"),r.appendChild(b)}let f=i.get(t.rotation),d=i.get(t.alignedAxis);return u(f)&&h.equals(h.UNIT_Z,d)&&(f=R.toDegrees(-f),f===0&&(f=360),r.appendChild(fn(n,"heading",f))),r}function wot(e,t,n,i){let o=e.kmlDoc,r=e.ellipsoid,s=e.valueGetter;if(!u(t))return;let a=o.createElement("LineString"),c=o.createElement("altitudeMode"),l=s.get(t.clampToGround,!1),f;l?(a.appendChild(fn(o,"tessellate",!0)),f=o.createTextNode("clampToGround")):f=o.createTextNode("absolute"),c.appendChild(f),a.appendChild(c);let d=t.positions,p=s.get(d),g=fn(o,"coordinates",rb(p,r));a.appendChild(g);let m=s.get(t.zIndex);l&&u(m)&&a.appendChild(fn(o,"drawOrder",m,Zd)),n.push(a);let y=o.createElement("LineStyle"),b=s.get(t.width);u(b)&&y.appendChild(fn(o,"width",b)),xY(e,t.material,y),i.push(y)}function Dot(e,t,n){let i=e.kmlDoc,o=e.valueGetter,r=o.get(t.height,0);n>0&&(r=n);let s=t.coordinates,a=o.get(s),c=[],l=[se.northeast,se.southeast,se.southwest,se.northwest];for(let g=0;g<4;++g)l[g](a,Kc),c.push(`${R.toDegrees(Kc.longitude)},${R.toDegrees(Kc.latitude)},${r}`);let f=fn(i,"coordinates",c.join(" ")),d=i.createElement("outerBoundaryIs"),p=i.createElement("LinearRing");return p.appendChild(f),d.appendChild(p),[d]}function f_e(e,t,n,i){let o=e.kmlDoc,r=e.ellipsoid,s=[],a=t.length;for(let f=0;f<a;++f)de.fromCartesian(t[f],r,Kc),s.push(`${R.toDegrees(Kc.longitude)},${R.toDegrees(Kc.latitude)},${i?Kc.height:n}`);let c=fn(o,"coordinates",s.join(" ")),l=o.createElement("LinearRing");return l.appendChild(c),l}function Iot(e,t,n){let i=e.kmlDoc,o=e.valueGetter,r=o.get(t.height,0),s=o.get(t.perPositionHeight,!1);!s&&n>0&&(r=n);let a=[],c=t.hierarchy,l=o.get(c),f=Array.isArray(l)?l:l.positions,d=i.createElement("outerBoundaryIs");d.appendChild(f_e(e,f,r,s)),a.push(d);let p=l.holes;if(u(p)){let g=p.length;for(let m=0;m<g;++m){let y=i.createElement("innerBoundaryIs");y.appendChild(f_e(e,p[m].positions,r,s)),a.push(y)}}return a}function d_e(e,t,n,i,o){let r=e.kmlDoc,s=e.valueGetter;if(!u(t))return;let a=t instanceof Nh;if(a&&s.getMaterialType(t.material)==="Image"){Pot(e,t,o);return}let c=r.createElement("Polygon"),l=s.get(t.extrudedHeight,0);l>0&&c.appendChild(fn(r,"extrude",!0));let f=a?Dot(e,t,l):Iot(e,t,l),d=f.length;for(let b=0;b<d;++b)c.appendChild(f[b]);let p=r.createElement("altitudeMode");p.appendChild(ab(e,t.heightReference)),c.appendChild(p),n.push(c);let g=r.createElement("PolyStyle"),m=s.get(t.fill,!1);m&&g.appendChild(fn(r,"fill",m)),xY(e,t.material,g);let y=s.get(t.outline,!1);if(y){g.appendChild(fn(r,"outline",y));let b=r.createElement("LineStyle"),C=s.get(t.outlineWidth,1);b.appendChild(fn(r,"width",C));let A=s.getColor(t.outlineColor,G.BLACK);b.appendChild(fn(r,"color",A)),b.appendChild(fn(r,"colorMode","normal")),i.push(b)}i.push(g)}function Pot(e,t,n){let i=e.kmlDoc,o=e.valueGetter,r=e.externalFileHandler,s=i.createElement("GroundOverlay"),a=i.createElement("altitudeMode");a.appendChild(ab(e,t.heightReference)),s.appendChild(a);let c=o.get(t.height);u(c)&&s.appendChild(fn(i,"altitude",c));let l=o.get(t.coordinates),f=i.createElement("LatLonBox");f.appendChild(fn(i,"north",R.toDegrees(l.north))),f.appendChild(fn(i,"south",R.toDegrees(l.south))),f.appendChild(fn(i,"east",R.toDegrees(l.east))),f.appendChild(fn(i,"west",R.toDegrees(l.west))),s.appendChild(f);let d=o.get(t.material),p=r.texture(d.image),g=i.createElement("Icon");g.appendChild(fn(i,"href",p)),s.appendChild(g);let m=d.color;u(m)&&s.appendChild(fn(i,"color",sb(d.color))),n.push(s)}function x_e(e,t){let n=e.kmlDoc,i=e.valueGetter,o=e.externalFileHandler,r=n.createElement("Model"),s=i.get(t.scale);if(u(s)){let l=n.createElement("scale");l.appendChild(fn(n,"x",s)),l.appendChild(fn(n,"y",s)),l.appendChild(fn(n,"z",s)),r.appendChild(l)}let a=n.createElement("Link"),c=o.model(t,e.time);return a.appendChild(fn(n,"href",c)),r.appendChild(a),r}function Rot(e,t,n,i,o){let r=e.kmlDoc,s=e.ellipsoid,a=e.valueGetter;if(!u(n))return;let c=t.position;if(!c.isConstant){__e(e,t,n,i,o);return}let l=x_e(e,n),f=r.createElement("altitudeMode");f.appendChild(ab(e,n.heightReference)),l.appendChild(f),a.get(c,void 0,Rl),de.fromCartesian(Rl,s,Kc);let d=r.createElement("Location");d.appendChild(fn(r,"longitude",R.toDegrees(Kc.longitude))),d.appendChild(fn(r,"latitude",R.toDegrees(Kc.latitude))),d.appendChild(fn(r,"altitude",Kc.height)),l.appendChild(d),i.push(l)}function xY(e,t,n){let i=e.kmlDoc,o=e.valueGetter;if(!u(t))return;let r=o.get(t);if(!u(r))return;let s,a=o.getMaterialType(t),c,l;switch(a){case"Image":s=sb(G.WHITE);break;case"Color":case"Grid":case"PolylineGlow":case"PolylineArrow":case"PolylineDash":s=sb(r.color);break;case"PolylineOutline":s=sb(r.color),c=sb(r.outlineColor),l=r.outlineWidth,n.appendChild(fn(i,"outerColor",c,Zd)),n.appendChild(fn(i,"outerWidth",l,Zd));break;case"Stripe":s=sb(r.oddColor);break}u(s)&&(n.appendChild(fn(i,"color",s)),n.appendChild(fn(i,"colorMode","normal")))}function ab(e,t){let n=e.kmlDoc,o=e.valueGetter.get(t,Xe.NONE),r;switch(o){case Xe.NONE:r=n.createTextNode("absolute");break;case Xe.CLAMP_TO_GROUND:r=n.createTextNode("clampToGround");break;case Xe.RELATIVE_TO_GROUND:r=n.createTextNode("relativeToGround");break}return r}function rb(e,t){Array.isArray(e)||(e=[e]);let n=e.length,i=[];for(let o=0;o<n;++o)de.fromCartesian(e[o],t,Kc),i.push(`${R.toDegrees(Kc.longitude)},${R.toDegrees(Kc.latitude)},${Kc.height}`);return i.join(" ")}function fn(e,t,n,i){n=x(n,""),typeof n=="boolean"&&(n=n?"1":"0");let o=u(i)?e.createElementNS(i,t):e.createElement(t),r=n==="string"&&n.indexOf("<")!==-1?e.createCDATASection(n):e.createTextNode(n);return o.appendChild(r),o}function sb(e){let t="",n=e.toBytes();for(let i=3;i>=0;--i)t+=n[i]<16?`0${n[i].toString(16)}`:n[i].toString(16);return t}var b_e=yY;function uD(){this._cache={}}uD.prototype.fromColor=function(e,t){return iV(void 0,void 0,e,t,this._cache)};uD.prototype.fromUrl=function(e,t,n){return iV(e,void 0,t,n,this._cache)};uD.prototype.fromMakiIconId=function(e,t,n){return iV(on(`Assets/Textures/maki/${encodeURIComponent(e)}.png`),void 0,t,n,this._cache)};uD.prototype.fromText=function(e,t,n){return iV(void 0,e,t,n,this._cache)};var Oot=new G;function Mot(e,t,n){e.save(),e.scale(n/24,n/24),e.fillStyle=t.toCssColorString(),e.strokeStyle=t.brighten(.6,Oot).toCssColorString(),e.lineWidth=.846,e.beginPath(),e.moveTo(6.72,.422),e.lineTo(17.28,.422),e.bezierCurveTo(18.553,.422,19.577,1.758,19.577,3.415),e.lineTo(19.577,10.973),e.bezierCurveTo(19.577,12.63,18.553,13.966,17.282,13.966),e.lineTo(14.386,14.008),e.lineTo(11.826,23.578),e.lineTo(9.614,14.008),e.lineTo(6.719,13.965),e.bezierCurveTo(5.446,13.983,4.422,12.629,4.422,10.972),e.lineTo(4.422,3.416),e.bezierCurveTo(4.423,1.76,5.447,.423,6.718,.423),e.closePath(),e.fill(),e.stroke(),e.restore()}function C_e(e,t,n){let i=n/2.5,o=i,r=i;t.width>t.height?r=i*(t.height/t.width):t.width<t.height&&(o=i*(t.width/t.height));let s=Math.round((n-o)/2),a=Math.round(7/24*n-r/2);e.globalCompositeOperation="destination-out",e.drawImage(t,s-1,a,o,r),e.drawImage(t,s,a-1,o,r),e.drawImage(t,s+1,a,o,r),e.drawImage(t,s,a+1,o,r),e.globalCompositeOperation="destination-over",e.fillStyle=G.BLACK.toCssColorString(),e.fillRect(s-1,a-1,o+2,r+2),e.globalCompositeOperation="destination-out",e.drawImage(t,s,a,o,r),e.globalCompositeOperation="destination-over",e.fillStyle=G.WHITE.toCssColorString(),e.fillRect(s-1,a-2,o+2,r+2)}var lD=new Array(4);function iV(e,t,n,i,o){lD[0]=e,lD[1]=t,lD[2]=n,lD[3]=i;let r=JSON.stringify(lD),s=o[r];if(u(s))return s;let a=document.createElement("canvas");a.width=i,a.height=i;let c=a.getContext("2d");if(Mot(c,n,i),u(e)){let f=De.createIfNeeded(e).fetchImage().then(function(d){return C_e(c,d,i),o[r]=a,a});return o[r]=f,f}else if(u(t)){let l=qA(t,{font:`bold ${i}px sans-serif`});C_e(c,l,i)}return o[r]=a,a}var I0=uD;function bY(e){return e}function oV(e){if(e==null)return bY;var t,n,i=e.scale[0],o=e.scale[1],r=e.translate[0],s=e.translate[1];return function(a,c){c||(t=n=0);var l=2,f=a.length,d=new Array(f);for(d[0]=(t+=a[0])*i+r,d[1]=(n+=a[1])*o+s;l<f;)d[l]=a[l],++l;return d}}function A_e(e,t){for(var n,i=e.length,o=i-t;o<--i;)n=e[o],e[o++]=e[i],e[i]=n}function CY(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return T_e(e,n)})}:T_e(e,t)}function T_e(e,t){var n=t.id,i=t.bbox,o=t.properties==null?{}:t.properties,r=AY(e,t);return n==null&&i==null?{type:"Feature",properties:o,geometry:r}:i==null?{type:"Feature",id:n,properties:o,geometry:r}:{type:"Feature",id:n,bbox:i,properties:o,geometry:r}}function AY(e,t){var n=oV(e.transform),i=e.arcs;function o(f,d){d.length&&d.pop();for(var p=i[f<0?~f:f],g=0,m=p.length;g<m;++g)d.push(n(p[g],g));f<0&&A_e(d,m)}function r(f){return n(f)}function s(f){for(var d=[],p=0,g=f.length;p<g;++p)o(f[p],d);return d.length<2&&d.push(d[0]),d}function a(f){for(var d=s(f);d.length<4;)d.push(d[0]);return d}function c(f){return f.map(a)}function l(f){var d=f.type,p;switch(d){case"GeometryCollection":return{type:d,geometries:f.geometries.map(l)};case"Point":p=r(f.coordinates);break;case"MultiPoint":p=f.coordinates.map(r);break;case"LineString":p=s(f.arcs);break;case"MultiLineString":p=f.arcs.map(s);break;case"Polygon":p=c(f.arcs);break;case"MultiPolygon":p=f.arcs.map(c);break;default:return null}return{type:d,coordinates:p}}return l(t)}function rV(e){return h.fromDegrees(e[0],e[1],e[2])}var TY={"urn:ogc:def:crs:OGC:1.3:CRS84":rV,"EPSG:4326":rV,"urn:ogc:def:crs:EPSG::4326":rV},E_e={},S_e={},EY=48,SY,vY=G.ROYALBLUE,wY=G.YELLOW,DY=2,IY=G.fromBytes(255,255,0,100),PY=!1,kot={small:24,medium:48,large:64},Vot=["title","description","marker-size","marker-symbol","marker-color","stroke","stroke-opacity","stroke-width","fill","fill-opacity"];function v_e(e,t){let n="";for(let i in e)if(e.hasOwnProperty(i)){if(i===t||Vot.indexOf(i)!==-1)continue;let o=e[i];u(o)&&(typeof o=="object"?n+=`<tr><th>${i}</th><td>${v_e(o)}</td></tr>`:n+=`<tr><th>${i}</th><td>${o}</td></tr>`)}return n.length>0&&(n=`<table class="cesium-infoBox-defaultTable"><tbody>${n}</tbody></table>`),n}function Uot(e,t,n){let i;return function(o,r){return u(i)||(i=e(t,n)),i}}function zot(e,t){return new Fh(Uot(v_e,e,t),!0)}function sV(e,t,n){let i=e.id;if(!u(i)||e.type!=="Feature")i=Hn();else{let s=2,a=i;for(;u(t.getById(a));)a=`${i}_${s}`,s++;i=a}let o=t.getOrCreateEntity(i),r=e.properties;if(u(r)){o.properties=r;let s,a=r.title;if(u(a))o.name=a,s="title";else{let l=Number.MAX_VALUE;for(let f in r)if(r.hasOwnProperty(f)&&r[f]){let d=f.toLowerCase();if(l>1&&d==="title"){l=1,s=f;break}else l>2&&d==="name"?(l=2,s=f):l>3&&/title/i.test(f)?(l=3,s=f):l>4&&/name/i.test(f)&&(l=4,s=f)}u(s)&&(o.name=r[s])}let c=r.description;c!==null&&(o.description=u(c)?new Kn(c):n(r,s))}return o}function RY(e,t){let n=new Array(e.length);for(let i=0;i<e.length;i++)n[i]=t(e[i]);return n}var w_e={Feature:I_e,FeatureCollection:Hot,GeometryCollection:P_e,LineString:N_e,MultiLineString:F_e,MultiPoint:M_e,MultiPolygon:V_e,Point:O_e,Polygon:k_e,Topology:U_e},D_e={GeometryCollection:P_e,LineString:N_e,MultiLineString:F_e,MultiPoint:M_e,MultiPolygon:V_e,Point:O_e,Polygon:k_e,Topology:U_e};function I_e(e,t,n,i,o){if(t.geometry===null){sV(t,e._entityCollection,o.describe);return}if(!u(t.geometry))throw new ce("feature.geometry is required.");let r=t.geometry.type,s=D_e[r];if(!u(s))throw new ce(`Unknown geometry type: ${r}`);s(e,t,t.geometry,i,o)}function Hot(e,t,n,i,o){let r=t.features;for(let s=0,a=r.length;s<a;s++)I_e(e,r[s],void 0,i,o)}function P_e(e,t,n,i,o){let r=n.geometries;for(let s=0,a=r.length;s<a;s++){let c=r[s],l=c.type,f=D_e[l];if(!u(f))throw new ce(`Unknown geometry type: ${l}`);f(e,t,c,i,o)}}function R_e(e,t,n,i,o){let r=o.markerSymbol,s=o.markerColor,a=o.markerSize,c=t.properties;if(u(c)){let g=c["marker-color"];u(g)&&(s=G.fromCssColorString(g)),a=x(kot[c["marker-size"]],a);let m=c["marker-symbol"];u(m)&&(r=m)}let l;u(r)?r.length===1?l=e._pinBuilder.fromText(r.toUpperCase(),s,a):l=e._pinBuilder.fromMakiIconId(r,s,a):l=e._pinBuilder.fromColor(s,a);let f=new Sc;f.verticalOrigin=new Kn(On.BOTTOM),i.length===2&&o.clampToGround&&(f.heightReference=Xe.CLAMP_TO_GROUND);let d=sV(t,e._entityCollection,o.describe);d.billboard=f,d.position=new gl(n(i));let p=Promise.resolve(l).then(function(g){f.image=new Kn(g)}).catch(function(){f.image=new Kn(e._pinBuilder.fromColor(s,a))});e._promises.push(p)}function O_e(e,t,n,i,o){R_e(e,t,i,n.coordinates,o)}function M_e(e,t,n,i,o){let r=n.coordinates;for(let s=0;s<r.length;s++)R_e(e,t,i,r[s],o)}function L_e(e,t,n,i,o){let r=o.strokeMaterialProperty,s=o.strokeWidthProperty,a=t.properties;if(u(a)){let f=a["stroke-width"];u(f)&&(s=new Kn(f));let d,p=a.stroke;u(p)&&(d=G.fromCssColorString(p));let g=a["stroke-opacity"];u(g)&&g!==1&&(u(d)||(d=r.color.getValue().clone()),d.alpha=g),u(d)&&(r=new Ht(d))}let c=sV(t,e._entityCollection,o.describe),l=new Pc;c.polyline=l,l.clampToGround=o.clampToGround,l.material=r,l.width=s,l.positions=new Kn(RY(i,n)),l.arcType=nn.RHUMB}function N_e(e,t,n,i,o){L_e(e,t,i,n.coordinates,o)}function F_e(e,t,n,i,o){let r=n.coordinates;for(let s=0;s<r.length;s++)L_e(e,t,i,r[s],o)}function B_e(e,t,n,i,o){if(i.length===0||i[0].length===0)return;let r=o.strokeMaterialProperty.color,s=o.fillMaterialProperty,a=o.strokeWidthProperty,c=t.properties;if(u(c)){let g=c["stroke-width"];u(g)&&(a=new Kn(g));let m,y=c.stroke;u(y)&&(m=G.fromCssColorString(y));let b=c["stroke-opacity"];u(b)&&b!==1&&(u(m)||(m=r.getValue().clone()),m.alpha=b),u(m)&&(r=new Kn(m));let C,A=c.fill,T=s.color.getValue();u(A)&&(C=G.fromCssColorString(A),C.alpha=T.alpha),b=c["fill-opacity"],u(b)&&b!==T.alpha&&(u(C)||(C=T.clone()),C.alpha=b),u(C)&&(s=new Ht(C))}let l=new Lh;l.outline=new Kn(!0),l.outlineColor=r,l.outlineWidth=a,l.material=s,l.arcType=nn.RHUMB;let f=[];for(let g=1,m=i.length;g<m;g++)f.push(new Za(RY(i[g],n)));let d=i[0];l.hierarchy=new Kn(new Za(RY(d,n),f)),d[0].length>2?l.perPositionHeight=new Kn(!0):o.clampToGround||(l.height=0);let p=sV(t,e._entityCollection,o.describe);p.polygon=l}function k_e(e,t,n,i,o){B_e(e,t,i,n.coordinates,o)}function V_e(e,t,n,i,o){let r=n.coordinates;for(let s=0;s<r.length;s++)B_e(e,t,i,r[s],o)}function U_e(e,t,n,i,o){for(let r in n.objects)if(n.objects.hasOwnProperty(r)){let s=CY(n,n.objects[r]),a=w_e[s.type];a(e,s,s,i,o)}}function P0(e){this._name=e,this._changed=new me,this._error=new me,this._isLoading=!1,this._loading=new me,this._entityCollection=new la(this),this._promises=[],this._pinBuilder=new I0,this._entityCluster=new Mf,this._credit=void 0,this._resourceCredits=[]}P0.load=function(e,t){return new P0().load(e,t)};Object.defineProperties(P0,{markerSize:{get:function(){return EY},set:function(e){EY=e}},markerSymbol:{get:function(){return SY},set:function(e){SY=e}},markerColor:{get:function(){return vY},set:function(e){vY=e}},stroke:{get:function(){return wY},set:function(e){wY=e}},strokeWidth:{get:function(){return DY},set:function(e){DY=e}},fill:{get:function(){return IY},set:function(e){IY=e}},clampToGround:{get:function(){return PY},set:function(e){PY=e}},crsNames:{get:function(){return TY}},crsLinkHrefs:{get:function(){return E_e}},crsLinkTypes:{get:function(){return S_e}}});Object.defineProperties(P0.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{value:void 0,writable:!1},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}},credit:{get:function(){return this._credit}}});P0.prototype.load=function(e,t){return z_e(this,e,t,!0)};P0.prototype.process=function(e,t){return z_e(this,e,t,!1)};function z_e(e,t,n,i){Kr.setLoading(e,!0),n=x(n,x.EMPTY_OBJECT);let o=n.credit;typeof o=="string"&&(o=new wt(o)),e._credit=o;let r=t,s=n.sourceUri;if(typeof t=="string"||t instanceof De){t=De.createIfNeeded(t),r=t.fetchJson(),s=x(s,t.getUrlComponent());let a=e._resourceCredits,c=t.credits;if(u(c)){let l=c.length;for(let f=0;f<l;f++)a.push(c[f])}}return n={describe:x(n.describe,zot),markerSize:x(n.markerSize,EY),markerSymbol:x(n.markerSymbol,SY),markerColor:x(n.markerColor,vY),strokeWidthProperty:new Kn(x(n.strokeWidth,DY)),strokeMaterialProperty:new Ht(x(n.stroke,wY)),fillMaterialProperty:new Ht(x(n.fill,IY)),clampToGround:x(n.clampToGround,PY)},Promise.resolve(r).then(function(a){return Got(e,a,n,s,i)}).catch(function(a){throw Kr.setLoading(e,!1),e._error.raiseEvent(e,a),a})}P0.prototype.update=function(e){return!0};function Got(e,t,n,i,o){let r;u(i)&&(r=o0(i)),u(r)&&e._name!==r&&(e._name=r,e._changed.raiseEvent(e));let s=w_e[t.type];if(!u(s))throw new ce(`Unsupported GeoJSON object type: ${t.type}`);let a=t.crs,c=a!==null?rV:null;if(u(a)){if(!u(a.properties))throw new ce("crs.properties is undefined.");let l=a.properties;if(a.type==="name"){if(c=TY[l.name],!u(c))throw new ce(`Unknown crs name: ${l.name}`)}else if(a.type==="link"){let f=E_e[l.href];if(u(f)||(f=S_e[l.type]),!u(f))throw new ce(`Unable to resolve crs link: ${JSON.stringify(l)}`);c=f(l)}else if(a.type==="EPSG"){if(c=TY[`EPSG:${l.code}`],!u(c))throw new ce(`Unknown crs EPSG code: ${l.code}`)}else throw new ce(`Unknown crs type: ${a.type}`)}return Promise.resolve(c).then(function(l){return o&&e._entityCollection.removeAll(),l!==null&&s(e,t,t,l,n),Promise.all(e._promises).then(function(){return e._promises.length=0,Kr.setLoading(e,!1),e})})}var aV=P0;function Wot(e){return typeof e=="string"&&(e=document.getElementById(e)),e}var Rn=Wot;var H_e="4.0.0";function jot(e){return e===void 0}function Tu(e){return typeof e=="boolean"}function G_e(e,t){for(var n in t)t.hasOwnProperty(n)&&jot(e[n])&&(e[n]=t[n]);return e}function W_e(e,t,n){var i;return e.length>t&&(n==null?(n="&hellip;",i=3):i=n.length,e=e.substring(0,t-i)+n),e}function Wo(e,t){for(var n=e.length-1;n>=0;n--)e[n]===t&&e.splice(n,1)}function R0(e,t){for(var n=e.length-1;n>=0;n--)t(e[n])===!0&&e.splice(n,1)}function O0(e){throw new Error("Unhandled case for value: '".concat(e,"'"))}var M0=/[A-Za-z]/,js=/[\d]/;var Eu=/\s/,cV=/['"]/,j_e=/[\x00-\x1F\x7F]/,q_e=/A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC/.source,qot=/\u2700-\u27bf\udde6-\uddff\ud800-\udbff\udc00-\udfff\ufe0e\ufe0f\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0\ud83c\udffb-\udfff\u200d\u3299\u3297\u303d\u3030\u24c2\ud83c\udd70-\udd71\udd7e-\udd7f\udd8e\udd91-\udd9a\udde6-\uddff\ude01-\ude02\ude1a\ude2f\ude32-\ude3a\ude50-\ude51\u203c\u2049\u25aa-\u25ab\u25b6\u25c0\u25fb-\u25fe\u00a9\u00ae\u2122\u2139\udc04\u2600-\u26FF\u2b05\u2b06\u2b07\u2b1b\u2b1c\u2b50\u2b55\u231a\u231b\u2328\u23cf\u23e9-\u23f3\u23f8-\u23fa\udccf\u2935\u2934\u2190-\u21ff/.source,Yot=/\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D4-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F/.source,Xot=q_e+qot+Yot,Y_e=/0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19/.source,uti=new RegExp("[".concat(q_e+Y_e,"]")),OY=Xot+Y_e,$d=new RegExp("[".concat(OY,"]"));var lV=function(){function e(t){t===void 0&&(t={}),this.tagName="",this.attrs={},this.innerHTML="",this.tagName=t.tagName||"",this.attrs=t.attrs||{},this.innerHTML=t.innerHtml||t.innerHTML||""}return e.prototype.setTagName=function(t){return this.tagName=t,this},e.prototype.getTagName=function(){return this.tagName||""},e.prototype.setAttr=function(t,n){var i=this.getAttrs();return i[t]=n,this},e.prototype.getAttr=function(t){return this.getAttrs()[t]},e.prototype.setAttrs=function(t){return Object.assign(this.getAttrs(),t),this},e.prototype.getAttrs=function(){return this.attrs||(this.attrs={})},e.prototype.setClass=function(t){return this.setAttr("class",t)},e.prototype.addClass=function(t){for(var n=this.getClass(),i=n?n.split(Eu):[],o=t.split(Eu),r;r=o.shift();)i.indexOf(r)===-1&&i.push(r);return this.getAttrs().class=i.join(" "),this},e.prototype.removeClass=function(t){for(var n=this.getClass(),i=n?n.split(Eu):[],o=t.split(Eu),r;i.length&&(r=o.shift());){var s=i.indexOf(r);s!==-1&&i.splice(s,1)}return this.getAttrs().class=i.join(" "),this},e.prototype.getClass=function(){return this.getAttrs().class||""},e.prototype.hasClass=function(t){return(" "+this.getClass()+" ").indexOf(" "+t+" ")!==-1},e.prototype.setInnerHTML=function(t){return this.innerHTML=t,this},e.prototype.setInnerHtml=function(t){return this.setInnerHTML(t)},e.prototype.getInnerHTML=function(){return this.innerHTML||""},e.prototype.getInnerHtml=function(){return this.getInnerHTML()},e.prototype.toAnchorString=function(){var t=this.getTagName(),n=this.buildAttrsStr();return n=n?" "+n:"",["<",t,n,">",this.getInnerHtml(),"</",t,">"].join("")},e.prototype.buildAttrsStr=function(){if(!this.attrs)return"";var t=this.getAttrs(),n=[];for(var i in t)t.hasOwnProperty(i)&&n.push(i+'="'+t[i]+'"');return n.join(" ")},e}();function X_e(e,t,n){var i,o;n==null?(n="&hellip;",o=3,i=8):(o=n.length,i=n.length);var r=function(A){var T={},E=A,v=E.match(/^([a-z]+):\/\//i);return v&&(T.scheme=v[1],E=E.substr(v[0].length)),v=E.match(/^(.*?)(?=(\?|#|\/|$))/i),v&&(T.host=v[1],E=E.substr(v[0].length)),v=E.match(/^\/(.*?)(?=(\?|#|$))/i),v&&(T.path=v[1],E=E.substr(v[0].length)),v=E.match(/^\?(.*?)(?=(#|$))/i),v&&(T.query=v[1],E=E.substr(v[0].length)),v=E.match(/^#(.*?)$/i),v&&(T.fragment=v[1]),T},s=function(A){var T="";return A.scheme&&A.host&&(T+=A.scheme+"://"),A.host&&(T+=A.host),A.path&&(T+="/"+A.path),A.query&&(T+="?"+A.query),A.fragment&&(T+="#"+A.fragment),T},a=function(A,T){var E=T/2,v=Math.ceil(E),D=-1*Math.floor(E),O="";return D<0&&(O=A.substr(D)),A.substr(0,v)+n+O};if(e.length<=t)return e;var c=t-o,l=r(e);if(l.query){var f=l.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i);f&&(l.query=l.query.substr(0,f[1].length),e=s(l))}if(e.length<=t||(l.host&&(l.host=l.host.replace(/^www\./,""),e=s(l)),e.length<=t))return e;var d="";if(l.host&&(d+=l.host),d.length>=c)return l.host.length==t?(l.host.substr(0,t-o)+n).substr(0,c+i):a(d,c).substr(0,c+i);var p="";if(l.path&&(p+="/"+l.path),l.query&&(p+="?"+l.query),p)if((d+p).length>=c){if((d+p).length==t)return(d+p).substr(0,t);var g=c-d.length;return(d+a(p,g)).substr(0,c+i)}else d+=p;if(l.fragment){var m="#"+l.fragment;if((d+m).length>=c){if((d+m).length==t)return(d+m).substr(0,t);var y=c-d.length;return(d+a(m,y)).substr(0,c+i)}else d+=m}if(l.scheme&&l.host){var b=l.scheme+"://";if((d+b).length<c)return(b+d).substr(0,t)}if(d.length<=t)return d;var C="";return c>0&&(C=d.substr(-1*Math.floor(c/2))),(d.substr(0,Math.ceil(c/2))+n+C).substr(0,c+i)}function K_e(e,t,n){if(e.length<=t)return e;var i,o;n==null?(n="&hellip;",i=8,o=3):(i=n.length,o=n.length);var r=t-o,s="";return r>0&&(s=e.substr(-1*Math.floor(r/2))),(e.substr(0,Math.ceil(r/2))+n+s).substr(0,r+i)}function Z_e(e,t,n){return W_e(e,t,n)}var $_e=function(){function e(t){t===void 0&&(t={}),this.newWindow=!1,this.truncate={},this.className="",this.newWindow=t.newWindow||!1,this.truncate=t.truncate||{},this.className=t.className||""}return e.prototype.build=function(t){return new lV({tagName:"a",attrs:this.createAttrs(t),innerHtml:this.processAnchorText(t.getAnchorText())})},e.prototype.createAttrs=function(t){var n={href:t.getAnchorHref()},i=this.createCssClass(t);return i&&(n.class=i),this.newWindow&&(n.target="_blank",n.rel="noopener noreferrer"),this.truncate&&this.truncate.length&&this.truncate.length<t.getAnchorText().length&&(n.title=t.getAnchorHref()),n},e.prototype.createCssClass=function(t){var n=this.className;if(n){for(var i=[n],o=t.getCssClassSuffixes(),r=0,s=o.length;r<s;r++)i.push(n+"-"+o[r]);return i.join(" ")}else return""},e.prototype.processAnchorText=function(t){return t=this.doTruncate(t),t},e.prototype.doTruncate=function(t){var n=this.truncate;if(!n||!n.length)return t;var i=n.length,o=n.location;return o==="smart"?X_e(t,i):o==="middle"?K_e(t,i):Z_e(t,i)},e}();var MY=function(e,t){return MY=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},MY(e,t)};function Tm(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");MY(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var qs=function(){return qs=Object.assign||function(t){for(var n,i=1,o=arguments.length;i<o;i++){n=arguments[i];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qs.apply(this,arguments)};var Em=function(){function e(t){this._=null,this.matchedText="",this.offset=0,this.tagBuilder=t.tagBuilder,this.matchedText=t.matchedText,this.offset=t.offset}return e.prototype.getMatchedText=function(){return this.matchedText},e.prototype.setOffset=function(t){this.offset=t},e.prototype.getOffset=function(){return this.offset},e.prototype.getCssClassSuffixes=function(){return[this.type]},e.prototype.buildTag=function(){return this.tagBuilder.build(this)},e}();var Kot="(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|verm\xF6gensberatung|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbah1a3hjkrd|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|verm\xF6gensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--mgbcpq6gpa1a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq480n2rg|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|travelchannel|wolterskluwer|xn--cckwcxetd|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--4dbrk0ce|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b|\u0B9A\u0BBF\u0B99\u0BCD\u0B95\u0BAA\u0BCD\u0BAA\u0BC2\u0BB0\u0BCD|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nextdirect|properties|protection|prudential|realestate|republican|restaurant|schaeffler|tatamotors|technology|university|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--q7ce6a|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|institute|insurance|kuokgroup|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--qxa6a|xn--tckwe|xn--vhquv|yodobashi|\u0645\u0648\u0631\u064A\u062A\u0627\u0646\u064A\u0627|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|builders|business|capetown|catering|catholic|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|etisalat|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|training|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama|\u0627\u0644\u0633\u0639\u0648\u062F\u064A\u0629|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lanxess|lasalle|latrobe|leclerc|limited|lincoln|markets|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|singles|staples|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|\u043A\u0430\u0442\u043E\u043B\u0438\u043A|\u0627\u062A\u0635\u0627\u0644\u0627\u062A|\u0627\u0644\u0628\u062D\u0631\u064A\u0646|\u0627\u0644\u062C\u0632\u0627\u0626\u0631|\u0627\u0644\u0639\u0644\u064A\u0627\u0646|\u067E\u0627\u06A9\u0633\u062A\u0627\u0646|\u0643\u0627\u062B\u0648\u0644\u064A\u0643|\u0B87\u0BA8\u0BCD\u0BA4\u0BBF\u0BAF\u0BBE|abarth|abbott|abbvie|africa|agency|airbus|airtel|alipay|alsace|alstom|amazon|anquan|aramco|author|bayern|beauty|berlin|bharti|bostik|boston|broker|camera|career|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|webcam|xihuan|yachts|yandex|zappos|\u043C\u043E\u0441\u043A\u0432\u0430|\u043E\u043D\u043B\u0430\u0439\u043D|\u0627\u0628\u0648\u0638\u0628\u064A|\u0627\u0631\u0627\u0645\u0643\u0648|\u0627\u0644\u0627\u0631\u062F\u0646|\u0627\u0644\u0645\u063A\u0631\u0628|\u0627\u0645\u0627\u0631\u0627\u062A|\u0641\u0644\u0633\u0637\u064A\u0646|\u0645\u0644\u064A\u0633\u064A\u0627|\u092D\u093E\u0930\u0924\u092E\u094D|\u0B87\u0BB2\u0B99\u0BCD\u0B95\u0BC8|\u30D5\u30A1\u30C3\u30B7\u30E7\u30F3|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|drive|dubai|earth|edeka|email|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|irish|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|loans|locus|lotte|lotto|macys|mango|media|miami|money|movie|music|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|\u05D9\u05E9\u05E8\u05D0\u05DC|\u0627\u06CC\u0631\u0627\u0646|\u0628\u0627\u0632\u0627\u0631|\u0628\u06BE\u0627\u0631\u062A|\u0633\u0648\u062F\u0627\u0646|\u0633\u0648\u0631\u064A\u0629|\u0647\u0645\u0631\u0627\u0647|\u092D\u093E\u0930\u094B\u0924|\u0938\u0902\u0917\u0920\u0928|\u09AC\u09BE\u0982\u09B2\u09BE|\u0C2D\u0C3E\u0C30\u0C24\u0C4D|\u0D2D\u0D3E\u0D30\u0D24\u0D02|\u5609\u91CC\u5927\u9152\u5E97|aarp|able|adac|aero|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kids|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|read|reit|rent|rest|rich|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone|\u0434\u0435\u0442\u0438|\u0441\u0430\u0439\u0442|\u0628\u0627\u0631\u062A|\u0628\u064A\u062A\u0643|\u0680\u0627\u0631\u062A|\u062A\u0648\u0646\u0633|\u0634\u0628\u0643\u0629|\u0639\u0631\u0627\u0642|\u0639\u0645\u0627\u0646|\u0645\u0648\u0642\u0639|\u092D\u093E\u0930\u0924|\u09AD\u09BE\u09B0\u09A4|\u09AD\u09BE\u09F0\u09A4|\u0A2D\u0A3E\u0A30\u0A24|\u0AAD\u0ABE\u0AB0\u0AA4|\u0B2D\u0B3E\u0B30\u0B24|\u0CAD\u0CBE\u0CB0\u0CA4|\u0DBD\u0D82\u0D9A\u0DCF|\u30A2\u30DE\u30BE\u30F3|\u30B0\u30FC\u30B0\u30EB|\u30AF\u30E9\u30A6\u30C9|\u30DD\u30A4\u30F3\u30C8|\u7EC4\u7EC7\u673A\u6784|\u96FB\u8A0A\u76C8\u79D1|\u9999\u683C\u91CC\u62C9|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceo|cfa|cfd|com|cpa|crs|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gay|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|llp|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|spa|srl|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip|\u0431\u0435\u043B|\u043A\u043E\u043C|\u049B\u0430\u0437|\u043C\u043A\u0434|\u043C\u043E\u043D|\u043E\u0440\u0433|\u0440\u0443\u0441|\u0441\u0440\u0431|\u0443\u043A\u0440|\u0570\u0561\u0575|\u05E7\u05D5\u05DD|\u0639\u0631\u0628|\u0642\u0637\u0631|\u0643\u0648\u0645|\u0645\u0635\u0631|\u0915\u0949\u092E|\u0928\u0947\u091F|\u0E04\u0E2D\u0E21|\u0E44\u0E17\u0E22|\u0EA5\u0EB2\u0EA7|\u30B9\u30C8\u30A2|\u30BB\u30FC\u30EB|\u307F\u3093\u306A|\u4E2D\u6587\u7F51|\u4E9A\u9A6C\u900A|\u5929\u4E3B\u6559|\u6211\u7231\u4F60|\u65B0\u52A0\u5761|\u6DE1\u9A6C\u9521|\u8BFA\u57FA\u4E9A|\u98DE\u5229\u6D66|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|\u03B5\u03BB|\u03B5\u03C5|\u0431\u0433|\u0435\u044E|\u0440\u0444|\u10D2\u10D4|\uB2F7\uB137|\uB2F7\uCEF4|\uC0BC\uC131|\uD55C\uAD6D|\u30B3\u30E0|\u4E16\u754C|\u4E2D\u4FE1|\u4E2D\u56FD|\u4E2D\u570B|\u4F01\u4E1A|\u4F5B\u5C71|\u4FE1\u606F|\u5065\u5EB7|\u516B\u5366|\u516C\u53F8|\u516C\u76CA|\u53F0\u6E7E|\u53F0\u7063|\u5546\u57CE|\u5546\u5E97|\u5546\u6807|\u5609\u91CC|\u5728\u7EBF|\u5927\u62FF|\u5A31\u4E50|\u5BB6\u96FB|\u5E7F\u4E1C|\u5FAE\u535A|\u6148\u5584|\u624B\u673A|\u62DB\u8058|\u653F\u52A1|\u653F\u5E9C|\u65B0\u95FB|\u65F6\u5C1A|\u66F8\u7C4D|\u673A\u6784|\u6E38\u620F|\u6FB3\u9580|\u70B9\u770B|\u79FB\u52A8|\u7F51\u5740|\u7F51\u5E97|\u7F51\u7AD9|\u7F51\u7EDC|\u8054\u901A|\u8C37\u6B4C|\u8D2D\u7269|\u901A\u8CA9|\u96C6\u56E2|\u98DF\u54C1|\u9910\u5385|\u9999\u6E2F)",Q_e=new RegExp("^"+Kot+"$");var Zot=/[\/?#]/,$ot=/[-+&@#/%=~_()|'$*\[\]{}\u2713]/,J_e=/[?!:,.;^]/,LY=/https?:\/\//i,ege=new RegExp("^"+LY.source,"i"),tge=new RegExp(J_e.source+"$"),Qot=/^(javascript|vbscript):/i,Jot=/^[A-Za-z][-.+A-Za-z0-9]*:(\/\/)?([^:/]*)/,ert=/^(?:\/\/)?([^/#?:]+)/;function uV(e){return M0.test(e)}function NY(e){return M0.test(e)||js.test(e)||e==="+"||e==="-"||e==="."}function l_(e){return $d.test(e)}function fV(e){return e==="_"||l_(e)}function FY(e){return $d.test(e)||$ot.test(e)||J_e.test(e)}function dV(e){return Zot.test(e)}function BY(e){return Q_e.test(e.toLowerCase())}function nge(e){if(Qot.test(e))return!1;var t=e.match(Jot);if(!t)return!1;var n=!!t[1],i=t[2];return n?!0:!(i.indexOf(".")===-1||!M0.test(i))}function ige(e){var t=e.match(ert);if(!t)return!1;var n=t[0],i=n.split(".");if(i.length<2)return!1;var o=i[i.length-1];return!!BY(o)}var trt=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,nrt=/[:/?#]/;function oge(e){var t=e.split(nrt,1)[0];return trt.test(t)}var irt=/^(https?:\/\/)?(www\.)?/i,ort=/^\/\//,rge=function(e){Tm(t,e);function t(n){var i=e.call(this,n)||this;return i.type="url",i.url="",i.urlMatchType="scheme",i.protocolRelativeMatch=!1,i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.protocolPrepended=!1,i.urlMatchType=n.urlMatchType,i.url=n.url,i.protocolRelativeMatch=n.protocolRelativeMatch,i.stripPrefix=n.stripPrefix,i.stripTrailingSlash=n.stripTrailingSlash,i.decodePercentEncoding=n.decodePercentEncoding,i}return t.prototype.getType=function(){return"url"},t.prototype.getUrlMatchType=function(){return this.urlMatchType},t.prototype.getUrl=function(){var n=this.url;return!this.protocolRelativeMatch&&this.urlMatchType!=="scheme"&&!this.protocolPrepended&&(n=this.url="http://"+n,this.protocolPrepended=!0),n},t.prototype.getAnchorHref=function(){var n=this.getUrl();return n.replace(/&amp;/g,"&")},t.prototype.getAnchorText=function(){var n=this.getMatchedText();return this.protocolRelativeMatch&&(n=art(n)),this.stripPrefix.scheme&&(n=rrt(n)),this.stripPrefix.www&&(n=srt(n)),this.stripTrailingSlash&&(n=crt(n)),this.decodePercentEncoding&&(n=lrt(n)),n},t}(Em);function rrt(e){return e.replace(ege,"")}function srt(e){return e.replace(irt,"$1")}function art(e){return e.replace(ort,"")}function crt(e){return e.charAt(e.length-1)==="/"&&(e=e.slice(0,-1)),e}function lrt(e){var t=e.replace(/%22/gi,"&quot;").replace(/%26/gi,"&amp;").replace(/%27/gi,"&#39;").replace(/%3C/gi,"&lt;").replace(/%3E/gi,"&gt;");try{return decodeURIComponent(t)}catch{return t}}var sge=/^mailto:/i,urt=new RegExp("[".concat(OY,"!#$%&'*+/=?^_`{|}~-]"));function age(e){return $d.test(e)}function hV(e){return urt.test(e)}function cge(e){var t=e.split(".").pop()||"";return BY(t)}var lge=function(e){Tm(t,e);function t(n){var i=e.call(this,n)||this;return i.type="email",i.email="",i.email=n.email,i}return t.prototype.getType=function(){return"email"},t.prototype.getEmail=function(){return this.email},t.prototype.getAnchorHref=function(){return"mailto:"+this.email},t.prototype.getAnchorText=function(){return this.email},t}(Em);function kY(e){return e==="_"||$d.test(e)}function uge(e){return e.length<=140}var fge=["twitter","facebook","instagram","tiktok"];var dge=function(e){Tm(t,e);function t(n){var i=e.call(this,n)||this;return i.type="hashtag",i.serviceName="twitter",i.hashtag="",i.serviceName=n.serviceName,i.hashtag=n.hashtag,i}return t.prototype.getType=function(){return"hashtag"},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getHashtag=function(){return this.hashtag},t.prototype.getAnchorHref=function(){var n=this.serviceName,i=this.hashtag;switch(n){case"twitter":return"https://twitter.com/hashtag/"+i;case"facebook":return"https://www.facebook.com/hashtag/"+i;case"instagram":return"https://instagram.com/explore/tags/"+i;case"tiktok":return"https://www.tiktok.com/tag/"+i;default:throw O0(n),new Error("Invalid hashtag service: ".concat(n))}},t.prototype.getAnchorText=function(){return"#"+this.hashtag},t.prototype.getCssClassSuffixes=function(){var n=e.prototype.getCssClassSuffixes.call(this),i=this.getServiceName();return i&&n.push(i),n},t}(Em);var frt={twitter:/^@\w{1,15}$/,instagram:/^@[_\w]{1,30}$/,soundcloud:/^@[-a-z0-9_]{3,25}$/,tiktok:/^@[.\w]{1,23}[\w]$/},drt=/[-\w.]/;function VY(e){return drt.test(e)}function hge(e,t){var n=frt[t];return n.test(e)}var mge=["twitter","instagram","soundcloud","tiktok"];var pge=function(e){Tm(t,e);function t(n){var i=e.call(this,n)||this;return i.type="mention",i.serviceName="twitter",i.mention="",i.mention=n.mention,i.serviceName=n.serviceName,i}return t.prototype.getType=function(){return"mention"},t.prototype.getMention=function(){return this.mention},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getAnchorHref=function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;case"soundcloud":return"https://soundcloud.com/"+this.mention;case"tiktok":return"https://www.tiktok.com/@"+this.mention;default:throw new Error("Unknown service name to point mention to: "+this.serviceName)}},t.prototype.getAnchorText=function(){return"@"+this.mention},t.prototype.getCssClassSuffixes=function(){var n=e.prototype.getCssClassSuffixes.call(this),i=this.getServiceName();return i&&n.push(i),n},t}(Em);var hrt=/[-. ]/,mrt=/[-. ()]/,prt=/[,;]/,_rt=/(?:(?:(?:(\+)?\d{1,3}[-. ]?)?\(?\d{3}\)?[-. ]?\d{3}[-. ]?\d{4})|(?:(\+)(?:9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-. ]?(?:\d[-. ]?){6,12}\d+))([,;]+[0-9]+#?)*/,grt=/(0([1-9]-?[1-9]\d{3}|[1-9]{2}-?\d{3}|[1-9]{2}\d{1}-?\d{2}|[1-9]{2}\d{2}-?\d{1})-?\d{4}|0[789]0-?\d{4}-?\d{4}|050-?\d{4}-?\d{4})/,yrt=new RegExp("^".concat(_rt.source,"|").concat(grt.source,"$"));function UY(e){return hrt.test(e)}function mV(e){return prt.test(e)}function _ge(e){var t=e.charAt(0)==="+"||mrt.test(e);return t&&yrt.test(e)}var gge=function(e){Tm(t,e);function t(n){var i=e.call(this,n)||this;return i.type="phone",i.number="",i.plusSign=!1,i.number=n.number,i.plusSign=n.plusSign,i}return t.prototype.getType=function(){return"phone"},t.prototype.getPhoneNumber=function(){return this.number},t.prototype.getNumber=function(){return this.getPhoneNumber()},t.prototype.getAnchorHref=function(){return"tel:"+(this.plusSign?"+":"")+this.number},t.prototype.getAnchorText=function(){return this.matchedText},t}(Em);function bge(e,t){for(var n=t.tagBuilder,i=t.stripPrefix,o=t.stripTrailingSlash,r=t.decodePercentEncoding,s=t.hashtagServiceName,a=t.mentionServiceName,c=[],l=e.length,f=[],d=0;d<l;d++){var p=e.charAt(d);if(f.length===0)b(p);else for(var g=f.length-1;g>=0;g--){var m=f[g];switch(m.state){case 11:D(m,p);break;case 12:O(m,p);break;case 0:C(m,p);break;case 1:A(m,p);break;case 2:T(m,p);break;case 3:E(m,p);break;case 4:v(m,p);break;case 5:P(m,p);break;case 6:M(m,p);break;case 7:L(m,p);break;case 13:_(m,p);break;case 14:S(m,p);break;case 8:w(m,p);break;case 9:I(m,p);break;case 10:N(m,p);break;case 15:k(m,p);break;case 16:z(m,p);break;case 17:V(m,p);break;case 18:U(m,p);break;case 19:B(m,p);break;case 20:W(m,p);break;case 21:j(m,p);break;case 22:Q(m,p);break;case 23:q(m,p);break;case 24:X(m,p);break;case 25:Z(m,p);break;case 26:fe(m,p);break;case 27:xe(m,p);break;case 28:re(m,p);break;case 29:pe(m,p);break;case 30:ye(m,p);break;case 31:Se(m,p);break;case 32:Fe(m,p);break;case 33:Ve(m,p);break;case 34:Ze(m,p);break;case 35:gt(m,p);break;case 36:lt(m,p);break;case 37:Te(m,p);break;case 38:Oe(m,p);break;case 39:Mt(m,p);break;case 40:ut(m,p);break;case 41:at(m,p);break;default:O0(m.state)}}}for(var y=f.length-1;y>=0;y--)f.forEach(function(Ce){return Kt(Ce)});return c;function b(Ce){if(Ce==="#")f.push(Trt(d,28));else if(Ce==="@")f.push(Ert(d,30));else if(Ce==="/")f.push(HY(d,11));else if(Ce==="+")f.push(GY(d,37));else if(Ce==="(")f.push(GY(d,32));else{if(js.test(Ce)&&(f.push(GY(d,38)),f.push(Crt(d,13))),age(Ce)){var Ae=Ce.toLowerCase()==="m"?15:22;f.push(Art(d,Ae))}uV(Ce)&&f.push(zY(d,0)),$d.test(Ce)&&f.push(HY(d,5))}}function C(Ce,Ae){Ae===":"?Ce.state=2:Ae==="-"?Ce.state=1:NY(Ae)||Wo(f,Ce)}function A(Ce,Ae){Ae==="-"||(Ae==="/"?(Wo(f,Ce),f.push(HY(d,11))):NY(Ae)?Ce.state=0:Wo(f,Ce))}function T(Ce,Ae){Ae==="/"?Ce.state=3:Ae==="."?Wo(f,Ce):l_(Ae)?(Ce.state=5,uV(Ae)&&f.push(zY(d,0))):Wo(f,Ce)}function E(Ce,Ae){Ae==="/"?Ce.state=4:FY(Ae)?(Ce.state=10,Ce.acceptStateReached=!0):Kt(Ce)}function v(Ce,Ae){Ae==="/"?Ce.state=10:l_(Ae)?(Ce.state=5,Ce.acceptStateReached=!0):Wo(f,Ce)}function D(Ce,Ae){Ae==="/"?Ce.state=12:Wo(f,Ce)}function O(Ce,Ae){l_(Ae)?Ce.state=5:Wo(f,Ce)}function P(Ce,Ae){Ae==="."?Ce.state=7:Ae==="-"?Ce.state=6:Ae===":"?Ce.state=8:dV(Ae)?Ce.state=10:fV(Ae)||Kt(Ce)}function M(Ce,Ae){Ae==="-"||(Ae==="."?Kt(Ce):l_(Ae)?Ce.state=5:Kt(Ce))}function L(Ce,Ae){Ae==="."?Kt(Ce):l_(Ae)?(Ce.state=5,Ce.acceptStateReached=!0):Kt(Ce)}function _(Ce,Ae){Ae==="."?Ce.state=14:Ae===":"?Ce.state=8:js.test(Ae)||(dV(Ae)?Ce.state=10:$d.test(Ae)?Wo(f,Ce):Kt(Ce))}function S(Ce,Ae){js.test(Ae)?(Ce.octetsEncountered++,Ce.octetsEncountered===4&&(Ce.acceptStateReached=!0),Ce.state=13):Kt(Ce)}function w(Ce,Ae){js.test(Ae)?Ce.state=9:Kt(Ce)}function I(Ce,Ae){js.test(Ae)||(dV(Ae)?Ce.state=10:Kt(Ce))}function N(Ce,Ae){FY(Ae)||Kt(Ce)}function k(Ce,Ae){Ae.toLowerCase()==="a"?Ce.state=16:Q(Ce,Ae)}function z(Ce,Ae){Ae.toLowerCase()==="i"?Ce.state=17:Q(Ce,Ae)}function V(Ce,Ae){Ae.toLowerCase()==="l"?Ce.state=18:Q(Ce,Ae)}function U(Ce,Ae){Ae.toLowerCase()==="t"?Ce.state=19:Q(Ce,Ae)}function B(Ce,Ae){Ae.toLowerCase()==="o"?Ce.state=20:Q(Ce,Ae)}function W(Ce,Ae){Ae.toLowerCase()===":"?Ce.state=21:Q(Ce,Ae)}function j(Ce,Ae){hV(Ae)?Ce.state=22:Wo(f,Ce)}function Q(Ce,Ae){Ae==="."?Ce.state=23:Ae==="@"?Ce.state=24:hV(Ae)?Ce.state=22:Wo(f,Ce)}function q(Ce,Ae){Ae==="."?Wo(f,Ce):Ae==="@"?Wo(f,Ce):hV(Ae)?Ce.state=22:Wo(f,Ce)}function X(Ce,Ae){l_(Ae)?Ce.state=25:Wo(f,Ce)}function Z(Ce,Ae){Ae==="."?Ce.state=27:Ae==="-"?Ce.state=26:fV(Ae)||Kt(Ce)}function fe(Ce,Ae){Ae==="-"||Ae==="."?Kt(Ce):fV(Ae)?Ce.state=25:Kt(Ce)}function xe(Ce,Ae){Ae==="."||Ae==="-"?Kt(Ce):l_(Ae)?(Ce.state=25,Ce.acceptStateReached=!0):Kt(Ce)}function re(Ce,Ae){kY(Ae)?(Ce.state=29,Ce.acceptStateReached=!0):Wo(f,Ce)}function pe(Ce,Ae){kY(Ae)||Kt(Ce)}function ye(Ce,Ae){VY(Ae)?(Ce.state=31,Ce.acceptStateReached=!0):Wo(f,Ce)}function Se(Ce,Ae){VY(Ae)||($d.test(Ae)?Wo(f,Ce):Kt(Ce))}function Te(Ce,Ae){js.test(Ae)?Ce.state=38:(Wo(f,Ce),b(Ae))}function Fe(Ce,Ae){js.test(Ae)?Ce.state=33:Wo(f,Ce),b(Ae)}function Ve(Ce,Ae){js.test(Ae)?Ce.state=34:Wo(f,Ce)}function Ze(Ce,Ae){js.test(Ae)?Ce.state=35:Wo(f,Ce)}function gt(Ce,Ae){Ae===")"?Ce.state=36:Wo(f,Ce)}function lt(Ce,Ae){js.test(Ae)?Ce.state=38:UY(Ae)?Ce.state=39:Wo(f,Ce)}function Oe(Ce,Ae){Ce.acceptStateReached=!0,mV(Ae)?Ce.state=40:Ae==="#"?Ce.state=41:js.test(Ae)||(Ae==="("?Ce.state=32:UY(Ae)?Ce.state=39:(Kt(Ce),uV(Ae)&&f.push(zY(d,0))))}function Mt(Ce,Ae){js.test(Ae)?Ce.state=38:Ae==="("?Ce.state=32:(Kt(Ce),b(Ae))}function ut(Ce,Ae){mV(Ae)||(Ae==="#"?Ce.state=41:js.test(Ae)?Ce.state=38:Kt(Ce))}function at(Ce,Ae){mV(Ae)?Ce.state=40:js.test(Ae)?Wo(f,Ce):Kt(Ce)}function Kt(Ce){if(Wo(f,Ce),!!Ce.acceptStateReached){var Ae=Ce.startIdx,nt=e.slice(Ce.startIdx,d);if(nt=brt(nt),Ce.type==="url"){var yi=e.charAt(Ce.startIdx-1);if(yi==="@")return;var ct=Ce.matchType;if(ct==="scheme"){var Si=LY.exec(nt);if(Si&&(Ae=Ae+Si.index,nt=nt.slice(Si.index)),!nge(nt))return}else if(ct==="tld"){if(!ige(nt))return}else if(ct==="ipV4"){if(!oge(nt))return}else O0(ct);c.push(new rge({tagBuilder:n,matchedText:nt,offset:Ae,urlMatchType:ct,url:nt,protocolRelativeMatch:nt.slice(0,2)==="//",stripPrefix:i,stripTrailingSlash:o,decodePercentEncoding:r}))}else if(Ce.type==="email")cge(nt)&&c.push(new lge({tagBuilder:n,matchedText:nt,offset:Ae,email:nt.replace(sge,"")}));else if(Ce.type==="hashtag")uge(nt)&&c.push(new dge({tagBuilder:n,matchedText:nt,offset:Ae,serviceName:s,hashtag:nt.slice(1)}));else if(Ce.type==="mention")hge(nt,a)&&c.push(new pge({tagBuilder:n,matchedText:nt,offset:Ae,serviceName:a,mention:nt.slice(1)}));else if(Ce.type==="phone"){if(nt=nt.replace(/ +$/g,""),_ge(nt)){var oo=nt.replace(/[^0-9,;#]/g,"");c.push(new gge({tagBuilder:n,matchedText:nt,offset:Ae,number:oo,plusSign:nt.charAt(0)==="+"}))}}else O0(Ce)}}}var xrt=/[\(\{\[]/,yge=/[\)\}\]]/,xge={")":"(","}":"{","]":"["};function brt(e){for(var t={"(":0,"{":0,"[":0},n=0;n<e.length;n++){var i=e.charAt(n);xrt.test(i)?t[i]++:yge.test(i)&&t[xge[i]]--}for(var o=e.length-1,r;o>=0;)if(r=e.charAt(o),yge.test(r)){var s=xge[r];if(t[s]<0)t[s]++,o--;else break}else if(tge.test(r))o--;else break;return e.slice(0,o+1)}function zY(e,t){return{type:"url",startIdx:e,state:t,acceptStateReached:!1,matchType:"scheme"}}function HY(e,t){return{type:"url",startIdx:e,state:t,acceptStateReached:!1,matchType:"tld"}}function Crt(e,t){return{type:"url",startIdx:e,state:t,acceptStateReached:!1,matchType:"ipV4",octetsEncountered:1}}function Art(e,t){return{type:"email",startIdx:e,state:t,acceptStateReached:!1}}function Trt(e,t){return{type:"hashtag",startIdx:e,state:t,acceptStateReached:!1}}function Ert(e,t){return{type:"mention",startIdx:e,state:t,acceptStateReached:!1}}function GY(e,t){return{type:"phone",startIdx:e,state:t,acceptStateReached:!1}}function Cge(e,t){for(var n=t.onOpenTag,i=t.onCloseTag,o=t.onText,r=t.onComment,s=t.onDoctype,a=new Sm,c=0,l=e.length,f=0,d=0,p=a;c<l;){var g=e.charAt(c);switch(f){case 0:m(g);break;case 1:y(g);break;case 2:C(g);break;case 3:b(g);break;case 4:A(g);break;case 5:T(g);break;case 6:E(g);break;case 7:v(g);break;case 8:D(g);break;case 9:O(g);break;case 10:P(g);break;case 11:M(g);break;case 12:L(g);break;case 13:_(g);break;case 14:S(g);break;case 15:w(g);break;case 16:I(g);break;case 17:N(g);break;case 18:k(g);break;case 19:z(g);break;case 20:V(g);break;default:O0(f)}c++}d<c&&j();function m(X){X==="<"&&B()}function y(X){X==="!"?f=13:X==="/"?(f=2,p=new Sm(qs(qs({},p),{isClosing:!0}))):X==="<"?B():M0.test(X)?(f=3,p=new Sm(qs(qs({},p),{isOpening:!0}))):(f=0,p=a)}function b(X){Eu.test(X)?(p=new Sm(qs(qs({},p),{name:Q()})),f=4):X==="<"?B():X==="/"?(p=new Sm(qs(qs({},p),{name:Q()})),f=12):X===">"?(p=new Sm(qs(qs({},p),{name:Q()})),W()):!M0.test(X)&&!js.test(X)&&X!==":"&&U()}function C(X){X===">"?U():M0.test(X)?f=3:U()}function A(X){Eu.test(X)||(X==="/"?f=12:X===">"?W():X==="<"?B():X==="="||cV.test(X)||j_e.test(X)?U():f=5)}function T(X){Eu.test(X)?f=6:X==="/"?f=12:X==="="?f=7:X===">"?W():X==="<"?B():cV.test(X)&&U()}function E(X){Eu.test(X)||(X==="/"?f=12:X==="="?f=7:X===">"?W():X==="<"?B():cV.test(X)?U():f=5)}function v(X){Eu.test(X)||(X==='"'?f=8:X==="'"?f=9:/[>=`]/.test(X)?U():X==="<"?B():f=10)}function D(X){X==='"'&&(f=11)}function O(X){X==="'"&&(f=11)}function P(X){Eu.test(X)?f=4:X===">"?W():X==="<"&&B()}function M(X){Eu.test(X)?f=4:X==="/"?f=12:X===">"?W():X==="<"?B():(f=4,q())}function L(X){X===">"?(p=new Sm(qs(qs({},p),{isClosing:!0})),W()):f=4}function _(X){e.substr(c,2)==="--"?(c+=2,p=new Sm(qs(qs({},p),{type:"comment"})),f=14):e.substr(c,7).toUpperCase()==="DOCTYPE"?(c+=7,p=new Sm(qs(qs({},p),{type:"doctype"})),f=20):U()}function S(X){X==="-"?f=15:X===">"?U():f=16}function w(X){X==="-"?f=18:X===">"?U():f=16}function I(X){X==="-"&&(f=17)}function N(X){X==="-"?f=18:f=16}function k(X){X===">"?W():X==="!"?f=19:X==="-"||(f=16)}function z(X){X==="-"?f=17:X===">"?W():f=16}function V(X){X===">"?W():X==="<"&&B()}function U(){f=0,p=a}function B(){f=1,p=new Sm({idx:c})}function W(){var X=e.slice(d,p.idx);X&&o(X,d),p.type==="comment"?r(p.idx):p.type==="doctype"?s(p.idx):(p.isOpening&&n(p.name,p.idx),p.isClosing&&i(p.name,p.idx)),U(),d=c+1}function j(){var X=e.slice(d,c);o(X,d),d=c+1}function Q(){var X=p.idx+(p.isClosing?2:1);return e.slice(X,c).toLowerCase()}function q(){c--}}var Sm=function(){function e(t){t===void 0&&(t={}),this.idx=t.idx!==void 0?t.idx:-1,this.type=t.type||"tag",this.name=t.name||"",this.isOpening=!!t.isOpening,this.isClosing=!!t.isClosing}return e}();var Srt=function(){function e(t){t===void 0&&(t={}),this.version=e.version,this.urls={},this.email=!0,this.phone=!0,this.hashtag=!1,this.mention=!1,this.newWindow=!0,this.stripPrefix={scheme:!0,www:!0},this.stripTrailingSlash=!0,this.decodePercentEncoding=!0,this.truncate={length:0,location:"end"},this.className="",this.replaceFn=null,this.context=void 0,this.sanitizeHtml=!1,this.tagBuilder=null,this.urls=vrt(t.urls),this.email=Tu(t.email)?t.email:this.email,this.phone=Tu(t.phone)?t.phone:this.phone,this.hashtag=t.hashtag||this.hashtag,this.mention=t.mention||this.mention,this.newWindow=Tu(t.newWindow)?t.newWindow:this.newWindow,this.stripPrefix=wrt(t.stripPrefix),this.stripTrailingSlash=Tu(t.stripTrailingSlash)?t.stripTrailingSlash:this.stripTrailingSlash,this.decodePercentEncoding=Tu(t.decodePercentEncoding)?t.decodePercentEncoding:this.decodePercentEncoding,this.sanitizeHtml=t.sanitizeHtml||!1;var n=this.mention;if(n!==!1&&mge.indexOf(n)===-1)throw new Error("invalid `mention` cfg '".concat(n,"' - see docs"));var i=this.hashtag;if(i!==!1&&fge.indexOf(i)===-1)throw new Error("invalid `hashtag` cfg '".concat(i,"' - see docs"));this.truncate=Drt(t.truncate),this.className=t.className||this.className,this.replaceFn=t.replaceFn||this.replaceFn,this.context=t.context||this}return e.link=function(t,n){var i=new e(n);return i.link(t)},e.parse=function(t,n){var i=new e(n);return i.parse(t)},e.prototype.parse=function(t){var n=this,i=["a","style","script"],o=0,r=[];return Cge(t,{onOpenTag:function(s){i.indexOf(s)>=0&&o++},onText:function(s,a){if(o===0){var c=/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi,l=s.split(c),f=a;l.forEach(function(d,p){if(p%2===0){var g=n.parseText(d,f);r.push.apply(r,g)}f+=d.length})}},onCloseTag:function(s){i.indexOf(s)>=0&&(o=Math.max(o-1,0))},onComment:function(s){},onDoctype:function(s){}}),r=this.compactMatches(r),r=this.removeUnwantedMatches(r),r},e.prototype.compactMatches=function(t){t.sort(function(c,l){return c.getOffset()-l.getOffset()});for(var n=0;n<t.length-1;){var i=t[n],o=i.getOffset(),r=i.getMatchedText().length,s=o+r;if(n+1<t.length){if(t[n+1].getOffset()===o){var a=t[n+1].getMatchedText().length>r?n:n+1;t.splice(a,1);continue}if(t[n+1].getOffset()<s){t.splice(n+1,1);continue}}n++}return t},e.prototype.removeUnwantedMatches=function(t){return this.hashtag||R0(t,function(n){return n.getType()==="hashtag"}),this.email||R0(t,function(n){return n.getType()==="email"}),this.phone||R0(t,function(n){return n.getType()==="phone"}),this.mention||R0(t,function(n){return n.getType()==="mention"}),this.urls.schemeMatches||R0(t,function(n){return n.getType()==="url"&&n.getUrlMatchType()==="scheme"}),this.urls.tldMatches||R0(t,function(n){return n.getType()==="url"&&n.getUrlMatchType()==="tld"}),this.urls.ipV4Matches||R0(t,function(n){return n.getType()==="url"&&n.getUrlMatchType()==="ipV4"}),t},e.prototype.parseText=function(t,n){n===void 0&&(n=0),n=n||0;for(var i=bge(t,{tagBuilder:this.getTagBuilder(),stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash,decodePercentEncoding:this.decodePercentEncoding,hashtagServiceName:this.hashtag,mentionServiceName:this.mention||"twitter"}),o=0,r=i.length;o<r;o++)i[o].setOffset(n+i[o].getOffset());return i},e.prototype.link=function(t){if(!t)return"";this.sanitizeHtml&&(t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;"));for(var n=this.parse(t),i=[],o=0,r=0,s=n.length;r<s;r++){var a=n[r];i.push(t.substring(o,a.getOffset())),i.push(this.createMatchReturnVal(a)),o=a.getOffset()+a.getMatchedText().length}return i.push(t.substring(o)),i.join("")},e.prototype.createMatchReturnVal=function(t){var n;if(this.replaceFn&&(n=this.replaceFn.call(this.context,t)),typeof n=="string")return n;if(n===!1)return t.getMatchedText();if(n instanceof lV)return n.toAnchorString();var i=t.buildTag();return i.toAnchorString()},e.prototype.getTagBuilder=function(){var t=this.tagBuilder;return t||(t=this.tagBuilder=new $_e({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),t},e.version=H_e,e}(),Age=Srt;function vrt(e){return e==null&&(e=!0),Tu(e)?{schemeMatches:e,tldMatches:e,ipV4Matches:e}:{schemeMatches:Tu(e.schemeMatches)?e.schemeMatches:!0,tldMatches:Tu(e.tldMatches)?e.tldMatches:!0,ipV4Matches:Tu(e.ipV4Matches)?e.ipV4Matches:!0}}function wrt(e){return e==null&&(e=!0),Tu(e)?{scheme:e,www:e}:{scheme:Tu(e.scheme)?e.scheme:!0,www:Tu(e.www)?e.www:!0}}function Drt(e){return typeof e=="number"?{length:e,location:"end"}:G_e(e||{},{length:Number.POSITIVE_INFINITY,location:"end"})}var pV=Age;var Rge;typeof DOMParser<"u"&&(Rge=new DOMParser);var Irt=new pV({stripPrefix:!1,email:!1,replaceFn:function(e,t){return t.urlMatchType==="scheme"||t.urlMatchType==="www"}}),_V=32,Tge=2414016,Ege=1,Sge=16093e3,vge=.1,Prt=[null,void 0,"http://www.topografix.com/GPX/1/1"],vo={gpx:Prt};function Rrt(e){return new Promise((t,n)=>{let i=new FileReader;i.addEventListener("load",function(){t(i.result)}),i.addEventListener("error",function(){n(i.error)}),i.readAsText(e)})}function WY(e,t){let n=hD(e,"id");return n=u(n)?n:Hn(),t.getOrCreateEntity(n)}function jY(e){let t=wge(e,"lon"),n=wge(e,"lat"),i=fD(e,"ele",vo.gpx);return h.fromDegrees(t,n,i)}function wge(e,t){if(!u(e))return;let n=e.getAttribute(t);if(n!==null){let i=parseFloat(n);return isNaN(i)?void 0:i}}function hD(e,t){if(!u(e))return;let n=e.getAttribute(t);return n!==null?n:void 0}function L0(e,t,n){if(!u(e))return;let i=e.childNodes,o=i.length;for(let r=0;r<o;r++){let s=i[r];if(s.localName===t&&n.indexOf(s.namespaceURI)!==-1)return s}}function qY(e,t,n){if(!u(e))return;let i=[],o=e.getElementsByTagName(t),r=o.length;for(let s=0;s<r;s++){let a=o[s];a.localName===t&&n.indexOf(a.namespaceURI)!==-1&&i.push(a)}return i}function fD(e,t,n){let i=L0(e,t,n);if(u(i)){let o=parseFloat(i.textContent);return isNaN(o)?void 0:o}}function Ol(e,t,n){let i=L0(e,t,n);if(u(i))return i.textContent.trim()}function Oge(e){let t=new Sc;return t.width=_V,t.height=_V,t.scaleByDistance=new kt(Tge,Ege,Sge,vge),t.pixelOffsetScaleByDistance=new kt(Tge,Ege,Sge,vge),t.verticalOrigin=new Kn(On.BOTTOM),t.image=e,t}function Ort(){let e=new Mh;return e.translucencyByDistance=new kt(3e6,1,5e6,0),e.pixelOffset=new H(17,0),e.horizontalOrigin=bi.LEFT,e.font="16px sans-serif",e.style=$o.FILL_AND_OUTLINE,e}function Mge(e){let t=new Pc;return t.width=4,t.material=new zx,t.material.color=u(e)?e:G.RED,t.material.outlineWidth=2,t.material.outlineColor=G.BLACK,t}var Dge={time:{text:"Time",tag:"time"},comment:{text:"Comment",tag:"cmt"},description:{text:"Description",tag:"desc"},source:{text:"Source",tag:"src"},number:{text:"GPS track/route number",tag:"number"},type:{text:"Type",tag:"type"}},dD;typeof document<"u"&&(dD=document.createElement("div"));function YY(e,t){let n,i="",o=Object.keys(Dge),r=o.length;for(n=0;n<r;n++){let f=o[n],d=Dge[f];d.value=x(Ol(e,d.tag,vo.gpx),""),u(d.value)&&d.value!==""&&(i=`${i}<p>${d.text}: ${d.value}</p>`)}if(!u(i)||i==="")return;i=Irt.link(i),dD.innerHTML=i;let s=dD.querySelectorAll("a");for(n=0;n<s.length;n++)s[n].setAttribute("target","_blank");let a=G.WHITE,c=G.BLACK,l='<div class="cesium-infoBox-description-lighter" style="';return l+="overflow:auto;",l+="word-wrap:break-word;",l+=`background-color:${a.toCssColorString()};`,l+=`color:${c.toCssColorString()};`,l+='">',l+=`${dD.innerHTML}</div>`,dD.innerHTML="",l}function Lge(e,t,n,i){let o=jY(t),r=WY(t,n);r.position=o;let s=u(i.waypointImage)?i.waypointImage:e._pinBuilder.fromMakiIconId("marker",G.RED,_V);r.billboard=Oge(s);let a=Ol(t,"name",vo.gpx);r.name=a,r.label=Ort(),r.label.text=a,r.description=YY(t,r),i.clampToGround&&(r.billboard.heightReference=Xe.CLAMP_TO_GROUND,r.label.heightReference=Xe.CLAMP_TO_GROUND)}function Mrt(e,t,n,i){let o=WY(t,n);o.description=YY(t,o);let r=qY(t,"rtept",vo.gpx),s=new Array(r.length);for(let a=0;a<r.length;a++)Lge(e,r[a],n,i),s[a]=jY(r[a]);o.polyline=Mge(i.routeColor),i.clampToGround&&(o.polyline.clampToGround=!0),o.polyline.positions=s}function Lrt(e,t,n,i){let o=WY(t,n);o.description=YY(t,o);let r=qY(t,"trkseg",vo.gpx),s=[],a=[],c,l=!0,f=new Ra;for(let d=0;d<r.length;d++)c=Nrt(r[d]),s=s.concat(c.positions),c.times.length>0?(a=a.concat(c.times),f.addSamples(a,s),l=l&&!0):l=!1;if(l){let d=u(i.waypointImage)?i.waypointImage:e._pinBuilder.fromMakiIconId("marker",G.RED,_V);o.billboard=Oge(d),o.position=f,i.clampToGround&&(o.billboard.heightReference=Xe.CLAMP_TO_GROUND),o.availability=new Xr,o.availability.addInterval(new Sn({start:a[0],stop:a[a.length-1]}))}o.polyline=Mge(i.trackColor),o.polyline.positions=s,i.clampToGround&&(o.polyline.clampToGround=!0)}function Nrt(e){let t={positions:[],times:[]},n=qY(e,"trkpt",vo.gpx),i;for(let o=0;o<n.length;o++){let r=jY(n[o]);t.positions.push(r),i=Ol(n[o],"time",vo.gpx),u(i)&&t.times.push($.fromIso8601(i))}return t}function Frt(e){let t=L0(e,"metadata",vo.gpx);if(u(t)){let n={name:Ol(t,"name",vo.gpx),desc:Ol(t,"desc",vo.gpx),author:Brt(t),copyright:Vrt(t),link:Nge(t),time:Ol(t,"time",vo.gpx),keywords:Ol(t,"keywords",vo.gpx),bounds:Urt(t)};if(u(n.name)||u(n.desc)||u(n.author)||u(n.copyright)||u(n.link)||u(n.time)||u(n.keywords)||u(n.bounds))return n}}function Brt(e){let t=L0(e,"author",vo.gpx);if(u(t)){let n={name:Ol(t,"name",vo.gpx),email:krt(t),link:Nge(t)};if(u(n.name)||u(n.email)||u(n.link))return n}}function krt(e){let t=L0(e,"email",vo.gpx);if(u(t)){let n=Ol(t,"id",vo.gpx),i=Ol(t,"domain",vo.gpx);return`${n}@${i}`}}function Nge(e){let t=L0(e,"link",vo.gpx);if(u(t)){let n={href:hD(t,"href"),text:Ol(t,"text",vo.gpx),mimeType:Ol(t,"type",vo.gpx)};if(u(n.href)||u(n.text)||u(n.mimeType))return n}}function Vrt(e){let t=L0(e,"copyright",vo.gpx);if(u(t)){let n={author:hD(t,"author"),year:Ol(t,"year",vo.gpx),license:Ol(t,"license",vo.gpx)};if(u(n.author)||u(n.year)||u(n.license))return n}}function Urt(e){let t=L0(e,"bounds",vo.gpx);if(u(t)){let n={minLat:fD(t,"minlat",vo.gpx),maxLat:fD(t,"maxlat",vo.gpx),minLon:fD(t,"minlon",vo.gpx),maxLon:fD(t,"maxlon",vo.gpx)};if(u(n.minLat)||u(n.maxLat)||u(n.minLon)||u(n.maxLon))return n}}var Ige={wpt:Lge,rte:Mrt,trk:Lrt};function zrt(e,t,n,i){let o=Object.keys(Ige),r=o.length;for(let s=0;s<r;s++){let a=o[s],c=Ige[a],l=t.childNodes,f=l.length;for(let d=0;d<f;d++){let p=l[d];p.localName===a&&vo.gpx.indexOf(p.namespaceURI)!==-1&&c(e,p,n,i)}}}function Pge(e,t,n){let i=e._entityCollection;i.removeAll();let o=t.documentElement,r=hD(o,"version"),s=hD(o,"creator"),a,c=Frt(o);u(c)&&(a=c.name),o.localName==="gpx"?zrt(e,o,i,n):console.log(`GPX - Unsupported node: ${o.localName}`);let l,f=i.computeAvailability(),d=f.start,p=f.stop,g=$.equals(d,He.MINIMUM_VALUE),m=$.equals(p,He.MAXIMUM_VALUE);if(!g||!m){let b;g&&(b=new Date,b.setHours(0,0,0,0),d=$.fromDate(b)),m&&(b=new Date,b.setHours(24,0,0,0),p=$.fromDate(b)),l=new lm,l.startTime=d,l.stopTime=p,l.currentTime=$.clone(d),l.clockRange=Zr.LOOP_STOP,l.clockStep=Ao.SYSTEM_CLOCK_MULTIPLIER,l.multiplier=Math.round(Math.min(Math.max($.secondsDifference(p,d)/60,1),31556900))}let y=!1;return e._name!==a&&(e._name=a,y=!0),e._creator!==s&&(e._creator=s,y=!0),Hrt(e._metadata,c)&&(e._metadata=c,y=!0),e._version!==r&&(e._version=r,y=!0),l!==e._clock&&(y=!0,e._clock=l),y&&e._changed.raiseEvent(e),Kr.setLoading(e,!1),e}function Hrt(e,t){return!u(e)&&!u(t)?!1:u(e)&&u(t)?e.name!==t.name||e.dec!==t.desc||e.src!==t.src||e.author!==t.author||e.copyright!==t.copyright||e.link!==t.link||e.time!==t.time||e.bounds!==t.bounds:!0}function Grt(e,t,n,i){i=x(i,x.EMPTY_OBJECT);let o=n;if(typeof n=="string"||n instanceof De){n=De.createIfNeeded(n),o=n.fetchBlob();let r=e._resourceCredits,s=n.credits;if(u(s)){let a=s.length;for(let c=0;c<a;c++)r.push(s[c])}}return Promise.resolve(o).then(function(r){return r instanceof Blob?Rrt(r).then(function(s){let a,c;try{a=Rge.parseFromString(s,"application/xml")}catch(l){c=l.toString()}if(u(c)||a.body||a.documentElement.tagName==="parsererror"){let l=u(c)?c:a.documentElement.firstChild.nodeValue;throw l||(l=a.body.innerText),new ce(l)}return Pge(e,a,i)}):Pge(e,r,i)}).catch(function(r){return e._error.raiseEvent(e,r),console.log(r),Promise.reject(r)})}function gE(){this._changed=new me,this._error=new me,this._loading=new me,this._clock=void 0,this._entityCollection=new la(this),this._entityCluster=new Mf,this._name=void 0,this._version=void 0,this._creator=void 0,this._metadata=void 0,this._isLoading=!1,this._pinBuilder=new I0}gE.load=function(e,t){return new gE().load(e,t)};Object.defineProperties(gE.prototype,{name:{get:function(){return this._name}},version:{get:function(){return this._version}},creator:{get:function(){return this._creator}},metadata:{get:function(){return this._metadata}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}}});gE.prototype.update=function(e){return!0};gE.prototype.load=function(e,t){if(!u(e))throw new he("data is required.");t=x(t,x.EMPTY_OBJECT),Kr.setLoading(this,!0);let n=this._name,i=this;return Grt(this,this._entityCollection,e,t).then(function(){let o,r=i._entityCollection.computeAvailability(),s=r.start,a=r.stop,c=$.equals(s,He.MINIMUM_VALUE),l=$.equals(a,He.MAXIMUM_VALUE);if(!c||!l){let d;c&&(d=new Date,d.setHours(0,0,0,0),s=$.fromDate(d)),l&&(d=new Date,d.setHours(24,0,0,0),a=$.fromDate(d)),o=new lm,o.startTime=s,o.stopTime=a,o.currentTime=$.clone(s),o.clockRange=Zr.LOOP_STOP,o.clockStep=Ao.SYSTEM_CLOCK_MULTIPLIER,o.multiplier=Math.round(Math.min(Math.max($.secondsDifference(a,s)/60,1),31556900))}let f=!1;return o!==i._clock&&(i._clock=o,f=!0),n!==i._name&&(f=!0),f&&i._changed.raiseEvent(i),Kr.setLoading(i,!1),i}).catch(function(o){return Kr.setLoading(i,!1),i._error.raiseEvent(i,o),console.log(o),Promise.reject(o)})};var gV=gE;function Wrt(e,t){this.position=e,this.headingPitchRoll=t}var yV=Wrt;var pD=Dr(Gl(),1);function jrt(e,t){this.position=e,this.headingPitchRange=t}var xV=jrt;function bV(e,t){this.id=t,this.name=e,this.playlistIndex=0,this.playlist=[],this.tourStart=new me,this.tourEnd=new me,this.entryStart=new me,this.entryEnd=new me,this._activeEntries=[]}bV.prototype.addPlaylistEntry=function(e){this.playlist.push(e)};bV.prototype.play=function(e,t){this.tourStart.raiseEvent();let n=this;Bge.call(this,e,t,function(i){n.playlistIndex=0,i||Fge(n._activeEntries),n.tourEnd.raiseEvent(i)})};bV.prototype.stop=function(){Fge(this._activeEntries)};function Fge(e){for(let t=e.pop();t!==void 0;t=e.pop())t.stop()}function Bge(e,t,n){let i=this.playlist[this.playlistIndex];if(i){let o=qrt.bind(this,e,t,n);if(this._activeEntries.push(i),this.entryStart.raiseEvent(i),i.blocking)i.play(o,e.scene.camera,t);else{let r=this;i.play(function(){r.entryEnd.raiseEvent(i);let s=r._activeEntries.indexOf(i);s>=0&&r._activeEntries.splice(s,1)}),o(e,t,n)}}else u(n)&&n(!1)}function qrt(e,t,n,i){let o=this.playlist[this.playlistIndex];if(this.entryEnd.raiseEvent(o,i),i)n(i);else{let r=this._activeEntries.indexOf(o);r>=0&&this._activeEntries.splice(r,1),this.playlistIndex++,Bge.call(this,e,t,n)}}var CV=bV;var Ii=Object.freeze({Linear:Object.freeze({None:function(e){return e},In:function(e){return e},Out:function(e){return e},InOut:function(e){return e}}),Quadratic:Object.freeze({In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}),Cubic:Object.freeze({In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),Quartic:Object.freeze({In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}),Quintic:Object.freeze({In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}),Sinusoidal:Object.freeze({In:function(e){return 1-Math.sin((1-e)*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return .5*(1-Math.sin(Math.PI*(.5-e)))}}),Exponential:Object.freeze({In:function(e){return e===0?0:Math.pow(1024,e-1)},Out:function(e){return e===1?1:1-Math.pow(2,-10*e)},InOut:function(e){return e===0?0:e===1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}}),Circular:Object.freeze({In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}),Elastic:Object.freeze({In:function(e){return e===0?0:e===1?1:-Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI)},Out:function(e){return e===0?0:e===1?1:Math.pow(2,-10*e)*Math.sin((e-.1)*5*Math.PI)+1},InOut:function(e){return e===0?0:e===1?1:(e*=2,e<1?-.5*Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin((e-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(e){var t=1.70158;return e===1?1:e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return e===0?0:--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)}}),Bounce:Object.freeze({In:function(e){return 1-Ii.Bounce.Out(1-e)},Out:function(e){return e<.36363636363636365?7.5625*e*e:e<.7272727272727273?7.5625*(e-=.5454545454545454)*e+.75:e<.9090909090909091?7.5625*(e-=.8181818181818182)*e+.9375:7.5625*(e-=.9545454545454546)*e+.984375},InOut:function(e){return e<.5?Ii.Bounce.In(e*2)*.5:Ii.Bounce.Out(e*2-1)*.5+.5}}),generatePow:function(e){return e===void 0&&(e=4),e=e<Number.EPSILON?Number.EPSILON:e,e=e>1e4?1e4:e,{In:function(t){return Math.pow(t,e)},Out:function(t){return 1-Math.pow(1-t,e)},InOut:function(t){return t<.5?Math.pow(t*2,e)/2:(1-Math.pow(2-t*2,e))/2+.5}}}}),mD=function(){return performance.now()},Yrt=function(){function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,t)}return e.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map(function(n){return t._tweens[n]})},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(){for(var t,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];for(var o=0,r=n;o<r.length;o++){var s=r[o];(t=s._group)===null||t===void 0||t.remove(s),s._group=this,this._tweens[s.getId()]=s,this._tweensAddedDuringUpdate[s.getId()]=s}},e.prototype.remove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var i=0,o=t;i<o.length;i++){var r=o[i];r._group=void 0,delete this._tweens[r.getId()],delete this._tweensAddedDuringUpdate[r.getId()]}},e.prototype.allStopped=function(){return this.getAll().every(function(t){return!t.isPlaying()})},e.prototype.update=function(t,n){t===void 0&&(t=mD()),n===void 0&&(n=!0);var i=Object.keys(this._tweens);if(i.length!==0)for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var o=0;o<i.length;o++){var r=this._tweens[i[o]],s=!n;r&&r.update(t,s)===!1&&!n&&this.remove(r)}i=Object.keys(this._tweensAddedDuringUpdate)}},e}(),yE={Linear:function(e,t){var n=e.length-1,i=n*t,o=Math.floor(i),r=yE.Utils.Linear;return t<0?r(e[0],e[1],i):t>1?r(e[n],e[n-1],n-i):r(e[o],e[o+1>n?n:o+1],i-o)},Bezier:function(e,t){for(var n=0,i=e.length-1,o=Math.pow,r=yE.Utils.Bernstein,s=0;s<=i;s++)n+=o(1-t,i-s)*o(t,s)*e[s]*r(i,s);return n},CatmullRom:function(e,t){var n=e.length-1,i=n*t,o=Math.floor(i),r=yE.Utils.CatmullRom;return e[0]===e[n]?(t<0&&(o=Math.floor(i=n*(1+t))),r(e[(o-1+n)%n],e[o],e[(o+1)%n],e[(o+2)%n],i-o)):t<0?e[0]-(r(e[0],e[0],e[1],e[1],-i)-e[0]):t>1?e[n]-(r(e[n],e[n],e[n-1],e[n-1],i-n)-e[n]):r(e[o?o-1:0],e[o],e[n<o+1?n:o+1],e[n<o+2?n:o+2],i-o)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=yE.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:function(){var e=[1];return function(t){var n=1;if(e[t])return e[t];for(var i=t;i>1;i--)n*=i;return e[t]=n,n}}(),CatmullRom:function(e,t,n,i,o){var r=(n-e)*.5,s=(i-t)*.5,a=o*o,c=o*a;return(2*t-2*n+r+s)*c+(-3*t+3*n-2*r-s)*a+r*o+t}}},kge=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),XY=new Yrt,Vge=function(){function e(t,n){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Ii.Linear.None,this._interpolationFunction=yE.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=kge.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=t,typeof n=="object"?(this._group=n,n.add(this)):n===!0&&(this._group=XY,XY.add(this))}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.getDuration=function(){return this._duration},e.prototype.to=function(t,n){if(n===void 0&&(n=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=t,this._propertiesAreSetUp=!1,this._duration=n<0?0:n,this},e.prototype.duration=function(t){return t===void 0&&(t=1e3),this._duration=t<0?0:t,this},e.prototype.dynamic=function(t){return t===void 0&&(t=!1),this._isDynamic=t,this},e.prototype.start=function(t,n){if(t===void 0&&(t=mD()),n===void 0&&(n=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=t,this._startTime+=this._delayTime,!this._propertiesAreSetUp||n){if(this._propertiesAreSetUp=!0,!this._isDynamic){var o={};for(var r in this._valuesEnd)o[r]=this._valuesEnd[r];this._valuesEnd=o}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,n)}return this},e.prototype.startFromCurrentValues=function(t){return this.start(t,!0)},e.prototype._setupProperties=function(t,n,i,o,r){for(var s in i){var a=t[s],c=Array.isArray(a),l=c?"array":typeof a,f=!c&&Array.isArray(i[s]);if(!(l==="undefined"||l==="function")){if(f){var d=i[s];if(d.length===0)continue;for(var p=[a],g=0,m=d.length;g<m;g+=1){var y=this._handleRelativeValue(a,d[g]);if(isNaN(y)){f=!1,console.warn("Found invalid interpolation list. Skipping.");break}p.push(y)}f&&(i[s]=p)}if((l==="object"||c)&&a&&!f){n[s]=c?[]:{};var b=a;for(var C in b)n[s][C]=b[C];o[s]=c?[]:{};var d=i[s];if(!this._isDynamic){var A={};for(var C in d)A[C]=d[C];i[s]=d=A}this._setupProperties(b,n[s],d,o[s],r)}else(typeof n[s]>"u"||r)&&(n[s]=a),c||(n[s]*=1),f?o[s]=i[s].slice().reverse():o[s]=n[s]||0}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},e.prototype.pause=function(t){return t===void 0&&(t=mD()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=t,this)},e.prototype.resume=function(t){return t===void 0&&(t=mD()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this)},e.prototype.stopChainedTweens=function(){for(var t=0,n=this._chainedTweens.length;t<n;t++)this._chainedTweens[t].stop();return this},e.prototype.group=function(t){return t?(t.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},e.prototype.remove=function(){var t;return(t=this._group)===null||t===void 0||t.remove(this),this},e.prototype.delay=function(t){return t===void 0&&(t=0),this._delayTime=t,this},e.prototype.repeat=function(t){return t===void 0&&(t=0),this._initialRepeat=t,this._repeat=t,this},e.prototype.repeatDelay=function(t){return this._repeatDelayTime=t,this},e.prototype.yoyo=function(t){return t===void 0&&(t=!1),this._yoyo=t,this},e.prototype.easing=function(t){return t===void 0&&(t=Ii.Linear.None),this._easingFunction=t,this},e.prototype.interpolation=function(t){return t===void 0&&(t=yE.Linear),this._interpolationFunction=t,this},e.prototype.chain=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this._chainedTweens=t,this},e.prototype.onStart=function(t){return this._onStartCallback=t,this},e.prototype.onEveryStart=function(t){return this._onEveryStartCallback=t,this},e.prototype.onUpdate=function(t){return this._onUpdateCallback=t,this},e.prototype.onRepeat=function(t){return this._onRepeatCallback=t,this},e.prototype.onComplete=function(t){return this._onCompleteCallback=t,this},e.prototype.onStop=function(t){return this._onStopCallback=t,this},e.prototype.update=function(t,n){var i=this,o;if(t===void 0&&(t=mD()),n===void 0&&(n=e.autoStartOnUpdate),this._isPaused)return!0;var r;if(!this._goToEnd&&!this._isPlaying)if(n)this.start(t,!0);else return!1;if(this._goToEnd=!1,t<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var s=t-this._startTime,a=this._duration+((o=this._repeatDelayTime)!==null&&o!==void 0?o:this._delayTime),c=this._duration+this._repeat*a,l=function(){if(i._duration===0||s>c)return 1;var y=Math.trunc(s/a),b=s-y*a,C=Math.min(b/i._duration,1);return C===0&&s===i._duration?1:C},f=l(),d=this._easingFunction(f);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,d),this._onUpdateCallback&&this._onUpdateCallback(this._object,f),this._duration===0||s>=this._duration)if(this._repeat>0){var p=Math.min(Math.trunc((s-this._duration)/a)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=p);for(r in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[r]=="string"&&(this._valuesStartRepeat[r]=this._valuesStartRepeat[r]+parseFloat(this._valuesEnd[r])),this._yoyo&&this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=a*p,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var g=0,m=this._chainedTweens.length;g<m;g++)this._chainedTweens[g].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(t,n,i,o){for(var r in i)if(n[r]!==void 0){var s=n[r]||0,a=i[r],c=Array.isArray(t[r]),l=Array.isArray(a),f=!c&&l;f?t[r]=this._interpolationFunction(a,o):typeof a=="object"&&a?this._updateProperties(t[r],s,a,o):(a=this._handleRelativeValue(s,a),typeof a=="number"&&(t[r]=s+(a-s)*o))}},e.prototype._handleRelativeValue=function(t,n){return typeof n!="string"?n:n.charAt(0)==="+"||n.charAt(0)==="-"?t+parseFloat(n):parseFloat(n)},e.prototype._swapEndStartRepeatValues=function(t){var n=this._valuesStartRepeat[t],i=this._valuesEnd[t];typeof i=="string"?this._valuesStartRepeat[t]=this._valuesStartRepeat[t]+parseFloat(i):this._valuesStartRepeat[t]=this._valuesEnd[t],this._valuesEnd[t]=n},e.autoStartOnUpdate=!1,e}();var wii=kge.nextId,vm=XY,Dii=vm.getAll.bind(vm),Iii=vm.removeAll.bind(vm),Pii=vm.add.bind(vm),Rii=vm.remove.bind(vm),Oii=vm.update.bind(vm);var Xrt={LINEAR_NONE:Ii.Linear.None,QUADRATIC_IN:Ii.Quadratic.In,QUADRATIC_OUT:Ii.Quadratic.Out,QUADRATIC_IN_OUT:Ii.Quadratic.InOut,CUBIC_IN:Ii.Cubic.In,CUBIC_OUT:Ii.Cubic.Out,CUBIC_IN_OUT:Ii.Cubic.InOut,QUARTIC_IN:Ii.Quartic.In,QUARTIC_OUT:Ii.Quartic.Out,QUARTIC_IN_OUT:Ii.Quartic.InOut,QUINTIC_IN:Ii.Quintic.In,QUINTIC_OUT:Ii.Quintic.Out,QUINTIC_IN_OUT:Ii.Quintic.InOut,SINUSOIDAL_IN:Ii.Sinusoidal.In,SINUSOIDAL_OUT:Ii.Sinusoidal.Out,SINUSOIDAL_IN_OUT:Ii.Sinusoidal.InOut,EXPONENTIAL_IN:Ii.Exponential.In,EXPONENTIAL_OUT:Ii.Exponential.Out,EXPONENTIAL_IN_OUT:Ii.Exponential.InOut,CIRCULAR_IN:Ii.Circular.In,CIRCULAR_OUT:Ii.Circular.Out,CIRCULAR_IN_OUT:Ii.Circular.InOut,ELASTIC_IN:Ii.Elastic.In,ELASTIC_OUT:Ii.Elastic.Out,ELASTIC_IN_OUT:Ii.Elastic.InOut,BACK_IN:Ii.Back.In,BACK_OUT:Ii.Back.Out,BACK_IN_OUT:Ii.Back.InOut,BOUNCE_IN:Ii.Bounce.In,BOUNCE_OUT:Ii.Bounce.Out,BOUNCE_IN_OUT:Ii.Bounce.InOut},Qr=Object.freeze(Xrt);function AV(e,t,n){this.type="KmlTourFlyTo",this.blocking=!0,this.activeCamera=null,this.activeCallback=null,this.duration=e,this.view=n,this.flyToMode=t}AV.prototype.play=function(e,t,n){if(this.activeCamera=t,u(e)&&e!==null){let o=this;this.activeCallback=function(r){delete o.activeCallback,delete o.activeCamera,e(u(r)?!1:r)}}let i=this.getCameraOptions(n);if(this.view.headingPitchRoll)t.flyTo(i);else if(this.view.headingPitchRange){let o=new ae(this.view.position);t.flyToBoundingSphere(o,i)}};AV.prototype.stop=function(){u(this.activeCamera)&&this.activeCamera.cancelFlight(),u(this.activeCallback)&&this.activeCallback(!0)};AV.prototype.getCameraOptions=function(e){let t={duration:this.duration};return u(this.activeCallback)&&(t.complete=this.activeCallback),this.flyToMode==="smooth"&&(t.easingFunction=Qr.LINEAR_NONE),this.view.headingPitchRoll?(t.destination=this.view.position,t.orientation=this.view.headingPitchRoll):this.view.headingPitchRange&&(t.offset=this.view.headingPitchRange),u(e)&&(t=bt(t,e)),t};var TV=AV;function KY(e){this.type="KmlTourWait",this.blocking=!0,this.duration=e,this.timeout=null}KY.prototype.play=function(e){let t=this;this.activeCallback=e,this.timeout=setTimeout(function(){delete t.activeCallback,e(!1)},this.duration*1e3)};KY.prototype.stop=function(){clearTimeout(this.timeout),u(this.activeCallback)&&this.activeCallback(!0)};var EV=KY;var Kge={avi:"video/x-msvideo",bmp:"image/bmp",bz2:"application/x-bzip2",chm:"application/vnd.ms-htmlhelp",css:"text/css",csv:"text/csv",doc:"application/msword",dvi:"application/x-dvi",eps:"application/postscript",flv:"video/x-flv",gif:"image/gif",gz:"application/x-gzip",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",jnlp:"application/x-java-jnlp-file",jpeg:"image/jpeg",jpg:"image/jpeg",m3u:"audio/x-mpegurl",m4v:"video/mp4",mathml:"application/mathml+xml",mid:"audio/midi",midi:"audio/midi",mov:"video/quicktime",mp3:"audio/mpeg",mp4:"video/mp4",mp4v:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",ogg:"application/ogg",pdf:"application/pdf",png:"image/png",pps:"application/vnd.ms-powerpoint",ppt:"application/vnd.ms-powerpoint",ps:"application/postscript",qt:"video/quicktime",rdf:"application/rdf+xml",rss:"application/rss+xml",rtf:"application/rtf",svg:"image/svg+xml",swf:"application/x-shockwave-flash",text:"text/plain",tif:"image/tiff",tiff:"image/tiff",txt:"text/plain",wav:"audio/x-wav",wma:"audio/x-ms-wma",wmv:"video/x-ms-wmv",xml:"application/xml",zip:"application/zip",detectFromFilename:function(e){let t=e.toLowerCase();return t=rC(t),Kge[t]}},nX;typeof DOMParser<"u"&&(nX=new DOMParser);var Krt=new pV({stripPrefix:!1,email:!1,replaceFn:function(e){return e.urlMatchType==="scheme"||e.urlMatchType==="www"}}),N0=32,Uge=2414016,zge=1,Hge=16093e3,Gge=.1,Wge=[null,void 0,"http://www.opengis.net/kml/2.2","http://earth.google.com/kml/2.2","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.0"],jge=["http://www.google.com/kml/ext/2.2"],Zrt=["http://www.w3.org/2005/Atom"],Re={kml:Wge,gx:jge,atom:Zrt,kmlgx:Wge.concat(jge)},iX={Document:r0e,Folder:pst,Placemark:_st,NetworkLink:Sst,GroundOverlay:Ast,PhotoOverlay:c0e,ScreenOverlay:Cst,Tour:yst};function wm(e){this._dataSource=e,this._deferred=Wl(),this._stack=[],this._promises=[],this._timeoutSet=!1,this._used=!1,this._started=0,this._timeThreshold=1e3}Object.defineProperties(wm.prototype,{dataSource:{get:function(){return this._dataSource}}});wm.prototype.addNodes=function(e,t){this._stack.push({nodes:e,index:0,processingData:t}),this._used=!0};wm.prototype.addPromise=function(e){this._promises.push(e)};wm.prototype.wait=function(){let e=this._deferred;return this._used||e.resolve(),Promise.all([e.promise,Promise.all(this._promises)])};wm.prototype.process=function(){let e=this._stack.length===1;return e&&(this._started=wu._getTimestamp()),this._process(e)};wm.prototype._giveUpTime=function(){if(this._timeoutSet)return;this._timeoutSet=!0,this._timeThreshold=50;let e=this;setTimeout(function(){e._timeoutSet=!1,e._started=wu._getTimestamp(),e._process(!0)},0)};wm.prototype._nextNode=function(){let e=this._stack,t=e[e.length-1],n=t.index,i=t.nodes;if(n!==i.length)return++t.index,i[n]};wm.prototype._pop=function(){let e=this._stack;return e.pop(),e.length===0?(this._deferred.resolve(),!1):!0};wm.prototype._process=function(e){let t=this.dataSource,n=this._stack[this._stack.length-1].processingData,i=this._nextNode();for(;u(i);){let o=iX[i.localName];if(u(o)&&(Re.kml.indexOf(i.namespaceURI)!==-1||Re.gx.indexOf(i.namespaceURI)!==-1)&&(o(t,i,n,this),this._timeoutSet||wu._getTimestamp()>this._started+this._timeThreshold)){this._giveUpTime();return}i=this._nextNode()}this._pop()&&e&&this._process(!0)};function $rt(e){let t=e.slice(0,Math.min(4,e.size)),n=Wl(),i=new FileReader;return i.addEventListener("load",function(){n.resolve(new DataView(i.result).getUint32(0,!1)===1347093252)}),i.addEventListener("error",function(){n.reject(i.error)}),i.readAsArrayBuffer(t),n.promise}function Qrt(e){let t=Wl(),n=new FileReader;return n.addEventListener("load",function(){t.resolve(n.result)}),n.addEventListener("error",function(){t.reject(n.error)}),n.readAsText(e),t.promise}function Zge(e){let t={xsi:"http://www.w3.org/2001/XMLSchema-instance"},n,i,o,r;for(let s in t)t.hasOwnProperty(s)&&(o=RegExp(`[< ]${s}:`),r=`xmlns:${s}=`,o.test(e)&&e.indexOf(r)===-1&&(u(n)||(n=e.substr(0,e.indexOf("<kml")+4),i=e.substr(n.length)),n+=` ${r}"${t[s]}"`));return u(n)&&(e=n+i),e}function $ge(e){let t=e.indexOf("xmlns:"),n=e.indexOf(">",t),i,o,r;for(;t!==-1&&t<n;)i=e.slice(t,e.indexOf('"',t)),o=t,t=e.indexOf(i,t+1),t!==-1?(r=e.indexOf('"',e.indexOf('"',t)+1),e=e.slice(0,t-1)+e.slice(r+1,e.length),t=e.indexOf("xmlns:",o-1)):t=e.indexOf("xmlns:",o+1);return e}function Jrt(e,t){return Promise.resolve(e.getData(new F4)).then(function(n){n=Zge(n),n=$ge(n),t.kml=nX.parseFromString(n,"application/xml")})}function ZY(e,t){let n=x(Kge.detectFromFilename(e.filename),"application/octet-stream");return Promise.resolve(e.getData(new L4(n))).then(function(i){t[e.filename]=i})}function Su(e,t,n,i){let o=i.keys,r=new pD.default("."),s=e.querySelectorAll(t);for(let a=0;a<s.length;a++){let c=s[a],l=c.getAttribute(n);if(u(l)){let d=new pD.default(l).absoluteTo(r).toString(),p=o.indexOf(d);if(p!==-1){let g=o[p];c.setAttribute(n,i[g]),t==="a"&&c.getAttribute("download")===null&&c.setAttribute("download",g)}}}}function vu(e,t,n,i){let o=e.querySelectorAll(t);for(let r=0;r<o.length;r++){let s=o[r],a=s.getAttribute(n),c=oX(a,i);u(c)&&s.setAttribute(n,c.url)}}function Qge(e,t,n){let i=vs(e,"id");i=u(i)&&i.length!==0?i:Hn(),u(n)&&(i=n+i);let o=t.getById(i);return u(o)&&(i=Hn(),u(n)&&(i=n+i)),o=t.add(new ar({id:i})),u(o.kml)||(o.addProperty("kml"),o.kml=new Ist),o}function _D(e,t){return e==="absolute"||e==="relativeToGround"||t==="relativeToSeaFloor"}function DV(e,t){if(!u(e))return h.fromDegrees(0,0,0,t);let n=e.match(/[^\s,\n]+/g);if(!u(n))return h.fromDegrees(0,0,0,t);let i=parseFloat(n[0]),o=parseFloat(n[1]),r=parseFloat(n[2]);return i=isNaN(i)?0:i,o=isNaN(o)?0:o,r=isNaN(r)?0:r,h.fromDegrees(i,o,r,t)}function SV(e,t){if(!u(e))return;let n=e.textContent.match(/[^\s\n]+/g);if(!u(n))return;let i=n.length,o=new Array(i),r=0;for(let s=0;s<i;s++)o[r++]=DV(n[s],t);return o}function F0(e,t){if(!u(e))return;let n=e.getAttribute(t);if(n!==null){let i=parseFloat(n);return isNaN(i)?void 0:i}}function vs(e,t){if(!u(e))return;let n=e.getAttribute(t);return n!==null?n:void 0}function Pi(e,t,n){if(!u(e))return;let i=e.childNodes,o=i.length;for(let r=0;r<o;r++){let s=i[r];if(s.localName===t&&n.indexOf(s.namespaceURI)!==-1)return s}}function qge(e,t,n){if(!u(e))return;let i=[],o=e.getElementsByTagNameNS("*",t),r=o.length;for(let s=0;s<r;s++){let a=o[s];a.localName===t&&n.indexOf(a.namespaceURI)!==-1&&i.push(a)}return i}function Qd(e,t,n){if(!u(e))return[];let i=[],o=e.childNodes,r=o.length;for(let s=0;s<r;s++){let a=o[s];a.localName===t&&n.indexOf(a.namespaceURI)!==-1&&i.push(a)}return i}function Zn(e,t,n){let i=Pi(e,t,n);if(u(i)){let o=parseFloat(i.textContent);return isNaN(o)?void 0:o}}function Dn(e,t,n){let i=Pi(e,t,n);if(u(i))return i.textContent.trim()}function Jd(e,t,n){let i=Pi(e,t,n);if(u(i)){let o=i.textContent.trim();return o==="1"||/^true$/i.test(o)}}function oX(e,t,n){if(!u(e))return;let i;if(u(n)){e=e.replace(/\\/g,"/");let o=n[e];if(u(o))i=new De({url:o});else{let r=new pD.default(t.getUrlComponent()),s=new pD.default(e);o=n[s.absoluteTo(r)],u(o)&&(i=new De({url:o}))}}return u(i)||(i=t.getDerivedResource({url:e})),i}var Ml={maximumRed:void 0,red:void 0,maximumGreen:void 0,green:void 0,maximumBlue:void 0,blue:void 0};function eX(e,t){if(!u(e)||/^\s*$/gm.test(e))return;e[0]==="#"&&(e=e.substring(1));let n=parseInt(e.substring(0,2),16)/255,i=parseInt(e.substring(2,4),16)/255,o=parseInt(e.substring(4,6),16)/255,r=parseInt(e.substring(6,8),16)/255;return t?(r>0?(Ml.maximumRed=r,Ml.red=void 0):(Ml.maximumRed=void 0,Ml.red=0),o>0?(Ml.maximumGreen=o,Ml.green=void 0):(Ml.maximumGreen=void 0,Ml.green=0),i>0?(Ml.maximumBlue=i,Ml.blue=void 0):(Ml.maximumBlue=void 0,Ml.blue=0),Ml.alpha=n,G.fromRandom(Ml)):new G(r,o,i,n)}function cb(e,t,n){let i=Dn(e,t,n);if(u(i))return eX(i,Dn(e,"colorMode",n)==="random")}function est(e){let t=Pi(e,"TimeStamp",Re.kmlgx),n=Dn(t,"when",Re.kmlgx);if(!u(t)||!u(n)||n.length===0)return;let i=$.fromIso8601(n),o=new Xr;return o.addInterval(new Sn({start:i,stop:He.MAXIMUM_VALUE})),o}function tst(e){let t=Pi(e,"TimeSpan",Re.kmlgx);if(!u(t))return;let n,i=Pi(t,"begin",Re.kmlgx),o=u(i)?$.fromIso8601(i.textContent):void 0,r=Pi(t,"end",Re.kmlgx),s=u(r)?$.fromIso8601(r.textContent):void 0;if(u(o)&&u(s)){if($.lessThan(s,o)){let a=o;o=s,s=a}n=new Xr,n.addInterval(new Sn({start:o,stop:s}))}else u(o)?(n=new Xr,n.addInterval(new Sn({start:o,stop:He.MAXIMUM_VALUE}))):u(s)&&(n=new Xr,n.addInterval(new Sn({start:He.MINIMUM_VALUE,stop:s})));return n}function Jge(){let e=new Sc;return e.width=N0,e.height=N0,e.scaleByDistance=new kt(Uge,zge,Hge,Gge),e.pixelOffsetScaleByDistance=new kt(Uge,zge,Hge,Gge),e}function rX(){let e=new Lh;return e.outline=!0,e.outlineColor=G.WHITE,e}function e0e(){let e=new Mh;return e.translucencyByDistance=new kt(3e6,1,5e6,0),e.pixelOffset=new H(17,0),e.horizontalOrigin=bi.LEFT,e.font="16px sans-serif",e.style=$o.FILL_AND_OUTLINE,e}function sX(e,t,n,i,o){let r=Dn(e,"href",Re.kml);if(!u(r)||r.length===0)return;if(r.indexOf("root://icons/palette-")===0){let a=r.charAt(21),c=x(Zn(e,"x",Re.gx),0),l=x(Zn(e,"y",Re.gx),0);c=Math.min(c/32,7),l=7-Math.min(l/32,7);let f=8*l+c;r=`https://maps.google.com/mapfiles/kml/pal${a}/icon${f}.png`}let s=oX(r,n,i);if(o){let a=Dn(e,"refreshMode",Re.kml),c=Dn(e,"viewRefreshMode",Re.kml);a==="onInterval"||a==="onExpire"?At(`kml-refreshMode-${a}`,`KML - Unsupported Icon refreshMode: ${a}`):(c==="onStop"||c==="onRegion")&&At(`kml-refreshMode-${c}`,`KML - Unsupported Icon viewRefreshMode: ${c}`);let l=x(Dn(e,"viewBoundScale",Re.kml),1),f=c==="onStop"?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"",d=x(Dn(e,"viewFormat",Re.kml),f),p=Dn(e,"httpQuery",Re.kml);u(d)&&s.setQueryParameters(Xu(wV(d))),u(p)&&s.setQueryParameters(Xu(wV(p)));let g=t._ellipsoid;return cX(s,t.camera,t.canvas,l,t._lastCameraView.bbox,g),s}return s}function nst(e,t,n,i,o){let r=Zn(t,"scale",Re.kml),s=Zn(t,"heading",Re.kml),a=cb(t,"color",Re.kml),c=Pi(t,"Icon",Re.kml),l=sX(c,e,i,o,!1);u(c)&&!u(l)&&(l=!1);let f=Zn(c,"x",Re.gx),d=Zn(c,"y",Re.gx),p=Zn(c,"w",Re.gx),g=Zn(c,"h",Re.gx),m=Pi(t,"hotSpot",Re.kml),y=F0(m,"x"),b=F0(m,"y"),C=vs(m,"xunits"),A=vs(m,"yunits"),T=n.billboard;u(T)||(T=Jge(),n.billboard=T),T.image=l,T.scale=r,T.color=a,(u(f)||u(d)||u(p)||u(g))&&(T.imageSubRegion=new qe(f,d,p,g)),u(s)&&s!==0&&(T.rotation=R.toRadians(-s),T.alignedAxis=h.UNIT_Z),r=x(r,1);let E,v;u(y)&&(C==="pixels"?E=-y*r:C==="insetPixels"?E=(y-N0)*r:C==="fraction"&&(E=-y*N0*r),E+=N0*.5*r),u(b)&&(A==="pixels"?v=b*r:A==="insetPixels"?v=(-b+N0)*r:A==="fraction"&&(v=b*N0*r),v-=N0*.5*r),(u(E)||u(v))&&(T.pixelOffset=new H(E,v))}function vV(e,t,n,i,o){for(let r=0,s=t.childNodes.length;r<s;r++){let a=t.childNodes.item(r);if(a.localName==="IconStyle")nst(e,a,n,i,o);else if(a.localName==="LabelStyle"){let c=n.label;u(c)||(c=e0e(),n.label=c),c.scale=x(Zn(a,"scale",Re.kml),c.scale),c.fillColor=x(cb(a,"color",Re.kml),c.fillColor),c.text=n.name}else if(a.localName==="LineStyle"){let c=n.polyline;u(c)||(c=new Pc,n.polyline=c),c.width=Zn(a,"width",Re.kml),c.material=cb(a,"color",Re.kml),u(cb(a,"outerColor",Re.gx))&&At("kml-gx:outerColor","KML - gx:outerColor is not supported in a LineStyle"),u(Zn(a,"outerWidth",Re.gx))&&At("kml-gx:outerWidth","KML - gx:outerWidth is not supported in a LineStyle"),u(Zn(a,"physicalWidth",Re.gx))&&At("kml-gx:physicalWidth","KML - gx:physicalWidth is not supported in a LineStyle"),u(Jd(a,"labelVisibility",Re.gx))&&At("kml-gx:labelVisibility","KML - gx:labelVisibility is not supported in a LineStyle")}else if(a.localName==="PolyStyle"){let c=n.polygon;u(c)||(c=rX(),n.polygon=c),c.material=x(cb(a,"color",Re.kml),c.material),c.fill=x(Jd(a,"fill",Re.kml),c.fill),c.outline=x(Jd(a,"outline",Re.kml),c.outline)}else if(a.localName==="BalloonStyle"){let c=x(eX(Dn(a,"bgColor",Re.kml)),G.WHITE),l=x(eX(Dn(a,"textColor",Re.kml)),G.BLACK),f=Dn(a,"text",Re.kml);n.addProperty("balloonStyle"),n.balloonStyle={bgColor:c,textColor:l,text:f}}else if(a.localName==="ListStyle"){let c=Dn(a,"listItemType",Re.kml);(c==="radioFolder"||c==="checkOffOnly")&&At(`kml-listStyle-${c}`,`KML - Unsupported ListStyle with listItemType: ${c}`)}}}function ist(e,t,n,i,o){let r=new ar,s,a=-1,c=t.childNodes,l=c.length;for(let d=0;d<l;d++){let p=c[d];(p.localName==="Style"||p.localName==="StyleMap")&&(a=d)}if(a!==-1){let d=c[a];if(d.localName==="Style")vV(e,d,r,i,o);else{let p=Qd(d,"Pair",Re.kml);for(let g=0;g<p.length;g++){let m=p[g],y=Dn(m,"key",Re.kml);if(y==="normal"){let b=Dn(m,"styleUrl",Re.kml);if(u(b))s=n.getById(b),u(s)||(s=n.getById(`#${b}`)),u(s)&&r.merge(s);else{let C=Pi(m,"Style",Re.kml);vV(e,C,r,i,o)}}else At(`kml-styleMap-${y}`,`KML - Unsupported StyleMap key: ${y}`)}}}let f=Dn(t,"styleUrl",Re.kml);if(u(f)){let d=f;if(f[0]!=="#"&&f.indexOf("#")!==-1){let p=f.split("#"),g=p[0];d=`${i.getDerivedResource({url:g}).getUrlComponent()}#${p[1]}`}s=n.getById(d),u(s)||(s=n.getById(`#${d}`)),u(s)&&r.merge(s)}return r}function ost(e,t,n){return t.fetchXML().then(function(i){return t0e(e,i,n,t,!0)})}function t0e(e,t,n,i,o,r){let s,a,c,l,f=qge(t,"Style",Re.kml);if(u(f)){let y=f.length;for(s=0;s<y;s++)l=f[s],a=vs(l,"id"),u(a)&&(a=`#${a}`,o&&u(i)&&(a=i.getUrlComponent()+a),u(n.getById(a))||(c=new ar({id:a}),n.add(c),vV(e,l,c,i,r)))}let d=qge(t,"StyleMap",Re.kml);if(u(d)){let y=d.length;for(s=0;s<y;s++){let b=d[s];if(a=vs(b,"id"),u(a)){let C=Qd(b,"Pair",Re.kml);for(let A=0;A<C.length;A++){let T=C[A],E=Dn(T,"key",Re.kml);if(E==="normal"){if(a=`#${a}`,o&&u(i)&&(a=i.getUrlComponent()+a),!u(n.getById(a))){c=n.getOrCreateEntity(a);let v=Dn(T,"styleUrl",Re.kml);if(u(v)){v[0]!=="#"&&(v=`#${v}`),o&&u(i)&&(v=i.getUrlComponent()+v);let D=n.getById(v);u(D)&&c.merge(D)}else l=Pi(T,"Style",Re.kml),vV(e,l,c,i,r)}}else At(`kml-styleMap-${E}`,`KML - Unsupported StyleMap key: ${E}`)}}}}let p=[],g=t.getElementsByTagName("styleUrl"),m=g.length;for(s=0;s<m;s++){let y=g[s].textContent;if(y[0]!=="#"){let b=y.split("#");if(b.length===2){let C=b[0],A=i.getDerivedResource({url:C});p.push(ost(e,A,n))}}}return p}function aX(e,t,n){let i=new a0(e,t.id,["position"]),o=new o_(t.position);t.polyline=u(n.polyline)?n.polyline.clone():new Pc,t.polyline.positions=new r0([i,o])}function n0e(e,t){return!u(e)&&!u(t)||e==="clampToGround"?Xe.CLAMP_TO_GROUND:e==="relativeToGround"?Xe.RELATIVE_TO_GROUND:e==="absolute"?Xe.NONE:t==="clampToSeaFloor"?(At("kml-gx:altitudeMode-clampToSeaFloor","KML - <gx:altitudeMode>:clampToSeaFloor is currently not supported, using <kml:altitudeMode>:clampToGround."),Xe.CLAMP_TO_GROUND):t==="relativeToSeaFloor"?(At("kml-gx:altitudeMode-relativeToSeaFloor","KML - <gx:altitudeMode>:relativeToSeaFloor is currently not supported, using <kml:altitudeMode>:relativeToGround."),Xe.RELATIVE_TO_GROUND):(u(e)?At("kml-altitudeMode-unknown",`KML - Unknown <kml:altitudeMode>:${e}, using <kml:altitudeMode>:CLAMP_TO_GROUND.`):At("kml-gx:altitudeMode-unknown",`KML - Unknown <gx:altitudeMode>:${t}, using <kml:altitudeMode>:CLAMP_TO_GROUND.`),Xe.CLAMP_TO_GROUND)}function rst(e,t,n){return n==="relativeToSeaFloor"||t==="absolute"||t==="relativeToGround"?e:((u(t)&&t!=="clampToGround"||u(n)&&n!=="clampToSeaFloor")&&At("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${x(t,n)}`),new o_(e))}function sst(e,t,n,i){if(!u(e))return;if(n==="relativeToSeaFloor"||t==="absolute"||t==="relativeToGround")return e;(u(t)&&t!=="clampToGround"||u(n)&&n!=="clampToSeaFloor")&&At("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${x(t,n)}`);let o=e.length;for(let r=0;r<o;r++){let s=e[r];i.scaleToGeodeticSurface(s,s)}return e}function IV(e,t,n,i){let o=t.label;u(o)||(o=u(n.label)?n.label.clone():e0e(),t.label=o),o.text=t.name;let r=t.billboard;u(r)||(r=u(n.billboard)?n.billboard.clone():Jge(),t.billboard=r),u(r.image)?r.image.getValue()||(r.image=void 0):r.image=e._pinBuilder.fromColor(G.YELLOW,64);let s=1;u(r.scale)&&(s=r.scale.getValue(),s!==0?o.pixelOffset=new H(s*16+1,0):(o.pixelOffset=void 0,o.horizontalOrigin=void 0)),u(i)&&e._clampToGround&&(r.heightReference=i,o.heightReference=i)}function i0e(e,t){let n=e.path;u(n)||(n=new $_,n.leadTime=0,e.path=n);let i=t.polyline;u(i)&&(n.material=i.material,n.width=i.width)}function ast(e,t,n,i,o){let r=Dn(n,"coordinates",Re.kml),s=Dn(n,"altitudeMode",Re.kml),a=Dn(n,"altitudeMode",Re.gx),c=Jd(n,"extrude",Re.kml),l=e._ellipsoid,f=DV(r,l);return i.position=f,IV(e,i,o,n0e(s,a)),c&&_D(s,a)&&aX(t,i,o),!0}function Yge(e,t,n,i,o){let r=Pi(n,"coordinates",Re.kml),s=Dn(n,"altitudeMode",Re.kml),a=Dn(n,"altitudeMode",Re.gx),c=Jd(n,"extrude",Re.kml),l=Jd(n,"tessellate",Re.kml),f=_D(s,a),d=Zn(n,"drawOrder",Re.gx),p=e._ellipsoid,g=SV(r,p),m=o.polyline;if(f&&c){let y=new Q_;i.wall=y,y.positions=g;let b=o.polygon;u(b)&&(y.fill=b.fill,y.material=b.material),y.outline=!0,u(m)?(y.outlineColor=u(m.material)?m.material.color:G.WHITE,y.outlineWidth=m.width):u(b)&&(y.outlineColor=u(b.material)?b.material.color:G.WHITE)}else if(e._clampToGround&&!f&&l){let y=new Pc;y.clampToGround=!0,i.polyline=y,y.positions=g,u(m)?(y.material=u(m.material)?m.material.color.getValue(He.MINIMUM_VALUE):G.WHITE,y.width=x(m.width,1)):(y.material=G.WHITE,y.width=1),y.zIndex=d}else u(d)&&At("kml-gx:drawOrder","KML - gx:drawOrder is not supported in LineStrings when clampToGround is false"),e._clampToGround&&!l&&At("kml-line-tesselate","Ignoring clampToGround for KML lines without the tessellate flag."),m=u(m)?m.clone():new Pc,i.polyline=m,m.positions=sst(g,s,a,p),(!l||f)&&(m.arcType=nn.NONE);return!0}function cst(e,t,n,i,o){let r=Pi(n,"outerBoundaryIs",Re.kml),s=Pi(r,"LinearRing",Re.kml),a=Pi(s,"coordinates",Re.kml),c=e._ellipsoid,l=SV(a,c),f=Jd(n,"extrude",Re.kml),d=Dn(n,"altitudeMode",Re.kml),p=Dn(n,"altitudeMode",Re.gx),g=_D(d,p),m=u(o.polygon)?o.polygon.clone():rX(),y=o.polyline;if(u(y)&&(m.outlineColor=u(y.material)?y.material.color:G.WHITE,m.outlineWidth=y.width),i.polygon=m,g?(m.perPositionHeight=!0,m.extrudedHeight=f?0:void 0):e._clampToGround||(m.height=0),u(l)){let b=new Za(l),C=Qd(n,"innerBoundaryIs",Re.kml);for(let A=0;A<C.length;A++){s=Qd(C[A],"LinearRing",Re.kml);for(let T=0;T<s.length;T++)a=Pi(s[T],"coordinates",Re.kml),l=SV(a,c),u(l)&&b.holes.push(new Za(l))}m.hierarchy=b}return!0}function lst(e,t,n,i,o){let r=Dn(n,"altitudeMode",Re.kml),s=Dn(n,"altitudeMode",Re.gx),a=Qd(n,"coord",Re.gx),c=Qd(n,"angles",Re.gx),l=Qd(n,"when",Re.kml),f=Jd(n,"extrude",Re.kml),d=_D(r,s),p=e._ellipsoid;c.length>0&&At("kml-gx:angles","KML - gx:angles are not supported in gx:Tracks");let g=Math.min(a.length,l.length),m=[],y=[];for(let C=0;C<g;C++){let A=DV(a[C].textContent,p);m.push(A),y.push($.fromIso8601(l[C].textContent))}let b=new Ra;return b.addSamples(y,m),i.position=b,IV(e,i,o,n0e(r,s)),i0e(i,o),i.availability=new Xr,l.length>0&&i.availability.addInterval(new Sn({start:y[0],stop:y[y.length-1]})),d&&f&&aX(t,i,o),!0}function Xge(e,t,n,i,o,r,s,a,c){let l=e[0],f=e[e.length-1],d=new Ra;d.addSamples(e,t),n.intervals.addInterval(new Sn({start:l,stop:f,isStartIncluded:c,isStopIncluded:c,data:rst(d,s,a)})),i.addInterval(new Sn({start:l,stop:f,isStartIncluded:c,isStopIncluded:c})),o.intervals.addInterval(new Sn({start:l,stop:f,isStartIncluded:c,isStopIncluded:c,data:r}))}function ust(e,t,n,i,o){let r=Jd(n,"interpolate",Re.gx),s=Qd(n,"Track",Re.gx),a,c,l,f=!1,d=new u0,p=new Xr,g=new Pa,m=e._ellipsoid;for(let y=0,b=s.length;y<b;y++){let C=s[y],A=Qd(C,"when",Re.kml),T=Qd(C,"coord",Re.gx),E=Dn(C,"altitudeMode",Re.kml),v=Dn(C,"altitudeMode",Re.gx),D=_D(E,v),O=Jd(C,"extrude",Re.kml),P=Math.min(T.length,A.length),M=[];a=[];for(let L=0;L<P;L++){let _=DV(T[L].textContent,m);M.push(_),a.push($.fromIso8601(A[L].textContent))}r&&(u(c)&&Xge([c,a[0]],[l,M[0]],g,p,d,!1,"absolute",void 0,!1),c=a[P-1],l=M[M.length-1]),Xge(a,M,g,p,d,D&&O,E,v,!0),f=f||D&&O}return i.availability=p,i.position=g,IV(e,i,o),i0e(i,o),f&&(aX(t,i,o),i.polyline.show=d),!0}var o0e={Point:ast,LineString:Yge,LinearRing:Yge,Polygon:cst,Track:lst,MultiTrack:ust,MultiGeometry:fst,Model:dst};function fst(e,t,n,i,o,r){let s=n.childNodes,a=!1;for(let c=0,l=s.length;c<l;c++){let f=s.item(c),d=o0e[f.localName];if(u(d)){let p=Qge(f,t,r);p.parent=i,p.name=i.name,p.availability=i.availability,p.description=i.description,p.kml=i.kml,d(e,t,f,p,o)&&(a=!0)}}return a}function dst(e,t,n,i,o){return At("kml-unsupportedGeometry",`KML - Unsupported geometry: ${n.localName}`),!1}function hst(e,t){let n=Pi(e,"ExtendedData",Re.kml);if(!u(n))return;u(Pi(n,"SchemaData",Re.kml))&&At("kml-schemaData","KML - SchemaData is unsupported"),u(vs(n,"xmlns:prefix"))&&At("kml-extendedData","KML - ExtendedData with xmlns:prefix is unsupported");let i={},o=Qd(n,"Data",Re.kml);if(u(o)){let r=o.length;for(let s=0;s<r;s++){let a=o[s],c=vs(a,"name");u(c)&&(i[c]={displayName:Dn(a,"displayName",Re.kml),value:Dn(a,"value",Re.kml)})}}t.kml.extendedData=i}var go;typeof document<"u"&&(go=document.createElement("div"));function mst(e,t,n,i,o){let r,s,a,c=t.kml,l=c.extendedData,f=Dn(e,"description",Re.kml),d=x(t.balloonStyle,n.balloonStyle),p=G.WHITE,g=G.BLACK,m=f;u(d)&&(p=x(d.bgColor,G.WHITE),g=x(d.textColor,G.BLACK),m=x(d.text,f));let y;if(u(m)){if(m=m.replace("$[name]",x(t.name,"")),m=m.replace("$[description]",x(f,"")),m=m.replace("$[address]",x(c.address,"")),m=m.replace("$[Snippet]",x(c.snippet,"")),m=m.replace("$[id]",t.id),m=m.replace("$[geDirections]",""),u(l)){let A=m.match(/\$\[.+?\]/g);if(A!==null)for(r=0;r<A.length;r++){let T=A[r],E=T.substr(2,T.length-3),v=/\/displayName$/.test(E);E=E.replace(/\/displayName$/,""),y=l[E],u(y)&&(y=v?y.displayName:y.value),u(y)&&(m=m.replace(T,x(y,"")))}}}else if(u(l)&&(a=Object.keys(l),a.length>0)){for(m='<table class="cesium-infoBox-defaultTable cesium-infoBox-defaultTable-lighter"><tbody>',r=0;r<a.length;r++)s=a[r],y=l[s],m+=`<tr><th>${x(y.displayName,s)}</th><td>${x(y.value,"")}</td></tr>`;m+="</tbody></table>"}if(!u(m))return;m=Krt.link(m),go.innerHTML=m;let b=go.querySelectorAll("a");for(r=0;r<b.length;r++)b[r].setAttribute("target","_blank");u(i)&&i.keys.length>1&&(Su(go,"a","href",i),Su(go,"link","href",i),Su(go,"area","href",i),Su(go,"img","src",i),Su(go,"iframe","src",i),Su(go,"video","src",i),Su(go,"audio","src",i),Su(go,"source","src",i),Su(go,"track","src",i),Su(go,"input","src",i),Su(go,"embed","src",i),Su(go,"script","src",i),Su(go,"video","poster",i)),vu(go,"a","href",o),vu(go,"link","href",o),vu(go,"area","href",o),vu(go,"img","src",o),vu(go,"iframe","src",o),vu(go,"video","src",o),vu(go,"audio","src",o),vu(go,"source","src",o),vu(go,"track","src",o),vu(go,"input","src",o),vu(go,"embed","src",o),vu(go,"script","src",o),vu(go,"video","poster",o);let C='<div class="cesium-infoBox-description-lighter" style="';C+="overflow:auto;",C+="word-wrap:break-word;",C+=`background-color:${p.toCssColorString()};`,C+=`color:${g.toCssColorString()};`,C+='">',C+=`${go.innerHTML}</div>`,go.innerHTML="",t.description=C}function PV(e,t,n){let i=n.entityCollection,o=n.parentEntity,r=n.sourceResource,s=n.uriResolver,a=Qge(t,i,n.context),c=a.kml,l=ist(e,t,n.styleCollection,r,s),f=Dn(t,"name",Re.kml);a.name=f,a.parent=o;let d=tst(t);u(d)||(d=est(t)),a.availability=d,uX(a);function p(T){return T?T.show&&p(T.parent):!0}let g=Jd(t,"visibility",Re.kml);a.show=p(o)&&x(g,!0);let m=Pi(t,"author",Re.atom),y=c.author;y.name=Dn(m,"name",Re.atom),y.uri=Dn(m,"uri",Re.atom),y.email=Dn(m,"email",Re.atom);let b=Pi(t,"link",Re.atom),C=c.link;C.href=vs(b,"href"),C.hreflang=vs(b,"hreflang"),C.rel=vs(b,"rel"),C.type=vs(b,"type"),C.title=vs(b,"title"),C.length=vs(b,"length"),c.address=Dn(t,"address",Re.kml),c.phoneNumber=Dn(t,"phoneNumber",Re.kml),c.snippet=Dn(t,"Snippet",Re.kml),hst(t,a),mst(t,a,l,s,r);let A=e._ellipsoid;return a0e(t,a,A),s0e(t,a,A),u(Pi(t,"Region",Re.kml))&&At("kml-region","KML - Placemark Regions are unsupported"),{entity:a,styleEntity:l}}function r0e(e,t,n,i){i.addNodes(t.childNodes,n),i.process()}function pst(e,t,n,i){let o=PV(e,t,n),r=Ge(n);r.parentEntity=o.entity,r0e(e,t,r,i)}function _st(e,t,n,i){let o=PV(e,t,n),r=o.entity,s=o.styleEntity,a=!1,c=t.childNodes;for(let l=0,f=c.length;l<f&&!a;l++){let d=c.item(l),p=o0e[d.localName];u(p)&&(p(e,n.entityCollection,d,r,s,r.id),a=!0)}a||(r.merge(s),IV(e,r,s))}var gst={FlyTo:bst,Wait:xst,SoundCue:$Y,AnimatedUpdate:$Y,TourControl:$Y};function yst(e,t,n,i){let o=Dn(t,"name",Re.kml),r=vs(t,"id"),s=new CV(o,r),a=Pi(t,"Playlist",Re.gx);if(a){let c=e._ellipsoid,l=a.childNodes;for(let f=0;f<l.length;f++){let d=l[f];if(d.localName){let p=gst[d.localName];p?p(s,d,c):console.log(`Unknown KML Tour playlist entry type ${d.localName}`)}}}e._kmlTours.push(s)}function $Y(e,t){At(`KML Tour unsupported node ${t.localName}`)}function xst(e,t){let n=Zn(t,"duration",Re.gx);e.addPlaylistEntry(new EV(n))}function bst(e,t,n){let i=Zn(t,"duration",Re.gx),o=Dn(t,"flyToMode",Re.gx),r={kml:{}};a0e(t,r,n),s0e(t,r,n);let s=r.kml.lookAt||r.kml.camera,a=new TV(i,o,s);e.addPlaylistEntry(a)}function s0e(e,t,n){let i=Pi(e,"Camera",Re.kml);if(u(i)){let o=x(Zn(i,"longitude",Re.kml),0),r=x(Zn(i,"latitude",Re.kml),0),s=x(Zn(i,"altitude",Re.kml),0),a=x(Zn(i,"heading",Re.kml),0),c=x(Zn(i,"tilt",Re.kml),0),l=x(Zn(i,"roll",Re.kml),0),f=h.fromDegrees(o,r,s,n),d=Wa.fromDegrees(a,c-90,l);t.kml.camera=new yV(f,d)}}function a0e(e,t,n){let i=Pi(e,"LookAt",Re.kml);if(u(i)){let o=x(Zn(i,"longitude",Re.kml),0),r=x(Zn(i,"latitude",Re.kml),0),s=x(Zn(i,"altitude",Re.kml),0),a=Zn(i,"heading",Re.kml),c=Zn(i,"tilt",Re.kml),l=x(Zn(i,"range",Re.kml),0);c=R.toRadians(x(c,0)),a=R.toRadians(x(a,0));let f=new Yd(a,c-R.PI_OVER_TWO,l),d=h.fromDegrees(o,r,s,n);t.kml.lookAt=new xV(d,f)}}function Cst(e,t,n,i){let o=n.screenOverlayContainer;if(!u(o))return;let r=n.sourceResource,s=n.uriResolver,a=Pi(t,"Icon",Re.kml),c=sX(a,e,r,s,!1);if(!u(c))return;let l=document.createElement("img");e._screenOverlays.push(l),l.src=c.url,l.onload=function(){let f=["position: absolute"],d=Pi(t,"screenXY",Re.kml),p=Pi(t,"overlayXY",Re.kml),g=Pi(t,"size",Re.kml),m,y,b,C,A,T;u(g)&&(m=F0(g,"x"),y=F0(g,"y"),b=vs(g,"xunits"),C=vs(g,"yunits"),u(m)&&m!==-1&&m!==0&&(b==="fraction"?A=`width: ${Math.floor(m*100)}%`:b==="pixels"&&(A=`width: ${m}px`),f.push(A)),u(y)&&y!==-1&&y!==0&&(C==="fraction"?T=`height: ${Math.floor(y*100)}%`:C==="pixels"&&(T=`height: ${y}px`),f.push(T))),l.style=f.join(";");let E=0,v=l.height;u(p)&&(m=F0(p,"x"),y=F0(p,"y"),b=vs(p,"xunits"),C=vs(p,"yunits"),u(m)&&(b==="fraction"?E=m*l.width:(b==="pixels"||b==="insetPixels")&&(E=m)),u(y)&&(C==="fraction"?v=y*l.height:(C==="pixels"||C==="insetPixels")&&(v=y))),u(d)&&(m=F0(d,"x"),y=F0(d,"y"),b=vs(d,"xunits"),C=vs(d,"yunits"),u(m)&&(b==="fraction"?A=`left: calc(${Math.floor(m*100)}% - ${E}px)`:b==="pixels"?A=`left: ${m-E}px`:b==="insetPixels"&&(A=`right: ${m-E}px`),f.push(A)),u(y)&&(C==="fraction"?T=`bottom: calc(${Math.floor(y*100)}% - ${v}px)`:C==="pixels"?T=`bottom: ${y-v}px`:C==="insetPixels"&&(T=`top: ${y-v}px`),f.push(T))),l.style=f.join(";")},o.appendChild(l)}function Ast(e,t,n,i){let r=PV(e,t,n).entity,s,a=!1,c=e._ellipsoid,l=SV(Pi(t,"LatLonQuad",Re.gx),c),f=Zn(t,"drawOrder",Re.kml);if(u(l))s=rX(),s.hierarchy=new Za(l),s.zIndex=f,r.polygon=s,a=!0;else{s=new Nh,s.zIndex=f,r.rectangle=s;let m=Pi(t,"LatLonBox",Re.kml);if(u(m)){let y=Zn(m,"west",Re.kml),b=Zn(m,"south",Re.kml),C=Zn(m,"east",Re.kml),A=Zn(m,"north",Re.kml);u(y)&&(y=R.negativePiToPi(R.toRadians(y))),u(b)&&(b=R.clampToLatitudeRange(R.toRadians(b))),u(C)&&(C=R.negativePiToPi(R.toRadians(C))),u(A)&&(A=R.clampToLatitudeRange(R.toRadians(A))),s.coordinates=new se(y,b,C,A);let T=Zn(m,"rotation",Re.kml);if(u(T)){let E=R.toRadians(T);s.rotation=E,s.stRotation=E}}}let d=Pi(t,"Icon",Re.kml),p=sX(d,e,n.sourceResource,n.uriResolver,!0);if(u(p)){a&&At("kml-gx:LatLonQuad","KML - gx:LatLonQuad Icon does not support texture projection.");let m=Zn(d,"x",Re.gx),y=Zn(d,"y",Re.gx),b=Zn(d,"w",Re.gx),C=Zn(d,"h",Re.gx);(u(m)||u(y)||u(b)||u(C))&&At("kml-groundOverlay-xywh","KML - gx:x, gx:y, gx:w, gx:h aren't supported for GroundOverlays"),s.material=p,s.material.color=cb(t,"color",Re.kml),s.material.transparent=!0}else s.material=cb(t,"color",Re.kml);let g=Dn(t,"altitudeMode",Re.kml);u(g)?g==="absolute"?(s.height=Zn(t,"altitude",Re.kml),s.zIndex=void 0):g!=="clampToGround"&&At("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${g}`):(g=Dn(t,"altitudeMode",Re.gx),g==="relativeToSeaFloor"?(At("kml-altitudeMode-relativeToSeaFloor","KML - altitudeMode relativeToSeaFloor is currently not supported, treating as absolute."),s.height=Zn(t,"altitude",Re.kml),s.zIndex=void 0):g==="clampToSeaFloor"?At("kml-altitudeMode-clampToSeaFloor","KML - altitudeMode clampToSeaFloor is currently not supported, treating as clampToGround."):u(g)&&At("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${g}`))}function c0e(e,t,n,i){e._unsupportedNode.raiseEvent(e,n.parentEntity,t,n.entityCollection,n.styleCollection,n.sourceResource,n.uriResolver),At(`kml-unsupportedFeature-${t.nodeName}`,`KML - Unsupported feature: ${t.nodeName}`)}var B0={INTERVAL:0,EXPIRE:1,STOP:2};function wV(e){if(!u(e)||e.length===0)return"";let t=e[0];return(t==="&"||t==="?")&&(e=e.substring(1)),e}var Tst=new se,xE=new de,QY=new H,Est=new h;function cX(e,t,n,i,o,r){function s(l){return l<-R.PI_OVER_TWO?-R.PI_OVER_TWO:l>R.PI_OVER_TWO?R.PI_OVER_TWO:l}function a(l){return l>R.PI?l-R.TWO_PI:l<-R.PI?l+R.TWO_PI:l}let c=cC(e.queryParameters);if(c=c.replace(/%5B/g,"[").replace(/%5D/g,"]"),u(t)&&t._mode!==ne.MORPHING){let l,f;if(o=x(o,Tst),u(n)&&(QY.x=n.clientWidth*.5,QY.y=n.clientHeight*.5,l=t.pickEllipsoid(QY,r,Est)),u(l)?f=r.cartesianToCartographic(l,xE):(f=se.center(o,xE),l=r.cartographicToCartesian(f)),u(i)&&!R.equalsEpsilon(i,1,R.EPSILON9)){let C=o.width*i*.5,A=o.height*i*.5;o=new se(a(f.longitude-C),s(f.latitude-A),a(f.longitude+C),s(f.latitude+A))}c=c.replace("[bboxWest]",R.toDegrees(o.west).toString()),c=c.replace("[bboxSouth]",R.toDegrees(o.south).toString()),c=c.replace("[bboxEast]",R.toDegrees(o.east).toString()),c=c.replace("[bboxNorth]",R.toDegrees(o.north).toString());let d=R.toDegrees(f.longitude).toString(),p=R.toDegrees(f.latitude).toString();c=c.replace("[lookatLon]",d),c=c.replace("[lookatLat]",p),c=c.replace("[lookatTilt]",R.toDegrees(t.pitch).toString()),c=c.replace("[lookatHeading]",R.toDegrees(t.heading).toString()),c=c.replace("[lookatRange]",h.distance(t.positionWC,l)),c=c.replace("[lookatTerrainLon]",d),c=c.replace("[lookatTerrainLat]",p),c=c.replace("[lookatTerrainAlt]",f.height.toString()),r.cartesianToCartographic(t.positionWC,xE),c=c.replace("[cameraLon]",R.toDegrees(xE.longitude).toString()),c=c.replace("[cameraLat]",R.toDegrees(xE.latitude).toString()),c=c.replace("[cameraAlt]",R.toDegrees(xE.height).toString());let g=t.frustum,m=g.aspectRatio,y="",b="";if(u(m)){let C=R.toDegrees(g.fov);m>1?(y=C,b=C/m):(b=C,y=C*m)}c=c.replace("[horizFov]",y.toString()),c=c.replace("[vertFov]",b.toString())}else c=c.replace("[bboxWest]","-180"),c=c.replace("[bboxSouth]","-90"),c=c.replace("[bboxEast]","180"),c=c.replace("[bboxNorth]","90"),c=c.replace("[lookatLon]",""),c=c.replace("[lookatLat]",""),c=c.replace("[lookatRange]",""),c=c.replace("[lookatTilt]",""),c=c.replace("[lookatHeading]",""),c=c.replace("[lookatTerrainLon]",""),c=c.replace("[lookatTerrainLat]",""),c=c.replace("[lookatTerrainAlt]",""),c=c.replace("[cameraLon]",""),c=c.replace("[cameraLat]",""),c=c.replace("[cameraAlt]",""),c=c.replace("[horizFov]",""),c=c.replace("[vertFov]","");u(n)?(c=c.replace("[horizPixels]",n.clientWidth),c=c.replace("[vertPixels]",n.clientHeight)):(c=c.replace("[horizPixels]",""),c=c.replace("[vertPixels]","")),c=c.replace("[terrainEnabled]","1"),c=c.replace("[clientVersion]","1"),c=c.replace("[kmlVersion]","2.2"),c=c.replace("[clientName]","Cesium"),c=c.replace("[language]","English"),e.setQueryParameters(Xu(c))}function Sst(e,t,n,i){let r=PV(e,t,n).entity,s=n.sourceResource,a=n.uriResolver,c=Pi(t,"Link",Re.kml);if(u(c)||(c=Pi(t,"Url",Re.kml)),u(c)){let l=Dn(c,"href",Re.kml),f,d;if(u(l)){let p=l;if(l=oX(l,s,n.uriResolver),/^data:/.test(l.getUrlComponent()))/\.kmz/i.test(s.getUrlComponent())||(p=s.getDerivedResource({url:p}));else{if(p=l.clone(),f=Dn(c,"viewRefreshMode",Re.kml),f==="onRegion"){At("kml-refrehMode-onRegion","KML - Unsupported viewRefreshMode: onRegion");return}d=x(Dn(c,"viewBoundScale",Re.kml),1);let b=f==="onStop"?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"",C=x(Dn(c,"viewFormat",Re.kml),b),A=Dn(c,"httpQuery",Re.kml);u(C)&&l.setQueryParameters(Xu(wV(C))),u(A)&&l.setQueryParameters(Xu(wV(A)));let T=e._ellipsoid;cX(l,e.camera,e.canvas,d,e._lastCameraView.bbox,T)}let g={sourceUri:p,uriResolver:a,context:r.id,screenOverlayContainer:n.screenOverlayContainer},m=new la,y=lX(e,m,l,g).then(function(b){let C=e._entityCollection,A=m.values;C.suspendEvents();for(let v=0;v<A.length;v++){let D=A[v];u(D.parent)||(D.parent=r,uX(D)),C.add(D)}C.resumeEvents();let T=Dn(c,"refreshMode",Re.kml),E=x(Zn(c,"refreshInterval",Re.kml),0);if(T==="onInterval"&&E>0||T==="onExpire"||f==="onStop"){let v=Pi(b,"NetworkLinkControl",Re.kml),D=u(v),O=$.now(),P={id:Hn(),href:l,cookie:{},lastUpdated:O,updating:!1,entity:r,viewBoundScale:d,needsUpdate:!1,cameraUpdateTime:O},M=0;if(D&&(P.cookie=Xu(x(Dn(v,"cookie",Re.kml),"")),M=x(Zn(v,"minRefreshPeriod",Re.kml),0)),T==="onInterval")D&&(E=Math.max(M,E)),P.refreshMode=B0.INTERVAL,P.time=E;else if(T==="onExpire"){let L;if(D&&(L=Dn(v,"expires",Re.kml)),u(L))try{let _=$.fromIso8601(L),S=$.secondsDifference(_,O);S>0&&S<M&&$.addSeconds(O,M,_),P.refreshMode=B0.EXPIRE,P.time=_}catch{At("kml-refreshMode-onInterval-onExpire","KML - NetworkLinkControl expires is not a valid date")}else At("kml-refreshMode-onExpire","KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element")}else u(e.camera)?(P.refreshMode=B0.STOP,P.time=x(Zn(c,"viewRefreshTime",Re.kml),0)):At("kml-refrehMode-onStop-noCamera","A NetworkLink with viewRefreshMode=onStop requires the `camera` property to be defined.");u(P.refreshMode)&&e._networkLinks.set(P.id,P)}}).catch(function(b){At(`An error occured during loading ${l.url}`),e._error.raiseEvent(e,b)});i.addPromise(y)}}}function vst(e,t,n,i){let o=iX[t.localName];return u(o)?o(e,t,n,i):c0e(e,t,n,i)}function tX(e,t,n,i,o,r,s){t.removeAll();let a=n.documentElement,c=a.localName==="Document"?a:Pi(a,"Document",Re.kml),l=Dn(c,"name",Re.kml);u(l)||(l=o0(i.getUrlComponent())),u(e._name)||(e._name=l);let f=new wu._DeferredLoading(e),d=new la(e);return Promise.all(t0e(e,n,d,i,!1,o)).then(function(){let p=n.documentElement;if(p.localName==="kml"){let m=p.childNodes;for(let y=0;y<m.length;y++){let b=m[y];if(u(iX[b.localName])){p=b;break}}}let g={parentEntity:void 0,entityCollection:t,styleCollection:d,sourceResource:i,uriResolver:o,context:s,screenOverlayContainer:r};return t.suspendEvents(),vst(e,p,g,f),t.resumeEvents(),f.wait().then(function(){return n.documentElement})})}function wst(e,t,n,i,o){let r=on("ThirdParty/Workers/z-worker-pako.js");lE({workerScripts:{deflate:[r,"./pako_deflate.min.js"],inflate:[r,"./pako_inflate.min.js"]}});let s=new Z4(new c_(n));return Promise.resolve(s.getEntries()).then(function(a){let c=[],l={},f;for(let d=0;d<a.length;d++){let p=a[d];p.directory||(/\.kml$/i.test(p.filename)&&(!u(f)||!/\//i.test(p.filename))?(u(f)&&c.push(ZY(f,l)),f=p):c.push(ZY(p,l)))}return u(f)&&c.push(Jrt(f,l)),Promise.all(c).then(function(){if(s.close(),!u(l.kml))throw new ce("KMZ file does not contain a KML document.");return l.keys=Object.keys(l),tX(e,t,l.kml,i,l,o)})})}function lX(e,t,n,i){i=x(i,x.EMPTY_OBJECT);let o=i.sourceUri,r=i.uriResolver,s=i.context,a=i.screenOverlayContainer,c=n;if(typeof n=="string"||n instanceof De){n=De.createIfNeeded(n),c=n.fetchBlob(),o=x(o,n.clone());let l=e._resourceCredits,f=n.credits;if(u(f)){let d=f.length;for(let p=0;p<d;p++)l.push(f[p])}}else o=x(o,De.DEFAULT.clone());return o=De.createIfNeeded(o),u(a)&&(a=Rn(a)),Promise.resolve(c).then(function(l){return l instanceof Blob?$rt(l).then(function(f){return f?wst(e,t,l,o,a):Qrt(l).then(function(d){d=Zge(d),d=$ge(d);let p,g;try{p=nX.parseFromString(d,"application/xml")}catch(m){g=m.toString()}if(u(g)||p.body||p.documentElement.tagName==="parsererror"){let m=u(g)?g:p.documentElement.firstChild.nodeValue;throw m||(m=p.body.innerText),new ce(m)}return tX(e,t,p,o,r,a,s)})}):tX(e,t,l,o,r,a,s)}).catch(function(l){return e._error.raiseEvent(e,l),console.log(l),Promise.reject(l)})}function wu(e){e=x(e,x.EMPTY_OBJECT);let t=e.camera,n=e.canvas;this._changed=new me,this._error=new me,this._loading=new me,this._refresh=new me,this._unsupportedNode=new me,this._clock=void 0,this._entityCollection=new la(this),this._name=void 0,this._isLoading=!1,this._pinBuilder=new I0,this._networkLinks=new St,this._entityCluster=new Mf,this.canvas=n,this.camera=t,this._lastCameraView={position:u(t)?h.clone(t.positionWC):void 0,direction:u(t)?h.clone(t.directionWC):void 0,up:u(t)?h.clone(t.upWC):void 0,bbox:u(t)?t.computeViewRectangle():se.clone(se.MAX_VALUE)},this._ellipsoid=x(e.ellipsoid,ee.default);let i=e.credit;typeof i=="string"&&(i=new wt(i)),this._credit=i,this._resourceCredits=[],this._kmlTours=[],this._screenOverlays=[]}wu.load=function(e,t){return t=x(t,x.EMPTY_OBJECT),new wu(t).load(e,t)};Object.defineProperties(wu.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},refreshEvent:{get:function(){return this._refresh}},unsupportedNodeEvent:{get:function(){return this._unsupportedNode}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}},credit:{get:function(){return this._credit}},kmlTours:{get:function(){return this._kmlTours}}});wu.prototype.load=function(e,t){t=x(t,x.EMPTY_OBJECT),Kr.setLoading(this,!0);let n=this._name;this._name=void 0,this._clampToGround=x(t.clampToGround,!1);let i=this;return lX(this,this._entityCollection,e,t).then(function(){let o,r=i._entityCollection.computeAvailability(),s=r.start,a=r.stop,c=$.equals(s,He.MINIMUM_VALUE),l=$.equals(a,He.MAXIMUM_VALUE);if(!c||!l){let d;c&&(d=new Date,d.setHours(0,0,0,0),s=$.fromDate(d)),l&&(d=new Date,d.setHours(24,0,0,0),a=$.fromDate(d)),o=new lm,o.startTime=s,o.stopTime=a,o.currentTime=$.clone(s),o.clockRange=Zr.LOOP_STOP,o.clockStep=Ao.SYSTEM_CLOCK_MULTIPLIER,o.multiplier=Math.round(Math.min(Math.max($.secondsDifference(a,s)/60,1),31556900))}let f=!1;return o!==i._clock&&(i._clock=o,f=!0),n!==i._name&&(f=!0),f&&i._changed.raiseEvent(i),Kr.setLoading(i,!1),i}).catch(function(o){return Kr.setLoading(i,!1),i._error.raiseEvent(i,o),console.log(o),Promise.reject(o)})};wu.prototype.destroy=function(){for(;this._screenOverlays.length>0;)this._screenOverlays.pop().remove()};function uX(e){let t=e.parent;if(u(t)){let n=t.availability;if(u(n)){let i=e.availability;u(i)?i.intersect(n):e.availability=n}}}function Dst(e,t,n,i,o){return function(r){if(!i.contains(t.id))return;let s=!1,a=Pi(r,"NetworkLinkControl",Re.kml),c=u(a),l=0;if(c){if(u(Pi(a,"Update",Re.kml))){At("kml-networkLinkControl-update","KML - NetworkLinkControl updates aren't supported."),t.updating=!1,i.remove(t.id);return}t.cookie=Xu(x(Dn(a,"cookie",Re.kml),"")),l=x(Zn(a,"minRefreshPeriod",Re.kml),0)}let f=$.now(),d=t.refreshMode;if(d===B0.INTERVAL)u(a)&&(t.time=Math.max(l,t.time));else if(d===B0.EXPIRE){let O;if(u(a)&&(O=Dn(a,"expires",Re.kml)),u(O))try{let P=$.fromIso8601(O),M=$.secondsDifference(P,f);M>0&&M<l&&$.addSeconds(f,l,P),t.time=P}catch{At("kml-networkLinkControl-expires","KML - NetworkLinkControl expires is not a valid date"),s=!0}else At("kml-refreshMode-onExpire","KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element"),s=!0}let p=t.entity,g=e._entityCollection,m=n.values;function y(O){g.remove(O);let P=O._children,M=P.length;for(let L=0;L<M;++L)y(P[L])}g.suspendEvents();let b=g.values.slice(),C;for(C=0;C<b.length;++C){let O=b[C];O.parent===p&&(O.parent=void 0,y(O))}for(g.resumeEvents(),g.suspendEvents(),C=0;C<m.length;C++){let O=m[C];u(O.parent)||(O.parent=p,uX(O)),g.add(O)}g.resumeEvents(),s?i.remove(t.id):t.lastUpdated=f;let A=g.computeAvailability(),T=A.start,E=A.stop,v=$.equals(T,He.MINIMUM_VALUE),D=$.equals(E,He.MAXIMUM_VALUE);if(!v||!D){let O=e._clock;(O.startTime!==T||O.stopTime!==E)&&(O.startTime=T,O.stopTime=E,e._changed.raiseEvent(e))}t.updating=!1,t.needsUpdate=!1,e._refresh.raiseEvent(e,o.getUrlComponent(!0))}}var JY=new St;wu.prototype.update=function(e){let t=this._networkLinks;if(t.length===0)return!0;let n=$.now(),i=this;JY.removeAll();function o(f){let d=f._children,p=d.length;for(let g=0;g<p;++g){let m=d[g];JY.set(m.id,m),o(m)}}let r=!1,s=this._lastCameraView,a=this.camera;u(a)&&!(a.positionWC.equalsEpsilon(s.position,R.EPSILON7)&&a.directionWC.equalsEpsilon(s.direction,R.EPSILON7)&&a.upWC.equalsEpsilon(s.up,R.EPSILON7))&&(s.position=h.clone(a.positionWC),s.direction=h.clone(a.directionWC),s.up=h.clone(a.upWC),s.bbox=a.computeViewRectangle(),r=!0);let c=new St,l=!1;return t.values.forEach(function(f){let d=f.entity;if(!JY.contains(d.id)){if(!f.updating){let p=!1;if(f.refreshMode===B0.INTERVAL?$.secondsDifference(n,f.lastUpdated)>f.time&&(p=!0):f.refreshMode===B0.EXPIRE?$.greaterThan(n,f.time)&&(p=!0):f.refreshMode===B0.STOP&&(r&&(f.needsUpdate=!0,f.cameraUpdateTime=n),f.needsUpdate&&$.secondsDifference(n,f.cameraUpdateTime)>=f.time&&(p=!0)),p){o(d),f.updating=!0;let g=new la,m=f.href.clone();m.setQueryParameters(f.cookie);let y=x(i._ellipsoid,ee.default);cX(m,i.camera,i.canvas,f.viewBoundScale,s.bbox,y),lX(i,g,m,{context:d.id}).then(Dst(i,f,g,c,m)).catch(function(b){let C=`NetworkLink ${f.href} refresh failed: ${b}`;console.log(C),i._error.raiseEvent(i,C)}),l=!0}}c.set(f.id,f)}}),l&&(this._networkLinks=c,this._changed.raiseEvent(this)),!0};function Ist(){this.author={name:void 0,uri:void 0,email:void 0},this.link={href:void 0,hreflang:void 0,rel:void 0,type:void 0,title:void 0,length:void 0},this.address=void 0,this.phoneNumber=void 0,this.snippet=void 0,this.extendedData=void 0}wu._DeferredLoading=wm;wu._getTimestamp=Ei;var RV=wu;function gD(){he.throwInstantiationError()}gD.prototype.update=he.throwInstantiationError;gD.prototype.getBoundingSphere=he.throwInstantiationError;gD.prototype.isDestroyed=he.throwInstantiationError;gD.prototype.destroy=he.throwInstantiationError;var l0e=gD;var Pst={NONE:0,LERC:1},eh=Object.freeze(Pst);var Rst={NONE:0,BITS12:1},pa=Object.freeze(Rst);var lb=new h,Ost=new h,Hf=new H,OV=new F,Mst=new F,Lst=Math.pow(2,12);function cc(e,t,n,i,o,r,s,a,c,l){let f=pa.NONE,d,p;if(u(t)&&u(n)&&u(i)&&u(o)){let g=t.minimum,m=t.maximum,y=h.subtract(m,g,Ost),b=i-n;Math.max(h.maximumComponent(y),b)<Lst-1?f=pa.BITS12:f=pa.NONE,d=F.inverseTransformation(o,new F);let A=h.negate(g,lb);F.multiply(F.fromTranslation(A,OV),d,d);let T=lb;T.x=1/y.x,T.y=1/y.y,T.z=1/y.z,F.multiply(F.fromScale(T,OV),d,d),p=F.clone(o),F.setTranslation(p,h.ZERO,p),o=F.clone(o,new F);let E=F.fromTranslation(g,OV),v=F.fromScale(y,Mst),D=F.multiply(E,v,OV);F.multiply(o,D,o),F.multiply(p,D,p)}this.quantization=f,this.minimumHeight=n,this.maximumHeight=i,this.center=h.clone(e),this.toScaledENU=d,this.fromScaledENU=o,this.matrix=p,this.hasVertexNormals=r,this.hasWebMercatorT=x(s,!1),this.hasGeodeticSurfaceNormals=x(a,!1),this.exaggeration=x(c,1),this.exaggerationRelativeHeight=x(l,0),this.stride=0,this._offsetGeodeticSurfaceNormal=0,this._offsetVertexNormal=0,this._calculateStrideAndOffsets()}cc.prototype.encode=function(e,t,n,i,o,r,s,a){let c=i.x,l=i.y;if(this.quantization===pa.BITS12){n=F.multiplyByPoint(this.toScaledENU,n,lb),n.x=R.clamp(n.x,0,1),n.y=R.clamp(n.y,0,1),n.z=R.clamp(n.z,0,1);let f=this.maximumHeight-this.minimumHeight,d=R.clamp((o-this.minimumHeight)/f,0,1);H.fromElements(n.x,n.y,Hf);let p=Ln.compressTextureCoordinates(Hf);H.fromElements(n.z,d,Hf);let g=Ln.compressTextureCoordinates(Hf);H.fromElements(c,l,Hf);let m=Ln.compressTextureCoordinates(Hf);if(e[t++]=p,e[t++]=g,e[t++]=m,this.hasWebMercatorT){H.fromElements(s,0,Hf);let y=Ln.compressTextureCoordinates(Hf);e[t++]=y}}else h.subtract(n,this.center,lb),e[t++]=lb.x,e[t++]=lb.y,e[t++]=lb.z,e[t++]=o,e[t++]=c,e[t++]=l,this.hasWebMercatorT&&(e[t++]=s);return this.hasVertexNormals&&(e[t++]=Ln.octPackFloat(r)),this.hasGeodeticSurfaceNormals&&(e[t++]=a.x,e[t++]=a.y,e[t++]=a.z),t};var Nst=new h,u0e=new h;cc.prototype.addGeodeticSurfaceNormals=function(e,t,n){if(this.hasGeodeticSurfaceNormals)return;let i=this.stride,o=e.length/i;this.hasGeodeticSurfaceNormals=!0,this._calculateStrideAndOffsets();let r=this.stride;for(let s=0;s<o;s++){for(let f=0;f<i;f++){let d=s*i+f,p=s*r+f;t[p]=e[d]}let a=this.decodePosition(t,s,Nst),c=n.geodeticSurfaceNormal(a,u0e),l=s*r+this._offsetGeodeticSurfaceNormal;t[l]=c.x,t[l+1]=c.y,t[l+2]=c.z}};cc.prototype.removeGeodeticSurfaceNormals=function(e,t){if(!this.hasGeodeticSurfaceNormals)return;let n=this.stride,i=e.length/n;this.hasGeodeticSurfaceNormals=!1,this._calculateStrideAndOffsets();let o=this.stride;for(let r=0;r<i;r++)for(let s=0;s<o;s++){let a=r*n+s,c=r*o+s;t[c]=e[a]}};cc.prototype.decodePosition=function(e,t,n){if(u(n)||(n=new h),t*=this.stride,this.quantization===pa.BITS12){let i=Ln.decompressTextureCoordinates(e[t],Hf);n.x=i.x,n.y=i.y;let o=Ln.decompressTextureCoordinates(e[t+1],Hf);return n.z=o.x,F.multiplyByPoint(this.fromScaledENU,n,n)}return n.x=e[t],n.y=e[t+1],n.z=e[t+2],h.add(n,this.center,n)};cc.prototype.getExaggeratedPosition=function(e,t,n){n=this.decodePosition(e,t,n);let i=this.exaggeration,o=this.exaggerationRelativeHeight;if(i!==1&&this.hasGeodeticSurfaceNormals){let s=this.decodeGeodeticSurfaceNormal(e,t,u0e),a=this.decodeHeight(e,t),c=Mr.getHeight(a,i,o)-a;n.x+=s.x*c,n.y+=s.y*c,n.z+=s.z*c}return n};cc.prototype.decodeTextureCoordinates=function(e,t,n){return u(n)||(n=new H),t*=this.stride,this.quantization===pa.BITS12?Ln.decompressTextureCoordinates(e[t+2],n):H.fromElements(e[t+4],e[t+5],n)};cc.prototype.decodeHeight=function(e,t){return t*=this.stride,this.quantization===pa.BITS12?Ln.decompressTextureCoordinates(e[t+1],Hf).y*(this.maximumHeight-this.minimumHeight)+this.minimumHeight:e[t+3]};cc.prototype.decodeWebMercatorT=function(e,t){return t*=this.stride,this.quantization===pa.BITS12?Ln.decompressTextureCoordinates(e[t+3],Hf).x:e[t+6]};cc.prototype.getOctEncodedNormal=function(e,t,n){t=t*this.stride+this._offsetVertexNormal;let i=e[t]/256,o=Math.floor(i),r=(i-o)*256;return H.fromElements(o,r,n)};cc.prototype.decodeGeodeticSurfaceNormal=function(e,t,n){return t=t*this.stride+this._offsetGeodeticSurfaceNormal,n.x=e[t],n.y=e[t+1],n.z=e[t+2],n};cc.prototype._calculateStrideAndOffsets=function(){let e=0;switch(this.quantization){case pa.BITS12:e+=3;break;default:e+=6}this.hasWebMercatorT&&(e+=1),this.hasVertexNormals&&(this._offsetVertexNormal=e,e+=1),this.hasGeodeticSurfaceNormals&&(this._offsetGeodeticSurfaceNormal=e,e+=3),this.stride=e};var MV={position3DAndHeight:0,textureCoordAndEncodedNormals:1,geodeticSurfaceNormal:2},LV={compressed0:0,compressed1:1,geodeticSurfaceNormal:2};cc.prototype.getAttributes=function(e){let t=K.FLOAT,n=K.getSizeInBytes(t),i=this.stride*n,o=0,r=[];function s(a,c){r.push({index:a,vertexBuffer:e,componentDatatype:t,componentsPerAttribute:c,offsetInBytes:o,strideInBytes:i}),o+=c*n}if(this.quantization===pa.NONE){s(MV.position3DAndHeight,4);let a=2;a+=this.hasWebMercatorT?1:0,a+=this.hasVertexNormals?1:0,s(MV.textureCoordAndEncodedNormals,a),this.hasGeodeticSurfaceNormals&&s(MV.geodeticSurfaceNormal,3)}else{let a=this.hasWebMercatorT||this.hasVertexNormals,c=this.hasWebMercatorT&&this.hasVertexNormals;s(LV.compressed0,a?4:3),c&&s(LV.compressed1,1),this.hasGeodeticSurfaceNormals&&s(LV.geodeticSurfaceNormal,3)}return r};cc.prototype.getAttributeLocations=function(){return this.quantization===pa.NONE?MV:LV};cc.clone=function(e,t){if(u(e))return u(t)||(t=new cc),t.quantization=e.quantization,t.minimumHeight=e.minimumHeight,t.maximumHeight=e.maximumHeight,t.center=h.clone(e.center),t.toScaledENU=F.clone(e.toScaledENU),t.fromScaledENU=F.clone(e.fromScaledENU),t.matrix=F.clone(e.matrix),t.hasVertexNormals=e.hasVertexNormals,t.hasWebMercatorT=e.hasWebMercatorT,t.hasGeodeticSurfaceNormals=e.hasGeodeticSurfaceNormals,t.exaggeration=e.exaggeration,t.exaggerationRelativeHeight=e.exaggerationRelativeHeight,t._calculateStrideAndOffsets(),t};var Zc=cc;var Dm={};Dm.DEFAULT_STRUCTURE=Object.freeze({heightScale:1,heightOffset:0,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1});var fX=new h,Fst=new F,Bst=new h,kst=new h;Dm.computeVertices=function(e){let t=Math.cos,n=Math.sin,i=Math.sqrt,o=Math.atan,r=Math.exp,s=R.PI_OVER_TWO,a=R.toRadians,c=e.heightmap,l=e.width,f=e.height,d=e.skirtHeight,p=d>0,g=x(e.isGeographic,!0),m=x(e.ellipsoid,ee.default),y=1/m.maximumRadius,b=se.clone(e.nativeRectangle),C=se.clone(e.rectangle),A,T,E,v;u(C)?(A=C.west,T=C.south,E=C.east,v=C.north):g?(A=a(b.west),T=a(b.south),E=a(b.east),v=a(b.north)):(A=b.west*y,T=s-2*o(r(-b.south*y)),E=b.east*y,v=s-2*o(r(-b.north*y)));let D=e.relativeToCenter,O=u(D);D=O?D:h.ZERO;let P=x(e.includeWebMercatorT,!1),M=x(e.exaggeration,1),L=x(e.exaggerationRelativeHeight,0),S=M!==1,w=x(e.structure,Dm.DEFAULT_STRUCTURE),I=x(w.heightScale,Dm.DEFAULT_STRUCTURE.heightScale),N=x(w.heightOffset,Dm.DEFAULT_STRUCTURE.heightOffset),k=x(w.elementsPerHeight,Dm.DEFAULT_STRUCTURE.elementsPerHeight),z=x(w.stride,Dm.DEFAULT_STRUCTURE.stride),V=x(w.elementMultiplier,Dm.DEFAULT_STRUCTURE.elementMultiplier),U=x(w.isBigEndian,Dm.DEFAULT_STRUCTURE.isBigEndian),B=se.computeWidth(b),W=se.computeHeight(b),j=B/(l-1),Q=W/(f-1);g||(B*=y,W*=y);let q=m.radiiSquared,X=q.x,Z=q.y,fe=q.z,xe=65536,re=-65536,pe=Lt.eastNorthUpToFixedFrame(D,m),ye=F.inverseTransformation(pe,Fst),Se,Te;P&&(Se=Li.geodeticLatitudeToMercatorAngle(T),Te=1/(Li.geodeticLatitudeToMercatorAngle(v)-Se));let Fe=Bst;Fe.x=Number.POSITIVE_INFINITY,Fe.y=Number.POSITIVE_INFINITY,Fe.z=Number.POSITIVE_INFINITY;let Ve=kst;Ve.x=Number.NEGATIVE_INFINITY,Ve.y=Number.NEGATIVE_INFINITY,Ve.z=Number.NEGATIVE_INFINITY;let Ze=Number.POSITIVE_INFINITY,gt=l*f,lt=d>0?l*2+f*2:0,Oe=gt+lt,Mt=new Array(Oe),ut=new Array(Oe),at=new Array(Oe),Kt=P?new Array(Oe):[],Ce=S?new Array(Oe):[],Ae=0,nt=f,yi=0,ct=l;p&&(--Ae,++nt,--yi,++ct);let Si=1e-5;for(let Ye=Ae;Ye<nt;++Ye){let ht=Ye;ht<0&&(ht=0),ht>=f&&(ht=f-1);let zt=b.north-Q*ht;g?zt=a(zt):zt=s-2*o(r(-zt*y));let mn=(zt-T)/(v-T);mn=R.clamp(mn,0,1);let bo=Ye===Ae,fo=Ye===nt-1;d>0&&(bo?zt+=Si*W:fo&&(zt-=Si*W));let $s=t(zt),Rs=n(zt),li=fe*Rs,ti;P&&(ti=(Li.geodeticLatitudeToMercatorAngle(zt)-Se)*Te);for(let ts=yi;ts<ct;++ts){let dr=ts;dr<0&&(dr=0),dr>=l&&(dr=l-1);let ba=ht*(l*z)+dr*z,qn;if(k===1)qn=c[ba];else{qn=0;let Mo;if(U)for(Mo=0;Mo<k;++Mo)qn=qn*V+c[ba+Mo];else for(Mo=k-1;Mo>=0;--Mo)qn=qn*V+c[ba+Mo]}qn=qn*I+N,re=Math.max(re,qn),xe=Math.min(xe,qn);let ro=b.west+j*dr;g?ro=a(ro):ro=ro*y;let Uu=(ro-A)/(E-A);Uu=R.clamp(Uu,0,1);let hr=ht*l+dr;if(d>0){let Mo=ts===yi,en=ts===ct-1,Ee=bo||fo||Mo||en;if((bo||fo)&&(Mo||en))continue;Ee&&(qn-=d,Mo?(hr=gt+(f-ht-1),ro-=Si*B):fo?hr=gt+f+(l-dr-1):en?(hr=gt+f+l+ht,ro+=Si*B):bo&&(hr=gt+f+l+f+dr))}let zu=$s*t(ro),ka=$s*n(ro),yy=X*zu,Ca=Z*ka,yc=1/i(yy*zu+Ca*ka+li*Rs),ns=yy*yc,Hu=Ca*yc,Gu=li*yc,Wu=new h;Wu.x=ns+zu*qn,Wu.y=Hu+ka*qn,Wu.z=Gu+Rs*qn,F.multiplyByPoint(ye,Wu,fX),h.minimumByComponent(fX,Fe,Fe),h.maximumByComponent(fX,Ve,Ve),Ze=Math.min(Ze,qn),Mt[hr]=Wu,at[hr]=new H(Uu,mn),ut[hr]=qn,P&&(Kt[hr]=ti),S&&(Ce[hr]=m.geodeticSurfaceNormal(Wu))}}let oo=ae.fromPoints(Mt),Zs;u(C)&&(Zs=wn.fromRectangle(C,xe,re,m));let jo;O&&(jo=new i0(m).computeHorizonCullingPointPossiblyUnderEllipsoid(D,Mt,xe));let wr=new Vy(Fe,Ve,D),Me=new Zc(D,wr,Ze,re,pe,!1,P,S,M,L),ot=new Float32Array(Oe*Me.stride),We=0;for(let Ye=0;Ye<Oe;++Ye)We=Me.encode(ot,We,Mt[Ye],at[Ye],ut[Ye],void 0,Kt[Ye],Ce[Ye]);return{vertices:ot,maximumHeight:re,minimumHeight:xe,encoding:Me,boundingSphere3D:oo,orientedBoundingBox:Zs,occludeePointInScaledSpace:jo}};var yD=Dm;function k0(){he.throwInstantiationError()}Object.defineProperties(k0.prototype,{credits:{get:he.throwInstantiationError},waterMask:{get:he.throwInstantiationError}});k0.prototype.interpolateHeight=he.throwInstantiationError;k0.prototype.isChildAvailable=he.throwInstantiationError;k0.prototype.createMesh=he.throwInstantiationError;k0.prototype.upsample=he.throwInstantiationError;k0.prototype.wasCreatedByUpsampling=he.throwInstantiationError;k0.maximumAsynchronousTasks=5;var Im=k0;function Vst(e,t,n,i,o,r,s,a,c,l,f,d,p,g,m,y){this.center=e,this.vertices=t,this.stride=x(l,6),this.indices=n,this.indexCountWithoutSkirts=i,this.vertexCountWithoutSkirts=o,this.minimumHeight=r,this.maximumHeight=s,this.boundingSphere3D=a,this.occludeePointInScaledSpace=c,this.orientedBoundingBox=f,this.encoding=d,this.westIndicesSouthToNorth=p,this.southIndicesEastToWest=g,this.eastIndicesNorthToSouth=m,this.northIndicesWestToEast=y}var th=Vst;function $c(){he.throwInstantiationError()}Object.defineProperties($c.prototype,{errorEvent:{get:he.throwInstantiationError},credit:{get:he.throwInstantiationError},tilingScheme:{get:he.throwInstantiationError},hasWaterMask:{get:he.throwInstantiationError},hasVertexNormals:{get:he.throwInstantiationError},availability:{get:he.throwInstantiationError}});var f0e=[];$c.getRegularGridIndices=function(e,t){let n=f0e[e];u(n)||(f0e[e]=n=[]);let i=n[t];return u(i)||(e*t<R.SIXTY_FOUR_KILOBYTES?i=n[t]=new Uint16Array((e-1)*(t-1)*6):i=n[t]=new Uint32Array((e-1)*(t-1)*6),p0e(e,t,i,0)),i};var d0e=[];$c.getRegularGridIndicesAndEdgeIndices=function(e,t){let n=d0e[e];u(n)||(d0e[e]=n=[]);let i=n[t];if(!u(i)){let o=$c.getRegularGridIndices(e,t),r=m0e(e,t),s=r.westIndicesSouthToNorth,a=r.southIndicesEastToWest,c=r.eastIndicesNorthToSouth,l=r.northIndicesWestToEast;i=n[t]={indices:o,westIndicesSouthToNorth:s,southIndicesEastToWest:a,eastIndicesNorthToSouth:c,northIndicesWestToEast:l}}return i};var h0e=[];$c.getRegularGridAndSkirtIndicesAndEdgeIndices=function(e,t){let n=h0e[e];u(n)||(h0e[e]=n=[]);let i=n[t];if(!u(i)){let o=e*t,r=(e-1)*(t-1)*6,s=e*2+t*2,a=Math.max(0,s-4)*6,c=o+s,l=r+a,f=m0e(e,t),d=f.westIndicesSouthToNorth,p=f.southIndicesEastToWest,g=f.eastIndicesNorthToSouth,m=f.northIndicesWestToEast,y=Be.createTypedArray(c,l);p0e(e,t,y,0),$c.addSkirtIndices(d,p,g,m,o,y,r),i=n[t]={indices:y,westIndicesSouthToNorth:d,southIndicesEastToWest:p,eastIndicesNorthToSouth:g,northIndicesWestToEast:m,indexCountWithoutSkirts:r}}return i};$c.addSkirtIndices=function(e,t,n,i,o,r,s){let a=o;s=NV(e,a,r,s),a+=e.length,s=NV(t,a,r,s),a+=t.length,s=NV(n,a,r,s),a+=n.length,NV(i,a,r,s)};function m0e(e,t){let n=new Array(t),i=new Array(e),o=new Array(t),r=new Array(e),s;for(s=0;s<e;++s)r[s]=s,i[s]=e*t-1-s;for(s=0;s<t;++s)o[s]=(s+1)*e-1,n[s]=(t-s-1)*e;return{westIndicesSouthToNorth:n,southIndicesEastToWest:i,eastIndicesNorthToSouth:o,northIndicesWestToEast:r}}function p0e(e,t,n,i){let o=0;for(let r=0;r<t-1;++r){for(let s=0;s<e-1;++s){let a=o,c=a+e,l=c+1,f=a+1;n[i++]=a,n[i++]=c,n[i++]=f,n[i++]=f,n[i++]=c,n[i++]=l,++o}++o}}function NV(e,t,n,i){let o=e[0],r=e.length;for(let s=1;s<r;++s){let a=e[s];n[i++]=o,n[i++]=a,n[i++]=t,n[i++]=t,n[i++]=a,n[i++]=t+1,o=a,++t}return i}$c.heightmapTerrainQuality=.25;$c.getEstimatedLevelZeroGeometricErrorForAHeightmap=function(e,t,n){return e.maximumRadius*2*Math.PI*$c.heightmapTerrainQuality/(t*n)};$c.prototype.requestTileGeometry=he.throwInstantiationError;$c.prototype.getLevelMaximumGeometricError=he.throwInstantiationError;$c.prototype.getTileDataAvailable=he.throwInstantiationError;$c.prototype.loadTileDataAvailability=he.throwInstantiationError;var ds=$c;function u_(e){this._buffer=e.buffer,this._width=e.width,this._height=e.height,this._childTileMask=x(e.childTileMask,15),this._encoding=x(e.encoding,eh.NONE);let t=yD.DEFAULT_STRUCTURE,n=e.structure;u(n)?n!==t&&(n.heightScale=x(n.heightScale,t.heightScale),n.heightOffset=x(n.heightOffset,t.heightOffset),n.elementsPerHeight=x(n.elementsPerHeight,t.elementsPerHeight),n.stride=x(n.stride,t.stride),n.elementMultiplier=x(n.elementMultiplier,t.elementMultiplier),n.isBigEndian=x(n.isBigEndian,t.isBigEndian)):n=t,this._structure=n,this._createdByUpsampling=x(e.createdByUpsampling,!1),this._waterMask=e.waterMask,this._skirtHeight=void 0,this._bufferType=this._encoding===eh.LERC?Float32Array:this._buffer.constructor,this._mesh=void 0}Object.defineProperties(u_.prototype,{credits:{get:function(){}},waterMask:{get:function(){return this._waterMask}},childTileMask:{get:function(){return this._childTileMask}}});var _0e="createVerticesFromHeightmap",Ust=new xi(_0e),zst=new xi(_0e,Im.maximumAsynchronousTasks);u_.prototype.createMesh=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.tilingScheme,n=e.x,i=e.y,o=e.level,r=x(e.exaggeration,1),s=x(e.exaggerationRelativeHeight,0),a=x(e.throttle,!0),c=t.ellipsoid,l=t.tileXYToNativeRectangle(n,i,o),f=t.tileXYToRectangle(n,i,o),d=c.cartographicToCartesian(se.center(f)),p=this._structure,m=ds.getEstimatedLevelZeroGeometricErrorForAHeightmap(c,this._width,t.getNumberOfXTilesAtLevel(0))/(1<<o);this._skirtHeight=Math.min(m*4,1e3);let b=(a?zst:Ust).scheduleTask({heightmap:this._buffer,structure:p,includeWebMercatorT:!0,width:this._width,height:this._height,nativeRectangle:l,rectangle:f,relativeToCenter:d,ellipsoid:c,skirtHeight:this._skirtHeight,isGeographic:t.projection instanceof Oi,exaggeration:r,exaggerationRelativeHeight:s,encoding:this._encoding});if(!u(b))return;let C=this;return Promise.resolve(b).then(function(A){let T;C._skirtHeight>0?T=ds.getRegularGridAndSkirtIndicesAndEdgeIndices(A.gridWidth,A.gridHeight):T=ds.getRegularGridIndicesAndEdgeIndices(A.gridWidth,A.gridHeight);let E=A.gridWidth*A.gridHeight;return C._mesh=new th(d,new Float32Array(A.vertices),T.indices,T.indexCountWithoutSkirts,E,A.minimumHeight,A.maximumHeight,ae.clone(A.boundingSphere3D),h.clone(A.occludeePointInScaledSpace),A.numberOfAttributes,wn.clone(A.orientedBoundingBox),Zc.clone(A.encoding),T.westIndicesSouthToNorth,T.southIndicesEastToWest,T.eastIndicesNorthToSouth,T.northIndicesWestToEast),C._buffer=void 0,C._mesh})};u_.prototype._createMeshSync=function(e){let t=e.tilingScheme,n=e.x,i=e.y,o=e.level,r=x(e.exaggeration,1),s=x(e.exaggerationRelativeHeight,0),a=t.ellipsoid,c=t.tileXYToNativeRectangle(n,i,o),l=t.tileXYToRectangle(n,i,o),f=a.cartographicToCartesian(se.center(l)),d=this._structure,g=ds.getEstimatedLevelZeroGeometricErrorForAHeightmap(a,this._width,t.getNumberOfXTilesAtLevel(0))/(1<<o);this._skirtHeight=Math.min(g*4,1e3);let m=yD.computeVertices({heightmap:this._buffer,structure:d,includeWebMercatorT:!0,width:this._width,height:this._height,nativeRectangle:c,rectangle:l,relativeToCenter:f,ellipsoid:a,skirtHeight:this._skirtHeight,isGeographic:t.projection instanceof Oi,exaggeration:r,exaggerationRelativeHeight:s});this._buffer=void 0;let y;this._skirtHeight>0?y=ds.getRegularGridAndSkirtIndicesAndEdgeIndices(this._width,this._height):y=ds.getRegularGridIndicesAndEdgeIndices(this._width,this._height);let b=m.gridWidth*m.gridHeight;return this._mesh=new th(f,m.vertices,y.indices,y.indexCountWithoutSkirts,b,m.minimumHeight,m.maximumHeight,m.boundingSphere3D,m.occludeePointInScaledSpace,m.encoding.stride,m.orientedBoundingBox,m.encoding,y.westIndicesSouthToNorth,y.southIndicesEastToWest,y.eastIndicesNorthToSouth,y.northIndicesWestToEast),this._mesh};u_.prototype.interpolateHeight=function(e,t,n){let i=this._width,o=this._height,r=this._structure,s=r.stride,a=r.elementsPerHeight,c=r.elementMultiplier,l=r.isBigEndian,f=r.heightOffset,d=r.heightScale,p=u(this._mesh),g=this._encoding===eh.LERC;if(!p&&g)return;let y;if(p){let b=this._mesh.vertices,C=this._mesh.encoding;y=g0e(b,C,f,d,e,i,o,t,n)}else y=Hst(this._buffer,a,c,s,l,e,i,o,t,n),y=y*d+f;return y};u_.prototype.upsample=function(e,t,n,i,o,r,s){let a=this._mesh;if(!u(a))return;let c=this._width,l=this._height,f=this._structure,d=f.stride,p=new this._bufferType(c*l*d),g=a.vertices,m=a.encoding,y=e.tileXYToRectangle(t,n,i),b=e.tileXYToRectangle(o,r,s),C=f.heightOffset,A=f.heightScale,T=f.elementsPerHeight,E=f.elementMultiplier,v=f.isBigEndian,D=Math.pow(E,T-1);for(let O=0;O<l;++O){let P=R.lerp(b.north,b.south,O/(l-1));for(let M=0;M<c;++M){let L=R.lerp(b.west,b.east,M/(c-1)),_=g0e(g,m,C,A,y,c,l,L,P);_=_<f.lowestEncodedHeight?f.lowestEncodedHeight:_,_=_>f.highestEncodedHeight?f.highestEncodedHeight:_,Gst(p,T,E,D,d,v,O*c+M,_)}}return Promise.resolve(new u_({buffer:p,width:c,height:l,childTileMask:0,structure:this._structure,createdByUpsampling:!0}))};u_.prototype.isChildAvailable=function(e,t,n,i){let o=2;return n!==e*2&&++o,i!==t*2&&(o-=2),(this._childTileMask&1<<o)!==0};u_.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};function Hst(e,t,n,i,o,r,s,a,c,l){let f=(c-r.west)*(s-1)/(r.east-r.west),d=(l-r.south)*(a-1)/(r.north-r.south),p=f|0,g=p+1;g>=s&&(g=s-1,p=s-2);let m=d|0,y=m+1;y>=a&&(y=a-1,m=a-2);let b=f-p,C=d-m;m=a-1-m,y=a-1-y;let A=FV(e,t,n,i,o,m*s+p),T=FV(e,t,n,i,o,m*s+g),E=FV(e,t,n,i,o,y*s+p),v=FV(e,t,n,i,o,y*s+g);return y0e(b,C,A,T,E,v)}function g0e(e,t,n,i,o,r,s,a,c){let l=(a-o.west)*(r-1)/(o.east-o.west),f=(c-o.south)*(s-1)/(o.north-o.south),d=l|0,p=d+1;p>=r&&(p=r-1,d=r-2);let g=f|0,m=g+1;m>=s&&(m=s-1,g=s-2);let y=l-d,b=f-g;g=s-1-g,m=s-1-m;let C=(t.decodeHeight(e,g*r+d)-n)/i,A=(t.decodeHeight(e,g*r+p)-n)/i,T=(t.decodeHeight(e,m*r+d)-n)/i,E=(t.decodeHeight(e,m*r+p)-n)/i;return y0e(y,b,C,A,T,E)}function y0e(e,t,n,i,o,r){return t<e?n+e*(i-n)+t*(r-i):n+e*(r-o)+t*(o-n)}function FV(e,t,n,i,o,r){r*=i;let s=0,a;if(o)for(a=0;a<t;++a)s=s*n+e[r+a];else for(a=t-1;a>=0;--a)s=s*n+e[r+a];return s}function Gst(e,t,n,i,o,r,s,a){s*=o;let c;if(r)for(c=0;c<t-1;++c)e[s+c]=a/i|0,a-=e[s+c]*i,i/=n;else for(c=t-1;c>0;--c)e[s+c]=a/i|0,a-=e[s+c]*i,i/=n;e[s+c]=a}var lc=u_;function AE(e,t){this._tilingScheme=e,this._maximumLevel=t,this._rootNodes=[]}var ub=new se;function Wst(e,t,n,i){let o=i.length;for(let r=0;r<o;++r){let s=i[r];if(s.x===t&&s.y===n&&s.level===e)return!0}return!1}AE.prototype.addAvailableTileRange=function(e,t,n,i,o){let r=this._tilingScheme,s=this._rootNodes;if(e===0)for(let p=n;p<=o;++p)for(let g=t;g<=i;++g)Wst(e,g,p,s)||s.push(new bE(r,void 0,0,g,p));r.tileXYToRectangle(t,n,e,ub);let a=ub.west,c=ub.north;r.tileXYToRectangle(i,o,e,ub);let l=ub.east,f=ub.south,d=new Kst(e,a,f,l,c);for(let p=0;p<s.length;++p){let g=s[p];dX(g.extent,d)&&Zst(this._maximumLevel,g,d)}};AE.prototype.computeMaximumLevelAtPosition=function(e){let t;for(let n=0;n<this._rootNodes.length;++n){let i=this._rootNodes[n];if(CE(i.extent,e)){t=i;break}}return u(t)?xD(void 0,t,e):-1};var jst=[],qst=[],Yst=new se,Xst=new se;AE.prototype.computeBestAvailableLevelOverRectangle=function(e){let t=jst;t.length=0,e.east<e.west?(t.push(se.fromRadians(-Math.PI,e.south,e.east,e.north,Yst)),t.push(se.fromRadians(e.west,e.south,Math.PI,e.north,Xst))):t.push(e);let n=qst;n.length=0;let i;for(i=0;i<this._rootNodes.length;++i)bD(n,this._rootNodes[i],t);for(i=n.length-1;i>=0;--i)if(u(n[i])&&n[i].length===0)return i;return 0};var x0e=new de;AE.prototype.isTileAvailable=function(e,t,n){let i=this._tilingScheme.tileXYToRectangle(t,n,e,ub);return se.center(i,x0e),this.computeMaximumLevelAtPosition(x0e)>=e};AE.prototype.computeChildMaskForTile=function(e,t,n){let i=e+1;if(i>=this._maximumLevel)return 0;let o=0;return o|=this.isTileAvailable(i,2*t,2*n+1)?1:0,o|=this.isTileAvailable(i,2*t+1,2*n+1)?2:0,o|=this.isTileAvailable(i,2*t,2*n)?4:0,o|=this.isTileAvailable(i,2*t+1,2*n)?8:0,o};function bE(e,t,n,i,o){this.tilingScheme=e,this.parent=t,this.level=n,this.x=i,this.y=o,this.extent=e.tileXYToRectangle(i,o,n),this.rectangles=[],this._sw=void 0,this._se=void 0,this._nw=void 0,this._ne=void 0}Object.defineProperties(bE.prototype,{nw:{get:function(){return this._nw||(this._nw=new bE(this.tilingScheme,this,this.level+1,this.x*2,this.y*2)),this._nw}},ne:{get:function(){return this._ne||(this._ne=new bE(this.tilingScheme,this,this.level+1,this.x*2+1,this.y*2)),this._ne}},sw:{get:function(){return this._sw||(this._sw=new bE(this.tilingScheme,this,this.level+1,this.x*2,this.y*2+1)),this._sw}},se:{get:function(){return this._se||(this._se=new bE(this.tilingScheme,this,this.level+1,this.x*2+1,this.y*2+1)),this._se}}});function Kst(e,t,n,i,o){this.level=e,this.west=t,this.south=n,this.east=i,this.north=o}function dX(e,t){let n=Math.max(e.west,t.west),i=Math.max(e.south,t.south),o=Math.min(e.east,t.east),r=Math.min(e.north,t.north);return i<r&&n<o}function Zst(e,t,n){for(;t.level<e;)if(BV(t.nw.extent,n))t=t.nw;else if(BV(t.ne.extent,n))t=t.ne;else if(BV(t.sw.extent,n))t=t.sw;else if(BV(t.se.extent,n))t=t.se;else break;if(t.rectangles.length===0||t.rectangles[t.rectangles.length-1].level<=n.level)t.rectangles.push(n);else{let i=No(t.rectangles,n.level,$st);i<0&&(i=~i),t.rectangles.splice(i,0,n)}}function $st(e,t){return e.level-t}function BV(e,t){return t.west>=e.west&&t.east<=e.east&&t.south>=e.south&&t.north<=e.north}function CE(e,t){return t.longitude>=e.west&&t.longitude<=e.east&&t.latitude>=e.south&&t.latitude<=e.north}function xD(e,t,n){let i=0,o=!1;for(;!o;){let r=t._nw&&CE(t._nw.extent,n),s=t._ne&&CE(t._ne.extent,n),a=t._sw&&CE(t._sw.extent,n),c=t._se&&CE(t._se.extent,n);if(r+s+a+c>1){r&&(i=Math.max(i,xD(t,t._nw,n))),s&&(i=Math.max(i,xD(t,t._ne,n))),a&&(i=Math.max(i,xD(t,t._sw,n))),c&&(i=Math.max(i,xD(t,t._se,n)));break}else r?t=t._nw:s?t=t._ne:a?t=t._sw:c?t=t._se:o=!0}for(;t!==e;){let r=t.rectangles;for(let s=r.length-1;s>=0&&r[s].level>i;--s){let a=r[s];CE(a,n)&&(i=a.level)}t=t.parent}return i}function bD(e,t,n){if(!t)return;let i,o=!1;for(i=0;i<n.length;++i)o=o||dX(t.extent,n[i]);if(!o)return;let r=t.rectangles;for(i=0;i<r.length;++i){let s=r[i];e[s.level]||(e[s.level]=n),e[s.level]=Qst(e[s.level],s)}bD(e,t._nw,n),bD(e,t._ne,n),bD(e,t._sw,n),bD(e,t._se,n)}function Qst(e,t){let n=[];for(let i=0;i<e.length;++i){let o=e[i];dX(o,t)?(o.west<t.west&&n.push(new se(o.west,o.south,t.west,o.north)),o.east>t.east&&n.push(new se(t.east,o.south,o.east,o.north)),o.south<t.south&&n.push(new se(Math.max(t.west,o.west),o.south,Math.min(t.east,o.east),t.south)),o.north>t.north&&n.push(new se(Math.max(t.west,o.west),t.north,Math.min(t.east,o.east),o.north))):n.push(o)}return n}var Pm=AE;function Jst(e){let t,n=e.name,i=e.message;u(n)&&u(i)?t=`${n}: ${i}`:t=e.toString();let o=e.stack;return u(o)&&(t+=`
${o}`),t}var f_=Jst;function kV(e,t,n,i,o,r,s){this.provider=e,this.message=t,this.x=n,this.y=i,this.level=o,this.timesRetried=x(r,0),this.retry=!1,this.error=s}kV.reportError=function(e,t,n,i,o,r,s,a){let c=e;return u(e)?(c.provider=t,c.message=i,c.x=o,c.y=r,c.level=s,c.retry=!1,c.error=a,++c.timesRetried):c=new kV(t,i,o,r,s,0,a),u(n)&&n.numberOfListeners>0?n.raiseEvent(c):u(t)&&console.log(`An error occurred in "${t.constructor.name}": ${f_(i)}`),c};kV.reportSuccess=function(e){u(e)&&(e.timesRetried=-1)};var Oo=kV;function V0(e){if(e=x(e,x.EMPTY_OBJECT),this._ellipsoid=x(e.ellipsoid,ee.default),this._numberOfLevelZeroTilesX=x(e.numberOfLevelZeroTilesX,1),this._numberOfLevelZeroTilesY=x(e.numberOfLevelZeroTilesY,1),this._projection=new Li(this._ellipsoid),u(e.rectangleSouthwestInMeters)&&u(e.rectangleNortheastInMeters))this._rectangleSouthwestInMeters=e.rectangleSouthwestInMeters,this._rectangleNortheastInMeters=e.rectangleNortheastInMeters;else{let i=this._ellipsoid.maximumRadius*Math.PI;this._rectangleSouthwestInMeters=new H(-i,-i),this._rectangleNortheastInMeters=new H(i,i)}let t=this._projection.unproject(this._rectangleSouthwestInMeters),n=this._projection.unproject(this._rectangleNortheastInMeters);this._rectangle=new se(t.longitude,t.latitude,n.longitude,n.latitude)}Object.defineProperties(V0.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}});V0.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e};V0.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e};V0.prototype.rectangleToNativeRectangle=function(e,t){let n=this._projection,i=n.project(se.southwest(e)),o=n.project(se.northeast(e));return u(t)?(t.west=i.x,t.south=i.y,t.east=o.x,t.north=o.y,t):new se(i.x,i.y,o.x,o.y)};V0.prototype.tileXYToNativeRectangle=function(e,t,n,i){let o=this.getNumberOfXTilesAtLevel(n),r=this.getNumberOfYTilesAtLevel(n),s=(this._rectangleNortheastInMeters.x-this._rectangleSouthwestInMeters.x)/o,a=this._rectangleSouthwestInMeters.x+e*s,c=this._rectangleSouthwestInMeters.x+(e+1)*s,l=(this._rectangleNortheastInMeters.y-this._rectangleSouthwestInMeters.y)/r,f=this._rectangleNortheastInMeters.y-t*l,d=this._rectangleNortheastInMeters.y-(t+1)*l;return u(i)?(i.west=a,i.south=d,i.east=c,i.north=f,i):new se(a,d,c,f)};V0.prototype.tileXYToRectangle=function(e,t,n,i){let o=this.tileXYToNativeRectangle(e,t,n,i),r=this._projection,s=r.unproject(new H(o.west,o.south)),a=r.unproject(new H(o.east,o.north));return o.west=s.longitude,o.south=s.latitude,o.east=a.longitude,o.north=a.latitude,o};V0.prototype.positionToTileXY=function(e,t,n){let i=this._rectangle;if(!se.contains(i,e))return;let o=this.getNumberOfXTilesAtLevel(t),r=this.getNumberOfYTilesAtLevel(t),a=(this._rectangleNortheastInMeters.x-this._rectangleSouthwestInMeters.x)/o,l=(this._rectangleNortheastInMeters.y-this._rectangleSouthwestInMeters.y)/r,d=this._projection.project(e),p=d.x-this._rectangleSouthwestInMeters.x,g=this._rectangleNortheastInMeters.y-d.y,m=p/a|0;m>=o&&(m=o-1);let y=g/l|0;return y>=r&&(y=r-1),u(n)?(n.x=m,n.y=y,n):new H(m,y)};var hs=V0;var eat=15;function b0e(e){this.ellipsoid=x(e.ellipsoid,ee.default),this.credit=void 0,this.tilingScheme=void 0,this.height=void 0,this.width=void 0,this.encoding=void 0,this.lodCount=void 0,this.hasAvailability=!1,this.tilesAvailable=void 0,this.tilesAvailabilityLoaded=void 0,this.levelZeroMaximumGeometricError=void 0,this.terrainDataStructure=void 0}b0e.prototype.build=function(e){e._credit=this.credit,e._tilingScheme=this.tilingScheme,e._height=this.height,e._width=this.width,e._encoding=this.encoding,e._lodCount=this.lodCount,e._hasAvailability=this.hasAvailability,e._tilesAvailable=this.tilesAvailable,e._tilesAvailabilityLoaded=this.tilesAvailabilityLoaded,e._levelZeroMaximumGeometricError=this.levelZeroMaximumGeometricError,e._terrainDataStructure=this.terrainDataStructure};function tat(e,t){let n=t.copyrightText;u(n)&&(e.credit=new wt(n));let i=t.spatialReference,o=x(i.latestWkid,i.wkid),r=t.extent,s={ellipsoid:e.ellipsoid};if(o===4326)s.rectangle=se.fromDegrees(r.xmin,r.ymin,r.xmax,r.ymax),e.tilingScheme=new $i(s);else if(o===3857){let l=Math.PI*e.ellipsoid.maximumRadius;t.extent.xmax>l&&(t.extent.xmax=l),t.extent.ymax>l&&(t.extent.ymax=l),t.extent.xmin<-l&&(t.extent.xmin=-l),t.extent.ymin<-l&&(t.extent.ymin=-l),s.rectangleSouthwestInMeters=new H(r.xmin,r.ymin),s.rectangleNortheastInMeters=new H(r.xmax,r.ymax),e.tilingScheme=new hs(s)}else throw new ce("Invalid spatial reference");let a=t.tileInfo;if(!u(a))throw new ce("tileInfo is required");e.width=a.rows+1,e.height=a.cols+1,e.encoding=a.format==="LERC"?eh.LERC:eh.NONE,e.lodCount=a.lods.length-1,(e.hasAvailability=t.capabilities.indexOf("Tilemap")!==-1)&&(e.tilesAvailable=new Pm(e.tilingScheme,e.lodCount),e.tilesAvailable.addAvailableTileRange(0,0,0,e.tilingScheme.getNumberOfXTilesAtLevel(0),e.tilingScheme.getNumberOfYTilesAtLevel(0)),e.tilesAvailabilityLoaded=new Pm(e.tilingScheme,e.lodCount)),e.levelZeroMaximumGeometricError=ds.getEstimatedLevelZeroGeometricErrorForAHeightmap(e.tilingScheme.ellipsoid,e.width,e.tilingScheme.getNumberOfXTilesAtLevel(0)),t.bandCount>1&&console.log("ArcGISTiledElevationTerrainProvider: Terrain data has more than 1 band. Using the first one."),u(t.minValues)&&u(t.maxValues)?e.terrainDataStructure={elementMultiplier:1,lowestEncodedHeight:t.minValues[0],highestEncodedHeight:t.maxValues[0]}:e.terrainDataStructure={elementMultiplier:1}}async function nat(e,t,n){try{let i=await t.fetchJson();tat(e,i)}catch(i){let o=`An error occurred while accessing ${t}.`;throw Oo.reportError(void 0,n,u(n)?n._errorEvent:void 0,o),i}}function U0(e){e=x(e,x.EMPTY_OBJECT),this._resource=void 0,this._credit=void 0,this._tilingScheme=void 0,this._levelZeroMaximumGeometricError=void 0,this._maxLevel=void 0,this._terrainDataStructure=void 0,this._width=void 0,this._height=void 0,this._encoding=void 0,this._lodCount=void 0,this._hasAvailability=!1,this._tilesAvailable=void 0,this._tilesAvailabilityLoaded=void 0,this._availableCache={},this._errorEvent=new me}Object.defineProperties(U0.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){return this._tilesAvailable}}});U0.fromUrl=async function(e,t){t=x(t,x.EMPTY_OBJECT),e=await Promise.resolve(e);let n=De.createIfNeeded(e);n.appendForwardSlash(),u(t.token)&&(n=n.getDerivedResource({queryParameters:{token:t.token}}));let i=n.getDerivedResource({queryParameters:{f:"pjson"}}),o=new b0e(t);await nat(o,i);let r=new U0(t);return o.build(r),r._resource=n,r};U0.prototype.requestTileGeometry=function(e,t,n,i){let o=this._resource.getDerivedResource({url:`tile/${n}/${t}/${e}`,request:i}),r=this._hasAvailability,s=Promise.resolve(!0),a;if(r&&!u(hX(this,n+1,e*2,t*2))){let d=C0e(this,n+1,e*2,t*2);s=d.promise,a=d.request}let c=o.fetchArrayBuffer();if(!u(c)||!u(s))return;let l=this,f=this._tilesAvailable;return Promise.all([c,s]).then(function(d){return new lc({buffer:d[0],width:l._width,height:l._height,childTileMask:r?f.computeChildMaskForTile(n,e,t):eat,structure:l._terrainDataStructure,encoding:l._encoding})}).catch(async function(d){if(u(a)&&a.state===$n.CANCELLED){i.cancel();try{await i.deferred?.promise}catch{}return i.state=$n.CANCELLED,Promise.reject(d)}return Promise.reject(d)})};function hX(e,t,n,i){if(!e._hasAvailability)return;let o=e._tilesAvailabilityLoaded,r=e._tilesAvailable;if(t>e._lodCount)return!1;if(r.isTileAvailable(t,n,i))return!0;if(o.isTileAvailable(t,n,i))return!1}U0.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)};U0.prototype.getTileDataAvailable=function(e,t,n){if(!this._hasAvailability)return;let i=hX(this,n,e,t);if(u(i))return i;C0e(this,n,e,t)};U0.prototype.loadTileDataAvailability=function(e,t,n){};function iat(e,t,n,i){let o=t-1,r=n-1,s=i[e.y*t+e.x],a=[],c={startX:e.x,startY:e.y,endX:0,endY:0},l=new H(e.x+1,e.y+1),f=!1,d=!1;for(;!(f&&d);){let p=l.x,g=d?l.y+1:l.y;if(!f){for(let m=e.y;m<g;++m)if(i[m*t+l.x]!==s){f=!0;break}f?(a.push(new H(l.x,e.y)),--l.x,--p,c.endX=l.x):l.x===o?(c.endX=l.x,f=!0):++l.x}if(!d){let m=l.y*t;for(let y=e.x;y<=p;++y)if(i[m+y]!==s){d=!0;break}d?(a.push(new H(e.x,l.y)),--l.y,c.endY=l.y):l.y===r?(c.endY=l.y,d=!0):++l.y}}return{endingIndices:a,range:c,value:s}}function oat(e,t,n,i,o){let r=[];if(o.every(function(c){return c===o[0]}))return o[0]===1&&r.push({startX:e,startY:t,endX:e+n-1,endY:t+i-1}),r;let a=[new H(0,0)];for(;a.length>0;){let c=a.pop(),l=iat(c,n,i,o);if(l.value===1){let d=l.range;d.startX+=e,d.endX+=e,d.startY+=t,d.endY+=t,r.push(d)}let f=l.endingIndices;f.length>0&&(a=a.concat(f))}return r}function C0e(e,t,n,i){if(!e._hasAvailability)return{};let o=Math.floor(n/128)*128,r=Math.floor(i/128)*128,s=Math.min(1<<t,128),a=`tilemap/${t}/${r}/${o}/${s}/${s}`,c=e._availableCache;if(u(c[a]))return c[a];let l=new rr({throttle:!1,throttleByServer:!0,type:gs.TERRAIN}),d=e._resource.getDerivedResource({url:a,request:l}).fetchJson();return u(d)?(d=d.then(function(p){let g=oat(o,r,s,s,p.data);e._tilesAvailabilityLoaded.addAvailableTileRange(t,o,r,o+s,r+s);let m=e._tilesAvailable;for(let y=0;y<g.length;++y){let b=g[y];m.addAvailableTileRange(t,b.startX,b.startY,b.endX,b.endY)}return hX(e,t,n,i)}),c[a]={promise:d,request:l},d=d.finally(function(p){return delete c[a],p}),{promise:d,request:l}):{}}var A0e=U0;var T0e="https://dev.virtualearth.net/REST/v1/Locations";function mX(e){e=x(e,x.EMPTY_OBJECT);let t=e.key;this._key=t;let n={key:t};u(e.culture)&&(n.culture=e.culture),this._resource=new De({url:T0e,queryParameters:n}),this._credit=new wt('<img src="http://dev.virtualearth.net/Branding/logo_powered_by.png"/>',!1)}Object.defineProperties(mX.prototype,{url:{get:function(){return T0e}},key:{get:function(){return this._key}},credit:{get:function(){return this._credit}}});mX.prototype.geocode=async function(e){return this._resource.getDerivedResource({queryParameters:{query:e}}).fetchJsonp("jsonp").then(function(n){return n.resourceSets.length===0?[]:n.resourceSets[0].resources.map(function(o){let r=o.bbox,s=r[0],a=r[1],c=r[2],l=r[3];return{displayName:o.name,destination:se.fromDegrees(a,s,l,c)}})})};var E0e=mX;function pX(){}Object.defineProperties(pX.prototype,{credit:{get:function(){}}});pX.prototype.geocode=function(e){let t=e.match(/[^\s,\n]+/g);if(t.length===2||t.length===3){let n=+t[0],i=+t[1],o=t.length===3?+t[2]:300;if(isNaN(n)&&isNaN(i)){let r=/^(\d+.?\d*)([nsew])/i;for(let s=0;s<t.length;++s){let a=t[s].match(r);r.test(t[s])&&a.length===3&&(/^[ns]/i.test(a[2])?i=/^[n]/i.test(a[2])?+a[1]:-a[1]:/^[ew]/i.test(a[2])&&(n=/^[e]/i.test(a[2])?+a[1]:-a[1]))}}if(!isNaN(n)&&!isNaN(i)&&!isNaN(o)){let r={displayName:e,destination:h.fromDegrees(n,i,o)};return Promise.resolve([r])}}return Promise.resolve([])};var S0e=pX;var rat=new oe,v0e=new h,TE=new h;function sat(e){let t=e.points,n=e.times;if(t.length<3){let i=n[0],o=1/(n[1]-i),r=t[0],s=t[1];return function(a,c){u(c)||(c=new h);let l=(a-i)*o;return h.lerp(r,s,l,c)}}return function(i,o){u(o)||(o=new h);let r=e._lastTimeIndex=e.findTimeInterval(i,e._lastTimeIndex),s=(i-n[r])/(n[r+1]-n[r]),a=rat;a.z=s,a.y=s*s,a.x=a.y*s,a.w=1;let c,l,f,d,p;return r===0?(c=t[0],l=t[1],f=e.firstTangent,d=h.subtract(t[2],c,v0e),h.multiplyByScalar(d,.5,d),p=F.multiplyByVector(px.hermiteCoefficientMatrix,a,a)):r===t.length-2?(c=t[r],l=t[r+1],d=e.lastTangent,f=h.subtract(l,t[r-1],v0e),h.multiplyByScalar(f,.5,f),p=F.multiplyByVector(px.hermiteCoefficientMatrix,a,a)):(c=t[r-1],l=t[r],f=t[r+1],d=t[r+2],p=F.multiplyByVector(z0.catmullRomCoefficientMatrix,a,a)),o=h.multiplyByScalar(c,p.x,o),h.multiplyByScalar(l,p.y,TE),h.add(o,TE,o),h.multiplyByScalar(f,p.z,TE),h.add(o,TE,o),h.multiplyByScalar(d,p.w,TE),h.add(o,TE,o)}}var aat=new h,cat=new h;function z0(e){e=x(e,x.EMPTY_OBJECT);let t=e.points,n=e.times,i=e.firstTangent,o=e.lastTangent;if(t.length>2&&(u(i)||(i=aat,h.multiplyByScalar(t[1],2,i),h.subtract(i,t[2],i),h.subtract(i,t[0],i),h.multiplyByScalar(i,.5,i)),!u(o))){let r=t.length-1;o=cat,h.multiplyByScalar(t[r-1],2,o),h.subtract(t[r],o,o),h.add(o,t[r-2],o),h.multiplyByScalar(o,.5,o)}this._times=n,this._points=t,this._firstTangent=h.clone(i),this._lastTangent=h.clone(o),this._evaluateFunction=sat(this),this._lastTimeIndex=0}Object.defineProperties(z0.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},firstTangent:{get:function(){return this._firstTangent}},lastTangent:{get:function(){return this._lastTangent}}});z0.catmullRomCoefficientMatrix=new F(-.5,1,-.5,0,1.5,-2.5,0,1,-1.5,2,.5,0,.5,-.5,0,0);z0.prototype.findTimeInterval=ao.prototype.findTimeInterval;z0.prototype.wrapTime=ao.prototype.wrapTime;z0.prototype.clampTime=ao.prototype.clampTime;z0.prototype.evaluate=function(e,t){return this._evaluateFunction(e,t)};var w0e=z0;var VV={};VV.clipTriangleAtAxisAlignedThreshold=function(e,t,n,i,o,r){u(r)?r.length=0:r=[];let s,a,c;t?(s=n<e,a=i<e,c=o<e):(s=n>e,a=i>e,c=o>e);let l=s+a+c,f,d,p,g,m,y;return l===1?s?(f=(e-n)/(i-n),d=(e-n)/(o-n),r.push(1),r.push(2),d!==1&&(r.push(-1),r.push(0),r.push(2),r.push(d)),f!==1&&(r.push(-1),r.push(0),r.push(1),r.push(f))):a?(p=(e-i)/(o-i),g=(e-i)/(n-i),r.push(2),r.push(0),g!==1&&(r.push(-1),r.push(1),r.push(0),r.push(g)),p!==1&&(r.push(-1),r.push(1),r.push(2),r.push(p))):c&&(m=(e-o)/(n-o),y=(e-o)/(i-o),r.push(0),r.push(1),y!==1&&(r.push(-1),r.push(2),r.push(1),r.push(y)),m!==1&&(r.push(-1),r.push(2),r.push(0),r.push(m))):l===2?!s&&n!==e?(g=(e-i)/(n-i),m=(e-o)/(n-o),r.push(0),r.push(-1),r.push(1),r.push(0),r.push(g),r.push(-1),r.push(2),r.push(0),r.push(m)):!a&&i!==e?(y=(e-o)/(i-o),f=(e-n)/(i-n),r.push(1),r.push(-1),r.push(2),r.push(1),r.push(y),r.push(-1),r.push(0),r.push(1),r.push(f)):!c&&o!==e&&(d=(e-n)/(o-n),p=(e-i)/(o-i),r.push(2),r.push(-1),r.push(0),r.push(2),r.push(d),r.push(-1),r.push(1),r.push(2),r.push(p)):l!==3&&(r.push(0),r.push(1),r.push(2)),r};VV.computeBarycentricCoordinates=function(e,t,n,i,o,r,s,a,c){let l=n-s,f=s-o,d=r-a,p=i-a,g=1/(d*l+f*p),m=t-a,y=e-s,b=(d*y+f*m)*g,C=(-p*y+l*m)*g,A=1-b-C;return u(c)?(c.x=b,c.y=C,c.z=A,c):new h(b,C,A)};VV.computeLineSegmentLineSegmentIntersection=function(e,t,n,i,o,r,s,a,c){let l=(s-o)*(t-r)-(a-r)*(e-o),f=(n-e)*(t-r)-(i-t)*(e-o),d=(a-r)*(n-e)-(s-o)*(i-t);if(d===0)return;let p=l/d,g=f/d;if(p>=0&&p<=1&&g>=0&&g<=1)return u(c)||(c=new H),c.x=e+p*(n-e),c.y=t+p*(i-t),c};var H0=VV;function G0(e){this._quantizedVertices=e.quantizedVertices,this._encodedNormals=e.encodedNormals,this._indices=e.indices,this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._boundingSphere=e.boundingSphere,this._orientedBoundingBox=e.orientedBoundingBox,this._horizonOcclusionPoint=e.horizonOcclusionPoint,this._credits=e.credits;let t=this._quantizedVertices.length/3,n=this._uValues=this._quantizedVertices.subarray(0,t),i=this._vValues=this._quantizedVertices.subarray(t,2*t);this._heightValues=this._quantizedVertices.subarray(2*t,3*t);function o(s,a){return i[s]-i[a]}function r(s,a){return n[s]-n[a]}this._westIndices=zV(e.westIndices,o,t),this._southIndices=zV(e.southIndices,r,t),this._eastIndices=zV(e.eastIndices,o,t),this._northIndices=zV(e.northIndices,r,t),this._westSkirtHeight=e.westSkirtHeight,this._southSkirtHeight=e.southSkirtHeight,this._eastSkirtHeight=e.eastSkirtHeight,this._northSkirtHeight=e.northSkirtHeight,this._childTileMask=x(e.childTileMask,15),this._createdByUpsampling=x(e.createdByUpsampling,!1),this._waterMask=e.waterMask,this._mesh=void 0}Object.defineProperties(G0.prototype,{credits:{get:function(){return this._credits}},waterMask:{get:function(){return this._waterMask}},childTileMask:{get:function(){return this._childTileMask}},canUpsample:{get:function(){return u(this._mesh)}}});var UV=[];function zV(e,t,n){UV.length=e.length;let i=!1;for(let o=0,r=e.length;o<r;++o)UV[o]=e[o],i=i||o>0&&t(e[o-1],e[o])>0;return i?(UV.sort(t),Be.createTypedArray(n,UV)):e}var D0e="createVerticesFromQuantizedTerrainMesh",lat=new xi(D0e),uat=new xi(D0e,Im.maximumAsynchronousTasks);G0.prototype.createMesh=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.tilingScheme,n=e.x,i=e.y,o=e.level,r=x(e.exaggeration,1),s=x(e.exaggerationRelativeHeight,0),a=x(e.throttle,!0),c=t.ellipsoid,l=t.tileXYToRectangle(n,i,o),d=(a?uat:lat).scheduleTask({minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,quantizedVertices:this._quantizedVertices,octEncodedNormals:this._encodedNormals,includeWebMercatorT:!0,indices:this._indices,westIndices:this._westIndices,southIndices:this._southIndices,eastIndices:this._eastIndices,northIndices:this._northIndices,westSkirtHeight:this._westSkirtHeight,southSkirtHeight:this._southSkirtHeight,eastSkirtHeight:this._eastSkirtHeight,northSkirtHeight:this._northSkirtHeight,rectangle:l,relativeToCenter:this._boundingSphere.center,ellipsoid:c,exaggeration:r,exaggerationRelativeHeight:s});if(!u(d))return;let p=this;return Promise.resolve(d).then(function(g){let m=p._quantizedVertices.length/3,y=m+p._westIndices.length+p._southIndices.length+p._eastIndices.length+p._northIndices.length,b=Be.createTypedArray(y,g.indices),C=new Float32Array(g.vertices),A=g.center,T=g.minimumHeight,E=g.maximumHeight,v=p._boundingSphere,D=p._orientedBoundingBox,O=x(h.clone(g.occludeePointInScaledSpace),p._horizonOcclusionPoint),P=g.vertexStride,M=Zc.clone(g.encoding);return p._mesh=new th(A,C,b,g.indexCountWithoutSkirts,m,T,E,v,O,P,D,M,g.westIndicesSouthToNorth,g.southIndicesEastToWest,g.eastIndicesNorthToSouth,g.northIndicesWestToEast),p._quantizedVertices=void 0,p._encodedNormals=void 0,p._indices=void 0,p._uValues=void 0,p._vValues=void 0,p._heightValues=void 0,p._westIndices=void 0,p._southIndices=void 0,p._eastIndices=void 0,p._northIndices=void 0,p._mesh})};var fat=new xi("upsampleQuantizedTerrainMesh",Im.maximumAsynchronousTasks);G0.prototype.upsample=function(e,t,n,i,o,r,s){let a=this._mesh;if(!u(this._mesh))return;let c=t*2!==o,l=n*2===r,f=e.ellipsoid,d=e.tileXYToRectangle(o,r,s),p=fat.scheduleTask({vertices:a.vertices,vertexCountWithoutSkirts:a.vertexCountWithoutSkirts,indices:a.indices,indexCountWithoutSkirts:a.indexCountWithoutSkirts,encoding:a.encoding,minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,isEastChild:c,isNorthChild:l,childRectangle:d,ellipsoid:f});if(!u(p))return;let g=Math.min(this._westSkirtHeight,this._eastSkirtHeight);g=Math.min(g,this._southSkirtHeight),g=Math.min(g,this._northSkirtHeight);let m=c?g*.5:this._westSkirtHeight,y=l?g*.5:this._southSkirtHeight,b=c?this._eastSkirtHeight:g*.5,C=l?this._northSkirtHeight:g*.5,A=this._credits;return Promise.resolve(p).then(function(T){let E=new Uint16Array(T.vertices),v=Be.createTypedArray(E.length/3,T.indices),D;return u(T.encodedNormals)&&(D=new Uint8Array(T.encodedNormals)),new G0({quantizedVertices:E,indices:v,encodedNormals:D,minimumHeight:T.minimumHeight,maximumHeight:T.maximumHeight,boundingSphere:ae.clone(T.boundingSphere),orientedBoundingBox:wn.clone(T.orientedBoundingBox),horizonOcclusionPoint:h.clone(T.horizonOcclusionPoint),westIndices:T.westIndices,southIndices:T.southIndices,eastIndices:T.eastIndices,northIndices:T.northIndices,westSkirtHeight:m,southSkirtHeight:y,eastSkirtHeight:b,northSkirtHeight:C,childTileMask:0,credits:A,createdByUpsampling:!0})})};var _X=32767,I0e=new h;G0.prototype.interpolateHeight=function(e,t,n){let i=R.clamp((t-e.west)/e.width,0,1);i*=_X;let o=R.clamp((n-e.south)/e.height,0,1);return o*=_X,u(this._mesh)?pat(this,i,o):_at(this,i,o)};function P0e(e,t,n,i,o,r,s,a){let c=Math.min(n,o,s),l=Math.max(n,o,s),f=Math.min(i,r,a),d=Math.max(i,r,a);return e>=c&&e<=l&&t>=f&&t<=d}var dat=new H,hat=new H,mat=new H;function pat(e,t,n){let i=e._mesh,o=i.vertices,r=i.encoding,s=i.indices;for(let a=0,c=s.length;a<c;a+=3){let l=s[a],f=s[a+1],d=s[a+2],p=r.decodeTextureCoordinates(o,l,dat),g=r.decodeTextureCoordinates(o,f,hat),m=r.decodeTextureCoordinates(o,d,mat);if(P0e(t,n,p.x,p.y,g.x,g.y,m.x,m.y)){let y=H0.computeBarycentricCoordinates(t,n,p.x,p.y,g.x,g.y,m.x,m.y,I0e);if(y.x>=-1e-15&&y.y>=-1e-15&&y.z>=-1e-15){let b=r.decodeHeight(o,l),C=r.decodeHeight(o,f),A=r.decodeHeight(o,d);return y.x*b+y.y*C+y.z*A}}}}function _at(e,t,n){let i=e._uValues,o=e._vValues,r=e._heightValues,s=e._indices;for(let a=0,c=s.length;a<c;a+=3){let l=s[a],f=s[a+1],d=s[a+2],p=i[l],g=i[f],m=i[d],y=o[l],b=o[f],C=o[d];if(P0e(t,n,p,y,g,b,m,C)){let A=H0.computeBarycentricCoordinates(t,n,p,y,g,b,m,C,I0e);if(A.x>=-1e-15&&A.y>=-1e-15&&A.z>=-1e-15){let T=A.x*r[l]+A.y*r[f]+A.z*r[d];return R.lerp(e._minimumHeight,e._maximumHeight,T/_X)}}}}G0.prototype.isChildAvailable=function(e,t,n,i){let o=2;return n!==e*2&&++o,i!==t*2&&(o-=2),(this._childTileMask&1<<o)!==0};G0.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};var EE=G0;function gat(e){this.resource=e.resource,this.version=e.version,this.isHeightmap=e.isHeightmap,this.tileUrlTemplates=e.tileUrlTemplates,this.availability=e.availability,this.hasVertexNormals=e.hasVertexNormals,this.hasWaterMask=e.hasWaterMask,this.hasMetadata=e.hasMetadata,this.availabilityLevels=e.availabilityLevels,this.availabilityTilesLoaded=e.availabilityTilesLoaded,this.littleEndianExtensionSize=e.littleEndianExtensionSize,this.availabilityPromiseCache={}}function O0e(e){this.requestVertexNormals=x(e.requestVertexNormals,!1),this.requestWaterMask=x(e.requestWaterMask,!1),this.requestMetadata=x(e.requestMetadata,!0),this.ellipsoid=x(e.ellipsoid,ee.default),this.heightmapWidth=65,this.heightmapStructure=void 0,this.hasWaterMask=!1,this.hasMetadata=!1,this.hasVertexNormals=!1,this.scheme=void 0,this.lastResource=void 0,this.layerJsonResource=void 0,this.previousError=void 0,this.availability=void 0,this.tilingScheme=void 0,this.levelZeroMaximumGeometricError=void 0,this.heightmapStructure=void 0,this.layers=[],this.attribution="",this.overallAvailability=[],this.overallMaxZoom=0,this.tileCredits=[]}O0e.prototype.build=function(e){e._heightmapWidth=this.heightmapWidth,e._scheme=this.scheme;let t=u(this.lastResource.credits)?this.lastResource.credits:[];e._tileCredits=t.concat(this.tileCredits),e._availability=this.availability,e._tilingScheme=this.tilingScheme,e._requestWaterMask=this.requestWaterMask,e._levelZeroMaximumGeometricError=this.levelZeroMaximumGeometricError,e._heightmapStructure=this.heightmapStructure,e._layers=this.layers,e._hasWaterMask=this.hasWaterMask,e._hasVertexNormals=this.hasVertexNormals,e._hasMetadata=this.hasMetadata};async function M0e(e,t,n){if(!t.format){let y="The tile format is not specified in the layer.json file.";throw e.previousError=Oo.reportError(e.previousError,n,u(n)?n._errorEvent:void 0,y),new ce(y)}if(!t.tiles||t.tiles.length===0){let y="The layer.json file does not specify any tile URL templates.";throw e.previousError=Oo.reportError(e.previousError,n,u(n)?n._errorEvent:void 0,y),new ce(y)}let i=!1,o=!1,r=!1,s=!0,a=!1;if(t.format==="heightmap-1.0")a=!0,u(e.heightmapStructure)||(e.heightmapStructure={heightScale:1/5,heightOffset:-1e3,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1,lowestEncodedHeight:0,highestEncodedHeight:256*256-1}),o=!0,e.requestWaterMask=!0;else if(t.format.indexOf("quantized-mesh-1.")!==0){let y=`The tile format "${t.format}" is invalid or not supported.`;throw e.previousError=Oo.reportError(e.previousError,n,u(n)?n._errorEvent:void 0,y),new ce(y)}let c=t.tiles,l=t.maxzoom;if(e.overallMaxZoom=Math.max(e.overallMaxZoom,l),!t.projection||t.projection==="EPSG:4326")e.tilingScheme=new $i({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:1,ellipsoid:e.ellipsoid});else if(t.projection==="EPSG:3857")e.tilingScheme=new hs({numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1,ellipsoid:e.ellipsoid});else{let y=`The projection "${t.projection}" is invalid or not supported.`;throw e.previousError=Oo.reportError(e.previousError,n,u(n)?n._errorEvent:void 0,y),new ce(y)}if(e.levelZeroMaximumGeometricError=ds.getEstimatedLevelZeroGeometricErrorForAHeightmap(e.tilingScheme.ellipsoid,e.heightmapWidth,e.tilingScheme.getNumberOfXTilesAtLevel(0)),!t.scheme||t.scheme==="tms"||t.scheme==="slippyMap")e.scheme=t.scheme;else{let y=`The scheme "${t.scheme}" is invalid or not supported.`;throw e.previousError=Oo.reportError(e.previousError,n,u(n)?n._errorEvent:void 0,y),new ce(y)}let f;u(t.extensions)&&t.extensions.indexOf("octvertexnormals")!==-1?i=!0:u(t.extensions)&&t.extensions.indexOf("vertexnormals")!==-1&&(i=!0,s=!1),u(t.extensions)&&t.extensions.indexOf("watermask")!==-1&&(o=!0),u(t.extensions)&&t.extensions.indexOf("metadata")!==-1&&(r=!0);let d=t.metadataAvailability,p=t.available,g;if(u(p)&&!u(d)){g=new Pm(e.tilingScheme,p.length);for(let y=0;y<p.length;++y){let b=p[y],C=e.tilingScheme.getNumberOfYTilesAtLevel(y);u(e.overallAvailability[y])||(e.overallAvailability[y]=[]);for(let A=0;A<b.length;++A){let T=b[A],E=C-T.endY-1,v=C-T.startY-1;e.overallAvailability[y].push([T.startX,E,T.endX,v]),g.addAvailableTileRange(y,T.startX,E,T.endX,v)}}}else u(d)&&(f=new Pm(e.tilingScheme,l),g=new Pm(e.tilingScheme,l),e.overallAvailability[0]=[[0,0,1,0]],g.addAvailableTileRange(0,0,0,1,0));e.hasWaterMask=e.hasWaterMask||o,e.hasVertexNormals=e.hasVertexNormals||i,e.hasMetadata=e.hasMetadata||r,u(t.attribution)&&(e.attribution.length>0&&(e.attribution+=" "),e.attribution+=t.attribution),e.layers.push(new gat({resource:e.lastResource,version:t.version,isHeightmap:a,tileUrlTemplates:c,availability:g,hasVertexNormals:i,hasWaterMask:o,hasMetadata:r,availabilityLevels:d,availabilityTilesLoaded:f,littleEndianExtensionSize:s}));let m=t.parentUrl;return u(m)?u(g)?(e.lastResource=e.lastResource.getDerivedResource({url:m}),e.lastResource.appendForwardSlash(),e.layerJsonResource=e.lastResource.getDerivedResource({url:"layer.json"}),await xX(e),!0):(console.log("A layer.json can't have a parentUrl if it does't have an available array."),!0):!0}function yat(e,t,n){let i=`An error occurred while accessing ${e.layerJsonResource.url}.`;if(u(t)&&(i+=`
${t.message}`),e.previousError=Oo.reportError(e.previousError,n,u(n)?n._errorEvent:void 0,i),e.previousError.retry)return xX(e,n);throw new ce(i)}async function xat(e,t,n){await M0e(e,t,n);let i=e.overallAvailability.length;if(i>0){let o=e.availability=new Pm(e.tilingScheme,e.overallMaxZoom);for(let r=0;r<i;++r){let s=e.overallAvailability[r];for(let a=0;a<s.length;++a){let c=s[a];o.addAvailableTileRange(r,c[0],c[1],c[2],c[3])}}}if(e.attribution.length>0){let o=new wt(e.attribution);e.tileCredits.push(o)}return!0}async function xX(e,t){try{let n=await e.layerJsonResource.fetchJson();return xat(e,n,t)}catch(n){return u(n)&&n.statusCode===404?(await M0e(e,{tilejson:"2.1.0",format:"heightmap-1.0",version:"1.0.0",scheme:"tms",tiles:["{z}/{x}/{y}.terrain?v={version}"]},t),!0):yat(e,n,t)}}function nh(e){e=x(e,x.EMPTY_OBJECT),this._heightmapWidth=void 0,this._heightmapStructure=void 0,this._hasWaterMask=!1,this._hasVertexNormals=!1,this._hasMetadata=!1,this._scheme=void 0,this._ellipsoid=e.ellipsoid,this._requestVertexNormals=x(e.requestVertexNormals,!1),this._requestWaterMask=x(e.requestWaterMask,!1),this._requestMetadata=x(e.requestMetadata,!0),this._errorEvent=new me;let t=e.credit;typeof t=="string"&&(t=new wt(t)),this._credit=t,this._availability=void 0,this._tilingScheme=void 0,this._levelZeroMaximumGeometricError=void 0,this._layers=void 0,this._tileCredits=void 0}var gX={OCT_VERTEX_NORMALS:1,WATER_MASK:2,METADATA:4};function R0e(e){return!u(e)||e.length===0?{Accept:"application/vnd.quantized-mesh,application/octet-stream;q=0.9,*/*;q=0.01"}:{Accept:`application/vnd.quantized-mesh;extensions=${e.join("-")},application/octet-stream;q=0.9,*/*;q=0.01`}}function bat(e,t,n,i,o){let r=new Uint16Array(t,0,e._heightmapWidth*e._heightmapWidth);return new lc({buffer:r,childTileMask:new Uint8Array(t,r.byteLength,1)[0],waterMask:new Uint8Array(t,r.byteLength+1,t.byteLength-r.byteLength-1),width:e._heightmapWidth,height:e._heightmapWidth,structure:e._heightmapStructure,credits:e._tileCredits})}function Cat(e,t,n,i,o,r){let s=r.littleEndianExtensionSize,a=0,c=3,l=c+1,f=Float64Array.BYTES_PER_ELEMENT*c,d=Float64Array.BYTES_PER_ELEMENT*l,g=Uint16Array.BYTES_PER_ELEMENT*3,m=3,y=Uint16Array.BYTES_PER_ELEMENT,b=y*m,C=new DataView(t),A=new h(C.getFloat64(a,!0),C.getFloat64(a+8,!0),C.getFloat64(a+16,!0));a+=f;let T=C.getFloat32(a,!0);a+=Float32Array.BYTES_PER_ELEMENT;let E=C.getFloat32(a,!0);a+=Float32Array.BYTES_PER_ELEMENT;let v=new ae(new h(C.getFloat64(a,!0),C.getFloat64(a+8,!0),C.getFloat64(a+16,!0)),C.getFloat64(a+f,!0));a+=d;let D=new h(C.getFloat64(a,!0),C.getFloat64(a+8,!0),C.getFloat64(a+16,!0));a+=f;let O=C.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;let P=new Uint16Array(t,a,O*3);a+=O*g,O>64*1024&&(y=Uint32Array.BYTES_PER_ELEMENT,b=y*m);let M=P.subarray(0,O),L=P.subarray(O,2*O),_=P.subarray(O*2,3*O);Ln.zigZagDeltaDecode(M,L,_),a%y!==0&&(a+=y-a%y);let S=C.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;let w=Be.createTypedArrayFromArrayBuffer(O,t,a,S*m);a+=S*b;let I=0,N=w.length;for(let re=0;re<N;++re){let pe=w[re];w[re]=I-pe,pe===0&&++I}let k=C.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;let z=Be.createTypedArrayFromArrayBuffer(O,t,a,k);a+=k*y;let V=C.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;let U=Be.createTypedArrayFromArrayBuffer(O,t,a,V);a+=V*y;let B=C.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;let W=Be.createTypedArrayFromArrayBuffer(O,t,a,B);a+=B*y;let j=C.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;let Q=Be.createTypedArrayFromArrayBuffer(O,t,a,j);a+=j*y;let q,X;for(;a<C.byteLength;){let re=C.getUint8(a,!0);a+=Uint8Array.BYTES_PER_ELEMENT;let pe=C.getUint32(a,s);if(a+=Uint32Array.BYTES_PER_ELEMENT,re===gX.OCT_VERTEX_NORMALS&&e._requestVertexNormals)q=new Uint8Array(t,a,O*2);else if(re===gX.WATER_MASK&&e._requestWaterMask)X=new Uint8Array(t,a,pe);else if(re===gX.METADATA&&e._requestMetadata){let ye=C.getUint32(a,!0);if(ye>0){let Te=Uo(new Uint8Array(t),a+Uint32Array.BYTES_PER_ELEMENT,ye).available;if(u(Te))for(let Fe=0;Fe<Te.length;++Fe){let Ve=n+Fe+1,Ze=Te[Fe],gt=e._tilingScheme.getNumberOfYTilesAtLevel(Ve);for(let lt=0;lt<Ze.length;++lt){let Oe=Ze[lt],Mt=gt-Oe.endY-1,ut=gt-Oe.startY-1;e.availability.addAvailableTileRange(Ve,Oe.startX,Mt,Oe.endX,ut),r.availability.addAvailableTileRange(Ve,Oe.startX,Mt,Oe.endX,ut)}}}r.availabilityTilesLoaded.addAvailableTileRange(n,i,o,i,o)}a+=pe}let Z=e.getLevelMaximumGeometricError(n)*5,fe=e._tilingScheme.tileXYToRectangle(i,o,n),xe=wn.fromRectangle(fe,T,E,e._tilingScheme.ellipsoid);return new EE({center:A,minimumHeight:T,maximumHeight:E,boundingSphere:v,orientedBoundingBox:xe,horizonOcclusionPoint:D,quantizedVertices:P,encodedNormals:q,indices:w,westIndices:z,southIndices:U,eastIndices:W,northIndices:Q,westSkirtHeight:Z,southSkirtHeight:Z,eastSkirtHeight:Z,northSkirtHeight:Z,childTileMask:e.availability.computeChildMaskForTile(n,i,o),waterMask:X,credits:e._tileCredits})}nh.prototype.requestTileGeometry=function(e,t,n,i){let o=this._layers,r,s=o.length,a=!1,c=Promise.resolve();if(s===1)r=o[0];else for(let l=0;l<s;++l){let f=o[l];if(!u(f.availability)||f.availability.isTileAvailable(n,e,t)){r=f;break}let d=bX(this,e,t,n,f,l===0);d.result&&(a=!0,c=c.then(()=>d.promise))}return!u(r)&&a?c.then(()=>new Promise(l=>{setTimeout(()=>{let f=this.requestTileGeometry(e,t,n,i);l(f)},0)})):L0e(this,e,t,n,r,i)};function L0e(e,t,n,i,o,r){if(!u(o))return Promise.reject(new ce("Terrain tile doesn't exist"));let s=o.tileUrlTemplates;if(s.length===0)return;let a;!e._scheme||e._scheme==="tms"?a=e._tilingScheme.getNumberOfYTilesAtLevel(i)-n-1:a=n;let c=[];e._requestVertexNormals&&o.hasVertexNormals&&c.push(o.littleEndianExtensionSize?"octvertexnormals":"vertexnormals"),e._requestWaterMask&&o.hasWaterMask&&c.push("watermask"),e._requestMetadata&&o.hasMetadata&&c.push("metadata");let l,f,d=s[(t+a+i)%s.length],p=o.resource;u(p._ionEndpoint)&&!u(p._ionEndpoint.externalType)?(c.length!==0&&(f={extensions:c.join("-")}),l=R0e(void 0)):l=R0e(c);let g=p.getDerivedResource({url:d,templateValues:{version:o.version,z:i,x:t,y:a},queryParameters:f,headers:l,request:r}).fetchArrayBuffer();if(u(g))return g.then(function(m){return u(m)?u(e._heightmapStructure)?bat(e,m,i,t,n):Cat(e,m,i,t,n,o):Promise.reject(new ce("Mesh buffer doesn't exist."))})}Object.defineProperties(nh.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},hasWaterMask:{get:function(){return this._hasWaterMask&&this._requestWaterMask}},hasVertexNormals:{get:function(){return this._hasVertexNormals&&this._requestVertexNormals}},hasMetadata:{get:function(){return this._hasMetadata&&this._requestMetadata}},requestVertexNormals:{get:function(){return this._requestVertexNormals}},requestWaterMask:{get:function(){return this._requestWaterMask}},requestMetadata:{get:function(){return this._requestMetadata}},availability:{get:function(){return this._availability}}});nh.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)};nh.fromIonAssetId=async function(e,t){let n=await cf.fromAssetId(e);return nh.fromUrl(n,t)};nh.fromUrl=async function(e,t){t=x(t,x.EMPTY_OBJECT),e=await Promise.resolve(e);let n=De.createIfNeeded(e);n.appendForwardSlash();let i=new O0e(t);i.lastResource=n,i.layerJsonResource=i.lastResource.getDerivedResource({url:"layer.json"}),await xX(i);let o=new nh(t);return i.build(o),o};nh.prototype.getTileDataAvailable=function(e,t,n){if(!u(this._availability))return;if(n>this._availability._maximumLevel)return!1;if(this._availability.isTileAvailable(n,e,t))return!0;if(!this._hasMetadata)return!1;let i=this._layers,o=i.length;for(let r=0;r<o;++r)if(bX(this,e,t,n,i[r],r===0).result)return;return!1};nh.prototype.loadTileDataAvailability=function(e,t,n){if(!u(this._availability)||n>this._availability._maximumLevel||this._availability.isTileAvailable(n,e,t)||!this._hasMetadata)return;let i=this._layers,o=i.length;for(let r=0;r<o;++r){let s=bX(this,e,t,n,i[r],r===0);if(u(s.promise))return s.promise}};function yX(e,t,n,i){if(i===0)return;let o=e.availabilityLevels,r=i%o===0?i-o:(i/o|0)*o,s=1<<i-r,a=t/s|0,c=n/s|0;return{level:r,x:a,y:c}}function bX(e,t,n,i,o,r){if(!u(o.availabilityLevels))return{result:!1};let s,a=function(){delete o.availabilityPromiseCache[s]},c=o.availabilityTilesLoaded,l=o.availability,f=yX(o,t,n,i);for(;u(f);){if(l.isTileAvailable(f.level,f.x,f.y)&&!c.isTileAvailable(f.level,f.x,f.y)){let d;if(!r&&(s=`${f.level}-${f.x}-${f.y}`,d=o.availabilityPromiseCache[s],!u(d))){let p=new rr({throttle:!1,throttleByServer:!0,type:gs.TERRAIN});d=L0e(e,f.x,f.y,f.level,o,p),u(d)&&(o.availabilityPromiseCache[s]=d,d.then(a))}return{result:!0,promise:d}}f=yX(o,f.x,f.y,f.level)}return{result:!1}}nh._getAvailabilityTile=yX;var SE=nh;function d_(e){e=x(e,x.EMPTY_OBJECT);let t=e.radius,n={center:e.center,semiMajorAxis:t,semiMinorAxis:t,ellipsoid:e.ellipsoid,height:e.height,extrudedHeight:e.extrudedHeight,granularity:e.granularity,vertexFormat:e.vertexFormat,stRotation:e.stRotation,shadowVolume:e.shadowVolume};this._ellipseGeometry=new wl(n),this._workerName="createCircleGeometry"}d_.packedLength=wl.packedLength;d_.pack=function(e,t,n){return wl.pack(e._ellipseGeometry,t,n)};var N0e=new wl({center:new h,semiMajorAxis:1,semiMinorAxis:1}),Na={center:new h,radius:void 0,ellipsoid:ee.clone(ee.default),height:void 0,extrudedHeight:void 0,granularity:void 0,vertexFormat:new Ie,stRotation:void 0,semiMajorAxis:void 0,semiMinorAxis:void 0,shadowVolume:void 0};d_.unpack=function(e,t,n){let i=wl.unpack(e,t,N0e);return Na.center=h.clone(i._center,Na.center),Na.ellipsoid=ee.clone(i._ellipsoid,Na.ellipsoid),Na.ellipsoid=ee.clone(i._ellipsoid,N0e._ellipsoid),Na.height=i._height,Na.extrudedHeight=i._extrudedHeight,Na.granularity=i._granularity,Na.vertexFormat=Ie.clone(i._vertexFormat,Na.vertexFormat),Na.stRotation=i._stRotation,Na.shadowVolume=i._shadowVolume,u(n)?(Na.semiMajorAxis=i._semiMajorAxis,Na.semiMinorAxis=i._semiMinorAxis,n._ellipseGeometry=new wl(Na),n):(Na.radius=i._semiMajorAxis,new d_(Na))};d_.createGeometry=function(e){return wl.createGeometry(e._ellipseGeometry)};d_.createShadowVolume=function(e,t,n){let i=e._ellipseGeometry._granularity,o=e._ellipseGeometry._ellipsoid,r=t(i,o),s=n(i,o);return new d_({center:e._ellipseGeometry._center,radius:e._ellipseGeometry._semiMajorAxis,ellipsoid:o,stRotation:e._ellipseGeometry._stRotation,granularity:i,extrudedHeight:r,height:s,vertexFormat:Ie.POSITION_ONLY,shadowVolume:!0})};Object.defineProperties(d_.prototype,{rectangle:{get:function(){return this._ellipseGeometry.rectangle}},textureCoordinateRotationPoints:{get:function(){return this._ellipseGeometry.textureCoordinateRotationPoints}}});var F0e=d_;function vE(e){e=x(e,x.EMPTY_OBJECT);let t=e.radius,n={center:e.center,semiMajorAxis:t,semiMinorAxis:t,ellipsoid:e.ellipsoid,height:e.height,extrudedHeight:e.extrudedHeight,granularity:e.granularity,numberOfVerticalLines:e.numberOfVerticalLines};this._ellipseGeometry=new Bf(n),this._workerName="createCircleOutlineGeometry"}vE.packedLength=Bf.packedLength;vE.pack=function(e,t,n){return Bf.pack(e._ellipseGeometry,t,n)};var Aat=new Bf({center:new h,semiMajorAxis:1,semiMinorAxis:1}),Du={center:new h,radius:void 0,ellipsoid:ee.clone(ee.UNIT_SPHERE),height:void 0,extrudedHeight:void 0,granularity:void 0,numberOfVerticalLines:void 0,semiMajorAxis:void 0,semiMinorAxis:void 0};vE.unpack=function(e,t,n){let i=Bf.unpack(e,t,Aat);return Du.center=h.clone(i._center,Du.center),Du.ellipsoid=ee.clone(i._ellipsoid,Du.ellipsoid),Du.height=i._height,Du.extrudedHeight=i._extrudedHeight,Du.granularity=i._granularity,Du.numberOfVerticalLines=i._numberOfVerticalLines,u(n)?(Du.semiMajorAxis=i._semiMajorAxis,Du.semiMinorAxis=i._semiMinorAxis,n._ellipseGeometry=new Bf(Du),n):(Du.radius=i._semiMajorAxis,new vE(Du))};vE.createGeometry=function(e){return Bf.createGeometry(e._ellipseGeometry)};var B0e=vE;function Tat(e){return e=x(e,x.EMPTY_OBJECT),SE.fromIonAssetId(2426648,{requestVertexNormals:x(e.requestVertexNormals,!1)})}var HV=Tat;function Eat(e){return e=x(e,x.EMPTY_OBJECT),SE.fromIonAssetId(1,{requestVertexNormals:x(e.requestVertexNormals,!1),requestWaterMask:x(e.requestWaterMask,!1),ellipsoid:ee.WGS84})}var wE=Eat;function DE(e){e=x(e,x.EMPTY_OBJECT),this._callback=e.callback,this._tilingScheme=e.tilingScheme,u(this._tilingScheme)||(this._tilingScheme=new $i({ellipsoid:x(e.ellipsoid,ee.default)})),this._width=e.width,this._height=e.height;let t=Math.max(this._width,this._height);this._levelZeroMaximumGeometricError=ds.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,t,this._tilingScheme.getNumberOfXTilesAtLevel(0)),this._errorEvent=new me;let n=e.credit;typeof n=="string"&&(n=new wt(n)),this._credit=n}Object.defineProperties(DE.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){}},width:{get:function(){return this._width}},height:{get:function(){return this._height}}});DE.prototype.requestTileGeometry=function(e,t,n,i){let o=this._callback(e,t,n);if(!u(o))return;let r=this._width,s=this._height;return Promise.resolve(o).then(function(a){let c=a;return Array.isArray(c)&&(c=new Float64Array(c)),new lc({buffer:c,width:r,height:s})})};DE.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)};DE.prototype.getTileDataAvailable=function(e,t,n){};DE.prototype.loadTileDataAvailability=function(e,t,n){};var k0e=DE;var Sat=1953029805,vat=2917034100;function CX(e,t){if(CX.passThroughDataForTesting)return t;let n=e.byteLength;if(n===0||n%4!==0)throw new ce("The length of key must be greater than 0 and a multiple of 4.");let i=new DataView(t),o=i.getUint32(0,!0);if(o===Sat||o===vat)return t;let r=new DataView(e),s=0,a=t.byteLength,c=a-a%8,l=n,f,d=8;for(;s<c;)for(d=(d+8)%24,f=d;s<c&&f<l;)i.setUint32(s,i.getUint32(s,!0)^r.getUint32(f,!0),!0),i.setUint32(s+4,i.getUint32(s+4,!0)^r.getUint32(f+4,!0),!0),s+=8,f+=24;if(s<a)for(f>=l&&(d=(d+8)%24,f=d);s<a;)i.setUint8(s,i.getUint8(s)^r.getUint8(f)),s++,f++}CX.passThroughDataForTesting=!1;var GV=CX;function V0e(e){this.proxy=e}V0e.prototype.getURL=function(e){let t=this.proxy.indexOf("?")===-1?"?":"";return this.proxy+t+encodeURIComponent(e)};var U0e=V0e;function ih(e){this._comparator=e.comparator,this._maximumLength=e.maximumLength,this._array=u(e.maximumLength)?new Array(e.maximumLength):[],this._length=0}Object.defineProperties(ih.prototype,{length:{get:function(){return this._length}},maximumLength:{get:function(){return this._maximumLength},set:function(e){if(u(e)){for(;this._length>e;)this.removeMinimum();this._array.length=e}this._maximumLength=e}},internalArray:{get:function(){return this._array}},comparator:{get:function(){return this._comparator}}});ih.prototype.clone=function(){let e=this._maximumLength,t=this._comparator,n=this._array,i=this._length,o=new ih({comparator:t,maximumLength:e});o._length=i;for(let r=0;r<i;r++)o._array[r]=n[r];return o};ih.prototype.reset=function(){this._length=0;let e=this._maximumLength;if(u(e))for(let t=0;t<e;t++)this._array[t]=void 0;else this._array.length=0};ih.prototype.resort=function(){let e=this._length;for(let t=0;t<e;t++)z0e(this,t)};ih.prototype.insert=function(e){let t,n=this._maximumLength;if(u(n)){if(n===0)return;if(this._length===n){let o=this._array[0];if(this._comparator(e,o)<=0)return e;t=this.removeMinimum()}}let i=this._length;return this._array[i]=e,this._length++,z0e(this,i),t};ih.prototype.removeMinimum=function(){let e=this._length;if(e===0)return;this._length--;let t=this._array[0];return e>=2&&(this._array[0]=this._array[e-1],H0e(this,0)),this._array[e-1]=void 0,t};ih.prototype.removeMaximum=function(){let e=this._length;if(e===0)return;this._length--;let t;if(e<=2)t=this._array[e-1];else{let n=AX(this,1,2)?1:2;t=this._array[n],this._array[n]=this._array[e-1],e>=4&&H0e(this,n)}return this._array[e-1]=void 0,t};ih.prototype.getMinimum=function(){if(this._length!==0)return this._array[0]};ih.prototype.getMaximum=function(){let e=this._length;if(e!==0)return e<=2?this._array[e-1]:this._array[AX(this,1,2)?1:2]};function WV(e,t,n){let i=e._array,o=i[t];i[t]=i[n],i[n]=o}function CD(e,t,n){return e._comparator(e._array[t],e._array[n])<0}function AX(e,t,n){return e._comparator(e._array[t],e._array[n])>0}function z0e(e,t){if(t===0)return;let n=Math.floor(R.log2(t+1))%2===0,i=Math.floor((t-1)/2),o=CD(e,t,i);for(o!==n&&(WV(e,t,i),t=i);t>=3;){let r=Math.floor((t-3)/4);if(CD(e,t,r)!==o)break;WV(e,t,r),t=r}}function H0e(e,t){let n=e._length,i=Math.floor(R.log2(t+1))%2===0,o;for(;(o=2*t+1)<n;){let r=o,s=o+1;if(s<n){CD(e,s,r)===i&&(r=s);let a=2*o+1,c=Math.max(Math.min(n-a,4),0);for(let l=0;l<c;l++){let f=a+l;CD(e,f,r)===i&&(r=f)}}if(CD(e,r,t)===i&&(WV(e,r,t),r!==o&&r!==s)){let a=Math.floor((r-1)/2);AX(e,r,a)===i&&WV(e,r,a)}t=r}}var IE=ih;function PE(e){e=x(e,x.EMPTY_OBJECT),this._tilingScheme=e.tilingScheme,u(this._tilingScheme)||(this._tilingScheme=new $i({ellipsoid:x(e.ellipsoid,ee.default)})),this._levelZeroMaximumGeometricError=ds.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,64,this._tilingScheme.getNumberOfXTilesAtLevel(0)),this._errorEvent=new me}Object.defineProperties(PE.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){}}});PE.prototype.requestTileGeometry=function(e,t,n,i){return Promise.resolve(new lc({buffer:new Uint8Array(16*16),width:16,height:16}))};PE.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)};PE.prototype.getTileDataAvailable=function(e,t,n){};PE.prototype.loadTileDataAvailability=function(e,t,n){};var h_=PE;function Rm(e){e=x(e,x.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=x(e.near,1),this._near=this.near,this.far=x(e.far,5e8),this._far=this.far,this._cullingVolume=new bs,this._perspectiveMatrix=new F,this._infinitePerspective=new F}function TX(e){let{top:t,bottom:n,right:i,left:o,near:r,far:s}=e;(t!==e._top||n!==e._bottom||o!==e._left||i!==e._right||r!==e._near||s!==e._far)&&(e._left=o,e._right=i,e._top=t,e._bottom=n,e._near=r,e._far=s,e._perspectiveMatrix=F.computePerspectiveOffCenter(o,i,n,t,r,s,e._perspectiveMatrix),e._infinitePerspective=F.computeInfinitePerspectiveOffCenter(o,i,n,t,r,e._infinitePerspective))}Object.defineProperties(Rm.prototype,{projectionMatrix:{get:function(){return TX(this),this._perspectiveMatrix}},infiniteProjectionMatrix:{get:function(){return TX(this),this._infinitePerspective}}});var wat=new h,Dat=new h,Iat=new h,Pat=new h;Rm.prototype.computeCullingVolume=function(e,t,n){let i=this._cullingVolume.planes,o=this.top,r=this.bottom,s=this.right,a=this.left,c=this.near,l=this.far,f=h.cross(t,n,wat),d=Dat;h.multiplyByScalar(t,c,d),h.add(e,d,d);let p=Iat;h.multiplyByScalar(t,l,p),h.add(e,p,p);let g=Pat;h.multiplyByScalar(f,a,g),h.add(d,g,g),h.subtract(g,e,g),h.normalize(g,g),h.cross(g,n,g),h.normalize(g,g);let m=i[0];return u(m)||(m=i[0]=new oe),m.x=g.x,m.y=g.y,m.z=g.z,m.w=-h.dot(g,e),h.multiplyByScalar(f,s,g),h.add(d,g,g),h.subtract(g,e,g),h.cross(n,g,g),h.normalize(g,g),m=i[1],u(m)||(m=i[1]=new oe),m.x=g.x,m.y=g.y,m.z=g.z,m.w=-h.dot(g,e),h.multiplyByScalar(n,r,g),h.add(d,g,g),h.subtract(g,e,g),h.cross(f,g,g),h.normalize(g,g),m=i[2],u(m)||(m=i[2]=new oe),m.x=g.x,m.y=g.y,m.z=g.z,m.w=-h.dot(g,e),h.multiplyByScalar(n,o,g),h.add(d,g,g),h.subtract(g,e,g),h.cross(g,f,g),h.normalize(g,g),m=i[3],u(m)||(m=i[3]=new oe),m.x=g.x,m.y=g.y,m.z=g.z,m.w=-h.dot(g,e),m=i[4],u(m)||(m=i[4]=new oe),m.x=t.x,m.y=t.y,m.z=t.z,m.w=-h.dot(t,d),h.negate(t,g),m=i[5],u(m)||(m=i[5]=new oe),m.x=g.x,m.y=g.y,m.z=g.z,m.w=-h.dot(g,p),this._cullingVolume};Rm.prototype.getPixelDimensions=function(e,t,n,i,o){TX(this);let r=1/this.near,s=this.top*r,a=2*i*n*s/t;s=this.right*r;let c=2*i*n*s/e;return o.x=c,o.y=a,o};Rm.prototype.clone=function(e){return u(e)||(e=new Rm),e.right=this.right,e.left=this.left,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e};Rm.prototype.equals=function(e){return u(e)&&e instanceof Rm&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far};Rm.prototype.equalsEpsilon=function(e,t,n){return e===this||u(e)&&e instanceof Rm&&R.equalsEpsilon(this.right,e.right,t,n)&&R.equalsEpsilon(this.left,e.left,t,n)&&R.equalsEpsilon(this.top,e.top,t,n)&&R.equalsEpsilon(this.bottom,e.bottom,t,n)&&R.equalsEpsilon(this.near,e.near,t,n)&&R.equalsEpsilon(this.far,e.far,t,n)};var Ll=Rm;function Nl(e){e=x(e,x.EMPTY_OBJECT),this._offCenterFrustum=new Ll,this.fov=e.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=x(e.near,1),this._near=this.near,this.far=x(e.far,5e8),this._far=this.far,this.xOffset=x(e.xOffset,0),this._xOffset=this.xOffset,this.yOffset=x(e.yOffset,0),this._yOffset=this.yOffset}Nl.packedLength=6;Nl.pack=function(e,t,n){return n=x(n,0),t[n++]=e.fov,t[n++]=e.aspectRatio,t[n++]=e.near,t[n++]=e.far,t[n++]=e.xOffset,t[n]=e.yOffset,t};Nl.unpack=function(e,t,n){return t=x(t,0),u(n)||(n=new Nl),n.fov=e[t++],n.aspectRatio=e[t++],n.near=e[t++],n.far=e[t++],n.xOffset=e[t++],n.yOffset=e[t],n};function oh(e){if(!(e.fov!==e._fov||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far||e.xOffset!==e._xOffset||e.yOffset!==e._yOffset))return;e._aspectRatio=e.aspectRatio,e._fov=e.fov,e._fovy=e.aspectRatio<=1?e.fov:Math.atan(Math.tan(e.fov*.5)/e.aspectRatio)*2,e._near=e.near,e._far=e.far,e._sseDenominator=2*Math.tan(.5*e._fovy),e._xOffset=e.xOffset,e._yOffset=e.yOffset;let n=e._offCenterFrustum;n.top=e.near*Math.tan(.5*e._fovy),n.bottom=-n.top,n.right=e.aspectRatio*n.top,n.left=-n.right,n.near=e.near,n.far=e.far,n.right+=e.xOffset,n.left+=e.xOffset,n.top+=e.yOffset,n.bottom+=e.yOffset}Object.defineProperties(Nl.prototype,{projectionMatrix:{get:function(){return oh(this),this._offCenterFrustum.projectionMatrix}},infiniteProjectionMatrix:{get:function(){return oh(this),this._offCenterFrustum.infiniteProjectionMatrix}},fovy:{get:function(){return oh(this),this._fovy}},sseDenominator:{get:function(){return oh(this),this._sseDenominator}},offCenterFrustum:{get:function(){return oh(this),this._offCenterFrustum}}});Nl.prototype.computeCullingVolume=function(e,t,n){return oh(this),this._offCenterFrustum.computeCullingVolume(e,t,n)};Nl.prototype.getPixelDimensions=function(e,t,n,i,o){return oh(this),this._offCenterFrustum.getPixelDimensions(e,t,n,i,o)};Nl.prototype.clone=function(e){return u(e)||(e=new Nl),e.aspectRatio=this.aspectRatio,e.fov=this.fov,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._fov=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e};Nl.prototype.equals=function(e){return!u(e)||!(e instanceof Nl)?!1:(oh(this),oh(e),this.fov===e.fov&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))};Nl.prototype.equalsEpsilon=function(e,t,n){return!u(e)||!(e instanceof Nl)?!1:(oh(this),oh(e),R.equalsEpsilon(this.fov,e.fov,t,n)&&R.equalsEpsilon(this.aspectRatio,e.aspectRatio,t,n)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,t,n))};var Ri=Nl;var jV=0,Rat=1;function fb(e){let t=e.frustum,n=e.orientation,i=e.origin,o=x(e.vertexFormat,Ie.DEFAULT),r=x(e._drawNearPlane,!0),s,a;t instanceof Ri?(s=jV,a=Ri.packedLength):t instanceof sn&&(s=Rat,a=sn.packedLength),this._frustumType=s,this._frustum=t.clone(),this._origin=h.clone(i),this._orientation=Le.clone(n),this._drawNearPlane=r,this._vertexFormat=o,this._workerName="createFrustumGeometry",this.packedLength=2+a+h.packedLength+Le.packedLength+Ie.packedLength}fb.pack=function(e,t,n){n=x(n,0);let i=e._frustumType,o=e._frustum;return t[n++]=i,i===jV?(Ri.pack(o,t,n),n+=Ri.packedLength):(sn.pack(o,t,n),n+=sn.packedLength),h.pack(e._origin,t,n),n+=h.packedLength,Le.pack(e._orientation,t,n),n+=Le.packedLength,Ie.pack(e._vertexFormat,t,n),n+=Ie.packedLength,t[n]=e._drawNearPlane?1:0,t};var Oat=new Ri,Mat=new sn,Lat=new Le,Nat=new h,Fat=new Ie;fb.unpack=function(e,t,n){t=x(t,0);let i=e[t++],o;i===jV?(o=Ri.unpack(e,t,Oat),t+=Ri.packedLength):(o=sn.unpack(e,t,Mat),t+=sn.packedLength);let r=h.unpack(e,t,Nat);t+=h.packedLength;let s=Le.unpack(e,t,Lat);t+=Le.packedLength;let a=Ie.unpack(e,t,Fat);t+=Ie.packedLength;let c=e[t]===1;if(!u(n))return new fb({frustum:o,origin:r,orientation:s,vertexFormat:a,_drawNearPlane:c});let l=i===n._frustumType?n._frustum:void 0;return n._frustum=o.clone(l),n._frustumType=i,n._origin=h.clone(r,n._origin),n._orientation=Le.clone(s,n._orientation),n._vertexFormat=Ie.clone(a,n._vertexFormat),n._drawNearPlane=c,n};function RE(e,t,n,i,o,r,s,a){let c=e/3*2;for(let l=0;l<4;++l)u(t)&&(t[e]=r.x,t[e+1]=r.y,t[e+2]=r.z),u(n)&&(n[e]=s.x,n[e+1]=s.y,n[e+2]=s.z),u(i)&&(i[e]=a.x,i[e+1]=a.y,i[e+2]=a.z),e+=3;o[c]=0,o[c+1]=0,o[c+2]=1,o[c+3]=0,o[c+4]=1,o[c+5]=1,o[c+6]=0,o[c+7]=1}var Bat=new J,kat=new F,EX=new F,G0e=new h,W0e=new h,j0e=new h,Vat=new h,Uat=new h,zat=new h,W0=new Array(3),AD=new Array(4);AD[0]=new oe(-1,-1,1,1);AD[1]=new oe(1,-1,1,1);AD[2]=new oe(1,1,1,1);AD[3]=new oe(-1,1,1,1);var q0e=new Array(4);for(let e=0;e<4;++e)q0e[e]=new oe;fb._computeNearFarPlanes=function(e,t,n,i,o,r,s,a){let c=J.fromQuaternion(t,Bat),l=x(r,G0e),f=x(s,W0e),d=x(a,j0e);l=J.getColumn(c,0,l),f=J.getColumn(c,1,f),d=J.getColumn(c,2,d),h.normalize(l,l),h.normalize(f,f),h.normalize(d,d),h.negate(l,l);let p=F.computeView(e,d,f,l,kat),g,m,y=i.projectionMatrix;if(n===jV){let b=F.multiply(y,p,EX);m=F.inverse(b,EX)}else g=F.inverseTransformation(p,EX);u(m)?(W0[0]=i.near,W0[1]=i.far):(W0[0]=0,W0[1]=i.near,W0[2]=i.far);for(let b=0;b<2;++b)for(let C=0;C<4;++C){let A=oe.clone(AD[C],q0e[C]);if(u(m)){A=F.multiplyByVector(m,A,A);let T=1/A.w;h.multiplyByScalar(A,T,A),h.subtract(A,e,A),h.normalize(A,A);let E=h.dot(d,A);h.multiplyByScalar(A,W0[b]/E,A),h.add(A,e,A)}else{let T=i.offCenterFrustum;u(T)&&(i=T);let E=W0[b],v=W0[b+1];A.x=(A.x*(i.right-i.left)+i.left+i.right)*.5,A.y=(A.y*(i.top-i.bottom)+i.bottom+i.top)*.5,A.z=(A.z*(E-v)-E-v)*.5,A.w=1,F.multiplyByVector(g,A,A)}o[12*b+C*3]=A.x,o[12*b+C*3+1]=A.y,o[12*b+C*3+2]=A.z}};fb.createGeometry=function(e){let t=e._frustumType,n=e._frustum,i=e._origin,o=e._orientation,r=e._drawNearPlane,s=e._vertexFormat,a=r?6:5,c=new Float64Array(3*4*6);fb._computeNearFarPlanes(i,o,t,n,c);let l=3*4*2;c[l]=c[3*4],c[l+1]=c[3*4+1],c[l+2]=c[3*4+2],c[l+3]=c[0],c[l+4]=c[1],c[l+5]=c[2],c[l+6]=c[3*3],c[l+7]=c[3*3+1],c[l+8]=c[3*3+2],c[l+9]=c[3*7],c[l+10]=c[3*7+1],c[l+11]=c[3*7+2],l+=3*4,c[l]=c[3*5],c[l+1]=c[3*5+1],c[l+2]=c[3*5+2],c[l+3]=c[3],c[l+4]=c[4],c[l+5]=c[5],c[l+6]=c[0],c[l+7]=c[1],c[l+8]=c[2],c[l+9]=c[3*4],c[l+10]=c[3*4+1],c[l+11]=c[3*4+2],l+=3*4,c[l]=c[3],c[l+1]=c[4],c[l+2]=c[5],c[l+3]=c[3*5],c[l+4]=c[3*5+1],c[l+5]=c[3*5+2],c[l+6]=c[3*6],c[l+7]=c[3*6+1],c[l+8]=c[3*6+2],c[l+9]=c[3*2],c[l+10]=c[3*2+1],c[l+11]=c[3*2+2],l+=3*4,c[l]=c[3*2],c[l+1]=c[3*2+1],c[l+2]=c[3*2+2],c[l+3]=c[3*6],c[l+4]=c[3*6+1],c[l+5]=c[3*6+2],c[l+6]=c[3*7],c[l+7]=c[3*7+1],c[l+8]=c[3*7+2],c[l+9]=c[3*3],c[l+10]=c[3*3+1],c[l+11]=c[3*3+2],r||(c=c.subarray(3*4));let f=new hn({position:new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:c})});if(u(s.normal)||u(s.tangent)||u(s.bitangent)||u(s.st)){let p=u(s.normal)?new Float32Array(12*a):void 0,g=u(s.tangent)?new Float32Array(3*4*a):void 0,m=u(s.bitangent)?new Float32Array(3*4*a):void 0,y=u(s.st)?new Float32Array(2*4*a):void 0,b=G0e,C=W0e,A=j0e,T=h.negate(b,Vat),E=h.negate(C,Uat),v=h.negate(A,zat);l=0,r&&(RE(l,p,g,m,y,v,b,C),l+=3*4),RE(l,p,g,m,y,A,T,C),l+=3*4,RE(l,p,g,m,y,T,v,C),l+=3*4,RE(l,p,g,m,y,E,v,T),l+=3*4,RE(l,p,g,m,y,b,A,C),l+=3*4,RE(l,p,g,m,y,C,A,T),u(p)&&(f.normal=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:p})),u(g)&&(f.tangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:g})),u(m)&&(f.bitangent=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:m})),u(y)&&(f.st=new ve({componentDatatype:K.FLOAT,componentsPerAttribute:2,values:y}))}let d=new Uint16Array(6*a);for(let p=0;p<a;++p){let g=p*6,m=p*4;d[g]=m,d[g+1]=m+1,d[g+2]=m+2,d[g+3]=m,d[g+4]=m+2,d[g+5]=m+3}return new ft({attributes:f,indices:d,primitiveType:Ne.TRIANGLES,boundingSphere:ae.fromVertices(c)})};var OE=fb;var SX=0,Hat=1;function TD(e){let t=e.frustum,n=e.orientation,i=e.origin,o=x(e._drawNearPlane,!0),r,s;t instanceof Ri?(r=SX,s=Ri.packedLength):t instanceof sn&&(r=Hat,s=sn.packedLength),this._frustumType=r,this._frustum=t.clone(),this._origin=h.clone(i),this._orientation=Le.clone(n),this._drawNearPlane=o,this._workerName="createFrustumOutlineGeometry",this.packedLength=2+s+h.packedLength+Le.packedLength}TD.pack=function(e,t,n){n=x(n,0);let i=e._frustumType,o=e._frustum;return t[n++]=i,i===SX?(Ri.pack(o,t,n),n+=Ri.packedLength):(sn.pack(o,t,n),n+=sn.packedLength),h.pack(e._origin,t,n),n+=h.packedLength,Le.pack(e._orientation,t,n),n+=Le.packedLength,t[n]=e._drawNearPlane?1:0,t};var Gat=new Ri,Wat=new sn,jat=new Le,qat=new h;TD.unpack=function(e,t,n){t=x(t,0);let i=e[t++],o;i===SX?(o=Ri.unpack(e,t,Gat),t+=Ri.packedLength):(o=sn.unpack(e,t,Wat),t+=sn.packedLength);let r=h.unpack(e,t,qat);t+=h.packedLength;let s=Le.unpack(e,t,jat);t+=Le.packedLength;let a=e[t]===1;if(!u(n))return new TD({frustum:o,origin:r,orientation:s,_drawNearPlane:a});let c=i===n._frustumType?n._frustum:void 0;return n._frustum=o.clone(c),n._frustumType=i,n._origin=h.clone(r,n._origin),n._orientation=Le.clone(s,n._orientation),n._drawNearPlane=a,n};TD.createGeometry=function(e){let t=e._frustumType,n=e._frustum,i=e._origin,o=e._orientation,r=e._drawNearPlane,s=new Float64Array(3*4*2);OE._computeNearFarPlanes(i,o,t,n,s);let a=new hn({position:new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:s})}),c,l,f=r?2:1,d=new Uint16Array(8*(f+1)),p=r?0:1;for(;p<2;++p)c=r?p*8:0,l=p*4,d[c]=l,d[c+1]=l+1,d[c+2]=l+1,d[c+3]=l+2,d[c+4]=l+2,d[c+5]=l+3,d[c+6]=l+3,d[c+7]=l;for(p=0;p<2;++p)c=(f+p)*8,l=p*4,d[c]=l,d[c+1]=l+4,d[c+2]=l+1,d[c+3]=l+5,d[c+4]=l+2,d[c+5]=l+6,d[c+6]=l+3,d[c+7]=l+7;return new ft({attributes:a,indices:d,primitiveType:Ne.LINES,boundingSphere:ae.fromVertices(s)})};var qV=TD;function YV(){he.throwInstantiationError()}Object.defineProperties(YV.prototype,{credit:{get:he.throwInstantiationError}});YV.getCreditsFromResult=function(e){if(u(e.attributions))return e.attributions.map(wt.getIonCredit)};YV.prototype.geocode=he.throwInstantiationError;var ED=YV;var Yat={SEARCH:0,AUTOCOMPLETE:1},db=Object.freeze(Yat);function Y0e(){he.throwInstantiationError()}Y0e.createGeometry=function(e){he.throwInstantiationError()};var X0e=Y0e;function Xat(e,t,n){let i=new Uint8ClampedArray(e.buffer),o=new ImageData(i,t,n),r=document.createElement("canvas");return r.width=t,r.height=n,r.getContext("2d").putImageData(o,0,0),r}var XV=Xat;var ect=Dr(vX(),1);function Kat(e,t){return(e&t)!==0}var Qc=Kat;var Zat=[1,2,4,8],K0e=15,$at=16,Qat=64,Jat=128;function Om(e,t,n,i,o,r){this._bits=e,this.cnodeVersion=t,this.imageryVersion=n,this.terrainVersion=i,this.imageryProvider=o,this.terrainProvider=r,this.ancestorHasTerrain=!1,this.terrainState=void 0}Om.clone=function(e,t){return u(t)?(t._bits=e._bits,t.cnodeVersion=e.cnodeVersion,t.imageryVersion=e.imageryVersion,t.terrainVersion=e.terrainVersion,t.imageryProvider=e.imageryProvider,t.terrainProvider=e.terrainProvider):t=new Om(e._bits,e.cnodeVersion,e.imageryVersion,e.terrainVersion,e.imageryProvider,e.terrainProvider),t.ancestorHasTerrain=e.ancestorHasTerrain,t.terrainState=e.terrainState,t};Om.prototype.setParent=function(e){this.ancestorHasTerrain=e.ancestorHasTerrain||this.hasTerrain()};Om.prototype.hasSubtree=function(){return Qc(this._bits,$at)};Om.prototype.hasImagery=function(){return Qc(this._bits,Qat)};Om.prototype.hasTerrain=function(){return Qc(this._bits,Jat)};Om.prototype.hasChildren=function(){return Qc(this._bits,K0e)};Om.prototype.hasChild=function(e){return Qc(this._bits,Zat[e])};Om.prototype.getChildBitmask=function(){return this._bits&K0e};var KV=Om;function tct(e){let t=e.length,n=new ArrayBuffer(t),i=new Uint8Array(n);for(let o=0;o<t;++o)i[o]=e.charCodeAt(o);return n}var nct=tct(`E\xF4\xBD\vy\xE2jE"\x92,\xCDq\xF8IFgQ\0B%\xC6\xE8a,f)\b\xC64\xDCjb%y
wmi\xD6\xF0\x9Ck\x93\xA1\xBDNu\xE0A[\xDF@V\f\xD9\xBBr\x9B\x81|3S\xEEOl\xD4q\xB0{\xC0\x7FEVZ\xADwUe\v3\x92*\xACl5\xC50s\xF83>mF8J\xB4\xDD\xF0.\xDDu\xDA\x8CDt"\xFAa"\f3"So\xAF9D\v\x8C9\xD99L\xB9\xBF\x7F\xAB\\\x8CP_\x9F"ux\xE9\x07q\x91h;\xC1\xC4\x9B\x7F\xF0<VqH\x82'UfYNe\x98u\xA3aF}a?A\0\x9F\xD7\xB44M\xCE\x87F\xB0\xD5\xB8\x8A'{\x8B\xDC+\xBBMg0\xC8\xD1\xF6\\\x8FP\xFA[/F\x9Bn5/'C.\xEB
\f^\xA5s\x1Be4\xE5l.jC'c#U\xA9?q{gC}:\xAF\xCD\xE2TU\x9C\xFDK\xC6\xE2\x9F/(\xED\xCB\\\xC6-f\x07\x88\xA7;/*"N\xB0k.\xDD\r\x95}}G\xBAC\xB2\xB2+>M\xAA>}\xE6\xCEI\x89\xC6\xE6x\fa1-\xA4O\xA5~q \x88\xEC\r1\xE8N\v\0nPh}=\b\r\x95\xA6n\xA3h\x97$[k\xF3#\xF3\xB6s\xB3\r\v@\xC0\x9F\xD8Q]\xFA".j\xDFI\0\xB9\xA0wU\xC6\xEFj\xBF{GL\x7F\x83\xEE\xDC\xDCF\x85\xA9\xADS\x07+S4\x07\xFF\x94Y\xE48\xE81\x83N\xB9XFk\xCB-#\x86\x92p\x005\x88"\xCF1\xB2&/\xE7\xC3u-6,rt\xB0#G\xB7\xD3\xD1&\x857r\xE2\0\x8CD\xCF\xDA3-\xDE\`\x86i#i*|\xCDKQ\r\x95T9w.)\xEA\x1B\xA6P\xA2j\x8FoP\x99\\>T\xFB\xEFP[\v\x07E\x89m(w7\xDB\x8EJfJo\x99 \xE5p\xE2\xB9q~\fmI-z\xFEr\xC7\xF2Y0\x8F\xBB]s\xE5\xC9 \xEAx\xEC \x90\xF0\x8A\x7FB|G\`\xB0\xBD&\xB7q\xB6\xC7\x9F\xD13\x82=\xD3\xAB\xEEc\x99\xC8+S\xA0D\\q\xC6\xCCD2O<\xCA\xC0)=R\xD3aX\xA9}e\xB4\xDC\xCF\r\xF4=\xF1\b\xA9B\xDA#	\xD8\xBF^PI\xF8M\xC0\xCBGLO\xF7{+\xD8\xC51\x92;\xB5o\xDCl\r\x92\x88\xD1\x9E\xDB?\xE2\xE9\xDA_\xD4\x84\xE2FaZ\xDEU\xCF\xA4\0\xBE\xFD\xCEg\xF1Ji\x97\xE6 H\xD8]\x7F~\xAEq N\xAE\xC0V\xA9\x91<\x82r\xE7v\xEC)I\xD6]-\x83\xE3\xDB6\xA9;f\x97\x87j\xD5\xB6=P^R\xB9K\xC7sWx\xC9\xF4.Y\x07\x95\x93o\xD0KW>''\xC7\`\xDB;\xED\x9ASD>?\x8D\x92mw\xA2
\xEB?R\xA8\xC6U^1I7\x85\xF4\xC5&-\xA9\xBF\x8B'T\xDA\xC3j \xE5*x\xB0\xD6\x90pr\xAA\x8Bh\xBD\x88\xF7_H\xB1~\xC0XL?f\xF9>\xE1e\xC0p\xA7\xCF8i\xAF\xF0VldI\x9C'\xADxtO\xC2\x87\xDEV9\0\xDAw\v\xCB-\x1B\x89\xFB5O\xF5\bQ\`\xC1
ZGM&30x\xDA\xC0\x9CFG\xE2[y\`In7gS
>\xE9\xECF9\xB2\xF14\r\xC6\x84Sun\xE1\fY\xD9\xDE)\x85{II\xA5wy\xBEIV.6\xE7\v:\xBBOb{\xD2M1\x95/\xBD8{\xA8O!\xE1\xECFpv\x95})"x\x88
\x90\xDD\x9D\\\xDA\xDEQ\xCF\xF0\xFCYRe|3\xDF\xF3H\xDA\xBB*u\xDB\`\xB2\xD4\xFC\xED\x1B\xEC\x7F5\xA8\xFF(1\x07-\xC8\xDC\x88F|\x8A["`);function Iu(e){this.imageryPresent=!0,this.protoImagery=void 0,this.terrainPresent=!0,this.negativeAltitudeExponentBias=32,this.negativeAltitudeThreshold=R.EPSILON12,this.providers={},this.key=void 0,this._resource=void 0,this._quadPacketVersion=1,this._tileInfo={},this._subtreePromises={}}Object.defineProperties(Iu.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},resource:{get:function(){return this._resource}}});Iu.fromUrl=async function(e){let t=e;typeof t!="string"&&!(t instanceof De)&&(t=e.url);let n=De.createIfNeeded(t);n.appendForwardSlash();let i=new Iu;i._resource=n;try{await ict(i),await i.getQuadTreePacket("",i._quadPacketVersion)}catch(o){let r=`An error occurred while accessing ${$0e(i,"",1).url}: ${o}`;throw new ce(r)}return i};Iu.tileXYToQuadKey=function(e,t,n){let i="";for(let o=n;o>=0;--o){let r=1<<o,s=0;Qc(t,r)?Qc(e,r)&&(s|=1):(s|=2,Qc(e,r)||(s|=1)),i+=s}return i};Iu.quadKeyToTileXY=function(e){let t=0,n=0,i=e.length-1;for(let o=i;o>=0;--o){let r=1<<o,s=+e[i-o];Qc(s,2)?Qc(s,1)||(t|=r):(n|=r,Qc(s,1)&&(t|=r))}return{x:t,y:n,level:i}};Iu.prototype.isValid=function(e){let t=this.getTileInformationFromQuadKey(e);if(u(t))return t!==null;let n=!0,i=e,o;for(;i.length>1;)if(o=i.substring(i.length-1),i=i.substring(0,i.length-1),t=this.getTileInformationFromQuadKey(i),u(t)){!t.hasSubtree()&&!t.hasChild(parseInt(o))&&(n=!1);break}else if(t===null){n=!1;break}return n};var Z0e=new xi("decodeGoogleEarthEnterprisePacket");Iu.prototype.getQuadTreePacket=function(e,t,n){t=x(t,1),e=x(e,"");let o=$0e(this,e,t,n).fetchArrayBuffer();if(!u(o))return;let r=this._tileInfo,s=this.key;return o.then(function(a){return Z0e.scheduleTask({buffer:a,quadKey:e,type:"Metadata",key:s},[a]).then(function(l){let f,d=-1;if(e!==""){d=e.length+1;let m=l[e];f=r[e],f._bits|=m._bits,delete l[e]}let p=Object.keys(l);p.sort(function(m,y){return m.length-y.length});let g=p.length;for(let m=0;m<g;++m){let y=p[m];if(l[y]!==null){let C=KV.clone(l[y]),A=y.length;if(A===d)C.setParent(f);else if(A>1){let T=r[y.substring(0,y.length-1)];C.setParent(T)}r[y]=C}else r[y]=null}})})};Iu.prototype.populateSubtree=function(e,t,n,i){let o=Iu.tileXYToQuadKey(e,t,n);return IX(this,o,i)};function IX(e,t,n){let i=e._tileInfo,o=t,r=i[o];if(u(r)&&(!r.hasSubtree()||r.hasChildren()))return r;for(;r===void 0&&o.length>1;)o=o.substring(0,o.length-1),r=i[o];let s,a=e._subtreePromises,c=a[o];if(u(c))return c.then(function(){return s=new rr({throttle:n.throttle,throttleByServer:n.throttleByServer,type:n.type,priorityFunction:n.priorityFunction}),IX(e,t,s)});if(!u(r)||!r.hasSubtree())return Promise.reject(new ce(`Couldn't load metadata for tile ${t}`));if(c=e.getQuadTreePacket(o,r.cnodeVersion,n),!!u(c))return a[o]=c,c.then(function(){return s=new rr({throttle:n.throttle,throttleByServer:n.throttleByServer,type:n.type,priorityFunction:n.priorityFunction}),IX(e,t,s)}).finally(function(){delete a[o]})}Iu.prototype.getTileInformation=function(e,t,n){let i=Iu.tileXYToQuadKey(e,t,n);return this._tileInfo[i]};Iu.prototype.getTileInformationFromQuadKey=function(e){return this._tileInfo[e]};function $0e(e,t,n,i){return e._resource.getDerivedResource({url:`flatfile?q2-0${t}-q.${n.toString()}`,request:i})}var wX,DX;function ict(e){let t=e._resource.getDerivedResource({url:"dbRoot.v5",queryParameters:{output:"proto"}});if(!u(DX)){let n=on("ThirdParty/google-earth-dbroot-parser.js"),i=window.cesiumGoogleEarthDbRootParser;DX=aC(n).then(function(){wX=window.cesiumGoogleEarthDbRootParser(ect),u(i)?window.cesiumGoogleEarthDbRootParser=i:delete window.cesiumGoogleEarthDbRootParser})}return DX.then(function(){return t.fetchArrayBuffer()}).then(function(n){let i=wX.EncryptedDbRootProto.decode(new Uint8Array(n)),o=i.encryptionData,r=o.byteOffset,s=r+o.byteLength,a=e.key=o.buffer.slice(r,s);o=i.dbrootData,r=o.byteOffset,s=r+o.byteLength;let c=o.buffer.slice(r,s);return Z0e.scheduleTask({buffer:c,type:"DbRoot",key:a},[c])}).then(function(n){let i=wX.DbRootProto.decode(new Uint8Array(n.buffer));if(e.imageryPresent=x(i.imageryPresent,e.imageryPresent),e.protoImagery=i.protoImagery,e.terrainPresent=x(i.terrainPresent,e.terrainPresent),u(i.endSnippet)&&u(i.endSnippet.model)){let a=i.endSnippet.model;e.negativeAltitudeExponentBias=x(a.negativeAltitudeExponentBias,e.negativeAltitudeExponentBias),e.negativeAltitudeThreshold=x(a.compressedNegativeAltitudeThreshold,e.negativeAltitudeThreshold)}u(i.databaseVersion)&&(e._quadPacketVersion=x(i.databaseVersion.quadtreeVersion,e._quadPacketVersion));let o=e.providers,r=x(i.providerInfo,[]),s=r.length;for(let a=0;a<s;++a){let c=r[a],l=c.copyrightString;u(l)&&(o[c.providerId]=new wt(l.value))}}).catch(function(){console.log(`Failed to retrieve ${t.url}. Using defaults.`),e.key=nct})}var j0=Iu;function hb(e){e=x(e,x.EMPTY_OBJECT),this._buffer=e.buffer,this._credits=e.credits,this._negativeAltitudeExponentBias=e.negativeAltitudeExponentBias,this._negativeElevationThreshold=e.negativeElevationThreshold;let t=x(e.childTileMask,15),n=t&3;n|=t&4?8:0,n|=t&8?4:0,this._childTileMask=n,this._createdByUpsampling=x(e.createdByUpsampling,!1),this._skirtHeight=void 0,this._bufferType=this._buffer.constructor,this._mesh=void 0,this._minimumHeight=void 0,this._maximumHeight=void 0}Object.defineProperties(hb.prototype,{credits:{get:function(){return this._credits}},waterMask:{get:function(){}}});var eye="createVerticesFromGoogleEarthEnterpriseBuffer",oct=new xi(eye),rct=new xi(eye,Im.maximumAsynchronousTasks),Q0e=new se,PX=new se;hb.prototype.createMesh=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.tilingScheme,n=e.x,i=e.y,o=e.level,r=x(e.exaggeration,1),s=x(e.exaggerationRelativeHeight,0),a=x(e.throttle,!0),c=t.ellipsoid;t.tileXYToNativeRectangle(n,i,o,Q0e),t.tileXYToRectangle(n,i,o,PX);let l=c.cartographicToCartesian(se.center(PX)),d=40075.16/(1<<o);this._skirtHeight=Math.min(d*8,1e3);let g=(a?rct:oct).scheduleTask({buffer:this._buffer,nativeRectangle:Q0e,rectangle:PX,relativeToCenter:l,ellipsoid:c,skirtHeight:this._skirtHeight,exaggeration:r,exaggerationRelativeHeight:s,includeWebMercatorT:!0,negativeAltitudeExponentBias:this._negativeAltitudeExponentBias,negativeElevationThreshold:this._negativeElevationThreshold});if(!u(g))return;let m=this;return g.then(function(y){return m._mesh=new th(l,new Float32Array(y.vertices),new Uint16Array(y.indices),y.indexCountWithoutSkirts,y.vertexCountWithoutSkirts,y.minimumHeight,y.maximumHeight,ae.clone(y.boundingSphere3D),h.clone(y.occludeePointInScaledSpace),y.numberOfAttributes,wn.clone(y.orientedBoundingBox),Zc.clone(y.encoding),y.westIndicesSouthToNorth,y.southIndicesEastToWest,y.eastIndicesNorthToSouth,y.northIndicesWestToEast),m._minimumHeight=y.minimumHeight,m._maximumHeight=y.maximumHeight,m._buffer=void 0,m._mesh})};hb.prototype.interpolateHeight=function(e,t,n){let i=R.clamp((t-e.west)/e.width,0,1),o=R.clamp((n-e.south)/e.height,0,1);return u(this._mesh)?uct(this,i,o):hct(this,i,o,e)};var sct=new xi("upsampleQuantizedTerrainMesh",Im.maximumAsynchronousTasks);hb.prototype.upsample=function(e,t,n,i,o,r,s){let a=this._mesh;if(!u(this._mesh))return;let c=t*2!==o,l=n*2===r,f=e.ellipsoid,d=e.tileXYToRectangle(o,r,s),p=sct.scheduleTask({vertices:a.vertices,indices:a.indices,indexCountWithoutSkirts:a.indexCountWithoutSkirts,vertexCountWithoutSkirts:a.vertexCountWithoutSkirts,encoding:a.encoding,minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,isEastChild:c,isNorthChild:l,childRectangle:d,ellipsoid:f});if(!u(p))return;let g=this;return p.then(function(m){let y=new Uint16Array(m.vertices),b=Be.createTypedArray(y.length/3,m.indices),C=g._skirtHeight;return new EE({quantizedVertices:y,indices:b,minimumHeight:m.minimumHeight,maximumHeight:m.maximumHeight,boundingSphere:ae.clone(m.boundingSphere),orientedBoundingBox:wn.clone(m.orientedBoundingBox),horizonOcclusionPoint:h.clone(m.horizonOcclusionPoint),westIndices:m.westIndices,southIndices:m.southIndices,eastIndices:m.eastIndices,northIndices:m.northIndices,westSkirtHeight:C,southSkirtHeight:C,eastSkirtHeight:C,northSkirtHeight:C,childTileMask:0,createdByUpsampling:!0,credits:g._credits})})};hb.prototype.isChildAvailable=function(e,t,n,i){let o=2;return n!==e*2&&++o,i!==t*2&&(o-=2),(this._childTileMask&1<<o)!==0};hb.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};var act=new H,cct=new H,lct=new H,tye=new h;function uct(e,t,n){let i=e._mesh,o=i.vertices,r=i.encoding,s=i.indices;for(let a=0,c=s.length;a<c;a+=3){let l=s[a],f=s[a+1],d=s[a+2],p=r.decodeTextureCoordinates(o,l,act),g=r.decodeTextureCoordinates(o,f,cct),m=r.decodeTextureCoordinates(o,d,lct),y=H0.computeBarycentricCoordinates(t,n,p.x,p.y,g.x,g.y,m.x,m.y,tye);if(y.x>=-1e-15&&y.y>=-1e-15&&y.z>=-1e-15){let b=r.decodeHeight(o,l),C=r.decodeHeight(o,f),A=r.decodeHeight(o,d);return y.x*b+y.y*C+y.z*A}}}var fct=Uint16Array.BYTES_PER_ELEMENT,J0e=Uint32Array.BYTES_PER_ELEMENT,RX=Int32Array.BYTES_PER_ELEMENT,dct=Float32Array.BYTES_PER_ELEMENT,OX=Float64Array.BYTES_PER_ELEMENT;function hct(e,t,n,i){let o=e._buffer,r=0,s=0,a=0;n>.5?(t>.5?(r=2,s=.5):r=3,a=.5):t>.5&&(r=1,s=.5);let c=new DataView(o),l=0;for(let v=0;v<r;++v)l+=c.getUint32(l,!0),l+=J0e;l+=J0e,l+=2*OX;let f=R.toRadians(c.getFloat64(l,!0)*180);l+=OX;let d=R.toRadians(c.getFloat64(l,!0)*180);l+=OX;let p=i.width/f/2,g=i.height/d/2,m=c.getInt32(l,!0);l+=RX;let y=c.getInt32(l,!0)*3;l+=RX,l+=RX;let b=new Array(m),C=new Array(m),A=new Array(m),T;for(T=0;T<m;++T)b[T]=s+c.getUint8(l++)*p,C[T]=a+c.getUint8(l++)*g,A[T]=c.getFloat32(l,!0)*6371010,l+=dct;let E=new Array(y);for(T=0;T<y;++T)E[T]=c.getUint16(l,!0),l+=fct;for(T=0;T<y;T+=3){let v=E[T],D=E[T+1],O=E[T+2],P=b[v],M=b[D],L=b[O],_=C[v],S=C[D],w=C[O],I=H0.computeBarycentricCoordinates(t,n,P,_,M,S,L,w,tye);if(I.x>=-1e-15&&I.y>=-1e-15&&I.z>=-1e-15)return I.x*A[v]+I.y*A[D]+I.z*A[O]}}var SD=hb;var Gf={UNKNOWN:0,NONE:1,SELF:2,PARENT:3},ZV=new $;function $V(){this._terrainCache={},this._lastTidy=$.now()}$V.prototype.add=function(e,t){this._terrainCache[e]={buffer:t,timestamp:$.now()}};$V.prototype.get=function(e){let n=this._terrainCache[e];if(u(n))return delete this._terrainCache[e],n.buffer};$V.prototype.tidy=function(){if($.now(ZV),$.secondsDifference(ZV,this._lastTidy)>10){let e=this._terrainCache,t=Object.keys(e),n=t.length;for(let i=0;i<n;++i){let o=t[i],r=e[o];$.secondsDifference(ZV,r.timestamp)>10&&delete e[o]}$.clone(ZV,this._lastTidy)}};function q0(e){e=x(e,x.EMPTY_OBJECT),this._tilingScheme=new $i({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new se(-R.PI,-R.PI,R.PI,R.PI),ellipsoid:e.ellipsoid});let t=e.credit;typeof t=="string"&&(t=new wt(t)),this._credit=t,this._levelZeroMaximumGeometricError=40075.16,this._terrainCache=new $V,this._terrainPromises={},this._terrainRequests={},this._errorEvent=new me}Object.defineProperties(q0.prototype,{url:{get:function(){return this._metadata.url}},proxy:{get:function(){return this._metadata.proxy}},tilingScheme:{get:function(){return this._tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){}}});q0.fromMetadata=function(e,t){if(!e.terrainPresent)throw new ce(`The server ${e.url} doesn't have terrain`);let n=new q0(t);return n._metadata=e,n};var mct=new xi("decodeGoogleEarthEnterprisePacket");function nye(e,t,n){let i=t.getChildBitmask();if(t.terrainState===Gf.PARENT){i=0;for(let o=0;o<4;++o){let r=n.getTileInformationFromQuadKey(e+o.toString());u(r)&&r.hasTerrain()&&(i|=1<<o)}}return i}q0.prototype.requestTileGeometry=function(e,t,n,i){let o=j0.tileXYToQuadKey(e,t,n),r=this._terrainCache,s=this._metadata,a=s.getTileInformationFromQuadKey(o);if(!u(a))return Promise.reject(new ce("Terrain tile doesn't exist"));let c=a.terrainState;u(c)||(c=a.terrainState=Gf.UNKNOWN);let l=r.get(o);if(u(l)){let C=s.providers[a.terrainProvider];return Promise.resolve(new SD({buffer:l,childTileMask:nye(o,a,s),credits:u(C)?[C]:void 0,negativeAltitudeExponentBias:s.negativeAltitudeExponentBias,negativeElevationThreshold:s.negativeAltitudeThreshold}))}if(r.tidy(),a.ancestorHasTerrain){if(c===Gf.NONE)return Promise.reject(new ce("Terrain tile doesn't exist"))}else return Promise.resolve(new lc({buffer:new Uint8Array(16*16),width:16,height:16}));let f,d=o,p=-1;switch(c){case Gf.SELF:p=a.terrainVersion;break;case Gf.PARENT:d=d.substring(0,d.length-1),f=s.getTileInformationFromQuadKey(d),p=f.terrainVersion;break;case Gf.UNKNOWN:a.hasTerrain()?p=a.terrainVersion:(d=d.substring(0,d.length-1),f=s.getTileInformationFromQuadKey(d),u(f)&&f.hasTerrain()&&(p=f.terrainVersion));break}if(p<0)return Promise.reject(new ce("Terrain tile doesn't exist"));let g=this._terrainPromises,m=this._terrainRequests,y,b;if(u(g[d]))y=g[d],b=m[d];else{b=i;let C=pct(this,d,p,b).fetchArrayBuffer();if(!u(C))return;y=C.then(function(A){return u(A)?mct.scheduleTask({buffer:A,type:"Terrain",key:s.key},[A]).then(function(T){let E=s.getTileInformationFromQuadKey(d);E.terrainState=Gf.SELF,r.add(d,T[0]);let v=E.terrainProvider,D=T.length-1;for(let O=0;O<D;++O){let P=d+O.toString(),M=s.getTileInformationFromQuadKey(P);u(M)&&(r.add(P,T[O+1]),M.terrainState=Gf.PARENT,M.terrainProvider===0&&(M.terrainProvider=v))}}):Promise.reject(new ce("Failed to load terrain."))}),g[d]=y,m[d]=b,y=y.finally(function(){delete g[d],delete m[d]})}return y.then(function(){let C=r.get(o);if(u(C)){let A=s.providers[a.terrainProvider];return new SD({buffer:C,childTileMask:nye(o,a,s),credits:u(A)?[A]:void 0,negativeAltitudeExponentBias:s.negativeAltitudeExponentBias,negativeElevationThreshold:s.negativeAltitudeThreshold})}return Promise.reject(new ce("Failed to load terrain."))}).catch(function(C){return b.state===$n.CANCELLED?(i.state=b.state,Promise.reject(C)):(a.terrainState=Gf.NONE,Promise.reject(C))})};q0.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)};q0.prototype.getTileDataAvailable=function(e,t,n){let i=this._metadata,o=j0.tileXYToQuadKey(e,t,n),r=i.getTileInformation(e,t,n);if(r===null)return!1;if(u(r)){if(!r.ancestorHasTerrain)return!0;let s=r.terrainState;if(s===Gf.NONE)return!1;if((!u(s)||s===Gf.UNKNOWN)&&(r.terrainState=Gf.UNKNOWN,!r.hasTerrain())){o=o.substring(0,o.length-1);let a=i.getTileInformationFromQuadKey(o);if(!u(a)||!a.hasTerrain())return!1}return!0}if(i.isValid(o)){let s=new rr({throttle:!1,throttleByServer:!0,type:gs.TERRAIN});i.populateSubtree(e,t,n,s)}return!1};q0.prototype.loadTileDataAvailability=function(e,t,n){};function pct(e,t,n,i){return n=u(n)&&n>0?n:1,e._metadata.resource.getDerivedResource({url:`flatfile?f1c-0${t}-t.${n.toString()}`,request:i})}var iye=q0;var QV={};QV.defaultApiKey=void 0;QV.mapTilesApiEndpoint=new De({url:"https://tile.googleapis.com/v1/"});QV.getDefaultCredit=function(){return new wt('<img src="https://assets.ion.cesium.com/google-credit.png" style="vertical-align: -5px" alt="Google">',!0)};var ME=QV;function _ct(e,t,n,i){this.rightAscension=e,this.declination=t,this.rotation=n,this.rotationRate=i}var JV=_ct;var gye={},gct=32.184,yct=2451545,oye=-.0529921,rye=-.1059842,sye=13.0120009,aye=13.3407154,cye=.9856003,lye=26.4057084,uye=13.064993,fye=.3287146,dye=1.7484877,hye=-.1589763,mye=.0036096,pye=.1643573,_ye=12.9590088,MX=new $;gye.ComputeMoon=function(e,t){u(e)||(e=$.now()),MX=$.addSeconds(e,gct,MX);let n=$.totalDays(MX)-yct,i=n/Yn.DAYS_PER_JULIAN_CENTURY,o=(125.045+oye*n)*R.RADIANS_PER_DEGREE,r=(250.089+rye*n)*R.RADIANS_PER_DEGREE,s=(260.008+sye*n)*R.RADIANS_PER_DEGREE,a=(176.625+aye*n)*R.RADIANS_PER_DEGREE,c=(357.529+cye*n)*R.RADIANS_PER_DEGREE,l=(311.589+lye*n)*R.RADIANS_PER_DEGREE,f=(134.963+uye*n)*R.RADIANS_PER_DEGREE,d=(276.617+fye*n)*R.RADIANS_PER_DEGREE,p=(34.226+dye*n)*R.RADIANS_PER_DEGREE,g=(15.134+hye*n)*R.RADIANS_PER_DEGREE,m=(119.743+mye*n)*R.RADIANS_PER_DEGREE,y=(239.961+pye*n)*R.RADIANS_PER_DEGREE,b=(25.053+_ye*n)*R.RADIANS_PER_DEGREE,C=Math.sin(o),A=Math.sin(r),T=Math.sin(s),E=Math.sin(a),v=Math.sin(c),D=Math.sin(l),O=Math.sin(f),P=Math.sin(d),M=Math.sin(p),L=Math.sin(g),_=Math.sin(m),S=Math.sin(y),w=Math.sin(b),I=Math.cos(o),N=Math.cos(r),k=Math.cos(s),z=Math.cos(a),V=Math.cos(c),U=Math.cos(l),B=Math.cos(f),W=Math.cos(d),j=Math.cos(p),Q=Math.cos(g),q=Math.cos(m),X=Math.cos(y),Z=Math.cos(b),fe=(269.9949+.0031*i-3.8787*C-.1204*A+.07*T-.0172*E+.0072*D-.0052*L+.0043*w)*R.RADIANS_PER_DEGREE,xe=(66.5392+.013*i+1.5419*I+.0239*N-.0278*k+.0068*z-.0029*U+9e-4*B+8e-4*Q-9e-4*Z)*R.RADIANS_PER_DEGREE,re=(38.3213+13.17635815*n-14e-13*n*n+3.561*C+.1208*A-.0642*T+.0158*E+.0252*v-.0066*D-.0047*O-.0046*P+.0028*M+.0052*L+.004*_+.0019*S-.0044*w)*R.RADIANS_PER_DEGREE,pe=(13.17635815-14e-13*(2*n)+3.561*I*oye+.1208*N*rye-.0642*k*sye+.0158*z*aye+.0252*V*cye-.0066*U*lye-.0047*B*uye-.0046*W*fye+.0028*j*dye+.0052*Q*hye+.004*q*mye+.0019*X*pye-.0044*Z*_ye)/86400*R.RADIANS_PER_DEGREE;return u(t)||(t=new JV),t.rightAscension=fe,t.declination=xe,t.rotation=re,t.rotationRate=pe,t};var eU=gye;function yye(e){(!u(e)||typeof e!="function")&&(e=eU.ComputeMoon),this._computeFunction=e}var xct=new h,bct=new h,Cct=new h;function Act(e,t,n){let i=xct;i.x=Math.cos(e+R.PI_OVER_TWO),i.y=Math.sin(e+R.PI_OVER_TWO),i.z=0;let o=Math.cos(t),r=Cct;r.x=o*Math.cos(e),r.y=o*Math.sin(e),r.z=Math.sin(t);let s=h.cross(r,i,bct);return u(n)||(n=new J),n[0]=i.x,n[1]=s.x,n[2]=r.x,n[3]=i.y,n[4]=s.y,n[5]=r.y,n[6]=i.z,n[7]=s.z,n[8]=r.z,n}var Tct=new J,Ect=new Le;yye.prototype.evaluate=function(e,t){u(e)||(e=$.now());let n=this._computeFunction(e),i=Act(n.rightAscension,n.declination,t),o=R.zeroToTwoPi(n.rotation),r=Le.fromAxisAngle(h.UNIT_Z,o,Ect),s=J.fromQuaternion(Le.conjugate(r,r),Tct);return J.multiply(s,i,i)};var tU=yye;var vD={};vD.type=void 0;vD.getRequiredDataPoints=he.throwInstantiationError;vD.interpolateOrderZero=he.throwInstantiationError;vD.interpolate=he.throwInstantiationError;var xye=vD;function LX(e){this._url=De.createIfNeeded(e),this._url.appendForwardSlash()}Object.defineProperties(LX.prototype,{url:{get:function(){return this._url}},credit:{get:function(){}}});LX.prototype.geocode=async function(e,t){return this._url.getDerivedResource({url:t===db.AUTOCOMPLETE?"autocomplete":"search",queryParameters:{text:e}}).fetchJson().then(function(i){return i.features.map(function(o){let r,s=o.bbox;if(u(s))r=se.fromDegrees(s[0],s[1],s[2],s[3]);else{let a=o.geometry.coordinates[0],c=o.geometry.coordinates[1];r=h.fromDegrees(a,c)}return{displayName:o.properties.label,destination:r,attributions:i.attributions}})})};var nU=LX;function NX(e){e=x(e,x.EMPTY_OBJECT);let t=x(e.accessToken,Vh.defaultAccessToken),n=De.createIfNeeded(x(e.server,Vh.defaultServer));n.appendForwardSlash();let i=Vh.getDefaultTokenCredit(t);u(i)&&e.scene.frameState.creditDisplay.addStaticCredit(wt.clone(i));let o=n.getDerivedResource({url:"v1/geocode"});u(t)&&o.appendQueryParameters({access_token:t}),this._accessToken=t,this._server=n,this._pelias=new nU(o)}Object.defineProperties(NX.prototype,{credit:{get:function(){}}});NX.prototype.geocode=async function(e,t){return this._pelias.geocode(e,t)};var iU=NX;var Sct={SHIFT:0,CTRL:1,ALT:2},_a=Object.freeze(Sct);function oU(){he.throwInstantiationError()}Object.defineProperties(oU.prototype,{ellipsoid:{get:he.throwInstantiationError}});oU.prototype.project=he.throwInstantiationError;oU.prototype.unproject=he.throwInstantiationError;var bye=oU;var FX=[],BX=[];function vct(e,t,n,i,o,r){let s=o-i+1,a=r-o,c=FX,l=BX,f,d;for(f=0;f<s;++f)c[f]=e[i+f];for(d=0;d<a;++d)l[d]=e[o+d+1];f=0,d=0;for(let p=i;p<=r;++p){let g=c[f],m=l[d];f<s&&(d>=a||t(g,m,n)<=0)?(e[p]=g,++f):d<a&&(e[p]=m,++d)}}function kX(e,t,n,i,o){if(i>=o)return;let r=Math.floor((i+o)*.5);kX(e,t,n,i,r),kX(e,t,n,r+1,o),vct(e,t,n,i,r,o)}function wct(e,t,n){let i=e.length,o=Math.ceil(i*.5);FX.length=o,BX.length=o,kX(e,t,n,0,i-1),FX.length=0,BX.length=0}var Y0=wct;function LE(e){e=x(e,x.EMPTY_OBJECT);let t=e.weights,n=e.times;this._times=n,this._weights=t,this._count=t.length/n.length,this._lastTimeIndex=0}Object.defineProperties(LE.prototype,{times:{get:function(){return this._times}},weights:{get:function(){return this._weights}}});LE.prototype.findTimeInterval=ao.prototype.findTimeInterval;LE.prototype.wrapTime=ao.prototype.wrapTime;LE.prototype.clampTime=ao.prototype.clampTime;LE.prototype.evaluate=function(e,t){let n=this.weights,i=this.times,o=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex),r=(e-i[o])/(i[o+1]-i[o]);u(t)||(t=new Array(this._count));for(let s=0;s<this._count;s++){let a=o*this._count+s;t[s]=n[a]*(1-r)+n[a+this._count]*r}return t};var Cye=LE;var Dct={NONE:-1,PARTIAL:0,FULL:1},Sr=Object.freeze(Dct);function uc(e,t){this._occluderPosition=h.clone(e.center),this._occluderRadius=e.radius,this._horizonDistance=0,this._horizonPlaneNormal=void 0,this._horizonPlanePosition=void 0,this._cameraPosition=void 0,this.cameraPosition=t}var rU=new h;Object.defineProperties(uc.prototype,{position:{get:function(){return this._occluderPosition}},radius:{get:function(){return this._occluderRadius}},cameraPosition:{set:function(e){e=h.clone(e,this._cameraPosition);let t=h.subtract(this._occluderPosition,e,rU),n=h.magnitudeSquared(t),i=this._occluderRadius*this._occluderRadius,o,r,s;if(n>i){o=Math.sqrt(n-i),n=1/Math.sqrt(n),r=h.multiplyByScalar(t,n,rU);let a=o*o*n;s=h.add(e,h.multiplyByScalar(r,a,rU),rU)}else o=Number.MAX_VALUE;this._horizonDistance=o,this._horizonPlaneNormal=r,this._horizonPlanePosition=s,this._cameraPosition=e}}});uc.fromBoundingSphere=function(e,t,n){return u(n)?(h.clone(e.center,n._occluderPosition),n._occluderRadius=e.radius,n.cameraPosition=t,n):new uc(e,t)};var Tye=new h;uc.prototype.isPointVisible=function(e){if(this._horizonDistance!==Number.MAX_VALUE){let t=h.subtract(e,this._occluderPosition,Tye),n=this._occluderRadius;if(n=h.magnitudeSquared(t)-n*n,n>0)return n=Math.sqrt(n)+this._horizonDistance,t=h.subtract(e,this._cameraPosition,t),n*n>h.magnitudeSquared(t)}return!1};var Ict=new h;uc.prototype.isBoundingSphereVisible=function(e){let t=h.clone(e.center,Ict),n=e.radius;if(this._horizonDistance!==Number.MAX_VALUE){let i=h.subtract(t,this._occluderPosition,Tye),o=this._occluderRadius-n;if(o=h.magnitudeSquared(i)-o*o,n<this._occluderRadius)return o>0?(o=Math.sqrt(o)+this._horizonDistance,i=h.subtract(t,this._cameraPosition,i),o*o+n*n>h.magnitudeSquared(i)):!1;if(o>0){i=h.subtract(t,this._cameraPosition,i);let r=h.magnitudeSquared(i),s=this._occluderRadius*this._occluderRadius,a=n*n;return(this._horizonDistance*this._horizonDistance+s)*a>r*s?!0:(o=Math.sqrt(o)+this._horizonDistance,o*o+a>r)}return!0}return!1};var Pct=new h;uc.prototype.computeVisibility=function(e){let t=h.clone(e.center),n=e.radius;if(n>this._occluderRadius)return Sr.FULL;if(this._horizonDistance!==Number.MAX_VALUE){let i=h.subtract(t,this._occluderPosition,Pct),o=this._occluderRadius-n,r=h.magnitudeSquared(i);if(o=r-o*o,o>0){o=Math.sqrt(o)+this._horizonDistance,i=h.subtract(t,this._cameraPosition,i);let s=h.magnitudeSquared(i);return o*o+n*n<s?Sr.NONE:(o=this._occluderRadius+n,o=r-o*o,o>0?(o=Math.sqrt(o)+this._horizonDistance,s<o*o+n*n?Sr.FULL:Sr.PARTIAL):(i=h.subtract(t,this._horizonPlanePosition,i),h.dot(i,this._horizonPlaneNormal)>-n?Sr.PARTIAL:Sr.FULL))}}return Sr.NONE};var sU=new h;uc.computeOccludeePoint=function(e,t,n){let i=h.clone(t),o=h.clone(e.center),r=e.radius,s=n.length,a=h.normalize(h.subtract(i,o,sU),sU),c=-h.dot(a,o),l=uc._anyRotationVector(o,a,c),f=uc._horizonToPlaneNormalDotProduct(e,a,c,l,n[0]);if(!f)return;let d;for(let g=1;g<s;++g){if(d=uc._horizonToPlaneNormalDotProduct(e,a,c,l,n[g]),!d)return;d<f&&(f=d)}if(f<.0017453283658983088)return;let p=r/f;return h.add(o,h.multiplyByScalar(a,p,sU),sU)};var Rct=[];uc.computeOccludeePointFromRectangle=function(e,t){t=x(t,ee.default);let n=se.subsample(e,t,0,Rct),i=ae.fromPoints(n),o=h.ZERO;if(!h.equals(o,i.center))return uc.computeOccludeePoint(new ae(o,t.minimumRadius),i.center,n)};var Oct=new h;uc._anyRotationVector=function(e,t,n){let i=h.abs(t,Oct),o=i.x>i.y?0:1;(o===0&&i.z>i.x||o===1&&i.z>i.y)&&(o=2);let r=new h,s;o===0?(i.x=e.x,i.y=e.y+1,i.z=e.z+1,s=h.UNIT_X):o===1?(i.x=e.x+1,i.y=e.y,i.z=e.z+1,s=h.UNIT_Y):(i.x=e.x+1,i.y=e.y+1,i.z=e.z,s=h.UNIT_Z);let a=(h.dot(t,i)+n)/-h.dot(t,s);return h.normalize(h.subtract(h.add(i,h.multiplyByScalar(s,a,r),i),e,i),i)};var Mct=new h;uc._rotationVector=function(e,t,n,i,o){let r=h.subtract(i,e,Mct);if(r=h.normalize(r,r),h.dot(t,r)<.9999999847691291){let s=h.cross(t,r,r);if(h.magnitude(s)>R.EPSILON13)return h.normalize(s,new h)}return o};var VX=new h,Lct=new h,aU=new h,Aye=new h;uc._horizonToPlaneNormalDotProduct=function(e,t,n,i,o){let r=h.clone(o,VX),s=h.clone(e.center,Lct),a=e.radius,c=h.subtract(s,r,aU),l=h.magnitudeSquared(c),f=a*a;if(l<f)return!1;let d=l-f,p=Math.sqrt(d),m=1/Math.sqrt(l),b=p*m*p;c=h.normalize(c,c);let C=h.add(r,h.multiplyByScalar(c,b,Aye),Aye),A=Math.sqrt(d-b*b),T=this._rotationVector(s,t,n,r,i),E=h.fromElements(T.x*T.x*c.x+(T.x*T.y-T.z)*c.y+(T.x*T.z+T.y)*c.z,(T.x*T.y+T.z)*c.x+T.y*T.y*c.y+(T.y*T.z-T.x)*c.z,(T.x*T.z-T.y)*c.x+(T.y*T.z+T.x)*c.y+T.z*T.z*c.z,VX);E=h.normalize(E,E);let v=h.multiplyByScalar(E,A,VX);T=h.normalize(h.subtract(h.add(C,v,aU),s,aU),aU);let D=h.dot(t,T);T=h.normalize(h.subtract(h.subtract(C,v,T),s,T),T);let O=h.dot(t,T);return D<O?D:O};var cU=uc;function UX(e,t,n){e=De.createIfNeeded(e),e.appendForwardSlash(),e.setQueryParameters({key:t}),this._url=e,this._params=x(n,{}),this._credit=new wt('Geodata copyright <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',!1)}Object.defineProperties(UX.prototype,{url:{get:function(){return this._url}},params:{get:function(){return this._params}},credit:{get:function(){return this._credit}}});UX.prototype.geocode=async function(e){return this._url.getDerivedResource({url:"json",queryParameters:bt(this._params,{q:e})}).fetchJson().then(function(n){return n.results.map(function(i){let o,r=i.bounds;if(u(r))o=se.fromDegrees(r.southwest.lng,r.southwest.lat,r.northeast.lng,r.northeast.lat);else{let s=i.geometry.lat,a=i.geometry.lng;o=h.fromDegrees(s,a)}return{displayName:i.formatted,destination:o}})})};var Eye=UX;var Nct={packedLength:void 0,pack:he.throwInstantiationError,unpack:he.throwInstantiationError},Sye=Nct;var Fct={packedInterpolationLength:void 0,convertPackedArrayForInterpolation:he.throwInstantiationError,unpackInterpolationResult:he.throwInstantiationError},vye=Fct;var Bct=new h;function kct(e,t,n,i){let o=gC(e,t,n,i,Bct);return u(o)?o.x>0&&o.y>0&&o.z>0:!1}var wye=kct;function Dye(){he.throwInstantiationError()}Dye.prototype.getURL=he.throwInstantiationError;var Iye=Dye;async function Vct(e,t,n,i){return u(i)||(i=!1),Hct(e,t,n,i)}function Uct(e,t,n){let i=e[0],o=i.terrainProvider.requestTileGeometry(i.x,i.y,i.level);if(!o)return!1;let r;return n?r=o.then(Rye(i)):r=o.then(Rye(i)).catch(Gct(i)),e.shift(),t.push(r),!0}function zct(e){return new Promise(function(t){setTimeout(t,e)})}function zX(e,t,n){return e.length?Uct(e,t,n)?zX(e,t,n):zct(100).then(()=>zX(e,t,n)):Promise.resolve()}function Hct(e,t,n,i){let o=e.tilingScheme,r,s=[],a={};for(r=0;r<n.length;++r){let l=o.positionToTileXY(n[r],t);if(!u(l))continue;let f=l.toString();if(!a.hasOwnProperty(f)){let d={x:l.x,y:l.y,level:t,tilingScheme:o,terrainProvider:e,positions:[]};a[f]=d,s.push(d)}a[f].positions.push(n[r])}let c=[];return zX(s,c,i).then(function(){return Promise.all(c).then(function(){return n})})}function Pye(e,t,n){let i=t.interpolateHeight(n,e.longitude,e.latitude);return i===void 0?!1:(e.height=i,!0)}function Rye(e){let t=e.positions,n=e.tilingScheme.tileXYToRectangle(e.x,e.y,e.level);return function(i){let o=!1;for(let r=0;r<t.length;++r){let s=t[r];if(!Pye(s,i,n)){o=!0;break}}return o?i.createMesh({tilingScheme:e.tilingScheme,x:e.x,y:e.y,level:e.level,throttle:!1}).then(function(){for(let r=0;r<t.length;++r){let s=t[r];Pye(s,i,n)}}):Promise.resolve()}}function Gct(e){let t=e.positions;return function(){for(let n=0;n<t.length;++n){let i=t[n];i.height=void 0}}}var lU=Vct;var HX=new H;async function Oye(e,t,n){u(n)||(n=!1);let i=[],o=[],r=e.availability,s=[];for(let c=0;c<t.length;++c){let l=t[c],f=r.computeMaximumLevelAtPosition(l);if(o[c]=f,f===0){e.tilingScheme.positionToTileXY(l,1,HX);let p=e.loadTileDataAvailability(HX.x,HX.y,1);u(p)&&s.push(p)}let d=i[f];u(d)||(i[f]=d=[]),d.push(l)}await Promise.all(s),await Promise.all(i.map(function(c,l){if(u(c))return lU(e,l,c,n)}));let a=[];for(let c=0;c<t.length;++c){let l=t[c];r.computeMaximumLevelAtPosition(l)!==o[c]&&a.push(l)}return a.length>0&&await Oye(e,a,n),t}var NE=Oye;var Wct={LEFT_DOWN:0,LEFT_UP:1,LEFT_CLICK:2,LEFT_DOUBLE_CLICK:3,RIGHT_DOWN:5,RIGHT_UP:6,RIGHT_CLICK:7,MIDDLE_DOWN:10,MIDDLE_UP:11,MIDDLE_CLICK:12,MOUSE_MOVE:15,WHEEL:16,PINCH_START:17,PINCH_END:18,PINCH_MOVE:19},Cn=Object.freeze(Wct);function X0(e,t,n){let i=e._element;if(i===document)return n.x=t.clientX,n.y=t.clientY,n;let o=i.getBoundingClientRect();return n.x=t.clientX-o.left,n.y=t.clientY-o.top,n}function XX(e,t){let n=e;return u(t)&&(n+=`+${t}`),n}function mb(e){if(e.shiftKey)return _a.SHIFT;if(e.ctrlKey)return _a.CTRL;if(e.altKey)return _a.ALT}var ws={LEFT:0,MIDDLE:1,RIGHT:2};function Pu(e,t,n,i){function o(r){i(e,r)}Wt.isInternetExplorer()?n.addEventListener(t,o,!1):n.addEventListener(t,o,{capture:!1,passive:!1}),e._removalFunctions.push(function(){n.removeEventListener(t,o,!1)})}function jct(e){let t=e._element,n=u(t.disableRootEvents)?t:document;Wt.supportsPointerEvents()?(Pu(e,"pointerdown",t,$ct),Pu(e,"pointerup",t,Hye),Pu(e,"pointermove",t,Qct),Pu(e,"pointercancel",t,Hye)):(Pu(e,"mousedown",t,Gye),Pu(e,"mouseup",n,Wye),Pu(e,"mousemove",n,jye),Pu(e,"touchstart",t,Kct),Pu(e,"touchend",n,Bye),Pu(e,"touchmove",n,Zct),Pu(e,"touchcancel",n,Bye)),Pu(e,"dblclick",t,Yct);let i;"onwheel"in t?i="wheel":document.onmousewheel!==void 0?i="mousewheel":i="DOMMouseScroll",Pu(e,i,t,Xct)}function qct(e){let t=e._removalFunctions;for(let n=0;n<t.length;++n)t[n]()}var Mye={position:new H};function KX(e){e._lastSeenTouchEvent=Ei()}function ZX(e){return Ei()-e._lastSeenTouchEvent>rh.mouseEmulationIgnoreMilliseconds}function YX(e,t,n){let i=e.x-t.x,o=e.y-t.y;return Math.sqrt(i*i+o*o)<n}function Gye(e,t){if(!ZX(e))return;let n=t.button;e._buttonDown[n]=!0;let i;if(n===ws.LEFT)i=Cn.LEFT_DOWN;else if(n===ws.MIDDLE)i=Cn.MIDDLE_DOWN;else if(n===ws.RIGHT)i=Cn.RIGHT_DOWN;else return;let o=X0(e,t,e._primaryPosition);H.clone(o,e._primaryStartPosition),H.clone(o,e._primaryPreviousPosition);let r=mb(t),s=e.getInputAction(i,r);u(s)&&(H.clone(o,Mye.position),s(Mye),t.preventDefault())}var Lye={position:new H},Nye={position:new H};function GX(e,t,n,i){let o=mb(i),r=e.getInputAction(t,o),s=e.getInputAction(n,o);if(u(r)||u(s)){let a=X0(e,i,e._primaryPosition);if(u(r)&&(H.clone(a,Lye.position),r(Lye)),u(s)){let c=e._primaryStartPosition;YX(c,a,e._clickPixelTolerance)&&(H.clone(a,Nye.position),s(Nye))}}}function Wye(e,t){if(!ZX(e))return;let n=t.button;n!==ws.LEFT&&n!==ws.MIDDLE&&n!==ws.RIGHT||(e._buttonDown[ws.LEFT]&&(GX(e,Cn.LEFT_UP,Cn.LEFT_CLICK,t),e._buttonDown[ws.LEFT]=!1),e._buttonDown[ws.MIDDLE]&&(GX(e,Cn.MIDDLE_UP,Cn.MIDDLE_CLICK,t),e._buttonDown[ws.MIDDLE]=!1),e._buttonDown[ws.RIGHT]&&(GX(e,Cn.RIGHT_UP,Cn.RIGHT_CLICK,t),e._buttonDown[ws.RIGHT]=!1))}var WX={startPosition:new H,endPosition:new H};function jye(e,t){if(!ZX(e))return;let n=mb(t),i=X0(e,t,e._primaryPosition),o=e._primaryPreviousPosition,r=e.getInputAction(Cn.MOUSE_MOVE,n);u(r)&&(H.clone(o,WX.startPosition),H.clone(i,WX.endPosition),r(WX)),H.clone(i,o),(e._buttonDown[ws.LEFT]||e._buttonDown[ws.MIDDLE]||e._buttonDown[ws.RIGHT])&&t.preventDefault()}var Fye={position:new H};function Yct(e,t){let n=t.button,i;if(n===ws.LEFT)i=Cn.LEFT_DOUBLE_CLICK;else return;let o=mb(t),r=e.getInputAction(i,o);u(r)&&(X0(e,t,Fye.position),r(Fye))}function Xct(e,t){let n;if(u(t.deltaY)){let r=t.deltaMode;r===t.DOM_DELTA_PIXEL?n=-t.deltaY:r===t.DOM_DELTA_LINE?n=-t.deltaY*40:n=-t.deltaY*120}else t.detail>0?n=t.detail*-120:n=t.wheelDelta;if(!u(n))return;let i=mb(t),o=e.getInputAction(Cn.WHEEL,i);u(o)&&(o(n),t.preventDefault())}function Kct(e,t){KX(e);let n=t.changedTouches,i,o=n.length,r,s,a=e._positions;for(i=0;i<o;++i)r=n[i],s=r.identifier,a.set(s,X0(e,r,new H));uU(e,t);let c=e._previousPositions;for(i=0;i<o;++i)r=n[i],s=r.identifier,c.set(s,H.clone(a.get(s)))}function Bye(e,t){KX(e);let n=t.changedTouches,i,o=n.length,r,s,a=e._positions;for(i=0;i<o;++i)r=n[i],s=r.identifier,a.remove(s);uU(e,t);let c=e._previousPositions;for(i=0;i<o;++i)r=n[i],s=r.identifier,c.remove(s)}var kye={position:new H},jX={position1:new H,position2:new H},Vye={position:new H},Uye={position:new H},zye={position:new H};function uU(e,t){let n=mb(t),i=e._positions,o=i.length,r,s,a=e._isPinching;if(o!==1&&e._buttonDown[ws.LEFT]){if(e._buttonDown[ws.LEFT]=!1,u(e._touchHoldTimer)&&(clearTimeout(e._touchHoldTimer),e._touchHoldTimer=void 0),r=e.getInputAction(Cn.LEFT_UP,n),u(r)&&(H.clone(e._primaryPosition,Vye.position),r(Vye)),o===0&&!e._isTouchHolding&&(s=e.getInputAction(Cn.LEFT_CLICK,n),u(s))){let c=e._primaryStartPosition,l=e._previousPositions.values[0];YX(c,l,e._clickPixelTolerance)&&(H.clone(e._primaryPosition,Uye.position),s(Uye))}e._isTouchHolding=!1}if(o===0&&a&&(e._isPinching=!1,r=e.getInputAction(Cn.PINCH_END,n),u(r)&&r()),o===1&&!a){let c=i.values[0];H.clone(c,e._primaryPosition),H.clone(c,e._primaryStartPosition),H.clone(c,e._primaryPreviousPosition),e._buttonDown[ws.LEFT]=!0,r=e.getInputAction(Cn.LEFT_DOWN,n),u(r)&&(H.clone(c,kye.position),r(kye)),e._touchHoldTimer=setTimeout(function(){if(!e.isDestroyed()&&(e._touchHoldTimer=void 0,e._isTouchHolding=!0,s=e.getInputAction(Cn.RIGHT_CLICK,n),u(s))){let l=e._primaryStartPosition,f=e._previousPositions.values[0];YX(l,f,e._holdPixelTolerance)&&(H.clone(e._primaryPosition,zye.position),s(zye))}},rh.touchHoldDelayMilliseconds),t.preventDefault()}o===2&&!a&&(e._isPinching=!0,r=e.getInputAction(Cn.PINCH_START,n),u(r)&&(H.clone(i.values[0],jX.position1),H.clone(i.values[1],jX.position2),r(jX),t.preventDefault()))}function Zct(e,t){KX(e);let n=t.changedTouches,i,o=n.length,r,s,a=e._positions;for(i=0;i<o;++i){r=n[i],s=r.identifier;let l=a.get(s);u(l)&&X0(e,r,l)}qye(e,t);let c=e._previousPositions;for(i=0;i<o;++i)r=n[i],s=r.identifier,H.clone(a.get(s),c.get(s))}var qX={startPosition:new H,endPosition:new H},wD={distance:{startPosition:new H,endPosition:new H},angleAndHeight:{startPosition:new H,endPosition:new H}};function qye(e,t){let n=mb(t),i=e._positions,o=e._previousPositions,r=i.length,s;if(r===1&&e._buttonDown[ws.LEFT]){let a=i.values[0];H.clone(a,e._primaryPosition);let c=e._primaryPreviousPosition;s=e.getInputAction(Cn.MOUSE_MOVE,n),u(s)&&(H.clone(c,qX.startPosition),H.clone(a,qX.endPosition),s(qX)),H.clone(a,c),t.preventDefault()}else if(r===2&&e._isPinching&&(s=e.getInputAction(Cn.PINCH_MOVE,n),u(s))){let a=i.values[0],c=i.values[1],l=o.values[0],f=o.values[1],d=c.x-a.x,p=c.y-a.y,g=Math.sqrt(d*d+p*p)*.25,m=f.x-l.x,y=f.y-l.y,b=Math.sqrt(m*m+y*y)*.25,C=(c.y+a.y)*.125,A=(f.y+l.y)*.125,T=Math.atan2(p,d),E=Math.atan2(y,m);H.fromElements(0,b,wD.distance.startPosition),H.fromElements(0,g,wD.distance.endPosition),H.fromElements(E,A,wD.angleAndHeight.startPosition),H.fromElements(T,C,wD.angleAndHeight.endPosition),s(wD)}}function $ct(e,t){if(t.target.setPointerCapture(t.pointerId),t.pointerType==="touch"){let n=e._positions,i=t.pointerId;n.set(i,X0(e,t,new H)),uU(e,t),e._previousPositions.set(i,H.clone(n.get(i)))}else Gye(e,t)}function Hye(e,t){if(t.pointerType==="touch"){let n=e._positions,i=t.pointerId;n.remove(i),uU(e,t),e._previousPositions.remove(i)}else Wye(e,t)}function Qct(e,t){if(t.pointerType==="touch"){let n=e._positions,i=t.pointerId,o=n.get(i);if(!u(o))return;X0(e,t,o),qye(e,t);let r=e._previousPositions;H.clone(n.get(i),r.get(i))}else jye(e,t)}function rh(e){this._inputEvents={},this._buttonDown={LEFT:!1,MIDDLE:!1,RIGHT:!1},this._isPinching=!1,this._isTouchHolding=!1,this._lastSeenTouchEvent=-rh.mouseEmulationIgnoreMilliseconds,this._primaryStartPosition=new H,this._primaryPosition=new H,this._primaryPreviousPosition=new H,this._positions=new St,this._previousPositions=new St,this._removalFunctions=[],this._touchHoldTimer=void 0,this._clickPixelTolerance=5,this._holdPixelTolerance=25,this._element=x(e,document),jct(this)}rh.prototype.setInputAction=function(e,t,n){let i=XX(t,n);this._inputEvents[i]=e};rh.prototype.getInputAction=function(e,t){let n=XX(e,t);return this._inputEvents[n]};rh.prototype.removeInputAction=function(e,t){let n=XX(e,t);delete this._inputEvents[n]};rh.prototype.isDestroyed=function(){return!1};rh.prototype.destroy=function(){return qct(this),ue(this)};rh.mouseEmulationIgnoreMilliseconds=800;rh.touchHoldDelayMilliseconds=1500;var Wf=rh;function Jct(e,t,n,i,o,r,s){let a=Fi.numberOfPoints(e,t,o),c,l=n.red,f=n.green,d=n.blue,p=n.alpha,g=i.red,m=i.green,y=i.blue,b=i.alpha;if(G.equals(n,i)){for(c=0;c<a;c++)r[s++]=G.floatToByte(l),r[s++]=G.floatToByte(f),r[s++]=G.floatToByte(d),r[s++]=G.floatToByte(p);return s}let C=(g-l)/a,A=(m-f)/a,T=(y-d)/a,E=(b-p)/a,v=s;for(c=0;c<a;c++)r[v++]=G.floatToByte(l+c*C),r[v++]=G.floatToByte(f+c*A),r[v++]=G.floatToByte(d+c*T),r[v++]=G.floatToByte(p+c*E);return v}function DD(e){e=x(e,x.EMPTY_OBJECT);let t=e.positions,n=e.colors,i=x(e.colorsPerVertex,!1);this._positions=t,this._colors=n,this._colorsPerVertex=i,this._arcType=x(e.arcType,nn.GEODESIC),this._granularity=x(e.granularity,R.RADIANS_PER_DEGREE),this._ellipsoid=x(e.ellipsoid,ee.default),this._workerName="createSimplePolylineGeometry";let o=1+t.length*h.packedLength;o+=u(n)?1+n.length*G.packedLength:1,this.packedLength=o+ee.packedLength+3}DD.pack=function(e,t,n){n=x(n,0);let i,o=e._positions,r=o.length;for(t[n++]=r,i=0;i<r;++i,n+=h.packedLength)h.pack(o[i],t,n);let s=e._colors;for(r=u(s)?s.length:0,t[n++]=r,i=0;i<r;++i,n+=G.packedLength)G.pack(s[i],t,n);return ee.pack(e._ellipsoid,t,n),n+=ee.packedLength,t[n++]=e._colorsPerVertex?1:0,t[n++]=e._arcType,t[n]=e._granularity,t};DD.unpack=function(e,t,n){t=x(t,0);let i,o=e[t++],r=new Array(o);for(i=0;i<o;++i,t+=h.packedLength)r[i]=h.unpack(e,t);o=e[t++];let s=o>0?new Array(o):void 0;for(i=0;i<o;++i,t+=G.packedLength)s[i]=G.unpack(e,t);let a=ee.unpack(e,t);t+=ee.packedLength;let c=e[t++]===1,l=e[t++],f=e[t];return u(n)?(n._positions=r,n._colors=s,n._ellipsoid=a,n._colorsPerVertex=c,n._arcType=l,n._granularity=f,n):new DD({positions:r,colors:s,ellipsoid:a,colorsPerVertex:c,arcType:l,granularity:f})};var fU=new Array(2),dU=new Array(2),elt={positions:fU,height:dU,ellipsoid:void 0,minDistance:void 0,granularity:void 0};DD.createGeometry=function(e){let t=e._positions,n=e._colors,i=e._colorsPerVertex,o=e._arcType,r=e._granularity,s=e._ellipsoid,a=R.chordLength(r,s.maximumRadius),c=u(n)&&!i,l,f=t.length,d,p,g,m,y=0;if(o===nn.GEODESIC||o===nn.RHUMB){let E,v,D;o===nn.GEODESIC?(E=R.chordLength(r,s.maximumRadius),v=Fi.numberOfPoints,D=Fi.generateArc):(E=r,v=Fi.numberOfPointsRhumbLine,D=Fi.generateRhumbArc);let O=Fi.extractHeights(t,s),P=elt;if(o===nn.GEODESIC?P.minDistance=a:P.granularity=r,P.ellipsoid=s,c){let M=0;for(l=0;l<f-1;l++)M+=v(t[l],t[l+1],E)+1;d=new Float64Array(M*3),g=new Uint8Array(M*4),P.positions=fU,P.height=dU;let L=0;for(l=0;l<f-1;++l){fU[0]=t[l],fU[1]=t[l+1],dU[0]=O[l],dU[1]=O[l+1];let _=D(P);if(u(n)){let S=_.length/3;m=n[l];for(let w=0;w<S;++w)g[L++]=G.floatToByte(m.red),g[L++]=G.floatToByte(m.green),g[L++]=G.floatToByte(m.blue),g[L++]=G.floatToByte(m.alpha)}d.set(_,y),y+=_.length}}else if(P.positions=t,P.height=O,d=new Float64Array(D(P)),u(n)){for(g=new Uint8Array(d.length/3*4),l=0;l<f-1;++l){let L=t[l],_=t[l+1],S=n[l],w=n[l+1];y=Jct(L,_,S,w,a,g,y)}let M=n[f-1];g[y++]=G.floatToByte(M.red),g[y++]=G.floatToByte(M.green),g[y++]=G.floatToByte(M.blue),g[y++]=G.floatToByte(M.alpha)}}else{p=c?f*2-2:f,d=new Float64Array(p*3),g=u(n)?new Uint8Array(p*4):void 0;let E=0,v=0;for(l=0;l<f;++l){let D=t[l];if(c&&l>0&&(h.pack(D,d,E),E+=3,m=n[l-1],g[v++]=G.floatToByte(m.red),g[v++]=G.floatToByte(m.green),g[v++]=G.floatToByte(m.blue),g[v++]=G.floatToByte(m.alpha)),c&&l===f-1)break;h.pack(D,d,E),E+=3,u(n)&&(m=n[l],g[v++]=G.floatToByte(m.red),g[v++]=G.floatToByte(m.green),g[v++]=G.floatToByte(m.blue),g[v++]=G.floatToByte(m.alpha))}}let b=new hn;b.position=new ve({componentDatatype:K.DOUBLE,componentsPerAttribute:3,values:d}),u(n)&&(b.color=new ve({componentDatatype:K.UNSIGNED_BYTE,componentsPerAttribute:4,values:g,normalize:!0})),p=d.length/3;let C=(p-1)*2,A=Be.createTypedArray(p,C),T=0;for(l=0;l<p-1;++l)A[T++]=l,A[T++]=l+1;return new ft({attributes:b,indices:A,primitiveType:Ne.LINES,boundingSphere:ae.fromPoints(t)})};var Yye=DD;function FE(e){let t=x(e.radius,1),i={radii:new h(t,t,t),stackPartitions:e.stackPartitions,slicePartitions:e.slicePartitions,vertexFormat:e.vertexFormat};this._ellipsoidGeometry=new da(i),this._workerName="createSphereGeometry"}FE.packedLength=da.packedLength;FE.pack=function(e,t,n){return da.pack(e._ellipsoidGeometry,t,n)};var tlt=new da,K0={radius:void 0,radii:new h,vertexFormat:new Ie,stackPartitions:void 0,slicePartitions:void 0};FE.unpack=function(e,t,n){let i=da.unpack(e,t,tlt);return K0.vertexFormat=Ie.clone(i._vertexFormat,K0.vertexFormat),K0.stackPartitions=i._stackPartitions,K0.slicePartitions=i._slicePartitions,u(n)?(h.clone(i._radii,K0.radii),n._ellipsoidGeometry=new da(K0),n):(K0.radius=i._radii.x,new FE(K0))};FE.createGeometry=function(e){return da.createGeometry(e._ellipsoidGeometry)};var Xye=FE;function nlt(e){return e<=.04045?e*.07739938080495357:Math.pow((e+.055)*.9478672985781991,2.4)}var BE=nlt;var ilt={WEST:0,NORTH:1,EAST:2,SOUTH:3,NORTHWEST:4,NORTHEAST:5,SOUTHWEST:6,SOUTHEAST:7},gn=ilt;function Z0(e){}Object.defineProperties(Z0.prototype,{ellipsoid:{get:he.throwInstantiationError},rectangle:{get:he.throwInstantiationError},projection:{get:he.throwInstantiationError}});Z0.prototype.getNumberOfXTilesAtLevel=he.throwInstantiationError;Z0.prototype.getNumberOfYTilesAtLevel=he.throwInstantiationError;Z0.prototype.rectangleToNativeRectangle=he.throwInstantiationError;Z0.prototype.tileXYToNativeRectangle=he.throwInstantiationError;Z0.prototype.tileXYToRectangle=he.throwInstantiationError;Z0.prototype.positionToTileXY=he.throwInstantiationError;var Kye=Z0;function pb(e){e=x(e,x.EMPTY_OBJECT),this._clock=void 0,this._element=void 0,this._clockSubscription=void 0,this._seekFunction=void 0,this._lastPlaybackRate=void 0,this.clock=e.clock,this.element=e.element,this.epoch=x(e.epoch,He.MINIMUM_VALUE),this.tolerance=x(e.tolerance,1),this._seeking=!1,this._seekFunction=void 0,this._firstTickAfterSeek=!1}Object.defineProperties(pb.prototype,{clock:{get:function(){return this._clock},set:function(e){let t=this._clock;t!==e&&(u(t)&&(this._clockSubscription(),this._clockSubscription=void 0),u(e)&&(this._clockSubscription=e.onTick.addEventListener(pb.prototype._onTick,this)),this._clock=e)}},element:{get:function(){return this._element},set:function(e){let t=this._element;t!==e&&(u(t)&&t.removeEventListener("seeked",this._seekFunction,!1),u(e)&&(this._seeking=!1,this._seekFunction=olt(this),e.addEventListener("seeked",this._seekFunction,!1)),this._element=e,this._seeking=!1,this._firstTickAfterSeek=!1)}}});pb.prototype.destroy=function(){return this.element=void 0,this.clock=void 0,ue(this)};pb.prototype.isDestroyed=function(){return!1};pb.prototype._trySetPlaybackRate=function(e){if(this._lastPlaybackRate===e.multiplier)return;let t=this._element;try{t.playbackRate=e.multiplier}catch{t.playbackRate=0}this._lastPlaybackRate=e.multiplier};pb.prototype._onTick=function(e){let t=this._element;if(!u(t)||t.readyState<2)return;let n=t.paused,i=e.shouldAnimate;if(i===n&&(i?t.play():t.pause()),this._seeking||this._firstTickAfterSeek){this._firstTickAfterSeek=!1;return}this._trySetPlaybackRate(e);let o=e.currentTime,r=x(this.epoch,He.MINIMUM_VALUE),s=$.secondsDifference(o,r),a=t.duration,c,l=t.currentTime;t.loop?(s=s%a,s<0&&(s=a-s),c=s):s>a?c=a:s<0?c=0:c=s;let f=i?x(this.tolerance,1):.001;Math.abs(c-l)>f&&(this._seeking=!0,t.currentTime=c)};function olt(e){return function(){e._seeking=!1,e._firstTickAfterSeek=!0}}var Zye=pb;function rlt(e,t){this.rectangle=e,this.maxLevel=t}function $ye(e){this.ellipsoid=x(e.ellipsoid,ee.default),this.tilingScheme=void 0,this.heightmapWidth=void 0,this.heightmapHeight=void 0,this.levelZeroMaximumGeometricError=void 0,this.rectangles=[]}$ye.prototype.build=function(e){e._tilingScheme=this.tilingScheme,e._heightmapWidth=this.heightmapWidth,e._heightmapHeight=this.heightmapHeight,e._levelZeroMaximumGeometricError=this.levelZeroMaximumGeometricError,e._rectangles=this.rectangles};function slt(e,t){let n=t.getElementsByTagName("SRS")[0].textContent;if(n==="EPSG:4326")e.tilingScheme=new $i({ellipsoid:e.ellipsoid});else throw new ce(`SRS ${n} is not supported`);let i=t.getElementsByTagName("TileFormat")[0];e.heightmapWidth=parseInt(i.getAttribute("width"),10),e.heightmapHeight=parseInt(i.getAttribute("height"),10),e.levelZeroMaximumGeometricError=ds.getEstimatedLevelZeroGeometricErrorForAHeightmap(e.ellipsoid,Math.min(e.heightmapWidth,e.heightmapHeight),e.tilingScheme.getNumberOfXTilesAtLevel(0));let o=t.getElementsByTagName("DataExtent");for(let r=0;r<o.length;++r){let s=o[r],a=R.toRadians(parseFloat(s.getAttribute("minx"))),c=R.toRadians(parseFloat(s.getAttribute("miny"))),l=R.toRadians(parseFloat(s.getAttribute("maxx"))),f=R.toRadians(parseFloat(s.getAttribute("maxy"))),d=parseInt(s.getAttribute("maxlevel"),10);e.rectangles.push(new rlt(new se(a,c,l,f),d))}}function alt(e,t,n){let i=`An error occurred while accessing ${e.url}`;throw u(t)&&u(t.message)&&(i=`${i}: ${t.message}`),Oo.reportError(void 0,n,u(n)?n._errorEvent:void 0,i),new ce(i)}async function clt(e,t,n){try{let i=await t.fetchXML();slt(e,i)}catch(i){alt(t,i,n)}}function $0(e){e=x(e,x.EMPTY_OBJECT),this._errorEvent=new me,this._terrainDataStructure={heightScale:1/1e3,heightOffset:-1e3,elementsPerHeight:3,stride:4,elementMultiplier:256,isBigEndian:!0,lowestEncodedHeight:0,highestEncodedHeight:256*256*256-1};let t=e.credit;typeof t=="string"&&(t=new wt(t)),this._credit=t,this._tilingScheme=void 0,this._rectangles=[]}Object.defineProperties($0.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){}}});$0.fromUrl=async function(e,t){t=x(t,x.EMPTY_OBJECT);let n=new $ye(t),i=De.createIfNeeded(e);await clt(n,i);let o=new $0(t);return n.build(o),o._resource=i,o};$0.prototype.requestTileGeometry=function(e,t,n,i){let o=this._tilingScheme.getNumberOfYTilesAtLevel(n),s=this._resource.getDerivedResource({url:`${n}/${e}/${o-t-1}.tif`,queryParameters:{cesium:!0},request:i}).fetchImage({preferImageBitmap:!0});if(!u(s))return;let a=this;return Promise.resolve(s).then(function(c){return new lc({buffer:yh(c),width:a._heightmapWidth,height:a._heightmapHeight,childTileMask:llt(a,e,t,n),structure:a._terrainDataStructure})})};$0.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)};var Qye=new se;function llt(e,t,n,i){let o=e._tilingScheme,r=e._rectangles,s=o.tileXYToRectangle(t,n,i),a=0;for(let c=0;c<r.length&&a!==15;++c){let l=r[c];if(l.maxLevel<=i)continue;let f=l.rectangle,d=se.intersection(f,s,Qye);u(d)&&(hU(o,f,t*2,n*2,i+1)&&(a|=4),hU(o,f,t*2+1,n*2,i+1)&&(a|=8),hU(o,f,t*2,n*2+1,i+1)&&(a|=1),hU(o,f,t*2+1,n*2+1,i+1)&&(a|=2))}return a}function hU(e,t,n,i,o){let r=e.tileXYToRectangle(n,i,o);return u(se.intersection(r,t,Qye))}$0.prototype.getTileDataAvailable=function(e,t,n){};$0.prototype.loadTileDataAvailability=function(e,t,n){};var Jye=$0;var ult={VK_FORMAT_UNDEFINED:0,VK_FORMAT_R4G4_UNORM_PACK8:1,VK_FORMAT_R4G4B4A4_UNORM_PACK16:2,VK_FORMAT_B4G4R4A4_UNORM_PACK16:3,VK_FORMAT_R5G6B5_UNORM_PACK16:4,VK_FORMAT_B5G6R5_UNORM_PACK16:5,VK_FORMAT_R5G5B5A1_UNORM_PACK16:6,VK_FORMAT_B5G5R5A1_UNORM_PACK16:7,VK_FORMAT_A1R5G5B5_UNORM_PACK16:8,VK_FORMAT_R8_UNORM:9,VK_FORMAT_R8_SNORM:10,VK_FORMAT_R8_USCALED:11,VK_FORMAT_R8_SSCALED:12,VK_FORMAT_R8_UINT:13,VK_FORMAT_R8_SINT:14,VK_FORMAT_R8_SRGB:15,VK_FORMAT_R8G8_UNORM:16,VK_FORMAT_R8G8_SNORM:17,VK_FORMAT_R8G8_USCALED:18,VK_FORMAT_R8G8_SSCALED:19,VK_FORMAT_R8G8_UINT:20,VK_FORMAT_R8G8_SINT:21,VK_FORMAT_R8G8_SRGB:22,VK_FORMAT_R8G8B8_UNORM:23,VK_FORMAT_R8G8B8_SNORM:24,VK_FORMAT_R8G8B8_USCALED:25,VK_FORMAT_R8G8B8_SSCALED:26,VK_FORMAT_R8G8B8_UINT:27,VK_FORMAT_R8G8B8_SINT:28,VK_FORMAT_R8G8B8_SRGB:29,VK_FORMAT_B8G8R8_UNORM:30,VK_FORMAT_B8G8R8_SNORM:31,VK_FORMAT_B8G8R8_USCALED:32,VK_FORMAT_B8G8R8_SSCALED:33,VK_FORMAT_B8G8R8_UINT:34,VK_FORMAT_B8G8R8_SINT:35,VK_FORMAT_B8G8R8_SRGB:36,VK_FORMAT_R8G8B8A8_UNORM:37,VK_FORMAT_R8G8B8A8_SNORM:38,VK_FORMAT_R8G8B8A8_USCALED:39,VK_FORMAT_R8G8B8A8_SSCALED:40,VK_FORMAT_R8G8B8A8_UINT:41,VK_FORMAT_R8G8B8A8_SINT:42,VK_FORMAT_R8G8B8A8_SRGB:43,VK_FORMAT_B8G8R8A8_UNORM:44,VK_FORMAT_B8G8R8A8_SNORM:45,VK_FORMAT_B8G8R8A8_USCALED:46,VK_FORMAT_B8G8R8A8_SSCALED:47,VK_FORMAT_B8G8R8A8_UINT:48,VK_FORMAT_B8G8R8A8_SINT:49,VK_FORMAT_B8G8R8A8_SRGB:50,VK_FORMAT_A8B8G8R8_UNORM_PACK32:51,VK_FORMAT_A8B8G8R8_SNORM_PACK32:52,VK_FORMAT_A8B8G8R8_USCALED_PACK32:53,VK_FORMAT_A8B8G8R8_SSCALED_PACK32:54,VK_FORMAT_A8B8G8R8_UINT_PACK32:55,VK_FORMAT_A8B8G8R8_SINT_PACK32:56,VK_FORMAT_A8B8G8R8_SRGB_PACK32:57,VK_FORMAT_A2R10G10B10_UNORM_PACK32:58,VK_FORMAT_A2R10G10B10_SNORM_PACK32:59,VK_FORMAT_A2R10G10B10_USCALED_PACK32:60,VK_FORMAT_A2R10G10B10_SSCALED_PACK32:61,VK_FORMAT_A2R10G10B10_UINT_PACK32:62,VK_FORMAT_A2R10G10B10_SINT_PACK32:63,VK_FORMAT_A2B10G10R10_UNORM_PACK32:64,VK_FORMAT_A2B10G10R10_SNORM_PACK32:65,VK_FORMAT_A2B10G10R10_USCALED_PACK32:66,VK_FORMAT_A2B10G10R10_SSCALED_PACK32:67,VK_FORMAT_A2B10G10R10_UINT_PACK32:68,VK_FORMAT_A2B10G10R10_SINT_PACK32:69,VK_FORMAT_R16_UNORM:70,VK_FORMAT_R16_SNORM:71,VK_FORMAT_R16_USCALED:72,VK_FORMAT_R16_SSCALED:73,VK_FORMAT_R16_UINT:74,VK_FORMAT_R16_SINT:75,VK_FORMAT_R16_SFLOAT:76,VK_FORMAT_R16G16_UNORM:77,VK_FORMAT_R16G16_SNORM:78,VK_FORMAT_R16G16_USCALED:79,VK_FORMAT_R16G16_SSCALED:80,VK_FORMAT_R16G16_UINT:81,VK_FORMAT_R16G16_SINT:82,VK_FORMAT_R16G16_SFLOAT:83,VK_FORMAT_R16G16B16_UNORM:84,VK_FORMAT_R16G16B16_SNORM:85,VK_FORMAT_R16G16B16_USCALED:86,VK_FORMAT_R16G16B16_SSCALED:87,VK_FORMAT_R16G16B16_UINT:88,VK_FORMAT_R16G16B16_SINT:89,VK_FORMAT_R16G16B16_SFLOAT:90,VK_FORMAT_R16G16B16A16_UNORM:91,VK_FORMAT_R16G16B16A16_SNORM:92,VK_FORMAT_R16G16B16A16_USCALED:93,VK_FORMAT_R16G16B16A16_SSCALED:94,VK_FORMAT_R16G16B16A16_UINT:95,VK_FORMAT_R16G16B16A16_SINT:96,VK_FORMAT_R16G16B16A16_SFLOAT:97,VK_FORMAT_R32_UINT:98,VK_FORMAT_R32_SINT:99,VK_FORMAT_R32_SFLOAT:100,VK_FORMAT_R32G32_UINT:101,VK_FORMAT_R32G32_SINT:102,VK_FORMAT_R32G32_SFLOAT:103,VK_FORMAT_R32G32B32_UINT:104,VK_FORMAT_R32G32B32_SINT:105,VK_FORMAT_R32G32B32_SFLOAT:106,VK_FORMAT_R32G32B32A32_UINT:107,VK_FORMAT_R32G32B32A32_SINT:108,VK_FORMAT_R32G32B32A32_SFLOAT:109,VK_FORMAT_R64_UINT:110,VK_FORMAT_R64_SINT:111,VK_FORMAT_R64_SFLOAT:112,VK_FORMAT_R64G64_UINT:113,VK_FORMAT_R64G64_SINT:114,VK_FORMAT_R64G64_SFLOAT:115,VK_FORMAT_R64G64B64_UINT:116,VK_FORMAT_R64G64B64_SINT:117,VK_FORMAT_R64G64B64_SFLOAT:118,VK_FORMAT_R64G64B64A64_UINT:119,VK_FORMAT_R64G64B64A64_SINT:120,VK_FORMAT_R64G64B64A64_SFLOAT:121,VK_FORMAT_B10G11R11_UFLOAT_PACK32:122,VK_FORMAT_E5B9G9R9_UFLOAT_PACK32:123,VK_FORMAT_D16_UNORM:124,VK_FORMAT_X8_D24_UNORM_PACK32:125,VK_FORMAT_D32_SFLOAT:126,VK_FORMAT_S8_UINT:127,VK_FORMAT_D16_UNORM_S8_UINT:128,VK_FORMAT_D24_UNORM_S8_UINT:129,VK_FORMAT_D32_SFLOAT_S8_UINT:130,VK_FORMAT_BC1_RGB_UNORM_BLOCK:131,VK_FORMAT_BC1_RGB_SRGB_BLOCK:132,VK_FORMAT_BC1_RGBA_UNORM_BLOCK:133,VK_FORMAT_BC1_RGBA_SRGB_BLOCK:134,VK_FORMAT_BC2_UNORM_BLOCK:135,VK_FORMAT_BC2_SRGB_BLOCK:136,VK_FORMAT_BC3_UNORM_BLOCK:137,VK_FORMAT_BC3_SRGB_BLOCK:138,VK_FORMAT_BC4_UNORM_BLOCK:139,VK_FORMAT_BC4_SNORM_BLOCK:140,VK_FORMAT_BC5_UNORM_BLOCK:141,VK_FORMAT_BC5_SNORM_BLOCK:142,VK_FORMAT_BC6H_UFLOAT_BLOCK:143,VK_FORMAT_BC6H_SFLOAT_BLOCK:144,VK_FORMAT_BC7_UNORM_BLOCK:145,VK_FORMAT_BC7_SRGB_BLOCK:146,VK_FORMAT_ETC2_R8G8B8_UNORM_BLOCK:147,VK_FORMAT_ETC2_R8G8B8_SRGB_BLOCK:148,VK_FORMAT_ETC2_R8G8B8A1_UNORM_BLOCK:149,VK_FORMAT_ETC2_R8G8B8A1_SRGB_BLOCK:150,VK_FORMAT_ETC2_R8G8B8A8_UNORM_BLOCK:151,VK_FORMAT_ETC2_R8G8B8A8_SRGB_BLOCK:152,VK_FORMAT_EAC_R11_UNORM_BLOCK:153,VK_FORMAT_EAC_R11_SNORM_BLOCK:154,VK_FORMAT_EAC_R11G11_UNORM_BLOCK:155,VK_FORMAT_EAC_R11G11_SNORM_BLOCK:156,VK_FORMAT_ASTC_4x4_UNORM_BLOCK:157,VK_FORMAT_ASTC_4x4_SRGB_BLOCK:158,VK_FORMAT_ASTC_5x4_UNORM_BLOCK:159,VK_FORMAT_ASTC_5x4_SRGB_BLOCK:160,VK_FORMAT_ASTC_5x5_UNORM_BLOCK:161,VK_FORMAT_ASTC_5x5_SRGB_BLOCK:162,VK_FORMAT_ASTC_6x5_UNORM_BLOCK:163,VK_FORMAT_ASTC_6x5_SRGB_BLOCK:164,VK_FORMAT_ASTC_6x6_UNORM_BLOCK:165,VK_FORMAT_ASTC_6x6_SRGB_BLOCK:166,VK_FORMAT_ASTC_8x5_UNORM_BLOCK:167,VK_FORMAT_ASTC_8x5_SRGB_BLOCK:168,VK_FORMAT_ASTC_8x6_UNORM_BLOCK:169,VK_FORMAT_ASTC_8x6_SRGB_BLOCK:170,VK_FORMAT_ASTC_8x8_UNORM_BLOCK:171,VK_FORMAT_ASTC_8x8_SRGB_BLOCK:172,VK_FORMAT_ASTC_10x5_UNORM_BLOCK:173,VK_FORMAT_ASTC_10x5_SRGB_BLOCK:174,VK_FORMAT_ASTC_10x6_UNORM_BLOCK:175,VK_FORMAT_ASTC_10x6_SRGB_BLOCK:176,VK_FORMAT_ASTC_10x8_UNORM_BLOCK:177,VK_FORMAT_ASTC_10x8_SRGB_BLOCK:178,VK_FORMAT_ASTC_10x10_UNORM_BLOCK:179,VK_FORMAT_ASTC_10x10_SRGB_BLOCK:180,VK_FORMAT_ASTC_12x10_UNORM_BLOCK:181,VK_FORMAT_ASTC_12x10_SRGB_BLOCK:182,VK_FORMAT_ASTC_12x12_UNORM_BLOCK:183,VK_FORMAT_ASTC_12x12_SRGB_BLOCK:184,VK_FORMAT_G8B8G8R8_422_UNORM:1000156e3,VK_FORMAT_B8G8R8G8_422_UNORM:1000156001,VK_FORMAT_G8_B8_R8_3PLANE_420_UNORM:1000156002,VK_FORMAT_G8_B8R8_2PLANE_420_UNORM:1000156003,VK_FORMAT_G8_B8_R8_3PLANE_422_UNORM:1000156004,VK_FORMAT_G8_B8R8_2PLANE_422_UNORM:1000156005,VK_FORMAT_G8_B8_R8_3PLANE_444_UNORM:1000156006,VK_FORMAT_R10X6_UNORM_PACK16:1000156007,VK_FORMAT_R10X6G10X6_UNORM_2PACK16:1000156008,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16:1000156009,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16:1000156010,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16:1000156011,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_420_UNORM_3PACK16:1000156012,VK_FORMAT_G10X6_B10X6R10X6_2PLANE_420_UNORM_3PACK16:1000156013,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_422_UNORM_3PACK16:1000156014,VK_FORMAT_G10X6_B10X6R10X6_2PLANE_422_UNORM_3PACK16:1000156015,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_444_UNORM_3PACK16:1000156016,VK_FORMAT_R12X4_UNORM_PACK16:1000156017,VK_FORMAT_R12X4G12X4_UNORM_2PACK16:1000156018,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16:1000156019,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16:1000156020,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16:1000156021,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_420_UNORM_3PACK16:1000156022,VK_FORMAT_G12X4_B12X4R12X4_2PLANE_420_UNORM_3PACK16:1000156023,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_422_UNORM_3PACK16:1000156024,VK_FORMAT_G12X4_B12X4R12X4_2PLANE_422_UNORM_3PACK16:1000156025,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_444_UNORM_3PACK16:1000156026,VK_FORMAT_G16B16G16R16_422_UNORM:1000156027,VK_FORMAT_B16G16R16G16_422_UNORM:1000156028,VK_FORMAT_G16_B16_R16_3PLANE_420_UNORM:1000156029,VK_FORMAT_G16_B16R16_2PLANE_420_UNORM:1000156030,VK_FORMAT_G16_B16_R16_3PLANE_422_UNORM:1000156031,VK_FORMAT_G16_B16R16_2PLANE_422_UNORM:1000156032,VK_FORMAT_G16_B16_R16_3PLANE_444_UNORM:1000156033,VK_FORMAT_PVRTC1_2BPP_UNORM_BLOCK_IMG:1000054e3,VK_FORMAT_PVRTC1_4BPP_UNORM_BLOCK_IMG:1000054001,VK_FORMAT_PVRTC2_2BPP_UNORM_BLOCK_IMG:1000054002,VK_FORMAT_PVRTC2_4BPP_UNORM_BLOCK_IMG:1000054003,VK_FORMAT_PVRTC1_2BPP_SRGB_BLOCK_IMG:1000054004,VK_FORMAT_PVRTC1_4BPP_SRGB_BLOCK_IMG:1000054005,VK_FORMAT_PVRTC2_2BPP_SRGB_BLOCK_IMG:1000054006,VK_FORMAT_PVRTC2_4BPP_SRGB_BLOCK_IMG:1000054007,VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT:1000066e3,VK_FORMAT_ASTC_5x4_SFLOAT_BLOCK_EXT:1000066001,VK_FORMAT_ASTC_5x5_SFLOAT_BLOCK_EXT:1000066002,VK_FORMAT_ASTC_6x5_SFLOAT_BLOCK_EXT:1000066003,VK_FORMAT_ASTC_6x6_SFLOAT_BLOCK_EXT:1000066004,VK_FORMAT_ASTC_8x5_SFLOAT_BLOCK_EXT:1000066005,VK_FORMAT_ASTC_8x6_SFLOAT_BLOCK_EXT:1000066006,VK_FORMAT_ASTC_8x8_SFLOAT_BLOCK_EXT:1000066007,VK_FORMAT_ASTC_10x5_SFLOAT_BLOCK_EXT:1000066008,VK_FORMAT_ASTC_10x6_SFLOAT_BLOCK_EXT:1000066009,VK_FORMAT_ASTC_10x8_SFLOAT_BLOCK_EXT:1000066010,VK_FORMAT_ASTC_10x10_SFLOAT_BLOCK_EXT:1000066011,VK_FORMAT_ASTC_12x10_SFLOAT_BLOCK_EXT:1000066012,VK_FORMAT_ASTC_12x12_SFLOAT_BLOCK_EXT:1000066013,VK_FORMAT_G8B8G8R8_422_UNORM_KHR:1000156e3,VK_FORMAT_B8G8R8G8_422_UNORM_KHR:1000156001,VK_FORMAT_G8_B8_R8_3PLANE_420_UNORM_KHR:1000156002,VK_FORMAT_G8_B8R8_2PLANE_420_UNORM_KHR:1000156003,VK_FORMAT_G8_B8_R8_3PLANE_422_UNORM_KHR:1000156004,VK_FORMAT_G8_B8R8_2PLANE_422_UNORM_KHR:1000156005,VK_FORMAT_G8_B8_R8_3PLANE_444_UNORM_KHR:1000156006,VK_FORMAT_R10X6_UNORM_PACK16_KHR:1000156007,VK_FORMAT_R10X6G10X6_UNORM_2PACK16_KHR:1000156008,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16_KHR:1000156009,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16_KHR:1000156010,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16_KHR:1000156011,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_420_UNORM_3PACK16_KHR:1000156012,VK_FORMAT_G10X6_B10X6R10X6_2PLANE_420_UNORM_3PACK16_KHR:1000156013,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_422_UNORM_3PACK16_KHR:1000156014,VK_FORMAT_G10X6_B10X6R10X6_2PLANE_422_UNORM_3PACK16_KHR:1000156015,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_444_UNORM_3PACK16_KHR:1000156016,VK_FORMAT_R12X4_UNORM_PACK16_KHR:1000156017,VK_FORMAT_R12X4G12X4_UNORM_2PACK16_KHR:1000156018,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16_KHR:1000156019,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16_KHR:1000156020,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16_KHR:1000156021,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_420_UNORM_3PACK16_KHR:1000156022,VK_FORMAT_G12X4_B12X4R12X4_2PLANE_420_UNORM_3PACK16_KHR:1000156023,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_422_UNORM_3PACK16_KHR:1000156024,VK_FORMAT_G12X4_B12X4R12X4_2PLANE_422_UNORM_3PACK16_KHR:1000156025,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_444_UNORM_3PACK16_KHR:1000156026,VK_FORMAT_G16B16G16R16_422_UNORM_KHR:1000156027,VK_FORMAT_B16G16R16G16_422_UNORM_KHR:1000156028,VK_FORMAT_G16_B16_R16_3PLANE_420_UNORM_KHR:1000156029,VK_FORMAT_G16_B16R16_2PLANE_420_UNORM_KHR:1000156030,VK_FORMAT_G16_B16_R16_3PLANE_422_UNORM_KHR:1000156031,VK_FORMAT_G16_B16R16_2PLANE_422_UNORM_KHR:1000156032,VK_FORMAT_G16_B16_R16_3PLANE_444_UNORM_KHR:1000156033},exe=Object.freeze(ult);function flt(e){switch(e){case te.FLOAT:return"float";case te.FLOAT_VEC2:return"vec2";case te.FLOAT_VEC3:return"vec3";case te.FLOAT_VEC4:return"vec4";case te.FLOAT_MAT2:return"mat2";case te.FLOAT_MAT3:return"mat3";case te.FLOAT_MAT4:return"mat4";case te.SAMPLER_2D:return"sampler2D";case te.BOOL:return"bool"}}var txe=flt;function dlt(e,t,n){return function(){n.apply(e,arguments),t.apply(e,arguments)}}var mU=dlt;async function $X(e,t){let n=t.terrainProvider,i=t.mapProjection,o=i.ellipsoid,r,s=t.camera.getRectangleCameraCoordinates(e);if(t.mode===ne.SCENE3D?r=o.cartesianToCartographic(s):r=i.unproject(s),!u(n))return r;let a=n.availability;if(!u(a)||t.mode===ne.SCENE2D)return r;let c=[se.center(e),se.southeast(e),se.southwest(e),se.northeast(e),se.northwest(e)],l=await $X._sampleTerrainMostDetailed(n,c),f=!1,d=l.reduce(function(g,m){return u(m.height)?(f=!0,Math.max(m.height,g)):g},-Number.MAX_VALUE),p=r;return f&&(p.height+=d),p}$X._sampleTerrainMostDetailed=NE;var kE=$X;var pU=`uniform vec4 u_initialColor;

#if TEXTURE_UNITS > 0
uniform sampler2D u_dayTextures[TEXTURE_UNITS];
uniform vec4 u_dayTextureTranslationAndScale[TEXTURE_UNITS];
uniform bool u_dayTextureUseWebMercatorT[TEXTURE_UNITS];

#ifdef APPLY_ALPHA
uniform float u_dayTextureAlpha[TEXTURE_UNITS];
#endif

#ifdef APPLY_DAY_NIGHT_ALPHA
uniform float u_dayTextureNightAlpha[TEXTURE_UNITS];
uniform float u_dayTextureDayAlpha[TEXTURE_UNITS];
#endif

#ifdef APPLY_SPLIT
uniform float u_dayTextureSplit[TEXTURE_UNITS];
#endif

#ifdef APPLY_BRIGHTNESS
uniform float u_dayTextureBrightness[TEXTURE_UNITS];
#endif

#ifdef APPLY_CONTRAST
uniform float u_dayTextureContrast[TEXTURE_UNITS];
#endif

#ifdef APPLY_HUE
uniform float u_dayTextureHue[TEXTURE_UNITS];
#endif

#ifdef APPLY_SATURATION
uniform float u_dayTextureSaturation[TEXTURE_UNITS];
#endif

#ifdef APPLY_GAMMA
uniform float u_dayTextureOneOverGamma[TEXTURE_UNITS];
#endif

#ifdef APPLY_IMAGERY_CUTOUT
uniform vec4 u_dayTextureCutoutRectangles[TEXTURE_UNITS];
#endif

#ifdef APPLY_COLOR_TO_ALPHA
uniform vec4 u_colorsToAlpha[TEXTURE_UNITS];
#endif

uniform vec4 u_dayTextureTexCoordsRectangle[TEXTURE_UNITS];
#endif

#if defined(HAS_WATER_MASK) && (defined(SHOW_REFLECTIVE_OCEAN) || defined(APPLY_MATERIAL))
uniform sampler2D u_waterMask;
uniform vec4 u_waterMaskTranslationAndScale;
uniform float u_zoomedOutOceanSpecularIntensity;
#endif

#ifdef SHOW_OCEAN_WAVES
uniform sampler2D u_oceanNormalMap;
#endif

#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)
uniform vec2 u_lightingFadeDistance;
#endif

#ifdef TILE_LIMIT_RECTANGLE
uniform vec4 u_cartographicLimitRectangle;
#endif

#ifdef GROUND_ATMOSPHERE
uniform vec2 u_nightFadeDistance;
#endif

#ifdef ENABLE_CLIPPING_PLANES
uniform highp sampler2D u_clippingPlanes;
uniform mat4 u_clippingPlanesMatrix;
uniform vec4 u_clippingPlanesEdgeStyle;
#endif

#ifdef ENABLE_CLIPPING_POLYGONS
uniform highp sampler2D u_clippingDistance;
in vec2 v_clippingPosition;
flat in int v_regionIndex;
#endif

#if defined(GROUND_ATMOSPHERE) || defined(FOG) && defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))
uniform float u_minimumBrightness;
#endif

#ifdef COLOR_CORRECT
uniform vec3 u_hsbShift; // Hue, saturation, brightness
#endif

#ifdef HIGHLIGHT_FILL_TILE
uniform vec4 u_fillHighlightColor;
#endif

#ifdef TRANSLUCENT
uniform vec4 u_frontFaceAlphaByDistance;
uniform vec4 u_backFaceAlphaByDistance;
uniform vec4 u_translucencyRectangle;
#endif

#ifdef UNDERGROUND_COLOR
uniform vec4 u_undergroundColor;
uniform vec4 u_undergroundColorAlphaByDistance;
#endif

#ifdef ENABLE_VERTEX_LIGHTING
uniform float u_lambertDiffuseMultiplier;
uniform float u_vertexShadowDarkness;
#endif

in vec3 v_positionMC;
in vec3 v_positionEC;
in vec3 v_textureCoordinates;
in vec3 v_normalMC;
in vec3 v_normalEC;

#ifdef APPLY_MATERIAL
in float v_height;
in float v_slope;
in float v_aspect;
#endif

#if defined(FOG) || defined(GROUND_ATMOSPHERE) || defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)
in float v_distance;
#endif

#if defined(GROUND_ATMOSPHERE) || defined(FOG)
in vec3 v_atmosphereRayleighColor;
in vec3 v_atmosphereMieColor;
in float v_atmosphereOpacity;
#endif

#if defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)
float interpolateByDistance(vec4 nearFarScalar, float distance)
{
    float startDistance = nearFarScalar.x;
    float startValue = nearFarScalar.y;
    float endDistance = nearFarScalar.z;
    float endValue = nearFarScalar.w;
    float t = clamp((distance - startDistance) / (endDistance - startDistance), 0.0, 1.0);
    return mix(startValue, endValue, t);
}
#endif

#if defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT) || defined(APPLY_MATERIAL)
vec4 alphaBlend(vec4 sourceColor, vec4 destinationColor)
{
    return sourceColor * vec4(sourceColor.aaa, 1.0) + destinationColor * (1.0 - sourceColor.a);
}
#endif

#ifdef TRANSLUCENT
bool inTranslucencyRectangle()
{
    return
        v_textureCoordinates.x > u_translucencyRectangle.x &&
        v_textureCoordinates.x < u_translucencyRectangle.z &&
        v_textureCoordinates.y > u_translucencyRectangle.y &&
        v_textureCoordinates.y < u_translucencyRectangle.w;
}
#endif

vec4 sampleAndBlend(
    vec4 previousColor,
    sampler2D textureToSample,
    vec2 tileTextureCoordinates,
    vec4 textureCoordinateRectangle,
    vec4 textureCoordinateTranslationAndScale,
    float textureAlpha,
    float textureNightAlpha,
    float textureDayAlpha,
    float textureBrightness,
    float textureContrast,
    float textureHue,
    float textureSaturation,
    float textureOneOverGamma,
    float split,
    vec4 colorToAlpha,
    float nightBlend)
{
    // This crazy step stuff sets the alpha to 0.0 if this following condition is true:
    //    tileTextureCoordinates.s < textureCoordinateRectangle.s ||
    //    tileTextureCoordinates.s > textureCoordinateRectangle.p ||
    //    tileTextureCoordinates.t < textureCoordinateRectangle.t ||
    //    tileTextureCoordinates.t > textureCoordinateRectangle.q
    // In other words, the alpha is zero if the fragment is outside the rectangle
    // covered by this texture.  Would an actual 'if' yield better performance?
    vec2 alphaMultiplier = step(textureCoordinateRectangle.st, tileTextureCoordinates);
    textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;

    alphaMultiplier = step(vec2(0.0), textureCoordinateRectangle.pq - tileTextureCoordinates);
    textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;

#if defined(APPLY_DAY_NIGHT_ALPHA) && defined(ENABLE_DAYNIGHT_SHADING)
    textureAlpha *= mix(textureDayAlpha, textureNightAlpha, nightBlend);
#endif

    vec2 translation = textureCoordinateTranslationAndScale.xy;
    vec2 scale = textureCoordinateTranslationAndScale.zw;
    vec2 textureCoordinates = tileTextureCoordinates * scale + translation;
    vec4 value = texture(textureToSample, textureCoordinates);
    vec3 color = value.rgb;
    float alpha = value.a;

#ifdef APPLY_COLOR_TO_ALPHA
    vec3 colorDiff = abs(color.rgb - colorToAlpha.rgb);
    colorDiff.r = czm_maximumComponent(colorDiff);
    alpha = czm_branchFreeTernary(colorDiff.r < colorToAlpha.a, 0.0, alpha);
#endif

#if !defined(APPLY_GAMMA)
    vec4 tempColor = czm_gammaCorrect(vec4(color, alpha));
    color = tempColor.rgb;
    alpha = tempColor.a;
#else
    color = pow(color, vec3(textureOneOverGamma));
#endif

#ifdef APPLY_SPLIT
    float splitPosition = czm_splitPosition;
    // Split to the left
    if (split < 0.0 && gl_FragCoord.x > splitPosition) {
       alpha = 0.0;
    }
    // Split to the right
    else if (split > 0.0 && gl_FragCoord.x < splitPosition) {
       alpha = 0.0;
    }
#endif

#ifdef APPLY_BRIGHTNESS
    color = mix(vec3(0.0), color, textureBrightness);
#endif

#ifdef APPLY_CONTRAST
    color = mix(vec3(0.5), color, textureContrast);
#endif

#ifdef APPLY_HUE
    color = czm_hue(color, textureHue);
#endif

#ifdef APPLY_SATURATION
    color = czm_saturation(color, textureSaturation);
#endif

    float sourceAlpha = alpha * textureAlpha;
    float outAlpha = mix(previousColor.a, 1.0, sourceAlpha);
    outAlpha += sign(outAlpha) - 1.0;

    vec3 outColor = mix(previousColor.rgb * previousColor.a, color, sourceAlpha) / outAlpha;

    // When rendering imagery for a tile in multiple passes,
    // some GPU/WebGL implementation combinations will not blend fragments in
    // additional passes correctly if their computation includes an unmasked
    // divide-by-zero operation,
    // even if it's not in the output or if the output has alpha zero.
    //
    // For example, without sanitization for outAlpha,
    // this renders without artifacts:
    //   if (outAlpha == 0.0) { outColor = vec3(0.0); }
    //
    // but using czm_branchFreeTernary will cause portions of the tile that are
    // alpha-zero in the additional pass to render as black instead of blending
    // with the previous pass:
    //   outColor = czm_branchFreeTernary(outAlpha == 0.0, vec3(0.0), outColor);
    //
    // So instead, sanitize against divide-by-zero,
    // store this state on the sign of outAlpha, and correct on return.

    return vec4(outColor, max(outAlpha, 0.0));
}

vec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates, float nightBlend);
vec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float specularMapValue, float fade);

const float fExposure = 2.0;

vec3 computeEllipsoidPosition()
{
    float mpp = czm_metersPerPixel(vec4(0.0, 0.0, -czm_currentFrustum.x, 1.0), 1.0);
    vec2 xy = gl_FragCoord.xy / czm_viewport.zw * 2.0 - vec2(1.0);
    xy *= czm_viewport.zw * mpp * 0.5;

    vec3 direction = normalize(vec3(xy, -czm_currentFrustum.x));
    czm_ray ray = czm_ray(vec3(0.0), direction);

    vec3 ellipsoid_center = czm_view[3].xyz;

    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid_center, czm_ellipsoidInverseRadii);

    vec3 ellipsoidPosition = czm_pointAlongRay(ray, intersection.start);
    return (czm_inverseView * vec4(ellipsoidPosition, 1.0)).xyz;
}

void main()
{
#ifdef TILE_LIMIT_RECTANGLE
    if (v_textureCoordinates.x < u_cartographicLimitRectangle.x || u_cartographicLimitRectangle.z < v_textureCoordinates.x ||
        v_textureCoordinates.y < u_cartographicLimitRectangle.y || u_cartographicLimitRectangle.w < v_textureCoordinates.y)
        {
            discard;
        }
#endif

#ifdef ENABLE_CLIPPING_PLANES
    float clipDistance = clip(gl_FragCoord, u_clippingPlanes, u_clippingPlanesMatrix);
#endif

#if defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING) || defined(HDR)
    vec3 normalMC = czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0));   // normalized surface normal in model coordinates
    vec3 normalEC = czm_normal3D * normalMC;                                         // normalized surface normal in eye coordinates
#endif

#if defined(APPLY_DAY_NIGHT_ALPHA) && defined(ENABLE_DAYNIGHT_SHADING)
    float nightBlend = 1.0 - clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * 5.0, 0.0, 1.0);
#else
    float nightBlend = 0.0;
#endif

    // The clamp below works around an apparent bug in Chrome Canary v23.0.1241.0
    // where the fragment shader sees textures coordinates < 0.0 and > 1.0 for the
    // fragments on the edges of tiles even though the vertex shader is outputting
    // coordinates strictly in the 0-1 range.
    vec4 color = computeDayColor(u_initialColor, clamp(v_textureCoordinates, 0.0, 1.0), nightBlend);

#ifdef SHOW_TILE_BOUNDARIES
    if (v_textureCoordinates.x < (1.0/256.0) || v_textureCoordinates.x > (255.0/256.0) ||
        v_textureCoordinates.y < (1.0/256.0) || v_textureCoordinates.y > (255.0/256.0))
    {
        color = vec4(1.0, 0.0, 0.0, 1.0);
    }
#endif

#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)
    float cameraDist;
    if (czm_sceneMode == czm_sceneMode2D)
    {
        cameraDist = max(czm_frustumPlanes.x - czm_frustumPlanes.y, czm_frustumPlanes.w - czm_frustumPlanes.z) * 0.5;
    }
    else if (czm_sceneMode == czm_sceneModeColumbusView)
    {
        cameraDist = -czm_view[3].z;
    }
    else
    {
        cameraDist = length(czm_view[3]);
    }
    float fadeOutDist = u_lightingFadeDistance.x;
    float fadeInDist = u_lightingFadeDistance.y;
    if (czm_sceneMode != czm_sceneMode3D) {
        vec3 radii = czm_ellipsoidRadii;
        float maxRadii = max(radii.x, max(radii.y, radii.z));
        fadeOutDist -= maxRadii;
        fadeInDist -= maxRadii;
    }
    float fade = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.0, 1.0);
#else
    float fade = 0.0;
#endif

#if defined(HAS_WATER_MASK) && (defined(SHOW_REFLECTIVE_OCEAN) || defined(APPLY_MATERIAL))
    vec2 waterMaskTranslation = u_waterMaskTranslationAndScale.xy;
    vec2 waterMaskScale = u_waterMaskTranslationAndScale.zw;
    vec2 waterMaskTextureCoordinates = v_textureCoordinates.xy * waterMaskScale + waterMaskTranslation;
    waterMaskTextureCoordinates.y = 1.0 - waterMaskTextureCoordinates.y;

    float mask = texture(u_waterMask, waterMaskTextureCoordinates).r;

    #ifdef SHOW_REFLECTIVE_OCEAN
    if (mask > 0.0)
    {
        mat3 enuToEye = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalEC);

        vec2 ellipsoidTextureCoordinates = czm_ellipsoidTextureCoordinates(normalMC);
        vec2 ellipsoidFlippedTextureCoordinates = czm_ellipsoidTextureCoordinates(normalMC.zyx);

        vec2 textureCoordinates = mix(ellipsoidTextureCoordinates, ellipsoidFlippedTextureCoordinates, czm_morphTime * smoothstep(0.9, 0.95, normalMC.z));

        color = computeWaterColor(v_positionEC, textureCoordinates, enuToEye, color, mask, fade);
    }
    #endif
#endif

#ifdef APPLY_MATERIAL
    czm_materialInput materialInput;
    materialInput.st = v_textureCoordinates.st;
    materialInput.normalEC = normalize(v_normalEC);
    materialInput.positionToEyeEC = -v_positionEC;
    materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalize(v_normalEC));
    materialInput.slope = v_slope;
    materialInput.height = v_height;
    materialInput.aspect = v_aspect;
    #ifdef HAS_WATER_MASK
        materialInput.waterMask = mask;
    #endif

    czm_material material = czm_getMaterial(materialInput);
    vec4 materialColor = vec4(material.diffuse, material.alpha);
    color = alphaBlend(materialColor, color);
#endif

#ifdef ENABLE_VERTEX_LIGHTING
    float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalize(v_normalEC)) * u_lambertDiffuseMultiplier + u_vertexShadowDarkness, 0.0, 1.0);
    vec4 finalColor = vec4(color.rgb * czm_lightColor * diffuseIntensity, color.a);
#elif defined(ENABLE_DAYNIGHT_SHADING)
    float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * 5.0 + 0.3, 0.0, 1.0);
    diffuseIntensity = mix(1.0, diffuseIntensity, fade);
    vec4 finalColor = vec4(color.rgb * czm_lightColor * diffuseIntensity, color.a);
#else
    vec4 finalColor = color;
#endif

#ifdef ENABLE_CLIPPING_PLANES
    vec4 clippingPlanesEdgeColor = vec4(1.0);
    clippingPlanesEdgeColor.rgb = u_clippingPlanesEdgeStyle.rgb;
    float clippingPlanesEdgeWidth = u_clippingPlanesEdgeStyle.a;

    if (clipDistance < clippingPlanesEdgeWidth)
    {
        finalColor = clippingPlanesEdgeColor;
    }
#endif

#ifdef ENABLE_CLIPPING_POLYGONS
    vec2 clippingPosition = v_clippingPosition;
    int regionIndex = v_regionIndex;
    clipPolygons(u_clippingDistance, CLIPPING_POLYGON_REGIONS_LENGTH, clippingPosition, regionIndex);
#endif

#ifdef HIGHLIGHT_FILL_TILE
    finalColor = vec4(mix(finalColor.rgb, u_fillHighlightColor.rgb, u_fillHighlightColor.a), finalColor.a);
#endif

#if defined(DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN)
    vec3 atmosphereLightDirection = czm_sunDirectionWC;
#else
    vec3 atmosphereLightDirection = czm_lightDirectionWC;
#endif

#if defined(GROUND_ATMOSPHERE) || defined(FOG)
    if (!czm_backFacing())
    {
        bool dynamicLighting = false;
        #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_DAYNIGHT_SHADING) || defined(ENABLE_VERTEX_LIGHTING))
            dynamicLighting = true;
        #endif

        vec3 rayleighColor;
        vec3 mieColor;
        float opacity;

        vec3 positionWC;
        vec3 lightDirection;

        // When the camera is far away (camera distance > nightFadeOutDistance), the scattering is computed in the fragment shader.
        // Otherwise, the scattering is computed in the vertex shader.
        #ifdef PER_FRAGMENT_GROUND_ATMOSPHERE
            positionWC = computeEllipsoidPosition();
            lightDirection = czm_branchFreeTernary(dynamicLighting, atmosphereLightDirection, normalize(positionWC));
            computeAtmosphereScattering(
                positionWC,
                lightDirection,
                rayleighColor,
                mieColor,
                opacity
            );
        #else
            positionWC = v_positionMC;
            lightDirection = czm_branchFreeTernary(dynamicLighting, atmosphereLightDirection, normalize(positionWC));
            rayleighColor = v_atmosphereRayleighColor;
            mieColor = v_atmosphereMieColor;
            opacity = v_atmosphereOpacity;
        #endif

        #ifdef COLOR_CORRECT
            const bool ignoreBlackPixels = true;
            rayleighColor = czm_applyHSBShift(rayleighColor, u_hsbShift, ignoreBlackPixels);
            mieColor = czm_applyHSBShift(mieColor, u_hsbShift, ignoreBlackPixels);
        #endif

        vec4 groundAtmosphereColor = computeAtmosphereColor(positionWC, lightDirection, rayleighColor, mieColor, opacity);

        // Fog is applied to tiles selected for fog, close to the Earth.
        #ifdef FOG
            vec3 fogColor = groundAtmosphereColor.rgb;

            // If there is lighting, apply that to the fog.
            #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))
                float darken = clamp(dot(normalize(czm_viewerPositionWC), atmosphereLightDirection), u_minimumBrightness, 1.0);
                fogColor *= darken;
            #endif

            #ifndef HDR
                fogColor.rgb = czm_pbrNeutralTonemapping(fogColor.rgb);
                fogColor.rgb = czm_inverseGamma(fogColor.rgb);
            #endif

            finalColor = vec4(czm_fog(v_distance, finalColor.rgb, fogColor.rgb, czm_fogVisualDensityScalar), finalColor.a);

        #else
            // Apply ground atmosphere. This happens when the camera is far away from the earth.

            // The transmittance is based on optical depth i.e. the length of segment of the ray inside the atmosphere.
            // This value is larger near the "circumference", as it is further away from the camera. We use it to
            // brighten up that area of the ground atmosphere.
            const float transmittanceModifier = 0.5;
            float transmittance = transmittanceModifier + clamp(1.0 - groundAtmosphereColor.a, 0.0, 1.0);

            vec3 finalAtmosphereColor = finalColor.rgb + groundAtmosphereColor.rgb * transmittance;

            #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))
                float fadeInDist = u_nightFadeDistance.x;
                float fadeOutDist = u_nightFadeDistance.y;

                float sunlitAtmosphereIntensity = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.05, 1.0);
                float darken = clamp(dot(normalize(positionWC), atmosphereLightDirection), 0.0, 1.0);
                vec3 darkenendGroundAtmosphereColor = mix(groundAtmosphereColor.rgb, finalAtmosphereColor.rgb, darken);

                finalAtmosphereColor = mix(darkenendGroundAtmosphereColor, finalAtmosphereColor, sunlitAtmosphereIntensity);
            #endif

            #ifndef HDR
                finalAtmosphereColor.rgb = vec3(1.0) - exp(-fExposure * finalAtmosphereColor.rgb);
            #else
                finalAtmosphereColor.rgb = czm_saturation(finalAtmosphereColor.rgb, 1.6);
            #endif

            finalColor.rgb = mix(finalColor.rgb, finalAtmosphereColor.rgb, fade);
        #endif
    }
#endif

#ifdef UNDERGROUND_COLOR
    if (czm_backFacing())
    {
        float distanceFromEllipsoid = max(czm_eyeHeight, 0.0);
        float distance = max(v_distance - distanceFromEllipsoid, 0.0);
        float blendAmount = interpolateByDistance(u_undergroundColorAlphaByDistance, distance);
        vec4 undergroundColor = vec4(u_undergroundColor.rgb, u_undergroundColor.a * blendAmount);
        finalColor = alphaBlend(undergroundColor, finalColor);
    }
#endif

#ifdef TRANSLUCENT
    if (inTranslucencyRectangle())
    {
      vec4 alphaByDistance = gl_FrontFacing ? u_frontFaceAlphaByDistance : u_backFaceAlphaByDistance;
      finalColor.a *= interpolateByDistance(alphaByDistance, v_distance);
    }
#endif

    out_FragColor =  finalColor;
}


#ifdef SHOW_REFLECTIVE_OCEAN

float waveFade(float edge0, float edge1, float x)
{
    float y = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
    return pow(1.0 - y, 5.0);
}

float linearFade(float edge0, float edge1, float x)
{
    return clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
}

// Based on water rendering by Jonas Wagner:
// http://29a.ch/2012/7/19/webgl-terrain-rendering-water-fog

// low altitude wave settings
const float oceanFrequencyLowAltitude = 825000.0;
const float oceanAnimationSpeedLowAltitude = 0.004;
const float oceanOneOverAmplitudeLowAltitude = 1.0 / 2.0;
const float oceanSpecularIntensity = 0.5;

// high altitude wave settings
const float oceanFrequencyHighAltitude = 125000.0;
const float oceanAnimationSpeedHighAltitude = 0.008;
const float oceanOneOverAmplitudeHighAltitude = 1.0 / 2.0;

vec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float maskValue, float fade)
{
    vec3 positionToEyeEC = -positionEyeCoordinates;
    float positionToEyeECLength = length(positionToEyeEC);

    // The double normalize below works around a bug in Firefox on Android devices.
    vec3 normalizedPositionToEyeEC = normalize(normalize(positionToEyeEC));

    // Fade out the waves as the camera moves far from the surface.
    float waveIntensity = waveFade(70000.0, 1000000.0, positionToEyeECLength);

#ifdef SHOW_OCEAN_WAVES
    // high altitude waves
    float time = czm_frameNumber * oceanAnimationSpeedHighAltitude;
    vec4 noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyHighAltitude, time, 0.0);
    vec3 normalTangentSpaceHighAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeHighAltitude);

    // low altitude waves
    time = czm_frameNumber * oceanAnimationSpeedLowAltitude;
    noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyLowAltitude, time, 0.0);
    vec3 normalTangentSpaceLowAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeLowAltitude);

    // blend the 2 wave layers based on distance to surface
    float highAltitudeFade = linearFade(0.0, 60000.0, positionToEyeECLength);
    float lowAltitudeFade = 1.0 - linearFade(20000.0, 60000.0, positionToEyeECLength);
    vec3 normalTangentSpace =
        (highAltitudeFade * normalTangentSpaceHighAltitude) +
        (lowAltitudeFade * normalTangentSpaceLowAltitude);
    normalTangentSpace = normalize(normalTangentSpace);

    // fade out the normal perturbation as we move farther from the water surface
    normalTangentSpace.xy *= waveIntensity;
    normalTangentSpace = normalize(normalTangentSpace);
#else
    vec3 normalTangentSpace = vec3(0.0, 0.0, 1.0);
#endif

    vec3 normalEC = enuToEye * normalTangentSpace;

    const vec3 waveHighlightColor = vec3(0.3, 0.45, 0.6);

    // Use diffuse light to highlight the waves
    float diffuseIntensity = czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * maskValue;
    vec3 diffuseHighlight = waveHighlightColor * diffuseIntensity * (1.0 - fade);

#ifdef SHOW_OCEAN_WAVES
    // Where diffuse light is low or non-existent, use wave highlights based solely on
    // the wave bumpiness and no particular light direction.
    float tsPerturbationRatio = normalTangentSpace.z;
    vec3 nonDiffuseHighlight = mix(waveHighlightColor * 5.0 * (1.0 - tsPerturbationRatio), vec3(0.0), diffuseIntensity);
#else
    vec3 nonDiffuseHighlight = vec3(0.0);
#endif

    // Add specular highlights in 3D, and in all modes when zoomed in.
    float specularIntensity = czm_getSpecular(czm_lightDirectionEC, normalizedPositionToEyeEC, normalEC, 10.0);
    float surfaceReflectance = mix(0.0, mix(u_zoomedOutOceanSpecularIntensity, oceanSpecularIntensity, waveIntensity), maskValue);
    float specular = specularIntensity * surfaceReflectance;

#ifdef HDR
    specular *= 1.4;

    float e = 0.2;
    float d = 3.3;
    float c = 1.7;

    vec3 color = imageryColor.rgb + (c * (vec3(e) + imageryColor.rgb * d) * (diffuseHighlight + nonDiffuseHighlight + specular));
#else
    vec3 color = imageryColor.rgb + diffuseHighlight + nonDiffuseHighlight + specular;
#endif

    return vec4(color, imageryColor.a);
}

#endif // #ifdef SHOW_REFLECTIVE_OCEAN
`;var _U=`#ifdef QUANTIZATION_BITS12
in vec4 compressed0;
in float compressed1;
#else
in vec4 position3DAndHeight;
in vec4 textureCoordAndEncodedNormals;
#endif

#ifdef GEODETIC_SURFACE_NORMALS
in vec3 geodeticSurfaceNormal;
#endif

#ifdef EXAGGERATION
uniform vec2 u_verticalExaggerationAndRelativeHeight;
#endif

uniform vec3 u_center3D;
uniform mat4 u_modifiedModelView;
uniform mat4 u_modifiedModelViewProjection;
uniform vec4 u_tileRectangle;

// Uniforms for 2D Mercator projection
uniform vec2 u_southAndNorthLatitude;
uniform vec2 u_southMercatorYAndOneOverHeight;

out vec3 v_positionMC;
out vec3 v_positionEC;

out vec3 v_textureCoordinates;
out vec3 v_normalMC;
out vec3 v_normalEC;

#ifdef APPLY_MATERIAL
out float v_slope;
out float v_aspect;
out float v_height;
#endif

#if defined(FOG) || defined(GROUND_ATMOSPHERE) || defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)
out float v_distance;
#endif

#if defined(FOG) || defined(GROUND_ATMOSPHERE)
out vec3 v_atmosphereRayleighColor;
out vec3 v_atmosphereMieColor;
out float v_atmosphereOpacity;
#endif

#ifdef ENABLE_CLIPPING_POLYGONS
uniform highp sampler2D u_clippingExtents;
out vec2 v_clippingPosition;
flat out int v_regionIndex;
#endif

// These functions are generated at runtime.
vec4 getPosition(vec3 position, float height, vec2 textureCoordinates);
float get2DYPositionFraction(vec2 textureCoordinates);

vec4 getPosition3DMode(vec3 position, float height, vec2 textureCoordinates)
{
    return u_modifiedModelViewProjection * vec4(position, 1.0);
}

float get2DMercatorYPositionFraction(vec2 textureCoordinates)
{
    // The width of a tile at level 11, in radians and assuming a single root tile, is
    //   2.0 * czm_pi / pow(2.0, 11.0)
    // We want to just linearly interpolate the 2D position from the texture coordinates
    // when we're at this level or higher.  The constant below is the expression
    // above evaluated and then rounded up at the 4th significant digit.
    const float maxTileWidth = 0.003068;
    float positionFraction = textureCoordinates.y;
    float southLatitude = u_southAndNorthLatitude.x;
    float northLatitude = u_southAndNorthLatitude.y;
    if (northLatitude - southLatitude > maxTileWidth)
    {
        float southMercatorY = u_southMercatorYAndOneOverHeight.x;
        float oneOverMercatorHeight = u_southMercatorYAndOneOverHeight.y;

        float currentLatitude = mix(southLatitude, northLatitude, textureCoordinates.y);
        currentLatitude = clamp(currentLatitude, -czm_webMercatorMaxLatitude, czm_webMercatorMaxLatitude);
        positionFraction = czm_latitudeToWebMercatorFraction(currentLatitude, southMercatorY, oneOverMercatorHeight);
    }
    return positionFraction;
}

float get2DGeographicYPositionFraction(vec2 textureCoordinates)
{
    return textureCoordinates.y;
}

vec4 getPositionPlanarEarth(vec3 position, float height, vec2 textureCoordinates)
{
    float yPositionFraction = get2DYPositionFraction(textureCoordinates);
    vec4 rtcPosition2D = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);
    return u_modifiedModelViewProjection * rtcPosition2D;
}

vec4 getPosition2DMode(vec3 position, float height, vec2 textureCoordinates)
{
    return getPositionPlanarEarth(position, 0.0, textureCoordinates);
}

vec4 getPositionColumbusViewMode(vec3 position, float height, vec2 textureCoordinates)
{
    return getPositionPlanarEarth(position, height, textureCoordinates);
}

vec4 getPositionMorphingMode(vec3 position, float height, vec2 textureCoordinates)
{
    // We do not do RTC while morphing, so there is potential for jitter.
    // This is unlikely to be noticeable, though.
    vec3 position3DWC = position + u_center3D;
    float yPositionFraction = get2DYPositionFraction(textureCoordinates);
    vec4 position2DWC = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);
    vec4 morphPosition = czm_columbusViewMorph(position2DWC, vec4(position3DWC, 1.0), czm_morphTime);
    return czm_modelViewProjection * morphPosition;
}

#ifdef QUANTIZATION_BITS12
uniform vec2 u_minMaxHeight;
uniform mat4 u_scaleAndBias;
#endif

void main()
{
#ifdef QUANTIZATION_BITS12
    vec2 xy = czm_decompressTextureCoordinates(compressed0.x);
    vec2 zh = czm_decompressTextureCoordinates(compressed0.y);
    vec3 position = vec3(xy, zh.x);
    float height = zh.y;
    vec2 textureCoordinates = czm_decompressTextureCoordinates(compressed0.z);

    height = height * (u_minMaxHeight.y - u_minMaxHeight.x) + u_minMaxHeight.x;
    position = (u_scaleAndBias * vec4(position, 1.0)).xyz;

#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)) && defined(INCLUDE_WEB_MERCATOR_Y) || defined(APPLY_MATERIAL)
    float webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;
    float encodedNormal = compressed1;
#elif defined(INCLUDE_WEB_MERCATOR_Y)
    float webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;
    float encodedNormal = 0.0;
#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)
    float webMercatorT = textureCoordinates.y;
    float encodedNormal = compressed0.w;
#else
    float webMercatorT = textureCoordinates.y;
    float encodedNormal = 0.0;
#endif

#else
    // A single float per element
    vec3 position = position3DAndHeight.xyz;
    float height = position3DAndHeight.w;
    vec2 textureCoordinates = textureCoordAndEncodedNormals.xy;

#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)) && defined(INCLUDE_WEB_MERCATOR_Y)
    float webMercatorT = textureCoordAndEncodedNormals.z;
    float encodedNormal = textureCoordAndEncodedNormals.w;
#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)
    float webMercatorT = textureCoordinates.y;
    float encodedNormal = textureCoordAndEncodedNormals.z;
#elif defined(INCLUDE_WEB_MERCATOR_Y)
    float webMercatorT = textureCoordAndEncodedNormals.z;
    float encodedNormal = 0.0;
#else
    float webMercatorT = textureCoordinates.y;
    float encodedNormal = 0.0;
#endif

#endif

    vec3 position3DWC = position + u_center3D;

#ifdef GEODETIC_SURFACE_NORMALS
    vec3 ellipsoidNormal = geodeticSurfaceNormal;
#else
    vec3 ellipsoidNormal = normalize(position3DWC);
#endif

#if defined(EXAGGERATION) && defined(GEODETIC_SURFACE_NORMALS)
    float exaggeration = u_verticalExaggerationAndRelativeHeight.x;
    float relativeHeight = u_verticalExaggerationAndRelativeHeight.y;
    float newHeight = (height - relativeHeight) * exaggeration + relativeHeight;

    // stop from going through center of earth
    float minRadius = min(min(czm_ellipsoidRadii.x, czm_ellipsoidRadii.y), czm_ellipsoidRadii.z);
    newHeight = max(newHeight, -minRadius);

    vec3 offset = ellipsoidNormal * (newHeight - height);
    position += offset;
    position3DWC += offset;
    height = newHeight;
#endif

    gl_Position = getPosition(position, height, textureCoordinates);

    v_positionEC = (u_modifiedModelView * vec4(position, 1.0)).xyz;
    v_positionMC = position3DWC;  // position in model coordinates

    v_textureCoordinates = vec3(textureCoordinates, webMercatorT);

#if defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)
    vec3 normalMC = czm_octDecode(encodedNormal);

#if defined(EXAGGERATION) && defined(GEODETIC_SURFACE_NORMALS)
    vec3 projection = dot(normalMC, ellipsoidNormal) * ellipsoidNormal;
    vec3 rejection = normalMC - projection;
    normalMC = normalize(projection + rejection * exaggeration);
#endif

    v_normalMC = normalMC;
    v_normalEC = czm_normal3D * v_normalMC;
#endif

#ifdef ENABLE_CLIPPING_POLYGONS
    vec2 sphericalLatLong = czm_approximateSphericalCoordinates(position3DWC);
    sphericalLatLong.y = czm_branchFreeTernary(sphericalLatLong.y < czm_pi, sphericalLatLong.y, sphericalLatLong.y - czm_twoPi);
    
    vec2 minDistance = vec2(czm_infinity);
    v_clippingPosition = vec2(czm_infinity);
    v_regionIndex = -1;

    for (int regionIndex = 0; regionIndex < CLIPPING_POLYGON_REGIONS_LENGTH; regionIndex++) {
        vec4 extents = unpackClippingExtents(u_clippingExtents, regionIndex);
        vec2 rectUv = (sphericalLatLong.yx - extents.yx) * extents.wz;

        vec2 clamped = clamp(rectUv, vec2(0.0), vec2(1.0));
        vec2 distance = abs(rectUv - clamped) * extents.wz;

        float threshold = 0.01;
        if (minDistance.x > distance.x || minDistance.y > distance.y) {
            minDistance = distance;
            v_clippingPosition = rectUv;
            if (rectUv.x > threshold && rectUv.y > threshold && rectUv.x < 1.0 - threshold && rectUv.y < 1.0 - threshold) {
                v_regionIndex = regionIndex;
            }
        }
    }
#endif

#if defined(FOG) || (defined(GROUND_ATMOSPHERE) && !defined(PER_FRAGMENT_GROUND_ATMOSPHERE))

    bool dynamicLighting = false;

    #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_DAYNIGHT_SHADING) || defined(ENABLE_VERTEX_LIGHTING))
        dynamicLighting = true;
    #endif

#if defined(DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN)
    vec3 atmosphereLightDirection = czm_sunDirectionWC;
#else
    vec3 atmosphereLightDirection = czm_lightDirectionWC;
#endif

    vec3 lightDirection = czm_branchFreeTernary(dynamicLighting, atmosphereLightDirection, normalize(position3DWC));

    computeAtmosphereScattering(
        position3DWC,
        lightDirection,
        v_atmosphereRayleighColor,
        v_atmosphereMieColor,
        v_atmosphereOpacity
    );
#endif

#if defined(FOG) || defined(GROUND_ATMOSPHERE) || defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)
    v_distance = length((czm_modelView3D * vec4(position3DWC, 1.0)).xyz);
#endif

#ifdef APPLY_MATERIAL
    float northPoleZ = czm_ellipsoidRadii.z;
    vec3 northPolePositionMC = vec3(0.0, 0.0, northPoleZ);
    vec3 vectorEastMC = normalize(cross(northPolePositionMC - v_positionMC, ellipsoidNormal));
    float dotProd = abs(dot(ellipsoidNormal, v_normalMC));
    v_slope = acos(dotProd);
    vec3 normalRejected = ellipsoidNormal * dotProd;
    vec3 normalProjected = v_normalMC - normalRejected;
    vec3 aspectVector = normalize(normalProjected);
    v_aspect = acos(dot(aspectVector, vectorEastMC));
    float determ = dot(cross(vectorEastMC, aspectVector), ellipsoidNormal);
    v_aspect = czm_branchFreeTernary(determ < 0.0, 2.0 * czm_pi - v_aspect, v_aspect);
    v_height = height;
#endif
}
`;var ID=`void computeAtmosphereScattering(vec3 positionWC, vec3 lightDirection, out vec3 rayleighColor, out vec3 mieColor, out float opacity) {

    vec3 cameraToPositionWC = positionWC - czm_viewerPositionWC;
    vec3 cameraToPositionWCDirection = normalize(cameraToPositionWC);
    czm_ray primaryRay = czm_ray(czm_viewerPositionWC, cameraToPositionWCDirection);
    
    float atmosphereInnerRadius = length(positionWC);

    computeScattering(
        primaryRay,
        length(cameraToPositionWC),
        lightDirection,
        atmosphereInnerRadius,
        rayleighColor,
        mieColor,
        opacity
    );
}
`;var hlt=new H;function mlt(e,t){let n=e.unionClippingRegions,i=e.length,o=As.useFloatTexture(t),r=As.getTextureResolution(e,t,hlt),s=r.x,a=r.y,c=o?glt(s,a):ylt(s,a);return c+=`
`,c+=n?plt(i):_lt(i),c}function plt(e){return`float clip(vec4 fragCoord, sampler2D clippingPlanes, mat4 clippingPlanesMatrix)
{
    vec4 position = czm_windowToEyeCoordinates(fragCoord);
    vec3 clipNormal = vec3(0.0);
    vec3 clipPosition = vec3(0.0);
    float clipAmount;
    float pixelWidth = czm_metersPerPixel(position);
    bool breakAndDiscard = false;
    for (int i = 0; i < ${e}; ++i)
    {
        vec4 clippingPlane = getClippingPlane(clippingPlanes, i, clippingPlanesMatrix);
        clipNormal = clippingPlane.xyz;
        clipPosition = -clippingPlane.w * clipNormal;
        float amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;
        clipAmount = czm_branchFreeTernary(i == 0, amount, min(amount, clipAmount));
        if (amount <= 0.0)
        {
           breakAndDiscard = true;
           break;
        }
    }
    if (breakAndDiscard) {
        discard;
    }
    return clipAmount;
}
`}function _lt(e){return`float clip(vec4 fragCoord, sampler2D clippingPlanes, mat4 clippingPlanesMatrix)
{
    bool clipped = true;
    vec4 position = czm_windowToEyeCoordinates(fragCoord);
    vec3 clipNormal = vec3(0.0);
    vec3 clipPosition = vec3(0.0);
    float clipAmount = 0.0;
    float pixelWidth = czm_metersPerPixel(position);
    for (int i = 0; i < ${e}; ++i)
    {
        vec4 clippingPlane = getClippingPlane(clippingPlanes, i, clippingPlanesMatrix);
        clipNormal = clippingPlane.xyz;
        clipPosition = -clippingPlane.w * clipNormal;
        float amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;
        clipAmount = max(amount, clipAmount);
        clipped = clipped && (amount <= 0.0);
    }
    if (clipped)
    {
        discard;
    }
    return clipAmount;
}
`}function glt(e,t){let n=1/e,i=1/t,o=`${n}`;o.indexOf(".")===-1&&(o+=".0");let r=`${i}`;return r.indexOf(".")===-1&&(r+=".0"),`vec4 getClippingPlane(highp sampler2D packedClippingPlanes, int clippingPlaneNumber, mat4 transform)
{
    int pixY = clippingPlaneNumber / ${e};
    int pixX = clippingPlaneNumber - (pixY * ${e});
    float u = (float(pixX) + 0.5) * ${o};
    float v = (float(pixY) + 0.5) * ${r};
    vec4 plane = texture(packedClippingPlanes, vec2(u, v));
    return czm_transformPlane(plane, transform);
}
`}function ylt(e,t){let n=1/e,i=1/t,o=`${n}`;o.indexOf(".")===-1&&(o+=".0");let r=`${i}`;return r.indexOf(".")===-1&&(r+=".0"),`vec4 getClippingPlane(highp sampler2D packedClippingPlanes, int clippingPlaneNumber, mat4 transform)
{
    int clippingPlaneStartIndex = clippingPlaneNumber * 2;
    int pixY = clippingPlaneStartIndex / ${e};
    int pixX = clippingPlaneStartIndex - (pixY * ${e});
    float u = (float(pixX) + 0.5) * ${o};
    float v = (float(pixY) + 0.5) * ${r};
    vec4 oct32 = texture(packedClippingPlanes, vec2(u, v)) * 255.0;
    vec2 oct = vec2(oct32.x * 256.0 + oct32.y, oct32.z * 256.0 + oct32.w);
    vec4 plane;
    plane.xyz = czm_octDecode(oct, 65535.0);
    plane.w = czm_unpackFloat(texture(packedClippingPlanes, vec2(u + ${o}, v)));
    return czm_transformPlane(plane, transform);
}
`}var Q0=mlt;function xlt(e,t,n,i,o,r){this.numberOfDayTextures=e,this.flags=t,this.material=n,this.shaderProgram=i,this.clippingShaderState=o,this.clippingPolygonShaderState=r}function QX(){this.baseVertexShaderSource=void 0,this.baseFragmentShaderSource=void 0,this._shadersByTexturesFlags=[],this.material=void 0}function blt(e){let t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPosition3DMode(position, height, textureCoordinates); }",n="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionColumbusViewMode(position, height, textureCoordinates); }",i="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionMorphingMode(position, height, textureCoordinates); }",o;switch(e){case ne.SCENE3D:o=t;break;case ne.SCENE2D:case ne.COLUMBUS_VIEW:o=n;break;case ne.MORPHING:o=i;break}return o}function Clt(e){return e.webgl2?`void clipPolygons(highp sampler2D clippingDistance, int regionsLength, vec2 clippingPosition, int regionIndex) {
    czm_clipPolygons(clippingDistance, regionsLength, clippingPosition, regionIndex);
  }`:`void clipPolygons(highp sampler2D clippingDistance, int regionsLength, vec2 clippingPosition, int regionIndex) {
    }`}function Alt(e){return e.webgl2?`vec4 unpackClippingExtents(highp sampler2D extentsTexture, int index) {
    return czm_unpackClippingExtents(extentsTexture, index);
  }`:`vec4 unpackClippingExtents(highp sampler2D extentsTexture, int index) {
      return vec4();
    }`}function Tlt(e){return e?"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DMercatorYPositionFraction(textureCoordinates); }":"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DGeographicYPositionFraction(textureCoordinates); }"}QX.prototype.getShaderProgram=function(e){let t=e.frameState,n=e.surfaceTile,i=e.numberOfDayTextures,o=e.applyBrightness,r=e.applyContrast,s=e.applyHue,a=e.applySaturation,c=e.applyGamma,l=e.applyAlpha,f=e.applyDayNightAlpha,d=e.applySplit,p=e.hasWaterMask,g=e.showReflectiveOcean,m=e.showOceanWaves,y=e.enableLighting,b=e.dynamicAtmosphereLighting,C=e.dynamicAtmosphereLightingFromSun,A=e.showGroundAtmosphere,T=e.perFragmentGroundAtmosphere,E=e.hasVertexNormals,v=e.useWebMercatorProjection,D=e.enableFog,O=e.enableClippingPlanes,P=e.clippingPlanes,M=e.enableClippingPolygons,L=e.clippingPolygons,_=e.clippedByBoundaries,S=e.hasImageryLayerCutout,w=e.colorCorrect,I=e.highlightFillTile,N=e.colorToAlpha,k=e.hasGeodeticSurfaceNormals,z=e.hasExaggeration,V=e.showUndergroundColor,U=e.translucent,B=0,W="",Q=n.renderedMesh.encoding;Q.quantization===pa.BITS12&&(B=1,W="QUANTIZATION_BITS12");let X=0,Z="";_&&(X=1,Z="TILE_LIMIT_RECTANGLE");let fe=0,xe="";S&&(fe=1,xe="APPLY_IMAGERY_CUTOUT");let re=t.mode,pe=re|o<<2|r<<3|s<<4|a<<5|c<<6|l<<7|p<<8|g<<9|m<<10|y<<11|b<<12|C<<13|A<<14|T<<15|E<<16|v<<17|D<<18|B<<19|d<<20|O<<21|M<<22|X<<23|fe<<24|w<<25|I<<26|N<<27|k<<28|z<<29|V<<30|U<<31|f<<32,ye=0;u(P)&&P.length>0&&(ye=O?P.clippingPlanesState:0);let Se=0;u(L)&&L.length>0&&(Se=M?L.clippingPolygonsState:0);let Te=n.surfaceShader;if(u(Te)&&Te.numberOfDayTextures===i&&Te.flags===pe&&Te.material===this.material&&Te.clippingShaderState===ye&&Te.clippingPolygonShaderState===Se)return Te.shaderProgram;let Fe=this._shadersByTexturesFlags[i];if(u(Fe)||(Fe=this._shadersByTexturesFlags[i]=[]),Te=Fe[pe],!u(Te)||Te.material!==this.material||Te.clippingShaderState!==ye||Te.clippingPolygonShaderState!==Se){let Ve=this.baseVertexShaderSource.clone(),Ze=this.baseFragmentShaderSource.clone();ye!==0&&Ze.sources.unshift(Q0(P,t.context)),Se!==0&&(Ze.sources.unshift(Clt(t.context)),Ve.sources.unshift(Alt(t.context))),Ve.defines.push(W),Ze.defines.push(`TEXTURE_UNITS ${i}`,Z,xe),o&&Ze.defines.push("APPLY_BRIGHTNESS"),r&&Ze.defines.push("APPLY_CONTRAST"),s&&Ze.defines.push("APPLY_HUE"),a&&Ze.defines.push("APPLY_SATURATION"),c&&Ze.defines.push("APPLY_GAMMA"),l&&Ze.defines.push("APPLY_ALPHA"),f&&Ze.defines.push("APPLY_DAY_NIGHT_ALPHA"),p&&Ze.defines.push("HAS_WATER_MASK"),g&&(Ze.defines.push("SHOW_REFLECTIVE_OCEAN"),Ve.defines.push("SHOW_REFLECTIVE_OCEAN")),m&&Ze.defines.push("SHOW_OCEAN_WAVES"),N&&Ze.defines.push("APPLY_COLOR_TO_ALPHA"),V&&(Ve.defines.push("UNDERGROUND_COLOR"),Ze.defines.push("UNDERGROUND_COLOR")),U&&(Ve.defines.push("TRANSLUCENT"),Ze.defines.push("TRANSLUCENT")),y&&(E?(Ve.defines.push("ENABLE_VERTEX_LIGHTING"),Ze.defines.push("ENABLE_VERTEX_LIGHTING")):(Ve.defines.push("ENABLE_DAYNIGHT_SHADING"),Ze.defines.push("ENABLE_DAYNIGHT_SHADING"))),b&&(Ve.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING"),Ze.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING"),C&&(Ve.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN"),Ze.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN"))),A&&(Ve.defines.push("GROUND_ATMOSPHERE"),Ze.defines.push("GROUND_ATMOSPHERE"),T&&(Ve.defines.push("PER_FRAGMENT_GROUND_ATMOSPHERE"),Ze.defines.push("PER_FRAGMENT_GROUND_ATMOSPHERE"))),Ve.defines.push("INCLUDE_WEB_MERCATOR_Y"),Ze.defines.push("INCLUDE_WEB_MERCATOR_Y"),D&&(Ve.defines.push("FOG"),Ze.defines.push("FOG")),d&&Ze.defines.push("APPLY_SPLIT"),O&&Ze.defines.push("ENABLE_CLIPPING_PLANES"),M&&(Ze.defines.push("ENABLE_CLIPPING_POLYGONS"),Ve.defines.push("ENABLE_CLIPPING_POLYGONS"),L.inverse&&Ze.defines.push("CLIPPING_INVERSE"),Ze.defines.push(`CLIPPING_POLYGON_REGIONS_LENGTH ${L.extentsCount}`),Ve.defines.push(`CLIPPING_POLYGON_REGIONS_LENGTH ${L.extentsCount}`)),w&&Ze.defines.push("COLOR_CORRECT"),I&&Ze.defines.push("HIGHLIGHT_FILL_TILE"),k&&Ve.defines.push("GEODETIC_SURFACE_NORMALS"),z&&Ve.defines.push("EXAGGERATION");let gt=`    vec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates, float nightBlend)
    {
        vec4 color = initialColor;
`;S&&(gt+=`        vec4 cutoutAndColorResult;
        bool texelUnclipped;
`);for(let Oe=0;Oe<i;++Oe)S?gt+=`        cutoutAndColorResult = u_dayTextureCutoutRectangles[${Oe}];
        texelUnclipped = v_textureCoordinates.x < cutoutAndColorResult.x || cutoutAndColorResult.z < v_textureCoordinates.x || v_textureCoordinates.y < cutoutAndColorResult.y || cutoutAndColorResult.w < v_textureCoordinates.y;
        cutoutAndColorResult = sampleAndBlend(
`:gt+=`        color = sampleAndBlend(
`,gt+=`            color,
            u_dayTextures[${Oe}],
            u_dayTextureUseWebMercatorT[${Oe}] ? textureCoordinates.xz : textureCoordinates.xy,
            u_dayTextureTexCoordsRectangle[${Oe}],
            u_dayTextureTranslationAndScale[${Oe}],
            ${l?`u_dayTextureAlpha[${Oe}]`:"1.0"},
            ${f?`u_dayTextureNightAlpha[${Oe}]`:"1.0"},
${f?`u_dayTextureDayAlpha[${Oe}]`:"1.0"},
${o?`u_dayTextureBrightness[${Oe}]`:"0.0"},
            ${r?`u_dayTextureContrast[${Oe}]`:"0.0"},
            ${s?`u_dayTextureHue[${Oe}]`:"0.0"},
            ${a?`u_dayTextureSaturation[${Oe}]`:"0.0"},
            ${c?`u_dayTextureOneOverGamma[${Oe}]`:"0.0"},
            ${d?`u_dayTextureSplit[${Oe}]`:"0.0"},
            ${N?`u_colorsToAlpha[${Oe}]`:"vec4(0.0)"},
        nightBlend        );
`,S&&(gt+=`        color = czm_branchFreeTernary(texelUnclipped, cutoutAndColorResult, color);
`);gt+=`        return color;
    }`,Ze.sources.push(gt),Ve.sources.push(blt(re)),Ve.sources.push(Tlt(v));let lt=tn.fromCache({context:t.context,vertexShaderSource:Ve,fragmentShaderSource:Ze,attributeLocations:Q.getAttributeLocations()});Te=Fe[pe]=new xlt(i,pe,this.material,lt,ye,Se)}return n.surfaceShader=Te,Te.shaderProgram};QX.prototype.destroy=function(){let e,t,n=this._shadersByTexturesFlags;for(let i in n)if(n.hasOwnProperty(i)){let o=n[i];if(!u(o))continue;for(e in o)o.hasOwnProperty(e)&&(t=o[e],u(t)&&t.shaderProgram.destroy())}return ue(this)};var gU=QX;var Elt={UNLOADED:0,TRANSITIONING:1,RECEIVED:2,TEXTURE_LOADED:3,READY:4,FAILED:5,INVALID:6,PLACEHOLDER:7},ci=Object.freeze(Elt);var Slt={START:0,LOADING:1,DONE:2,FAILED:3},ga=Object.freeze(Slt);var vlt={FAILED:0,UNLOADED:1,RECEIVING:2,RECEIVED:3,TRANSFORMING:4,TRANSFORMED:5,READY:6},yo=Object.freeze(vlt);function tr(){this.imagery=[],this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new oe(0,0,1,1),this.terrainData=void 0,this.vertexArray=void 0,this.tileBoundingRegion=void 0,this.occludeePointInScaledSpace=new h,this.boundingVolumeSourceTile=void 0,this.boundingVolumeIsFromMesh=!1,this.terrainState=yo.UNLOADED,this.mesh=void 0,this.fill=void 0,this.pickBoundingSphere=new ae,this.surfaceShader=void 0,this.isClipped=!0,this.clippedByBoundaries=!1}Object.defineProperties(tr.prototype,{eligibleForUnloading:{get:function(){let e=this.terrainState,n=!(e===yo.RECEIVING||e===yo.TRANSFORMING),i=this.imagery;for(let o=0,r=i.length;n&&o<r;++o){let s=i[o];n=!u(s.loadingImagery)||s.loadingImagery.state!==ci.TRANSITIONING}return n}},renderedMesh:{get:function(){if(u(this.vertexArray))return this.mesh;if(u(this.fill))return this.fill.mesh}}});var wlt=new de;function JX(e,t,n,i,o,r){let s=e.getExaggeratedPosition(i,o,r);if(u(t)&&t!==ne.SCENE3D){let c=n.ellipsoid.cartesianToCartographic(s,wlt);s=n.project(c,r),s=h.fromElements(s.z,s.x,s.y,r)}return s}var Dlt=new h,Ilt=new h,Plt=new h;tr.prototype.pick=function(e,t,n,i,o){let r=this.renderedMesh;if(!u(r))return;let s=r.vertices,a=r.indices,c=r.encoding,l=a.length,f=Number.MAX_VALUE;for(let d=0;d<l;d+=3){let p=a[d],g=a[d+1],m=a[d+2],y=JX(c,t,n,s,p,Dlt),b=JX(c,t,n,s,g,Ilt),C=JX(c,t,n,s,m,Plt),A=Qn.rayTriangleParametric(e,y,b,C,i);u(A)&&A<f&&A>=0&&(f=A)}return f!==Number.MAX_VALUE?_n.getPoint(e,f,o):void 0};tr.prototype.freeResources=function(){u(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,this.waterMaskTexture.referenceCount===0&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0),this.terrainData=void 0,this.terrainState=yo.UNLOADED,this.mesh=void 0,this.fill=this.fill&&this.fill.destroy();let e=this.imagery;for(let t=0,n=e.length;t<n;++t)e[t].freeResources();this.imagery.length=0,this.freeVertexArray()};tr.prototype.freeVertexArray=function(){tr._freeVertexArray(this.vertexArray),this.vertexArray=void 0,tr._freeVertexArray(this.wireframeVertexArray),this.wireframeVertexArray=void 0};tr.initialize=function(e,t,n){let i=e.data;u(i)||(i=e.data=new tr),e.state===ga.START&&(Rlt(e,t,n),e.state=ga.LOADING)};tr.processStateMachine=function(e,t,n,i,o,r,s){tr.initialize(e,n,i);let a=e.data;if(e.state===ga.LOADING&&Olt(e,t,n,i,o,r),s)return;let c=e.renderable;e.renderable=u(a.vertexArray);let l=a.terrainState===yo.READY;e.upsampledFromParent=u(a.terrainData)&&a.terrainData.wasCreatedByUpsampling();let f=a.processImagery(e,n,t);if(l&&f){let d=e._loadedCallbacks,p={};for(let g in d)d.hasOwnProperty(g)&&(d[g](e)||(p[g]=d[g]));e._loadedCallbacks=p,e.state=ga.DONE}c&&(e.renderable=!0)};tr.prototype.processImagery=function(e,t,n,i){let o=e.data,r=e.upsampledFromParent,s=!1,a=!0,c=o.imagery,l,f;for(l=0,f=c.length;l<f;++l){let d=c[l];if(!u(d.loadingImagery)){r=!1;continue}if(d.loadingImagery.state===ci.PLACEHOLDER){let g=d.loadingImagery.imageryLayer;if(g.ready){d.freeResources(),c.splice(l,1),g._createTileImagerySkeletons(e,t,l),--l,f=c.length;continue}else r=!1}let p=d.processStateMachine(e,n,i);a=a&&p,s=s||p||u(d.readyImagery),r=r&&u(d.loadingImagery)&&(d.loadingImagery.state===ci.FAILED||d.loadingImagery.state===ci.INVALID)}return e.upsampledFromParent=r,e.renderable=e.renderable&&(s||a),a};function nxe(e,t,n,i){let o=e.renderedMesh,r=o.vertices,s=o.encoding,a=r.length/s.stride,c=Zc.clone(s);c.hasGeodeticSurfaceNormals=t,c=Zc.clone(c);let l=c.stride,f=new Float32Array(a*l);t?s.addGeodeticSurfaceNormals(r,f,n):s.removeGeodeticSurfaceNormals(r,f),o.vertices=f,o.stride=l,o!==e.mesh?(tr._freeVertexArray(e.fill.vertexArray),e.fill.vertexArray=tr._createVertexArrayForMesh(i.context,o)):(tr._freeVertexArray(e.vertexArray),e.vertexArray=tr._createVertexArrayForMesh(i.context,o)),tr._freeVertexArray(e.wireframeVertexArray),e.wireframeVertexArray=void 0}tr.prototype.addGeodeticSurfaceNormals=function(e,t){nxe(this,!0,e,t)};tr.prototype.removeGeodeticSurfaceNormals=function(e){nxe(this,!1,void 0,e)};tr.prototype.updateExaggeration=function(e,t,n){let i=this,o=i.renderedMesh;if(o===void 0)return;let r=t.verticalExaggeration,s=t.verticalExaggerationRelativeHeight,a=r!==1,c=o.encoding,l=c.exaggeration!==r,f=c.exaggerationRelativeHeight!==s;if(l||f){if(l)if(a&&!c.hasGeodeticSurfaceNormals){let d=e.tilingScheme.ellipsoid;i.addGeodeticSurfaceNormals(d,t)}else!a&&c.hasGeodeticSurfaceNormals&&i.removeGeodeticSurfaceNormals(t);if(c.exaggeration=r,c.exaggerationRelativeHeight=s,n!==void 0){n._tileToUpdateHeights.push(e);let d=e.customData,p=d.length;for(let g=0;g<p;g++){let m=d[g];m.level=-1}}}};function Rlt(e,t,n){let i=t.getTileDataAvailable(e.x,e.y,e.level);if(!u(i)&&u(e.parent)){let o=e.parent,r=o.data;u(r)&&u(r.terrainData)&&(i=r.terrainData.isChildAvailable(o.x,o.y,e.x,e.y))}i===!1&&(e.data.terrainState=yo.FAILED);for(let o=0,r=n.length;o<r;++o){let s=n.get(o);s.show&&s._createTileImagerySkeletons(e,t)}}function Olt(e,t,n,i,o,r){let s=e.data,a=e.parent;if(s.terrainState===yo.FAILED&&a!==void 0&&(a.data!==void 0&&a.data.terrainData!==void 0&&a.data.terrainData.canUpsample!==!1||tr.processStateMachine(a,t,n,i,o,r,!0)),s.terrainState===yo.FAILED&&Mlt(s,e,t,n,e.x,e.y,e.level),s.terrainState===yo.UNLOADED&&Llt(s,n,e.x,e.y,e.level),s.terrainState===yo.RECEIVED&&Flt(s,t,n,e.x,e.y,e.level),s.terrainState===yo.TRANSFORMED&&(Blt(s,t.context,n,e.x,e.y,e.level,r),s.updateExaggeration(e,t,o)),s.terrainState>=yo.RECEIVED&&s.waterMaskTexture===void 0&&n.hasWaterMask)if(s.terrainData.waterMask!==void 0)Vlt(t.context,s);else{let l=s._findAncestorTileWithTerrainData(e);u(l)&&u(l.data.waterMaskTexture)&&(s.waterMaskTexture=l.data.waterMaskTexture,++s.waterMaskTexture.referenceCount,s._computeWaterMaskTranslationAndScale(e,l,s.waterMaskTranslationAndScale))}}function Mlt(e,t,n,i,o,r,s){let a=t.parent;if(!a){t.state=ga.FAILED;return}let c=a.data.terrainData,l=a.x,f=a.y,d=a.level;if(!u(c))return;let p=c.upsample(i.tilingScheme,l,f,d,o,r,s);u(p)&&(e.terrainState=yo.RECEIVING,Promise.resolve(p).then(function(g){u(g)&&(e.terrainData=g,e.terrainState=yo.RECEIVED)}).catch(function(){e.terrainState=yo.FAILED}))}function Llt(e,t,n,i,o){function r(c){if(!u(c)){e.terrainState=yo.UNLOADED,e.request=void 0;return}e.terrainData=c,e.terrainState=yo.RECEIVED,e.request=void 0}function s(c){if(e.request.state===$n.CANCELLED){e.terrainData=void 0,e.terrainState=yo.UNLOADED,e.request=void 0;return}e.terrainState=yo.FAILED,e.request=void 0;let l=`Failed to obtain terrain tile X: ${n} Y: ${i} Level: ${o}. Error message: "${c}"`;t._requestError=Oo.reportError(t._requestError,t,t.errorEvent,l,n,i,o),t._requestError.retry&&a()}function a(){let c=new rr({throttle:!1,throttleByServer:!0,type:gs.TERRAIN});e.request=c;let l=t.requestTileGeometry(n,i,o,c);u(l)?(e.terrainState=yo.RECEIVING,Promise.resolve(l).then(function(f){r(f)}).catch(function(f){s(f)})):(e.terrainState=yo.UNLOADED,e.request=void 0)}a()}var Nlt={tilingScheme:void 0,x:0,y:0,level:0,exaggeration:1,exaggerationRelativeHeight:0,throttle:!0};function Flt(e,t,n,i,o,r){let s=n.tilingScheme,a=Nlt;a.tilingScheme=s,a.x=i,a.y=o,a.level=r,a.exaggeration=t.verticalExaggeration,a.exaggerationRelativeHeight=t.verticalExaggerationRelativeHeight,a.throttle=!0;let l=e.terrainData.createMesh(a);u(l)&&(e.terrainState=yo.TRANSFORMING,Promise.resolve(l).then(function(f){e.mesh=f,e.terrainState=yo.TRANSFORMED}).catch(function(){e.terrainState=yo.FAILED}))}tr._createVertexArrayForMesh=function(e,t){let n=t.vertices,i=xt.createVertexBuffer({context:e,typedArray:n,usage:ke.STATIC_DRAW}),o=t.encoding.getAttributes(i),r=t.indices.indexBuffers||{},s=r[e.id];if(!u(s)||s.isDestroyed()){let a=t.indices;s=xt.createIndexBuffer({context:e,typedArray:a,usage:ke.STATIC_DRAW,indexDatatype:Be.fromSizeInBytes(a.BYTES_PER_ELEMENT)}),s.vertexArrayDestroyable=!1,s.referenceCount=1,r[e.id]=s,t.indices.indexBuffers=r}else++s.referenceCount;return new ii({context:e,attributes:o,indexBuffer:s})};tr._freeVertexArray=function(e){if(u(e)){let t=e.indexBuffer;e.isDestroyed()||e.destroy(),u(t)&&!t.isDestroyed()&&u(t.referenceCount)&&(--t.referenceCount,t.referenceCount===0&&t.destroy())}};function Blt(e,t,n,i,o,r,s){e.vertexArray=tr._createVertexArrayForMesh(t,e.mesh),e.terrainState=yo.READY,e.fill=e.fill&&e.fill.destroy(s)}function klt(e){let t=e.cache.tile_waterMaskData;if(!u(t)){let n=Ot.create({context:e,pixelFormat:tt.LUMINANCE,pixelDatatype:Ke.UNSIGNED_BYTE,source:{arrayBufferView:new Uint8Array([255]),width:1,height:1}});n.referenceCount=1;let i=new Qt({wrapS:En.CLAMP_TO_EDGE,wrapT:En.CLAMP_TO_EDGE,minificationFilter:$t.LINEAR,magnificationFilter:mi.LINEAR});t={allWaterTexture:n,sampler:i,destroy:function(){this.allWaterTexture.destroy()}},e.cache.tile_waterMaskData=t}return t}function Vlt(e,t){let n=t.terrainData.waterMask,i=klt(e),o,r=n.length;if(r===1)if(n[0]!==0)o=i.allWaterTexture;else return;else{let s=Math.sqrt(r);o=Ot.create({context:e,pixelFormat:tt.LUMINANCE,pixelDatatype:Ke.UNSIGNED_BYTE,source:{width:s,height:s,arrayBufferView:n},sampler:i.sampler,flipY:!1}),o.referenceCount=0}++o.referenceCount,t.waterMaskTexture=o,oe.fromElements(0,0,1,1,t.waterMaskTranslationAndScale)}tr.prototype._findAncestorTileWithTerrainData=function(e){let t=e.parent;for(;u(t)&&(!u(t.data)||!u(t.data.terrainData)||t.data.terrainData.wasCreatedByUpsampling());)t=t.parent;return t};tr.prototype._computeWaterMaskTranslationAndScale=function(e,t,n){let i=t.rectangle,o=e.rectangle,r=o.width,s=o.height,a=r/i.width,c=s/i.height;return n.x=a*(o.west-i.west)/r,n.y=c*(o.south-i.south)/s,n.z=a,n.w=c,n};var sh=tr;var eK,ixe="AAPTxy8BH1VEsoebNVZXo8HurEOF051kAEKlhkOhBEc9BmQpcUfxe1Yndhf82d5oKkQJ4_7VPaBQGYSISOMaRew7Sy-eTX1JQ4XwaC8v5aCvV72O6LCPs5Ss1pXXH-0uEw6bSRhTeQYHOmikutC2OMyZt6lu0VfT7FA-jVMO_UsunWNTf2cycP2O4IeDN_UV9G-VNmUu2jRvCHioi8o72ua4238s2219cYLEmcoGRJGVJTA.AT1_PjLvyih0",VE={};VE.defaultAccessToken=ixe;VE.defaultWorldImageryServer=new De({url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"});VE.defaultWorldHillshadeServer=new De({url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"});VE.defaultWorldOceanServer=new De({url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"});VE.getDefaultTokenCredit=function(e){if(e===ixe){if(!u(eK)){let t='<b>             This application is using a default ArcGIS access token. Please assign <i>Cesium.ArcGisMapService.defaultAccessToken</i>             with an API key from your ArcGIS Developer account before using the ArcGIS tile services.             You can sign up for a free ArcGIS Developer account at <a href="https://developers.arcgis.com/">https://developers.arcgis.com/</a>.</b>';eK=new wt(t,!0)}return eK}};var jf=VE;function tK(e){e=x(e,x.EMPTY_OBJECT),this._pixelsToCheck=e.pixelsToCheck,this._missingImagePixels=void 0,this._missingImageByteLength=void 0,this._isReady=!1;let t=De.createIfNeeded(e.missingImageUrl),n=this;function i(r){u(r.blob)&&(n._missingImageByteLength=r.blob.size);let s=yh(r);if(e.disableCheckIfAllPixelsAreTransparent){let a=!0,c=r.width,l=e.pixelsToCheck;for(let f=0,d=l.length;a&&f<d;++f){let p=l[f],g=p.x*4+p.y*c;s[g+3]>0&&(a=!1)}a&&(s=void 0)}n._missingImagePixels=s,n._isReady=!0}function o(){n._missingImagePixels=void 0,n._isReady=!0}t.fetchImage({preferBlob:!0,preferImageBitmap:!0,flipY:!0}).then(i).catch(o)}tK.prototype.isReady=function(){return this._isReady};tK.prototype.shouldDiscardImage=function(e){let t=this._pixelsToCheck,n=this._missingImagePixels;if(!u(n)||u(e.blob)&&e.blob.size!==this._missingImageByteLength)return!1;let i=yh(e),o=e.width;for(let r=0,s=t.length;r<s;++r){let a=t[r],c=a.x*4+a.y*o;for(let l=0;l<4;++l){let f=c+l;if(i[f]!==n[f])return!1}}return!0};var yU=tK;function nK(){this.name=void 0,this.description=void 0,this.position=void 0,this.data=void 0,this.imageryLayer=void 0}nK.prototype.configureNameFromProperties=function(e){let t=10,n;for(let i in e)if(e.hasOwnProperty(i)&&e[i]){let o=i.toLowerCase();t>1&&o==="name"?(t=1,n=i):t>2&&o==="title"?(t=2,n=i):t>3&&/name/i.test(i)?(t=3,n=i):t>4&&/title/i.test(i)&&(t=4,n=i)}u(n)&&(this.name=e[n])};nK.prototype.configureDescriptionFromProperties=function(e){function t(n){let i='<table class="cesium-infoBox-defaultTable">';for(let o in n)if(n.hasOwnProperty(o)){let r=n[o];u(r)&&(typeof r=="object"?i+=`<tr><td>${o}</td><td>${t(r)}</td></tr>`:i+=`<tr><td>${o}</td><td>${r}</td></tr>`)}return i+="</table>",i}this.description=t(e)};var Mm=nK;function UE(){he.throwInstantiationError()}Object.defineProperties(UE.prototype,{rectangle:{get:he.throwInstantiationError},tileWidth:{get:he.throwInstantiationError},tileHeight:{get:he.throwInstantiationError},maximumLevel:{get:he.throwInstantiationError},minimumLevel:{get:he.throwInstantiationError},tilingScheme:{get:he.throwInstantiationError},tileDiscardPolicy:{get:he.throwInstantiationError},errorEvent:{get:he.throwInstantiationError},credit:{get:he.throwInstantiationError},proxy:{get:he.throwInstantiationError},hasAlphaChannel:{get:he.throwInstantiationError}});UE.prototype.getTileCredits=function(e,t,n){he.throwInstantiationError()};UE.prototype.requestImage=function(e,t,n,i){he.throwInstantiationError()};UE.prototype.pickFeatures=function(e,t,n,i,o){he.throwInstantiationError()};var Ult=/\.ktx2$/i;UE.loadImage=function(e,t){let n=De.createIfNeeded(t);return Ult.test(n.url)?jl(n):u(e)&&u(e.tileDiscardPolicy)?n.fetchImage({preferBlob:!0,preferImageBitmap:!0,flipY:!0}):n.fetchImage({preferImageBitmap:!0,flipY:!0})};var Fl=UE;var zlt={SATELLITE:1,OCEANS:2,HILLSHADE:3},Lm=Object.freeze(zlt);function oxe(e){this.useTiles=x(e.usePreCachedTilesIfAvailable,!0);let t=e.ellipsoid;this.tilingScheme=x(e.tilingScheme,new $i({ellipsoid:t})),this.rectangle=x(e.rectangle,this.tilingScheme.rectangle),this.ellipsoid=t;let n=e.credit;typeof n=="string"&&(n=new wt(n)),this.credit=n,this.tileCredits=void 0,this.tileDiscardPolicy=e.tileDiscardPolicy,this.tileWidth=x(e.tileWidth,256),this.tileHeight=x(e.tileHeight,256),this.maximumLevel=e.maximumLevel}oxe.prototype.build=function(e){e._useTiles=this.useTiles,e._tilingScheme=this.tilingScheme,e._rectangle=this.rectangle,e._credit=this.credit,e._tileCredits=this.tileCredits,e._tileDiscardPolicy=this.tileDiscardPolicy,e._tileWidth=this.tileWidth,e._tileHeight=this.tileHeight,e._maximumLevel=this.maximumLevel,this.useTiles&&!u(this.tileDiscardPolicy)&&(e._tileDiscardPolicy=new yU({missingImageUrl:rxe(e,0,0,this.maximumLevel).url,pixelsToCheck:[new H(0,0),new H(200,20),new H(20,200),new H(80,110),new H(160,130)],disableCheckIfAllPixelsAreTransparent:!0}))};function Hlt(e,t){let n=e.tileInfo;if(!u(n))t.useTiles=!1;else{if(t.tileWidth=n.rows,t.tileHeight=n.cols,n.spatialReference.wkid===102100||n.spatialReference.wkid===102113)t.tilingScheme=new hs({ellipsoid:t.ellipsoid});else if(e.tileInfo.spatialReference.wkid===4326)t.tilingScheme=new $i({ellipsoid:t.ellipsoid});else{let i=`Tile spatial reference WKID ${e.tileInfo.spatialReference.wkid} is not supported.`;throw new ce(i)}if(t.maximumLevel=e.tileInfo.lods.length-1,u(e.fullExtent)){if(u(e.fullExtent.spatialReference)&&u(e.fullExtent.spatialReference.wkid))if(e.fullExtent.spatialReference.wkid===102100||e.fullExtent.spatialReference.wkid===102113){let i=new Li,o=e.fullExtent,r=i.unproject(new h(Math.max(o.xmin,-t.tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.max(o.ymin,-t.tilingScheme.ellipsoid.maximumRadius*Math.PI),0)),s=i.unproject(new h(Math.min(o.xmax,t.tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.min(o.ymax,t.tilingScheme.ellipsoid.maximumRadius*Math.PI),0));t.rectangle=new se(r.longitude,r.latitude,s.longitude,s.latitude)}else if(e.fullExtent.spatialReference.wkid===4326)t.rectangle=se.fromDegrees(e.fullExtent.xmin,e.fullExtent.ymin,e.fullExtent.xmax,e.fullExtent.ymax);else{let i=`fullExtent.spatialReference WKID ${e.fullExtent.spatialReference.wkid} is not supported.`;throw new ce(i)}}else t.rectangle=t.tilingScheme.rectangle;t.useTiles=!0}u(e.copyrightText)&&e.copyrightText.length>0&&(u(t.credit)?t.tileCredits=[new wt(e.copyrightText)]:t.credit=new wt(e.copyrightText))}function Glt(e,t){let n=`An error occurred while accessing ${e.url}`;throw u(t)&&u(t.message)&&(n+=`: ${t.message}`),new ce(n)}async function Wlt(e,t){let n=e.getDerivedResource({queryParameters:{f:"json"}});try{let i=await n.fetchJson();Hlt(i,t)}catch(i){Glt(e,i)}}function Nm(e){e=x(e,x.EMPTY_OBJECT),this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._tileDiscardPolicy=e.tileDiscardPolicy,this._tileWidth=x(e.tileWidth,256),this._tileHeight=x(e.tileHeight,256),this._maximumLevel=e.maximumLevel,this._tilingScheme=x(e.tilingScheme,new $i({ellipsoid:e.ellipsoid})),this._useTiles=x(e.usePreCachedTilesIfAvailable,!0),this._rectangle=x(e.rectangle,this._tilingScheme.rectangle),this._layers=e.layers,this._credit=e.credit,this._tileCredits=void 0;let t=e.credit;typeof t=="string"&&(t=new wt(t)),this.enablePickFeatures=x(e.enablePickFeatures,!0),this._errorEvent=new me}Nm.fromBasemapType=async function(e,t){t=x(t,x.EMPTY_OBJECT);let n,i,o;switch(e){case Lm.SATELLITE:{n=x(t.token,jf.defaultAccessToken),i=De.createIfNeeded(jf.defaultWorldImageryServer),i.appendForwardSlash();let r=jf.getDefaultTokenCredit(n);u(r)&&(o=wt.clone(r))}break;case Lm.OCEANS:{n=x(t.token,jf.defaultAccessToken),i=De.createIfNeeded(jf.defaultWorldOceanServer),i.appendForwardSlash();let r=jf.getDefaultTokenCredit(n);u(r)&&(o=wt.clone(r))}break;case Lm.HILLSHADE:{n=x(t.token,jf.defaultAccessToken),i=De.createIfNeeded(jf.defaultWorldHillshadeServer),i.appendForwardSlash();let r=jf.getDefaultTokenCredit(n);u(r)&&(o=wt.clone(r))}break;default:}return Nm.fromUrl(i,{...t,token:n,credit:o,usePreCachedTilesIfAvailable:!0})};function rxe(e,t,n,i,o){let r;if(e._useTiles)r=e._resource.getDerivedResource({url:`tile/${i}/${n}/${t}`,request:o});else{let s=e._tilingScheme.tileXYToNativeRectangle(t,n,i),c={bbox:`${s.west},${s.south},${s.east},${s.north}`,size:`${e._tileWidth},${e._tileHeight}`,format:"png32",transparent:!0,f:"image"};e._tilingScheme.projection instanceof Oi?(c.bboxSR=4326,c.imageSR=4326):(c.bboxSR=3857,c.imageSR=3857),e.layers&&(c.layers=`show:${e.layers}`),r=e._resource.getDerivedResource({url:"export",request:o,queryParameters:c})}return r}Object.defineProperties(Nm.prototype,{url:{get:function(){return this._resource._url}},token:{get:function(){return this._resource.queryParameters.token}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},usingPrecachedTiles:{get:function(){return this._useTiles}},hasAlphaChannel:{get:function(){return!0}},layers:{get:function(){return this._layers}}});Nm.fromUrl=async function(e,t){t=x(t,x.EMPTY_OBJECT);let n=De.createIfNeeded(e);n.appendForwardSlash(),u(t.token)&&n.setQueryParameters({token:t.token});let i=new Nm(t);i._resource=n;let o=new oxe(t);return x(t.usePreCachedTilesIfAvailable,!0)&&await Wlt(n,o),o.build(i),i};Nm.prototype.getTileCredits=function(e,t,n){return this._tileCredits};Nm.prototype.requestImage=function(e,t,n,i){return Fl.loadImage(this,rxe(this,e,t,n,i))};Nm.prototype.pickFeatures=function(e,t,n,i,o){if(!this.enablePickFeatures)return;let r=this._tilingScheme.tileXYToNativeRectangle(e,t,n),s,a,c;if(this._tilingScheme.projection instanceof Oi)s=R.toDegrees(i),a=R.toDegrees(o),c="4326";else{let p=this._tilingScheme.projection.project(new de(i,o,0));s=p.x,a=p.y,c="3857"}let l="visible";u(this._layers)&&(l+=`:${this._layers}`);let f={f:"json",tolerance:2,geometryType:"esriGeometryPoint",geometry:`${s},${a}`,mapExtent:`${r.west},${r.south},${r.east},${r.north}`,imageDisplay:`${this._tileWidth},${this._tileHeight},96`,sr:c,layers:l};return this._resource.getDerivedResource({url:"identify",queryParameters:f}).fetchJson().then(function(p){let g=[],m=p.results;if(!u(m))return g;for(let y=0;y<m.length;++y){let b=m[y],C=new Mm;if(C.data=b,C.name=b.value,C.properties=b.attributes,C.configureDescriptionFromProperties(b.attributes),b.geometryType==="esriGeometryPoint"&&b.geometry){let A=b.geometry.spatialReference&&b.geometry.spatialReference.wkid?b.geometry.spatialReference.wkid:4326;if(A===4326||A===4283)C.position=de.fromDegrees(b.geometry.x,b.geometry.y,b.geometry.z);else if(A===102100||A===900913||A===3857){let T=new Li;C.position=T.unproject(new h(b.geometry.x,b.geometry.y,b.geometry.z))}}g.push(C)}return g})};Nm._metadataCache={};var J0=Nm;var jlt={AERIAL:"Aerial",AERIAL_WITH_LABELS:"AerialWithLabels",AERIAL_WITH_LABELS_ON_DEMAND:"AerialWithLabelsOnDemand",ROAD:"Road",ROAD_ON_DEMAND:"RoadOnDemand",CANVAS_DARK:"CanvasDark",CANVAS_LIGHT:"CanvasLight",CANVAS_GRAY:"CanvasGray",ORDNANCE_SURVEY:"OrdnanceSurvey",COLLINS_BART:"CollinsBart"},PD=Object.freeze(jlt);function RD(e){}RD.prototype.isReady=function(){return!0};RD.prototype.shouldDiscardImage=function(e){return RD.EMPTY_IMAGE===e};var xU;Object.defineProperties(RD,{EMPTY_IMAGE:{get:function(){return u(xU)||(xU=new Image,xU.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="),xU}}});var OD=RD;function sxe(e){this.tileWidth=void 0,this.tileHeight=void 0,this.maximumLevel=void 0,this.imageUrlSubdomains=void 0,this.imageUrlTemplate=void 0,this.attributionList=void 0}sxe.prototype.build=function(e){e._tileWidth=this.tileWidth,e._tileHeight=this.tileHeight,e._maximumLevel=this.maximumLevel,e._imageUrlSubdomains=this.imageUrlSubdomains,e._imageUrlTemplate=this.imageUrlTemplate;let t=e._attributionList=this.attributionList;t||(t=[]),e._attributionList=t;for(let n=0,i=t.length;n<i;++n){let o=t[n];if(o.credit instanceof wt)break;o.credit=new wt(o.attribution);let r=o.coverageAreas;for(let s=0,a=o.coverageAreas.length;s<a;++s){let c=r[s],l=c.bbox;c.bbox=new se(R.toRadians(l[1]),R.toRadians(l[0]),R.toRadians(l[3]),R.toRadians(l[2]))}}};function qlt(e,t){if(e.resourceSets.length!==1)throw new ce("metadata does not specify one resource in resourceSets");let n=e.resourceSets[0].resources[0];t.tileWidth=n.imageWidth,t.tileHeight=n.imageHeight,t.maximumLevel=n.zoomMax-1,t.imageUrlSubdomains=n.imageUrlSubdomains,t.imageUrlTemplate=n.imageUrl;let i=n.imageryProviders;u(n.imageryProviders)&&(i=n.imageryProviders.filter(o=>o.coverageAreas?.some(r=>u(r.bbox)))),t.attributionList=i}function Ylt(e,t,n){let i=`An error occurred while accessing ${e.url}`;throw u(t)&&u(t.message)&&(i+=`: ${t.message}`),Oo.reportError(void 0,n,u(n)?n._errorEvent:void 0,i,void 0,void 0,void 0,t),new ce(i)}async function Xlt(e,t,n){let i=e.url,o=Ds._metadataCache[i];u(o)||(o=e.fetchJsonp("jsonp"),Ds._metadataCache[i]=o);try{let r=await o;return qlt(r,t)}catch(r){Ylt(e,r,n)}}function Ds(e){e=x(e,x.EMPTY_OBJECT),this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=1,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._mapStyle=x(e.mapStyle,PD.AERIAL),this._mapLayer=e.mapLayer,this._culture=x(e.culture,""),this._key=e.key,this._tileDiscardPolicy=e.tileDiscardPolicy,u(this._tileDiscardPolicy)||(this._tileDiscardPolicy=new OD),this._proxy=e.proxy,this._credit=new wt(`<a href="https://www.microsoft.com/en-us/maps/bing-maps/product"><img src="${Ds.logoUrl}" title="Bing Imagery"/></a>`),this._tilingScheme=new hs({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:e.ellipsoid}),this._tileWidth=void 0,this._tileHeight=void 0,this._maximumLevel=void 0,this._imageUrlTemplate=void 0,this._imageUrlSubdomains=void 0,this._attributionList=void 0,this._errorEvent=new me}Object.defineProperties(Ds.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},key:{get:function(){return this._key}},mapStyle:{get:function(){return this._mapStyle}},mapLayer:{get:function(){return this._mapLayer}},culture:{get:function(){return this._culture}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return u(this.mapLayer)}}});Ds.fromUrl=async function(e,t){t=x(t,x.EMPTY_OBJECT);let n=t.tileProtocol;u(n)?n.length>0&&n[n.length-1]===":"&&(n=n.substr(0,n.length-1)):n=document.location.protocol==="http:"?"http":"https";let i=x(t.mapStyle,PD.AERIAL),o=De.createIfNeeded(e);o.appendForwardSlash();let r={incl:"ImageryProviders",key:t.key,uriScheme:n};u(t.mapLayer)&&(r.mapLayer=t.mapLayer),u(t.culture)&&(r.culture=t.culture);let s=o.getDerivedResource({url:`REST/v1/Imagery/Metadata/${i}`,queryParameters:r}),a=new Ds(t);a._resource=o;let c=new sxe(t);return await Xlt(s,c),c.build(a),a};var Klt=new se;Ds.prototype.getTileCredits=function(e,t,n){let i=this._tilingScheme.tileXYToRectangle(e,t,n,Klt);return Qlt(this._attributionList,n,i)};Ds.prototype.requestImage=function(e,t,n,i){let o=Fl.loadImage(this,Zlt(this,e,t,n,i));if(u(o))return o.catch(function(r){return u(r.blob)&&r.blob.size===0?OD.EMPTY_IMAGE:Promise.reject(r)})};Ds.prototype.pickFeatures=function(e,t,n,i,o){};Ds.tileXYToQuadKey=function(e,t,n){let i="";for(let o=n;o>=0;--o){let r=1<<o,s=0;e&r&&(s|=1),t&r&&(s|=2),i+=s}return i};Ds.quadKeyToTileXY=function(e){let t=0,n=0,i=e.length-1;for(let o=i;o>=0;--o){let r=1<<o,s=+e[i-o];s&1&&(t|=r),s&2&&(n|=r)}return{x:t,y:n,level:i}};Ds._logoUrl=void 0;Object.defineProperties(Ds,{logoUrl:{get:function(){return u(Ds._logoUrl)||(Ds._logoUrl=on("Assets/Images/bing_maps_credit.png")),Ds._logoUrl},set:function(e){Ds._logoUrl=e}}});function Zlt(e,t,n,i,o){let r=e._imageUrlTemplate,s=e._imageUrlSubdomains,a=(t+n+i)%s.length;return e._resource.getDerivedResource({url:r,request:o,templateValues:{quadkey:Ds.tileXYToQuadKey(t,n,i),subdomain:s[a],culture:e._culture},queryParameters:{n:"z"}})}var $lt=new se;function Qlt(e,t,n){++t;let i=[];for(let o=0,r=e.length;o<r;++o){let s=e[o],a=s.coverageAreas,c=!1;for(let l=0,f=s.coverageAreas.length;!c&&l<f;++l){let d=a[l];if(t>=d.zoomMin&&t<=d.zoomMax){let p=se.intersection(n,d.bbox,$lt);u(p)&&(c=!0)}}c&&i.push(s.credit)}return i}Ds._metadataCache={};var bU=Ds;var axe=/{[^}]+}/g,cxe={x:nut,y:out,z:aut,s:cut,reverseX:iut,reverseY:rut,reverseZ:sut,westDegrees:lut,southDegrees:uut,eastDegrees:fut,northDegrees:dut,westProjected:hut,southProjected:mut,eastProjected:put,northProjected:_ut,width:gut,height:yut},Jlt=bt(cxe,{i:xut,j:but,reverseI:Cut,reverseJ:Aut,longitudeDegrees:Eut,latitudeDegrees:Sut,longitudeProjected:vut,latitudeProjected:wut,format:Iut});function MD(e){e=x(e,x.EMPTY_OBJECT),this._errorEvent=new me;let t=De.createIfNeeded(e.url),n=De.createIfNeeded(e.pickFeaturesUrl);this._resource=t,this._urlSchemeZeroPadding=e.urlSchemeZeroPadding,this._getFeatureInfoFormats=e.getFeatureInfoFormats,this._pickFeaturesResource=n;let i=e.subdomains;Array.isArray(i)?i=i.slice():u(i)&&i.length>0?i=i.split(""):i=["a","b","c"],this._subdomains=i,this._tileWidth=x(e.tileWidth,256),this._tileHeight=x(e.tileHeight,256),this._minimumLevel=x(e.minimumLevel,0),this._maximumLevel=e.maximumLevel,this._tilingScheme=x(e.tilingScheme,new hs({ellipsoid:e.ellipsoid})),this._rectangle=x(e.rectangle,this._tilingScheme.rectangle),this._rectangle=se.intersection(this._rectangle,this._tilingScheme.rectangle),this._tileDiscardPolicy=e.tileDiscardPolicy;let o=e.credit;typeof o=="string"&&(o=new wt(o)),this._credit=o,this._hasAlphaChannel=x(e.hasAlphaChannel,!0);let r=e.customTags,s=bt(cxe,r),a=bt(Jlt,r);this._tags=s,this._pickFeaturesTags=a,this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this.enablePickFeatures=x(e.enablePickFeatures,!0)}Object.defineProperties(MD.prototype,{url:{get:function(){return this._resource.url}},urlSchemeZeroPadding:{get:function(){return this._urlSchemeZeroPadding}},pickFeaturesUrl:{get:function(){return this._pickFeaturesResource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return this._minimumLevel}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return this._hasAlphaChannel}}});MD.prototype.getTileCredits=function(e,t,n){};MD.prototype.requestImage=function(e,t,n,i){return Fl.loadImage(this,eut(this,e,t,n,i))};MD.prototype.pickFeatures=function(e,t,n,i,o){if(!this.enablePickFeatures||!u(this._pickFeaturesResource)||this._getFeatureInfoFormats.length===0)return;let r=0,s=this;function a(l,f){return l.callback(f)}function c(){if(r>=s._getFeatureInfoFormats.length)return Promise.resolve([]);let l=s._getFeatureInfoFormats[r],f=tut(s,e,t,n,i,o,l.format);return++r,l.type==="json"?f.fetchJson().then(l.callback).catch(c):l.type==="xml"?f.fetchXML().then(l.callback).catch(c):l.type==="text"||l.type==="html"?f.fetchText().then(l.callback).catch(c):f.fetch({responseType:l.format}).then(a.bind(void 0,l)).catch(c)}return c()};var CU=!1,Ru=new se,AU=!1,LD=new se;function eut(e,t,n,i,o){CU=!1,AU=!1;let r=e._resource,s=r.getUrlComponent(!0),a=e._tags,c={},l=s.match(axe);return u(l)&&l.forEach(function(f){let d=f.substring(1,f.length-1);u(a[d])&&(c[d]=a[d](e,t,n,i))}),r.getDerivedResource({request:o,templateValues:c})}var iK=!1,HE=new H,oK=!1;function tut(e,t,n,i,o,r,s){CU=!1,AU=!1,iK=!1,oK=!1;let a=e._pickFeaturesResource,c=a.getUrlComponent(!0),l=e._pickFeaturesTags,f={},d=c.match(axe);return u(d)&&d.forEach(function(p){let g=p.substring(1,p.length-1);u(l[g])&&(f[g]=l[g](e,t,n,i,o,r,s))}),a.getDerivedResource({templateValues:f})}function GE(e,t,n){if(e&&e.urlSchemeZeroPadding&&e.urlSchemeZeroPadding.hasOwnProperty(t)){let i=e.urlSchemeZeroPadding[t];if(typeof i=="string"){let o=i.length;o>1&&(n=n.length>=o?n:new Array(o-n.toString().length+1).join("0")+n)}}return n}function nut(e,t,n,i){return GE(e,"{x}",t)}function iut(e,t,n,i){let o=e.tilingScheme.getNumberOfXTilesAtLevel(i)-t-1;return GE(e,"{reverseX}",o)}function out(e,t,n,i){return GE(e,"{y}",n)}function rut(e,t,n,i){let o=e.tilingScheme.getNumberOfYTilesAtLevel(i)-n-1;return GE(e,"{reverseY}",o)}function sut(e,t,n,i){let o=e.maximumLevel,r=u(o)&&i<o?o-i-1:i;return GE(e,"{reverseZ}",r)}function aut(e,t,n,i){return GE(e,"{z}",i)}function cut(e,t,n,i){let o=(t+n+i)%e._subdomains.length;return e._subdomains[o]}function TU(e,t,n,i){CU||(e.tilingScheme.tileXYToRectangle(t,n,i,Ru),Ru.west=R.toDegrees(Ru.west),Ru.south=R.toDegrees(Ru.south),Ru.east=R.toDegrees(Ru.east),Ru.north=R.toDegrees(Ru.north),CU=!0)}function lut(e,t,n,i){return TU(e,t,n,i),Ru.west}function uut(e,t,n,i){return TU(e,t,n,i),Ru.south}function fut(e,t,n,i){return TU(e,t,n,i),Ru.east}function dut(e,t,n,i){return TU(e,t,n,i),Ru.north}function EU(e,t,n,i){AU||(e.tilingScheme.tileXYToNativeRectangle(t,n,i,LD),AU=!0)}function hut(e,t,n,i){return EU(e,t,n,i),LD.west}function mut(e,t,n,i){return EU(e,t,n,i),LD.south}function put(e,t,n,i){return EU(e,t,n,i),LD.east}function _ut(e,t,n,i){return EU(e,t,n,i),LD.north}function gut(e,t,n,i){return e.tileWidth}function yut(e,t,n,i){return e.tileHeight}function xut(e,t,n,i,o,r,s){return SU(e,t,n,i,o,r),HE.x}function but(e,t,n,i,o,r,s){return SU(e,t,n,i,o,r),HE.y}function Cut(e,t,n,i,o,r,s){return SU(e,t,n,i,o,r),e.tileWidth-HE.x-1}function Aut(e,t,n,i,o,r,s){return SU(e,t,n,i,o,r),e.tileHeight-HE.y-1}var Tut=new se,zE=new h;function SU(e,t,n,i,o,r,s){if(iK)return;rK(e,t,n,i,o,r);let a=zE,c=e.tilingScheme.tileXYToNativeRectangle(t,n,i,Tut);HE.x=e.tileWidth*(a.x-c.west)/c.width|0,HE.y=e.tileHeight*(c.north-a.y)/c.height|0,iK=!0}function Eut(e,t,n,i,o,r,s){return R.toDegrees(o)}function Sut(e,t,n,i,o,r,s){return R.toDegrees(r)}function vut(e,t,n,i,o,r,s){return rK(e,t,n,i,o,r),zE.x}function wut(e,t,n,i,o,r,s){return rK(e,t,n,i,o,r),zE.y}var Dut=new de;function rK(e,t,n,i,o,r,s){if(!oK){if(e.tilingScheme.projection instanceof Oi)zE.x=R.toDegrees(o),zE.y=R.toDegrees(r);else{let a=Dut;a.longitude=o,a.latitude=r,e.tilingScheme.projection.project(a,zE)}oK=!0}}function Iut(e,t,n,i,o,r,s){return s}var fc=MD;function qf(e){fc.call(this,e)}qf._requestMetadata=async function(e,t,n,i){try{let o=await n.fetchXML();return qf._metadataSuccess(o,e,t,n,i)}catch(o){if(o instanceof Zm)return qf._metadataFailure(e,t);throw o}};qf.fromUrl=async function(e,t){let n=De.createIfNeeded(e);n.appendForwardSlash();let i=n,o=n.getDerivedResource({url:"tilemapresource.xml"});t=x(t,x.EMPTY_OBJECT);let r=await qf._requestMetadata(t,i,o);return new qf(r)};u(Object.create)&&(qf.prototype=Object.create(fc.prototype),qf.prototype.constructor=qf);function lxe(e,t){return e.west<t.rectangle.west&&(e.west=t.rectangle.west),e.east>t.rectangle.east&&(e.east=t.rectangle.east),e.south<t.rectangle.south&&(e.south=t.rectangle.south),e.north>t.rectangle.north&&(e.north=t.rectangle.north),e}function uxe(e,t,n){let i=e.positionToTileXY(se.southwest(t),n),o=e.positionToTileXY(se.northeast(t),n);return(Math.abs(o.x-i.x)+1)*(Math.abs(o.y-i.y)+1)>4?0:n}qf._metadataSuccess=function(e,t,n,i,o){let r=/tileformat/i,s=/tileset/i,a=/tilesets/i,c=/boundingbox/i,l,f,d,p=[],g=e.childNodes[0].childNodes;for(let P=0;P<g.length;P++)if(r.test(g.item(P).nodeName))l=g.item(P);else if(a.test(g.item(P).nodeName)){d=g.item(P);let M=g.item(P).childNodes;for(let L=0;L<M.length;L++)s.test(M.item(L).nodeName)&&p.push(M.item(L))}else c.test(g.item(P).nodeName)&&(f=g.item(P));let m;if(!u(d)||!u(f))throw m=`Unable to find expected tilesets or bbox attributes in ${i.url}.`,u(o)&&Oo.reportError(void 0,o,o.errorEvent,m),new ce(m);let y=x(t.fileExtension,l.getAttribute("extension")),b=x(t.tileWidth,parseInt(l.getAttribute("width"),10)),C=x(t.tileHeight,parseInt(l.getAttribute("height"),10)),A=x(t.minimumLevel,parseInt(p[0].getAttribute("order"),10)),T=x(t.maximumLevel,parseInt(p[p.length-1].getAttribute("order"),10)),E=d.getAttribute("profile"),v=t.tilingScheme;if(!u(v))if(E==="geodetic"||E==="global-geodetic")v=new $i({ellipsoid:t.ellipsoid});else if(E==="mercator"||E==="global-mercator")v=new hs({ellipsoid:t.ellipsoid});else throw m=`${i.url} specifies an unsupported profile attribute, ${E}.`,u(o)&&Oo.reportError(void 0,o,o.errorEvent,m),new ce(m);let D=se.clone(t.rectangle);if(!u(D)){let P,M,L,_;x(t.flipXY,!1)?(L=new H(parseFloat(f.getAttribute("miny")),parseFloat(f.getAttribute("minx"))),_=new H(parseFloat(f.getAttribute("maxy")),parseFloat(f.getAttribute("maxx")))):(L=new H(parseFloat(f.getAttribute("minx")),parseFloat(f.getAttribute("miny"))),_=new H(parseFloat(f.getAttribute("maxx")),parseFloat(f.getAttribute("maxy"))));let w=E==="geodetic"||E==="mercator";if(v.projection instanceof Oi||w)P=de.fromDegrees(L.x,L.y),M=de.fromDegrees(_.x,_.y);else{let I=v.projection;P=I.unproject(L),M=I.unproject(_)}D=new se(P.longitude,P.latitude,M.longitude,M.latitude)}return D=lxe(D,v),A=uxe(v,D,A),{url:n.getDerivedResource({url:`{z}/{x}/{reverseY}.${y}`}),tilingScheme:v,rectangle:D,tileWidth:b,tileHeight:C,minimumLevel:A,maximumLevel:T,tileDiscardPolicy:t.tileDiscardPolicy,credit:t.credit}};qf._metadataFailure=function(e,t){let n=x(e.fileExtension,"png"),i=x(e.tileWidth,256),o=x(e.tileHeight,256),r=e.maximumLevel,s=u(e.tilingScheme)?e.tilingScheme:new hs({ellipsoid:e.ellipsoid}),a=x(e.rectangle,s.rectangle);a=lxe(a,s);let c=uxe(s,a,e.minimumLevel);return{url:t.getDerivedResource({url:`{z}/{x}/{reverseY}.${n}`}),tilingScheme:s,rectangle:a,tileWidth:i,tileHeight:o,minimumLevel:c,maximumLevel:r,tileDiscardPolicy:e.tileDiscardPolicy,credit:e.credit}};var _b=qf;function fxe(e){this.channel=e.channel,this.ellipsoid=e.ellipsoid,this.tilingScheme=void 0,this.version=void 0}fxe.prototype.build=function(e){e._channel=this.channel,e._version=this.version,e._tilingScheme=this.tilingScheme};function Put(e,t){let n;try{n=JSON.parse(e)}catch{n=JSON.parse(e.replace(/([\[\{,])[\n\r ]*([A-Za-z0-9]+)[\n\r ]*:/g,'$1"$2":'))}let i;for(let o=0;o<n.layers.length;o++)if(n.layers[o].id===t.channel){i=n.layers[o];break}if(!u(i)){let o=`Could not find layer with channel (id) of ${t.channel}.`;throw new ce(o)}if(!u(i.version)){let o=`Could not find a version in channel (id) ${t.channel}.`;throw new ce(o)}if(t.version=i.version,u(n.projection)&&n.projection==="flat")t.tilingScheme=new $i({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new se(-Math.PI,-Math.PI,Math.PI,Math.PI),ellipsoid:t.ellipsoid});else if(!u(n.projection)||n.projection==="mercator")t.tilingScheme=new hs({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:t.ellipsoid});else{let o=`Unsupported projection ${n.projection}.`;throw new ce(o)}return!0}function Rut(e,t,n){let i=`An error occurred while accessing ${t.url}.`;throw u(e)&&u(e.message)&&(i+=`: ${e.message}`),Oo.reportError(void 0,n,u(n)?n._errorEvent:void 0,i),new ce(i)}async function Out(e,t,n){try{let i=await e.fetchText();Put(i,t)}catch(i){Rut(i,e,n)}}function Bl(e){e=x(e,{}),this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=1.9,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._tileDiscardPolicy=e.tileDiscardPolicy,this._channel=e.channel,this._requestType="ImageryMaps",this._credit=new wt(`<a href="http://www.google.com/enterprise/mapsearth/products/earthenterprise.html"><img src="${Bl.logoUrl}" title="Google Imagery"/></a>`),this._tilingScheme=void 0,this._version=void 0,this._tileWidth=256,this._tileHeight=256,this._maximumLevel=e.maximumLevel,this._errorEvent=new me}Object.defineProperties(Bl.prototype,{url:{get:function(){return this._url}},path:{get:function(){return this._path}},proxy:{get:function(){return this._resource.proxy}},channel:{get:function(){return this._channel}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},version:{get:function(){return this._version}},requestType:{get:function(){return this._requestType}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}});Bl.fromUrl=async function(e,t,n){n=x(n,{});let i=x(n.path,"/default_map"),o=De.createIfNeeded(e).getDerivedResource({url:i[0]==="/"?i.substring(1):i});o.appendForwardSlash();let r=o.getDerivedResource({url:"query",queryParameters:{request:"Json",vars:"geeServerDefs",is2d:"t"}}),s=new fxe(n);s.channel=t,await Out(r,s);let a=new Bl(n);return s.build(a),a._resource=o,a._url=e,a._path=i,a};Bl.prototype.getTileCredits=function(e,t,n){};Bl.prototype.requestImage=function(e,t,n,i){let o=this._resource.getDerivedResource({url:"query",request:i,queryParameters:{request:this._requestType,channel:this._channel,version:this._version,x:e,y:t,z:n+1}});return Fl.loadImage(this,o)};Bl.prototype.pickFeatures=function(e,t,n,i,o){};Bl._logoUrl=void 0;Object.defineProperties(Bl,{logoUrl:{get:function(){return u(Bl._logoUrl)||(Bl._logoUrl=on("Assets/Images/google_earth_credit.png")),Bl._logoUrl},set:function(e){Bl._logoUrl=e}}});var vU=Bl;var Mut=/\/$/,dxe=new wt('&copy; <a href="https://www.mapbox.com/about/maps/">Mapbox</a> &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/">Improve this map</a></strong>');function WE(e){e=x(e,x.EMPTY_OBJECT);let t=e.mapId,n=e.accessToken;this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0;let i=De.createIfNeeded(x(e.url,"https://{s}.tiles.mapbox.com/v4/"));this._mapId=t,this._accessToken=n;let o=x(e.format,"png");/\./.test(o)||(o=`.${o}`),this._format=o;let r=i.getUrlComponent();Mut.test(r)||(r+="/"),r+=`${t}/{z}/{x}/{y}${this._format}`,i.url=r,i.setQueryParameters({access_token:n});let s;u(e.credit)?(s=e.credit,typeof s=="string"&&(s=new wt(s))):s=dxe,this._resource=i,this._imageryProvider=new fc({url:i,credit:s,ellipsoid:e.ellipsoid,minimumLevel:e.minimumLevel,maximumLevel:e.maximumLevel,rectangle:e.rectangle})}Object.defineProperties(WE.prototype,{url:{get:function(){return this._imageryProvider.url}},rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._imageryProvider.errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},proxy:{get:function(){return this._imageryProvider.proxy}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel}}});WE.prototype.getTileCredits=function(e,t,n){};WE.prototype.requestImage=function(e,t,n,i){return this._imageryProvider.requestImage(e,t,n,i)};WE.prototype.pickFeatures=function(e,t,n,i,o){return this._imageryProvider.pickFeatures(e,t,n,i,o)};WE._defaultCredit=dxe;var wU=WE;function gb(e){e=x(e,x.EMPTY_OBJECT),this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0;let t=x(e.rectangle,se.MAX_VALUE),n=new $i({rectangle:t,numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1,ellipsoid:e.ellipsoid});this._tilingScheme=n,this._image=void 0,this._texture=void 0,this._hasError=!1,this._errorEvent=new me;let i=e.credit;typeof i=="string"&&(i=new wt(i)),this._credit=i;let o=De.createIfNeeded(e.url);this._resource=o,this._tileWidth=e.tileWidth,this._tileHeight=e.tileHeight}Object.defineProperties(gb.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return 0}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}});function Lut(e,t,n,i){let o=`Failed to load image ${e.url}`;u(t)&&u(t.message)&&(o+=`: ${t.message}`);let r=Oo.reportError(i,n,u(n)?n._errorEvent:void 0,o,0,0,0,t);if(r.retry)return sK(e,n,r);throw u(n)&&(n._hasError=!0),new ce(o)}async function sK(e,t,n){try{return await Fl.loadImage(null,e)}catch(i){return Lut(e,i,t,n)}}gb.fromUrl=async function(e,t){let n=De.createIfNeeded(e),i=await sK(n);t=x(t,x.EMPTY_OBJECT);let o=new gb({...t,url:e,tileWidth:i.width,tileHeight:i.height});return o._image=i,o};gb.prototype.getTileCredits=function(e,t,n){};gb.prototype.requestImage=async function(e,t,n,i){if(!this._hasError&&!u(this._image)){let o=await sK(this._resource,this);return this._image=o,Oo.reportSuccess(this._errorEvent),o}return this._image};gb.prototype.pickFeatures=function(e,t,n,i,o){};var DU=gb;function Nut(e,t,n){this.type=e,u(t)||(e==="json"?t="application/json":e==="xml"?t="text/xml":e==="html"?t="text/html":e==="text"&&(t="text/plain")),this.format=t,u(n)||(e==="json"?n=Fut:e==="xml"?n=Uut:(e==="html"||e==="text")&&(n=hxe)),this.callback=n}function Fut(e){let t=[],n=e.features;for(let i=0;i<n.length;++i){let o=n[i],r=new Mm;if(r.data=o,r.properties=o.properties,r.configureNameFromProperties(o.properties),r.configureDescriptionFromProperties(o.properties),u(o.geometry)&&o.geometry.type==="Point"){let s=o.geometry.coordinates[0],a=o.geometry.coordinates[1];r.position=de.fromDegrees(s,a)}t.push(r)}return t}var aK="http://www.mapinfo.com/mxp",But="http://www.esri.com/wms",kut="http://www.opengis.net/wfs",Vut="http://www.opengis.net/gml";function Uut(e){let t=e.documentElement;if(t.localName==="MultiFeatureCollection"&&t.namespaceURI===aK)return zut(e);if(t.localName==="FeatureInfoResponse"&&t.namespaceURI===But)return Hut(e);if(t.localName==="FeatureCollection"&&t.namespaceURI===kut)return Gut(e);if(t.localName==="ServiceExceptionReport")throw new ce(new XMLSerializer().serializeToString(t));return t.localName==="msGMLOutput"?Wut(e):jut(e)}function zut(e){let t=[],i=e.documentElement.getElementsByTagNameNS(aK,"Feature");for(let o=0;o<i.length;++o){let r=i[o],s={},a=r.getElementsByTagNameNS(aK,"Val");for(let l=0;l<a.length;++l){let f=a[l];if(f.hasAttribute("ref")){let d=f.getAttribute("ref"),p=f.textContent.trim();s[d]=p}}let c=new Mm;c.data=r,c.properties=s,c.configureNameFromProperties(s),c.configureDescriptionFromProperties(s),t.push(c)}return t}function Hut(e){let t=e.documentElement,n=[],i,o=t.getElementsByTagNameNS("*","FIELDS");if(o.length>0)for(let r=0;r<o.length;++r){let s=o[r];i={};let a=s.attributes;for(let c=0;c<a.length;++c){let l=a[c];i[l.name]=l.value}n.push(IU(s,i))}else{let r=t.getElementsByTagNameNS("*","FeatureInfo");for(let s=0;s<r.length;++s){let a=r[s];i={};let c=a.childNodes;for(let l=0;l<c.length;++l){let f=c[l];f.nodeType===Node.ELEMENT_NODE&&(i[f.localName]=f.textContent)}n.push(IU(a,i))}}return n}function Gut(e){let t=[],i=e.documentElement.getElementsByTagNameNS(Vut,"featureMember");for(let o=0;o<i.length;++o){let r=i[o],s={};cK(r,s),t.push(IU(r,s))}return t}function Wut(e){let t=[],n,i=e.documentElement.childNodes;for(let r=0;r<i.length;r++)if(i[r].nodeType===Node.ELEMENT_NODE){n=i[r];break}if(!u(n))throw new ce("Unable to find first child of the feature info xml document");let o=n.childNodes;for(let r=0;r<o.length;++r){let s=o[r];if(s.nodeType===Node.ELEMENT_NODE){let a={};cK(s,a),t.push(IU(s,a))}}return t}function cK(e,t){let n=!0;for(let i=0;i<e.childNodes.length;++i){let o=e.childNodes[i];o.nodeType===Node.ELEMENT_NODE&&(n=!1),!(o.localName==="Point"||o.localName==="LineString"||o.localName==="Polygon"||o.localName==="boundedBy")&&o.hasChildNodes()&&cK(o,t)&&(t[o.localName]=o.textContent)}return n}function IU(e,t){let n=new Mm;return n.data=e,n.properties=t,n.configureNameFromProperties(t),n.configureDescriptionFromProperties(t),n}function jut(e){let t=new XMLSerializer().serializeToString(e),n=document.createElement("div"),i=document.createElement("pre");i.textContent=t,n.appendChild(i);let o=new Mm;return o.data=e,o.description=n.innerHTML,[o]}var qut=/<body>\s*<\/body>/im,Yut=/<ServiceExceptionReport([\s\S]*)<\/ServiceExceptionReport>/im,Xut=/<title>([\s\S]*)<\/title>/im;function hxe(e){if(qut.test(e)||Yut.test(e))return;let t,n=Xut.exec(e);n&&n.length>1&&(t=n[1]);let i=new Mm;return i.name=t,i.description=e,i.data=e,[i]}var jE=Nut;function ND(e){e=x(e,x.EMPTY_OBJECT),this._tileCache={},this._tilesRequestedForInterval=[];let t=this._clock=e.clock;this._times=e.times,this._requestImageFunction=e.requestImageFunction,this._reloadFunction=e.reloadFunction,this._currentIntervalIndex=-1,t.onTick.addEventListener(this._clockOnTick,this),this._clockOnTick(t)}Object.defineProperties(ND.prototype,{clock:{get:function(){return this._clock},set:function(e){this._clock!==e&&(this._clock=e,this._clockOnTick(e),this._reloadFunction())}},times:{get:function(){return this._times},set:function(e){this._times!==e&&(this._times=e,this._clockOnTick(this._clock),this._reloadFunction())}},currentInterval:{get:function(){return this._times.get(this._currentIntervalIndex)}}});ND.prototype.getFromCache=function(e,t,n,i){let o=mxe(e,t,n),r,s=this._tileCache[this._currentIntervalIndex];if(u(s)&&u(s[o])){let a=s[o];r=a.promise.catch(function(c){throw i.state=a.request.state,c}),delete s[o]}return r};ND.prototype.checkApproachingInterval=function(e,t,n,i){let o=mxe(e,t,n),r=this._tilesRequestedForInterval,s=pxe(this),a={key:o,priorityFunction:i.priorityFunction};(!u(s)||!_xe(this,a,s))&&r.push(a),r.length>=512&&r.splice(0,256)};ND.prototype._clockOnTick=function(e){let t=e.currentTime,i=this._times.indexOf(t),o=this._currentIntervalIndex;if(i!==o){let s=this._tileCache[o];for(let a in s)s.hasOwnProperty(a)&&s[a].request.cancel();delete this._tileCache[o],this._tilesRequestedForInterval=[],this._currentIntervalIndex=i,this._reloadFunction();return}let r=pxe(this);if(u(r)){let s=this._tilesRequestedForInterval,a=!0;for(;a&&s.length!==0;){let c=s.pop();a=_xe(this,c,r),a||s.push(c)}}};function mxe(e,t,n){return`${e}-${t}-${n}`}function Kut(e){let t=e.split("-");if(t.length===3)return{x:Number(t[0]),y:Number(t[1]),level:Number(t[2])}}function pxe(e){let t=e._times;if(!u(t))return;let n=e._clock,i=n.currentTime,o=n.canAnimate&&n.shouldAnimate,r=n.multiplier;if(!o&&r!==0)return;let s,a=t.indexOf(i);if(a<0)return;let c=t.get(a);return r>0?(s=$.secondsDifference(c.stop,i),++a):(s=$.secondsDifference(c.start,i),--a),s/=r,a>=0&&s<=5?t.get(a):void 0}function _xe(e,t,n){let i=e._times.indexOf(n.start),o=e._tileCache,r=o[i];u(r)||(r=o[i]={});let s=t.key;if(u(r[s]))return!0;let a=Kut(s),c=new rr({throttle:!1,throttleByServer:!0,type:gs.IMAGERY,priorityFunction:t.priorityFunction}),l=e._requestImageFunction(a.x,a.y,a.level,c,n);return u(l)?(r[s]={promise:l,request:c},!0):!1}var qE=ND;var Zut=[3034,3035,3042,3043,3044],$ut=[4471,4559];function ah(e){if(e=x(e,x.EMPTY_OBJECT),u(e.times)&&!u(e.clock))throw new he("options.times was specified, so options.clock is required.");this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._getFeatureInfoUrl=x(e.getFeatureInfoUrl,e.url);let t=De.createIfNeeded(e.url),n=De.createIfNeeded(this._getFeatureInfoUrl);t.setQueryParameters(ah.DefaultParameters,!0),n.setQueryParameters(ah.GetFeatureInfoDefaultParameters,!0),u(e.parameters)&&t.setQueryParameters(gxe(e.parameters)),u(e.getFeatureInfoParameters)&&n.setQueryParameters(gxe(e.getFeatureInfoParameters));let i=this;this._reload=void 0,u(e.times)&&(this._timeDynamicImagery=new qE({clock:e.clock,times:e.times,requestImageFunction:function(s,a,c,l,f){return yxe(i,s,a,c,l,f)},reloadFunction:function(){u(i._reload)&&i._reload()}}));let o={};if(o.layers=e.layers,o.bbox="{westProjected},{southProjected},{eastProjected},{northProjected}",o.width="{width}",o.height="{height}",parseFloat(t.queryParameters.version)>=1.3){o.crs=x(e.crs,e.tilingScheme&&e.tilingScheme.projection instanceof Li?"EPSG:3857":"CRS:84");let s=o.crs.split(":");if(s[0]==="EPSG"&&s.length===2){let a=Number(s[1]);(a>=4e3&&a<5e3&&!$ut.includes(a)||Zut.includes(a))&&(o.bbox="{southProjected},{westProjected},{northProjected},{eastProjected}")}}else o.srs=x(e.srs,e.tilingScheme&&e.tilingScheme.projection instanceof Li?"EPSG:3857":"EPSG:4326");t.setQueryParameters(o,!0),n.setQueryParameters(o,!0);let r={query_layers:e.layers,info_format:"{format}"};parseFloat(n.queryParameters.version)>=1.3?(r.i="{i}",r.j="{j}"):(r.x="{i}",r.y="{j}"),n.setQueryParameters(r,!0),this._resource=t,this._pickFeaturesResource=n,this._layers=e.layers,this._tileProvider=new fc({url:t,pickFeaturesUrl:n,tilingScheme:x(e.tilingScheme,new $i({ellipsoid:e.ellipsoid})),rectangle:e.rectangle,tileWidth:e.tileWidth,tileHeight:e.tileHeight,minimumLevel:e.minimumLevel,maximumLevel:e.maximumLevel,subdomains:e.subdomains,tileDiscardPolicy:e.tileDiscardPolicy,credit:e.credit,getFeatureInfoFormats:x(e.getFeatureInfoFormats,ah.DefaultGetFeatureInfoFormats),enablePickFeatures:e.enablePickFeatures})}function yxe(e,t,n,i,o,r){let s=u(r)?r.data:void 0,a=e._tileProvider;return u(s)&&a._resource.setQueryParameters(s),a.requestImage(t,n,i,o)}function Qut(e,t,n,i,o,r,s){let a=u(s)?s.data:void 0,c=e._tileProvider;return u(a)&&c._pickFeaturesResource.setQueryParameters(a),c.pickFeatures(t,n,i,o,r)}Object.defineProperties(ah.prototype,{url:{get:function(){return this._resource._url}},proxy:{get:function(){return this._resource.proxy}},layers:{get:function(){return this._layers}},tileWidth:{get:function(){return this._tileProvider.tileWidth}},tileHeight:{get:function(){return this._tileProvider.tileHeight}},maximumLevel:{get:function(){return this._tileProvider.maximumLevel}},minimumLevel:{get:function(){return this._tileProvider.minimumLevel}},tilingScheme:{get:function(){return this._tileProvider.tilingScheme}},rectangle:{get:function(){return this._tileProvider.rectangle}},tileDiscardPolicy:{get:function(){return this._tileProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._tileProvider.errorEvent}},credit:{get:function(){return this._tileProvider.credit}},hasAlphaChannel:{get:function(){return this._tileProvider.hasAlphaChannel}},enablePickFeatures:{get:function(){return this._tileProvider.enablePickFeatures},set:function(e){this._tileProvider.enablePickFeatures=e}},clock:{get:function(){return this._timeDynamicImagery.clock},set:function(e){this._timeDynamicImagery.clock=e}},times:{get:function(){return this._timeDynamicImagery.times},set:function(e){this._timeDynamicImagery.times=e}},getFeatureInfoUrl:{get:function(){return this._getFeatureInfoUrl}}});ah.prototype.getTileCredits=function(e,t,n){return this._tileProvider.getTileCredits(e,t,n)};ah.prototype.requestImage=function(e,t,n,i){let o,r=this._timeDynamicImagery,s;return u(r)&&(s=r.currentInterval,o=r.getFromCache(e,t,n,i)),u(o)||(o=yxe(this,e,t,n,i,s)),u(o)&&u(r)&&r.checkApproachingInterval(e,t,n,i),o};ah.prototype.pickFeatures=function(e,t,n,i,o){let r=this._timeDynamicImagery,s=u(r)?r.currentInterval:void 0;return Qut(this,e,t,n,i,o,s)};ah.DefaultParameters=Object.freeze({service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"});ah.GetFeatureInfoDefaultParameters=Object.freeze({service:"WMS",version:"1.1.1",request:"GetFeatureInfo"});ah.DefaultGetFeatureInfoFormats=Object.freeze([Object.freeze(new jE("json","application/json")),Object.freeze(new jE("xml","text/xml")),Object.freeze(new jE("text","text/html"))]);function gxe(e){let t={};for(let n in e)e.hasOwnProperty(n)&&(t[n.toLowerCase()]=e[n]);return t}var PU=ah;var Jut=Object.freeze({service:"WMTS",version:"1.0.0",request:"GetTile"});function FD(e){e=x(e,x.EMPTY_OBJECT),this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0;let t=De.createIfNeeded(e.url),n=e.style,i=e.tileMatrixSetID,o=t.url,r=o.match(/{/g);if(!u(r)||r.length===1&&/{s}/.test(o))t.setQueryParameters(Jut),this._useKvp=!0;else{let d={style:n,Style:n,TileMatrixSet:i};t.setTemplateValues(d),this._useKvp=!1}this._resource=t,this._layer=e.layer,this._style=n,this._tileMatrixSetID=i,this._tileMatrixLabels=e.tileMatrixLabels,this._format=x(e.format,"image/jpeg"),this._tileDiscardPolicy=e.tileDiscardPolicy,this._tilingScheme=u(e.tilingScheme)?e.tilingScheme:new hs({ellipsoid:e.ellipsoid}),this._tileWidth=x(e.tileWidth,256),this._tileHeight=x(e.tileHeight,256),this._minimumLevel=x(e.minimumLevel,0),this._maximumLevel=e.maximumLevel,this._rectangle=x(e.rectangle,this._tilingScheme.rectangle),this._dimensions=e.dimensions;let s=this;this._reload=void 0,u(e.times)&&(this._timeDynamicImagery=new qE({clock:e.clock,times:e.times,requestImageFunction:function(d,p,g,m,y){return xxe(s,d,p,g,m,y)},reloadFunction:function(){u(s._reload)&&s._reload()}}));let a=this._tilingScheme.positionToTileXY(se.southwest(this._rectangle),this._minimumLevel),c=this._tilingScheme.positionToTileXY(se.northeast(this._rectangle),this._minimumLevel),l=(Math.abs(c.x-a.x)+1)*(Math.abs(c.y-a.y)+1);this._errorEvent=new me;let f=e.credit;this._credit=typeof f=="string"?new wt(f):f,this._subdomains=e.subdomains,Array.isArray(this._subdomains)?this._subdomains=this._subdomains.slice():u(this._subdomains)&&this._subdomains.length>0?this._subdomains=this._subdomains.split(""):this._subdomains=["a","b","c"]}function xxe(e,t,n,i,o,r){let s=e._tileMatrixLabels,a=u(s)?s[i]:i.toString(),c=e._subdomains,l=e._dimensions,f=u(r)?r.data:void 0,d,p;if(!e._useKvp)p={TileMatrix:a,TileRow:n.toString(),TileCol:t.toString(),s:c[(t+n+i)%c.length]},d=e._resource.getDerivedResource({request:o}),d.setTemplateValues(p),u(l)&&d.setTemplateValues(l),u(f)&&d.setTemplateValues(f);else{let g={};g.tilematrix=a,g.layer=e._layer,g.style=e._style,g.tilerow=n,g.tilecol=t,g.tilematrixset=e._tileMatrixSetID,g.format=e._format,u(l)&&(g=bt(g,l)),u(f)&&(g=bt(g,f)),p={s:c[(t+n+i)%c.length]},d=e._resource.getDerivedResource({queryParameters:g,request:o}),d.setTemplateValues(p)}return Fl.loadImage(e,d)}Object.defineProperties(FD.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return this._minimumLevel}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},format:{get:function(){return this._format}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}},clock:{get:function(){return this._timeDynamicImagery.clock},set:function(e){this._timeDynamicImagery.clock=e}},times:{get:function(){return this._timeDynamicImagery.times},set:function(e){this._timeDynamicImagery.times=e}},dimensions:{get:function(){return this._dimensions},set:function(e){this._dimensions!==e&&(this._dimensions=e,u(this._reload)&&this._reload())}}});FD.prototype.getTileCredits=function(e,t,n){};FD.prototype.requestImage=function(e,t,n,i){let o,r=this._timeDynamicImagery,s;return u(r)&&(s=r.currentInterval,o=r.getFromCache(e,t,n,i)),u(o)||(o=xxe(this,e,t,n,i,s)),u(o)&&u(r)&&r.checkApproachingInterval(e,t,n,i),o};FD.prototype.pickFeatures=function(e,t,n,i,o){};var RU=FD;var eft={ARCGIS_MAPSERVER:J0.fromUrl,BING:async(e,t)=>bU.fromUrl(e,t),GOOGLE_EARTH:async(e,t)=>{let n=t.channel;return delete t.channel,vU.fromUrl(e,n,t)},MAPBOX:(e,t)=>new wU({url:e,...t}),SINGLE_TILE:DU.fromUrl,TMS:_b.fromUrl,URL_TEMPLATE:(e,t)=>new fc({url:e,...t}),WMS:(e,t)=>new PU({url:e,...t}),WMTS:(e,t)=>new RU({url:e,...t})};function Fm(e){e=x(e,x.EMPTY_OBJECT),this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._tileCredits=void 0,this._errorEvent=new me}Object.defineProperties(Fm.prototype,{rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel}},proxy:{get:function(){}}});Fm.fromAssetId=async function(e,t){t=x(t,x.EMPTY_OBJECT);let n=cf._createEndpointResource(e,t),i=e.toString()+t.accessToken+t.server,o=Fm._endpointCache[i];u(o)||(o=n.fetchJson(),Fm._endpointCache[i]=o);let r=await o;if(r.type!=="IMAGERY")throw new ce(`Cesium ion asset ${e} is not an imagery asset.`);let s,a=r.externalType;if(!u(a))s=await _b.fromUrl(new cf(r,n));else{let l=eft[a];if(!u(l))throw new ce(`Unrecognized Cesium ion imagery type: ${a}`);let f={...r.options},d=f.url;delete f.url,s=await l(d,f)}let c=new Fm(t);return s.errorEvent.addEventListener(function(l){l.provider=c,c._errorEvent.raiseEvent(l)}),c._tileCredits=cf.getCreditsFromEndpoint(r,n),c._imageryProvider=s,c};Fm.prototype.getTileCredits=function(e,t,n){let i=this._imageryProvider.getTileCredits(e,t,n);return u(i)?this._tileCredits.concat(i):this._tileCredits};Fm.prototype.requestImage=function(e,t,n,i){return this._imageryProvider.requestImage(e,t,n,i)};Fm.prototype.pickFeatures=function(e,t,n,i,o){return this._imageryProvider.pickFeatures(e,t,n,i,o)};Fm._endpointCache={};var ey=Fm;var tft={AERIAL:2,AERIAL_WITH_LABELS:3,ROAD:4},ty=Object.freeze(tft);function nft(e){e=x(e,x.EMPTY_OBJECT);let t=x(e.style,ty.AERIAL);return ey.fromAssetId(t)}var ny=nft;var OU=`uniform sampler2D u_texture;

in vec2 v_textureCoordinates;

void main()
{
    out_FragColor = texture(u_texture, v_textureCoordinates);
}
`;var MU=`in vec4 position;
in float webMercatorT;

uniform vec2 u_textureDimensions;

out vec2 v_textureCoordinates;

void main()
{
    v_textureCoordinates = vec2(position.x, webMercatorT);
    gl_Position = czm_viewportOrthographic * (position * vec4(u_textureDimensions, 1.0, 1.0));
}
`;function YE(e,t,n,i,o){if(this.imageryLayer=e,this.x=t,this.y=n,this.level=i,this.request=void 0,i!==0){let r=t/2|0,s=n/2|0,a=i-1;this.parent=e.getImageryFromCache(r,s,a)}this.state=ci.UNLOADED,this.imageUrl=void 0,this.image=void 0,this.texture=void 0,this.textureWebMercator=void 0,this.credits=void 0,this.referenceCount=0,!u(o)&&e.ready&&(o=e.imageryProvider.tilingScheme.tileXYToRectangle(t,n,i)),this.rectangle=o}YE.createPlaceholder=function(e){let t=new YE(e,0,0,0);return t.addReference(),t.state=ci.PLACEHOLDER,t};YE.prototype.addReference=function(){++this.referenceCount};YE.prototype.releaseReference=function(){return--this.referenceCount,this.referenceCount===0?(this.imageryLayer.removeImageryFromCache(this),u(this.parent)&&this.parent.releaseReference(),u(this.image)&&u(this.image.destroy)&&this.image.destroy(),u(this.texture)&&this.texture.destroy(),u(this.textureWebMercator)&&this.texture!==this.textureWebMercator&&this.textureWebMercator.destroy(),ue(this),0):this.referenceCount};YE.prototype.processStateMachine=function(e,t,n){this.state===ci.UNLOADED&&!n&&(this.state=ci.TRANSITIONING,this.imageryLayer._requestImagery(this)),this.state===ci.RECEIVED&&(this.state=ci.TRANSITIONING,this.imageryLayer._createTexture(e.context,this));let i=this.state===ci.READY&&t&&!this.texture;(this.state===ci.TEXTURE_LOADED||i)&&(this.state=ci.TRANSITIONING,this.imageryLayer._reprojectTexture(e,this,t))};var BD=YE;function lK(e,t,n){this.readyImagery=void 0,this.loadingImagery=e,this.textureCoordinateRectangle=t,this.textureTranslationAndScale=void 0,this.useWebMercatorT=n}lK.prototype.freeResources=function(){u(this.readyImagery)&&this.readyImagery.releaseReference(),u(this.loadingImagery)&&this.loadingImagery.releaseReference()};lK.prototype.processStateMachine=function(e,t,n){let i=this.loadingImagery,o=i.imageryLayer;if(i.processStateMachine(t,!this.useWebMercatorT,n),i.state===ci.READY)return u(this.readyImagery)&&this.readyImagery.releaseReference(),this.readyImagery=this.loadingImagery,this.loadingImagery=void 0,this.textureTranslationAndScale=o._calculateTextureTranslationAndScale(e,this),!0;let r=i.parent,s;for(;u(r)&&(r.state!==ci.READY||!this.useWebMercatorT&&!u(r.texture));)r.state!==ci.FAILED&&r.state!==ci.INVALID&&(s=s||r),r=r.parent;return this.readyImagery!==r&&(u(this.readyImagery)&&this.readyImagery.releaseReference(),this.readyImagery=r,u(r)&&(r.addReference(),this.textureTranslationAndScale=o._calculateTextureTranslationAndScale(e,this))),i.state===ci.FAILED||i.state===ci.INVALID?u(s)?(s.processStateMachine(t,!this.useWebMercatorT,n),!1):!0:!1};var kD=lK;function gi(e,t){this._imageryProvider=e,this._readyEvent=new me,this._errorEvent=new me,t=x(t,x.EMPTY_OBJECT),e=x(e,x.EMPTY_OBJECT),this.alpha=x(t.alpha,x(e._defaultAlpha,1)),this.nightAlpha=x(t.nightAlpha,x(e._defaultNightAlpha,1)),this.dayAlpha=x(t.dayAlpha,x(e._defaultDayAlpha,1)),this.brightness=x(t.brightness,x(e._defaultBrightness,gi.DEFAULT_BRIGHTNESS)),this.contrast=x(t.contrast,x(e._defaultContrast,gi.DEFAULT_CONTRAST)),this.hue=x(t.hue,x(e._defaultHue,gi.DEFAULT_HUE)),this.saturation=x(t.saturation,x(e._defaultSaturation,gi.DEFAULT_SATURATION)),this.gamma=x(t.gamma,x(e._defaultGamma,gi.DEFAULT_GAMMA)),this.splitDirection=x(t.splitDirection,gi.DEFAULT_SPLIT),this.minificationFilter=x(t.minificationFilter,x(e._defaultMinificationFilter,gi.DEFAULT_MINIFICATION_FILTER)),this.magnificationFilter=x(t.magnificationFilter,x(e._defaultMagnificationFilter,gi.DEFAULT_MAGNIFICATION_FILTER)),this.show=x(t.show,!0),this._minimumTerrainLevel=t.minimumTerrainLevel,this._maximumTerrainLevel=t.maximumTerrainLevel,this._rectangle=x(t.rectangle,se.MAX_VALUE),this._maximumAnisotropy=t.maximumAnisotropy,this._imageryCache={},this._skeletonPlaceholder=new kD(BD.createPlaceholder(this)),this._show=!0,this._layerIndex=-1,this._isBaseLayer=!1,this._requestImageError=void 0,this._reprojectComputeCommands=[],this.cutoutRectangle=t.cutoutRectangle,this.colorToAlpha=t.colorToAlpha,this.colorToAlphaThreshold=x(t.colorToAlphaThreshold,gi.DEFAULT_APPLY_COLOR_TO_ALPHA_THRESHOLD)}Object.defineProperties(gi.prototype,{imageryProvider:{get:function(){return this._imageryProvider}},ready:{get:function(){return u(this._imageryProvider)}},errorEvent:{get:function(){return this._errorEvent}},readyEvent:{get:function(){return this._readyEvent}},rectangle:{get:function(){return this._rectangle}}});gi.DEFAULT_BRIGHTNESS=1;gi.DEFAULT_CONTRAST=1;gi.DEFAULT_HUE=0;gi.DEFAULT_SATURATION=1;gi.DEFAULT_GAMMA=1;gi.DEFAULT_SPLIT=Wr.NONE;gi.DEFAULT_MINIFICATION_FILTER=$t.LINEAR;gi.DEFAULT_MAGNIFICATION_FILTER=mi.LINEAR;gi.DEFAULT_APPLY_COLOR_TO_ALPHA_THRESHOLD=.004;gi.fromProviderAsync=function(e,t){let n=new gi(void 0,t);return aft(n,Promise.resolve(e)),n};gi.fromWorldImagery=function(e){return e=x(e,x.EMPTY_OBJECT),gi.fromProviderAsync(ny({style:e.style}),e)};gi.prototype.isBaseLayer=function(){return this._isBaseLayer};gi.prototype.isDestroyed=function(){return!1};gi.prototype.destroy=function(){return ue(this)};var Axe=new se,bxe=new se,uK=new se,Txe=new se;gi.prototype.getImageryRectangle=function(){let e=this._imageryProvider,t=this._rectangle;return se.intersection(e.rectangle,t)};gi.prototype._createTileImagerySkeletons=function(e,t,n){let i=e.data;if(!u(t)||u(this._minimumTerrainLevel)&&e.level<this._minimumTerrainLevel||u(this._maximumTerrainLevel)&&e.level>this._maximumTerrainLevel)return!1;u(n)||(n=i.imagery.length);let o=this._imageryProvider;if(!this.ready)return this._skeletonPlaceholder.loadingImagery.addReference(),i.imagery.splice(n,0,this._skeletonPlaceholder),!0;let r=o.tilingScheme.projection instanceof Li&&e.rectangle.north<Li.MaximumLatitude&&e.rectangle.south>-Li.MaximumLatitude,s=se.intersection(o.rectangle,this._rectangle,Axe),a=se.intersection(e.rectangle,s,bxe);if(!u(a)){if(!this.isBaseLayer())return!1;let w=s,I=e.rectangle;a=bxe,I.south>=w.north?a.north=a.south=w.north:I.north<=w.south?a.north=a.south=w.south:(a.south=Math.max(I.south,w.south),a.north=Math.min(I.north,w.north)),I.west>=w.east?a.west=a.east=w.east:I.east<=w.west?a.west=a.east=w.west:(a.west=Math.max(I.west,w.west),a.east=Math.min(I.east,w.east))}let c=0;a.south>0?c=a.south:a.north<0&&(c=a.north);let f=1*t.getLevelMaximumGeometricError(e.level),d=rft(this,f,c);d=Math.max(0,d);let p=o.maximumLevel;if(d>p&&(d=p),u(o.minimumLevel)){let w=o.minimumLevel;d<w&&(d=w)}let g=o.tilingScheme,m=g.positionToTileXY(se.northwest(a),d),y=g.positionToTileXY(se.southeast(a),d),b=e.rectangle.width/512,C=e.rectangle.height/512,A=g.tileXYToRectangle(m.x,m.y,d);Math.abs(A.south-e.rectangle.north)<C&&m.y<y.y&&++m.y,Math.abs(A.east-e.rectangle.west)<b&&m.x<y.x&&++m.x;let T=g.tileXYToRectangle(y.x,y.y,d);Math.abs(T.north-e.rectangle.south)<C&&y.y>m.y&&--y.y,Math.abs(T.west-e.rectangle.east)<b&&y.x>m.x&&--y.x;let E=se.clone(e.rectangle,Txe),v=g.tileXYToRectangle(m.x,m.y,d),D=se.intersection(v,s,uK),O;r?(g.rectangleToNativeRectangle(E,E),g.rectangleToNativeRectangle(v,v),g.rectangleToNativeRectangle(D,D),g.rectangleToNativeRectangle(s,s),O=g.tileXYToNativeRectangle.bind(g),b=E.width/512,C=E.height/512):O=g.tileXYToRectangle.bind(g);let P,M=0,L=1,_;!this.isBaseLayer()&&Math.abs(D.west-E.west)>=b&&(M=Math.min(1,(D.west-E.west)/E.width)),!this.isBaseLayer()&&Math.abs(D.north-E.north)>=C&&(L=Math.max(0,(D.north-E.south)/E.height));let S=L;for(let w=m.x;w<=y.x;w++)if(P=M,v=O(w,m.y,d),D=se.simpleIntersection(v,s,uK),!!u(D)){M=Math.min(1,(D.east-E.west)/E.width),w===y.x&&(this.isBaseLayer()||Math.abs(D.east-E.east)<b)&&(M=1),L=S;for(let I=m.y;I<=y.y;I++){if(_=L,v=O(w,I,d),D=se.simpleIntersection(v,s,uK),!u(D))continue;L=Math.max(0,(D.south-E.south)/E.height),I===y.y&&(this.isBaseLayer()||Math.abs(D.south-E.south)<C)&&(L=0);let N=new oe(P,L,M,_),k=this.getImageryFromCache(w,I,d);i.imagery.splice(n,0,new kD(k,N,r)),++n}}return!0};gi.prototype._calculateTextureTranslationAndScale=function(e,t){let n=t.readyImagery.rectangle,i=e.rectangle;if(t.useWebMercatorT){let c=t.readyImagery.imageryLayer.imageryProvider.tilingScheme;n=c.rectangleToNativeRectangle(n,Axe),i=c.rectangleToNativeRectangle(i,Txe)}let o=i.width,r=i.height,s=o/n.width,a=r/n.height;return new oe(s*(i.west-n.west)/o,a*(i.south-n.south)/r,s,a)};gi.prototype._requestImagery=function(e){let t=this._imageryProvider,n=this;function i(s){if(!u(s))return o();e.image=s,e.state=ci.RECEIVED,e.request=void 0,Oo.reportSuccess(n._requestImageError)}function o(s){if(e.request.state===$n.CANCELLED){e.state=ci.UNLOADED,e.request=void 0;return}e.state=ci.FAILED,e.request=void 0;let a=`Failed to obtain image tile X: ${e.x} Y: ${e.y} Level: ${e.level}.`;n._requestImageError=Oo.reportError(n._requestImageError,t,t.errorEvent,a,e.x,e.y,e.level,s),n._requestImageError.retry&&r()}function r(){let s=new rr({throttle:!1,throttleByServer:!0,type:gs.IMAGERY});e.request=s,e.state=ci.TRANSITIONING;let a=t.requestImage(e.x,e.y,e.level,s);if(!u(a)){e.state=ci.UNLOADED,e.request=void 0;return}u(t.getTileCredits)&&(e.credits=t.getTileCredits(e.x,e.y,e.level)),a.then(function(c){i(c)}).catch(function(c){o(c)})}r()};gi.prototype._createTextureWebGL=function(e,t){let n=new Qt({minificationFilter:this.minificationFilter,magnificationFilter:this.magnificationFilter}),i=t.image;return u(i.internalFormat)?new Ot({context:e,pixelFormat:i.internalFormat,width:i.width,height:i.height,source:{arrayBufferView:i.bufferView},sampler:n}):new Ot({context:e,source:i,pixelFormat:this._imageryProvider.hasAlphaChannel?tt.RGBA:tt.RGB,sampler:n})};gi.prototype._createTexture=function(e,t){let n=this._imageryProvider,i=t.image;if(u(n.tileDiscardPolicy)){let r=n.tileDiscardPolicy;if(u(r)){if(!r.isReady()){t.state=ci.RECEIVED;return}if(r.shouldDiscardImage(i)){t.state=ci.INVALID;return}}}let o=this._createTextureWebGL(e,t);n.tilingScheme.projection instanceof Li?t.textureWebMercator=o:t.texture=o,t.image=void 0,t.state=ci.TEXTURE_LOADED};function Cxe(e,t,n){return`${e}:${t}:${n}`}gi.prototype._finalizeReprojectTexture=function(e,t){let n=this.minificationFilter,i=this.magnificationFilter;if(n===$t.LINEAR&&i===mi.LINEAR&&!tt.isCompressedFormat(t.pixelFormat)&&R.isPowerOfTwo(t.width)&&R.isPowerOfTwo(t.height)){n=$t.LINEAR_MIPMAP_LINEAR;let r=Vt.maximumTextureFilterAnisotropy,s=Math.min(r,x(this._maximumAnisotropy,r)),a=Cxe(n,i,s),c=e.cache.imageryLayerMipmapSamplers;u(c)||(c={},e.cache.imageryLayerMipmapSamplers=c);let l=c[a];u(l)||(l=c[a]=new Qt({wrapS:En.CLAMP_TO_EDGE,wrapT:En.CLAMP_TO_EDGE,minificationFilter:n,magnificationFilter:i,maximumAnisotropy:s})),t.generateMipmap(ip.NICEST),t.sampler=l}else{let r=Cxe(n,i,0),s=e.cache.imageryLayerNonMipmapSamplers;u(s)||(s={},e.cache.imageryLayerNonMipmapSamplers=s);let a=s[r];u(a)||(a=s[r]=new Qt({wrapS:En.CLAMP_TO_EDGE,wrapT:En.CLAMP_TO_EDGE,minificationFilter:n,magnificationFilter:i})),t.sampler=a}};gi.prototype._reprojectTexture=function(e,t,n){let i=t.textureWebMercator||t.texture,o=t.rectangle,r=e.context;if(n=x(n,!0),n&&!(this._imageryProvider.tilingScheme.projection instanceof Oi)&&o.width/i.width>1e-5){let s=this;t.addReference();let a=new cl({persists:!0,owner:this,preExecute:function(c){oft(c,r,i,t.rectangle)},postExecute:function(c){t.texture=c,s._finalizeReprojectTexture(r,c),t.state=ci.READY,t.releaseReference()},canceled:function(){t.state=ci.TEXTURE_LOADED,t.releaseReference()}});this._reprojectComputeCommands.push(a)}else n&&(t.texture=i),this._finalizeReprojectTexture(r,i),t.state=ci.READY};gi.prototype.queueReprojectionCommands=function(e){let t=this._reprojectComputeCommands,n=t.length;for(let i=0;i<n;++i)e.commandList.push(t[i]);t.length=0};gi.prototype.cancelReprojections=function(){this._reprojectComputeCommands.forEach(function(e){u(e.canceled)&&e.canceled()}),this._reprojectComputeCommands.length=0};gi.prototype.getImageryFromCache=function(e,t,n,i){let o=Exe(e,t,n),r=this._imageryCache[o];return u(r)||(r=new BD(this,e,t,n,i),this._imageryCache[o]=r),r.addReference(),r};gi.prototype.removeImageryFromCache=function(e){let t=Exe(e.x,e.y,e.level);delete this._imageryCache[t]};function Exe(e,t,n){return JSON.stringify([e,t,n])}var LU={u_textureDimensions:function(){return this.textureDimensions},u_texture:function(){return this.texture},textureDimensions:new H,texture:void 0},ift=Wt.supportsTypedArrays()?new Float32Array(2*64):void 0;function oft(e,t,n,i){let o=t.cache.imageryLayer_reproject;if(!u(o)){o=t.cache.imageryLayer_reproject={vertexArray:void 0,shaderProgram:void 0,sampler:void 0,destroy:function(){u(this.framebuffer)&&this.framebuffer.destroy(),u(this.vertexArray)&&this.vertexArray.destroy(),u(this.shaderProgram)&&this.shaderProgram.destroy()}};let b=new Float32Array(2*64*2),C=0;for(let D=0;D<64;++D){let O=D/63;b[C++]=0,b[C++]=O,b[C++]=1,b[C++]=O}let A={position:0,webMercatorT:1},T=ds.getRegularGridIndices(2,64),E=xt.createIndexBuffer({context:t,typedArray:T,usage:ke.STATIC_DRAW,indexDatatype:Be.UNSIGNED_SHORT});o.vertexArray=new ii({context:t,attributes:[{index:A.position,vertexBuffer:xt.createVertexBuffer({context:t,typedArray:b,usage:ke.STATIC_DRAW}),componentsPerAttribute:2},{index:A.webMercatorT,vertexBuffer:xt.createVertexBuffer({context:t,sizeInBytes:64*2*4,usage:ke.STREAM_DRAW}),componentsPerAttribute:1}],indexBuffer:E});let v=new ze({sources:[MU]});o.shaderProgram=tn.fromCache({context:t,vertexShaderSource:v,fragmentShaderSource:OU,attributeLocations:A}),o.sampler=new Qt({wrapS:En.CLAMP_TO_EDGE,wrapT:En.CLAMP_TO_EDGE,minificationFilter:$t.LINEAR,magnificationFilter:mi.LINEAR})}n.sampler=o.sampler;let r=n.width,s=n.height;LU.textureDimensions.x=r,LU.textureDimensions.y=s,LU.texture=n;let a=Math.sin(i.south),c=.5*Math.log((1+a)/(1-a));a=Math.sin(i.north);let f=1/(.5*Math.log((1+a)/(1-a))-c),d=new Ot({context:t,width:r,height:s,pixelFormat:n.pixelFormat,pixelDatatype:n.pixelDatatype,preMultiplyAlpha:n.preMultiplyAlpha});R.isPowerOfTwo(r)&&R.isPowerOfTwo(s)&&d.generateMipmap(ip.NICEST);let p=i.south,g=i.north,m=ift,y=0;for(let b=0;b<64;++b){let C=b/63,A=R.lerp(p,g,C);a=Math.sin(A);let E=(.5*Math.log((1+a)/(1-a))-c)*f;m[y++]=E,m[y++]=E}o.vertexArray.getAttribute(1).vertexBuffer.copyFromArrayView(m),e.shaderProgram=o.shaderProgram,e.outputTexture=d,e.uniformMap=LU,e.vertexArray=o.vertexArray}function rft(e,t,n){let i=e._imageryProvider,o=i.tilingScheme,r=o.ellipsoid,s=e._imageryProvider.tilingScheme.projection instanceof Oi?1:Math.cos(n),a=o.rectangle,l=r.maximumRadius*a.width*s/(i.tileWidth*o.getNumberOfXTilesAtLevel(0))/t,f=Math.log(l)/Math.log(2);return Math.round(f)|0}function sft(e,t){e.numberOfListeners>0?e.raiseEvent(t):console.error(t)}async function aft(e,t){let n;try{if(n=await Promise.resolve(t),e.isDestroyed())return;e._imageryProvider=n,e._readyEvent.raiseEvent(n)}catch(i){sft(e._errorEvent,i)}}var dc=gi;var Sxe={NONE:0,CULLED:1,RENDERED:2,REFINED:3,RENDERED_AND_KICKED:6,REFINED_AND_KICKED:7,CULLED_BUT_NEEDED:9,wasKicked:function(e){return e>=Sxe.RENDERED_AND_KICKED},originalResult:function(e){return e&3},kick:function(e){return e|4}},Xn=Sxe;function KE(e){this.tile=e,this.frameLastUpdated=void 0,this.westMeshes=[],this.westTiles=[],this.southMeshes=[],this.southTiles=[],this.eastMeshes=[],this.eastTiles=[],this.northMeshes=[],this.northTiles=[],this.southwestMesh=void 0,this.southwestTile=void 0,this.southeastMesh=void 0,this.southeastTile=void 0,this.northwestMesh=void 0,this.northwestTile=void 0,this.northeastMesh=void 0,this.northeastTile=void 0,this.changedThisFrame=!0,this.visitedFrame=void 0,this.enqueuedFrame=void 0,this.mesh=void 0,this.vertexArray=void 0,this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new oe}KE.prototype.update=function(e,t,n){this.changedThisFrame&&(Oxe(e,t,this.tile,n),this.changedThisFrame=!1)};KE.prototype.destroy=function(e){this._destroyVertexArray(e),u(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,this.waterMaskTexture.referenceCount===0&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0)};KE.prototype._destroyVertexArray=function(e){u(this.vertexArray)&&(u(e)?e.push(this.vertexArray):sh._freeVertexArray(this.vertexArray),this.vertexArray=void 0)};var cft=new lx;KE.updateFillTiles=function(e,t,n,i){let o=e._quadtree,r=o._levelZeroTiles,s=o._lastSelectionFrameNumber,a=cft;a.clear();for(let l=0;l<t.length;++l){let f=t[l];u(f.data.vertexArray)&&a.enqueue(t[l])}let c=a.dequeue();for(;c!==void 0;){let l=c.findTileToWest(r),f=c.findTileToSouth(r),d=c.findTileToEast(r),p=c.findTileToNorth(r);Is(e,n,c,l,s,gn.EAST,!1,a,i),Is(e,n,c,f,s,gn.NORTH,!1,a,i),Is(e,n,c,d,s,gn.WEST,!1,a,i),Is(e,n,c,p,s,gn.SOUTH,!1,a,i);let g=l.findTileToNorth(r),m=l.findTileToSouth(r),y=d.findTileToNorth(r),b=d.findTileToSouth(r);Is(e,n,c,g,s,gn.SOUTHEAST,!1,a,i),Is(e,n,c,y,s,gn.SOUTHWEST,!1,a,i),Is(e,n,c,m,s,gn.NORTHEAST,!1,a,i),Is(e,n,c,b,s,gn.NORTHWEST,!1,a,i),c=a.dequeue()}};function Is(e,t,n,i,o,r,s,a,c){if(i===void 0)return;let l=i;for(;l&&(l._lastSelectionResultFrame!==o||Xn.wasKicked(l._lastSelectionResult)||Xn.originalResult(l._lastSelectionResult)===Xn.CULLED);){if(s)return;let f=l.parent;if(r>=gn.NORTHWEST&&f!==void 0)switch(r){case gn.NORTHWEST:l=l===f.northwestChild?f:void 0;break;case gn.NORTHEAST:l=l===f.northeastChild?f:void 0;break;case gn.SOUTHWEST:l=l===f.southwestChild?f:void 0;break;case gn.SOUTHEAST:l=l===f.southeastChild?f:void 0;break}else l=f}if(l!==void 0){if(l._lastSelectionResult===Xn.RENDERED){if(u(l.data.vertexArray))return;lft(e,t,n,l,r,o,a,c);return}if(Xn.originalResult(i._lastSelectionResult)!==Xn.CULLED)switch(r){case gn.WEST:Is(e,t,n,i.northwestChild,o,r,!0,a,c),Is(e,t,n,i.southwestChild,o,r,!0,a,c);break;case gn.EAST:Is(e,t,n,i.southeastChild,o,r,!0,a,c),Is(e,t,n,i.northeastChild,o,r,!0,a,c);break;case gn.SOUTH:Is(e,t,n,i.southwestChild,o,r,!0,a,c),Is(e,t,n,i.southeastChild,o,r,!0,a,c);break;case gn.NORTH:Is(e,t,n,i.northeastChild,o,r,!0,a,c),Is(e,t,n,i.northwestChild,o,r,!0,a,c);break;case gn.NORTHWEST:Is(e,t,n,i.northwestChild,o,r,!0,a,c);break;case gn.NORTHEAST:Is(e,t,n,i.northeastChild,o,r,!0,a,c);break;case gn.SOUTHWEST:Is(e,t,n,i.southwestChild,o,r,!0,a,c);break;case gn.SOUTHEAST:Is(e,t,n,i.southeastChild,o,r,!0,a,c);break;default:throw new he("Invalid edge")}}}function lft(e,t,n,i,o,r,s,a){let c=i.data;if(c.fill===void 0)c.fill=new KE(i);else if(c.fill.visitedFrame===r)return;c.fill.enqueuedFrame!==r&&(c.fill.enqueuedFrame=r,c.fill.changedThisFrame=!1,s.enqueue(i)),uft(e,t,n,i,o,a)}function uft(e,t,n,i,o,r){let s=i.data.fill,a,c=n.data.fill;u(c)?(c.visitedFrame=t.frameNumber,c.changedThisFrame&&(Oxe(e,t,n,r),c.changedThisFrame=!1),a=n.data.fill.mesh):a=n.data.mesh;let l,f;switch(o){case gn.WEST:l=s.westMeshes,f=s.westTiles;break;case gn.SOUTH:l=s.southMeshes,f=s.southTiles;break;case gn.EAST:l=s.eastMeshes,f=s.eastTiles;break;case gn.NORTH:l=s.northMeshes,f=s.northTiles;break;case gn.NORTHWEST:s.changedThisFrame=s.changedThisFrame||s.northwestMesh!==a,s.northwestMesh=a,s.northwestTile=n;return;case gn.NORTHEAST:s.changedThisFrame=s.changedThisFrame||s.northeastMesh!==a,s.northeastMesh=a,s.northeastTile=n;return;case gn.SOUTHWEST:s.changedThisFrame=s.changedThisFrame||s.southwestMesh!==a,s.southwestMesh=a,s.southwestTile=n;return;case gn.SOUTHEAST:s.changedThisFrame=s.changedThisFrame||s.southeastMesh!==a,s.southeastMesh=a,s.southeastTile=n;return}if(n.level<=i.level){s.changedThisFrame=s.changedThisFrame||l[0]!==a||l.length!==1,l[0]=a,f[0]=n,l.length=1,f.length=1;return}let d,p,g,m,y=n.rectangle,b,C=i.rectangle;switch(o){case gn.WEST:for(b=(C.north-C.south)*R.EPSILON5,d=0;d<f.length&&(g=f[d],m=g.rectangle,!R.greaterThan(y.north,m.south,b));++d);for(p=d;p<f.length&&(g=f[p],m=g.rectangle,!R.greaterThanOrEquals(y.south,m.north,b));++p);break;case gn.SOUTH:for(b=(C.east-C.west)*R.EPSILON5,d=0;d<f.length&&(g=f[d],m=g.rectangle,!R.lessThan(y.west,m.east,b));++d);for(p=d;p<f.length&&(g=f[p],m=g.rectangle,!R.lessThanOrEquals(y.east,m.west,b));++p);break;case gn.EAST:for(b=(C.north-C.south)*R.EPSILON5,d=0;d<f.length&&(g=f[d],m=g.rectangle,!R.lessThan(y.south,m.north,b));++d);for(p=d;p<f.length&&(g=f[p],m=g.rectangle,!R.lessThanOrEquals(y.north,m.south,b));++p);break;case gn.NORTH:for(b=(C.east-C.west)*R.EPSILON5,d=0;d<f.length&&(g=f[d],m=g.rectangle,!R.greaterThan(y.east,m.west,b));++d);for(p=d;p<f.length&&(g=f[p],m=g.rectangle,!R.greaterThanOrEquals(y.west,m.east,b));++p);break}p-d===1?(s.changedThisFrame=s.changedThisFrame||l[d]!==a,l[d]=a,f[d]=n):(s.changedThisFrame=!0,l.splice(d,p-d,a),f.splice(d,p-d,n))}var yb=new de,fft=new de,XE=new h,mK=new h,fK=new H,dK=new H,Ou=new H;function zU(){this.height=0,this.encodedNormal=new H}function NU(e,t,n,i,o,r,s,a,c){if(u(o))return o;let l;if(u(r)&&u(s))l=(r.height+s.height)*.5;else if(u(r))l=r.height;else if(u(s))l=s.height;else if(u(a))l=a.height;else{let d=e.tile.data.tileBoundingRegion,p=0,g=0;u(d)&&(p=d.minimumHeight,g=d.maximumHeight),l=(p+g)*.5}return Mxe(e,t,n,i,l,c),c}var dft={minimumHeight:0,maximumHeight:0},hft=new h,vxe=new zU,wxe=new zU,Dxe=new zU,Ixe=new zU,mft=typeof Uint8Array<"u"?new Uint8Array(9*9):void 0,pft={tilingScheme:void 0,x:0,y:0,level:0,exaggeration:1,exaggerationRelativeHeight:0};function Oxe(e,t,n,i){sh.initialize(n,e.terrainProvider,e._imageryLayers);let o=n.data,r=o.fill,s=n.rectangle,a=t.verticalExaggeration,c=t.verticalExaggerationRelativeHeight,l=a!==1,f=n.tilingScheme.ellipsoid,d=BU(r,f,0,1,r.northwestTile,r.northwestMesh,r.northTiles,r.northMeshes,r.westTiles,r.westMeshes,Dxe),p=BU(r,f,0,0,r.southwestTile,r.southwestMesh,r.westTiles,r.westMeshes,r.southTiles,r.southMeshes,vxe),g=BU(r,f,1,0,r.southeastTile,r.southeastMesh,r.southTiles,r.southMeshes,r.eastTiles,r.eastMeshes,wxe),m=BU(r,f,1,1,r.northeastTile,r.northeastMesh,r.eastTiles,r.eastMeshes,r.northTiles,r.northMeshes,Ixe);d=NU(r,f,0,1,d,p,m,g,Dxe),p=NU(r,f,0,0,p,d,g,m,vxe),g=NU(r,f,1,1,g,p,m,d,wxe),m=NU(r,f,1,1,m,g,d,p,Ixe);let y=p.height,b=g.height,C=d.height,A=m.height,T=Math.min(y,b,C,A),E=Math.max(y,b,C,A),v=(T+E)*.5,D,O,P=e.getLevelMaximumGeometricError(n.level),M=f.maximumRadius-P,L=Math.acos(M/f.maximumRadius)*4;if(L*=1.5,s.width>L&&E-T<=P){let w=new lc({width:9,height:9,buffer:mft,structure:{heightOffset:E}}),I=pft;I.tilingScheme=n.tilingScheme,I.x=n.x,I.y=n.y,I.level=n.level,I.exaggeration=a,I.exaggerationRelativeHeight=c,r.mesh=w._createMeshSync(I)}else{let w=l,I=se.center(s,fft);I.height=v;let N=f.cartographicToCartesian(I,hft),k=new Zc(N,void 0,void 0,void 0,void 0,!0,!0,w,a,c),z=5,V;for(V=r.westMeshes,D=0,O=V.length;D<O;++D)z+=V[D].eastIndicesNorthToSouth.length;for(V=r.southMeshes,D=0,O=V.length;D<O;++D)z+=V[D].northIndicesWestToEast.length;for(V=r.eastMeshes,D=0,O=V.length;D<O;++D)z+=V[D].westIndicesSouthToNorth.length;for(V=r.northMeshes,D=0,O=V.length;D<O;++D)z+=V[D].southIndicesEastToWest.length;let U=dft;U.minimumHeight=T,U.maximumHeight=E;let B=k.stride,W=new Float32Array(z*B),j=0,Q=j;j=FU(f,s,k,W,j,0,1,d.height,d.encodedNormal,1,U),j=VU(r,f,k,W,j,r.westTiles,r.westMeshes,gn.EAST,U);let q=j;j=FU(f,s,k,W,j,0,0,p.height,p.encodedNormal,0,U),j=VU(r,f,k,W,j,r.southTiles,r.southMeshes,gn.NORTH,U);let X=j;j=FU(f,s,k,W,j,1,0,g.height,g.encodedNormal,0,U),j=VU(r,f,k,W,j,r.eastTiles,r.eastMeshes,gn.WEST,U);let Z=j;j=FU(f,s,k,W,j,1,1,m.height,m.encodedNormal,1,U),j=VU(r,f,k,W,j,r.northTiles,r.northMeshes,gn.SOUTH,U),T=U.minimumHeight,E=U.maximumHeight;let fe=wn.fromRectangle(s,T,E,n.tilingScheme.ellipsoid),xe=Li.geodeticLatitudeToMercatorAngle(s.south),re=1/(Li.geodeticLatitudeToMercatorAngle(s.north)-xe),pe=(Li.geodeticLatitudeToMercatorAngle(I.latitude)-xe)*re,ye=f.geodeticSurfaceNormalCartographic(yb,mK),Se=Ln.octEncode(ye,fK),Te=j;k.encode(W,j*B,fe.center,H.fromElements(.5,.5,Ou),v,Se,pe,ye),++j;let Fe=j,Ve=Fe<256?1:2,Ze=(Fe-1)*3,gt=Ze*Ve,lt=(W.length-Fe*B)*Float32Array.BYTES_PER_ELEMENT,Oe;if(lt>=gt){let Ae=Fe*B*Float32Array.BYTES_PER_ELEMENT;Oe=Fe<256?new Uint8Array(W.buffer,Ae,Ze):new Uint16Array(W.buffer,Ae,Ze)}else Oe=Fe<256?new Uint8Array(Ze):new Uint16Array(Ze);W=new Float32Array(W.buffer,0,Fe*B);let Mt=0;for(D=0;D<Fe-2;++D)Oe[Mt++]=Te,Oe[Mt++]=D,Oe[Mt++]=D+1;Oe[Mt++]=Te,Oe[Mt++]=D,Oe[Mt++]=0;let ut=[];for(D=q;D>=Q;--D)ut.push(D);let at=[];for(D=X;D>=q;--D)at.push(D);let Kt=[];for(D=Z;D>=X;--D)Kt.push(D);let Ce=[];for(Ce.push(0),D=Te-1;D>=Z;--D)Ce.push(D);r.mesh=new th(k.center,W,Oe,Ze,Fe,T,E,ae.fromOrientedBoundingBox(fe),Aft(e,fe.center,s,T,E),k.stride,fe,k,ut,at,Kt,Ce)}let _=t.context;r._destroyVertexArray(i),r.vertexArray=sh._createVertexArrayForMesh(_,r.mesh),o.processImagery(n,e.terrainProvider,t,!0);let S=r.waterMaskTexture;if(r.waterMaskTexture=void 0,e.terrainProvider.hasWaterMask){let w=o._findAncestorTileWithTerrainData(n);u(w)&&u(w.data.waterMaskTexture)&&(r.waterMaskTexture=w.data.waterMaskTexture,++r.waterMaskTexture.referenceCount,o._computeWaterMaskTranslationAndScale(n,w,r.waterMaskTranslationAndScale))}u(S)&&(--S.referenceCount,S.referenceCount===0&&S.destroy())}function FU(e,t,n,i,o,r,s,a,c,l,f){let d=yb;d.longitude=R.lerp(t.west,t.east,r),d.latitude=R.lerp(t.south,t.north,s),d.height=a;let p=e.cartographicToCartesian(d,XE),g;n.hasGeodeticSurfaceNormals&&(g=e.geodeticSurfaceNormal(p,mK));let m=dK;return m.x=r,m.y=s,n.encode(i,o*n.stride,p,m,a,c,l,g),f.minimumHeight=Math.min(f.minimumHeight,a),f.maximumHeight=Math.max(f.maximumHeight,a),o+1}var UU=new se;function VD(e,t,n,i){let o=e.rectangle,r=t.rectangle;t.x===0&&n.x===1&&e.x===e.tilingScheme.getNumberOfXTilesAtLevel(e.level)-1?(o=se.clone(e.rectangle,UU),o.west-=R.TWO_PI,o.east-=R.TWO_PI):e.x===0&&n.x===0&&t.x===t.tilingScheme.getNumberOfXTilesAtLevel(t.level)-1&&(o=se.clone(e.rectangle,UU),o.west+=R.TWO_PI,o.east+=R.TWO_PI);let s=o.east-o.west,a=(r.west-o.west)/s,c=(r.east-o.west)/s,l=o.north-o.south,f=(r.south-o.south)/l,d=(r.north-o.south)/l,p=(n.x-a)/(c-a),g=(n.y-f)/(d-f);return Math.abs(p)<Math.EPSILON5?p=0:Math.abs(p-1)<Math.EPSILON5&&(p=1),Math.abs(g)<Math.EPSILON5?g=0:Math.abs(g-1)<Math.EPSILON5&&(g=1),i.x=p,i.y=g,i}var _ft=new H;function hK(e,t,n,i,o){let r=e.encoding,s=e.vertices;if(o.height=r.decodeHeight(s,t),r.hasVertexNormals)r.getOctEncodedNormal(s,t,o.encodedNormal);else{let a=o.encodedNormal;a.x=0,a.y=0}}var gft=new H,yft=new h;function xft(e,t,n,i,o,r,s,a,c,l){let f=i.encoding,d=i.vertices,p=VD(t,n,f.decodeTextureCoordinates(d,o,Ou),Ou),g=VD(t,n,f.decodeTextureCoordinates(d,r,dK),dK),m;c?m=(s-p.x)/(g.x-p.x):m=(a-p.y)/(g.y-p.y);let y=f.decodeHeight(d,o),b=f.decodeHeight(d,r),C=n.rectangle;yb.longitude=R.lerp(C.west,C.east,s),yb.latitude=R.lerp(C.south,C.north,a),l.height=yb.height=R.lerp(y,b,m);let A;if(f.hasVertexNormals){let T=f.getOctEncodedNormal(d,o,_ft),E=f.getOctEncodedNormal(d,r,gft),v=Ln.octDecode(T.x,T.y,XE),D=Ln.octDecode(E.x,E.y,yft);A=h.lerp(v,D,m,XE),h.normalize(A,A),Ln.octEncode(A,l.encodedNormal)}else A=e.geodeticSurfaceNormalCartographic(yb,XE),Ln.octEncode(A,l.encodedNormal)}function Mxe(e,t,n,i,o,r){r.height=o;let s=t.geodeticSurfaceNormalCartographic(yb,XE);Ln.octEncode(s,r.encodedNormal)}function BU(e,t,n,i,o,r,s,a,c,l,f){if(Rxe(e,t,a,s,!1,n,i,f)||Rxe(e,t,l,c,!0,n,i,f))return f;let p;if(pK(o,r))return n===0?i===0?p=r.eastIndicesNorthToSouth[0]:p=r.southIndicesEastToWest[0]:i===0?p=r.northIndicesWestToEast[0]:p=r.westIndicesSouthToNorth[0],hK(r,p,n,i,f),f;let g;if(n===0?i===0?g=kU(e.westMeshes,e.westTiles,gn.EAST,e.southMeshes,e.southTiles,gn.NORTH,n,i):g=kU(e.northMeshes,e.northTiles,gn.SOUTH,e.westMeshes,e.westTiles,gn.EAST,n,i):i===0?g=kU(e.southMeshes,e.southTiles,gn.NORTH,e.eastMeshes,e.eastTiles,gn.WEST,n,i):g=kU(e.eastMeshes,e.eastTiles,gn.WEST,e.northMeshes,e.northTiles,gn.SOUTH,n,i),u(g))return Mxe(e,t,n,i,g,f),f}function kU(e,t,n,i,o,r,s,a){let c=Pxe(e,t,!1,n,s,a),l=Pxe(i,o,!0,r,s,a);return u(c)&&u(l)?(c+l)*.5:u(c)?c:l}function VU(e,t,n,i,o,r,s,a,c){for(let l=0;l<r.length;++l)o=bft(e,t,n,i,o,r[l],s[l],a,c);return o}function bft(e,t,n,i,o,r,s,a,c){let l=r.rectangle;a===gn.EAST&&e.tile.x===0?(l=se.clone(r.rectangle,UU),l.west-=R.TWO_PI,l.east-=R.TWO_PI):a===gn.WEST&&r.x===0&&(l=se.clone(r.rectangle,UU),l.west+=R.TWO_PI,l.east+=R.TWO_PI);let f=e.tile.rectangle,d,p;o>0&&(n.decodeTextureCoordinates(i,o-1,Ou),d=Ou.x,p=Ou.y);let g,m;switch(a){case gn.WEST:g=s.westIndicesSouthToNorth,m=!1;break;case gn.NORTH:g=s.northIndicesWestToEast,m=!0;break;case gn.EAST:g=s.eastIndicesNorthToSouth,m=!1;break;case gn.SOUTH:g=s.southIndicesEastToWest,m=!0;break}let y=r,b=e.tile,C=s.encoding,A=s.vertices,T=n.stride,E,v;C.hasWebMercatorT&&(E=Li.geodeticLatitudeToMercatorAngle(f.south),v=1/(Li.geodeticLatitudeToMercatorAngle(f.north)-E));for(let D=0;D<g.length;++D){let O=g[D],P=C.decodeTextureCoordinates(A,O,Ou);VD(y,b,P,P);let M=P.x,L=P.y,_=m?M:L;if(_<0||_>1||Math.abs(M-d)<R.EPSILON5&&Math.abs(L-p)<R.EPSILON5)continue;let S=Math.abs(M)<R.EPSILON5||Math.abs(M-1)<R.EPSILON5,w=Math.abs(L)<R.EPSILON5||Math.abs(L-1)<R.EPSILON5;if(S&&w)continue;let I=C.decodePosition(A,O,XE),N=C.decodeHeight(A,O),k;C.hasVertexNormals?k=C.getOctEncodedNormal(A,O,fK):(k=fK,k.x=0,k.y=0);let z=L;if(C.hasWebMercatorT){let U=R.lerp(f.south,f.north,L);z=(Li.geodeticLatitudeToMercatorAngle(U)-E)*v}let V;n.hasGeodeticSurfaceNormals&&(V=t.geodeticSurfaceNormal(I,mK)),n.encode(i,o*T,I,P,N,k,z,V),c.minimumHeight=Math.min(c.minimumHeight,N),c.maximumHeight=Math.max(c.maximumHeight,N),++o}return o}function Pxe(e,t,n,i,o,r){let s,a,c;n?(s=0,a=e.length,c=1):(s=e.length-1,a=-1,c=-1);for(let l=s;l!==a;l+=c){let f=e[l],d=t[l];if(!pK(d,f))continue;let p;switch(i){case gn.WEST:p=f.westIndicesSouthToNorth;break;case gn.SOUTH:p=f.southIndicesEastToWest;break;case gn.EAST:p=f.eastIndicesNorthToSouth;break;case gn.NORTH:p=f.northIndicesWestToEast;break}let g=p[n?0:p.length-1];if(u(g))return f.encoding.decodeHeight(f.vertices,g)}}function pK(e,t){return u(t)&&(!u(e.data.fill)||!e.data.fill.changedThisFrame)}function Rxe(e,t,n,i,o,r,s,a){let c,l,f,d,p,g=i[o?0:n.length-1],m=n[o?0:n.length-1];if(pK(g,m)&&(r===0?s===0?(c=o?m.northIndicesWestToEast:m.eastIndicesNorthToSouth,l=o,f=o):(c=o?m.eastIndicesNorthToSouth:m.southIndicesEastToWest,l=!o,f=!1):s===0?(c=o?m.westIndicesSouthToNorth:m.northIndicesWestToEast,l=!o,f=!0):(c=o?m.southIndicesEastToWest:m.westIndicesSouthToNorth,l=o,f=!o),c.length>0)){d=o?0:c.length-1,p=c[d],m.encoding.decodeTextureCoordinates(m.vertices,p,Ou);let y=VD(g,e.tile,Ou,Ou);if(y.x===r&&y.y===s)return hK(m,p,r,s,a),!0;if(d=No(c,l?r:s,function(b,C){m.encoding.decodeTextureCoordinates(m.vertices,b,Ou);let A=VD(g,e.tile,Ou,Ou);return f?l?A.x-r:A.y-s:l?r-A.x:s-A.y}),d<0){if(d=~d,d>0&&d<c.length)return xft(t,g,e.tile,m,c[d-1],c[d],r,s,l,a),!0}else return hK(m,c[d],r,s,a),!0}return!1}var Cft=[new h,new h,new h,new h];function Aft(e,t,n,i,o,r){let s=e.quadtree._occluders.ellipsoid,a=s.ellipsoid,c=Cft;return h.fromRadians(n.west,n.south,o,a,c[0]),h.fromRadians(n.east,n.south,o,a,c[1]),h.fromRadians(n.west,n.north,o,a,c[2]),h.fromRadians(n.east,n.north,o,a,c[3]),s.computeHorizonCullingPointPossiblyUnderEllipsoid(t,c,i,r)}var UD=KE;function nr(e){this.lightingFadeOutDistance=65e5,this.lightingFadeInDistance=9e6,this.hasWaterMask=!1,this.showWaterEffect=!1,this.oceanNormalMap=void 0,this.zoomedOutOceanSpecularIntensity=.5,this.enableLighting=!1,this.dynamicAtmosphereLighting=!1,this.dynamicAtmosphereLightingFromSun=!1,this.showGroundAtmosphere=!1,this.shadows=xn.RECEIVE_ONLY,this.vertexShadowDarkness=.3,this.fillHighlightColor=void 0,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this.showSkirts=!0,this.backFaceCulling=!0,this.undergroundColor=void 0,this.undergroundColorAlphaByDistance=void 0,this.lambertDiffuseMultiplier=0,this.materialUniformMap=void 0,this._materialUniformMap=void 0,this._quadtree=void 0,this._terrainProvider=e.terrainProvider,this._imageryLayers=e.imageryLayers,this._surfaceShaderSet=e.surfaceShaderSet,this._renderState=void 0,this._blendRenderState=void 0,this._disableCullingRenderState=void 0,this._disableCullingBlendRenderState=void 0,this._errorEvent=new me,this._removeLayerAddedListener=this._imageryLayers.layerAdded.addEventListener(nr.prototype._onLayerAdded,this),this._removeLayerRemovedListener=this._imageryLayers.layerRemoved.addEventListener(nr.prototype._onLayerRemoved,this),this._removeLayerMovedListener=this._imageryLayers.layerMoved.addEventListener(nr.prototype._onLayerMoved,this),this._removeLayerShownListener=this._imageryLayers.layerShownOrHidden.addEventListener(nr.prototype._onLayerShownOrHidden,this),this._imageryLayersUpdatedEvent=new me,this._layerOrderChanged=!1,this._tilesToRenderByTextureCount=[],this._drawCommands=[],this._uniformMaps=[],this._usedDrawCommands=0,this._vertexArraysToDestroy=[],this._debug={wireframe:!1,boundingSphereTile:void 0},this._baseColor=void 0,this._firstPassInitialColor=void 0,this.baseColor=new G(0,0,.5,1),this._clippingPlanes=void 0,this._clippingPolygons=void 0,this.cartographicLimitRectangle=se.clone(se.MAX_VALUE),this._hasLoadedTilesThisFrame=!1,this._hasFillTilesThisFrame=!1,this._oldVerticalExaggeration=void 0,this._oldVerticalExaggerationRelativeHeight=void 0}Object.defineProperties(nr.prototype,{baseColor:{get:function(){return this._baseColor},set:function(e){this._baseColor=e,this._firstPassInitialColor=oe.fromColor(e,this._firstPassInitialColor)}},quadtree:{get:function(){return this._quadtree},set:function(e){this._quadtree=e}},tilingScheme:{get:function(){if(u(this._terrainProvider))return this._terrainProvider.tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},imageryLayersUpdatedEvent:{get:function(){return this._imageryLayersUpdatedEvent}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){this._terrainProvider!==e&&(this._terrainProvider=e,u(this._quadtree)&&this._quadtree.invalidateAllTiles())}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){As.setOwner(e,this,"_clippingPlanes")}},clippingPolygons:{get:function(){return this._clippingPolygons},set:function(e){Yh.setOwner(e,this,"_clippingPolygons")}}});function Tft(e,t){let n=e.loadingImagery;u(n)||(n=e.readyImagery);let i=t.loadingImagery;return u(i)||(i=t.readyImagery),n.imageryLayer._layerIndex-i.imageryLayer._layerIndex}nr.prototype.update=function(e){this._imageryLayers._update()};function Eft(e,t){let n=t.creditDisplay,i=e._terrainProvider;u(i)&&u(i.credit)&&n.addCreditToNextFrame(i.credit);let o=e._imageryLayers;for(let r=0,s=o.length;r<s;++r){let a=o.get(r);a.ready&&a.show&&u(a.imageryProvider.credit)&&n.addCreditToNextFrame(a.imageryProvider.credit)}}nr.prototype.initialize=function(e){this._imageryLayers.queueReprojectionCommands(e),this._layerOrderChanged&&(this._layerOrderChanged=!1,this._quadtree.forEachLoadedTile(function(i){i.data.imagery.sort(Tft)})),Eft(this,e);let t=this._vertexArraysToDestroy,n=t.length;for(let i=0;i<n;++i)sh._freeVertexArray(t[i]);t.length=0};nr.prototype.beginUpdate=function(e){let t=this._tilesToRenderByTextureCount;for(let o=0,r=t.length;o<r;++o){let s=t[o];u(s)&&(s.length=0)}let n=this._clippingPlanes;u(n)&&n.enabled&&n.update(e);let i=this._clippingPolygons;u(i)&&i.enabled&&(i.update(e),i.queueCommands(e)),this._usedDrawCommands=0,this._hasLoadedTilesThisFrame=!1,this._hasFillTilesThisFrame=!1};nr.prototype.endUpdate=function(e){if(!u(this._renderState)){this._renderState=Ue.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:wc.LESS}}),this._blendRenderState=Ue.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:wc.LESS_OR_EQUAL},blending:un.ALPHA_BLEND});let s=Ge(this._renderState,!0);s.cull.enabled=!1,this._disableCullingRenderState=Ue.fromCache(s),s=Ge(this._blendRenderState,!0),s.cull.enabled=!1,this._disableCullingBlendRenderState=Ue.fromCache(s)}this._hasFillTilesThisFrame&&this._hasLoadedTilesThisFrame&&UD.updateFillTiles(this,this._quadtree._tilesToRender,e,this._vertexArraysToDestroy);let t=this.quadtree,n=e.verticalExaggeration,i=e.verticalExaggerationRelativeHeight,o=this._oldVerticalExaggeration!==n||this._oldVerticalExaggerationRelativeHeight!==i;this._oldVerticalExaggeration=n,this._oldVerticalExaggerationRelativeHeight=i,o&&t.forEachLoadedTile(function(s){s.data.updateExaggeration(s,e,t)});let r=this._tilesToRenderByTextureCount;for(let s=0,a=r.length;s<a;++s){let c=r[s];if(u(c))for(let l=0,f=c.length;l<f;++l){let d=c[l],p=d.data.tileBoundingRegion;Xft(this,d,e),e.minimumTerrainHeight=Math.min(e.minimumTerrainHeight,p.minimumHeight)}}};function kxe(e,t){let n=t.globeTranslucencyState;if(n.translucent){let i=e.renderState.blending.enabled;n.pushDerivedCommands(e,i,t)}else t.commandList.push(e)}nr.prototype.updateForPick=function(e){let t=this._drawCommands;for(let n=0,i=this._usedDrawCommands;n<i;++n)kxe(t[n],e)};nr.prototype.cancelReprojections=function(){this._imageryLayers.cancelReprojections()};nr.prototype.getLevelMaximumGeometricError=function(e){return u(this._terrainProvider)?this._terrainProvider.getLevelMaximumGeometricError(e):0};nr.prototype.loadTile=function(e,t){let n=t.data,i=!0,o;u(n)&&(i=n.boundingVolumeSourceTile!==t||t._lastSelectionResult===Xn.CULLED_BUT_NEEDED,o=n.terrainState),sh.processStateMachine(t,e,this.terrainProvider,this._imageryLayers,this.quadtree,this._vertexArraysToDestroy,i),n=t.data,i&&o!==t.data.terrainState&&this.computeTileVisibility(t,e,this.quadtree.occluders)!==Sr.NONE&&n.boundingVolumeSourceTile===t&&(i=!1,sh.processStateMachine(t,e,this.terrainProvider,this._imageryLayers,this.quadtree,this._vertexArraysToDestroy,i))};var Sft=new ae,Vxe=new se,vft=new se,wft=new de;function GU(e,t){if(t.west<t.east)return t;let n=se.clone(t,vft);return se.center(e,wft).longitude>0?n.east=R.PI:n.west=-R.PI,n}function Uxe(e,t){if(t.cameraUnderground||t.globeTranslucencyState.translucent)return!0;if(e.backFaceCulling)return!1;let n=e._clippingPlanes;if(u(n)&&n.enabled)return!0;let i=e._clippingPolygons;return!!(u(i)&&i.enabled||!se.equals(e.cartographicLimitRectangle,se.MAX_VALUE))}nr.prototype.computeTileVisibility=function(e,t,n){let i=this.computeDistanceToTile(e,t);e._distance=i;let o=Uxe(this,t);if(t.fog.enabled&&!o&&R.fog(i,t.fog.density)>=1)return Sr.NONE;let r=e.data,s=r.tileBoundingRegion;if(r.boundingVolumeSourceTile===void 0)return Sr.PARTIAL;let a=t.cullingVolume,c=s.boundingVolume;u(c)||(c=s.boundingSphere),r.clippedByBoundaries=!1;let l=GU(e.rectangle,this.cartographicLimitRectangle),f=se.simpleIntersection(l,e.rectangle,Vxe);if(!u(f))return Sr.NONE;if(se.equals(f,e.rectangle)||(r.clippedByBoundaries=!0),t.mode!==ne.SCENE3D&&(c=Sft,ae.fromRectangleWithHeights2D(e.rectangle,t.mapProjection,s.minimumHeight,s.maximumHeight,c),h.fromElements(c.center.z,c.center.x,c.center.y,c.center),t.mode===ne.MORPHING&&u(r.renderedMesh)&&(c=ae.union(s.boundingSphere,c,c))),!u(c))return Sr.PARTIAL;let d=this._clippingPlanes;if(u(d)&&d.enabled){let b=d.computeIntersectionWithBoundingVolume(c);if(e.isClipped=b!==qt.INSIDE,b===qt.OUTSIDE)return Sr.NONE}let p=this._clippingPolygons;if(u(p)&&p.enabled){let b=p.computeIntersectionWithBoundingVolume(s);e.isClipped=b!==qt.OUTSIDE}let g,m=a.computeVisibility(c);if(m===qt.OUTSIDE?g=Sr.NONE:m===qt.INTERSECTING?g=Sr.PARTIAL:m===qt.INSIDE&&(g=Sr.FULL),g===Sr.NONE)return g;let y=t.mode===ne.SCENE3D&&t.camera.frustum instanceof sn;if(t.mode===ne.SCENE3D&&!y&&u(n)&&!o){let b=r.occludeePointInScaledSpace;return!u(b)||n.ellipsoid.isScaledSpacePointVisiblePossiblyUnderEllipsoid(b,s.minimumHeight)?g:Sr.NONE}return g};nr.prototype.canRefine=function(e){return u(e.data.terrainData)?!0:this.terrainProvider.getTileDataAvailable(e.x*2,e.y*2,e.level+1)!==void 0};var Dft=[],Ift=[];nr.prototype.canRenderWithoutLosingDetail=function(e,t){let n=e.data,i=Dft;i.length=this._imageryLayers.length;let o=!1,r=!1,s;u(n)&&(o=n.terrainState===yo.READY,r=!0,s=n.imagery);let a,c;for(a=0,c=i.length;a<c;++a)i[a]=r;if(u(s))for(a=0,c=s.length;a<c;++a){let d=s[a],p=d.loadingImagery,g=!u(p)||p.state===ci.FAILED||p.state===ci.INVALID,m=(d.loadingImagery||d.readyImagery).imageryLayer._layerIndex;i[m]=g&&i[m]}let l=this.quadtree._lastSelectionFrameNumber,f=Ift;for(f.length=0,f.push(e.southwestChild,e.southeastChild,e.northwestChild,e.northeastChild);f.length>0;){let d=f.pop(),p=d._lastSelectionResultFrame===l?d._lastSelectionResult:Xn.NONE;if(p===Xn.RENDERED){let g=d.data;if(!u(g))continue;if(!o&&d.data.terrainState===yo.READY)return!1;let m=d.data.imagery;for(a=0,c=m.length;a<c;++a){let y=m[a],b=y.loadingImagery,C=!u(b)||b.state===ci.FAILED||b.state===ci.INVALID,A=(y.loadingImagery||y.readyImagery).imageryLayer._layerIndex;if(C&&!i[A])return!1}}else p===Xn.REFINED&&f.push(d.southwestChild,d.southeastChild,d.northwestChild,d.northeastChild)}return!0};var Pft=new h;nr.prototype.computeTileLoadPriority=function(e,t){let n=e.data;if(n===void 0)return 0;let i=n.tileBoundingRegion.boundingVolume;if(i===void 0)return 0;let o=t.camera.positionWC,r=t.camera.directionWC,s=h.subtract(i.center,o,Pft),a=h.magnitude(s);return a<R.EPSILON5?0:(h.divideByScalar(s,a,s),(1-h.dot(s,r))*e._distance)};var Lxe=new F,HU=new F,Rft=new oe,Oft=new oe,Mft=new oe,Lft=new h,Nxe=new h,Nft=new h,Fft=new h;nr.prototype.showTileThisFrame=function(e,t){let n=0,i=e.data.imagery;for(let a=0,c=i.length;a<c;++a){let l=i[a];u(l.readyImagery)&&l.readyImagery.imageryLayer.alpha!==0&&++n}let o=this._tilesToRenderByTextureCount[n];u(o)||(o=[],this._tilesToRenderByTextureCount[n]=o),o.push(e);let r=e.data;u(r.vertexArray)?this._hasLoadedTilesThisFrame=!0:this._hasFillTilesThisFrame=!0;let s=this._debug;++s.tilesRendered,s.texturesRendered+=n};var Bft=[new h,new h,new h,new h];function Fxe(e,t,n,i,o,r){let s=e.quadtree._occluders.ellipsoid,a=s.ellipsoid,c=Bft;return h.fromRadians(n.west,n.south,o,a,c[0]),h.fromRadians(n.east,n.south,o,a,c[1]),h.fromRadians(n.west,n.north,o,a,c[2]),h.fromRadians(n.east,n.north,o,a,c[3]),s.computeHorizonCullingPointPossiblyUnderEllipsoid(t,c,i,r)}nr.prototype.computeDistanceToTile=function(e,t){kft(e,this,t);let n=e.data;if(n.boundingVolumeSourceTile===void 0)return 9999999999;let o=n.tileBoundingRegion,r=o.minimumHeight,s=o.maximumHeight;if(n.boundingVolumeSourceTile!==e){let c=t.camera.positionCartographic.height,l=Math.abs(c-r),f=Math.abs(c-s);l>f?(o.minimumHeight=r,o.maximumHeight=r):(o.minimumHeight=s,o.maximumHeight=s)}let a=o.distanceToCamera(t);return o.minimumHeight=r,o.maximumHeight=s,a};function kft(e,t,n){let i=e.data;i===void 0&&(i=e.data=new sh);let o=e.tilingScheme.ellipsoid;i.tileBoundingRegion===void 0&&(i.tileBoundingRegion=new Pd({computeBoundingVolumes:!1,rectangle:e.rectangle,ellipsoid:o,minimumHeight:0,maximumHeight:0}));let r=i.tileBoundingRegion,s=r.minimumHeight,a=r.maximumHeight,c=!1,l=e,f=i.mesh,d=i.terrainData;if(f!==void 0&&f.minimumHeight!==void 0&&f.maximumHeight!==void 0)r.minimumHeight=f.minimumHeight,r.maximumHeight=f.maximumHeight,c=!0;else if(d!==void 0&&d._minimumHeight!==void 0&&d._maximumHeight!==void 0)r.minimumHeight=d._minimumHeight,r.maximumHeight=d._maximumHeight;else{r.minimumHeight=Number.NaN,r.maximumHeight=Number.NaN;let p=e.parent;for(;p!==void 0;){let g=p.data;if(g!==void 0){let m=g.mesh,y=g.terrainData;if(m!==void 0&&m.minimumHeight!==void 0&&m.maximumHeight!==void 0){r.minimumHeight=m.minimumHeight,r.maximumHeight=m.maximumHeight;break}else if(y!==void 0&&y._minimumHeight!==void 0&&y._maximumHeight!==void 0){r.minimumHeight=y._minimumHeight,r.maximumHeight=y._maximumHeight;break}}p=p.parent}l=p}if(l!==void 0){let p=n.verticalExaggeration,g=n.verticalExaggerationRelativeHeight;if(p!==1&&(c=!1,r.minimumHeight=Mr.getHeight(r.minimumHeight,p,g),r.maximumHeight=Mr.getHeight(r.maximumHeight,p,g)),c)i.boundingVolumeIsFromMesh||(r._orientedBoundingBox=wn.clone(f.orientedBoundingBox,r._orientedBoundingBox),r._boundingSphere=ae.clone(f.boundingSphere3D,r._boundingSphere),i.occludeePointInScaledSpace=h.clone(f.occludeePointInScaledSpace,i.occludeePointInScaledSpace),u(i.occludeePointInScaledSpace)||(i.occludeePointInScaledSpace=Fxe(t,r._orientedBoundingBox.center,e.rectangle,r.minimumHeight,r.maximumHeight,i.occludeePointInScaledSpace)));else{let y=r._orientedBoundingBox===void 0||r._boundingSphere===void 0;(r.minimumHeight!==s||r.maximumHeight!==a||y)&&(r.computeBoundingVolumes(o),i.occludeePointInScaledSpace=Fxe(t,r._orientedBoundingBox.center,e.rectangle,r.minimumHeight,r.maximumHeight,i.occludeePointInScaledSpace))}i.boundingVolumeSourceTile=l,i.boundingVolumeIsFromMesh=c}else i.boundingVolumeSourceTile=void 0,i.boundingVolumeIsFromMesh=!1}nr.prototype.isDestroyed=function(){return!1};nr.prototype.destroy=function(){return this._tileProvider=this._tileProvider&&this._tileProvider.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),this._clippingPolygons=this._clippingPolygons&&this._clippingPolygons.destroy(),this._removeLayerAddedListener=this._removeLayerAddedListener&&this._removeLayerAddedListener(),this._removeLayerRemovedListener=this._removeLayerRemovedListener&&this._removeLayerRemovedListener(),this._removeLayerMovedListener=this._removeLayerMovedListener&&this._removeLayerMovedListener(),this._removeLayerShownListener=this._removeLayerShownListener&&this._removeLayerShownListener(),ue(this)};function Vft(e,t,n){return function(i){let o,r,s=-1,a=i.data.imagery,c=a.length,l;for(l=0;l<c;++l)if(o=a[l],r=x(o.readyImagery,o.loadingImagery),r.imageryLayer===t){s=l;break}if(s!==-1){let f=s+e;if(o=a[f],r=u(o)?x(o.readyImagery,o.loadingImagery):void 0,!u(r)||r.imageryLayer!==t)return!t._createTileImagerySkeletons(i,n,f);for(l=s;l<f;++l)a[l].freeResources();a.splice(s,e)}return!0}}nr.prototype._onLayerAdded=function(e,t){if(!this.isDestroyed()&&e.show){let n=this._terrainProvider,i=this,o=this._imageryLayersUpdatedEvent,r=function(){e._imageryCache={},i._quadtree.forEachLoadedTile(function(s){if(u(s._loadedCallbacks[e._layerIndex]))return;let a,c=s.data.imagery,l=c.length,f=-1,d=0;for(a=0;a<l;++a){let g=c[a];if(x(g.readyImagery,g.loadingImagery).imageryLayer===e)f===-1&&(f=a),++d;else if(f!==-1)break}if(f===-1)return;let p=f+d;e._createTileImagerySkeletons(s,n,p)&&(s._loadedCallbacks[e._layerIndex]=Vft(d,e,n),s.state=ga.LOADING)})};if(e.ready){let s=e.imageryProvider;s._reload=r}this._quadtree.forEachLoadedTile(function(s){e._createTileImagerySkeletons(s,n)&&(s.state=ga.LOADING,s.level!==0&&(s._lastSelectionResultFrame!==i.quadtree._lastSelectionFrameNumber||s._lastSelectionResult!==Xn.RENDERED)&&(s.renderable=!1))}),this._layerOrderChanged=!0,o.raiseEvent()}};nr.prototype._onLayerRemoved=function(e,t){this._quadtree.forEachLoadedTile(function(n){let i=n.data.imagery,o=-1,r=0;for(let s=0,a=i.length;s<a;++s){let c=i[s],l=c.loadingImagery;if(u(l)||(l=c.readyImagery),l.imageryLayer===e)o===-1&&(o=s),c.freeResources(),++r;else if(o!==-1)break}o!==-1&&i.splice(o,r)}),u(e.imageryProvider)&&(e.imageryProvider._reload=void 0),this._imageryLayersUpdatedEvent.raiseEvent()};nr.prototype._onLayerMoved=function(e,t,n){this._layerOrderChanged=!0,this._imageryLayersUpdatedEvent.raiseEvent()};nr.prototype._onLayerShownOrHidden=function(e,t,n){n?this._onLayerAdded(e,t):this._onLayerRemoved(e,t)};var Uft=new F,zft=new F;function Bxe(e,t){let n={u_initialColor:function(){return this.properties.initialColor},u_fillHighlightColor:function(){return this.properties.fillHighlightColor},u_zoomedOutOceanSpecularIntensity:function(){return this.properties.zoomedOutOceanSpecularIntensity},u_oceanNormalMap:function(){return this.properties.oceanNormalMap},u_atmosphereLightIntensity:function(){return this.properties.atmosphereLightIntensity},u_atmosphereRayleighCoefficient:function(){return this.properties.atmosphereRayleighCoefficient},u_atmosphereMieCoefficient:function(){return this.properties.atmosphereMieCoefficient},u_atmosphereRayleighScaleHeight:function(){return this.properties.atmosphereRayleighScaleHeight},u_atmosphereMieScaleHeight:function(){return this.properties.atmosphereMieScaleHeight},u_atmosphereMieAnisotropy:function(){return this.properties.atmosphereMieAnisotropy},u_lightingFadeDistance:function(){return this.properties.lightingFadeDistance},u_nightFadeDistance:function(){return this.properties.nightFadeDistance},u_center3D:function(){return this.properties.center3D},u_verticalExaggerationAndRelativeHeight:function(){return this.properties.verticalExaggerationAndRelativeHeight},u_tileRectangle:function(){return this.properties.tileRectangle},u_modifiedModelView:function(){let i=e.context.uniformState.view,o=F.multiplyByPoint(i,this.properties.rtc,Nxe);return F.setTranslation(i,o,Lxe),Lxe},u_modifiedModelViewProjection:function(){let i=e.context.uniformState.view,o=e.context.uniformState.projection,r=F.multiplyByPoint(i,this.properties.rtc,Nxe);return F.setTranslation(i,r,HU),F.multiply(o,HU,HU),HU},u_dayTextures:function(){return this.properties.dayTextures},u_dayTextureTranslationAndScale:function(){return this.properties.dayTextureTranslationAndScale},u_dayTextureTexCoordsRectangle:function(){return this.properties.dayTextureTexCoordsRectangle},u_dayTextureUseWebMercatorT:function(){return this.properties.dayTextureUseWebMercatorT},u_dayTextureAlpha:function(){return this.properties.dayTextureAlpha},u_dayTextureNightAlpha:function(){return this.properties.dayTextureNightAlpha},u_dayTextureDayAlpha:function(){return this.properties.dayTextureDayAlpha},u_dayTextureBrightness:function(){return this.properties.dayTextureBrightness},u_dayTextureContrast:function(){return this.properties.dayTextureContrast},u_dayTextureHue:function(){return this.properties.dayTextureHue},u_dayTextureSaturation:function(){return this.properties.dayTextureSaturation},u_dayTextureOneOverGamma:function(){return this.properties.dayTextureOneOverGamma},u_dayIntensity:function(){return this.properties.dayIntensity},u_southAndNorthLatitude:function(){return this.properties.southAndNorthLatitude},u_southMercatorYAndOneOverHeight:function(){return this.properties.southMercatorYAndOneOverHeight},u_waterMask:function(){return this.properties.waterMask},u_waterMaskTranslationAndScale:function(){return this.properties.waterMaskTranslationAndScale},u_minMaxHeight:function(){return this.properties.minMaxHeight},u_scaleAndBias:function(){return this.properties.scaleAndBias},u_dayTextureSplit:function(){return this.properties.dayTextureSplit},u_dayTextureCutoutRectangles:function(){return this.properties.dayTextureCutoutRectangles},u_clippingPlanes:function(){let i=t._clippingPlanes;return u(i)&&u(i.texture)?i.texture:e.context.defaultTexture},u_cartographicLimitRectangle:function(){return this.properties.localizedCartographicLimitRectangle},u_clippingPlanesMatrix:function(){let i=t._clippingPlanes,o=u(i)?F.multiply(e.context.uniformState.view,i.modelMatrix,Uft):F.IDENTITY;return F.inverseTranspose(o,zft)},u_clippingPlanesEdgeStyle:function(){let i=this.properties.clippingPlanesEdgeColor;return i.alpha=this.properties.clippingPlanesEdgeWidth,i},u_clippingDistance:function(){let i=t._clippingPolygons.clippingTexture;return u(i)?i:e.context.defaultTexture},u_clippingExtents:function(){let i=t._clippingPolygons.extentsTexture;return u(i)?i:e.context.defaultTexture},u_minimumBrightness:function(){return e.fog.minimumBrightness},u_hsbShift:function(){return this.properties.hsbShift},u_colorsToAlpha:function(){return this.properties.colorsToAlpha},u_frontFaceAlphaByDistance:function(){return this.properties.frontFaceAlphaByDistance},u_backFaceAlphaByDistance:function(){return this.properties.backFaceAlphaByDistance},u_translucencyRectangle:function(){return this.properties.localizedTranslucencyRectangle},u_undergroundColor:function(){return this.properties.undergroundColor},u_undergroundColorAlphaByDistance:function(){return this.properties.undergroundColorAlphaByDistance},u_lambertDiffuseMultiplier:function(){return this.properties.lambertDiffuseMultiplier},u_vertexShadowDarkness:function(){return this.properties.vertexShadowDarkness},properties:{initialColor:new oe(0,0,.5,1),fillHighlightColor:new G(0,0,0,0),zoomedOutOceanSpecularIntensity:.5,oceanNormalMap:void 0,lightingFadeDistance:new H(65e5,9e6),nightFadeDistance:new H(1e7,4e7),atmosphereLightIntensity:10,atmosphereRayleighCoefficient:new h(55e-7,13e-6,284e-7),atmosphereMieCoefficient:new h(21e-6,21e-6,21e-6),atmosphereRayleighScaleHeight:1e4,atmosphereMieScaleHeight:3200,atmosphereMieAnisotropy:.9,hsbShift:new h,center3D:void 0,rtc:new h,modifiedModelView:new F,tileRectangle:new oe,verticalExaggerationAndRelativeHeight:new H(1,0),dayTextures:[],dayTextureTranslationAndScale:[],dayTextureTexCoordsRectangle:[],dayTextureUseWebMercatorT:[],dayTextureAlpha:[],dayTextureNightAlpha:[],dayTextureDayAlpha:[],dayTextureBrightness:[],dayTextureContrast:[],dayTextureHue:[],dayTextureSaturation:[],dayTextureOneOverGamma:[],dayTextureSplit:[],dayTextureCutoutRectangles:[],dayIntensity:0,colorsToAlpha:[],southAndNorthLatitude:new H,southMercatorYAndOneOverHeight:new H,waterMask:void 0,waterMaskTranslationAndScale:new oe,minMaxHeight:new H,scaleAndBias:new F,clippingPlanesEdgeColor:G.clone(G.WHITE),clippingPlanesEdgeWidth:0,localizedCartographicLimitRectangle:new oe,frontFaceAlphaByDistance:new oe,backFaceAlphaByDistance:new oe,localizedTranslucencyRectangle:new oe,undergroundColor:G.clone(G.TRANSPARENT),undergroundColorAlphaByDistance:new oe,lambertDiffuseMultiplier:0,vertexShadowDarkness:0}};return u(t.materialUniformMap)?bt(n,t.materialUniformMap):n}function Hft(e,t,n){let i=n.data,o,r;if(u(i.vertexArray)?(o=i.mesh,r=i.vertexArray):u(i.fill)&&u(i.fill.vertexArray)&&(o=i.fill.mesh,r=i.fill.vertexArray),!(!u(o)||!u(r))){if(u(i.wireframeVertexArray)){if(i.wireframeVertexArray.mesh===o)return;i.wireframeVertexArray.destroy(),i.wireframeVertexArray=void 0}i.wireframeVertexArray=Gft(e,r,o),i.wireframeVertexArray.mesh=o}}function Gft(e,t,n){let o={indices:n.indices,primitiveType:Ne.TRIANGLES};Nn.toWireframe(o);let r=o.indices,s=xt.createIndexBuffer({context:e,typedArray:r,usage:ke.STATIC_DRAW,indexDatatype:Be.fromSizeInBytes(r.BYTES_PER_ELEMENT)});return new ii({context:e,attributes:t._attributes,indexBuffer:s})}var zxe,Hxe,WU;(function(){let e=new vt({geometry:Ih.fromDimensions({dimensions:new h(2,2,2)})}),t=new vt({geometry:new jg({radius:1})}),n=new F,i,o;function r(s){return new In({geometryInstances:s,appearance:new ln({translucent:!1,flat:!0}),asynchronous:!1})}zxe=function(s,a){return s===i||(WU(),i=s,n=F.fromRotationTranslation(s.halfAxes,s.center,n),e.modelMatrix=n,e.attributes.color=jt.fromColor(a),o=r(e)),o},Hxe=function(s,a){return s===i||(WU(),i=s,n=F.fromTranslation(s.center,n),n=F.multiplyByUniformScale(n,s.radius,n),t.modelMatrix=n,t.attributes.color=jt.fromColor(a),o=r(t)),o},WU=function(){u(o)&&(o.destroy(),o=void 0,i=void 0)}})();var Wft=new oe(0,0,0,0),jft={frameState:void 0,surfaceTile:void 0,numberOfDayTextures:void 0,applyBrightness:void 0,applyContrast:void 0,applyHue:void 0,applySaturation:void 0,applyGamma:void 0,applyAlpha:void 0,applyDayNightAlpha:void 0,applySplit:void 0,showReflectiveOcean:void 0,showOceanWaves:void 0,enableLighting:void 0,dynamicAtmosphereLighting:void 0,dynamicAtmosphereLightingFromSun:void 0,showGroundAtmosphere:void 0,perFragmentGroundAtmosphere:void 0,hasVertexNormals:void 0,useWebMercatorProjection:void 0,enableFog:void 0,enableClippingPlanes:void 0,clippingPlanes:void 0,enableClippingPolygons:void 0,clippingPolygons:void 0,clippedByBoundaries:void 0,hasImageryLayerCutout:void 0,colorCorrect:void 0,colorToAlpha:void 0,hasGeodeticSurfaceNormals:void 0,hasExaggeration:void 0},qft=G.TRANSPARENT,Yft=new kt;function Xft(e,t,n){let i=t.data;u(i.vertexArray)||(i.fill===void 0&&(i.fill=new UD(t)),i.fill.update(e,n));let o=n.creditDisplay,r=i.terrainData;if(u(r)&&u(r.credits)){let Ae=r.credits;for(let nt=0,yi=Ae.length;nt<yi;++nt)o.addCreditToNextFrame(Ae[nt])}let s=Vt.maximumTextureImageUnits,a=i.waterMaskTexture,c=i.waterMaskTranslationAndScale;!u(a)&&u(i.fill)&&(a=i.fill.waterMaskTexture,c=i.fill.waterMaskTranslationAndScale);let l=n.cameraUnderground,f=n.globeTranslucencyState,d=f.translucent,p=f.frontFaceAlphaByDistance,g=f.backFaceAlphaByDistance,m=f.rectangle,y=x(e.undergroundColor,qft),b=x(e.undergroundColorAlphaByDistance,Yft),C=Uxe(e,n)&&n.mode===ne.SCENE3D&&y.alpha>0&&(b.nearValue>0||b.farValue>0),A=e.lambertDiffuseMultiplier,T=e.vertexShadowDarkness,E=e.hasWaterMask&&u(a),v=E&&e.showWaterEffect,D=e.oceanNormalMap,O=v&&u(D),P=e.terrainProvider,M=u(P)&&e.terrainProvider.hasVertexNormals,L=n.fog.enabled&&n.fog.renderable&&!l,_=e.showGroundAtmosphere&&n.mode===ne.SCENE3D,S=xn.castShadows(e.shadows)&&!d,w=xn.receiveShadows(e.shadows)&&!d,I=e.hueShift,N=e.saturationShift,k=e.brightnessShift,z=!(R.equalsEpsilon(I,0,R.EPSILON7)&&R.equalsEpsilon(N,0,R.EPSILON7)&&R.equalsEpsilon(k,0,R.EPSILON7)),V=!1;if(_){let Ae=h.magnitude(n.camera.positionWC),nt=e.nightFadeOutDistance;V=Ae>nt}E&&--s,O&&--s,u(n.shadowState)&&n.shadowState.shadowsEnabled&&--s,u(e.clippingPlanes)&&e.clippingPlanes.enabled&&--s,u(e.clippingPolygons)&&e.clippingPolygons.enabled&&(--s,--s),s-=f.numberOfTextureUniforms;let U=i.renderedMesh,B=U.center,W=U.encoding,j=i.tileBoundingRegion,Q=n.verticalExaggeration,q=n.verticalExaggerationRelativeHeight,X=Q!==1,Z=W.hasGeodeticSurfaceNormals,fe=Rft,xe=0,re=0,pe=0,ye=0,Se=!1;if(n.mode!==ne.SCENE3D){let Ae=n.mapProjection,nt=Ae.project(se.southwest(t.rectangle),Nft),yi=Ae.project(se.northeast(t.rectangle),Fft);if(fe.x=nt.x,fe.y=nt.y,fe.z=yi.x,fe.w=yi.y,n.mode!==ne.MORPHING&&(B=Lft,B.x=0,B.y=(fe.z+fe.x)*.5,B.z=(fe.w+fe.y)*.5,fe.x-=B.y,fe.y-=B.z,fe.z-=B.y,fe.w-=B.z),n.mode===ne.SCENE2D&&W.quantization===pa.BITS12){let ct=1/(Math.pow(2,12)-1)*.5,Si=(fe.z-fe.x)*ct,oo=(fe.w-fe.y)*ct;fe.x-=Si,fe.y-=oo,fe.z+=Si,fe.w+=oo}Ae instanceof Li&&(xe=t.rectangle.south,re=t.rectangle.north,pe=Li.geodeticLatitudeToMercatorAngle(xe),ye=1/(Li.geodeticLatitudeToMercatorAngle(re)-pe),Se=!0)}let Te=jft;Te.frameState=n,Te.surfaceTile=i,Te.hasWaterMask=E,Te.showReflectiveOcean=v,Te.showOceanWaves=O,Te.enableLighting=e.enableLighting,Te.dynamicAtmosphereLighting=e.dynamicAtmosphereLighting,Te.dynamicAtmosphereLightingFromSun=e.dynamicAtmosphereLightingFromSun,Te.showGroundAtmosphere=_,Te.atmosphereLightIntensity=e.atmosphereLightIntensity,Te.atmosphereRayleighCoefficient=e.atmosphereRayleighCoefficient,Te.atmosphereMieCoefficient=e.atmosphereMieCoefficient,Te.atmosphereRayleighScaleHeight=e.atmosphereRayleighScaleHeight,Te.atmosphereMieScaleHeight=e.atmosphereMieScaleHeight,Te.atmosphereMieAnisotropy=e.atmosphereMieAnisotropy,Te.perFragmentGroundAtmosphere=V,Te.hasVertexNormals=M,Te.useWebMercatorProjection=Se,Te.clippedByBoundaries=i.clippedByBoundaries,Te.hasGeodeticSurfaceNormals=Z,Te.hasExaggeration=X;let Fe=i.imagery,Ve=0,Ze=Fe.length,gt=e.showSkirts&&!l&&!d,lt=e.backFaceCulling&&!l&&!d,Oe=lt?e._renderState:e._disableCullingRenderState,Mt=lt?e._blendRenderState:e._disableCullingBlendRenderState,ut=Oe,at=e._firstPassInitialColor,Kt=n.context;if(u(e._debug.boundingSphereTile)||WU(),e._materialUniformMap!==e.materialUniformMap){e._materialUniformMap=e.materialUniformMap;let Ae=e._drawCommands.length;for(let nt=0;nt<Ae;++nt)e._uniformMaps[nt]=Bxe(n,e)}do{let Ae=0,nt,yi;if(e._drawCommands.length<=e._usedDrawCommands?(nt=new Qe,nt.owner=t,nt.cull=!1,nt.boundingVolume=new ae,nt.orientedBoundingBox=void 0,yi=Bxe(n,e),e._drawCommands.push(nt),e._uniformMaps.push(yi)):(nt=e._drawCommands[e._usedDrawCommands],yi=e._uniformMaps[e._usedDrawCommands]),nt.owner=t,++e._usedDrawCommands,t===e._debug.boundingSphereTile){let Ca=j.boundingVolume,rl=j.boundingSphere;u(Ca)?zxe(Ca,G.RED).update(n):u(rl)&&Hxe(rl,G.RED).update(n)}let ct=yi.properties;oe.clone(at,ct.initialColor),ct.oceanNormalMap=D,ct.lightingFadeDistance.x=e.lightingFadeOutDistance,ct.lightingFadeDistance.y=e.lightingFadeInDistance,ct.nightFadeDistance.x=e.nightFadeOutDistance,ct.nightFadeDistance.y=e.nightFadeInDistance,ct.atmosphereLightIntensity=e.atmosphereLightIntensity,ct.atmosphereRayleighCoefficient=e.atmosphereRayleighCoefficient,ct.atmosphereMieCoefficient=e.atmosphereMieCoefficient,ct.atmosphereRayleighScaleHeight=e.atmosphereRayleighScaleHeight,ct.atmosphereMieScaleHeight=e.atmosphereMieScaleHeight,ct.atmosphereMieAnisotropy=e.atmosphereMieAnisotropy,ct.zoomedOutOceanSpecularIntensity=e.zoomedOutOceanSpecularIntensity;let Si=l?g:p,oo=l?p:g;u(Si)&&(oe.fromElements(Si.near,Si.nearValue,Si.far,Si.farValue,ct.frontFaceAlphaByDistance),oe.fromElements(oo.near,oo.nearValue,oo.far,oo.farValue,ct.backFaceAlphaByDistance)),oe.fromElements(b.near,b.nearValue,b.far,b.farValue,ct.undergroundColorAlphaByDistance),G.clone(y,ct.undergroundColor),ct.lambertDiffuseMultiplier=A,ct.vertexShadowDarkness=T;let Zs=!u(i.vertexArray)&&u(e.fillHighlightColor)&&e.fillHighlightColor.alpha>0;Zs&&G.clone(e.fillHighlightColor,ct.fillHighlightColor),ct.verticalExaggerationAndRelativeHeight.x=Q,ct.verticalExaggerationAndRelativeHeight.y=q,ct.center3D=U.center,h.clone(B,ct.rtc),oe.clone(fe,ct.tileRectangle),ct.southAndNorthLatitude.x=xe,ct.southAndNorthLatitude.y=re,ct.southMercatorYAndOneOverHeight.x=pe,ct.southMercatorYAndOneOverHeight.y=ye;let jo=Oft,wr=GU(t.rectangle,e.cartographicLimitRectangle),Me=Mft,ot=GU(t.rectangle,m);h.fromElements(I,N,k,ct.hsbShift);let We=t.rectangle,Ye=1/We.width,ht=1/We.height;jo.x=(wr.west-We.west)*Ye,jo.y=(wr.south-We.south)*ht,jo.z=(wr.east-We.west)*Ye,jo.w=(wr.north-We.south)*ht,oe.clone(jo,ct.localizedCartographicLimitRectangle),Me.x=(ot.west-We.west)*Ye,Me.y=(ot.south-We.south)*ht,Me.z=(ot.east-We.west)*Ye,Me.w=(ot.north-We.south)*ht,oe.clone(Me,ct.localizedTranslucencyRectangle);let zt=L&&R.fog(t._distance,n.fog.density)>R.EPSILON3;z=z&&(zt||_);let mn=!1,bo=!1,fo=!1,$s=!1,Rs=!1,li=!1,ti=!1,ts=!1,dr=!1,ba=!1;for(;Ae<s&&Ve<Ze;){let Ca=Fe[Ve],rl=Ca.readyImagery;if(++Ve,!u(rl)||rl.imageryLayer.alpha===0)continue;let yc=Ca.useWebMercatorT?rl.textureWebMercator:rl.texture,ns=rl.imageryLayer;u(Ca.textureTranslationAndScale)||(Ca.textureTranslationAndScale=ns._calculateTextureTranslationAndScale(t,Ca)),ct.dayTextures[Ae]=yc,ct.dayTextureTranslationAndScale[Ae]=Ca.textureTranslationAndScale,ct.dayTextureTexCoordsRectangle[Ae]=Ca.textureCoordinateRectangle,ct.dayTextureUseWebMercatorT[Ae]=Ca.useWebMercatorT,ct.dayTextureAlpha[Ae]=ns.alpha,li=li||ct.dayTextureAlpha[Ae]!==1,ct.dayTextureNightAlpha[Ae]=ns.nightAlpha,ti=ti||ct.dayTextureNightAlpha[Ae]!==1,ct.dayTextureDayAlpha[Ae]=ns.dayAlpha,ti=ti||ct.dayTextureDayAlpha[Ae]!==1,ct.dayTextureBrightness[Ae]=ns.brightness,mn=mn||ct.dayTextureBrightness[Ae]!==dc.DEFAULT_BRIGHTNESS,ct.dayTextureContrast[Ae]=ns.contrast,bo=bo||ct.dayTextureContrast[Ae]!==dc.DEFAULT_CONTRAST,ct.dayTextureHue[Ae]=ns.hue,fo=fo||ct.dayTextureHue[Ae]!==dc.DEFAULT_HUE,ct.dayTextureSaturation[Ae]=ns.saturation,$s=$s||ct.dayTextureSaturation[Ae]!==dc.DEFAULT_SATURATION,ct.dayTextureOneOverGamma[Ae]=1/ns.gamma,Rs=Rs||ct.dayTextureOneOverGamma[Ae]!==1/dc.DEFAULT_GAMMA,ct.dayTextureSplit[Ae]=ns.splitDirection,ts=ts||ct.dayTextureSplit[Ae]!==0;let Hu=ct.dayTextureCutoutRectangles[Ae];if(u(Hu)||(Hu=ct.dayTextureCutoutRectangles[Ae]=new oe),oe.clone(oe.ZERO,Hu),u(ns.cutoutRectangle)){let Mo=GU(We,ns.cutoutRectangle),en=se.simpleIntersection(Mo,We,Vxe);dr=u(en)||dr,Hu.x=(Mo.west-We.west)*Ye,Hu.y=(Mo.south-We.south)*ht,Hu.z=(Mo.east-We.west)*Ye,Hu.w=(Mo.north-We.south)*ht}let Gu=ct.colorsToAlpha[Ae];u(Gu)||(Gu=ct.colorsToAlpha[Ae]=new oe);let Wu=u(ns.colorToAlpha)&&ns.colorToAlphaThreshold>0;if(ba=ba||Wu,Wu){let Mo=ns.colorToAlpha;Gu.x=Mo.red,Gu.y=Mo.green,Gu.z=Mo.blue,Gu.w=ns.colorToAlphaThreshold}else Gu.w=-1;if(u(rl.credits)){let Mo=rl.credits;for(let en=0,Ee=Mo.length;en<Ee;++en)o.addCreditToNextFrame(Mo[en])}++Ae}ct.dayTextures.length=Ae,ct.waterMask=a,oe.clone(c,ct.waterMaskTranslationAndScale),ct.minMaxHeight.x=W.minimumHeight,ct.minMaxHeight.y=W.maximumHeight,F.clone(W.matrix,ct.scaleAndBias);let qn=e._clippingPlanes,ro=u(qn)&&qn.enabled&&t.isClipped;ro&&(ct.clippingPlanesEdgeColor=G.clone(qn.edgeColor,ct.clippingPlanesEdgeColor),ct.clippingPlanesEdgeWidth=qn.edgeWidth);let Uu=e._clippingPolygons,hr=u(Uu)&&Uu.enabled&&t.isClipped;Te.numberOfDayTextures=Ae,Te.applyBrightness=mn,Te.applyContrast=bo,Te.applyHue=fo,Te.applySaturation=$s,Te.applyGamma=Rs,Te.applyAlpha=li,Te.applyDayNightAlpha=ti,Te.applySplit=ts,Te.enableFog=zt,Te.enableClippingPlanes=ro,Te.clippingPlanes=qn,Te.enableClippingPolygons=hr,Te.clippingPolygons=Uu,Te.hasImageryLayerCutout=dr,Te.colorCorrect=z,Te.highlightFillTile=Zs,Te.colorToAlpha=ba,Te.showUndergroundColor=C,Te.translucent=d;let zu=i.renderedMesh.indices.length;gt||(zu=i.renderedMesh.indexCountWithoutSkirts),nt.shaderProgram=e._surfaceShaderSet.getShaderProgram(Te),nt.castShadows=S,nt.receiveShadows=w,nt.renderState=ut,nt.primitiveType=Ne.TRIANGLES,nt.vertexArray=i.vertexArray||i.fill.vertexArray,nt.count=zu,nt.uniformMap=yi,nt.pass=we.GLOBE,e._debug.wireframe&&(Hft(Kt,e,t),u(i.wireframeVertexArray)&&(nt.vertexArray=i.wireframeVertexArray,nt.primitiveType=Ne.LINES,nt.count=zu*2));let ka=nt.boundingVolume,yy=nt.orientedBoundingBox;n.mode!==ne.SCENE3D?(ae.fromRectangleWithHeights2D(t.rectangle,n.mapProjection,j.minimumHeight,j.maximumHeight,ka),h.fromElements(ka.center.z,ka.center.x,ka.center.y,ka.center),n.mode===ne.MORPHING&&(ka=ae.union(j.boundingSphere,ka,ka))):(nt.boundingVolume=ae.clone(j.boundingSphere,ka),nt.orientedBoundingBox=wn.clone(j.boundingVolume,yy)),nt.dirty=!0,d&&f.updateDerivedCommands(nt,n),kxe(nt,n),ut=Mt,at=Wft}while(Ve<Ze)}var jU=nr;function Gxe(){this._enabled=!1,this._frontFaceAlpha=1,this._frontFaceAlphaByDistance=void 0,this._backFaceAlpha=1,this._backFaceAlphaByDistance=void 0,this._rectangle=se.clone(se.MAX_VALUE)}Object.defineProperties(Gxe.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this._enabled=e}},frontFaceAlpha:{get:function(){return this._frontFaceAlpha},set:function(e){this._frontFaceAlpha=e}},frontFaceAlphaByDistance:{get:function(){return this._frontFaceAlphaByDistance},set:function(e){this._frontFaceAlphaByDistance=kt.clone(e,this._frontFaceAlphaByDistance)}},backFaceAlpha:{get:function(){return this._backFaceAlpha},set:function(e){this._backFaceAlpha=e}},backFaceAlphaByDistance:{get:function(){return this._backFaceAlphaByDistance},set:function(e){this._backFaceAlphaByDistance=kt.clone(e,this._backFaceAlphaByDistance)}},rectangle:{get:function(){return this._rectangle},set:function(e){u(e)||(e=se.clone(se.MAX_VALUE)),se.clone(e,this._rectangle)}}});var qU=Gxe;function Ps(){this._layers=[],this.layerAdded=new me,this.layerRemoved=new me,this.layerMoved=new me,this.layerShownOrHidden=new me}Object.defineProperties(Ps.prototype,{length:{get:function(){return this._layers.length}}});Ps.prototype.add=function(e,t){u(t)?this._layers.splice(t,0,e):(t=this._layers.length,this._layers.push(e)),this._update(),this.layerAdded.raiseEvent(e,t);let i=e.readyEvent.addEventListener(()=>{this.layerShownOrHidden.raiseEvent(e,e._layerIndex,e.show),i()})};Ps.prototype.addImageryProvider=function(e,t){let n=new dc(e);return this.add(n,t),n};Ps.prototype.remove=function(e,t){t=x(t,!0);let n=this._layers.indexOf(e);return n!==-1?(this._layers.splice(n,1),this._update(),this.layerRemoved.raiseEvent(e,n),t&&e.destroy(),!0):!1};Ps.prototype.removeAll=function(e){e=x(e,!0);let t=this._layers;for(let n=0,i=t.length;n<i;n++){let o=t[n];this.layerRemoved.raiseEvent(o,n),e&&o.destroy()}this._layers=[]};Ps.prototype.contains=function(e){return this.indexOf(e)!==-1};Ps.prototype.indexOf=function(e){return this._layers.indexOf(e)};Ps.prototype.get=function(e){return this._layers[e]};function YU(e,t){return e.indexOf(t)}function Wxe(e,t,n){let i=e._layers;if(t=R.clamp(t,0,i.length-1),n=R.clamp(n,0,i.length-1),t===n)return;let o=i[t];i[t]=i[n],i[n]=o,e._update(),e.layerMoved.raiseEvent(o,n,t)}Ps.prototype.raise=function(e){let t=YU(this._layers,e);Wxe(this,t,t+1)};Ps.prototype.lower=function(e){let t=YU(this._layers,e);Wxe(this,t,t-1)};Ps.prototype.raiseToTop=function(e){let t=YU(this._layers,e);t!==this._layers.length-1&&(this._layers.splice(t,1),this._layers.push(e),this._update(),this.layerMoved.raiseEvent(e,this._layers.length-1,t))};Ps.prototype.lowerToBottom=function(e){let t=YU(this._layers,e);t!==0&&(this._layers.splice(t,1),this._layers.splice(0,0,e),this._update(),this.layerMoved.raiseEvent(e,0,t))};var Kft=new se;function jxe(e,t,n,i){let o=e.globe._surface._tilesToRender,r;for(let a=0;!u(r)&&a<o.length;++a){let c=o[a];se.contains(c.rectangle,t)&&(r=c)}if(!u(r))return;let s=r.data.imagery;for(let a=s.length-1;a>=0;--a){let c=s[a],l=c.readyImagery;if(!u(l)||!l.imageryLayer.ready)continue;let f=l.imageryLayer.imageryProvider;if(n&&!u(f.pickFeatures)||!se.contains(l.rectangle,t))continue;let d=Kft,p=1/1024;d.west=R.lerp(r.rectangle.west,r.rectangle.east,c.textureCoordinateRectangle.x-p),d.east=R.lerp(r.rectangle.west,r.rectangle.east,c.textureCoordinateRectangle.z+p),d.south=R.lerp(r.rectangle.south,r.rectangle.north,c.textureCoordinateRectangle.y-p),d.north=R.lerp(r.rectangle.south,r.rectangle.north,c.textureCoordinateRectangle.w+p),se.contains(d,t)&&i(l)}}Ps.prototype.pickImageryLayers=function(e,t){let n=t.globe.pick(e,t);if(!u(n))return;let i=t.ellipsoid.cartesianToCartographic(n),o=[];if(jxe(t,i,!1,function(r){o.push(r.imageryLayer)}),o.length!==0)return o};Ps.prototype.pickImageryLayerFeatures=function(e,t){let n=t.globe.pick(e,t);if(!u(n))return;let i=t.ellipsoid.cartesianToCartographic(n),o=[],r=[];if(jxe(t,i,!0,function(s){if(!s.imageryLayer.ready)return;let c=s.imageryLayer.imageryProvider.pickFeatures(s.x,s.y,s.level,i.longitude,i.latitude);u(c)&&(o.push(c),r.push(s.imageryLayer))}),o.length!==0)return Promise.all(o).then(function(s){let a=[];for(let c=0;c<s.length;++c){let l=s[c],f=r[c];if(u(l)&&l.length>0)for(let d=0;d<l.length;++d){let p=l[d];p.imageryLayer=f,u(p.position)||(p.position=i),a.push(p)}}return a})};Ps.prototype.queueReprojectionCommands=function(e){let t=this._layers;for(let n=0,i=t.length;n<i;++n)t[n].queueReprojectionCommands(e)};Ps.prototype.cancelReprojections=function(){let e=this._layers;for(let t=0,n=e.length;t<n;++t)e[t].cancelReprojections()};Ps.prototype.isDestroyed=function(){return!1};Ps.prototype.destroy=function(){return this.removeAll(!0),ue(this)};Ps.prototype._update=function(){let e=!0,t=this._layers,n,i,o,r;for(o=0,r=t.length;o<r;++o)i=t[o],i._layerIndex=o,i.show?(i._isBaseLayer=e,e=!1):i._isBaseLayer=!1,i.show!==i._show&&(u(i._show)&&(u(n)||(n=[]),n.push(i)),i._show=i.show);if(u(n))for(o=0,r=n.length;o<r;++o)i=n[o],this.layerShownOrHidden.raiseEvent(i,i._layerIndex,i.show)};var XU=Ps;function qxe(e){this._ellipsoid=new i0(e.ellipsoid,h.ZERO)}Object.defineProperties(qxe.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});var KU=qxe;function Jc(e){this._tilingScheme=e.tilingScheme,this._x=e.x,this._y=e.y,this._level=e.level,this._parent=e.parent,this._rectangle=this._tilingScheme.tileXYToRectangle(this._x,this._y,this._level),this._southwestChild=void 0,this._southeastChild=void 0,this._northwestChild=void 0,this._northeastChild=void 0,this.replacementPrevious=void 0,this.replacementNext=void 0,this._distance=0,this._loadPriority=0,this._customData=[],this._frameUpdated=void 0,this._lastSelectionResult=Xn.NONE,this._lastSelectionResultFrame=void 0,this._loadedCallbacks={},this.state=ga.START,this.renderable=!1,this.upsampledFromParent=!1,this.data=void 0}Jc.createLevelZeroTiles=function(e){let t=e.getNumberOfXTilesAtLevel(0),n=e.getNumberOfYTilesAtLevel(0),i=new Array(t*n),o=0;for(let r=0;r<n;++r)for(let s=0;s<t;++s)i[o++]=new Jc({tilingScheme:e,x:s,y:r,level:0});return i};Jc.prototype._updateCustomData=function(e,t,n){let i=this.customData,o,r,s;if(u(t)&&u(n)){for(i=i.filter(function(a){return n.indexOf(a)===-1}),this._customData=i,s=this._rectangle,o=0;o<t.length;++o)r=t[o],se.contains(s,r.positionCartographic)&&i.push(r);this._frameUpdated=e}else{let a=this._parent;if(u(a)&&this._frameUpdated!==a._frameUpdated){i.length=0,s=this._rectangle;let c=a.customData;for(o=0;o<c.length;++o)r=c[o],se.contains(s,r.positionCartographic)&&i.push(r);this._frameUpdated=a._frameUpdated}}};Object.defineProperties(Jc.prototype,{tilingScheme:{get:function(){return this._tilingScheme}},x:{get:function(){return this._x}},y:{get:function(){return this._y}},level:{get:function(){return this._level}},parent:{get:function(){return this._parent}},rectangle:{get:function(){return this._rectangle}},children:{get:function(){return[this.northwestChild,this.northeastChild,this.southwestChild,this.southeastChild]}},southwestChild:{get:function(){return u(this._southwestChild)||(this._southwestChild=new Jc({tilingScheme:this.tilingScheme,x:this.x*2,y:this.y*2+1,level:this.level+1,parent:this})),this._southwestChild}},southeastChild:{get:function(){return u(this._southeastChild)||(this._southeastChild=new Jc({tilingScheme:this.tilingScheme,x:this.x*2+1,y:this.y*2+1,level:this.level+1,parent:this})),this._southeastChild}},northwestChild:{get:function(){return u(this._northwestChild)||(this._northwestChild=new Jc({tilingScheme:this.tilingScheme,x:this.x*2,y:this.y*2,level:this.level+1,parent:this})),this._northwestChild}},northeastChild:{get:function(){return u(this._northeastChild)||(this._northeastChild=new Jc({tilingScheme:this.tilingScheme,x:this.x*2+1,y:this.y*2,level:this.level+1,parent:this})),this._northeastChild}},customData:{get:function(){return this._customData}},needsLoading:{get:function(){return this.state<ga.DONE}},eligibleForUnloading:{get:function(){let e=!0;return u(this.data)&&(e=this.data.eligibleForUnloading,u(e)||(e=!0)),e}}});Jc.prototype.findLevelZeroTile=function(e,t,n){let i=this.tilingScheme.getNumberOfXTilesAtLevel(0);if(t<0?t+=i:t>=i&&(t-=i),!(n<0||n>=this.tilingScheme.getNumberOfYTilesAtLevel(0)))return e.filter(function(o){return o.x===t&&o.y===n})[0]};Jc.prototype.findTileToWest=function(e){let t=this.parent;if(t===void 0)return this.findLevelZeroTile(e,this.x-1,this.y);if(t.southeastChild===this)return t.southwestChild;if(t.northeastChild===this)return t.northwestChild;let n=t.findTileToWest(e);if(n!==void 0)return t.southwestChild===this?n.southeastChild:n.northeastChild};Jc.prototype.findTileToEast=function(e){let t=this.parent;if(t===void 0)return this.findLevelZeroTile(e,this.x+1,this.y);if(t.southwestChild===this)return t.southeastChild;if(t.northwestChild===this)return t.northeastChild;let n=t.findTileToEast(e);if(n!==void 0)return t.southeastChild===this?n.southwestChild:n.northwestChild};Jc.prototype.findTileToSouth=function(e){let t=this.parent;if(t===void 0)return this.findLevelZeroTile(e,this.x,this.y+1);if(t.northwestChild===this)return t.southwestChild;if(t.northeastChild===this)return t.southeastChild;let n=t.findTileToSouth(e);if(n!==void 0)return t.southwestChild===this?n.northwestChild:n.northeastChild};Jc.prototype.findTileToNorth=function(e){let t=this.parent;if(t===void 0)return this.findLevelZeroTile(e,this.x,this.y-1);if(t.southwestChild===this)return t.northwestChild;if(t.southeastChild===this)return t.northeastChild;let n=t.findTileToNorth(e);if(n!==void 0)return t.northwestChild===this?n.southwestChild:n.southeastChild};Jc.prototype.freeResources=function(){this.state=ga.START,this.renderable=!1,this.upsampledFromParent=!1,u(this.data)&&u(this.data.freeResources)&&this.data.freeResources(),ZU(this._southwestChild),this._southwestChild=void 0,ZU(this._southeastChild),this._southeastChild=void 0,ZU(this._northwestChild),this._northwestChild=void 0,ZU(this._northeastChild),this._northeastChild=void 0};function ZU(e){u(e)&&e.freeResources()}var $U=Jc;function QU(){this.head=void 0,this.tail=void 0,this.count=0,this._lastBeforeStartOfFrame=void 0}QU.prototype.markStartOfRenderFrame=function(){this._lastBeforeStartOfFrame=this.head};QU.prototype.trimTiles=function(e){let t=this.tail,n=!0;for(;n&&u(this._lastBeforeStartOfFrame)&&this.count>e&&u(t);){n=t!==this._lastBeforeStartOfFrame;let i=t.replacementPrevious;t.eligibleForUnloading&&(t.freeResources(),Yxe(this,t)),t=i}};function Yxe(e,t){let n=t.replacementPrevious,i=t.replacementNext;t===e._lastBeforeStartOfFrame&&(e._lastBeforeStartOfFrame=i),t===e.head?e.head=i:n.replacementNext=i,t===e.tail?e.tail=n:i.replacementPrevious=n,t.replacementPrevious=void 0,t.replacementNext=void 0,--e.count}QU.prototype.markTileRendered=function(e){let t=this.head;if(t===e){e===this._lastBeforeStartOfFrame&&(this._lastBeforeStartOfFrame=e.replacementNext);return}if(++this.count,!u(t)){e.replacementPrevious=void 0,e.replacementNext=void 0,this.head=e,this.tail=e;return}(u(e.replacementPrevious)||u(e.replacementNext))&&Yxe(this,e),e.replacementPrevious=void 0,e.replacementNext=t,t.replacementPrevious=e,this.head=e};var JU=QU;function Yf(e){this._tileProvider=e.tileProvider,this._tileProvider.quadtree=this,this._debug={enableDebugOutput:!1,maxDepth:0,maxDepthVisited:0,tilesVisited:0,tilesCulled:0,tilesRendered:0,tilesWaitingForChildren:0,lastMaxDepth:-1,lastMaxDepthVisited:-1,lastTilesVisited:-1,lastTilesCulled:-1,lastTilesRendered:-1,lastTilesWaitingForChildren:-1,suspendLodUpdate:!1};let n=this._tileProvider.tilingScheme.ellipsoid;this._tilesToRender=[],this._tileLoadQueueHigh=[],this._tileLoadQueueMedium=[],this._tileLoadQueueLow=[],this._tileReplacementQueue=new JU,this._levelZeroTiles=void 0,this._loadQueueTimeSlice=5,this._tilesInvalidated=!1,this._addHeightCallbacks=[],this._removeHeightCallbacks=[],this._tileToUpdateHeights=[],this._lastTileIndex=0,this._updateHeightsTimeSlice=2,this._cameraPositionCartographic=void 0,this._cameraReferenceFrameOriginCartographic=void 0,this.maximumScreenSpaceError=x(e.maximumScreenSpaceError,2),this.tileCacheSize=x(e.tileCacheSize,100),this.loadingDescendantLimit=20,this.preloadAncestors=!0,this.preloadSiblings=!1,this._occluders=new KU({ellipsoid:n}),this._tileLoadProgressEvent=new me,this._lastTileLoadQueueLength=0,this._lastSelectionFrameNumber=void 0}Object.defineProperties(Yf.prototype,{tileProvider:{get:function(){return this._tileProvider}},tileLoadProgressEvent:{get:function(){return this._tileLoadProgressEvent}},occluders:{get:function(){return this._occluders}}});Yf.prototype.invalidateAllTiles=function(){this._tilesInvalidated=!0};function Zft(e){let t=e._tileReplacementQueue;t.head=void 0,t.tail=void 0,t.count=0,Kxe(e);let n=e._levelZeroTiles;if(u(n))for(let i=0;i<n.length;++i){let r=n[i].customData,s=r.length;for(let a=0;a<s;++a){let c=r[a];c.level=0,e._addHeightCallbacks.push(c)}n[i].freeResources()}e._levelZeroTiles=void 0,e._tileProvider.cancelReprojections()}Yf.prototype.forEachLoadedTile=function(e){let t=this._tileReplacementQueue.head;for(;u(t);)t.state!==ga.START&&e(t),t=t.replacementNext};Yf.prototype.forEachRenderedTile=function(e){let t=this._tilesToRender;for(let n=0,i=t.length;n<i;++n)e(t[n])};Yf.prototype.updateHeight=function(e,t){let n=this,i={positionOnEllipsoidSurface:void 0,positionCartographic:e,level:-1,callback:t};return i.removeFunc=function(){let o=n._addHeightCallbacks,r=o.length;for(let s=0;s<r;++s)if(o[s]===i){o.splice(s,1);break}n._removeHeightCallbacks.push(i),i.callback&&(i.callback=void 0)},n._addHeightCallbacks.push(i),i.removeFunc};Yf.prototype.update=function(e){u(this._tileProvider.update)&&this._tileProvider.update(e)};function Kxe(e){let t=e._debug;t.maxDepth=0,t.maxDepthVisited=0,t.tilesVisited=0,t.tilesCulled=0,t.tilesRendered=0,t.tilesWaitingForChildren=0,e._tileLoadQueueHigh.length=0,e._tileLoadQueueMedium.length=0,e._tileLoadQueueLow.length=0}Yf.prototype.beginFrame=function(e){e.passes.render&&(this._tilesInvalidated&&(Zft(this),this._tilesInvalidated=!1),this._tileProvider.initialize(e),Kxe(this),!this._debug.suspendLodUpdate&&this._tileReplacementQueue.markStartOfRenderFrame())};Yf.prototype.render=function(e){let t=e.passes,n=this._tileProvider;t.render&&(n.beginUpdate(e),edt(this,e),udt(this,e),n.endUpdate(e)),t.pick&&this._tilesToRender.length>0&&n.updateForPick(e)};function $ft(e,t){let n=e._tileLoadQueueHigh.length+e._tileLoadQueueMedium.length+e._tileLoadQueueLow.length;if(n!==e._lastTileLoadQueueLength||e._tilesInvalidated){let o=me.prototype.raiseEvent.bind(e._tileLoadProgressEvent,n);t.afterRender.push(()=>(o(),!0)),e._lastTileLoadQueueLength=n}let i=e._debug;i.enableDebugOutput&&!i.suspendLodUpdate&&(i.maxDepth=e._tilesToRender.reduce(function(o,r){return Math.max(o,r.level)},-1),i.tilesRendered=e._tilesToRender.length,(i.tilesVisited!==i.lastTilesVisited||i.tilesRendered!==i.lastTilesRendered||i.tilesCulled!==i.lastTilesCulled||i.maxDepth!==i.lastMaxDepth||i.tilesWaitingForChildren!==i.lastTilesWaitingForChildren||i.maxDepthVisited!==i.lastMaxDepthVisited)&&(console.log(`Visited ${i.tilesVisited}, Rendered: ${i.tilesRendered}, Culled: ${i.tilesCulled}, Max Depth Rendered: ${i.maxDepth}, Max Depth Visited: ${i.maxDepthVisited}, Waiting for children: ${i.tilesWaitingForChildren}`),i.lastTilesVisited=i.tilesVisited,i.lastTilesRendered=i.tilesRendered,i.lastTilesCulled=i.tilesCulled,i.lastMaxDepth=i.maxDepth,i.lastTilesWaitingForChildren=i.tilesWaitingForChildren,i.lastMaxDepthVisited=i.maxDepthVisited))}Yf.prototype.endFrame=function(e){!e.passes.render||e.mode===ne.MORPHING||(sdt(this,e),ldt(this,e),$ft(this,e))};Yf.prototype.isDestroyed=function(){return!1};Yf.prototype.destroy=function(){this._tileProvider=this._tileProvider&&this._tileProvider.destroy()};var HD,Xxe=new de;function Qft(e,t){let n=se.center(e.rectangle,Xxe),i=n.longitude-HD.longitude,o=n.latitude-HD.latitude;n=se.center(t.rectangle,Xxe);let r=n.longitude-HD.longitude,s=n.latitude-HD.latitude;return i*i+o*o-(r*r+s*s)}var Jft=new h,zD=[];function edt(e,t){let n=e._debug;if(n.suspendLodUpdate)return;let i=e._tilesToRender;i.length=0;let o,r=e._tileProvider;if(!u(e._levelZeroTiles)){let y=r.tilingScheme;if(u(y)){let b=r.tilingScheme;e._levelZeroTiles=$U.createLevelZeroTiles(b);let C=e._levelZeroTiles.length;if(zD.length<C)for(zD=new Array(C),o=0;o<C;++o)zD[o]===void 0&&(zD[o]=new GD)}else return}e._occluders.ellipsoid.cameraPosition=t.camera.positionWC;let s,a=e._levelZeroTiles,c=a.length>1?e._occluders:void 0;HD=t.camera.positionCartographic,a.sort(Qft);let l=e._addHeightCallbacks,f=e._removeHeightCallbacks,d=t.frameNumber,p;if(l.length>0||f.length>0){for(o=0,p=a.length;o<p;++o)s=a[o],s._updateCustomData(d,l,f);l.length=0,f.length=0}let g=t.camera;e._cameraPositionCartographic=g.positionCartographic;let m=F.getTranslation(g.transform,Jft);for(e._cameraReferenceFrameOriginCartographic=e.tileProvider.tilingScheme.ellipsoid.cartesianToCartographic(m,e._cameraReferenceFrameOriginCartographic),o=0,p=a.length;o<p;++o)s=a[o],e._tileReplacementQueue.markTileRendered(s),s.renderable?Fa(e,s,r,t,c,!1,zD[o]):(m_(e,e._tileLoadQueueHigh,s,t),++n.tilesWaitingForChildren);e._lastSelectionFrameNumber=d}function m_(e,t,n,i){n.needsLoading&&(e.tileProvider.computeTileLoadPriority!==void 0&&(n._loadPriority=e.tileProvider.computeTileLoadPriority(n,i)),t.push(n))}function GD(){this.allAreRenderable=!0,this.anyWereRenderedLastFrame=!1,this.notYetRenderableCount=0}function Zxe(){this.southwest=new GD,this.southeast=new GD,this.northwest=new GD,this.northeast=new GD}Zxe.prototype.combine=function(e){let t=this.southwest,n=this.southeast,i=this.northwest,o=this.northeast;e.allAreRenderable=t.allAreRenderable&&n.allAreRenderable&&i.allAreRenderable&&o.allAreRenderable,e.anyWereRenderedLastFrame=t.anyWereRenderedLastFrame||n.anyWereRenderedLastFrame||i.anyWereRenderedLastFrame||o.anyWereRenderedLastFrame,e.notYetRenderableCount=t.notYetRenderableCount+n.notYetRenderableCount+i.notYetRenderableCount+o.notYetRenderableCount};var yK=new Array(31);for(let e=0;e<yK.length;++e)yK[e]=new Zxe;function tdt(e,t,n,i,o){let r=e._debug;++r.tilesVisited,e._tileReplacementQueue.markTileRendered(n),n._updateCustomData(t.frameNumber),n.level>r.maxDepthVisited&&(r.maxDepthVisited=n.level);let s=odt(e,t,n)<e.maximumScreenSpaceError,a=n.southwestChild,c=n.southeastChild,l=n.northwestChild,f=n.northeastChild,d=e._lastSelectionFrameNumber,p=n._lastSelectionResultFrame===d?n._lastSelectionResult:Xn.NONE,g=e.tileProvider;if(s||i){let m=Xn.originalResult(p)===Xn.RENDERED,y=Xn.originalResult(p)===Xn.CULLED||p===Xn.NONE,b=n.state===ga.DONE,C=m||y||b;if(C||u(g.canRenderWithoutLosingDetail)&&(C=g.canRenderWithoutLosingDetail(n)),C){s&&m_(e,e._tileLoadQueueMedium,n,t),ez(e,n),o.allAreRenderable=n.renderable,o.anyWereRenderedLastFrame=p===Xn.RENDERED,o.notYetRenderableCount=n.renderable?0:1,n._lastSelectionResultFrame=t.frameNumber,n._lastSelectionResult=Xn.RENDERED,o.anyWereRenderedLastFrame||e._tileToUpdateHeights.push(n);return}i=!0,s&&m_(e,e._tileLoadQueueHigh,n,t)}if(g.canRefine(n)){if(a.upsampledFromParent&&c.upsampledFromParent&&l.upsampledFromParent&&f.upsampledFromParent){ez(e,n),m_(e,e._tileLoadQueueMedium,n,t),e._tileReplacementQueue.markTileRendered(a),e._tileReplacementQueue.markTileRendered(c),e._tileReplacementQueue.markTileRendered(l),e._tileReplacementQueue.markTileRendered(f),o.allAreRenderable=n.renderable,o.anyWereRenderedLastFrame=p===Xn.RENDERED,o.notYetRenderableCount=n.renderable?0:1,n._lastSelectionResultFrame=t.frameNumber,n._lastSelectionResult=Xn.RENDERED,o.anyWereRenderedLastFrame||e._tileToUpdateHeights.push(n);return}n._lastSelectionResultFrame=t.frameNumber,n._lastSelectionResult=Xn.REFINED;let y=e._tilesToRender.length,b=e._tileLoadQueueLow.length,C=e._tileLoadQueueMedium.length,A=e._tileLoadQueueHigh.length,T=e._tileToUpdateHeights.length;if(ndt(e,a,c,l,f,t,i,o),y!==e._tilesToRender.length){let E=o.allAreRenderable,v=o.anyWereRenderedLastFrame,D=o.notYetRenderableCount,O=!1;if(!E&&!v){let P=e._tilesToRender;for(let L=y;L<P.length;++L){let _=P[L];for(;_!==void 0&&_._lastSelectionResult!==Xn.KICKED&&_!==n;)_._lastSelectionResult=Xn.kick(_._lastSelectionResult),_=_.parent}e._tilesToRender.length=y,e._tileToUpdateHeights.length=T,ez(e,n),n._lastSelectionResult=Xn.RENDERED;let M=p===Xn.RENDERED;!M&&D>e.loadingDescendantLimit&&(e._tileLoadQueueLow.length=b,e._tileLoadQueueMedium.length=C,e._tileLoadQueueHigh.length=A,m_(e,e._tileLoadQueueMedium,n,t),o.notYetRenderableCount=n.renderable?0:1,O=!0),o.allAreRenderable=n.renderable,o.anyWereRenderedLastFrame=M,M||e._tileToUpdateHeights.push(n),++r.tilesWaitingForChildren}e.preloadAncestors&&!O&&m_(e,e._tileLoadQueueLow,n,t)}return}n._lastSelectionResultFrame=t.frameNumber,n._lastSelectionResult=Xn.RENDERED,ez(e,n),m_(e,e._tileLoadQueueHigh,n,t),o.allAreRenderable=n.renderable,o.anyWereRenderedLastFrame=p===Xn.RENDERED,o.notYetRenderableCount=n.renderable?0:1}function ndt(e,t,n,i,o,r,s,a){let c=r.camera.positionCartographic,l=e._tileProvider,f=e._occluders,d=yK[t.level],p=d.southwest,g=d.southeast,m=d.northwest,y=d.northeast;c.longitude<t.rectangle.east?c.latitude<t.rectangle.north?(Fa(e,t,l,r,f,s,p),Fa(e,n,l,r,f,s,g),Fa(e,i,l,r,f,s,m),Fa(e,o,l,r,f,s,y)):(Fa(e,i,l,r,f,s,m),Fa(e,t,l,r,f,s,p),Fa(e,o,l,r,f,s,y),Fa(e,n,l,r,f,s,g)):c.latitude<t.rectangle.north?(Fa(e,n,l,r,f,s,g),Fa(e,t,l,r,f,s,p),Fa(e,o,l,r,f,s,y),Fa(e,i,l,r,f,s,m)):(Fa(e,o,l,r,f,s,y),Fa(e,i,l,r,f,s,m),Fa(e,n,l,r,f,s,g),Fa(e,t,l,r,f,s,p)),d.combine(a)}function idt(e,t){let n=t.rectangle;return u(e._cameraPositionCartographic)&&se.contains(n,e._cameraPositionCartographic)||u(e._cameraReferenceFrameOriginCartographic)&&se.contains(n,e._cameraReferenceFrameOriginCartographic)}function Fa(e,t,n,i,o,r,s){if(n.computeTileVisibility(t,i,o)!==Sr.NONE)return tdt(e,i,t,r,s);if(++e._debug.tilesCulled,e._tileReplacementQueue.markTileRendered(t),s.allAreRenderable=!0,s.anyWereRenderedLastFrame=!1,s.notYetRenderableCount=0,idt(e,t)){(!u(t.data)||!u(t.data.vertexArray))&&m_(e,e._tileLoadQueueMedium,t,i);let a=e._lastSelectionFrameNumber,c=t._lastSelectionResultFrame===a?t._lastSelectionResult:Xn.NONE;c!==Xn.CULLED_BUT_NEEDED&&c!==Xn.RENDERED&&e._tileToUpdateHeights.push(t),t._lastSelectionResult=Xn.CULLED_BUT_NEEDED}else e.preloadSiblings||t.level===0?(m_(e,e._tileLoadQueueLow,t,i),t._lastSelectionResult=Xn.CULLED):t._lastSelectionResult=Xn.CULLED;t._lastSelectionResultFrame=i.frameNumber}function odt(e,t,n){if(t.mode===ne.SCENE2D||t.camera.frustum instanceof sn||t.camera.frustum instanceof Gr)return rdt(e,t,n);let i=e._tileProvider.getLevelMaximumGeometricError(n.level),o=n._distance,r=t.context.drawingBufferHeight,s=t.camera.frustum.sseDenominator,a=i*r/(o*s);return t.fog.enabled&&(a-=R.fog(o,t.fog.density)*t.fog.sse),a/=t.pixelRatio,a}function rdt(e,t,n){let o=t.camera.frustum,r=o.offCenterFrustum;u(r)&&(o=r);let s=t.context,a=s.drawingBufferWidth,c=s.drawingBufferHeight,l=e._tileProvider.getLevelMaximumGeometricError(n.level),f=Math.max(o.top-o.bottom,o.right-o.left)/Math.max(a,c),d=l/f;return t.fog.enabled&&t.mode!==ne.SCENE2D&&(d-=R.fog(n._distance,t.fog.density)*t.fog.sse),d/=t.pixelRatio,d}function ez(e,t){e._tilesToRender.push(t)}function sdt(e,t){let n=e._tileLoadQueueHigh,i=e._tileLoadQueueMedium,o=e._tileLoadQueueLow;if(n.length===0&&i.length===0&&o.length===0)return;e._tileReplacementQueue.trimTiles(e.tileCacheSize);let r=Ei()+e._loadQueueTimeSlice,s=e._tileProvider,a=_K(e,t,s,r,n,!1);a=_K(e,t,s,r,i,a),_K(e,t,s,r,o,a)}function adt(e,t){return e._loadPriority-t._loadPriority}function _K(e,t,n,i,o,r){n.computeTileLoadPriority!==void 0&&o.sort(adt);for(let s=0,a=o.length;s<a&&(Ei()<i||!r);++s){let c=o[s];e._tileReplacementQueue.markTileRendered(c),n.loadTile(t,c),r=!0}return r}var ZE=new _n,gK=new de,iy=new h,cdt=[];function ldt(e,t){if(!u(e.tileProvider.tilingScheme))return;let n=cdt;n.length=0;let i=e._tileToUpdateHeights,o=Ei(),r=e._updateHeightsTimeSlice,s=o+r,a=t.mode,c=t.mapProjection,l=e.tileProvider.tilingScheme.ellipsoid,f;for(;i.length>0;){let d=i[0];if(!u(d.data)||!u(d.data.mesh)){let y=d._lastSelectionResultFrame===e._lastSelectionFrameNumber?d._lastSelectionResult:Xn.NONE;(y===Xn.RENDERED||y===Xn.CULLED_BUT_NEEDED)&&n.push(d),i.shift(),e._lastTileIndex=0;continue}let p=d.customData,g=p.length,m=!1;for(f=e._lastTileIndex;f<g;++f){let y=p[f],b=d.data.terrainData,C=u(b)&&b.wasCreatedByUpsampling();if(d.level>y.level&&!C){if(u(y.positionOnEllipsoidSurface)||(y.positionOnEllipsoidSurface=h.fromRadians(y.positionCartographic.longitude,y.positionCartographic.latitude,0,l)),a===ne.SCENE3D){let T=l.geodeticSurfaceNormal(y.positionOnEllipsoidSurface,ZE.direction),E=l.getSurfaceNormalIntersectionWithZAxis(y.positionOnEllipsoidSurface,11500,ZE.origin);if(!u(E)){let v=0;u(d.data.tileBoundingRegion)&&(v=d.data.tileBoundingRegion.minimumHeight);let D=Math.min(v,-11500),O=h.multiplyByScalar(T,Math.abs(D)+1,iy);h.subtract(y.positionOnEllipsoidSurface,O,ZE.origin)}}else de.clone(y.positionCartographic,gK),gK.height=-11500,c.project(gK,iy),h.fromElements(iy.z,iy.x,iy.y,iy),h.clone(iy,ZE.origin),h.clone(h.UNIT_X,ZE.direction);let A=d.data.pick(ZE,a,c,!1,iy);u(A)&&(u(y.callback)&&y.callback(A),y.level=d.level)}if(Ei()>=s){m=!0;break}}if(m){e._lastTileIndex=f;break}else e._lastTileIndex=0,i.shift()}for(f=0;f<n.length;f++)i.push(n[f])}function udt(e,t){let n=e._tileProvider,i=e._tilesToRender;for(let o=0,r=i.length;o<r;++o){let s=i[o];n.showTileThisFrame(s,t)}}var tz=Yf;function ch(e){e=x(e,ee.default);let t=new h_({ellipsoid:e}),n=new XU;this._ellipsoid=e,this._imageryLayerCollection=n,this._surfaceShaderSet=new gU,this._material=void 0,this._surface=new tz({tileProvider:new jU({terrainProvider:t,imageryLayers:n,surfaceShaderSet:this._surfaceShaderSet})}),this._terrainProvider=t,this._terrainProviderChanged=new me,this._undergroundColor=G.clone(G.BLACK),this._undergroundColorAlphaByDistance=new kt(e.maximumRadius/1e3,0,e.maximumRadius/5,1),this._translucency=new qU,bK(this),this.show=!0,this._oceanNormalMapResourceDirty=!0,this._oceanNormalMapResource=new De({url:on("Assets/Textures/waterNormalsSmall.jpg")}),this.maximumScreenSpaceError=2,this.tileCacheSize=100,this.loadingDescendantLimit=20,this.preloadAncestors=!0,this.preloadSiblings=!1,this.fillHighlightColor=void 0,this.enableLighting=!1,this.lambertDiffuseMultiplier=.9,this.dynamicAtmosphereLighting=!0,this.dynamicAtmosphereLightingFromSun=!1,this.showGroundAtmosphere=ee.WGS84.equals(e),this.atmosphereLightIntensity=10,this.atmosphereRayleighCoefficient=new h(55e-7,13e-6,284e-7),this.atmosphereMieCoefficient=new h(21e-6,21e-6,21e-6),this.atmosphereRayleighScaleHeight=1e4,this.atmosphereMieScaleHeight=3200,this.atmosphereMieAnisotropy=.9,this.lightingFadeOutDistance=R.PI_OVER_TWO*e.minimumRadius,this.lightingFadeInDistance=R.PI*e.minimumRadius,this.nightFadeOutDistance=R.PI_OVER_TWO*e.minimumRadius,this.nightFadeInDistance=5*R.PI_OVER_TWO*e.minimumRadius,this.showWaterEffect=!0,this.depthTestAgainstTerrain=!1,this.shadows=xn.RECEIVE_ONLY,this.atmosphereHueShift=0,this.atmosphereSaturationShift=0,this.atmosphereBrightnessShift=0,this.showSkirts=!0,this.backFaceCulling=!0,this._oceanNormalMap=void 0,this._zoomedOutOceanSpecularIntensity=void 0,this.vertexShadowDarkness=.3}Object.defineProperties(ch.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},imageryLayers:{get:function(){return this._imageryLayerCollection}},imageryLayersUpdatedEvent:{get:function(){return this._surface.tileProvider.imageryLayersUpdatedEvent}},tilesLoaded:{get:function(){return u(this._surface)?this._surface._tileLoadQueueHigh.length===0&&this._surface._tileLoadQueueMedium.length===0&&this._surface._tileLoadQueueLow.length===0:!0}},baseColor:{get:function(){return this._surface.tileProvider.baseColor},set:function(e){this._surface.tileProvider.baseColor=e}},clippingPlanes:{get:function(){return this._surface.tileProvider.clippingPlanes},set:function(e){this._surface.tileProvider.clippingPlanes=e}},clippingPolygons:{get:function(){return this._surface.tileProvider.clippingPolygons},set:function(e){this._surface.tileProvider.clippingPolygons=e}},cartographicLimitRectangle:{get:function(){return this._surface.tileProvider.cartographicLimitRectangle},set:function(e){u(e)||(e=se.clone(se.MAX_VALUE)),this._surface.tileProvider.cartographicLimitRectangle=e}},oceanNormalMapUrl:{get:function(){return this._oceanNormalMapResource.url},set:function(e){this._oceanNormalMapResource.url=e,this._oceanNormalMapResourceDirty=!0}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){e!==this._terrainProvider&&(this._terrainProvider=e,this._terrainProviderChanged.raiseEvent(e),u(this._material)&&bK(this))}},terrainProviderChanged:{get:function(){return this._terrainProviderChanged}},tileLoadProgressEvent:{get:function(){return this._surface.tileLoadProgressEvent}},material:{get:function(){return this._material},set:function(e){this._material!==e&&(this._material=e,bK(this))}},undergroundColor:{get:function(){return this._undergroundColor},set:function(e){this._undergroundColor=G.clone(e,this._undergroundColor)}},undergroundColorAlphaByDistance:{get:function(){return this._undergroundColorAlphaByDistance},set:function(e){this._undergroundColorAlphaByDistance=kt.clone(e,this._undergroundColorAlphaByDistance)}},translucency:{get:function(){return this._translucency}}});function bK(e){let t=[],n=u(e._material)&&(u(e._material.shaderSource.match(/slope/))||u(e._material.shaderSource.match("normalEC"))),i=[Xh,ID];u(e._material)&&(!n||e._terrainProvider.requestVertexNormals)?(i.push(e._material.shaderSource),t.push("APPLY_MATERIAL"),e._surface._tileProvider.materialUniformMap=e._material._uniforms):e._surface._tileProvider.materialUniformMap=void 0,i.push(pU),e._surfaceShaderSet.baseVertexShaderSource=new ze({sources:[Xh,ID,_U],defines:t}),e._surfaceShaderSet.baseFragmentShaderSource=new ze({sources:i,defines:t}),e._surfaceShaderSet.material=e._material}function fdt(e){return function(t,n){let i=ae.distanceSquaredTo(t.pickBoundingSphere,e),o=ae.distanceSquaredTo(n.pickBoundingSphere,e);return i-o}}var ddt=[],hdt={start:0,stop:0};ch.prototype.pickWorldCoordinates=function(e,t,n,i){n=x(n,!0);let o=t.mode,r=t.mapProjection,s=ddt;s.length=0;let a=this._surface._tilesToRender,c=a.length,l,f;for(f=0;f<c;++f){l=a[f];let p=l.data;if(!u(p))continue;let g=p.pickBoundingSphere;if(o!==ne.SCENE3D)p.pickBoundingSphere=g=ae.fromRectangleWithHeights2D(l.rectangle,r,p.tileBoundingRegion.minimumHeight,p.tileBoundingRegion.maximumHeight,g),h.fromElements(g.center.z,g.center.x,g.center.y,g.center);else if(u(p.renderedMesh))ae.clone(p.tileBoundingRegion.boundingSphere,g);else continue;let m=Qn.raySphere(e,g,hdt);u(m)&&s.push(p)}s.sort(fdt(e.origin));let d;for(c=s.length,f=0;f<c&&(d=s[f].pick(e,t.mode,t.mapProjection,n,i),!u(d));++f);return d};var mdt=new de;ch.prototype.pick=function(e,t,n){if(n=this.pickWorldCoordinates(e,t,!0,n),u(n)&&t.mode!==ne.SCENE3D){n=h.fromElements(n.y,n.z,n.x,n);let i=t.mapProjection.unproject(n,mdt);n=this._ellipsoid.cartographicToCartesian(i,n)}return n};var pdt=new h,$xe=new h,_dt=new de,gdt=new _n;function xK(e,t){return u(e)&&se.contains(e.rectangle,t)?e:void 0}ch.prototype.getHeight=function(e){let t=this._surface._levelZeroTiles;if(!u(t))return;let n,i,o=t.length;for(i=0;i<o&&(n=t[i],!se.contains(n.rectangle,e));++i);if(i>=o)return;let r=n;for(;u(n);)n=xK(n._southwestChild,e)||xK(n._southeastChild,e)||xK(n._northwestChild,e)||n._northeastChild,u(n)&&u(n.data)&&u(n.data.renderedMesh)&&(r=n);if(n=r,!u(n)||!u(n.data)||!u(n.data.renderedMesh))return;let s=this._surface._tileProvider.tilingScheme.projection,a=this._surface._tileProvider.tilingScheme.ellipsoid,c=h.fromRadians(e.longitude,e.latitude,0,a,pdt),l=gdt,f=a.geodeticSurfaceNormal(c,l.direction),d=a.getSurfaceNormalIntersectionWithZAxis(c,11500,l.origin);if(!u(d)){let g;u(n.data.tileBoundingRegion)&&(g=n.data.tileBoundingRegion.minimumHeight);let m=Math.min(x(g,0),-11500),y=h.multiplyByScalar(f,Math.abs(m)+1,$xe);h.subtract(c,y,l.origin)}let p=n.data.pick(l,void 0,s,!1,$xe);if(u(p))return a.cartesianToCartographic(p,_dt).height};ch.prototype.update=function(e){this.show&&e.passes.render&&this._surface.update(e)};ch.prototype.beginFrame=function(e){let t=this._surface,n=t.tileProvider,i=this.terrainProvider,o=u(i)&&i.hasWaterMask&&i.hasWaterMask;if(o&&this._oceanNormalMapResourceDirty){this._oceanNormalMapResourceDirty=!1;let a=this._oceanNormalMapResource,c=a.url;if(u(c)){let l=this;a.fetchImage().then(function(f){c===l._oceanNormalMapResource.url&&(l._oceanNormalMap=l._oceanNormalMap&&l._oceanNormalMap.destroy(),l._oceanNormalMap=new Ot({context:e.context,source:f}))})}else this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy()}let r=e.passes,s=e.mode;r.render&&(this.showGroundAtmosphere?this._zoomedOutOceanSpecularIntensity=.4:this._zoomedOutOceanSpecularIntensity=.5,t.maximumScreenSpaceError=this.maximumScreenSpaceError,t.tileCacheSize=this.tileCacheSize,t.loadingDescendantLimit=this.loadingDescendantLimit,t.preloadAncestors=this.preloadAncestors,t.preloadSiblings=this.preloadSiblings,n.terrainProvider=this.terrainProvider,n.lightingFadeOutDistance=this.lightingFadeOutDistance,n.lightingFadeInDistance=this.lightingFadeInDistance,n.nightFadeOutDistance=this.nightFadeOutDistance,n.nightFadeInDistance=this.nightFadeInDistance,n.zoomedOutOceanSpecularIntensity=s===ne.SCENE3D?this._zoomedOutOceanSpecularIntensity:0,n.hasWaterMask=o,n.showWaterEffect=this.showWaterEffect,n.oceanNormalMap=this._oceanNormalMap,n.enableLighting=this.enableLighting,n.dynamicAtmosphereLighting=this.dynamicAtmosphereLighting,n.dynamicAtmosphereLightingFromSun=this.dynamicAtmosphereLightingFromSun,n.showGroundAtmosphere=this.showGroundAtmosphere,n.atmosphereLightIntensity=this.atmosphereLightIntensity,n.atmosphereRayleighCoefficient=this.atmosphereRayleighCoefficient,n.atmosphereMieCoefficient=this.atmosphereMieCoefficient,n.atmosphereRayleighScaleHeight=this.atmosphereRayleighScaleHeight,n.atmosphereMieScaleHeight=this.atmosphereMieScaleHeight,n.atmosphereMieAnisotropy=this.atmosphereMieAnisotropy,n.shadows=this.shadows,n.hueShift=this.atmosphereHueShift,n.saturationShift=this.atmosphereSaturationShift,n.brightnessShift=this.atmosphereBrightnessShift,n.fillHighlightColor=this.fillHighlightColor,n.showSkirts=this.showSkirts,n.backFaceCulling=this.backFaceCulling,n.vertexShadowDarkness=this.vertexShadowDarkness,n.undergroundColor=this._undergroundColor,n.undergroundColorAlphaByDistance=this._undergroundColorAlphaByDistance,n.lambertDiffuseMultiplier=this.lambertDiffuseMultiplier,t.beginFrame(e))};ch.prototype.render=function(e){this.show&&(u(this._material)&&this._material.update(e.context),this._surface.render(e))};ch.prototype.endFrame=function(e){this.show&&e.passes.render&&this._surface.endFrame(e)};ch.prototype.isDestroyed=function(){return!1};ch.prototype.destroy=function(){return this._surfaceShaderSet=this._surfaceShaderSet&&this._surfaceShaderSet.destroy(),this._surface=this._surface&&this._surface.destroy(),this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy(),ue(this)};var nz=ch;var WD=`uniform vec3 u_radii;
uniform vec3 u_oneOverEllipsoidRadiiSquared;

in vec3 v_positionEC;

vec4 computeEllipsoidColor(czm_ray ray, float intersection, float side)
{
    vec3 positionEC = czm_pointAlongRay(ray, intersection);
    vec3 positionMC = (czm_inverseModelView * vec4(positionEC, 1.0)).xyz;
    vec3 geodeticNormal = normalize(czm_geodeticSurfaceNormal(positionMC, vec3(0.0), u_oneOverEllipsoidRadiiSquared));
    vec3 sphericalNormal = normalize(positionMC / u_radii);
    vec3 normalMC = geodeticNormal * side;              // normalized surface normal (always facing the viewer) in model coordinates
    vec3 normalEC = normalize(czm_normal * normalMC);   // normalized surface normal in eye coordinates

    vec2 st = czm_ellipsoidTextureCoordinates(sphericalNormal);
    vec3 positionToEyeEC = -positionEC;

    czm_materialInput materialInput;
    materialInput.s = st.s;
    materialInput.st = st;
    materialInput.str = (positionMC + u_radii) / u_radii;
    materialInput.normalEC = normalEC;
    materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(positionMC, normalEC);
    materialInput.positionToEyeEC = positionToEyeEC;
    czm_material material = czm_getMaterial(materialInput);

#ifdef ONLY_SUN_LIGHTING
    return czm_private_phong(normalize(positionToEyeEC), material, czm_sunDirectionEC);
#else
    return czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);
#endif
}

void main()
{
    // PERFORMANCE_TODO: When dynamic branching is available, compute ratio of maximum and minimum radii
    // in the vertex shader. Only when it is larger than some constant, march along the ray.
    // Otherwise perform one intersection test which will be the common case.

    // Test if the ray intersects a sphere with the ellipsoid's maximum radius.
    // For very oblate ellipsoids, using the ellipsoid's radii for an intersection test
    // may cause false negatives. This will discard fragments before marching the ray forward.
    float maxRadius = max(u_radii.x, max(u_radii.y, u_radii.z)) * 1.5;
    vec3 direction = normalize(v_positionEC);
    vec3 ellipsoidCenter = czm_modelView[3].xyz;

    float t1 = -1.0;
    float t2 = -1.0;

    float b = -2.0 * dot(direction, ellipsoidCenter);
    float c = dot(ellipsoidCenter, ellipsoidCenter) - maxRadius * maxRadius;

    float discriminant = b * b - 4.0 * c;
    if (discriminant >= 0.0) {
        t1 = (-b - sqrt(discriminant)) * 0.5;
        t2 = (-b + sqrt(discriminant)) * 0.5;
    }

    if (t1 < 0.0 && t2 < 0.0) {
        discard;
    }

    float t = min(t1, t2);
    if (t < 0.0) {
        t = 0.0;
    }

    // March ray forward to intersection with larger sphere and find
    czm_ray ray = czm_ray(t * direction, direction);

    vec3 ellipsoid_inverseRadii = vec3(1.0 / u_radii.x, 1.0 / u_radii.y, 1.0 / u_radii.z);

    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoidCenter, ellipsoid_inverseRadii);

    if (czm_isEmpty(intersection))
    {
        discard;
    }

    // If the viewer is outside, compute outsideFaceColor, with normals facing outward.
    vec4 outsideFaceColor = (intersection.start != 0.0) ? computeEllipsoidColor(ray, intersection.start, 1.0) : vec4(0.0);

    // If the viewer either is inside or can see inside, compute insideFaceColor, with normals facing inward.
    vec4 insideFaceColor = (outsideFaceColor.a < 1.0) ? computeEllipsoidColor(ray, intersection.stop, -1.0) : vec4(0.0);

    out_FragColor = mix(insideFaceColor, outsideFaceColor, outsideFaceColor.a);
    out_FragColor.a = 1.0 - (1.0 - insideFaceColor.a) * (1.0 - outsideFaceColor.a);

#if (defined(WRITE_DEPTH) && (__VERSION__ == 300 || defined(GL_EXT_frag_depth)))
    t = (intersection.start != 0.0) ? intersection.start : intersection.stop;
    vec3 positionEC = czm_pointAlongRay(ray, t);
    vec4 positionCC = czm_projection * vec4(positionEC, 1.0);
#ifdef LOG_DEPTH
    czm_writeLogDepth(1.0 + positionCC.w);
#else
    float z = positionCC.z / positionCC.w;

    float n = czm_depthRange.near;
    float f = czm_depthRange.far;

    gl_FragDepth = (z * (f - n) + f + n) * 0.5;
#endif
#endif
}
`;var jD=`in vec3 position;

uniform vec3 u_radii;

out vec3 v_positionEC;

void main()
{
    // In the vertex data, the cube goes from (-1.0, -1.0, -1.0) to (1.0, 1.0, 1.0) in model coordinates.
    // Scale to consider the radii.  We could also do this once on the CPU when using the BoxGeometry,
    // but doing it here allows us to change the radii without rewriting the vertex data, and
    // allows all ellipsoids to reuse the same vertex data.
    vec4 p = vec4(u_radii * position, 1.0);

    v_positionEC = (czm_modelView * p).xyz;     // position in eye coordinates
    gl_Position = czm_modelViewProjection * p;  // position in clip coordinates

    // With multi-frustum, when the ellipsoid primitive is positioned on the intersection of two frustums
    // and close to terrain, the terrain (writes depth) in the closest frustum can overwrite part of the
    // ellipsoid (does not write depth) that was rendered in the farther frustum.
    //
    // Here, we clamp the depth in the vertex shader to avoid being overwritten; however, this creates
    // artifacts since some fragments can be alpha blended twice.  This is solved by only rendering
    // the ellipsoid in the closest frustum to the viewer.
    gl_Position.z = clamp(gl_Position.z, czm_depthRange.near, czm_depthRange.far);

    czm_vertexLogDepth();
}
`;var CK={position:0};function iz(e){e=x(e,x.EMPTY_OBJECT),this.center=h.clone(x(e.center,h.ZERO)),this._center=new h,this.radii=h.clone(e.radii),this._radii=new h,this._oneOverEllipsoidRadiiSquared=new h,this._boundingSphere=new ae,this.modelMatrix=F.clone(x(e.modelMatrix,F.IDENTITY)),this._modelMatrix=new F,this._computedModelMatrix=new F,this.show=x(e.show,!0),this.material=x(e.material,Zi.fromType(Zi.ColorType)),this._material=void 0,this._translucent=void 0,this.id=e.id,this._id=void 0,this.debugShowBoundingVolume=x(e.debugShowBoundingVolume,!1),this.onlySunLighting=x(e.onlySunLighting,!1),this._onlySunLighting=!1,this._depthTestEnabled=x(e.depthTestEnabled,!0),this._useLogDepth=!1,this._sp=void 0,this._rs=void 0,this._va=void 0,this._pickSP=void 0,this._pickId=void 0,this._colorCommand=new Qe({owner:x(e._owner,this)}),this._pickCommand=new Qe({owner:x(e._owner,this),pickOnly:!0});let t=this;this._uniforms={u_radii:function(){return t.radii},u_oneOverEllipsoidRadiiSquared:function(){return t._oneOverEllipsoidRadiiSquared}},this._pickUniforms={czm_pickColor:function(){return t._pickId.color}}}function ydt(e){let t=e.cache.ellipsoidPrimitive_vertexArray;if(u(t))return t;let n=Ya.createGeometry(Ya.fromDimensions({dimensions:new h(2,2,2),vertexFormat:Ie.POSITION_ONLY}));return t=ii.fromGeometry({context:e,geometry:n,attributeLocations:CK,bufferUsage:ke.STATIC_DRAW,interleave:!0}),e.cache.ellipsoidPrimitive_vertexArray=t,t}iz.prototype.update=function(e){if(!this.show||e.mode!==ne.SCENE3D||!u(this.center)||!u(this.radii))return;let t=e.context,n=this.material.isTranslucent(),i=this._translucent!==n;(!u(this._rs)||i)&&(this._translucent=n,this._rs=Ue.fromCache({cull:{enabled:!0,face:Ci.FRONT},depthTest:{enabled:this._depthTestEnabled},depthMask:!n&&t.fragmentDepth,blending:n?un.ALPHA_BLEND:void 0})),u(this._va)||(this._va=ydt(t));let o=!1,r=this.radii;if(!h.equals(this._radii,r)){h.clone(r,this._radii);let y=this._oneOverEllipsoidRadiiSquared;y.x=1/(r.x*r.x),y.y=1/(r.y*r.y),y.z=1/(r.z*r.z),o=!0}(!F.equals(this.modelMatrix,this._modelMatrix)||!h.equals(this.center,this._center))&&(F.clone(this.modelMatrix,this._modelMatrix),h.clone(this.center,this._center),F.multiplyByTranslation(this.modelMatrix,this.center,this._computedModelMatrix),o=!0),o&&(h.clone(h.ZERO,this._boundingSphere.center),this._boundingSphere.radius=h.maximumComponent(r),ae.transform(this._boundingSphere,this._computedModelMatrix,this._boundingSphere));let s=this._material!==this.material;this._material=this.material,this._material.update(t);let a=this.onlySunLighting!==this._onlySunLighting;this._onlySunLighting=this.onlySunLighting;let c=e.useLogDepth,l=this._useLogDepth!==c;this._useLogDepth=c;let f=this._colorCommand,d,p;(s||a||i||l)&&(d=new ze({sources:[jD]}),p=new ze({sources:[this.material.shaderSource,WD]}),this.onlySunLighting&&p.defines.push("ONLY_SUN_LIGHTING"),!n&&t.fragmentDepth&&p.defines.push("WRITE_DEPTH"),this._useLogDepth&&(d.defines.push("LOG_DEPTH"),p.defines.push("LOG_DEPTH")),this._sp=tn.replaceCache({context:t,shaderProgram:this._sp,vertexShaderSource:d,fragmentShaderSource:p,attributeLocations:CK}),f.vertexArray=this._va,f.renderState=this._rs,f.shaderProgram=this._sp,f.uniformMap=bt(this._uniforms,this.material._uniforms),f.executeInClosestFrustum=n);let g=e.commandList,m=e.passes;if(m.render&&(f.boundingVolume=this._boundingSphere,f.debugShowBoundingVolume=this.debugShowBoundingVolume,f.modelMatrix=this._computedModelMatrix,f.pass=n?we.TRANSLUCENT:we.OPAQUE,g.push(f)),m.pick){let y=this._pickCommand;(!u(this._pickId)||this._id!==this.id)&&(this._id=this.id,this._pickId=this._pickId&&this._pickId.destroy(),this._pickId=t.createPickId({primitive:this,id:this.id})),(s||a||!u(this._pickSP)||l)&&(d=new ze({sources:[jD]}),p=new ze({sources:[this.material.shaderSource,WD],pickColorQualifier:"uniform"}),this.onlySunLighting&&p.defines.push("ONLY_SUN_LIGHTING"),!n&&t.fragmentDepth&&p.defines.push("WRITE_DEPTH"),this._useLogDepth&&(d.defines.push("LOG_DEPTH"),p.defines.push("LOG_DEPTH")),this._pickSP=tn.replaceCache({context:t,shaderProgram:this._pickSP,vertexShaderSource:d,fragmentShaderSource:p,attributeLocations:CK}),y.vertexArray=this._va,y.renderState=this._rs,y.shaderProgram=this._pickSP,y.uniformMap=bt(bt(this._uniforms,this._pickUniforms),this.material._uniforms),y.executeInClosestFrustum=n),y.boundingVolume=this._boundingSphere,y.modelMatrix=this._computedModelMatrix,y.pass=n?we.TRANSLUCENT:we.OPAQUE,g.push(y)}};iz.prototype.isDestroyed=function(){return!1};iz.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._pickSP=this._pickSP&&this._pickSP.destroy(),this._pickId=this._pickId&&this._pickId.destroy(),ue(this)};var oz=iz;function qD(e){e=x(e,x.EMPTY_OBJECT);let t=e.textureUrl;u(t)||(t=on("Assets/Textures/moonSmall.jpg")),this.show=x(e.show,!0),this.textureUrl=t,this._ellipsoid=x(e.ellipsoid,ee.MOON),this.onlySunLighting=x(e.onlySunLighting,!0),this._ellipsoidPrimitive=new oz({radii:this.ellipsoid.radii,material:Zi.fromType(Zi.ImageType),depthTestEnabled:!1,_owner:this}),this._ellipsoidPrimitive.material.translucent=!1,this._axes=new tU}Object.defineProperties(qD.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});var rz=new J,xdt=new J,bdt=new h,sz=[];qD.prototype.update=function(e){if(!this.show)return;let t=this._ellipsoidPrimitive;t.material.uniforms.image=this.textureUrl,t.onlySunLighting=this.onlySunLighting;let n=e.time;u(Lt.computeIcrfToFixedMatrix(n,rz))||Lt.computeTemeToPseudoFixedMatrix(n,rz);let i=this._axes.evaluate(n,xdt);J.transpose(i,i),J.multiply(rz,i,i);let o=Ly.computeMoonPositionInEarthInertialFrame(n,bdt);J.multiplyByVector(rz,o,o),F.fromRotationTranslation(i,o,t.modelMatrix);let r=e.commandList;return e.commandList=sz,sz.length=0,t.update(e),e.commandList=r,sz.length===1?sz[0]:void 0};qD.prototype.isDestroyed=function(){return!1};qD.prototype.destroy=function(){return this._ellipsoidPrimitive=this._ellipsoidPrimitive&&this._ellipsoidPrimitive.destroy(),ue(this)};var az=qD;var cz=`in vec2 v_textureCoordinates;
const float M_PI = 3.141592653589793;

float vdcRadicalInverse(int i)
{
    float r;
    float base = 2.0;
    float value = 0.0;
    float invBase = 1.0 / base;
    float invBi = invBase;
    for (int x = 0; x < 100; x++)
    {
        if (i <= 0)
        {
            break;
        }
        r = mod(float(i), base);
        value += r * invBi;
        invBi *= invBase;
        i = int(float(i) * invBase);
    }
    return value;
}

vec2 hammersley2D(int i, int N)
{
    return vec2(float(i) / float(N), vdcRadicalInverse(i));
}

vec3 importanceSampleGGX(vec2 xi, float alphaRoughness, vec3 N)
{
    float alphaRoughnessSquared = alphaRoughness * alphaRoughness;
    float phi = 2.0 * M_PI * xi.x;
    float cosTheta = sqrt((1.0 - xi.y) / (1.0 + (alphaRoughnessSquared - 1.0) * xi.y));
    float sinTheta = sqrt(1.0 - cosTheta * cosTheta);
    vec3 H = vec3(sinTheta * cos(phi), sinTheta * sin(phi), cosTheta);
    vec3 upVector = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
    vec3 tangentX = normalize(cross(upVector, N));
    vec3 tangentY = cross(N, tangentX);
    return tangentX * H.x + tangentY * H.y + N * H.z;
}

/**
 * Estimate the geometric self-shadowing of the microfacets in a surface,
 * using the Smith Joint GGX visibility function.
 * Note: Vis = G / (4 * NdotL * NdotV)
 * see Eric Heitz. 2014. Understanding the Masking-Shadowing Function in Microfacet-Based BRDFs. Journal of Computer Graphics Techniques, 3
 * see Real-Time Rendering. Page 331 to 336.
 * see https://google.github.io/filament/Filament.md.html#materialsystem/specularbrdf/geometricshadowing(specularg)
 *
 * @param {float} alphaRoughness The roughness of the material, expressed as the square of perceptual roughness.
 * @param {float} NdotL The cosine of the angle between the surface normal and the direction to the light source.
 * @param {float} NdotV The cosine of the angle between the surface normal and the direction to the camera.
 */
float smithVisibilityGGX(float alphaRoughness, float NdotL, float NdotV)
{
    float alphaRoughnessSq = alphaRoughness * alphaRoughness;

    float GGXV = NdotL * sqrt(NdotV * NdotV * (1.0 - alphaRoughnessSq) + alphaRoughnessSq);
    float GGXL = NdotV * sqrt(NdotL * NdotL * (1.0 - alphaRoughnessSq) + alphaRoughnessSq);

    float GGX = GGXV + GGXL; // 2.0 if NdotL = NdotV = 1.0
    if (GGX > 0.0)
    {
        return 0.5 / GGX; // 1/4 if NdotL = NdotV = 1.0
    }
    return 0.0;
}

vec2 integrateBrdf(float roughness, float NdotV)
{
    vec3 V = vec3(sqrt(1.0 - NdotV * NdotV), 0.0, NdotV);
    float A = 0.0;
    float B = 0.0;
    const int NumSamples = 1024;
    float alphaRoughness = roughness * roughness;
    for (int i = 0; i < NumSamples; i++)
    {
        vec2 xi = hammersley2D(i, NumSamples);
        vec3 H = importanceSampleGGX(xi, alphaRoughness, vec3(0.0, 0.0, 1.0));
        vec3 L = 2.0 * dot(V, H) * H - V;
        float NdotL = clamp(L.z, 0.0, 1.0);
        float NdotH = clamp(H.z, 0.0, 1.0);
        float VdotH = clamp(dot(V, H), 0.0, 1.0);
        if (NdotL > 0.0)
        {
            float G = smithVisibilityGGX(alphaRoughness, NdotL, NdotV);
            float G_Vis = 4.0 * G * VdotH * NdotL / NdotH;
            float Fc = pow(1.0 - VdotH, 5.0);
            A += (1.0 - Fc) * G_Vis;
            B += Fc * G_Vis;
        }
    }
    return vec2(A, B) / float(NumSamples);
}

void main()
{
    out_FragColor = vec4(integrateBrdf(v_textureCoordinates.y, v_textureCoordinates.x), 0.0, 1.0);
}
`;function YD(){this._colorTexture=void 0,this._drawCommand=void 0}Object.defineProperties(YD.prototype,{colorTexture:{get:function(){return this._colorTexture}}});function Cdt(e,t,n){let i=t.createViewportQuadCommand(cz,{framebuffer:n,renderState:Ue.fromCache({viewport:new qe(0,0,256,256)})});e._drawCommand=i}YD.prototype.update=function(e){if(!u(this._colorTexture)){let t=e.context,n=new Ot({context:t,width:256,height:256,pixelFormat:tt.RGBA,pixelDatatype:Ke.UNSIGNED_BYTE,sampler:Qt.NEAREST});this._colorTexture=n;let i=new Hr({context:t,colorTextures:[n],destroyAttachments:!1});Cdt(this,t,i),this._drawCommand.execute(t),i.destroy(),this._drawCommand.shaderProgram=this._drawCommand.shaderProgram&&this._drawCommand.shaderProgram.destroy()}};YD.prototype.isDestroyed=function(){return!1};YD.prototype.destroy=function(){return this._colorTexture=this._colorTexture&&this._colorTexture.destroy(),ue(this)};var lz=YD;var tbe={};function Adt(e,t,n){let i,o,r;if(e instanceof Ri){let s=Math.tan(.5*e.fovy);return i=e.near,o=e.near*s,r=e.aspectRatio*o,Math.max(t*i/r,n*i/o)}else if(e instanceof Ll)return i=e.near,o=e.top,r=e.right,Math.max(t*i/r,n*i/o);return Math.max(t,n)}var Tdt=new h,Qxe=new h;function nbe(e,t,n,i){if(u(i)&&n(.5)>i){let o=n(0),r=n(1),s=n(.5),a=s-o,c=s-r;return function(l){let f=n(l);if(l<=.5){let p=(f-o)/a;return R.lerp(e,-R.PI_OVER_TWO,p)}let d=(f-r)/c;return R.lerp(-R.PI_OVER_TWO,t,1-d)}}return function(o){return R.lerp(e,t,o)}}function TK(e,t,n,i,o){let r=o,s=Math.max(n,i);if(!u(r)){let a=e.position,c=t,l=e.up,f=e.right,d=e.frustum,p=h.subtract(a,c,Tdt),g=h.magnitude(h.multiplyByScalar(l,h.dot(p,l),Qxe)),m=h.magnitude(h.multiplyByScalar(f,h.dot(p,f),Qxe));r=Math.min(Adt(d,g,m)*.2,1e9)}if(s<r){let l=-Math.pow((r-n)*1e6,.125),f=Math.pow((r-i)*1e6,1/8);return function(d){let p=d*(f-l)+l;return-Math.pow(p,8)/1e6+r}}return function(a){return R.lerp(n,i,a)}}function XD(e,t){return R.equalsEpsilon(e,R.TWO_PI,R.EPSILON11)&&(e=0),t>e+Math.PI?e+=R.TWO_PI:t<e-Math.PI&&(e-=R.TWO_PI),e}var ibe=new h;function Edt(e,t,n,i,o,r,s,a){let c=e.camera,l=h.clone(c.position,ibe),f=c.pitch,d=XD(c.heading,i),p=XD(c.roll,r),g=TK(c,n,l.z,n.z,s),m=nbe(f,o,g,a);function y(b){let C=b.time/t;c.setView({orientation:{heading:R.lerp(d,i,C),pitch:m(C),roll:R.lerp(p,r,C)}}),H.lerp(l,n,C,c.position),c.position.z=g(C)}return y}function Sdt(e,t){e.longitude<t.longitude?e.longitude+=R.TWO_PI:t.longitude+=R.TWO_PI}function vdt(e,t){let n=e.longitude-t.longitude;n<-R.PI?e.longitude+=R.TWO_PI:n>R.PI&&(t.longitude+=R.TWO_PI)}var wdt=new de,Ddt=new de;function Idt(e,t,n,i,o,r,s,a,c,l){let f=e.camera,p=e.mapProjection.ellipsoid,g=de.clone(f.positionCartographic,wdt),m=f.pitch,y=XD(f.heading,i),b=XD(f.roll,r),C=p.cartesianToCartographic(n,Ddt);g.longitude=R.zeroToTwoPi(g.longitude),C.longitude=R.zeroToTwoPi(C.longitude);let A=!1;if(u(a)){let D=R.zeroToTwoPi(a),O=Math.min(g.longitude,C.longitude),P=Math.max(g.longitude,C.longitude),M=D>=O&&D<=P;if(u(c)){let L=Math.abs(g.longitude-C.longitude),_=R.TWO_PI-L;(M?L:_)<(M?_:L)*c&&!M&&(A=!0)}else M||(A=!0)}A?Sdt(g,C):vdt(g,C);let T=TK(f,n,g.height,C.height,s),E=nbe(m,o,T,l);function v(){let D=g.longitude,O=C.longitude,P=g.latitude,M=C.latitude;return function(_){let S=_.time/t,w=h.fromRadians(R.lerp(D,O,S),R.lerp(P,M,S),T(S),p);f.setView({destination:w,orientation:{heading:R.lerp(y,i,S),pitch:E(S),roll:R.lerp(b,r,S)}})}}return v()}function Pdt(e,t,n,i,o,r,s){let a=e.camera,c=h.clone(a.position,ibe),l=XD(a.heading,i),f=a.frustum.right-a.frustum.left,d=TK(a,n,f,n.z,s);function p(g){let m=g.time/t;a.setView({orientation:{heading:R.lerp(l,i,m)}}),H.lerp(c,n,m,a.position);let y=d(m),b=a.frustum,C=b.top/b.right,A=(y-(b.right-b.left))*.5;b.right+=A,b.left-=A,b.top=C*b.right,b.bottom=-b.top}return p}var Jxe=new de,Rdt=new h;function AK(e,t){return{startObject:{},stopObject:{},duration:0,complete:e,cancel:t}}function ebe(e,t){function n(){typeof t=="function"&&t(),e.enableInputs=!0}return n}tbe.createTween=function(e,t){t=x(t,x.EMPTY_OBJECT);let n=t.destination,i=e.mode;if(i===ne.MORPHING)return AK();let o=x(t.convert,!0),r=e.mapProjection,s=r.ellipsoid,a=t.maximumHeight,c=t.flyOverLongitude,l=t.flyOverLongitudeWeight,f=t.pitchAdjustHeight,d=t.easingFunction;o&&i!==ne.SCENE3D&&(s.cartesianToCartographic(n,Jxe),n=r.project(Jxe,Rdt));let p=e.camera,g=t.endTransform;u(g)&&p._setTransform(g);let m=t.duration;u(m)||(m=Math.ceil(h.distance(p.position,n)/1e6)+2,m=Math.min(m,3));let y=x(t.heading,0),b=x(t.pitch,-R.PI_OVER_TWO),C=x(t.roll,0),A=e.screenSpaceCameraController;A.enableInputs=!1;let T=ebe(A,t.complete),E=ebe(A,t.cancel),v=p.frustum,D=e.mode===ne.SCENE2D;if(D=D&&H.equalsEpsilon(p.position,n,R.EPSILON6),D=D&&R.equalsEpsilon(Math.max(v.right-v.left,v.top-v.bottom),n.z,R.EPSILON6),D=D||e.mode!==ne.SCENE2D&&h.equalsEpsilon(n,p.position,R.EPSILON10),D=D&&R.equalsEpsilon(R.negativePiToPi(y),R.negativePiToPi(p.heading),R.EPSILON10)&&R.equalsEpsilon(R.negativePiToPi(b),R.negativePiToPi(p.pitch),R.EPSILON10)&&R.equalsEpsilon(R.negativePiToPi(C),R.negativePiToPi(p.roll),R.EPSILON10),D)return AK(T,E);let O=new Array(4);if(O[ne.SCENE2D]=Pdt,O[ne.SCENE3D]=Idt,O[ne.COLUMBUS_VIEW]=Edt,m<=0)return AK(function(){O[i](e,1,n,y,b,C,a,c,l,f)({time:1}),typeof T=="function"&&T()},E);let P=O[i](e,m,n,y,b,C,a,c,l,f);if(!u(d)){let M=p.positionCartographic.height,L=i===ne.SCENE3D?s.cartesianToCartographic(n).height:n.z;M>L&&M>11500?d=Qr.CUBIC_OUT:d=Qr.QUINTIC_IN_OUT}return{duration:m,easingFunction:d,startObject:{time:0},stopObject:{time:m},update:P,complete:T,cancel:E}};var uz=tbe;var Odt={ROTATE:0,INFINITE_SCROLL:1},Mu=Object.freeze(Odt);function Jt(e){this._scene=e,this._transform=F.clone(F.IDENTITY),this._invTransform=F.clone(F.IDENTITY),this._actualTransform=F.clone(F.IDENTITY),this._actualInvTransform=F.clone(F.IDENTITY),this._transformChanged=!1,this.position=new h,this._position=new h,this._positionWC=new h,this._positionCartographic=new de,this._oldPositionWC=void 0,this.positionWCDeltaMagnitude=0,this.positionWCDeltaMagnitudeLastFrame=0,this.timeSinceMoved=0,this._lastMovedTimestamp=0,this.direction=new h,this._direction=new h,this._directionWC=new h,this.up=new h,this._up=new h,this._upWC=new h,this.right=new h,this._right=new h,this._rightWC=new h,this.frustum=new Ri,this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight,this.frustum.fov=R.toRadians(60),this.defaultMoveAmount=1e5,this.defaultLookAmount=Math.PI/60,this.defaultRotateAmount=Math.PI/3600,this.defaultZoomAmount=1e5,this.constrainedAxis=void 0,this.maximumZoomFactor=1.5,this._moveStart=new me,this._moveEnd=new me,this._changed=new me,this._changedPosition=void 0,this._changedDirection=void 0,this._changedFrustum=void 0,this._changedHeading=void 0,this._changedRoll=void 0,this.percentageChanged=.5,this._viewMatrix=new F,this._invViewMatrix=new F,fbe(this),this._mode=ne.SCENE3D,this._modeChanged=!0;let t=e.mapProjection;this._projection=t,this._maxCoord=t.project(new de(Math.PI,R.PI_OVER_TWO)),this._max2Dfrustum=void 0,Tbe(this,Jt.DEFAULT_VIEW_RECTANGLE,this.position,!0);let n=h.magnitude(this.position);n+=n*Jt.DEFAULT_VIEW_FACTOR,h.normalize(this.position,this.position),h.multiplyByScalar(this.position,n,this.position)}Jt.TRANSFORM_2D=new F(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1);Jt.TRANSFORM_2D_INVERSE=F.inverseTransformation(Jt.TRANSFORM_2D,new F);Jt.DEFAULT_VIEW_RECTANGLE=se.fromDegrees(-95,-20,-70,90);Jt.DEFAULT_VIEW_FACTOR=.5;Jt.DEFAULT_OFFSET=new Yd(0,-R.PI_OVER_FOUR,0);function fbe(e){F.computeView(e._position,e._direction,e._up,e._right,e._viewMatrix),F.multiply(e._viewMatrix,e._actualInvTransform,e._viewMatrix),F.inverseTransformation(e._viewMatrix,e._invViewMatrix)}function Mdt(e){if(!u(e._oldPositionWC))e._oldPositionWC=h.clone(e.positionWC,e._oldPositionWC);else{e.positionWCDeltaMagnitudeLastFrame=e.positionWCDeltaMagnitude;let t=h.subtract(e.positionWC,e._oldPositionWC,e._oldPositionWC);e.positionWCDeltaMagnitude=h.magnitude(t),e._oldPositionWC=h.clone(e.positionWC,e._oldPositionWC),e.positionWCDeltaMagnitude>0?(e.timeSinceMoved=0,e._lastMovedTimestamp=Ei()):e.timeSinceMoved=Math.max(Ei()-e._lastMovedTimestamp,0)/1e3}}Jt.prototype.canPreloadFlight=function(){return u(this._currentFlight)&&this._mode!==ne.SCENE2D};Jt.prototype._updateCameraChanged=function(){let e=this;if(Mdt(e),e._changed.numberOfListeners===0)return;let t=e.percentageChanged,n=e.heading;u(e._changedHeading)||(e._changedHeading=n);let i=Math.abs(e._changedHeading-n)%R.TWO_PI;i=i>R.PI?R.TWO_PI-i:i;let o=i/Math.PI;o>t&&(e._changedHeading=n);let r=e.roll;u(e._changedRoll)||(e._changedRoll=r);let s=Math.abs(e._changedRoll-r)%R.TWO_PI;s=s>R.PI?R.TWO_PI-s:s;let a=s/Math.PI;if(a>t&&(e._changedRoll=r),(a>t||o>t)&&e._changed.raiseEvent(Math.max(a,o)),e._mode===ne.SCENE2D){if(!u(e._changedFrustum)){e._changedPosition=h.clone(e.position,e._changedPosition),e._changedFrustum=e.frustum.clone();return}let p=e.position,g=e._changedPosition,m=e.frustum,y=e._changedFrustum,b=p.x+m.left,C=p.x+m.right,A=g.x+y.left,T=g.x+y.right,E=p.y+m.bottom,v=p.y+m.top,D=g.y+y.bottom,O=g.y+y.top,P=Math.max(b,A),M=Math.min(C,T),L=Math.max(E,D),_=Math.min(v,O),S;if(P>=M||L>=v)S=1;else{let w=y;b<A&&C>T&&E<D&&v>O&&(w=m),S=1-(M-P)*(_-L)/((w.right-w.left)*(w.top-w.bottom))}S>t&&(e._changed.raiseEvent(S),e._changedPosition=h.clone(e.position,e._changedPosition),e._changedFrustum=e.frustum.clone(e._changedFrustum));return}if(!u(e._changedDirection)){e._changedPosition=h.clone(e.positionWC,e._changedPosition),e._changedDirection=h.clone(e.directionWC,e._changedDirection);return}let c=R.acosClamped(h.dot(e.directionWC,e._changedDirection)),l;u(e.frustum.fovy)?l=c/(e.frustum.fovy*.5):l=c;let d=h.distance(e.positionWC,e._changedPosition)/e.positionCartographic.height;(l>t||d>t)&&(e._changed.raiseEvent(Math.max(l,d)),e._changedPosition=h.clone(e.positionWC,e._changedPosition),e._changedDirection=h.clone(e.directionWC,e._changedDirection))};function Ldt(e){Lt.basisTo2D(e._projection,e._transform,e._actualTransform)}var Ndt=new de,Fdt=new h,fz=new h,Bdt=new oe,kdt=new oe,Vdt=new oe,Udt=new oe,zdt=new oe;function Hdt(e){let t=e._projection,n=t.ellipsoid,i=F.getColumn(e._transform,3,Bdt),o=n.cartesianToCartographic(i,Ndt),r=t.project(o,Fdt),s=kdt;s.x=r.z,s.y=r.x,s.z=r.y,s.w=1;let a=oe.clone(oe.UNIT_X,zdt),c=oe.add(F.getColumn(e._transform,0,fz),i,fz);n.cartesianToCartographic(c,o),t.project(o,r);let l=Vdt;l.x=r.z,l.y=r.x,l.z=r.y,l.w=0,h.subtract(l,s,l),l.x=0;let f=Udt;if(h.magnitudeSquared(l)>R.EPSILON10)h.cross(a,l,f);else{let d=oe.add(F.getColumn(e._transform,1,fz),i,fz);n.cartesianToCartographic(d,o),t.project(o,r),f.x=r.z,f.y=r.x,f.z=r.y,f.w=0,h.subtract(f,s,f),f.x=0,h.magnitudeSquared(f)<R.EPSILON10&&(oe.clone(oe.UNIT_Y,l),oe.clone(oe.UNIT_Z,f))}h.cross(f,a,l),h.normalize(l,l),h.cross(a,l,f),h.normalize(f,f),F.setColumn(e._actualTransform,0,l,e._actualTransform),F.setColumn(e._actualTransform,1,f,e._actualTransform),F.setColumn(e._actualTransform,2,a,e._actualTransform),F.setColumn(e._actualTransform,3,s,e._actualTransform)}var EK=new h;function mc(e){let t=e._mode,n=!1,i=0;t===ne.SCENE2D&&(i=e.frustum.right-e.frustum.left,n=i!==e._positionCartographic.height);let o=e._position,r=!h.equals(o,e.position)||n;r&&(o=h.clone(e.position,e._position));let s=e._direction,a=!h.equals(s,e.direction);a&&(h.normalize(e.direction,e.direction),s=h.clone(e.direction,e._direction));let c=e._up,l=!h.equals(c,e.up);l&&(h.normalize(e.up,e.up),c=h.clone(e.up,e._up));let f=e._right,d=!h.equals(f,e.right);d&&(h.normalize(e.right,e.right),f=h.clone(e.right,e._right));let p=e._transformChanged||e._modeChanged;e._transformChanged=!1,p&&(F.inverseTransformation(e._transform,e._invTransform),e._mode===ne.COLUMBUS_VIEW||e._mode===ne.SCENE2D?F.equals(F.IDENTITY,e._transform)?F.clone(Jt.TRANSFORM_2D,e._actualTransform):e._mode===ne.COLUMBUS_VIEW?Ldt(e):Hdt(e):F.clone(e._transform,e._actualTransform),F.inverseTransformation(e._actualTransform,e._actualInvTransform),e._modeChanged=!1);let g=e._actualTransform;if(r||p)if(e._positionWC=F.multiplyByPoint(g,o,e._positionWC),t===ne.SCENE3D||t===ne.MORPHING)e._positionCartographic=e._projection.ellipsoid.cartesianToCartographic(e._positionWC,e._positionCartographic);else{let m=EK;m.x=e._positionWC.y,m.y=e._positionWC.z,m.z=e._positionWC.x,t===ne.SCENE2D&&(m.z=i),e._projection.unproject(m,e._positionCartographic)}if(a||l||d){let m=h.dot(s,h.cross(c,f,EK));if(Math.abs(1-m)>R.EPSILON2){let y=1/h.magnitudeSquared(c),b=h.dot(c,s)*y,C=h.multiplyByScalar(s,b,EK);c=h.normalize(h.subtract(c,C,e._up),e._up),h.clone(c,e.up),f=h.cross(s,c,e._right),h.clone(f,e.right)}}(a||p)&&(e._directionWC=F.multiplyByPointAsVector(g,s,e._directionWC),h.normalize(e._directionWC,e._directionWC)),(l||p)&&(e._upWC=F.multiplyByPointAsVector(g,c,e._upWC),h.normalize(e._upWC,e._upWC)),(d||p)&&(e._rightWC=F.multiplyByPointAsVector(g,f,e._rightWC),h.normalize(e._rightWC,e._rightWC)),(r||a||l||d||p)&&fbe(e)}function dbe(e,t){let n;return R.equalsEpsilon(Math.abs(e.z),1,R.EPSILON3)?n=Math.atan2(t.y,t.x)-R.PI_OVER_TWO:n=Math.atan2(e.y,e.x)-R.PI_OVER_TWO,R.TWO_PI-R.zeroToTwoPi(n)}function hbe(e){return R.PI_OVER_TWO-R.acosClamped(e.z)}function mbe(e,t,n){let i=0;return R.equalsEpsilon(Math.abs(e.z),1,R.EPSILON3)||(i=Math.atan2(-n.z,t.z),i=R.zeroToTwoPi(i+R.TWO_PI)),i}var mz=new F,pz=new F;Object.defineProperties(Jt.prototype,{transform:{get:function(){return this._transform}},inverseTransform:{get:function(){return mc(this),this._invTransform}},viewMatrix:{get:function(){return mc(this),this._viewMatrix}},inverseViewMatrix:{get:function(){return mc(this),this._invViewMatrix}},positionCartographic:{get:function(){return mc(this),this._positionCartographic}},positionWC:{get:function(){return mc(this),this._positionWC}},directionWC:{get:function(){return mc(this),this._directionWC}},upWC:{get:function(){return mc(this),this._upWC}},rightWC:{get:function(){return mc(this),this._rightWC}},heading:{get:function(){if(this._mode!==ne.MORPHING){let e=this._projection.ellipsoid,t=F.clone(this._transform,mz),n=Lt.eastNorthUpToFixedFrame(this.positionWC,e,pz);this._setTransform(n);let i=dbe(this.direction,this.up);return this._setTransform(t),i}}},pitch:{get:function(){if(this._mode!==ne.MORPHING){let e=this._projection.ellipsoid,t=F.clone(this._transform,mz),n=Lt.eastNorthUpToFixedFrame(this.positionWC,e,pz);this._setTransform(n);let i=hbe(this.direction);return this._setTransform(t),i}}},roll:{get:function(){if(this._mode!==ne.MORPHING){let e=this._projection.ellipsoid,t=F.clone(this._transform,mz),n=Lt.eastNorthUpToFixedFrame(this.positionWC,e,pz);this._setTransform(n);let i=mbe(this.direction,this.up,this.right);return this._setTransform(t),i}}},moveStart:{get:function(){return this._moveStart}},moveEnd:{get:function(){return this._moveEnd}},changed:{get:function(){return this._changed}}});Jt.prototype.update=function(e){let t=!1;if(e!==this._mode&&(this._mode=e,this._modeChanged=e!==ne.MORPHING,t=this._mode===ne.SCENE2D),t){let n=this._max2Dfrustum=this.frustum.clone(),i=2,o=n.top/n.right;n.right=this._maxCoord.x*i,n.left=-n.right,n.top=o*n.right,n.bottom=-n.top}this._mode===ne.SCENE2D&&ybe(this,this.position)};var Gdt=new h,Wdt=new h,jdt=new h;Jt.prototype._setTransform=function(e){let t=h.clone(this.positionWC,Gdt),n=h.clone(this.upWC,Wdt),i=h.clone(this.directionWC,jdt);F.clone(e,this._transform),this._transformChanged=!0,mc(this);let o=this._actualInvTransform;F.multiplyByPoint(o,t,this.position),F.multiplyByPointAsVector(o,i,this.direction),F.multiplyByPointAsVector(o,n,this.up),h.cross(this.direction,this.up,this.right),mc(this)};var qdt=new H,Ydt=new _n,Xdt=new h,Kdt=new h;function pbe(e){if(!F.equals(F.IDENTITY,e.transform))return h.magnitude(e.position);let t=e._scene,n=t.globe,i=qdt;i.x=t.drawingBufferWidth/2,i.y=t.drawingBufferHeight/2;let o;if(u(n)){let a=e.getPickRay(i,Ydt);o=n.pickWorldCoordinates(a,t,!0,Xdt)}let r;t.pickPositionSupported&&(r=t.pickPositionWorldCoordinates(i,Kdt));let s;if(u(o)||u(r)){let a=u(r)?h.distance(r,e.positionWC):Number.POSITIVE_INFINITY,c=u(o)?h.distance(o,e.positionWC):Number.POSITIVE_INFINITY;s=Math.min(a,c)}else s=Math.max(e.positionCartographic.height,0);return s}Jt.prototype._adjustOrthographicFrustum=function(e){this.frustum instanceof sn&&(!e&&this._positionCartographic.height<15e4||(this.frustum.width=pbe(this)))};var _z=new h,IK=new F,Zdt=new F,PK=new Le,RK=new J,_be=new de;function $dt(e,t,n){let i=F.clone(e.transform,IK),o=Lt.eastNorthUpToFixedFrame(t,e._projection.ellipsoid,Zdt);e._setTransform(o),h.clone(h.ZERO,e.position),n.heading=n.heading-R.PI_OVER_TWO;let r=Le.fromHeadingPitchRoll(n,PK),s=J.fromQuaternion(r,RK);J.getColumn(s,0,e.direction),J.getColumn(s,2,e.up),h.cross(e.direction,e.up,e.right),e._setTransform(i),e._adjustOrthographicFrustum(!0)}function Qdt(e,t,n,i){let o=F.clone(e.transform,IK);if(e._setTransform(F.IDENTITY),!h.equals(t,e.positionWC)){if(i){let a=e._projection,c=a.ellipsoid.cartesianToCartographic(t,_be);t=a.project(c,_z)}h.clone(t,e.position)}n.heading=n.heading-R.PI_OVER_TWO;let r=Le.fromHeadingPitchRoll(n,PK),s=J.fromQuaternion(r,RK);J.getColumn(s,0,e.direction),J.getColumn(s,2,e.up),h.cross(e.direction,e.up,e.right),e._setTransform(o),e._adjustOrthographicFrustum(!0)}function Jdt(e,t,n,i){let o=F.clone(e.transform,IK);if(e._setTransform(F.IDENTITY),!h.equals(t,e.positionWC)){if(i){let c=e._projection,l=c.ellipsoid.cartesianToCartographic(t,_be);t=c.project(l,_z)}H.clone(t,e.position);let r=-t.z*.5,s=-r,a=e.frustum;if(s>r){let c=a.top/a.right;a.right=s,a.left=r,a.top=a.right*c,a.bottom=-a.top}}if(e._scene.mapMode2D===Mu.ROTATE){n.heading=n.heading-R.PI_OVER_TWO,n.pitch=-R.PI_OVER_TWO,n.roll=0;let r=Le.fromHeadingPitchRoll(n,PK),s=J.fromQuaternion(r,RK);J.getColumn(s,2,e.up),h.cross(e.direction,e.up,e.right)}e._setTransform(o)}var eht=new h,tht=new h,nht=new h;function gbe(e,t,n,i){let o=h.clone(n.direction,eht),r=h.clone(n.up,tht);if(e._scene.mode===ne.SCENE3D){let a=e._projection.ellipsoid,c=Lt.eastNorthUpToFixedFrame(t,a,mz),l=F.inverseTransformation(c,pz);F.multiplyByPointAsVector(l,o,o),F.multiplyByPointAsVector(l,r,r)}let s=h.cross(o,r,nht);return i.heading=dbe(o,r),i.pitch=hbe(o),i.roll=mbe(o,r,s),i}var DK={destination:void 0,orientation:{direction:void 0,up:void 0,heading:void 0,pitch:void 0,roll:void 0},convert:void 0,endTransform:void 0},$E=new Wa;Jt.prototype.setView=function(e){e=x(e,x.EMPTY_OBJECT);let t=x(e.orientation,x.EMPTY_OBJECT),n=this._mode;if(n===ne.MORPHING)return;u(e.endTransform)&&this._setTransform(e.endTransform);let i=x(e.convert,!0),o=x(e.destination,h.clone(this.positionWC,_z));u(o)&&u(o.west)&&(o=this.getRectangleCameraCoordinates(o,_z),i=!1),u(t.direction)&&(t=gbe(this,o,t,DK.orientation)),$E.heading=x(t.heading,0),$E.pitch=x(t.pitch,-R.PI_OVER_TWO),$E.roll=x(t.roll,0),n===ne.SCENE3D?$dt(this,o,$E):n===ne.SCENE2D?Jdt(this,o,$E,i):Qdt(this,o,$E,i)};var iht=new h;Jt.prototype.flyHome=function(e){let t=this._mode;if(t===ne.MORPHING&&this._scene.completeMorph(),t===ne.SCENE2D)this.flyTo({destination:Jt.DEFAULT_VIEW_RECTANGLE,duration:e,endTransform:F.IDENTITY});else if(t===ne.SCENE3D){let n=this.getRectangleCameraCoordinates(Jt.DEFAULT_VIEW_RECTANGLE),i=h.magnitude(n);i+=i*Jt.DEFAULT_VIEW_FACTOR,h.normalize(n,n),h.multiplyByScalar(n,i,n),this.flyTo({destination:n,duration:e,endTransform:F.IDENTITY})}else if(t===ne.COLUMBUS_VIEW){let n=this._projection.ellipsoid.maximumRadius,i=new h(0,-1,1);i=h.multiplyByScalar(h.normalize(i,i),5*n,i),this.flyTo({destination:i,duration:e,orientation:{heading:0,pitch:-Math.acos(h.normalize(i,iht).z),roll:0},endTransform:F.IDENTITY,convert:!1})}};Jt.prototype.worldToCameraCoordinates=function(e,t){return u(t)||(t=new oe),mc(this),F.multiplyByVector(this._actualInvTransform,e,t)};Jt.prototype.worldToCameraCoordinatesPoint=function(e,t){return u(t)||(t=new h),mc(this),F.multiplyByPoint(this._actualInvTransform,e,t)};Jt.prototype.worldToCameraCoordinatesVector=function(e,t){return u(t)||(t=new h),mc(this),F.multiplyByPointAsVector(this._actualInvTransform,e,t)};Jt.prototype.cameraToWorldCoordinates=function(e,t){return u(t)||(t=new oe),mc(this),F.multiplyByVector(this._actualTransform,e,t)};Jt.prototype.cameraToWorldCoordinatesPoint=function(e,t){return u(t)||(t=new h),mc(this),F.multiplyByPoint(this._actualTransform,e,t)};Jt.prototype.cameraToWorldCoordinatesVector=function(e,t){return u(t)||(t=new h),mc(this),F.multiplyByPointAsVector(this._actualTransform,e,t)};function ybe(e,t){let n=e._scene.mapMode2D===Mu.ROTATE,i=e._maxCoord.x,o=e._maxCoord.y,r,s;n?(s=i,r=-s):(s=t.x-i*2,r=t.x+i*2),t.x>i&&(t.x=s),t.x<-i&&(t.x=r),t.y>o&&(t.y=o),t.y<-o&&(t.y=-o)}var obe=new h;Jt.prototype.move=function(e,t){let n=this.position;h.multiplyByScalar(e,t,obe),h.add(n,obe,n),this._mode===ne.SCENE2D&&ybe(this,n),this._adjustOrthographicFrustum(!0)};Jt.prototype.moveForward=function(e){e=x(e,this.defaultMoveAmount),this._mode===ne.SCENE2D?gz(this,e):this.move(this.direction,e)};Jt.prototype.moveBackward=function(e){e=x(e,this.defaultMoveAmount),this._mode===ne.SCENE2D?gz(this,-e):this.move(this.direction,-e)};Jt.prototype.moveUp=function(e){e=x(e,this.defaultMoveAmount),this.move(this.up,e)};Jt.prototype.moveDown=function(e){e=x(e,this.defaultMoveAmount),this.move(this.up,-e)};Jt.prototype.moveRight=function(e){e=x(e,this.defaultMoveAmount),this.move(this.right,e)};Jt.prototype.moveLeft=function(e){e=x(e,this.defaultMoveAmount),this.move(this.right,-e)};Jt.prototype.lookLeft=function(e){e=x(e,this.defaultLookAmount),this._mode!==ne.SCENE2D&&this.look(this.up,-e)};Jt.prototype.lookRight=function(e){e=x(e,this.defaultLookAmount),this._mode!==ne.SCENE2D&&this.look(this.up,e)};Jt.prototype.lookUp=function(e){e=x(e,this.defaultLookAmount),this._mode!==ne.SCENE2D&&this.look(this.right,-e)};Jt.prototype.lookDown=function(e){e=x(e,this.defaultLookAmount),this._mode!==ne.SCENE2D&&this.look(this.right,e)};var oht=new Le,rht=new J;Jt.prototype.look=function(e,t){let n=x(t,this.defaultLookAmount),i=Le.fromAxisAngle(e,-n,oht),o=J.fromQuaternion(i,rht),r=this.direction,s=this.up,a=this.right;J.multiplyByVector(o,r,r),J.multiplyByVector(o,s,s),J.multiplyByVector(o,a,a)};Jt.prototype.twistLeft=function(e){e=x(e,this.defaultLookAmount),this.look(this.direction,e)};Jt.prototype.twistRight=function(e){e=x(e,this.defaultLookAmount),this.look(this.direction,-e)};var sht=new Le,aht=new J;Jt.prototype.rotate=function(e,t){let n=x(t,this.defaultRotateAmount),i=Le.fromAxisAngle(e,-n,sht),o=J.fromQuaternion(i,aht);J.multiplyByVector(o,this.position,this.position),J.multiplyByVector(o,this.direction,this.direction),J.multiplyByVector(o,this.up,this.up),h.cross(this.direction,this.up,this.right),h.cross(this.right,this.direction,this.up),this._adjustOrthographicFrustum(!1)};Jt.prototype.rotateDown=function(e){e=x(e,this.defaultRotateAmount),xbe(this,e)};Jt.prototype.rotateUp=function(e){e=x(e,this.defaultRotateAmount),xbe(this,-e)};var cht=new h,lht=new h,uht=new h,rbe=new h;function xbe(e,t){let n=e.position;if(u(e.constrainedAxis)&&!h.equalsEpsilon(e.position,h.ZERO,R.EPSILON2)){let i=h.normalize(n,cht),o=h.equalsEpsilon(i,e.constrainedAxis,R.EPSILON2),r=h.equalsEpsilon(i,h.negate(e.constrainedAxis,rbe),R.EPSILON2);if(!o&&!r){let s=h.normalize(e.constrainedAxis,lht),a=h.dot(i,s),c=R.acosClamped(a);t>0&&t>c&&(t=c-R.EPSILON4),a=h.dot(i,h.negate(s,rbe)),c=R.acosClamped(a),t<0&&-t>c&&(t=-c+R.EPSILON4);let l=h.cross(s,i,uht);e.rotate(l,t)}else(o&&t<0||r&&t>0)&&e.rotate(e.right,t)}else e.rotate(e.right,t)}Jt.prototype.rotateRight=function(e){e=x(e,this.defaultRotateAmount),bbe(this,-e)};Jt.prototype.rotateLeft=function(e){e=x(e,this.defaultRotateAmount),bbe(this,e)};function bbe(e,t){u(e.constrainedAxis)?e.rotate(e.constrainedAxis,t):e.rotate(e.up,t)}function gz(e,t){let n=e.frustum,i;if(t=t*.5,Math.abs(n.top)+Math.abs(n.bottom)>Math.abs(n.left)+Math.abs(n.right)){let o=n.top-t,r=n.bottom+t,s=e._maxCoord.y;e._scene.mapMode2D===Mu.ROTATE&&(s*=e.maximumZoomFactor),r>s&&(r=s,o=-s),o<=r&&(o=1,r=-1),i=n.right/n.top,n.top=o,n.bottom=r,n.right=n.top*i,n.left=-n.right}else{let o=n.right-t,r=n.left+t,s=e._maxCoord.x;e._scene.mapMode2D===Mu.ROTATE&&(s*=e.maximumZoomFactor),o>s&&(o=s,r=-s),o<=r&&(o=1,r=-1),i=n.top/n.right,n.right=o,n.left=r,n.top=n.right*i,n.bottom=-n.top}}function Cbe(e,t){e.move(e.direction,t)}Jt.prototype.zoomIn=function(e){e=x(e,this.defaultZoomAmount),this._mode===ne.SCENE2D?gz(this,e):Cbe(this,e)};Jt.prototype.zoomOut=function(e){e=x(e,this.defaultZoomAmount),this._mode===ne.SCENE2D?gz(this,-e):Cbe(this,-e)};Jt.prototype.getMagnitude=function(){if(this._mode===ne.SCENE3D)return h.magnitude(this.position);if(this._mode===ne.COLUMBUS_VIEW)return Math.abs(this.position.z);if(this._mode===ne.SCENE2D)return Math.max(this.frustum.right-this.frustum.left,this.frustum.top-this.frustum.bottom)};var fht=new F;Jt.prototype.lookAt=function(e,t){let n=this._scene,i=x(n.ellipsoid,ee.default),o=Lt.eastNorthUpToFixedFrame(e,i,fht);this.lookAtTransform(o,t)};var dht=new h,hht=new Le,mht=new Le,pht=new J;function Abe(e,t,n){t=R.clamp(t,-R.PI_OVER_TWO,R.PI_OVER_TWO),e=R.zeroToTwoPi(e)-R.PI_OVER_TWO;let i=Le.fromAxisAngle(h.UNIT_Y,-t,hht),o=Le.fromAxisAngle(h.UNIT_Z,-e,mht),r=Le.multiply(o,i,o),s=J.fromQuaternion(r,pht),a=h.clone(h.UNIT_X,dht);return J.multiplyByVector(s,a,a),h.negate(a,a),h.multiplyByScalar(a,n,a),a}Jt.prototype.lookAtTransform=function(e,t){if(this._setTransform(e),!u(t))return;let n;if(u(t.heading)?n=Abe(t.heading,t.pitch,t.range):n=t,this._mode===ne.SCENE2D){H.clone(H.ZERO,this.position),h.negate(n,this.up),this.up.z=0,h.magnitudeSquared(this.up)<R.EPSILON10&&h.clone(h.UNIT_Y,this.up),h.normalize(this.up,this.up),this._setTransform(F.IDENTITY),h.negate(h.UNIT_Z,this.direction),h.cross(this.direction,this.up,this.right),h.normalize(this.right,this.right);let i=this.frustum,o=i.top/i.right;i.right=h.magnitude(n)*.5,i.left=-i.right,i.top=o*i.right,i.bottom=-i.top,this._setTransform(e);return}h.clone(n,this.position),h.negate(this.position,this.direction),h.normalize(this.direction,this.direction),h.cross(this.direction,h.UNIT_Z,this.right),h.magnitudeSquared(this.right)<R.EPSILON10&&h.clone(h.UNIT_X,this.right),h.normalize(this.right,this.right),h.cross(this.right,this.direction,this.up),h.normalize(this.up,this.up),this._adjustOrthographicFrustum(!0)};var KD=new de,_ht=new de,ght=new h,yht=new h,xht=new h,bht=new h,Cht=new h,Aht=new h,Tht=new h,SK=new h,Eht={direction:new h,right:new h,up:new h},sbe;function hc(e,t,n,i){return Math.abs(h.dot(t,n))/i-h.dot(e,n)}function Tbe(e,t,n,i){let o=e._projection.ellipsoid,r=i?e:Eht,{north:s,south:a,west:c}=t,{east:l}=t;c>l&&(l+=R.TWO_PI);let f=(c+l)*.5,d;if(a<-R.PI_OVER_TWO+R.RADIANS_PER_DEGREE&&s>R.PI_OVER_TWO-R.RADIANS_PER_DEGREE)d=0;else{let M=KD;M.longitude=f,M.latitude=s,M.height=0;let L=_ht;L.longitude=f,L.latitude=a,L.height=0;let _=sbe;(!u(_)||_.ellipsoid!==o)&&(sbe=_=new Y_(void 0,void 0,o)),_.setEndPoints(M,L),d=_.interpolateUsingFraction(.5,KD).latitude}let p=KD;p.longitude=f,p.latitude=d,p.height=0;let g=o.cartographicToCartesian(p,Tht),m=KD;m.longitude=l,m.latitude=s;let y=o.cartographicToCartesian(m,ght);m.longitude=c;let b=o.cartographicToCartesian(m,xht);m.longitude=f;let C=o.cartographicToCartesian(m,Cht);m.latitude=a;let A=o.cartographicToCartesian(m,Aht);m.longitude=l;let T=o.cartographicToCartesian(m,bht);m.longitude=c;let E=o.cartographicToCartesian(m,yht);h.subtract(b,g,b),h.subtract(T,g,T),h.subtract(y,g,y),h.subtract(E,g,E),h.subtract(C,g,C),h.subtract(A,g,A);let v=o.geodeticSurfaceNormal(g,r.direction);h.negate(v,v);let D=h.cross(v,h.UNIT_Z,r.right);h.normalize(D,D);let O=h.cross(D,v,r.up),P;if(e.frustum instanceof sn){let M=Math.max(h.distance(y,b),h.distance(T,E)),L=Math.max(h.distance(y,T),h.distance(b,E)),_,S,w=e.frustum._offCenterFrustum,I=w.right/w.top,N=L*I;M>N?(_=M,S=_/I):(S=L,_=N),P=Math.max(_,S)}else{let M=Math.tan(e.frustum.fovy*.5),L=e.frustum.aspectRatio*M;if(P=Math.max(hc(v,O,b,M),hc(v,O,T,M),hc(v,O,y,M),hc(v,O,E,M),hc(v,O,C,M),hc(v,O,A,M),hc(v,D,b,L),hc(v,D,T,L),hc(v,D,y,L),hc(v,D,E,L),hc(v,D,C,L),hc(v,D,A,L)),a<0&&s>0){let _=KD;_.longitude=c,_.latitude=0,_.height=0;let S=o.cartographicToCartesian(_,SK);h.subtract(S,g,S),P=Math.max(P,hc(v,O,S,M),hc(v,D,S,L)),_.longitude=l,S=o.cartographicToCartesian(_,SK),h.subtract(S,g,S),P=Math.max(P,hc(v,O,S,M),hc(v,D,S,L))}}return h.add(g,h.multiplyByScalar(v,-P,SK),n)}var Sht=new de,vht=new h,wht=new h;function Dht(e,t,n){let i=e._projection;t.west>t.east&&(t=se.MAX_VALUE);let o=e._actualTransform,r=e._actualInvTransform,s=Sht;s.longitude=t.east,s.latitude=t.north;let a=i.project(s,vht);F.multiplyByPoint(o,a,a),F.multiplyByPoint(r,a,a),s.longitude=t.west,s.latitude=t.south;let c=i.project(s,wht);if(F.multiplyByPoint(o,c,c),F.multiplyByPoint(r,c,c),n.x=(a.x-c.x)*.5+c.x,n.y=(a.y-c.y)*.5+c.y,u(e.frustum.fovy)){let l=Math.tan(e.frustum.fovy*.5),f=e.frustum.aspectRatio*l;n.z=Math.max((a.x-c.x)/f,(a.y-c.y)/l)*.5}else{let l=a.x-c.x,f=a.y-c.y;n.z=Math.max(l,f)}return n}var Iht=new de,Pht=new h,Rht=new h;function Oht(e,t,n){let i=e._projection,o=t.east;t.west>t.east&&(e._scene.mapMode2D===Mu.INFINITE_SCROLL?o+=R.TWO_PI:(t=se.MAX_VALUE,o=t.east));let r=Iht;r.longitude=o,r.latitude=t.north;let s=i.project(r,Pht);r.longitude=t.west,r.latitude=t.south;let a=i.project(r,Rht),c=Math.abs(s.x-a.x)*.5,l=Math.abs(s.y-a.y)*.5,f,d,p=e.frustum.right/e.frustum.top,g=l*p;return c>g?(f=c,d=f/p):(d=l,f=g),l=Math.max(2*f,2*d),n.x=(s.x-a.x)*.5+a.x,n.y=(s.y-a.y)*.5+a.y,r=i.unproject(n,r),r.height=l,n=i.project(r,n),n}Jt.prototype.getRectangleCameraCoordinates=function(e,t){let n=this._mode;if(u(t)||(t=new h),n===ne.SCENE3D)return Tbe(this,e,t);if(n===ne.COLUMBUS_VIEW)return Dht(this,e,t);if(n===ne.SCENE2D)return Oht(this,e,t)};var Mht=new _n;function Lht(e,t,n,i){n=x(n,ee.default);let o=e.getPickRay(t,Mht),r=Qn.rayEllipsoid(o,n);if(!r)return;let s=r.start>0?r.start:r.stop;return _n.getPoint(o,s,i)}var Nht=new _n;function Fht(e,t,n,i){let r=e.getPickRay(t,Nht).origin;r=h.fromElements(r.y,r.z,0,r);let s=n.unproject(r);if(!(s.latitude<-R.PI_OVER_TWO||s.latitude>R.PI_OVER_TWO))return n.ellipsoid.cartographicToCartesian(s,i)}var Bht=new _n;function kht(e,t,n,i){let o=e.getPickRay(t,Bht),r=-o.origin.x/o.direction.x;_n.getPoint(o,r,i);let s=n.unproject(new h(i.y,i.z,0));if(!(s.latitude<-R.PI_OVER_TWO||s.latitude>R.PI_OVER_TWO||s.longitude<-Math.PI||s.longitude>Math.PI))return n.ellipsoid.cartographicToCartesian(s,i)}Jt.prototype.pickEllipsoid=function(e,t,n){let i=this._scene.canvas;if(!(i.clientWidth===0||i.clientHeight===0)){if(u(n)||(n=new h),t=x(t,ee.default),this._mode===ne.SCENE3D)n=Lht(this,e,t,n);else if(this._mode===ne.SCENE2D)n=Fht(this,e,this._projection,n);else if(this._mode===ne.COLUMBUS_VIEW)n=kht(this,e,this._projection,n);else return;return n}};var Vht=new h,Uht=new h,zht=new h;function Hht(e,t,n){let i=e._scene.canvas,o=i.clientWidth,r=i.clientHeight,s=Math.tan(e.frustum.fovy*.5),a=e.frustum.aspectRatio*s,c=e.frustum.near,l=2/o*t.x-1,f=2/r*(r-t.y)-1,d=e.positionWC;h.clone(d,n.origin);let p=h.multiplyByScalar(e.directionWC,c,Vht);h.add(d,p,p);let g=h.multiplyByScalar(e.rightWC,l*c*a,Uht),m=h.multiplyByScalar(e.upWC,f*c*s,zht),y=h.add(p,g,n.direction);return h.add(y,m,y),h.subtract(y,d,y),h.normalize(y,y),n}var dz=new h;function Ght(e,t,n){let i=e._scene.canvas,o=i.clientWidth,r=i.clientHeight,s=e.frustum,a=s.offCenterFrustum;u(a)&&(s=a);let c=2/o*t.x-1;c*=(s.right-s.left)*.5;let l=2/r*(r-t.y)-1;l*=(s.top-s.bottom)*.5;let f=n.origin;return h.clone(e.position,f),h.multiplyByScalar(e.right,c,dz),h.add(dz,f,f),h.multiplyByScalar(e.up,l,dz),h.add(dz,f,f),h.clone(e.directionWC,n.direction),(e._mode===ne.COLUMBUS_VIEW||e._mode===ne.SCENE2D)&&h.fromElements(n.origin.z,n.origin.x,n.origin.y,n.origin),n}Jt.prototype.getPickRay=function(e,t){u(t)||(t=new _n);let n=this._scene.canvas;if(n.clientWidth<=0||n.clientHeight<=0)return;let i=this.frustum;return u(i.aspectRatio)&&u(i.fov)&&u(i.near)?Hht(this,e,t):Ght(this,e,t)};var Wht=new h,jht=new h;Jt.prototype.distanceToBoundingSphere=function(e){let t=h.subtract(this.positionWC,e.center,Wht),n=h.multiplyByScalar(this.directionWC,h.dot(t,this.directionWC),jht);return Math.max(0,h.magnitude(n)-e.radius)};var qht=new H;Jt.prototype.getPixelSize=function(e,t,n){let i=this.distanceToBoundingSphere(e),o=this.frustum.getPixelDimensions(t,n,i,this._scene.pixelRatio,qht);return Math.max(o.x,o.y)};function Yht(e,t,n,i,o,r){let s=h.clone(t);n.y>i?s.y-=n.y-i:n.y<-i&&(s.y+=-i-n.y),n.z>o?s.z-=n.z-o:n.z<-o&&(s.z+=-o-n.z);function a(c){let l=h.lerp(t,s,c.time,new h);e.worldToCameraCoordinatesPoint(l,e.position)}return{easingFunction:Qr.EXPONENTIAL_OUT,startObject:{time:0},stopObject:{time:1},duration:r,update:a}}var Xht=new h,abe=new h,Kht=new h,Zht=new h;function $ht(e,t){let n=e.position,i=e.direction,o=e.worldToCameraCoordinatesVector(h.UNIT_X,Xht),r=-h.dot(o,n)/h.dot(o,i),s=h.add(n,h.multiplyByScalar(i,r,abe),abe);e.cameraToWorldCoordinatesPoint(s,s),n=e.cameraToWorldCoordinatesPoint(e.position,Kht);let a=Math.tan(e.frustum.fovy*.5),c=e.frustum.aspectRatio*a,l=h.magnitude(h.subtract(n,s,Zht)),f=c*l,d=a*l,p=e._maxCoord.x,g=e._maxCoord.y,m=Math.max(f-p,p),y=Math.max(d-g,g);if(n.z<-m||n.z>m||n.y<-y||n.y>y){let b=s.y<-m||s.y>m,C=s.z<-y||s.z>y;if(b||C)return Yht(e,n,s,m,y,t)}}Jt.prototype.createCorrectPositionTween=function(e){if(this._mode===ne.COLUMBUS_VIEW)return $ht(this,e)};var Qht=new h,Ys={destination:void 0,heading:void 0,pitch:void 0,roll:void 0,duration:void 0,complete:void 0,cancel:void 0,endTransform:void 0,maximumHeight:void 0,easingFunction:void 0};Jt.prototype.cancelFlight=function(){u(this._currentFlight)&&(this._currentFlight.cancelTween(),this._currentFlight=void 0)};Jt.prototype.completeFlight=function(){if(u(this._currentFlight)){this._currentFlight.cancelTween();let e={destination:void 0,orientation:{heading:void 0,pitch:void 0,roll:void 0}};e.destination=Ys.destination,e.orientation.heading=Ys.heading,e.orientation.pitch=Ys.pitch,e.orientation.roll=Ys.roll,this.setView(e),u(this._currentFlight.complete)&&this._currentFlight.complete(),this._currentFlight=void 0}};Jt.prototype.flyTo=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.destination;if(this._mode===ne.MORPHING)return;this.cancelFlight();let i=t instanceof se;i&&(t=this.getRectangleCameraCoordinates(t,Qht));let o=x(e.orientation,x.EMPTY_OBJECT);if(u(o.direction)&&(o=gbe(this,t,o,DK.orientation)),u(e.duration)&&e.duration<=0){let f=DK;f.destination=e.destination,f.orientation.heading=o.heading,f.orientation.pitch=o.pitch,f.orientation.roll=o.roll,f.convert=e.convert,f.endTransform=e.endTransform,this.setView(f),typeof e.complete=="function"&&e.complete();return}let r=this,s;Ys.destination=t,Ys.heading=o.heading,Ys.pitch=o.pitch,Ys.roll=o.roll,Ys.duration=e.duration,Ys.complete=function(){s===r._currentFlight&&(r._currentFlight=void 0),u(e.complete)&&e.complete()},Ys.cancel=e.cancel,Ys.endTransform=e.endTransform,Ys.convert=i?!1:e.convert,Ys.maximumHeight=e.maximumHeight,Ys.pitchAdjustHeight=e.pitchAdjustHeight,Ys.flyOverLongitude=e.flyOverLongitude,Ys.flyOverLongitudeWeight=e.flyOverLongitudeWeight,Ys.easingFunction=e.easingFunction;let a=this._scene,c=uz.createTween(a,Ys);if(c.duration===0){typeof c.complete=="function"&&c.complete();return}s=a.tweens.add(c),this._currentFlight=s;let l=this._scene.preloadFlightCamera;this._mode!==ne.SCENE2D&&(u(l)||(l=Jt.clone(this)),l.setView({destination:t,orientation:o}),this._scene.preloadFlightCullingVolume=l.frustum.computeCullingVolume(l.positionWC,l.directionWC,l.upWC))};function Jht(e,t){let n=e.frustum,i=Math.tan(n.fovy*.5),o=n.aspectRatio*i;return Math.max(t/o,t/i)}function emt(e,t){let n=e.frustum,i=n.offCenterFrustum;u(i)&&(n=i);let o,r,s=n.right/n.top,a=t*s;return t>a?(o=t,r=o/s):(r=t,o=a),Math.max(o,r)*1.5}var tmt=100;function Ebe(e,t,n){n=Yd.clone(u(n)?n:Jt.DEFAULT_OFFSET);let i=e._scene.screenSpaceCameraController.minimumZoomDistance,o=e._scene.screenSpaceCameraController.maximumZoomDistance,r=n.range;if(!u(r)||r===0){let s=t.radius;s===0?n.range=tmt:e.frustum instanceof sn||e._mode===ne.SCENE2D?n.range=emt(e,s):n.range=Jht(e,s),n.range=R.clamp(n.range,i,o)}return n}Jt.prototype.viewBoundingSphere=function(e,t){t=Ebe(this,e,t),this.lookAt(e.center,t)};var nmt=new F,imt=new h,omt=new h,rmt=new h,smt=new h,amt=new oe,cmt=new Le,lmt=new J;Jt.prototype.flyToBoundingSphere=function(e,t){t=x(t,x.EMPTY_OBJECT);let n=this._mode===ne.SCENE2D||this._mode===ne.COLUMBUS_VIEW;this._setTransform(F.IDENTITY);let i=Ebe(this,e,t.offset),o;n?o=h.multiplyByScalar(h.UNIT_Z,i.range,imt):o=Abe(i.heading,i.pitch,i.range);let r=this._scene,s=x(r.ellipsoid,ee.default),a=Lt.eastNorthUpToFixedFrame(e.center,s,nmt);F.multiplyByPoint(a,o,o);let c,l;if(!n){if(c=h.subtract(e.center,o,omt),h.normalize(c,c),l=F.multiplyByPointAsVector(a,h.UNIT_Z,rmt),1-Math.abs(h.dot(c,l))<R.EPSILON6){let d=Le.fromAxisAngle(c,i.heading,cmt),p=J.fromQuaternion(d,lmt);h.fromCartesian4(F.getColumn(a,1,amt),l),J.multiplyByVector(p,l,l)}let f=h.cross(c,l,smt);h.cross(f,c,l),h.normalize(l,l)}this.flyTo({destination:o,orientation:{direction:c,up:l},duration:t.duration,complete:t.complete,cancel:t.cancel,endTransform:t.endTransform,maximumHeight:t.maximumHeight,easingFunction:t.easingFunction,flyOverLongitude:t.flyOverLongitude,flyOverLongitudeWeight:t.flyOverLongitudeWeight,pitchAdjustHeight:t.pitchAdjustHeight})};var cbe=new h,lbe=new h,vK=new h,ube=new h,ZD=[new h,new h,new h,new h];function umt(e,t){let n=t.radii,i=e.positionWC,o=h.multiplyComponents(t.oneOverRadii,i,cbe),r=h.magnitude(o),s=h.normalize(o,lbe),a,c;h.equalsEpsilon(s,h.UNIT_Z,R.EPSILON10)?(a=new h(0,1,0),c=new h(0,0,1)):(a=h.normalize(h.cross(h.UNIT_Z,s,vK),vK),c=h.normalize(h.cross(s,a,ube),ube));let l=Math.sqrt(h.magnitudeSquared(o)-1),f=h.multiplyByScalar(s,1/r,cbe),d=l/r,p=h.multiplyByScalar(a,d,lbe),g=h.multiplyByScalar(c,d,vK),m=h.add(f,g,ZD[0]);h.subtract(m,p,m),h.multiplyComponents(n,m,m);let y=h.subtract(f,g,ZD[1]);h.subtract(y,p,y),h.multiplyComponents(n,y,y);let b=h.subtract(f,g,ZD[2]);h.add(b,p,b),h.multiplyComponents(n,b,b);let C=h.add(f,g,ZD[3]);return h.add(C,p,C),h.multiplyComponents(n,C,C),ZD}var wK=new H,fmt=new h,oy=[new de,new de,new de,new de];function hz(e,t,n,i,o,r){wK.x=e,wK.y=t;let s=i.pickEllipsoid(wK,o,fmt);return u(s)?(oy[n]=o.cartesianToCartographic(s,oy[n]),1):(oy[n]=o.cartesianToCartographic(r[n],oy[n]),0)}Jt.prototype.computeViewRectangle=function(e,t){e=x(e,ee.default);let n=this.frustum.computeCullingVolume(this.positionWC,this.directionWC,this.upWC),i=new ae(h.ZERO,e.maximumRadius);if(n.computeVisibility(i)===qt.OUTSIDE)return;let r=this._scene.canvas,s=r.clientWidth,a=r.clientHeight,c=0,l=umt(this,e);if(c+=hz(0,0,0,this,e,l),c+=hz(0,a,1,this,e,l),c+=hz(s,a,2,this,e,l),c+=hz(s,0,3,this,e,l),c<2)return se.MAX_VALUE;t=se.fromCartographicArray(oy,t);let f=0,d=oy[3].longitude;for(let p=0;p<4;++p){let g=oy[p].longitude,m=Math.abs(g-d);m>R.PI?f+=R.TWO_PI-m:f+=m,d=g}return R.equalsEpsilon(Math.abs(f),R.TWO_PI,R.EPSILON9)&&(t.west=-R.PI,t.east=R.PI,oy[0].latitude>=0?t.north=R.PI_OVER_TWO:t.south=-R.PI_OVER_TWO),t};Jt.prototype.switchToPerspectiveFrustum=function(){if(this._mode===ne.SCENE2D||this.frustum instanceof Ri)return;let e=this._scene;this.frustum=new Ri,this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight,this.frustum.fov=R.toRadians(60)};Jt.prototype.switchToOrthographicFrustum=function(){if(this._mode===ne.SCENE2D||this.frustum instanceof sn)return;let e=pbe(this),t=this._scene;this.frustum=new sn,this.frustum.aspectRatio=t.drawingBufferWidth/t.drawingBufferHeight,this.frustum.width=e};Jt.clone=function(e,t){return u(t)||(t=new Jt(e._scene)),h.clone(e.position,t.position),h.clone(e.direction,t.direction),h.clone(e.up,t.up),h.clone(e.right,t.right),F.clone(e._transform,t.transform),t._transformChanged=!0,t.frustum=e.frustum.clone(),t};var uo=Jt;function dmt(e){this.pass=e.pass,this.commandList=e.commandList,this.camera=e.camera,this.cullingVolume=e.cullingVolume,this.ready=!1}var lh=dmt;var Ibe=Dr(Gl(),1),Sbe=576,hmt=100,$D="#ffffff",yz="#48b";function Pbe(e,t){this.credit=e,this.count=x(t,1)}function mmt(e,t){let n=e.length;for(let i=0;i<n;i++){let o=e[i];if(wt.equals(o,t))return!0}return!1}function pmt(e){let t=e._previousCesiumCredit,n=e._currentCesiumCredit;wt.equals(n,t)||(u(t)&&e._cesiumCreditContainer.removeChild(t.element),u(n)&&e._cesiumCreditContainer.appendChild(n.element),e._previousCesiumCredit=n)}var Rbe="cesium-credit-delimiter";function vbe(e){let t=document.createElement("span");return t.textContent=e,t.className=Rbe,t}function wbe(e,t){if(u(t)){let n=document.createElement(t);n._creditId=e._creditId,n.appendChild(e),e=n}return e}function Dbe(e,t,n,i){let o=e.childNodes,r=-1;t.sort(function(s,a){return a.count-s.count});for(let s=0;s<t.length;++s){let a=t[s].credit;if(u(a)){if(r=s,u(n)&&(r*=2,s>0)){let l=r-1;if(o.length<=l)e.appendChild(vbe(n));else{let f=o[l];f.className!==Rbe&&e.replaceChild(vbe(n),f)}}let c=a.element;if(o.length<=r)e.appendChild(wbe(c,i));else{let l=o[r];l._creditId!==a._id&&e.replaceChild(wbe(c,i),l)}}}for(++r;r<o.length;)e.removeChild(o[r])}function _mt(e){let t=e._lightboxCredits,n=e.viewport.clientWidth,i=e.viewport.clientHeight;n!==e._lastViewportWidth&&(n<Sbe?(t.className="cesium-credit-lightbox cesium-credit-lightbox-mobile",t.style.marginTop="0"):(t.className="cesium-credit-lightbox cesium-credit-lightbox-expanded",t.style.marginTop=`${Math.floor((i-t.clientHeight)*.5)}px`),e._lastViewportWidth=n),n>=Sbe&&i!==e._lastViewportHeight&&(t.style.marginTop=`${Math.floor((i-t.clientHeight)*.5)}px`,e._lastViewportHeight=i)}function gmt(e){let t=`
.cesium-credit-lightbox-overlay {
  display: none;
  z-index: 1;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(80, 80, 80, 0.8);
}

.cesium-credit-lightbox {
  background-color: #303336;
  color: ${$D};
  position: relative;
  min-height: ${hmt}px;
  margin: auto;
}
.cesium-credit-lightbox > ul > li a,
.cesium-credit-lightbox > ul > li a:visited,
.cesium-credit-wrapper a,
.cesium-credit-wrapper a:visited {
  color: ${$D};
}
.cesium-credit-lightbox > ul > li a:hover {
  color: ${yz};
}
.cesium-credit-lightbox.cesium-credit-lightbox-expanded {
  border: 1px solid #444;
  border-radius: 5px;
  max-width: 370px;
}
.cesium-credit-lightbox.cesium-credit-lightbox-mobile {
  height: 100%;
  width: 100%;
}
.cesium-credit-lightbox-title {
  padding: 20px 20px 0 20px;
}
.cesium-credit-lightbox-close {
  font-size: 18pt;
  cursor: pointer;
  position: absolute;
  top: 0;
  right: 6px;
  color: ${$D};
}
.cesium-credit-lightbox-close:hover {
  color: ${yz};
}
.cesium-credit-lightbox > ul {
  margin: 0;
  padding: 12px 20px 12px 40px;
  font-size: 13px;
}
.cesium-credit-lightbox > ul > li {
  padding-bottom: 6px;
}
.cesium-credit-lightbox > ul > li * {
  padding: 0;
  margin: 0;
}

.cesium-credit-expand-link {
  padding-left: 5px;
  cursor: pointer;
  text-decoration: underline;
  color: ${$D};
}
.cesium-credit-expand-link:hover {
  color: ${yz};
}

.cesium-credit-text {
  color: ${$D};
}

.cesium-credit-delimiter {
  padding: 0 5px;
}

.cesium-credit-textContainer *,
.cesium-credit-logoContainer * {
  display: inline;
}

.cesium-credit-textContainer a:hover {
  color: ${yz}
}

.cesium-credit-textContainer .cesium-credit-wrapper:first-of-type {
  padding-left: 5px;
}
`;function n(r){if(r.shadowRoot)return r.shadowRoot;if(r.getRootNode){let s=r.getRootNode();if(s instanceof ShadowRoot)return s}}let i=x(n(e),document.head),o=document.createElement("style");o.innerHTML=t,i.appendChild(o)}function fr(e,t,n){let i=this;n=x(n,document.body);let o=document.createElement("div");o.className="cesium-credit-lightbox-overlay",n.appendChild(o);let r=document.createElement("div");r.className="cesium-credit-lightbox",o.appendChild(r);function s(m){r.contains(m.target)||i.hideLightbox()}o.addEventListener("click",s,!1);let a=document.createElement("div");a.className="cesium-credit-lightbox-title",a.textContent="Data provided by:",r.appendChild(a);let c=document.createElement("a");c.onclick=this.hideLightbox.bind(this),c.innerHTML="&times;",c.className="cesium-credit-lightbox-close",r.appendChild(c);let l=document.createElement("ul");r.appendChild(l);let f=document.createElement("div");f.className="cesium-credit-logoContainer",f.style.display="inline",e.appendChild(f);let d=document.createElement("div");d.className="cesium-credit-textContainer",d.style.display="inline",e.appendChild(d);let p=document.createElement("a");p.className="cesium-credit-expand-link",p.onclick=this.showLightbox.bind(this),p.textContent="Data attribution",e.appendChild(p),gmt(e);let g=wt.clone(fr.cesiumCredit);this._delimiter=x(t,"\u2022"),this._screenContainer=d,this._cesiumCreditContainer=f,this._lastViewportHeight=void 0,this._lastViewportWidth=void 0,this._lightboxCredits=r,this._creditList=l,this._lightbox=o,this._hideLightbox=s,this._expandLink=p,this._expanded=!1,this._staticCredits=[],this._cesiumCredit=g,this._previousCesiumCredit=void 0,this._currentCesiumCredit=g,this._creditDisplayElementPool=[],this._creditDisplayElementIndex=0,this._currentFrameCredits={screenCredits:new St,lightboxCredits:new St},this._defaultCredit=void 0,this.viewport=n,this.container=e}function Obe(e,t,n,i){i=x(i,1);let o=t.get(n.id);if(u(o))o.count<Number.MAX_VALUE&&(o.count+=i);else{let r=e._creditDisplayElementPool,s=e._creditDisplayElementPoolIndex;s<r.length?(o=r[s],o.credit=n,o.count=i):(o=new Pbe(n,i),r.push(o)),++e._creditDisplayElementPoolIndex,t.set(n.id,o)}}fr.prototype.addCreditToNextFrame=function(e){if(e.isIon()){u(this._defaultCredit)||(this._defaultCredit=wt.clone(Mbe())),this._currentCesiumCredit=this._defaultCredit;return}let t;e.showOnScreen?t=this._currentFrameCredits.screenCredits:t=this._currentFrameCredits.lightboxCredits,Obe(this,t,e)};fr.prototype.addStaticCredit=function(e){let t=this._staticCredits;mmt(t,e)||t.push(e)};fr.prototype.removeStaticCredit=function(e){let t=this._staticCredits,n=t.indexOf(e);n!==-1&&t.splice(n,1)};fr.prototype.showLightbox=function(){this._lightbox.style.display="block",this._expanded=!0};fr.prototype.hideLightbox=function(){this._lightbox.style.display="none",this._expanded=!1};fr.prototype.update=function(){this._expanded&&_mt(this)};fr.prototype.beginFrame=function(){let e=this._currentFrameCredits;this._creditDisplayElementPoolIndex=0;let t=e.screenCredits,n=e.lightboxCredits;t.removeAll(),n.removeAll();let i=this._staticCredits;for(let o=0;o<i.length;++o){let r=i[o],s=r.showOnScreen?t:n;r.isIon()&&wt.equals(fr.cesiumCredit,this._cesiumCredit)||Obe(this,s,r,Number.MAX_VALUE)}wt.equals(fr.cesiumCredit,this._cesiumCredit)||(this._cesiumCredit=wt.clone(fr.cesiumCredit)),this._currentCesiumCredit=this._cesiumCredit};fr.prototype.endFrame=function(){let e=this._currentFrameCredits.screenCredits.values;Dbe(this._screenContainer,e,this._delimiter,void 0);let t=this._currentFrameCredits.lightboxCredits.values;this._expandLink.style.display=t.length>0?"inline":"none",Dbe(this._creditList,t,void 0,"li"),pmt(this)};fr.prototype.destroy=function(){return this._lightbox.removeEventListener("click",this._hideLightbox,!1),this.container.removeChild(this._cesiumCreditContainer),this.container.removeChild(this._screenContainer),this.container.removeChild(this._expandLink),this.viewport.removeChild(this._lightbox),ue(this)};fr.prototype.isDestroyed=function(){return!1};fr._cesiumCredit=void 0;fr._cesiumCreditInitialized=!1;var xz;function Mbe(){if(!u(xz)){let e=on("Assets/Images/ion-credit.png");e.indexOf("http://")!==0&&e.indexOf("https://")!==0&&e.indexOf("data:")!==0&&(e=new Ibe.default(e).path()),xz=new wt(`<a href="https://cesium.com/" target="_blank"><img src="${e}" style="vertical-align: -7px" title="Cesium ion"/></a>`,!0)}return fr._cesiumCreditInitialized||(fr._cesiumCredit=xz,fr._cesiumCreditInitialized=!0),xz}Object.defineProperties(fr,{cesiumCredit:{get:function(){return Mbe(),fr._cesiumCredit},set:function(e){fr._cesiumCredit=e,fr._cesiumCreditInitialized=!0}}});fr.CreditDisplayElement=Pbe;var bz=fr;function Cz(e){e=x(e,x.EMPTY_OBJECT),this._camera=e.camera,this._frustumSplits=e.frustumSplits,this._color=x(e.color,G.CYAN),this._updateOnChange=x(e.updateOnChange,!0),this.show=x(e.show,!0),this.id=e.id,this._id=void 0,this._outlinePrimitives=[],this._planesPrimitives=[]}var ymt=new h,xmt=new J,bmt=new Le,Cmt=new Ri,Amt=new Ll,Tmt=new sn,Emt=new Gr,Smt=new G,vmt=[1,1e5];Cz.prototype.update=function(e){if(!this.show)return;let t=this._planesPrimitives,n=this._outlinePrimitives,i,o;if(this._updateOnChange){for(o=t.length,i=0;i<o;++i)n[i]=n[i]&&n[i].destroy(),t[i]=t[i]&&t[i].destroy();t.length=0,n.length=0}if(t.length===0){let r=this._camera,s=r.frustum,a;s instanceof Ri?a=Cmt:s instanceof Ll?a=Amt:s instanceof sn?a=Tmt:a=Emt,a=s.clone(a);let c,l=this._frustumSplits;!u(l)||l.length<=1?(l=vmt,l[0]=this._camera.frustum.near,l[1]=this._camera.frustum.far,c=1):c=l.length-1;let f=r.positionWC,d=r.directionWC,p=r.upWC,g=r.rightWC;g=h.negate(g,ymt);let m=xmt;J.setColumn(m,0,g,m),J.setColumn(m,1,p,m),J.setColumn(m,2,d,m);let y=Le.fromRotationMatrix(m,bmt);for(t.length=n.length=c,i=0;i<c;++i)a.near=l[i],a.far=l[i+1],t[i]=new In({geometryInstances:new vt({geometry:new OE({origin:f,orientation:y,frustum:a,_drawNearPlane:i===0}),attributes:{color:jt.fromColor(G.fromAlpha(this._color,.1,Smt))},id:this.id,pickPrimitive:this}),appearance:new ln({translucent:!0,flat:!0}),asynchronous:!1}),n[i]=new In({geometryInstances:new vt({geometry:new qV({origin:f,orientation:y,frustum:a,_drawNearPlane:i===0}),attributes:{color:jt.fromColor(this._color)},id:this.id,pickPrimitive:this}),appearance:new ln({translucent:!1,flat:!0}),asynchronous:!1})}for(o=t.length,i=0;i<o;++i)n[i].update(e),t[i].update(e)};Cz.prototype.isDestroyed=function(){return!1};Cz.prototype.destroy=function(){let e=this._planesPrimitives.length;for(let t=0;t<e;++t)this._outlinePrimitives[t]=this._outlinePrimitives[t]&&this._outlinePrimitives[t].destroy(),this._planesPrimitives[t]=this._planesPrimitives[t]&&this._planesPrimitives[t].destroy();return ue(this)};var p_=Cz;var Az=`in vec4 positionEC;

void main()
{
    vec3 position;
    vec3 direction;
    if (czm_orthographicIn3D == 1.0)
    {
        vec2 uv = (gl_FragCoord.xy -  czm_viewport.xy) / czm_viewport.zw;
        vec2 minPlane = vec2(czm_frustumPlanes.z, czm_frustumPlanes.y); // left, bottom
        vec2 maxPlane = vec2(czm_frustumPlanes.w, czm_frustumPlanes.x); // right, top
        position = vec3(mix(minPlane, maxPlane, uv), 0.0);
        direction = vec3(0.0, 0.0, -1.0);
    } 
    else 
    {
        position = vec3(0.0);
        direction = normalize(positionEC.xyz);
    }

    czm_ray ray = czm_ray(position, direction);

    vec3 ellipsoid_center = czm_view[3].xyz;

    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid_center, czm_ellipsoidInverseRadii);
    if (!czm_isEmpty(intersection))
    {
        out_FragColor = vec4(1.0, 1.0, 0.0, 1.0);
    }
    else
    {
        discard;
    }

    czm_writeLogDepth();
}
`;var Tz=`in vec4 position;

out vec4 positionEC;

void main()
{
    positionEC = czm_modelView * position;
    gl_Position = czm_modelViewProjection * position;

    czm_vertexLogDepth();
}
`;function JD(e){this._rs=void 0,this._sp=void 0,this._va=void 0,this._command=void 0,this._mode=void 0,this._useLogDepth=!1,this._ellipsoidOffset=x(e,0)}var QD=Wt.supportsTypedArrays()?new Float32Array(12):[],Lbe=new h,Nbe=new h,OK=new h,Fbe=new h,Ez=new h;function wmt(e,t){let n=e.radii,i=t.camera,o,r,s;if(i.frustum instanceof sn)o=h.ZERO,r=i.rightWC,s=i.upWC;else{let d=i.positionWC,p=h.multiplyComponents(e.oneOverRadii,d,Lbe),g=h.normalize(p,Nbe),m=h.normalize(h.cross(h.UNIT_Z,p,OK),OK),y=h.normalize(h.cross(g,m,Fbe),Fbe),b=h.magnitude(p),C=Math.sqrt(b*b-1);o=h.multiplyByScalar(g,1/b,Lbe);let A=C/b;r=h.multiplyByScalar(m,A,Nbe),s=h.multiplyByScalar(y,A,OK)}let a=h.add(o,s,Ez);h.subtract(a,r,a),h.multiplyComponents(n,a,a),h.pack(a,QD,0);let c=h.subtract(o,s,Ez);h.subtract(c,r,c),h.multiplyComponents(n,c,c),h.pack(c,QD,3);let l=h.add(o,s,Ez);h.add(l,r,l),h.multiplyComponents(n,l,l),h.pack(l,QD,6);let f=h.subtract(o,s,Ez);return h.add(f,r,f),h.multiplyComponents(n,f,f),h.pack(f,QD,9),QD}JD.prototype.update=function(e){if(this._mode=e.mode,e.mode!==ne.SCENE3D)return;let t=e.context,n=e.mapProjection.ellipsoid.radii,i=new ee(n.x+this._ellipsoidOffset,n.y+this._ellipsoidOffset,n.z+this._ellipsoidOffset),o=e.useLogDepth;if(u(this._command)||(this._rs=Ue.fromCache({cull:{enabled:!0},depthTest:{enabled:!0},colorMask:{red:!1,green:!1,blue:!1,alpha:!1}}),this._command=new Qe({renderState:this._rs,boundingVolume:new ae(h.ZERO,i.maximumRadius),pass:we.OPAQUE,owner:this})),!u(this._sp)||this._useLogDepth!==o){this._useLogDepth=o;let s=new ze({sources:[Tz]}),a=new ze({sources:[Az]});o&&(a.defines.push("LOG_DEPTH"),s.defines.push("LOG_DEPTH")),this._sp=tn.replaceCache({shaderProgram:this._sp,context:t,vertexShaderSource:s,fragmentShaderSource:a,attributeLocations:{position:0}}),this._command.shaderProgram=this._sp}let r=wmt(i,e);if(u(this._va))this._va.getAttribute(0).vertexBuffer.copyFromArrayView(r);else{let s=new ft({attributes:{position:new ve({componentDatatype:K.FLOAT,componentsPerAttribute:3,values:r})},indices:[0,1,2,2,1,3],primitiveType:Ne.TRIANGLES});this._va=ii.fromGeometry({context:t,geometry:s,attributeLocations:{position:0},bufferUsage:ke.DYNAMIC_DRAW}),this._command.vertexArray=this._va}};JD.prototype.execute=function(e,t){this._mode===ne.SCENE3D&&this._command.execute(e,t)};JD.prototype.isDestroyed=function(){return!1};JD.prototype.destroy=function(){this._sp=this._sp&&this._sp.destroy(),this._va=this._va&&this._va.destroy()};var Sz=JD;function JE(){}var Dmt=/\bgl_FragDepth\b/,Imt=/\bdiscard\b/;function Pmt(e,t){let n=e.shaderCache.getDerivedShaderProgram(t,"depthOnly");if(u(n))return n;let i=t.fragmentShaderSource,o=!1,r=i.sources;for(let a=0;a<r.length;++a)if(Dmt.test(r[a])||Imt.test(r[a])){o=!0;break}let s=i.defines.indexOf("LOG_DEPTH")>=0;if(!o&&!s){let a=`void main()
{
    out_FragColor = vec4(1.0);
}
`;i=new ze({sources:[a]})}else if(!o&&s){let a=`void main()
{
    out_FragColor = vec4(1.0);
    czm_writeLogDepth();
}
`;i=new ze({defines:["LOG_DEPTH"],sources:[a]})}return e.shaderCache.createDerivedShaderProgram(t,"depthOnly",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:i,attributeLocations:t._attributeLocations})}function Rmt(e,t){let n=e._depthOnlyRenderStateCache,i=n[t.id];if(u(i))return i;let o=Ue.getState(t);o.depthMask=!0,o.colorMask={red:!1,green:!1,blue:!1,alpha:!1};let r=Ue.fromCache(o);return n[t.id]=r,r}JE.createDepthOnlyDerivedCommand=function(e,t,n,i){u(i)||(i={});let o=i.depthOnlyCommand?.shaderProgram,r=i.depthOnlyCommand?.renderState;return i.depthOnlyCommand=Qe.shallowClone(t,i.depthOnlyCommand),!u(o)||i.shaderProgramId!==t.shaderProgram.id?(i.depthOnlyCommand.shaderProgram=Pmt(n,t.shaderProgram),i.depthOnlyCommand.renderState=Rmt(e,t.renderState),i.shaderProgramId=t.shaderProgram.id):(i.depthOnlyCommand.shaderProgram=o,i.depthOnlyCommand.renderState=r),i};var Omt=/\s+czm_writeLogDepth\(/,Mmt=/\s+czm_vertexLogDepth\(/;function Lmt(e,t){if(t.fragmentShaderSource.defines.indexOf("LOG_DEPTH_READ_ONLY")>=0)return t;let i=e.shaderCache.getDerivedShaderProgram(t,"logDepth");if(u(i))return i;let o=t._attributeLocations,r=t.vertexShaderSource.clone(),s=t.fragmentShaderSource.clone();r.defines=u(r.defines)?r.defines.slice(0):[],r.defines.push("LOG_DEPTH"),s.defines=u(s.defines)?s.defines.slice(0):[],s.defines.push("LOG_DEPTH");let a=!1,c=r.sources;for(let f=0;f<c.length;++f)if(Mmt.test(c[f])){a=!0;break}if(!a){for(let d=0;d<c.length;++d)c[d]=ze.replaceMain(c[d],"czm_log_depth_main");c.push(`

void main()
{
    czm_log_depth_main();
    czm_vertexLogDepth();
}
`)}c=s.sources,a=!1;for(let f=0;f<c.length;++f)Omt.test(c[f])&&(a=!0);s.defines.indexOf("LOG_DEPTH_WRITE")!==-1&&(a=!0);let l="";if(!a){for(let f=0;f<c.length;f++)c[f]=ze.replaceMain(c[f],"czm_log_depth_main");l=`
void main()
{
    czm_log_depth_main();
    czm_writeLogDepth();
}
`}return c.push(l),e.shaderCache.createDerivedShaderProgram(t,"logDepth",{vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:o})}JE.createLogDepthCommand=function(e,t,n){u(n)||(n={});let i=n.command?.shaderProgram;return n.command=Qe.shallowClone(e,n.command),!u(i)||n.shaderProgramId!==e.shaderProgram.id?(n.command.shaderProgram=Lmt(t,e.shaderProgram),n.shaderProgramId=e.shaderProgram.id):n.command.shaderProgram=i,n};function Nmt(e,t,n){let i=e.shaderCache.getDerivedShaderProgram(t,"pick");if(u(i))return i;let o=t._attributeLocations,{sources:r,defines:s}=t.fragmentShaderSource,c=r.some(g=>g.includes("out_FragData"))?"out_FragData_0":"out_FragColor",l=`void main () 
{ 
    czm_non_pick_main(); 
    if (${c}.a == 0.0) { 
        discard; 
    } 
    ${c} = ${n}; 
} `,f=r.length,d=new Array(f+1);for(let g=0;g<f;++g)d[g]=ze.replaceMain(r[g],"czm_non_pick_main");d[f]=l;let p=new ze({sources:d,defines:s});return e.shaderCache.createDerivedShaderProgram(t,"pick",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:p,attributeLocations:o})}function Bbe(e,t){let n=e.picking.pickRenderStateCache,i=n[t.id];if(u(i))return i;let o=Ue.getState(t);o.blending.enabled=!1,o.depthMask=!0;let r=Ue.fromCache(o);return n[t.id]=r,r}JE.createPickDerivedCommand=function(e,t,n,i){u(i)||(i={});let o=i.pickCommand?.shaderProgram,r=i.pickCommand?.renderState;return i.pickCommand=Qe.shallowClone(t,i.pickCommand),!u(o)||i.shaderProgramId!==t.shaderProgram.id?(i.pickCommand.shaderProgram=Nmt(n,t.shaderProgram,t.pickId),i.pickCommand.renderState=Bbe(e,t.renderState),i.shaderProgramId=t.shaderProgram.id):(i.pickCommand.shaderProgram=o,i.pickCommand.renderState=r),i};function QE(e,t,n){let i=e.length;for(let o=0;o<i;o++)e[o].trimStart().split(/\s+/)[0]===t&&(e[o]=`${t} ${n}`)}function kbe(e){return e.isArray?e.arrayLength:Et.getComponentCount(e.type)}function Fmt(e){let t=kbe(e);return e.normalized?t===1?"float":`vec${t}`:t===1?"int":`ivec${t}`}function Bmt(e,t,n){let i=n.schemaId,o=n.className,r=n.propertyName,s=`pickMetadata-${i}-${o}-${r}`,a=e.shaderCache.getDerivedShaderProgram(t,s);if(u(a))return a;let c=n.classProperty,l=Fmt(c),f=["0.0","0.0","0.0","0.0"],d=kbe(c);if(d===1)f[0]="float(value)";else{let y=["x","y","z","w"];for(let b=0;b<d;b++){let A=`value.${y[b]}`;f[b]=`float(${A})`}}if(!c.normalized)for(let y=0;y<d;y++)f[y]+=" / 255.0";let p=t.fragmentShaderSource.defines.slice();p.push(_f.METADATA_PICKING_ENABLED),QE(p,_f.METADATA_PICKING_VALUE_TYPE,l),QE(p,_f.METADATA_PICKING_VALUE_STRING,`metadata.${r}`),QE(p,_f.METADATA_PICKING_VALUE_COMPONENT_X,f[0]),QE(p,_f.METADATA_PICKING_VALUE_COMPONENT_Y,f[1]),QE(p,_f.METADATA_PICKING_VALUE_COMPONENT_Z,f[2]),QE(p,_f.METADATA_PICKING_VALUE_COMPONENT_W,f[3]);let g=new ze({sources:t.fragmentShaderSource.sources,defines:p});return e.shaderCache.createDerivedShaderProgram(t,s,{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:g,attributeLocations:t._attributeLocations})}JE.createPickMetadataDerivedCommand=function(e,t,n,i){return u(i)||(i={}),i.pickMetadataCommand=Qe.shallowClone(t,i.pickMetadataCommand),i.pickMetadataCommand.shaderProgram=Bmt(n,t.shaderProgram,t.pickedMetadataInfo),i.pickMetadataCommand.renderState=Bbe(e,t.renderState),i.shaderProgramId=t.shaderProgram.id,i};function kmt(e,t){let n=e.shaderCache.getDerivedShaderProgram(t,"HDR");if(u(n))return n;let i=t._attributeLocations,o=t.vertexShaderSource.clone(),r=t.fragmentShaderSource.clone();return o.defines=u(o.defines)?o.defines.slice(0):[],o.defines.push("HDR"),r.defines=u(r.defines)?r.defines.slice(0):[],r.defines.push("HDR"),e.shaderCache.createDerivedShaderProgram(t,"HDR",{vertexShaderSource:o,fragmentShaderSource:r,attributeLocations:i})}JE.createHdrCommand=function(e,t,n){u(n)||(n={});let i=n.command?.shaderProgram;return n.command=Qe.shallowClone(e,n.command),!u(i)||n.shaderProgramId!==e.shaderProgram.id?(n.command.shaderProgram=kmt(t,e.shaderProgram),n.shaderProgramId=e.shaderProgram.id):n.command.shaderProgram=i,n};var __=JE;function vz(e){this._scene=e,this._lastAlpha=void 0,this._lastBeta=void 0,this._lastGamma=void 0,this._alpha=void 0,this._beta=void 0,this._gamma=void 0;let t=this;function n(i){let o=i.alpha;if(!u(o)){t._alpha=void 0,t._beta=void 0,t._gamma=void 0;return}t._alpha=R.toRadians(o),t._beta=R.toRadians(i.beta),t._gamma=R.toRadians(i.gamma)}window.addEventListener("deviceorientation",n,!1),this._removeListener=function(){window.removeEventListener("deviceorientation",n,!1)}}var Vmt=new Le,Vbe=new Le,Umt=new J;function zmt(e,t,n,i){let o=e.direction,r=e.right,s=e.up,a=Le.fromAxisAngle(o,n,Vbe),c=Le.fromAxisAngle(r,i,Vmt),l=Le.multiply(c,a,c),f=Le.fromAxisAngle(s,t,Vbe);Le.multiply(f,l,l);let d=J.fromQuaternion(l,Umt);J.multiplyByVector(d,r,r),J.multiplyByVector(d,s,s),J.multiplyByVector(d,o,o)}vz.prototype.update=function(){if(!u(this._alpha))return;u(this._lastAlpha)||(this._lastAlpha=this._alpha,this._lastBeta=this._beta,this._lastGamma=this._gamma);let e=this._lastAlpha-this._alpha,t=this._lastBeta-this._beta,n=this._lastGamma-this._gamma;zmt(this._scene.camera,-e,t,n),this._lastAlpha=this._alpha,this._lastBeta=this._beta,this._lastGamma=this._gamma};vz.prototype.isDestroyed=function(){return!1};vz.prototype.destroy=function(){return this._removeListener(),ue(this)};var wz=vz;function MK(){this.enabled=!0,this.renderable=!0,this.density=6e-4,this.heightScalar=.001,this._heightFalloff=.59,this.maxHeight=8e5,this.visualDensityScalar=.15,this.screenSpaceErrorFactor=2,this.minimumBrightness=.03}Object.defineProperties(MK.prototype,{heightFalloff:{get:function(){return this._heightFalloff},set:function(e){this._heightFalloff=e}}});var Hmt=new h;MK.prototype.update=function(e){if(!(e.fog.enabled=this.enabled))return;e.fog.renderable=this.renderable;let n=e.camera,i=n.positionCartographic;if(!u(i)||i.height>this.maxHeight||e.mode!==ne.SCENE3D){e.fog.enabled=!1,e.fog.density=0;return}let o=i.height,r=this.density*this.heightScalar*Math.pow(Math.max(o/this.maxHeight,R.EPSILON4),-Math.max(this._heightFalloff,0)),s=h.normalize(n.positionWC,Hmt),a=Math.abs(h.dot(n.directionWC,s));r*=1-a,e.fog.density=r,e.fog.visualDensityScalar=this.visualDensityScalar,e.fog.sse=this.screenSpaceErrorFactor,e.fog.minimumBrightness=this.minimumBrightness};var Dz=MK;function Gmt(e,t,n){this.context=e,this.commandList=[],this.shadowMaps=[],this.brdfLutGenerator=void 0,this.environmentMap=void 0,this.sphericalHarmonicCoefficients=void 0,this.specularEnvironmentMaps=void 0,this.specularEnvironmentMapsMaximumLOD=void 0,this.mode=ne.SCENE3D,this.morphTime=ne.getMorphTime(ne.SCENE3D),this.frameNumber=0,this.newFrame=!1,this.time=void 0,this.jobScheduler=n,this.mapProjection=void 0,this.camera=void 0,this.cameraUnderground=!1,this.globeTranslucencyState=void 0,this.cullingVolume=void 0,this.occluder=void 0,this.maximumScreenSpaceError=void 0,this.pixelRatio=1,this.passes={render:!1,pick:!1,pickVoxel:!1,depth:!1,postProcess:!1,offscreen:!1},this.creditDisplay=t,this.afterRender=[],this.scene3DOnly=!1,this.fog={enabled:!1,renderable:!1,density:void 0,visualDensityScalar:void 0,sse:void 0,minimumBrightness:void 0},this.atmosphere=void 0,this.verticalExaggeration=1,this.verticalExaggerationRelativeHeight=0,this.shadowState={shadowsEnabled:!0,shadowMaps:[],lightShadowMaps:[],nearPlane:1,farPlane:5e3,closestObjectSize:1e3,lastDirtyTime:0,outOfView:!0},this.splitPosition=0,this.frustumSplits=[],this.backgroundColor=void 0,this.light=void 0,this.minimumDisableDepthTestDistance=void 0,this.invertClassification=!1,this.invertClassificationColor=void 0,this.useLogDepth=!1,this.tilesetPassState=void 0,this.minimumTerrainHeight=0,this.pickingMetadata=!1,this.pickedMetadataInfo=void 0}var Iz=Gmt;var ya={OPAQUE_FRONT_FACE:0,OPAQUE_BACK_FACE:1,DEPTH_ONLY_FRONT_FACE:2,DEPTH_ONLY_BACK_FACE:3,DEPTH_ONLY_FRONT_AND_BACK_FACE:4,TRANSLUCENT_FRONT_FACE:5,TRANSLUCENT_BACK_FACE:6,TRANSLUCENT_FRONT_FACE_MANUAL_DEPTH_TEST:7,TRANSLUCENT_BACK_FACE_MANUAL_DEPTH_TEST:8,PICK_FRONT_FACE:9,PICK_BACK_FACE:10,DERIVED_COMMANDS_MAXIMUM_LENGTH:11},xb=ya.DERIVED_COMMANDS_MAXIMUM_LENGTH,Kbe=["opaqueFrontFaceCommand","opaqueBackFaceCommand","depthOnlyFrontFaceCommand","depthOnlyBackFaceCommand","depthOnlyFrontAndBackFaceCommand","translucentFrontFaceCommand","translucentBackFaceCommand","translucentFrontFaceManualDepthTestCommand","translucentBackFaceManualDepthTestCommand","pickFrontFaceCommand","pickBackFaceCommand"];function bb(){this._frontFaceAlphaByDistance=new kt(0,1,0,1),this._backFaceAlphaByDistance=new kt(0,1,0,1),this._frontFaceTranslucent=!1,this._backFaceTranslucent=!1,this._requiresManualDepthTest=!1,this._sunVisibleThroughGlobe=!1,this._environmentVisible=!1,this._useDepthPlane=!1,this._numberOfTextureUniforms=0,this._globeTranslucencyFramebuffer=void 0,this._rectangle=se.clone(se.MAX_VALUE),this._derivedCommandKey=0,this._derivedCommandsDirty=!1,this._derivedCommandPacks=void 0,this._derivedCommandTypes=new Array(xb),this._derivedBlendCommandTypes=new Array(xb),this._derivedPickCommandTypes=new Array(xb),this._derivedCommandTypesToUpdate=new Array(xb),this._derivedCommandsLength=0,this._derivedBlendCommandsLength=0,this._derivedPickCommandsLength=0,this._derivedCommandsToUpdateLength=0}Object.defineProperties(bb.prototype,{frontFaceAlphaByDistance:{get:function(){return this._frontFaceAlphaByDistance}},backFaceAlphaByDistance:{get:function(){return this._backFaceAlphaByDistance}},translucent:{get:function(){return this._frontFaceTranslucent}},sunVisibleThroughGlobe:{get:function(){return this._sunVisibleThroughGlobe}},environmentVisible:{get:function(){return this._environmentVisible}},useDepthPlane:{get:function(){return this._useDepthPlane}},numberOfTextureUniforms:{get:function(){return this._numberOfTextureUniforms}},rectangle:{get:function(){return this._rectangle}}});bb.prototype.update=function(e){let t=e.globe;if(!u(t)||!t.show){this._frontFaceTranslucent=!1,this._backFaceTranslucent=!1,this._sunVisibleThroughGlobe=!0,this._environmentVisible=!0,this._useDepthPlane=!1;return}this._frontFaceAlphaByDistance=Ube(t.translucency.enabled,t.translucency.frontFaceAlpha,t.translucency.frontFaceAlphaByDistance,this._frontFaceAlphaByDistance),this._backFaceAlphaByDistance=Ube(t.translucency.enabled,t.translucency.backFaceAlpha,t.translucency.backFaceAlphaByDistance,this._backFaceAlphaByDistance),this._frontFaceTranslucent=zbe(t.translucency.enabled,this._frontFaceAlphaByDistance,t),this._backFaceTranslucent=zbe(t.translucency.enabled,this._backFaceAlphaByDistance,t),this._requiresManualDepthTest=Ymt(this,e,t),this._sunVisibleThroughGlobe=Wmt(this,e),this._environmentVisible=jmt(this,e),this._useDepthPlane=qmt(this,e),this._numberOfTextureUniforms=Xmt(this),this._rectangle=se.clone(t.translucency.rectangle,this._rectangle),Kmt(this,e)};function Ube(e,t,n,i){return e?u(n)?(kt.clone(n,i),i.nearValue*=t,i.farValue*=t,i):(i.nearValue=t,i.farValue=t,i):(i.nearValue=1,i.farValue=1,i)}function zbe(e,t,n){return e&&(n.baseColor.alpha<1||t.nearValue<1||t.farValue<1)}function Wmt(e,t){let n=e._frontFaceTranslucent,i=e._backFaceTranslucent;return n&&(t.cameraUnderground||i)}function jmt(e,t){return!t.cameraUnderground||e._frontFaceTranslucent}function qmt(e,t){return!t.cameraUnderground&&!e._frontFaceTranslucent}function Ymt(e,t,n){return e._frontFaceTranslucent&&!e._backFaceTranslucent&&!n.depthTestAgainstTerrain&&t.mode!==ne.SCENE2D&&t.context.depthTexture}function Xmt(e){let t=0;return e._frontFaceTranslucent&&++t,e._requiresManualDepthTest&&++t,t}function Kmt(e,t){e._derivedCommandsLength=LK(e,t,!1,!1,e._derivedCommandTypes),e._derivedBlendCommandsLength=LK(e,t,!0,!1,e._derivedBlendCommandTypes),e._derivedPickCommandsLength=LK(e,t,!1,!0,e._derivedPickCommandTypes);let n,i=0;for(n=0;n<e._derivedCommandsLength;++n)i|=1<<e._derivedCommandTypes[n];for(n=0;n<e._derivedBlendCommandsLength;++n)i|=1<<e._derivedBlendCommandTypes[n];for(n=0;n<e._derivedPickCommandsLength;++n)i|=1<<e._derivedPickCommandTypes[n];let o=0;for(n=0;n<xb;++n)(i&1<<n)>0&&(e._derivedCommandTypesToUpdate[o++]=n);e._derivedCommandsToUpdateLength=o;let r=i!==e._derivedCommandKey;e._derivedCommandKey=i,e._derivedCommandsDirty=r,!u(e._derivedCommandPacks)&&e._frontFaceTranslucent&&(e._derivedCommandPacks=upt())}function LK(e,t,n,i,o){let r=0,s=e._frontFaceTranslucent,a=e._backFaceTranslucent;if(!s)return r;let c=t.cameraUnderground,l=e._requiresManualDepthTest,f=i?ya.PICK_FRONT_FACE:l?ya.TRANSLUCENT_FRONT_FACE_MANUAL_DEPTH_TEST:ya.TRANSLUCENT_FRONT_FACE,d=i?ya.PICK_BACK_FACE:l?ya.TRANSLUCENT_BACK_FACE_MANUAL_DEPTH_TEST:ya.TRANSLUCENT_BACK_FACE;return t.mode===ne.SCENE2D?(o[r++]=ya.DEPTH_ONLY_FRONT_FACE,o[r++]=f,r):(a?(n||(o[r++]=ya.DEPTH_ONLY_FRONT_AND_BACK_FACE),c?(o[r++]=f,o[r++]=d):(o[r++]=d,o[r++]=f)):c?(n||(o[r++]=ya.DEPTH_ONLY_BACK_FACE),o[r++]=ya.OPAQUE_FRONT_FACE,o[r++]=d):(n||(o[r++]=ya.DEPTH_ONLY_FRONT_FACE),o[r++]=ya.OPAQUE_BACK_FACE,o[r++]=f),r)}function Xf(e,t){let n=e.indexOf(t);n>-1&&e.splice(n,1)}function Hbe(e,t){return e.indexOf(t)>-1}function Zmt(e,t){Xf(e.defines,"TRANSLUCENT"),Xf(t.defines,"TRANSLUCENT")}function $mt(e,t){Xf(e.defines,"GROUND_ATMOSPHERE"),Xf(t.defines,"GROUND_ATMOSPHERE"),Xf(e.defines,"FOG"),Xf(t.defines,"FOG"),Xf(e.defines,"TRANSLUCENT"),Xf(t.defines,"TRANSLUCENT")}function NK(e,t){if(Hbe(t.defines,"TILE_LIMIT_RECTANGLE")||Hbe(t.defines,"ENABLE_CLIPPING_PLANES"))return;let n=`void main() 
{ 
    out_FragColor = vec4(1.0); 
} 
`;t.sources=[n]}function FK(e,t){let n=t.sources,i=n.length;for(let r=0;r<i;++r)n[r]=ze.replaceMain(n[r],"czm_globe_translucency_main");n.push(`

uniform sampler2D u_classificationTexture; 
void main() 
{ 
    vec2 st = gl_FragCoord.xy / czm_viewport.zw; 
#ifdef MANUAL_DEPTH_TEST 
    float logDepthOrDepth = czm_unpackDepth(texture(czm_globeDepthTexture, st)); 
    if (logDepthOrDepth != 0.0) 
    { 
        vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth); 
        float depthEC = eyeCoordinate.z / eyeCoordinate.w; 
        if (v_positionEC.z < depthEC) 
        { 
            discard; 
        } 
    } 
#endif 
    czm_globe_translucency_main(); 
    vec4 classificationColor = texture(u_classificationTexture, st); 
    if (classificationColor.a > 0.0) 
    { 
        // Reverse premultiplication process to get the correct composited result of the classification primitives 
        classificationColor.rgb /= classificationColor.a; 
    } 
    out_FragColor = classificationColor * vec4(classificationColor.aaa, 1.0) + out_FragColor * (1.0 - classificationColor.a); 
} 
`)}function Zbe(e,t){FK(e,t),Xf(e.defines,"GROUND_ATMOSPHERE"),Xf(t.defines,"GROUND_ATMOSPHERE"),Xf(e.defines,"FOG"),Xf(t.defines,"FOG")}function Qmt(e,t){FK(e,t),e.defines.push("GENERATE_POSITION"),t.defines.push("MANUAL_DEPTH_TEST")}function Jmt(e,t){Zbe(e,t),e.defines.push("GENERATE_POSITION"),t.defines.push("MANUAL_DEPTH_TEST")}function Gbe(e,t){let n=`uniform sampler2D u_classificationTexture; 
void main() 
{ 
    vec2 st = gl_FragCoord.xy / czm_viewport.zw; 
    vec4 pickColor = texture(u_classificationTexture, st); 
    if (pickColor == vec4(0.0)) 
    { 
        discard; 
    } 
    out_FragColor = pickColor; 
} 
`;t.sources=[n]}function ept(e,t,n,i,o,r){if(!u(o))return t;if(!i&&u(n))return n;let s=e.shaderCache.getDerivedShaderProgram(t,r);if(!u(s)){let a=t._attributeLocations,c=t.vertexShaderSource.clone(),l=t.fragmentShaderSource.clone();c.defines=u(c.defines)?c.defines.slice(0):[],l.defines=u(l.defines)?l.defines.slice(0):[],o(c,l),s=e.shaderCache.createDerivedShaderProgram(t,r,{vertexShaderSource:c,fragmentShaderSource:l,attributeLocations:a})}return s}function tpt(e){e.cull.face=Ci.BACK,e.cull.enabled=!0}function npt(e){e.cull.face=Ci.FRONT,e.cull.enabled=!0}function ipt(e){e.cull.face=Ci.BACK,e.cull.enabled=!0,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function opt(e){e.cull.face=Ci.FRONT,e.cull.enabled=!0,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function rpt(e){e.cull.enabled=!1,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function Wbe(e){e.cull.face=Ci.BACK,e.cull.enabled=!0,e.depthMask=!1,e.blending=un.ALPHA_BLEND}function jbe(e){e.cull.face=Ci.FRONT,e.cull.enabled=!0,e.depthMask=!1,e.blending=un.ALPHA_BLEND}function spt(e){e.cull.face=Ci.BACK,e.cull.enabled=!0,e.blending.enabled=!1}function apt(e){e.cull.face=Ci.FRONT,e.cull.enabled=!0,e.blending.enabled=!1}function cpt(e,t,n,i,o){if(!u(i))return e;if(!n&&u(t))return t;let r=o[e.id];if(!u(r)){let s=Ue.getState(e);i(s),r=Ue.fromCache(s),o[e.id]=r}return r}function eS(e){return{u_classificationTexture:function(){return e._globeTranslucencyFramebuffer.classificationTexture}}}function lpt(e,t,n,i,o){return u(o)?!i&&u(n)?n:bt(t,o(e),!1):t}function uh(e){this.pass=e.pass,this.pickOnly=e.pickOnly,this.getShaderProgramFunction=e.getShaderProgramFunction,this.getRenderStateFunction=e.getRenderStateFunction,this.getUniformMapFunction=e.getUniformMapFunction,this.renderStateCache={}}function upt(){return[new uh({pass:we.GLOBE,pickOnly:!1,getShaderProgramFunction:Zmt,getRenderStateFunction:tpt,getUniformMapFunction:void 0}),new uh({pass:we.GLOBE,pickOnly:!1,getShaderProgramFunction:$mt,getRenderStateFunction:npt,getUniformMapFunction:void 0}),new uh({pass:we.GLOBE,pickOnly:!1,getShaderProgramFunction:NK,getRenderStateFunction:ipt,getUniformMapFunction:void 0}),new uh({pass:we.GLOBE,pickOnly:!1,getShaderProgramFunction:NK,getRenderStateFunction:opt,getUniformMapFunction:void 0}),new uh({pass:we.GLOBE,pickOnly:!1,getShaderProgramFunction:NK,getRenderStateFunction:rpt,getUniformMapFunction:void 0}),new uh({pass:we.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:FK,getRenderStateFunction:Wbe,getUniformMapFunction:eS}),new uh({pass:we.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:Zbe,getRenderStateFunction:jbe,getUniformMapFunction:eS}),new uh({pass:we.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:Qmt,getRenderStateFunction:Wbe,getUniformMapFunction:eS}),new uh({pass:we.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:Jmt,getRenderStateFunction:jbe,getUniformMapFunction:eS}),new uh({pass:we.TRANSLUCENT,pickOnly:!0,getShaderProgramFunction:Gbe,getRenderStateFunction:spt,getUniformMapFunction:eS}),new uh({pass:we.TRANSLUCENT,pickOnly:!0,getShaderProgramFunction:Gbe,getRenderStateFunction:apt,getUniformMapFunction:eS})]}var qbe=new Array(xb),Ybe=new Array(xb);bb.prototype.updateDerivedCommands=function(e,t){let n=this._derivedCommandTypesToUpdate,i=this._derivedCommandsToUpdateLength;if(i!==0){for(let o=0;o<i;++o)Ybe[o]=this._derivedCommandPacks[n[o]],qbe[o]=Kbe[n[o]];fpt(this,e,i,n,qbe,Ybe,t)}};function fpt(e,t,n,i,o,r,s){let a=t.derivedCommands.globeTranslucency,c=e._derivedCommandsDirty;if(t.dirty||!u(a)||c){t.dirty=!1,u(a)||(a={},t.derivedCommands.globeTranslucency=a);let l=s.frameNumber,f=x(a.uniformMapDirtyFrame,0),d=x(a.shaderProgramDirtyFrame,0),p=x(a.renderStateDirtyFrame,0),g=a.uniformMap!==t.uniformMap,m=a.shaderProgramId!==t.shaderProgram.id,y=a.renderStateId!==t.renderState.id;g&&(a.uniformMapDirtyFrame=l),m&&(a.shaderProgramDirtyFrame=l),y&&(a.renderStateDirtyFrame=l),a.uniformMap=t.uniformMap,a.shaderProgramId=t.shaderProgram.id,a.renderStateId=t.renderState.id;for(let b=0;b<n;++b){let C=r[b],A=i[b],T=o[b],E=a[T],v,D,O;u(E)?(v=E.uniformMap,D=E.shaderProgram,O=E.renderState):(v=void 0,D=void 0,O=void 0),E=Qe.shallowClone(t,E),a[T]=E;let P=x(E.derivedCommands.uniformMapDirtyFrame,0),M=x(E.derivedCommands.shaderProgramDirtyFrame,0),L=x(E.derivedCommands.renderStateDirtyFrame,0),_=g||P<f,S=m||M<d,w=y||L<p;_&&(E.derivedCommands.uniformMapDirtyFrame=l),S&&(E.derivedCommands.shaderProgramDirtyFrame=l),w&&(E.derivedCommands.renderStateDirtyFrame=l),E.derivedCommands.type=A,E.pass=C.pass,E.pickOnly=C.pickOnly,E.uniformMap=lpt(e,t.uniformMap,v,_,C.getUniformMapFunction),E.shaderProgram=ept(s.context,t.shaderProgram,D,S,C.getShaderProgramFunction,T),E.renderState=cpt(t.renderState,O,w,C.getRenderStateFunction,C.renderStateCache)}}}bb.prototype.pushDerivedCommands=function(e,t,n){let i=n.passes.pick||n.passes.pickVoxel;if(i&&t)return;let o=this._derivedCommandTypes,r=this._derivedCommandsLength;if(i?(o=this._derivedPickCommandTypes,r=this._derivedPickCommandsLength):t&&(o=this._derivedBlendCommandTypes,r=this._derivedBlendCommandsLength),r===0){n.commandList.push(e);return}let s=e.derivedCommands.globeTranslucency;for(let a=0;a<r;++a){let c=Kbe[o[a]];n.commandList.push(s[c])}};function $be(e,t,n,i,o,r){for(let s=0;s<t;++s){let a=e[s],c=a.derivedCommands.type;(!u(r)||r.indexOf(c)>-1)&&n(a,i,o)}}function Xbe(e,t,n,i,o){for(let r=0;r<t;++r)n(e[r],i,o)}var dpt=[ya.OPAQUE_FRONT_FACE,ya.OPAQUE_BACK_FACE],hpt=[ya.DEPTH_ONLY_FRONT_FACE,ya.DEPTH_ONLY_BACK_FACE,ya.DEPTH_ONLY_FRONT_AND_BACK_FACE];bb.prototype.executeGlobeCommands=function(e,t,n,i,o){let r=i.context,s=e.commands[we.GLOBE],a=e.indices[we.GLOBE];a!==0&&(this._globeTranslucencyFramebuffer=n,n.clearClassification(r,o),$be(s,a,t,i,o,dpt))};bb.prototype.executeGlobeClassificationCommands=function(e,t,n,i,o){let{context:r}=i,{uniformState:s}=r,a=e.commands[we.GLOBE],c=e.indices[we.GLOBE],l=e.commands[we.TERRAIN_CLASSIFICATION],f=e.indices[we.TERRAIN_CLASSIFICATION];if(c===0||f===0)return;let d=this._frontFaceTranslucent,p=this._backFaceTranslucent;if((!d||!p)&&Xbe(l,f,t,i,o),!d&&!p)return;this._globeTranslucencyFramebuffer=n;let g=s.globeDepthTexture,m=o.framebuffer;if(o.framebuffer=n.classificationFramebuffer,$be(a,c,t,i,o,hpt),r.depthTexture){let y=n.packDepth(r,o);s.globeDepthTexture=y}Xbe(l,f,t,i,o),s.globeDepthTexture=g,o.framebuffer=m};var Pz=bb;var Lu=`uniform sampler2D colorTexture;

in vec2 v_textureCoordinates;

void main()
{
    out_FragColor = texture(colorTexture, v_textureCoordinates);
}
`;function Bm(){this._numSamples=1,this.previousFramebuffer=void 0,this._previousFramebuffer=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this._fbo=new pi({depthStencil:!0,createDepthAttachments:!1}),this._fboClassified=new pi({depthStencil:!0,createDepthAttachments:!1}),this._rsUnclassified=void 0,this._rsClassified=void 0,this._unclassifiedCommand=void 0,this._classifiedCommand=void 0,this._translucentCommand=void 0,this._clearColorCommand=new ni({color:new G(0,0,0,0),owner:this}),this._clearCommand=new ni({color:new G(0,0,0,0),depth:1,stencil:0});let e=this;this._uniformMap={colorTexture:function(){return e._fbo.getColorTexture()},depthTexture:function(){return e._depthStencilTexture},classifiedTexture:function(){return e._fboClassified.getColorTexture()}}}Object.defineProperties(Bm.prototype,{unclassifiedCommand:{get:function(){return this._unclassifiedCommand}}});Bm.isTranslucencySupported=function(e){return e.depthTexture&&e.fragmentDepth};var mpt={depthMask:!1,stencilTest:{enabled:!0,frontFunction:Un.EQUAL,frontOperation:{fail:mt.KEEP,zFail:mt.KEEP,zPass:mt.KEEP},backFunction:Un.NEVER,reference:0,mask:Ut.CLASSIFICATION_MASK},blending:un.ALPHA_BLEND},ppt={depthMask:!1,stencilTest:{enabled:!0,frontFunction:Un.NOT_EQUAL,frontOperation:{fail:mt.KEEP,zFail:mt.KEEP,zPass:mt.KEEP},backFunction:Un.NEVER,reference:0,mask:Ut.CLASSIFICATION_MASK},blending:un.ALPHA_BLEND},_pt={depthMask:!0,depthTest:{enabled:!0},stencilTest:Ut.setCesium3DTileBit(),stencilMask:Ut.CESIUM_3D_TILE_MASK,blending:un.ALPHA_BLEND},gpt=`uniform sampler2D colorTexture;
uniform sampler2D depthTexture;
uniform sampler2D classifiedTexture;
in vec2 v_textureCoordinates;
void main()
{
    vec4 color = texture(colorTexture, v_textureCoordinates);
    if (color.a == 0.0)
    {
        discard;
    }
    bool isClassified = all(equal(texture(classifiedTexture, v_textureCoordinates), vec4(0.0)));
#ifdef UNCLASSIFIED
    vec4 highlightColor = czm_invertClassificationColor;
    if (isClassified)
    {
        discard;
    }
#else
    vec4 highlightColor = vec4(1.0);
    if (!isClassified)
    {
        discard;
    }
#endif
    out_FragColor = color * highlightColor;
    gl_FragDepth = texture(depthTexture, v_textureCoordinates).r;
}
`,ypt=`uniform sampler2D colorTexture;
in vec2 v_textureCoordinates;
void main()
{
    vec4 color = texture(colorTexture, v_textureCoordinates);
    if (color.a == 0.0)
    {
        discard;
    }
#ifdef UNCLASSIFIED
    out_FragColor = color * czm_invertClassificationColor;
#else
    out_FragColor = color;
#endif
}
`;Bm.prototype.update=function(e,t,n){let i=this._fbo.getColorTexture(),o=this.previousFramebuffer!==this._previousFramebuffer;this._previousFramebuffer=this.previousFramebuffer;let r=this._numSamples!==t,s=e.drawingBufferWidth,a=e.drawingBufferHeight,c=!u(i)||i.width!==s||i.height!==a;if((c||o||r)&&(this._numSamples=t,this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy(),u(this._previousFramebuffer)||(this._depthStencilTexture=new Ot({context:e,width:s,height:a,pixelFormat:tt.DEPTH_STENCIL,pixelDatatype:Ke.UNSIGNED_INT_24_8}),t>1&&(this._depthStencilRenderbuffer=new Ju({context:e,width:s,height:a,format:hl.DEPTH24_STENCIL8,numSamples:t})))),!u(this._fbo.framebuffer)||c||o||r){this._fbo.destroy(),this._fboClassified.destroy();let l,f;u(this._previousFramebuffer)?(l=n.getDepthStencilTexture(),f=n.getDepthStencilRenderbuffer()):(l=this._depthStencilTexture,f=this._depthStencilRenderbuffer),this._fbo.setDepthStencilTexture(l),u(f)&&this._fbo.setDepthStencilRenderbuffer(f),this._fbo.update(e,s,a,t),u(this._previousFramebuffer)||(this._fboClassified.setDepthStencilTexture(l),this._fboClassified.update(e,s,a))}if(u(this._rsUnclassified)||(this._rsUnclassified=Ue.fromCache(mpt),this._rsClassified=Ue.fromCache(ppt),this._rsDefault=Ue.fromCache(_pt)),!u(this._unclassifiedCommand)||o||r){u(this._unclassifiedCommand)&&(this._unclassifiedCommand.shaderProgram=this._unclassifiedCommand.shaderProgram&&this._unclassifiedCommand.shaderProgram.destroy(),this._classifiedCommand.shaderProgram=this._classifiedCommand.shaderProgram&&this._classifiedCommand.shaderProgram.destroy());let l=u(this._previousFramebuffer)?ypt:gpt,f=new ze({defines:["UNCLASSIFIED"],sources:[l]}),d=new ze({sources:[l]});this._unclassifiedCommand=e.createViewportQuadCommand(f,{renderState:u(this._previousFramebuffer)?this._rsUnclassified:this._rsDefault,uniformMap:this._uniformMap,owner:this}),this._classifiedCommand=e.createViewportQuadCommand(d,{renderState:u(this._previousFramebuffer)?this._rsClassified:this._rsDefault,uniformMap:this._uniformMap,owner:this}),u(this._translucentCommand)&&(this._translucentCommand.shaderProgram=this._translucentCommand.shaderProgram&&this._translucentCommand.shaderProgram.destroy()),u(this._previousFramebuffer)||(this._translucentCommand=e.createViewportQuadCommand(Lu,{renderState:this._rsUnclassified,uniformMap:this._uniformMap,owner:this}))}};Bm.prototype.prepareTextures=function(e,t){this._fbo._numSamples>1&&this._fbo.prepareTextures(e,t)};Bm.prototype.clear=function(e,t){u(this._previousFramebuffer)?this._fbo.clear(e,this._clearColorCommand,t):(this._fbo.clear(e,this._clearCommand,t),this._fboClassified.clear(e,this._clearCommand,t))};Bm.prototype.executeClassified=function(e,t){if(!u(this._previousFramebuffer)){let n=t.framebuffer;this.prepareTextures(e,!0),t.framebuffer=this._fboClassified.framebuffer,this._translucentCommand.execute(e,t),t.framebuffer=n}this._classifiedCommand.execute(e,t)};Bm.prototype.executeUnclassified=function(e,t){this._unclassifiedCommand.execute(e,t)};Bm.prototype.isDestroyed=function(){return!1};Bm.prototype.destroy=function(){return this._fbo.destroy(),this._fboClassified.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy(),u(this._unclassifiedCommand)&&(this._unclassifiedCommand.shaderProgram=this._unclassifiedCommand.shaderProgram&&this._unclassifiedCommand.shaderProgram.destroy(),this._classifiedCommand.shaderProgram=this._classifiedCommand.shaderProgram&&this._classifiedCommand.shaderProgram.destroy()),ue(this)};var eI=Bm;function Rz(e){this._total=e,this.usedThisFrame=0,this.stolenFromMeThisFrame=0,this.starvedThisFrame=!1,this.starvedLastFrame=!1}Object.defineProperties(Rz.prototype,{total:{get:function(){return this._total}}});function ry(e){let t=new Array(Qa.NUMBER_OF_JOB_TYPES);t[Qa.TEXTURE]=new Rz(u(e)?e[Qa.TEXTURE]:10),t[Qa.PROGRAM]=new Rz(u(e)?e[Qa.PROGRAM]:10),t[Qa.BUFFER]=new Rz(u(e)?e[Qa.BUFFER]:30);let n=t.length,i,o=0;for(i=0;i<n;++i)o+=t[i].total;let r=new Array(n);for(i=0;i<n;++i)r[i]=!1;this._totalBudget=o,this._totalUsedThisFrame=0,this._budgets=t,this._executedThisFrame=r}ry.getTimestamp=Ei;Object.defineProperties(ry.prototype,{totalBudget:{get:function(){return this._totalBudget}}});ry.prototype.disableThisFrame=function(){this._totalUsedThisFrame=this._totalBudget};ry.prototype.resetBudgets=function(){let e=this._budgets,t=e.length;for(let n=0;n<t;++n){let i=e[n];i.starvedLastFrame=i.starvedThisFrame,i.starvedThisFrame=!1,i.usedThisFrame=0,i.stolenFromMeThisFrame=0}this._totalUsedThisFrame=0};ry.prototype.execute=function(e,t){let n=this._budgets,i=n[t],o=this._executedThisFrame[t];if(this._totalUsedThisFrame>=this._totalBudget&&o)return i.starvedThisFrame=!0,!1;let r;if(i.usedThisFrame+i.stolenFromMeThisFrame>=i.total){let c=n.length,l;for(l=0;l<c&&(r=n[l],!(r.usedThisFrame+r.stolenFromMeThisFrame<r.total&&!r.starvedLastFrame));++l);if(l===c&&o)return!1;o&&(i.starvedThisFrame=!0)}let s=ry.getTimestamp();e.execute();let a=ry.getTimestamp()-s;return this._totalUsedThisFrame+=a,r?r.stolenFromMeThisFrame+=a:i.usedThisFrame+=a,this._executedThisFrame[t]=!0,!0};var Oz=ry;function Mz(e){e=x(e,x.EMPTY_OBJECT);let t=Rn(e.container);this._container=t;let n=document.createElement("div");n.className="cesium-performanceDisplay";let i=document.createElement("div");i.className="cesium-performanceDisplay-fps",this._fpsText=document.createTextNode(""),i.appendChild(this._fpsText);let o=document.createElement("div");o.className="cesium-performanceDisplay-ms",this._msText=document.createTextNode(""),o.appendChild(this._msText),n.appendChild(o),n.appendChild(i),this._container.appendChild(n),this._lastFpsSampleTime=Ei(),this._lastMsSampleTime=Ei(),this._fpsFrameCount=0,this._msFrameCount=0,this._throttled=!1;let r=document.createElement("div");r.className="cesium-performanceDisplay-throttled",this._throttledText=document.createTextNode(""),r.appendChild(this._throttledText),n.appendChild(r)}Object.defineProperties(Mz.prototype,{throttled:{get:function(){return this._throttled},set:function(e){this._throttled!==e&&(e?this._throttledText.nodeValue="(throttled)":this._throttledText.nodeValue="",this._throttled=e)}}});Mz.prototype.update=function(e){let t=Ei(),n=x(e,!0);this._fpsFrameCount++;let i=t-this._lastFpsSampleTime;if(i>1e3){let r="N/A";n&&(r=this._fpsFrameCount*1e3/i|0),this._fpsText.nodeValue=`${r} FPS`,this._lastFpsSampleTime=t,this._fpsFrameCount=0}this._msFrameCount++;let o=t-this._lastMsSampleTime;if(o>200){let r="N/A";n&&(r=(o/this._msFrameCount).toFixed(2)),this._msText.nodeValue=`${r} MS`,this._lastMsSampleTime=t,this._msFrameCount=0}};Mz.prototype.destroy=function(){return ue(this)};var sy=Mz;var el={};el.decodeRawMetadataValue=function(e,t,n){switch(e){case Gt.INT8:return t.getInt8(n);case Gt.UINT8:return t.getUint8(n);case Gt.INT16:return t.getInt16(n);case Gt.UINT16:return t.getUint16(n);case Gt.INT32:return t.getInt32(n);case Gt.UINT32:return t.getUint32(n);case Gt.INT64:return t.getBigInt64(n);case Gt.UINT64:return t.getBigUint64(n);case Gt.FLOAT32:return t.getFloat32(n);case Gt.FLOAT64:return t.getFloat64(n)}throw new ce(`Invalid component type: ${e}`)};el.decodeRawMetadataValueComponent=function(e,t,n){let i=e.componentType,o=el.decodeRawMetadataValue(i,t,n);return e.normalized?Gt.normalize(o,i):o};el.decodeRawMetadataValueElement=function(e,t,n){let i=e.componentType,o=Gt.getSizeInBytes(i),r=e.type,s=Et.getComponentCount(r),a=o*s;if(s>1){let f=Array(s);for(let d=0;d<s;d++){let p=n*a+d*o,g=el.decodeRawMetadataValueComponent(e,t,p);f[d]=g}return f}let c=n*a;return el.decodeRawMetadataValueComponent(e,t,c)};el.decodeRawMetadataValues=function(e,t){let n=new DataView(t.buffer,t.byteOffset,t.byteLength);if(e.isArray){let o=e.arrayLength,r=Array(o);for(let s=0;s<o;s++){let a=el.decodeRawMetadataValueElement(e,n,s);r[s]=a}return r}return el.decodeRawMetadataValueElement(e,n,0)};el.convertToObjectType=function(e,t){if(!u(t)||e===Et.SCALAR||e===Et.STRING||e===Et.BOOLEAN||e===Et.ENUM)return t;let n=t.map(i=>Number(i));switch(e){case Et.VEC2:return H.unpack(n,0,new H);case Et.VEC3:return h.unpack(n,0,new h);case Et.VEC4:return oe.unpack(n,0,new h);case Et.MAT2:return Hi.unpack(n,0,new Hi);case Et.MAT3:return J.unpack(n,0,new J);case Et.MAT4:return F.unpack(n,0,new F)}return t};el.decodeMetadataValues=function(e,t){let n=el.decodeRawMetadataValues(e,t);if(e.isArray){let o=e.arrayLength,r=Array(o);for(let s=0;s<o;s++){let a=n[s],c=el.convertToObjectType(e.type,a);r[s]=c}return r}return el.convertToObjectType(e.type,n)};var Lz=Object.freeze(el);function Cb(){this._framebuffer=new pi,this._textureToCopy=void 0,this._copyDepthCommand=void 0}Object.defineProperties(Cb.prototype,{framebuffer:{get:function(){return this._framebuffer.framebuffer}}});function xpt(e,t,n){let{width:i,height:o}=n;e._framebuffer.update(t,i,o)}function bpt(e,t,n){u(e._copyDepthCommand)||(e._copyDepthCommand=t.createViewportQuadCommand(`uniform highp sampler2D colorTexture;

in vec2 v_textureCoordinates;

void main()
{
  vec4 globeDepthPacked = texture(czm_globeDepthTexture, v_textureCoordinates);
  float globeDepth = czm_unpackDepth(globeDepthPacked);
  float depth = texture(colorTexture, v_textureCoordinates).r;
  out_FragColor = czm_branchFreeTernary(globeDepth <= 0.0 || globeDepth >= 1.0 || depth < globeDepth && depth > 0.0 && depth < 1.0,
    czm_packDepth(depth), globeDepthPacked);
}
`,{renderState:Ue.fromCache(),uniformMap:{colorTexture:function(){return e._textureToCopy}},owner:e})),e._textureToCopy=n,e._copyDepthCommand.framebuffer=e.framebuffer}Cb.prototype.update=function(e,t){xpt(this,e,t),bpt(this,e,t)};var Cpt=new oe,Apt=new oe(1,1/255,1/65025,1/16581375);Cb.prototype.getDepth=function(e,t,n){if(!u(this.framebuffer))return;let i=e.readPixels({x:t,y:n,width:1,height:1,framebuffer:this.framebuffer}),o=oe.unpack(i,0,Cpt);return oe.divideByScalar(o,255,o),oe.dot(o,Apt)};Cb.prototype.executeCopyDepth=function(e,t){this._copyDepthCommand.execute(e,t)};Cb.prototype.isDestroyed=function(){return!1};Cb.prototype.destroy=function(){return this._framebuffer.destroy(),u(this._copyDepthCommand)&&(this._copyDepthCommand.shaderProgram=u(this._copyDepthCommand.shaderProgram)&&this._copyDepthCommand.shaderProgram.destroy()),ue(this)};var Nz=Cb;function Tpt(e,t){this.near=x(e,0),this.far=x(t,0);let n=we.NUMBER_OF_PASSES,i=new Array(n),o=new Array(n);for(let r=0;r<n;++r)i[r]=[],o[r]=0;this.commands=i,this.indices=o}var Fz=Tpt;var Ab=`uniform highp sampler2D u_depthTexture;

in vec2 v_textureCoordinates;

void main()
{
    out_FragColor = czm_packDepth(texture(u_depthTexture, v_textureCoordinates).r);
}
`;function km(){this._picking=!1,this._numSamples=1,this._tempCopyDepthTexture=void 0,this._pickColorFramebuffer=new pi({depthStencil:!0,supportsDepthTexture:!0}),this._outputFramebuffer=new pi({depthStencil:!0,supportsDepthTexture:!0}),this._copyDepthFramebuffer=new pi,this._tempCopyDepthFramebuffer=new pi,this._updateDepthFramebuffer=new pi({createColorAttachments:!1,createDepthAttachments:!1,depthStencil:!0}),this._clearGlobeColorCommand=void 0,this._copyColorCommand=void 0,this._copyDepthCommand=void 0,this._tempCopyDepthCommand=void 0,this._updateDepthCommand=void 0,this._viewport=new qe,this._rs=void 0,this._rsBlend=void 0,this._rsUpdate=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHdr=void 0,this._clearGlobeDepth=void 0}Object.defineProperties(km.prototype,{colorFramebufferManager:{get:function(){return this._picking?this._pickColorFramebuffer:this._outputFramebuffer}},framebuffer:{get:function(){return this.colorFramebufferManager.framebuffer}},depthStencilTexture:{get:function(){return this.colorFramebufferManager.getDepthStencilTexture()}},picking:{get:function(){return this._picking},set:function(e){this._picking=e}}});function Qbe(e,t,n,i,o){let r=e._viewport;r.width=n,r.height=i;let s=!qe.equals(r,o.viewport),a=s!==e._useScissorTest;e._useScissorTest=s,qe.equals(e._scissorRectangle,o.viewport)||(e._scissorRectangle=qe.clone(o.viewport,e._scissorRectangle),a=!0),(!u(e._rs)||!qe.equals(r,e._rs.viewport)||a)&&(e._rs=Ue.fromCache({viewport:r,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle}}),e._rsBlend=Ue.fromCache({viewport:r,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle},blending:un.ALPHA_BLEND}),e._rsUpdate=Ue.fromCache({viewport:r,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle},stencilTest:{enabled:!0,frontFunction:Un.EQUAL,frontOperation:{fail:mt.KEEP,zFail:mt.KEEP,zPass:mt.KEEP},backFunction:Un.NEVER,reference:Ut.CESIUM_3D_TILE_MASK,mask:Ut.CESIUM_3D_TILE_MASK}})),u(e._copyDepthCommand)||(e._copyDepthCommand=t.createViewportQuadCommand(Ab,{uniformMap:{u_depthTexture:function(){return e.colorFramebufferManager.getDepthStencilTexture()}},owner:e})),e._copyDepthCommand.framebuffer=e._copyDepthFramebuffer.framebuffer,e._copyDepthCommand.renderState=e._rs,u(e._copyColorCommand)||(e._copyColorCommand=t.createViewportQuadCommand(Lu,{uniformMap:{colorTexture:function(){return e.colorFramebufferManager.getColorTexture()}},owner:e})),e._copyColorCommand.renderState=e._rs,u(e._tempCopyDepthCommand)||(e._tempCopyDepthCommand=t.createViewportQuadCommand(Ab,{uniformMap:{u_depthTexture:function(){return e._tempCopyDepthTexture}},owner:e})),e._tempCopyDepthCommand.framebuffer=e._tempCopyDepthFramebuffer.framebuffer,e._tempCopyDepthCommand.renderState=e._rs,u(e._updateDepthCommand)||(e._updateDepthCommand=t.createViewportQuadCommand(Lu,{uniformMap:{colorTexture:function(){return e._tempCopyDepthFramebuffer.getColorTexture()}},owner:e})),e._updateDepthCommand.framebuffer=e._updateDepthFramebuffer.framebuffer,e._updateDepthCommand.renderState=e._rsUpdate,u(e._clearGlobeColorCommand)||(e._clearGlobeColorCommand=new ni({color:new G(0,0,0,0),stencil:0,owner:e})),e._clearGlobeColorCommand.framebuffer=e.framebuffer}km.prototype.update=function(e,t,n,i,o,r){let{width:s,height:a}=n,c=o?e.halfFloatingPointTexture?Ke.HALF_FLOAT:Ke.FLOAT:Ke.UNSIGNED_BYTE;this._numSamples=i,this.picking?this._pickColorFramebuffer.update(e,s,a):this._outputFramebuffer.update(e,s,a,i,c),this._copyDepthFramebuffer.update(e,s,a),Qbe(this,e,s,a,t),e.uniformState.globeDepthTexture=void 0,this._clearGlobeDepth=r};km.prototype.prepareColorTextures=function(e,t){!this.picking&&this._numSamples>1&&this._outputFramebuffer.prepareTextures(e,t)};km.prototype.executeCopyDepth=function(e,t){u(this._copyDepthCommand)&&(this.prepareColorTextures(e),this._copyDepthCommand.execute(e,t),e.uniformState.globeDepthTexture=this._copyDepthFramebuffer.getColorTexture())};km.prototype.executeUpdateDepth=function(e,t,n){let i=u(n)?n:t.framebuffer.depthStencilTexture;if(!this._clearGlobeDepth&&i===this.colorFramebufferManager.getDepthStencilTexture()){u(this._copyDepthCommand)&&this._copyDepthCommand.execute(e,t);return}if(!u(this._updateDepthCommand))return;let o=this._updateDepthFramebuffer;if(!u(o.framebuffer)||o.getDepthStencilTexture()!==i||o.getColorTexture()!==this._copyDepthFramebuffer.getColorTexture()){let r=this._copyDepthFramebuffer.getColorTexture(),{width:s,height:a}=r;this._tempCopyDepthFramebuffer.destroy(),this._tempCopyDepthFramebuffer.update(e,s,a),o.setColorTexture(r,0),o.setDepthStencilTexture(i),o.update(e,s,a),Qbe(this,e,s,a,t)}this._tempCopyDepthTexture=i,this._tempCopyDepthCommand.execute(e,t),this._updateDepthCommand.execute(e,t)};km.prototype.executeCopyColor=function(e,t){u(this._copyColorCommand)&&this._copyColorCommand.execute(e,t)};km.prototype.clear=function(e,t,n){let i=this._clearGlobeColorCommand;u(i)&&(G.clone(n,i.color),this.colorFramebufferManager.clear(e,i,t))};km.prototype.isDestroyed=function(){return!1};km.prototype.destroy=function(){return this._pickColorFramebuffer.destroy(),this._outputFramebuffer.destroy(),this._copyDepthFramebuffer.destroy(),this._tempCopyDepthFramebuffer.destroy(),this._updateDepthFramebuffer.destroy(),u(this._copyColorCommand)&&(this._copyColorCommand.shaderProgram=this._copyColorCommand.shaderProgram.destroy()),u(this._copyDepthCommand)&&(this._copyDepthCommand.shaderProgram=this._copyDepthCommand.shaderProgram.destroy()),u(this._tempCopyDepthCommand)&&(this._tempCopyDepthCommand.shaderProgram=this._tempCopyDepthCommand.shaderProgram.destroy()),u(this._updateDepthCommand)&&(this._updateDepthCommand.shaderProgram=this._updateDepthCommand.shaderProgram.destroy()),ue(this)};var Bz=km;function Tb(){this._framebuffer=new pi({depthStencil:!0,supportsDepthTexture:!0}),this._packedDepthFramebuffer=new pi,this._renderState=void 0,this._packedDepthCommand=void 0,this._clearCommand=void 0,this._viewport=new qe,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHdr=void 0}Object.defineProperties(Tb.prototype,{classificationTexture:{get:function(){return this._framebuffer.getColorTexture()}},classificationFramebuffer:{get:function(){return this._framebuffer.framebuffer}},packedDepthFramebuffer:{get:function(){return this._packedDepthFramebuffer.framebuffer}},depthStencilTexture:{get:function(){return this._framebuffer.getDepthStencilTexture()}},depthStencilRenderbuffer:{get:function(){return this._framebuffer.getDepthStencilRenderbuffer()}},packedDepthTexture:{get:function(){return this._packedDepthFramebuffer.getColorTexture()}}});function Ept(e){e._framebuffer.destroy(),e._packedDepthFramebuffer.destroy()}function Spt(e,t,n,i,o){let r=o?t.halfFloatingPointTexture?Ke.HALF_FLOAT:Ke.FLOAT:Ke.UNSIGNED_BYTE;e._framebuffer.update(t,n,i,1,r),e._packedDepthFramebuffer.update(t,n,i)}function vpt(e,t,n,i,o){e._viewport.width=n,e._viewport.height=i;let r=!qe.equals(e._viewport,o.viewport),s=r!==e._useScissorTest;e._useScissorTest=r,qe.equals(e._scissorRectangle,o.viewport)||(e._scissorRectangle=qe.clone(o.viewport,e._scissorRectangle),s=!0),(!u(e._renderState)||!qe.equals(e._viewport,e._renderState.viewport)||s)&&(e._renderState=Ue.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle}})),u(e._packedDepthCommand)||(e._packedDepthCommand=t.createViewportQuadCommand(Ab,{uniformMap:{u_depthTexture:function(){return e.depthStencilTexture}},owner:e})),u(e._clearCommand)||(e._clearCommand=new ni({color:new G(0,0,0,0),depth:1,stencil:0,owner:e})),e._packedDepthCommand.framebuffer=e._packedDepthFramebuffer.framebuffer,e._packedDepthCommand.renderState=e._renderState,e._clearCommand.framebuffer=e.classificationFramebuffer,e._clearCommand.renderState=e._renderState}Tb.prototype.updateAndClear=function(e,t,n,i){let o=t.width,r=t.height;Spt(this,n,o,r,e),vpt(this,n,o,r,i),this._useHdr=e};Tb.prototype.clearClassification=function(e,t){this._clearCommand.execute(e,t)};Tb.prototype.packDepth=function(e,t){return this._packedDepthCommand.execute(e,t),this.packedDepthTexture};Tb.prototype.isDestroyed=function(){return!1};Tb.prototype.destroy=function(){return Ept(this),ue(this)};var kz=Tb;var tI=`#ifdef MRT
layout (location = 0) out vec4 out_FragData_0;
layout (location = 1) out vec4 out_FragData_1;
#else
layout (location = 0) out vec4 out_FragColor;
#endif

uniform vec4 u_bgColor;
uniform sampler2D u_depthTexture;

in vec2 v_textureCoordinates;

void main()
{
    if (texture(u_depthTexture, v_textureCoordinates).r < 1.0)
    {
#ifdef MRT
        out_FragData_0 = u_bgColor;
        out_FragData_1 = vec4(u_bgColor.a);
#else
        out_FragColor = u_bgColor;
#endif
        return;
    }
    
    discard;
}
`;var Vz=`/**
 * Compositing for Weighted Blended Order-Independent Transparency. See:
 * - http://jcgt.org/published/0002/02/09/
 * - http://casual-effects.blogspot.com/2014/03/weighted-blended-order-independent.html
 */

uniform sampler2D u_opaque;
uniform sampler2D u_accumulation;
uniform sampler2D u_revealage;

in vec2 v_textureCoordinates;

void main()
{
    vec4 opaque = texture(u_opaque, v_textureCoordinates);
    vec4 accum = texture(u_accumulation, v_textureCoordinates);
    float r = texture(u_revealage, v_textureCoordinates).r;

#ifdef MRT
    vec4 transparent = vec4(accum.rgb / clamp(r, 1e-4, 5e4), accum.a);
#else
    vec4 transparent = vec4(accum.rgb / clamp(accum.a, 1e-4, 5e4), r);
#endif

    out_FragColor = (1.0 - transparent.a) * transparent + transparent.a * opaque;

    if (opaque != czm_backgroundColor)
    {
        out_FragColor.a = 1.0;
    }
}
`;function g_(e){this._numSamples=1,this._translucentMultipassSupport=!1,this._translucentMRTSupport=!1;let t=e.colorBufferFloat&&e.depthTexture&&e.floatBlend;this._translucentMRTSupport=e.drawBuffers&&t,this._translucentMultipassSupport=!this._translucentMRTSupport&&t,this._opaqueFBO=void 0,this._opaqueTexture=void 0,this._depthStencilTexture=void 0,this._accumulationTexture=void 0,this._translucentFBO=new pi({colorAttachmentsLength:this._translucentMRTSupport?2:1,createColorAttachments:!1,createDepthAttachments:!1,depth:!0}),this._alphaFBO=new pi({createColorAttachments:!1,createDepthAttachments:!1,depth:!0}),this._adjustTranslucentFBO=new pi({colorAttachmentsLength:this._translucentMRTSupport?2:1,createColorAttachments:!1}),this._adjustAlphaFBO=new pi({createColorAttachments:!1}),this._opaqueClearCommand=new ni({color:new G(0,0,0,0),owner:this}),this._translucentMRTClearCommand=new ni({color:new G(0,0,0,1),owner:this}),this._translucentMultipassClearCommand=new ni({color:new G(0,0,0,0),owner:this}),this._alphaClearCommand=new ni({color:new G(1,1,1,1),owner:this}),this._translucentRenderStateCache={},this._alphaRenderStateCache={},this._compositeCommand=void 0,this._adjustTranslucentCommand=void 0,this._adjustAlphaCommand=void 0,this._viewport=new qe,this._rs=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHDR=!1}function Jbe(e){e._accumulationTexture=e._accumulationTexture&&!e._accumulationTexture.isDestroyed()&&e._accumulationTexture.destroy(),e._revealageTexture=e._revealageTexture&&!e._revealageTexture.isDestroyed()&&e._revealageTexture.destroy()}function BK(e){e._translucentFBO.destroy(),e._alphaFBO.destroy(),e._adjustTranslucentFBO.destroy(),e._adjustAlphaFBO.destroy()}function eCe(e){Jbe(e),BK(e)}function wpt(e,t,n,i){Jbe(e),e._accumulationTexture=new Ot({context:t,width:n,height:i,pixelFormat:tt.RGBA,pixelDatatype:Ke.FLOAT}),e._revealageTexture=new Ot({context:t,pixelFormat:tt.RGBA,pixelDatatype:Ke.FLOAT,width:n,height:i,flipY:!1})}function Dpt(e,t){BK(e);let n=te.FRAMEBUFFER_COMPLETE,i=!0,{width:o,height:r}=e._accumulationTexture;if(e._translucentMRTSupport&&(e._translucentFBO.setColorTexture(e._accumulationTexture,0),e._translucentFBO.setColorTexture(e._revealageTexture,1),e._translucentFBO.setDepthStencilTexture(e._depthStencilTexture),e._translucentFBO.update(t,o,r),e._adjustTranslucentFBO.setColorTexture(e._accumulationTexture,0),e._adjustTranslucentFBO.setColorTexture(e._revealageTexture,1),e._adjustTranslucentFBO.update(t,o,r),(e._translucentFBO.status!==n||e._adjustTranslucentFBO.status!==n)&&(BK(e),e._translucentMRTSupport=!1)),!e._translucentMRTSupport){e._translucentFBO.setColorTexture(e._accumulationTexture),e._translucentFBO.setDepthStencilTexture(e._depthStencilTexture),e._translucentFBO.update(t,o,r),e._alphaFBO.setColorTexture(e._revealageTexture),e._alphaFBO.setDepthStencilTexture(e._depthStencilTexture),e._alphaFBO.update(t,o,r),e._adjustTranslucentFBO.setColorTexture(e._accumulationTexture),e._adjustTranslucentFBO.update(t,o,r),e._adjustAlphaFBO.setColorTexture(e._revealageTexture),e._adjustAlphaFBO.update(t,o,r);let s=e._translucentFBO.status===n,a=e._alphaFBO.status===n,c=e._adjustTranslucentFBO.status===n,l=e._adjustAlphaFBO.status===n;(!s||!a||!c||!l)&&(eCe(e),e._translucentMultipassSupport=!1,i=!1)}return i}g_.prototype.update=function(e,t,n,i,o){if(!this.isSupported())return;this._opaqueFBO=n,this._opaqueTexture=n.getColorTexture(0),this._depthStencilTexture=n.getDepthStencilTexture();let{width:r,height:s}=this._opaqueTexture,a=this._accumulationTexture,c=!u(a)||a.width!==r||a.height!==s||i!==this._useHDR,l=this._numSamples!==o;if((c||l)&&(this._numSamples=o,wpt(this,e,r,s)),(!u(this._translucentFBO.framebuffer)||c||l)&&!Dpt(this,e))return;this._useHDR=i;let f=this,d,p;u(this._compositeCommand)||(d=new ze({sources:[Vz]}),this._translucentMRTSupport&&d.defines.push("MRT"),p={u_opaque:function(){return f._opaqueTexture},u_accumulation:function(){return f._accumulationTexture},u_revealage:function(){return f._revealageTexture}},this._compositeCommand=e.createViewportQuadCommand(d,{uniformMap:p,owner:this})),u(this._adjustTranslucentCommand)||(this._translucentMRTSupport?(d=new ze({defines:["MRT"],sources:[tI]}),p={u_bgColor:function(){return f._translucentMRTClearCommand.color},u_depthTexture:function(){return f._depthStencilTexture}},this._adjustTranslucentCommand=e.createViewportQuadCommand(d,{uniformMap:p,owner:this})):this._translucentMultipassSupport&&(d=new ze({sources:[tI]}),p={u_bgColor:function(){return f._translucentMultipassClearCommand.color},u_depthTexture:function(){return f._depthStencilTexture}},this._adjustTranslucentCommand=e.createViewportQuadCommand(d,{uniformMap:p,owner:this}),p={u_bgColor:function(){return f._alphaClearCommand.color},u_depthTexture:function(){return f._depthStencilTexture}},this._adjustAlphaCommand=e.createViewportQuadCommand(d,{uniformMap:p,owner:this}))),this._viewport.width=r,this._viewport.height=s;let g=!qe.equals(this._viewport,t.viewport),m=g!==this._useScissorTest;this._useScissorTest=g,qe.equals(this._scissorRectangle,t.viewport)||(this._scissorRectangle=qe.clone(t.viewport,this._scissorRectangle),m=!0),(!u(this._rs)||!qe.equals(this._viewport,this._rs.viewport)||m)&&(this._rs=Ue.fromCache({viewport:this._viewport,scissorTest:{enabled:this._useScissorTest,rectangle:this._scissorRectangle}})),u(this._compositeCommand)&&(this._compositeCommand.renderState=this._rs),this._adjustTranslucentCommand&&(this._adjustTranslucentCommand.renderState=this._rs),u(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.renderState=this._rs)};var Ipt={enabled:!0,color:new G(0,0,0,0),equationRgb:Xa.ADD,equationAlpha:Xa.ADD,functionSourceRgb:Do.ONE,functionDestinationRgb:Do.ONE,functionSourceAlpha:Do.ZERO,functionDestinationAlpha:Do.ONE_MINUS_SOURCE_ALPHA},Ppt={enabled:!0,color:new G(0,0,0,0),equationRgb:Xa.ADD,equationAlpha:Xa.ADD,functionSourceRgb:Do.ONE,functionDestinationRgb:Do.ONE,functionSourceAlpha:Do.ONE,functionDestinationAlpha:Do.ONE},Rpt={enabled:!0,color:new G(0,0,0,0),equationRgb:Xa.ADD,equationAlpha:Xa.ADD,functionSourceRgb:Do.ZERO,functionDestinationRgb:Do.ONE_MINUS_SOURCE_ALPHA,functionSourceAlpha:Do.ZERO,functionDestinationAlpha:Do.ONE_MINUS_SOURCE_ALPHA};function kK(e,t,n,i){let o=n[i.id];if(!u(o)){let r=Ue.getState(i);r.depthMask=!1,r.blending=t,o=Ue.fromCache(r),n[i.id]=o}return o}function Opt(e,t,n){return kK(t,Ipt,e._translucentRenderStateCache,n)}function Mpt(e,t,n){return kK(t,Ppt,e._translucentRenderStateCache,n)}function Lpt(e,t,n){return kK(t,Rpt,e._alphaRenderStateCache,n)}var Npt=`    vec3 Ci = czm_out_FragColor.rgb * czm_out_FragColor.a;
    float ai = czm_out_FragColor.a;
    float wzi = czm_alphaWeight(ai);
    out_FragData_0 = vec4(Ci * wzi, ai);
    out_FragData_1 = vec4(ai * wzi);
`,Fpt=`    vec3 Ci = czm_out_FragColor.rgb * czm_out_FragColor.a;
    float ai = czm_out_FragColor.a;
    float wzi = czm_alphaWeight(ai);
    out_FragColor = vec4(Ci, ai) * wzi;
`,Bpt=`    float ai = czm_out_FragColor.a;
    out_FragColor = vec4(ai);
`;function VK(e,t,n,i){let{shaderCache:o}=e,r=o.getDerivedShaderProgram(t,n);if(u(r))return r;let s=t._attributeLocations,a=t.fragmentShaderSource.clone();a.sources=a.sources.map(function(f){return ze.replaceMain(f,"czm_translucent_main").replace(/out_FragColor/g,"czm_out_FragColor").replace(/layout\s*\(location\s*=\s*0\)\s*out\s+vec4\s+out_FragColor;/g,"").replace(/\bdiscard\b/g,"czm_discard = true").replace(/czm_phong/g,"czm_translucentPhong")}),a.sources.splice(0,0,`vec4 czm_out_FragColor;
bool czm_discard = false;
`);let c=[...i.matchAll(/out_FragData_(\d+)/g)],l="";for(let f=0;f<c.length;f++){let d=c[f];l=`layout (location = ${d[1]}) out vec4 ${d[0]};
${l}`}return a.sources.push(l),a.sources.push(`void main()
{
    czm_translucent_main();
    if (czm_discard)
    {
        discard;
    }
${i}}
`),o.createDerivedShaderProgram(t,n,{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:a,attributeLocations:s})}function kpt(e,t){return VK(e,t,"translucentMRT",Npt)}function Vpt(e,t){return VK(e,t,"translucentMultipass",Fpt)}function Upt(e,t){return VK(e,t,"alphaMultipass",Bpt)}g_.prototype.createDerivedCommands=function(e,t,n){if(u(n)||(n={}),this._translucentMRTSupport){let a,c;return u(n.translucentCommand)&&(a=n.translucentCommand.shaderProgram,c=n.translucentCommand.renderState),n.translucentCommand=Qe.shallowClone(e,n.translucentCommand),!u(a)||n.shaderProgramId!==e.shaderProgram.id?(n.translucentCommand.shaderProgram=kpt(t,e.shaderProgram),n.translucentCommand.renderState=Opt(this,t,e.renderState),n.shaderProgramId=e.shaderProgram.id):(n.translucentCommand.shaderProgram=a,n.translucentCommand.renderState=c),n}let i,o,r,s;return u(n.translucentCommand)&&(i=n.translucentCommand.shaderProgram,o=n.translucentCommand.renderState,r=n.alphaCommand.shaderProgram,s=n.alphaCommand.renderState),n.translucentCommand=Qe.shallowClone(e,n.translucentCommand),n.alphaCommand=Qe.shallowClone(e,n.alphaCommand),!u(i)||n.shaderProgramId!==e.shaderProgram.id?(n.translucentCommand.shaderProgram=Vpt(t,e.shaderProgram),n.translucentCommand.renderState=Mpt(this,t,e.renderState),n.alphaCommand.shaderProgram=Upt(t,e.shaderProgram),n.alphaCommand.renderState=Lpt(this,t,e.renderState),n.shaderProgramId=e.shaderProgram.id):(n.translucentCommand.shaderProgram=i,n.translucentCommand.renderState=o,n.alphaCommand.shaderProgram=r,n.alphaCommand.renderState=s),n};function zpt(e,t,n,i,o,r){let{context:s,frameState:a}=t,{useLogDepth:c,shadowState:l}=a,f=t._hdr,d=i.framebuffer,p=l.lightShadowsEnabled;i.framebuffer=e._adjustTranslucentFBO.framebuffer,e._adjustTranslucentCommand.execute(s,i),i.framebuffer=e._adjustAlphaFBO.framebuffer,e._adjustAlphaCommand.execute(s,i);let g=e._opaqueFBO.framebuffer;i.framebuffer=e._translucentFBO.framebuffer;for(let m=0;m<o.length;++m){let y=o[m];y=c?y.derivedCommands.logDepth.command:y,y=f?y.derivedCommands.hdr.command:y;let b=p&&y.receiveShadows?y.derivedCommands.oit.shadows.translucentCommand:y.derivedCommands.oit.translucentCommand;n(b,t,i,g)}if(u(r)){let m=r.unclassifiedCommand,y=p&&m.receiveShadows?m.derivedCommands.oit.shadows.translucentCommand:m.derivedCommands.oit.translucentCommand;n(y,t,i,g)}i.framebuffer=e._alphaFBO.framebuffer;for(let m=0;m<o.length;++m){let y=o[m];y=c?y.derivedCommands.logDepth.command:y,y=f?y.derivedCommands.hdr.command:y;let b=p&&y.receiveShadows?y.derivedCommands.oit.shadows.alphaCommand:y.derivedCommands.oit.alphaCommand;n(b,t,i,g)}if(u(r)){let m=r.unclassifiedCommand,y=p&&m.receiveShadows?m.derivedCommands.oit.shadows.alphaCommand:m.derivedCommands.oit.alphaCommand;n(y,t,i,g)}i.framebuffer=d}function Hpt(e,t,n,i,o,r){let{context:s,frameState:a}=t,{useLogDepth:c,shadowState:l}=a,f=t._hdr,d=i.framebuffer,p=l.lightShadowsEnabled;i.framebuffer=e._adjustTranslucentFBO.framebuffer,e._adjustTranslucentCommand.execute(s,i);let g=e._opaqueFBO.framebuffer;i.framebuffer=e._translucentFBO.framebuffer;for(let m=0;m<o.length;++m){let y=o[m];y=c?y.derivedCommands.logDepth.command:y,y=f?y.derivedCommands.hdr.command:y;let b=p&&y.receiveShadows?y.derivedCommands.oit.shadows.translucentCommand:y.derivedCommands.oit.translucentCommand;n(b,t,i,g)}if(u(r)){let m=r.unclassifiedCommand,y=p&&m.receiveShadows?m.derivedCommands.oit.shadows.translucentCommand:m.derivedCommands.oit.translucentCommand;n(y,t,i,g)}i.framebuffer=d}g_.prototype.executeCommands=function(e,t,n,i,o){if(this._translucentMRTSupport){Hpt(this,e,t,n,i,o);return}zpt(this,e,t,n,i,o)};g_.prototype.execute=function(e,t){this._compositeCommand.execute(e,t)};g_.prototype.clear=function(e,t,n){let i=t.framebuffer;t.framebuffer=this._opaqueFBO.framebuffer,G.clone(n,this._opaqueClearCommand.color),this._opaqueClearCommand.execute(e,t),t.framebuffer=this._translucentFBO.framebuffer,(this._translucentMRTSupport?this._translucentMRTClearCommand:this._translucentMultipassClearCommand).execute(e,t),this._translucentMultipassSupport&&(t.framebuffer=this._alphaFBO.framebuffer,this._alphaClearCommand.execute(e,t)),t.framebuffer=i};g_.prototype.isSupported=function(){return this._translucentMRTSupport||this._translucentMultipassSupport};g_.prototype.isDestroyed=function(){return!1};g_.prototype.destroy=function(){return eCe(this),u(this._compositeCommand)&&(this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()),u(this._adjustTranslucentCommand)&&(this._adjustTranslucentCommand.shaderProgram=this._adjustTranslucentCommand.shaderProgram&&this._adjustTranslucentCommand.shaderProgram.destroy()),u(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.shaderProgram=this._adjustAlphaCommand.shaderProgram&&this._adjustAlphaCommand.shaderProgram.destroy()),ue(this)};var Uz=g_;function nI(){this._framebuffer=new pi({color:!1,depthStencil:!0,supportsDepthTexture:!0}),this._passState=void 0}Object.defineProperties(nI.prototype,{framebuffer:{get:function(){return this._framebuffer.framebuffer}}});function Gpt(e){e._framebuffer.destroy()}function Wpt(e,t){let n=t.drawingBufferWidth,i=t.drawingBufferHeight;e._framebuffer.update(t,n,i);let o=new Tc(t);o.blendingEnabled=!1,o.scissorTest={enabled:!0,rectangle:new qe},o.viewport=new qe,e._passState=o}nI.prototype.update=function(e,t,n){let i=n.width,o=n.height;this._framebuffer.isDirty(i,o)&&Wpt(this,e);let r=this.framebuffer,s=this._passState;return s.framebuffer=r,s.viewport.width=i,s.viewport.height=o,s.scissorTest.rectangle.x=t.x,s.scissorTest.rectangle.y=o-t.y,s.scissorTest.rectangle.width=1,s.scissorTest.rectangle.height=1,s};nI.prototype.isDestroyed=function(){return!1};nI.prototype.destroy=function(){return Gpt(this),ue(this)};var zz=nI;function tS(e){let t=new Tc(e);t.blendingEnabled=!1,t.scissorTest={enabled:!0,rectangle:new qe},t.viewport=new qe,this._context=e,this._fb=new pi({depthStencil:!0}),this._passState=t,this._width=0,this._height=0}tS.prototype.begin=function(e,t){let n=this._context,{width:i,height:o}=t;return qe.clone(e,this._passState.scissorTest.rectangle),this._width=i,this._height=o,this._fb.update(n,i,o),this._passState.framebuffer=this._fb.framebuffer,this._passState.viewport.width=i,this._passState.viewport.height=o,this._passState};var iI=new G;tS.prototype.end=function(e){let t=x(e.width,1),n=x(e.height,1),i=this._context,o=i.readPixels({x:e.x,y:e.y,width:t,height:n,framebuffer:this._fb.framebuffer}),r=Math.max(t,n),s=r*r,a=Math.floor(t*.5),c=Math.floor(n*.5),l=0,f=0,d=0,p=-1;for(let g=0;g<s;++g){if(-a<=l&&l<=a&&-c<=f&&f<=c){let m=4*((c-f)*t+l+a);iI.red=G.byteToFloat(o[m]),iI.green=G.byteToFloat(o[m+1]),iI.blue=G.byteToFloat(o[m+2]),iI.alpha=G.byteToFloat(o[m+3]);let y=i.getObjectByPickColor(iI);if(u(y))return y}if(l===f||l<0&&-l===f||l>0&&l===1-f){let m=d;d=-p,p=m}l+=d,f+=p}};tS.prototype.readCenterPixel=function(e){let t=x(e.width,1),n=x(e.height,1),o=this._context.readPixels({x:e.x,y:e.y,width:t,height:n,framebuffer:this._fb.framebuffer}),r=Math.floor(t*.5),a=4*(Math.floor(n*.5)*t+r);return o.slice(a,a+4)};tS.prototype.isDestroyed=function(){return!1};tS.prototype.destroy=function(){return this._fb.destroy(),ue(this)};var Hz=tS;function y_(){this._numSamples=1,this._colorFramebuffer=new pi({depthStencil:!0,supportsDepthTexture:!0}),this._idFramebuffer=new pi({depthStencil:!0,supportsDepthTexture:!0}),this._idClearColor=new G(0,0,0,0),this._clearCommand=new ni({color:new G(0,0,0,0),depth:1,owner:this})}function jpt(e){e._colorFramebuffer.destroy(),e._idFramebuffer.destroy()}Object.defineProperties(y_.prototype,{framebuffer:{get:function(){return this._colorFramebuffer.framebuffer}},idFramebuffer:{get:function(){return this._idFramebuffer.framebuffer}},depthStencilTexture:{get:function(){return this._colorFramebuffer.getDepthStencilTexture()}}});y_.prototype.update=function(e,t,n,i){let o=t.width,r=t.height,s=n?e.halfFloatingPointTexture?Ke.HALF_FLOAT:Ke.FLOAT:Ke.UNSIGNED_BYTE;this._numSamples=i,this._colorFramebuffer.update(e,o,r,i,s),this._idFramebuffer.update(e,o,r)};y_.prototype.clear=function(e,t,n){G.clone(n,this._clearCommand.color),G.clone(this._idClearColor,this._clearCommand.color),this._colorFramebuffer.clear(e,this._clearCommand,t),this._idFramebuffer.clear(e,this._clearCommand,t)};y_.prototype.getFramebuffer=function(){return this._colorFramebuffer.framebuffer};y_.prototype.getIdFramebuffer=function(){return this._idFramebuffer.framebuffer};y_.prototype.prepareColorTextures=function(e){this._numSamples>1&&this._colorFramebuffer.prepareTextures(e)};y_.prototype.isDestroyed=function(){return!1};y_.prototype.destroy=function(){return jpt(this),ue(this)};var nS=y_;function Eb(){}Eb.getShadowCastShaderKeyword=function(e,t,n,i){return`castShadow ${e} ${t} ${n} ${i}`};Eb.createShadowCastVertexShader=function(e,t,n){let i=e.defines.slice(0),o=e.sources.slice(0);i.push("SHADOW_MAP"),n&&i.push("GENERATE_POSITION");let r=ze.findPositionVarying(e),s=u(r);if(t&&!s){let a=o.length;for(let l=0;l<a;++l)o[l]=ze.replaceMain(o[l],"czm_shadow_cast_main");o.push(`out vec3 v_positionEC; 
void main() 
{ 
    czm_shadow_cast_main(); 
    v_positionEC = (czm_inverseProjection * gl_Position).xyz; 
}`)}return new ze({defines:i,sources:o})};Eb.createShadowCastFragmentShader=function(e,t,n,i){let o=e.defines.slice(0),r=e.sources.slice(0);o.push("SHADOW_MAP");let s=ze.findPositionVarying(e),a=u(s);a||(s="v_positionEC");let c=r.length;for(let f=0;f<c;++f)r[f]=ze.replaceMain(r[f],"czm_shadow_cast_main");let l="";return t&&(a||(l+=`in vec3 v_positionEC; 
`),l+=`uniform vec4 shadowMap_lightPositionEC; 
`),i?l+=`void main() 
{ 
`:l+=`void main() 
{ 
    czm_shadow_cast_main(); 
    if (out_FragColor.a == 0.0) 
    { 
       discard; 
    } 
`,t?l+=`    float distance = length(${s}); 
    if (distance >= shadowMap_lightPositionEC.w) 
    { 
        discard; 
    } 
    distance /= shadowMap_lightPositionEC.w; // radius 
    out_FragColor = czm_packDepth(distance); 
`:n?l+=`    out_FragColor = vec4(1.0); 
`:l+=`    out_FragColor = czm_packDepth(gl_FragCoord.z); 
`,l+=`} 
`,r.push(l),new ze({defines:o,sources:r})};Eb.getShadowReceiveShaderKeyword=function(e,t,n,i){let o=e._usesDepthTexture,r=e._polygonOffsetSupported,s=e._isPointLight,a=e._isSpotLight,c=e._numberOfCascades>1,l=e.debugCascadeColors,f=e.softShadows;return`receiveShadow ${o}${r}${s}${a}${c}${l}${f}${t}${n}${i}`};Eb.createShadowReceiveVertexShader=function(e,t,n){let i=e.defines.slice(0),o=e.sources.slice(0);return i.push("SHADOW_MAP"),t&&(n?i.push("GENERATE_POSITION_AND_NORMAL"):i.push("GENERATE_POSITION")),new ze({defines:i,sources:o})};Eb.createShadowReceiveFragmentShader=function(e,t,n,i,o){let r=ze.findNormalVarying(e),s=!i&&u(r)||i&&o,a=ze.findPositionVarying(e),c=u(a),l=t._usesDepthTexture,f=t._polygonOffsetSupported,d=t._isPointLight,p=t._isSpotLight,g=t._numberOfCascades>1,m=t.debugCascadeColors,y=t.softShadows,b=d?t._pointBias:i?t._terrainBias:t._primitiveBias,C=e.defines.slice(0),A=e.sources.slice(0),T=A.length;for(let D=0;D<T;++D)A[D]=ze.replaceMain(A[D],"czm_shadow_receive_main");d?C.push("USE_CUBE_MAP_SHADOW"):l&&C.push("USE_SHADOW_DEPTH_TEXTURE"),y&&!d&&C.push("USE_SOFT_SHADOWS"),g&&n&&i&&(s?C.push("ENABLE_VERTEX_LIGHTING"):C.push("ENABLE_DAYNIGHT_SHADING")),n&&b.normalShading&&s&&(C.push("USE_NORMAL_SHADING"),b.normalShadingSmooth>0&&C.push("USE_NORMAL_SHADING_SMOOTH"));let E="";d?E+=`uniform samplerCube shadowMap_textureCube; 
`:E+=`uniform sampler2D shadowMap_texture; 
`;let v;return c?v=`    return vec4(${a}, 1.0); 
`:v=`#ifndef LOG_DEPTH 
    return czm_windowToEyeCoordinates(gl_FragCoord); 
#else 
    return vec4(v_logPositionEC, 1.0); 
#endif 
`,E+=`uniform mat4 shadowMap_matrix; 
uniform vec3 shadowMap_lightDirectionEC; 
uniform vec4 shadowMap_lightPositionEC; 
uniform vec4 shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness; 
uniform vec4 shadowMap_texelSizeDepthBiasAndNormalShadingSmooth; 
#ifdef LOG_DEPTH 
in vec3 v_logPositionEC; 
#endif 
vec4 getPositionEC() 
{ 
${v}} 
vec3 getNormalEC() 
{ 
${s?`    return normalize(${r}); 
`:`    return vec3(1.0); 
`}} 
void applyNormalOffset(inout vec4 positionEC, vec3 normalEC, float nDotL) 
{ 
${b.normalOffset&&s?`    float normalOffset = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.x; 
    float normalOffsetScale = 1.0 - nDotL; 
    vec3 offset = normalOffset * normalOffsetScale * normalEC; 
    positionEC.xyz += offset; 
`:""}} 
`,E+=`void main() 
{ 
    czm_shadow_receive_main(); 
    vec4 positionEC = getPositionEC(); 
    vec3 normalEC = getNormalEC(); 
    float depth = -positionEC.z; 
`,E+=`    czm_shadowParameters shadowParameters; 
    shadowParameters.texelStepSize = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.xy; 
    shadowParameters.depthBias = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.z; 
    shadowParameters.normalShadingSmooth = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.w; 
    shadowParameters.darkness = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.w; 
`,i?E+=`    shadowParameters.depthBias *= max(depth * 0.01, 1.0); 
`:f||(E+=`    shadowParameters.depthBias *= mix(1.0, 100.0, depth * 0.0015); 
`),d?E+=`    vec3 directionEC = positionEC.xyz - shadowMap_lightPositionEC.xyz; 
    float distance = length(directionEC); 
    directionEC = normalize(directionEC); 
    float radius = shadowMap_lightPositionEC.w; 
    // Stop early if the fragment is beyond the point light radius 
    if (distance > radius) 
    { 
        return; 
    } 
    vec3 directionWC  = czm_inverseViewRotation * directionEC; 
    shadowParameters.depth = distance / radius; 
    shadowParameters.nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); 
    shadowParameters.texCoords = directionWC; 
    float visibility = czm_shadowVisibility(shadowMap_textureCube, shadowParameters); 
`:p?E+=`    vec3 directionEC = normalize(positionEC.xyz - shadowMap_lightPositionEC.xyz); 
    float nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); 
    applyNormalOffset(positionEC, normalEC, nDotL); 
    vec4 shadowPosition = shadowMap_matrix * positionEC; 
    // Spot light uses a perspective projection, so perform the perspective divide 
    shadowPosition /= shadowPosition.w; 
    // Stop early if the fragment is not in the shadow bounds 
    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) 
    { 
        return; 
    } 
    shadowParameters.texCoords = shadowPosition.xy; 
    shadowParameters.depth = shadowPosition.z; 
    shadowParameters.nDotL = nDotL; 
    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); 
`:g?E+=`    float maxDepth = shadowMap_cascadeSplits[1].w; 
    // Stop early if the eye depth exceeds the last cascade 
    if (depth > maxDepth) 
    { 
        return; 
    } 
    // Get the cascade based on the eye-space depth 
    vec4 weights = czm_cascadeWeights(depth); 
    // Apply normal offset 
    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); 
    applyNormalOffset(positionEC, normalEC, nDotL); 
    // Transform position into the cascade 
    vec4 shadowPosition = czm_cascadeMatrix(weights) * positionEC; 
    // Get visibility 
    shadowParameters.texCoords = shadowPosition.xy; 
    shadowParameters.depth = shadowPosition.z; 
    shadowParameters.nDotL = nDotL; 
    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); 
    // Fade out shadows that are far away 
    float shadowMapMaximumDistance = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.z; 
    float fade = max((depth - shadowMapMaximumDistance * 0.8) / (shadowMapMaximumDistance * 0.2), 0.0); 
    visibility = mix(visibility, 1.0, fade); 
${m?`    // Draw cascade colors for debugging 
    out_FragColor *= czm_cascadeColor(weights); 
`:""}`:E+=`    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); 
    applyNormalOffset(positionEC, normalEC, nDotL); 
    vec4 shadowPosition = shadowMap_matrix * positionEC; 
    // Stop early if the fragment is not in the shadow bounds 
    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) 
    { 
        return; 
    } 
    shadowParameters.texCoords = shadowPosition.xy; 
    shadowParameters.depth = shadowPosition.z; 
    shadowParameters.nDotL = nDotL; 
    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); 
`,E+=`    out_FragColor.rgb *= visibility; 
} 
`,A.push(E),new ze({defines:C,sources:A})};var x_=Eb;function Vm(e){e=x(e,x.EMPTY_OBJECT);let t=e.context;this._enabled=x(e.enabled,!0),this._softShadows=x(e.softShadows,!1),this._normalOffset=x(e.normalOffset,!0),this.dirty=!0,this.fromLightSource=x(e.fromLightSource,!0),this.darkness=x(e.darkness,.3),this._darkness=this.darkness,this.fadingEnabled=x(e.fadingEnabled,!0),this.maximumDistance=x(e.maximumDistance,5e3),this._outOfView=!1,this._outOfViewPrevious=!1,this._needsUpdate=!0;let n=!0;(Wt.isInternetExplorer()||Wt.isEdge()||(Wt.isChrome()||Wt.isFirefox())&&Wt.isWindows()&&!t.depthTexture)&&(n=!1),this._polygonOffsetSupported=n,this._terrainBias={polygonOffset:n,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.5,normalShading:!0,normalShadingSmooth:.3,depthBias:1e-4},this._primitiveBias={polygonOffset:n,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.1,normalShading:!0,normalShadingSmooth:.05,depthBias:2e-5},this._pointBias={polygonOffset:!1,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:0,normalShading:!0,normalShadingSmooth:.1,depthBias:5e-4},this._depthAttachment=void 0,this._colorAttachment=void 0,this._shadowMapMatrix=new F,this._shadowMapTexture=void 0,this._lightDirectionEC=new h,this._lightPositionEC=new oe,this._distance=0,this._lightCamera=e.lightCamera,this._shadowMapCamera=new Gz,this._shadowMapCullingVolume=void 0,this._sceneCamera=void 0,this._boundingSphere=new ae,this._isPointLight=x(e.isPointLight,!1),this._pointLightRadius=x(e.pointLightRadius,100),this._cascadesEnabled=this._isPointLight?!1:x(e.cascadesEnabled,!0),this._numberOfCascades=this._cascadesEnabled?x(e.numberOfCascades,4):0,this._fitNearFar=!0,this._maximumCascadeDistances=[25,150,700,Number.MAX_VALUE],this._textureSize=new H,this._isSpotLight=!1,this._cascadesEnabled?this._shadowMapCamera.frustum=new Gr:u(this._lightCamera.frustum.fov)&&(this._isSpotLight=!0),this._cascadeSplits=[new oe,new oe],this._cascadeMatrices=[new F,new F,new F,new F],this._cascadeDistances=new oe;let i;this._isPointLight?i=6:this._cascadesEnabled?i=this._numberOfCascades:i=1,this._passes=new Array(i);for(let o=0;o<i;++o)this._passes[o]=new qpt(t);this.debugShow=!1,this.debugFreezeFrame=!1,this._debugFreezeFrame=!1,this._debugCascadeColors=!1,this._debugLightFrustum=void 0,this._debugCameraFrustum=void 0,this._debugCascadeFrustums=new Array(this._numberOfCascades),this._debugShadowViewCommand=void 0,this._usesDepthTexture=t.depthTexture,this._isPointLight&&(this._usesDepthTexture=!1),this._primitiveRenderState=void 0,this._terrainRenderState=void 0,this._pointRenderState=void 0,zK(this),this._clearCommand=new ni({depth:1,color:new G}),this._clearPassState=new Tc(t),this._size=x(e.size,2048),this.size=this._size}Vm.MAXIMUM_DISTANCE=2e4;function qpt(e){this.camera=new Gz,this.passState=new Tc(e),this.framebuffer=void 0,this.textureOffsets=void 0,this.commandList=[],this.cullingVolume=void 0}function UK(e,t){return Ue.fromCache({cull:{enabled:!0,face:Ci.BACK},depthTest:{enabled:!0},colorMask:{red:e,green:e,blue:e,alpha:e},depthMask:!0,polygonOffset:{enabled:t.polygonOffset,factor:t.polygonOffsetFactor,units:t.polygonOffsetUnits}})}function zK(e){let t=!e._usesDepthTexture;e._primitiveRenderState=UK(t,e._primitiveBias),e._terrainRenderState=UK(t,e._terrainBias),e._pointRenderState=UK(t,e._pointBias)}Vm.prototype.debugCreateRenderStates=function(){zK(this)};Object.defineProperties(Vm.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this.dirty=this._enabled!==e,this._enabled=e}},normalOffset:{get:function(){return this._normalOffset},set:function(e){this.dirty=this._normalOffset!==e,this._normalOffset=e,this._terrainBias.normalOffset=e,this._primitiveBias.normalOffset=e,this._pointBias.normalOffset=e}},softShadows:{get:function(){return this._softShadows},set:function(e){this.dirty=this._softShadows!==e,this._softShadows=e}},size:{get:function(){return this._size},set:function(e){Qpt(this,e)}},outOfView:{get:function(){return this._outOfView}},shadowMapCullingVolume:{get:function(){return this._shadowMapCullingVolume}},passes:{get:function(){return this._passes}},isPointLight:{get:function(){return this._isPointLight}},debugCascadeColors:{get:function(){return this._debugCascadeColors},set:function(e){this.dirty=this._debugCascadeColors!==e,this._debugCascadeColors=e}}});function HK(e){let t=e._passes.length;for(let n=0;n<t;++n){let i=e._passes[n],o=i.framebuffer;u(o)&&!o.isDestroyed()&&o.destroy(),i.framebuffer=void 0}e._depthAttachment=e._depthAttachment&&e._depthAttachment.destroy(),e._colorAttachment=e._colorAttachment&&e._colorAttachment.destroy()}function Ypt(e,t){let n=new Ju({context:t,width:e._textureSize.x,height:e._textureSize.y,format:hl.DEPTH_COMPONENT16}),i=new Ot({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:tt.RGBA,pixelDatatype:Ke.UNSIGNED_BYTE,sampler:Qt.NEAREST}),o=new Hr({context:t,depthRenderbuffer:n,colorTextures:[i],destroyAttachments:!1}),r=e._passes.length;for(let s=0;s<r;++s){let a=e._passes[s];a.framebuffer=o,a.passState.framebuffer=o}e._shadowMapTexture=i,e._depthAttachment=n,e._colorAttachment=i}function Xpt(e,t){let n=new Ot({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:tt.DEPTH_STENCIL,pixelDatatype:Ke.UNSIGNED_INT_24_8,sampler:Qt.NEAREST}),i=new Hr({context:t,depthStencilTexture:n,destroyAttachments:!1}),o=e._passes.length;for(let r=0;r<o;++r){let s=e._passes[r];s.framebuffer=i,s.passState.framebuffer=i}e._shadowMapTexture=n,e._depthAttachment=n}function Kpt(e,t){let n=new Ju({context:t,width:e._textureSize.x,height:e._textureSize.y,format:hl.DEPTH_COMPONENT16}),i=new Or({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:tt.RGBA,pixelDatatype:Ke.UNSIGNED_BYTE,sampler:Qt.NEAREST}),o=[i.negativeX,i.negativeY,i.negativeZ,i.positiveX,i.positiveY,i.positiveZ];for(let r=0;r<6;++r){let s=new Hr({context:t,depthRenderbuffer:n,colorTextures:[o[r]],destroyAttachments:!1}),a=e._passes[r];a.framebuffer=s,a.passState.framebuffer=s}e._shadowMapTexture=i,e._depthAttachment=n,e._colorAttachment=i}function iCe(e,t){e._isPointLight?Kpt(e,t):e._usesDepthTexture?Xpt(e,t):Ypt(e,t)}function Zpt(e,t){e._usesDepthTexture&&e._passes[0].framebuffer.status!==te.FRAMEBUFFER_COMPLETE&&(e._usesDepthTexture=!1,zK(e),HK(e),iCe(e,t))}function $pt(e,t){(!u(e._passes[0].framebuffer)||e._shadowMapTexture.width!==e._textureSize.x)&&(HK(e),iCe(e,t),Zpt(e,t),oCe(e,t))}function oCe(e,t,n){n=x(n,0),(e._isPointLight||n===0)&&(e._clearCommand.framebuffer=e._passes[n].framebuffer,e._clearCommand.execute(t,e._clearPassState))}function Qpt(e,t){e._size=t;let n=e._passes,i=n.length,o=e._textureSize;if(e._isPointLight){t=Vt.maximumCubeMapSize>=t?t:Vt.maximumCubeMapSize,o.x=t,o.y=t;let r=new qe(0,0,t,t);n[0].passState.viewport=r,n[1].passState.viewport=r,n[2].passState.viewport=r,n[3].passState.viewport=r,n[4].passState.viewport=r,n[5].passState.viewport=r}else i===1?(t=Vt.maximumTextureSize>=t?t:Vt.maximumTextureSize,o.x=t,o.y=t,n[0].passState.viewport=new qe(0,0,t,t)):i===4&&(t=Vt.maximumTextureSize>=t*2?t:Vt.maximumTextureSize/2,o.x=t*2,o.y=t*2,n[0].passState.viewport=new qe(0,0,t,t),n[1].passState.viewport=new qe(t,0,t,t),n[2].passState.viewport=new qe(0,t,t,t),n[3].passState.viewport=new qe(t,t,t,t));e._clearPassState.viewport=new qe(0,0,o.x,o.y);for(let r=0;r<i;++r){let s=n[r],a=s.passState.viewport,c=a.x/o.x,l=a.y/o.y,f=a.width/o.x,d=a.height/o.y;s.textureOffsets=new F(f,0,0,c,0,d,0,l,0,0,1,0,0,0,0,1)}}var Jpt=new qe;function e_t(e,t){let n;e._isPointLight?n=`uniform samplerCube shadowMap_textureCube; 
in vec2 v_textureCoordinates; 
void main() 
{ 
    vec2 uv = v_textureCoordinates; 
    vec3 dir; 
 
    if (uv.y < 0.5) 
    { 
        if (uv.x < 0.333) 
        { 
            dir.x = -1.0; 
            dir.y = uv.x * 6.0 - 1.0; 
            dir.z = uv.y * 4.0 - 1.0; 
        } 
        else if (uv.x < 0.666) 
        { 
            dir.y = -1.0; 
            dir.x = uv.x * 6.0 - 3.0; 
            dir.z = uv.y * 4.0 - 1.0; 
        } 
        else 
        { 
            dir.z = -1.0; 
            dir.x = uv.x * 6.0 - 5.0; 
            dir.y = uv.y * 4.0 - 1.0; 
        } 
    } 
    else 
    { 
        if (uv.x < 0.333) 
        { 
            dir.x = 1.0; 
            dir.y = uv.x * 6.0 - 1.0; 
            dir.z = uv.y * 4.0 - 3.0; 
        } 
        else if (uv.x < 0.666) 
        { 
            dir.y = 1.0; 
            dir.x = uv.x * 6.0 - 3.0; 
            dir.z = uv.y * 4.0 - 3.0; 
        } 
        else 
        { 
            dir.z = 1.0; 
            dir.x = uv.x * 6.0 - 5.0; 
            dir.y = uv.y * 4.0 - 3.0; 
        } 
    } 
 
    float shadow = czm_unpackDepth(czm_textureCube(shadowMap_textureCube, dir)); 
    out_FragColor = vec4(vec3(shadow), 1.0); 
} 
`:n=`uniform sampler2D shadowMap_texture; 
in vec2 v_textureCoordinates; 
void main() 
{ 
${e._usesDepthTexture?`    float shadow = texture(shadowMap_texture, v_textureCoordinates).r; 
`:`    float shadow = czm_unpackDepth(texture(shadowMap_texture, v_textureCoordinates)); 
`}    out_FragColor = vec4(vec3(shadow), 1.0); 
} 
`;let i=t.createViewportQuadCommand(n,{uniformMap:{shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture}}});return i.pass=we.OVERLAY,i}function t_t(e,t){let n=t.context,i=t.context.drawingBufferWidth,o=t.context.drawingBufferHeight,r=Math.min(i,o)*.3,s=Jpt;s.x=i-r,s.y=0,s.width=r,s.height=r;let a=e._debugShadowViewCommand;u(a)||(a=e_t(e,n),e._debugShadowViewCommand=a),(!u(a.renderState)||!qe.equals(a.renderState.viewport,s))&&(a.renderState=Ue.fromCache({viewport:qe.clone(s)})),t.commandList.push(e._debugShadowViewCommand)}var Um=new Array(8);Um[0]=new oe(-1,-1,-1,1);Um[1]=new oe(1,-1,-1,1);Um[2]=new oe(1,1,-1,1);Um[3]=new oe(-1,1,-1,1);Um[4]=new oe(-1,-1,1,1);Um[5]=new oe(1,-1,1,1);Um[6]=new oe(1,1,1,1);Um[7]=new oe(-1,1,1,1);var ay=new F,GK=new Array(8);for(let e=0;e<8;++e)GK[e]=new oe;function n_t(e,t){let n=new vt({geometry:new Ih({minimum:new h(-.5,-.5,-.5),maximum:new h(.5,.5,.5)}),attributes:{color:jt.fromColor(t)}}),i=new vt({geometry:new jg({radius:.5}),attributes:{color:jt.fromColor(t)}});return new In({geometryInstances:[n,i],appearance:new ln({translucent:!1,flat:!0}),asynchronous:!1,modelMatrix:e})}var i_t=[G.RED,G.GREEN,G.BLUE,G.MAGENTA],o_t=new h;function r_t(e,t){t_t(e,t);let n=e.debugFreezeFrame&&!e._debugFreezeFrame;if(e._debugFreezeFrame=e.debugFreezeFrame,e.debugFreezeFrame&&(n&&(e._debugCameraFrustum=e._debugCameraFrustum&&e._debugCameraFrustum.destroy(),e._debugCameraFrustum=new p_({camera:e._sceneCamera,color:G.CYAN,updateOnChange:!1})),e._debugCameraFrustum.update(t)),e._cascadesEnabled){if(e.debugFreezeFrame){n&&(e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=new p_({camera:e._shadowMapCamera,color:G.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t);for(let i=0;i<e._numberOfCascades;++i)n&&(e._debugCascadeFrustums[i]=e._debugCascadeFrustums[i]&&e._debugCascadeFrustums[i].destroy(),e._debugCascadeFrustums[i]=new p_({camera:e._passes[i].camera,color:i_t[i],updateOnChange:!1})),e._debugCascadeFrustums[i].update(t)}}else if(e._isPointLight){if(!u(e._debugLightFrustum)||e._needsUpdate){let i=e._shadowMapCamera.positionWC,o=Le.IDENTITY,r=e._pointLightRadius*2,s=h.fromElements(r,r,r,o_t),a=F.fromTranslationQuaternionRotationScale(i,o,s,ay);e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=n_t(a,G.YELLOW)}e._debugLightFrustum.update(t)}else(!u(e._debugLightFrustum)||e._needsUpdate)&&(e._debugLightFrustum=new p_({camera:e._shadowMapCamera,color:G.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t)}function Gz(){this.viewMatrix=new F,this.inverseViewMatrix=new F,this.frustum=void 0,this.positionCartographic=new de,this.positionWC=new h,this.directionWC=h.clone(h.UNIT_Z),this.upWC=h.clone(h.UNIT_Y),this.rightWC=h.clone(h.UNIT_X),this.viewProjectionMatrix=new F}Gz.prototype.clone=function(e){F.clone(e.viewMatrix,this.viewMatrix),F.clone(e.inverseViewMatrix,this.inverseViewMatrix),this.frustum=e.frustum.clone(this.frustum),de.clone(e.positionCartographic,this.positionCartographic),h.clone(e.positionWC,this.positionWC),h.clone(e.directionWC,this.directionWC),h.clone(e.upWC,this.upWC),h.clone(e.rightWC,this.rightWC)};var s_t=new F(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);Gz.prototype.getViewProjection=function(){let e=this.viewMatrix,t=this.frustum.projectionMatrix;return F.multiply(t,e,this.viewProjectionMatrix),F.multiply(s_t,this.viewProjectionMatrix,this.viewProjectionMatrix),this.viewProjectionMatrix};var a_t=new Array(5),c_t=new Ri,l_t=new Array(4),rCe=new h,sCe=new h;function u_t(e,t){let n=e._shadowMapCamera,i=e._sceneCamera,o=i.frustum.near,r=i.frustum.far,s=e._numberOfCascades,a,c=r-o,l=r/o,f=.9,d=!1;t.shadowState.closestObjectSize<200&&(d=!0,f=.9);let p=l_t,g=a_t;for(g[0]=o,g[s]=r,a=0;a<s;++a){let L=(a+1)/s,_=o*Math.pow(l,L),S=o+c*L,w=R.lerp(S,_,f);g[a+1]=w,p[a]=w-g[a]}if(d){for(a=0;a<s;++a)p[a]=Math.min(p[a],e._maximumCascadeDistances[a]);let L=g[0];for(a=0;a<s-1;++a)L+=p[a],g[a+1]=L}oe.unpack(g,0,e._cascadeSplits[0]),oe.unpack(g,1,e._cascadeSplits[1]),oe.unpack(p,0,e._cascadeDistances);let m=n.frustum,y=m.left,b=m.right,C=m.bottom,A=m.top,T=m.near,E=m.far,v=n.positionWC,D=n.directionWC,O=n.upWC,P=i.frustum.clone(c_t),M=n.getViewProjection();for(a=0;a<s;++a){P.near=g[a],P.far=g[a+1];let L=F.multiply(P.projectionMatrix,i.viewMatrix,ay),_=F.inverse(L,ay),S=F.multiply(M,_,ay),w=h.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,rCe),I=h.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,sCe);for(let U=0;U<8;++U){let B=oe.clone(Um[U],GK[U]);F.multiplyByVector(S,B,B),h.divideByScalar(B,B.w,B),h.minimumByComponent(B,w,w),h.maximumByComponent(B,I,I)}w.x=Math.max(w.x,0),w.y=Math.max(w.y,0),w.z=0,I.x=Math.min(I.x,1),I.y=Math.min(I.y,1),I.z=Math.min(I.z,1);let N=e._passes[a],k=N.camera;k.clone(n);let z=k.frustum;z.left=y+w.x*(b-y),z.right=y+I.x*(b-y),z.bottom=C+w.y*(A-C),z.top=C+I.y*(A-C),z.near=T+w.z*(E-T),z.far=T+I.z*(E-T),N.cullingVolume=k.frustum.computeCullingVolume(v,D,O);let V=e._cascadeMatrices[a];F.multiply(k.getViewProjection(),i.inverseViewMatrix,V),F.multiply(N.textureOffsets,V,V)}}var f_t=new F,d_t=new h,h_t=new h,tCe=new h;function m_t(e,t){let n=e._shadowMapCamera,i=e._sceneCamera,o=F.multiply(i.frustum.projectionMatrix,i.viewMatrix,ay),r=F.inverse(o,ay),s=n.directionWC,a=i.directionWC;h.equalsEpsilon(s,a,R.EPSILON10)&&(a=i.upWC);let c=h.cross(s,a,d_t);a=h.cross(c,s,h_t),h.normalize(a,a),h.normalize(c,c);let l=h.fromElements(0,0,0,tCe),f=F.computeView(l,s,a,c,f_t),d=F.multiply(f,r,ay),p=h.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,rCe),g=h.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,sCe);for(let E=0;E<8;++E){let v=oe.clone(Um[E],GK[E]);F.multiplyByVector(d,v,v),h.divideByScalar(v,v.w,v),h.minimumByComponent(v,p,p),h.maximumByComponent(v,g,g)}g.z+=1e3,p.z-=10;let m=tCe;m.x=-(.5*(p.x+g.x)),m.y=-(.5*(p.y+g.y)),m.z=-g.z;let y=F.fromTranslation(m,ay);f=F.multiply(y,f,f);let b=.5*(g.x-p.x),C=.5*(g.y-p.y),A=g.z-p.z,T=n.frustum;T.left=-b,T.right=b,T.bottom=-C,T.top=C,T.near=.01,T.far=A,F.clone(f,n.viewMatrix),F.inverse(f,n.inverseViewMatrix),F.getTranslation(n.inverseViewMatrix,n.positionWC),t.mapProjection.ellipsoid.cartesianToCartographic(n.positionWC,n.positionCartographic),h.clone(s,n.directionWC),h.clone(a,n.upWC),h.clone(c,n.rightWC)}var p_t=[new h(-1,0,0),new h(0,-1,0),new h(0,0,-1),new h(1,0,0),new h(0,1,0),new h(0,0,1)],__t=[new h(0,-1,0),new h(0,0,-1),new h(0,-1,0),new h(0,-1,0),new h(0,0,1),new h(0,-1,0)],g_t=[new h(0,0,1),new h(1,0,0),new h(-1,0,0),new h(0,0,-1),new h(1,0,0),new h(1,0,0)];function y_t(e,t){let n=new Ri;n.fov=R.PI_OVER_TWO,n.near=1,n.far=e._pointLightRadius,n.aspectRatio=1;for(let i=0;i<6;++i){let o=e._passes[i].camera;o.positionWC=e._shadowMapCamera.positionWC,o.positionCartographic=t.mapProjection.ellipsoid.cartesianToCartographic(o.positionWC,o.positionCartographic),o.directionWC=p_t[i],o.upWC=__t[i],o.rightWC=g_t[i],F.computeView(o.positionWC,o.directionWC,o.upWC,o.rightWC,o.viewMatrix),F.inverse(o.viewMatrix,o.inverseViewMatrix),o.frustum=n}}var x_t=new h,b_t=new h,aCe=new ae,nCe=aCe.center;function C_t(e,t){let n=e._sceneCamera,i=e._shadowMapCamera,o=aCe;if(e._cascadesEnabled){if(n.frustum.near>=e.maximumDistance){e._outOfView=!0,e._needsUpdate=!1;return}let r=t.mapProjection.ellipsoid.geodeticSurfaceNormal(n.positionWC,x_t),s=h.negate(i.directionWC,b_t),a=h.dot(r,s);if(e.fadingEnabled){let c=R.clamp(a/.1,0,1);e._darkness=R.lerp(1,e.darkness,c)}else e._darkness=e.darkness;if(a<0){e._outOfView=!0,e._needsUpdate=!1;return}e._needsUpdate=!0,e._outOfView=!1}else if(e._isPointLight)o.center=i.positionWC,o.radius=e._pointLightRadius,e._outOfView=t.cullingVolume.computeVisibility(o)===qt.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(o),ae.clone(o,e._boundingSphere);else{let r=i.frustum.far/2,s=h.add(i.positionWC,h.multiplyByScalar(i.directionWC,r,nCe),nCe);o.center=s,o.radius=r,e._outOfView=t.cullingVolume.computeVisibility(o)===qt.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(o),ae.clone(o,e._boundingSphere)}}function A_t(e,t){let n=t.camera,i=e._lightCamera,o=e._sceneCamera,r=e._shadowMapCamera;e._cascadesEnabled?h.clone(i.directionWC,r.directionWC):e._isPointLight?h.clone(i.positionWC,r.positionWC):r.clone(i);let s=e._lightDirectionEC;F.multiplyByPointAsVector(n.viewMatrix,r.directionWC,s),h.normalize(s,s),h.negate(s,s),F.multiplyByPoint(n.viewMatrix,r.positionWC,e._lightPositionEC),e._lightPositionEC.w=e._pointLightRadius;let a,c;e._fitNearFar?(a=Math.min(t.shadowState.nearPlane,e.maximumDistance),c=Math.min(t.shadowState.farPlane,e.maximumDistance),c=Math.max(c,a+1)):(a=n.frustum.near,c=e.maximumDistance),e._sceneCamera=uo.clone(n,o),n.frustum.clone(e._sceneCamera.frustum),e._sceneCamera.frustum.near=a,e._sceneCamera.frustum.far=c,e._distance=c-a,C_t(e,t),!e._outOfViewPrevious&&e._outOfView&&(e._needsUpdate=!0),e._outOfViewPrevious=e._outOfView}Vm.prototype.update=function(e){if(A_t(this,e),this._needsUpdate)if($pt(this,e.context),this._isPointLight&&y_t(this,e),this._cascadesEnabled&&(m_t(this,e),this._numberOfCascades>1&&u_t(this,e)),this._isPointLight)this._shadowMapCullingVolume=bs.fromBoundingSphere(this._boundingSphere);else{let t=this._shadowMapCamera,n=t.positionWC,i=t.directionWC,o=t.upWC;this._shadowMapCullingVolume=t.frustum.computeCullingVolume(n,i,o),this._passes.length===1&&this._passes[0].camera.clone(t)}if(this._passes.length===1){let t=this._sceneCamera.inverseViewMatrix;F.multiply(this._shadowMapCamera.getViewProjection(),t,this._shadowMapMatrix)}this.debugShow&&r_t(this,e)};Vm.prototype.updatePass=function(e,t){oCe(this,e,t)};var T_t=new H;function cCe(e,t,n){let i=e._isPointLight?e._pointBias:n?e._terrainBias:e._primitiveBias,o={shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture},shadowMap_matrix:function(){return e._shadowMapMatrix},shadowMap_cascadeSplits:function(){return e._cascadeSplits},shadowMap_cascadeMatrices:function(){return e._cascadeMatrices},shadowMap_lightDirectionEC:function(){return e._lightDirectionEC},shadowMap_lightPositionEC:function(){return e._lightPositionEC},shadowMap_cascadeDistances:function(){return e._cascadeDistances},shadowMap_texelSizeDepthBiasAndNormalShadingSmooth:function(){let r=T_t;return r.x=1/e._textureSize.x,r.y=1/e._textureSize.y,oe.fromElements(r.x,r.y,i.depthBias,i.normalShadingSmooth,this.combinedUniforms1)},shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness:function(){return oe.fromElements(i.normalOffsetScale,e._distance,e.maximumDistance,e._darkness,this.combinedUniforms2)},combinedUniforms1:new oe,combinedUniforms2:new oe};return bt(t,o,!1)}function E_t(e,t,n,i,o,r){let s,a,c;if(u(r)&&(s=r.shaderProgram,a=r.renderState,c=r.uniformMap),r=Qe.shallowClone(n,r),r.castShadows=!0,r.receiveShadows=!1,!u(s)||o!==n.shaderProgram.id||t){let l=n.shaderProgram,f=n.pass===we.GLOBE,d=n.pass!==we.TRANSLUCENT,p=e._isPointLight,g=e._usesDepthTexture,m=x_.getShadowCastShaderKeyword(p,f,g,d);if(s=i.shaderCache.getDerivedShaderProgram(l,m),!u(s)){let b=l.vertexShaderSource,C=l.fragmentShaderSource,A=x_.createShadowCastVertexShader(b,p,f),T=x_.createShadowCastFragmentShader(C,p,g,d);s=i.shaderCache.createDerivedShaderProgram(l,m,{vertexShaderSource:A,fragmentShaderSource:T,attributeLocations:l._attributeLocations})}a=e._primitiveRenderState,p?a=e._pointRenderState:f&&(a=e._terrainRenderState),n.renderState.cull.enabled||(a=Ge(a,!1),a.cull=Ge(a.cull,!1),a.cull.enabled=!1,a=Ue.fromCache(a)),c=cCe(e,n.uniformMap,f)}return r.shaderProgram=s,r.renderState=a,r.uniformMap=c,r}Vm.createReceiveDerivedCommand=function(e,t,n,i,o){u(o)||(o={});let r=e.length>0,s=t.shaderProgram,a=s.vertexShaderSource,c=s.fragmentShaderSource,l=t.pass===we.GLOBE,f=!1;if(l&&(f=t.owner.data.renderedMesh.encoding.hasVertexNormals),t.receiveShadows&&r){let d,p;u(o.receiveCommand)&&(d=o.receiveCommand.shaderProgram,p=o.receiveCommand.uniformMap),o.receiveCommand=Qe.shallowClone(t,o.receiveCommand),o.castShadows=!1,o.receiveShadows=!0;let g=o.receiveShaderCastShadows!==t.castShadows,m=o.receiveShaderProgramId!==t.shaderProgram.id;if(!u(d)||m||n||g){let y=x_.getShadowReceiveShaderKeyword(e[0],t.castShadows,l,f);if(d=i.shaderCache.getDerivedShaderProgram(s,y),!u(d)){let b=x_.createShadowReceiveVertexShader(a,l,f),C=x_.createShadowReceiveFragmentShader(c,e[0],t.castShadows,l,f);d=i.shaderCache.createDerivedShaderProgram(s,y,{vertexShaderSource:b,fragmentShaderSource:C,attributeLocations:s._attributeLocations})}p=cCe(e[0],t.uniformMap,l)}o.receiveCommand.shaderProgram=d,o.receiveCommand.uniformMap=p,o.receiveShaderProgramId=t.shaderProgram.id,o.receiveShaderCastShadows=t.castShadows}return o};Vm.createCastDerivedCommand=function(e,t,n,i,o){if(u(o)||(o={}),t.castShadows){let r=o.castCommands;u(r)||(r=o.castCommands=[]);let s=o.castShaderProgramId,a=e.length;r.length=a;for(let c=0;c<a;++c)r[c]=E_t(e[c],n,t,i,s,r[c]);o.castShaderProgramId=t.shaderProgram.id}return o};Vm.prototype.isDestroyed=function(){return!1};Vm.prototype.destroy=function(){HK(this),this._debugLightFrustum=this._debugLightFrustum&&this._debugLightFrustum.destroy(),this._debugCameraFrustum=this._debugCameraFrustum&&this._debugCameraFrustum.destroy(),this._debugShadowViewCommand=this._debugShadowViewCommand&&this._debugShadowViewCommand.shaderProgram&&this._debugShadowViewCommand.shaderProgram.destroy();for(let e=0;e<this._numberOfCascades;++e)this._debugCascadeFrustums[e]=this._debugCascadeFrustums[e]&&this._debugCascadeFrustums[e].destroy();return ue(this)};var cy=Vm;var Wz=`uniform sampler2D u_opaqueDepthTexture;
uniform sampler2D u_translucentDepthTexture;

in vec2 v_textureCoordinates;

void main()
{
    float opaqueDepth = texture(u_opaqueDepthTexture, v_textureCoordinates).r;
    float translucentDepth = texture(u_translucentDepthTexture, v_textureCoordinates).r;
    translucentDepth = czm_branchFreeTernary(translucentDepth > opaqueDepth, 1.0, translucentDepth);
    out_FragColor = czm_packDepth(translucentDepth);
}
`;var iS=`uniform sampler2D colorTexture;

#ifdef DEBUG_SHOW_DEPTH
uniform sampler2D u_packedTranslucentDepth;
#endif

in vec2 v_textureCoordinates;

void main()
{
#ifdef DEBUG_SHOW_DEPTH
    if (v_textureCoordinates.x < 0.5)
    {
        out_FragColor.rgb = vec3(czm_unpackDepth(texture(u_packedTranslucentDepth, v_textureCoordinates)));
        out_FragColor.a = 1.0;
    }
#else
    vec4 color = texture(colorTexture, v_textureCoordinates);

#ifdef PICK
    if (color == vec4(0.0))
    {
        discard;
    }
#else
    // Reverse premultiplication process to get the correct composited result of the classification primitives
    color.rgb /= color.a;
#endif
    out_FragColor = color;
#endif
}
`;var S_t=!1;function ly(e){this._drawClassificationFBO=new pi({createDepthAttachments:!1}),this._accumulationFBO=new pi({createDepthAttachments:!1}),this._packFBO=new pi,this._opaqueDepthStencilTexture=void 0,this._textureToComposite=void 0,this._translucentDepthStencilTexture=void 0,this._packDepthCommand=void 0,this._accumulateCommand=void 0,this._compositeCommand=void 0,this._copyCommand=void 0,this._clearColorCommand=new ni({color:new G(0,0,0,0),owner:this}),this._clearDepthStencilCommand=new ni({depth:1,stencil:0,owner:this}),this._supported=e.depthTexture,this._viewport=new qe,this._rsDepth=void 0,this._rsAccumulate=void 0,this._rsComp=void 0,this._useScissorTest=void 0,this._scissorRectangle=void 0,this._hasTranslucentDepth=!1,this._frustumsDrawn=0}Object.defineProperties(ly.prototype,{hasTranslucentDepth:{get:function(){return this._hasTranslucentDepth}}});function lCe(e){e._textureToComposite=void 0,e._translucentDepthStencilTexture=e._translucentDepthStencilTexture&&!e._translucentDepthStencilTexture.isDestroyed()&&e._translucentDepthStencilTexture.destroy()}function uCe(e){e._drawClassificationFBO.destroy(),e._accumulationFBO.destroy(),e._packFBO.destroy()}function v_t(e,t,n,i){lCe(e),e._translucentDepthStencilTexture=new Ot({context:t,width:n,height:i,pixelFormat:tt.DEPTH_STENCIL,pixelDatatype:Ke.UNSIGNED_INT_24_8,sampler:Qt.NEAREST})}function w_t(e,t,n,i){uCe(e),e._drawClassificationFBO.setDepthStencilTexture(e._translucentDepthStencilTexture),e._drawClassificationFBO.update(t,n,i),e._accumulationFBO.setDepthStencilTexture(e._translucentDepthStencilTexture),e._accumulationFBO.update(t,n,i),e._packFBO.update(t,n,i)}function D_t(e,t,n,i){if(!e.isSupported())return;e._opaqueDepthStencilTexture=i;let o=e._opaqueDepthStencilTexture.width,r=e._opaqueDepthStencilTexture.height;e._drawClassificationFBO.isDirty(o,r)&&(v_t(e,t,o,r),w_t(e,t,o,r));let s,a;if(u(e._packDepthCommand)||(s=new ze({sources:[Wz]}),a={u_opaqueDepthTexture:function(){return e._opaqueDepthStencilTexture},u_translucentDepthTexture:function(){return e._translucentDepthStencilTexture}},e._packDepthCommand=t.createViewportQuadCommand(s,{uniformMap:a,owner:e})),!u(e._compositeCommand)){s=new ze({sources:[iS]}),a={colorTexture:function(){return e._textureToComposite}},S_t&&(s.defines=["DEBUG_SHOW_DEPTH"],a.u_packedTranslucentDepth=function(){return e._packFBO.getColorTexture()}),e._compositeCommand=t.createViewportQuadCommand(s,{uniformMap:a,owner:e});let f=e._compositeCommand,d=f.shaderProgram,p=t.shaderCache.createDerivedShaderProgram(d,"pick",{vertexShaderSource:d.vertexShaderSource,fragmentShaderSource:new ze({sources:s.sources,defines:["PICK"]}),attributeLocations:d._attributeLocations}),g=Qe.shallowClone(f);g.shaderProgram=p,f.derivedCommands.pick=g}u(e._copyCommand)||(s=new ze({sources:[iS]}),a={colorTexture:function(){return e._drawClassificationFBO.getColorTexture()}},e._copyCommand=t.createViewportQuadCommand(s,{uniformMap:a,owner:e})),u(e._accumulateCommand)||(s=new ze({sources:[iS]}),a={colorTexture:function(){return e._drawClassificationFBO.getColorTexture()}},e._accumulateCommand=t.createViewportQuadCommand(s,{uniformMap:a,owner:e})),e._viewport.width=o,e._viewport.height=r;let c=!qe.equals(e._viewport,n.viewport),l=c!==e._useScissorTest;e._useScissorTest=c,qe.equals(e._scissorRectangle,n.viewport)||(e._scissorRectangle=qe.clone(n.viewport,e._scissorRectangle),l=!0),(!u(e._rsDepth)||!qe.equals(e._viewport,e._rsDepth.viewport)||l)&&(e._rsDepth=Ue.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle}})),u(e._packDepthCommand)&&(e._packDepthCommand.renderState=e._rsDepth),(!u(e._rsAccumulate)||!qe.equals(e._viewport,e._rsAccumulate.viewport)||l)&&(e._rsAccumulate=Ue.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle},stencilTest:{enabled:!0,frontFunction:Un.EQUAL,reference:Ut.CESIUM_3D_TILE_MASK}})),u(e._accumulateCommand)&&(e._accumulateCommand.renderState=e._rsAccumulate),(!u(e._rsComp)||!qe.equals(e._viewport,e._rsComp.viewport)||l)&&(e._rsComp=Ue.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle},blending:un.ALPHA_BLEND})),u(e._compositeCommand)&&(e._compositeCommand.renderState=e._rsComp,e._compositeCommand.derivedCommands.pick.renderState=e._rsComp)}ly.prototype.executeTranslucentCommands=function(e,t,n,i,o){let r=e.frameState.useLogDepth,s=e.context,a=n.framebuffer;for(let c=0;c<i.length;++c){let l=i[c];if(l=r?l.derivedCommands.logDepth.command:l,l.depthForTranslucentClassification){this._hasTranslucentDepth=!0;break}}if(this._hasTranslucentDepth){D_t(this,s,n,o),n.framebuffer=this._drawClassificationFBO.framebuffer,this._clearDepthStencilCommand.execute(s,n);for(let c=0;c<i.length;++c){let l=i[c];if(l=r?l.derivedCommands.logDepth.command:l,!l.depthForTranslucentClassification)continue;let f=l.derivedCommands.depth.depthOnlyCommand;t(f,e,n)}this._frustumsDrawn+=this._hasTranslucentDepth?1:0,this._hasTranslucentDepth&&(n.framebuffer=this._packFBO.framebuffer,this._packDepthCommand.execute(s,n)),n.framebuffer=a}};ly.prototype.executeClassificationCommands=function(e,t,n,i){if(!this._hasTranslucentDepth)return;let o=e.context,r=o.uniformState,s=n.framebuffer;n.framebuffer=this._accumulationFBO.framebuffer,this._accumulateCommand.execute(o,n),n.framebuffer=this._drawClassificationFBO.framebuffer,this._frustumsDrawn>1&&this._clearColorCommand.execute(o,n),r.updatePass(we.CESIUM_3D_TILE_CLASSIFICATION);let a=r.globeDepthTexture;r.globeDepthTexture=this._packFBO.getColorTexture();let c=i.commands[we.CESIUM_3D_TILE_CLASSIFICATION],l=i.indices[we.CESIUM_3D_TILE_CLASSIFICATION];for(let f=0;f<l;++f)t(c[f],e,n);r.globeDepthTexture=a,n.framebuffer=s,this._frustumsDrawn!==1&&(n.framebuffer=this._accumulationFBO.framebuffer,this._accumulateCommand.execute(o,n),n.framebuffer=s)};ly.prototype.execute=function(e,t){if(!this._hasTranslucentDepth)return;this._frustumsDrawn===1?this._textureToComposite=this._drawClassificationFBO.getColorTexture():this._textureToComposite=this._accumulationFBO.getColorTexture(),(e.frameState.passes.pick?this._compositeCommand.derivedCommands.pick:this._compositeCommand).execute(e.context,t),I_t(this,e,t)};function I_t(e,t,n){if(!e._hasTranslucentDepth)return;let i=n.framebuffer;n.framebuffer=e._drawClassificationFBO.framebuffer,e._clearColorCommand.execute(t._context,n),n.framebuffer=i,e._frustumsDrawn>1&&(n.framebuffer=e._accumulationFBO.framebuffer,e._clearColorCommand.execute(t._context,n)),e._hasTranslucentDepth=!1,e._frustumsDrawn=0}ly.prototype.isSupported=function(){return this._supported};ly.prototype.isDestroyed=function(){return!1};ly.prototype.destroy=function(){return lCe(this),uCe(this),u(this._compositeCommand)&&(this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()),u(this._packDepthCommand)&&(this._packDepthCommand.shaderProgram=this._packDepthCommand.shaderProgram&&this._packDepthCommand.shaderProgram.destroy()),ue(this)};var jz=ly;function P_t(){this.command=void 0,this.near=void 0,this.far=void 0}function qz(e,t,n){let i=e.context,o;i.depthTexture&&(o=new Bz);let r;e._useOIT&&i.depthTexture&&(r=new Uz(i));let s=new Tc(i);s.viewport=qe.clone(n),this.camera=t,this._cameraClone=uo.clone(t),this._cameraStartFired=!1,this._cameraMovedTime=void 0,this.viewport=n,this.passState=s,this.pickFramebuffer=new Hz(i),this.pickDepthFramebuffer=new zz,this.sceneFramebuffer=new nS,this.globeDepth=o,this.globeTranslucencyFramebuffer=new kz,this.oit=r,this.translucentTileClassification=new jz(i),this.pickDepths=[],this.frustumCommandsList=[],this.debugFrustumStatistics=void 0,this._commandExtents=[]}var WK=new h,jK=new h;function R_t(e,t,n){let i=Math.max(h.maximumComponent(h.abs(e.position,WK)),h.maximumComponent(h.abs(t.position,jK))),o=1/Math.max(1,i);return h.multiplyByScalar(e.position,o,WK),h.multiplyByScalar(t.position,o,jK),h.equalsEpsilon(WK,jK,n)&&h.equalsEpsilon(e.direction,t.direction,n)&&h.equalsEpsilon(e.up,t.up,n)&&h.equalsEpsilon(e.right,t.right,n)&&F.equalsEpsilon(e.transform,t.transform,n)&&e.frustum.equalsEpsilon(t.frustum,n)}qz.prototype.checkForCameraUpdates=function(e){let t=this.camera,n=this._cameraClone;return R_t(t,n,R.EPSILON15)?(this._cameraStartFired&&Ei()-this._cameraMovedTime>e.cameraEventWaitTime&&(t.moveEnd.raiseEvent(),this._cameraStartFired=!1),!1):(this._cameraStartFired||(t.moveStart.raiseEvent(),this._cameraStartFired=!0),this._cameraMovedTime=Ei(),uo.clone(t,n),!0)};function O_t(e,t,n,i){let{frameState:o}=t,{camera:r,useLogDepth:s}=o,a=s?t.logarithmicDepthFarToNearRatio:t.farToNearRatio,c=t.mode===ne.SCENE2D,l=t.nearToFarDistance2D;i*=1+R.EPSILON2,n=Math.min(Math.max(n,r.frustum.near),r.frustum.far),i=Math.max(Math.min(i,r.frustum.far),n);let f;c?(i=Math.min(i,r.position.z+t.nearToFarDistance2D),n=Math.min(n,i),f=Math.ceil(Math.max(1,i-n)/t.nearToFarDistance2D)):f=Math.ceil(Math.log(i/n)/Math.log(a));let{frustumCommandsList:d}=e;d.length=f;for(let p=0;p<f;++p){let g,m;c?(g=Math.min(i-l,n+p*l),m=Math.min(i,g+l)):(g=Math.max(n,Math.pow(a,p)*n),m=Math.min(i,a*g));let y=d[p];u(y)?(y.near=g,y.far=m):y=d[p]=new Fz(g,m)}}function M_t(e,t,n){let{command:i,near:o,far:r}=n;t.debugShowFrustums&&(i.debugOverlappingFrustums=0);let{frustumCommandsList:s}=e;for(let a=0;a<s.length;++a){let c=s[a];if(o>c.far)continue;if(r<c.near)break;let l=i.pass,f=c.indices[l]++;if(c.commands[l][f]=i,t.debugShowFrustums&&(i.debugOverlappingFrustums|=1<<a),i.executeInClosestFrustum)break}if(t.debugShowFrustums){let{debugFrustumStatistics:a}=e,{debugOverlappingFrustums:c}=i,l=a.commandsInFrustums;l[c]=u(l[c])?l[c]+1:1,++a.totalCommands}t.updateDerivedCommands(i)}var fCe=new bs,L_t=new qa;qz.prototype.createPotentiallyVisibleSet=function(e){let{frameState:t}=e,{camera:n,commandList:i,shadowState:o}=t,{positionWC:r,directionWC:s,frustum:a}=n,c=e._computeCommandList,l=e._overlayCommandList;e.debugShowFrustums&&(this.debugFrustumStatistics={totalCommands:0,commandsInFrustums:{}});let f=this.frustumCommandsList;for(let M=0;M<f.length;++M)for(let L=0;L<we.NUMBER_OF_PASSES;++L)f[M].indices[L]=0;c.length=0,l.length=0;let d=this._commandExtents,p=d.length,g=0,m=+Number.MAX_VALUE,y=-Number.MAX_VALUE,{shadowsEnabled:b}=o,C=+Number.MAX_VALUE,A=-Number.MAX_VALUE,T=Number.MAX_VALUE,E=t.mode===ne.SCENE3D?t.occluder:void 0,{cullingVolume:v}=t,D=fCe.planes;for(let M=0;M<5;++M)D[M]=v.planes[M];v=fCe;for(let M=0;M<i.length;++M){let L=i[M],{pass:_,boundingVolume:S}=L;if(_===we.COMPUTE)c.push(L);else if(_===we.OVERLAY)l.push(L);else{let w,I;if(u(S)){if(!e.isVisible(v,L,E))continue;let k=S.computePlaneDistances(r,s,L_t);if(w=k.start,I=k.stop,m=Math.min(m,w),y=Math.max(y,I),b&&L.receiveShadows&&w<cy.MAXIMUM_DISTANCE&&!(_===we.GLOBE&&w<-100&&I>100)){let z=I-w;_!==we.GLOBE&&w<100&&(T=Math.min(T,z)),C=Math.min(C,w),A=Math.max(A,I)}}else L instanceof ni?(w=a.near,I=a.far):(w=a.near,I=a.far,m=Math.min(m,w),y=Math.max(y,I));let N=d[g];u(N)||(N=d[g]=new P_t),N.command=L,N.near=w,N.far=I,g++}}b&&(C=Math.min(Math.max(C,a.near),a.far),A=Math.max(Math.min(A,a.far),C),o.nearPlane=C,o.farPlane=A,o.closestObjectSize=T),O_t(this,e,m,y);for(let M=0;M<g;M++)M_t(this,e,d[M]);if(g<p)for(let M=g;M<p;M++){let L=d[M];if(!u(L.command))break;L.command=void 0}let O=f.length,{frustumSplits:P}=t;P.length=O+1;for(let M=0;M<O;++M)P[M]=f[M].near,M===O-1&&(P[M+1]=f[M].far)};qz.prototype.destroy=function(){this.pickFramebuffer=this.pickFramebuffer&&this.pickFramebuffer.destroy(),this.pickDepthFramebuffer=this.pickDepthFramebuffer&&this.pickDepthFramebuffer.destroy(),this.sceneFramebuffer=this.sceneFramebuffer&&this.sceneFramebuffer.destroy(),this.globeDepth=this.globeDepth&&this.globeDepth.destroy(),this.oit=this.oit&&this.oit.destroy(),this.translucentTileClassification=this.translucentTileClassification&&this.translucentTileClassification.destroy(),this.globeTranslucencyFramebuffer=this.globeTranslucencyFramebuffer&&this.globeTranslucencyFramebuffer.destroy();let e=this.pickDepths;for(let t=0;t<e.length;++t)e[t].destroy()};var oS=qz;var hCe=.1,N_t=new lh({pass:Ho.MOST_DETAILED_PRELOAD}),F_t=new lh({pass:Ho.MOST_DETAILED_PICK}),oI=new lh({pass:Ho.PICK});function Xs(e){this._mostDetailedRayPicks=[],this.pickRenderStateCache={},this._pickPositionCache={},this._pickPositionCacheDirty=!1;let t=new qe(0,0,1,1),n=new uo(e);n.frustum=new sn({width:hCe,aspectRatio:1,near:.1}),this._pickOffscreenView=new oS(e,n,t)}Xs.prototype.update=function(){this._pickPositionCacheDirty=!0};Xs.prototype.getPickDepth=function(e,t){let n=e.view.pickDepths,i=n[t];return u(i)||(i=new Nz,n[t]=i),i};var B_t=new Gr,k_t=new h,Yz=new h,V_t=new H,U_t=new F;function z_t(e,t,n,i,o){let r=e.camera,s=r.frustum,a=s.offCenterFrustum;u(a)&&(s=a);let c=2*(t.x-o.x)/o.width-1;c*=(s.right-s.left)*.5;let l=2*(o.height-t.y-o.y)/o.height-1;l*=(s.top-s.bottom)*.5;let f=F.clone(r.transform,U_t);r._setTransform(F.IDENTITY);let d=h.clone(r.position,k_t);h.multiplyByScalar(r.right,c,Yz),h.add(Yz,d,d),h.multiplyByScalar(r.up,l,Yz),h.add(Yz,d,d),r._setTransform(f),e.mode===ne.SCENE2D&&h.fromElements(d.z,d.x,d.y,d);let p=s.getPixelDimensions(o.width,o.height,1,1,V_t),g=B_t;return g.right=p.x*.5,g.left=-g.right,g.top=p.y*.5,g.bottom=-g.top,g.near=s.near,g.far=s.far,g.computeCullingVolume(d,r.directionWC,r.upWC)}var H_t=new Ll,G_t=new H;function W_t(e,t,n,i,o){let r=e.camera,s=r.frustum,a=s.near,c=Math.tan(s.fovy*.5),l=s.aspectRatio*c,f=2*(t.x-o.x)/o.width-1,d=2*(o.height-t.y-o.y)/o.height-1,p=f*a*l,g=d*a*c,m=s.getPixelDimensions(o.width,o.height,1,1,G_t),y=m.x*n*.5,b=m.y*i*.5,C=H_t;return C.top=g+b,C.bottom=g-b,C.right=p+y,C.left=p-y,C.near=a,C.far=s.far,C.computeCullingVolume(r.positionWC,r.directionWC,r.upWC)}function Xz(e,t,n,i,o){let r=e.camera.frustum;return r instanceof sn||r instanceof Gr?z_t(e,t,n,i,o):W_t(e,t,n,i,o)}var Kz=new qe(0,0,3,3),Zz=new H,rI=new G(0,0,0,0);function qK(e,t,n,i,o){return o.width=x(n,3),o.height=x(i,o.width),o.x=t.x-(o.width-1)*.5,o.y=e-t.y-(o.height-1)*.5,o}Xs.prototype.pick=function(e,t,n,i){let{context:o,frameState:r,defaultView:s}=e,{viewport:a,pickFramebuffer:c}=s;e.view=s,a.x=0,a.y=0,a.width=o.drawingBufferWidth,a.height=o.drawingBufferHeight;let l=s.passState;l.viewport=qe.clone(a,l.viewport);let f=Wi.transformWindowToDrawingBuffer(e,t,Zz),d=qK(o.drawingBufferHeight,f,n,i,Kz);e.jobScheduler.disableThisFrame(),e.updateFrameState(),r.cullingVolume=Xz(e,f,d.width,d.height,a),r.invertClassification=!1,r.passes.pick=!0,r.tilesetPassState=oI,o.uniformState.update(r),e.updateEnvironment(),l=c.begin(d,a),e.updateAndExecuteCommands(l,rI),e.resolveFramebuffers(l);let p=c.end(d);return o.endFrame(),p};Xs.prototype.pickVoxelCoordinate=function(e,t,n,i){let{context:o,frameState:r,defaultView:s}=e,{viewport:a,pickFramebuffer:c}=s;e.view=s,a.x=0,a.y=0,a.width=o.drawingBufferWidth,a.height=o.drawingBufferHeight;let l=s.passState;l.viewport=qe.clone(a,l.viewport);let f=Wi.transformWindowToDrawingBuffer(e,t,Zz),d=qK(o.drawingBufferHeight,f,n,i,Kz);e.jobScheduler.disableThisFrame(),e.updateFrameState(),r.cullingVolume=Xz(e,f,d.width,d.height,a),r.invertClassification=!1,r.passes.pickVoxel=!0,r.tilesetPassState=oI,o.uniformState.update(r),e.updateEnvironment(),l=c.begin(d,a),e.updateAndExecuteCommands(l,rI),e.resolveFramebuffers(l);let p=c.readCenterPixel(d);return o.endFrame(),p};Xs.prototype.pickMetadata=function(e,t,n){let{context:i,frameState:o,defaultView:r}=e,{viewport:s,pickFramebuffer:a}=r;e.view=r,s.x=0,s.y=0,s.width=i.drawingBufferWidth,s.height=i.drawingBufferHeight;let c=r.passState;c.viewport=qe.clone(s,c.viewport);let l=Wi.transformWindowToDrawingBuffer(e,t,Zz),f=qK(i.drawingBufferHeight,l,1,1,Kz);e.jobScheduler.disableThisFrame(),e.updateFrameState(),o.cullingVolume=Xz(e,l,f.width,f.height,s),o.invertClassification=!1,o.passes.pick=!0,o.tilesetPassState=oI,o.pickingMetadata=!0,o.pickedMetadataInfo=n,i.uniformState.update(o),e.updateEnvironment(),c=a.begin(f,s),e.updateAndExecuteCommands(c,rI);let d=e._environmentState.useOIT;e._environmentState.useOIT=!1,e.resolveFramebuffers(c),e._environmentState.useOIT=d;let p=a.readCenterPixel(f);return i.endFrame(),o.pickingMetadata=!1,Lz.decodeMetadataValues(n.classProperty,p)};function j_t(e,t){let{defaultView:n,context:i,frameState:o,environmentState:r}=e,{viewport:s,pickDepthFramebuffer:a}=n;e.view=n,s.x=0,s.y=0,s.width=i.drawingBufferWidth,s.height=i.drawingBufferHeight;let c=n.passState;c.viewport=qe.clone(s,c.viewport),e.clearPasses(o.passes),o.passes.pick=!0,o.passes.depth=!0,o.cullingVolume=Xz(e,t,1,1,s),o.tilesetPassState=oI,e.updateEnvironment(),r.renderTranslucentDepthForPick=!0,c=a.update(i,t,s),e.updateAndExecuteCommands(c,rI),e.resolveFramebuffers(c),i.endFrame()}var q_t=new Ri,Y_t=new Ll,X_t=new sn,K_t=new Gr;Xs.prototype.pickPositionWorldCoordinates=function(e,t,n){if(!e.useDepthPicking)return;let i=t.toString();if(this._pickPositionCacheDirty)this._pickPositionCache={},this._pickPositionCacheDirty=!1;else if(this._pickPositionCache.hasOwnProperty(i))return h.clone(this._pickPositionCache[i],n);let{context:o,frameState:r,camera:s,defaultView:a}=e,{uniformState:c}=o;e.view=a;let l=Wi.transformWindowToDrawingBuffer(e,t,Zz);e.pickTranslucentDepth?j_t(e,l):(e.updateFrameState(),c.update(r),e.updateEnvironment()),l.y=e.drawingBufferHeight-l.y;let f;u(s.frustum.fov)?f=s.frustum.clone(q_t):u(s.frustum.infiniteProjectionMatrix)?f=s.frustum.clone(Y_t):u(s.frustum.width)?f=s.frustum.clone(X_t):f=s.frustum.clone(K_t);let{frustumCommandsList:d}=a,p=d.length;for(let g=0;g<p;++g){let y=this.getPickDepth(e,g).getDepth(o,l.x,l.y);if(u(y)&&y>0&&y<1){let b=d[g],C;return e.mode===ne.SCENE2D?(C=s.position.z,s.position.z=C-b.near+1,f.far=Math.max(1,b.far-b.near),f.near=1,c.update(r),c.updateFrustum(f)):(f.near=b.near*(g!==0?e.opaqueFrustumNearOffset:1),f.far=b.far,c.updateFrustum(f)),n=Wi.drawingBufferToWorldCoordinates(e,l,y,n),e.mode===ne.SCENE2D&&(s.position.z=C,c.update(r)),this._pickPositionCache[i]=h.clone(n),n}}this._pickPositionCache[i]=void 0};var Z_t=new de;Xs.prototype.pickPosition=function(e,t,n){if(n=this.pickPositionWorldCoordinates(e,t,n),u(n)&&e.mode!==ne.SCENE3D){h.fromElements(n.y,n.z,n.x,n);let i=e.mapProjection,o=i.ellipsoid,r=i.unproject(n,Z_t);o.cartographicToCartesian(r,n)}return n};function mCe(e,t){let n,i,o=[],r=[],s=[],a=[];u(e)||(e=Number.MAX_VALUE);let c=t();for(;u(c);){let l=c.object,f=c.position,d=c.exclude;if(u(f)&&!u(l)){o.push(c);break}if(!u(l)||!u(l.primitive)||!d&&(o.push(c),0>=--e))break;let p=l.primitive,g=!1;typeof p.getGeometryInstanceAttributes=="function"&&u(l.id)&&(i=p.getGeometryInstanceAttributes(l.id),u(i)&&u(i.show)&&(g=!0,i.show=yn.toValue(!1,i.show),s.push(i))),l instanceof ta&&(g=!0,l.show=!1,a.push(l)),g||(p.show=!1,r.push(p)),c=t()}for(n=0;n<r.length;++n)r[n].show=!0;for(n=0;n<s.length;++n)i=s[n],i.show=yn.toValue(!0,i.show);for(n=0;n<a.length;++n)a[n].show=!0;return o}Xs.prototype.drillPick=function(e,t,n,i,o){let r=this;return mCe(n,function(){let c=r.pick(e,t,i,o);if(u(c))return{object:c,position:void 0,exclude:!1}}).map(function(c){return c.object})};var dCe=new h,$_t=new h;function Q_t(e,t,n){this.ray=e,this.width=t,this.tilesets=n,this.ready=!1;let i=this;this.promise=new Promise(o=>{i._completePick=()=>{o()}})}function pCe(e,t,n,i){let o=t.direction,r=h.mostOrthogonalAxis(o,dCe),s=h.cross(o,r,dCe),a=h.cross(o,s,$_t);return i.position=t.origin,i.direction=o,i.up=a,i.right=s,i.frustum.width=x(n,hCe),i.frustum.computeCullingVolume(i.positionWC,i.directionWC,i.upWC)}function J_t(e,t,n){let i=t.frameState,{ray:o,width:r,tilesets:s}=n,a=e._pickOffscreenView.camera,c=pCe(e,o,r,a),l=N_t;l.camera=a,l.cullingVolume=c;let f=!0,d=s.length;for(let p=0;p<d;++p){let g=s[p];g.show&&t.primitives.contains(g)&&(g.updateForPass(i,l),f=f&&l.ready)}return f&&n._completePick(),f}Xs.prototype.updateMostDetailedRayPicks=function(e){let t=this._mostDetailedRayPicks;for(let n=0;n<t.length;++n)J_t(this,e,t[n])&&t.splice(n--,1)};function _Ce(e,t,n){for(let i=0;i<e.length;++i){let o=e.get(i);o.show&&(u(o.isCesium3DTileset)?(!u(t)||t.indexOf(o)===-1)&&n.push(o):o instanceof _u&&_Ce(o,t,n))}}function $z(e,t,n,i,o,r){let s=[];if(_Ce(t.primitives,i,s),s.length===0)return Promise.resolve(r());let a=new Q_t(n,o,s);return e._mostDetailedRayPicks.push(a),a.promise.then(function(){return r()})}function egt(e,t){return!u(e)||!u(t)||t.length===0?!1:t.indexOf(e)>-1||t.indexOf(e.primitive)>-1||t.indexOf(e.id)>-1}function tgt(e,t,n,i,o,r,s){let{context:a,frameState:c}=t,l=a.uniformState,f=e._pickOffscreenView;t.view=f,pCe(e,n,o,f.camera);let d=qe.clone(f.viewport,Kz),p=f.pickFramebuffer.begin(d,f.viewport);t.jobScheduler.disableThisFrame(),t.updateFrameState(),c.invertClassification=!1,c.passes.pick=!0,c.passes.offscreen=!0,s?c.tilesetPassState=F_t:c.tilesetPassState=oI,l.update(c),t.updateEnvironment(),t.updateAndExecuteCommands(p,rI),t.resolveFramebuffers(p);let g,m=f.pickFramebuffer.end(d);if(t.context.depthTexture){let{frustumCommandsList:y}=f,b=y.length;for(let C=0;C<b;++C){let T=e.getPickDepth(t,C).getDepth(a,0,0);if(u(T)&&T>0&&T<1){let E=y[C],v=E.near*(C!==0?t.opaqueFrustumNearOffset:1),D=E.far,O=v+T*(D-v);g=_n.getPoint(n,O);break}}}if(t.view=t.defaultView,a.endFrame(),u(m)||u(g))return{object:m,position:g,exclude:!u(g)&&r||egt(m,i)}}function gCe(e,t,n,i,o,r,s,a){return mCe(i,function(){return tgt(e,t,n,o,r,s,a)})}function rS(e,t,n,i,o,r,s){let a=gCe(e,t,n,1,i,o,r,s);if(a.length>0)return a[0]}function yCe(e,t,n,i,o,r,s,a){return gCe(e,t,n,i,o,r,s,a)}function Qz(e,t){return new Promise((n,i)=>{t.then(function(o){let r=e.postRender.addEventListener(function(){r(),n(o)});e.requestRender()}).catch(function(o){i(o)})})}Xs.prototype.pickFromRay=function(e,t,n,i){return rS(this,e,t,n,i,!1,!1)};Xs.prototype.drillPickFromRay=function(e,t,n,i,o){return yCe(this,e,t,n,i,o,!1,!1)};Xs.prototype.pickFromRayMostDetailed=function(e,t,n,i){let o=this;return t=_n.clone(t),n=u(n)?n.slice():n,Qz(e,$z(o,e,t,n,i,function(){return rS(o,e,t,n,i,!1,!0)}))};Xs.prototype.drillPickFromRayMostDetailed=function(e,t,n,i,o){let r=this;return t=_n.clone(t),i=u(i)?i.slice():i,Qz(e,$z(r,e,t,i,o,function(){return yCe(r,e,t,n,i,o,!1,!0)}))};var ngt=new h,igt=new h,ogt=new _n,xCe=new de;function YK(e,t){let n=e.ellipsoid,i=di._defaultMaxTerrainHeight,o=n.geodeticSurfaceNormalCartographic(t,igt),r=de.toCartesian(t,n,ngt),s=ogt;s.origin=r,s.direction=o;let a=new _n;return _n.getPoint(s,i,a.origin),h.negate(o,a.direction),a}function bCe(e,t){let n=e.ellipsoid,i=de.fromCartesian(t,n,xCe);return YK(e,i)}function CCe(e,t){let n=e.ellipsoid;return de.fromCartesian(t,n,xCe).height}function rgt(e,t,n,i,o){let r=YK(t,n);return $z(e,t,r,i,o,function(){let s=rS(e,t,r,i,o,!0,!0);if(u(s))return CCe(t,s.position)})}function sgt(e,t,n,i,o,r){let s=bCe(t,n);return $z(e,t,s,i,o,function(){let a=rS(e,t,s,i,o,!0,!0);if(u(a))return h.clone(a.position,r)})}Xs.prototype.sampleHeight=function(e,t,n,i){let o=YK(e,t),r=rS(this,e,o,n,i,!0,!1);if(u(r))return CCe(e,r.position)};Xs.prototype.clampToHeight=function(e,t,n,i,o){let r=bCe(e,t),s=rS(this,e,r,n,i,!0,!1);if(u(s))return h.clone(s.position,o)};Xs.prototype.sampleHeightMostDetailed=function(e,t,n,i){n=u(n)?n.slice():n;let o=t.length,r=new Array(o);for(let s=0;s<o;++s)r[s]=rgt(this,e,t[s],n,i);return Qz(e,Promise.all(r).then(function(s){let a=s.length;for(let c=0;c<a;++c)t[c].height=s[c];return t}))};Xs.prototype.clampToHeightMostDetailed=function(e,t,n,i){n=u(n)?n.slice():n;let o=t.length,r=new Array(o);for(let s=0;s<o;++s)r[s]=sgt(this,e,t[s],n,i,t[s]);return Qz(e,Promise.all(r).then(function(s){let a=s.length;for(let c=0;c<a;++c)t[c]=s[c];return t}))};Xs.prototype.destroy=function(){this._pickOffscreenView=this._pickOffscreenView&&this._pickOffscreenView.destroy()};var Jz=Xs;var e8=`uniform sampler2D colorTexture;

in vec2 v_textureCoordinates;

#ifdef AUTO_EXPOSURE
uniform sampler2D autoExposure;
#else
uniform float exposure;
#endif

void main()
{
    vec4 fragmentColor = texture(colorTexture, v_textureCoordinates);
    vec3 color = fragmentColor.rgb;

#ifdef AUTO_EXPOSURE
    color /= texture(autoExposure, vec2(0.5)).r;
#else
    color *= vec3(exposure);
#endif
    color = czm_acesTonemapping(color);
    color = czm_inverseGamma(color);

    out_FragColor = vec4(color, fragmentColor.a);
}
`;var t8=`precision highp float;

uniform sampler2D randomTexture;
uniform sampler2D depthTexture;
uniform float intensity;
uniform float bias;
uniform float lengthCap;
uniform float stepSize;
uniform float frustumLength;

vec3 pixelToEye(vec2 screenCoordinate)
{
    vec2 uv = screenCoordinate / czm_viewport.zw;
    float depth = czm_readDepth(depthTexture, uv);
    vec2 xy = 2.0 * uv - vec2(1.0);
    vec4 posEC = czm_inverseProjection * vec4(xy, depth, 1.0);
    return posEC.xyz / posEC.w;
}

// Reconstruct surface normal in eye coordinates, avoiding edges
vec3 getNormalXEdge(vec3 positionEC)
{
    // Find the 3D surface positions at adjacent screen pixels
    vec2 centerCoord = gl_FragCoord.xy;
    vec3 positionLeft = pixelToEye(centerCoord + vec2(-1.0, 0.0));
    vec3 positionRight = pixelToEye(centerCoord + vec2(1.0, 0.0));
    vec3 positionUp = pixelToEye(centerCoord + vec2(0.0, 1.0));
    vec3 positionDown = pixelToEye(centerCoord + vec2(0.0, -1.0));

    // Compute potential tangent vectors
    vec3 dx0 = positionEC - positionLeft;
    vec3 dx1 = positionRight - positionEC;
    vec3 dy0 = positionEC - positionDown;
    vec3 dy1 = positionUp - positionEC;

    // The shorter tangent is more likely to be on the same surface
    vec3 dx = length(dx0) < length(dx1) ? dx0 : dx1;
    vec3 dy = length(dy0) < length(dy1) ? dy0 : dy1;

    return normalize(cross(dx, dy));
}

void main(void)
{
    vec3 positionEC = pixelToEye(gl_FragCoord.xy);

    if (positionEC.z > frustumLength)
    {
        out_FragColor = vec4(1.0);
        return;
    }

    vec3 normalEC = getNormalXEdge(positionEC);

    float ao = 0.0;

    const int ANGLE_STEPS = 4;
    float angleStepScale = 1.0 / float(ANGLE_STEPS);
    float angleStep = angleStepScale * czm_twoPi;
    float cosStep = cos(angleStep);
    float sinStep = sin(angleStep);
    mat2 rotateStep = mat2(cosStep, sinStep, -sinStep, cosStep);

    // Initial sampling direction (different for each pixel)
    const float randomTextureSize = 255.0;
    vec2 randomTexCoord = fract(gl_FragCoord.xy / randomTextureSize);
    float randomVal = texture(randomTexture, randomTexCoord).x;
    vec2 sampleDirection = vec2(cos(angleStep * randomVal), sin(angleStep * randomVal));

    // Loop over sampling directions
    for (int i = 0; i < ANGLE_STEPS; i++)
    {
        sampleDirection = rotateStep * sampleDirection;

        float localAO = 0.0;
        vec2 radialStep = stepSize * sampleDirection;

        for (int j = 0; j < 6; j++)
        {
            // Step along sampling direction, away from output pixel
            vec2 newCoords = floor(gl_FragCoord.xy + float(j + 1) * radialStep) + vec2(0.5);

            // Exit if we stepped off the screen
            if (clamp(newCoords, vec2(0.0), czm_viewport.zw) != newCoords)
            {
                break;
            }

            vec3 stepPositionEC = pixelToEye(newCoords);
            vec3 stepVector = stepPositionEC - positionEC;
            float stepLength = length(stepVector);

            if (stepLength > lengthCap)
            {
                break;
            }

            float dotVal = clamp(dot(normalEC, normalize(stepVector)), 0.0, 1.0);
            if (dotVal < bias)
            {
                dotVal = 0.0;
            }

            float weight = stepLength / lengthCap;
            weight = 1.0 - weight * weight;
            localAO = max(localAO, dotVal * weight);
        }
        ao += localAO;
    }

    ao *= angleStepScale;
    ao = 1.0 - clamp(ao, 0.0, 1.0);
    ao = pow(ao, intensity);
    out_FragColor = vec4(vec3(ao), 1.0);
}
`;var n8=`uniform sampler2D colorTexture;
uniform sampler2D ambientOcclusionTexture;
uniform bool ambientOcclusionOnly;
in vec2 v_textureCoordinates;

void main(void)
{
    vec4 color = texture(colorTexture, v_textureCoordinates);
    vec4 ao = texture(ambientOcclusionTexture, v_textureCoordinates);
    out_FragColor = ambientOcclusionOnly ? ao : ao * color;
}
`;var i8=`uniform sampler2D colorTexture;
uniform float gradations;

in vec2 v_textureCoordinates;

void main(void)
{
    vec3 rgb = texture(colorTexture, v_textureCoordinates).rgb;
#ifdef CZM_SELECTED_FEATURE
    if (czm_selected()) {
        out_FragColor = vec4(rgb, 1.0);
        return;
    }
#endif
    float luminance = czm_luminance(rgb);
    float darkness = luminance * gradations;
    darkness = (darkness - fract(darkness)) / gradations;
    out_FragColor = vec4(vec3(darkness), 1.0);
}
`;var o8=`uniform sampler2D colorTexture;
uniform sampler2D bloomTexture;
uniform bool glowOnly;

in vec2 v_textureCoordinates;

void main(void)
{
    vec4 color = texture(colorTexture, v_textureCoordinates);

#ifdef CZM_SELECTED_FEATURE
    if (czm_selected()) {
        out_FragColor = color;
        return;
    }
#endif

    vec4 bloom = texture(bloomTexture, v_textureCoordinates);
    out_FragColor = glowOnly ? bloom : bloom + color;
}
`;var r8=`uniform sampler2D colorTexture;
uniform float brightness;

in vec2 v_textureCoordinates;

void main(void)
{
    vec3 rgb = texture(colorTexture, v_textureCoordinates).rgb;
    vec3 target = vec3(0.0);
    out_FragColor = vec4(mix(target, rgb, brightness), 1.0);
}
`;var s8=`uniform sampler2D colorTexture;
uniform float contrast;
uniform float brightness;

in vec2 v_textureCoordinates;

void main(void)
{
    vec3 sceneColor = texture(colorTexture, v_textureCoordinates).xyz;
    sceneColor = czm_RGBToHSB(sceneColor);
    sceneColor.z += brightness;
    sceneColor = czm_HSBToRGB(sceneColor);

    float factor = (259.0 * (contrast + 255.0)) / (255.0 * (259.0 - contrast));
    sceneColor = factor * (sceneColor - vec3(0.5)) + vec3(0.5);
    out_FragColor = vec4(sceneColor, 1.0);
}
`;var a8=`uniform sampler2D colorTexture;
uniform sampler2D blurTexture;
uniform sampler2D depthTexture;
uniform float focalDistance;

in vec2 v_textureCoordinates;

vec4 toEye(vec2 uv, float depth)
{
   vec2 xy = vec2((uv.x * 2.0 - 1.0), ((1.0 - uv.y) * 2.0 - 1.0));
   vec4 posInCamera = czm_inverseProjection * vec4(xy, depth, 1.0);
   posInCamera = posInCamera / posInCamera.w;
   return posInCamera;
}

float computeDepthBlur(float depth)
{
    float f;
    if (depth < focalDistance)
    {
        f = (focalDistance - depth) / (focalDistance - czm_currentFrustum.x);
    }
    else
    {
        f = (depth - focalDistance) / (czm_currentFrustum.y - focalDistance);
        f = pow(f, 0.1);
    }
    f *= f;
    f = clamp(f, 0.0, 1.0);
    return pow(f, 0.5);
}

void main(void)
{
    float depth = czm_readDepth(depthTexture, v_textureCoordinates);
    vec4 posInCamera = toEye(v_textureCoordinates, depth);
    float d = computeDepthBlur(-posInCamera.z);
    out_FragColor = mix(texture(colorTexture, v_textureCoordinates), texture(blurTexture, v_textureCoordinates), d);
}
`;var c8=`uniform sampler2D depthTexture;

in vec2 v_textureCoordinates;

void main(void)
{
    float depth = czm_readDepth(depthTexture, v_textureCoordinates);
    out_FragColor = vec4(vec3(depth), 1.0);
}
`;var l8=`uniform sampler2D depthTexture;
uniform float length;
uniform vec4 color;

in vec2 v_textureCoordinates;

void main(void)
{
    float directions[3];
    directions[0] = -1.0;
    directions[1] = 0.0;
    directions[2] = 1.0;

    float scalars[3];
    scalars[0] = 3.0;
    scalars[1] = 10.0;
    scalars[2] = 3.0;

    float padx = czm_pixelRatio / czm_viewport.z;
    float pady = czm_pixelRatio / czm_viewport.w;

#ifdef CZM_SELECTED_FEATURE
    bool selected = false;
    for (int i = 0; i < 3; ++i)
    {
        float dir = directions[i];
        selected = selected || czm_selected(vec2(-padx, dir * pady));
        selected = selected || czm_selected(vec2(padx, dir * pady));
        selected = selected || czm_selected(vec2(dir * padx, -pady));
        selected = selected || czm_selected(vec2(dir * padx, pady));
        if (selected)
        {
            break;
        }
    }
    if (!selected)
    {
        out_FragColor = vec4(color.rgb, 0.0);
        return;
    }
#endif

    float horizEdge = 0.0;
    float vertEdge = 0.0;

    for (int i = 0; i < 3; ++i)
    {
        float dir = directions[i];
        float scale = scalars[i];

        horizEdge -= texture(depthTexture, v_textureCoordinates + vec2(-padx, dir * pady)).x * scale;
        horizEdge += texture(depthTexture, v_textureCoordinates + vec2(padx, dir * pady)).x * scale;

        vertEdge -= texture(depthTexture, v_textureCoordinates + vec2(dir * padx, -pady)).x * scale;
        vertEdge += texture(depthTexture, v_textureCoordinates + vec2(dir * padx, pady)).x * scale;
    }

    float len = sqrt(horizEdge * horizEdge + vertEdge * vertEdge);
    out_FragColor = vec4(color.rgb, len > length ? color.a : 0.0);
}
`;var u8=`uniform sampler2D colorTexture;

in vec2 v_textureCoordinates;

#ifdef AUTO_EXPOSURE
uniform sampler2D autoExposure;
#else
uniform float exposure;
#endif

// See slides 142 and 143:
//     http://www.gdcvault.com/play/1012459/Uncharted_2__HDR_Lighting

void main()
{
    vec4 fragmentColor = texture(colorTexture, v_textureCoordinates);
    vec3 color = fragmentColor.rgb;

#ifdef AUTO_EXPOSURE
    float exposure = texture(autoExposure, vec2(0.5)).r;
    color /= exposure;
#else
    color *= vec3(exposure);
#endif

	const float A = 0.22; // shoulder strength
	const float B = 0.30; // linear strength
	const float C = 0.10; // linear angle
	const float D = 0.20; // toe strength
	const float E = 0.01; // toe numerator
	const float F = 0.30; // toe denominator

	const float white = 11.2; // linear white point value

	vec3 c = ((color * (A * color + C * B) + D * E) / (color * ( A * color + B) + D * F)) - E / F;
	float w = ((white * (A * white + C * B) + D * E) / (white * ( A * white + B) + D * F)) - E / F;

	c = czm_inverseGamma(c / w);
	out_FragColor = vec4(c, fragmentColor.a);
}
`;var f8=`uniform sampler2D colorTexture;

in vec2 v_textureCoordinates;

#ifdef AUTO_EXPOSURE
uniform sampler2D autoExposure;
#else
uniform float exposure;
#endif

void main()
{
    vec4 fragmentColor = texture(colorTexture, v_textureCoordinates);
    vec3 color = fragmentColor.rgb;

#ifdef AUTO_EXPOSURE
    color /= texture(autoExposure, vec2(0.5)).r;
#else
    color *= vec3(exposure);
#endif
    color = czm_pbrNeutralTonemapping(color);
    color = czm_inverseGamma(color);

    out_FragColor = vec4(color, fragmentColor.a);
}
`;var d8=`in vec2 v_textureCoordinates;

uniform sampler2D colorTexture;

const float fxaaQualitySubpix = 0.5;
const float fxaaQualityEdgeThreshold = 0.125;
const float fxaaQualityEdgeThresholdMin = 0.0833;

void main()
{
    vec2 fxaaQualityRcpFrame = vec2(1.0) / czm_viewport.zw;
    vec4 color = FxaaPixelShader(
        v_textureCoordinates,
        colorTexture,
        fxaaQualityRcpFrame,
        fxaaQualitySubpix,
        fxaaQualityEdgeThreshold,
        fxaaQualityEdgeThresholdMin);
    float alpha = texture(colorTexture, v_textureCoordinates).a;
    out_FragColor = vec4(color.rgb, alpha);
}
`;var Sb=`#define SAMPLES 8

uniform float delta;
uniform float sigma;
uniform float direction; // 0.0 for x direction, 1.0 for y direction

uniform sampler2D colorTexture;

#ifdef USE_STEP_SIZE
uniform float stepSize;
#else
uniform vec2 step;
#endif

in vec2 v_textureCoordinates;

//  Incremental Computation of the Gaussian:
//  https://developer.nvidia.com/gpugems/GPUGems3/gpugems3_ch40.html

void main()
{
    vec2 st = v_textureCoordinates;
    vec2 dir = vec2(1.0 - direction, direction);

#ifdef USE_STEP_SIZE
    vec2 step = vec2(stepSize * (czm_pixelRatio / czm_viewport.zw));
#else
    vec2 step = step;
#endif

    vec3 g;
    g.x = 1.0 / (sqrt(czm_twoPi) * sigma);
    g.y = exp((-0.5 * delta * delta) / (sigma * sigma));
    g.z = g.y * g.y;

    vec4 result = texture(colorTexture, st) * g.x;
    for (int i = 1; i < SAMPLES; ++i)
    {
        g.xy *= g.yz;

        vec2 offset = float(i) * dir * step;
        result += texture(colorTexture, st - offset) * g.x;
        result += texture(colorTexture, st + offset) * g.x;
    }

    out_FragColor = result;
}
`;var h8=`uniform sampler2D colorTexture;
uniform sampler2D dirtTexture;
uniform sampler2D starTexture;
uniform vec2 dirtTextureDimensions;
uniform float distortion;
uniform float ghostDispersal;
uniform float haloWidth;
uniform float dirtAmount;
uniform float earthRadius;
uniform float intensity;

in vec2 v_textureCoordinates;

// whether it is in space or not
// 6500000.0 is empirical value
#define DISTANCE_TO_SPACE 6500000.0

// return ndc from world coordinate biased earthRadius
vec4 getNDCFromWC(vec3 WC, float earthRadius)
{
    vec4 positionEC = czm_view * vec4(WC, 1.0);
    positionEC = vec4(positionEC.x + earthRadius, positionEC.y, positionEC.z, 1.0);
    vec4 positionWC = czm_eyeToWindowCoordinates(positionEC);
    return czm_viewportOrthographic * vec4(positionWC.xy, -positionWC.z, 1.0);
}

// Check if current pixel is included Earth
// if then mask it gradually
float isInEarth(vec2 texcoord, vec2 sceneSize)
{
    vec2 NDC = texcoord * 2.0 - 1.0;
    vec4 earthPosSC = getNDCFromWC(vec3(0.0), 0.0);
    vec4 earthPosSCEdge = getNDCFromWC(vec3(0.0), earthRadius * 1.5);
    NDC.xy -= earthPosSC.xy;

    float X = abs(NDC.x) * sceneSize.x;
    float Y = abs(NDC.y) * sceneSize.y;

    return clamp(0.0, 1.0, max(sqrt(X * X + Y * Y) / max(abs(earthPosSCEdge.x * sceneSize.x), 1.0) - 0.8 , 0.0));
}

// For Chromatic effect
vec4 textureDistorted(sampler2D tex, vec2 texcoord, vec2 direction, vec3 distortion, bool isSpace)
{
    vec2 sceneSize = czm_viewport.zw;
    vec3 color;
    if(isSpace)
    {
        color.r = isInEarth(texcoord + direction * distortion.r, sceneSize) * texture(tex, texcoord + direction * distortion.r).r;
        color.g = isInEarth(texcoord + direction * distortion.g, sceneSize) * texture(tex, texcoord + direction * distortion.g).g;
        color.b = isInEarth(texcoord + direction * distortion.b, sceneSize) * texture(tex, texcoord + direction * distortion.b).b;
    }
    else
    {
        color.r = texture(tex, texcoord + direction * distortion.r).r;
        color.g = texture(tex, texcoord + direction * distortion.g).g;
        color.b = texture(tex, texcoord + direction * distortion.b).b;
    }
    return vec4(clamp(color, 0.0, 1.0), 0.0);
}

void main(void)
{
    vec4 originalColor = texture(colorTexture, v_textureCoordinates);
    vec3 rgb = originalColor.rgb;
    bool isSpace = length(czm_viewerPositionWC.xyz) > DISTANCE_TO_SPACE;

    // Sun position
    vec4 sunPos = czm_morphTime == 1.0 ? vec4(czm_sunPositionWC, 1.0) : vec4(czm_sunPositionColumbusView.zxy, 1.0);
    vec4 sunPositionEC = czm_view * sunPos;
    vec4 sunPositionWC = czm_eyeToWindowCoordinates(sunPositionEC);
    sunPos = czm_viewportOrthographic * vec4(sunPositionWC.xy, -sunPositionWC.z, 1.0);

    // If sun is not in the screen space, use original color.
    if(!isSpace || !((sunPos.x >= -1.1 && sunPos.x <= 1.1) && (sunPos.y >= -1.1 && sunPos.y <= 1.1)))
    {
        // Lens flare is disabled when not in space until #5932 is fixed.
        //    https://github.com/CesiumGS/cesium/issues/5932
        out_FragColor = originalColor;
        return;
    }

    vec2 texcoord = vec2(1.0) - v_textureCoordinates;
    vec2 pixelSize = czm_pixelRatio / czm_viewport.zw;
    vec2 invPixelSize = 1.0 / pixelSize;
    vec3 distortionVec = pixelSize.x * vec3(-distortion, 0.0, distortion);

    // ghost vector to image centre:
    vec2 ghostVec = (vec2(0.5) - texcoord) * ghostDispersal;
    vec3 direction = normalize(vec3(ghostVec, 0.0));

    // sample ghosts:
    vec4 result = vec4(0.0);
    vec4 ghost = vec4(0.0);
    for (int i = 0; i < 4; ++i)
    {
        vec2 offset = fract(texcoord + ghostVec * float(i));
        // Only bright spots from the centre of the source image
        ghost += textureDistorted(colorTexture, offset, direction.xy, distortionVec, isSpace);
    }
    result += ghost;

    // sample halo
    vec2 haloVec = normalize(ghostVec) * haloWidth;
    float weightForHalo = length(vec2(0.5) - fract(texcoord + haloVec)) / length(vec2(0.5));
    weightForHalo = pow(1.0 - weightForHalo, 5.0);

    result += textureDistorted(colorTexture, texcoord + haloVec, direction.xy, distortionVec, isSpace) * weightForHalo * 1.5;

    // dirt on lens
    vec2 dirtTexCoords = (v_textureCoordinates * invPixelSize) / dirtTextureDimensions;
    if (dirtTexCoords.x > 1.0)
    {
        dirtTexCoords.x = mod(floor(dirtTexCoords.x), 2.0) == 1.0 ? 1.0 - fract(dirtTexCoords.x) :  fract(dirtTexCoords.x);
    }
    if (dirtTexCoords.y > 1.0)
    {
        dirtTexCoords.y = mod(floor(dirtTexCoords.y), 2.0) == 1.0 ? 1.0 - fract(dirtTexCoords.y) :  fract(dirtTexCoords.y);
    }
    result += dirtAmount * texture(dirtTexture, dirtTexCoords);

    // Rotating starburst texture's coordinate
    // dot(czm_view[0].xyz, vec3(0.0, 0.0, 1.0)) + dot(czm_view[1].xyz, vec3(0.0, 1.0, 0.0))
    float camrot = czm_view[0].z + czm_view[1].y;
    float cosValue = cos(camrot);
    float sinValue = sin(camrot);
    mat3 rotation = mat3(
        cosValue, -sinValue, 0.0,
        sinValue, cosValue, 0.0,
        0.0, 0.0, 1.0
    );

    vec3 st1 = vec3(v_textureCoordinates * 2.0 - vec2(1.0), 1.0);
    vec3 st2 = vec3((rotation * st1).xy, 1.0);
    vec3 st3 = st2 * 0.5 + vec3(0.5);
    vec2 lensStarTexcoord = st3.xy;
    float weightForLensFlare = length(vec3(sunPos.xy, 0.0));
    float oneMinusWeightForLensFlare = max(1.0 - weightForLensFlare, 0.0);

    if (!isSpace)
    {
        result *= oneMinusWeightForLensFlare * intensity * 0.2;
    }
    else
    {
        result *= oneMinusWeightForLensFlare * intensity;
        result *= texture(starTexture, lensStarTexcoord) * pow(weightForLensFlare, 1.0) * max((1.0 - length(vec3(st1.xy, 0.0))), 0.0) * 2.0;
    }

    result += texture(colorTexture, v_textureCoordinates);

    out_FragColor = result;
}
`;var m8=`uniform sampler2D colorTexture;
uniform vec3 white;

in vec2 v_textureCoordinates;

#ifdef AUTO_EXPOSURE
uniform sampler2D autoExposure;
#else
uniform float exposure;
#endif

// See equation 4:
//    http://www.cs.utah.edu/~reinhard/cdrom/tonemap.pdf

void main()
{
    vec4 fragmentColor = texture(colorTexture, v_textureCoordinates);
    vec3 color = fragmentColor.rgb;
#ifdef AUTO_EXPOSURE
    float exposure = texture(autoExposure, vec2(0.5)).r;
    color /= exposure;
#else
    color *= vec3(exposure);
#endif
    color = (color * (1.0 + color / white)) / (1.0 + color);
    color = czm_inverseGamma(color);
    out_FragColor = vec4(color, fragmentColor.a);
}
`;var p8=`uniform sampler2D colorTexture;

in vec2 v_textureCoordinates;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy ,vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    float noiseValue = rand(v_textureCoordinates + sin(czm_frameNumber)) * 0.1;
    vec3 rgb = texture(colorTexture, v_textureCoordinates).rgb;
    vec3 green = vec3(0.0, 1.0, 0.0);
    out_FragColor = vec4((noiseValue + rgb) * green, 1.0);
}
`;var _8=`uniform sampler2D colorTexture;

in vec2 v_textureCoordinates;

#ifdef AUTO_EXPOSURE
uniform sampler2D autoExposure;
#else
uniform float exposure;
#endif

// See equation 3:
//    http://www.cs.utah.edu/~reinhard/cdrom/tonemap.pdf

void main()
{
    vec4 fragmentColor = texture(colorTexture, v_textureCoordinates);
    vec3 color = fragmentColor.rgb;
#ifdef AUTO_EXPOSURE
    float exposure = texture(autoExposure, vec2(0.5)).r;
    color /= exposure;
#else
    color *= vec3(exposure);
#endif
    color = color / (1.0 + color);
    color = czm_inverseGamma(color);
    out_FragColor = vec4(color, fragmentColor.a);
}
`;var g8=`uniform sampler2D colorTexture;
uniform sampler2D silhouetteTexture;

in vec2 v_textureCoordinates;

void main(void)
{
    vec4 silhouetteColor = texture(silhouetteTexture, v_textureCoordinates);
    vec4 color = texture(colorTexture, v_textureCoordinates);
    out_FragColor = mix(color, silhouetteColor, silhouetteColor.a);
}
`;/**
 * @license
 * Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *  * Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 *  * Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *  * Neither the name of NVIDIA CORPORATION nor the names of its
 *    contributors may be used to endorse or promote products derived
 *    from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */var y8=`/**
 * @license
 * Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *  * Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 *  * Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *  * Neither the name of NVIDIA CORPORATION nor the names of its
 *    contributors may be used to endorse or promote products derived
 *    from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS \`\`AS IS'' AND ANY
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

// NVIDIA GameWorks Graphics Samples GitHub link: https://github.com/NVIDIAGameWorks/GraphicsSamples
// Original FXAA 3.11 shader link: https://github.com/NVIDIAGameWorks/GraphicsSamples/blob/master/samples/es3-kepler/FXAA/FXAA3_11.h

// Steps used to integrate into Cesium:
// * The following defines are set:
//       #define FXAA_PC 1
//       #define FXAA_WEBGL_1 1
//       #define FXAA_GREEN_AS_LUMA 1
//       #define FXAA_EARLY_EXIT 1
//       #define FXAA_GLSL_120 1
// * All other preprocessor directives besides the FXAA_QUALITY__P* directives were removed.
// * Double underscores are invalid for preprocessor directives so replace them with a single underscore. Replace
//   /FXAA_QUALITY__P(.*)/g with /FXAA_QUALITY__P$1/.
// * There are no implicit conversions from ivec* to vec* so replace:
//       #define FxaaInt2 ivec2
//           with
//       #define FxaaInt2 vec2
// * The texture2DLod function is only available in vertex shaders so replace:
//       #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)
//       #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)
//           with
//       #define FxaaTexTop(t, p) texture(t, p)
//       #define FxaaTexOff(t, p, o, r) texture(t, p + (o * r))
// * FXAA_QUALITY_PRESET is prepended in the javascript code. We may want to expose that setting in the future.
// * The following parameters to FxaaPixelShader are unused and can be removed:
//       fxaaConsolePosPos
//       fxaaConsoleRcpFrameOpt
//       fxaaConsoleRcpFrameOpt2
//       fxaaConsole360RcpFrameOpt2
//       fxaaConsoleEdgeSharpness
//       fxaaConsoleEdgeThreshold
//       fxaaConsoleEdgeThresholdMi
//       fxaaConsole360ConstDir

//
// Choose the quality preset.
// This needs to be compiled into the shader as it effects code.
// Best option to include multiple presets is to
// in each shader define the preset, then include this file.
//
// OPTIONS
// -----------------------------------------------------------------------
// 10 to 15 - default medium dither (10=fastest, 15=highest quality)
// 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)
// 39       - no dither, very expensive
//
// NOTES
// -----------------------------------------------------------------------
// 12 = slightly faster then FXAA 3.9 and higher edge quality (default)
// 13 = about same speed as FXAA 3.9 and better than 12
// 23 = closest to FXAA 3.9 visually and performance wise
//  _ = the lowest digit is directly related to performance
// _  = the highest digit is directly related to style
//
//#define FXAA_QUALITY_PRESET 12


#if (FXAA_QUALITY_PRESET == 10)
    #define FXAA_QUALITY_PS 3
    #define FXAA_QUALITY_P0 1.5
    #define FXAA_QUALITY_P1 3.0
    #define FXAA_QUALITY_P2 12.0
#endif
#if (FXAA_QUALITY_PRESET == 11)
    #define FXAA_QUALITY_PS 4
    #define FXAA_QUALITY_P0 1.0
    #define FXAA_QUALITY_P1 1.5
    #define FXAA_QUALITY_P2 3.0
    #define FXAA_QUALITY_P3 12.0
#endif
#if (FXAA_QUALITY_PRESET == 12)
    #define FXAA_QUALITY_PS 5
    #define FXAA_QUALITY_P0 1.0
    #define FXAA_QUALITY_P1 1.5
    #define FXAA_QUALITY_P2 2.0
    #define FXAA_QUALITY_P3 4.0
    #define FXAA_QUALITY_P4 12.0
#endif
#if (FXAA_QUALITY_PRESET == 13)
    #define FXAA_QUALITY_PS 6
    #define FXAA_QUALITY_P0 1.0
    #define FXAA_QUALITY_P1 1.5
    #define FXAA_QUALITY_P2 2.0
    #define FXAA_QUALITY_P3 2.0
    #define FXAA_QUALITY_P4 4.0
    #define FXAA_QUALITY_P5 12.0
#endif
#if (FXAA_QUALITY_PRESET == 14)
    #define FXAA_QUALITY_PS 7
    #define FXAA_QUALITY_P0 1.0
    #define FXAA_QUALITY_P1 1.5
    #define FXAA_QUALITY_P2 2.0
    #define FXAA_QUALITY_P3 2.0
    #define FXAA_QUALITY_P4 2.0
    #define FXAA_QUALITY_P5 4.0
    #define FXAA_QUALITY_P6 12.0
#endif
#if (FXAA_QUALITY_PRESET == 15)
    #define FXAA_QUALITY_PS 8
    #define FXAA_QUALITY_P0 1.0
    #define FXAA_QUALITY_P1 1.5
    #define FXAA_QUALITY_P2 2.0
    #define FXAA_QUALITY_P3 2.0
    #define FXAA_QUALITY_P4 2.0
    #define FXAA_QUALITY_P5 2.0
    #define FXAA_QUALITY_P6 4.0
    #define FXAA_QUALITY_P7 12.0
#endif
#if (FXAA_QUALITY_PRESET == 20)
    #define FXAA_QUALITY_PS 3
    #define FXAA_QUALITY_P0 1.5
    #define FXAA_QUALITY_P1 2.0
    #define FXAA_QUALITY_P2 8.0
#endif
#if (FXAA_QUALITY_PRESET == 21)
    #define FXAA_QUALITY_PS 4
    #define FXAA_QUALITY_P0 1.0
    #define FXAA_QUALITY_P1 1.5
    #define FXAA_QUALITY_P2 2.0
    #define FXAA_QUALITY_P3 8.0
#endif
#if (FXAA_QUALITY_PRESET == 22)
    #define FXAA_QUALITY_PS 5
    #define FXAA_QUALITY_P0 1.0
    #define FXAA_QUALITY_P1 1.5
    #define FXAA_QUALITY_P2 2.0
    #define FXAA_QUALITY_P3 2.0
    #define FXAA_QUALITY_P4 8.0
#endif
#if (FXAA_QUALITY_PRESET == 23)
    #define FXAA_QUALITY_PS 6
    #define FXAA_QUALITY_P0 1.0
    #define FXAA_QUALITY_P1 1.5
    #define FXAA_QUALITY_P2 2.0
    #define FXAA_QUALITY_P3 2.0
    #define FXAA_QUALITY_P4 2.0
    #define FXAA_QUALITY_P5 8.0
#endif
#if (FXAA_QUALITY_PRESET == 24)
    #define FXAA_QUALITY_PS 7
    #define FXAA_QUALITY_P0 1.0
    #define FXAA_QUALITY_P1 1.5
    #define FXAA_QUALITY_P2 2.0
    #define FXAA_QUALITY_P3 2.0
    #define FXAA_QUALITY_P4 2.0
    #define FXAA_QUALITY_P5 3.0
    #define FXAA_QUALITY_P6 8.0
#endif
#if (FXAA_QUALITY_PRESET == 25)
    #define FXAA_QUALITY_PS 8
    #define FXAA_QUALITY_P0 1.0
    #define FXAA_QUALITY_P1 1.5
    #define FXAA_QUALITY_P2 2.0
    #define FXAA_QUALITY_P3 2.0
    #define FXAA_QUALITY_P4 2.0
    #define FXAA_QUALITY_P5 2.0
    #define FXAA_QUALITY_P6 4.0
    #define FXAA_QUALITY_P7 8.0
#endif
#if (FXAA_QUALITY_PRESET == 26)
    #define FXAA_QUALITY_PS 9
    #define FXAA_QUALITY_P0 1.0
    #define FXAA_QUALITY_P1 1.5
    #define FXAA_QUALITY_P2 2.0
    #define FXAA_QUALITY_P3 2.0
    #define FXAA_QUALITY_P4 2.0
    #define FXAA_QUALITY_P5 2.0
    #define FXAA_QUALITY_P6 2.0
    #define FXAA_QUALITY_P7 4.0
    #define FXAA_QUALITY_P8 8.0
#endif
#if (FXAA_QUALITY_PRESET == 27)
    #define FXAA_QUALITY_PS 10
    #define FXAA_QUALITY_P0 1.0
    #define FXAA_QUALITY_P1 1.5
    #define FXAA_QUALITY_P2 2.0
    #define FXAA_QUALITY_P3 2.0
    #define FXAA_QUALITY_P4 2.0
    #define FXAA_QUALITY_P5 2.0
    #define FXAA_QUALITY_P6 2.0
    #define FXAA_QUALITY_P7 2.0
    #define FXAA_QUALITY_P8 4.0
    #define FXAA_QUALITY_P9 8.0
#endif
#if (FXAA_QUALITY_PRESET == 28)
    #define FXAA_QUALITY_PS 11
    #define FXAA_QUALITY_P0 1.0
    #define FXAA_QUALITY_P1 1.5
    #define FXAA_QUALITY_P2 2.0
    #define FXAA_QUALITY_P3 2.0
    #define FXAA_QUALITY_P4 2.0
    #define FXAA_QUALITY_P5 2.0
    #define FXAA_QUALITY_P6 2.0
    #define FXAA_QUALITY_P7 2.0
    #define FXAA_QUALITY_P8 2.0
    #define FXAA_QUALITY_P9 4.0
    #define FXAA_QUALITY_P10 8.0
#endif
#if (FXAA_QUALITY_PRESET == 29)
    #define FXAA_QUALITY_PS 12
    #define FXAA_QUALITY_P0 1.0
    #define FXAA_QUALITY_P1 1.5
    #define FXAA_QUALITY_P2 2.0
    #define FXAA_QUALITY_P3 2.0
    #define FXAA_QUALITY_P4 2.0
    #define FXAA_QUALITY_P5 2.0
    #define FXAA_QUALITY_P6 2.0
    #define FXAA_QUALITY_P7 2.0
    #define FXAA_QUALITY_P8 2.0
    #define FXAA_QUALITY_P9 2.0
    #define FXAA_QUALITY_P10 4.0
    #define FXAA_QUALITY_P11 8.0
#endif
#if (FXAA_QUALITY_PRESET == 39)
    #define FXAA_QUALITY_PS 12
    #define FXAA_QUALITY_P0 1.0
    #define FXAA_QUALITY_P1 1.0
    #define FXAA_QUALITY_P2 1.0
    #define FXAA_QUALITY_P3 1.0
    #define FXAA_QUALITY_P4 1.0
    #define FXAA_QUALITY_P5 1.5
    #define FXAA_QUALITY_P6 2.0
    #define FXAA_QUALITY_P7 2.0
    #define FXAA_QUALITY_P8 2.0
    #define FXAA_QUALITY_P9 2.0
    #define FXAA_QUALITY_P10 4.0
    #define FXAA_QUALITY_P11 8.0
#endif

#define FxaaBool bool
#define FxaaFloat float
#define FxaaFloat2 vec2
#define FxaaFloat3 vec3
#define FxaaFloat4 vec4
#define FxaaHalf float
#define FxaaHalf2 vec2
#define FxaaHalf3 vec3
#define FxaaHalf4 vec4
#define FxaaInt2 vec2
#define FxaaTex sampler2D

#define FxaaSat(x) clamp(x, 0.0, 1.0)
#define FxaaTexTop(t, p) texture(t, p)
#define FxaaTexOff(t, p, o, r) texture(t, p + (o * r))

FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }

FxaaFloat4 FxaaPixelShader(
    //
    // Use noperspective interpolation here (turn off perspective interpolation).
    // {xy} = center of pixel
    FxaaFloat2 pos,
    //
    // Input color texture.
    // {rgb_} = color in linear or perceptual color space
    // if (FXAA_GREEN_AS_LUMA == 0)
    //     {___a} = luma in perceptual color space (not linear)
    FxaaTex tex,
    //
    // Only used on FXAA Quality.
    // This must be from a constant/uniform.
    // {x_} = 1.0/screenWidthInPixels
    // {_y} = 1.0/screenHeightInPixels
    FxaaFloat2 fxaaQualityRcpFrame,
    //
    // Only used on FXAA Quality.
    // This used to be the FXAA_QUALITY_SUBPIX define.
    // It is here now to allow easier tuning.
    // Choose the amount of sub-pixel aliasing removal.
    // This can effect sharpness.
    //   1.00 - upper limit (softer)
    //   0.75 - default amount of filtering
    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)
    //   0.25 - almost off
    //   0.00 - completely off
    FxaaFloat fxaaQualitySubpix,
    //
    // Only used on FXAA Quality.
    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.
    // It is here now to allow easier tuning.
    // The minimum amount of local contrast required to apply algorithm.
    //   0.333 - too little (faster)
    //   0.250 - low quality
    //   0.166 - default
    //   0.125 - high quality
    //   0.063 - overkill (slower)
    FxaaFloat fxaaQualityEdgeThreshold,
    //
    // Only used on FXAA Quality.
    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.
    // It is here now to allow easier tuning.
    // Trims the algorithm from processing darks.
    //   0.0833 - upper limit (default, the start of visible unfiltered edges)
    //   0.0625 - high quality (faster)
    //   0.0312 - visible limit (slower)
    // Special notes when using FXAA_GREEN_AS_LUMA,
    //   Likely want to set this to zero.
    //   As colors that are mostly not-green
    //   will appear very dark in the green channel!
    //   Tune by looking at mostly non-green content,
    //   then start at zero and increase until aliasing is a problem.
    FxaaFloat fxaaQualityEdgeThresholdMin
) {
/*--------------------------------------------------------------------------*/
    FxaaFloat2 posM;
    posM.x = pos.x;
    posM.y = pos.y;
    FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);
    #define lumaM rgbyM.y
    FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));
    FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));
    FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));
    FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));
/*--------------------------------------------------------------------------*/
    FxaaFloat maxSM = max(lumaS, lumaM);
    FxaaFloat minSM = min(lumaS, lumaM);
    FxaaFloat maxESM = max(lumaE, maxSM);
    FxaaFloat minESM = min(lumaE, minSM);
    FxaaFloat maxWN = max(lumaN, lumaW);
    FxaaFloat minWN = min(lumaN, lumaW);
    FxaaFloat rangeMax = max(maxWN, maxESM);
    FxaaFloat rangeMin = min(minWN, minESM);
    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;
    FxaaFloat range = rangeMax - rangeMin;
    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);
    FxaaBool earlyExit = range < rangeMaxClamped;
/*--------------------------------------------------------------------------*/
    if(earlyExit)
        return rgbyM;
/*--------------------------------------------------------------------------*/
    FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));
    FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));
    FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));
    FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));
/*--------------------------------------------------------------------------*/
    FxaaFloat lumaNS = lumaN + lumaS;
    FxaaFloat lumaWE = lumaW + lumaE;
    FxaaFloat subpixRcpRange = 1.0/range;
    FxaaFloat subpixNSWE = lumaNS + lumaWE;
    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;
    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;
/*--------------------------------------------------------------------------*/
    FxaaFloat lumaNESE = lumaNE + lumaSE;
    FxaaFloat lumaNWNE = lumaNW + lumaNE;
    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;
    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;
/*--------------------------------------------------------------------------*/
    FxaaFloat lumaNWSW = lumaNW + lumaSW;
    FxaaFloat lumaSWSE = lumaSW + lumaSE;
    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);
    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);
    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;
    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;
    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;
    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;
/*--------------------------------------------------------------------------*/
    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;
    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;
    FxaaBool horzSpan = edgeHorz >= edgeVert;
    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;
/*--------------------------------------------------------------------------*/
    if(!horzSpan) lumaN = lumaW;
    if(!horzSpan) lumaS = lumaE;
    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;
    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;
/*--------------------------------------------------------------------------*/
    FxaaFloat gradientN = lumaN - lumaM;
    FxaaFloat gradientS = lumaS - lumaM;
    FxaaFloat lumaNN = lumaN + lumaM;
    FxaaFloat lumaSS = lumaS + lumaM;
    FxaaBool pairN = abs(gradientN) >= abs(gradientS);
    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));
    if(pairN) lengthSign = -lengthSign;
    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);
/*--------------------------------------------------------------------------*/
    FxaaFloat2 posB;
    posB.x = posM.x;
    posB.y = posM.y;
    FxaaFloat2 offNP;
    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;
    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;
    if(!horzSpan) posB.x += lengthSign * 0.5;
    if( horzSpan) posB.y += lengthSign * 0.5;
/*--------------------------------------------------------------------------*/
    FxaaFloat2 posN;
    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;
    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;
    FxaaFloat2 posP;
    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;
    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;
    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;
    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));
    FxaaFloat subpixE = subpixC * subpixC;
    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));
/*--------------------------------------------------------------------------*/
    if(!pairN) lumaNN = lumaSS;
    FxaaFloat gradientScaled = gradient * 1.0/4.0;
    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;
    FxaaFloat subpixF = subpixD * subpixE;
    FxaaBool lumaMLTZero = lumaMM < 0.0;
/*--------------------------------------------------------------------------*/
    lumaEndN -= lumaNN * 0.5;
    lumaEndP -= lumaNN * 0.5;
    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;
    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;
    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;
    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;
    FxaaBool doneNP = (!doneN) || (!doneP);
    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;
    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;
/*--------------------------------------------------------------------------*/
    if(doneNP) {
        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
        doneN = abs(lumaEndN) >= gradientScaled;
        doneP = abs(lumaEndP) >= gradientScaled;
        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;
        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;
        doneNP = (!doneN) || (!doneP);
        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;
        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;
/*--------------------------------------------------------------------------*/
        #if (FXAA_QUALITY_PS > 3)
        if(doneNP) {
            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
            doneN = abs(lumaEndN) >= gradientScaled;
            doneP = abs(lumaEndP) >= gradientScaled;
            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;
            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;
            doneNP = (!doneN) || (!doneP);
            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;
            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;
/*--------------------------------------------------------------------------*/
            #if (FXAA_QUALITY_PS > 4)
            if(doneNP) {
                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
                doneN = abs(lumaEndN) >= gradientScaled;
                doneP = abs(lumaEndP) >= gradientScaled;
                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;
                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;
                doneNP = (!doneN) || (!doneP);
                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;
                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;
/*--------------------------------------------------------------------------*/
                #if (FXAA_QUALITY_PS > 5)
                if(doneNP) {
                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
                    doneN = abs(lumaEndN) >= gradientScaled;
                    doneP = abs(lumaEndP) >= gradientScaled;
                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;
                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;
                    doneNP = (!doneN) || (!doneP);
                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;
                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;
/*--------------------------------------------------------------------------*/
                    #if (FXAA_QUALITY_PS > 6)
                    if(doneNP) {
                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
                        doneN = abs(lumaEndN) >= gradientScaled;
                        doneP = abs(lumaEndP) >= gradientScaled;
                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;
                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;
                        doneNP = (!doneN) || (!doneP);
                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;
                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;
/*--------------------------------------------------------------------------*/
                        #if (FXAA_QUALITY_PS > 7)
                        if(doneNP) {
                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
                            doneN = abs(lumaEndN) >= gradientScaled;
                            doneP = abs(lumaEndP) >= gradientScaled;
                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;
                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;
                            doneNP = (!doneN) || (!doneP);
                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;
                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;
/*--------------------------------------------------------------------------*/
    #if (FXAA_QUALITY_PS > 8)
    if(doneNP) {
        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
        doneN = abs(lumaEndN) >= gradientScaled;
        doneP = abs(lumaEndP) >= gradientScaled;
        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;
        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;
        doneNP = (!doneN) || (!doneP);
        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;
        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;
/*--------------------------------------------------------------------------*/
        #if (FXAA_QUALITY_PS > 9)
        if(doneNP) {
            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
            doneN = abs(lumaEndN) >= gradientScaled;
            doneP = abs(lumaEndP) >= gradientScaled;
            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;
            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;
            doneNP = (!doneN) || (!doneP);
            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;
            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;
/*--------------------------------------------------------------------------*/
            #if (FXAA_QUALITY_PS > 10)
            if(doneNP) {
                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
                doneN = abs(lumaEndN) >= gradientScaled;
                doneP = abs(lumaEndP) >= gradientScaled;
                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;
                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;
                doneNP = (!doneN) || (!doneP);
                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;
                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;
/*--------------------------------------------------------------------------*/
                #if (FXAA_QUALITY_PS > 11)
                if(doneNP) {
                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
                    doneN = abs(lumaEndN) >= gradientScaled;
                    doneP = abs(lumaEndP) >= gradientScaled;
                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;
                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;
                    doneNP = (!doneN) || (!doneP);
                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;
                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;
/*--------------------------------------------------------------------------*/
                    #if (FXAA_QUALITY_PS > 12)
                    if(doneNP) {
                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
                        doneN = abs(lumaEndN) >= gradientScaled;
                        doneP = abs(lumaEndP) >= gradientScaled;
                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;
                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;
                        doneNP = (!doneN) || (!doneP);
                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;
                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;
/*--------------------------------------------------------------------------*/
                    }
                    #endif
/*--------------------------------------------------------------------------*/
                }
                #endif
/*--------------------------------------------------------------------------*/
            }
            #endif
/*--------------------------------------------------------------------------*/
        }
        #endif
/*--------------------------------------------------------------------------*/
    }
    #endif
/*--------------------------------------------------------------------------*/
                        }
                        #endif
/*--------------------------------------------------------------------------*/
                    }
                    #endif
/*--------------------------------------------------------------------------*/
                }
                #endif
/*--------------------------------------------------------------------------*/
            }
            #endif
/*--------------------------------------------------------------------------*/
        }
        #endif
/*--------------------------------------------------------------------------*/
    }
/*--------------------------------------------------------------------------*/
    FxaaFloat dstN = posM.x - posN.x;
    FxaaFloat dstP = posP.x - posM.x;
    if(!horzSpan) dstN = posM.y - posN.y;
    if(!horzSpan) dstP = posP.y - posM.y;
/*--------------------------------------------------------------------------*/
    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;
    FxaaFloat spanLength = (dstP + dstN);
    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;
    FxaaFloat spanLengthRcp = 1.0/spanLength;
/*--------------------------------------------------------------------------*/
    FxaaBool directionN = dstN < dstP;
    FxaaFloat dst = min(dstN, dstP);
    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;
    FxaaFloat subpixG = subpixF * subpixF;
    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;
    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;
/*--------------------------------------------------------------------------*/
    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;
    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);
    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;
    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;
    return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);
}
`;function vb(){this._uniformMap=void 0,this._command=void 0,this._colorTexture=void 0,this._depthTexture=void 0,this._ready=!1,this._name="czm_autoexposure",this._logDepthChanged=void 0,this._useLogDepth=void 0,this._framebuffers=void 0,this._previousLuminance=new pi,this._commands=void 0,this._clearCommand=void 0,this._minMaxLuminance=new H,this.enabled=!0,this._enabled=!0,this.minimumLuminance=.1,this.maximumLuminance=10}Object.defineProperties(vb.prototype,{ready:{get:function(){return this._ready}},name:{get:function(){return this._name}},outputTexture:{get:function(){let e=this._framebuffers;if(u(e))return e[e.length-1].getColorTexture(0)}}});function ACe(e){let t=e._framebuffers;if(!u(t))return;let n=t.length;for(let i=0;i<n;++i)t[i].destroy();e._framebuffers=void 0,e._previousLuminance.destroy(),e._previousLuminance=void 0}function agt(e,t){ACe(e);let n=e._width,i=e._height,o=t.halfFloatingPointTexture?Ke.HALF_FLOAT:Ke.FLOAT,r=Math.ceil(Math.log(Math.max(n,i))/Math.log(3)),s=new Array(r);for(let c=0;c<r;++c)n=Math.max(Math.ceil(n/3),1),i=Math.max(Math.ceil(i/3),1),s[c]=new pi,s[c].update(t,n,i,1,o);let a=s[r-1].getColorTexture(0);e._previousLuminance.update(t,a.width,a.height,1,o),e._framebuffers=s}function TCe(e){let t=e._commands;if(!u(t))return;let n=t.length;for(let i=0;i<n;++i)t[i].shaderProgram.destroy();e._commands=void 0}function cgt(e,t){let n;if(t===0)n={colorTexture:function(){return e._colorTexture},colorTextureDimensions:function(){return e._colorTexture.dimensions}};else{let i=e._framebuffers[t-1].getColorTexture(0);n={colorTexture:function(){return i},colorTextureDimensions:function(){return i.dimensions}}}return n.minMaxLuminance=function(){return e._minMaxLuminance},n.previousLuminance=function(){return e._previousLuminance.getColorTexture(0)},n}function lgt(e,t){let n=`uniform sampler2D colorTexture; 
in vec2 v_textureCoordinates; 
float sampleTexture(vec2 offset) { 
`;return e===0?n+=`    vec4 color = texture(colorTexture, v_textureCoordinates + offset); 
    return czm_luminance(color.rgb); 
`:n+=`    return texture(colorTexture, v_textureCoordinates + offset).r; 
`,n+=`}

`,n+=`uniform vec2 colorTextureDimensions; 
uniform vec2 minMaxLuminance; 
uniform sampler2D previousLuminance; 
void main() { 
    float color = 0.0; 
    float xStep = 1.0 / colorTextureDimensions.x; 
    float yStep = 1.0 / colorTextureDimensions.y; 
    int count = 0; 
    for (int i = 0; i < 3; ++i) { 
        for (int j = 0; j < 3; ++j) { 
            vec2 offset; 
            offset.x = -xStep + float(i) * xStep; 
            offset.y = -yStep + float(j) * yStep; 
            if (offset.x < 0.0 || offset.x > 1.0 || offset.y < 0.0 || offset.y > 1.0) { 
                continue; 
            } 
            color += sampleTexture(offset); 
            ++count; 
        } 
    } 
    if (count > 0) { 
        color /= float(count); 
    } 
`,e===t-1&&(n+=`    float previous = texture(previousLuminance, vec2(0.5)).r; 
    color = clamp(color, minMaxLuminance.x, minMaxLuminance.y); 
    color = previous + (color - previous) / (60.0 * 1.5); 
    color = clamp(color, minMaxLuminance.x, minMaxLuminance.y); 
`),n+=`    out_FragColor = vec4(color); 
} 
`,n}function ugt(e,t){TCe(e);let n=e._framebuffers,i=n.length,o=new Array(i);for(let r=0;r<i;++r)o[r]=t.createViewportQuadCommand(lgt(r,i),{framebuffer:n[r].framebuffer,uniformMap:cgt(e,r)});e._commands=o}vb.prototype.clear=function(e){let t=this._framebuffers;if(!u(t))return;let n=this._clearCommand;u(n)||(n=this._clearCommand=new ni({color:new G(0,0,0,0),framebuffer:void 0}));let i=t.length;for(let o=0;o<i;++o)t[o].clear(e,n)};vb.prototype.update=function(e){let t=e.drawingBufferWidth,n=e.drawingBufferHeight;(t!==this._width||n!==this._height)&&(this._width=t,this._height=n,agt(this,e),ugt(this,e),this._ready||(this._ready=!0)),this._minMaxLuminance.x=this.minimumLuminance,this._minMaxLuminance.y=this.maximumLuminance;let i=this._framebuffers,o=i[i.length-1];i[i.length-1]=this._previousLuminance,this._commands[this._commands.length-1].framebuffer=this._previousLuminance.framebuffer,this._previousLuminance=o};vb.prototype.execute=function(e,t){this._colorTexture=t;let n=this._commands;if(!u(n))return;let i=n.length;for(let o=0;o<i;++o)n[o].execute(e)};vb.prototype.isDestroyed=function(){return!1};vb.prototype.destroy=function(){return ACe(this),TCe(this),ue(this)};var x8=vb;var fgt={NEAREST:0,LINEAR:1},Kf=fgt;function wb(e){e=x(e,x.EMPTY_OBJECT);let{fragmentShader:t,textureScale:n=1,pixelFormat:i=tt.RGBA}=e;this._fragmentShader=t,this._uniforms=e.uniforms,this._textureScale=n,this._forcePowerOfTwo=x(e.forcePowerOfTwo,!1),this._sampleMode=x(e.sampleMode,Kf.NEAREST),this._pixelFormat=i,this._pixelDatatype=x(e.pixelDatatype,Ke.UNSIGNED_BYTE),this._clearColor=x(e.clearColor,G.BLACK),this._uniformMap=void 0,this._command=void 0,this._colorTexture=void 0,this._depthTexture=void 0,this._idTexture=void 0,this._actualUniforms={},this._dirtyUniforms=[],this._texturesToRelease=[],this._texturesToCreate=[],this._texturePromise=void 0;let o=new Tc;o.scissorTest={enabled:!0,rectangle:u(e.scissorRectangle)?qe.clone(e.scissorRectangle):new qe},this._passState=o,this._ready=!1;let r=e.name;u(r)||(r=Hn()),this._name=r,this._logDepthChanged=void 0,this._useLogDepth=void 0,this._selectedIdTexture=void 0,this._selected=void 0,this._selectedShadow=void 0,this._parentSelected=void 0,this._parentSelectedShadow=void 0,this._combinedSelected=void 0,this._combinedSelectedShadow=void 0,this._selectedLength=0,this._parentSelectedLength=0,this._selectedDirty=!0,this._textureCache=void 0,this._index=void 0,this.enabled=!0,this._enabled=!0}Object.defineProperties(wb.prototype,{ready:{get:function(){return this._ready}},name:{get:function(){return this._name}},fragmentShader:{get:function(){return this._fragmentShader}},uniforms:{get:function(){return this._uniforms}},textureScale:{get:function(){return this._textureScale}},forcePowerOfTwo:{get:function(){return this._forcePowerOfTwo}},sampleMode:{get:function(){return this._sampleMode}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},clearColor:{get:function(){return this._clearColor}},scissorRectangle:{get:function(){return this._passState.scissorTest.rectangle}},outputTexture:{get:function(){if(u(this._textureCache)){let e=this._textureCache.getFramebuffer(this._name);if(u(e))return e.getColorTexture(0)}}},selected:{get:function(){return this._selected},set:function(e){this._selected=e}},parentSelected:{get:function(){return this._parentSelected},set:function(e){this._parentSelected=e}}});var dgt=/uniform\s+sampler2D\s+depthTexture/g;wb.prototype._isSupported=function(e){return!dgt.test(this._fragmentShader)||e.depthTexture};function hgt(e,t,n){let i=t[n];return(typeof i=="string"||i instanceof HTMLCanvasElement||i instanceof HTMLImageElement||i instanceof HTMLVideoElement||i instanceof ImageData)&&e._dirtyUniforms.push(n),{get:function(){return t[n]},set:function(o){let r=t[n];t[n]=o;let s=e._actualUniforms,a=s[n];u(a)&&a!==r&&a instanceof Ot&&!u(e._textureCache.getStageByName(n))&&(e._texturesToRelease.push(a),delete s[n],delete s[`${n}Dimensions`]),r instanceof Ot&&e._texturesToRelease.push(r),typeof o=="string"||o instanceof HTMLCanvasElement||o instanceof HTMLImageElement||o instanceof HTMLVideoElement||o instanceof ImageData?e._dirtyUniforms.push(n):s[n]=o}}}function mgt(e,t){return function(){let n=e._actualUniforms[t];return typeof n=="function"?n():n}}function pgt(e,t){return function(){let n=e[t]();if(u(n))return n.dimensions}}function _gt(e){if(u(e._uniformMap))return;let t={},n={},i=e._uniforms,o=e._actualUniforms;for(let r in i){if(!i.hasOwnProperty(r))continue;typeof i[r]!="function"?(t[r]=mgt(e,r),n[r]=hgt(e,i,r)):(t[r]=i[r],n[r]=i[r]),o[r]=i[r];let s=t[r]();(typeof s=="string"||s instanceof Ot||s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement)&&(t[`${r}Dimensions`]=pgt(t,r))}e._uniforms={},Object.defineProperties(e._uniforms,n),e._uniformMap=bt(t,{colorTexture:function(){return e._colorTexture},colorTextureDimensions:function(){return e._colorTexture.dimensions},depthTexture:function(){return e._depthTexture},depthTextureDimensions:function(){return e._depthTexture.dimensions},czm_idTexture:function(){return e._idTexture},czm_selectedIdTexture:function(){return e._selectedIdTexture},czm_selectedIdTextureStep:function(){return 1/e._selectedIdTexture.width}})}function ggt(e,t){return e=e.replace(/in\s+vec2\s+v_textureCoordinates;/g,""),`#define CZM_SELECTED_FEATURE
uniform sampler2D czm_idTexture;
uniform sampler2D czm_selectedIdTexture;
uniform float czm_selectedIdTextureStep;
in vec2 v_textureCoordinates;
bool czm_selected(vec2 offset)
{
    bool selected = false;
    vec4 id = texture(czm_idTexture, v_textureCoordinates + offset);
    for (int i = 0; i < ${t}; ++i)
    {
        vec4 selectedId = texture(czm_selectedIdTexture, vec2((float(i) + 0.5) * czm_selectedIdTextureStep, 0.5));
        if (all(equal(id, selectedId)))
        {
            return true;
        }
    }
    return false;
}
bool czm_selected()
{
    return czm_selected(vec2(0.0));
}

${e}`}function ygt(e,t){if(u(e._command)&&!e._logDepthChanged&&!e._selectedDirty)return;let n=e._fragmentShader;if(u(e._selectedIdTexture)){let o=e._selectedIdTexture.width;n=ggt(n,o)}let i=new ze({defines:[e._useLogDepth?"LOG_DEPTH":""],sources:[n]});e._command=t.createViewportQuadCommand(i,{uniformMap:e._uniformMap,owner:e})}function xgt(e){let t=e._sampleMode,n,i;t===Kf.LINEAR?(n=$t.LINEAR,i=mi.LINEAR):(n=$t.NEAREST,i=mi.NEAREST);let o=e._sampler;(!u(o)||o.minificationFilter!==n||o.magnificationFilter!==i)&&(e._sampler=new Qt({wrapS:En.CLAMP_TO_EDGE,wrapT:En.CLAMP_TO_EDGE,minificationFilter:n,magnificationFilter:i}))}function bgt(e,t){return function(n){e._texturesToCreate.push({name:t,source:n})}}function Cgt(e,t){return function(){return e._textureCache.getOutputTexture(t)}}function Agt(e,t){let n=e._texturesToRelease;for(let a=0;a<n.length;++a){let c=n[a];c=c&&c.destroy()}n.length=0;let i=e._texturesToCreate;for(let a=0;a<i.length;++a){let{name:c,source:l}=i[a];e._actualUniforms[c]=new Ot({context:t,source:l})}i.length=0;let o=e._dirtyUniforms;if(o.length===0&&!u(e._texturePromise)){e._ready=!0;return}if(o.length===0||u(e._texturePromise))return;let r=e._uniforms,s=[];for(let a=0;a<o.length;++a){let c=o[a],l=r[c],f=e._textureCache.getStageByName(l);if(u(f))e._actualUniforms[c]=Cgt(e,l);else if(typeof l=="string"){let d=new De({url:l});s.push(d.fetchImage().then(bgt(e,c)))}else e._texturesToCreate.push({name:c,source:l})}o.length=0,s.length>0?(e._ready=!1,e._texturePromise=Promise.all(s).then(function(){e._ready=!0,e._texturePromise=void 0})):e._ready=!0}function ECe(e){u(e._command)&&(e._command.shaderProgram=e._command.shaderProgram&&e._command.shaderProgram.destroy(),e._command=void 0),e._selectedIdTexture=e._selectedIdTexture&&e._selectedIdTexture.destroy();let t=e._textureCache;if(!u(t))return;let n=e._uniforms,i=e._actualUniforms;for(let o in i){if(!i.hasOwnProperty(o))continue;let r=i[o];r instanceof Ot&&(u(t.getStageByName(n[o]))||r.destroy(),e._dirtyUniforms.push(o))}}function Tgt(e){let t=u(e._selected)?e._selected.length:0,n=u(e._parentSelected)?e._parentSelected:0,i=e._selected!==e._selectedShadow||t!==e._selectedLength||e._parentSelected!==e._parentSelectedShadow||n!==e._parentSelectedLength;if(u(e._selected)&&u(e._parentSelected)?e._combinedSelected=e._selected.concat(e._parentSelected):u(e._parentSelected)?e._combinedSelected=e._parentSelected:e._combinedSelected=e._selected,!i&&u(e._combinedSelected)){if(!u(e._combinedSelectedShadow))return!0;for(let o=0;o<e._combinedSelected.length;++o)if(e._combinedSelected[o]!==e._combinedSelectedShadow[o])return!0}return i}function Egt(e,t){if(!e._selectedDirty)return;e._selectedIdTexture=e._selectedIdTexture&&e._selectedIdTexture.destroy(),e._selectedIdTexture=void 0;let n=e._combinedSelected;if(!u(n))return;let i=0;for(let s=0;s<n.length;++s){let a=n[s];u(a.pickIds)?i+=a.pickIds.length:u(a.pickId)&&++i}if(n.length===0||i===0){let s=new Uint8Array([255,255,255,255]);e._selectedIdTexture=new Ot({context:t,pixelFormat:tt.RGBA,pixelDatatype:Ke.UNSIGNED_BYTE,source:{arrayBufferView:s,width:1,height:1},sampler:Qt.NEAREST});return}let o=0,r=new Uint8Array(i*4);for(let s=0;s<n.length;++s){let a=n[s];if(u(a.pickIds)){let c=a.pickIds,l=c.length;for(let f=0;f<l;++f){let d=c[f].color;r[o]=G.floatToByte(d.red),r[o+1]=G.floatToByte(d.green),r[o+2]=G.floatToByte(d.blue),r[o+3]=G.floatToByte(d.alpha),o+=4}}else if(u(a.pickId)){let c=a.pickId.color;r[o]=G.floatToByte(c.red),r[o+1]=G.floatToByte(c.green),r[o+2]=G.floatToByte(c.blue),r[o+3]=G.floatToByte(c.alpha),o+=4}}e._selectedIdTexture=new Ot({context:t,pixelFormat:tt.RGBA,pixelDatatype:Ke.UNSIGNED_BYTE,source:{arrayBufferView:r,width:i,height:1},sampler:Qt.NEAREST})}wb.prototype.update=function(e,t){if(this.enabled!==this._enabled&&!this.enabled&&ECe(this),this._enabled=this.enabled,!this._enabled||(this._logDepthChanged=t!==this._useLogDepth,this._useLogDepth=t,this._selectedDirty=Tgt(this),this._selectedShadow=this._selected,this._parentSelectedShadow=this._parentSelected,this._combinedSelectedShadow=this._combinedSelected,this._selectedLength=u(this._selected)?this._selected.length:0,this._parentSelectedLength=u(this._parentSelected)?this._parentSelected.length:0,Egt(this,e),_gt(this),Agt(this,e),ygt(this,e),xgt(this),this._selectedDirty=!1,!this._ready))return;let n=this._textureCache.getFramebuffer(this._name);if(this._command.framebuffer=n,!u(n))return;let i=n.getColorTexture(0),o;(i.width!==e.drawingBufferWidth||i.height!==e.drawingBufferHeight)&&(o=this._renderState,(!u(o)||i.width!==o.viewport.width||i.height!==o.viewport.height)&&(this._renderState=Ue.fromCache({viewport:new qe(0,0,i.width,i.height)}))),this._command.renderState=o};wb.prototype.execute=function(e,t,n,i){if(!u(this._command)||!u(this._command.framebuffer)||!this._ready||!this._enabled)return;this._colorTexture=t,this._depthTexture=n,this._idTexture=i,Qt.equals(this._colorTexture.sampler,this._sampler)||(this._colorTexture.sampler=this._sampler);let o=this.scissorRectangle.width>0&&this.scissorRectangle.height>0?this._passState:void 0;u(o)&&(o.context=e),this._command.execute(e,o)};wb.prototype.isDestroyed=function(){return!1};wb.prototype.destroy=function(){return ECe(this),ue(this)};var xo=wb;function Db(e){e=x(e,x.EMPTY_OBJECT),this._stages=e.stages,this._inputPreviousStageTexture=x(e.inputPreviousStageTexture,!0);let t=e.name;u(t)||(t=Hn()),this._name=t,this._uniforms=e.uniforms,this._textureCache=void 0,this._index=void 0,this._selected=void 0,this._selectedShadow=void 0,this._parentSelected=void 0,this._parentSelectedShadow=void 0,this._combinedSelected=void 0,this._combinedSelectedShadow=void 0,this._selectedLength=0,this._parentSelectedLength=0,this._selectedDirty=!0}Object.defineProperties(Db.prototype,{ready:{get:function(){let e=this._stages,t=e.length;for(let n=0;n<t;++n)if(!e[n].ready)return!1;return!0}},name:{get:function(){return this._name}},enabled:{get:function(){return this._stages[0].enabled},set:function(e){let t=this._stages,n=t.length;for(let i=0;i<n;++i)t[i].enabled=e}},uniforms:{get:function(){return this._uniforms}},inputPreviousStageTexture:{get:function(){return this._inputPreviousStageTexture}},length:{get:function(){return this._stages.length}},selected:{get:function(){return this._selected},set:function(e){this._selected=e}},parentSelected:{get:function(){return this._parentSelected},set:function(e){this._parentSelected=e}}});Db.prototype._isSupported=function(e){let t=this._stages,n=t.length;for(let i=0;i<n;++i)if(!t[i]._isSupported(e))return!1;return!0};Db.prototype.get=function(e){return this._stages[e]};function Sgt(e){let t=u(e._selected)?e._selected.length:0,n=u(e._parentSelected)?e._parentSelected:0,i=e._selected!==e._selectedShadow||t!==e._selectedLength;if(i=i||e._parentSelected!==e._parentSelectedShadow||n!==e._parentSelectedLength,u(e._selected)&&u(e._parentSelected)?e._combinedSelected=e._selected.concat(e._parentSelected):u(e._parentSelected)?e._combinedSelected=e._parentSelected:e._combinedSelected=e._selected,!i&&u(e._combinedSelected)){if(!u(e._combinedSelectedShadow))return!0;t=e._combinedSelected.length;for(let o=0;o<t;++o)if(e._combinedSelected[o]!==e._combinedSelectedShadow[o])return!0}return i}Db.prototype.update=function(e,t){this._selectedDirty=Sgt(this),this._selectedShadow=this._selected,this._parentSelectedShadow=this._parentSelected,this._combinedSelectedShadow=this._combinedSelected,this._selectedLength=u(this._selected)?this._selected.length:0,this._parentSelectedLength=u(this._parentSelected)?this._parentSelected.length:0;let n=this._stages,i=n.length;for(let o=0;o<i;++o){let r=n[o];this._selectedDirty&&(r.parentSelected=this._combinedSelected),r.update(e,t)}};Db.prototype.isDestroyed=function(){return!1};Db.prototype.destroy=function(){let e=this._stages,t=e.length;for(let n=0;n<t;++n)e[n].destroy();return ue(this)};var kl=Db;var vr={};function b8(e){let o=`#define USE_STEP_SIZE
${Sb}`,r=new xo({name:`${e}_x_direction`,fragmentShader:o,uniforms:{delta:1,sigma:2,stepSize:1,direction:0},sampleMode:Kf.LINEAR}),s=new xo({name:`${e}_y_direction`,fragmentShader:o,uniforms:{delta:1,sigma:2,stepSize:1,direction:1},sampleMode:Kf.LINEAR}),a={};return Object.defineProperties(a,{delta:{get:function(){return r.uniforms.delta},set:function(c){let l=r.uniforms,f=s.uniforms;l.delta=f.delta=c}},sigma:{get:function(){return r.uniforms.sigma},set:function(c){let l=r.uniforms,f=s.uniforms;l.sigma=f.sigma=c}},stepSize:{get:function(){return r.uniforms.stepSize},set:function(c){let l=r.uniforms,f=s.uniforms;l.stepSize=f.stepSize=c}}}),new kl({name:e,stages:[r,s],uniforms:a})}vr.createBlurStage=function(){return b8("czm_blur")};vr.createDepthOfFieldStage=function(){let e=b8("czm_depth_of_field_blur"),t=new xo({name:"czm_depth_of_field_composite",fragmentShader:a8,uniforms:{focalDistance:5,blurTexture:e.name}}),n={};return Object.defineProperties(n,{focalDistance:{get:function(){return t.uniforms.focalDistance},set:function(i){t.uniforms.focalDistance=i}},delta:{get:function(){return e.uniforms.delta},set:function(i){e.uniforms.delta=i}},sigma:{get:function(){return e.uniforms.sigma},set:function(i){e.uniforms.sigma=i}},stepSize:{get:function(){return e.uniforms.stepSize},set:function(i){e.uniforms.stepSize=i}}}),new kl({name:"czm_depth_of_field",stages:[e,t],inputPreviousStageTexture:!1,uniforms:n})};vr.isDepthOfFieldSupported=function(e){return e.context.depthTexture};vr.createEdgeDetectionStage=function(){let e=Hn();return new xo({name:`czm_edge_detection_${e}`,fragmentShader:l8,uniforms:{length:.25,color:G.clone(G.BLACK)}})};vr.isEdgeDetectionSupported=function(e){return e.context.depthTexture};function vgt(e){if(!u(e))return vr.createEdgeDetectionStage();let t=new kl({name:"czm_edge_detection_multiple",stages:e,inputPreviousStageTexture:!1}),n={},i="",o="";for(let a=0;a<e.length;++a)i+=`uniform sampler2D edgeTexture${a}; 
`,o+=`        vec4 edge${a} = texture(edgeTexture${a}, v_textureCoordinates); 
        if (edge${a}.a > 0.0) 
        { 
            color = edge${a}; 
            break; 
        } 
`,n[`edgeTexture${a}`]=e[a].name;let r=`${i}in vec2 v_textureCoordinates; 
void main() { 
    vec4 color = vec4(0.0); 
    for (int i = 0; i < ${e.length}; i++) 
    { 
${o}    } 
    out_FragColor = color; 
} 
`,s=new xo({name:"czm_edge_detection_combine",fragmentShader:r,uniforms:n});return new kl({name:"czm_edge_detection_composite",stages:[t,s]})}vr.createSilhouetteStage=function(e){let t=vgt(e),n=new xo({name:"czm_silhouette_color_edges",fragmentShader:g8,uniforms:{silhouetteTexture:t.name}});return new kl({name:"czm_silhouette",stages:[t,n],inputPreviousStageTexture:!1,uniforms:t.uniforms})};vr.isSilhouetteSupported=function(e){return e.context.depthTexture};vr.createBloomStage=function(){let e=new xo({name:"czm_bloom_contrast_bias",fragmentShader:s8,uniforms:{contrast:128,brightness:-.3}}),t=b8("czm_bloom_blur"),n=new kl({name:"czm_bloom_contrast_bias_blur",stages:[e,t]}),i=new xo({name:"czm_bloom_generate_composite",fragmentShader:o8,uniforms:{glowOnly:!1,bloomTexture:n.name}}),o={};return Object.defineProperties(o,{glowOnly:{get:function(){return i.uniforms.glowOnly},set:function(r){i.uniforms.glowOnly=r}},contrast:{get:function(){return e.uniforms.contrast},set:function(r){e.uniforms.contrast=r}},brightness:{get:function(){return e.uniforms.brightness},set:function(r){e.uniforms.brightness=r}},delta:{get:function(){return t.uniforms.delta},set:function(r){t.uniforms.delta=r}},sigma:{get:function(){return t.uniforms.sigma},set:function(r){t.uniforms.sigma=r}},stepSize:{get:function(){return t.uniforms.stepSize},set:function(r){t.uniforms.stepSize=r}}}),new kl({name:"czm_bloom",stages:[n,i],inputPreviousStageTexture:!1,uniforms:o})};vr.createAmbientOcclusionStage=function(){let e=new xo({name:"czm_ambient_occlusion_generate",fragmentShader:t8,uniforms:{intensity:3,bias:.1,lengthCap:.26,stepSize:1.95,frustumLength:1e3,randomTexture:void 0}}),t=b8("czm_ambient_occlusion_blur");t.uniforms.stepSize=.86;let n=new kl({name:"czm_ambient_occlusion_generate_blur",stages:[e,t]}),i=new xo({name:"czm_ambient_occlusion_composite",fragmentShader:n8,uniforms:{ambientOcclusionOnly:!1,ambientOcclusionTexture:n.name}}),o={};return Object.defineProperties(o,{intensity:{get:function(){return e.uniforms.intensity},set:function(r){e.uniforms.intensity=r}},bias:{get:function(){return e.uniforms.bias},set:function(r){e.uniforms.bias=r}},lengthCap:{get:function(){return e.uniforms.lengthCap},set:function(r){e.uniforms.lengthCap=r}},stepSize:{get:function(){return e.uniforms.stepSize},set:function(r){e.uniforms.stepSize=r}},frustumLength:{get:function(){return e.uniforms.frustumLength},set:function(r){e.uniforms.frustumLength=r}},randomTexture:{get:function(){return e.uniforms.randomTexture},set:function(r){e.uniforms.randomTexture=r}},delta:{get:function(){return t.uniforms.delta},set:function(r){t.uniforms.delta=r}},sigma:{get:function(){return t.uniforms.sigma},set:function(r){t.uniforms.sigma=r}},blurStepSize:{get:function(){return t.uniforms.stepSize},set:function(r){t.uniforms.stepSize=r}},ambientOcclusionOnly:{get:function(){return i.uniforms.ambientOcclusionOnly},set:function(r){i.uniforms.ambientOcclusionOnly=r}}}),new kl({name:"czm_ambient_occlusion",stages:[n,i],inputPreviousStageTexture:!1,uniforms:o})};vr.isAmbientOcclusionSupported=function(e){return e.context.depthTexture};var wgt=`#define FXAA_QUALITY_PRESET 39 
${y8}
${d8}`;vr.createFXAAStage=function(){return new xo({name:"czm_FXAA",fragmentShader:wgt,sampleMode:Kf.LINEAR})};vr.createAcesTonemappingStage=function(e){let t=e?`#define AUTO_EXPOSURE
`:"";return t+=e8,new xo({name:"czm_aces",fragmentShader:t,uniforms:{autoExposure:void 0,exposure:1}})};vr.createFilmicTonemappingStage=function(e){let t=e?`#define AUTO_EXPOSURE
`:"";return t+=u8,new xo({name:"czm_filmic",fragmentShader:t,uniforms:{autoExposure:void 0,exposure:1}})};vr.createPbrNeutralTonemappingStage=function(e){let t=e?`#define AUTO_EXPOSURE
`:"";return t+=f8,new xo({name:"czm_pbr_neutral",fragmentShader:t,uniforms:{autoExposure:void 0,exposure:1}})};vr.createReinhardTonemappingStage=function(e){let t=e?`#define AUTO_EXPOSURE
`:"";return t+=_8,new xo({name:"czm_reinhard",fragmentShader:t,uniforms:{autoExposure:void 0,exposure:1}})};vr.createModifiedReinhardTonemappingStage=function(e){let t=e?`#define AUTO_EXPOSURE
`:"";return t+=m8,new xo({name:"czm_modified_reinhard",fragmentShader:t,uniforms:{white:G.WHITE,autoExposure:void 0,exposure:1}})};vr.createAutoExposureStage=function(){return new x8};vr.createBlackAndWhiteStage=function(){return new xo({name:"czm_black_and_white",fragmentShader:i8,uniforms:{gradations:5}})};vr.createBrightnessStage=function(){return new xo({name:"czm_brightness",fragmentShader:r8,uniforms:{brightness:.5}})};vr.createNightVisionStage=function(){return new xo({name:"czm_night_vision",fragmentShader:p8})};vr.createDepthViewStage=function(){return new xo({name:"czm_depth_view",fragmentShader:c8})};vr.createLensFlareStage=function(){return new xo({name:"czm_lens_flare",fragmentShader:h8,uniforms:{dirtTexture:on("Assets/Textures/LensFlare/DirtMask.jpg"),starTexture:on("Assets/Textures/LensFlare/StarBurst.jpg"),intensity:2,distortion:10,ghostDispersal:.4,haloWidth:.4,dirtAmount:.4,earthRadius:ee.WGS84.maximumRadius}})};var Zf=vr;function b_(e){this._collection=e,this._framebuffers=[],this._stageNameToFramebuffer={},this._width=void 0,this._height=void 0,this._updateDependencies=!1}function aI(e){for(;u(e.length);)e=e.get(e.length-1);return e.name}function XK(e,t,n,i,o){if(!i.enabled||!i._isSupported(t))return o;let r=n[i.name]={};if(u(o)){let a=e.getStageByName(o);r[aI(a)]=!0}let s=i.uniforms;if(u(s)){let a=Object.getOwnPropertyNames(s),c=a.length;for(let l=0;l<c;++l){let f=s[a[l]];if(typeof f=="string"){let d=e.getStageByName(f);u(d)&&(r[aI(d)]=!0)}}}return i.name}function sI(e,t,n,i,o){if(u(i.enabled)&&!i.enabled||u(i._isSupported)&&!i._isSupported(t))return o;let r=o,s=!u(i.inputPreviousStageTexture)||i.inputPreviousStageTexture,a=o,c=i.length;for(let d=0;d<c;++d){let p=i.get(d);u(p.length)?a=sI(e,t,n,p,o):a=XK(e,t,n,p,o),s&&(o=a)}let l,f;if(s)for(l=1;l<c;++l)f=aI(i.get(l)),u(n[f])||(n[f]={}),n[f][r]=!0;else for(l=1;l<c;++l){f=aI(i.get(l));let d=n[f];for(let p=0;p<l;++p)d[aI(i.get(p))]=!0}return a}function Dgt(e,t){let n={};if(u(e.ambientOcclusion)){let i=e.ambientOcclusion,o=e.bloom,r=e._tonemapping,s=e.fxaa,a=sI(e,t,n,i,void 0);a=sI(e,t,n,o,a),a=XK(e,t,n,r,a),a=sI(e,t,n,e,a),XK(e,t,n,s,a)}else sI(e,t,n,e,void 0);return n}function Igt(e,t,n){let o=e._collection.getStageByName(t),r=o._textureScale,s=o._forcePowerOfTwo,a=o._pixelFormat,c=o._pixelDatatype,l=o._clearColor,f,d,p=e._framebuffers,g=p.length;for(f=0;f<g;++f){if(d=p[f],r!==d.textureScale||s!==d.forcePowerOfTwo||a!==d.pixelFormat||c!==d.pixelDatatype||!G.equals(l,d.clearColor))continue;let m=d.stages,y=m.length,b=!1;for(let C=0;C<y;++C)if(n[m[C]]){b=!0;break}if(!b)break}return u(d)&&f<g?(d.stages.push(t),d):(d={textureScale:r,forcePowerOfTwo:s,pixelFormat:a,pixelDatatype:c,clearColor:l,stages:[t],buffer:new pi({pixelFormat:a,pixelDatatype:c}),clear:void 0},p.push(d),d)}function Pgt(e,t){let n=Dgt(e._collection,t);for(let i in n)n.hasOwnProperty(i)&&(e._stageNameToFramebuffer[i]=Igt(e,i,n[i]))}function KK(e){let t=e._framebuffers,n=t.length;for(let i=0;i<n;++i)t[i].buffer.destroy()}function Rgt(e,t){let n=e._width,i=e._height,o=e._framebuffers,r=o.length;for(let s=0;s<r;++s){let a=o[s],c=a.textureScale,l=Math.ceil(n*c),f=Math.ceil(i*c),d=Math.min(l,f);a.forcePowerOfTwo&&(R.isPowerOfTwo(d)||(d=R.nextPowerOfTwo(d)),l=d,f=d),a.buffer.update(t,l,f),a.clear=new ni({color:a.clearColor,framebuffer:a.buffer.framebuffer})}}b_.prototype.updateDependencies=function(){this._updateDependencies=!0};b_.prototype.update=function(e){let t=this._collection,n=this._updateDependencies,i=u(t.ambientOcclusion)&&t.ambientOcclusion.enabled&&t.ambientOcclusion._isSupported(e),o=u(t.bloom)&&t.bloom.enabled&&t.bloom._isSupported(e),r=u(t._tonemapping)&&t._tonemapping.enabled&&t._tonemapping._isSupported(e),s=u(t.fxaa)&&t.fxaa.enabled&&t.fxaa._isSupported(e),a=!u(t._activeStages)||t._activeStages.length>0||i||o||r||s;if((n||!a&&this._framebuffers.length>0)&&(KK(this),this._framebuffers.length=0,this._stageNameToFramebuffer={},this._width=void 0,this._height=void 0),!n&&!a)return;this._framebuffers.length===0&&Pgt(this,e);let c=e.drawingBufferWidth,l=e.drawingBufferHeight,f=this._width!==c||this._height!==l;!n&&!f||(this._width=c,this._height=l,this._updateDependencies=!1,KK(this),Rgt(this,e))};b_.prototype.clear=function(e){let t=this._framebuffers;for(let n=0;n<t.length;++n)t[n].clear.execute(e)};b_.prototype.getStageByName=function(e){return this._collection.getStageByName(e)};b_.prototype.getOutputTexture=function(e){return this._collection.getOutputTexture(e)};b_.prototype.getFramebuffer=function(e){let t=this._stageNameToFramebuffer[e];if(u(t))return t.buffer.framebuffer};b_.prototype.isDestroyed=function(){return!1};b_.prototype.destroy=function(){return KK(this),ue(this)};var sS=b_;var Ogt={REINHARD:"REINHARD",MODIFIED_REINHARD:"MODIFIED_REINHARD",FILMIC:"FILMIC",ACES:"ACES",PBR_NEUTRAL:"PBR_NEUTRAL"};var uy=Object.freeze(Ogt);var ZK=[];function tl(){let e=Zf.createFXAAStage(),t=Zf.createAmbientOcclusionStage(),n=Zf.createBloomStage();this._autoExposureEnabled=!1,this._autoExposure=Zf.createAutoExposureStage(),this._exposure=1,this._tonemapping=void 0,this._tonemapper=void 0,this.tonemapper=uy.PBR_NEUTRAL;let i=this._tonemapping;e.enabled=!1,t.enabled=!1,n.enabled=!1,i.enabled=!1;let o=new sS(this),r={},s=ZK;for(s.push(e,t,n,i);s.length>0;){let c=s.pop();r[c.name]=c,c._textureCache=o;let l=c.length;if(u(l))for(let f=0;f<l;++f)s.push(c.get(f))}this._stages=[],this._activeStages=[],this._previousActiveStages=[],this._randomTexture=void 0;let a=this;t.uniforms.randomTexture=function(){return a._randomTexture},this._ao=t,this._bloom=n,this._fxaa=e,this._aoEnabled=void 0,this._bloomEnabled=void 0,this._tonemappingEnabled=void 0,this._fxaaEnabled=void 0,this._activeStagesChanged=!1,this._stagesRemoved=!1,this._textureCacheDirty=!1,this._stageNames=r,this._textureCache=o}Object.defineProperties(tl.prototype,{ready:{get:function(){let e=!1,t=this._stages,n=t.length;for(let a=n-1;a>=0;--a){let c=t[a];e=e||c.ready&&c.enabled}let i=this._fxaa,o=this._ao,r=this._bloom,s=this._tonemapping;return e=e||i.ready&&i.enabled,e=e||o.ready&&o.enabled,e=e||r.ready&&r.enabled,e=e||s.ready&&s.enabled,e}},fxaa:{get:function(){return this._fxaa}},ambientOcclusion:{get:function(){return this._ao}},bloom:{get:function(){return this._bloom}},length:{get:function(){return $K(this),this._stages.length}},outputTexture:{get:function(){let e=this._fxaa;if(e.enabled&&e.ready)return this.getOutputTexture(e.name);let t=this._stages,n=t.length;for(let s=n-1;s>=0;--s){let a=t[s];if(u(a)&&a.ready&&a.enabled)return this.getOutputTexture(a.name)}let i=this._tonemapping;if(i.enabled&&i.ready)return this.getOutputTexture(i.name);let o=this._bloom;if(o.enabled&&o.ready)return this.getOutputTexture(o.name);let r=this._ao;if(r.enabled&&r.ready)return this.getOutputTexture(r.name)}},hasSelected:{get:function(){let e=this._stages.slice();for(;e.length>0;){let t=e.pop();if(!u(t))continue;if(u(t.selected))return!0;let n=t.length;if(u(n))for(let i=0;i<n;++i)e.push(t.get(i))}return!1}},tonemapper:{get:function(){return this._tonemapper},set:function(e){if(this._tonemapper===e)return;u(this._tonemapping)&&(delete this._stageNames[this._tonemapping.name],this._tonemapping.destroy());let t=this._autoExposureEnabled,n;switch(e){case uy.REINHARD:n=Zf.createReinhardTonemappingStage(t);break;case uy.MODIFIED_REINHARD:n=Zf.createModifiedReinhardTonemappingStage(t);break;case uy.FILMIC:n=Zf.createFilmicTonemappingStage(t);break;case uy.PBR_NEUTRAL:n=Zf.createPbrNeutralTonemappingStage(t);break;default:n=Zf.createAcesTonemappingStage(t);break}if(t){let i=this._autoExposure;n.uniforms.autoExposure=function(){return i.outputTexture}}else n.uniforms.exposure=this._exposure;this._tonemapper=e,this._tonemapping=n,u(this._stageNames)&&(this._stageNames[n.name]=n,n._textureCache=this._textureCache),this._textureCacheDirty=!0}},exposure:{get:function(){return this._exposure},set:function(e){this._tonemapping.uniforms.exposure=e,this._exposure=e}}});function $K(e){if(!e._stagesRemoved)return;e._stagesRemoved=!1;let t=[],n=e._stages;for(let i=0,o=0;i<n.length;++i){let r=n[i];r&&(r._index=o++,t.push(r))}e._stages=t}tl.prototype.add=function(e){let t=this._stageNames,n=ZK;for(n.push(e);n.length>0;){let o=n.pop();t[o.name]=o,o._textureCache=this._textureCache;let r=o.length;if(u(r))for(let s=0;s<r;++s)n.push(o.get(s))}let i=this._stages;return e._index=i.length,i.push(e),this._textureCacheDirty=!0,e};tl.prototype.remove=function(e){if(!this.contains(e))return!1;let t=this._stageNames,n=ZK;for(n.push(e);n.length>0;){let i=n.pop();delete t[i.name];let o=i.length;if(u(o))for(let r=0;r<o;++r)n.push(i.get(r))}return this._stages[e._index]=void 0,this._stagesRemoved=!0,this._textureCacheDirty=!0,e._index=void 0,e._textureCache=void 0,e.destroy(),!0};tl.prototype.contains=function(e){return u(e)&&u(e._index)&&e._textureCache===this._textureCache};tl.prototype.get=function(e){return $K(this),this._stages[e]};tl.prototype.removeAll=function(){let e=this._stages,t=e.length;for(let n=0;n<t;++n)this.remove(e[n]);e.length=0};tl.prototype.getStageByName=function(e){return this._stageNames[e]};tl.prototype.update=function(e,t,n){$K(this);let i=this._activeStages,o=this._activeStages=this._previousActiveStages;this._previousActiveStages=i;let r=this._stages;o.length=r.length;let s=0;for(let C=0;C<r.length;++C){let A=r[C];A.ready&&A.enabled&&A._isSupported(e)&&(o[s++]=A)}o.length=s;let a=s!==i.length;if(!a){for(let C=0;C<s;++C)if(o[C]!==i[C]){a=!0;break}}let c=this._ao,l=this._bloom,f=this._autoExposure,d=this._tonemapping,p=this._fxaa;d.enabled=n;let g=c.enabled&&c._isSupported(e),m=l.enabled&&l._isSupported(e),y=d.enabled&&d._isSupported(e),b=p.enabled&&p._isSupported(e);if((a||this._textureCacheDirty||g!==this._aoEnabled||m!==this._bloomEnabled||y!==this._tonemappingEnabled||b!==this._fxaaEnabled)&&(this._textureCache.updateDependencies(),this._aoEnabled=g,this._bloomEnabled=m,this._tonemappingEnabled=y,this._fxaaEnabled=b,this._textureCacheDirty=!1),u(this._randomTexture)&&!g&&(this._randomTexture.destroy(),this._randomTexture=void 0),!u(this._randomTexture)&&g){let A=new Uint8Array(196608);for(let T=0;T<196608;T+=3)A[T]=Math.floor(Math.random()*255);this._randomTexture=new Ot({context:e,pixelFormat:tt.RGB,pixelDatatype:Ke.UNSIGNED_BYTE,source:{arrayBufferView:A,width:256,height:256},sampler:new Qt({wrapS:En.REPEAT,wrapT:En.REPEAT,minificationFilter:$t.NEAREST,magnificationFilter:mi.NEAREST})})}this._textureCache.update(e),p.update(e,t),c.update(e,t),l.update(e,t),d.update(e,t),this._autoExposureEnabled&&f.update(e,t);for(let C=0;C<r.length;++C)r[C].update(e,t);s=0;for(let C=0;C<r.length;++C){let A=r[C];A.ready&&A.enabled&&A._isSupported(e)&&s++}a=s!==o.length,a&&this.update(e,t,n)};tl.prototype.clear=function(e){this._textureCache.clear(e),this._autoExposureEnabled&&this._autoExposure.clear(e)};function Ib(e){for(;u(e.length);)e=e.get(e.length-1);return e.outputTexture}tl.prototype.getOutputTexture=function(e){let t=this.getStageByName(e);if(u(t))return Ib(t)};function zm(e,t,n,i,o){if(u(e.execute)){e.execute(t,n,i,o);return}if(e.inputPreviousStageTexture){zm(e.get(0),t,n,i,o);for(let r=1;r<e.length;++r)zm(e.get(r),t,Ib(e.get(r-1)),i,o)}else for(let r=0;r<e.length;++r)zm(e.get(r),t,n,i,o)}tl.prototype.execute=function(e,t,n,i){let o=this._activeStages,r=o.length,s=this._fxaa,a=this._ao,c=this._bloom,l=this._autoExposure,f=this._tonemapping,d=a.enabled&&a._isSupported(e),p=c.enabled&&c._isSupported(e),g=this._autoExposureEnabled,m=f.enabled&&f._isSupported(e),y=s.enabled&&s._isSupported(e);if(!y&&!d&&!p&&!m&&r===0)return;let b=t;d&&a.ready&&(zm(a,e,b,n,i),b=Ib(a)),p&&c.ready&&(zm(c,e,b,n,i),b=Ib(c)),g&&l.ready&&zm(l,e,b,n,i),m&&f.ready&&(zm(f,e,b,n,i),b=Ib(f));let C=b;if(r>0){zm(o[0],e,b,n,i);for(let A=1;A<r;++A)zm(o[A],e,Ib(o[A-1]),n,i);C=Ib(o[r-1])}y&&s.ready&&zm(s,e,C,n,i)};tl.prototype.copy=function(e,t){if(!u(this._copyColorCommand)){let n=this;this._copyColorCommand=e.createViewportQuadCommand(Lu,{uniformMap:{colorTexture:function(){return n.outputTexture}},owner:this})}this._copyColorCommand.framebuffer=t,this._copyColorCommand.execute(e)};tl.prototype.isDestroyed=function(){return!1};tl.prototype.destroy=function(){return this._fxaa.destroy(),this._ao.destroy(),this._bloom.destroy(),this._autoExposure.destroy(),this._tonemapping.destroy(),this.removeAll(),this._textureCache=this._textureCache&&this._textureCache.destroy(),ue(this)};var C8=tl;function Pb(e){this._scene=e,this._currentTweens=[],this._morphHandler=void 0,this._morphCancelled=!1,this._completeMorph=void 0,this._morphToOrthographic=!1}Pb.prototype.completeMorph=function(){u(this._completeMorph)&&this._completeMorph()};Pb.prototype.morphTo2D=function(e,t){u(this._completeMorph)&&this._completeMorph();let n=this._scene;this._previousMode=n.mode,this._morphToOrthographic=n.camera.frustum instanceof sn,!(this._previousMode===ne.SCENE2D||this._previousMode===ne.MORPHING)&&(this._scene.morphStart.raiseEvent(this,this._previousMode,ne.SCENE2D,!0),n._mode=ne.MORPHING,n.camera._setTransform(F.IDENTITY),this._previousMode===ne.COLUMBUS_VIEW?f0t(this,e):y0t(this,e,t),e===0&&u(this._completeMorph)&&this._completeMorph())};var Mgt=new h,Lgt=new h,Ngt=new h,Fgt=new h,Bgt=new h,kgt=new h,Vgt=new h,Ugt=new de,zgt=new F,Hgt=new Ri,Ggt=new sn,Wgt={position:void 0,direction:void 0,up:void 0,position2D:void 0,direction2D:void 0,up2D:void 0,frustum:void 0};Pb.prototype.morphToColumbusView=function(e,t){u(this._completeMorph)&&this._completeMorph();let n=this._scene;if(this._previousMode=n.mode,this._previousMode===ne.COLUMBUS_VIEW||this._previousMode===ne.MORPHING)return;this._scene.morphStart.raiseEvent(this,this._previousMode,ne.COLUMBUS_VIEW,!0),n.camera._setTransform(F.IDENTITY);let i=Mgt,o=Lgt,r=Ngt;if(e>0)i.x=0,i.y=-1,i.z=1,i=h.multiplyByScalar(h.normalize(i,i),5*t.maximumRadius,i),h.negate(h.normalize(i,o),o),h.cross(h.UNIT_X,o,r);else{let l=n.camera;if(this._previousMode===ne.SCENE2D)h.clone(l.position,i),i.z=l.frustum.right-l.frustum.left,h.negate(h.UNIT_Z,o),h.clone(h.UNIT_Y,r);else{h.clone(l.positionWC,i),h.clone(l.directionWC,o),h.clone(l.upWC,r);let f=t.scaleToGeodeticSurface(i,Vgt),d=Lt.eastNorthUpToFixedFrame(f,t,zgt);F.inverseTransformation(d,d),n.mapProjection.project(t.cartesianToCartographic(i,Ugt),i),F.multiplyByPointAsVector(d,o,o),F.multiplyByPointAsVector(d,r,r)}}let s;this._morphToOrthographic?(s=Ggt,s.width=n.camera.frustum.right-n.camera.frustum.left,s.aspectRatio=n.drawingBufferWidth/n.drawingBufferHeight):(s=Hgt,s.aspectRatio=n.drawingBufferWidth/n.drawingBufferHeight,s.fov=R.toRadians(60));let a=Wgt;a.position=i,a.direction=o,a.up=r,a.frustum=s;let c=b0t(a);cI(this,c),this._previousMode===ne.SCENE2D?x0t(this,e,a,c):(a.position2D=F.multiplyByPoint(uo.TRANSFORM_2D,i,Fgt),a.direction2D=F.multiplyByPointAsVector(uo.TRANSFORM_2D,o,Bgt),a.up2D=F.multiplyByPointAsVector(uo.TRANSFORM_2D,r,kgt),n._mode=ne.MORPHING,NCe(this,e,a,c)),e===0&&u(this._completeMorph)&&this._completeMorph()};var eZ={position:new h,direction:new h,up:new h,frustum:void 0},vCe=new Ri;Pb.prototype.morphTo3D=function(e,t){u(this._completeMorph)&&this._completeMorph();let n=this._scene;if(this._previousMode=n.mode,!(this._previousMode===ne.SCENE3D||this._previousMode===ne.MORPHING)){if(this._scene.morphStart.raiseEvent(this,this._previousMode,ne.SCENE3D,!0),n._mode=ne.MORPHING,n.camera._setTransform(F.IDENTITY),this._previousMode===ne.SCENE2D)t0t(this,e,t);else{let i;e>0?(i=eZ,h.fromDegrees(0,0,5*t.maximumRadius,t,i.position),h.negate(i.position,i.direction),h.normalize(i.direction,i.direction),h.clone(h.UNIT_Z,i.up)):i=wCe(this,t);let o,r=n.camera;r.frustum instanceof sn?o=r.frustum.clone():(o=vCe,o.aspectRatio=n.drawingBufferWidth/n.drawingBufferHeight,o.fov=R.toRadians(60)),i.frustum=o;let s=BCe(i);cI(this,s),JK(this,e,i,s)}e===0&&u(this._completeMorph)&&this._completeMorph()}};Pb.prototype.isDestroyed=function(){return!1};Pb.prototype.destroy=function(){return A8(this),ue(this)};function cI(e,t){if(e._scene.completeMorphOnUserInput){e._morphHandler=new Wf(e._scene.canvas);let n=function(){e._morphCancelled=!0,e._scene.camera.cancelFlight(),t(e)};e._completeMorph=n,e._morphHandler.setInputAction(n,Cn.LEFT_DOWN),e._morphHandler.setInputAction(n,Cn.MIDDLE_DOWN),e._morphHandler.setInputAction(n,Cn.RIGHT_DOWN),e._morphHandler.setInputAction(n,Cn.WHEEL)}}function A8(e){let t=e._currentTweens;for(let n=0;n<t.length;++n)t[n].cancelTween();e._currentTweens.length=0,e._morphHandler=e._morphHandler&&e._morphHandler.destroy()}var jgt=new de,qgt=new h,Ygt=new F;function wCe(e,t){let n=e._scene,i=n.camera,o=eZ,r=o.position,s=o.direction,a=o.up,c=n.mapProjection.unproject(i.position,jgt);t.cartographicToCartesian(c,r);let l=t.scaleToGeodeticSurface(r,qgt),f=Lt.eastNorthUpToFixedFrame(l,t,Ygt);return F.multiplyByPointAsVector(f,i.direction,s),F.multiplyByPointAsVector(f,i.up,a),o}var Xgt=new h,Kgt=new h,Zgt=new h,$gt=new h,Qgt=new h,Jgt=new h;function JK(e,t,n,i){t*=.5;let o=e._scene,r=o.camera,s=h.clone(r.position,Xgt),a=h.clone(r.direction,Kgt),c=h.clone(r.up,Zgt),l=F.multiplyByPoint(uo.TRANSFORM_2D_INVERSE,n.position,$gt),f=F.multiplyByPointAsVector(uo.TRANSFORM_2D_INVERSE,n.direction,Qgt),d=F.multiplyByPointAsVector(uo.TRANSFORM_2D_INVERSE,n.up,Jgt);function p(m){$f(s,l,m.time,r.position),$f(a,f,m.time,r.direction),$f(c,d,m.time,r.up),h.cross(r.direction,r.up,r.right),h.normalize(r.right,r.right)}let g=o.tweens.add({duration:t,easingFunction:Qr.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:p,complete:function(){FCe(e,o,0,1,t,i)}});e._currentTweens.push(g)}var e0t=new sn,DCe=new h,ICe=new h,PCe=new h,tZ=new h,RCe=new h,OCe=new h;function t0t(e,t,n){t/=3;let i=e._scene,o=i.camera,r;t>0?(r=eZ,h.fromDegrees(0,0,5*n.maximumRadius,n,r.position),h.negate(r.position,r.direction),h.normalize(r.direction,r.direction),h.clone(h.UNIT_Z,r.up)):(o.position.z=o.frustum.right-o.frustum.left,r=wCe(e,n));let s;e._morphToOrthographic?(s=e0t,s.aspectRatio=i.drawingBufferWidth/i.drawingBufferHeight,s.width=o.frustum.right-o.frustum.left):(s=vCe,s.aspectRatio=i.drawingBufferWidth/i.drawingBufferHeight,s.fov=R.toRadians(60)),r.frustum=s;let a=BCe(r);cI(e,a);let c;e._morphToOrthographic?c=function(){JK(e,t,r,a)}:c=function(){LCe(e,t,r,function(){JK(e,t,r,a)})},t>0?(i._mode=ne.SCENE2D,o.flyTo({duration:t,destination:h.fromDegrees(0,0,5*n.maximumRadius,n,tZ),complete:function(){i._mode=ne.MORPHING,c()}})):c()}function $f(e,t,n,i){return h.lerp(e,t,n,i)}function MCe(e,t,n,i,o){let r=e._scene,s=r.camera;if(s.frustum instanceof sn)return;let a=s.frustum.fov,c=R.RADIANS_PER_DEGREE*.5,l=n.position.z*Math.tan(a*.5);s.frustum.far=l/Math.tan(c*.5)+1e7;function f(p){s.frustum.fov=R.lerp(a,c,p.time);let g=l/Math.tan(s.frustum.fov*.5);i(s,g)}let d=r.tweens.add({duration:t,easingFunction:Qr.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:f,complete:function(){s.frustum=n.frustum.clone(),o(e)}});e._currentTweens.push(d)}var n0t=new h,i0t=new h,o0t=new h,QK=new h,r0t=new h,s0t=new h,a0t=new Gr,c0t=new _n,l0t=new h,u0t={position:void 0,direction:void 0,up:void 0,frustum:void 0};function f0t(e,t){t*=.5;let n=e._scene,i=n.camera,o=h.clone(i.position,n0t),r=h.clone(i.direction,i0t),s=h.clone(i.up,o0t),a=h.negate(h.UNIT_Z,r0t),c=h.clone(h.UNIT_Y,s0t),l=QK;if(t>0)h.clone(h.ZERO,QK),l.z=5*n.ellipsoid.maximumRadius;else{h.clone(o,QK);let b=c0t;F.multiplyByPoint(uo.TRANSFORM_2D,o,b.origin),F.multiplyByPointAsVector(uo.TRANSFORM_2D,r,b.direction);let C=n.globe;if(u(C)){let A=C.pickWorldCoordinates(b,n,!0,l0t);u(A)&&(F.multiplyByPoint(uo.TRANSFORM_2D_INVERSE,A,l),l.z+=h.distance(o,l))}}let f=a0t;f.right=l.z*.5,f.left=-f.right,f.top=f.right*(n.drawingBufferHeight/n.drawingBufferWidth),f.bottom=-f.top;let d=u0t;d.position=l,d.direction=a,d.up=c,d.frustum=f;let p=kCe(d);cI(e,p);function g(b){$f(o,l,b.time,i.position),$f(r,a,b.time,i.direction),$f(s,c,b.time,i.up),h.cross(i.direction,i.up,i.right),h.normalize(i.right,i.right),i._adjustOrthographicFrustum(!0)}function m(b,C){b.position.z=C}let y=n.tweens.add({duration:t,easingFunction:Qr.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:g,complete:function(){MCe(e,t,d,m,p)}});e._currentTweens.push(y)}var SCe=new de,d0t={position:new h,direction:new h,up:new h,position2D:new h,direction2D:new h,up2D:new h,frustum:new Gr},h0t={position:new h,direction:new h,up:new h,frustum:void 0},m0t=new h,p0t=new _n,_0t=new F,g0t=new h;function y0t(e,t,n){t*=.5;let i=e._scene,o=i.camera,r=d0t;if(t>0)h.clone(h.ZERO,r.position),r.position.z=5*n.maximumRadius,h.negate(h.UNIT_Z,r.direction),h.clone(h.UNIT_Y,r.up);else{n.cartesianToCartographic(o.positionWC,SCe),i.mapProjection.project(SCe,r.position),h.negate(h.UNIT_Z,r.direction),h.clone(h.UNIT_Y,r.up);let d=p0t;h.clone(r.position2D,d.origin);let p=h.clone(o.directionWC,d.direction),g=n.scaleToGeodeticSurface(o.positionWC,g0t),m=Lt.eastNorthUpToFixedFrame(g,n,_0t);F.inverseTransformation(m,m),F.multiplyByPointAsVector(m,p,p),F.multiplyByPointAsVector(uo.TRANSFORM_2D,p,p);let y=i.globe;if(u(y)){let b=y.pickWorldCoordinates(d,i,!0,m0t);if(u(b)){let C=h.distance(r.position2D,b);b.x+=C,h.clone(b,r.position2D)}}}function s(d,p){d.position.x=p}F.multiplyByPoint(uo.TRANSFORM_2D,r.position,r.position2D),F.multiplyByPointAsVector(uo.TRANSFORM_2D,r.direction,r.direction2D),F.multiplyByPointAsVector(uo.TRANSFORM_2D,r.up,r.up2D);let a=r.frustum;a.right=r.position.z*.5,a.left=-a.right,a.top=a.right*(i.drawingBufferHeight/i.drawingBufferWidth),a.bottom=-a.top;let c=h0t;F.multiplyByPoint(uo.TRANSFORM_2D_INVERSE,r.position2D,c.position),h.clone(r.direction,c.direction),h.clone(r.up,c.up),c.frustum=a;let l=kCe(c);cI(e,l);function f(){MCe(e,t,r,s,l)}NCe(e,t,r,f)}function LCe(e,t,n,i){let o=e._scene,r=o.camera,s=r.frustum.right-r.frustum.left;r.frustum=n.frustum.clone();let a=r.frustum.fov,c=R.RADIANS_PER_DEGREE*.5,l=s*Math.tan(a*.5);r.frustum.far=l/Math.tan(c*.5)+1e7,r.frustum.fov=c;function f(p){r.frustum.fov=R.lerp(c,a,p.time),r.position.z=l/Math.tan(r.frustum.fov*.5)}let d=o.tweens.add({duration:t,easingFunction:Qr.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:f,complete:function(){i(e)}});e._currentTweens.push(d)}function x0t(e,t,n,i){t*=.5;let o=e._scene,r=o.camera,s=h.clone(n.position,tZ),a=h.clone(n.direction,RCe),c=h.clone(n.up,OCe);o._mode=ne.MORPHING;function l(){r.frustum=n.frustum.clone();let f=h.clone(r.position,DCe),d=h.clone(r.direction,ICe),p=h.clone(r.up,PCe);f.z=s.z;function g(y){$f(f,s,y.time,r.position),$f(d,a,y.time,r.direction),$f(p,c,y.time,r.up),h.cross(r.direction,r.up,r.right),h.normalize(r.right,r.right)}let m=o.tweens.add({duration:t,easingFunction:Qr.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:g,complete:function(){i(e)}});e._currentTweens.push(m)}e._morphToOrthographic?l():LCe(e,0,n,l)}function NCe(e,t,n,i){let o=e._scene,r=o.camera,s=h.clone(r.position,DCe),a=h.clone(r.direction,ICe),c=h.clone(r.up,PCe),l=h.clone(n.position2D,tZ),f=h.clone(n.direction2D,RCe),d=h.clone(n.up2D,OCe);function p(m){$f(s,l,m.time,r.position),$f(a,f,m.time,r.direction),$f(c,d,m.time,r.up),h.cross(r.direction,r.up,r.right),h.normalize(r.right,r.right),r._adjustOrthographicFrustum(!0)}let g=o.tweens.add({duration:t,easingFunction:Qr.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:p,complete:function(){FCe(e,o,1,0,t,i)}});e._currentTweens.push(g)}function FCe(e,t,n,i,o,r){let s={object:t,property:"morphTime",startValue:n,stopValue:i,duration:o,easingFunction:Qr.QUARTIC_OUT};u(r)&&(s.complete=function(){r(e)});let a=t.tweens.addProperty(s);e._currentTweens.push(a)}function BCe(e){return function(t){let n=t._scene;n._mode=ne.SCENE3D,n.morphTime=ne.getMorphTime(ne.SCENE3D),A8(t);let i=n.camera;(t._previousMode!==ne.MORPHING||t._morphCancelled)&&(t._morphCancelled=!1,h.clone(e.position,i.position),h.clone(e.direction,i.direction),h.clone(e.up,i.up),h.cross(i.direction,i.up,i.right),h.normalize(i.right,i.right),i.frustum=e.frustum.clone());let o=i.frustum;n.frameState.useLogDepth&&(o.near=.1,o.far=1e10);let r=u(t._completeMorph);t._completeMorph=void 0,n.camera.update(n.mode),t._scene.morphComplete.raiseEvent(t,t._previousMode,ne.SCENE3D,r)}}function kCe(e){return function(t){let n=t._scene;n._mode=ne.SCENE2D,n.morphTime=ne.getMorphTime(ne.SCENE2D),A8(t);let i=n.camera;h.clone(e.position,i.position),i.position.z=n.ellipsoid.maximumRadius*2,h.clone(e.direction,i.direction),h.clone(e.up,i.up),h.cross(i.direction,i.up,i.right),h.normalize(i.right,i.right),i.frustum=e.frustum.clone();let o=u(t._completeMorph);t._completeMorph=void 0,n.camera.update(n.mode),t._scene.morphComplete.raiseEvent(t,t._previousMode,ne.SCENE2D,o)}}function b0t(e){return function(t){let n=t._scene;n._mode=ne.COLUMBUS_VIEW,n.morphTime=ne.getMorphTime(ne.COLUMBUS_VIEW),A8(t);let i=n.camera;(t._previousModeMode!==ne.MORPHING||t._morphCancelled)&&(t._morphCancelled=!1,h.clone(e.position,i.position),h.clone(e.direction,i.direction),h.clone(e.up,i.up),h.cross(i.direction,i.up,i.right),h.normalize(i.right,i.right));let o=i.frustum;n.frameState.useLogDepth&&(o.near=.1,o.far=1e10);let r=u(t._completeMorph);t._completeMorph=void 0,n.camera.update(n.mode),t._scene.morphComplete.raiseEvent(t,t._previousMode,ne.COLUMBUS_VIEW,r)}}var T8=Pb;var C0t={LEFT_DRAG:0,RIGHT_DRAG:1,MIDDLE_DRAG:2,WHEEL:3,PINCH:4},Ui=Object.freeze(C0t);function Ks(e,t){let n=`${e}`;return u(t)&&(n+=`+${t}`),n}function A0t(e,t){H.clone(e.distance.startPosition,t.distance.startPosition),H.clone(e.distance.endPosition,t.distance.endPosition),H.clone(e.angleAndHeight.startPosition,t.angleAndHeight.startPosition),H.clone(e.angleAndHeight.endPosition,t.angleAndHeight.endPosition)}function VCe(e,t,n){let i=Ks(Ui.PINCH,t),o=e._update,r=e._isDown,s=e._eventStartPosition,a=e._pressTime,c=e._releaseTime;o[i]=!0,r[i]=!1,s[i]=new H;let l=e._movement[i];u(l)||(l=e._movement[i]={}),l.distance={startPosition:new H,endPosition:new H},l.angleAndHeight={startPosition:new H,endPosition:new H},l.prevAngle=0,e._eventHandler.setInputAction(function(f){e._buttonsDown++,r[i]=!0,a[i]=new Date,H.lerp(f.position1,f.position2,.5,s[i])},Cn.PINCH_START,t),e._eventHandler.setInputAction(function(){e._buttonsDown=Math.max(e._buttonsDown-1,0),r[i]=!1,c[i]=new Date},Cn.PINCH_END,t),e._eventHandler.setInputAction(function(f){if(r[i]){o[i]?(A0t(f,l),o[i]=!1,l.prevAngle=l.angleAndHeight.startPosition.x):(H.clone(f.distance.endPosition,l.distance.endPosition),H.clone(f.angleAndHeight.endPosition,l.angleAndHeight.endPosition));let d=l.angleAndHeight.endPosition.x,p=l.prevAngle,g=Math.PI*2;for(;d>=p+Math.PI;)d-=g;for(;d<p-Math.PI;)d+=g;l.angleAndHeight.endPosition.x=-d*n.clientWidth/12,l.angleAndHeight.startPosition.x=-p*n.clientWidth/12}},Cn.PINCH_MOVE,t)}function UCe(e,t){let n=Ks(Ui.WHEEL,t),i=e._pressTime,o=e._releaseTime,r=e._update;r[n]=!0;let s=e._movement[n];u(s)||(s=e._movement[n]={});let a=e._lastMovement[n];u(a)||(a=e._lastMovement[n]={startPosition:new H,endPosition:new H,valid:!1}),s.startPosition=new H,H.clone(H.ZERO,s.startPosition),s.endPosition=new H,e._eventHandler.setInputAction(function(c){let l=7.5*R.toRadians(c);i[n]=o[n]=new Date,s.endPosition.x=0,s.endPosition.y=l,H.clone(s.endPosition,a.endPosition),a.valid=!0,r[n]=!1},Cn.WHEEL,t)}function aS(e,t,n){let i=Ks(n,t),o=e._isDown,r=e._eventStartPosition,s=e._pressTime;o[i]=!1,r[i]=new H;let a=e._lastMovement[i];u(a)||(a=e._lastMovement[i]={startPosition:new H,endPosition:new H,valid:!1});let c,l;n===Ui.LEFT_DRAG?(c=Cn.LEFT_DOWN,l=Cn.LEFT_UP):n===Ui.RIGHT_DRAG?(c=Cn.RIGHT_DOWN,l=Cn.RIGHT_UP):n===Ui.MIDDLE_DRAG&&(c=Cn.MIDDLE_DOWN,l=Cn.MIDDLE_UP),e._eventHandler.setInputAction(function(f){e._buttonsDown++,a.valid=!1,o[i]=!0,s[i]=new Date,H.clone(f.position,r[i])},c,t),e._eventHandler.setInputAction(function(){nZ(Ks(n,void 0),e);for(let f of Object.values(_a)){let d=Ks(n,f);nZ(d,e)}},l,t)}function nZ(e,t){let n=t._releaseTime,i=t._isDown;i[e]&&(t._buttonsDown=Math.max(t._buttonsDown-1,0)),i[e]=!1,n[e]=new Date}function zCe(e,t){H.clone(e.startPosition,t.startPosition),H.clone(e.endPosition,t.endPosition)}function T0t(e,t,n){let i=n._isDown,o=!1,r=Ks(e,t);for(let[c,l]of Object.entries(i))c.startsWith(e)&&l&&c!==r&&(o=!0,nZ(c,n));if(!o)return;let s=n._pressTime,a=n._lastMovement[r];u(a)||(a=n._lastMovement[r]={startPosition:new H,endPosition:new H,valid:!1}),n._buttonsDown++,a.valid=!1,i[r]=!0,s[r]=new Date}function HCe(e,t){let n=e._update,i=e._movement,o=e._lastMovement,r=e._isDown;for(let s in Ui)if(Ui.hasOwnProperty(s)){let a=Ui[s];if(u(a)){let c=Ks(a,t);n[c]=!0,u(e._lastMovement[c])||(e._lastMovement[c]={startPosition:new H,endPosition:new H,valid:!1}),u(e._movement[c])||(e._movement[c]={startPosition:new H,endPosition:new H})}}e._eventHandler.setInputAction(function(s){for(let a in Ui)if(Ui.hasOwnProperty(a)){let c=Ui[a];if(u(c)){let l=Ks(c,t);T0t(c,t,e),r[l]&&(n[l]?(zCe(i[l],o[l]),o[l].valid=!0,zCe(s,i[l]),n[l]=!1):H.clone(s.endPosition,i[l].endPosition))}}H.clone(s.endPosition,e._currentMousePosition)},Cn.MOUSE_MOVE,t)}function Qf(e){this._eventHandler=new Wf(e),this._update={},this._movement={},this._lastMovement={},this._isDown={},this._eventStartPosition={},this._pressTime={},this._releaseTime={},this._buttonsDown=0,this._currentMousePosition=new H,UCe(this,void 0),VCe(this,void 0,e),aS(this,void 0,Ui.LEFT_DRAG),aS(this,void 0,Ui.RIGHT_DRAG),aS(this,void 0,Ui.MIDDLE_DRAG),HCe(this,void 0);for(let t in _a)if(_a.hasOwnProperty(t)){let n=_a[t];u(n)&&(UCe(this,n),VCe(this,n,e),aS(this,n,Ui.LEFT_DRAG),aS(this,n,Ui.RIGHT_DRAG),aS(this,n,Ui.MIDDLE_DRAG),HCe(this,n))}}Object.defineProperties(Qf.prototype,{currentMousePosition:{get:function(){return this._currentMousePosition}},anyButtonDown:{get:function(){let e=!this._update[Ks(Ui.WHEEL)]||!this._update[Ks(Ui.WHEEL,_a.SHIFT)]||!this._update[Ks(Ui.WHEEL,_a.CTRL)]||!this._update[Ks(Ui.WHEEL,_a.ALT)];return this._buttonsDown>0||e}}});Qf.prototype.isMoving=function(e,t){let n=Ks(e,t);return!this._update[n]};Qf.prototype.getMovement=function(e,t){let n=Ks(e,t);return this._movement[n]};Qf.prototype.getLastMovement=function(e,t){let n=Ks(e,t),i=this._lastMovement[n];if(i.valid)return i};Qf.prototype.isButtonDown=function(e,t){let n=Ks(e,t);return this._isDown[n]};Qf.prototype.getStartMousePosition=function(e,t){if(e===Ui.WHEEL)return this._currentMousePosition;let n=Ks(e,t);return this._eventStartPosition[n]};Qf.prototype.getButtonPressTime=function(e,t){let n=Ks(e,t);return this._pressTime[n]};Qf.prototype.getButtonReleaseTime=function(e,t){let n=Ks(e,t);return this._releaseTime[n]};Qf.prototype.reset=function(){for(let e in this._update)this._update.hasOwnProperty(e)&&(this._update[e]=!0)};Qf.prototype.isDestroyed=function(){return!1};Qf.prototype.destroy=function(){return this._eventHandler=this._eventHandler&&this._eventHandler.destroy(),ue(this)};var E8=Qf;function S8(e,t,n,i,o,r,s,a,c,l){this._tweens=e,this._tweenjs=t,this._startObject=Ge(n),this._stopObject=Ge(i),this._duration=o,this._delay=r,this._easingFunction=s,this._update=a,this._complete=c,this.cancel=l,this.needsStart=!0}Object.defineProperties(S8.prototype,{startObject:{get:function(){return this._startObject}},stopObject:{get:function(){return this._stopObject}},duration:{get:function(){return this._duration}},delay:{get:function(){return this._delay}},easingFunction:{get:function(){return this._easingFunction}},update:{get:function(){return this._update}},complete:{get:function(){return this._complete}},tweenjs:{get:function(){return this._tweenjs}}});S8.prototype.cancelTween=function(){this._tweens.remove(this)};function fh(){this._tweens=[]}Object.defineProperties(fh.prototype,{length:{get:function(){return this._tweens.length}}});fh.prototype.add=function(e){if(e=x(e,x.EMPTY_OBJECT),e.duration===0)return u(e.complete)&&e.complete(),new S8(this);let t=e.duration/Yn.SECONDS_PER_MILLISECOND,n=x(e.delay,0),i=n/Yn.SECONDS_PER_MILLISECOND,o=x(e.easingFunction,Qr.LINEAR_NONE),r=e.startObject,s=new Vge(r);s.to(Ge(e.stopObject),t),s.delay(i),s.easing(o),u(e.update)&&s.onUpdate(function(){e.update(r)}),s.onComplete(x(e.complete,null)),s.repeat(x(e._repeat,0));let a=new S8(this,s,e.startObject,e.stopObject,e.duration,n,o,e.update,e.complete,e.cancel);return this._tweens.push(a),a};fh.prototype.addProperty=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.object,n=e.property,i=e.startValue,o=e.stopValue;function r(s){t[n]=s.value}return this.add({startObject:{value:i},stopObject:{value:o},duration:x(e.duration,3),delay:e.delay,easingFunction:e.easingFunction,update:r,complete:e.complete,cancel:e.cancel,_repeat:e._repeat})};fh.prototype.addAlpha=function(e){e=x(e,x.EMPTY_OBJECT);let t=e.material,n=[];for(let o in t.uniforms)t.uniforms.hasOwnProperty(o)&&u(t.uniforms[o])&&u(t.uniforms[o].alpha)&&n.push(o);function i(o){let r=n.length;for(let s=0;s<r;++s)t.uniforms[n[s]].alpha=o.alpha}return this.add({startObject:{alpha:x(e.startValue,0)},stopObject:{alpha:x(e.stopValue,1)},duration:x(e.duration,3),delay:e.delay,easingFunction:e.easingFunction,update:i,complete:e.complete,cancel:e.cancel})};fh.prototype.addOffsetIncrement=function(e){e=x(e,x.EMPTY_OBJECT);let n=e.material.uniforms;return this.addProperty({object:n,property:"offset",startValue:n.offset,stopValue:n.offset+1,duration:e.duration,delay:e.delay,easingFunction:e.easingFunction,update:e.update,cancel:e.cancel,_repeat:1/0})};fh.prototype.remove=function(e){if(!u(e))return!1;let t=this._tweens.indexOf(e);return t!==-1?(e.tweenjs.stop(),u(e.cancel)&&e.cancel(),this._tweens.splice(t,1),!0):!1};fh.prototype.removeAll=function(){let e=this._tweens;for(let t=0;t<e.length;++t){let n=e[t];n.tweenjs.stop(),u(n.cancel)&&n.cancel()}e.length=0};fh.prototype.contains=function(e){return u(e)&&this._tweens.indexOf(e)!==-1};fh.prototype.get=function(e){return this._tweens[e]};fh.prototype.update=function(e){let t=this._tweens,n=0;for(e=u(e)?e/Yn.SECONDS_PER_MILLISECOND:Ei();n<t.length;){let i=t[n],o=i.tweenjs;i.needsStart?(i.needsStart=!1,o.start(e)):o.update(e)?n++:(o.stop(),t.splice(n,1))}};var cS=fh;function uI(e){this.enableInputs=!0,this.enableTranslate=!0,this.enableZoom=!0,this.enableRotate=!0,this.enableTilt=!0,this.enableLook=!0,this.inertiaSpin=.9,this.inertiaTranslate=.9,this.inertiaZoom=.8,this.maximumMovementRatio=.1,this.bounceAnimationTime=3,this.minimumZoomDistance=1,this.maximumZoomDistance=Number.POSITIVE_INFINITY,this.zoomFactor=5,this.translateEventTypes=Ui.LEFT_DRAG,this.zoomEventTypes=[Ui.RIGHT_DRAG,Ui.WHEEL,Ui.PINCH],this.rotateEventTypes=Ui.LEFT_DRAG,this.tiltEventTypes=[Ui.MIDDLE_DRAG,Ui.PINCH,{eventType:Ui.LEFT_DRAG,modifier:_a.CTRL},{eventType:Ui.RIGHT_DRAG,modifier:_a.CTRL}],this.lookEventTypes={eventType:Ui.LEFT_DRAG,modifier:_a.SHIFT};let t=x(e.ellipsoid,ee.default);this.minimumPickingTerrainHeight=ee.WGS84.equals(t)?15e4:t.minimumRadius*.025,this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight,this.minimumPickingTerrainDistanceWithInertia=ee.WGS84.equals(t)?4e3:t.minimumRadius*63e-5,this.minimumCollisionTerrainHeight=ee.WGS84.equals(t)?15e3:t.minimumRadius*.0025,this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight,this.minimumTrackBallHeight=ee.WGS84.equals(t)?75e5:t.minimumRadius*1.175,this._minimumTrackBallHeight=this.minimumTrackBallHeight,this.enableCollisionDetection=!0,this.maximumTiltAngle=void 0,this._scene=e,this._globe=void 0,this._ellipsoid=t,this._lastGlobeHeight=0,this._aggregator=new E8(e.canvas),this._lastInertiaSpinMovement=void 0,this._lastInertiaZoomMovement=void 0,this._lastInertiaTranslateMovement=void 0,this._lastInertiaTiltMovement=void 0,this._inertiaDisablers={_lastInertiaZoomMovement:["_lastInertiaSpinMovement","_lastInertiaTranslateMovement","_lastInertiaTiltMovement"],_lastInertiaTiltMovement:["_lastInertiaSpinMovement","_lastInertiaTranslateMovement"]},this._tweens=new cS,this._tween=void 0,this._horizontalRotationAxis=void 0,this._tiltCenterMousePosition=new H(-1,-1),this._tiltCenter=new h,this._rotateMousePosition=new H(-1,-1),this._rotateStartPosition=new h,this._strafeStartPosition=new h,this._strafeMousePosition=new H,this._strafeEndMousePosition=new H,this._zoomMouseStart=new H(-1,-1),this._zoomWorldPosition=new h,this._useZoomWorldPosition=!1,this._panLastMousePosition=new H,this._panLastWorldPosition=new h,this._tiltCVOffMap=!1,this._looking=!1,this._rotating=!1,this._strafing=!1,this._zoomingOnVector=!1,this._zoomingUnderground=!1,this._rotatingZoom=!1,this._adjustedHeightForTerrain=!1,this._cameraUnderground=!1;let n=e.mapProjection;this._maxCoord=n.project(new de(Math.PI,R.PI_OVER_TWO)),this._rotateFactor=void 0,this._rotateRateRangeAdjustment=void 0,this._maximumRotateRate=1.77,this._minimumRotateRate=1/5e3,this._minimumZoomRate=20,this._maximumZoomRate=5906376272e3,this._minimumUndergroundPickDistance=2e3,this._maximumUndergroundPickDistance=1e4}function E0t(e,t){if(e<0)return 0;let n=(1-t)*25;return Math.exp(-n*e)}function S0t(e){return H.equalsEpsilon(e.startPosition,e.endPosition,R.EPSILON14)}var v0t=.4;function w0t(e,t,n,i,o,r,s){let a=r[s];u(a)||(a=r[s]={startPosition:new H,endPosition:new H,motion:new H,inertiaEnabled:!0});let c=e.getButtonPressTime(t,n),l=e.getButtonReleaseTime(t,n),f=c&&l&&(l.getTime()-c.getTime())/1e3,p=l&&(new Date().getTime()-l.getTime())/1e3;if(c&&l&&f<v0t){let g=E0t(p,i),m=e.getLastMovement(t,n);if(!u(m)||S0t(m)||!a.inertiaEnabled||(a.motion.x=(m.endPosition.x-m.startPosition.x)*.5,a.motion.y=(m.endPosition.y-m.startPosition.y)*.5,a.startPosition=H.clone(m.startPosition,a.startPosition),a.endPosition=H.multiplyByScalar(a.motion,g,a.endPosition),a.endPosition=H.add(a.startPosition,a.endPosition,a.endPosition),isNaN(a.endPosition.x)||isNaN(a.endPosition.y)||H.distance(a.startPosition,a.endPosition)<.5))return;if(!e.isButtonDown(t,n)){let y=e.getStartMousePosition(t,n);o(r,y,a)}}}function D0t(e,t){if(u(t)){let n=e[t];u(n)&&(n.inertiaEnabled=!0);let i=e._inertiaDisablers[t];if(u(i)){let o=i.length;for(let r=0;r<o;++r)n=e[i[r]],u(n)&&(n.inertiaEnabled=!1)}}}var GCe=[];function nl(e,t,n,i,o,r){if(!u(n))return;let s=e._aggregator;Array.isArray(n)||(GCe[0]=n,n=GCe);let a=n.length;for(let c=0;c<a;++c){let l=n[c],f=u(l.eventType)?l.eventType:l,d=l.modifier,p=s.isMoving(f,d)&&s.getMovement(f,d),g=s.getStartMousePosition(f,d);e.enableInputs&&t&&(p?(i(e,g,p),D0t(e,r)):o<1&&w0t(s,f,d,o,i,e,r))}}var v8=new _n,I0t=new h,P0t=new H,R0t=new h,O0t=new H,M0t=new h,L0t=new h,N0t=new h,F0t=new h,tAe=new h,B0t=new h,k0t=new h,V0t=new h,U0t=new h,z0t=new h,H0t=new h,G0t=new h,W0t=new h,j0t=new h,q0t=new h,Rb=new h,WCe=new h,jCe=new h,iZ={orientation:new Wa};function fZ(e,t,n,i,o,r){let s=1;u(r)&&(s=R.clamp(Math.abs(r),.25,1));let a=n.endPosition.y-n.startPosition.y,l=a>0?e.minimumZoomDistance*s:0,f=e.maximumZoomDistance,d=o-l,p=i*d;p=R.clamp(p,e._minimumZoomRate,e._maximumZoomRate);let g=a/e._scene.canvas.clientHeight;g=Math.min(g,e.maximumMovementRatio);let m=p*g;if(e.enableCollisionDetection||e.minimumZoomDistance===0||!u(e._globe)){if(m>0&&Math.abs(o-l)<1||m<0&&Math.abs(o-f)<1)return;o-m<l?m=o-l-1:o-m>f&&(m=o-f)}let y=e._scene,b=y.camera,C=y.mode,A=iZ.orientation;if(A.heading=b.heading,A.pitch=b.pitch,A.roll=b.roll,b.frustum instanceof sn){Math.abs(m)>0&&(b.zoomIn(m),b._adjustOrthographicFrustum(!0));return}let T=x(n.inertiaEnabled,H.equals(t,e._zoomMouseStart)),E=e._zoomingOnVector,v=e._rotatingZoom,D;if(T||(e._zoomMouseStart=H.clone(t,e._zoomMouseStart),u(e._globe)&&C===ne.SCENE2D?(D=b.getPickRay(t,v8).origin,D=h.fromElements(D.y,D.z,D.x)):u(e._globe)&&(D=C_(e,t,I0t)),u(D)?(e._useZoomWorldPosition=!0,e._zoomWorldPosition=h.clone(D,e._zoomWorldPosition)):e._useZoomWorldPosition=!1,E=e._zoomingOnVector=!1,v=e._rotatingZoom=!1,e._zoomingUnderground=e._cameraUnderground),!e._useZoomWorldPosition){b.zoomIn(m);return}let O=C===ne.COLUMBUS_VIEW;if(b.positionCartographic.height<2e6&&(v=!0),!T||v){if(C===ne.SCENE2D){let P=e._zoomWorldPosition,M=b.position;if(!h.equals(P,M)&&b.positionCartographic.height<e._maxCoord.x*2){let L=b.position.x,_=h.subtract(P,M,R0t);h.normalize(_,_);let S=h.distance(P,M)*m/(b.getMagnitude()*.5);b.move(_,S*.5),(b.position.x<0&&L>0||b.position.x>0&&L<0)&&(D=b.getPickRay(t,v8).origin,D=h.fromElements(D.y,D.z,D.x),e._zoomWorldPosition=h.clone(D,e._zoomWorldPosition))}}else if(C===ne.SCENE3D){let P=h.normalize(b.position,tAe);if(e._cameraUnderground||e._zoomingUnderground||b.positionCartographic.height<3e3&&Math.abs(h.dot(b.direction,P))<.6)O=!0;else{let M=y.canvas,L=O0t;L.x=M.clientWidth/2,L.y=M.clientHeight/2;let _=C_(e,L,M0t);if(!u(_))O=!0;else if(b.positionCartographic.height<1e6)if(h.dot(b.direction,P)>=-.5)O=!0;else{let S=k0t;h.clone(b.position,S);let w=e._zoomWorldPosition,I=B0t;if(I=h.normalize(w,I),h.dot(I,P)<0)return;let N=q0t,k=z0t;h.clone(b.direction,k),h.add(S,h.multiplyByScalar(k,1e3,Rb),N);let z=H0t,V=G0t;h.subtract(w,S,z),h.normalize(z,V);let U=h.dot(P,V);if(U>=0){e._zoomMouseStart.x=-1;return}let B=Math.acos(-U),W=h.magnitude(S),j=h.magnitude(w),Q=W-m,q=h.magnitude(z),X=Math.asin(R.clamp(q/j*Math.sin(B),-1,1)),Z=Math.asin(R.clamp(Q/j*Math.sin(B),-1,1)),fe=X-Z+B,xe=V0t;h.normalize(S,xe);let re=U0t;re=h.cross(V,xe,re),re=h.normalize(re,re),h.normalize(h.cross(xe,re,Rb),k),h.multiplyByScalar(h.normalize(N,Rb),h.magnitude(N)-m,N),h.normalize(S,S),h.multiplyByScalar(S,Q,S);let pe=W0t;h.multiplyByScalar(h.add(h.multiplyByScalar(xe,Math.cos(fe)-1,WCe),h.multiplyByScalar(k,Math.sin(fe),jCe),Rb),Q,pe),h.add(S,pe,S),h.normalize(N,xe),h.normalize(h.cross(xe,re,Rb),k);let ye=j0t;h.multiplyByScalar(h.add(h.multiplyByScalar(xe,Math.cos(fe)-1,WCe),h.multiplyByScalar(k,Math.sin(fe),jCe),Rb),h.magnitude(N),ye),h.add(N,ye,N),h.clone(S,b.position),h.normalize(h.subtract(N,S,Rb),b.direction),h.clone(b.direction,b.direction),h.cross(b.direction,b.up,b.right),h.cross(b.right,b.direction,b.up),b.setView(iZ);return}else{let S=h.normalize(_,L0t),w=h.normalize(e._zoomWorldPosition,N0t),I=h.dot(w,S);if(I>0&&I<1){let N=R.acosClamped(I),k=h.cross(w,S,F0t),z=Math.abs(N)>R.toRadians(20)?b.positionCartographic.height*.75:b.positionCartographic.height-m,V=m/z;b.rotate(k,N*V)}}}}e._rotatingZoom=!O}if(!T&&O||E){let P,M=Wi.worldToWindowCoordinates(y,e._zoomWorldPosition,P0t);C!==ne.COLUMBUS_VIEW&&H.equals(t,e._zoomMouseStart)&&u(M)?P=b.getPickRay(M,v8):P=b.getPickRay(t,v8);let L=P.direction;(C===ne.COLUMBUS_VIEW||C===ne.SCENE2D)&&h.fromElements(L.y,L.z,L.x,L),b.move(L,m),e._zoomingOnVector=!0}else b.zoomIn(m);e._cameraUnderground||b.setView(iZ)}var Y0t=new _n,X0t=new _n,K0t=new h;function Z0t(e,t,n){let o=e._scene.camera,r=o.getPickRay(n.startPosition,Y0t).origin,s=o.getPickRay(n.endPosition,X0t).origin;r=h.fromElements(r.y,r.z,r.x,r),s=h.fromElements(s.y,s.z,s.x,s);let a=h.subtract(r,s,K0t),c=h.magnitude(a);c>0&&(h.normalize(a,a),o.move(a,c))}function qCe(e,t,n){u(n.distance)&&(n=n.distance);let o=e._scene.camera;fZ(e,t,n,e.zoomFactor,o.getMagnitude())}var $0t=new H,Q0t=new H;function YCe(e,t,n){if(u(n.angleAndHeight)){J0t(e,t,n.angleAndHeight);return}let i=e._scene,o=i.camera,r=i.canvas,s=r.clientWidth,a=r.clientHeight,c=$0t;c.x=2/s*n.startPosition.x-1,c.y=2/a*(a-n.startPosition.y)-1,c=H.normalize(c,c);let l=Q0t;l.x=2/s*n.endPosition.x-1,l.y=2/a*(a-n.endPosition.y)-1,l=H.normalize(l,l);let f=R.acosClamped(c.x);c.y<0&&(f=R.TWO_PI-f);let d=R.acosClamped(l.x);l.y<0&&(d=R.TWO_PI-d);let p=d-f;o.twistRight(p)}function J0t(e,t,n){let i=e._rotateFactor*e._rotateRateRangeAdjustment;i>e._maximumRotateRate&&(i=e._maximumRotateRate),i<e._minimumRotateRate&&(i=e._minimumRotateRate);let o=e._scene,r=o.camera,s=o.canvas,a=(n.endPosition.x-n.startPosition.x)/s.clientWidth;a=Math.min(a,e.maximumMovementRatio);let c=i*a*Math.PI*4;r.twistRight(c)}function eyt(e){let t=e._scene.mapMode2D===Mu.ROTATE;F.equals(F.IDENTITY,e._scene.camera.transform)?(nl(e,e.enableTranslate,e.translateEventTypes,Z0t,e.inertiaTranslate,"_lastInertiaTranslateMovement"),nl(e,e.enableZoom,e.zoomEventTypes,qCe,e.inertiaZoom,"_lastInertiaZoomMovement"),t&&nl(e,e.enableRotate,e.tiltEventTypes,YCe,e.inertiaSpin,"_lastInertiaTiltMovement")):(nl(e,e.enableZoom,e.zoomEventTypes,qCe,e.inertiaZoom,"_lastInertiaZoomMovement"),t&&nl(e,e.enableRotate,e.translateEventTypes,YCe,e.inertiaSpin,"_lastInertiaSpinMovement"))}var nAe=new _n,tyt=new h,nyt=new h;function C_(e,t,n){let i=e._scene,o=e._globe,r=i.camera,s;if(i.pickPositionSupported&&(s=i.pickPositionWorldCoordinates(t,tyt)),!u(o))return h.clone(s,n);let a=!e._cameraUnderground,c=r.getPickRay(t,nAe),l=o.pickWorldCoordinates(c,i,a,nyt),f=u(s)?h.distance(s,r.positionWC):Number.POSITIVE_INFINITY,d=u(l)?h.distance(l,r.positionWC):Number.POSITIVE_INFINITY;return f<d?h.clone(s,n):h.clone(l,n)}var iyt=new de;function M8(e){let t=e._ellipsoid,n=e._scene,i=n.camera,o=n.mode,r=0;if(o===ne.SCENE3D){let c=t.cartesianToCartographic(i.position,iyt);u(c)&&(r=c.height)}else r=i.position.z;let s=x(e._scene.globeHeight,0);return Math.abs(s-r)}var oyt=new h;function iAe(e,t){let n=t.origin,i=t.direction,o=M8(e),r=h.normalize(n,oyt),s=Math.abs(h.dot(r,i));return s=Math.max(s,.5)*2,o*s}function oAe(e,t,n,i){let o=h.distance(t.origin,n),r=M8(e),s=R.clamp(r*5,e._minimumUndergroundPickDistance,e._maximumUndergroundPickDistance);return o>s&&(o=Math.min(o,r/5),o=Math.max(o,100)),_n.getPoint(t,o,i)}function rAe(e,t,n,i){let o;return u(n)?(o=h.distance(t.origin,n),o>e._maximumUndergroundPickDistance&&(o=M8(e))):o=M8(e),_n.getPoint(t,o,i)}var ryt=new H;function sAe(e,t){let n=t.endPosition,i=H.subtract(t.endPosition,t.startPosition,ryt),o=e._strafeEndMousePosition;H.add(o,i,o),t.endPosition=o,dZ(e,t,e._strafeStartPosition),t.endPosition=n}var XCe=new _n,syt=new _n,oZ=new h,ayt=new h,cyt=new h,lyt=new h,uyt=new cn(h.UNIT_X,0),fyt=new H,dyt=new H;function hyt(e,t,n){if(h.equals(t,e._translateMousePosition)||(e._looking=!1),h.equals(t,e._strafeMousePosition)||(e._strafing=!1),e._looking){Fu(e,t,n);return}if(e._strafing){sAe(e,n);return}let o=e._scene.camera,r=e._cameraUnderground,s=H.clone(n.startPosition,fyt),a=H.clone(n.endPosition,dyt),c=o.getPickRay(s,XCe),l=h.clone(h.ZERO,lyt),f=h.UNIT_X,d;if(o.position.z<e._minimumPickingTerrainHeight&&(d=C_(e,s,oZ),u(d)&&(l.x=d.x)),r||l.x>o.position.z&&u(d)){let T=d;r&&(T=rAe(e,c,d,oZ)),H.clone(t,e._strafeMousePosition),H.clone(t,e._strafeEndMousePosition),h.clone(T,e._strafeStartPosition),e._strafing=!0,dZ(e,n,e._strafeStartPosition);return}let p=cn.fromPointNormal(l,f,uyt);c=o.getPickRay(s,XCe);let g=Qn.rayPlane(c,p,oZ),m=o.getPickRay(a,syt),y=Qn.rayPlane(m,p,ayt);if(!u(g)||!u(y)){e._looking=!0,Fu(e,t,n),H.clone(t,e._translateMousePosition);return}let b=h.subtract(g,y,cyt),C=b.x;b.x=b.y,b.y=b.z,b.z=C;let A=h.magnitude(b);A>R.EPSILON6&&(h.normalize(b,b),o.move(b,A))}var aAe=new H,I8=new _n,P8=new h,myt=new h,cAe=new F,pyt=new F,_yt=new h,gyt=new cn(h.UNIT_X,0),rZ=new h,cZ=new de,lAe=new F,yyt=new Le,xyt=new J,R8=new h;function byt(e,t,n){if(u(n.angleAndHeight)&&(n=n.angleAndHeight),H.equals(t,e._tiltCenterMousePosition)||(e._tiltCVOffMap=!1,e._looking=!1),e._looking){Fu(e,t,n);return}let o=e._scene.camera;e._tiltCVOffMap||!e.onMap()||Math.abs(o.position.z)>e._minimumPickingTerrainHeight?(e._tiltCVOffMap=!0,Cyt(e,t,n)):Ayt(e,t,n)}function Cyt(e,t,n){let i=e._scene,o=i.camera,r=i.canvas,s=aAe;s.x=r.clientWidth/2,s.y=r.clientHeight/2;let a=o.getPickRay(s,I8),c=h.UNIT_X,l=a.origin,f=a.direction,d,p=h.dot(c,f);if(Math.abs(p)>R.EPSILON6&&(d=-h.dot(c,l)/p),!u(d)||d<=0){e._looking=!0,Fu(e,t,n),H.clone(t,e._tiltCenterMousePosition);return}let g=h.multiplyByScalar(f,d,P8);h.add(l,g,g);let m=i.mapProjection,y=m.ellipsoid;h.fromElements(g.y,g.z,g.x,g);let b=m.unproject(g,cZ);y.cartographicToCartesian(b,g);let C=Lt.eastNorthUpToFixedFrame(g,y,cAe),A=e._globe,T=e._ellipsoid;e._globe=void 0,e._ellipsoid=ee.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;let E=F.clone(o.transform,lAe);o._setTransform(C),Nu(e,t,n,h.UNIT_Z),o._setTransform(E),e._globe=A,e._ellipsoid=T;let v=T.maximumRadius;e._rotateFactor=1/v,e._rotateRateRangeAdjustment=v}function Ayt(e,t,n){let i=e._scene,o=i.camera,r=e._cameraUnderground,s,a,c=h.UNIT_X;if(H.equals(t,e._tiltCenterMousePosition))s=h.clone(e._tiltCenter,P8);else{if(o.position.z<e._minimumPickingTerrainHeight&&(s=C_(e,t,P8)),!u(s)){a=o.getPickRay(t,I8);let _=a.origin,S=a.direction,w,I=h.dot(c,S);if(Math.abs(I)>R.EPSILON6&&(w=-h.dot(c,_)/I),!u(w)||w<=0){e._looking=!0,Fu(e,t,n),H.clone(t,e._tiltCenterMousePosition);return}s=h.multiplyByScalar(S,w,P8),h.add(_,s,s)}r&&(u(a)||(a=o.getPickRay(t,I8)),oAe(e,a,s,s)),H.clone(t,e._tiltCenterMousePosition),h.clone(s,e._tiltCenter)}let l=i.canvas,f=aAe;f.x=l.clientWidth/2,f.y=e._tiltCenterMousePosition.y,a=o.getPickRay(f,I8);let d=h.clone(h.ZERO,_yt);d.x=s.x;let p=cn.fromPointNormal(d,c,gyt),g=Qn.rayPlane(a,p,myt),m=o._projection,y=m.ellipsoid;h.fromElements(s.y,s.z,s.x,s);let b=m.unproject(s,cZ);y.cartographicToCartesian(b,s);let C=Lt.eastNorthUpToFixedFrame(s,y,cAe),A;u(g)?(h.fromElements(g.y,g.z,g.x,g),b=m.unproject(g,cZ),y.cartographicToCartesian(b,g),A=Lt.eastNorthUpToFixedFrame(g,y,pyt)):A=C;let T=e._globe,E=e._ellipsoid;e._globe=void 0,e._ellipsoid=ee.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;let v=h.UNIT_Z,D=F.clone(o.transform,lAe);o._setTransform(C);let O=h.cross(h.UNIT_Z,h.normalize(o.position,rZ),rZ),P=h.dot(o.right,O);if(Nu(e,t,n,v,!1,!0),o._setTransform(A),P<0){let _=n.startPosition.y-n.endPosition.y;(r&&_<0||!r&&_>0)&&(v=void 0);let S=o.constrainedAxis;o.constrainedAxis=void 0,Nu(e,t,n,v,!0,!1),o.constrainedAxis=S}else Nu(e,t,n,v,!0,!1);if(u(o.constrainedAxis)){let _=h.cross(o.direction,o.constrainedAxis,R8);h.equalsEpsilon(_,h.ZERO,R.EPSILON6)||(h.dot(_,o.right)<0&&h.negate(_,_),h.cross(_,o.direction,o.up),h.cross(o.direction,o.up,o.right),h.normalize(o.up,o.up),h.normalize(o.right,o.right))}o._setTransform(D),e._globe=T,e._ellipsoid=E;let M=E.maximumRadius;e._rotateFactor=1/M,e._rotateRateRangeAdjustment=M;let L=h.clone(o.positionWC,rZ);if(e.enableCollisionDetection&&pZ(e,!0),!h.equals(o.positionWC,L)){o._setTransform(A),o.worldToCameraCoordinatesPoint(L,L);let _=h.magnitudeSquared(L);h.magnitudeSquared(o.position)>_&&(h.normalize(o.position,o.position),h.multiplyByScalar(o.position,Math.sqrt(_),o.position));let S=h.angleBetween(L,o.position),w=h.cross(L,o.position,L);h.normalize(w,w);let I=Le.fromAxisAngle(w,S,yyt),N=J.fromQuaternion(I,xyt);J.multiplyByVector(N,o.direction,o.direction),J.multiplyByVector(N,o.up,o.up),h.cross(o.direction,o.up,o.right),h.cross(o.right,o.direction,o.up),o._setTransform(D)}}var uAe=new H,fAe=new _n,dAe=new h;function Tyt(e,t,n){u(n.distance)&&(n=n.distance);let i=e._scene,o=i.camera,r=i.canvas,s=e._cameraUnderground,a;s?a=t:(a=uAe,a.x=r.clientWidth/2,a.y=r.clientHeight/2);let c=o.getPickRay(a,fAe),l=c.origin,f=c.direction,d=o.position.z,p;d<e._minimumPickingTerrainHeight&&(p=C_(e,a,dAe));let g;if(u(p)&&(g=h.distance(l,p)),s){let m=iAe(e,c,d);u(g)?g=Math.min(g,m):g=m}if(!u(g)){let m=h.UNIT_X;g=-h.dot(m,l)/h.dot(m,f)}fZ(e,t,n,e.zoomFactor,g)}function Eyt(e){let n=e._scene.camera;if(!F.equals(F.IDENTITY,n.transform))nl(e,e.enableRotate,e.rotateEventTypes,Nu,e.inertiaSpin,"_lastInertiaSpinMovement"),nl(e,e.enableZoom,e.zoomEventTypes,mAe,e.inertiaZoom,"_lastInertiaZoomMovement");else{let i=e._tweens;if(e._aggregator.anyButtonDown&&i.removeAll(),nl(e,e.enableTilt,e.tiltEventTypes,byt,e.inertiaSpin,"_lastInertiaTiltMovement"),nl(e,e.enableTranslate,e.translateEventTypes,hyt,e.inertiaTranslate,"_lastInertiaTranslateMovement"),nl(e,e.enableZoom,e.zoomEventTypes,Tyt,e.inertiaZoom,"_lastInertiaZoomMovement"),nl(e,e.enableLook,e.lookEventTypes,Fu),!e._aggregator.anyButtonDown&&!i.contains(e._tween)){let o=n.createCorrectPositionTween(e.bounceAnimationTime);u(o)&&(e._tween=i.add(o))}i.update()}}var Syt=new _n,vyt=new cn(h.UNIT_X,0),wyt=new h,Dyt=new h;function dZ(e,t,n){let i=e._scene,o=i.camera,r=o.getPickRay(t.endPosition,Syt),s=h.clone(o.direction,Dyt);i.mode===ne.COLUMBUS_VIEW&&h.fromElements(s.z,s.x,s.y,s);let a=cn.fromPointNormal(n,s,vyt),c=Qn.rayPlane(r,a,wyt);u(c)&&(s=h.subtract(n,c,s),i.mode===ne.COLUMBUS_VIEW&&h.fromElements(s.y,s.z,s.x,s),h.add(o.position,s,o.position))}var KCe=new h,hAe=new de,lZ=new h,uZ=new ee,Iyt=new h,Pyt=new h,Ryt=new h;function Oyt(e,t,n){let o=e._scene.camera,r=e._cameraUnderground,s=e._ellipsoid;if(!F.equals(o.transform,F.IDENTITY)){Nu(e,t,n);return}let a,c,l=s.geodeticSurfaceNormal(o.position,Iyt);if(H.equals(t,e._rotateMousePosition)){if(e._looking)Fu(e,t,n,l);else if(e._rotating)Nu(e,t,n);else if(e._strafing)sAe(e,n);else{if(h.magnitude(o.position)<h.magnitude(e._rotateStartPosition))return;a=h.magnitude(e._rotateStartPosition),c=lZ,c.x=c.y=c.z=a,s=ee.fromCartesian3(c,uZ),aZ(e,t,n,s)}return}e._looking=!1,e._rotating=!1,e._strafing=!1;let f=s.cartesianToCartographic(o.positionWC,hAe).height,d=e._globe;if(u(d)&&f<e._minimumPickingTerrainHeight){let p=C_(e,n.startPosition,Ryt);if(u(p)){let g=!1,m=o.getPickRay(n.startPosition,nAe);if(r)g=!0,rAe(e,m,p,p);else{let y=s.geodeticSurfaceNormal(p,Pyt);Math.abs(h.dot(m.direction,y))<.05?g=!0:g=h.magnitude(o.position)<h.magnitude(p)}g?(H.clone(t,e._strafeEndMousePosition),h.clone(p,e._strafeStartPosition),e._strafing=!0,dZ(e,n,e._strafeStartPosition)):(a=h.magnitude(p),c=lZ,c.x=c.y=c.z=a,s=ee.fromCartesian3(c,uZ),aZ(e,t,n,s),h.clone(p,e._rotateStartPosition))}else e._looking=!0,Fu(e,t,n,l)}else u(o.pickEllipsoid(n.startPosition,e._ellipsoid,KCe))?(aZ(e,t,n,e._ellipsoid),h.clone(KCe,e._rotateStartPosition)):f>e._minimumTrackBallHeight?(e._rotating=!0,Nu(e,t,n)):(e._looking=!0,Fu(e,t,n,l));H.clone(t,e._rotateMousePosition)}function Nu(e,t,n,i,o,r){o=x(o,!1),r=x(r,!1);let s=e._scene,a=s.camera,c=s.canvas,l=a.constrainedAxis;u(i)&&(a.constrainedAxis=i);let f=h.magnitude(a.position),d=e._rotateFactor*(f-e._rotateRateRangeAdjustment);d>e._maximumRotateRate&&(d=e._maximumRotateRate),d<e._minimumRotateRate&&(d=e._minimumRotateRate);let p=(n.startPosition.x-n.endPosition.x)/c.clientWidth,g=(n.startPosition.y-n.endPosition.y)/c.clientHeight;p=Math.min(p,e.maximumMovementRatio),g=Math.min(g,e.maximumMovementRatio);let m=d*p*Math.PI*2,y=d*g*Math.PI;if(u(i)&&u(e.maximumTiltAngle)){let b=e.maximumTiltAngle,C=h.dot(a.direction,i),A=Math.PI-Math.acos(C)+y;A>b&&(y-=A-b)}o||a.rotateRight(m),r||a.rotateUp(y),a.constrainedAxis=l}var sZ=oe.clone(oe.UNIT_W),ZCe=oe.clone(oe.UNIT_W),w8=new h,lS=new h,D8=new h,$Ce=new h,Myt=new H,Lyt=new H,Nyt=new H,Fyt=new H,Byt=new _n;function aZ(e,t,n,i){let o=e._scene,r=o.camera,s=H.clone(n.startPosition,Myt),a=H.clone(n.endPosition,Lyt),c=i.cartesianToCartographic(r.positionWC,hAe).height,l,f;if(!n.inertiaEnabled&&c<e._minimumPickingTerrainHeight&&(l=h.clone(e._panLastWorldPosition,sZ),!u(e._globe)&&!H.equalsEpsilon(s,e._panLastMousePosition)&&(l=C_(e,s,sZ)),!u(e._globe)&&u(l))){let d=h.subtract(l,r.positionWC,lS),p=h.multiplyByScalar(r.directionWC,h.dot(r.directionWC,d),lS),g=h.magnitude(p),m=r.frustum.getPixelDimensions(o.drawingBufferWidth,o.drawingBufferHeight,g,o.pixelRatio,Fyt),y=H.subtract(a,s,Nyt),b=h.multiplyByScalar(r.rightWC,y.x*m.x,lS),C=h.normalize(r.positionWC,tAe),A=r.getPickRay(a,Byt).direction,T=h.subtract(A,h.projectVector(A,r.rightWC,D8),D8),E=h.angleBetween(T,r.directionWC),v=1;u(r.frustum.fov)&&(v=Math.max(Math.tan(E),.1));let D=Math.abs(h.dot(r.directionWC,C)),O=-y.y*m.y*2/Math.sqrt(v)*(1-D),P=h.multiplyByScalar(A,O,D8);D=Math.abs(h.dot(r.upWC,C));let M=h.multiplyByScalar(r.upWC,-y.y*(1-D)*m.y,$Ce);f=h.add(l,b,ZCe),f=h.add(f,P,f),f=h.add(f,M,f),h.clone(f,e._panLastWorldPosition),H.clone(a,e._panLastMousePosition)}if((!u(l)||!u(f))&&(l=r.pickEllipsoid(s,i,sZ),f=r.pickEllipsoid(a,i,ZCe)),!u(l)||!u(f)){e._rotating=!0,Nu(e,t,n);return}if(l=r.worldToCameraCoordinates(l,l),f=r.worldToCameraCoordinates(f,f),u(r.constrainedAxis)){let d=r.constrainedAxis,p=h.mostOrthogonalAxis(d,w8);h.cross(p,d,p),h.normalize(p,p);let g=h.cross(d,p,lS),m=h.magnitude(l),y=h.dot(d,l),b=Math.acos(y/m),C=h.multiplyByScalar(d,y,D8);h.subtract(l,C,C),h.normalize(C,C);let A=h.magnitude(f),T=h.dot(d,f),E=Math.acos(T/A),v=h.multiplyByScalar(d,T,$Ce);h.subtract(f,v,v),h.normalize(v,v);let D=Math.acos(h.dot(C,p));h.dot(C,g)<0&&(D=R.TWO_PI-D);let O=Math.acos(h.dot(v,p));h.dot(v,g)<0&&(O=R.TWO_PI-O);let P=D-O,M;h.equalsEpsilon(d,r.position,R.EPSILON2)?M=r.right:M=h.cross(d,r.position,w8);let L=h.cross(d,M,w8),_=h.dot(L,h.subtract(l,d,lS)),S=h.dot(L,h.subtract(f,d,lS)),w;_>0&&S>0?w=E-b:_>0&&S<=0?h.dot(r.position,d)>0?w=-b-E:w=b+E:w=b-E,r.rotateRight(P),r.rotateUp(w)}else{h.normalize(l,l),h.normalize(f,f);let d=h.dot(l,f),p=h.cross(l,f,w8);if(d<1&&!h.equalsEpsilon(p,h.ZERO,R.EPSILON14)){let g=Math.acos(d);r.rotate(p,g)}}}var kyt=new h,Vyt=new de,QCe=0;function mAe(e,t,n){u(n.distance)&&(n=n.distance);let i=n.inertiaEnabled,o=e._ellipsoid,r=e._scene,s=r.camera,a=r.canvas,c=e._cameraUnderground,l;c?l=t:(l=uAe,l.x=a.clientWidth/2,l.y=a.clientHeight/2);let f=s.getPickRay(l,fAe),d,p=o.cartesianToCartographic(s.position,Vyt).height,g=Math.abs(QCe)<e.minimumPickingTerrainDistanceWithInertia;(i?g:p<e._minimumPickingTerrainHeight)&&(d=C_(e,l,dAe));let y;if(u(d)&&(y=h.distance(f.origin,d),QCe=y),c){let C=iAe(e,f,p);u(y)?y=Math.min(y,C):y=C}u(y)||(y=p);let b=h.normalize(s.position,kyt);fZ(e,t,n,e.zoomFactor,y,h.dot(b,s.direction))}var pAe=new H,O8=new _n,lI=new h,Uyt=new h,_Ae=new F,zyt=new F,gAe=new F,Hyt=new Le,Gyt=new J,hZ=new de,mZ=new h;function Wyt(e,t,n){let o=e._scene.camera;if(!F.equals(o.transform,F.IDENTITY))return;if(u(n.angleAndHeight)&&(n=n.angleAndHeight),H.equals(t,e._tiltCenterMousePosition)||(e._tiltOnEllipsoid=!1,e._looking=!1),e._looking){let a=e._ellipsoid.geodeticSurfaceNormal(o.position,mZ);Fu(e,t,n,a);return}let s=e._ellipsoid.cartesianToCartographic(o.position,hZ);e._tiltOnEllipsoid||s.height>e._minimumCollisionTerrainHeight?(e._tiltOnEllipsoid=!0,qyt(e,t,n)):Yyt(e,t,n)}var jyt=new de;function qyt(e,t,n){let i=e._ellipsoid,o=e._scene,r=o.camera,s=e.minimumZoomDistance*.25,a=i.cartesianToCartographic(r.positionWC,jyt).height;if(a-s-1<R.EPSILON3&&n.endPosition.y-n.startPosition.y<0)return;let c=o.canvas,l=pAe;l.x=c.clientWidth/2,l.y=c.clientHeight/2;let f=r.getPickRay(l,O8),d,p=Qn.rayEllipsoid(f,i);if(u(p))d=_n.getPoint(f,p.start,lI);else if(a>e._minimumTrackBallHeight){let A=Qn.grazingAltitudeLocation(f,i);if(!u(A))return;let T=i.cartesianToCartographic(A,hZ);T.height=0,d=i.cartographicToCartesian(T,lI)}else{e._looking=!0;let A=e._ellipsoid.geodeticSurfaceNormal(r.position,mZ);Fu(e,t,n,A),H.clone(t,e._tiltCenterMousePosition);return}let g=Lt.eastNorthUpToFixedFrame(d,i,_Ae),m=e._globe,y=e._ellipsoid;e._globe=void 0,e._ellipsoid=ee.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;let b=F.clone(r.transform,gAe);r._setTransform(g),Nu(e,t,n,h.UNIT_Z),r._setTransform(b),e._globe=m,e._ellipsoid=y;let C=y.maximumRadius;e._rotateFactor=1/C,e._rotateRateRangeAdjustment=C}function Yyt(e,t,n){let i=e._ellipsoid,o=e._scene,r=o.camera,s=e._cameraUnderground,a,c,l;if(H.equals(t,e._tiltCenterMousePosition))a=h.clone(e._tiltCenter,lI);else{if(a=C_(e,t,lI),!u(a)){if(c=r.getPickRay(t,O8),l=Qn.rayEllipsoid(c,i),!u(l)){if(i.cartesianToCartographic(r.position,hZ).height<=e._minimumTrackBallHeight){e._looking=!0;let S=e._ellipsoid.geodeticSurfaceNormal(r.position,mZ);Fu(e,t,n,S),H.clone(t,e._tiltCenterMousePosition)}return}a=_n.getPoint(c,l.start,lI)}s&&(u(c)||(c=r.getPickRay(t,O8)),oAe(e,c,a,a)),H.clone(t,e._tiltCenterMousePosition),h.clone(a,e._tiltCenter)}let f=o.canvas,d=pAe;d.x=f.clientWidth/2,d.y=e._tiltCenterMousePosition.y,c=r.getPickRay(d,O8);let p=h.magnitude(a),g=h.fromElements(p,p,p,lZ),m=ee.fromCartesian3(g,uZ);if(l=Qn.rayEllipsoid(c,m),!u(l))return;let y=h.magnitude(c.origin)>p?l.start:l.stop,b=_n.getPoint(c,y,Uyt),C=Lt.eastNorthUpToFixedFrame(a,i,_Ae),A=Lt.eastNorthUpToFixedFrame(b,m,zyt),T=e._globe,E=e._ellipsoid;e._globe=void 0,e._ellipsoid=ee.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;let v=h.UNIT_Z,D=F.clone(r.transform,gAe);r._setTransform(A);let O=h.cross(b,r.positionWC,R8);if(h.dot(r.rightWC,O)<0){let _=n.startPosition.y-n.endPosition.y;(s&&_<0||!s&&_>0)&&(v=void 0);let S=r.constrainedAxis;r.constrainedAxis=void 0,Nu(e,t,n,v,!0,!1),r.constrainedAxis=S}else Nu(e,t,n,v,!0,!1);if(r._setTransform(C),Nu(e,t,n,v,!1,!0),u(r.constrainedAxis)){let _=h.cross(r.direction,r.constrainedAxis,R8);h.equalsEpsilon(_,h.ZERO,R.EPSILON6)||(h.dot(_,r.right)<0&&h.negate(_,_),h.cross(_,r.direction,r.up),h.cross(r.direction,r.up,r.right),h.normalize(r.up,r.up),h.normalize(r.right,r.right))}r._setTransform(D),e._globe=T,e._ellipsoid=E;let M=E.maximumRadius;e._rotateFactor=1/M,e._rotateRateRangeAdjustment=M;let L=h.clone(r.positionWC,R8);if(e.enableCollisionDetection&&pZ(e,!0),!h.equals(r.positionWC,L)){r._setTransform(A),r.worldToCameraCoordinatesPoint(L,L);let _=h.magnitudeSquared(L);h.magnitudeSquared(r.position)>_&&(h.normalize(r.position,r.position),h.multiplyByScalar(r.position,Math.sqrt(_),r.position));let S=h.angleBetween(L,r.position),w=h.cross(L,r.position,L);h.normalize(w,w);let I=Le.fromAxisAngle(w,S,Hyt),N=J.fromQuaternion(I,Gyt);J.multiplyByVector(N,r.direction,r.direction),J.multiplyByVector(N,r.up,r.up),h.cross(r.direction,r.up,r.right),h.cross(r.right,r.direction,r.up),r._setTransform(D)}}var Xyt=new H,Kyt=new H,JCe=new _n,eAe=new _n,Zyt=new h,$yt=new h;function Fu(e,t,n,i){let r=e._scene.camera,s=Xyt;s.x=n.startPosition.x,s.y=0;let a=Kyt;a.x=n.endPosition.x,a.y=0;let c=r.getPickRay(s,JCe),l=r.getPickRay(a,eAe),f=0,d,p;r.frustum instanceof sn?(d=c.origin,p=l.origin,h.add(r.direction,d,d),h.add(r.direction,p,p),h.subtract(d,r.position,d),h.subtract(p,r.position,p),h.normalize(d,d),h.normalize(p,p)):(d=c.direction,p=l.direction);let g=h.dot(d,p);g<1&&(f=Math.acos(g)),f=n.startPosition.x>n.endPosition.x?-f:f;let m=e._horizontalRotationAxis;if(u(i)?r.look(i,-f):u(m)?r.look(m,-f):r.lookLeft(f),s.x=0,s.y=n.startPosition.y,a.x=0,a.y=n.endPosition.y,c=r.getPickRay(s,JCe),l=r.getPickRay(a,eAe),f=0,r.frustum instanceof sn?(d=c.origin,p=l.origin,h.add(r.direction,d,d),h.add(r.direction,p,p),h.subtract(d,r.position,d),h.subtract(p,r.position,p),h.normalize(d,d),h.normalize(p,p)):(d=c.direction,p=l.direction),g=h.dot(d,p),g<1&&(f=Math.acos(g)),f=n.startPosition.y>n.endPosition.y?-f:f,i=x(i,m),u(i)){let y=r.direction,b=h.negate(i,Zyt),C=h.equalsEpsilon(y,i,R.EPSILON2),A=h.equalsEpsilon(y,b,R.EPSILON2);if(!C&&!A){g=h.dot(y,i);let T=R.acosClamped(g);f>0&&f>T&&(f=T-R.EPSILON4),g=h.dot(y,b),T=R.acosClamped(g),f<0&&-f>T&&(f=-T+R.EPSILON4);let E=h.cross(i,y,$yt);r.look(E,f)}else(C&&f<0||A&&f>0)&&r.look(r.right,-f)}else r.lookUp(f)}function Qyt(e){nl(e,e.enableRotate,e.rotateEventTypes,Oyt,e.inertiaSpin,"_lastInertiaSpinMovement"),nl(e,e.enableZoom,e.zoomEventTypes,mAe,e.inertiaZoom,"_lastInertiaZoomMovement"),nl(e,e.enableTilt,e.tiltEventTypes,Wyt,e.inertiaSpin,"_lastInertiaTiltMovement"),nl(e,e.enableLook,e.lookEventTypes,Fu)}var Jyt=new F,ext=new de;function pZ(e,t){e._adjustedHeightForTerrain=!0;let n=e._scene,i=n.mode;if(i===ne.SCENE2D||i===ne.MORPHING)return;let o=n.camera,r=x(n.ellipsoid,ee.WGS84),s=n.mapProjection,a,c;F.equals(o.transform,F.IDENTITY)||(a=F.clone(o.transform,Jyt),c=h.magnitude(o.position),o._setTransform(F.IDENTITY));let l=ext;i===ne.SCENE3D?r.cartesianToCartographic(o.position,l):s.unproject(o.position,l);let f=!1;if(l.height<e._minimumCollisionTerrainHeight){let d=e._scene.globeHeight;if(u(d)){let p=d+e.minimumZoomDistance,g=d-e._lastGlobeHeight,m=g/e._lastGlobeHeight;l.height<p&&(t||Math.abs(m)<=.1)&&(l.height=p,i===ne.SCENE3D?r.cartographicToCartesian(l,o.position):s.project(l,o.position),f=!0),t||Math.abs(m)<=.1?e._lastGlobeHeight=d:e._lastGlobeHeight+=g*.1}}u(a)&&(o._setTransform(a),f&&(h.normalize(o.position,o.position),h.negate(o.position,o.direction),h.multiplyByScalar(o.position,Math.max(c,e.minimumZoomDistance),o.position),h.normalize(o.direction,o.direction),h.cross(o.direction,o.up,o.right),h.cross(o.right,o.direction,o.up)))}uI.prototype.onMap=function(){let e=this._scene,t=e.mode,n=e.camera;return t===ne.COLUMBUS_VIEW?Math.abs(n.position.x)-this._maxCoord.x<0&&Math.abs(n.position.y)-this._maxCoord.y<0:!0};var txt=new h,nxt=new h;uI.prototype.update=function(){let e=this._scene,{camera:t,globe:n,mode:i}=e;F.equals(t.transform,F.IDENTITY)?(this._globe=n,this._ellipsoid=x(e.ellipsoid,ee.default)):(this._globe=void 0,this._ellipsoid=ee.UNIT_SPHERE);let{verticalExaggeration:o,verticalExaggerationRelativeHeight:r}=e;this._minimumCollisionTerrainHeight=Mr.getHeight(this.minimumCollisionTerrainHeight,o,r),this._minimumPickingTerrainHeight=Mr.getHeight(this.minimumPickingTerrainHeight,o,r),this._minimumTrackBallHeight=Mr.getHeight(this.minimumTrackBallHeight,o,r),this._cameraUnderground=e.cameraUnderground&&u(this._globe);let s=this._ellipsoid.maximumRadius;this._rotateFactor=1/s,this._rotateRateRangeAdjustment=s,this._adjustedHeightForTerrain=!1;let a=h.clone(t.positionWC,txt),c=h.clone(t.directionWC,nxt);if(i===ne.SCENE2D?eyt(this):i===ne.COLUMBUS_VIEW?(this._horizontalRotationAxis=h.UNIT_Z,Eyt(this)):i===ne.SCENE3D&&(this._horizontalRotationAxis=void 0,Qyt(this)),this.enableCollisionDetection&&!this._adjustedHeightForTerrain){let l=!h.equals(a,t.positionWC)||!h.equals(c,t.directionWC);pZ(this,l)}this._aggregator.reset()};uI.prototype.isDestroyed=function(){return!1};uI.prototype.destroy=function(){return this._tweens.removeAll(),this._aggregator=this._aggregator&&this._aggregator.destroy(),ue(this)};var L8=uI;var N8=`uniform sampler2D colorTexture;
uniform sampler2D colorTexture2;

uniform vec2 center;
uniform float radius;

in vec2 v_textureCoordinates;

void main()
{
    vec4 color0 = texture(colorTexture, v_textureCoordinates);
    vec4 color1 = texture(colorTexture2, v_textureCoordinates);

    float x = length(gl_FragCoord.xy - center) / radius;
    float t = smoothstep(0.5, 0.8, x);
    out_FragColor = mix(color0 + color1, color1, t);
}
`;var F8=`uniform sampler2D colorTexture;

uniform float avgLuminance;
uniform float threshold;
uniform float offset;

in vec2 v_textureCoordinates;

float key(float avg)
{
    float guess = 1.5 - (1.5 / (avg * 0.1 + 1.0));
    return max(0.0, guess) + 0.1;
}

// See section 9. "The bright-pass filter" of Realtime HDR Rendering
// http://www.cg.tuwien.ac.at/research/publications/2007/Luksch_2007_RHR/Luksch_2007_RHR-RealtimeHDR%20.pdf

void main()
{
    vec4 color = texture(colorTexture, v_textureCoordinates);
    vec3 xyz = czm_RGBToXYZ(color.rgb);
    float luminance = xyz.r;

    float scaledLum = key(avgLuminance) * luminance / avgLuminance;
    float brightLum = max(scaledLum - threshold, 0.0);
    float brightness = brightLum / (offset + brightLum);

    xyz.r = brightness;
    out_FragColor = vec4(czm_XYZToRGB(xyz), 1.0);
}
`;function A_(){this._sceneFramebuffer=new nS;let e=.125,t=new Array(6);t[0]=new xo({fragmentShader:Lu,textureScale:e,forcePowerOfTwo:!0,sampleMode:Kf.LINEAR});let n=t[1]=new xo({fragmentShader:F8,uniforms:{avgLuminance:.5,threshold:.25,offset:.1},textureScale:e,forcePowerOfTwo:!0}),i=this;this._delta=1,this._sigma=2,this._blurStep=new H,t[2]=new xo({fragmentShader:Sb,uniforms:{step:function(){return i._blurStep.x=i._blurStep.y=1/n.outputTexture.width,i._blurStep},delta:function(){return i._delta},sigma:function(){return i._sigma},direction:0},textureScale:e,forcePowerOfTwo:!0}),t[3]=new xo({fragmentShader:Sb,uniforms:{step:function(){return i._blurStep.x=i._blurStep.y=1/n.outputTexture.width,i._blurStep},delta:function(){return i._delta},sigma:function(){return i._sigma},direction:1},textureScale:e,forcePowerOfTwo:!0}),t[4]=new xo({fragmentShader:Lu,sampleMode:Kf.LINEAR}),this._uCenter=new H,this._uRadius=void 0,t[5]=new xo({fragmentShader:N8,uniforms:{center:function(){return i._uCenter},radius:function(){return i._uRadius},colorTexture2:function(){return i._sceneFramebuffer.framebuffer.getColorTexture(0)}}}),this._stages=new kl({stages:t});let o=new sS(this),r=t.length;for(let s=0;s<r;++s)t[s]._textureCache=o;this._textureCache=o,this.length=t.length}A_.prototype.get=function(e){return this._stages.get(e)};A_.prototype.getStageByName=function(e){let t=this._stages.length;for(let n=0;n<t;++n){let i=this._stages.get(n);if(i.name===e)return i}};var ixt=new oe,yAe=new H,oxt=new H,xAe=new F;function rxt(e,t,n){let i=t.uniformState,o=i.sunPositionWC,r=i.view,s=i.viewProjection,a=i.projection,c=F.computeViewportTransformation(n,0,1,xAe),l=F.multiplyByPoint(r,o,ixt),f=Lt.pointToGLWindowCoordinates(s,c,o,yAe);l.x+=R.SOLAR_RADIUS;let d=Lt.pointToGLWindowCoordinates(a,c,l,l),p=H.magnitude(H.subtract(d,f,d))*30*2,g=oxt;g.x=p,g.y=p,e._uCenter=H.clone(f,e._uCenter),e._uRadius=Math.max(g.x,g.y)*.15;let m=t.drawingBufferWidth,y=t.drawingBufferHeight,b=e._stages,C=b.get(0),A=C.outputTexture.width,T=C.outputTexture.height,E=new qe;E.width=A,E.height=T,c=F.computeViewportTransformation(E,0,1,xAe),f=Lt.pointToGLWindowCoordinates(s,c,o,yAe),g.x*=A/m,g.y*=T/y;let v=C.scissorRectangle;v.x=Math.max(f.x-g.x*.5,0),v.y=Math.max(f.y-g.y*.5,0),v.width=Math.min(g.x,m),v.height=Math.min(g.y,y);for(let D=1;D<4;++D)qe.clone(v,b.get(D).scissorRectangle)}A_.prototype.clear=function(e,t,n){this._sceneFramebuffer.clear(e,t,n),this._textureCache.clear(e)};A_.prototype.update=function(e){let t=e.context,n=e.viewport,i=this._sceneFramebuffer;i.update(t,n);let o=i.framebuffer;return this._textureCache.update(t),this._stages.update(t,!1),rxt(this,t,n),o};A_.prototype.execute=function(e){let t=this._sceneFramebuffer.framebuffer.getColorTexture(0),n=this._stages,i=n.length;n.get(0).execute(e,t);for(let o=1;o<i;++o)n.get(o).execute(e,n.get(o-1).outputTexture)};A_.prototype.copy=function(e,t){if(!u(this._copyColorCommand)){let n=this;this._copyColorCommand=e.createViewportQuadCommand(Lu,{uniformMap:{colorTexture:function(){return n._stages.get(n._stages.length-1).outputTexture}},owner:this})}this._copyColorCommand.framebuffer=t,this._copyColorCommand.execute(e)};A_.prototype.isDestroyed=function(){return!1};A_.prototype.destroy=function(){return this._textureCache.destroy(),this._stages.destroy(),ue(this)};var B8=A_;function bAe(){this._cachedShowFrustumsShaders={}}function sxt(e){let t={},n=e.vertexAttributes;for(let i in n)n.hasOwnProperty(i)&&(t[i]=n[i].index);return t}function axt(e,t){let n=e.context,i=t,o=i.fragmentShaderSource.clone(),r=[];o.sources=o.sources.map(function(f){f=ze.replaceMain(f,"czm_Debug_main");let d=/out_FragData_(\d+)/g,p;for(;(p=d.exec(f))!==null;)r.indexOf(p[1])===-1&&r.push(p[1]);return f});let s=r.length,a="";a+=`uniform vec3 debugShowCommandsColor;
`,a+=`uniform vec3 debugShowFrustumsColor;
`,a+=`void main() 
{ 
    czm_Debug_main(); 
`;let c;if(s>0)for(c=0;c<s;++c)a+=`    out_FragData_${r[c]}.rgb *= debugShowCommandsColor;
`,a+=`    out_FragData_${r[c]}.rgb *= debugShowFrustumsColor;
`;else a+=`    out_FragColor.rgb *= debugShowCommandsColor;
`,a+=`    out_FragColor.rgb *= debugShowFrustumsColor;
`;a+="}",o.sources.push(a);let l=sxt(i);return tn.fromCache({context:n,vertexShaderSource:i.vertexShaderSource,fragmentShaderSource:o,attributeLocations:l})}var fI=new G;function cxt(e,t){let n;return u(t.uniformMap)?n=t.uniformMap:n={},u(n.debugShowCommandsColor)||u(n.debugShowFrustumsColor)||(n.debugShowCommandsColor=function(){return e.debugShowCommands?(u(t._debugColor)||(t._debugColor=G.fromRandom()),t._debugColor):G.WHITE},n.debugShowFrustumsColor=function(){return e.debugShowFrustums?(fI.red=t.debugOverlappingFrustums&1?1:0,fI.green=t.debugOverlappingFrustums&2?1:0,fI.blue=t.debugOverlappingFrustums&4?1:0,fI.alpha=1,fI):G.WHITE}),n}var lxt=new Qe;bAe.prototype.executeDebugShowFrustumsCommand=function(e,t,n){let i=t.shaderProgram.id,o=this._cachedShowFrustumsShaders[i];u(o)||(o=axt(e,t.shaderProgram),this._cachedShowFrustumsShaders[i]=o);let r=Qe.shallowClone(t,lxt);r.shaderProgram=o,r.uniformMap=cxt(e,t),r.execute(e.context,n)};var k8=bAe;function Ob(e,t,n){this._primitive=e,this._tileIndex=t,this._sampleIndex=n,this._metadata={},this._orientedBoundingBox=new wn}Ob.fromKeyframeNode=function(e,t,n,i){let o=new Ob(e,t,n),{spatialNode:r,metadata:s}=i;return o._metadata=uxt(e,s,n),o._orientedBoundingBox=dxt(e,r,n,o._orientedBoundingBox),o};function uxt(e,t,n){if(!u(t))return;let{names:i,types:o}=e.provider,r={};for(let s=0;s<i.length;s++){let a=i[s],c=Et.getComponentCount(o[s]),l=t[s].slice(n*c,(n+1)*c);r[a]=l}return r}var CAe=new h,fxt=new h;function dxt(e,t,n,i){let o=t.dimensions,r=o.x*o.y,s=Math.floor(n/r),a=n-s*r,c=Math.floor(a/o.x),l=a-c*o.x,f=h.fromElements(l,c,s,CAe),d=h.divideComponents(h.subtract(f,e._paddingBefore,CAe),e.dimensions,fxt);return e._shape.computeOrientedBoundingBoxForSample(t,e.dimensions,d,i)}Object.defineProperties(Ob.prototype,{metadata:{get:function(){return this._metadata}},primitive:{get:function(){return this._primitive}},sampleIndex:{get:function(){return this._sampleIndex}},tileIndex:{get:function(){return this._tileIndex}},orientedBoundingBox:{get:function(){return this._orientedBoundingBox.clone()}}});Ob.prototype.hasProperty=function(e){return u(this._metadata[e])};Ob.prototype.getNames=function(){return Object.keys(this._metadata)};Ob.prototype.getProperty=function(e){return this._metadata[e]};var V8=Ob;var U8=`struct Ray {
    vec3 pos;
    vec3 dir;
    vec3 rawDir;
};

#if defined(JITTER)
/**
 * Generate a pseudo-random value for a given 2D screen coordinate.
 * Similar to https://www.shadertoy.com/view/4djSRW with a modified hashscale.
 */
float hash(vec2 p)
{
    vec3 p3 = fract(vec3(p.xyx) * 50.0);
    p3 += dot(p3, p3.yzx + 19.19);
    return fract((p3.x + p3.y) * p3.z);
}
#endif

float minComponent(in vec3 v) {
    return min(min(v.x, v.y), v.z);
}

float maxComponent(in vec3 v) {
    return max(max(v.x, v.y), v.z);
}

struct PointJacobianT {
    vec3 point;
    mat3 jacobianT;
};
`;var z8=`// See Intersection.glsl for the definition of intersectScene
// See IntersectionUtils.glsl for the definition of nextIntersection
// See convertUvToBox.glsl, convertUvToCylinder.glsl, or convertUvToEllipsoid.glsl
// for the definition of convertUvToShapeUvSpace. The appropriate function is 
// selected based on the VoxelPrimitive shape type, and added to the shader in
// Scene/VoxelRenderResources.js.
// See Octree.glsl for the definitions of TraversalData, SampleData,
// traverseOctreeFromBeginning, and traverseOctreeFromExisting
// See Megatexture.glsl for the definition of accumulatePropertiesFromMegatexture

#define STEP_COUNT_MAX 1000 // Harcoded value because GLSL doesn't like variable length loops
#if defined(PICKING_VOXEL)
    #define ALPHA_ACCUM_MAX 0.1
#else
    #define ALPHA_ACCUM_MAX 0.98 // Must be > 0.0 and <= 1.0
#endif

uniform mat3 u_transformDirectionViewToLocal;
uniform vec3 u_cameraPositionUv;
uniform float u_stepSize;

#if defined(PICKING)
    uniform vec4 u_pickColor;
#endif

vec3 getSampleSize(in int level) {
    vec3 sampleCount = exp2(float(level)) * vec3(u_dimensions);
    vec3 sampleSizeUv = 1.0 / sampleCount;
    return scaleShapeUvToShapeSpace(sampleSizeUv);
}

#define MINIMUM_STEP_SCALAR (0.02)
#define SHIFT_FRACTION (0.001)

/**
 * Given a coordinate within a tile, and sample spacings along a ray through
 * the coordinate, find the distance to the points where the ray entered and
 * exited the voxel cell, along with the surface normals at those points.
 * The surface normals are returned in shape space coordinates.
 */
RayShapeIntersection getVoxelIntersection(in vec3 tileUv, in vec3 sampleSizeAlongRay) {
    vec3 voxelCoord = tileUv * vec3(u_dimensions);
    vec3 directions = sign(sampleSizeAlongRay);
    vec3 positiveDirections = max(directions, 0.0);
    vec3 entryCoord = mix(ceil(voxelCoord), floor(voxelCoord), positiveDirections);
    vec3 exitCoord = entryCoord + directions;

    vec3 distanceFromEntry = -abs((entryCoord - voxelCoord) * sampleSizeAlongRay);
    float lastEntry = maxComponent(distanceFromEntry);
    bvec3 isLastEntry = equal(distanceFromEntry, vec3(lastEntry));
    vec3 entryNormal = -1.0 * vec3(isLastEntry) * directions;
    vec4 entry = vec4(entryNormal, lastEntry);

    vec3 distanceToExit = abs((exitCoord - voxelCoord) * sampleSizeAlongRay);
    float firstExit = minComponent(distanceToExit);
    bvec3 isFirstExit = equal(distanceToExit, vec3(firstExit));
    vec3 exitNormal = vec3(isFirstExit) * directions;
    vec4 exit = vec4(exitNormal, firstExit);

    return RayShapeIntersection(entry, exit);
}

vec4 getStepSize(in SampleData sampleData, in Ray viewRay, in RayShapeIntersection shapeIntersection, in mat3 jacobianT, in float currentT) {
    // The Jacobian is computed in a space where the shape spans [-1, 1].
    // But the ray is marched in a space where the shape fills [0, 1].
    // So we need to scale the Jacobian by 2.
    vec3 gradient = 2.0 * viewRay.rawDir * jacobianT;
    vec3 sampleSizeAlongRay = getSampleSize(sampleData.tileCoords.w) / gradient;

    RayShapeIntersection voxelIntersection = getVoxelIntersection(sampleData.tileUv, sampleSizeAlongRay);

    // Transform normal from shape space to Cartesian space
    vec3 voxelNormal = normalize(jacobianT * voxelIntersection.entry.xyz);
    // Compare with the shape intersection, to choose the appropriate normal
    vec4 voxelEntry = vec4(voxelNormal, currentT + voxelIntersection.entry.w);
    vec4 entry = intersectionMax(shapeIntersection.entry, voxelEntry);

    float fixedStep = minComponent(abs(sampleSizeAlongRay)) * u_stepSize;
    float shift = fixedStep * SHIFT_FRACTION;
    float dt = voxelIntersection.exit.w + shift;
    if ((currentT + dt) > shapeIntersection.exit.w) {
        // Stop at end of shape
        dt = shapeIntersection.exit.w - currentT + shift;
    }
    float stepSize = clamp(dt, fixedStep * MINIMUM_STEP_SCALAR, fixedStep + shift);

    return vec4(entry.xyz, stepSize);
}

vec2 packIntToVec2(int value) {
    float shifted = float(value) / 255.0;
    float lowBits = fract(shifted);
    float highBits = floor(shifted) / 255.0;
    return vec2(highBits, lowBits);
}

vec2 packFloatToVec2(float value) {
    float lowBits = fract(value);
    float highBits = floor(value) / 255.0;
    return vec2(highBits, lowBits);
}

int getSampleIndex(in vec3 tileUv) {
    ivec3 voxelDimensions = u_dimensions;
    vec3 sampleCoordinate = tileUv * vec3(voxelDimensions);
    // tileUv = 1.0 is a valid coordinate but sampleIndex = voxelDimensions is not.
    // (tileUv = 1.0 corresponds to the last sample, at index = voxelDimensions - 1).
    // Clamp to [0, voxelDimensions - 0.5) to avoid numerical error before flooring
    vec3 maxCoordinate = vec3(voxelDimensions) - vec3(0.5);
    sampleCoordinate = clamp(sampleCoordinate, vec3(0.0), maxCoordinate);
    ivec3 sampleIndex = ivec3(floor(sampleCoordinate));
    #if defined(PADDING)
        voxelDimensions += u_paddingBefore + u_paddingAfter;
        sampleIndex += u_paddingBefore;
    #endif
    // Convert to a 1D index for lookup in a 1D data array
    return sampleIndex.x + voxelDimensions.x * (sampleIndex.y + voxelDimensions.y * sampleIndex.z);
}

void main()
{
    vec4 fragCoord = gl_FragCoord;
    vec2 screenCoord = (fragCoord.xy - czm_viewport.xy) / czm_viewport.zw; // [0,1]
    vec3 eyeDirection = normalize(czm_windowToEyeCoordinates(fragCoord).xyz);
    vec3 viewDirWorld = normalize(czm_inverseViewRotation * eyeDirection); // normalize again just in case
    vec3 viewDirUv = normalize(u_transformDirectionViewToLocal * eyeDirection); // normalize again just in case
    vec3 viewPosUv = u_cameraPositionUv;
    #if defined(SHAPE_ELLIPSOID)
        // viewDirUv has been scaled to a space where the ellipsoid is a sphere.
        // Undo this scaling to get the raw direction.
        vec3 rawDir = viewDirUv * u_ellipsoidRadiiUv;
        Ray viewRayUv = Ray(viewPosUv, viewDirUv, rawDir);
    #else
        Ray viewRayUv = Ray(viewPosUv, viewDirUv, viewDirUv);
    #endif

    Intersections ix;
    RayShapeIntersection shapeIntersection = intersectScene(screenCoord, viewRayUv, ix);

    // Exit early if the scene was completely missed.
    if (shapeIntersection.entry.w == NO_HIT) {
        discard;
    }

    float currentT = shapeIntersection.entry.w;
    float endT = shapeIntersection.exit.w;
    vec3 positionUv = viewPosUv + currentT * viewDirUv;
    PointJacobianT pointJacobian = convertUvToShapeUvSpaceDerivative(positionUv);

    // Traverse the tree from the start position
    TraversalData traversalData;
    SampleData sampleDatas[SAMPLE_COUNT];
    traverseOctreeFromBeginning(pointJacobian.point, traversalData, sampleDatas);
    vec4 step = getStepSize(sampleDatas[0], viewRayUv, shapeIntersection, pointJacobian.jacobianT, currentT);

    #if defined(JITTER)
        float noise = hash(screenCoord); // [0,1]
        currentT += noise * step.w;
        positionUv += noise * step.w * viewDirUv;
    #endif

    FragmentInput fragmentInput;
    #if defined(STATISTICS)
        setStatistics(fragmentInput.metadata.statistics);
    #endif

    vec4 colorAccum = vec4(0.0);

    for (int stepCount = 0; stepCount < STEP_COUNT_MAX; ++stepCount) {
        // Read properties from the megatexture based on the traversal state
        Properties properties = accumulatePropertiesFromMegatexture(sampleDatas);

        // Prepare the custom shader inputs
        copyPropertiesToMetadata(properties, fragmentInput.metadata);
        fragmentInput.voxel.positionUv = positionUv;
        fragmentInput.voxel.positionShapeUv = pointJacobian.point;
        fragmentInput.voxel.positionUvLocal = sampleDatas[0].tileUv;
        fragmentInput.voxel.viewDirUv = viewDirUv;
        fragmentInput.voxel.viewDirWorld = viewDirWorld;
        fragmentInput.voxel.surfaceNormal = step.xyz;
        fragmentInput.voxel.travelDistance = step.w;
        fragmentInput.voxel.stepCount = stepCount;
        fragmentInput.voxel.tileIndex = sampleDatas[0].megatextureIndex;
        fragmentInput.voxel.sampleIndex = getSampleIndex(sampleDatas[0].tileUv);

        // Run the custom shader
        czm_modelMaterial materialOutput;
        fragmentMain(fragmentInput, materialOutput);

        // Sanitize the custom shader output
        vec4 color = vec4(materialOutput.diffuse, materialOutput.alpha);
        color.rgb = max(color.rgb, vec3(0.0));
        color.a = clamp(color.a, 0.0, 1.0);

        // Pre-multiplied alpha blend
        colorAccum += (1.0 - colorAccum.a) * vec4(color.rgb * color.a, color.a);

        // Stop traversing if the alpha has been fully saturated
        if (colorAccum.a > ALPHA_ACCUM_MAX) {
            colorAccum.a = ALPHA_ACCUM_MAX;
            break;
        }

        if (step.w == 0.0) {
            // Shape is infinitely thin. The ray may have hit the edge of a
            // foreground voxel. Step ahead slightly to check for more voxels
            step.w == 0.00001;
        }

        // Keep raymarching
        currentT += step.w;
        positionUv = viewPosUv + currentT * viewDirUv;

        // Check if there's more intersections.
        if (currentT > endT) {
            #if (INTERSECTION_COUNT == 1)
                break;
            #else
                shapeIntersection = nextIntersection(ix);
                if (shapeIntersection.entry.w == NO_HIT) {
                    break;
                } else {
                    // Found another intersection. Resume raymarching there
                    currentT = shapeIntersection.entry.w;
                    endT = shapeIntersection.exit.w;
                    positionUv = viewPosUv + currentT * viewDirUv;
                }
            #endif
        }

        // Traverse the tree from the current ray position.
        // This is similar to traverseOctreeFromBeginning but is faster when the ray is in the same tile as the previous step.
        pointJacobian = convertUvToShapeUvSpaceDerivative(positionUv);
        traverseOctreeFromExisting(pointJacobian.point, traversalData, sampleDatas);
        step = getStepSize(sampleDatas[0], viewRayUv, shapeIntersection, pointJacobian.jacobianT, currentT);
    }

    // Convert the alpha from [0,ALPHA_ACCUM_MAX] to [0,1]
    colorAccum.a /= ALPHA_ACCUM_MAX;

    #if defined(PICKING)
        // If alpha is 0.0 there is nothing to pick
        if (colorAccum.a == 0.0) {
            discard;
        }
        out_FragColor = u_pickColor;
    #elif defined(PICKING_VOXEL)
        // If alpha is 0.0 there is nothing to pick
        if (colorAccum.a == 0.0) {
            discard;
        }
        vec2 megatextureId = packIntToVec2(sampleDatas[0].megatextureIndex);
        vec2 sampleIndex = packIntToVec2(getSampleIndex(sampleDatas[0].tileUv));
        out_FragColor = vec4(megatextureId, sampleIndex);
    #else
        out_FragColor = colorAccum;
    #endif
}
`;var H8=`in vec2 position;

uniform vec4 u_ndcSpaceAxisAlignedBoundingBox;

void main() {
    vec2 aabbMin = u_ndcSpaceAxisAlignedBoundingBox.xy;
    vec2 aabbMax = u_ndcSpaceAxisAlignedBoundingBox.zw;
    vec2 translation = 0.5 * (aabbMax + aabbMin);
    vec2 scale = 0.5 * (aabbMax - aabbMin);
    gl_Position = vec4(position * scale + translation, 0.0, 1.0);
}
`;var G8=`/* Intersection defines
#define INTERSECTION_COUNT ###
*/

#define NO_HIT (-czm_infinity)
#define INF_HIT (czm_infinity * 0.5)

struct RayShapeIntersection {
    vec4 entry;
    vec4 exit;
};

vec4 intersectionMin(in vec4 intersect0, in vec4 intersect1)
{
    if (intersect0.w == NO_HIT) {
        return intersect1;
    } else if (intersect1.w == NO_HIT) {
        return intersect0;
    }
    return (intersect0.w <= intersect1.w) ? intersect0 : intersect1;
}

vec4 intersectionMax(in vec4 intersect0, in vec4 intersect1)
{
    return (intersect0.w >= intersect1.w) ? intersect0 : intersect1;
}

RayShapeIntersection intersectIntersections(in Ray ray, in RayShapeIntersection intersect0, in RayShapeIntersection intersect1)
{
    bool missed = (intersect0.entry.w == NO_HIT) ||
        (intersect1.entry.w == NO_HIT) ||
        (intersect0.exit.w < intersect1.entry.w) ||
        (intersect0.entry.w > intersect1.exit.w);
    if (missed) {
        vec4 miss = vec4(normalize(ray.dir), NO_HIT);
        return RayShapeIntersection(miss, miss);
    }

    vec4 entry = intersectionMax(intersect0.entry, intersect1.entry);
    vec4 exit = intersectionMin(intersect0.exit, intersect1.exit);

    return RayShapeIntersection(entry, exit);
}

struct Intersections {
    // Don't access these member variables directly - call the functions instead.

    // Store an array of ray-surface intersections. Each intersection is composed of:
    //  .xyz for the surface normal at the intersection point
    //  .w for the T value
    // The scale of the normal encodes the shape intersection type:
    //  length(intersection.xyz) = 1: positive shape entry
    //  length(intersection.xyz) = 2: positive shape exit
    //  length(intersection.xyz) = 3: negative shape entry
    //  length(intersection.xyz) = 4: negative shape exit
    // INTERSECTION_COUNT is the number of ray-*shape* (volume) intersections,
    // so we need twice as many to track ray-*surface* intersections
    vec4 intersections[INTERSECTION_COUNT * 2];

    #if (INTERSECTION_COUNT > 1)
        // Maintain state for future nextIntersection calls
        int index;
        int surroundCount;
        bool surroundIsPositive;
    #endif
};

RayShapeIntersection getFirstIntersection(in Intersections ix) 
{
    return RayShapeIntersection(ix.intersections[0], ix.intersections[1]);
}

vec4 encodeIntersectionType(vec4 intersection, int index, bool entry)
{
    float scale = float(index > 0) * 2.0 + float(!entry) + 1.0;
    return vec4(intersection.xyz * scale, intersection.w);
}

// Use defines instead of real functions because WebGL1 cannot access array with non-constant index.
#define setIntersection(/*inout Intersections*/ ix, /*int*/ index, /*float*/ t, /*bool*/ positive, /*bool*/ enter) (ix).intersections[(index)] = vec4(0.0, float(!positive) * 2.0 + float(!enter) + 1.0, 0.0, (t))
#define setIntersectionPair(/*inout Intersections*/ ix, /*int*/ index, /*vec2*/ entryExit) (ix).intersections[(index) * 2 + 0] = vec4(0.0, float((index) > 0) * 2.0 + 1.0, 0.0, (entryExit).x); (ix).intersections[(index) * 2 + 1] = vec4(0.0, float((index) > 0) * 2.0 + 2.0, 0.0, (entryExit).y)
#define setSurfaceIntersection(/*inout Intersections*/ ix, /*int*/ index, /*vec4*/ intersection, /*bool*/ positive, /*bool*/ enter) (ix).intersections[(index)] = encodeIntersectionType((intersection), int(!positive), (enter))
#define setShapeIntersection(/*inout Intersections*/ ix, /*int*/ index, /*RayShapeIntersection*/ intersection) (ix).intersections[(index) * 2 + 0] = encodeIntersectionType((intersection).entry, (index), true); (ix).intersections[(index) * 2 + 1] = encodeIntersectionType((intersection).exit, (index), false)

#if (INTERSECTION_COUNT > 1)
void initializeIntersections(inout Intersections ix) {
    // Sort the intersections from min T to max T with bubble sort.
    // Note: If this sorting function changes, some of the intersection test may
    // need to be updated. Search for "bubble sort" to find those areas.
    const int sortPasses = INTERSECTION_COUNT * 2 - 1;
    for (int n = sortPasses; n > 0; --n) {
        for (int i = 0; i < sortPasses; ++i) {
            // The loop should be: for (i = 0; i < n; ++i) {...} but WebGL1 cannot
            // loop with non-constant condition, so it has to break early instead
            if (i >= n) { break; }

            vec4 intersect0 = ix.intersections[i + 0];
            vec4 intersect1 = ix.intersections[i + 1];

            bool inOrder = intersect0.w <= intersect1.w;

            ix.intersections[i + 0] = inOrder ? intersect0 : intersect1;
            ix.intersections[i + 1] = inOrder ? intersect1 : intersect0;
        }
    }

    // Prepare initial state for nextIntersection
    ix.index = 0;
    ix.surroundCount = 0;
    ix.surroundIsPositive = false;
}
#endif

#if (INTERSECTION_COUNT > 1)
RayShapeIntersection nextIntersection(inout Intersections ix) {
    vec4 surfaceIntersection = vec4(0.0, 0.0, 0.0, NO_HIT);
    RayShapeIntersection shapeIntersection = RayShapeIntersection(surfaceIntersection, surfaceIntersection);

    const int passCount = INTERSECTION_COUNT * 2;

    if (ix.index == passCount) {
        return shapeIntersection;
    }

    for (int i = 0; i < passCount; ++i) {
        // The loop should be: for (i = ix.index; i < passCount; ++i) {...} but WebGL1 cannot
        // loop with non-constant condition, so it has to continue instead.
        if (i < ix.index) {
            continue;
        }

        ix.index = i + 1;

        surfaceIntersection = ix.intersections[i];
        int intersectionType = int(length(surfaceIntersection.xyz) - 0.5);
        bool currShapeIsPositive = intersectionType < 2;
        bool enter = intMod(intersectionType, 2) == 0;

        ix.surroundCount += enter ? +1 : -1;
        ix.surroundIsPositive = currShapeIsPositive ? enter : ix.surroundIsPositive;

        // entering positive or exiting negative
        if (ix.surroundCount == 1 && ix.surroundIsPositive && enter == currShapeIsPositive) {
            shapeIntersection.entry = surfaceIntersection;
        }

        // exiting positive or entering negative after being inside positive
        bool exitPositive = !enter && currShapeIsPositive && ix.surroundCount == 0;
        bool enterNegativeFromPositive = enter && !currShapeIsPositive && ix.surroundCount == 2 && ix.surroundIsPositive;
        if (exitPositive || enterNegativeFromPositive) {
            shapeIntersection.exit = surfaceIntersection;

            // entry and exit have been found, so the loop can stop
            if (exitPositive) {
                // After exiting positive shape there is nothing left to intersect, so jump to the end index.
                ix.index = passCount;
            }
            break;
        }
    }

    return shapeIntersection;
}
#endif

// NOTE: initializeIntersections, nextIntersection aren't even declared unless INTERSECTION_COUNT > 1
`;var W8=`// See IntersectionUtils.glsl for the definitions of Ray, Intersections,
// setIntersectionPair, INF_HIT, NO_HIT

/* intersectDepth defines (set in Scene/VoxelRenderResources.js)
#define DEPTH_INTERSECTION_INDEX ###
*/

uniform mat4 u_transformPositionViewToUv;

void intersectDepth(in vec2 screenCoord, in Ray ray, inout Intersections ix) {
    float logDepthOrDepth = czm_unpackDepth(texture(czm_globeDepthTexture, screenCoord));
    if (logDepthOrDepth != 0.0) {
        // Calculate how far the ray must travel before it hits the depth buffer.
        vec4 eyeCoordinateDepth = czm_screenToEyeCoordinates(screenCoord, logDepthOrDepth);
        eyeCoordinateDepth /= eyeCoordinateDepth.w;
        vec3 depthPositionUv = vec3(u_transformPositionViewToUv * eyeCoordinateDepth);
        float t = dot(depthPositionUv - ray.pos, ray.dir);
        setIntersectionPair(ix, DEPTH_INTERSECTION_INDEX, vec2(t, +INF_HIT));
    } else {
        // There's no depth at this location.
        setIntersectionPair(ix, DEPTH_INTERSECTION_INDEX, vec2(NO_HIT));
    }
}
`;var j8=`// See IntersectionUtils.glsl for the definitions of Ray, Intersections, INF_HIT,
// NO_HIT, setShapeIntersection

/* Clipping plane defines (set in Scene/VoxelRenderResources.js)
#define CLIPPING_PLANES_UNION
#define CLIPPING_PLANES_COUNT
#define CLIPPING_PLANES_INTERSECTION_INDEX
*/

uniform sampler2D u_clippingPlanesTexture;
uniform mat4 u_clippingPlanesMatrix;

// Plane is in Hessian Normal Form
vec4 intersectPlane(in Ray ray, in vec4 plane) {
    vec3 n = plane.xyz; // normal
    float w = plane.w; // -dot(pointOnPlane, normal)

    float a = dot(ray.pos, n);
    float b = dot(ray.dir, n);
    float t = -(w + a) / b;

    return vec4(n, t);
}

void intersectClippingPlanes(in Ray ray, inout Intersections ix) {
    vec4 backSide = vec4(-ray.dir, -INF_HIT);
    vec4 farSide = vec4(ray.dir, +INF_HIT);
    RayShapeIntersection clippingVolume;

    #if (CLIPPING_PLANES_COUNT == 1)
        // Union and intersection are the same when there's one clipping plane, and the code
        // is more simplified.
        vec4 planeUv = getClippingPlane(u_clippingPlanesTexture, 0, u_clippingPlanesMatrix);
        vec4 intersection = intersectPlane(ray, planeUv);
        bool reflects = dot(ray.dir, intersection.xyz) < 0.0;
        clippingVolume.entry = reflects ? backSide : intersection;
        clippingVolume.exit = reflects ? intersection : farSide;
        setShapeIntersection(ix, CLIPPING_PLANES_INTERSECTION_INDEX, clippingVolume);
    #elif defined(CLIPPING_PLANES_UNION)
        vec4 firstTransmission = vec4(ray.dir, +INF_HIT);
        vec4 lastReflection = vec4(-ray.dir, -INF_HIT);
        for (int i = 0; i < CLIPPING_PLANES_COUNT; i++) {
            vec4 planeUv = getClippingPlane(u_clippingPlanesTexture, i, u_clippingPlanesMatrix);
            vec4 intersection = intersectPlane(ray, planeUv);
            if (dot(ray.dir, planeUv.xyz) > 0.0) {
                firstTransmission = intersection.w <= firstTransmission.w ? intersection : firstTransmission;
            } else {
                lastReflection = intersection.w >= lastReflection.w ? intersection : lastReflection;
            }
        }
        clippingVolume.entry = backSide;
        clippingVolume.exit = lastReflection;
        setShapeIntersection(ix, CLIPPING_PLANES_INTERSECTION_INDEX + 0, clippingVolume);
        clippingVolume.entry = firstTransmission;
        clippingVolume.exit = farSide;
        setShapeIntersection(ix, CLIPPING_PLANES_INTERSECTION_INDEX + 1, clippingVolume);
    #else // intersection
        vec4 lastTransmission = vec4(ray.dir, -INF_HIT);
        vec4 firstReflection = vec4(-ray.dir, +INF_HIT);
        for (int i = 0; i < CLIPPING_PLANES_COUNT; i++) {
            vec4 planeUv = getClippingPlane(u_clippingPlanesTexture, i, u_clippingPlanesMatrix);
            vec4 intersection = intersectPlane(ray, planeUv);
            if (dot(ray.dir, planeUv.xyz) > 0.0) {
                lastTransmission = intersection.w > lastTransmission.w ? intersection : lastTransmission;
            } else {
                firstReflection = intersection.w < firstReflection.w ? intersection: firstReflection;
            }
        }
        if (lastTransmission.w < firstReflection.w) {
            clippingVolume.entry = lastTransmission;
            clippingVolume.exit = firstReflection;
        } else {
            clippingVolume.entry = vec4(-ray.dir, NO_HIT);
            clippingVolume.exit = vec4(ray.dir, NO_HIT);
        }
        setShapeIntersection(ix, CLIPPING_PLANES_INTERSECTION_INDEX, clippingVolume);
    #endif
}
`;var dI=`// See IntersectionUtils.glsl for the definitions of Ray, NO_HIT, INF_HIT,
// RayShapeIntersection

vec4 intersectLongitude(in Ray ray, in float angle, in bool positiveNormal) {
    float normalSign = positiveNormal ? 1.0 : -1.0;
    vec2 planeNormal = vec2(-sin(angle), cos(angle)) * normalSign;

    vec2 position = ray.pos.xy;
    vec2 direction = ray.dir.xy;
    float approachRate = dot(direction, planeNormal);
    float distance = -dot(position, planeNormal);

    float t = (approachRate == 0.0)
        ? NO_HIT
        : distance / approachRate;

    return vec4(planeNormal, 0.0, t);
}

RayShapeIntersection intersectHalfSpace(in Ray ray, in float angle, in bool positiveNormal)
{
    vec4 intersection = intersectLongitude(ray, angle, positiveNormal);
    vec4 farSide = vec4(normalize(ray.dir), INF_HIT);

    bool hitFront = (intersection.w > 0.0) == (dot(ray.pos.xy, intersection.xy) > 0.0);
    if (!hitFront) {
        return RayShapeIntersection(intersection, farSide);
    } else {
        return RayShapeIntersection(-1.0 * farSide, intersection);
    }
}

void intersectFlippedWedge(in Ray ray, in vec2 minMaxAngle, out RayShapeIntersection intersections[2])
{
    intersections[0] = intersectHalfSpace(ray, minMaxAngle.x, false);
    intersections[1] = intersectHalfSpace(ray, minMaxAngle.y, true);
}

bool hitPositiveHalfPlane(in Ray ray, in vec4 intersection, in bool positiveNormal) {
    float normalSign = positiveNormal ? 1.0 : -1.0;
    vec2 planeDirection = vec2(intersection.y, -intersection.x) * normalSign;
    vec2 hit = ray.pos.xy + intersection.w * ray.dir.xy;
    return dot(hit, planeDirection) > 0.0;
}

void intersectHalfPlane(in Ray ray, in float angle, out RayShapeIntersection intersections[2]) {
    vec4 intersection = intersectLongitude(ray, angle, true);
    vec4 farSide = vec4(normalize(ray.dir), INF_HIT);

    if (hitPositiveHalfPlane(ray, intersection, true)) {
        intersections[0].entry = -1.0 * farSide;
        intersections[0].exit = vec4(-1.0 * intersection.xy, 0.0, intersection.w);
        intersections[1].entry = intersection;
        intersections[1].exit = farSide;
    } else {
        vec4 miss = vec4(normalize(ray.dir), NO_HIT);
        intersections[0].entry = -1.0 * farSide;
        intersections[0].exit = farSide;
        intersections[1].entry = miss;
        intersections[1].exit = miss;
    }
}

RayShapeIntersection intersectRegularWedge(in Ray ray, in vec2 minMaxAngle)
{
    // Note: works for maxAngle > minAngle + pi, where the "regular wedge"
    // is actually a negative volume.
    // Compute intersections with the two planes.
    // Normals will point toward the "outside" (negative space)
    vec4 intersect1 = intersectLongitude(ray, minMaxAngle.x, false);
    vec4 intersect2 = intersectLongitude(ray, minMaxAngle.y, true);

    // Choose intersection with smallest T as the "first", the other as "last"
    // Note: first or last could be in the "shadow" wedge, beyond the tip
    bool inOrder = intersect1.w <= intersect2.w;
    vec4 first = inOrder ? intersect1 : intersect2;
    vec4 last = inOrder ? intersect2 : intersect1;

    bool firstIsAhead = first.w >= 0.0;
    bool startedInsideFirst = dot(ray.pos.xy, first.xy) < 0.0;
    bool exitFromInside = firstIsAhead == startedInsideFirst;
    bool lastIsAhead = last.w > 0.0;
    bool startedOutsideLast = dot(ray.pos.xy, last.xy) >= 0.0;
    bool enterFromOutside = lastIsAhead == startedOutsideLast;

    vec4 farSide = vec4(normalize(ray.dir), INF_HIT);
    vec4 miss = vec4(normalize(ray.dir), NO_HIT);

    if (exitFromInside && enterFromOutside) {
        // Ray crosses both faces of negative wedge, exiting then entering the positive shape
        return RayShapeIntersection(first, last);
    } else if (!exitFromInside && enterFromOutside) {
        // Ray starts inside wedge. last is in shadow wedge, and first is actually the entry
        return RayShapeIntersection(-1.0 * farSide, first);
    } else if (exitFromInside && !enterFromOutside) {
        // First intersection was in the shadow wedge, so last is actually the exit
        return RayShapeIntersection(last, farSide);
    } else { // !exitFromInside && !enterFromOutside
        // Both intersections were in the shadow wedge
        return RayShapeIntersection(miss, miss);
    }
}
`;var q8=`// See IntersectionUtils.glsl for the definitions of Ray, RayShapeIntersection,
// NO_HIT, Intersections

/* Box defines (set in Scene/VoxelBoxShape.js)
#define BOX_INTERSECTION_INDEX ### // always 0
*/

uniform vec3 u_renderMinBounds;
uniform vec3 u_renderMaxBounds;

RayShapeIntersection intersectBox(in Ray ray, in vec3 minBound, in vec3 maxBound)
{
    // Consider the box as the intersection of the space between 3 pairs of parallel planes
    // Compute the distance along the ray to each plane
    vec3 t0 = (minBound - ray.pos) / ray.dir;
    vec3 t1 = (maxBound - ray.pos) / ray.dir;

    // Identify candidate entries/exits based on distance from ray.pos
    vec3 entries = min(t0, t1);
    vec3 exits = max(t0, t1);

    vec3 directions = sign(ray.dir);

    // The actual intersection points are the furthest entry and the closest exit
    float lastEntry = maxComponent(entries);
    bvec3 isLastEntry = equal(entries, vec3(lastEntry));
    vec3 entryNormal = -1.0 * vec3(isLastEntry) * directions;
    vec4 entry = vec4(entryNormal, lastEntry);

    float firstExit = minComponent(exits);
    bvec3 isFirstExit = equal(exits, vec3(firstExit));
    vec3 exitNormal = vec3(isLastEntry) * directions;
    vec4 exit = vec4(exitNormal, firstExit);

    if (entry.w > exit.w) {
        entry.w = NO_HIT;
        exit.w = NO_HIT;
    }

    return RayShapeIntersection(entry, exit);
}

void intersectShape(in Ray ray, inout Intersections ix)
{
    RayShapeIntersection intersection = intersectBox(ray, u_renderMinBounds, u_renderMaxBounds);
    setShapeIntersection(ix, BOX_INTERSECTION_INDEX, intersection);
}
`;var Y8=`// See IntersectionUtils.glsl for the definitions of Ray, NO_HIT, Intersections,
// RayShapeIntersection, setSurfaceIntersection, setShapeIntersection,
// intersectIntersections
// See IntersectLongitude.glsl for the definitions of intersectHalfPlane,
// intersectFlippedWedge, intersectRegularWedge

/* Cylinder defines (set in Scene/VoxelCylinderShape.js)
#define CYLINDER_HAS_RENDER_BOUNDS_RADIUS_MIN
#define CYLINDER_HAS_RENDER_BOUNDS_RADIUS_FLAT
#define CYLINDER_HAS_RENDER_BOUNDS_ANGLE
#define CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_UNDER_HALF
#define CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_OVER_HALF
#define CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_EQUAL_ZERO

#define CYLINDER_INTERSECTION_INDEX_RADIUS_MAX
#define CYLINDER_INTERSECTION_INDEX_RADIUS_MIN
#define CYLINDER_INTERSECTION_INDEX_ANGLE
*/

// Cylinder uniforms
uniform vec2 u_cylinderRenderRadiusMinMax;
uniform vec2 u_cylinderRenderHeightMinMax;
#if defined(CYLINDER_HAS_RENDER_BOUNDS_ANGLE)
    uniform vec2 u_cylinderRenderAngleMinMax;
#endif

/**
 * Find the intersection of a ray with the volume defined by two planes of constant z
 */
RayShapeIntersection intersectHeightBounds(in Ray ray, in vec2 minMaxHeight, in bool convex)
{
    float zPosition = ray.pos.z;
    float zDirection = ray.dir.z;

    float tmin = (minMaxHeight.x - zPosition) / zDirection;
    float tmax = (minMaxHeight.y - zPosition) / zDirection;

    // Normals point outside the volume
    float signFlip = convex ? 1.0 : -1.0;
    vec4 intersectMin = vec4(0.0, 0.0, -1.0 * signFlip, tmin);
    vec4 intersectMax = vec4(0.0, 0.0, 1.0 * signFlip, tmax);

    bool topEntry = zDirection < 0.0;
    vec4 entry = topEntry ? intersectMax : intersectMin;
    vec4 exit = topEntry ? intersectMin : intersectMax;

    return RayShapeIntersection(entry, exit);
}

/**
 * Find the intersection of a ray with a right cylindrical surface of a given radius
 * about the z-axis.
 */
RayShapeIntersection intersectCylinder(in Ray ray, in float radius, in bool convex)
{
    vec2 position = ray.pos.xy;
    vec2 direction = ray.dir.xy;

    float a = dot(direction, direction);
    float b = dot(position, direction);
    float c = dot(position, position) - radius * radius;
    float determinant = b * b - a * c;

    if (determinant < 0.0) {
        vec4 miss = vec4(normalize(ray.dir), NO_HIT);
        return RayShapeIntersection(miss, miss);
    }

    determinant = sqrt(determinant);
    float t1 = (-b - determinant) / a;
    float t2 = (-b + determinant) / a;
    float signFlip = convex ? 1.0 : -1.0;
    vec4 intersect1 = vec4(normalize(position + t1 * direction) * signFlip, 0.0, t1);
    vec4 intersect2 = vec4(normalize(position + t2 * direction) * signFlip, 0.0, t2);

    return RayShapeIntersection(intersect1, intersect2);
}

/**
 * Find the intersection of a ray with a right cylindrical solid of given
 * radius and height bounds. NOTE: The shape is assumed to be convex.
 */
RayShapeIntersection intersectBoundedCylinder(in Ray ray, in float radius, in vec2 minMaxHeight)
{
    RayShapeIntersection cylinderIntersection = intersectCylinder(ray, radius, true);
    RayShapeIntersection heightBoundsIntersection = intersectHeightBounds(ray, minMaxHeight, true);
    return intersectIntersections(ray, cylinderIntersection, heightBoundsIntersection);
}

void intersectShape(Ray ray, inout Intersections ix)
{
    // Position is converted from [0,1] to [-1,+1] because shape intersections assume unit space is [-1,+1].
    // Direction is scaled as well to be in sync with position.
    ray.pos = ray.pos * 2.0 - 1.0;
    ray.dir *= 2.0;

    RayShapeIntersection outerIntersect = intersectBoundedCylinder(ray, u_cylinderRenderRadiusMinMax.y, u_cylinderRenderHeightMinMax);

    setShapeIntersection(ix, CYLINDER_INTERSECTION_INDEX_RADIUS_MAX, outerIntersect);

    if (outerIntersect.entry.w == NO_HIT) {
        return;
    }

    #if defined(CYLINDER_HAS_RENDER_BOUNDS_RADIUS_FLAT)
        // When the cylinder is perfectly thin it's necessary to sandwich the
        // inner cylinder intersection inside the outer cylinder intersection.

        // Without this special case,
        // [outerMin, outerMax, innerMin, innerMax] will bubble sort to
        // [outerMin, innerMin, outerMax, innerMax] which will cause the back
        // side of the cylinder to be invisible because it will think the ray
        // is still inside the inner (negative) cylinder after exiting the
        // outer (positive) cylinder.

        // With this special case,
        // [outerMin, innerMin, innerMax, outerMax] will bubble sort to
        // [outerMin, innerMin, innerMax, outerMax] which will work correctly.

        // Note: If initializeIntersections() changes its sorting function
        // from bubble sort to something else, this code may need to change.
        RayShapeIntersection innerIntersect = intersectCylinder(ray, 1.0, false);
        setSurfaceIntersection(ix, 0, outerIntersect.entry, true, true);  // positive, enter
        setSurfaceIntersection(ix, 1, innerIntersect.entry, false, true); // negative, enter
        setSurfaceIntersection(ix, 2, innerIntersect.exit, false, false); // negative, exit
        setSurfaceIntersection(ix, 3, outerIntersect.exit, true, false);  // positive, exit
    #elif defined(CYLINDER_HAS_RENDER_BOUNDS_RADIUS_MIN)
        RayShapeIntersection innerIntersect = intersectCylinder(ray, u_cylinderRenderRadiusMinMax.x, false);
        setShapeIntersection(ix, CYLINDER_INTERSECTION_INDEX_RADIUS_MIN, innerIntersect);
    #endif

    #if defined(CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_UNDER_HALF)
        RayShapeIntersection wedgeIntersect = intersectRegularWedge(ray, u_cylinderRenderAngleMinMax);
        setShapeIntersection(ix, CYLINDER_INTERSECTION_INDEX_ANGLE, wedgeIntersect);
    #elif defined(CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_OVER_HALF)
        RayShapeIntersection wedgeIntersects[2];
        intersectFlippedWedge(ray, u_cylinderRenderAngleMinMax, wedgeIntersects);
        setShapeIntersection(ix, CYLINDER_INTERSECTION_INDEX_ANGLE + 0, wedgeIntersects[0]);
        setShapeIntersection(ix, CYLINDER_INTERSECTION_INDEX_ANGLE + 1, wedgeIntersects[1]);
    #elif defined(CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_EQUAL_ZERO)
        RayShapeIntersection wedgeIntersects[2];
        intersectHalfPlane(ray, u_cylinderRenderAngleMinMax.x, wedgeIntersects);
        setShapeIntersection(ix, CYLINDER_INTERSECTION_INDEX_ANGLE + 0, wedgeIntersects[0]);
        setShapeIntersection(ix, CYLINDER_INTERSECTION_INDEX_ANGLE + 1, wedgeIntersects[1]);
    #endif
}
`;var X8=`// See IntersectionUtils.glsl for the definitions of Ray, NO_HIT, INF_HIT, Intersections,
// RayShapeIntersection, setSurfaceIntersection, setShapeIntersection
// See IntersectLongitude.glsl for the definitions of intersectHalfPlane,
// intersectFlippedWedge, intersectRegularWedge

/* Ellipsoid defines (set in Scene/VoxelEllipsoidShape.js)
#define ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE
#define ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_EQUAL_ZERO
#define ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_UNDER_HALF
#define ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_OVER_HALF
#define ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_UNDER_HALF
#define ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_EQUAL_HALF
#define ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_OVER_HALF
#define ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_UNDER_HALF
#define ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_EQUAL_HALF
#define ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_OVER_HALF
#define ELLIPSOID_INTERSECTION_INDEX_LONGITUDE
#define ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX
#define ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN
#define ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MAX
#define ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MIN
*/

#if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE)
    uniform vec2 u_ellipsoidRenderLongitudeMinMax;
#endif
uniform float u_eccentricitySquared;
uniform vec2 u_ellipsoidRenderLatitudeSinMinMax;
uniform vec2 u_clipMinMaxHeight;

RayShapeIntersection intersectZPlane(in Ray ray, in float z) {
    float t = -ray.pos.z / ray.dir.z;

    bool startsOutside = sign(ray.pos.z) == sign(z);
    bool entry = (t >= 0.0) != startsOutside;

    vec4 intersect = vec4(0.0, 0.0, z, t);
    vec4 farSide = vec4(normalize(ray.dir), INF_HIT);

    if (entry) {
        return RayShapeIntersection(intersect, farSide);
    } else {
        return RayShapeIntersection(-1.0 * farSide, intersect);
    }
}

RayShapeIntersection intersectHeight(in Ray ray, in float relativeHeight, in bool convex)
{
    // Scale the ray by the ellipsoid axes to make it a unit sphere
    // Note: approximating ellipsoid + height as an ellipsoid
    vec3 radiiCorrection = u_ellipsoidRadiiUv / (u_ellipsoidRadiiUv + relativeHeight);
    vec3 position = ray.pos * radiiCorrection;
    vec3 direction = ray.dir * radiiCorrection;

    float a = dot(direction, direction); // ~ 1.0 (or maybe 4.0 if ray is scaled)
    float b = dot(direction, position); // roughly inside [-1.0, 1.0] when zoomed in
    float c = dot(position, position) - 1.0; // ~ 0.0 when zoomed in.
    float determinant = b * b - a * c; // ~ b * b when zoomed in

    if (determinant < 0.0) {
        vec4 miss = vec4(normalize(direction), NO_HIT);
        return RayShapeIntersection(miss, miss);
    }

    determinant = sqrt(determinant);

    // Compute larger root using standard formula
    float signB = b < 0.0 ? -1.0 : 1.0;
    // The other root may suffer from subtractive cancellation in the standard formula.
    // Compute it from the first root instead.
    float t1 = (-b - signB * determinant) / a;
    float t2 = c / (a * t1);
    float tmin = min(t1, t2);
    float tmax = max(t1, t2);

    float directionScale = convex ? 1.0 : -1.0;
    vec3 d1 = directionScale * normalize(position + tmin * direction);
    vec3 d2 = directionScale * normalize(position + tmax * direction);

    return RayShapeIntersection(vec4(d1, tmin), vec4(d2, tmax));
}

/**
 * Given a circular cone around the z-axis, with apex at the origin,
 * find the parametric distance(s) along a ray where that ray intersects
 * the cone.
 * The cone opening angle is described by the squared cosine of
 * its half-angle (the angle between the Z-axis and the surface)
 */
vec2 intersectDoubleEndedCone(in Ray ray, in float cosSqrHalfAngle)
{
    vec3 o = ray.pos;
    vec3 d = ray.dir;
    float sinSqrHalfAngle = 1.0 - cosSqrHalfAngle;

    float aSin = d.z * d.z * sinSqrHalfAngle;
    float aCos = -dot(d.xy, d.xy) * cosSqrHalfAngle;
    float a = aSin + aCos;

    float bSin = d.z * o.z * sinSqrHalfAngle;
    float bCos = -dot(o.xy, d.xy) * cosSqrHalfAngle;
    float b = bSin + bCos;

    float cSin = o.z * o.z * sinSqrHalfAngle;
    float cCos = -dot(o.xy, o.xy) * cosSqrHalfAngle;
    float c = cSin + cCos;
    // determinant = b * b - a * c. But bSin * bSin = aSin * cSin.
    // Avoid subtractive cancellation by expanding to eliminate these terms
    float determinant = 2.0 * bSin * bCos + bCos * bCos - aSin * cCos - aCos * cSin - aCos * cCos;

    if (determinant < 0.0) {
        return vec2(NO_HIT);
    } else if (a == 0.0) {
        // Ray is parallel to cone surface
        return (b == 0.0)
            ? vec2(NO_HIT) // Ray is on cone surface
            : vec2(-0.5 * c / b, NO_HIT);
    }

    determinant = sqrt(determinant);

    // Compute larger root using standard formula
    float signB = b < 0.0 ? -1.0 : 1.0;
    float t1 = (-b - signB * determinant) / a;
    // The other root may suffer from subtractive cancellation in the standard formula.
    // Compute it from the first root instead.
    float t2 = c / (a * t1);
    float tmin = min(t1, t2);
    float tmax = max(t1, t2);
    return vec2(tmin, tmax);
}

/**
 * Given a point on a conical surface, find the surface normal at that point.
 */
vec3 getConeNormal(in vec3 p, in bool convex) {
    // Start with radial component pointing toward z-axis
    vec2 radial = -abs(p.z) * normalize(p.xy);
    // Z component points toward opening of cone
    float zSign = (p.z < 0.0) ? -1.0 : 1.0;
    float z = length(p.xy) * zSign;
    // Flip normal if shape is convex
    float flip = (convex) ? -1.0 : 1.0;
    return normalize(vec3(radial, z) * flip);
}

/**
 * Compute the shift between the ellipsoid origin and the apex of a cone of latitude
 */
float getLatitudeConeShift(in float sinLatitude) {
    // Find prime vertical radius of curvature: 
    // the distance along the ellipsoid normal to the intersection with the z-axis
    float x2 = u_eccentricitySquared * sinLatitude * sinLatitude;
    float primeVerticalRadius = inversesqrt(1.0 - x2);

    // Compute a shift from the origin to the intersection of the cone with the z-axis
    return primeVerticalRadius * u_eccentricitySquared * sinLatitude;
}

void intersectFlippedCone(in Ray ray, in float cosHalfAngle, out RayShapeIntersection intersections[2]) {
    // Undo the scaling from ellipsoid to sphere
    ray.pos = ray.pos * u_ellipsoidRadiiUv;
    ray.dir = ray.dir * u_ellipsoidRadiiUv;
    // Shift the ray to account for the latitude cone not being centered at the Earth center
    ray.pos.z += getLatitudeConeShift(cosHalfAngle);

    float cosSqrHalfAngle = cosHalfAngle * cosHalfAngle;
    vec2 intersect = intersectDoubleEndedCone(ray, cosSqrHalfAngle);

    vec4 miss = vec4(normalize(ray.dir), NO_HIT);
    vec4 farSide = vec4(normalize(ray.dir), INF_HIT);

    // Initialize output with no intersections
    intersections[0].entry = -1.0 * farSide;
    intersections[0].exit = farSide;
    intersections[1].entry = miss;
    intersections[1].exit = miss;

    if (intersect.x == NO_HIT) {
        return;
    }

    // Find the points of intersection
    float tmin = intersect.x;
    float tmax = intersect.y;
    vec3 p0 = ray.pos + tmin * ray.dir;
    vec3 p1 = ray.pos + tmax * ray.dir;

    vec4 intersect0 = vec4(getConeNormal(p0, true), tmin);
    vec4 intersect1 = vec4(getConeNormal(p1, true), tmax);

    bool p0InShadowCone = sign(p0.z) != sign(cosHalfAngle);
    bool p1InShadowCone = sign(p1.z) != sign(cosHalfAngle);

    if (p0InShadowCone && p1InShadowCone) {
        // no valid intersections
    } else if (p0InShadowCone) {
        intersections[0].exit = intersect1;
    } else if (p1InShadowCone) {
        intersections[0].entry = intersect0;
    } else {
        intersections[0].exit = intersect0;
        intersections[1].entry = intersect1;
        intersections[1].exit = farSide;
    }
}

RayShapeIntersection intersectRegularCone(in Ray ray, in float cosHalfAngle, in bool convex) {
    // Undo the scaling from ellipsoid to sphere
    ray.pos = ray.pos * u_ellipsoidRadiiUv;
    ray.dir = ray.dir * u_ellipsoidRadiiUv;
    // Shift the ray to account for the latitude cone not being centered at the Earth center
    ray.pos.z += getLatitudeConeShift(cosHalfAngle);

    float cosSqrHalfAngle = cosHalfAngle * cosHalfAngle;
    vec2 intersect = intersectDoubleEndedCone(ray, cosSqrHalfAngle);

    vec4 miss = vec4(normalize(ray.dir), NO_HIT);
    vec4 farSide = vec4(normalize(ray.dir), INF_HIT);

    if (intersect.x == NO_HIT) {
        return RayShapeIntersection(miss, miss);
    }

    // Find the points of intersection
    float tmin = intersect.x;
    float tmax = intersect.y;
    vec3 p0 = ray.pos + tmin * ray.dir;
    vec3 p1 = ray.pos + tmax * ray.dir;

    vec4 intersect0 = vec4(getConeNormal(p0, convex), tmin);
    vec4 intersect1 = vec4(getConeNormal(p1, convex), tmax);

    bool p0InShadowCone = sign(p0.z) != sign(cosHalfAngle);
    bool p1InShadowCone = sign(p1.z) != sign(cosHalfAngle);

    if (p0InShadowCone && p1InShadowCone) {
        return RayShapeIntersection(miss, miss);
    } else if (p0InShadowCone) {
        return RayShapeIntersection(intersect1, farSide);
    } else if (p1InShadowCone) {
        return RayShapeIntersection(-1.0 * farSide, intersect0);
    } else {
        return RayShapeIntersection(intersect0, intersect1);
    }
}

void intersectShape(in Ray ray, inout Intersections ix) {
    // Position is converted from [0,1] to [-1,+1] because shape intersections assume unit space is [-1,+1].
    // Direction is scaled as well to be in sync with position.
    ray.pos = ray.pos * 2.0 - 1.0;
    ray.dir *= 2.0;

    // Outer ellipsoid
    RayShapeIntersection outerIntersect = intersectHeight(ray, u_clipMinMaxHeight.y, true);
    setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MAX, outerIntersect);

    // Exit early if the outer ellipsoid was missed.
    if (outerIntersect.entry.w == NO_HIT) {
        return;
    }

    // Inner ellipsoid
    RayShapeIntersection innerIntersect = intersectHeight(ray, u_clipMinMaxHeight.x, false);

    if (innerIntersect.entry.w == NO_HIT) {
        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MIN, innerIntersect);
    } else {
        // When the ellipsoid is large and thin it's possible for floating point math
        // to cause the ray to intersect the inner ellipsoid before the outer ellipsoid. 
        // To prevent this from happening, clamp innerIntersect to outerIntersect and
        // sandwich the inner ellipsoid intersection inside the outer ellipsoid intersection.

        // Without this special case,
        // [outerMin, outerMax, innerMin, innerMax] will bubble sort to
        // [outerMin, innerMin, outerMax, innerMax] which will cause the back
        // side of the ellipsoid to be invisible because it will think the ray
        // is still inside the inner (negative) ellipsoid after exiting the
        // outer (positive) ellipsoid.

        // With this special case,
        // [outerMin, innerMin, innerMax, outerMax] will bubble sort to
        // [outerMin, innerMin, innerMax, outerMax] which will work correctly.

        // Note: If initializeIntersections() changes its sorting function
        // from bubble sort to something else, this code may need to change.
        innerIntersect.entry.w = max(innerIntersect.entry.w, outerIntersect.entry.w);
        innerIntersect.exit.w = min(innerIntersect.exit.w, outerIntersect.exit.w);
        setSurfaceIntersection(ix, 0, outerIntersect.entry, true, true);  // positive, enter
        setSurfaceIntersection(ix, 1, innerIntersect.entry, false, true); // negative, enter
        setSurfaceIntersection(ix, 2, innerIntersect.exit, false, false); // negative, exit
        setSurfaceIntersection(ix, 3, outerIntersect.exit, true, false);  // positive, exit
    }

    // Bottom cone
    #if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_UNDER_HALF)
        RayShapeIntersection bottomConeIntersection = intersectRegularCone(ray, u_ellipsoidRenderLatitudeSinMinMax.x, false);
        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN, bottomConeIntersection);
    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_EQUAL_HALF)
        RayShapeIntersection bottomConeIntersection = intersectZPlane(ray, -1.0);
        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN, bottomConeIntersection);
    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_OVER_HALF)
        RayShapeIntersection bottomConeIntersections[2];
        intersectFlippedCone(ray, u_ellipsoidRenderLatitudeSinMinMax.x, bottomConeIntersections);
        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN + 0, bottomConeIntersections[0]);
        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN + 1, bottomConeIntersections[1]);
    #endif

    // Top cone
    #if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_UNDER_HALF)
        RayShapeIntersection topConeIntersections[2];
        intersectFlippedCone(ray, u_ellipsoidRenderLatitudeSinMinMax.y, topConeIntersections);
        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX + 0, topConeIntersections[0]);
        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX + 1, topConeIntersections[1]);
    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_EQUAL_HALF)
        RayShapeIntersection topConeIntersection = intersectZPlane(ray, 1.0);
        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX, topConeIntersection);
    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_OVER_HALF)
        RayShapeIntersection topConeIntersection = intersectRegularCone(ray, u_ellipsoidRenderLatitudeSinMinMax.y, false);
        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX, topConeIntersection);
    #endif

    // Wedge
    #if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_EQUAL_ZERO)
        RayShapeIntersection wedgeIntersects[2];
        intersectHalfPlane(ray, u_ellipsoidRenderLongitudeMinMax.x, wedgeIntersects);
        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LONGITUDE + 0, wedgeIntersects[0]);
        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LONGITUDE + 1, wedgeIntersects[1]);
    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_UNDER_HALF)
        RayShapeIntersection wedgeIntersect = intersectRegularWedge(ray, u_ellipsoidRenderLongitudeMinMax);
        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LONGITUDE, wedgeIntersect);
    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_OVER_HALF)
        RayShapeIntersection wedgeIntersects[2];
        intersectFlippedWedge(ray, u_ellipsoidRenderLongitudeMinMax, wedgeIntersects);
        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LONGITUDE + 0, wedgeIntersects[0]);
        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LONGITUDE + 1, wedgeIntersects[1]);
    #endif
}
`;var uS=`// Main intersection function for Voxel scenes.
// See IntersectBox.glsl, IntersectCylinder.glsl, or IntersectEllipsoid.glsl
// for the definition of intersectShape. The appropriate function is selected
// based on the VoxelPrimitive shape type, and added to the shader in
// Scene/VoxelRenderResources.js.
// See also IntersectClippingPlane.glsl and IntersectDepth.glsl.
// See IntersectionUtils.glsl for the definitions of Ray, NO_HIT,
// getFirstIntersection, initializeIntersections, nextIntersection.

/* Intersection defines (set in Scene/VoxelRenderResources.js)
#define INTERSECTION_COUNT ###
*/

RayShapeIntersection intersectScene(in vec2 screenCoord, in Ray ray, out Intersections ix) {
    // Do a ray-shape intersection to find the exact starting and ending points.
    intersectShape(ray, ix);

    // Exit early if the positive shape was completely missed or behind the ray.
    RayShapeIntersection intersection = getFirstIntersection(ix);
    if (intersection.entry.w == NO_HIT) {
        // Positive shape was completely missed - so exit early.
        return intersection;
    }

    // Clipping planes
    #if defined(CLIPPING_PLANES)
        intersectClippingPlanes(ray, ix);
    #endif

    // Depth
    #if defined(DEPTH_TEST)
        intersectDepth(screenCoord, ray, ix);
    #endif

    // Find the first intersection that's in front of the ray
    #if (INTERSECTION_COUNT > 1)
        initializeIntersections(ix);
        for (int i = 0; i < INTERSECTION_COUNT; ++i) {
            intersection = nextIntersection(ix);
            if (intersection.exit.w > 0.0) {
                // Set start to 0.0 when ray is inside the shape.
                intersection.entry.w = max(intersection.entry.w, 0.0);
                break;
            }
        }
    #else
        // Set start to 0.0 when ray is inside the shape.
        intersection.entry.w = max(intersection.entry.w, 0.0);
    #endif

    return intersection;
}
`;var K8=`/* Box defines (set in Scene/VoxelBoxShape.js)
#define BOX_HAS_SHAPE_BOUNDS
*/

#if defined(BOX_HAS_SHAPE_BOUNDS)
    uniform vec3 u_boxUvToShapeUvScale;
    uniform vec3 u_boxUvToShapeUvTranslate;
#endif

PointJacobianT convertUvToShapeSpaceDerivative(in vec3 positionUv) {
    // For BOX, UV space = shape space, so we can use positionUv as-is,
    // and the Jacobian is the identity matrix, except that a step of 1
    // only spans half the shape space [-1, 1], so the identity is scaled.
    return PointJacobianT(positionUv, mat3(0.5));
}

vec3 convertShapeToShapeUvSpace(in vec3 positionShape) {
#if defined(BOX_HAS_SHAPE_BOUNDS)
    return positionShape * u_boxUvToShapeUvScale + u_boxUvToShapeUvTranslate;
#else
    return positionShape;
#endif
}

PointJacobianT convertUvToShapeUvSpaceDerivative(in vec3 positionUv) {
    PointJacobianT pointJacobian = convertUvToShapeSpaceDerivative(positionUv);
    pointJacobian.point = convertShapeToShapeUvSpace(pointJacobian.point);
    return pointJacobian;
}

vec3 convertShapeUvToUvSpace(in vec3 shapeUv) {
#if defined(BOX_HAS_SHAPE_BOUNDS)
    return (shapeUv - u_boxUvToShapeUvTranslate) / u_boxUvToShapeUvScale;
#else
    return shapeUv;
#endif
}

vec3 scaleShapeUvToShapeSpace(in vec3 shapeUv) {
#if defined(BOX_HAS_SHAPE_BOUNDS)
    return shapeUv / u_boxUvToShapeUvScale;
#else
    return shapeUv;
#endif
}`;var Z8=`/* Cylinder defines (set in Scene/VoxelCylinderShape.js)
#define CYLINDER_HAS_SHAPE_BOUNDS_RADIUS
#define CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT
#define CYLINDER_HAS_SHAPE_BOUNDS_ANGLE
#define CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_DISCONTINUITY
#define CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MAX_DISCONTINUITY
#define CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_MAX_REVERSED
*/

#if defined(CYLINDER_HAS_SHAPE_BOUNDS_RADIUS)
    uniform vec2 u_cylinderUvToShapeUvRadius; // x = scale, y = offset
#endif
#if defined(CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT)
    uniform vec2 u_cylinderUvToShapeUvHeight; // x = scale, y = offset
#endif
#if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE)
    uniform vec2 u_cylinderUvToShapeUvAngle; // x = scale, y = offset
#endif
#if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_DISCONTINUITY) || defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MAX_DISCONTINUITY)
    uniform vec2 u_cylinderShapeUvAngleMinMax;
#endif
#if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_DISCONTINUITY) || defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MAX_DISCONTINUITY) || defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_MAX_REVERSED)
    uniform float u_cylinderShapeUvAngleRangeZeroMid;
#endif

PointJacobianT convertUvToShapeSpaceDerivative(in vec3 positionUv) {
    // Convert from Cartesian UV space [0, 1] to Cartesian local space [-1, 1]
    vec3 position = positionUv * 2.0 - 1.0;

    float radius = length(position.xy); // [0, 1]
    vec3 radial = normalize(vec3(position.xy, 0.0));

    // Shape space height is defined within [0, 1]
    float height = positionUv.z; // [0, 1]
    vec3 z = vec3(0.0, 0.0, 1.0);

    float angle = atan(position.y, position.x);
    vec3 east = normalize(vec3(-position.y, position.x, 0.0));

    vec3 point = vec3(radius, height, angle);
    mat3 jacobianT = mat3(radial, z, east / length(position.xy));
    return PointJacobianT(point, jacobianT);
}

vec3 convertShapeToShapeUvSpace(in vec3 positionShape) {
    float radius = positionShape.x;
    #if defined(CYLINDER_HAS_SHAPE_BOUNDS_RADIUS)
        radius = radius * u_cylinderUvToShapeUvRadius.x + u_cylinderUvToShapeUvRadius.y;
    #endif

    float height = positionShape.y;
    #if defined(CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT)
        height = height * u_cylinderUvToShapeUvHeight.x + u_cylinderUvToShapeUvHeight.y;
    #endif

    float angle = (positionShape.z + czm_pi) / czm_twoPi;
    #if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE)
        #if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_MAX_REVERSED)
            // Comparing against u_cylinderShapeUvAngleMinMax has precision problems. u_cylinderShapeUvAngleRangeZeroMid is more conservative.
            angle += float(angle < u_cylinderShapeUvAngleRangeZeroMid);
        #endif

        // Avoid flickering from reading voxels from both sides of the -pi/+pi discontinuity.
        #if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_DISCONTINUITY)
            angle = angle > u_cylinderShapeUvAngleRangeZeroMid ? u_cylinderShapeUvAngleMinMax.x : angle;
        #elif defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MAX_DISCONTINUITY)
            angle = angle < u_cylinderShapeUvAngleRangeZeroMid ? u_cylinderShapeUvAngleMinMax.y : angle;
        #endif

        angle = angle * u_cylinderUvToShapeUvAngle.x + u_cylinderUvToShapeUvAngle.y;
    #endif

    return vec3(radius, height, angle);
}

PointJacobianT convertUvToShapeUvSpaceDerivative(in vec3 positionUv) {
    PointJacobianT pointJacobian = convertUvToShapeSpaceDerivative(positionUv);
    pointJacobian.point = convertShapeToShapeUvSpace(pointJacobian.point);
    return pointJacobian;
}

vec3 scaleShapeUvToShapeSpace(in vec3 shapeUv) {
    float radius = shapeUv.x;
    #if defined(CYLINDER_HAS_SHAPE_BOUNDS_RADIUS)
        radius /= u_cylinderUvToShapeUvRadius.x;
    #endif

    float height = shapeUv.y;
    #if defined(CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT)
        height /= u_cylinderUvToShapeUvHeight.x;
    #endif

    float angle = shapeUv.z * czm_twoPi;
    #if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE)
        angle /= u_cylinderUvToShapeUvAngle.x;
    #endif

    return vec3(radius, height, angle);
}
`;var $8=`/* Ellipsoid defines (set in Scene/VoxelEllipsoidShape.js)
#define ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MIN_DISCONTINUITY
#define ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MAX_DISCONTINUITY
#define ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE
#define ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE_MIN_MAX_REVERSED
#define ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE
*/

uniform vec3 u_ellipsoidRadiiUv; // [0,1]
uniform vec2 u_evoluteScale; // (radiiUv.x ^ 2 - radiiUv.z ^ 2) * vec2(1.0, -1.0) / radiiUv;
uniform vec3 u_ellipsoidInverseRadiiSquaredUv;
#if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MIN_DISCONTINUITY) || defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MAX_DISCONTINUITY) || defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE_MIN_MAX_REVERSED)
    uniform vec3 u_ellipsoidShapeUvLongitudeMinMaxMid;
#endif
#if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE)
    uniform vec2 u_ellipsoidUvToShapeUvLongitude; // x = scale, y = offset
#endif
#if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE)
    uniform vec2 u_ellipsoidUvToShapeUvLatitude; // x = scale, y = offset
#endif
uniform float u_ellipsoidInverseHeightDifferenceUv;

// robust iterative solution without trig functions
// https://github.com/0xfaded/ellipse_demo/issues/1
// https://stackoverflow.com/questions/22959698/distance-from-given-point-to-given-ellipse
// Extended to return radius of curvature along with the point
vec3 nearestPointAndRadiusOnEllipse(vec2 pos, vec2 radii) {
    vec2 p = abs(pos);
    vec2 inverseRadii = 1.0 / radii;

    // We describe the ellipse parametrically: v = radii * vec2(cos(t), sin(t))
    // but store the cos and sin of t in a vec2 for efficiency.
    // Initial guess: t = pi/4
    vec2 tTrigs = vec2(0.7071067811865476);
    // Initial guess of point on ellipsoid
    vec2 v = radii * tTrigs;
    // Center of curvature of the ellipse at v
    vec2 evolute = u_evoluteScale * tTrigs * tTrigs * tTrigs;

    const int iterations = 3;
    for (int i = 0; i < iterations; ++i) {
        // Find the (approximate) intersection of p - evolute with the ellipsoid.
        vec2 q = normalize(p - evolute) * length(v - evolute);
        // Update the estimate of t.
        tTrigs = (q + evolute) * inverseRadii;
        tTrigs = normalize(clamp(tTrigs, 0.0, 1.0));
        v = radii * tTrigs;
        evolute = u_evoluteScale * tTrigs * tTrigs * tTrigs;
    }

    return vec3(v * sign(pos), length(v - evolute));
}

PointJacobianT convertUvToShapeSpaceDerivative(in vec3 positionUv) {
    // Convert from UV space [0, 1] to local space [-1, 1]
    vec3 position = positionUv * 2.0 - 1.0;
    // Undo the scaling from ellipsoid to sphere
    position = position * u_ellipsoidRadiiUv;

    float longitude = atan(position.y, position.x);
    vec3 east = normalize(vec3(-position.y, position.x, 0.0));

    // Convert the 3D position to a 2D position relative to the ellipse (radii.x, radii.z)
    // (assume radii.y == radii.x) and find the nearest point on the ellipse and its normal
    float distanceFromZAxis = length(position.xy);
    vec2 posEllipse = vec2(distanceFromZAxis, position.z);
    vec3 surfacePointAndRadius = nearestPointAndRadiusOnEllipse(posEllipse, u_ellipsoidRadiiUv.xz);
    vec2 surfacePoint = surfacePointAndRadius.xy;

    vec2 normal2d = normalize(surfacePoint * u_ellipsoidInverseRadiiSquaredUv.xz);
    float latitude = atan(normal2d.y, normal2d.x);
    vec3 north = vec3(-normal2d.y * normalize(position.xy), abs(normal2d.x));

    float heightSign = length(posEllipse) < length(surfacePoint) ? -1.0 : 1.0;
    float height = heightSign * length(posEllipse - surfacePoint);
    vec3 up = normalize(cross(east, north));

    vec3 point = vec3(longitude, latitude, height);
    mat3 jacobianT = mat3(east / distanceFromZAxis, north / (surfacePointAndRadius.z + height), up);
    return PointJacobianT(point, jacobianT);
}

vec3 convertShapeToShapeUvSpace(in vec3 positionShape) {
    // Longitude: shift & scale to [0, 1]
    float longitude = (positionShape.x + czm_pi) / czm_twoPi;

    // Correct the angle when max < min
    // Technically this should compare against min longitude - but it has precision problems so compare against the middle of empty space.
    #if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE_MIN_MAX_REVERSED)
        longitude += float(longitude < u_ellipsoidShapeUvLongitudeMinMaxMid.z);
    #endif

    // Avoid flickering from reading voxels from both sides of the -pi/+pi discontinuity.
    #if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MIN_DISCONTINUITY)
        longitude = longitude > u_ellipsoidShapeUvLongitudeMinMaxMid.z ? u_ellipsoidShapeUvLongitudeMinMaxMid.x : longitude;
    #endif
    #if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MAX_DISCONTINUITY)
        longitude = longitude < u_ellipsoidShapeUvLongitudeMinMaxMid.z ? u_ellipsoidShapeUvLongitudeMinMaxMid.y : longitude;
    #endif

    #if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE)
        longitude = longitude * u_ellipsoidUvToShapeUvLongitude.x + u_ellipsoidUvToShapeUvLongitude.y;
    #endif

    // Latitude: shift and scale to [0, 1]
    float latitude = (positionShape.y + czm_piOverTwo) / czm_pi;
    #if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE)
        latitude = latitude * u_ellipsoidUvToShapeUvLatitude.x + u_ellipsoidUvToShapeUvLatitude.y;
    #endif

    // Height: scale to the range [0, 1]
    float height = 1.0 + positionShape.z * u_ellipsoidInverseHeightDifferenceUv;

    return vec3(longitude, latitude, height);
}

PointJacobianT convertUvToShapeUvSpaceDerivative(in vec3 positionUv) {
    PointJacobianT pointJacobian = convertUvToShapeSpaceDerivative(positionUv);
    pointJacobian.point = convertShapeToShapeUvSpace(pointJacobian.point);
    return pointJacobian;
}

vec3 scaleShapeUvToShapeSpace(in vec3 shapeUv) {
    // Convert from [0, 1] to radians [-pi, pi]
    float longitude = shapeUv.x * czm_twoPi;
    #if defined (ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE)
        longitude /= u_ellipsoidUvToShapeUvLongitude.x;
    #endif

    // Convert from [0, 1] to radians [-pi/2, pi/2]
    float latitude = shapeUv.y * czm_pi;
    #if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE)
        latitude /= u_ellipsoidUvToShapeUvLatitude.x;
    #endif
    
    float height = shapeUv.z / u_ellipsoidInverseHeightDifferenceUv;

    return vec3(longitude, latitude, height);
}
`;var Q8=`// These octree flags must be in sync with GpuOctreeFlag in VoxelTraversal.js
#define OCTREE_FLAG_INTERNAL 0
#define OCTREE_FLAG_LEAF 1
#define OCTREE_FLAG_PACKED_LEAF_FROM_PARENT 2

#define OCTREE_MAX_LEVELS 32 // Harcoded value because GLSL doesn't like variable length loops

uniform sampler2D u_octreeInternalNodeTexture;
uniform vec2 u_octreeInternalNodeTexelSizeUv;
uniform int u_octreeInternalNodeTilesPerRow;
#if (SAMPLE_COUNT > 1)
uniform sampler2D u_octreeLeafNodeTexture;
uniform vec2 u_octreeLeafNodeTexelSizeUv;
uniform int u_octreeLeafNodeTilesPerRow;
#endif

struct OctreeNodeData {
    int data;
    int flag;
};

struct TraversalData {
    ivec4 octreeCoords;
    int parentOctreeIndex;
};

struct SampleData {
    int megatextureIndex;
    ivec4 tileCoords;
    vec3 tileUv;
    #if (SAMPLE_COUNT > 1)
        float weight;
    #endif
};

// Integer mod: For WebGL1 only
int intMod(in int a, in int b) {
    return a - (b * (a / b));
}
int normU8_toInt(in float value) {
    return int(value * 255.0);
}
int normU8x2_toInt(in vec2 value) {
    return int(value.x * 255.0) + 256 * int(value.y * 255.0);
}
float normU8x2_toFloat(in vec2 value) {
    return float(normU8x2_toInt(value)) / 65535.0;
}

OctreeNodeData getOctreeNodeData(in vec2 octreeUv) {
    vec4 texData = texture(u_octreeInternalNodeTexture, octreeUv);

    OctreeNodeData data;
    data.data = normU8x2_toInt(texData.xy);
    data.flag = normU8x2_toInt(texData.zw);
    return data;
}

OctreeNodeData getOctreeChildData(in int parentOctreeIndex, in ivec3 childCoord) {
    int childIndex = childCoord.z * 4 + childCoord.y * 2 + childCoord.x;
    int octreeCoordX = intMod(parentOctreeIndex, u_octreeInternalNodeTilesPerRow) * 9 + 1 + childIndex;
    int octreeCoordY = parentOctreeIndex / u_octreeInternalNodeTilesPerRow;
    vec2 octreeUv = u_octreeInternalNodeTexelSizeUv * vec2(float(octreeCoordX) + 0.5, float(octreeCoordY) + 0.5);
    return getOctreeNodeData(octreeUv);
}

int getOctreeParentIndex(in int octreeIndex) {
    int octreeCoordX = intMod(octreeIndex, u_octreeInternalNodeTilesPerRow) * 9;
    int octreeCoordY = octreeIndex / u_octreeInternalNodeTilesPerRow;
    vec2 octreeUv = u_octreeInternalNodeTexelSizeUv * vec2(float(octreeCoordX) + 0.5, float(octreeCoordY) + 0.5);
    vec4 parentData = texture(u_octreeInternalNodeTexture, octreeUv);
    int parentOctreeIndex = normU8x2_toInt(parentData.xy);
    return parentOctreeIndex;
}

/**
* Convert a position in the uv-space of the tileset bounding shape
* into the uv-space of a tile within the tileset
*/
vec3 getTileUv(in vec3 shapePosition, in ivec4 octreeCoords) {
	// PERFORMANCE_IDEA: use bit-shifting (only in WebGL2)
    float dimAtLevel = exp2(float(octreeCoords.w));
    return shapePosition * dimAtLevel - vec3(octreeCoords.xyz);
}

vec3 getClampedTileUv(in vec3 shapePosition, in ivec4 octreeCoords) {
    vec3 tileUv = getTileUv(shapePosition, octreeCoords);
    return clamp(tileUv, vec3(0.0), vec3(1.0));
}

void getOctreeLeafSampleData(in OctreeNodeData data, in ivec4 octreeCoords, out SampleData sampleData) {
    sampleData.megatextureIndex = data.data;
    sampleData.tileCoords = (data.flag == OCTREE_FLAG_PACKED_LEAF_FROM_PARENT)
        ? ivec4(octreeCoords.xyz / 2, octreeCoords.w - 1)
        : octreeCoords;
}

#if (SAMPLE_COUNT > 1)
void getOctreeLeafSampleDatas(in OctreeNodeData data, in ivec4 octreeCoords, out SampleData sampleDatas[SAMPLE_COUNT]) {
    int leafIndex = data.data;
    int leafNodeTexelCount = 2;
    // Adding 0.5 moves to the center of the texel
    float leafCoordXStart = float(intMod(leafIndex, u_octreeLeafNodeTilesPerRow) * leafNodeTexelCount) + 0.5;
    float leafCoordY = float(leafIndex / u_octreeLeafNodeTilesPerRow) + 0.5;

    // Get an interpolation weight and a flag to determine whether to read the parent texture
    vec2 leafUv0 = u_octreeLeafNodeTexelSizeUv * vec2(leafCoordXStart + 0.0, leafCoordY);
    vec4 leafData0 = texture(u_octreeLeafNodeTexture, leafUv0);
    float lerp = normU8x2_toFloat(leafData0.xy);
    sampleDatas[0].weight = 1.0 - lerp;
    sampleDatas[1].weight = lerp;
    // TODO: this looks wrong? Should be comparing to OCTREE_FLAG_PACKED_LEAF_FROM_PARENT
    sampleDatas[0].tileCoords = (normU8_toInt(leafData0.z) == 1)
        ? ivec4(octreeCoords.xyz / 2, octreeCoords.w - 1)
        : octreeCoords;
    sampleDatas[1].tileCoords = (normU8_toInt(leafData0.w) == 1)
        ? ivec4(octreeCoords.xyz / 2, octreeCoords.w - 1)
        : octreeCoords;

    // Get megatexture indices for both samples
    vec2 leafUv1 = u_octreeLeafNodeTexelSizeUv * vec2(leafCoordXStart + 1.0, leafCoordY);
    vec4 leafData1 = texture(u_octreeLeafNodeTexture, leafUv1);
    sampleDatas[0].megatextureIndex = normU8x2_toInt(leafData1.xy);
    sampleDatas[1].megatextureIndex = normU8x2_toInt(leafData1.zw);
}
#endif

OctreeNodeData traverseOctreeDownwards(in vec3 shapePosition, inout TraversalData traversalData) {
    float sizeAtLevel = exp2(-1.0 * float(traversalData.octreeCoords.w));
    vec3 start = vec3(traversalData.octreeCoords.xyz) * sizeAtLevel;
    vec3 end = start + vec3(sizeAtLevel);
    OctreeNodeData childData;

    for (int i = 0; i < OCTREE_MAX_LEVELS; ++i) {
        // Find out which octree child contains the position
        // 0 if before center, 1 if after
        vec3 center = 0.5 * (start + end);
        vec3 childCoord = step(center, shapePosition);

        // Get octree coords for the next level down
        ivec4 octreeCoords = traversalData.octreeCoords;
        traversalData.octreeCoords = ivec4(octreeCoords.xyz * 2 + ivec3(childCoord), octreeCoords.w + 1);

        childData = getOctreeChildData(traversalData.parentOctreeIndex, ivec3(childCoord));

        if (childData.flag != OCTREE_FLAG_INTERNAL) {
            // leaf tile - stop traversing
            break;
        }

        // interior tile - keep going deeper
        start = mix(start, center, childCoord);
        end = mix(center, end, childCoord);
        traversalData.parentOctreeIndex = childData.data;
    }

    return childData;
}

/**
* Transform a given position to an octree tile coordinate and a position within that tile,
* and find the corresponding megatexture index and texture coordinates
*/
void traverseOctreeFromBeginning(in vec3 shapePosition, out TraversalData traversalData, out SampleData sampleDatas[SAMPLE_COUNT]) {
    traversalData.octreeCoords = ivec4(0);
    traversalData.parentOctreeIndex = 0;

    OctreeNodeData nodeData = getOctreeNodeData(vec2(0.0));
    if (nodeData.flag != OCTREE_FLAG_LEAF) {
        nodeData = traverseOctreeDownwards(shapePosition, traversalData);
    }

    #if (SAMPLE_COUNT == 1)
        getOctreeLeafSampleData(nodeData, traversalData.octreeCoords, sampleDatas[0]);
        sampleDatas[0].tileUv = getClampedTileUv(shapePosition, sampleDatas[0].tileCoords);
    #else
        getOctreeLeafSampleDatas(nodeData, traversalData.octreeCoords, sampleDatas);
        sampleDatas[0].tileUv = getClampedTileUv(shapePosition, sampleDatas[0].tileCoords);
        sampleDatas[1].tileUv = getClampedTileUv(shapePosition, sampleDatas[1].tileCoords);
    #endif
}

bool inRange(in vec3 v, in vec3 minVal, in vec3 maxVal) {
    return clamp(v, minVal, maxVal) == v;
}

bool insideTile(in vec3 shapePosition, in ivec4 octreeCoords) {
    vec3 tileUv = getTileUv(shapePosition, octreeCoords);
	bool inside = inRange(tileUv, vec3(0.0), vec3(1.0));
	// Assume (!) the position is always inside the root tile.
	return inside || octreeCoords.w == 0;
}

void traverseOctreeFromExisting(in vec3 shapePosition, inout TraversalData traversalData, inout SampleData sampleDatas[SAMPLE_COUNT]) {
    if (insideTile(shapePosition, traversalData.octreeCoords)) {
        for (int i = 0; i < SAMPLE_COUNT; i++) {
            sampleDatas[0].tileUv = getClampedTileUv(shapePosition, sampleDatas[0].tileCoords);
        }
        return;
    }

    // Go up tree until we find a parent tile containing shapePosition
    for (int i = 0; i < OCTREE_MAX_LEVELS; ++i) {
        traversalData.octreeCoords.xyz /= 2;
        traversalData.octreeCoords.w -= 1;

        if (insideTile(shapePosition, traversalData.octreeCoords)) {
            break;
        }

        traversalData.parentOctreeIndex = getOctreeParentIndex(traversalData.parentOctreeIndex);
    }

    // Go down tree
    OctreeNodeData nodeData = traverseOctreeDownwards(shapePosition, traversalData);

    #if (SAMPLE_COUNT == 1)
        getOctreeLeafSampleData(nodeData, traversalData.octreeCoords, sampleDatas[0]);
        sampleDatas[0].tileUv = getClampedTileUv(shapePosition, sampleDatas[0].tileCoords);
    #else
        getOctreeLeafSampleDatas(nodeData, traversalData.octreeCoords, sampleDatas);
        sampleDatas[0].tileUv = getClampedTileUv(shapePosition, sampleDatas[0].tileCoords);
        sampleDatas[1].tileUv = getClampedTileUv(shapePosition, sampleDatas[1].tileCoords);
    #endif
}
`;var J8=`// See Octree.glsl for the definitions of SampleData and intMod

/* Megatexture defines (set in Scene/VoxelRenderResources.js)
#define SAMPLE_COUNT ###
#define NEAREST_SAMPLING
#define PADDING
*/

uniform ivec2 u_megatextureSliceDimensions; // number of slices per tile, in two dimensions
uniform ivec2 u_megatextureTileDimensions; // number of tiles per megatexture, in two dimensions
uniform vec2 u_megatextureVoxelSizeUv;
uniform vec2 u_megatextureSliceSizeUv;
uniform vec2 u_megatextureTileSizeUv;

uniform ivec3 u_dimensions; // does not include padding
#if defined(PADDING)
    uniform ivec3 u_paddingBefore;
    uniform ivec3 u_paddingAfter;
#endif

// Integer min, max, clamp: For WebGL1 only
int intMin(int a, int b) {
    return a <= b ? a : b;
}
int intMax(int a, int b) {
    return a >= b ? a : b;
}
int intClamp(int v, int minVal, int maxVal) {
    return intMin(intMax(v, minVal), maxVal);
}

vec2 index1DTo2DTexcoord(int index, ivec2 dimensions, vec2 uvScale)
{
    int indexX = intMod(index, dimensions.x);
    int indexY = index / dimensions.x;
    return vec2(indexX, indexY) * uvScale;
}

/*
    How is 3D data stored in a 2D megatexture?

    In this example there is only one loaded tile and it has 2x2x2 voxels (8 voxels total).
    The data is sliced by Z. The data at Z = 0 is placed in texels (0,0), (0,1), (1,0), (1,1) and
    the data at Z = 1 is placed in texels (2,0), (2,1), (3,0), (3,1).
    Note that there could be empty space in the megatexture because it's a power of two.

      0   1   2   3
    +---+---+---+---+
    |   |   |   |   | 3
    +---+---+---+---+
    |   |   |   |   | 2
    +-------+-------+
    |010|110|011|111| 1
    |--- ---|--- ---|
    |000|100|001|101| 0
    +-------+-------+

    When doing linear interpolation the megatexture needs to be sampled twice: once for
    the Z slice above the voxel coordinate and once for the slice below. The two slices
    are interpolated with fract(coord.z - 0.5). For example, a Z coordinate of 1.0 is
    halfway between two Z slices so the interpolation factor is 0.5. Below is a side view
    of the 3D voxel grid with voxel coordinates on the left side.

    2 +---+
      |001|
    1 +-z-+
      |000|
    0 +---+

    When doing nearest neighbor the megatexture only needs to be sampled once at the closest Z slice.
*/

Properties getPropertiesFromMegatexture(in SampleData sampleData) {
    int tileIndex = sampleData.megatextureIndex;
    vec3 voxelCoord = sampleData.tileUv * vec3(u_dimensions);
    ivec3 voxelDimensions = u_dimensions;

    #if defined(PADDING)
        voxelDimensions += u_paddingBefore + u_paddingAfter;
        voxelCoord += vec3(u_paddingBefore);
    #endif

    #if defined(NEAREST_SAMPLING)
        // Round to the center of the nearest voxel
        voxelCoord = floor(voxelCoord) + vec3(0.5);
    #endif

    // Tile location
    vec2 tileUvOffset = index1DTo2DTexcoord(tileIndex, u_megatextureTileDimensions, u_megatextureTileSizeUv);

    // Slice location
    float slice = voxelCoord.z - 0.5;
    int sliceIndex = int(floor(slice));
    int sliceIndex0 = intClamp(sliceIndex, 0, voxelDimensions.z - 1);
    vec2 sliceUvOffset0 = index1DTo2DTexcoord(sliceIndex0, u_megatextureSliceDimensions, u_megatextureSliceSizeUv);

    // Voxel location
    vec2 voxelUvOffset = clamp(voxelCoord.xy, vec2(0.5), vec2(voxelDimensions.xy) - vec2(0.5)) * u_megatextureVoxelSizeUv;

    // Final location in the megatexture
    vec2 uv0 = tileUvOffset + sliceUvOffset0 + voxelUvOffset;

    #if defined(NEAREST_SAMPLING)
        return getPropertiesFromMegatextureAtUv(uv0);
    #else
        float sliceLerp = fract(slice);
        int sliceIndex1 = intMin(sliceIndex + 1, voxelDimensions.z - 1);
        vec2 sliceUvOffset1 = index1DTo2DTexcoord(sliceIndex1, u_megatextureSliceDimensions, u_megatextureSliceSizeUv);
        vec2 uv1 = tileUvOffset + sliceUvOffset1 + voxelUvOffset;
        Properties properties0 = getPropertiesFromMegatextureAtUv(uv0);
        Properties properties1 = getPropertiesFromMegatextureAtUv(uv1);
        return mixProperties(properties0, properties1, sliceLerp);
    #endif
}

// Convert an array of sample datas to a final weighted properties.
Properties accumulatePropertiesFromMegatexture(in SampleData sampleDatas[SAMPLE_COUNT]) {
    #if (SAMPLE_COUNT == 1)
        return getPropertiesFromMegatexture(sampleDatas[0]);
    #else
        // When more than one sample is taken the accumulator needs to start at 0
        Properties properties = clearProperties();
        for (int i = 0; i < SAMPLE_COUNT; ++i) {
            float weight = sampleDatas[i].weight;

            // Avoid reading the megatexture when the weight is 0 as it can be costly.
            if (weight > 0.0) {
                Properties tempProperties = getPropertiesFromMegatexture(sampleDatas[i]);
                tempProperties = scaleProperties(tempProperties, weight);
                properties = sumProperties(properties, tempProperties);
            }
        }
        return properties;
    #endif
}
`;function hxt(e){let t=new wC;this.shaderBuilder=t;let n=e._customShader,i=bt(e._uniformMap,n.uniformMap);e._uniformMap=i;let o=n.uniforms;for(let p in o)if(o.hasOwnProperty(p)){let g=o[p];t.addUniform(g.type,p,_e.FRAGMENT)}t.addUniform("sampler2D","u_megatextureTextures[METADATA_COUNT]",_e.FRAGMENT),this.uniformMap=i;let r=e._clippingPlanes,s=u(r)&&r.enabled?r.length:0;this.clippingPlanes=r,this.clippingPlanesLength=s,t.addVertexLines([H8]),t.addFragmentLines([n.fragmentShaderText,"#line 0",Q8,U8,G8,J8]),s>0&&(t.addDefine("CLIPPING_PLANES",void 0,_e.FRAGMENT),t.addDefine("CLIPPING_PLANES_COUNT",s,_e.FRAGMENT),r.unionClippingRegions&&t.addDefine("CLIPPING_PLANES_UNION",void 0,_e.FRAGMENT),t.addFragmentLines([j8])),e._depthTest&&(t.addDefine("DEPTH_TEST",void 0,_e.FRAGMENT),t.addFragmentLines([W8]));let a=e._provider.shape;a==="BOX"?t.addFragmentLines([K8,q8,uS]):a==="CYLINDER"?t.addFragmentLines([Z8,dI,Y8,uS]):a==="ELLIPSOID"&&(t.addDefine("SHAPE_ELLIPSOID",void 0,_e.FRAGMENT),t.addFragmentLines([$8,dI,X8,uS])),t.addFragmentLines([z8]);let c=e._shape,l=c.shaderDefines;for(let p in l)if(l.hasOwnProperty(p)){let g=l[p];u(g)&&(g=g===!0?void 0:g,t.addDefine(p,g,_e.FRAGMENT))}let f=c.shaderMaximumIntersectionsLength;s>0&&(t.addDefine("CLIPPING_PLANES_INTERSECTION_INDEX",f,_e.FRAGMENT),s===1?f+=1:r.unionClippingRegions?f+=2:f+=1),e._depthTest&&(t.addDefine("DEPTH_INTERSECTION_INDEX",f,_e.FRAGMENT),f+=1),t.addDefine("INTERSECTION_COUNT",f,_e.FRAGMENT),(!h.equals(e.paddingBefore,h.ZERO)||!h.equals(e.paddingAfter,h.ZERO))&&t.addDefine("PADDING",void 0,_e.FRAGMENT),e._useLogDepth&&t.addDefine("LOG_DEPTH_READ_ONLY",void 0,_e.FRAGMENT),e._nearestSampling&&t.addDefine("NEAREST_SAMPLING",void 0,_e.FRAGMENT);let d=e._traversal;t.addDefine("SAMPLE_COUNT",`${d._sampleCount}`,_e.FRAGMENT)}var e5=hxt;function mxt(e,t){let{shaderBuilder:n}=e,{names:i,types:o,componentTypes:r,minimumValues:s,maximumValues:a}=t._provider,c=o.length,l=u(s)&&u(a);n.addDefine("METADATA_COUNT",c,_e.FRAGMENT),l&&n.addDefine("STATISTICS",void 0,_e.FRAGMENT);for(let P=0;P<c;P++){let M=i[P],L=o[P],_=`PropertyStatistics_${M}`,S=`PropertyStatistics_${M}`;n.addStruct(_,S,_e.FRAGMENT);let w=t5(L);n.addStructField(_,w,"min"),n.addStructField(_,w,"max")}let f="Statistics",d="Statistics",p="statistics";n.addStruct(f,d,_e.FRAGMENT);for(let P=0;P<c;P++){let M=i[P],L=`PropertyStatistics_${M}`,_=M;n.addStructField(f,L,_)}let g="Metadata",m="Metadata",y="metadata";n.addStruct(g,m,_e.FRAGMENT),n.addStructField(g,d,p);for(let P=0;P<c;P++){let M=i[P],L=o[P],_=t5(L);n.addStructField(g,_,M)}for(let P=0;P<c;P++){let M=i[P],L=o[P],_=_xt(L),S=`VoxelProperty_${M}`,w=`VoxelProperty_${M}`;n.addStruct(S,w,_e.FRAGMENT),n.addStructField(S,_,"partialDerivativeLocal"),n.addStructField(S,_,"partialDerivativeWorld"),n.addStructField(S,_,"partialDerivativeView"),n.addStructField(S,_,"partialDerivativeValid")}let b="Voxel",C="Voxel",A="voxel";n.addStruct(b,C,_e.FRAGMENT);for(let P=0;P<c;P++){let M=i[P],L=`VoxelProperty_${M}`;n.addStructField(b,L,M)}n.addStructField(b,"vec3","positionEC"),n.addStructField(b,"vec3","positionUv"),n.addStructField(b,"vec3","positionShapeUv"),n.addStructField(b,"vec3","positionUvLocal"),n.addStructField(b,"vec3","viewDirUv"),n.addStructField(b,"vec3","viewDirWorld"),n.addStructField(b,"vec3","surfaceNormal"),n.addStructField(b,"float","travelDistance"),n.addStructField(b,"int","stepCount"),n.addStructField(b,"int","tileIndex"),n.addStructField(b,"int","sampleIndex");let T="FragmentInput";n.addStruct(T,"FragmentInput",_e.FRAGMENT),n.addStructField(T,m,y),n.addStructField(T,C,A);let v="Properties",D="Properties",O="properties";n.addStruct(v,D,_e.FRAGMENT);for(let P=0;P<c;P++){let M=i[P],L=o[P],_=t5(L);n.addStructField(v,_,M)}{let P="clearProperties";n.addFunction(P,`${D} clearProperties()`,_e.FRAGMENT),n.addFunctionLines(P,[`${D} ${O};`]);for(let M=0;M<c;M++){let L=i[M],_=o[M],S=r[M],w=t5(_,S);n.addFunctionLines(P,[`${O}.${L} = ${w}(0.0);`])}n.addFunctionLines(P,[`return ${O};`])}{let P="sumProperties";n.addFunction(P,`${D} sumProperties(${D} propertiesA, ${D} propertiesB)`,_e.FRAGMENT),n.addFunctionLines(P,[`${D} ${O};`]);for(let M=0;M<c;M++){let L=i[M];n.addFunctionLines(P,[`${O}.${L} = propertiesA.${L} + propertiesB.${L};`])}n.addFunctionLines(P,[`return ${O};`])}{let P="scaleProperties";n.addFunction(P,`${D} scaleProperties(${D} ${O}, float scale)`,_e.FRAGMENT),n.addFunctionLines(P,[`${D} scaledProperties = ${O};`]);for(let M=0;M<c;M++){let L=i[M];n.addFunctionLines(P,[`scaledProperties.${L} *= scale;`])}n.addFunctionLines(P,["return scaledProperties;"])}{let P="mixProperties";n.addFunction(P,`${D} mixProperties(${D} propertiesA, ${D} propertiesB, float mixFactor)`,_e.FRAGMENT),n.addFunctionLines(P,[`${D} ${O};`]);for(let M=0;M<c;M++){let L=i[M];n.addFunctionLines(P,[`${O}.${L} = mix(propertiesA.${L}, propertiesB.${L}, mixFactor);`])}n.addFunctionLines(P,[`return ${O};`])}{let P="copyPropertiesToMetadata";n.addFunction(P,`void copyPropertiesToMetadata(in ${D} ${O}, inout ${m} ${y})`,_e.FRAGMENT);for(let M=0;M<c;M++){let L=i[M];n.addFunctionLines(P,[`${y}.${L} = ${O}.${L};`])}}if(l){let P="setStatistics";n.addFunction(P,`void setStatistics(inout ${d} ${p})`,_e.FRAGMENT);for(let M=0;M<c;M++){let L=i[M],_=o[M],S=Et.getComponentCount(_);for(let w=0;w<S;w++){let I=gxt(_,w),N=s[M][w],k=a[M][w];n.addFunctionLines(P,[`${p}.${L}.min${I} = ${AAe(N)};`,`${p}.${L}.max${I} = ${AAe(k)};`])}}}{let P="getPropertiesFromMegatextureAtUv";n.addFunction(P,`${D} getPropertiesFromMegatextureAtUv(vec2 texcoord)`,_e.FRAGMENT),n.addFunctionLines(P,[`${D} ${O};`]);for(let M=0;M<c;M++){let L=i[M],_=o[M],S=r[M],w=pxt(_,S);n.addFunctionLines(P,[`properties.${L} = texture(u_megatextureTextures[${M}], texcoord)${w};`])}n.addFunctionLines(P,[`return ${O};`])}}function t5(e){if(e===Et.SCALAR)return"float";if(e===Et.VEC2)return"vec2";if(e===Et.VEC3)return"vec3";if(e===Et.VEC4)return"vec4"}function pxt(e){if(e===Et.SCALAR)return".r";if(e===Et.VEC2)return".ra";if(e===Et.VEC3)return".rgb";if(e===Et.VEC4)return""}function _xt(e){if(e===Et.SCALAR)return"vec3";if(e===Et.VEC2)return"mat2";if(e===Et.VEC3)return"mat3";if(e===Et.VEC4)return"mat4"}function AAe(e){let t=e.toString();return t.indexOf(".")===-1&&(t=`${e}.0`),t}function gxt(e,t){return e===Et.SCALAR?"":`[${t}]`}var n5=mxt;function yxt(e,t){let n=new e5(e);n5(n,e);let{shaderBuilder:i,clippingPlanes:o,clippingPlanesLength:r}=n;if(r>0){let C="getClippingPlane",A=Q0(o,t),T=0,E=A.indexOf(")")+1,v=A.indexOf("{",E)+1,D=A.indexOf("}",v),O=A.slice(T,E),P=A.slice(v,D);i.addFunction(C,O,_e.FRAGMENT),i.addFunctionLines(C,[P])}let s=i.clone();s.addDefine("PICKING",void 0,_e.FRAGMENT);let a=i.clone();a.addDefine("PICKING_VOXEL",void 0,_e.FRAGMENT);let c=i.buildShaderProgram(t),l=s.buildShaderProgram(t),f=a.buildShaderProgram(t),d=Ue.fromCache({cull:{enabled:!0,face:Ci.BACK},depthTest:{enabled:!1},depthMask:!1,blending:un.PRE_MULTIPLIED_ALPHA_BLEND}),p=t.getViewportQuadVertexArray(),g=e._depthTest,m=new Qe({vertexArray:p,primitiveType:Ne.TRIANGLES,renderState:d,shaderProgram:c,uniformMap:n.uniformMap,modelMatrix:e._compoundModelMatrix,pass:we.VOXELS,executeInClosestFrustum:!0,owner:this,cull:g,occlude:g}),y=Qe.shallowClone(m,new Qe);y.shaderProgram=l,y.pickOnly=!0;let b=Qe.shallowClone(m,new Qe);if(b.shaderProgram=f,b.pickOnly=!0,u(e._drawCommand)){let C=e._drawCommand;C.shaderProgram=C.shaderProgram&&C.shaderProgram.destroy()}if(u(e._drawCommandPick)){let C=e._drawCommandPick;C.shaderProgram=C.shaderProgram&&C.shaderProgram.destroy()}if(u(e._drawCommandPickVoxel)){let C=e._drawCommandPickVoxel;C.shaderProgram=C.shaderProgram&&C.shaderProgram.destroy()}e._drawCommand=m,e._drawCommandPick=y,e._drawCommandPickVoxel=b}var i5=yxt;function Vl(){this.orientedBoundingBox=new wn,this.boundingSphere=new ae,this.boundTransform=new F,this.shapeTransform=new F,this._minBounds=h.clone(Vl.DefaultMinBounds,new h),this._maxBounds=h.clone(Vl.DefaultMaxBounds,new h),this.shaderUniforms={renderMinBounds:new h,renderMaxBounds:new h,boxUvToShapeUvScale:new h,boxUvToShapeUvTranslate:new h},this.shaderDefines={BOX_INTERSECTION_INDEX:void 0,BOX_HAS_SHAPE_BOUNDS:void 0},this.shaderMaximumIntersectionsLength=0}var xxt=new h,_Z=new h,bxt=new J,Cxt=new h,Axt=new h,Txt=new h,Ext=new h,TAe=F.fromRotationTranslation(J.fromUniformScale(.5,new J),new h(.5,.5,.5),new F);Vl.prototype.update=function(e,t,n,i,o){i=x(i,Vl.DefaultMinBounds),o=x(o,Vl.DefaultMaxBounds);let r=Vl.DefaultMinBounds,s=Vl.DefaultMaxBounds;t=this._minBounds=h.clamp(t,r,s,this._minBounds),n=this._maxBounds=h.clamp(n,r,s,this._maxBounds),i=h.clamp(i,r,s,Cxt),o=h.clamp(o,r,s,Axt);let a=h.clamp(t,i,o,Txt),c=h.clamp(n,i,o,Ext),l=F.getScale(e,_Z);if(a.x>c.x||a.y>c.y||a.z>c.z||(a.x===c.x)+(a.y===c.y)+(a.z===c.z)>=2||i.x>o.x||i.y>o.y||i.z>o.z||l.x===0||l.y===0||l.z===0)return!1;this.shapeTransform=F.clone(e,this.shapeTransform),this.orientedBoundingBox=yZ(a,c,this.shapeTransform,this.orientedBoundingBox),this.boundTransform=F.fromRotationTranslation(this.orientedBoundingBox.halfAxes,this.orientedBoundingBox.center,this.boundTransform),this.boundingSphere=ae.fromOrientedBoundingBox(this.orientedBoundingBox,this.boundingSphere);let{shaderUniforms:f,shaderDefines:d}=this;for(let m in d)d.hasOwnProperty(m)&&(d[m]=void 0);let p=!h.equals(t,r)||!h.equals(n,s),g=0;if(d.BOX_INTERSECTION_INDEX=g,g+=1,f.renderMinBounds=F.multiplyByPoint(TAe,a,f.renderMinBounds),f.renderMaxBounds=F.multiplyByPoint(TAe,c,f.renderMaxBounds),p){d.BOX_HAS_SHAPE_BOUNDS=!0;let m=t,y=n;f.boxUvToShapeUvScale=h.fromElements(2/(m.x===y.x?1:y.x-m.x),2/(m.y===y.y?1:y.y-m.y),2/(m.z===y.z?1:y.z-m.z),f.boxUvToShapeUvScale),f.boxUvToShapeUvTranslate=h.fromElements(-f.boxUvToShapeUvScale.x*(m.x*.5+.5),-f.boxUvToShapeUvScale.y*(m.y*.5+.5),-f.boxUvToShapeUvScale.z*(m.z*.5+.5),f.boxUvToShapeUvTranslate)}return this.shaderMaximumIntersectionsLength=g,!0};var o5=new h,gZ=new h;Vl.prototype.computeOrientedBoundingBoxForTile=function(e,t,n,i,o){let r=this._minBounds,s=this._maxBounds,a=1/Math.pow(2,e),c=h.fromElements(R.lerp(r.x,s.x,a*t),R.lerp(r.y,s.y,a*n),R.lerp(r.z,s.z,a*i),o5),l=h.fromElements(R.lerp(r.x,s.x,a*(t+1)),R.lerp(r.y,s.y,a*(n+1)),R.lerp(r.z,s.z,a*(i+1)),gZ);return yZ(c,l,this.shapeTransform,o)};var EAe=new h;Vl.prototype.computeOrientedBoundingBoxForSample=function(e,t,n,i){let o=1/Math.pow(2,e.level),r=h.divideComponents(h.ONE,t,EAe),s=h.multiplyByScalar(r,o,EAe),a=h.multiplyByScalar(h.fromElements(e.x+n.x,e.y+n.y,e.z+n.z,o5),o,o5),c=h.add(a,s,gZ),l=this._minBounds,f=this._maxBounds,d=h.fromElements(R.lerp(l.x,f.x,a.x),R.lerp(l.y,f.y,a.y),R.lerp(l.z,f.z,a.z),o5),p=h.fromElements(R.lerp(l.x,f.x,c.x),R.lerp(l.y,f.y,c.y),R.lerp(l.z,f.z,c.z),gZ);return yZ(d,p,this.shapeTransform,i)};Vl.DefaultMinBounds=Object.freeze(new h(-1,-1,-1));Vl.DefaultMaxBounds=Object.freeze(new h(1,1,1));function yZ(e,t,n,i){let o=Vl.DefaultMinBounds,r=Vl.DefaultMaxBounds;if(h.equals(e,o)&&h.equals(t,r))i.center=F.getTranslation(n,i.center),i.halfAxes=F.getMatrix3(n,i.halfAxes);else{let a=F.getScale(n,_Z),c=h.midpoint(e,t,xxt);i.center=F.multiplyByPoint(n,c,i.center),a=h.fromElements(a.x*.5*(t.x-e.x),a.y*.5*(t.y-e.y),a.z*.5*(t.z-e.z),_Z);let l=F.getRotation(n,bxt);i.halfAxes=J.setScale(l,a,i.halfAxes)}return i}var T_=Vl;function Jr(){this.orientedBoundingBox=new wn,this.boundingSphere=new ae,this.boundTransform=new F,this.shapeTransform=new F,this._minimumRadius=Jr.DefaultMinBounds.x,this._maximumRadius=Jr.DefaultMaxBounds.x,this._minimumHeight=Jr.DefaultMinBounds.y,this._maximumHeight=Jr.DefaultMaxBounds.y,this._minimumAngle=Jr.DefaultMinBounds.z,this._maximumAngle=Jr.DefaultMaxBounds.z,this.shaderUniforms={cylinderRenderHeightMinMax:new H,cylinderRenderRadiusMinMax:new H,cylinderRenderAngleMinMax:new H,cylinderUvToShapeUvRadius:new H,cylinderUvToShapeUvHeight:new H,cylinderUvToShapeUvAngle:new H,cylinderShapeUvAngleMinMax:new H,cylinderShapeUvAngleRangeZeroMid:0},this.shaderDefines={CYLINDER_HAS_RENDER_BOUNDS_RADIUS_MIN:void 0,CYLINDER_HAS_RENDER_BOUNDS_RADIUS_FLAT:void 0,CYLINDER_HAS_RENDER_BOUNDS_ANGLE:void 0,CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_EQUAL_ZERO:void 0,CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_UNDER_HALF:void 0,CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_OVER_HALF:void 0,CYLINDER_HAS_SHAPE_BOUNDS_RADIUS:void 0,CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT:void 0,CYLINDER_HAS_SHAPE_BOUNDS_ANGLE:void 0,CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_DISCONTINUITY:void 0,CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MAX_DISCONTINUITY:void 0,CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_MAX_REVERSED:void 0,CYLINDER_INTERSECTION_INDEX_RADIUS_MAX:void 0,CYLINDER_INTERSECTION_INDEX_RADIUS_MIN:void 0,CYLINDER_INTERSECTION_INDEX_ANGLE:void 0},this.shaderMaximumIntersectionsLength=0}var DAe=new h;Jr.prototype.update=function(e,t,n,i,o){i=x(i,Jr.DefaultMinBounds),o=x(o,Jr.DefaultMaxBounds);let r=Jr.DefaultMinBounds.x,s=Jr.DefaultMaxBounds.x,a=Jr.DefaultMinBounds.y,c=Jr.DefaultMaxBounds.y,l=Jr.DefaultMinBounds.z,f=Jr.DefaultMaxBounds.z,d=f-l,p=.5*d,g=R.EPSILON10,m=R.EPSILON3,y=R.EPSILON10,b=R.clamp(t.x,r,s),C=R.clamp(n.x,r,s),A=R.clamp(i.x,r,s),T=R.clamp(o.x,r,s),E=Math.max(b,A),v=Math.min(C,T),D=R.clamp(t.y,a,c),O=R.clamp(n.y,a,c),P=R.clamp(i.y,a,c),M=R.clamp(o.y,a,c),L=Math.max(D,P),_=Math.min(O,M),S=R.negativePiToPi(t.z),w=R.negativePiToPi(n.z),I=R.negativePiToPi(i.z),N=R.negativePiToPi(o.z),k=Math.max(S,I),z=Math.min(w,N),V=F.getScale(e,DAe);if(v===0||E>v||L>_||R.equalsEpsilon(V.x,0,void 0,g)||R.equalsEpsilon(V.y,0,void 0,g)||R.equalsEpsilon(V.z,0,void 0,g))return!1;this._minimumRadius=b,this._maximumRadius=C,this._minimumHeight=D,this._maximumHeight=O,this._minimumAngle=S,this._maximumAngle=w,this.shapeTransform=F.clone(e,this.shapeTransform),this.orientedBoundingBox=bZ(E,v,L,_,k,z,this.shapeTransform,this.orientedBoundingBox),this.boundTransform=F.fromRotationTranslation(this.orientedBoundingBox.halfAxes,this.orientedBoundingBox.center,this.boundTransform),this.boundingSphere=ae.fromOrientedBoundingBox(this.orientedBoundingBox,this.boundingSphere);let W=b===r&&C===s,j=D===a&&O===c,Q=w<S,q=w-S+Q*d,X=q>p+y&&q<d-y,Z=q<p-y,fe=q>=p-y&&q<=p+y,xe=X||Z||fe,re=R.equalsEpsilon(S,l,void 0,m),pe=R.equalsEpsilon(w,f,void 0,m),ye=E===r,Se=z<k,Te=z-k+Se*d,Fe=Te>=p-y&&Te<d-y,Ve=Te>y&&Te<p-y,Ze=Te<=y,gt=Fe||Ve||Ze,{shaderUniforms:lt,shaderDefines:Oe}=this;for(let ut in Oe)Oe.hasOwnProperty(ut)&&(Oe[ut]=void 0);let Mt=0;if(Oe.CYLINDER_INTERSECTION_INDEX_RADIUS_MAX=Mt,Mt+=1,ye||(Oe.CYLINDER_HAS_RENDER_BOUNDS_RADIUS_MIN=!0,Oe.CYLINDER_INTERSECTION_INDEX_RADIUS_MIN=Mt,Mt+=1),lt.cylinderRenderRadiusMinMax=H.fromElements(E,v,lt.cylinderRenderRadiusMinMax),E===v&&(Oe.CYLINDER_HAS_RENDER_BOUNDS_RADIUS_FLAT=!0),!W){Oe.CYLINDER_HAS_SHAPE_BOUNDS_RADIUS=!0;let ut=C-b,at=0,Kt=1;ut!==0&&(at=1/ut,Kt=-b/ut),lt.cylinderUvToShapeUvRadius=H.fromElements(at,Kt,lt.cylinderUvToShapeUvRadius)}if(!j){Oe.CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT=!0;let ut=O-D,at=0,Kt=1;ut!==0&&(at=2/ut,Kt=-(D+1)/ut),lt.cylinderUvToShapeUvHeight=H.fromElements(at,Kt,lt.cylinderUvToShapeUvHeight)}if(lt.cylinderRenderHeightMinMax=H.fromElements(L,_,lt.cylinderRenderHeightMinMax),Q&&(Oe.CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_MAX_REVERSED=!0),gt&&(Oe.CYLINDER_HAS_RENDER_BOUNDS_ANGLE=!0,Oe.CYLINDER_INTERSECTION_INDEX_ANGLE=Mt,Fe?(Oe.CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_UNDER_HALF=!0,Mt+=1):Ve?(Oe.CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_OVER_HALF=!0,Mt+=2):Ze&&(Oe.CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_EQUAL_ZERO=!0,Mt+=2),lt.cylinderRenderAngleMinMax=H.fromElements(k,z,lt.cylinderRenderAngleMinMax)),xe){Oe.CYLINDER_HAS_SHAPE_BOUNDS_ANGLE=!0,re&&(Oe.CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_DISCONTINUITY=!0),pe&&(Oe.CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MAX_DISCONTINUITY=!0);let ut=(S-l)/d,at=(w-l)/d,Kt=1-q/d;if(lt.cylinderShapeUvAngleMinMax=H.fromElements(ut,at,lt.cylinderShapeUvAngleMinMax),lt.cylinderShapeUvAngleRangeZeroMid=(at+.5*Kt)%1,q<=y)lt.cylinderUvToShapeUvAngle=H.fromElements(0,1,lt.cylinderUvToShapeUvAngle);else{let Ce=d/q,Ae=-(S-l)/q;lt.cylinderUvToShapeUvAngle=H.fromElements(Ce,Ae,lt.cylinderUvToShapeUvAngle)}}return this.shaderMaximumIntersectionsLength=Mt,!0};Jr.prototype.computeOrientedBoundingBoxForTile=function(e,t,n,i,o){let r=this._minimumRadius,s=this._maximumRadius,a=this._minimumHeight,c=this._maximumHeight,l=this._minimumAngle,f=this._maximumAngle,d=1/Math.pow(2,e),p=R.lerp(r,s,t*d),g=R.lerp(r,s,(t+1)*d),m=R.lerp(a,c,n*d),y=R.lerp(a,c,(n+1)*d),b=R.lerp(l,f,i*d),C=R.lerp(l,f,(i+1)*d);return bZ(p,g,m,y,b,C,this.shapeTransform,o)};var SAe=new h,vAe=new h,Sxt=new h;Jr.prototype.computeOrientedBoundingBoxForSample=function(e,t,n,i){let o=1/Math.pow(2,e.level),r=h.divideComponents(h.ONE,t,SAe),s=h.multiplyByScalar(r,o,SAe),a=h.multiplyByScalar(h.fromElements(e.x+n.x,e.y+n.y,e.z+n.z,vAe),o,vAe),c=h.add(a,s,Sxt),l=this._minimumRadius,f=this._maximumRadius,d=this._minimumHeight,p=this._maximumHeight,g=this._minimumAngle,m=this._maximumAngle,y=R.lerp(l,f,a.x),b=R.lerp(l,f,c.x),C=R.lerp(d,p,a.y),A=R.lerp(d,p,c.y),T=R.lerp(g,m,a.z),E=R.lerp(g,m,c.z);return bZ(y,b,C,A,T,E,this.shapeTransform,i)};Jr.DefaultMinBounds=Object.freeze(new h(0,-1,-R.PI));Jr.DefaultMaxBounds=Object.freeze(new h(1,1,+R.PI));var vxt=5,wxt=new Array(vxt),Dxt=new h,Ixt=new J,Pxt=new F,Rxt=new F,Oxt=new F,xZ=new F,Mxt=new h,Lxt=new h,Nxt=new h,IAe=new Array(8);for(let e=0;e<8;e++)IAe[e]=new h;function wAe(e,t,n){return Math.abs(oe.dot(e,t))<n}function Fxt(e){let t=F.getColumn(e,0,Mxt),n=F.getColumn(e,1,Lxt),i=F.getColumn(e,2,Nxt),o=R.EPSILON4;return wAe(t,n,o)&&wAe(n,i,o)}function Bxt(e,t){let n=IAe;h.fromElements(-.5,-.5,-.5,n[0]),h.fromElements(-.5,-.5,.5,n[1]),h.fromElements(-.5,.5,-.5,n[2]),h.fromElements(-.5,.5,.5,n[3]),h.fromElements(.5,-.5,-.5,n[4]),h.fromElements(.5,-.5,.5,n[5]),h.fromElements(.5,.5,-.5,n[6]),h.fromElements(.5,.5,.5,n[7]);for(let i=0;i<8;++i)F.multiplyByPoint(e,n[i],n[i]);return wn.fromPoints(n,t)}function bZ(e,t,n,i,o,r,s,a){let c=Jr.DefaultMinBounds,l=Jr.DefaultMaxBounds,f=c.x,d=l.x,p=c.y,g=l.y,m=c.z,y=l.z;if(e===f&&t===d&&n===p&&i===g&&o===m&&r===y)return a.center=F.getTranslation(s,a.center),a.halfAxes=F.getMatrix3(s,a.halfAxes),a;r<o&&(r+=R.TWO_PI);let C=r-o,A=o+C*.5,T=wxt,E=0;T[E++]=o,T[E++]=r,T[E++]=A,C>R.PI&&(T[E++]=A-R.PI_OVER_TWO,T[E++]=A+R.PI_OVER_TWO);let v=1,D=1,O=-1,P=-1;for(let Q=0;Q<E;++Q){let q=T[Q]-A,X=Math.cos(q),Z=Math.sin(q),fe=X*e,xe=Z*e,re=X*t,pe=Z*t;v=Math.min(v,fe),D=Math.min(D,xe),v=Math.min(v,re),D=Math.min(D,pe),O=Math.max(O,fe),P=Math.max(P,xe),O=Math.max(O,re),P=Math.max(P,pe)}let M=O-v,L=P-D,_=i-n,S=(v+O)*.5,w=(D+P)*.5,I=(n+i)*.5,N=h.fromElements(S,w,I,Dxt),k=J.fromRotationZ(A,Ixt),z=h.fromElements(M,L,_,DAe),V=F.fromScale(z,Oxt),U=F.fromRotation(k,Rxt),B=F.fromTranslation(N,Pxt),W=F.multiplyTransformation(U,F.multiplyTransformation(B,V,xZ),xZ),j=F.multiplyTransformation(s,W,xZ);return Fxt(j)?wn.fromTransformation(j,a):Bxt(j,a)}var E_=Jr;function S_(){this.orientedBoundingBox=new wn,this.boundingSphere=new ae,this.boundTransform=new F,this.shapeTransform=new F,this._rectangle=new se,this._minimumHeight=S_.DefaultMinBounds.z,this._maximumHeight=S_.DefaultMaxBounds.z,this._ellipsoid=new ee,this._translation=new h,this._rotation=new J,this.shaderUniforms={ellipsoidRadiiUv:new h,eccentricitySquared:0,evoluteScale:new H,ellipsoidInverseRadiiSquaredUv:new h,ellipsoidRenderLongitudeMinMax:new H,ellipsoidShapeUvLongitudeMinMaxMid:new h,ellipsoidUvToShapeUvLongitude:new H,ellipsoidUvToShapeUvLatitude:new H,ellipsoidRenderLatitudeSinMinMax:new H,ellipsoidInverseHeightDifferenceUv:0,clipMinMaxHeight:new H},this.shaderDefines={ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_EQUAL_ZERO:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_UNDER_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_OVER_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MIN_DISCONTINUITY:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MAX_DISCONTINUITY:void 0,ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE:void 0,ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE_MIN_MAX_REVERSED:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_UNDER_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_EQUAL_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_OVER_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_UNDER_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_EQUAL_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_OVER_HALF:void 0,ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE:void 0,ELLIPSOID_INTERSECTION_INDEX_LONGITUDE:void 0,ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX:void 0,ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN:void 0,ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MAX:void 0,ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MIN:void 0},this.shaderMaximumIntersectionsLength=0}var kxt=new h,Vxt=new h,Uxt=new h,zxt=new h,Hxt=new h,Gxt=new h,Wxt=new h,jxt=new h,qxt=new J,PAe=new h,RAe=new h,Yxt=new se;S_.prototype.update=function(e,t,n,i,o){let{DefaultMinBounds:r,DefaultMaxBounds:s}=S_;i=x(i,r),o=x(o,s);let a=R.EPSILON10,c=R.EPSILON3,l=R.EPSILON10,f=R.EPSILON10,d=R.EPSILON3,p=F.getScale(e,jxt),g=h.clone(r,kxt);g.z=-h.minimumComponent(p);let m=h.clamp(t,g,s,Vxt),y=h.clamp(n,g,s,Uxt),b=h.clamp(i,g,s,zxt),C=h.clamp(o,g,s,Hxt),A=h.maximumByComponent(m,b,Gxt),T=h.minimumByComponent(y,C,Wxt),E=h.add(p,h.fromElements(y.z,y.z,y.z,PAe),PAe),v=h.maximumComponent(E),D=h.add(p,h.fromElements(T.z,T.z,T.z,RAe),RAe);if(A.y>T.y||A.y===s.y||T.y===r.y||A.z>T.z||R.equalsEpsilon(D,h.ZERO,void 0,a))return!1;this._rectangle=se.fromRadians(m.x,m.y,y.x,y.y),this._translation=F.getTranslation(e,this._translation),this._rotation=F.getRotation(e,this._rotation),this._ellipsoid=ee.fromCartesian3(p,this._ellipsoid),this._minimumHeight=m.z,this._maximumHeight=y.z;let O=se.fromRadians(A.x,A.y,T.x,T.y,Yxt);this.orientedBoundingBox=CZ(O,A.z,T.z,this._ellipsoid,this._translation,this._rotation,this.orientedBoundingBox),this.shapeTransform=F.fromRotationTranslation(J.setScale(this._rotation,E,qxt),this._translation,this.shapeTransform),this.boundTransform=F.fromRotationTranslation(this.orientedBoundingBox.halfAxes,this.orientedBoundingBox.center,this.boundTransform),this.boundingSphere=ae.fromOrientedBoundingBox(this.orientedBoundingBox,this.boundingSphere);let P=s.x-r.x,M=.5*P,L=T.x<A.x,_=T.x-A.x+L*P,S=_<=l,w=_>=M-l&&_<P-l,I=_>l&&_<M-l,N=S||w||I,k=y.x<m.x,z=y.x-m.x+k*P,V=z>M+l&&z<P-l,U=z>=M-l&&z<=M+l,B=z<M-l,W=V||U||B,j=T.y<-d,Q=T.y>=-d&&T.y<=+d,q=T.y>+d&&T.y<s.y-f,X=j||Q||q,Z=A.y>r.y+f&&A.y<-d,fe=A.y>=-d&&A.y<=+d,xe=A.y>+d,re=Z||fe||xe,pe=X||re,ye=y.y-m.y,Se=y.y<-d,Te=y.y>=-d&&y.y<=+d,Fe=y.y>+d&&y.y<s.y-f,Ve=Se||Te||Fe,Ze=m.y>r.y+f&&m.y<-d,gt=m.y>=-d&&m.y<=+d,lt=m.y>+d,Mt=Ve||(Ze||gt||lt),{shaderUniforms:ut,shaderDefines:at}=this;for(let ct in at)at.hasOwnProperty(ct)&&(at[ct]=void 0);ut.ellipsoidRadiiUv=h.divideByScalar(E,v,ut.ellipsoidRadiiUv);let{x:Kt,z:Ce}=ut.ellipsoidRadiiUv,Ae=Ce/Kt;ut.eccentricitySquared=1-Ae*Ae,ut.evoluteScale=H.fromElements((Kt*Kt-Ce*Ce)/Kt,(Ce*Ce-Kt*Kt)/Ce,ut.evoluteScale),ut.ellipsoidInverseRadiiSquaredUv=h.divideComponents(h.ONE,h.multiplyComponents(ut.ellipsoidRadiiUv,ut.ellipsoidRadiiUv,ut.ellipsoidInverseRadiiSquaredUv),ut.ellipsoidInverseRadiiSquaredUv);let nt=0;at.ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MAX=nt,nt+=1,at.ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MIN=nt,nt+=1,ut.clipMinMaxHeight=H.fromElements((A.z-y.z)/v,(T.z-y.z)/v,ut.clipMinMaxHeight);let yi=(y.z-m.z)/v;if(ut.ellipsoidInverseHeightDifferenceUv=1/yi,m.z===y.z&&(ut.ellipsoidInverseHeightDifferenceUv=0),N&&(at.ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE=!0,at.ELLIPSOID_INTERSECTION_INDEX_LONGITUDE=nt,w?(at.ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_UNDER_HALF=!0,nt+=1):I?(at.ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_OVER_HALF=!0,nt+=2):S&&(at.ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_EQUAL_ZERO=!0,nt+=2),ut.ellipsoidRenderLongitudeMinMax=H.fromElements(A.x,T.x,ut.ellipsoidRenderLongitudeMinMax)),W)if(at.ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE=!0,y.x<m.x&&(at.ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE_MIN_MAX_REVERSED=!0),z<=l)ut.ellipsoidUvToShapeUvLongitude=H.fromElements(0,1,ut.ellipsoidUvToShapeUvLongitude);else{let Si=P/z,oo=-(m.x-r.x)/z;ut.ellipsoidUvToShapeUvLongitude=H.fromElements(Si,oo,ut.ellipsoidUvToShapeUvLongitude)}if(N){let ct=R.equalsEpsilon(A.x,r.x,void 0,c),Si=R.equalsEpsilon(T.x,s.x,void 0,c);ct&&(at.ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MIN_DISCONTINUITY=!0),Si&&(at.ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MAX_DISCONTINUITY=!0);let oo=(m.x-r.x)/P,Zs=(y.x-r.x)/P,jo=(T.x-r.x)/P,wr=1-_/P,Me=(jo+.5*wr)%1;ut.ellipsoidShapeUvLongitudeMinMaxMid=h.fromElements(oo,Zs,Me,ut.ellipsoidShapeUvLongitudeMinMaxMid)}if(pe&&(re&&(at.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN=!0,at.ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN=nt,Z?(at.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_UNDER_HALF=!0,nt+=1):fe?(at.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_EQUAL_HALF=!0,nt+=1):xe&&(at.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_OVER_HALF=!0,nt+=2)),X&&(at.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX=!0,at.ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX=nt,j?(at.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_UNDER_HALF=!0,nt+=2):Q?(at.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_EQUAL_HALF=!0,nt+=1):q&&(at.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_OVER_HALF=!0,nt+=1)),ut.ellipsoidRenderLatitudeSinMinMax=H.fromElements(Math.sin(A.y),Math.sin(T.y),ut.ellipsoidRenderLatitudeSinMinMax)),Mt)if(at.ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE=!0,ye<f)ut.ellipsoidUvToShapeUvLatitude=H.fromElements(0,1,ut.ellipsoidUvToShapeUvLatitude);else{let Si=(s.y-r.y)/ye,oo=(r.y-m.y)/ye;ut.ellipsoidUvToShapeUvLatitude=H.fromElements(Si,oo,ut.ellipsoidUvToShapeUvLatitude)}return this.shaderMaximumIntersectionsLength=nt,!0};var LAe=new se;S_.prototype.computeOrientedBoundingBoxForTile=function(e,t,n,i,o){let r=1/Math.pow(2,e),s=t*r,a=(t+1)*r,c=n*r,l=(n+1)*r,f=i*r,d=(i+1)*r,p=se.subsection(this._rectangle,s,c,a,l,LAe),g=R.lerp(this._minimumHeight,this._maximumHeight,f),m=R.lerp(this._minimumHeight,this._maximumHeight,d);return CZ(p,g,m,this._ellipsoid,this._translation,this._rotation,o)};var OAe=new h,MAe=new h,Xxt=new h;S_.prototype.computeOrientedBoundingBoxForSample=function(e,t,n,i){let o=1/Math.pow(2,e.level),r=h.divideComponents(h.ONE,t,OAe),s=h.multiplyByScalar(r,o,OAe),a=h.multiplyByScalar(h.fromElements(e.x+n.x,e.y+n.y,e.z+n.z,MAe),o,MAe),c=h.add(a,s,Xxt),l=se.subsection(this._rectangle,a.x,a.y,c.x,c.y,LAe),f=R.lerp(this._minimumHeight,this._maximumHeight,a.z),d=R.lerp(this._minimumHeight,this._maximumHeight,c.z);return CZ(l,f,d,this._ellipsoid,this._translation,this._rotation,i)};function CZ(e,t,n,i,o,r,s){return s=wn.fromRectangle(e,t,n,i,s),s.center=h.add(s.center,o,s.center),s.halfAxes=J.multiply(s.halfAxes,r,s.halfAxes),s}S_.DefaultMinBounds=Object.freeze(new h(-R.PI,-R.PI_OVER_TWO,-ee.WGS84.minimumRadius));S_.DefaultMaxBounds=Object.freeze(new h(R.PI,R.PI_OVER_TWO,10*ee.WGS84.maximumRadius));var fS=S_;var Bu={BOX:"BOX",ELLIPSOID:"ELLIPSOID",CYLINDER:"CYLINDER"};Bu.getMinBounds=function(e){switch(e){case Bu.BOX:return T_.DefaultMinBounds;case Bu.ELLIPSOID:return fS.DefaultMinBounds;case Bu.CYLINDER:return E_.DefaultMinBounds}};Bu.getMaxBounds=function(e){switch(e){case Bu.BOX:return T_.DefaultMaxBounds;case Bu.ELLIPSOID:return fS.DefaultMaxBounds;case Bu.CYLINDER:return E_.DefaultMaxBounds}};Bu.getShapeConstructor=function(e){switch(e){case Bu.BOX:return T_;case Bu.ELLIPSOID:return fS;case Bu.CYLINDER:return E_}};var zi=Object.freeze(Bu);var NAe=Object.freeze({UNLOADED:0,RECEIVING:1,RECEIVED:2,LOADED:3,FAILED:4,UNAVAILABLE:5});function r5(e,t){this.spatialNode=e,this.keyframe=t,this.state=NAe.UNLOADED,this.metadata=[],this.megatextureIndex=-1,this.priority=-Number.MAX_VALUE,this.highPriorityFrameNumber=-1}r5.priorityComparator=function(e,t){return e.priority-t.priority};r5.searchComparator=function(e,t){return e.keyframe-t.keyframe};r5.LoadState=NAe;var io=r5;function fy(e,t,n,i,o){i===Gt.UNSIGNED_SHORT&&(i=Gt.FLOAT32);let r=e.floatingPointTexture;if(i===Gt.FLOAT32&&!r)throw new ce("Floating point texture not supported");let s;i===Gt.FLOAT32||i===Gt.FLOAT64?s=Ke.FLOAT:i===Gt.UINT8&&(s=Ke.UNSIGNED_BYTE);let a;n===1?a=e.webgl2?tt.RED:tt.LUMINANCE:n===2?a=e.webgl2?tt.RG:tt.LUMINANCE_ALPHA:n===3?a=tt.RGB:n===4&&(a=tt.RGBA);let c=512*1024*1024,l=128*1024*1024;o=Math.min(x(o,l),c);let f=Vt.maximumTextureSize,d=Gt.getSizeInBytes(i),p=Math.floor(o/(n*d)),g=Math.min(f,R.previousPowerOfTwo(Math.floor(Math.sqrt(p)))),m=Math.ceil(Math.sqrt(t.x)),y=Math.ceil(t.z/m),b=m*t.x,C=y*t.y,A=Math.floor(g/b),T=Math.floor(g/C);if(A===0||T===0)throw new ce("Tileset is too large to fit into megatexture");this.channelCount=n,this.componentType=i,this.voxelCountPerTile=h.clone(t,new h),this.maximumTileCount=A*T,this.regionCountPerMegatexture=new H(A,T),this.voxelCountPerRegion=new H(b,C),this.sliceCountPerRegion=new H(m,y),this.voxelSizeUv=new H(1/g,1/g),this.sliceSizeUv=new H(t.x/g,t.y/g),this.regionSizeUv=new H(b/g,C/g),this.texture=new Ot({context:e,pixelFormat:a,pixelDatatype:s,flipY:!1,width:g,height:g,sampler:new Qt({wrapS:En.CLAMP_TO_EDGE,wrapT:En.CLAMP_TO_EDGE,minificationFilter:$t.LINEAR,magnificationFilter:mi.LINEAR})});let E=Gt.toComponentDatatype(i);this.tileVoxelDataTemp=K.createTypedArray(E,b*C*n),this.nodes=new Array(this.maximumTileCount);for(let v=0;v<this.maximumTileCount;v++)this.nodes[v]=new Kxt(v);for(let v=0;v<this.maximumTileCount;v++){let D=this.nodes[v];D.previousNode=v>0?this.nodes[v-1]:void 0,D.nextNode=v<this.maximumTileCount-1?this.nodes[v+1]:void 0}this.occupiedList=void 0,this.emptyList=this.nodes[0],this.occupiedCount=0}function Kxt(e){this.index=e,this.nextNode=void 0,this.previousNode=void 0}fy.prototype.add=function(e){if(this.isFull())throw new he("Trying to add when there are no empty spots");let t=this.emptyList;this.emptyList=this.emptyList.nextNode,u(this.emptyList)&&(this.emptyList.previousNode=void 0),t.nextNode=this.occupiedList,u(t.nextNode)&&(t.nextNode.previousNode=t),this.occupiedList=t;let n=t.index;return this.writeDataToTexture(n,e),this.occupiedCount++,n};fy.prototype.remove=function(e){if(e<0||e>=this.maximumTileCount)throw new he("Megatexture index out of bounds");let t=this.nodes[e];u(t.previousNode)&&(t.previousNode.nextNode=t.nextNode),u(t.nextNode)&&(t.nextNode.previousNode=t.previousNode),t.nextNode=this.emptyList,u(t.nextNode)&&(t.nextNode.previousNode=t),t.previousNode=void 0,this.emptyList=t,this.occupiedCount--};fy.prototype.isFull=function(){return this.emptyList===void 0};fy.getApproximateTextureMemoryByteLength=function(e,t,n,i){i===Gt.UNSIGNED_SHORT&&(i=Gt.FLOAT32);let o=Gt.getSizeInBytes(i),r=e*t.x*t.y*t.z,s=Math.ceil(Math.sqrt(t.x)),a=Math.ceil(t.z/s),c=s*t.x,l=a*t.y,f=R.previousPowerOfTwo(Math.floor(Math.sqrt(r)));for(;;){let p=Math.floor(f/c),g=Math.floor(f/l);if(p*g>=e)break;f*=2}return f*f*n*o};fy.prototype.writeDataToTexture=function(e,t){let n=t.constructor===Uint16Array?new Float32Array(t):t,i=this.voxelCountPerTile,o=this.sliceCountPerRegion,r=this.voxelCountPerRegion,s=this.channelCount,a=this.tileVoxelDataTemp;for(let y=0;y<i.z;y++){let b=y%o.x*i.x,C=Math.floor(y/o.x)*i.y;for(let A=0;A<i.y;A++)for(let T=0;T<i.x;T++){let E=y*i.y*i.x+A*i.x+T,v=(C+A)*r.x+(b+T);for(let D=0;D<s;D++)a[v*s+D]=n[E*s+D]}}let c=this.regionCountPerMegatexture,l=r.x,f=r.y,d=e%c.x*r.x,p=Math.floor(e/c.x)*r.y,m={source:{arrayBufferView:a,width:l,height:f},xOffset:d,yOffset:p};this.texture.copyFrom(m)};fy.prototype.isDestroyed=function(){return!1};fy.prototype.destroy=function(){return this.texture=this.texture&&this.texture.destroy(),ue(this)};var hI=fy;function Jf(e,t,n,i,o,r,s){this.children=void 0,this.parent=o,this.level=e,this.x=t,this.y=n,this.z=i,this.dimensions=h.clone(s),this.keyframeNodes=[],this.renderableKeyframeNodes=[],this.renderableKeyframeNodeLerp=0,this.renderableKeyframeNodePrevious=void 0,this.renderableKeyframeNodeNext=void 0,this.orientedBoundingBox=new wn,this.approximateVoxelSize=0,this.screenSpaceError=0,this.visitedFrameNumber=-1,this.computeBoundingVolumes(r)}var Zxt=new h;Jf.prototype.computeBoundingVolumes=function(e){this.orientedBoundingBox=e.computeOrientedBoundingBoxForTile(this.level,this.x,this.y,this.z,this.orientedBoundingBox);let t=J.getScale(this.orientedBoundingBox.halfAxes,Zxt),n=2*h.maximumComponent(t);this.approximateVoxelSize=n/h.minimumComponent(this.dimensions)};Jf.prototype.constructChildNodes=function(e){let{level:t,x:n,y:i,z:o}=this,r=n*2,s=i*2,a=o*2,c=s+1,l=r+1,f=a+1,d=t+1,p=[[d,r,s,a],[d,l,s,a],[d,r,c,a],[d,l,c,a],[d,r,s,f],[d,l,s,f],[d,r,c,f],[d,l,c,f]];this.children=p.map(([g,m,y,b])=>new Jf(g,m,y,b,this,e,this.dimensions))};Jf.prototype.visibility=function(e,t){let n=this.orientedBoundingBox;return e.cullingVolume.computeVisibilityWithPlaneMask(n,t)};Jf.prototype.computeScreenSpaceError=function(e,t){let n=this.orientedBoundingBox,i=Math.sqrt(n.distanceSquaredTo(e));i=Math.max(i,R.EPSILON7);let o=this.approximateVoxelSize,r=t*(o/i);this.screenSpaceError=r};var FAe={keyframe:0};function mI(e,t){return FAe.keyframe=e,No(t,FAe,io.searchComparator)}Jf.prototype.computeSurroundingRenderableKeyframeNodes=function(e){let t=this,n=t.level,i=Math.floor(e),o=Math.ceil(e),r,s,a=+Number.MAX_VALUE,c=+Number.MAX_VALUE;for(;u(t);){let{renderableKeyframeNodes:d}=t;if(d.length>=1){let p=$xt(i,d),g=d[p],m=o===i||i<g.keyframe?p:Math.min(p+1,d.length-1),y=d[m],b=i-g.keyframe,C=BAe(n-t.level,b);C<a&&(a=C,r=g);let A=y.keyframe-o,T=BAe(n-t.level,A);if(T<c&&(c=T,s=y),b===0&&A===0)break}t=t.parent}if(this.renderableKeyframeNodePrevious=r,this.renderableKeyframeNodeNext=s,!u(r)||!u(s))return;let l=r.keyframe,f=s.keyframe;this.renderableKeyframeNodeLerp=l===f?0:R.clamp((e-l)/(f-l),0,1)};function $xt(e,t){let n=mI(e,t);return n<0?R.clamp(~n-1,0,t.length-1):n}function BAe(e,t){let n=Math.exp(e*4),i=t>=0?1:-200;return e*n+t*i}Jf.prototype.isVisited=function(e){return this.visitedFrameNumber===e};Jf.prototype.createKeyframeNode=function(e){let t=mI(e,this.keyframeNodes);if(t<0){t=~t;let n=new io(this,e);this.keyframeNodes.splice(t,0,n)}};Jf.prototype.destroyKeyframeNode=function(e,t){let n=e.keyframe,i=mI(n,this.keyframeNodes);if(i<0)throw new he("Keyframe node does not exist.");if(this.keyframeNodes.splice(i,1),e.megatextureIndex!==-1){for(let r=0;r<t.length;r++)t[r].remove(e.megatextureIndex);let o=mI(n,this.renderableKeyframeNodes);if(o<0)throw new he("Renderable keyframe node does not exist.");this.renderableKeyframeNodes.splice(o,1)}e.spatialNode=void 0,e.state=io.LoadState.UNLOADED,e.metadata={},e.megatextureIndex=-1,e.priority=-Number.MAX_VALUE,e.highPriorityFrameNumber=-1};Jf.prototype.addKeyframeNodeToMegatextures=function(e,t){if(e.state!==io.LoadState.RECEIVED||e.megatextureIndex!==-1||e.metadata.length!==t.length)throw new he("Keyframe node cannot be added to megatexture");for(let o=0;o<t.length;o++){let r=t[o];e.megatextureIndex=r.add(e.metadata[o])}e.state=io.LoadState.LOADED;let n=this.renderableKeyframeNodes,i=mI(e.keyframe,n);if(i>=0)throw new he("Keyframe already renderable");i=~i,n.splice(i,0,e)};Jf.prototype.isRenderable=function(e){let t=this.renderableKeyframeNodePrevious,n=this.renderableKeyframeNodeNext,i=this.level;return u(t)&&u(n)&&(t.spatialNode.level===i||n.spatialNode.level===i)&&this.visitedFrameNumber===e};var s5=Jf;function v_(e,t,n,i,o,r,s){this._primitive=e,this.megatextures=new Array(i.length);for(let m=0;m<i.length;m++){let y=i[m],b=Et.getComponentCount(y),C=o[m];this.megatextures[m]=new hI(t,n,b,C,s)}let a=this.megatextures[0].maximumTileCount;this._simultaneousRequestCount=0,this._debugPrint=!1,this._frameNumber=0;let c=e._shape;this.rootNode=new s5(0,0,0,0,void 0,c,n),this._priorityQueue=new IE({maximumLength:a,comparator:io.priorityComparator}),this._highPriorityKeyframeNodes=new Array(a),this._keyframeNodesInMegatexture=new Array(a),this._keyframeCount=r,this._sampleCount=void 0,this._keyframeLocation=0,this._binaryTreeKeyframeWeighting=new Array(r);let l=this._binaryTreeKeyframeWeighting;l[0]=0,l[r-1]=0,AZ(l,1,r-2,0);let f=9,d=2048,p=Math.floor(d/f),g=Math.ceil(a/p);this.internalNodeTexture=new Ot({context:t,pixelFormat:tt.RGBA,pixelDatatype:Ke.UNSIGNED_BYTE,flipY:!1,width:d,height:g,sampler:new Qt({minificationFilter:$t.NEAREST,magnificationFilter:mi.NEAREST})}),this.internalNodeTilesPerRow=p,this.internalNodeTexelSizeUv=new H(1/d,1/g),this.leafNodeTexture=void 0,this.leafNodeTilesPerRow=void 0,this.leafNodeTexelSizeUv=new H}v_.prototype.findKeyframeNode=function(e){return this._keyframeNodesInMegatexture.find(function(t){return t.megatextureIndex===e})};function AZ(e,t,n,i){if(t>n)return;let o=Math.floor((t+n)/2);e[o]=i,AZ(e,t,o-1,i+1),AZ(e,o+1,n,i+1)}v_.simultaneousRequestCountMaximum=50;v_.prototype.update=function(e,t,n,i){let o=this._primitive,r=e.context,s=this.megatextures[0].maximumTileCount,a=this._keyframeCount,c=o._levelBlendFactor,l=c>0,f=a>1,d=(l?2:1)*(f?2:1);this._sampleCount=d;let p=d>=2;if(p&&!u(this.leafNodeTexture)){let A=Math.floor(512),T=Math.ceil(s/A);this.leafNodeTexture=new Ot({context:r,pixelFormat:tt.RGBA,pixelDatatype:Ke.UNSIGNED_BYTE,flipY:!1,width:1024,height:T,sampler:new Qt({minificationFilter:$t.NEAREST,magnificationFilter:mi.NEAREST})}),this.leafNodeTexelSizeUv=H.fromElements(1/1024,1/T,this.leafNodeTexelSizeUv),this.leafNodeTilesPerRow=A}else!p&&u(this.leafNodeTexture)&&(this.leafNodeTexture=this.leafNodeTexture.destroy());if(this._keyframeLocation=R.clamp(t,0,a-1),n&&kAe(this,this.rootNode),i)return;this._frameNumber=e.frameNumber;let g=Ei();ebt(this,e);let m=Ei();ibt(this,d,c);let y=Ei();if(this._debugPrint){let b=m-g,C=y-m,A=y-g;nbt(this,b,C,A)}};v_.prototype.isRenderable=function(e){return e.isRenderable(this._frameNumber)};v_.prototype.isDestroyed=function(){return!1};v_.prototype.destroy=function(){let e=this.megatextures,t=e.length;for(let n=0;n<t;n++)e[n]=e[n]&&e[n].destroy();return this.internalNodeTexture=this.internalNodeTexture&&this.internalNodeTexture.destroy(),this.leafNodeTexture=this.leafNodeTexture&&this.leafNodeTexture.destroy(),ue(this)};function kAe(e,t){if(t.computeBoundingVolumes(e._primitive._shape),u(t.children))for(let n=0;n<8;n++){let i=t.children[n];kAe(e,i)}}function Qxt(e,t){if(e._simultaneousRequestCount>=v_.simultaneousRequestCountMaximum)return;let n=e._primitive._provider;function i(c){e._simultaneousRequestCount--;let l=n.types.length;if(!u(c))t.state=io.LoadState.UNAVAILABLE;else if(c===io.LoadState.FAILED)t.state=io.LoadState.FAILED;else if(!Array.isArray(c)||c.length!==l)t.state=io.LoadState.FAILED;else{let f=e.megatextures;for(let d=0;d<l;d++){let{voxelCountPerTile:p,channelCount:g}=f[d],{x:m,y,z:b}=p,C=m*y*b,A=c[d],T=C*g;if(A.length===T)t.metadata[d]=A,t.state=io.LoadState.RECEIVED;else{t.state=io.LoadState.FAILED;break}}}}function o(){e._simultaneousRequestCount--,t.state=io.LoadState.FAILED}let{keyframe:r,spatialNode:s}=t,a=n.requestData({tileLevel:s.level,tileX:s.x,tileY:s.y,tileZ:s.z,keyframe:r});u(a)?(e._simultaneousRequestCount++,t.state=io.LoadState.RECEIVING,a.then(i).catch(o)):t.state=io.LoadState.FAILED}function Jxt(e){return e/(1+e)}function ebt(e,t){let n=e._frameNumber,i=e._primitive,o=i._shape,r=i.screenSpaceError,s=e._priorityQueue,a=e._keyframeCount,c=R.clamp(Math.floor(e._keyframeLocation),0,a-2),l=c+1,{camera:f,context:d,pixelRatio:p}=t,{positionWC:g,frustum:m}=f,b=d.drawingBufferHeight/p/m.sseDenominator;function C(L,_){if(L.computeScreenSpaceError(g,b),_=L.visibility(t,_),_===bs.MASK_OUTSIDE)return;if(L.visitedFrameNumber=n,a===1)L.createKeyframeNode(0);else if(L.keyframeNodes.length!==a)for(let k=0;k<a;k++)L.createKeyframeNode(k);let{screenSpaceError:S,keyframeNodes:w}=L,I=Jxt(S),N=!1;for(let k=0;k<w.length;k++){let z=w[k];z.priority=10*I+tbt(c,z.keyframe,l,e),z.state!==io.LoadState.UNAVAILABLE&&z.state!==io.LoadState.FAILED&&z.priority!==-Number.MAX_VALUE&&s.insert(z),z.state===io.LoadState.LOADED&&(N=!0)}if(S<r||!N){L.children=void 0;return}u(L.children)||L.constructChildNodes(o);for(let k=0;k<8;k++){let z=L.children[k];C(z,_)}}s.reset(),C(e.rootNode,bs.MASK_INDETERMINATE);let A=e._highPriorityKeyframeNodes,T=0,E;for(;s.length>0;)E=s.removeMaximum(),E.highPriorityFrameNumber=n,A[T]=E,T++;let v=e._keyframeNodesInMegatexture,D=e.megatextures[0],O=D.occupiedCount;v.length=O,v.sort(function(L,_){return L.highPriorityFrameNumber===_.highPriorityFrameNumber?_.priority-L.priority:_.highPriorityFrameNumber-L.highPriorityFrameNumber});let P=0,M=0;for(let L=0;L<T;L++)if(E=A[L],!(E.state===io.LoadState.LOADED||E.spatialNode===void 0)&&(E.state===io.LoadState.UNLOADED&&Qxt(e,E),E.state===io.LoadState.RECEIVED)){let _=0;if(D.isFull()){_=O-1-P,P++;let S=v[_];S.spatialNode.destroyKeyframeNode(S,e.megatextures)}else _=O+M,M++;E.spatialNode.addKeyframeNodeToMegatextures(E,e.megatextures),v[_]=E}}function tbt(e,t,n,i){let o=Math.min(Math.abs(t-e),Math.abs(t-n)),r=Math.max(e,i._keyframeCount-n-1,1),s=Math.pow(1-o/r,4),a=Math.exp(-i._binaryTreeKeyframeWeighting[t]);return R.lerp(a,s,.15+.85*s)}function nbt(e,t,n,i){let o=e._keyframeCount,r=e.rootNode,s=Object.keys(io.LoadState).length,a=new Array(s),c=new Array(s),l=0;for(let C=0;C<s;C++){let A=new Array(o);a[C]=A;for(let T=0;T<o;T++)A[T]=0;c[C]=0}function f(C){let A=C.keyframeNodes;for(let T=0;T<A.length;T++){let E=A[T],v=E.keyframe,D=E.state;a[D][v]+=1,c[D]+=1,l++}if(u(C.children))for(let T=0;T<8;T++){let E=C.children[T];f(E)}}f(r);let d=`KEYFRAMES: ${a[io.LoadState.LOADED]}`,p=`UNLOADED: ${c[io.LoadState.UNLOADED]} | RECEIVING: ${c[io.LoadState.RECEIVING]} | RECEIVED: ${c[io.LoadState.RECEIVED]} | LOADED: ${c[io.LoadState.LOADED]} | FAILED: ${c[io.LoadState.FAILED]} | UNAVAILABLE: ${c[io.LoadState.UNAVAILABLE]} | TOTAL: ${l}`,g=Math.round(t*100)/100,m=Math.round(n*100)/100,y=Math.round(i*100)/100,b=`LOAD: ${g} | OCT: ${m} | ALL: ${y}`;console.log(`${d} || ${p} || ${b}`)}var a5={INTERNAL:0,LEAF:1,PACKED_LEAF_FROM_PARENT:2};function ibt(e,t,n){let i=e._primitive._screenSpaceError,o=e._keyframeLocation,r=e._frameNumber,s=t>=2,a=0,c=0,l=[],f=[];function d(g,m,y,b,C){let A=!1;if(u(g.children))for(let T=0;T<8;T++){let E=g.children[T];E.computeSurroundingRenderableKeyframeNodes(o),E.isRenderable(r)&&(A=!0)}if(A){l[C]=a5.INTERNAL<<16|m,l[y]=b,a++,b=m,C=b*9+1;for(let T=0;T<8;T++){let E=g.children[T];m=a,y=m*9+0,d(E,m,y,b,C+T)}}else{if(s){let T=c*5,E=g.renderableKeyframeNodePrevious,v=g.level-E.spatialNode.level,D=E.spatialNode.parent,O=u(D)?D.renderableKeyframeNodePrevious:E,P=obt(g,i,n),M=v,L=1,_=E.megatextureIndex,S=O.megatextureIndex;f[T+0]=P,f[T+1]=M,f[T+2]=L,f[T+3]=_,f[T+4]=S,l[C]=a5.LEAF<<16|c}else{let T=g.renderableKeyframeNodePrevious,v=g.level-T.spatialNode.level===0?a5.LEAF:a5.PACKED_LEAF_FROM_PARENT;l[C]=v<<16|T.megatextureIndex}c++}}let p=e.rootNode;p.computeSurroundingRenderableKeyframeNodes(o),p.isRenderable(r)&&d(p,0,0,0,0),rbt(l,9,e.internalNodeTilesPerRow,e.internalNodeTexture),s&&sbt(f,2,e.leafNodeTilesPerRow,e.leafNodeTexture)}function obt(e,t,n){if(e.parent===void 0)return 0;let i=e.screenSpaceError,o=e.parent.screenSpaceError,s=((t-i)/(o-i)+n-1)/n;return R.clamp(s,0,1)}function rbt(e,t,n,i){let o=tt.componentsLength(i.pixelFormat),r=Math.ceil(e.length/t),s=Math.max(1,t*Math.min(r,n)),a=Math.max(1,Math.ceil(r/n)),c=new Uint8Array(s*a*o);for(let d=0;d<e.length;d++){let p=e[d],g=d*o;for(let m=0;m<o;m++)c[g+m]=p>>>m*8&255}let f={source:{arrayBufferView:c,width:s,height:a},xOffset:0,yOffset:0};i.copyFrom(f)}function sbt(e,t,n,i){let o=tt.componentsLength(i.pixelFormat),r=5,s=Math.ceil(e.length/r),a=Math.max(1,t*Math.min(s,n)),c=Math.max(1,Math.ceil(s/n)),l=new Uint8Array(a*c*o);for(let p=0;p<s;p++){let g=e[p*r+0],m=e[p*r+1],y=e[p*r+2],b=e[p*r+3],C=e[p*r+4],A=R.clamp(Math.floor(65536*g),0,65535);l[p*8+0]=A>>>0&255,l[p*8+1]=A>>>8&255,l[p*8+2]=m&255,l[p*8+3]=y&255,l[p*8+4]=b>>>0&255,l[p*8+5]=b>>>8&255,l[p*8+6]=C>>>0&255,l[p*8+7]=C>>>8&255}let d={source:{arrayBufferView:l,width:a,height:c},xOffset:0,yOffset:0};i.copyFrom(d)}v_.getApproximateTextureMemoryByteLength=function(e,t,n,i){let o=0,r=n.length;for(let s=0;s<r;s++){let a=n[s],c=i[s],l=Et.getComponentCount(a);o+=hI.getApproximateTextureMemoryByteLength(e,t,l,c)}return o};var pI=v_;var abt={FLOAT:"float",VEC2:"vec2",VEC3:"vec3",VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",MAT2:"mat2",MAT3:"mat3",MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},_I=Object.freeze(abt);function dS(){this._defaultTexture=void 0,this._textures={},this._loadedImages=[],this._lastUpdatedFrame=-1}dS.prototype.getTexture=function(e){return this._textures[e]};function cbt(e,t,n){n.resource.fetchImage().then(function(i){e._loadedImages.push({id:t,image:i,textureUniform:n})}).catch(function(){let i=e._textures[t];u(i)&&i!==e._defaultTexture&&i.destroy(),e._textures[t]=e._defaultTexture})}dS.prototype.loadTexture2D=function(e,t){u(t.typedArray)?this._loadedImages.push({id:e,textureUniform:t}):cbt(this,e,t)};function lbt(e,t,n){let{id:i,textureUniform:o,image:r}=t,s=n.webgl2?c5(o,r,n):ubt(o,r,n),a=e._textures[i];u(a)&&a!==n.defaultTexture&&a.destroy(),e._textures[i]=s}function c5(e,t,n){let{typedArray:i,sampler:o}=e,r=u(i)?UAe(e,n):new Ot({context:n,source:t,sampler:o});return VAe(o)&&r.generateMipmap(),r}function ubt(e,t,n){let{typedArray:i,sampler:o}=e,r=VAe(o),s=o.wrapS===En.REPEAT||o.wrapS===En.MIRRORED_REPEAT||o.wrapT===En.REPEAT||o.wrapT===En.MIRRORED_REPEAT,{width:a,height:c}=u(i)?e:t,l=[a,c].every(R.isPowerOfTwo);if((r||s)&&!l)if(u(i)){if(e.pixelDatatype===Ke.UNSIGNED_BYTE){let d=XV(i,a,c),p=sx(d);return c5({sampler:o},p,n)}}else{let d=sx(t);return c5(e,d,n)}else return c5(e,t,n);return r?console.warn("Texture requires resizing for mipmaps but pixelDataType cannot be resized. The texture may be rendered incorrectly."):s&&console.warn("Texture requires resizing for wrapping but pixelDataType cannot be resized. The texture may be rendered incorrectly."),UAe(e,n)}function VAe(e){return[$t.NEAREST_MIPMAP_NEAREST,$t.NEAREST_MIPMAP_LINEAR,$t.LINEAR_MIPMAP_NEAREST,$t.LINEAR_MIPMAP_LINEAR].includes(e.minificationFilter)}function UAe(e,t){let{pixelFormat:n,pixelDatatype:i,width:o,height:r,typedArray:s,sampler:a}=e;return new Ot({context:t,pixelFormat:n,pixelDatatype:i,source:{arrayBufferView:s,width:o,height:r},sampler:a,flipY:!1})}dS.prototype.update=function(e){if(e.frameNumber===this._lastUpdatedFrame)return;this._lastUpdatedFrame=e.frameNumber;let t=e.context;this._defaultTexture=t.defaultTexture;let n=this._loadedImages;for(let i=0;i<n.length;i++){let o=n[i];lbt(this,o,t)}n.length=0};dS.prototype.isDestroyed=function(){return!1};dS.prototype.destroy=function(){let e=this._textures;for(let t in e)if(e.hasOwnProperty(t)){let n=e[t];n!==this._defaultTexture&&n.destroy()}return ue(this)};var l5=dS;function gI(e){e=x(e,x.EMPTY_OBJECT),this.mode=x(e.mode,Ng.MODIFY_MATERIAL),this.lightingModel=e.lightingModel,this.uniforms=x(e.uniforms,x.EMPTY_OBJECT),this.varyings=x(e.varyings,x.EMPTY_OBJECT),this.vertexShaderText=e.vertexShaderText,this.fragmentShaderText=e.fragmentShaderText,this.translucencyMode=x(e.translucencyMode,xx.INHERIT),this._textureManager=new l5,this._defaultTexture=void 0,this.uniformMap=fbt(this),this.usedVariablesVertex={attributeSet:{},featureIdSet:{},metadataSet:{}},this.usedVariablesFragment={attributeSet:{},featureIdSet:{},metadataSet:{},materialSet:{}},mbt(this),pbt(this)}function fbt(e){let t=e.uniforms,n={};for(let i in t)if(t.hasOwnProperty(i)){let o=t[i];o.type===_I.SAMPLER_2D?(e._textureManager.loadTexture2D(i,o.value),n[i]=dbt(e,i)):n[i]=hbt(e,i)}return n}function dbt(e,t){return function(){return x(e._textureManager.getTexture(t),e._defaultTexture)}}function hbt(e,t){return function(){return e.uniforms[t].value}}function Mb(e,t,n){let i;for(;(i=t.exec(e))!==null;){let o=i[1];n[o]=!0}}function mbt(e){let t=/[vf]sInput\.attributes\.(\w+)/g,n=/[vf]sInput\.featureIds\.(\w+)/g,i=/[vf]sInput\.metadata.(\w+)/g,o,r=e.vertexShaderText;u(r)&&(o=e.usedVariablesVertex.attributeSet,Mb(r,t,o),o=e.usedVariablesVertex.featureIdSet,Mb(r,n,o),o=e.usedVariablesVertex.metadataSet,Mb(r,i,o));let s=e.fragmentShaderText;if(u(s)){o=e.usedVariablesFragment.attributeSet,Mb(s,t,o),o=e.usedVariablesFragment.featureIdSet,Mb(s,n,o),o=e.usedVariablesFragment.metadataSet,Mb(s,i,o);let a=/material\.(\w+)/g,c=e.usedVariablesFragment.materialSet;Mb(s,a,c)}}function zAe(e){let t=/^.*MC$/,n=/^.*WC$/,i=/^.*EC$/;return t.test(e)?`${e} (model coordinates)`:n.test(e)?`${e} (Cartesian world coordinates)`:i.test(e)?`${e} (eye coordinates)`:e}function pc(e,t,n,i){if(e.hasOwnProperty(t)){let o=`${zAe(t)} is not available in the ${i} shader. Did you mean ${zAe(n)} instead?`;throw new he(o)}}function pbt(e){let t=e.usedVariablesVertex.attributeSet;pc(t,"position","positionMC","vertex"),pc(t,"normal","normalMC","vertex"),pc(t,"tangent","tangentMC","vertex"),pc(t,"bitangent","bitangentMC","vertex"),pc(t,"positionWC","positionMC","vertex"),pc(t,"positionEC","positionMC","vertex"),pc(t,"normalEC","normalMC","vertex"),pc(t,"tangentEC","tangentMC","vertex"),pc(t,"bitangentEC","bitangentMC","vertex");let n=e.usedVariablesFragment.attributeSet;pc(n,"position","positionEC","fragment"),pc(n,"normal","normalEC","fragment"),pc(n,"tangent","tangentEC","fragment"),pc(n,"bitangent","bitangentEC","fragment"),pc(n,"normalMC","normalEC","fragment"),pc(n,"tangentMC","tangentEC","fragment"),pc(n,"bitangentMC","bitangentEC","fragment")}gI.prototype.setUniform=function(e,t){let n=this.uniforms[e];n.type===_I.SAMPLER_2D?this._textureManager.loadTexture2D(e,t):u(t.clone)?n.value=t.clone(n.value):n.value=t};gI.prototype.update=function(e){this._defaultTexture=e.context.defaultTexture,this._textureManager.update(e)};gI.prototype.isDestroyed=function(){return!1};gI.prototype.destroy=function(){this._textureManager=this._textureManager&&this._textureManager.destroy(),ue(this)};var hS=gI;function Hm(e){e=x(e,x.EMPTY_OBJECT),this._ready=!1,this._provider=x(e.provider,Hm.DefaultProvider),this._traversal=void 0,this._shape=void 0,this._shapeVisible=!1,this._paddingBefore=new h,this._paddingAfter=new h,this._minBounds=new h,this._minBoundsOld=new h,this._maxBounds=new h,this._maxBoundsOld=new h,this._exaggeratedMinBounds=new h,this._exaggeratedMinBoundsOld=new h,this._exaggeratedMaxBounds=new h,this._exaggeratedMaxBoundsOld=new h,this._minClippingBounds=new h,this._minClippingBoundsOld=new h,this._maxClippingBounds=new h,this._maxClippingBoundsOld=new h,this._clippingPlanes=void 0,this._clippingPlanesState=0,this._clippingPlanesEnabled=!1,this._modelMatrix=F.clone(x(e.modelMatrix,F.IDENTITY)),this._exaggeratedModelMatrix=F.clone(this._modelMatrix),this._compoundModelMatrix=new F,this._compoundModelMatrixOld=new F,this._customShader=x(e.customShader,Hm.DefaultCustomShader),this._customShaderCompilationEvent=new me,this._shaderDirty=!0,this._drawCommand=void 0,this._drawCommandPick=void 0,this._pickId=void 0,this._clock=e.clock,this._transformPositionWorldToUv=new F,this._transformPositionUvToWorld=new F,this._transformDirectionWorldToLocal=new J,this._transformNormalLocalToWorld=new J,this._nearestSampling=!1,this._levelBlendFactor=0,this._stepSizeMultiplier=1,this._depthTest=!0,this._useLogDepth=void 0,this._screenSpaceError=4,this._debugPolylines=new im,this._debugDraw=!1,this._disableRender=!1,this._disableUpdate=!1,this._uniforms={octreeInternalNodeTexture:void 0,octreeInternalNodeTilesPerRow:0,octreeInternalNodeTexelSizeUv:new H,octreeLeafNodeTexture:void 0,octreeLeafNodeTilesPerRow:0,octreeLeafNodeTexelSizeUv:new H,megatextureTextures:[],megatextureSliceDimensions:new H,megatextureTileDimensions:new H,megatextureVoxelSizeUv:new H,megatextureSliceSizeUv:new H,megatextureTileSizeUv:new H,dimensions:new h,paddingBefore:new h,paddingAfter:new h,transformPositionViewToUv:new F,transformPositionUvToView:new F,transformDirectionViewToLocal:new J,transformNormalLocalToWorld:new J,cameraPositionUv:new h,ndcSpaceAxisAlignedBoundingBox:new oe,clippingPlanesTexture:void 0,clippingPlanesMatrix:new F,stepSize:0,pickColor:new G},this._shapeDefinesOld={},this._uniformMap={};let t=this._uniforms,n=this._uniformMap;for(let o in t)if(t.hasOwnProperty(o)){let r=`u_${o}`;n[r]=function(){return t[o]}}let i=this._provider;_bt(this,i)}function _bt(e,t){let{shape:n,minBounds:i=zi.getMinBounds(n),maxBounds:o=zi.getMaxBounds(n)}=t;e.minBounds=i,e.maxBounds=o,e.minClippingBounds=zi.getMinBounds(n),e.maxClippingBounds=zi.getMaxBounds(n),e._exaggeratedMinBounds=h.clone(e._minBounds,e._exaggeratedMinBounds),e._exaggeratedMaxBounds=h.clone(e._maxBounds,e._exaggeratedMaxBounds),e._exaggeratedModelMatrix=F.clone(e._modelMatrix,e._exaggeratedModelMatrix),GAe(e,t);let r=zi.getShapeConstructor(n);e._shape=new r,e._shapeVisible=WAe(e,e._shape,t)}Object.defineProperties(Hm.prototype,{ready:{get:function(){return this._ready}},provider:{get:function(){return this._provider}},boundingSphere:{get:function(){return this._shape.boundingSphere}},orientedBoundingBox:{get:function(){return this._shape.orientedBoundingBox}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix=F.clone(e,this._modelMatrix)}},shape:{get:function(){return this._provider.shape}},dimensions:{get:function(){return this._provider.dimensions}},minimumValues:{get:function(){return this._provider.minimumValues}},maximumValues:{get:function(){return this._provider.maximumValues}},show:{get:function(){return!this._disableRender},set:function(e){this._disableRender=!e}},disableUpdate:{get:function(){return this._disableUpdate},set:function(e){this._disableUpdate=e}},debugDraw:{get:function(){return this._debugDraw},set:function(e){this._debugDraw=e}},depthTest:{get:function(){return this._depthTest},set:function(e){this._depthTest!==e&&(this._depthTest=e,this._shaderDirty=!0)}},nearestSampling:{get:function(){return this._nearestSampling},set:function(e){this._nearestSampling!==e&&(this._nearestSampling=e,this._shaderDirty=!0)}},levelBlendFactor:{get:function(){return this._levelBlendFactor},set:function(e){this._levelBlendFactor=R.clamp(e,0,1)}},screenSpaceError:{get:function(){return this._screenSpaceError},set:function(e){this._screenSpaceError=e}},stepSize:{get:function(){return this._stepSizeMultiplier},set:function(e){this._stepSizeMultiplier=e}},minBounds:{get:function(){return this._minBounds},set:function(e){this._minBounds=h.clone(e,this._minBounds)}},maxBounds:{get:function(){return this._maxBounds},set:function(e){this._maxBounds=h.clone(e,this._maxBounds)}},minClippingBounds:{get:function(){return this._minClippingBounds},set:function(e){this._minClippingBounds=h.clone(e,this._minClippingBounds)}},maxClippingBounds:{get:function(){return this._maxClippingBounds},set:function(e){this._maxClippingBounds=h.clone(e,this._maxClippingBounds)}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){As.setOwner(e,this,"_clippingPlanes")}},customShader:{get:function(){return this._customShader},set:function(e){if(this._customShader!==e){let t=this._uniformMap,i=this._customShader.uniformMap;for(let o in i)i.hasOwnProperty(o)&&delete t[o];u(e)?this._customShader=e:this._customShader=Hm.DefaultCustomShader,this._shaderDirty=!0}}},customShaderCompilationEvent:{get:function(){return this._customShaderCompilationEvent}}});var gbt=new h,ybt=new oe,xbt=new oe,bbt=new h,Cbt=new h,Abt=new J,Tbt=new J,Ebt=new F,Sbt=new F,vbt=new F,wbt=F.fromRotationTranslation(J.fromUniformScale(.5,new J),new h(.5,.5,.5),new F),Dbt=F.fromRotationTranslation(J.fromUniformScale(2,new J),new h(-1,-1,-1),new F);Hm.prototype.update=function(e){let t=this._provider;this._customShader.update(e);let n=e.context;if(!this._ready){Lbt(this,t,n),e.afterRender.push(()=>(this._ready=!0,!0));return}Obt(this,e);let i=GAe(this,t),o=this._shape;if(i&&(this._shapeVisible=WAe(this,o,t),Bbt(this,o)&&(this._shaderDirty=!0)),!this._shapeVisible)return;let r=kbt(t.timeIntervalCollection,this._clock),s=this._traversal,a=s._sampleCount;if(s.update(e,r,i,this._disableUpdate),a!==s._sampleCount&&(this._shaderDirty=!0),!s.isRenderable(s.rootNode)||(this._debugDraw&&qbt(this,e),this._disableRender))return;this._useLogDepth!==e.useLogDepth&&(this._useLogDepth=e.useLogDepth,this._shaderDirty=!0),Vbt(this,e)&&(this._shaderDirty=!0);let l=s.leafNodeTexture,f=this._uniforms;u(l)&&(f.octreeLeafNodeTexture=s.leafNodeTexture,f.octreeLeafNodeTexelSizeUv=H.clone(s.leafNodeTexelSizeUv,f.octreeLeafNodeTexelSizeUv),f.octreeLeafNodeTilesPerRow=s.leafNodeTilesPerRow),this._shaderDirty&&(i5(this,n),this._shaderDirty=!1);let d=n.uniformState.viewProjection,p=o.orientedBoundingBox,g=Hbt(p,d,xbt);if(g.x===1||g.y===1||g.z===-1||g.w===-1)return;f.ndcSpaceAxisAlignedBoundingBox=oe.clone(g,f.ndcSpaceAxisAlignedBoundingBox);let y=n.uniformState.inverseView;f.transformPositionViewToUv=F.multiplyTransformation(this._transformPositionWorldToUv,y,f.transformPositionViewToUv);let b=n.uniformState.view;f.transformPositionUvToView=F.multiplyTransformation(b,this._transformPositionUvToWorld,f.transformPositionUvToView);let C=n.uniformState.inverseViewRotation;f.transformDirectionViewToLocal=J.multiply(this._transformDirectionWorldToLocal,C,f.transformDirectionViewToLocal),f.transformNormalLocalToWorld=J.clone(this._transformNormalLocalToWorld,f.transformNormalLocalToWorld);let A=e.camera.positionWC;f.cameraPositionUv=F.multiplyByPoint(this._transformPositionWorldToUv,A,f.cameraPositionUv),f.stepSize=this._stepSizeMultiplier;let T=e.passes.pick?this._drawCommandPick:e.passes.pickVoxel?this._drawCommandPickVoxel:this._drawCommand;T.boundingVolume=o.boundingSphere,e.commandList.push(T)};var Ibt=new h,TZ=new h,Pbt=new de,Rbt=new h;function Obt(e,t){if(e._exaggeratedMinBounds=h.clone(e._minBounds,e._exaggeratedMinBounds),e._exaggeratedMaxBounds=h.clone(e._maxBounds,e._exaggeratedMaxBounds),e.shape===zi.ELLIPSOID){let n=t.verticalExaggerationRelativeHeight,i=t.verticalExaggeration;e._exaggeratedMinBounds.z=(e._minBounds.z-n)*i+n,e._exaggeratedMaxBounds.z=(e._maxBounds.z-n)*i+n}else if(e.shape===zi.BOX){let n=h.fromElements(1,1,t.verticalExaggeration,Ibt);e._exaggeratedModelMatrix=F.multiplyByScale(e._modelMatrix,n,e._exaggeratedModelMatrix),e._exaggeratedModelMatrix=F.multiplyByTranslation(e._exaggeratedModelMatrix,Mbt(e,t),e._exaggeratedModelMatrix)}}function Mbt(e,t){let{shapeTransform:n=F.IDENTITY,globalTransform:i=F.IDENTITY}=e._provider,o=F.getTranslation(n,TZ),r=F.multiplyByPoint(e._modelMatrix,o,TZ),s=F.multiplyByPoint(i,r,TZ),c=ee.WGS84.cartesianToCartographic(s,Pbt),l=0;u(c)&&(l=c.height);let f=Mr.getHeight(l,t.verticalExaggeration,t.verticalExaggerationRelativeHeight);return h.fromElements(0,0,(f-l)/t.verticalExaggeration,Rbt)}function Lbt(e,t,n){let i=e._uniforms;e._pickId=n.createPickId({primitive:e}),i.pickColor=G.clone(e._pickId.color,i.pickColor);let{shaderDefines:o,shaderUniforms:r}=e._shape;e._shapeDefinesOld=Ge(o,!0);let s=e._uniformMap;for(let a in r)if(r.hasOwnProperty(a)){let c=`u_${a}`;s[c]=function(){return r[a]}}i.dimensions=h.clone(t.dimensions,i.dimensions),e._paddingBefore=h.clone(x(t.paddingBefore,h.ZERO),e._paddingBefore),i.paddingBefore=h.clone(e._paddingBefore,i.paddingBefore),e._paddingAfter=h.clone(x(t.paddingAfter,h.ZERO),e._paddingBefore),i.paddingAfter=h.clone(e._paddingAfter,i.paddingAfter),e._traversal=Nbt(e,t,n),Fbt(e._traversal,i)}function GAe(e,t){let n=x(t.shapeTransform,F.IDENTITY),i=x(t.globalTransform,F.IDENTITY);return F.multiplyTransformation(i,e._exaggeratedModelMatrix,e._compoundModelMatrix),F.multiplyTransformation(e._compoundModelMatrix,n,e._compoundModelMatrix),Lb(e,"_compoundModelMatrix","_compoundModelMatrixOld")+Lb(e,"_minBounds","_minBoundsOld")+Lb(e,"_maxBounds","_maxBoundsOld")+Lb(e,"_exaggeratedMinBounds","_exaggeratedMinBoundsOld")+Lb(e,"_exaggeratedMaxBounds","_exaggeratedMaxBoundsOld")+Lb(e,"_minClippingBounds","_minClippingBoundsOld")+Lb(e,"_maxClippingBounds","_maxClippingBoundsOld")>0}function Lb(e,t,n){let i=e[t],o=e[n],r=!i.equals(o);return r&&i.clone(o),r?1:0}function WAe(e,t,n){if(!t.update(e._compoundModelMatrix,e._exaggeratedMinBounds,e._exaggeratedMaxBounds,e.minClippingBounds,e.maxClippingBounds))return!1;let o=t.shapeTransform,r=F.inverse(o,Ebt),s=F.getRotation(o,Abt),a=F.getScale(o,bbt),c=h.maximumComponent(a),l=h.divideByScalar(a,c,Cbt),f=J.multiplyByScale(s,l,Tbt);return e._transformPositionWorldToUv=F.multiplyTransformation(wbt,r,e._transformPositionWorldToUv),e._transformPositionUvToWorld=F.multiplyTransformation(o,Dbt,e._transformPositionUvToWorld),e._transformDirectionWorldToLocal=F.getMatrix3(r,e._transformDirectionWorldToLocal),e._transformNormalLocalToWorld=J.inverseTranspose(f,e._transformNormalLocalToWorld),!0}function Nbt(e,t,n){let i=h.clone(t.dimensions,gbt);h.add(i,e._paddingBefore,i),h.add(i,e._paddingAfter,i);let o=t.maximumTileCount,r=u(o)?pI.getApproximateTextureMemoryByteLength(o,i,t.types,t.componentTypes):void 0,s=x(t.keyframeCount,1);return new pI(e,n,i,t.types,t.componentTypes,s,r)}function Fbt(e,t){t.octreeInternalNodeTexture=e.internalNodeTexture,t.octreeInternalNodeTexelSizeUv=H.clone(e.internalNodeTexelSizeUv,t.octreeInternalNodeTexelSizeUv),t.octreeInternalNodeTilesPerRow=e.internalNodeTilesPerRow;let n=e.megatextures,i=n[0],o=n.length;t.megatextureTextures=new Array(o);for(let r=0;r<o;r++)t.megatextureTextures[r]=n[r].texture;t.megatextureSliceDimensions=H.clone(i.sliceCountPerRegion,t.megatextureSliceDimensions),t.megatextureTileDimensions=H.clone(i.regionCountPerMegatexture,t.megatextureTileDimensions),t.megatextureVoxelSizeUv=H.clone(i.voxelSizeUv,t.megatextureVoxelSizeUv),t.megatextureSliceSizeUv=H.clone(i.sliceSizeUv,t.megatextureSliceSizeUv),t.megatextureTileSizeUv=H.clone(i.regionSizeUv,t.megatextureTileSizeUv)}function Bbt(e,t){let n=t.shaderDefines,i=Object.keys(n).some(o=>n[o]!==e._shapeDefinesOld[o]);return i&&(e._shapeDefinesOld=Ge(n,!0)),i}function kbt(e,t){if(!u(e)||!u(t))return 0;let n=t.currentTime,i,o=e.indexOf(n);o>=0?i=e.get(o):(o=~o,o===e.length?(o=e.length-1,i=e.get(o),n=i.stop):(i=e.get(o),n=i.start));let r=$.secondsDifference(i.stop,i.start),a=$.secondsDifference(n,i.start)/r;return o+a}function Vbt(e,t){let n=e.clippingPlanes;if(!u(n))return!1;n.update(t);let{clippingPlanesState:i,enabled:o}=n;if(o){let r=e._uniforms;r.clippingPlanesTexture=n.texture,r.clippingPlanesMatrix=F.transpose(F.multiplyTransformation(F.inverse(n.modelMatrix,r.clippingPlanesMatrix),e._transformPositionUvToWorld,r.clippingPlanesMatrix),r.clippingPlanesMatrix)}return e._clippingPlanesState===i&&e._clippingPlanesEnabled===o?!1:(e._clippingPlanesState=i,e._clippingPlanesEnabled=o,!0)}Hm.prototype.isDestroyed=function(){return!1};Hm.prototype.destroy=function(){let e=this._drawCommand;u(e)&&(e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy());let t=this._drawCommandPick;return u(t)&&(t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy()),this._pickId=this._pickId&&this._pickId.destroy(),this._traversal=this._traversal&&this._traversal.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),ue(this)};var HAe=new Array(new oe(-1,-1,-1,1),new oe(1,-1,-1,1),new oe(-1,1,-1,1),new oe(1,1,-1,1),new oe(-1,-1,1,1),new oe(1,-1,1,1),new oe(-1,1,1,1),new oe(1,1,1,1)),Ubt=new Array(1,2,4,0,3,5,0,3,6,1,2,7,0,5,6,1,4,7,2,4,7,3,5,6),zbt=new Array(new oe,new oe,new oe,new oe,new oe,new oe,new oe,new oe);function Hbt(e,t,n){let i=F.fromRotationTranslation(e.halfAxes,e.center,Sbt),o=F.multiply(t,i,vbt),r=+Number.MAX_VALUE,s=-Number.MAX_VALUE,a=+Number.MAX_VALUE,c=-Number.MAX_VALUE,l,f=zbt,d=HAe.length;for(l=0;l<d;l++)F.multiplyByVector(o,HAe[l],f[l]);for(l=0;l<d;l++){let p=f[l];if(p.z>=-p.w){let g=p.x/p.w,m=p.y/p.w;r=Math.min(r,g),s=Math.max(s,g),a=Math.min(a,m),c=Math.max(c,m)}else for(let g=0;g<3;g++){let m=Ubt[l*3+g],y=f[m];if(y.z>=-y.w){let b=p.z+p.w,C=y.z+y.w,A=b/(b-C),T=oe.lerp(p,y,A,ybt),E=T.x/T.w,v=T.y/T.w;r=Math.min(r,E),s=Math.max(s,E),a=Math.min(a,v),c=Math.max(c,v)}}}return r=R.clamp(r,-1,1),a=R.clamp(a,-1,1),s=R.clamp(s,-1,1),c=R.clamp(c,-1,1),n=oe.fromElements(r,a,s,c,n),n}var EZ=3e7,Gbt=new h(EZ,0,0),Wbt=new h(0,EZ,0),jbt=new h(0,0,EZ);function qbt(e,t){let n=e._traversal,i=e._debugPolylines;i.removeAll();function o(c,l,f,d){i.add({positions:[c,l],width:d,material:Zi.fromType("Color",{color:f})})}function r(c,l,f){let d=c.computeCorners();o(d[0],d[1],l,f),o(d[2],d[3],l,f),o(d[4],d[5],l,f),o(d[6],d[7],l,f),o(d[0],d[2],l,f),o(d[4],d[6],l,f),o(d[1],d[3],l,f),o(d[5],d[7],l,f),o(d[0],d[4],l,f),o(d[2],d[6],l,f),o(d[1],d[5],l,f),o(d[3],d[7],l,f)}function s(c){if(!n.isRenderable(c))return;let l=c.level,d=Math.max(1,5/Math.pow(2,l)),g=[G.RED,G.LIME,G.BLUE][l%3];if(r(c.orientedBoundingBox,g,d),u(c.children))for(let m=0;m<8;m++)s(c.children[m])}r(e._shape.orientedBoundingBox,G.WHITE,5),s(n.rootNode);let a=10;o(h.ZERO,Gbt,G.RED,a),o(h.ZERO,Wbt,G.LIME,a),o(h.ZERO,jbt,G.BLUE,a),i.update(t)}Hm.DefaultCustomShader=new hS({fragmentShaderText:`void fragmentMain(FragmentInput fsInput, inout czm_modelMaterial material)
{
    material.diffuse = vec3(1.0);
    material.alpha = 1.0;
}`});function jAe(){this.ready=!0,this.shape=zi.BOX,this.dimensions=new h(1,1,1),this.names=["data"],this.types=[Et.SCALAR],this.componentTypes=[Gt.FLOAT32],this.maximumTileCount=1}jAe.prototype.requestData=function(e){if(!((u(e)?x(e.tileLevel,0):0)>=1))return Promise.resolve([new Float32Array(1)])};Hm.DefaultProvider=new jAe;var Nb=Hm;function Ybt(e,t,n,i){if(!u(e)||u(t)&&e.id!==t)return;let r=(e.classes||{})[n];if(!u(r))return;let a=(r.properties||{})[i];if(u(a))return a}var u5=Ybt;function Xbt(e,t,n,i){this.schemaId=e,this.className=t,this.propertyName=n,this.classProperty=i}var f5=Xbt;var h5=function(e){return function(){e.frameState.afterRender.push(function(){e.requestRender()})}};function ei(e){e=x(e,x.EMPTY_OBJECT);let t=e.canvas,n=e.creditContainer,i=e.creditViewport,o=Ge(e.contextOptions),r=u(n),s=new UM(t,o);r||(n=document.createElement("div"),n.style.position="absolute",n.style.bottom="0",n.style["text-shadow"]="0 0 2px #000000",n.style.color="#ffffff",n.style["font-size"]="10px",n.style["padding-right"]="5px",t.parentNode.appendChild(n)),u(i)||(i=t.parentNode),this._id=Hn(),this._jobScheduler=new Oz,this._frameState=new Iz(s,new bz(n,"\u2022",i),this._jobScheduler),this._frameState.scene3DOnly=x(e.scene3DOnly,!1),this._removeCreditContainer=!r,this._creditContainer=n,this._canvas=t,this._context=s,this._computeEngine=new UP(s),this._ellipsoid=x(e.ellipsoid,ee.default),this._globe=void 0,this._globeTranslucencyState=new Pz,this._primitives=new _u,this._groundPrimitives=new _u,this._globeHeight=void 0,this._globeHeightDirty=!0,this._cameraUnderground=!1,this._removeUpdateHeightCallback=void 0,this._logDepthBuffer=ei.defaultLogDepthBuffer&&s.fragmentDepth,this._logDepthBufferDirty=!0,this._tweens=new cS,this._shaderFrameCount=0,this._sunPostProcess=void 0,this._computeCommandList=[],this._overlayCommandList=[],this._useOIT=x(e.orderIndependentTranslucency,!0),this._executeOITFunction=void 0,this._depthPlane=new Sz(e.depthPlaneEllipsoidOffset),this._clearColorCommand=new ni({color:new G,stencil:0,owner:this}),this._depthClearCommand=new ni({depth:1,owner:this}),this._stencilClearCommand=new ni({stencil:0}),this._classificationStencilClearCommand=new ni({stencil:0,renderState:Ue.fromCache({stencilMask:Ut.CLASSIFICATION_MASK})}),this._depthOnlyRenderStateCache={},this._transitioner=new T8(this),this._preUpdate=new me,this._postUpdate=new me,this._renderError=new me,this._preRender=new me,this._postRender=new me,this._minimumDisableDepthTestDistance=0,this._debugInspector=new k8,this._msaaSamples=x(e.msaaSamples,4),this.rethrowRenderErrors=!1,this.completeMorphOnUserInput=!0,this.morphStart=new me,this.morphComplete=new me,this.skyBox=void 0,this.skyAtmosphere=void 0,this.sun=void 0,this.sunBloom=!0,this._sunBloom=void 0,this.moon=void 0,this.backgroundColor=G.clone(G.BLACK),this._mode=ne.SCENE3D,this._mapProjection=u(e.mapProjection)?e.mapProjection:new Oi(this._ellipsoid),this.morphTime=1,this.farToNearRatio=1e3,this.logarithmicDepthFarToNearRatio=1e9,this.nearToFarDistance2D=175e4,this.verticalExaggeration=1,this.verticalExaggerationRelativeHeight=0,this.debugCommandFilter=void 0,this.debugShowCommands=!1,this.debugShowFrustums=!1,this.debugShowFramesPerSecond=!1,this.debugShowDepthFrustum=1,this.debugShowFrustumPlanes=!1,this._debugShowFrustumPlanes=!1,this._debugFrustumPlanes=void 0,this.useDepthPicking=!0,this.pickTranslucentDepth=!1,this.cameraEventWaitTime=500,this.atmosphere=new AA,this.fog=new Dz,this.fog.enabled=ee.WGS84.equals(this._ellipsoid),ee.WGS84.equals(this._ellipsoid)||(uo.DEFAULT_VIEW_RECTANGLE=se.fromDegrees(-45,-45,45,45)),this._shadowMapCamera=new uo(this),this.shadowMap=new cy({context:s,lightCamera:this._shadowMapCamera,enabled:x(e.shadows,!1)}),this.invertClassification=!1,this.invertClassificationColor=G.clone(G.WHITE),this._actualInvertClassificationColor=G.clone(this._invertClassificationColor),this._invertClassification=new eI,this.focalLength=void 0,this.eyeSeparation=void 0,this.postProcessStages=new C8,this._brdfLutGenerator=new lz,this._performanceDisplay=void 0,this._debugVolume=void 0,this._screenSpaceCameraController=new L8(this),this._cameraUnderground=!1,this._mapMode2D=x(e.mapMode2D,Mu.INFINITE_SCROLL),this._environmentState={skyBoxCommand:void 0,skyAtmosphereCommand:void 0,sunDrawCommand:void 0,sunComputeCommand:void 0,moonCommand:void 0,isSunVisible:!1,isMoonVisible:!1,isReadyForAtmosphere:!1,isSkyAtmosphereVisible:!1,clearGlobeDepth:!1,useDepthPlane:!1,renderTranslucentDepthForPick:!1,originalFramebuffer:void 0,useGlobeDepthFramebuffer:!1,useOIT:!1,useInvertClassification:!1,usePostProcess:!1,usePostProcessSelected:!1,useWebVR:!1},this._useWebVR=!1,this._cameraVR=void 0,this._aspectRatioVR=void 0,this.requestRenderMode=x(e.requestRenderMode,!1),this._renderRequested=!0,this.maximumRenderTimeChange=x(e.maximumRenderTimeChange,0),this._lastRenderTime=void 0,this._frameRateMonitor=void 0,this._removeRequestListenerCallback=Cc.requestCompletedEvent.addEventListener(h5(this)),this._removeTaskProcessorListenerCallback=xi.taskCompletedEvent.addEventListener(h5(this)),this._removeGlobeCallbacks=[],this._removeTerrainProviderReadyListener=void 0;let a=new qe(0,0,s.drawingBufferWidth,s.drawingBufferHeight),c=new uo(this);this._logDepthBuffer&&(c.frustum.near=.1,c.frustum.far=1e10),this.preloadFlightCamera=new uo(this),this.preloadFlightCullingVolume=void 0,this._picking=new Jz(this),this._defaultView=new oS(this,c,a),this._view=this._defaultView,this._hdr=void 0,this._hdrDirty=void 0,this.highDynamicRange=!1,this.gamma=2.2,this.sphericalHarmonicCoefficients=void 0,this.specularEnvironmentMaps=void 0,this._specularEnvironmentCubeMap=void 0,this.light=new H_,ZAe(this,0,$.now()),this.updateFrameState(),this.initializeFrame()}ei.defaultLogDepthBuffer=!0;function Kbt(e,t){for(let i=0;i<e._removeGlobeCallbacks.length;++i)e._removeGlobeCallbacks[i]();e._removeGlobeCallbacks.length=0;let n=[];u(t)&&(n.push(t.imageryLayersUpdatedEvent.addEventListener(h5(e))),n.push(t.terrainProviderChanged.addEventListener(h5(e)))),e._removeGlobeCallbacks=n}Object.defineProperties(ei.prototype,{canvas:{get:function(){return this._canvas}},drawingBufferHeight:{get:function(){return this._context.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._context.drawingBufferWidth}},maximumAliasedLineWidth:{get:function(){return Vt.maximumAliasedLineWidth}},maximumCubeMapSize:{get:function(){return Vt.maximumCubeMapSize}},pickPositionSupported:{get:function(){return this._context.depthTexture}},sampleHeightSupported:{get:function(){return this._context.depthTexture}},clampToHeightSupported:{get:function(){return this._context.depthTexture}},invertClassificationSupported:{get:function(){return this._context.depthTexture}},specularEnvironmentMapsSupported:{get:function(){return kh.isSupported(this._context)}},ellipsoid:{get:function(){return this._ellipsoid}},globe:{get:function(){return this._globe},set:function(e){this._globe=this._globe&&this._globe.destroy(),this._globe=e,Kbt(this,e)}},primitives:{get:function(){return this._primitives}},groundPrimitives:{get:function(){return this._groundPrimitives}},camera:{get:function(){return this._view.camera},set:function(e){this._view.camera=e}},view:{get:function(){return this._view},set:function(e){this._view=e}},defaultView:{get:function(){return this._defaultView}},picking:{get:function(){return this._picking}},screenSpaceCameraController:{get:function(){return this._screenSpaceCameraController}},mapProjection:{get:function(){return this._mapProjection}},jobScheduler:{get:function(){return this._jobScheduler}},frameState:{get:function(){return this._frameState}},environmentState:{get:function(){return this._environmentState}},tweens:{get:function(){return this._tweens}},imageryLayers:{get:function(){if(u(this.globe))return this.globe.imageryLayers}},terrainProvider:{get:function(){if(u(this.globe))return this.globe.terrainProvider},set:function(e){this._removeTerrainProviderReadyListener=this._removeTerrainProviderReadyListener&&this._removeTerrainProviderReadyListener(),u(this.globe)&&(this.globe.terrainProvider=e)}},terrainProviderChanged:{get:function(){if(u(this.globe))return this.globe.terrainProviderChanged}},preUpdate:{get:function(){return this._preUpdate}},postUpdate:{get:function(){return this._postUpdate}},renderError:{get:function(){return this._renderError}},preRender:{get:function(){return this._preRender}},postRender:{get:function(){return this._postRender}},lastRenderTime:{get:function(){return this._lastRenderTime}},context:{get:function(){return this._context}},debugFrustumStatistics:{get:function(){return this._view.debugFrustumStatistics}},scene3DOnly:{get:function(){return this._frameState.scene3DOnly}},orderIndependentTranslucency:{get:function(){return this._useOIT}},id:{get:function(){return this._id}},mode:{get:function(){return this._mode},set:function(e){e===ne.SCENE2D?this.morphTo2D(0):e===ne.SCENE3D?this.morphTo3D(0):e===ne.COLUMBUS_VIEW&&this.morphToColumbusView(0),this._mode=e}},frustumCommandsList:{get:function(){return this._view.frustumCommandsList}},numberOfFrustums:{get:function(){return this._view.frustumCommandsList.length}},useWebVR:{get:function(){return this._useWebVR},set:function(e){this._useWebVR=e,this._useWebVR?(this._frameState.creditDisplay.container.style.visibility="hidden",this._cameraVR=new uo(this),u(this._deviceOrientationCameraController)||(this._deviceOrientationCameraController=new wz(this)),this._aspectRatioVR=this.camera.frustum.aspectRatio):(this._frameState.creditDisplay.container.style.visibility="visible",this._cameraVR=void 0,this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this.camera.frustum.aspectRatio=this._aspectRatioVR,this.camera.frustum.xOffset=0)}},mapMode2D:{get:function(){return this._mapMode2D}},splitPosition:{get:function(){return this._frameState.splitPosition},set:function(e){this._frameState.splitPosition=e}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance},set:function(e){this._minimumDisableDepthTestDistance=e}},logarithmicDepthBuffer:{get:function(){return this._logDepthBuffer},set:function(e){e=this._context.fragmentDepth&&e,this._logDepthBuffer!==e&&(this._logDepthBuffer=e,this._logDepthBufferDirty=!0)}},gamma:{get:function(){return this._context.uniformState.gamma},set:function(e){this._context.uniformState.gamma=e}},highDynamicRange:{get:function(){return this._hdr},set:function(e){let t=this._context,n=e&&t.depthTexture&&(t.colorBufferFloat||t.colorBufferHalfFloat);this._hdrDirty=n!==this._hdr,this._hdr=n}},highDynamicRangeSupported:{get:function(){let e=this._context;return e.depthTexture&&(e.colorBufferFloat||e.colorBufferHalfFloat)}},cameraUnderground:{get:function(){return this._cameraUnderground}},msaaSamples:{get:function(){return this._msaaSamples},set:function(e){e=Math.min(e,Vt.maximumSamples),this._msaaSamples=e}},msaaSupported:{get:function(){return this._context.msaa}},pixelRatio:{get:function(){return this._frameState.pixelRatio},set:function(e){this._frameState.pixelRatio=e}},opaqueFrustumNearOffset:{get:function(){return .9999}},globeHeight:{get:function(){return this._globeHeight}}});ei.prototype.getCompressedTextureFormatSupported=function(e){let t=this.context;return(e==="WEBGL_compressed_texture_s3tc"||e==="s3tc")&&t.s3tc||(e==="WEBGL_compressed_texture_pvrtc"||e==="pvrtc")&&t.pvrtc||(e==="WEBGL_compressed_texture_etc"||e==="etc")&&t.etc||(e==="WEBGL_compressed_texture_etc1"||e==="etc1")&&t.etc1||(e==="WEBGL_compressed_texture_astc"||e==="astc")&&t.astc||(e==="EXT_texture_compression_bptc"||e==="bc7")&&t.bc7};function Zbt(e,t){let n=e.pickedMetadataInfo,i=t.pickedMetadataInfo;return n?.schemaId!==i?.schemaId||n?.className!==i?.className||n?.propertyName!==i?.propertyName}function qAe(e,t,n){let i=e._frameState,o=e._context,r=e._view.oit,{lightShadowMaps:s,lightShadowsEnabled:a}=i.shadowState,c=t.derivedCommands;u(t.pickId)&&(c.picking=__.createPickDerivedCommand(e,t,o,c.picking)),i.pickingMetadata&&t.pickMetadataAllowed&&(t.pickedMetadataInfo=i.pickedMetadataInfo,u(t.pickedMetadataInfo)&&(c.pickingMetadata=__.createPickMetadataDerivedCommand(e,t,o,c.pickingMetadata))),t.pickOnly||(c.depth=__.createDepthOnlyDerivedCommand(e,t,o,c.depth)),c.originalCommand=t,e._hdr&&(c.hdr=__.createHdrCommand(t,o,c.hdr),t=c.hdr.command,c=t.derivedCommands),a&&t.receiveShadows&&(c.shadows=cy.createReceiveDerivedCommand(s,t,n,o,c.shadows)),t.pass===we.TRANSLUCENT&&u(r)&&r.isSupported()&&(a&&t.receiveShadows?(c.oit=u(c.oit)?c.oit:{},c.oit.shadows=r.createDerivedCommands(c.shadows.receiveCommand,o,c.oit.shadows)):c.oit=r.createDerivedCommands(t,o,c.oit))}ei.prototype.updateDerivedCommands=function(e){let{derivedCommands:t}=e;if(!u(t))return;let n=this._frameState,{shadowState:i,useLogDepth:o}=this._frameState,r=this._context,s=!1,a=i.lastDirtyTime;e.lastDirtyTime!==a&&(e.lastDirtyTime=a,e.dirty=!0,s=!0);let c=this._hdr,l=u(t.logDepth),f=u(t.hdr),d=u(t.originalCommand),p=o&&!l,g=c&&!f,m=(!o||!c)&&!d,y=n.pickingMetadata&&Zbt(e,n);if(e.dirty=e.dirty||p||g||m||y,!e.dirty)return;e.dirty=!1;let{shadowsEnabled:b,shadowMaps:C}=i;b&&e.castShadows&&(t.shadows=cy.createCastDerivedCommand(C,e,s,r,t.shadows)),(l||p)&&(t.logDepth=__.createLogDepthCommand(e,r,t.logDepth),qAe(this,t.logDepth.command,s)),(d||m)&&qAe(this,e,s)};var $bt=new lh({pass:Ho.RENDER}),SZ=new lh({pass:Ho.PRELOAD}),vZ=new lh({pass:Ho.PRELOAD_FLIGHT}),Qbt=new lh({pass:Ho.REQUEST_RENDER_MODE_DEFER_CHECK}),YAe=new ae,wZ;function Jbt(e){if(!(e._mode!==ne.SCENE3D||!e.globe?.show||e._cameraUnderground||e._globeTranslucencyState.translucent))return YAe.radius=e.ellipsoid.minimumRadius+e.frameState.minimumTerrainHeight,wZ=cU.fromBoundingSphere(YAe,e.camera.positionWC,wZ),wZ}ei.prototype.clearPasses=function(e){e.render=!1,e.pick=!1,e.pickVoxel=!1,e.depth=!1,e.postProcess=!1,e.offscreen=!1};function ZAe(e,t,n){let i=e._frameState;i.frameNumber=t,i.time=$.clone(n,i.time)}ei.prototype.updateFrameState=function(){let e=this.camera,t=this._frameState;t.commandList.length=0,t.shadowMaps.length=0,t.brdfLutGenerator=this._brdfLutGenerator,t.environmentMap=this.skyBox&&this.skyBox._cubeMap,t.mode=this._mode,t.morphTime=this.morphTime,t.mapProjection=this.mapProjection,t.camera=e,t.cullingVolume=e.frustum.computeCullingVolume(e.positionWC,e.directionWC,e.upWC),t.occluder=Jbt(this),t.minimumTerrainHeight=0,t.minimumDisableDepthTestDistance=this._minimumDisableDepthTestDistance,t.invertClassification=this.invertClassification,t.useLogDepth=this._logDepthBuffer&&!(this.camera.frustum instanceof sn||this.camera.frustum instanceof Gr),t.light=this.light,t.cameraUnderground=this._cameraUnderground,t.globeTranslucencyState=this._globeTranslucencyState;let{globe:n}=this;u(n)&&n._terrainExaggerationChanged&&(this.verticalExaggeration=n._terrainExaggeration,this.verticalExaggerationRelativeHeight=n._terrainExaggerationRelativeHeight,n._terrainExaggerationChanged=!1),t.verticalExaggeration=this.verticalExaggeration,t.verticalExaggerationRelativeHeight=this.verticalExaggerationRelativeHeight,u(this._specularEnvironmentCubeMap)&&this._specularEnvironmentCubeMap.ready?(t.specularEnvironmentMaps=this._specularEnvironmentCubeMap.texture,t.specularEnvironmentMapsMaximumLOD=this._specularEnvironmentCubeMap.maximumMipmapLevel):(t.specularEnvironmentMaps=void 0,t.specularEnvironmentMapsMaximumLOD=void 0),t.sphericalHarmonicCoefficients=this.sphericalHarmonicCoefficients,this._actualInvertClassificationColor=G.clone(this.invertClassificationColor,this._actualInvertClassificationColor),eI.isTranslucencySupported(this._context)||(this._actualInvertClassificationColor.alpha=1),t.invertClassificationColor=this._actualInvertClassificationColor,u(this.globe)?t.maximumScreenSpaceError=this.globe.maximumScreenSpaceError:t.maximumScreenSpaceError=2,this.clearPasses(t.passes),t.tilesetPassState=void 0};ei.prototype.isVisible=function(e,t,n){if(!u(t))return!1;let{boundingVolume:i}=t;return!u(i)||!t.cull?!0:e.computeVisibility(i)===qt.OUTSIDE?!1:!u(n)||!t.occlude||!i.isOccluded(n)};var d5=new F(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1);d5=F.inverseTransformation(d5,d5);function eCt(e,t,n,i){let o=t._frameState,r=o.context,s=e.boundingVolume;u(t._debugVolume)&&t._debugVolume.destroy();let a=h.clone(s.center);if(o.mode!==ne.SCENE3D){a=F.multiplyByPoint(d5,a,a);let m=o.mapProjection,y=m.unproject(a);a=m.ellipsoid.cartographicToCartesian(y)}let c,l,{radius:f}=s;u(f)?(c=da.createGeometry(new da({radii:new h(f,f,f),vertexFormat:ln.FLAT_VERTEX_FORMAT})),l=F.fromTranslation(a)):(c=Ya.createGeometry(Ya.fromDimensions({dimensions:new h(2,2,2),vertexFormat:ln.FLAT_VERTEX_FORMAT})),l=F.fromRotationTranslation(s.halfAxes,a,new F)),t._debugVolume=new In({geometryInstances:new vt({geometry:Nn.toWireframe(c),modelMatrix:l,attributes:{color:new jt(1,0,0,1)}}),appearance:new ln({flat:!0,translucent:!1}),asynchronous:!1});let d=o.commandList,p=o.commandList=[];t._debugVolume.update(o),e=p[0],o.useLogDepth&&(e=__.createLogDepthCommand(e,r).command);let g;u(i)&&(g=n.framebuffer,n.framebuffer=i),e.execute(r,n),u(g)&&(n.framebuffer=g),o.commandList=d}function Gm(e,t,n,i){let o=t._frameState,r=t._context;if(u(t.debugCommandFilter)&&!t.debugCommandFilter(e))return;if(e instanceof ni){e.execute(r,n);return}e.debugShowBoundingVolume&&u(e.boundingVolume)&&eCt(e,t,n,i),o.useLogDepth&&u(e.derivedCommands.logDepth)&&(e=e.derivedCommands.logDepth.command);let s=o.passes;if(!s.pick&&!s.pickVoxel&&!s.depth&&t._hdr&&u(e.derivedCommands)&&u(e.derivedCommands.hdr)&&(e=e.derivedCommands.hdr.command),s.pick||s.depth){if(s.pick&&!s.depth){if(o.pickingMetadata&&u(e.derivedCommands.pickingMetadata)){e=e.derivedCommands.pickingMetadata.pickMetadataCommand,e.execute(r,n);return}if(!o.pickingMetadata&&u(e.derivedCommands.picking)){e=e.derivedCommands.picking.pickCommand,e.execute(r,n);return}}else if(u(e.derivedCommands.depth)){e=e.derivedCommands.depth.depthOnlyCommand,e.execute(r,n);return}}if(t.debugShowCommands||t.debugShowFrustums){t._debugInspector.executeDebugShowFrustumsCommand(t,e,n);return}o.shadowState.lightShadowsEnabled&&e.receiveShadows&&u(e.derivedCommands.shadows)?e.derivedCommands.shadows.receiveCommand.execute(r,n):e.execute(r,n)}function XAe(e,t,n){let{derivedCommands:i}=e;if(!u(i))return;let o=t._frameState,r=t._context;o.useLogDepth&&u(i.logDepth)&&(e=i.logDepth.command);let{picking:s,pickingMetadata:a,depth:c}=e.derivedCommands;u(a)&&(e=i.pickingMetadata.pickMetadataCommand,e.execute(r,n)),u(s)?(e=s.pickCommand,e.execute(r,n)):u(c)&&(e=c.depthOnlyCommand,e.execute(r,n))}function $Ae(e,t,n){return t.boundingVolume.distanceSquaredTo(n)-e.boundingVolume.distanceSquaredTo(n)}function tCt(e,t,n){return e.boundingVolume.distanceSquaredTo(n)-t.boundingVolume.distanceSquaredTo(n)+R.EPSILON12}function nCt(e,t,n,i,o){Y0(i,$Ae,e.camera.positionWC),u(o)&&t(o.unclassifiedCommand,e,n);for(let r=0;r<i.length;++r)t(i[r],e,n)}function iCt(e,t,n,i,o){Y0(i,tCt,e.camera.positionWC),u(o)&&t(o.unclassifiedCommand,e,n);for(let r=0;r<i.length;++r)t(i[r],e,n)}function oCt(e,t,n){e.context.uniformState.updatePass(we.VOXELS);let i=n.commands[we.VOXELS];i.length=n.indices[we.VOXELS],Y0(i,$Ae,e.camera.positionWC);for(let o=0;o<i.length;++o)Gm(i[o],e,t)}var rCt=new Ri,sCt=new Ll,aCt=new sn,cCt=new Gr;function lCt(e){let{frustum:t}=e;return u(t.fov)?t.clone(rCt):u(t.infiniteProjectionMatrix)?t.clone(sCt):u(t.width)?t.clone(aCt):t.clone(cCt)}function uCt(e){if(e._environmentState.useOIT){if(!u(e._executeOITFunction)){let{view:t,context:n}=e;e._executeOITFunction=function(i,o,r,s,a){t.globeDepth.prepareColorTextures(n),t.oit.executeCommands(i,o,r,s,a)}}return e._executeOITFunction}return e.frameState.passes.render?nCt:iCt}function fCt(e,t,n){let{frameState:i,context:o}=e,{pick:r,pickVoxel:s}=i.passes,a=r||s,c;!a&&e._environmentState.useInvertClassification&&i.invertClassificationColor.alpha<1&&(c=e._invertClassification);let l=uCt(e);o.uniformState.updatePass(we.TRANSLUCENT);let f=n.commands[we.TRANSLUCENT];f.length=n.indices[we.TRANSLUCENT],l(e,Gm,t,f,c)}function dCt(e,t,n){let{translucentTileClassification:i,globeDepth:o}=e._view;if(!(n.indices[we.CESIUM_3D_TILE_CLASSIFICATION]>0)||!i.isSupported())return;let s=n.commands[we.TRANSLUCENT];i.executeTranslucentCommands(e,Gm,t,s,o.depthStencilTexture),i.executeClassificationCommands(e,Gm,t,n)}function IZ(e,t){let{camera:n,context:i,frameState:o}=e,{uniformState:r}=i;r.updateCamera(n);let s=lCt(n);s.near=n.frustum.near,s.far=n.frustum.far;let a=o.passes,c=a.pick||a.pickVoxel;c||hCt(e,t);let{clearGlobeDepth:l,renderTranslucentDepthForPick:f,useDepthPlane:d,useGlobeDepthFramebuffer:p,useInvertClassification:g,usePostProcessSelected:m}=e._environmentState,{globeDepth:y,globeTranslucencyFramebuffer:b,sceneFramebuffer:C,frustumCommandsList:A}=e._view,T=A.length,E=e._globeTranslucencyState,v=e._depthClearCommand,D=e._stencilClearCommand,O=e._classificationStencilClearCommand,P=e._depthPlane,M=n.position.z;function L(S,w){r.updatePass(w);let I=S.commands[w],N=S.indices[w];for(let k=0;k<N;++k)Gm(I[k],e,t);return N}function _(S,w){r.updatePass(w);let I=S.commands[w],N=S.indices[w];for(let k=0;k<N;++k)XAe(I[k],e,t)}for(let S=0;S<T;++S){let w=T-S-1,I=A[w];e.mode===ne.SCENE2D?(n.position.z=M-I.near+1,s.far=Math.max(1,I.far-I.near),s.near=1,r.update(o),r.updateFrustum(s)):(s.near=w!==0?I.near*e.opaqueFrustumNearOffset:I.near,s.far=I.far,r.updateFrustum(s)),v.execute(i,t),i.stencilBuffer&&D.execute(i,t),E.translucent?(r.updatePass(we.GLOBE),E.executeGlobeCommands(I,Gm,b,e,t)):L(I,we.GLOBE),p&&y.executeCopyDepth(i,t),f||(E.translucent?(r.updatePass(we.TERRAIN_CLASSIFICATION),E.executeGlobeClassificationCommands(I,Gm,b,e,t)):L(I,we.TERRAIN_CLASSIFICATION)),l&&(v.execute(i,t),d&&P.execute(i,t));let N;if(!g||c||f)N=L(I,we.CESIUM_3D_TILE),N>0&&(p&&(y.prepareColorTextures(i,l),y.executeUpdateDepth(i,t,y.depthStencilTexture)),f||(N=L(I,we.CESIUM_3D_TILE_CLASSIFICATION)));else{e._invertClassification.clear(i,t);let z=t.framebuffer;t.framebuffer=e._invertClassification._fbo.framebuffer,N=L(I,we.CESIUM_3D_TILE),p&&(e._invertClassification.prepareTextures(i),y.executeUpdateDepth(i,t,e._invertClassification._fbo.getDepthStencilTexture())),N=L(I,we.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW),t.framebuffer=z,e._invertClassification.executeClassified(i,t),o.invertClassificationColor.alpha===1&&e._invertClassification.executeUnclassified(i,t),N>0&&i.stencilBuffer&&O.execute(i,t),N=L(I,we.CESIUM_3D_TILE_CLASSIFICATION)}if(N>0&&i.stencilBuffer&&D.execute(i,t),oCt(e,t,I),L(I,we.OPAQUE),w!==0&&e.mode!==ne.SCENE2D&&(s.near=I.near,r.updateFrustum(s)),fCt(e,t,I),dCt(e,t,I),i.depthTexture&&e.useDepthPicking&&(p||f)){let z=e._picking.getPickDepth(e,w);z.update(i,y.depthStencilTexture),z.executeCopyDepth(i,t)}if(c||!m)continue;let k=t.framebuffer;t.framebuffer=C.getIdFramebuffer(),s.near=w!==0?I.near*e.opaqueFrustumNearOffset:I.near,s.far=I.far,r.updateFrustum(s),E.translucent?(r.updatePass(we.GLOBE),E.executeGlobeCommands(I,XAe,b,e,t)):_(I,we.GLOBE),l&&(v.framebuffer=t.framebuffer,v.execute(i,t),v.framebuffer=void 0),l&&d&&P.execute(i,t),_(I,we.CESIUM_3D_TILE),_(I,we.OPAQUE),_(I,we.TRANSLUCENT),t.framebuffer=k}}function hCt(e,t){let{context:n,environmentState:i,view:o}=e;if(n.uniformState.updatePass(we.ENVIRONMENT),u(i.skyBoxCommand)&&Gm(i.skyBoxCommand,e,t),i.isSkyAtmosphereVisible&&Gm(i.skyAtmosphereCommand,e,t),i.isSunVisible&&(i.sunDrawCommand.execute(n,t),e.sunBloom&&!i.useWebVR)){let r;i.useGlobeDepthFramebuffer?r=o.globeDepth.framebuffer:i.usePostProcess?r=o.sceneFramebuffer.framebuffer:r=i.originalFramebuffer,e._sunPostProcess.execute(n),e._sunPostProcess.copy(n,r),t.framebuffer=r}i.isMoonVisible&&i.moonCommand.execute(n,t)}function QAe(e){e.context.uniformState.updatePass(we.COMPUTE);let t=e._environmentState.sunComputeCommand;u(t)&&t.execute(e._computeEngine);let n=e._computeCommandList;for(let i=0;i<n.length;++i)n[i].execute(e._computeEngine)}function mCt(e,t){e.context.uniformState.updatePass(we.OVERLAY);let n=e.context,i=e._overlayCommandList;for(let o=0;o<i.length;++o)i[o].execute(n,t)}function pCt(e,t,n){let{shadowMapCullingVolume:i,isPointLight:o,passes:r}=n,s=r.length,a=[we.GLOBE,we.CESIUM_3D_TILE,we.OPAQUE,we.TRANSLUCENT];for(let c=0;c<t.length;++c){let l=t[c];if(e.updateDerivedCommands(l),!(!l.castShadows||a.indexOf(l.pass)<0||!e.isVisible(i,l)))if(o)for(let f=0;f<s;++f)r[f].commandList.push(l);else if(s===1)r[0].commandList.push(l);else{let f=!1;for(let d=s-1;d>=0;--d){let p=r[d].cullingVolume;if(e.isVisible(p,l))r[d].commandList.push(l),f=!0;else if(f)break}}}}function JAe(e){let{shadowState:t,commandList:n}=e.frameState,{shadowsEnabled:i,shadowMaps:o}=t;if(!i)return;let{context:r}=e,{uniformState:s}=r;for(let a=0;a<o.length;++a){let c=o[a];if(c.outOfView)continue;let{passes:l}=c;for(let f=0;f<l.length;++f)l[f].commandList.length=0;pCt(e,n,c);for(let f=0;f<l.length;++f){let d=c.passes[f],{camera:p,commandList:g}=d;s.updateCamera(p),c.updatePass(r,f);for(let m=0;m<g.length;++m){let y=g[m];s.updatePass(y.pass);let b=y.derivedCommands.shadows.castCommands[a];Gm(b,e,d.passState)}}}}var _Ct=new h;ei.prototype.updateAndExecuteCommands=function(e,t){ICt(this,e,t),this._environmentState.useWebVR?gCt(this,e,t):this._frameState.mode!==ne.SCENE2D||this._mapMode2D===Mu.ROTATE?dy(!0,this,e):vCt(this,e)};function gCt(e,t){let n=e._view,i=n.camera,r=e._environmentState.renderTranslucentDepthForPick;eTe(e),n.createPotentiallyVisibleSet(e),QAe(e),r||JAe(e);let s=t.viewport;s.x=0,s.y=0,s.width=s.width*.5;let a=uo.clone(i,e._cameraVR);a.frustum=i.frustum;let c=i.frustum.near,l=c*x(e.focalLength,5),f=x(e.eyeSeparation,l/30),d=h.multiplyByScalar(a.right,f*.5,_Ct);i.frustum.aspectRatio=s.width/s.height;let p=.5*f*c/l;h.add(a.position,d,i.position),i.frustum.xOffset=p,IZ(e,t),s.x=s.width,h.subtract(a.position,d,i.position),i.frustum.xOffset=-p,IZ(e,t),uo.clone(a,i)}var yCt=new de(Math.PI,R.PI_OVER_TWO),xCt=new h,bCt=new h,CCt=new F,ACt=new F,TCt=new h,ECt=new h,SCt=new qe;function vCt(e,t){let{frameState:n,camera:i}=e,{uniformState:o}=e.context,r=t.viewport,s=qe.clone(r,SCt);t.viewport=s;let a=yCt,c=xCt;e.mapProjection.project(a,c);let f=h.clone(i.position,bCt),d=F.clone(i.transform,ACt),p=i.frustum.clone();i._setTransform(F.IDENTITY);let g=F.computeViewportTransformation(s,0,1,CCt),m=i.frustum.projectionMatrix,y=i.positionWC.y,b=h.fromElements(R.sign(y)*c.x-y,0,-i.positionWC.x,TCt),C=Lt.pointToGLWindowCoordinates(m,g,b,ECt);C.x=Math.floor(C.x);let A=s.x,T=s.width;if(y===0||C.x<=A||C.x>=A+T)dy(!0,e,t);else if(Math.abs(A+T*.5-C.x)<1)s.width=C.x-s.x,i.position.x*=R.sign(i.position.x),i.frustum.right=0,n.cullingVolume=i.frustum.computeCullingVolume(i.positionWC,i.directionWC,i.upWC),o.update(n),dy(!0,e,t),s.x=C.x,i.position.x=-i.position.x,i.frustum.right=-i.frustum.left,i.frustum.left=0,n.cullingVolume=i.frustum.computeCullingVolume(i.positionWC,i.directionWC,i.upWC),o.update(n),dy(!1,e,t);else if(C.x>A+T*.5){s.width=C.x-A;let E=i.frustum.right;i.frustum.right=c.x-y,n.cullingVolume=i.frustum.computeCullingVolume(i.positionWC,i.directionWC,i.upWC),o.update(n),dy(!0,e,t),s.x=C.x,s.width=A+T-C.x,i.position.x=-i.position.x,i.frustum.left=-i.frustum.right,i.frustum.right=E-i.frustum.right*2,n.cullingVolume=i.frustum.computeCullingVolume(i.positionWC,i.directionWC,i.upWC),o.update(n),dy(!1,e,t)}else{s.x=C.x,s.width=A+T-C.x;let E=i.frustum.left;i.frustum.left=-c.x-y,n.cullingVolume=i.frustum.computeCullingVolume(i.positionWC,i.directionWC,i.upWC),o.update(n),dy(!0,e,t),s.x=A,s.width=C.x-A,i.position.x=-i.position.x,i.frustum.right=-i.frustum.left,i.frustum.left=E-i.frustum.left*2,n.cullingVolume=i.frustum.computeCullingVolume(i.positionWC,i.directionWC,i.upWC),o.update(n),dy(!1,e,t)}i._setTransform(d),h.clone(f,i.position),i.frustum=p.clone(),t.viewport=r}function dy(e,t,n){let i=t._view,{renderTranslucentDepthForPick:o}=t._environmentState;e||(t.frameState.commandList.length=0),eTe(t),i.createPotentiallyVisibleSet(t),e&&(QAe(t),o||JAe(t)),IZ(t,n)}var KAe=new bs;ei.prototype.updateEnvironment=function(){let e=this._frameState,t=this._view,n=this._environmentState,i=e.passes.render,o=e.passes.offscreen,r=this.atmosphere,s=this.skyAtmosphere,a=this.globe,c=this._globeTranslucencyState;if(!i||this._mode!==ne.SCENE2D&&t.camera.frustum instanceof sn||!c.environmentVisible)n.skyAtmosphereCommand=void 0,n.skyBoxCommand=void 0,n.sunDrawCommand=void 0,n.sunComputeCommand=void 0,n.moonCommand=void 0;else{if(u(s)){if(u(a))s.setDynamicLighting(Tg.fromGlobeFlags(a)),n.isReadyForAtmosphere=n.isReadyForAtmosphere||!a.show||a._surface._tilesToRender.length>0;else{let C=r.dynamicLighting;s.setDynamicLighting(C),n.isReadyForAtmosphere=!0}n.skyAtmosphereCommand=s.update(e,a),u(n.skyAtmosphereCommand)&&this.updateDerivedCommands(n.skyAtmosphereCommand)}else n.skyAtmosphereCommand=void 0;n.skyBoxCommand=u(this.skyBox)?this.skyBox.update(e,this._hdr):void 0;let b=u(this.sun)?this.sun.update(e,t.passState,this._hdr):void 0;n.sunDrawCommand=u(b)?b.drawCommand:void 0,n.sunComputeCommand=u(b)?b.computeCommand:void 0,n.moonCommand=u(this.moon)?this.moon.update(e):void 0}let l=n.clearGlobeDepth=u(a)&&a.show&&(!a.depthTestAgainstTerrain||this.mode===ne.SCENE2D);(n.useDepthPlane=l&&this.mode===ne.SCENE3D&&c.useDepthPlane)&&this._depthPlane.update(e),n.renderTranslucentDepthForPick=!1,n.useWebVR=this._useWebVR&&this.mode!==ne.SCENE2D&&!o;let d=e.mode===ne.SCENE3D&&!c.sunVisibleThroughGlobe?e.occluder:void 0,p=e.cullingVolume,g=KAe.planes;for(let b=0;b<5;++b)g[b]=p.planes[b];p=KAe,n.isSkyAtmosphereVisible=u(n.skyAtmosphereCommand)&&n.isReadyForAtmosphere,n.isSunVisible=this.isVisible(p,n.sunDrawCommand,d),n.isMoonVisible=this.isVisible(p,n.moonCommand,d);let m=this.specularEnvironmentMaps,y=this._specularEnvironmentCubeMap;u(m)&&y?.url!==m?(y=y&&y.destroy(),this._specularEnvironmentCubeMap=new kh(m)):!u(m)&&u(y)&&(y.destroy(),this._specularEnvironmentCubeMap=void 0),u(this._specularEnvironmentCubeMap)&&this._specularEnvironmentCubeMap.update(e)};function wCt(e){let t=e._frameState;e.debugShowFrustumPlanes!==e._debugShowFrustumPlanes&&(e.debugShowFrustumPlanes?e._debugFrustumPlanes=new p_({camera:e.camera,updateOnChange:!1,frustumSplits:t.frustumSplits}):e._debugFrustumPlanes=e._debugFrustumPlanes&&e._debugFrustumPlanes.destroy(),e._debugShowFrustumPlanes=e.debugShowFrustumPlanes),u(e._debugFrustumPlanes)&&e._debugFrustumPlanes.update(t)}function DCt(e){let t=e._frameState,{passes:n,shadowState:i,shadowMaps:o}=t,r=o.length,s=r>0&&!n.pick&&!n.pickVoxel&&e.mode===ne.SCENE3D;if(s!==i.shadowsEnabled&&(++i.lastDirtyTime,i.shadowsEnabled=s),i.lightShadowsEnabled=!1,!!s){for(let a=0;a<r;++a)if(o[a]!==i.shadowMaps[a]){++i.lastDirtyTime;break}i.shadowMaps.length=0,i.lightShadowMaps.length=0;for(let a=0;a<r;++a){let c=o[a];c.update(t),i.shadowMaps.push(c),c.fromLightSource&&(i.lightShadowMaps.push(c),i.lightShadowsEnabled=!0),c.dirty&&(++i.lastDirtyTime,c.dirty=!1)}}}function eTe(e){let t=e._frameState;e._groundPrimitives.update(t),e._primitives.update(t),wCt(e),DCt(e),e._globe&&e._globe.render(t)}function ICt(e,t,n){let i=e._context,o=e._frameState,r=e._environmentState,s=e._view,a=o.passes,c=a.pick||a.pickVoxel;u(s.globeDepth)&&(s.globeDepth.picking=c);let l=r.useWebVR;r.originalFramebuffer=t.framebuffer,u(e.sun)&&e.sunBloom!==e._sunBloom?(e.sunBloom&&!l?e._sunPostProcess=new B8:u(e._sunPostProcess)&&(e._sunPostProcess=e._sunPostProcess.destroy()),e._sunBloom=e.sunBloom):!u(e.sun)&&u(e._sunPostProcess)&&(e._sunPostProcess=e._sunPostProcess.destroy(),e._sunBloom=!1);let f=e._clearColorCommand;G.clone(n,f.color),f.execute(i,t);let d=r.useGlobeDepthFramebuffer=u(s.globeDepth);d&&(s.globeDepth.update(i,t,s.viewport,e.msaaSamples,e._hdr,r.clearGlobeDepth),s.globeDepth.clear(i,t,n));let p=s.oit,g=r.useOIT=!c&&u(p)&&p.isSupported();g&&(p.update(i,t,s.globeDepth.colorFramebufferManager,e._hdr,e.msaaSamples),p.clear(i,t,n),r.useOIT=p.isSupported());let m=e.postProcessStages,y=r.usePostProcess=!c&&(e._hdr||m.length>0||m.ambientOcclusion.enabled||m.fxaa.enabled||m.bloom.enabled);if(r.usePostProcessSelected=!1,y&&(s.sceneFramebuffer.update(i,s.viewport,e._hdr,e.msaaSamples),s.sceneFramebuffer.clear(i,t,n),m.update(i,o.useLogDepth,e._hdr),m.clear(i),y=r.usePostProcess=m.ready,r.usePostProcessSelected=y&&m.hasSelected),r.isSunVisible&&e.sunBloom&&!l?(t.framebuffer=e._sunPostProcess.update(t),e._sunPostProcess.clear(i,t,n)):d?t.framebuffer=s.globeDepth.framebuffer:y&&(t.framebuffer=s.sceneFramebuffer.framebuffer),u(t.framebuffer)&&f.execute(i,t),r.useInvertClassification=!c&&u(t.framebuffer)&&e.invertClassification){let C;if(o.invertClassificationColor.alpha===1&&d&&(C=s.globeDepth.framebuffer),u(C)||i.depthTexture){if(e._invertClassification.previousFramebuffer=C,e._invertClassification.update(i,e.msaaSamples,s.globeDepth.colorFramebufferManager),e._invertClassification.clear(i,t),o.invertClassificationColor.alpha<1&&g){let A=e._invertClassification.unclassifiedCommand,T=A.derivedCommands;T.oit=p.createDerivedCommands(A,i,T.oit)}}else r.useInvertClassification=!1}e._globeTranslucencyState.translucent&&s.globeTranslucencyFramebuffer.updateAndClear(e._hdr,s.viewport,i,t)}ei.prototype.resolveFramebuffers=function(e){let t=this._context,n=this._environmentState,i=this._view,{globeDepth:o,translucentTileClassification:r}=i;u(o)&&o.prepareColorTextures(t);let{useOIT:s,useGlobeDepthFramebuffer:a,usePostProcess:c,originalFramebuffer:l}=n,f=a?o.colorFramebufferManager:void 0,d=i.sceneFramebuffer._colorFramebuffer,p=i.sceneFramebuffer.idFramebuffer;if(s&&(e.framebuffer=c?d.framebuffer:l,i.oit.execute(t,e)),r.hasTranslucentDepth&&r.isSupported()&&r.execute(this,e),c){i.sceneFramebuffer.prepareColorTextures(t);let g=d;a&&!s&&(g=f);let m=this.postProcessStages,y=g.getColorTexture(0),b=p.getColorTexture(0),C=x(f,d).getDepthStencilTexture();m.execute(t,y,C,b),m.copy(t,l)}!s&&!c&&a&&(e.framebuffer=l,o.executeCopyColor(t,e))};function PCt(e){let t=e._frameState.afterRender;for(let n=0;n<t.length;++n)t[n]()&&e.requestRender();t.length=0}function RCt(e){if(e.mode===ne.MORPHING)return;let t=e.camera.positionCartographic;return e.getHeight(t)}ei.prototype.getHeight=function(e,t){if(!u(e))return;let n=t===Xe.CLAMP_TO_TERRAIN||t===Xe.RELATIVE_TO_TERRAIN,i=t===Xe.CLAMP_TO_3D_TILE||t===Xe.RELATIVE_TO_3D_TILE;if(!u(e))return;let o=Number.NEGATIVE_INFINITY;if(!n){let s=this.primitives.length;for(let a=0;a<s;++a){let c=this.primitives.get(a);if(!c.isCesium3DTileset||!c.show||!c.enableCollision)continue;let l=c.getHeight(e,this);u(l)&&l>o&&(o=l)}}let r=this._globe;if(!i&&u(r)&&r.show){let s=r.getHeight(e);s>o&&(o=s)}if(o>Number.NEGATIVE_INFINITY)return o};var DZ=new de;ei.prototype.updateHeight=function(e,t,n){let i=()=>{de.clone(e,DZ);let g=this.getHeight(e,n);u(g)&&(DZ.height=g,t(DZ))},o=n===Xe.CLAMP_TO_TERRAIN||n===Xe.RELATIVE_TO_TERRAIN,r=n===Xe.CLAMP_TO_3D_TILE||n===Xe.RELATIVE_TO_3D_TILE,s;!r&&u(this.globe)&&(s=this.globe._surface.updateHeight(e,i));let a={},c=this._ellipsoid,l=g=>{if(o||g.isDestroyed()||!g.isCesium3DTileset)return;let m=g.updateHeight(e,i,c);a[g.id]=m};if(!o){let g=this.primitives.length;for(let m=0;m<g;++m){let y=this.primitives.get(m);l(y)}}let f=this.primitives.primitiveAdded.addEventListener(l),d=this.primitives.primitiveRemoved.addEventListener(g=>{g.isDestroyed()||!g.isCesium3DTileset||(u(a[g.id])&&a[g.id](),delete a[g.id])});return()=>{s=s&&s(),Object.values(a).forEach(g=>g()),a={},f(),d()}};function OCt(e){let t=e.camera,n=e._mode,i=e._screenSpaceCameraController,o=t.positionCartographic;if(!u(o))return!1;if(!i.onMap()&&o.height<0)return!0;if(n===ne.SCENE2D||n===ne.MORPHING)return!1;let r=e._globeHeight;return u(r)&&o.height<r}ei.prototype.initializeFrame=function(){if(this._shaderFrameCount++===120&&(this._shaderFrameCount=0,this._context.shaderCache.destroyReleasedShaderPrograms(),this._context.textureCache.destroyReleasedTextures()),this._tweens.update(),this._globeHeightDirty){u(this._removeUpdateHeightCallback)&&(this._removeUpdateHeightCallback(),this._removeUpdateHeightCallback=void 0),this._globeHeight=RCt(this),this._globeHeightDirty=!1;let e=this.camera.positionCartographic;this._removeUpdateHeightCallback=this.updateHeight(e,t=>{this.isDestroyed()||(this._globeHeight=t.height)})}this._cameraUnderground=OCt(this),this._globeTranslucencyState.update(this),this._screenSpaceCameraController.update(),u(this._deviceOrientationCameraController)&&this._deviceOrientationCameraController.update(),this.camera.update(this._mode),this.camera._updateCameraChanged()};function MCt(e,t){if(e.debugShowFramesPerSecond){if(!u(e._performanceDisplay)){let n=document.createElement("div");n.className="cesium-performanceDisplay-defaultContainer",e._canvas.parentNode.appendChild(n);let o=new sy({container:n});e._performanceDisplay=o,e._performanceContainer=n}e._performanceDisplay.throttled=e.requestRenderMode,e._performanceDisplay.update(t)}else u(e._performanceDisplay)&&(e._performanceDisplay=e._performanceDisplay&&e._performanceDisplay.destroy(),e._performanceContainer.parentNode.removeChild(e._performanceContainer))}function LCt(e){e._jobScheduler.resetBudgets();let t=e._frameState;e.primitives.prePassesUpdate(t),u(e.globe)&&e.globe.update(t),e._picking.update(),t.creditDisplay.update()}function NCt(e){e.primitives.postPassesUpdate(e._frameState),Cc.update()}var FCt=new G;function BCt(e){let t=e._frameState,n=e.context,{uniformState:i}=n,o=e._defaultView;e._view=o,e.updateFrameState(),t.passes.render=!0,t.passes.postProcess=e.postProcessStages.hasSelected,t.tilesetPassState=$bt;let r=x(e.backgroundColor,G.BLACK);e._hdr&&(r=G.clone(r,FCt),r.red=Math.pow(r.red,e.gamma),r.green=Math.pow(r.green,e.gamma),r.blue=Math.pow(r.blue,e.gamma)),t.backgroundColor=r,t.atmosphere=e.atmosphere,e.fog.update(t),i.update(t);let s=e.shadowMap;u(s)&&s.enabled&&(!u(e.light)||e.light instanceof H_?h.negate(i.sunDirectionWC,e._shadowMapCamera.direction):h.clone(e.light.direction,e._shadowMapCamera.direction),t.shadowMaps.push(s)),e._computeCommandList.length=0,e._overlayCommandList.length=0;let a=o.viewport;a.x=0,a.y=0,a.width=n.drawingBufferWidth,a.height=n.drawingBufferHeight;let c=o.passState;c.framebuffer=void 0,c.blendingEnabled=void 0,c.scissorTest=void 0,c.viewport=qe.clone(a,c.viewport),u(e.globe)&&e.globe.beginFrame(t),e.updateEnvironment(),e.updateAndExecuteCommands(c,r),e.resolveFramebuffers(c),c.framebuffer=void 0,mCt(e,c),u(e.globe)&&(e.globe.endFrame(t),e.globe.tilesLoaded||(e._renderRequested=!0)),n.endFrame()}function Fb(e,t){try{t(e)}catch(n){if(e._renderError.raiseEvent(e,n),e.rethrowRenderErrors)throw n}}function kCt(e){return e._picking.updateMostDetailedRayPicks(e)}ei.prototype.render=function(e){this._preUpdate.raiseEvent(this,e);let t=this._frameState;t.newFrame=!1,u(e)||(e=$.now());let n=this._view.checkForCameraUpdates(this);n&&(this._globeHeightDirty=!0);let i=!this.requestRenderMode||this._renderRequested||n||this._logDepthBufferDirty||this._hdrDirty||this.mode===ne.MORPHING;if(!i&&u(this.maximumRenderTimeChange)&&u(this._lastRenderTime)){let o=Math.abs($.secondsDifference(this._lastRenderTime,e));i=i||o>this.maximumRenderTimeChange}if(i){this._lastRenderTime=$.clone(e,this._lastRenderTime),this._renderRequested=!1,this._logDepthBufferDirty=!1,this._hdrDirty=!1;let o=R.incrementWrap(t.frameNumber,15e6,1);ZAe(this,o,e),t.newFrame=!0}Fb(this,LCt),this.primitives.show&&(Fb(this,kCt),Fb(this,VCt),Fb(this,UCt),i||Fb(this,zCt)),this._postUpdate.raiseEvent(this,e),i&&(this._preRender.raiseEvent(this,e),t.creditDisplay.beginFrame(),Fb(this,BCt)),MCt(this,i),Fb(this,NCt),PCt(this),i&&(this._postRender.raiseEvent(this,e),t.creditDisplay.endFrame())};ei.prototype.forceRender=function(e){this._renderRequested=!0,this.render(e)};ei.prototype.requestRender=function(){this._renderRequested=!0};ei.prototype.clampLineWidth=function(e){return Math.max(Vt.minimumAliasedLineWidth,Math.min(e,Vt.maximumAliasedLineWidth))};ei.prototype.pick=function(e,t,n){return this._picking.pick(this,e,t,n)};ei.prototype.pickVoxel=function(e,t,n){let i=this.pick(e,t,n);if(!u(i))return;let o=i.primitive;if(!(o instanceof Nb))return;let r=this._picking.pickVoxelCoordinate(this,e,t,n),s=255*r[0]+r[1],a=o._traversal.findKeyframeNode(s);if(!u(a))return;let c=255*r[2]+r[3];return V8.fromKeyframeNode(o,s,c,a)};ei.prototype.pickMetadata=function(e,t,n,i){let o=this.pick(e);if(!u(o))return;let r=o.detail?.model?.structuralMetadata?.schema,s=u5(r,t,n,i);if(!u(s))return;let a=new f5(t,n,i,s);return this._picking.pickMetadata(this,e,a)};ei.prototype.pickMetadataSchema=function(e){let t=this.pick(e);return u(t)?t.detail?.model?.structuralMetadata?.schema:void 0};ei.prototype.pickPositionWorldCoordinates=function(e,t){return this._picking.pickPositionWorldCoordinates(this,e,t)};ei.prototype.pickPosition=function(e,t){return this._picking.pickPosition(this,e,t)};ei.prototype.drillPick=function(e,t,n,i){return this._picking.drillPick(this,e,t,n,i)};function VCt(e){let t=e._frameState;SZ.camera=t.camera,SZ.cullingVolume=t.cullingVolume,e.primitives.updateForPass(t,SZ)}function UCt(e){let t=e._frameState;if(!t.camera.canPreloadFlight())return;vZ.camera=e.preloadFlightCamera,vZ.cullingVolume=e.preloadFlightCullingVolume,e.primitives.updateForPass(t,vZ)}function zCt(e){e.primitives.updateForPass(e._frameState,Qbt)}ei.prototype.pickFromRay=function(e,t,n){return this._picking.pickFromRay(this,e,t,n)};ei.prototype.drillPickFromRay=function(e,t,n,i){return this._picking.drillPickFromRay(this,e,t,n,i)};ei.prototype.pickFromRayMostDetailed=function(e,t,n){return this._picking.pickFromRayMostDetailed(this,e,t,n)};ei.prototype.drillPickFromRayMostDetailed=function(e,t,n,i){return this._picking.drillPickFromRayMostDetailed(this,e,t,n,i)};ei.prototype.sampleHeight=function(e,t,n){return this._picking.sampleHeight(this,e,t,n)};ei.prototype.clampToHeight=function(e,t,n,i){return this._picking.clampToHeight(this,e,t,n,i)};ei.prototype.sampleHeightMostDetailed=function(e,t,n){return this._picking.sampleHeightMostDetailed(this,e,t,n)};ei.prototype.clampToHeightMostDetailed=function(e,t,n){return this._picking.clampToHeightMostDetailed(this,e,t,n)};ei.prototype.cartesianToCanvasCoordinates=function(e,t){return Wi.worldToWindowCoordinates(this,e,t)};ei.prototype.completeMorph=function(){this._transitioner.completeMorph()};ei.prototype.morphTo2D=function(e){e=x(e,2),this._transitioner.morphTo2D(e,this._ellipsoid)};ei.prototype.morphToColumbusView=function(e){e=x(e,2),this._transitioner.morphToColumbusView(e,this._ellipsoid)};ei.prototype.morphTo3D=function(e){e=x(e,2),this._transitioner.morphTo3D(e,this._ellipsoid)};function HCt(e,t){if(e._removeTerrainProviderReadyListener=e._removeTerrainProviderReadyListener&&e._removeTerrainProviderReadyListener(),t.ready){u(e.globe)&&(e.globe.terrainProvider=t.provider);return}e.globe.terrainProvider=void 0,e._removeTerrainProviderReadyListener=t.readyEvent.addEventListener(n=>{u(e)&&u(e.globe)&&(e.globe.terrainProvider=n),e._removeTerrainProviderReadyListener()})}ei.prototype.setTerrain=function(e){return HCt(this,e),e};ei.prototype.isDestroyed=function(){return!1};ei.prototype.destroy=function(){this._tweens.removeAll(),this._computeEngine=this._computeEngine&&this._computeEngine.destroy(),this._screenSpaceCameraController=this._screenSpaceCameraController&&this._screenSpaceCameraController.destroy(),this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this._primitives=this._primitives&&this._primitives.destroy(),this._groundPrimitives=this._groundPrimitives&&this._groundPrimitives.destroy(),this._globe=this._globe&&this._globe.destroy(),this._removeTerrainProviderReadyListener=this._removeTerrainProviderReadyListener&&this._removeTerrainProviderReadyListener(),this.skyBox=this.skyBox&&this.skyBox.destroy(),this.skyAtmosphere=this.skyAtmosphere&&this.skyAtmosphere.destroy(),this._debugSphere=this._debugSphere&&this._debugSphere.destroy(),this.sun=this.sun&&this.sun.destroy(),this._sunPostProcess=this._sunPostProcess&&this._sunPostProcess.destroy(),this._depthPlane=this._depthPlane&&this._depthPlane.destroy(),this._transitioner=this._transitioner&&this._transitioner.destroy(),this._debugFrustumPlanes=this._debugFrustumPlanes&&this._debugFrustumPlanes.destroy(),this._brdfLutGenerator=this._brdfLutGenerator&&this._brdfLutGenerator.destroy(),this._picking=this._picking&&this._picking.destroy(),this._defaultView=this._defaultView&&this._defaultView.destroy(),this._view=void 0,this._removeCreditContainer&&this._canvas.parentNode.removeChild(this._creditContainer),this.postProcessStages=this.postProcessStages&&this.postProcessStages.destroy(),this._context=this._context&&this._context.destroy(),this._frameState.creditDisplay=this._frameState.creditDisplay&&this._frameState.creditDisplay.destroy(),u(this._performanceDisplay)&&(this._performanceDisplay=this._performanceDisplay&&this._performanceDisplay.destroy(),this._performanceContainer.parentNode.removeChild(this._performanceContainer)),this._removeRequestListenerCallback(),this._removeTaskProcessorListenerCallback();for(let e=0;e<this._removeGlobeCallbacks.length;++e)this._removeGlobeCallbacks[e]();return this._removeGlobeCallbacks.length=0,u(this._removeUpdateHeightCallback)&&(this._removeUpdateHeightCallback(),this._removeUpdateHeightCallback=void 0),ue(this)};var m5=ei;var yI=`float interpolateByDistance(vec4 nearFarScalar, float distance)
{
    float startDistance = nearFarScalar.x;
    float startValue = nearFarScalar.y;
    float endDistance = nearFarScalar.z;
    float endValue = nearFarScalar.w;
    float t = clamp((distance - startDistance) / (endDistance - startDistance), 0.0, 1.0);
    return mix(startValue, endValue, t);
}

void computeAtmosphereScattering(vec3 positionWC, vec3 lightDirection, out vec3 rayleighColor, out vec3 mieColor, out float opacity, out float underTranslucentGlobe)
{
    float ellipsoidRadiiDifference = czm_ellipsoidRadii.x - czm_ellipsoidRadii.z;

    // Adjustment to the atmosphere radius applied based on the camera height.
    float distanceAdjustMin = czm_ellipsoidRadii.x / 4.0;
    float distanceAdjustMax = czm_ellipsoidRadii.x;
    float distanceAdjustModifier = ellipsoidRadiiDifference / 2.0;
    float distanceAdjust = distanceAdjustModifier * clamp((czm_eyeHeight - distanceAdjustMin) / (distanceAdjustMax - distanceAdjustMin), 0.0, 1.0);

    // Since atmosphere scattering assumes the atmosphere is a spherical shell, we compute an inner radius of the atmosphere best fit
    // for the position on the ellipsoid.
    float radiusAdjust = (ellipsoidRadiiDifference / 4.0) + distanceAdjust;
    float atmosphereInnerRadius = (length(czm_viewerPositionWC) - czm_eyeHeight) - radiusAdjust;

    // Setup the primary ray: from the camera position to the vertex position.
    vec3 cameraToPositionWC = positionWC - czm_viewerPositionWC;
    vec3 cameraToPositionWCDirection = normalize(cameraToPositionWC);
    czm_ray primaryRay = czm_ray(czm_viewerPositionWC, cameraToPositionWCDirection);

    underTranslucentGlobe = 0.0;

    // Brighten the sky atmosphere under the Earth's atmosphere when translucency is enabled.
    #if defined(GLOBE_TRANSLUCENT)

        // Check for intersection with the inner radius of the atmopshere.
        czm_raySegment primaryRayEarthIntersect = czm_raySphereIntersectionInterval(primaryRay, vec3(0.0), atmosphereInnerRadius + radiusAdjust);
        if (primaryRayEarthIntersect.start > 0.0 && primaryRayEarthIntersect.stop > 0.0) {

            // Compute position on globe.
            vec3 direction = normalize(positionWC);
            czm_ray ellipsoidRay = czm_ray(positionWC, -direction);
            czm_raySegment ellipsoidIntersection = czm_rayEllipsoidIntersectionInterval(ellipsoidRay, vec3(0.0), czm_ellipsoidInverseRadii);
            vec3 onEarth = positionWC - (direction * ellipsoidIntersection.start);

            // Control the color using the camera angle.
            float angle = dot(normalize(czm_viewerPositionWC), normalize(onEarth));

            // Control the opacity using the distance from Earth.
            opacity = interpolateByDistance(vec4(0.0, 1.0, czm_ellipsoidRadii.x, 0.0), length(czm_viewerPositionWC - onEarth));
            vec3 horizonColor = vec3(0.1, 0.2, 0.3);
            vec3 nearColor = vec3(0.0);

            rayleighColor = mix(nearColor, horizonColor, exp(-angle) * opacity);

            // Set the traslucent flag to avoid alpha adjustment in computeFinalColor funciton.
            underTranslucentGlobe = 1.0;
            return;
        }
    #endif

    computeScattering(
        primaryRay,
        length(cameraToPositionWC),
        lightDirection,
        atmosphereInnerRadius,
        rayleighColor,
        mieColor,
        opacity
    );

    // Alter the opacity based on how close the viewer is to the ground.
    // (0.0 = At edge of atmosphere, 1.0 = On ground)
    float cameraHeight = czm_eyeHeight + atmosphereInnerRadius;
    float atmosphereOuterRadius = atmosphereInnerRadius + ATMOSPHERE_THICKNESS;
    opacity = clamp((atmosphereOuterRadius - cameraHeight) / (atmosphereOuterRadius - atmosphereInnerRadius), 0.0, 1.0);

    // Alter alpha based on time of day (0.0 = night , 1.0 = day)
    float nightAlpha = (u_radiiAndDynamicAtmosphereColor.z != 0.0) ? clamp(dot(normalize(positionWC), lightDirection), 0.0, 1.0) : 1.0;
    opacity *= pow(nightAlpha, 0.5);
}
`;var p5=`in vec3 v_outerPositionWC;

uniform vec3 u_hsbShift;

#ifndef PER_FRAGMENT_ATMOSPHERE
in vec3 v_mieColor;
in vec3 v_rayleighColor;
in float v_opacity;
in float v_translucent;
#endif

void main (void)
{
    float lightEnum = u_radiiAndDynamicAtmosphereColor.z;
    vec3 lightDirection = czm_getDynamicAtmosphereLightDirection(v_outerPositionWC, lightEnum);

    vec3 mieColor;
    vec3 rayleighColor;
    float opacity;
    float translucent;

    #ifdef PER_FRAGMENT_ATMOSPHERE
        computeAtmosphereScattering(
            v_outerPositionWC,
            lightDirection,
            rayleighColor,
            mieColor,
            opacity,
            translucent
        );
    #else
        mieColor = v_mieColor;
        rayleighColor = v_rayleighColor;
        opacity = v_opacity;
        translucent = v_translucent;
    #endif

    vec4 color = computeAtmosphereColor(v_outerPositionWC, lightDirection, rayleighColor, mieColor, opacity);

    #ifndef HDR
        color.rgb = czm_pbrNeutralTonemapping(color.rgb);
        color.rgb = czm_inverseGamma(color.rgb);
    #endif

    #ifdef COLOR_CORRECT
        const bool ignoreBlackPixels = true;
        color.rgb = czm_applyHSBShift(color.rgb, u_hsbShift, ignoreBlackPixels);
    #endif

    // For the parts of the sky atmosphere that are not behind a translucent globe,
    // we mix in the default opacity so that the sky atmosphere still appears at distance.
    // This is needed because the opacity in the sky atmosphere is initially adjusted based
    // on the camera height.
    if (translucent == 0.0) {
        color.a = mix(color.b, 1.0, color.a) * smoothstep(0.0, 1.0, czm_morphTime);
    }

    out_FragColor = color;
}
`;var _5=`in vec4 position;

out vec3 v_outerPositionWC;

#ifndef PER_FRAGMENT_ATMOSPHERE
out vec3 v_mieColor;
out vec3 v_rayleighColor;
out float v_opacity;
out float v_translucent;
#endif

void main(void)
{
    vec4 positionWC = czm_model * position;
    float lightEnum = u_radiiAndDynamicAtmosphereColor.z;
    vec3 lightDirection = czm_getDynamicAtmosphereLightDirection(positionWC.xyz, lightEnum);

    #ifndef PER_FRAGMENT_ATMOSPHERE
        computeAtmosphereScattering(
            positionWC.xyz,
            lightDirection,
            v_rayleighColor,
            v_mieColor,
            v_opacity,
            v_translucent
        );
    #endif

    v_outerPositionWC = positionWC.xyz;
    gl_Position = czm_modelViewProjection * position;
}
`;function mS(e){e=x(e,ee.WGS84),this.show=!0,this.perFragmentAtmosphere=!1,this._ellipsoid=e;let t=1.025,n=h.multiplyByScalar(e.radii,t,new h);this._scaleMatrix=F.fromScale(n),this._modelMatrix=new F,this._command=new Qe({owner:this,modelMatrix:this._modelMatrix}),this._spSkyFromSpace=void 0,this._spSkyFromAtmosphere=void 0,this._flags=void 0,this.atmosphereLightIntensity=50,this.atmosphereRayleighCoefficient=new h(55e-7,13e-6,284e-7),this.atmosphereMieCoefficient=new h(21e-6,21e-6,21e-6),this.atmosphereRayleighScaleHeight=1e4,this.atmosphereMieScaleHeight=3200,this.atmosphereMieAnisotropy=.9,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this._hueSaturationBrightness=new h;let i=new h;i.x=e.maximumRadius*t,i.y=e.maximumRadius,i.z=0,this._radiiAndDynamicAtmosphereColor=i;let o=this;this._command.uniformMap={u_radiiAndDynamicAtmosphereColor:function(){return o._radiiAndDynamicAtmosphereColor},u_hsbShift:function(){return o._hueSaturationBrightness.x=o.hueShift,o._hueSaturationBrightness.y=o.saturationShift,o._hueSaturationBrightness.z=o.brightnessShift,o._hueSaturationBrightness},u_atmosphereLightIntensity:function(){return o.atmosphereLightIntensity},u_atmosphereRayleighCoefficient:function(){return o.atmosphereRayleighCoefficient},u_atmosphereMieCoefficient:function(){return o.atmosphereMieCoefficient},u_atmosphereRayleighScaleHeight:function(){return o.atmosphereRayleighScaleHeight},u_atmosphereMieScaleHeight:function(){return o.atmosphereMieScaleHeight},u_atmosphereMieAnisotropy:function(){return o.atmosphereMieAnisotropy}}}Object.defineProperties(mS.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});mS.prototype.setDynamicLighting=function(e){this._radiiAndDynamicAtmosphereColor.z=e};var PZ=new F;mS.prototype.update=function(e,t){if(!this.show)return;let n=e.mode;if(n!==ne.SCENE3D&&n!==ne.MORPHING||!e.passes.render)return;let i=F.fromRotationTranslation(e.context.uniformState.inverseViewRotation,h.ZERO,PZ),o=F.multiplyTransformation(i,Vo.Y_UP_TO_Z_UP,PZ),r=F.multiply(this._scaleMatrix,o,PZ);F.clone(r,this._modelMatrix);let s=e.context,a=GCt(this),c=e.globeTranslucencyState.translucent,l=this.perFragmentAtmosphere||c||!u(t)||!t.show,f=this._command;if(!u(f.vertexArray)){let p=da.createGeometry(new da({radii:new h(1,1,1),slicePartitions:256,stackPartitions:256,vertexFormat:Ie.POSITION_ONLY}));f.vertexArray=ii.fromGeometry({context:s,geometry:p,attributeLocations:Nn.createAttributeLocations(p),bufferUsage:ke.STATIC_DRAW}),f.renderState=Ue.fromCache({cull:{enabled:!0,face:Ci.FRONT},blending:un.ALPHA_BLEND,depthMask:!1})}let d=a|l<<2|c<<3;if(d!==this._flags){this._flags=d;let p=[];a&&p.push("COLOR_CORRECT"),l&&p.push("PER_FRAGMENT_ATMOSPHERE"),c&&p.push("GLOBE_TRANSLUCENT");let g=new ze({defines:p,sources:[Xh,yI,_5]}),m=new ze({defines:p,sources:[Xh,yI,p5]});this._spSkyAtmosphere=tn.fromCache({context:s,vertexShaderSource:g,fragmentShaderSource:m}),f.shaderProgram=this._spSkyAtmosphere}return f};function GCt(e){return!(R.equalsEpsilon(e.hueShift,0,R.EPSILON7)&&R.equalsEpsilon(e.saturationShift,0,R.EPSILON7)&&R.equalsEpsilon(e.brightnessShift,0,R.EPSILON7))}mS.prototype.isDestroyed=function(){return!1};mS.prototype.destroy=function(){let e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),this._spSkyAtmosphere=this._spSkyAtmosphere&&this._spSkyAtmosphere.destroy(),ue(this)};var g5=mS;var y5=`uniform samplerCube u_cubeMap;

in vec3 v_texCoord;

void main()
{
    vec4 color = czm_textureCube(u_cubeMap, normalize(v_texCoord));
    out_FragColor = vec4(czm_gammaCorrect(color).rgb, czm_morphTime);
}
`;var x5=`in vec3 position;
out vec3 v_texCoord;

void main()
{
    vec3 p = czm_viewRotation * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));
    gl_Position = czm_projection * vec4(p, 1.0);
    v_texCoord = position.xyz;
}
`;function _S(e){this.sources=e.sources,this._sources=void 0,this.show=x(e.show,!0),this._command=new Qe({modelMatrix:F.clone(F.IDENTITY),owner:this}),this._cubeMap=void 0,this._attributeLocations=void 0,this._useHdr=void 0}_S.prototype.update=function(e,t){let n=this,{mode:i,passes:o,context:r}=e;if(!this.show||i!==ne.SCENE3D&&i!==ne.MORPHING||!o.render)return;if(this._sources!==this.sources){this._sources=this.sources;let a=this.sources;typeof a.positiveX=="string"?HM(r,this._sources).then(function(c){n._cubeMap=n._cubeMap&&n._cubeMap.destroy(),n._cubeMap=c}):(this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this._cubeMap=new Or({context:r,source:a}))}let s=this._command;if(!u(s.vertexArray)){s.uniformMap={u_cubeMap:function(){return n._cubeMap}};let a=Ya.createGeometry(Ya.fromDimensions({dimensions:new h(2,2,2),vertexFormat:Ie.POSITION_ONLY})),c=this._attributeLocations=Nn.createAttributeLocations(a);s.vertexArray=ii.fromGeometry({context:r,geometry:a,attributeLocations:c,bufferUsage:ke.STATIC_DRAW}),s.renderState=Ue.fromCache({blending:un.ALPHA_BLEND})}if(!u(s.shaderProgram)||this._useHdr!==t){let a=new ze({defines:[t?"HDR":""],sources:[y5]});s.shaderProgram=tn.fromCache({context:r,vertexShaderSource:x5,fragmentShaderSource:a,attributeLocations:this._attributeLocations}),this._useHdr=t}if(u(this._cubeMap))return s};_S.prototype.isDestroyed=function(){return!1};_S.prototype.destroy=function(){let e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),ue(this)};function pS(e){return on(`Assets/Textures/SkyBox/tycho2t3_80_${e}.jpg`)}_S.createEarthSkyBox=function(){return new _S({sources:{positiveX:pS("px"),negativeX:pS("mx"),positiveY:pS("py"),negativeY:pS("my"),positiveZ:pS("pz"),negativeZ:pS("mz")}})};var b5=_S;var C5=`uniform sampler2D u_texture;

in vec2 v_textureCoordinates;

void main()
{
    vec4 color = texture(u_texture, v_textureCoordinates);
    out_FragColor = czm_gammaCorrect(color);
}
`;var A5=`uniform float u_radiusTS;

in vec2 v_textureCoordinates;

vec2 rotate(vec2 p, vec2 direction)
{
    return vec2(p.x * direction.x - p.y * direction.y, p.x * direction.y + p.y * direction.x);
}

vec4 addBurst(vec2 position, vec2 direction, float lengthScalar)
{
    vec2 rotatedPosition = rotate(position, direction) * vec2(25.0, 0.75);
    float radius = length(rotatedPosition) * lengthScalar;
    float burst = 1.0 - smoothstep(0.0, 0.55, radius);
    return vec4(burst);
}

void main()
{
    float lengthScalar = 2.0 / sqrt(2.0);
    vec2 position = v_textureCoordinates - vec2(0.5);
    float radius = length(position) * lengthScalar;
    float surface = step(radius, u_radiusTS);
    vec4 color = vec4(vec2(1.0), surface + 0.2, surface);

    float glow = 1.0 - smoothstep(0.0, 0.55, radius);
    color.ba += mix(vec2(0.0), vec2(1.0), glow) * 0.75;

    vec4 burst = vec4(0.0);

    // The following loop has been manually unrolled for speed, to
    // avoid sin() and cos().
    //
    //for (float i = 0.4; i < 3.2; i += 1.047) {
    //    vec2 direction = vec2(sin(i), cos(i));
    //    burst += 0.4 * addBurst(position, direction, lengthScalar);
    //
    //    direction = vec2(sin(i - 0.08), cos(i - 0.08));
    //    burst += 0.3 * addBurst(position, direction, lengthScalar);
    //}

    burst += 0.4 * addBurst(position, vec2(0.38942,  0.92106), lengthScalar);  // angle == 0.4
    burst += 0.4 * addBurst(position, vec2(0.99235,  0.12348), lengthScalar);  // angle == 0.4 + 1.047
    burst += 0.4 * addBurst(position, vec2(0.60327, -0.79754), lengthScalar);  // angle == 0.4 + 1.047 * 2.0

    burst += 0.3 * addBurst(position, vec2(0.31457,  0.94924), lengthScalar);  // angle == 0.4 - 0.08
    burst += 0.3 * addBurst(position, vec2(0.97931,  0.20239), lengthScalar);  // angle == 0.4 + 1.047 - 0.08
    burst += 0.3 * addBurst(position, vec2(0.66507, -0.74678), lengthScalar);  // angle == 0.4 + 1.047 * 2.0 - 0.08

    // End of manual loop unrolling.

    color += clamp(burst, vec4(0.0), vec4(1.0)) * 0.15;

    out_FragColor = clamp(color, vec4(0.0), vec4(1.0));
}
`;var T5=`in vec2 direction;

uniform float u_size;

out vec2 v_textureCoordinates;

void main() 
{
    vec4 position;
    if (czm_morphTime == 1.0)
    {
        position = vec4(czm_sunPositionWC, 1.0);
    }
    else
    {
        position = vec4(czm_sunPositionColumbusView.zxy, 1.0);
    }
    
    vec4 positionEC = czm_view * position;
    vec4 positionWC = czm_eyeToWindowCoordinates(positionEC);
    
    vec2 halfSize = vec2(u_size * 0.5);
    halfSize *= ((direction * 2.0) - 1.0);
    
    gl_Position = czm_viewportOrthographic * vec4(positionWC.xy + halfSize, -positionWC.z, 1.0);
    
    v_textureCoordinates = direction;
}
`;function bI(){this.show=!0,this._drawCommand=new Qe({primitiveType:Ne.TRIANGLES,boundingVolume:new ae,owner:this}),this._commands={drawCommand:this._drawCommand,computeCommand:void 0},this._boundingVolume=new ae,this._boundingVolume2D=new ae,this._texture=void 0,this._drawingBufferWidth=void 0,this._drawingBufferHeight=void 0,this._radiusTS=void 0,this._size=void 0,this.glowFactor=1,this._glowFactorDirty=!1,this._useHdr=void 0;let e=this;this._uniformMap={u_texture:function(){return e._texture},u_size:function(){return e._size}}}Object.defineProperties(bI.prototype,{glowFactor:{get:function(){return this._glowFactor},set:function(e){e=Math.max(e,0),this._glowFactor=e,this._glowFactorDirty=!0}}});var WCt=new H,jCt=new H,qCt=new oe,xI=new oe;bI.prototype.update=function(e,t,n){if(!this.show)return;let i=e.mode;if(i===ne.SCENE2D||i===ne.MORPHING||!e.passes.render)return;let o=e.context,r=t.viewport.width,s=t.viewport.height;if(!u(this._texture)||r!==this._drawingBufferWidth||s!==this._drawingBufferHeight||this._glowFactorDirty||n!==this._useHdr){this._texture=this._texture&&this._texture.destroy(),this._drawingBufferWidth=r,this._drawingBufferHeight=s,this._glowFactorDirty=!1,this._useHdr=n;let E=Math.max(r,s);E=Math.pow(2,Math.ceil(Math.log(E)/Math.log(2))-2),E=Math.max(1,E);let v=n?o.halfFloatingPointTexture?Ke.HALF_FLOAT:Ke.FLOAT:Ke.UNSIGNED_BYTE;this._texture=new Ot({context:o,width:E,height:E,pixelFormat:tt.RGBA,pixelDatatype:v}),this._glowLengthTS=this._glowFactor*5,this._radiusTS=1/(1+2*this._glowLengthTS)*.5;let D=this,O={u_radiusTS:function(){return D._radiusTS}};this._commands.computeCommand=new cl({fragmentShaderSource:A5,outputTexture:this._texture,uniformMap:O,persists:!1,owner:this,postExecute:function(){D._commands.computeCommand=void 0}})}let a=this._drawCommand;if(!u(a.vertexArray)){let E={direction:0},v=new Uint8Array(4*2);v[0]=0,v[1]=0,v[2]=255,v[3]=0,v[4]=255,v[5]=255,v[6]=0,v[7]=255;let D=xt.createVertexBuffer({context:o,typedArray:v,usage:ke.STATIC_DRAW}),O=[{index:E.direction,vertexBuffer:D,componentsPerAttribute:2,normalize:!0,componentDatatype:K.UNSIGNED_BYTE}],P=xt.createIndexBuffer({context:o,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:ke.STATIC_DRAW,indexDatatype:Be.UNSIGNED_SHORT});a.vertexArray=new ii({context:o,attributes:O,indexBuffer:P}),a.shaderProgram=tn.fromCache({context:o,vertexShaderSource:T5,fragmentShaderSource:C5,attributeLocations:E}),a.renderState=Ue.fromCache({blending:un.ALPHA_BLEND}),a.uniformMap=this._uniformMap}let c=o.uniformState.sunPositionWC,l=o.uniformState.sunPositionColumbusView,f=this._boundingVolume,d=this._boundingVolume2D;h.clone(c,f.center),d.center.x=l.z,d.center.y=l.x,d.center.z=l.y,f.radius=R.SOLAR_RADIUS+R.SOLAR_RADIUS*this._glowLengthTS,d.radius=f.radius,i===ne.SCENE3D?ae.clone(f,a.boundingVolume):i===ne.COLUMBUS_VIEW&&ae.clone(d,a.boundingVolume);let p=Wi.computeActualEllipsoidPosition(e,c,xI),g=h.magnitude(h.subtract(p,e.camera.position,xI)),m=o.uniformState.projection,y=qCt;y.x=0,y.y=0,y.z=-g,y.w=1;let b=F.multiplyByVector(m,y,xI),C=Wi.clipToGLWindowCoordinates(t.viewport,b,WCt);y.x=R.SOLAR_RADIUS;let A=F.multiplyByVector(m,y,xI),T=Wi.clipToGLWindowCoordinates(t.viewport,A,jCt);return this._size=H.magnitude(H.subtract(T,C,xI)),this._size=2*this._size*(1+2*this._glowLengthTS),this._size=Math.ceil(this._size),this._commands};bI.prototype.isDestroyed=function(){return!1};bI.prototype.destroy=function(){let e=this._drawCommand;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._texture=this._texture&&this._texture.destroy(),ue(this)};var E5=bI;var iTe=Dr(qI(),1);function YCt(e,t,n){return`    float clipDistance = clip(gl_FragCoord, ${e}, ${t}); 
    vec4 clippingPlanesEdgeColor = vec4(1.0); 
    clippingPlanesEdgeColor.rgb = ${n}.rgb; 
    float clippingPlanesEdgeWidth = ${n}.a; 
    if (clipDistance > 0.0 && clipDistance < clippingPlanesEdgeWidth) 
    { 
        out_FragColor = clippingPlanesEdgeColor;
    } 
`}var S5=YCt;var XCt={modifyFragmentShader:function(t){return t=ze.replaceMain(t,"czm_splitter_main"),t+=`uniform float czm_splitDirection; 
void main() 
{ 
#ifndef SHADOW_MAP
    if (czm_splitDirection < 0.0 && gl_FragCoord.x > czm_splitPosition) discard; 
    if (czm_splitDirection > 0.0 && gl_FragCoord.x < czm_splitPosition) discard; 
#endif
    czm_splitter_main(); 
} 
`,t},addUniforms:function(t,n){n.czm_splitDirection=function(){return t.splitDirection}}},CI=XCt;var Bb={NEEDS_DECODE:0,DECODING:1,READY:2,FAILED:3};function AI(e){this._parsedContent=void 0,this._drawCommand=void 0,this._isTranslucent=!1,this._styleTranslucent=!1,this._constantColor=G.clone(G.DARKGRAY),this._highlightColor=G.clone(G.WHITE),this._pointSize=1,this._rtcCenter=void 0,this._quantizedVolumeScale=void 0,this._quantizedVolumeOffset=void 0,this._styleableShaderAttributes=void 0,this._isQuantized=!1,this._isOctEncoded16P=!1,this._isRGB565=!1,this._hasColors=!1,this._hasNormals=!1,this._hasBatchIds=!1,this._decodingState=Bb.READY,this._dequantizeInShader=!0,this._isQuantizedDraco=!1,this._isOctEncodedDraco=!1,this._quantizedRange=0,this._octEncodedRange=0,this.backFaceCulling=!1,this._backFaceCulling=!1,this.normalShading=!0,this._normalShading=!0,this._opaqueRenderState=void 0,this._translucentRenderState=void 0,this._mode=void 0,this._ready=!1,this._pointsLength=0,this._geometryByteLength=0,this._vertexShaderLoaded=e.vertexShaderLoaded,this._fragmentShaderLoaded=e.fragmentShaderLoaded,this._uniformMapLoaded=e.uniformMapLoaded,this._batchTableLoaded=e.batchTableLoaded,this._pickIdLoaded=e.pickIdLoaded,this._opaquePass=x(e.opaquePass,we.OPAQUE),this._cull=x(e.cull,!0),this.style=void 0,this._style=void 0,this.styleDirty=!1,this.modelMatrix=F.clone(F.IDENTITY),this._modelMatrix=F.clone(F.IDENTITY),this.time=0,this.shadows=xn.ENABLED,this._boundingSphere=void 0,this.clippingPlanes=void 0,this.isClipped=!1,this.clippingPlanesDirty=!1,this.clippingPlanesOriginMatrix=void 0,this.attenuation=!1,this._attenuation=!1,this.geometricError=0,this.geometricErrorScale=1,this.maximumAttenuation=this._pointSize,this.splitDirection=x(e.splitDirection,Wr.NONE),this._splittingEnabled=!1,this._error=void 0,KCt(this,e)}Object.defineProperties(AI.prototype,{pointsLength:{get:function(){return this._pointsLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},ready:{get:function(){return this._ready}},color:{get:function(){return G.clone(this._highlightColor)},set:function(e){this._highlightColor=G.clone(e,this._highlightColor)}},boundingSphere:{get:function(){if(u(this._drawCommand))return this._drawCommand.boundingVolume},set:function(e){this._boundingSphere=ae.clone(e,this._boundingSphere)}}});function KCt(e,t){let n=HA.parse(t.arrayBuffer,t.byteOffset);if(e._parsedContent=n,e._rtcCenter=n.rtcCenter,e._hasNormals=n.hasNormals,e._hasColors=n.hasColors,e._hasBatchIds=n.hasBatchIds,e._isTranslucent=n.isTranslucent,!n.hasBatchIds&&u(n.batchTableBinary)&&(n.styleableProperties=ng.getBinaryProperties(n.pointsLength,n.batchTableJson,n.batchTableBinary)),u(n.draco)){let a=n.draco;e._decodingState=Bb.NEEDS_DECODE,a.dequantizeInShader=e._dequantizeInShader}let i=n.positions;u(i)&&(e._isQuantized=i.isQuantized,e._quantizedVolumeScale=i.quantizedVolumeScale,e._quantizedVolumeOffset=i.quantizedVolumeOffset,e._quantizedRange=i.quantizedRange);let o=n.normals;u(o)&&(e._isOctEncoded16P=o.octEncoded);let r=n.colors;u(r)&&(u(r.constantColor)&&(e._constantColor=G.clone(r.constantColor,e._constantColor),e._hasColors=!1),e._isRGB565=r.isRGB565);let s=n.batchIds;u(n.batchIds)&&(s.name="BATCH_ID",s.semantic="BATCH_ID",s.setIndex=void 0),n.hasBatchIds&&e._batchTableLoaded(n.batchLength,n.batchTableJson,n.batchTableBinary),e._pointsLength=n.pointsLength}var ZCt=new h,$Ct=new h,QCt=new h,tTe,v5;function JCt(e){if(!u(v5)){tTe=new iTe.default(0),v5=new Array(e);for(let t=0;t<e;++t)v5[t]=tTe.random()}return v5}function eAt(e){let n=e.length/3,i=Math.min(n,20),o=JCt(20),r=Number.MAX_VALUE,s=-Number.MAX_VALUE,a=h.fromElements(r,r,r,ZCt),c=h.fromElements(s,s,s,$Ct);for(let f=0;f<i;++f){let d=Math.floor(o[f]*n),p=h.unpack(e,d*3,QCt);h.minimumByComponent(a,p,a),h.maximumByComponent(c,p,c)}let l=ae.fromCornerPoints(a,c);return l.radius+=R.EPSILON2,l}function nTe(e,t){let n=K.fromTypedArray(e);return n===K.INT||n===K.UNSIGNED_INT||n===K.DOUBLE?(At("Cast pnts property to floats",`Point cloud property "${t}" will be cast to a float array because INT, UNSIGNED_INT, and DOUBLE are not valid WebGL vertex attribute types. Some precision may be lost.`),new Float32Array(e)):e}var tAt=new oe,nAt=new oe,iAt=new G,oTe=0,w5=1,NZ=2,rTe=3,oAt=4,RZ=new F,rAt=new F;function sAt(e,t){let n=t.context,i=e._parsedContent,o=e._pointsLength,r=i.positions,s=i.colors,a=i.normals,c=i.batchIds,l=i.styleableProperties,f=u(l),d=e._isQuantized,p=e._isQuantizedDraco,g=e._isOctEncoded16P,m=e._isOctEncodedDraco,y=e._quantizedRange,b=e._octEncodedRange,C=e._isRGB565,A=e._isTranslucent,T=e._hasColors,E=e._hasNormals,v=e._hasBatchIds,D,O,P=[],M={};if(e._styleableShaderAttributes=M,f){let V=oAt;for(let U in l)if(l.hasOwnProperty(U)){let B=l[U],W=nTe(B.typedArray,U);D=B.componentCount,O=K.fromTypedArray(W);let j=xt.createVertexBuffer({context:n,typedArray:W,usage:ke.STATIC_DRAW});e._geometryByteLength+=j.sizeInBytes;let Q={index:V,vertexBuffer:j,componentsPerAttribute:D,componentDatatype:O,normalize:!1,offsetInBytes:0,strideInBytes:0};P.push(Q),M[U]={location:V,componentCount:D},++V}}let L=xt.createVertexBuffer({context:n,typedArray:r.typedArray,usage:ke.STATIC_DRAW});e._geometryByteLength+=L.sizeInBytes;let _;T&&(_=xt.createVertexBuffer({context:n,typedArray:s.typedArray,usage:ke.STATIC_DRAW}),e._geometryByteLength+=_.sizeInBytes);let S;E&&(S=xt.createVertexBuffer({context:n,typedArray:a.typedArray,usage:ke.STATIC_DRAW}),e._geometryByteLength+=S.sizeInBytes);let w;v&&(c.typedArray=nTe(c.typedArray,"batchIds"),w=xt.createVertexBuffer({context:n,typedArray:c.typedArray,usage:ke.STATIC_DRAW}),e._geometryByteLength+=w.sizeInBytes);let I=[];if(d?O=K.UNSIGNED_SHORT:p?O=y<=255?K.UNSIGNED_BYTE:K.UNSIGNED_SHORT:O=K.FLOAT,I.push({index:oTe,vertexBuffer:L,componentsPerAttribute:3,componentDatatype:O,normalize:!1,offsetInBytes:0,strideInBytes:0}),e._cull&&(d||p?e._boundingSphere=ae.fromCornerPoints(h.ZERO,e._quantizedVolumeScale):e._boundingSphere=eAt(r.typedArray)),T)if(C)I.push({index:w5,vertexBuffer:_,componentsPerAttribute:1,componentDatatype:K.UNSIGNED_SHORT,normalize:!1,offsetInBytes:0,strideInBytes:0});else{let V=A?4:3;I.push({index:w5,vertexBuffer:_,componentsPerAttribute:V,componentDatatype:K.UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0})}E&&(g?(D=2,O=K.UNSIGNED_BYTE):m?(D=2,O=b<=255?K.UNSIGNED_BYTE:K.UNSIGNED_SHORT):(D=3,O=K.FLOAT),I.push({index:NZ,vertexBuffer:S,componentsPerAttribute:D,componentDatatype:O,normalize:!1,offsetInBytes:0,strideInBytes:0})),v&&I.push({index:rTe,vertexBuffer:w,componentsPerAttribute:1,componentDatatype:K.fromTypedArray(c.typedArray),normalize:!1,offsetInBytes:0,strideInBytes:0}),f&&(I=I.concat(P));let N=new ii({context:n,attributes:I}),k={depthTest:{enabled:!0}},z={depthTest:{enabled:!0},depthMask:!1,blending:un.ALPHA_BLEND};e._opaquePass===we.CESIUM_3D_TILE&&(k.stencilTest=Ut.setCesium3DTileBit(),k.stencilMask=Ut.CESIUM_3D_TILE_MASK,z.stencilTest=Ut.setCesium3DTileBit(),z.stencilMask=Ut.CESIUM_3D_TILE_MASK),e._opaqueRenderState=Ue.fromCache(k),e._translucentRenderState=Ue.fromCache(z),e._drawCommand=new Qe({boundingVolume:new ae,cull:e._cull,modelMatrix:new F,primitiveType:Ne.POINTS,vertexArray:N,count:o,shaderProgram:void 0,uniformMap:void 0,renderState:A?e._translucentRenderState:e._opaqueRenderState,pass:A?we.TRANSLUCENT:e._opaquePass,owner:e,castShadows:!1,receiveShadows:!1,pickId:e._pickIdLoaded()})}function aAt(e,t){let n=t.context,i=e._isQuantized,o=e._isQuantizedDraco,r=e._isOctEncodedDraco,s={u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier:function(){let a=tAt;if(a.x=e._attenuation?e.maximumAttenuation:e._pointSize,a.x*=t.pixelRatio,a.y=e.time,e._attenuation){let c=t.camera.frustum,l;t.mode===ne.SCENE2D||c instanceof sn?l=Number.POSITIVE_INFINITY:l=n.drawingBufferHeight/t.camera.frustum.sseDenominator,a.z=e.geometricError*e.geometricErrorScale,a.w=l}return a},u_highlightColor:function(){return e._highlightColor},u_constantColor:function(){return e._constantColor},u_clippingPlanes:function(){let a=e.clippingPlanes;return e.isClipped?a.texture:n.defaultTexture},u_clippingPlanesEdgeStyle:function(){let a=e.clippingPlanes;if(!u(a))return G.TRANSPARENT;let c=G.clone(a.edgeColor,iAt);return c.alpha=a.edgeWidth,c},u_clippingPlanesMatrix:function(){let a=e.clippingPlanes;if(!u(a))return F.IDENTITY;let c=x(e.clippingPlanesOriginMatrix,e._modelMatrix);F.multiply(n.uniformState.view3D,c,RZ);let l=F.multiply(RZ,a.modelMatrix,RZ);return F.inverseTranspose(l,rAt)}};CI.addUniforms(e,s),(i||o||r)&&(s=bt(s,{u_quantizedVolumeScaleAndOctEncodedRange:function(){let a=nAt;if(u(e._quantizedVolumeScale)){let c=h.clone(e._quantizedVolumeScale,a);h.divideByScalar(c,e._quantizedRange,a)}return a.w=e._octEncodedRange,a}})),u(e._uniformMapLoaded)&&(s=e._uniformMapLoaded(s)),e._drawCommand.uniformMap=s}function OZ(e,t){let n=/czm_3dtiles_property_(\d+)/g,i=n.exec(e);for(;i!==null;){let o=parseInt(i[1]);t.indexOf(o)===-1&&t.push(o),i=n.exec(e)}}function MZ(e,t){e=e.slice(e.indexOf(`
`));let n=/czm_3dtiles_builtin_property_(\w+)/g,i=n.exec(e);for(;i!==null;){let o=i[1];t.indexOf(o)===-1&&t.push(o),i=n.exec(e)}}function LZ(e,t){let n=e.numberOfAttributes;for(let i=0;i<n;++i){let o=e.getAttribute(i);if(o.index===t)return o}}var cAt={POSITION:"czm_3dtiles_builtin_property_POSITION",POSITION_ABSOLUTE:"czm_3dtiles_builtin_property_POSITION_ABSOLUTE",COLOR:"czm_3dtiles_builtin_property_COLOR",NORMAL:"czm_3dtiles_builtin_property_NORMAL"};function lAt(e,t,n){let i,o,r,s=t.context,a=u(n),c=e._isQuantized,l=e._isQuantizedDraco,f=e._isOctEncoded16P,d=e._isOctEncodedDraco,p=e._isRGB565,g=e._isTranslucent,m=e._hasColors,y=e._hasNormals,b=e._hasBatchIds,C=e._backFaceCulling,A=e._normalShading,T=e._drawCommand.vertexArray,E=e.clippingPlanes,v=e._attenuation,D,O,P,M=g,L=Ge(cAt),_={},S=e._styleableShaderAttributes;for(o in S)S.hasOwnProperty(o)&&(r=S[o],L[o]=`czm_3dtiles_property_${r.location}`,_[r.location]=r);if(a){let re={translucent:!1},pe="(vec3 czm_3dtiles_builtin_property_POSITION, vec3 czm_3dtiles_builtin_property_POSITION_ABSOLUTE, vec4 czm_3dtiles_builtin_property_COLOR, vec3 czm_3dtiles_builtin_property_NORMAL)";D=n.getColorShaderFunction(`getColorFromStyle${pe}`,L,re),O=n.getShowShaderFunction(`getShowFromStyle${pe}`,L,re),P=n.getPointSizeShaderFunction(`getPointSizeFromStyle${pe}`,L,re),u(D)&&re.translucent&&(M=!0)}e._styleTranslucent=M;let w=u(D),I=u(O),N=u(P),k=e.isClipped,z=[],V=[];w&&(OZ(D,z),MZ(D,V)),I&&(OZ(O,z),MZ(O,V)),N&&(OZ(P,z),MZ(P,V));let U=V.indexOf("COLOR")>=0,B=V.indexOf("NORMAL")>=0;if(B&&!y)throw new ce("Style references the NORMAL semantic but the point cloud does not have normals");for(o in S)if(S.hasOwnProperty(o)){r=S[o];let re=z.indexOf(r.location)>=0,pe=LZ(T,r.location);pe.enabled=re}let W=m&&(!w||U);if(m){let re=LZ(T,w5);re.enabled=W}let j=y&&(A||C||B);if(y){let re=LZ(T,NZ);re.enabled=j}let Q={a_position:oTe};W&&(Q.a_color=w5),j&&(Q.a_normal=NZ),b&&(Q.a_batchId=rTe);let q="",X=z.length;for(i=0;i<X;++i){let re=z[i];r=_[re];let pe=r.componentCount,ye=`czm_3dtiles_property_${re}`,Se;pe===1?Se="float":Se=`vec${pe}`,q+=`in ${Se} ${ye}; 
`,Q[ye]=r.location}aAt(e,t);let Z=`in vec3 a_position; 
out vec4 v_color; 
uniform vec4 u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier; 
uniform vec4 u_constantColor; 
uniform vec4 u_highlightColor; 
`;Z+=`float u_pointSize; 
float tiles3d_tileset_time; 
`,v&&(Z+=`float u_geometricError; 
float u_depthMultiplier; 
`),Z+=q,W&&(g?Z+=`in vec4 a_color; 
`:p?Z+=`in float a_color; 
const float SHIFT_RIGHT_11 = 1.0 / 2048.0; 
const float SHIFT_RIGHT_5 = 1.0 / 32.0; 
const float SHIFT_LEFT_11 = 2048.0; 
const float SHIFT_LEFT_5 = 32.0; 
const float NORMALIZE_6 = 1.0 / 64.0; 
const float NORMALIZE_5 = 1.0 / 32.0; 
`:Z+=`in vec3 a_color; 
`),j&&(f||d?Z+=`in vec2 a_normal; 
`:Z+=`in vec3 a_normal; 
`),b&&(Z+=`in float a_batchId; 
`),(c||l||d)&&(Z+=`uniform vec4 u_quantizedVolumeScaleAndOctEncodedRange; 
`),w&&(Z+=D),I&&(Z+=O),N&&(Z+=P),Z+=`void main() 
{ 
    u_pointSize = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.x; 
    tiles3d_tileset_time = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.y; 
`,v&&(Z+=`    u_geometricError = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.z; 
    u_depthMultiplier = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.w; 
`),W?g?Z+=`    vec4 color = a_color; 
`:p?Z+=`    float compressed = a_color; 
    float r = floor(compressed * SHIFT_RIGHT_11); 
    compressed -= r * SHIFT_LEFT_11; 
    float g = floor(compressed * SHIFT_RIGHT_5); 
    compressed -= g * SHIFT_LEFT_5; 
    float b = compressed; 
    vec3 rgb = vec3(r * NORMALIZE_5, g * NORMALIZE_6, b * NORMALIZE_5); 
    vec4 color = vec4(rgb, 1.0); 
`:Z+=`    vec4 color = vec4(a_color, 1.0); 
`:Z+=`    vec4 color = u_constantColor; 
`,c||l?Z+=`    vec3 position = a_position * u_quantizedVolumeScaleAndOctEncodedRange.xyz; 
`:Z+=`    vec3 position = a_position; 
`,Z+=`    vec3 position_absolute = vec3(czm_model * vec4(position, 1.0)); 
`,j?(f?Z+=`    vec3 normal = czm_octDecode(a_normal); 
`:d?Z+=`    vec3 normal = czm_octDecode(a_normal, u_quantizedVolumeScaleAndOctEncodedRange.w).zxy; 
`:Z+=`    vec3 normal = a_normal; 
`,Z+=`    vec3 normalEC = czm_normal * normal; 
`):Z+=`    vec3 normal = vec3(1.0); 
`,w&&(Z+=`    color = getColorFromStyle(position, position_absolute, color, normal); 
`),I&&(Z+=`    float show = float(getShowFromStyle(position, position_absolute, color, normal)); 
`),N?Z+=`    gl_PointSize = getPointSizeFromStyle(position, position_absolute, color, normal) * czm_pixelRatio; 
`:v?Z+=`    vec4 positionEC = czm_modelView * vec4(position, 1.0); 
    float depth = -positionEC.z; 
    gl_PointSize = min((u_geometricError / depth) * u_depthMultiplier, u_pointSize); 
`:Z+=`    gl_PointSize = u_pointSize; 
`,Z+=`    color = color * u_highlightColor; 
`,j&&A&&(Z+=`    float diffuseStrength = czm_getLambertDiffuse(czm_lightDirectionEC, normalEC); 
    diffuseStrength = max(diffuseStrength, 0.4); 
    color.xyz *= diffuseStrength * czm_lightColor; 
`),Z+=`    v_color = color; 
    gl_Position = czm_modelViewProjection * vec4(position, 1.0); 
`,j&&C&&(Z+=`    float visible = step(-normalEC.z, 0.0); 
    gl_Position *= visible; 
    gl_PointSize *= visible; 
`),I&&(Z+=`    gl_Position.w *= float(show); 
    gl_PointSize *= float(show); 
`),Z+=`} 
`;let fe=`in vec4 v_color; 
`;k&&(fe+=`uniform highp sampler2D u_clippingPlanes; 
uniform mat4 u_clippingPlanesMatrix; 
uniform vec4 u_clippingPlanesEdgeStyle; 
`,fe+=`
`,fe+=Q0(E,s),fe+=`
`),fe+=`void main() 
{ 
    out_FragColor = czm_gammaCorrect(v_color); 
`,k&&(fe+=S5("u_clippingPlanes","u_clippingPlanesMatrix","u_clippingPlanesEdgeStyle")),fe+=`} 
`,e.splitDirection!==Wr.NONE&&(fe=CI.modifyFragmentShader(fe)),u(e._vertexShaderLoaded)&&(Z=e._vertexShaderLoaded(Z)),u(e._fragmentShaderLoaded)&&(fe=e._fragmentShaderLoaded(fe));let xe=e._drawCommand;u(xe.shaderProgram)&&xe.shaderProgram.destroy(),xe.shaderProgram=tn.fromCache({context:s,vertexShaderSource:Z,fragmentShaderSource:fe,attributeLocations:Q});try{xe.shaderProgram._bind()}catch{throw new ce("Error generating style shader: this may be caused by a type mismatch, index out-of-bounds, or other syntax error.")}}function uAt(e,t){if(e._decodingState===Bb.READY)return!1;if(e._decodingState===Bb.NEEDS_DECODE){let n=e._parsedContent,i=n.draco,o=fg.decodePointCloud(i,t);u(o)&&(e._decodingState=Bb.DECODING,o.then(function(r){e._decodingState=Bb.READY;let s=u(r.POSITION)?r.POSITION.array:void 0,a=u(r.RGB)?r.RGB.array:void 0,c=u(r.RGBA)?r.RGBA.array:void 0,l=u(r.NORMAL)?r.NORMAL.array:void 0,f=u(r.BATCH_ID)?r.BATCH_ID.array:void 0,d=u(s)&&u(r.POSITION.data.quantization),p=u(l)&&u(r.NORMAL.data.quantization);if(d){let b=r.POSITION.data.quantization,C=b.range;e._quantizedVolumeScale=h.fromElements(C,C,C),e._quantizedVolumeOffset=h.unpack(b.minValues),e._quantizedRange=(1<<b.quantizationBits)-1,e._isQuantizedDraco=!0}p&&(e._octEncodedRange=(1<<r.NORMAL.data.quantization.quantizationBits)-1,e._isOctEncodedDraco=!0);let g=n.styleableProperties,m=i.batchTableProperties;for(let b in m)if(m.hasOwnProperty(b)){let C=r[b];u(g)||(g={}),g[b]={typedArray:C.array,componentCount:C.data.componentsPerAttribute}}u(s)&&(n.positions={typedArray:s});let y=x(c,a);u(y)&&(n.colors={typedArray:y}),u(l)&&(n.normals={typedArray:l}),u(f)&&(n.batchIds={typedArray:f}),n.styleableProperties=g}).catch(function(r){e._decodingState=Bb.FAILED,e._error=r}))}return!0}var fAt=new oe,dAt=new h;AI.prototype.update=function(e){let t=e.context;if(u(this._error)){let l=this._error;throw this._error=void 0,l}if(uAt(this,t))return;let i=!1,o=!F.equals(this._modelMatrix,this.modelMatrix);if(this._mode!==e.mode&&(this._mode=e.mode,o=!0),u(this._drawCommand)||(sAt(this,e),o=!0,i=!0,this._ready=!0,this._parsedContent=void 0),o){F.clone(this.modelMatrix,this._modelMatrix);let l=this._drawCommand.modelMatrix;if(F.clone(this._modelMatrix,l),u(this._rtcCenter)&&F.multiplyByTranslation(l,this._rtcCenter,l),u(this._quantizedVolumeOffset)&&F.multiplyByTranslation(l,this._quantizedVolumeOffset,l),e.mode!==ne.SCENE3D){let d=e.mapProjection,p=F.getColumn(l,3,fAt);oe.equals(p,oe.UNIT_W)||Lt.basisTo2D(d,l,l)}let f=this._drawCommand.boundingVolume;if(ae.clone(this._boundingSphere,f),this._cull){let d=f.center;F.multiplyByPoint(l,d,d);let p=F.getScale(l,dAt);f.radius*=h.maximumComponent(p)}}this.clippingPlanesDirty&&(this.clippingPlanesDirty=!1,i=!0),this._attenuation!==this.attenuation&&(this._attenuation=this.attenuation,i=!0),this.backFaceCulling!==this._backFaceCulling&&(this._backFaceCulling=this.backFaceCulling,i=!0),this.normalShading!==this._normalShading&&(this._normalShading=this.normalShading,i=!0),(this._style!==this.style||this.styleDirty)&&(this._style=this.style,this.styleDirty=!1,i=!0);let r=this.splitDirection!==Wr.NONE;this._splittingEnabled!==r&&(this._splittingEnabled=r,i=!0),i&&lAt(this,e,this._style),this._drawCommand.castShadows=xn.castShadows(this.shadows),this._drawCommand.receiveShadows=xn.receiveShadows(this.shadows);let s=this._highlightColor.alpha<1||this._constantColor.alpha<1||this._styleTranslucent;this._drawCommand.renderState=s?this._translucentRenderState:this._opaqueRenderState,this._drawCommand.pass=s?we.TRANSLUCENT:this._opaquePass;let a=e.commandList,c=e.passes;(c.render||c.pick)&&a.push(this._drawCommand)};AI.prototype.isDestroyed=function(){return!1};AI.prototype.destroy=function(){let e=this._drawCommand;return u(e)&&(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy()),ue(this)};var D5=AI;function Vb(e){e=x(e,x.EMPTY_OBJECT),this.show=x(e.show,!0),this.modelMatrix=F.clone(x(e.modelMatrix,F.IDENTITY)),this.shadows=x(e.shadows,xn.ENABLED),this.maximumMemoryUsage=x(e.maximumMemoryUsage,256),this.shading=new Tp(e.shading),this.style=e.style,this.frameFailed=new me,this.frameChanged=new me,this._clock=e.clock,this._intervals=e.intervals,this._clippingPlanes=void 0,this.clippingPlanes=e.clippingPlanes,this._pointCloudEyeDomeLighting=new Ig,this._loadTimestamp=void 0,this._clippingPlanesState=0,this._styleDirty=!1,this._pickId=void 0,this._totalMemoryUsageInBytes=0,this._frames=[],this._previousInterval=void 0,this._nextInterval=void 0,this._lastRenderedFrame=void 0,this._clockMultiplier=0,this._runningSum=0,this._runningLength=0,this._runningIndex=0,this._runningSamples=new Array(5).fill(0),this._runningAverage=0}Object.defineProperties(Vb.prototype,{clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){As.setOwner(e,this,"_clippingPlanes")}},totalMemoryUsageInBytes:{get:function(){return this._totalMemoryUsageInBytes}},boundingSphere:{get:function(){if(u(this._lastRenderedFrame))return this._lastRenderedFrame.pointCloud.boundingSphere}}});function hAt(e){return`uniform vec4 czm_pickColor;
${e}`}function mAt(e){return function(t){return bt(t,{czm_pickColor:function(){return e._pickId.color}})}}function pAt(){return"czm_pickColor"}Vb.prototype.makeStyleDirty=function(){this._styleDirty=!0};Vb.prototype._getAverageLoadTime=function(){return this._runningLength===0?.05:this._runningAverage};var _At=new $;function BZ(e){let t=e._clock,n=t.canAnimate&&t.shouldAnimate,i=t.multiplier;return n?i:0}function kb(e,t){return e._intervals.indexOf(t.start)}function gAt(e,t){let n=e._intervals,i=e._clock,o=BZ(e);if(o===0)return;let r=e._getAverageLoadTime(),s=$.addSeconds(i.currentTime,r*o,_At),a=n.indexOf(s),c=kb(e,t);return a===c&&(o>=0?++a:--a),n.get(a)}function yAt(e){let t=e._intervals,i=e._clock.currentTime,o=t.indexOf(i);return t.get(o)}function xAt(e,t,n){let i=BZ(e),o=kb(e,t),r=kb(e,n);return i>=0?o>=r:o<=r}function aTe(e,t){return function(n){let i=u(n.message)?n.message:n.toString();e.frameFailed.numberOfListeners>0?e.frameFailed.raiseEvent({uri:t,message:i}):(console.log(`A frame failed to load: ${t}`),console.log(`Error: ${i}`))}}function bAt(e,t,n){let i=kb(e,t),o=e._frames,r=o[i];if(!u(r)){let s=t.data.transform,a=u(s)?F.fromArray(s):void 0,c=t.data.uri;r={pointCloud:void 0,transform:a,timestamp:Ei(),sequential:!0,ready:!1,touchedFrameNumber:n.frameNumber,uri:c},o[i]=r,De.fetchArrayBuffer({url:c}).then(function(l){r.pointCloud=new D5({arrayBuffer:l,cull:!0,fragmentShaderLoaded:hAt,uniformMapLoaded:mAt(e),pickIdLoaded:pAt})}).catch(aTe(e,c))}return r}function CAt(e,t){e._runningSum+=t,e._runningSum-=e._runningSamples[e._runningIndex],e._runningSamples[e._runningIndex]=t,e._runningLength=Math.min(e._runningLength+1,e._runningSamples.length),e._runningIndex=(e._runningIndex+1)%e._runningSamples.length,e._runningAverage=e._runningSum/e._runningLength}function AAt(e,t,n,i){t.touchedFrameNumber<i.frameNumber-1&&(t.sequential=!1);let o=t.pointCloud;if(u(o)&&!t.ready){let r=i.commandList,s=r.length;if(cTe(e,t,n,i),o.ready&&(t.ready=!0,e._totalMemoryUsageInBytes+=o.geometryByteLength,r.length=s,t.sequential)){let a=(Ei()-t.timestamp)/1e3;CAt(e,a)}}t.touchedFrameNumber=i.frameNumber}var TAt=new F;function EAt(e,t){let n=e.shading;return u(n)&&u(n.baseResolution)?n.baseResolution:u(t.boundingSphere)?R.cbrt(t.boundingSphere.volume()/t.pointsLength):0}function SAt(e){let t=e.shading;return u(t)&&u(t.maximumAttenuation)?t.maximumAttenuation:10}var vAt=new Tp;function cTe(e,t,n,i){let o=x(e.shading,vAt),r=t.pointCloud,s=x(t.transform,F.IDENTITY);r.modelMatrix=F.multiplyTransformation(e.modelMatrix,s,TAt),r.style=e.style,r.time=n.timeSinceLoad,r.shadows=e.shadows,r.clippingPlanes=e._clippingPlanes,r.isClipped=n.isClipped,r.attenuation=o.attenuation,r.backFaceCulling=o.backFaceCulling,r.normalShading=o.normalShading,r.geometricError=EAt(e,r),r.geometricErrorScale=o.geometricErrorScale,r.maximumAttenuation=SAt(e);try{r.update(i)}catch(a){aTe(e,t.uri)(a)}t.touchedFrameNumber=i.frameNumber}function FZ(e,t,n,i){let o=bAt(e,t,i);AAt(e,o,n,i)}function wAt(e){return function(t){return t.touchedFrameNumber<e.frameNumber}}function lTe(e,t){let n=e._frames,i=n.length;for(let o=0;o<i;++o){let r=n[o];if(u(r)&&(!u(t)||t(r))){let s=r.pointCloud;r.ready&&(e._totalMemoryUsageInBytes-=s.geometryByteLength),u(s)&&s.destroy(),r===e._lastRenderedFrame&&(e._lastRenderedFrame=void 0),n[o]=void 0}}}function DAt(e,t){let n=kb(e,t),i=e._frames[n];if(u(i)&&i.ready)return i}function sTe(e,t,n,i,o){return u(n)?n.ready?!0:(FZ(e,t,i,o),n.ready):!1}function IAt(e,t,n,i,o){let r,s,a,c=e._intervals,l=e._frames,f=kb(e,n),d=kb(e,t);if(f>=d){for(r=f;r>=d;--r)if(s=c.get(r),a=l[r],sTe(e,s,a,i,o))return s}else for(r=f;r<=d;++r)if(s=c.get(r),a=l[r],sTe(e,s,a,i,o))return s;return t}function PAt(e,t,n){let i=e._frames,o=i.length;for(let r=0;r<o;++r){let s=i[r];u(s)&&u(s.pointCloud)&&(s.pointCloud.clippingPlanesDirty=t,s.pointCloud.styleDirty=n)}}var gS={timeSinceLoad:0,isClipped:!1,clippingPlanesDirty:!1};Vb.prototype.update=function(e){if(e.mode===ne.MORPHING||!this.show)return;u(this._pickId)||(this._pickId=e.context.createPickId({primitive:this})),u(this._loadTimestamp)||(this._loadTimestamp=$.clone(e.time));let t=Math.max($.secondsDifference(e.time,this._loadTimestamp)*1e3,0),n=this._clippingPlanes,i=0,o=!1,r=u(n)&&n.enabled;r&&(n.update(e),i=n.clippingPlanesState),this._clippingPlanesState!==i&&(this._clippingPlanesState=i,o=!0);let s=this._styleDirty;this._styleDirty=!1,(o||s)&&PAt(this,o,s),gS.timeSinceLoad=t,gS.isClipped=r;let a=this.shading,c=this._pointCloudEyeDomeLighting,l=e.commandList,f=l.length,d=this._previousInterval,p=this._nextInterval,g=yAt(this);if(!u(g))return;let m=!1,y=BZ(this),b=y===0;y!==this._clockMultiplier&&(m=!0,this._clockMultiplier=y),(!u(d)||b)&&(d=g),(!u(p)||m||xAt(this,g,p))&&(p=gAt(this,g)),d=IAt(this,d,g,gS,e);let C=DAt(this,d);u(C)||(FZ(this,d,gS,e),C=this._lastRenderedFrame),u(C)&&cTe(this,C,gS,e),u(p)&&FZ(this,p,gS,e);let A=this;u(C)&&!u(this._lastRenderedFrame)&&e.afterRender.push(function(){return!0}),u(C)&&C!==this._lastRenderedFrame&&A.frameChanged.numberOfListeners>0&&e.afterRender.push(function(){return A.frameChanged.raiseEvent(A),!0}),this._previousInterval=d,this._nextInterval=p,this._lastRenderedFrame=C;let T=this._totalMemoryUsageInBytes,E=this.maximumMemoryUsage*1024*1024;T>E&&lTe(this,wAt(e));let D=l.length-f;u(a)&&a.attenuation&&a.eyeDomeLighting&&D>0&&c.update(e,f,a,this.boundingSphere)};Vb.prototype.isDestroyed=function(){return!1};Vb.prototype.destroy=function(){return lTe(this),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),this._pickId=this._pickId&&this._pickId.destroy(),ue(this)};var TI=Vb;function uTe(e,t){if(u(t)){let n=t.clock;u(n)&&n.getValue(e)}}function RAt(e){e._renderLoopRunning=!0;let t=0;function n(i){if(!e.isDestroyed())if(e._useDefaultRenderLoop)try{let o=e._targetFrameRate;if(!u(o))e.resize(),e.render(),requestAnimationFrame(n);else{let r=1e3/o,s=i-t;s>r&&(e.resize(),e.render(),t=i-s%r),requestAnimationFrame(n)}}catch(o){e._useDefaultRenderLoop=!1,e._renderLoopRunning=!1,e._showRenderLoopErrors&&e.showErrorPanel("An error occurred while rendering.  Rendering has stopped.",void 0,o)}else e._renderLoopRunning=!1}requestAnimationFrame(n)}function fTe(e){let t=e._useBrowserRecommendedResolution?1:window.devicePixelRatio;return t*=e._resolutionScale,u(e._scene)&&(e._scene.pixelRatio=t),t}function dTe(e){let t=e._canvas,n=t.clientWidth,i=t.clientHeight,o=fTe(e);e._canvasClientWidth=n,e._canvasClientHeight=i,n*=o,i*=o,t.width=n,t.height=i,e._canRender=n!==0&&i!==0,e._lastDevicePixelRatio=window.devicePixelRatio}function hTe(e){let t=e._canvas,n=t.width,i=t.height;if(n!==0&&i!==0){let o=e._scene.camera.frustum;u(o.aspectRatio)?o.aspectRatio=n/i:(o.top=o.right*(i/n),o.bottom=-o.top)}}function wo(e,t){e=Rn(e),t=x(t,x.EMPTY_OBJECT);let n=document.createElement("div");n.className="cesium-widget",e.appendChild(n);let i=document.createElement("canvas"),o=Wt.supportsImageRenderingPixelated();this._supportsImageRenderingPixelated=o,o&&(i.style.imageRendering=Wt.imageRenderingValue()),i.oncontextmenu=function(){return!1},i.onselectstart=function(){return!1};function r(){i!==i.ownerDocument.activeElement&&i.ownerDocument.activeElement.blur()}x(t.blurActiveElementOnCanvasFocus,!0)&&(i.addEventListener("mousedown",r),i.addEventListener("pointerdown",r)),n.appendChild(i);let a=document.createElement("div");a.className="cesium-widget-credits";let c=u(t.creditContainer)?Rn(t.creditContainer):n;c.appendChild(a);let l=u(t.creditViewport)?Rn(t.creditViewport):n,f=x(t.showRenderLoopErrors,!0),d=x(t.useBrowserRecommendedResolution,!0);this._element=n,this._container=e,this._canvas=i,this._canvasClientWidth=0,this._canvasClientHeight=0,this._lastDevicePixelRatio=0,this._creditViewport=l,this._creditContainer=c,this._innerCreditContainer=a,this._canRender=!1,this._renderLoopRunning=!1,this._showRenderLoopErrors=f,this._resolutionScale=1,this._useBrowserRecommendedResolution=d,this._forceResize=!1,this._entityView=void 0,this._clockTrackedDataSource=void 0,this._trackedEntity=void 0,this._needTrackedEntityUpdate=!1,this._zoomIsFlight=!1,this._zoomTarget=void 0,this._zoomPromise=void 0,this._zoomOptions=void 0,this._trackedEntityChanged=new me,this._allowDataSourcesToSuspendAnimation=!0,this._clock=u(t.clock)?t.clock:new cm,u(t.shouldAnimate)&&(this._clock.shouldAnimate=t.shouldAnimate),dTe(this);try{let p=x(t.ellipsoid,ee.default),g=new m5({canvas:i,contextOptions:t.contextOptions,creditContainer:a,creditViewport:l,ellipsoid:p,mapProjection:t.mapProjection,orderIndependentTranslucency:t.orderIndependentTranslucency,scene3DOnly:x(t.scene3DOnly,!1),shadows:t.shadows,mapMode2D:t.mapMode2D,requestRenderMode:t.requestRenderMode,maximumRenderTimeChange:t.maximumRenderTimeChange,depthPlaneEllipsoidOffset:t.depthPlaneEllipsoidOffset,msaaSamples:t.msaaSamples});this._scene=g,g.camera.constrainedAxis=h.UNIT_Z,fTe(this),hTe(this);let m=t.globe;u(m)||(m=new nz(p)),m!==!1&&(g.globe=m,g.globe.shadows=x(t.terrainShadows,xn.RECEIVE_ONLY));let y=t.skyBox;!u(y)&&ee.WGS84.equals(p)&&(y=b5.createEarthSkyBox()),y!==!1&&(g.skyBox=y,g.sun=new E5,ee.WGS84.equals(p)&&(g.moon=new az));let b=t.skyAtmosphere;!u(b)&&ee.WGS84.equals(p)&&(b=new g5(p),b.show=t.globe!==!1&&m.show),b!==!1&&(g.skyAtmosphere=b);let C=t.baseLayer;t.globe!==!1&&C!==!1&&(u(C)||(C=dc.fromWorldImagery()),g.imageryLayers.add(C)),u(t.terrainProvider)&&t.globe!==!1&&(g.terrainProvider=t.terrainProvider),u(t.terrain)&&t.globe!==!1&&g.setTerrain(t.terrain),this._screenSpaceEventHandler=new Wf(i),u(t.sceneMode)&&(t.sceneMode===ne.SCENE2D&&this._scene.morphTo2D(0),t.sceneMode===ne.COLUMBUS_VIEW&&this._scene.morphToColumbusView(0)),this._useDefaultRenderLoop=void 0,this.useDefaultRenderLoop=x(t.useDefaultRenderLoop,!0),this._targetFrameRate=void 0,this.targetFrameRate=t.targetFrameRate;let A=this;this._onRenderError=function(P,M){A._useDefaultRenderLoop=!1,A._renderLoopRunning=!1,A._showRenderLoopErrors&&A.showErrorPanel("An error occurred while rendering.  Rendering has stopped.",void 0,M)},g.renderError.addEventListener(this._onRenderError);let T=t.dataSources,E=!1;u(T)||(T=new mk,E=!0);let v=new n4({scene:g,dataSourceCollection:T}),D=new Ar;this._dataSourceChangedListeners={},this._automaticallyTrackDataSourceClocks=t.automaticallyTrackDataSourceClocks??!0,this._dataSourceCollection=T,this._destroyDataSourceCollection=E,this._dataSourceDisplay=v,this._eventHelper=D,this._canAnimateUpdateCallback=this._updateCanAnimate,D.add(this._clock.onTick,wo.prototype._onTick,this),D.add(g.morphStart,wo.prototype._clearTrackedObject,this),D.add(T.dataSourceAdded,wo.prototype._onDataSourceAdded,this),D.add(T.dataSourceRemoved,wo.prototype._onDataSourceRemoved,this),D.add(g.postRender,wo.prototype._postRender,this);let O=T.length;for(let P=0;P<O;P++)this._dataSourceAdded(T,T.get(P));this._dataSourceAdded(void 0,v.defaultDataSource),D.add(T.dataSourceAdded,wo.prototype._dataSourceAdded,this),D.add(T.dataSourceRemoved,wo.prototype._dataSourceRemoved,this)}catch(p){throw f&&this.showErrorPanel("Error constructing CesiumWidget.",'Visit <a href="http://get.webgl.org">http://get.webgl.org</a> to verify that your web browser and hardware support WebGL.  Consider trying a different web browser or updating your video drivers.  Detailed error information is below:',p),p}}Object.defineProperties(wo.prototype,{container:{get:function(){return this._container}},canvas:{get:function(){return this._canvas}},creditContainer:{get:function(){return this._creditContainer}},creditViewport:{get:function(){return this._creditViewport}},scene:{get:function(){return this._scene}},imageryLayers:{get:function(){return this._scene.imageryLayers}},terrainProvider:{get:function(){return this._scene.terrainProvider},set:function(e){this._scene.terrainProvider=e}},creditDisplay:{get:function(){return this._scene.frameState.creditDisplay}},dataSourceDisplay:{get:function(){return this._dataSourceDisplay}},entities:{get:function(){return this._dataSourceDisplay.defaultDataSource.entities}},dataSources:{get:function(){return this._dataSourceCollection}},camera:{get:function(){return this._scene.camera}},ellipsoid:{get:function(){return this._scene.ellipsoid}},clock:{get:function(){return this._clock}},screenSpaceEventHandler:{get:function(){return this._screenSpaceEventHandler}},targetFrameRate:{get:function(){return this._targetFrameRate},set:function(e){this._targetFrameRate=e}},useDefaultRenderLoop:{get:function(){return this._useDefaultRenderLoop},set:function(e){this._useDefaultRenderLoop!==e&&(this._useDefaultRenderLoop=e,e&&!this._renderLoopRunning&&RAt(this))}},resolutionScale:{get:function(){return this._resolutionScale},set:function(e){this._resolutionScale!==e&&(this._resolutionScale=e,this._forceResize=!0)}},useBrowserRecommendedResolution:{get:function(){return this._useBrowserRecommendedResolution},set:function(e){this._useBrowserRecommendedResolution!==e&&(this._useBrowserRecommendedResolution=e,this._forceResize=!0)}},allowDataSourcesToSuspendAnimation:{get:function(){return this._allowDataSourcesToSuspendAnimation},set:function(e){this._allowDataSourcesToSuspendAnimation=e}},trackedEntity:{get:function(){return this._trackedEntity},set:function(e){if(this._trackedEntity!==e){this._trackedEntity=e,kZ(this);let t=this.scene,n=t.mode;!u(e)||!u(e.position)?(this._needTrackedEntityUpdate=!1,(n===ne.COLUMBUS_VIEW||n===ne.SCENE2D)&&(t.screenSpaceCameraController.enableTranslate=!0),(n===ne.COLUMBUS_VIEW||n===ne.SCENE3D)&&(t.screenSpaceCameraController.enableTilt=!0),this._entityView=void 0,this.camera.lookAtTransform(F.IDENTITY)):this._needTrackedEntityUpdate=!0,this._trackedEntityChanged.raiseEvent(e),this.scene.requestRender()}}},trackedEntityChanged:{get:function(){return this._trackedEntityChanged}},clockTrackedDataSource:{get:function(){return this._clockTrackedDataSource},set:function(e){this._clockTrackedDataSource!==e&&(this._clockTrackedDataSource=e,uTe(this.clock,e))}}});wo.prototype.showErrorPanel=function(e,t,n){let i=this._element,o=document.createElement("div");o.className="cesium-widget-errorPanel";let r=document.createElement("div");r.className="cesium-widget-errorPanel-content",o.appendChild(r);let s=document.createElement("div");s.className="cesium-widget-errorPanel-header",s.appendChild(document.createTextNode(e)),r.appendChild(s);let a=document.createElement("div");a.className="cesium-widget-errorPanel-scroll",r.appendChild(a);function c(){a.style.maxHeight=`${Math.max(Math.round(i.clientHeight*.9-100),30)}px`}c(),u(window.addEventListener)&&window.addEventListener("resize",c,!1);let l=u(t),f=u(n);if(l||f){let g=document.createElement("div");if(g.className="cesium-widget-errorPanel-message",a.appendChild(g),f){let m=f_(n);l||(typeof n=="string"&&(n=new Error(n)),t=f_({name:n.name,message:n.message}),m=n.stack),typeof console<"u"&&console.error(`${e}
${t}
${m}`);let y=document.createElement("div");y.className="cesium-widget-errorPanel-message-details collapsed";let b=document.createElement("span");b.className="cesium-widget-errorPanel-more-details",b.appendChild(document.createTextNode("See more...")),y.appendChild(b),y.onclick=function(C){y.removeChild(b),y.appendChild(document.createTextNode(m)),y.className="cesium-widget-errorPanel-message-details",r.className="cesium-widget-errorPanel-content expanded",y.onclick=void 0},a.appendChild(y)}g.innerHTML=`<p>${t}</p>`}let d=document.createElement("div");d.className="cesium-widget-errorPanel-buttonPanel",r.appendChild(d);let p=document.createElement("button");p.setAttribute("type","button"),p.className="cesium-button",p.appendChild(document.createTextNode("OK")),p.onclick=function(){u(c)&&u(window.removeEventListener)&&window.removeEventListener("resize",c,!1),i.removeChild(o)},d.appendChild(p),i.appendChild(o)};wo.prototype.isDestroyed=function(){return!1};wo.prototype.destroy=function(){let e=this.dataSources,t=e.length;for(let n=0;n<t;n++)this._dataSourceRemoved(e,e.get(n));this._dataSourceRemoved(void 0,this._dataSourceDisplay.defaultDataSource),this._dataSourceDisplay=this._dataSourceDisplay.destroy(),u(this._scene)&&(this._scene.renderError.removeEventListener(this._onRenderError),this._scene=this._scene.destroy()),this._container.removeChild(this._element),this._creditContainer.removeChild(this._innerCreditContainer),this._eventHelper.removeAll(),this._destroyDataSourceCollection&&(this._dataSourceCollection=this._dataSourceCollection.destroy()),ue(this)};wo.prototype.resize=function(){let e=this._canvas;!this._forceResize&&this._canvasClientWidth===e.clientWidth&&this._canvasClientHeight===e.clientHeight&&this._lastDevicePixelRatio===window.devicePixelRatio||(this._forceResize=!1,dTe(this),hTe(this),this._scene.requestRender())};wo.prototype.render=function(){if(this._canRender){this._scene.initializeFrame();let e=this._clock.tick();this._scene.render(e)}else this._clock.tick()};wo.prototype._dataSourceAdded=function(e,t){t.entities.collectionChanged.addEventListener(wo.prototype._onEntityCollectionChanged,this)};wo.prototype._dataSourceRemoved=function(e,t){let n=t.entities;n.collectionChanged.removeEventListener(wo.prototype._onEntityCollectionChanged,this),u(this.trackedEntity)&&n.getById(this.trackedEntity.id)===this.trackedEntity&&(this.trackedEntity=void 0)};wo.prototype._updateCanAnimate=function(e){this._clock.canAnimate=e};var yS=new ae;wo.prototype._onTick=function(e){let t=e.currentTime,n=this._dataSourceDisplay.update(t);this._allowDataSourcesToSuspendAnimation&&this._canAnimateUpdateCallback(n);let i=this._entityView;if(u(i)){let o=this._trackedEntity;this._dataSourceDisplay.getBoundingSphere(o,!0,yS)===dt.DONE&&i.update(t,yS)}};wo.prototype._onEntityCollectionChanged=function(e,t,n){let i=n.length;for(let o=0;o<i;o++){let r=n[o];this.trackedEntity===r&&(this.trackedEntity=void 0)}};wo.prototype._clearTrackedObject=function(){this.trackedEntity=void 0};wo.prototype._onDataSourceChanged=function(e){this.clockTrackedDataSource===e&&uTe(this.clock,e)};wo.prototype._onDataSourceAdded=function(e,t){this._automaticallyTrackDataSourceClocks&&(this.clockTrackedDataSource=t);let n=t.entities.id,i=this._eventHelper.add(t.changedEvent,wo.prototype._onDataSourceChanged,this);this._dataSourceChangedListeners[n]=i};wo.prototype._onDataSourceRemoved=function(e,t){let n=this.clockTrackedDataSource===t,i=t.entities.id;if(this._dataSourceChangedListeners[i](),this._dataSourceChangedListeners[i]=void 0,n){let o=e.length;this._automaticallyTrackDataSourceClocks&&o>0?this.clockTrackedDataSource=e.get(o-1):this.clockTrackedDataSource=void 0}};wo.prototype.zoomTo=function(e,t){return mTe(this,e,{offset:t},!1)};wo.prototype.flyTo=function(e,t){return mTe(this,e,t,!0)};function mTe(e,t,n,i){kZ(e);let o=new Promise(r=>{e._completeZoom=function(s){r(s)}});return e._zoomPromise=o,e._zoomIsFlight=i,e._zoomOptions=n,Promise.resolve(t).then(function(r){if(e._zoomPromise===o){if(r instanceof dc){let s;u(r.imageryProvider)?s=Promise.resolve(r.getImageryRectangle()):s=new Promise(a=>{let c=r.readyEvent.addEventListener(()=>{c(),a(r.getImageryRectangle())})}),s.then(function(a){return kE(a,e.scene)}).then(function(a){e._zoomPromise===o&&(e._zoomTarget=a)});return}if(r instanceof Ia||r instanceof TI||r instanceof Nb){e._zoomTarget=r;return}if(r.isLoading&&u(r.loadingEvent)){let s=r.loadingEvent.addEventListener(function(){s(),e._zoomPromise===o&&(e._zoomTarget=r.entities.values.slice(0))});return}if(Array.isArray(r)){e._zoomTarget=r.slice(0);return}r=r.values??r,u(r.entities)&&(r=r.entities.values),Array.isArray(r)?e._zoomTarget=r.slice(0):e._zoomTarget=[r]}}),e.scene.requestRender(),o}function EI(e){e._zoomPromise=void 0,e._zoomTarget=void 0,e._zoomOptions=void 0}function kZ(e){let t=e._zoomPromise;u(t)&&(EI(e),e._completeZoom(!1))}wo.prototype._postRender=function(){OAt(this),MAt(this)};function OAt(e){let t=e._zoomTarget;if(!u(t)||e.scene.mode===ne.MORPHING)return;let n=e.scene,i=n.camera,o=e._zoomOptions??{},r;function s(f){u(o.offset)||(o.offset=new Yd(0,-.5,f.radius)),r={offset:o.offset,duration:o.duration,maximumHeight:o.maximumHeight,complete:function(){e._completeZoom(!0)},cancel:function(){e._completeZoom(!1)}},e._zoomIsFlight?i.flyToBoundingSphere(t.boundingSphere,r):(i.viewBoundingSphere(f,o.offset),i.lookAtTransform(F.IDENTITY),e._completeZoom(!0)),EI(e)}if(t instanceof TI){if(u(t.boundingSphere)){s(t.boundingSphere);return}let f=t.frameChanged.addEventListener(function(d){s(d.boundingSphere),f()});return}if(t instanceof Ia||t instanceof Nb){s(t.boundingSphere);return}if(t instanceof de){r={destination:n.ellipsoid.cartographicToCartesian(t),duration:o.duration,maximumHeight:o.maximumHeight,complete:function(){e._completeZoom(!0)},cancel:function(){e._completeZoom(!1)}},e._zoomIsFlight?i.flyTo(r):(i.setView(r),e._completeZoom(!0)),EI(e);return}let a=t,c=[];for(let f=0,d=a.length;f<d;f++){let p=e._dataSourceDisplay.getBoundingSphere(a[f],!1,yS);if(p===dt.PENDING)return;p!==dt.FAILED&&c.push(ae.clone(yS))}if(c.length===0){kZ(e);return}e.trackedEntity=void 0;let l=ae.fromBoundingSpheres(c);e._zoomIsFlight?(EI(e),i.flyToBoundingSphere(l,{duration:o.duration,maximumHeight:o.maximumHeight,complete:function(){e._completeZoom(!0)},cancel:function(){e._completeZoom(!1)},offset:o.offset})):(i.viewBoundingSphere(l,o.offset),i.lookAtTransform(F.IDENTITY),EI(e),e._completeZoom(!0))}function MAt(e){if(!e._needTrackedEntityUpdate)return;let t=e._trackedEntity,n=e.clock.currentTime,i=Y.getValueOrUndefined(t.position,n);if(!u(i))return;let o=e.scene,r=e._dataSourceDisplay.getBoundingSphere(t,!1,yS);if(r===dt.PENDING)return;let s=o.mode;(s===ne.COLUMBUS_VIEW||s===ne.SCENE2D)&&(o.screenSpaceCameraController.enableTranslate=!1),(s===ne.COLUMBUS_VIEW||s===ne.SCENE3D)&&(o.screenSpaceCameraController.enableTilt=!1);let a=r!==dt.FAILED?yS:void 0;e._entityView=new r4(t,o,o.ellipsoid),e._entityView.update(n,a),e._needTrackedEntityUpdate=!1}var I5=wo;var P5=`uniform sampler2D u_noiseTexture;
uniform vec3 u_noiseTextureDimensions;
uniform float u_noiseDetail;
in vec2 v_offset;
in vec3 v_maximumSize;
in vec4 v_color;
in float v_slice;
in float v_brightness;

float wrap(float value, float rangeLength) {
    if(value < 0.0) {
        float absValue = abs(value);
        float modValue = mod(absValue, rangeLength);
        return mod(rangeLength - modValue, rangeLength);
    }
    return mod(value, rangeLength);
}

vec3 wrapVec(vec3 value, float rangeLength) {
    return vec3(wrap(value.x, rangeLength),
                wrap(value.y, rangeLength),
                wrap(value.z, rangeLength));
}

vec2 voxelToUV(vec3 voxelIndex) {
    float textureSliceWidth = u_noiseTextureDimensions.x;
    float noiseTextureRows = u_noiseTextureDimensions.y;
    float inverseNoiseTextureRows = u_noiseTextureDimensions.z;

    float textureSliceWidthSquared = textureSliceWidth * textureSliceWidth;
    vec2 inverseNoiseTextureDimensions = vec2(noiseTextureRows / textureSliceWidthSquared,
                                            inverseNoiseTextureRows / textureSliceWidth);
    vec3 wrappedIndex = wrapVec(voxelIndex, textureSliceWidth);
    float column = mod(wrappedIndex.z, textureSliceWidth * inverseNoiseTextureRows);
    float row = floor(wrappedIndex.z / textureSliceWidth * noiseTextureRows);

    float xPixelCoord = wrappedIndex.x + column * textureSliceWidth;
    float yPixelCoord = wrappedIndex.y + row * textureSliceWidth;
    return vec2(xPixelCoord, yPixelCoord) * inverseNoiseTextureDimensions;
}

// Interpolate a voxel with its neighbor (along the positive X-axis)
vec4 lerpSamplesX(vec3 voxelIndex, float x) {
    vec2 uv0 = voxelToUV(voxelIndex);
    vec2 uv1 = voxelToUV(voxelIndex + vec3(1.0, 0.0, 0.0));
    vec4 sample0 = texture(u_noiseTexture, uv0);
    vec4 sample1 = texture(u_noiseTexture, uv1);
    return mix(sample0, sample1, x);
}

vec4 sampleNoiseTexture(vec3 position) {
    float textureSliceWidth = u_noiseTextureDimensions.x;
    vec3 recenteredPos = position + vec3(textureSliceWidth / 2.0);
    vec3 lerpValue = fract(recenteredPos);
    vec3 voxelIndex = floor(recenteredPos);

    vec4 xLerp00 = lerpSamplesX(voxelIndex, lerpValue.x);
    vec4 xLerp01 = lerpSamplesX(voxelIndex + vec3(0.0, 0.0, 1.0), lerpValue.x);
    vec4 xLerp10 = lerpSamplesX(voxelIndex + vec3(0.0, 1.0, 0.0), lerpValue.x);
    vec4 xLerp11 = lerpSamplesX(voxelIndex + vec3(0.0, 1.0, 1.0), lerpValue.x);

    vec4 yLerp0 = mix(xLerp00, xLerp10, lerpValue.y);
    vec4 yLerp1 = mix(xLerp01, xLerp11, lerpValue.y);
    return mix(yLerp0, yLerp1, lerpValue.z);
}

// Intersection with a unit sphere with radius 0.5 at center (0, 0, 0).
bool intersectSphere(vec3 origin, vec3 dir, float slice,
                     out vec3 point, out vec3 normal) {
    float A = dot(dir, dir);
    float B = dot(origin, dir);
    float C = dot(origin, origin) - 0.25;
    float discriminant = (B * B) - (A * C);
    if(discriminant < 0.0) {
        return false;
    }
    float root = sqrt(discriminant);
    float t = (-B - root) / A;
    if(t < 0.0) {
        t = (-B + root) / A;
    }
    point = origin + t * dir;

    if(slice >= 0.0) {
        point.z = (slice / 2.0) - 0.5;
        if(length(point) > 0.5) {
            return false;
        }
    }

    normal = normalize(point);
    point -= czm_epsilon2 * normal;
    return true;
}

// Transforms the ray origin and direction into unit sphere space,
// then transforms the result back into the ellipsoid's space.
bool intersectEllipsoid(vec3 origin, vec3 dir, vec3 center, vec3 scale, float slice,
                        out vec3 point, out vec3 normal) {
    if(scale.x <= 0.01 || scale.y < 0.01 || scale.z < 0.01) {
        return false;
    }

    vec3 o = (origin - center) / scale;
    vec3 d = dir / scale;
    vec3 p, n;
    bool intersected = intersectSphere(o, d, slice, p, n);
    if(intersected) {
        point = (p * scale) + center;
        normal = n;
    }
    return intersected;
}

// Assume that if phase shift is being called for octave i,
// the frequency is of i - 1. This saves us from doing extra
// division / multiplication operations.
vec2 phaseShift2D(vec2 p, vec2 freq) {
    return (czm_pi / 2.0) * sin(freq.yx * p.yx);
}

vec2 phaseShift3D(vec3 p, vec2 freq) {
    return phaseShift2D(p.xy, freq) + czm_pi * vec2(sin(freq.x * p.z));
}

// The cloud texture function derived from Gardner's 1985 paper,
// "Visual Simulation of Clouds."
// https://www.cs.drexel.edu/~david/Classes/Papers/p297-gardner.pdf
const float T0    = 0.6;  // contrast of the texture pattern
const float k     = 0.1;  // computed to produce a maximum value of 1
const float C0    = 0.8;  // coefficient
const float FX0   = 0.6;  // frequency X
const float FY0   = 0.6;  // frequency Y
const int octaves = 5;

float T(vec3 point) {
    vec2 sum = vec2(0.0);
    float Ci = C0;
    vec2 FXY = vec2(FX0, FY0);
    vec2 PXY = vec2(0.0);
    for(int i = 1; i <= octaves; i++) {
        PXY = phaseShift3D(point, FXY);
        Ci *= 0.707;
        FXY *= 2.0;
        vec2 sinTerm = sin(FXY * point.xy + PXY);
        sum += Ci * sinTerm + vec2(T0);
    }
    return k * sum.x * sum.y;
}

const float a = 0.5;  // fraction of surface reflection due to ambient or scattered light,
const float t = 0.4;  // fraction of texture shading
const float s = 0.25; // fraction of specular reflection

float I(float Id, float Is, float It) {
    return (1.0 - a) * ((1.0 - t) * ((1.0 - s) * Id + s * Is) + t * It) + a;
}

const vec3 lightDir = normalize(vec3(0.2, -1.0, 0.7));

vec4 drawCloud(vec3 rayOrigin, vec3 rayDir, vec3 cloudCenter, vec3 cloudScale, float cloudSlice,
               float brightness) {
    vec3 cloudPoint, cloudNormal;
    if(!intersectEllipsoid(rayOrigin, rayDir, cloudCenter, cloudScale, cloudSlice,
                            cloudPoint, cloudNormal)) {
        return vec4(0.0);
    }

    float Id = clamp(dot(cloudNormal, -lightDir), 0.0, 1.0);  // diffuse reflection
    float Is = max(pow(dot(-lightDir, -rayDir), 2.0), 0.0);   // specular reflection
    float It = T(cloudPoint);                                 // texture function
    float intensity = I(Id, Is, It);
    vec3 color = vec3(intensity * clamp(brightness, 0.1, 1.0));

    vec4 noise = sampleNoiseTexture(u_noiseDetail * cloudPoint);
    float W = noise.x;
    float W2 = noise.y;
    float W3 = noise.z;

    // The dot product between the cloud's normal and the ray's direction is greatest
    // in the center of the ellipsoid's surface. It decreases towards the edge.
    // Thus, it is used to blur the areas leading to the edges of the ellipsoid,
    // so that no harsh lines appear.

    // The first (and biggest) layer of worley noise is then subtracted from this.
    // The final result is scaled up so that the base cloud is not too translucent.
    float ndDot = clamp(dot(cloudNormal, -rayDir), 0.0, 1.0);
    float TR = pow(ndDot, 3.0) - W; // translucency
    TR *= 1.3;

    // Subtracting the second and third layers of worley noise is more complicated.
    // If these layers of noise were simply subtracted from the current translucency,
    // the shape derived from the first layer of noise would be completely deleted.
    // The erosion of this noise should thus be constricted to the edges of the cloud.
    // However, because the edges of the ellipsoid were already blurred away, mapping
    // the noise to (1.0 - ndDot) will have no impact on most of the cloud's appearance.
    // The value of (0.5 - ndDot) provides the best compromise.
    float minusDot = 0.5 - ndDot;

    // Even with the previous calculation, subtracting the second layer of wnoise
    // erode too much of the cloud. The addition of it, however, will detailed
    // volume to the cloud. As long as the noise is only added and not subtracted,
    // the results are aesthetically pleasing.

    // The minusDot product is mapped in a way that it is larger at the edges of
    // the ellipsoid, so a subtraction and min operation are used instead of
    // an addition and max one.
    TR -= min(minusDot * W2, 0.0);

    // The third level of worley noise is subtracted from the result, with some
    // modifications. First, a scalar is added to minusDot so that the noise
    // starts affecting the shape farther away from the center of the ellipsoid's
    // surface. Then, it is scaled down so its impact is not too intense.
    TR -= 0.8 * (minusDot + 0.25) * W3;

    // The texture function's shading does not correlate with the shape of the cloud
    // produced by the layers of noise, so an extra shading scalar is calculated.
    // The darkest areas of the cloud are assigned to be where the noise erodes
    // the cloud the most. This is then interpolated based on the translucency
    // and the diffuse shading term of that point in the cloud.
    float shading = mix(1.0 - 0.8 * W * W, 1.0, Id * TR);

    // To avoid values that are too dark, this scalar is increased by a small amount
    // and clamped so it never goes to zero.
    shading = clamp(shading + 0.2, 0.3, 1.0);

    // Finally, the contrast of the cloud's color is increased.
    vec3 finalColor = mix(vec3(0.5), shading * color, 1.15);
    return vec4(finalColor, clamp(TR, 0.0, 1.0)) * v_color;
}

void main() {
#ifdef DEBUG_BILLBOARDS
    out_FragColor = vec4(0.0, 0.5, 0.5, 1.0);
#endif
    // To avoid calculations with high values,
    // we raycast from an arbitrarily smaller space.
    vec2 coordinate = v_maximumSize.xy * v_offset;

    vec3 ellipsoidScale = 0.82 * v_maximumSize;
    vec3 ellipsoidCenter = vec3(0.0);

    float zOffset = max(ellipsoidScale.z - 10.0, 0.0);
    vec3 eye = vec3(0, 0, -10.0 - zOffset);
    vec3 rayDir = normalize(vec3(coordinate, 1.0) - eye);
    vec3 rayOrigin = eye;
#ifdef DEBUG_ELLIPSOIDS
    vec3 point, normal;
    if(intersectEllipsoid(rayOrigin, rayDir, ellipsoidCenter, ellipsoidScale, v_slice,
                          point, normal)) {
        out_FragColor = v_brightness * v_color;
    }
#else
#ifndef DEBUG_BILLBOARDS
    vec4 cloud = drawCloud(rayOrigin, rayDir,
                           ellipsoidCenter, ellipsoidScale, v_slice, v_brightness);
    if(cloud.w < 0.01) {
        discard;
    }
    out_FragColor = cloud;
#endif
#endif
}
`;var R5=`#ifdef INSTANCED
in vec2 direction;
#endif
in vec4 positionHighAndScaleX;
in vec4 positionLowAndScaleY;
in vec4 packedAttribute0;
in vec4 packedAttribute1;
in vec4 color;

out vec2 v_offset;
out vec3 v_maximumSize;
out vec4 v_color;
out float v_slice;
out float v_brightness;

void main() {
    // Unpack attributes.
    vec3 positionHigh = positionHighAndScaleX.xyz;
    vec3 positionLow = positionLowAndScaleY.xyz;
    vec2 scale = vec2(positionHighAndScaleX.w, positionLowAndScaleY.w);

    float show = packedAttribute0.x;
    float brightness = packedAttribute0.y;
    vec2 coordinates = packedAttribute0.wz;
    vec3 maximumSize = packedAttribute1.xyz;
    float slice = packedAttribute1.w;

#ifdef INSTANCED
    vec2 dir = direction;
#else
    vec2 dir = coordinates;
#endif

    vec2 offset = dir - vec2(0.5, 0.5);
    vec2 scaledOffset = scale * offset;
    vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);
    vec4 positionEC = czm_modelViewRelativeToEye * p;
    positionEC.xy += scaledOffset;
    
    positionEC.xyz *= show;
    gl_Position = czm_projection * positionEC;

    v_offset = offset;
    v_maximumSize = maximumSize;
    v_color = color;
    v_slice = slice;
    v_brightness = brightness;
}
`;var O5=`uniform vec3 u_noiseTextureDimensions;
uniform float u_noiseDetail;
uniform vec3 u_noiseOffset;
in vec2 v_position;

float wrap(float value, float rangeLength) {
    if(value < 0.0) {
        float absValue = abs(value);
        float modValue = mod(absValue, rangeLength);
        return mod(rangeLength - modValue, rangeLength);
    }
    return mod(value, rangeLength);
}

vec3 wrapVec(vec3 value, float rangeLength) {
    return vec3(wrap(value.x, rangeLength),
                wrap(value.y, rangeLength),
                wrap(value.z, rangeLength));
}

vec3 random3(vec3 p) {
    float dot1 = dot(p, vec3(127.1, 311.7, 932.8));
    float dot2 = dot(p, vec3(269.5, 183.3, 421.4));
    return fract(vec3(sin(dot1 - dot2), cos(dot1 * dot2), dot1 * dot2));
}

// Frequency corresponds to cell size.
// The higher the frequency, the smaller the cell size.
vec3 getWorleyCellPoint(vec3 centerCell, vec3 offset, float freq) {
    float textureSliceWidth = u_noiseTextureDimensions.x;
    vec3 cell = centerCell + offset;
    cell = wrapVec(cell, textureSliceWidth / u_noiseDetail);
    cell += floor(u_noiseOffset / u_noiseDetail);
    vec3 p = offset + random3(cell);
    return p;
}

float worleyNoise(vec3 p, float freq) {
    vec3 centerCell = floor(p * freq);
    vec3 pointInCell = fract(p * freq);
    float shortestDistance = 1000.0;

    for(float z = -1.0; z <= 1.0; z++) {
        for(float y = -1.0; y <= 1.0; y++) {
            for(float x = -1.0; x <= 1.0; x++) {
                vec3 offset = vec3(x, y, z);
                vec3 point = getWorleyCellPoint(centerCell, offset, freq);

                float distance = length(pointInCell - point);
                if(distance < shortestDistance) {
                    shortestDistance = distance;
                }
            }
        }
    }

    return shortestDistance;
}

const float MAX_FBM_ITERATIONS = 10.0;

float worleyFBMNoise(vec3 p, float octaves, float scale) {
    float noise = 0.0;
    float freq = 1.0;
    float persistence = 0.625;
    for(float i = 0.0; i < MAX_FBM_ITERATIONS; i++) {
        if(i >= octaves) {
            break;
        }

        noise += worleyNoise(p * scale, freq * scale) * persistence;
        persistence *= 0.5;
        freq *= 2.0;
    }
    return noise;
}

void main() {
    float textureSliceWidth = u_noiseTextureDimensions.x;
    float inverseNoiseTextureRows = u_noiseTextureDimensions.z;
    float x = mod(v_position.x, textureSliceWidth);
    float y = mod(v_position.y, textureSliceWidth);
    float sliceRow = floor(v_position.y / textureSliceWidth);
    float z = floor(v_position.x / textureSliceWidth) + sliceRow * inverseNoiseTextureRows * textureSliceWidth;

    vec3 position = vec3(x, y, z);
    position /= u_noiseDetail;
    float worley0 = clamp(worleyFBMNoise(position, 3.0, 1.0), 0.0, 1.0);
    float worley1 = clamp(worleyFBMNoise(position, 3.0, 2.0), 0.0, 1.0);
    float worley2 = clamp(worleyFBMNoise(position, 3.0, 3.0), 0.0, 1.0);
    out_FragColor = vec4(worley0, worley1, worley2, 1.0);
}
`;var M5=`uniform vec3 u_noiseTextureDimensions;
in vec2 position;

out vec2 v_position;

void main()
{
    gl_Position = vec4(position, 0.1, 1.0);

    float textureSliceWidth = u_noiseTextureDimensions.x;
    float noiseTextureRows = u_noiseTextureDimensions.y;
    float inverseNoiseTextureRows = u_noiseTextureDimensions.z;
    vec2 transformedPos = (position * 0.5) + vec2(0.5);
    transformedPos *= textureSliceWidth;
    transformedPos.x *= textureSliceWidth * inverseNoiseTextureRows;
    transformedPos.y *= noiseTextureRows;
    v_position = transformedPos;
}
`;var L5=`
in vec2 v_textureCoordinates;

void main()
{
    czm_materialInput materialInput;
    
    materialInput.s = v_textureCoordinates.s;
    materialInput.st = v_textureCoordinates;
    materialInput.str = vec3(v_textureCoordinates, 0.0);
    materialInput.normalEC = vec3(0.0, 0.0, -1.0);
    
    czm_material material = czm_getMaterial(materialInput);

    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);
}
`;var LAt=new h(1,1,1);function VZ(e){e=x(e,LAt),this._dimensions=h.clone(e)}Object.defineProperties(VZ.prototype,{dimensions:{get:function(){return this._dimensions},set:function(e){h.clone(e,this._dimensions)}}});var NAt=new h;VZ.prototype.emit=function(e){let t=this._dimensions,n=h.multiplyByScalar(t,.5,NAt),i=R.randomBetween(-n.x,n.x),o=R.randomBetween(-n.y,n.y),r=R.randomBetween(-n.z,n.z);e.position=h.fromElements(i,o,r,e.position),e.velocity=h.normalize(e.position,e.velocity)};var pTe=VZ;function Wm(){this.featurePropertiesDirty=!1}Object.defineProperties(Wm.prototype,{featuresLength:{get:function(){he.throwInstantiationError()}},pointsLength:{get:function(){he.throwInstantiationError()}},trianglesLength:{get:function(){he.throwInstantiationError()}},geometryByteLength:{get:function(){he.throwInstantiationError()}},texturesByteLength:{get:function(){he.throwInstantiationError()}},batchTableByteLength:{get:function(){he.throwInstantiationError()}},innerContents:{get:function(){he.throwInstantiationError()}},ready:{get:function(){he.throwInstantiationError()}},tileset:{get:function(){he.throwInstantiationError()}},tile:{get:function(){he.throwInstantiationError()}},url:{get:function(){he.throwInstantiationError()}},batchTable:{get:function(){he.throwInstantiationError()}},metadata:{get:function(){he.throwInstantiationError()},set:function(e){he.throwInstantiationError()}},group:{get:function(){he.throwInstantiationError()},set:function(e){he.throwInstantiationError()}}});Wm.prototype.hasProperty=function(e,t){he.throwInstantiationError()};Wm.prototype.getFeature=function(e){he.throwInstantiationError()};Wm.prototype.applyDebugSettings=function(e,t){he.throwInstantiationError()};Wm.prototype.applyStyle=function(e){he.throwInstantiationError()};Wm.prototype.update=function(e,t){he.throwInstantiationError()};Wm.prototype.pick=function(e,t,n){he.throwInstantiationError()};Wm.prototype.isDestroyed=function(){he.throwInstantiationError()};Wm.prototype.destroy=function(){he.throwInstantiationError()};var _Te=Wm;function xS(e,t){this._conditionsExpression=Ge(e,!0),this._conditions=e.conditions,this._runtimeConditions=void 0,BAt(this,t)}Object.defineProperties(xS.prototype,{conditionsExpression:{get:function(){return this._conditionsExpression}}});function FAt(e,t){this.condition=e,this.expression=t}function BAt(e,t){let n=[],i=e._conditions;if(!u(i))return;let o=i.length;for(let r=0;r<o;++r){let s=i[r],a=String(s[0]),c=String(s[1]);n.push(new FAt(new _d(a,t),new _d(c,t)))}e._runtimeConditions=n}xS.prototype.evaluate=function(e,t){let n=this._runtimeConditions;if(!u(n))return;let i=n.length;for(let o=0;o<i;++o){let r=n[o];if(r.condition.evaluate(e))return r.expression.evaluate(e,t)}};xS.prototype.evaluateColor=function(e,t){let n=this._runtimeConditions;if(!u(n))return;let i=n.length;for(let o=0;o<i;++o){let r=n[o];if(r.condition.evaluate(e))return r.expression.evaluateColor(e,t)}};xS.prototype.getShaderFunction=function(e,t,n,i){let o=this._runtimeConditions;if(!u(o)||o.length===0)return;let r="",s=o.length;for(let a=0;a<s;++a){let c=o[a],l=c.condition.getShaderExpression(t,n),f=c.expression.getShaderExpression(t,n);r+=`    ${a===0?"if":"else if"} (${l})
    {
        return ${f};
    }
`}return r=`${i} ${e}
{
${r}    return ${i}(1.0);
}
`,r};xS.prototype.getVariables=function(){let e=[],t=this._runtimeConditions;if(!u(t)||t.length===0)return e;let n=t.length;for(let i=0;i<n;++i){let o=t[i];e.push.apply(e,o.condition.getVariables()),e.push.apply(e,o.expression.getVariables())}return e=e.filter(function(i,o,r){return r.indexOf(i)===o}),e};var N5=xS;function hy(e){this._style={},this._ready=!1,this._show=void 0,this._color=void 0,this._pointSize=void 0,this._pointOutlineColor=void 0,this._pointOutlineWidth=void 0,this._labelColor=void 0,this._labelOutlineColor=void 0,this._labelOutlineWidth=void 0,this._font=void 0,this._labelStyle=void 0,this._labelText=void 0,this._backgroundColor=void 0,this._backgroundPadding=void 0,this._backgroundEnabled=void 0,this._scaleByDistance=void 0,this._translucencyByDistance=void 0,this._distanceDisplayCondition=void 0,this._heightOffset=void 0,this._anchorLineEnabled=void 0,this._anchorLineColor=void 0,this._image=void 0,this._disableDepthTestDistance=void 0,this._horizontalOrigin=void 0,this._verticalOrigin=void 0,this._labelHorizontalOrigin=void 0,this._labelVerticalOrigin=void 0,this._meta=void 0,this._colorShaderFunction=void 0,this._showShaderFunction=void 0,this._pointSizeShaderFunction=void 0,this._colorShaderFunctionReady=!1,this._showShaderFunctionReady=!1,this._pointSizeShaderFunctionReady=!1,this._colorShaderTranslucent=!1,kAt(this,e)}function kAt(e,t){t=x(Ge(t,!0),e._style),e._style=t,e.show=t.show,e.color=t.color,e.pointSize=t.pointSize,e.pointOutlineColor=t.pointOutlineColor,e.pointOutlineWidth=t.pointOutlineWidth,e.labelColor=t.labelColor,e.labelOutlineColor=t.labelOutlineColor,e.labelOutlineWidth=t.labelOutlineWidth,e.labelStyle=t.labelStyle,e.font=t.font,e.labelText=t.labelText,e.backgroundColor=t.backgroundColor,e.backgroundPadding=t.backgroundPadding,e.backgroundEnabled=t.backgroundEnabled,e.scaleByDistance=t.scaleByDistance,e.translucencyByDistance=t.translucencyByDistance,e.distanceDisplayCondition=t.distanceDisplayCondition,e.heightOffset=t.heightOffset,e.anchorLineEnabled=t.anchorLineEnabled,e.anchorLineColor=t.anchorLineColor,e.image=t.image,e.disableDepthTestDistance=t.disableDepthTestDistance,e.horizontalOrigin=t.horizontalOrigin,e.verticalOrigin=t.verticalOrigin,e.labelHorizontalOrigin=t.labelHorizontalOrigin,e.labelVerticalOrigin=t.labelVerticalOrigin;let n={};if(u(t.meta)){let i=t.defines,o=x(t.meta,x.EMPTY_OBJECT);for(let r in o)o.hasOwnProperty(r)&&(n[r]=new _d(o[r],i))}e._meta=n,e._ready=!0}function ir(e,t){let n=x(e._style,x.EMPTY_OBJECT).defines;if(u(t)){if(typeof t=="boolean"||typeof t=="number")return new _d(String(t));if(typeof t=="string")return new _d(t,n);if(u(t.conditions))return new N5(t,n)}else return;return t}function or(e){if(u(e)){if(u(e.expression))return e.expression;if(u(e.conditionsExpression))return Ge(e.conditionsExpression,!0)}else return;return e}Object.defineProperties(hy.prototype,{style:{get:function(){return this._style}},show:{get:function(){return this._show},set:function(e){this._show=ir(this,e),this._style.show=or(this._show),this._showShaderFunctionReady=!1}},color:{get:function(){return this._color},set:function(e){this._color=ir(this,e),this._style.color=or(this._color),this._colorShaderFunctionReady=!1}},pointSize:{get:function(){return this._pointSize},set:function(e){this._pointSize=ir(this,e),this._style.pointSize=or(this._pointSize),this._pointSizeShaderFunctionReady=!1}},pointOutlineColor:{get:function(){return this._pointOutlineColor},set:function(e){this._pointOutlineColor=ir(this,e),this._style.pointOutlineColor=or(this._pointOutlineColor)}},pointOutlineWidth:{get:function(){return this._pointOutlineWidth},set:function(e){this._pointOutlineWidth=ir(this,e),this._style.pointOutlineWidth=or(this._pointOutlineWidth)}},labelColor:{get:function(){return this._labelColor},set:function(e){this._labelColor=ir(this,e),this._style.labelColor=or(this._labelColor)}},labelOutlineColor:{get:function(){return this._labelOutlineColor},set:function(e){this._labelOutlineColor=ir(this,e),this._style.labelOutlineColor=or(this._labelOutlineColor)}},labelOutlineWidth:{get:function(){return this._labelOutlineWidth},set:function(e){this._labelOutlineWidth=ir(this,e),this._style.labelOutlineWidth=or(this._labelOutlineWidth)}},font:{get:function(){return this._font},set:function(e){this._font=ir(this,e),this._style.font=or(this._font)}},labelStyle:{get:function(){return this._labelStyle},set:function(e){this._labelStyle=ir(this,e),this._style.labelStyle=or(this._labelStyle)}},labelText:{get:function(){return this._labelText},set:function(e){this._labelText=ir(this,e),this._style.labelText=or(this._labelText)}},backgroundColor:{get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=ir(this,e),this._style.backgroundColor=or(this._backgroundColor)}},backgroundPadding:{get:function(){return this._backgroundPadding},set:function(e){this._backgroundPadding=ir(this,e),this._style.backgroundPadding=or(this._backgroundPadding)}},backgroundEnabled:{get:function(){return this._backgroundEnabled},set:function(e){this._backgroundEnabled=ir(this,e),this._style.backgroundEnabled=or(this._backgroundEnabled)}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){this._scaleByDistance=ir(this,e),this._style.scaleByDistance=or(this._scaleByDistance)}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){this._translucencyByDistance=ir(this,e),this._style.translucencyByDistance=or(this._translucencyByDistance)}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){this._distanceDisplayCondition=ir(this,e),this._style.distanceDisplayCondition=or(this._distanceDisplayCondition)}},heightOffset:{get:function(){return this._heightOffset},set:function(e){this._heightOffset=ir(this,e),this._style.heightOffset=or(this._heightOffset)}},anchorLineEnabled:{get:function(){return this._anchorLineEnabled},set:function(e){this._anchorLineEnabled=ir(this,e),this._style.anchorLineEnabled=or(this._anchorLineEnabled)}},anchorLineColor:{get:function(){return this._anchorLineColor},set:function(e){this._anchorLineColor=ir(this,e),this._style.anchorLineColor=or(this._anchorLineColor)}},image:{get:function(){return this._image},set:function(e){this._image=ir(this,e),this._style.image=or(this._image)}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){this._disableDepthTestDistance=ir(this,e),this._style.disableDepthTestDistance=or(this._disableDepthTestDistance)}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){this._horizontalOrigin=ir(this,e),this._style.horizontalOrigin=or(this._horizontalOrigin)}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){this._verticalOrigin=ir(this,e),this._style.verticalOrigin=or(this._verticalOrigin)}},labelHorizontalOrigin:{get:function(){return this._labelHorizontalOrigin},set:function(e){this._labelHorizontalOrigin=ir(this,e),this._style.labelHorizontalOrigin=or(this._labelHorizontalOrigin)}},labelVerticalOrigin:{get:function(){return this._labelVerticalOrigin},set:function(e){this._labelVerticalOrigin=ir(this,e),this._style.labelVerticalOrigin=or(this._labelVerticalOrigin)}},meta:{get:function(){return this._meta},set:function(e){this._meta=e}}});hy.fromUrl=function(e){return De.createIfNeeded(e).fetchJson(e).then(function(n){return new hy(n)})};hy.prototype.getColorShaderFunction=function(e,t,n){return this._colorShaderFunctionReady?(n.translucent=this._colorShaderTranslucent,this._colorShaderFunction):(this._colorShaderFunctionReady=!0,u(this.color)&&u(this.color.getShaderFunction)?this._colorShaderFunction=this.color.getShaderFunction(e,t,n,"vec4"):this._colorShaderFunction=void 0,this._colorShaderTranslucent=n.translucent,this._colorShaderFunction)};hy.prototype.getShowShaderFunction=function(e,t,n){return this._showShaderFunctionReady?this._showShaderFunction:(this._showShaderFunctionReady=!0,u(this.show)&&u(this.show.getShaderFunction)?this._showShaderFunction=this.show.getShaderFunction(e,t,n,"bool"):this._showShaderFunction=void 0,this._showShaderFunction)};hy.prototype.getPointSizeShaderFunction=function(e,t,n){return this._pointSizeShaderFunctionReady?this._pointSizeShaderFunction:(this._pointSizeShaderFunctionReady=!0,u(this.pointSize)&&u(this.pointSize.getShaderFunction)?this._pointSizeShaderFunction=this.pointSize.getShaderFunction(e,t,n,"float"):this._pointSizeShaderFunction=void 0,this._pointSizeShaderFunction)};hy.prototype.getVariables=function(){let e=[];return u(this.color)&&u(this.color.getVariables)&&e.push.apply(e,this.color.getVariables()),u(this.show)&&u(this.show.getVariables)&&e.push.apply(e,this.show.getVariables()),u(this.pointSize)&&u(this.pointSize.getVariables)&&e.push.apply(e,this.pointSize.getVariables()),e=e.filter(function(t,n,i){return i.indexOf(t)===n}),e};var bS=hy;function SI(e){e=x(e,x.EMPTY_OBJECT),this._maximumSubtreeCount=x(e.maximumSubtreeCount,0),this._subtreeRequestCounter=0,this._queue=new IE({comparator:SI.comparator})}SI.prototype.addSubtree=function(e){let t=new VAt(e,this._subtreeRequestCounter);this._subtreeRequestCounter++,this._queue.insert(t);let n=e.implicitCoordinates;if(n.level>0){let i=n.getParentSubtreeCoordinates(),o=this.find(i)}if(this._maximumSubtreeCount>0)for(;this._queue.length>this._maximumSubtreeCount&&this._queue.getMinimum()!==t;)this._queue.removeMinimum()};SI.prototype.find=function(e){let t=this._queue,n=t.internalArray,i=t.length;for(let o=0;o<i;o++){let r=n[o],a=r.subtree.implicitCoordinates;if(e.isEqual(a))return r.subtree}};SI.comparator=function(e,t){let n=e.subtree.implicitCoordinates,i=t.subtree.implicitCoordinates;return n.isAncestor(i)?1:i.isAncestor(n)?-1:e.stamp-t.stamp};function VAt(e,t){this.subtree=e,this.stamp=t}var F5=SI;function B5(e){this._resource=e,this._metadataTable=void 0}Object.defineProperties(B5.prototype,{metadataTable:{get:function(){return this._metadataTable}}});B5.fromJson=async function(e,t,n,i){let o;u(t)?o={json:t,binary:void 0}:o=zAt(n);let r=await UAt(e,o.json,o.binary),s={},a=o.json.bufferViews.length;for(let d=0;d<a;++d){let p=o.json.bufferViews[d],g=p.byteOffset,m=g+p.byteLength,b=r[p.buffer].subarray(g,m);s[d]=b}let c=o.json.voxelTable,l=o.json.propertyTables[c],f=new B5(e);return f._metadataTable=new ou({count:l.count,properties:l.properties,class:i.classes[l.class],bufferViews:s}),f};function UAt(e,t,n){let i=t.buffers.length,o=new Array(i);for(let r=0;r<i;r++){let s=t.buffers[r];if(u(s.uri)){let c=e.getDerivedResource({url:s.uri});o[r]=c.fetchArrayBuffer().then(function(l){return new Uint8Array(l)})}else o[r]=Promise.resolve(n)}return Promise.all(o)}function zAt(e){let n=new DataView(e.buffer,e.byteOffset),i=8,o=n.getUint32(i,!0);i+=8;let r=n.getUint32(i,!0);i+=8;let s=Uo(e,i,o);i+=o;let a=e.subarray(i,i+r);return{json:s,binary:a}}var k5=B5;function V5(e){e=x(e,x.EMPTY_OBJECT),this.shapeTransform=void 0,this.globalTransform=void 0,this.shape=void 0,this.minBounds=void 0,this.maxBounds=void 0,this.dimensions=void 0,this.paddingBefore=void 0,this.paddingAfter=void 0,this.names=void 0,this.types=void 0,this.componentTypes=void 0,this.minimumValues=void 0,this.maximumValues=void 0,this.maximumTileCount=void 0,this._implicitTileset=void 0,this._subtreeCache=new F5}V5.fromUrl=async function(e){let t=De.createIfNeeded(e),n=await t.fetchJson();GAt(n);let i=XAt(n,t);await i.load();let o=n.root,r=o.content.extensions["3DTILES_content_voxels"],s=r.class,a=si(n,"3DTILES_metadata")?n.extensions["3DTILES_metadata"]:n,c=i.schema,l=new lT({metadataJson:a,schema:c}),f=new V5;KAt(f,l,s);let d=new fT(t,o,c),{shape:p,minBounds:g,maxBounds:m,shapeTransform:y,globalTransform:b}=WAt(o);f.shape=p,f.minBounds=g,f.maxBounds=m,f.dimensions=h.unpack(r.dimensions),f.shapeTransform=y,f.globalTransform=b,f.maximumTileCount=HAt(l);let C,A;return u(r.padding)&&(C=h.unpack(r.padding.before),A=h.unpack(r.padding.after)),f.paddingBefore=C,f.paddingAfter=A,f._implicitTileset=d,wi.unload(i),f};function HAt(e){if(u(e.tileset))return e.tileset.getPropertyBySemantic(mA.TILESET_TILE_COUNT)}function GAt(e){let t=e.root;if(!u(t.content))throw new ce("Root must have content");if(!si(t.content,"3DTILES_content_voxels"))throw new ce("Root tile content must have 3DTILES_content_voxels extension");if(!si(t,"3DTILES_implicit_tiling")&&!u(t.implicitTiling))throw new ce("Root tile must have implicit tiling");if(!u(e.schema)&&!u(e.schemaUri)&&!si(e,"3DTILES_metadata"))throw new ce("Tileset must have a metadata schema")}function WAt(e){let t=e.boundingVolume,n;if(u(e.transform)?n=F.unpack(e.transform):n=F.clone(F.IDENTITY),u(t.box))return qAt(t.box,n);if(u(t.region))return jAt(t.region);if(si(t,"3DTILES_bounding_volume_cylinder"))return YAt(t.extensions["3DTILES_bounding_volume_cylinder"].cylinder,n);throw new ce("Only box, region and 3DTILES_bounding_volume_cylinder are supported in Cesium3DTilesVoxelProvider")}function jAt(e){let t=e[0],n=e[1],i=e[2],o=e[3],r=e[4],s=e[5],a=F.fromScale(ee.WGS84.radii),c=new h(t,n,r),l=new h(i,o,s);return{shape:zi.ELLIPSOID,minBounds:c,maxBounds:l,shapeTransform:a,globalTransform:F.clone(F.IDENTITY)}}function qAt(e,t){let n=wn.unpack(e),i=F.fromRotationTranslation(n.halfAxes,n.center);return{shape:zi.BOX,minBounds:h.clone(T_.DefaultMinBounds),maxBounds:h.clone(T_.DefaultMaxBounds),shapeTransform:i,globalTransform:t}}function YAt(e,t){let n=wn.unpack(e),i=F.fromRotationTranslation(n.halfAxes,n.center);return{shape:zi.CYLINDER,minBounds:h.clone(E_.DefaultMinBounds),maxBounds:h.clone(E_.DefaultMaxBounds),shapeTransform:i,globalTransform:t}}function XAt(e,t){let{schemaUri:n,schema:i}=e;return u(n)?wi.getSchemaLoader({resource:t.getDerivedResource({url:n})}):wi.getSchemaLoader({schema:i})}function KAt(e,t,n){let{schema:i,statistics:o}=t,r=o?.classes[n],s=i.classes[n].properties,a=Object.entries(s).map(([d,p])=>{let{type:g,componentType:m}=p,y=r?.properties[d].min,b=r?.properties[d].max,C=Et.getComponentCount(g),A=gTe(y,C),T=gTe(b,C);return{id:d,type:g,componentType:m,minValue:A,maxValue:T}});e.names=a.map(d=>d.id),e.types=a.map(d=>d.type),e.componentTypes=a.map(d=>d.componentType);let c=a.map(d=>d.minValue),l=a.map(d=>d.maxValue),f=c.some(u);e.minimumValues=f?c:void 0,e.maximumValues=f?l:void 0}function gTe(e,t){if(!u(e))return;let n=Array.isArray(e)?e:[e];return Array.from({length:t},(i,o)=>n[o])}async function ZAt(e,t){let n=e.contentUriTemplates[0].getDerivedResource({templateValues:t.getTemplateValues()}),i=e.baseResource.getDerivedResource({url:n.url}),o=await i.fetchArrayBuffer(),r=zp(o);return await k5.fromJson(i,r.jsonPayload,r.binaryPayload,e.metadataSchema)}async function $At(e,t){let n=e._implicitTileset,i=e._subtreeCache,o=i.find(t);if(u(o))return o;let r=n.subtreeUriTemplate.getDerivedResource({templateValues:t.getTemplateValues()}),s=n.baseResource.getDerivedResource({url:r.url}),a=await s.fetchArrayBuffer();if(o=i.find(t),u(o))return o;let c=zp(a);return o=await hA.fromSubtreeJson(s,c.jsonPayload,c.binaryPayload,n,t),i.addSubtree(o),o}V5.prototype.requestData=function(e){e=x(e,x.EMPTY_OBJECT);let t=x(e.tileLevel,0),n=x(e.tileX,0),i=x(e.tileY,0),o=x(e.tileZ,0);if(x(e.keyframe,0)!==0)return;let s=this._implicitTileset,a=this.names,c=new dT({subdivisionScheme:s.subdivisionScheme,subtreeLevels:s.subtreeLevels,level:t,x:n,y:i,z:o}),l=c.isSubtreeRoot()&&c.level>0,f=l?c.getParentSubtreeCoordinates():c.getSubtreeCoordinates();return $At(this,f).then(function(p){return(l?p.childSubtreeIsAvailableAtCoordinates(c):p.tileIsAvailableAtCoordinates(c))?ZAt(s,c):Promise.reject("Tile is not available")}).then(function(p){return a.map(function(g){return p.metadataTable.getPropertyTypedArray(g)})})};var yTe=V5;function UZ(e){e=x(e,1),this._radius=x(e,1)}Object.defineProperties(UZ.prototype,{radius:{get:function(){return this._radius},set:function(e){this._radius=e}}});UZ.prototype.emit=function(e){let t=R.randomBetween(0,R.TWO_PI),n=R.randomBetween(0,this._radius),i=n*Math.cos(t),o=n*Math.sin(t),r=0;e.position=h.fromElements(i,o,r,e.position),e.velocity=h.clone(h.UNIT_Z,e.velocity)};var U5=UZ;var zZ={CUMULUS:0};zZ.validate=function(e){return e===zZ.CUMULUS};var vI=Object.freeze(zZ);function dh(e,t){if(e=x(e,x.EMPTY_OBJECT),this._show=x(e.show,!0),this._position=h.clone(x(e.position,h.ZERO)),!u(e.scale)&&u(e.maximumSize))this._maximumSize=h.clone(e.maximumSize),this._scale=new H(this._maximumSize.x,this._maximumSize.y);else{this._scale=H.clone(x(e.scale,new H(20,12)));let n=new h(this._scale.x,this._scale.y,Math.min(this._scale.x,this._scale.y)/1.5);this._maximumSize=h.clone(x(e.maximumSize,n))}this._slice=x(e.slice,-1),this._color=G.clone(x(e.color,G.WHITE)),this._brightness=x(e.brightness,1),this._cloudCollection=t,this._index=-1}var QAt=dh.SHOW_INDEX=0,JAt=dh.POSITION_INDEX=1,eTt=dh.SCALE_INDEX=2,tTt=dh.MAXIMUM_SIZE_INDEX=3,nTt=dh.SLICE_INDEX=4,iTt=dh.BRIGHTNESS_INDEX=5,oTt=dh.COLOR_INDEX=6;dh.NUMBER_OF_PROPERTIES=7;function Ub(e,t){let n=e._cloudCollection;u(n)&&(n._updateCloud(e,t),e._dirty=!0)}Object.defineProperties(dh.prototype,{show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,Ub(this,QAt))}},position:{get:function(){return this._position},set:function(e){let t=this._position;h.equals(t,e)||(h.clone(e,t),Ub(this,JAt))}},scale:{get:function(){return this._scale},set:function(e){let t=this._scale;H.equals(t,e)||(H.clone(e,t),Ub(this,eTt))}},maximumSize:{get:function(){return this._maximumSize},set:function(e){let t=this._maximumSize;h.equals(t,e)||(h.clone(e,t),Ub(this,tTt))}},color:{get:function(){return this._color},set:function(e){let t=this._color;G.equals(t,e)||(G.clone(e,t),Ub(this,oTt))}},slice:{get:function(){return this._slice},set:function(e){this._slice!==e&&(this._slice=e,Ub(this,nTt))}},brightness:{get:function(){return this._brightness},set:function(e){this._brightness!==e&&(this._brightness=e,Ub(this,iTt))}}});dh.prototype._destroy=function(){this._cloudCollection=void 0};var ed=dh;var ku,z5=new h,rTt={positionHighAndScaleX:0,positionLowAndScaleY:1,packedAttribute0:2,packedAttribute1:3,color:4},sTt={direction:0,positionHighAndScaleX:1,positionLowAndScaleY:2,packedAttribute0:3,packedAttribute1:4,color:5},aTt=ed.SHOW_INDEX,cTt=ed.POSITION_INDEX,lTt=ed.SCALE_INDEX,uTt=ed.MAXIMUM_SIZE_INDEX,fTt=ed.SLICE_INDEX,dTt=ed.BRIGHTNESS_INDEX,hTt=ed.NUMBER_OF_PROPERTIES,mTt=ed.COLOR_INDEX;function hh(e){e=x(e,x.EMPTY_OBJECT),this._clouds=[],this._cloudsToUpdate=[],this._cloudsToUpdateIndex=0,this._cloudsRemoved=!1,this._createVertexArray=!1,this._propertiesChanged=new Uint32Array(hTt),this._noiseTexture=void 0,this._textureSliceWidth=128,this._noiseTextureRows=4,this.noiseDetail=x(e.noiseDetail,16),this.noiseOffset=h.clone(x(e.noiseOffset,h.ZERO)),this._loading=!1,this._ready=!1;let t=this;this._uniforms={u_noiseTexture:function(){return t._noiseTexture},u_noiseTextureDimensions:xTe(t),u_noiseDetail:function(){return t.noiseDetail}},this._vaNoise=void 0,this._spNoise=void 0,this._spCreated=!1,this._sp=void 0,this._rs=void 0,this.show=x(e.show,!0),this._colorCommands=[],this.debugBillboards=x(e.debugBillboards,!1),this._compiledDebugBillboards=!1,this.debugEllipsoids=x(e.debugEllipsoids,!1),this._compiledDebugEllipsoids=!1}function xTe(e){return function(){return z5.x=e._textureSliceWidth,z5.y=e._noiseTextureRows,z5.z=1/e._noiseTextureRows,z5}}Object.defineProperties(hh.prototype,{length:{get:function(){return GZ(this),this._clouds.length}}});function bTe(e){let t=e.length;for(let n=0;n<t;++n)e[n]&&e[n]._destroy()}hh.prototype.add=function(e){e=x(e,x.EMPTY_OBJECT);let t=x(e.cloudType,vI.CUMULUS),n;return t===vI.CUMULUS&&(n=new ed(e,this),n._index=this._clouds.length,this._clouds.push(n),this._createVertexArray=!0),n};hh.prototype.remove=function(e){return this.contains(e)?(this._clouds[e._index]=void 0,this._cloudsRemoved=!0,this._createVertexArray=!0,e._destroy(),!0):!1};hh.prototype.removeAll=function(){bTe(this._clouds),this._clouds=[],this._cloudsToUpdate=[],this._cloudsToUpdateIndex=0,this._cloudsRemoved=!1,this._createVertexArray=!0};function GZ(e){if(e._cloudsRemoved){e._cloudsRemoved=!1;let t=[],n=e._clouds,i=n.length;for(let o=0,r=0;o<i;++o){let s=n[o];u(s)&&(n._index=r++,t.push(s))}e._clouds=t}}hh.prototype._updateCloud=function(e,t){e._dirty||(this._cloudsToUpdate[this._cloudsToUpdateIndex++]=e),++this._propertiesChanged[t]};hh.prototype.contains=function(e){return u(e)&&e._cloudCollection===this};hh.prototype.get=function(e){return GZ(this),this._clouds[e]};var pTt=new Float32Array([-1,-1,1,-1,1,1,-1,1]),_Tt=new Uint16Array([0,1,2,0,2,3]);function gTt(e){let t=xt.createVertexBuffer({context:e,typedArray:pTt,usage:ke.STATIC_DRAW}),n=xt.createIndexBuffer({context:e,typedArray:_Tt,usage:ke.STATIC_DRAW,indexDatatype:Be.UNSIGNED_SHORT}),i=[{index:0,vertexBuffer:t,componentsPerAttribute:2,componentDatatype:K.FLOAT}];return new ii({context:e,attributes:i,indexBuffer:n})}var WZ;function yTt(e){let n=e.cache.cloudCollection_indexBufferBatched;if(u(n))return n;let i=16384*6-6,o=new Uint16Array(i);for(let r=0,s=0;r<i;r+=6,s+=4)o[r]=s,o[r+1]=s+1,o[r+2]=s+2,o[r+3]=s,o[r+4]=s+2,o[r+5]=s+3;return n=xt.createIndexBuffer({context:e,typedArray:o,usage:ke.STATIC_DRAW,indexDatatype:Be.UNSIGNED_SHORT}),n.vertexArrayDestroyable=!1,e.cache.cloudCollection_indexBufferBatched=n,n}function xTt(e){let t=e.cache.cloudCollection_indexBufferInstanced;return u(t)||(t=xt.createIndexBuffer({context:e,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:ke.STATIC_DRAW,indexDatatype:Be.UNSIGNED_SHORT}),t.vertexArrayDestroyable=!1,e.cache.cloudCollection_indexBufferInstanced=t),t}function bTt(e){let t=e.cache.cloudCollection_vertexBufferInstanced;return u(t)||(t=xt.createVertexBuffer({context:e,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:ke.STATIC_DRAW}),t.vertexArrayDestroyable=!1,e.cache.cloudCollection_vertexBufferInstanced=t),t}function CTt(e,t,n){let i=[{index:ku.positionHighAndScaleX,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:ke.STATIC_DRAW},{index:ku.positionLowAndScaleY,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:ke.STATIC_DRAW},{index:ku.packedAttribute0,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:ke.STATIC_DRAW},{index:ku.packedAttribute1,componentsPerAttribute:4,componentDatatype:K.FLOAT,usage:ke.STATIC_DRAW},{index:ku.color,componentsPerAttribute:4,componentDatatype:K.UNSIGNED_BYTE,normalize:!0,usage:ke.STATIC_DRAW}];n&&i.push({index:ku.direction,componentsPerAttribute:2,componentDatatype:K.FLOAT,vertexBuffer:bTt(e)});let o=n?t:4*t;return new G_(e,i,o,n)}var HZ=new Gn;function CTe(e,t,n,i){let o,r=n[ku.positionHighAndScaleX],s=n[ku.positionLowAndScaleY],a=i.position;Gn.fromCartesian(a,HZ);let c=i.scale,l=HZ.high,f=HZ.low;e._instanced?(o=i._index,r(o,l.x,l.y,l.z,c.x),s(o,f.x,f.y,f.z,c.y)):(o=i._index*4,r(o+0,l.x,l.y,l.z,c.x),r(o+1,l.x,l.y,l.z,c.x),r(o+2,l.x,l.y,l.z,c.x),r(o+3,l.x,l.y,l.z,c.x),s(o+0,f.x,f.y,f.z,c.y),s(o+1,f.x,f.y,f.z,c.y),s(o+2,f.x,f.y,f.z,c.y),s(o+3,f.x,f.y,f.z,c.y))}function ATe(e,t,n,i){let o,r=n[ku.packedAttribute0],s=i.show,a=i.brightness;e._instanced?(o=i._index,r(o,s,a,0,0)):(o=i._index*4,r(o+0,s,a,0,0),r(o+1,s,a,1,0),r(o+2,s,a,1,1),r(o+3,s,a,0,1))}function TTe(e,t,n,i){let o,r=n[ku.packedAttribute1],s=i.maximumSize,a=i.slice;e._instanced?(o=i._index,r(o,s.x,s.y,s.z,a)):(o=i._index*4,r(o+0,s.x,s.y,s.z,a),r(o+1,s.x,s.y,s.z,a),r(o+2,s.x,s.y,s.z,a),r(o+3,s.x,s.y,s.z,a))}function ETe(e,t,n,i){let o,r=n[ku.color],s=i.color,a=G.floatToByte(s.red),c=G.floatToByte(s.green),l=G.floatToByte(s.blue),f=G.floatToByte(s.alpha);e._instanced?(o=i._index,r(o,a,c,l,f)):(o=i._index*4,r(o+0,a,c,l,f),r(o+1,a,c,l,f),r(o+2,a,c,l,f),r(o+3,a,c,l,f))}function ATt(e,t,n,i){CTe(e,t,n,i),ATe(e,t,n,i),TTe(e,t,n,i),ETe(e,t,n,i)}function TTt(e,t,n,i){let o=e,r=o._textureSliceWidth,s=o._noiseTextureRows,a=t.context;o._vaNoise=gTt(a),o._spNoise=tn.fromCache({context:a,vertexShaderSource:n,fragmentShaderSource:i,attributeLocations:{position:0}});let c=o.noiseDetail,l=o.noiseOffset;o._noiseTexture=new Ot({context:a,width:r*r/s,height:r*s,pixelDatatype:Ke.UNSIGNED_BYTE,pixelFormat:tt.RGBA,sampler:new Qt({wrapS:En.REPEAT,wrapT:En.REPEAT,minificationFilter:$t.NEAREST,magnificationFilter:mi.NEAREST})});let f=new cl({vertexArray:o._vaNoise,shaderProgram:o._spNoise,outputTexture:o._noiseTexture,uniformMap:{u_noiseTextureDimensions:xTe(o),u_noiseDetail:function(){return c},u_noiseOffset:function(){return l}},persists:!1,owner:e,postExecute:function(d){o._ready=!0,o._loading=!1}});t.commandList.push(f),o._loading=!0}function ETt(e,t){let n=e,i=t.context;n._createVertexArray=!1,n._vaf=n._vaf&&n._vaf.destroy();let o=e._clouds,r=o.length;if(r>0){n._vaf=CTt(i,r,n._instanced);let s=n._vaf.writers,a;for(a=0;a<r;++a){let c=o[a];ATt(e,t,s,c)}n._vaf.commit(WZ(i))}}var STt=[];function vTt(e,t){let n=t.context,i=e,r=i._clouds.length,s=i._cloudsToUpdate,a=i._cloudsToUpdateIndex,c=i._propertiesChanged,l=STt;l.length=0,(c[cTt]||c[lTt])&&l.push(CTe),(c[aTt]||c[dTt])&&l.push(ATe),(c[uTt]||c[fTt])&&l.push(TTe),c[mTt]&&l.push(ETe);let f=l.length,d=i._vaf.writers,p,g,m;if(a/r>.1){for(p=0;p<a;++p)for(g=s[p],g._dirty=!1,m=0;m<f;++m)l[m](e,t,d,g);i._vaf.commit(WZ(n))}else{for(p=0;p<a;++p){for(g=s[p],g._dirty=!1,m=0;m<f;++m)l[m](e,t,d,g);i._instanced?i._vaf.subCommit(g._index,1):i._vaf.subCommit(g._index*4,4)}i._vaf.endSubCommits()}i._cloudsToUpdateIndex=0}function wTt(e,t,n,i){let o=t.context,r=e,s=new ze({defines:[],sources:[n]});r._instanced&&s.defines.push("INSTANCED");let a=new ze({defines:[],sources:[i]});r.debugBillboards&&a.defines.push("DEBUG_BILLBOARDS"),r.debugEllipsoids&&a.defines.push("DEBUG_ELLIPSOIDS"),r._sp=tn.replaceCache({context:o,shaderProgram:r._sp,vertexShaderSource:s,fragmentShaderSource:a,attributeLocations:ku}),r._rs=Ue.fromCache({depthTest:{enabled:!0,func:te.LESS},depthMask:!1,blending:un.ALPHA_BLEND}),r._spCreated=!0,r._compiledDebugBillboards=r.debugBillboards,r._compiledDebugEllipsoids=r.debugEllipsoids}function DTt(e,t){let n=e,i=t.passes,o=n._uniforms,r=t.commandList;if(i.render){let s=n._colorCommands,a=n._vaf.va,c=a.length;s.length=c;for(let l=0;l<c;l++){let f=s[l];u(f)||(f=s[l]=new Qe),f.pass=we.TRANSLUCENT,f.owner=e,f.uniformMap=o,f.count=a[l].indicesCount,f.vertexArray=a[l].va,f.shaderProgram=n._sp,f.renderState=n._rs,n._instanced&&(f.count=6,f.instanceCount=n._clouds.length),r.push(f)}}}hh.prototype.update=function(e){if(GZ(this),!this.show)return;let t=this.debugBillboards||this.debugEllipsoids;this._ready=t?!0:u(this._noiseTexture),!this._ready&&!this._loading&&!t&&TTt(this,e,M5,O5),this._instanced=e.context.instancedArrays,ku=this._instanced?sTt:rTt,WZ=this._instanced?xTt:yTt;let i=this._clouds.length,o=this._cloudsToUpdate,r=this._cloudsToUpdateIndex;this._createVertexArray?ETt(this,e):r>0&&vTt(this,e),r>i*1.5&&(o.length=i),!(!u(this._vaf)||!u(this._vaf.va)||!this._ready&!t)&&((!this._spCreated||this.debugBillboards!==this._compiledDebugBillboards||this.debugEllipsoids!==this._compiledDebugEllipsoids)&&wTt(this,e,R5,P5),DTt(this,e))};hh.prototype.isDestroyed=function(){return!1};hh.prototype.destroy=function(){return this._noiseTexture=this._noiseTexture&&this._noiseTexture.destroy(),this._sp=this._sp&&this._sp.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),bTe(this._clouds),ue(this)};var STe=hh;var ITt=R.toRadians(30);function jZ(e){this._angle=x(e,ITt)}Object.defineProperties(jZ.prototype,{angle:{get:function(){return this._angle},set:function(e){this._angle=e}}});jZ.prototype.emit=function(e){let t=Math.tan(this._angle),n=R.randomBetween(0,R.TWO_PI),i=R.randomBetween(0,t),o=i*Math.cos(n),r=i*Math.sin(n),s=1;e.velocity=h.fromElements(o,r,s,e.velocity),h.normalize(e.velocity,e.velocity),e.position=h.clone(h.ZERO,e.position)};var vTe=jZ;var PTt=new G,RTt=new G,OTt=new G,MTt=new G,wTe=new oe,wI=new Uint8Array(4);function DTe(e,t,n,i){let o=t.height===n.height?0:(e-t.height)/(n.height-t.height);return G.lerp(t.color,n.color,o,i)}function H5(e,t){return{height:e,color:G.clone(t)}}function ITe(e){return e=e.filter(function(t,n,i){let o=n>0,r=n<i.length-1,s=o?t.height===i[n-1].height:!0,a=r?t.height===i[n+1].height:!0;return!s||!a}),e=e.filter(function(t,n,i){let o=n>0,r=n<i.length-1,s=o?G.equals(t.color,i[n-1].color):!1,a=r?G.equals(t.color,i[n+1].color):!1;return!s||!a}),e=e.filter(function(t,n,i){let o=n>0,r=o?G.equals(t.color,i[n-1].color):!1,s=o?t.height===i[n-1].height:!0;return!r||!s}),e}function LTt(e){let t,n,i=[],o=e.length;for(t=0;t<o;t++){let r=e[t],s=r.entries,a=s.length,c=[];for(n=0;n<a;n++){let g=s[n],m=R.clamp(g.height,Ul._minimumHeight,Ul._maximumHeight),y=G.clone(g.color,PTt);y.red*=y.alpha,y.green*=y.alpha,y.blue*=y.alpha,c.push(H5(m,y))}let l=!0,f=!0;for(n=0;n<a-1;n++){let g=c[n+0],m=c[n+1];l=l&&g.height<=m.height,f=f&&g.height>=m.height}f?c=c.reverse():l||Y0(c,function(g,m){return R.sign(g.height-m.height)});let d=x(r.extendDownwards,!1),p=x(r.extendUpwards,!1);c.length===1&&!d&&!p&&(d=!0,p=!0),d&&c.splice(0,0,H5(Ul._minimumHeight,c[0].color)),p&&c.splice(c.length,0,H5(Ul._maximumHeight,c[c.length-1].color)),c=ITe(c),i.push(c)}return i}function NTt(e){let t=LTt(e),n=[],i=[],o;function r(l,f){n.push(H5(l,f))}function s(l,f,d){let p=G.multiplyByScalar(d,1-f.alpha,MTt);p=G.add(p,f,p),r(l,p)}let a=t.length;for(o=0;o<a;o++){let l=t[o],f=0,d=0;i=n,n=[];let p=l.length,g=i.length;for(;f<p||d<g;){let m=f<p?l[f]:void 0,y=f>0?l[f-1]:void 0,b=f<p-1?l[f+1]:void 0,C=d<g?i[d]:void 0,A=d>0?i[d-1]:void 0,T=d<g-1?i[d+1]:void 0;if(u(m)&&u(C)&&m.height===C.height){let E=u(T)&&C.height===T.height,v=!u(A),D=!u(T),O=u(b)&&m.height===b.height,P=!u(y),M=!u(b);E?O?(s(m.height,m.color,C.color),s(m.height,b.color,T.color)):P?(r(m.height,C.color),s(m.height,m.color,T.color)):M?(s(m.height,m.color,C.color),r(m.height,T.color)):(s(m.height,m.color,C.color),s(m.height,m.color,T.color)):v?O?(r(m.height,m.color),s(m.height,b.color,C.color)):M?(r(m.height,m.color),r(m.height,C.color)):(P||r(m.height,m.color),s(m.height,m.color,C.color)):D?O?(s(m.height,m.color,C.color),r(m.height,b.color)):P?(r(m.height,C.color),r(m.height,m.color)):M?s(m.height,m.color,C.color):(s(m.height,m.color,C.color),r(m.height,m.color)):O?(s(m.height,m.color,C.color),s(m.height,b.color,C.color)):P?(r(m.height,C.color),s(m.height,m.color,C.color)):M?(s(m.height,m.color,C.color),r(m.height,C.color)):s(m.height,m.color,C.color),f+=O?2:1,d+=E?2:1}else if(u(m)&&u(C)&&u(A)&&m.height<C.height){let E=DTe(m.height,A,C,OTt);u(y)?u(b)?s(m.height,m.color,E):(s(m.height,m.color,E),r(m.height,E)):(r(m.height,E),s(m.height,m.color,E)),f++}else if(u(C)&&u(m)&&u(y)&&C.height<m.height){let E=DTe(C.height,y,m,RTt);u(A)?u(T)?s(C.height,E,C.color):(s(C.height,E,C.color),r(C.height,E)):(r(C.height,E),s(C.height,E,C.color)),d++}else u(m)&&(!u(C)||m.height<C.height)?(u(C)&&!u(A)&&!u(b)?(r(m.height,m.color),r(m.height,Ul._emptyColor),r(C.height,Ul._emptyColor)):(!u(C)&&u(A)&&!u(y)&&(r(A.height,Ul._emptyColor),r(m.height,Ul._emptyColor)),r(m.height,m.color)),f++):u(C)&&(!u(m)||C.height<m.height)&&(r(C.height,C.color),d++)}}return ITe(n)}function Ul(e){let{scene:t,layers:n}=x(e,x.EMPTY_OBJECT),{context:i}=t,o=NTt(n),r=o.length,s,a,c;if(!Ul._useFloatTexture(i)){a=Ke.UNSIGNED_BYTE,c=tt.RGBA,s=new Uint8Array(r*4);for(let g=0;g<r;g++)oe.packFloat(o[g].height,wTe),oe.pack(wTe,s,g*4)}else{a=Ke.FLOAT,c=i.webgl2?tt.RED:tt.LUMINANCE,s=new Float32Array(r);for(let g=0;g<r;g++)s[g]=o[g].height}let f=Ot.create({context:i,pixelFormat:c,pixelDatatype:a,source:{arrayBufferView:s,width:r,height:1},sampler:new Qt({wrapS:En.CLAMP_TO_EDGE,wrapT:En.CLAMP_TO_EDGE,minificationFilter:$t.NEAREST,magnificationFilter:mi.NEAREST})}),d=new Uint8Array(r*4);for(let g=0;g<r;g++)o[g].color.toBytes(wI),d[g*4+0]=wI[0],d[g*4+1]=wI[1],d[g*4+2]=wI[2],d[g*4+3]=wI[3];let p=Ot.create({context:i,pixelFormat:tt.RGBA,pixelDatatype:Ke.UNSIGNED_BYTE,source:{arrayBufferView:d,width:r,height:1},sampler:new Qt({wrapS:En.CLAMP_TO_EDGE,wrapT:En.CLAMP_TO_EDGE,minificationFilter:$t.LINEAR,magnificationFilter:mi.LINEAR})});return Zi.fromType("ElevationBand",{heights:f,colors:p})}Ul._useFloatTexture=function(e){return e.floatingPointTexture};Ul._maximumHeight=5906376425472;Ul._minimumHeight=-5906376425472;Ul._emptyColor=new G(0,0,0,0);var PTe=Ul;async function FTt(e,t){if(t=x(t,{}),t.cacheBytes=x(t.cacheBytes,1536*1024*1024),t.maximumCacheOverflowBytes=x(t.maximumCacheOverflowBytes,1024*1024*1024),t.enableCollision=x(t.enableCollision,!0),e=x(e,ME.defaultApiKey),!u(e))return BTt(t);let n,i=ME.getDefaultCredit();u(i)&&(n=[i]);let o=new De({url:`${ME.mapTilesApiEndpoint}3dtiles/root.json`,queryParameters:{key:e},credits:n});return Ia.fromUrl(o,t)}var RTe={};async function BTt(e){let i=RTe[2275207];u(i)||(i=cf.fromAssetId(2275207),RTe[2275207]=i);let o=await i;return Ia.fromUrl(o,e)}var OTe=FTt;async function kTt(e){let t=await Ia.fromIonAssetId(96188,e);e=x(e,x.EMPTY_OBJECT);let n=e.style;if(!u(n)){let i=x(e.defaultColor,G.WHITE).toCssColorString();n=new bS({color:`Boolean(\${feature['cesium#color']}) ? color(\${feature['cesium#color']}) : ${i}`})}return t.style=n,t}var MTe=kTt;function VTt(e){e=x(e,x.EMPTY_OBJECT);let t=[],n=e.geometry;(!u(n.attributes)||!u(n.primitiveType))&&(n=n.constructor.createGeometry(n));let i=n.attributes,o=F.clone(x(e.modelMatrix,F.IDENTITY)),r=x(e.length,1e4);if(u(i.normal)&&t.push(new vt({geometry:Nn.createLineSegmentsForVectors(n,"normal",r),attributes:{color:new jt(1,0,0,1)},modelMatrix:o})),u(i.tangent)&&t.push(new vt({geometry:Nn.createLineSegmentsForVectors(n,"tangent",r),attributes:{color:new jt(0,1,0,1)},modelMatrix:o})),u(i.bitangent)&&t.push(new vt({geometry:Nn.createLineSegmentsForVectors(n,"bitangent",r),attributes:{color:new jt(0,0,1,1)},modelMatrix:o})),t.length>0)return new In({asynchronous:!1,geometryInstances:t,appearance:new ln({flat:!0,translucent:!1})})}var LTe=VTt;function DI(e){e=x(e,x.EMPTY_OBJECT);let t=e.attributeName,n=e.perInstanceAttribute;u(n)||(n=!1);let i=x(e.glslDatatype,"vec3"),o=`v_${t}`,r;if(t==="normal"||t==="tangent"||t==="bitangent")r=`vec4 getColor() { return vec4((${o} + vec3(1.0)) * 0.5, 1.0); }
`;else switch(t==="st"&&(i="vec2"),i){case"float":r=`vec4 getColor() { return vec4(vec3(${o}), 1.0); }
`;break;case"vec2":r=`vec4 getColor() { return vec4(${o}, 0.0, 1.0); }
`;break;case"vec3":r=`vec4 getColor() { return vec4(${o}, 1.0); }
`;break;case"vec4":r=`vec4 getColor() { return ${o}; }
`;break}let s=`in vec3 position3DHigh;
in vec3 position3DLow;
in float batchId;
${n?"":`in ${i} ${t};
`}out ${i} ${o};
void main()
{
vec4 p = czm_translateRelativeToEye(position3DHigh, position3DLow);
${n?`${o} = czm_batchTable_${t}(batchId);
`:`${o} = ${t};
`}gl_Position = czm_modelViewProjectionRelativeToEye * p;
}`,a=`in ${i} ${o};
${r}
void main()
{
out_FragColor = getColor();
}`;this.material=void 0,this.translucent=x(e.translucent,!1),this._vertexShaderSource=x(e.vertexShaderSource,s),this._fragmentShaderSource=x(e.fragmentShaderSource,a),this._renderState=so.getDefaultRenderState(!1,!1,e.renderState),this._closed=x(e.closed,!1),this._attributeName=t,this._glslDatatype=i}Object.defineProperties(DI.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},attributeName:{get:function(){return this._attributeName}},glslDatatype:{get:function(){return this._glslDatatype}}});DI.prototype.getFragmentShaderSource=so.prototype.getFragmentShaderSource;DI.prototype.isTranslucent=so.prototype.isTranslucent;DI.prototype.getRenderState=so.prototype.getRenderState;var NTe=DI;function G5(e){e=x(e,x.EMPTY_OBJECT),this.length=x(e.length,1e7),this._length=void 0,this.width=x(e.width,2),this._width=void 0,this.show=x(e.show,!0),this.modelMatrix=F.clone(x(e.modelMatrix,F.IDENTITY)),this._modelMatrix=new F,this.id=e.id,this._id=void 0,this._primitive=void 0}G5.prototype.update=function(e){if(this.show){if(!u(this._primitive)||!F.equals(this._modelMatrix,this.modelMatrix)||this._length!==this.length||this._width!==this.width||this._id!==this.id){this._modelMatrix=F.clone(this.modelMatrix,this._modelMatrix),this._length=this.length,this._width=this.width,this._id=this.id,u(this._primitive)&&this._primitive.destroy(),this.modelMatrix[12]===0&&this.modelMatrix[13]===0&&this.modelMatrix[14]===0&&(this.modelMatrix[14]=.01);let t=new vt({geometry:new b0({positions:[h.ZERO,h.UNIT_X],width:this.width,vertexFormat:rs.VERTEX_FORMAT,colors:[G.RED,G.RED],arcType:nn.NONE}),modelMatrix:F.multiplyByUniformScale(this.modelMatrix,this.length,new F),id:this.id,pickPrimitive:this}),n=new vt({geometry:new b0({positions:[h.ZERO,h.UNIT_Y],width:this.width,vertexFormat:rs.VERTEX_FORMAT,colors:[G.GREEN,G.GREEN],arcType:nn.NONE}),modelMatrix:F.multiplyByUniformScale(this.modelMatrix,this.length,new F),id:this.id,pickPrimitive:this}),i=new vt({geometry:new b0({positions:[h.ZERO,h.UNIT_Z],width:this.width,vertexFormat:rs.VERTEX_FORMAT,colors:[G.BLUE,G.BLUE],arcType:nn.NONE}),modelMatrix:F.multiplyByUniformScale(this.modelMatrix,this.length,new F),id:this.id,pickPrimitive:this});this._primitive=new In({geometryInstances:[t,n,i],appearance:new rs,asynchronous:!1})}this._primitive.update(e)}};G5.prototype.isDestroyed=function(){return!1};G5.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),ue(this)};var W5=G5;function UTt(e){this.direction=h.clone(e.direction),this.color=G.clone(x(e.color,G.WHITE)),this.intensity=x(e.intensity,1)}var FTe=UTt;var j5=`in vec3 v_positionMC;
in vec3 v_positionEC;
in vec2 v_st;

void main()
{
    czm_materialInput materialInput;

    vec3 normalEC = normalize(czm_normal3D * czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0)));
#ifdef FACE_FORWARD
    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);
#endif

    materialInput.s = v_st.s;
    materialInput.st = v_st;
    materialInput.str = vec3(v_st, 0.0);

    // Convert tangent space material normal to eye space
    materialInput.normalEC = normalEC;
    materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(v_positionMC, materialInput.normalEC);

    // Convert view vector to world space
    vec3 positionToEyeEC = -v_positionEC;
    materialInput.positionToEyeEC = positionToEyeEC;

    czm_material material = czm_getMaterial(materialInput);

#ifdef FLAT
    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#else
    out_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);
#endif
}
`;var q5=`in vec3 position3DHigh;
in vec3 position3DLow;
in vec2 st;
in float batchId;

out vec3 v_positionMC;
out vec3 v_positionEC;
out vec2 v_st;

void main()
{
    vec4 p = czm_computePosition();

    v_positionMC = position3DHigh + position3DLow;           // position in model coordinates
    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;     // position in eye coordinates
    v_st = st;

    gl_Position = czm_modelViewProjectionRelativeToEye * p;
}
`;function zb(e){e=x(e,x.EMPTY_OBJECT);let t=x(e.translucent,!0),n=x(e.aboveGround,!1);this.material=u(e.material)?e.material:Zi.fromType(Zi.ColorType),this.translucent=x(e.translucent,!0),this._vertexShaderSource=x(e.vertexShaderSource,q5),this._fragmentShaderSource=x(e.fragmentShaderSource,j5),this._renderState=so.getDefaultRenderState(t,!n,e.renderState),this._closed=!1,this._flat=x(e.flat,!1),this._faceForward=x(e.faceForward,n),this._aboveGround=n}Object.defineProperties(zb.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return zb.VERTEX_FORMAT}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}},aboveGround:{get:function(){return this._aboveGround}}});zb.VERTEX_FORMAT=Ie.POSITION_AND_ST;zb.prototype.getFragmentShaderSource=so.prototype.getFragmentShaderSource;zb.prototype.isTranslucent=so.prototype.isTranslucent;zb.prototype.getRenderState=so.prototype.getRenderState;var BTe=zb;function zl(e){this._scene=e.scene,this.samplingWindow=x(e.samplingWindow,zl.defaultSettings.samplingWindow),this.quietPeriod=x(e.quietPeriod,zl.defaultSettings.quietPeriod),this.warmupPeriod=x(e.warmupPeriod,zl.defaultSettings.warmupPeriod),this.minimumFrameRateDuringWarmup=x(e.minimumFrameRateDuringWarmup,zl.defaultSettings.minimumFrameRateDuringWarmup),this.minimumFrameRateAfterWarmup=x(e.minimumFrameRateAfterWarmup,zl.defaultSettings.minimumFrameRateAfterWarmup),this._lowFrameRate=new me,this._nominalFrameRate=new me,this._frameTimes=[],this._needsQuietPeriod=!0,this._quietPeriodEndTime=0,this._warmupPeriodEndTime=0,this._frameRateIsLow=!1,this._lastFramesPerSecond=void 0,this._pauseCount=0;let t=this;this._preUpdateRemoveListener=this._scene.preUpdate.addEventListener(function(o,r){zTt(t,r)}),this._hiddenPropertyName=document.hidden!==void 0?"hidden":document.mozHidden!==void 0?"mozHidden":document.msHidden!==void 0?"msHidden":document.webkitHidden!==void 0?"webkitHidden":void 0;let n=document.hidden!==void 0?"visibilitychange":document.mozHidden!==void 0?"mozvisibilitychange":document.msHidden!==void 0?"msvisibilitychange":document.webkitHidden!==void 0?"webkitvisibilitychange":void 0;function i(){HTt(t)}this._visibilityChangeRemoveListener=void 0,u(n)&&(document.addEventListener(n,i,!1),this._visibilityChangeRemoveListener=function(){document.removeEventListener(n,i,!1)})}zl.defaultSettings={samplingWindow:5,quietPeriod:2,warmupPeriod:5,minimumFrameRateDuringWarmup:4,minimumFrameRateAfterWarmup:8};zl.fromScene=function(e){return(!u(e._frameRateMonitor)||e._frameRateMonitor.isDestroyed())&&(e._frameRateMonitor=new zl({scene:e})),e._frameRateMonitor};Object.defineProperties(zl.prototype,{scene:{get:function(){return this._scene}},lowFrameRate:{get:function(){return this._lowFrameRate}},nominalFrameRate:{get:function(){return this._nominalFrameRate}},lastFramesPerSecond:{get:function(){return this._lastFramesPerSecond}}});zl.prototype.pause=function(){++this._pauseCount,this._pauseCount===1&&(this._frameTimes.length=0,this._lastFramesPerSecond=void 0)};zl.prototype.unpause=function(){--this._pauseCount,this._pauseCount<=0&&(this._pauseCount=0,this._needsQuietPeriod=!0)};zl.prototype.isDestroyed=function(){return!1};zl.prototype.destroy=function(){return this._preUpdateRemoveListener(),u(this._visibilityChangeRemoveListener)&&this._visibilityChangeRemoveListener(),ue(this)};function zTt(e,t){if(e._pauseCount>0)return;let n=Ei();if(e._needsQuietPeriod)e._needsQuietPeriod=!1,e._frameTimes.length=0,e._quietPeriodEndTime=n+e.quietPeriod/Yn.SECONDS_PER_MILLISECOND,e._warmupPeriodEndTime=e._quietPeriodEndTime+(e.warmupPeriod+e.samplingWindow)/Yn.SECONDS_PER_MILLISECOND;else if(n>=e._quietPeriodEndTime){e._frameTimes.push(n);let i=n-e.samplingWindow/Yn.SECONDS_PER_MILLISECOND;if(e._frameTimes.length>=2&&e._frameTimes[0]<=i){for(;e._frameTimes.length>=2&&e._frameTimes[1]<i;)e._frameTimes.shift();let o=(n-e._frameTimes[0])/(e._frameTimes.length-1);e._lastFramesPerSecond=1e3/o;let r=1e3/(n>e._warmupPeriodEndTime?e.minimumFrameRateAfterWarmup:e.minimumFrameRateDuringWarmup);o>r?e._frameRateIsLow||(e._frameRateIsLow=!0,e._needsQuietPeriod=!0,e.lowFrameRate.raiseEvent(e.scene,e._lastFramesPerSecond)):e._frameRateIsLow&&(e._frameRateIsLow=!1,e._needsQuietPeriod=!0,e.nominalFrameRate.raiseEvent(e.scene,e._lastFramesPerSecond))}}}function HTt(e){document[e._hiddenPropertyName]?e.pause():e.unpause()}var Y5=zl;var kTe=Dr(vX(),1);function qZ(){this._image=new Image}qZ.prototype.isReady=function(){return!0};qZ.prototype.shouldDiscardImage=function(e){return e===this._image};function Hb(e){e=x(e,x.EMPTY_OBJECT),this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._tileDiscardPolicy=e.tileDiscardPolicy,this._tilingScheme=new $i({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new se(-R.PI,-R.PI,R.PI,R.PI),ellipsoid:e.ellipsoid});let t=e.credit;typeof t=="string"&&(t=new wt(t)),this._credit=t,this._tileWidth=256,this._tileHeight=256,this._maximumLevel=23,u(this._tileDiscardPolicy)||(this._tileDiscardPolicy=new qZ),this._errorEvent=new me}Object.defineProperties(Hb.prototype,{url:{get:function(){return this._metadata.url}},proxy:{get:function(){return this._metadata.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!1}}});Hb.fromMetadata=function(e,t){if(!e.imageryPresent)throw new ce(`The server ${e.url} doesn't have imagery`);let n=new Hb(t);return n._metadata=e,n};Hb.prototype.getTileCredits=function(e,t,n){let i=this._metadata,o=i.getTileInformation(e,t,n);if(u(o)){let r=i.providers[o.imageryProvider];if(u(r))return[r]}};Hb.prototype.requestImage=function(e,t,n,i){let o=this._tileDiscardPolicy._image,r=this._metadata,s=j0.tileXYToQuadKey(e,t,n),a=r.getTileInformation(e,t,n);if(!u(a)){if(r.isValid(s)){let l=new rr({throttle:i.throttle,throttleByServer:i.throttleByServer,type:i.type,priorityFunction:i.priorityFunction});r.populateSubtree(e,t,n,l);return}return Promise.resolve(o)}if(!a.hasImagery())return Promise.resolve(o);let c=GTt(this,a,e,t,n,i).fetchArrayBuffer();if(u(c))return c.then(function(l){GV(r.key,l);let f=new Uint8Array(l),d,p=r.protoImagery;if((!u(p)||!p)&&(d=WTt(f)),!u(d)&&(!u(p)||p)){let g=jTt(f);d=g.imageType,f=g.imageData}return!u(d)||!u(f)?o:cA({uint8Array:f,format:d,flipY:!0})})};Hb.prototype.pickFeatures=function(e,t,n,i,o){};function GTt(e,t,n,i,o,r){let s=j0.tileXYToQuadKey(n,i,o),a=t.imageryVersion;return a=u(a)&&a>0?a:1,e._metadata.resource.getDerivedResource({url:`flatfile?f1-0${s}-i.${a.toString()}`,request:r})}function WTt(e){let t="JFIF";if(e[6]===t.charCodeAt(0)&&e[7]===t.charCodeAt(1)&&e[8]===t.charCodeAt(2)&&e[9]===t.charCodeAt(3))return"image/jpeg";let n="PNG";if(e[1]===n.charCodeAt(0)&&e[2]===n.charCodeAt(1)&&e[3]===n.charCodeAt(2))return"image/png"}function jTt(e){let t=kTe.Reader.create(e),n=t.len,i={};for(;t.pos<n;){let s=t.uint32(),a;switch(s>>>3){case 1:i.imageType=t.uint32();break;case 2:i.imageData=t.bytes();break;case 3:i.alphaType=t.uint32();break;case 4:i.imageAlpha=t.bytes();break;case 5:if(a=i.copyrightIds,u(a)||(a=i.copyrightIds=[]),(s&7)===2){let c=t.uint32()+t.pos;for(;t.pos<c;)a.push(t.uint32())}else a.push(t.uint32());break;default:t.skipType(s&7);break}}let o=i.imageType;if(u(o))switch(o){case 0:i.imageType="image/jpeg";break;case 4:i.imageType="image/png";break;default:throw new ce("GoogleEarthEnterpriseImageryProvider: Unsupported image type.")}let r=i.alphaType;return u(r)&&r!==0&&(console.log("GoogleEarthEnterpriseImageryProvider: External alpha not supported."),delete i.alphaType,delete i.imageAlpha),i}var VTe=Hb;var qTt=new G(1,1,1,.4),YTt=new G(0,1,0,.05),XTt=new G(0,.5,0,.2);function Gb(e){e=x(e,x.EMPTY_OBJECT),this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._tilingScheme=u(e.tilingScheme)?e.tilingScheme:new $i({ellipsoid:e.ellipsoid}),this._cells=x(e.cells,8),this._color=x(e.color,qTt),this._glowColor=x(e.glowColor,YTt),this._glowWidth=x(e.glowWidth,6),this._backgroundColor=x(e.backgroundColor,XTt),this._errorEvent=new me,this._tileWidth=x(e.tileWidth,256),this._tileHeight=x(e.tileHeight,256),this._canvasSize=x(e.canvasSize,256),this._canvas=this._createGridCanvas()}Object.defineProperties(Gb.prototype,{proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){}},minimumLevel:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){}},hasAlphaChannel:{get:function(){return!0}}});Gb.prototype._drawGrid=function(e){let n=this._canvasSize;for(let i=0;i<=this._cells;++i){let r=1+i/this._cells*(n-1);e.moveTo(r,0),e.lineTo(r,n),e.moveTo(0,r),e.lineTo(n,r)}e.stroke()};Gb.prototype._createGridCanvas=function(){let e=document.createElement("canvas");e.width=this._canvasSize,e.height=this._canvasSize;let t=0,n=this._canvasSize,i=e.getContext("2d"),o=this._backgroundColor.toCssColorString();i.fillStyle=o,i.fillRect(t,t,n,n);let r=this._glowColor.toCssColorString();i.strokeStyle=r,i.lineWidth=this._glowWidth,i.strokeRect(t,t,n,n),this._drawGrid(i),i.lineWidth=this._glowWidth*.5,i.strokeRect(t,t,n,n),this._drawGrid(i);let s=this._color.toCssColorString();return i.strokeStyle=s,i.lineWidth=2,i.strokeRect(t,t,n,n),i.lineWidth=1,this._drawGrid(i),e};Gb.prototype.getTileCredits=function(e,t,n){};Gb.prototype.requestImage=function(e,t,n,i){return Promise.resolve(this._canvas)};Gb.prototype.pickFeatures=function(e,t,n,i,o){};var UTe=Gb;function mh(){}mh._maxDecodingConcurrency=Math.max(Wt.hardwareConcurrency-1,1);mh._decodeTaskProcessor=new xi("decodeI3S",mh._maxDecodingConcurrency);mh._promise=void 0;async function KTt(){if(await mh._decodeTaskProcessor.initWebAssemblyModule({wasmBinaryFile:"ThirdParty/draco_decoder.wasm"}))return mh._decodeTaskProcessor;throw new ce("I3S decoder could not be initialized.")}mh.decode=async function(e,t,n,i,o){return u(mh._promise)||(mh._promise=KTt()),mh._promise.then(function(r){let s=n._parent._data,a=n._parent._inverseRotationMatrix,c=0,l=0,f=0;u(s.obb)?(c=s.obb.center[0],l=s.obb.center[1],f=s.obb.center[2]):u(s.mbs)&&(c=s.mbs[0],l=s.mbs[1],f=s.mbs[2]);let d=J.fromRotationX(-R.PI_OVER_TWO),p=new J;J.multiply(d,a,p);let g=de.fromDegrees(c,l,f),m=ee.WGS84.cartographicToCartesian(g),y={binaryData:n._data,featureData:u(i)&&u(i[0])?i[0].data:void 0,schema:t,bufferInfo:n._geometryBufferInfo,ellipsoidRadiiSquare:ee.WGS84.radiiSquared,url:e,geoidDataList:n._dataProvider._geoidDataList,cartographicCenter:g,cartesianCenter:m,parentRotation:p,enableFeatures:n._dataProvider.showFeatures,splitGeometryByColorTransparency:n._dataProvider.adjustMaterialAlphaMode,symbologyData:o,calculateNormals:n._dataProvider.calculateNormals};return r.scheduleTask(y)})};var X5=mh;function YZ(e,t){this._parent=e,this._dataProvider=e._dataProvider,this._layer=e._layer,u(this._parent._nodeIndex)?this._resource=this._parent._layer.resource.getDerivedResource({url:`nodes/${this._parent._data.mesh.attribute.resource}/${t}`}):this._resource=this._parent.resource.getDerivedResource({url:t})}Object.defineProperties(YZ.prototype,{resource:{get:function(){return this._resource}},data:{get:function(){return this._data}}});YZ.prototype.load=async function(){return this._data=await jm.loadJson(this._resource),this._data};var K5=YZ;function w_(e,t){this._storageInfo=t,this._parent=e,this._dataProvider=e._dataProvider,this._loadPromise=void 0;let n=`attributes/${t.key}/0`;u(this._parent._nodeIndex)?this._resource=this._parent._layer.resource.getDerivedResource({url:`nodes/${this._parent._data.mesh.attribute.resource}/${n}`}):this._resource=this._parent.resource.getDerivedResource({url:n})}Object.defineProperties(w_.prototype,{resource:{get:function(){return this._resource}},header:{get:function(){return this._header}},values:{get:function(){if(u(this._values)){if(u(this._values.attributeValues))return this._values.attributeValues;if(u(this._values.objectIds))return this._values.objectIds}return[]}},name:{get:function(){return this._storageInfo.name}}});function Z5(e){return e==="UInt8"||e==="Int8"?1:e==="UInt16"||e==="Int16"?2:e==="UInt32"||e==="Int32"||e==="Oid32"||e==="Float32"?4:e==="UInt64"||e==="Int64"||e==="Float64"?8:0}function ZTt(e){return e==="String"?1:Z5(e)}async function $Tt(e){let t=await e._dataProvider._loadBinary(e._resource),n=new DataView(t);e._data=t,e._validateHeader(n);let i=e._parseHeader(n),o=e._getBodyOffset(i);e._validateBody(n,o),e._parseBody(n,o)}w_.prototype.load=function(){return u(this._loadPromise)?this._loadPromise:(this._loadPromise=$Tt(this).catch(function(e){console.error(e)}),this._loadPromise)};w_.prototype._parseValue=function(e,t,n){let i;if(t==="UInt8")i=e.getUint8(n),n+=1;else if(t==="Int8")i=e.getInt8(n),n+=1;else if(t==="UInt16")i=e.getUint16(n,!0),n+=2;else if(t==="Int16")i=e.getInt16(n,!0),n+=2;else if(t==="UInt32")i=e.getUint32(n,!0),n+=4;else if(t==="Oid32")i=e.getUint32(n,!0),n+=4;else if(t==="Int32")i=e.getInt32(n,!0),n+=4;else if(t==="UInt64"){let o=e.getUint32(n,!0),r=e.getUint32(n+4,!0);i=o+Math.pow(2,32)*r,n+=8}else if(t==="Int64"){let o=e.getUint32(n,!0),r=e.getUint32(n+4,!0);r<Math.pow(2,31)?i=o+Math.pow(2,32)*r:i=o+Math.pow(2,32)*(r-Math.pow(2,32)),n+=8}else t==="Float32"?(i=e.getFloat32(n,!0),n+=4):t==="Float64"?(i=e.getFloat64(n,!0),n+=8):t==="String"&&(i=String.fromCharCode(e.getUint8(n)),n+=1);return{value:i,offset:n}};w_.prototype._parseHeader=function(e){let t=0;this._header={};for(let n=0;n<this._storageInfo.header.length;n++){let i=this._storageInfo.header[n],o=this._parseValue(e,i.valueType,t);this._header[i.property]=o.value,t=o.offset}return t};w_.prototype._parseBody=function(e,t){this._values={};for(let n=0;n<this._storageInfo.ordering.length;n++){let i=this._storageInfo.ordering[n],o=i==="ObjectIds"?"objectIds":i,r=this._storageInfo[o];if(u(r)){this._values[o]=[];for(let s=0;s<this._header.count;++s)if(r.valueType!=="String"){let a=this._parseValue(e,r.valueType,t);this._values[o].push(a.value),t=a.offset}else{let a=this._values.attributeByteCounts[s],c="";for(let l=0;l<a;++l){let f=this._parseValue(e,r.valueType,t);f.value.charCodeAt(0)!==0&&(c+=f.value),t=f.offset}this._values[o].push(c)}}}};w_.prototype._getBodyOffset=function(e){let t=0;return u(this._storageInfo.attributeValues)?t=Z5(this._storageInfo.attributeValues.valueType):u(this._storageInfo.objectIds)&&(t=Z5(this._storageInfo.objectIds.valueType)),t>0?Math.ceil(e/t)*t:e};w_.prototype._validateHeader=function(e){let t=0;for(let n=0;n<this._storageInfo.header.length;n++){let i=this._storageInfo.header[n];t+=ZTt(i.valueType)}if(e.byteLength<t)throw new ce(`Invalid attribute buffer size (field: ${this.name}, header: ${t}, actual: ${e.byteLength})`)};w_.prototype._validateBody=function(e,t){if(!u(this._header.count))throw new ce(`Invalid attribute buffer (field: ${this.name}, count is missing)`);let n;for(let i=0;i<this._storageInfo.ordering.length&&t<e.byteLength;i++){let o=this._storageInfo.ordering[i],r=o==="ObjectIds"?"objectIds":o,s=this._storageInfo[r];if(u(s))if(s.valueType!=="String"){r==="attributeByteCounts"&&(n=t);let a=Z5(s.valueType);t+=a*this._header.count}else{if(!u(n))throw new ce(`Invalid attribute buffer (field: ${this.name}, attributeByteCounts is missing)`);for(let a=0;a<this._header.count&&t<e.byteLength;++a){let c=this._parseValue(e,this._storageInfo.attributeByteCounts.valueType,n);t+=c.value,n=c.offset}}else throw new ce(`Invalid attribute buffer (field: ${this.name}, ${r} is missing)`)}if(e.byteLength<t)throw new ce(`Invalid attribute buffer size (field: ${this.name}, expected: ${t}, actual: ${e.byteLength})`)};var $5=w_;function II(e,t){let n=e._dataProvider,i=e._layer,o;u(e._nodeIndex)?o=i.resource.getDerivedResource({url:`nodes/${e._data.mesh.geometry.resource}/${t}`}):o=e.resource.getDerivedResource({url:t}),this._parent=e,this._dataProvider=n,this._layer=i,this._resource=o,this._customAttributes=void 0}Object.defineProperties(II.prototype,{resource:{get:function(){return this._resource}},data:{get:function(){return this._data}},customAttributes:{get:function(){return this._customAttributes}}});II.prototype.load=function(){let e=this;return this._dataProvider._loadBinary(this._resource).then(function(t){return e._data=t,t})};var QTt=new h,JTt=new h,eEt=new h,tEt=new h,nEt=new h;function XZ(e,t,n,i){let o=h.subtract(i,n,QTt),r=h.cross(o,h.subtract(e,n,JTt),tEt),s=h.cross(o,h.subtract(t,n,eEt),nEt);return h.dot(r,s)>=0}var iEt=new h,oEt=new h,rEt=new h,sEt=new h,aEt=new h,cEt=new h,lEt=new h,uEt=new h,fEt=new h,dEt=new h;II.prototype.getClosestPointIndexOnTriangle=function(e,t,n){if(u(this._customAttributes)&&u(this._customAttributes.positions)){let i=new h(e,t,n);i.x-=this._customAttributes.cartesianCenter.x,i.y-=this._customAttributes.cartesianCenter.y,i.z-=this._customAttributes.cartesianCenter.z,J.multiplyByVector(this._customAttributes.parentRotation,i,i);let o=Number.MAX_VALUE,r,s,a,c,l=this._customAttributes.positions,f=this._customAttributes.indices,d;u(f)?d=f.length:d=l.length/3;for(let p=0;p<d;p++){let g,m,y;u(f)?(g=f[p],m=f[p+1],y=f[p+2]):(g=p*3,m=p*3+1,y=p*3+2);let b=h.fromElements(l[g*3],l[g*3+1],l[g*3+2],iEt),C=h.fromElements(l[m*3],l[m*3+1],l[m*3+2],oEt),A=new h(l[y*3],l[y*3+1],l[y*3+2],rEt);if(!XZ(i,b,C,A)||!XZ(i,C,b,A)||!XZ(i,A,b,C))continue;let T=h.subtract(C,b,sEt),E=h.subtract(A,b,aEt),v=h.cross(T,E,cEt);if(h.magnitude(v)===0)continue;let D=h.normalize(v,lEt),O=h.subtract(i,b,uEt),P=Math.abs(h.dot(O,D));if(P<o){o=P,r=p;let M=h.magnitudeSquared(h.subtract(i,b,O)),L=h.magnitudeSquared(h.subtract(i,C,fEt)),_=h.magnitudeSquared(h.subtract(i,A,dEt));M<L&&M<_?(a=g,c=b,s=M):L<_?(a=m,c=C,s=L):(a=y,c=A,s=_)}}if(u(r))return{index:a,distanceSquared:s,distance:Math.sqrt(s),queriedPosition:i,closestPosition:h.clone(c)}}return{index:-1,distanceSquared:Number.Infinity,distance:Number.Infinity}};function zTe(e){let t=[],n=e.length;for(let i=0;i<n;i++)i<3?t.push(BE(e[i])):t.push(e[i]);return t}II.prototype._generateGltf=function(e,t,n,i,o,r,s,a){let c={pbrMetallicRoughness:{metallicFactor:0},doubleSided:!0,name:"Material"},l=!1,f,d="";if(u(this._parent._data.mesh)&&u(this._layer._data.materialDefinitions)){let T=this._parent._data.mesh.material.definition;if(T>=0&&T<this._layer._data.materialDefinitions.length){if(f=this._layer._data.materialDefinitions[T],c=f,u(c.pbrMetallicRoughness)&&u(c.pbrMetallicRoughness.baseColorTexture)){l=!0,c.pbrMetallicRoughness.baseColorTexture.index=0;let E="0";if(u(this._layer._data.textureSetDefinitions))for(let v=0;v<this._layer._data.textureSetDefinitions.length;v++){let D=this._layer._data.textureSetDefinitions[v];for(let O=0;O<D.formats.length;O++){let P=D.formats[O];if(P.format==="jpg"){E=P.name;break}}}u(this._parent._data.mesh)&&this._parent._data.mesh.material.resource>=0&&(d=this._layer.resource.getDerivedResource({url:`nodes/${this._parent._data.mesh.material.resource}/textures/${E}`}).url)}u(c.pbrMetallicRoughness)&&u(c.pbrMetallicRoughness.baseColorFactor)&&(c.pbrMetallicRoughness.baseColorFactor=zTe(c.pbrMetallicRoughness.baseColorFactor)),u(c.emissiveFactor)&&(c.emissiveFactor=zTe(c.emissiveFactor))}}else u(this._parent._data.textureData)&&(l=!0,d=this._parent.resource.getDerivedResource({url:`${this._parent._data.textureData[0].href}`}).url,c.pbrMetallicRoughness.baseColorTexture={index:0});u(c.alphaMode)&&(c.alphaMode=c.alphaMode.toUpperCase());let p=[],g=[],m=[];l&&(p=[{sampler:0,source:0}],g=[{uri:d}],m=[{magFilter:9729,minFilter:9986,wrapS:10497,wrapT:10497}]);let y=[],b=n.length;for(let A=0;A<b;A++){let T=n[A].primitives,E=T.length;for(let v=0;v<E;v++){let D=T[v];if(u(D.material)){for(;D.material>=y.length;){let P=Ge(c,!0);y.push(P)}let O=y[D.material];u(D.extra)&&D.extra.isTransparent?u(O.alphaMode)||(O.alphaMode="BLEND"):O.alphaMode==="BLEND"&&(O.alphaMode="OPAQUE")}}}return{scene:0,scenes:[{nodes:e}],nodes:t,meshes:n,buffers:i,bufferViews:o,accessors:r,materials:y,textures:p,images:g,samplers:m,asset:{version:"2.0"},extensions:s,extensionsUsed:a}};var PI=II;function _c(e,t,n){let i,o,r,s;n?(i=0,o=e):(i=e._level+1,o=e._layer),typeof t=="number"?r=t:s=e.resource.getDerivedResource({url:`${t}/`}),this._parent=e,this._dataProvider=e._dataProvider,this._isRoot=n,this._level=i,this._layer=o,this._nodeIndex=r,this._resource=s,this._isLoading=!1,this._tile=void 0,this._data=void 0,this._geometryData=[],this._featureData=[],this._fields={},this._children=[],this._childrenReadyPromise=void 0,this._globalTransform=void 0,this._inverseGlobalTransform=void 0,this._inverseRotationMatrix=void 0,this._symbologyData=void 0}Object.defineProperties(_c.prototype,{resource:{get:function(){return this._resource}},layer:{get:function(){return this._layer}},parent:{get:function(){return this._parent}},children:{get:function(){return this._children}},geometryData:{get:function(){return this._geometryData}},featureData:{get:function(){return this._featureData}},fields:{get:function(){return this._fields}},tile:{get:function(){return this._tile}},data:{get:function(){return this._data}}});_c.prototype.load=async function(){let e=this;function t(){if(!e._isRoot){let o=e._create3DTileDefinition();e._tile=new Od(e._layer._tileset,e._dataProvider.resource,o,e._parent._tile),e._tile._i3sNode=e}}if(!u(this._nodeIndex)){let o=await jm.loadJson(this._resource);e._data=o,t();return}let n=await this._layer._getNodeInNodePages(this._nodeIndex);e._data=n;let i;e._isRoot?i="nodes/root/":u(n.mesh)&&(i=`../${n.mesh.geometry.resource}/`),u(i)&&u(e._parent.resource)&&(e._resource=e._parent.resource.getDerivedResource({url:i})),t()};function HTe(e,t){let n=new $5(e,t);return e._fields[t.name]=n,n.load()}_c.prototype.loadFields=function(){let e=this._layer._data.attributeStorageInfo,t=[];if(u(e))for(let n=0;n<e.length;n++){let i=e[n],o=this._fields[i.name];u(o)?t.push(o.load()):t.push(HTe(this,i))}return Promise.all(t)};_c.prototype.loadField=function(e){let t=this._fields[e];if(u(t))return t.load();let n=this._layer._data.attributeStorageInfo;if(u(n))for(let i=0;i<n.length;i++){let o=n[i];if(o.name===e)return HTe(this,o)}return Promise.resolve()};_c.prototype.getFieldsForPickedPosition=function(e){let t=this.geometryData[0];if(!u(t.customAttributes.featureIndex))return{};let n=t.getClosestPointIndexOnTriangle(e.x,e.y,e.z);if(n.index===-1||n.index>t.customAttributes.featureIndex.length)return{};let i=t.customAttributes.featureIndex[n.index];return this.getFieldsForFeature(i)};_c.prototype.getFieldsForFeature=function(e){let t={};for(let n in this.fields)if(this.fields.hasOwnProperty(n)){let i=this.fields[n];e>=0&&e<i.values.length&&(t[i.name]=i.values[e])}return t};_c.prototype._loadChildren=function(){let e=this;if(u(this._childrenReadyPromise))return this._childrenReadyPromise;let t=[];if(u(e._data.children))for(let n=0;n<e._data.children.length;n++){let i=e._data.children[n],o=new _c(e,x(i.href,i),!1);e._children.push(o),t.push(o.load())}return this._childrenReadyPromise=Promise.all(t).then(function(){for(let n=0;n<e._children.length;n++)e._tile.children.push(e._children[n]._tile)}),this._childrenReadyPromise};_c.prototype._loadGeometryData=function(){let e=[];if(u(this._data.geometryData))for(let t=0;t<this._data.geometryData.length;t++){let n=new PI(this,this._data.geometryData[t].href);this._geometryData.push(n),e.push(n.load())}else if(u(this._data.mesh)){let t=this._layer._findBestGeometryBuffers(this._data.mesh.geometry.definition,["position","uv0"]),n=`./geometries/${t.bufferIndex}/`,i=new PI(this,n);i._geometryDefinitions=t.definition,i._geometryBufferInfo=t.geometryBufferInfo,this._geometryData.push(i),e.push(i.load())}return Promise.all(e)};_c.prototype._loadFeatureData=function(){let e=[];if(u(this._data.featureData))for(let t=0;t<this._data.featureData.length;t++){let n=new K5(this,this._data.featureData[t].href);this._featureData.push(n),e.push(n.load())}return Promise.all(e)};_c.prototype._clearGeometryData=function(){this._geometryData=[]};_c.prototype._create3DTileDefinition=function(){let e=this._data.obb,t=this._data.mbs;if(!u(e)&&!u(t)){console.error("Failed to load I3S node. Bounding volume is required.");return}let n;if(u(e)?n=de.fromDegrees(e.center[0],e.center[1],e.center[2]):n=de.fromDegrees(t[0],t[1],t[2]),u(this._dataProvider._geoidDataList)&&u(n))for(let C=0;C<this._dataProvider._geoidDataList.length;C++){let A=this._dataProvider._geoidDataList[C],T=A.projection.project(n);if(T.x>A.nativeExtent.west&&T.x<A.nativeExtent.east&&T.y>A.nativeExtent.south&&T.y<A.nativeExtent.north){n.height+=_Et(T.x,T.y,A);break}}let i={},o,r=0;u(e)?(i={box:[0,0,0,e.halfSize[0],0,0,0,e.halfSize[1],0,0,0,e.halfSize[2]]},r=Math.max(Math.max(this._data.obb.halfSize[0],this._data.obb.halfSize[1]),this._data.obb.halfSize[2]),o=ee.WGS84.cartographicToCartesian(n)):(i={sphere:[0,0,0,t[3]]},o=ee.WGS84.cartographicToCartesian(n),r=this._data.mbs[3]),r*=2;let s=1/0;if(u(this._data.lodThreshold))if(this._layer._data.nodePages.lodSelectionMetricType==="maxScreenThresholdSQ"){let C=Math.sqrt(this._data.lodThreshold/(Math.PI*.25));s=r/C}else if(this._layer._data.nodePages.lodSelectionMetricType==="maxScreenThreshold"){let C=this._data.lodThreshold;s=r/C}else console.error("Invalid lodSelectionMetricType in Layer");else if(u(this._data.lodSelection))for(let C=0;C<this._data.lodSelection.length;C++)this._data.lodSelection[C].metricType==="maxScreenThreshold"&&(s=r/this._data.lodSelection[C].maxError);s===1/0&&(s=1e5);let a=s*16,c=new Wa(0,0,0),l=Lt.headingPitchRollQuaternion(o,c);u(this._data.obb)&&(l=new Le(this._data.obb.quaternion[0],this._data.obb.quaternion[1],this._data.obb.quaternion[2],this._data.obb.quaternion[3]));let f=J.fromQuaternion(l),d=J.inverse(f,new J),p=new F(f[0],f[1],f[2],0,f[3],f[4],f[5],0,f[6],f[7],f[8],0,o.x,o.y,o.z,1),g=F.inverse(p,new F),m=F.clone(p);u(this._parent._globalTransform)&&F.multiply(p,this._parent._inverseGlobalTransform,m),this._globalTransform=p,this._inverseGlobalTransform=g,this._inverseRotationMatrix=d;let y=[];for(let C=0;C<this._children.length;C++)y.push(this._children[C]._create3DTileDefinition());return{children:y,refine:"REPLACE",boundingVolume:i,transform:[m[0],m[4],m[8],m[12],m[1],m[5],m[9],m[13],m[2],m[6],m[10],m[14],m[3],m[7],m[11],m[15]],content:{uri:u(this._resource)?this._resource.url:void 0},geometricError:a}};_c.prototype._loadSymbology=async function(){!u(this._symbologyData)&&u(this._layer._symbology)&&(this._symbologyData=await this._layer._symbology._getSymbology(this))};_c.prototype._createContentURL=async function(){let e={scene:0,scenes:[{nodes:[0]}],nodes:[{name:"singleNode"}],meshes:[],buffers:[],bufferViews:[],accessors:[],materials:[],textures:[],images:[],samplers:[],asset:{version:"2.0"}},t=[this._loadGeometryData()];if(this._dataProvider.legacyVersion16&&t.push(this._loadFeatureData()),await Promise.all(t),u(this._geometryData)&&this._geometryData.length>0){this._dataProvider._applySymbology&&await this._loadSymbology();let o=this._geometryData[0].resource.url,r=this._layer._data.store.defaultGeometrySchema,s=this._geometryData[0],a=await X5.decode(o,r,s,this._featureData[0],this._symbologyData);if(!u(a))return;e=s._generateGltf(a.meshData.nodesInScene,a.meshData.nodes,a.meshData.meshes,a.meshData.buffers,a.meshData.bufferViews,a.meshData.accessors,a.meshData.rootExtensions,a.meshData.extensionsUsed),this._geometryData[0]._customAttributes=a.meshData._customAttributes}let n=this._dataProvider._binarizeGltf(e),i=new Blob([n],{type:"application/binary"});return URL.createObjectURL(i)};async function hEt(e){let t=e._layer._filters,n=[];for(let i=0;i<t.length;i++){let o=e.loadField(t[i].name);n.push(o)}return await Promise.all(n),t}function mEt(e,t,n){if(!u(n.values)||n.values.length===0)return!1;let i=u(t)?t.values:[],o;e<i.length&&(o=i[e]);let r=!1;for(let s=0;s<n.values.length;s++)if(n.values[s]===o){r=!0;break}return r}async function GTe(e,t){let n=e._tile.content.batchTable;if(u(n)&&n.featuresLength>0){n.setAllShow(!0);let i=await hEt(e);if(i.length>0)for(let o=0;o<n.featuresLength;o++)for(let r=0;r<i.length;r++){let s=i[r];if(!mEt(o,e._fields[s.name],s)){n.setShow(o,!1);break}}}t.show=!0}_c.prototype._filterFeatures=function(){let e=[];for(let n=0;n<this._children.length;n++){let i=this._children[n]._filterFeatures();e.push(i)}let t=this._tile?.content?._model;if(u(this._geometryData)&&this._geometryData.length>0&&u(t)&&t.ready){t.show=!1;let n=GTe(this,t);e.push(n)}return Promise.all(e)};Od.prototype._hookedRequestContent=Od.prototype.requestContent;Od.prototype.requestContent=function(){if(!this.tileset._isI3STileSet)return this._hookedRequestContent();if(!this._isLoading){this._isLoading=!0;let e=this;return this._i3sNode._createContentURL().then(t=>{if(!u(t)){e._isLoading=!1;return}return e._contentResource=new De({url:t}),e._hookedRequestContent()}).then(t=>{let n=t?._model;return u(e._i3sNode._geometryData)&&e._i3sNode._geometryData.length>0&&u(n)&&(n.show=!1,n.readyEvent.addEventListener(()=>{GTe(e._i3sNode,n)})),e._isLoading=!1,t})}};function pEt(e,t,n,i,o,r){let s=n*(1-e)+i*e,a=o*(1-e)+r*e;return s*(1-t)+a*t}function Q5(e,t,n,i){let o=e+t*n;return i[o]}function _Et(e,t,n){let i=n.nativeExtent,o=(e-i.west)/(i.east-i.west)*(n.width-1),r=(t-i.south)/(i.north-i.south)*(n.height-1),s=Math.floor(o),a=Math.floor(r);o-=s,r-=a;let c=s<n.width?s+1:s,l=a<n.height?a+1:a;a=n.height-1-a,l=n.height-1-l;let f=Q5(s,a,n.width,n.buffer),d=Q5(c,a,n.width,n.buffer),p=Q5(s,l,n.width,n.buffer),g=Q5(c,l,n.width,n.buffer),m=pEt(o,r,f,d,p,g);return m=m*n.scale+n.offset,m}Object.defineProperties(Od.prototype,{i3sNode:{get:function(){return this._i3sNode}}});var RI=_c;function J5(e){this._layer=e,this._defaultSymbology=void 0,this._valueFields=[],this._uniqueValueHash=void 0,this._classBreaksHash=void 0,this._parseLayerSymbology()}Object.defineProperties(J5.prototype,{defaultSymbology:{get:function(){return this._defaultSymbology}}});function KZ(e,t){let n=[];for(let i=0;i<e.length;i++){let o=G.byteToFloat(e[i]);i<3?n.push(BE(o)):n.push(o)}return n.length===3&&(u(t)?n.push(1-t/100):n.push(1)),n}function CS(e,t){let n={edges:void 0,material:void 0};if(u(e)&&u(e.symbolLayers))for(let i=0;i<e.symbolLayers.length;i++){let o=e.symbolLayers[i];if(o.type==="Fill"){let r=o.edges,s=o.outline;if(u(r)?(n.edges={},u(r.color)&&(n.edges.color=KZ(r.color,r.transparency))):u(s)&&(n.edges={},u(s.color)&&(n.edges.color=KZ(s.color,s.transparency))),!t){let a=o.material;u(a)&&(n.material={colorMixMode:a.colorMixMode},u(a.color)&&(n.material.color=KZ(a.color,a.transparency)))}break}}return n}function gEt(e,t){if(u(e.uniqueValueGroups)){let n={};for(let i=0;i<e.uniqueValueGroups.length;i++){let o=e.uniqueValueGroups[i].classes;if(u(o))for(let r=0;r<o.length;r++){let s=CS(o[r].symbol,t),a=o[r].values;for(let c=0;c<a.length;c++){let l=a[c],f=n;for(let d=0;d<l.length;d++){let p=l[d];d===l.length-1?f[p]=s:(u(f[p])||(f[p]={}),f=f[p])}}}}return n}if(u(e.uniqueValueInfos)){let n={};for(let i=0;i<e.uniqueValueInfos.length;i++){let o=e.uniqueValueInfos[i];n[o.value]=CS(o.symbol,t)}return n}}function yEt(e,t){if(u(e.classBreakInfos)){let n=[...e.classBreakInfos];n.sort(function(o,r){let s=x(o.classMaxValue,o.classMinValue),a=x(r.classMaxValue,r.classMinValue);return s-a});let i={ranges:[],symbols:[]};u(e.minValue)&&(i.ranges.push(e.minValue),i.symbols.push(void 0));for(let o=0;o<n.length;o++){let r=n[o];u(r.classMinValue)&&(i.ranges.length===0||r.classMinValue>i.ranges[i.ranges.length-1])&&(i.ranges.push(r.classMinValue),i.symbols.push(void 0)),u(r.classMaxValue)&&(i.ranges.length===0||r.classMaxValue>i.ranges[i.ranges.length-1])&&(i.ranges.push(r.classMaxValue),i.symbols.push(CS(r.symbol,t)))}return i.symbols.push(void 0),i}}J5.prototype._parseLayerSymbology=function(){let e=this._layer.data.drawingInfo;if(u(e)&&u(e.renderer)){let t=this._layer.data.cachedDrawingInfo,n=u(t)&&t.color===!0,i=e.renderer;i.type==="simple"?this._defaultSymbology=CS(i.symbol,n):i.type==="uniqueValue"?(this._defaultSymbology=CS(i.defaultSymbol,n),this._valueFields.push(i.field1),u(i.field2)&&this._valueFields.push(i.field2),u(i.field3)&&this._valueFields.push(i.field3),this._uniqueValueHash=gEt(i,n)):i.type==="classBreaks"&&(this._defaultSymbology=CS(i.defaultSymbol,n),this._valueFields.push(i.field),this._classBreaksHash=yEt(i,n))}};function WTe(e,t,n,i){let o=t[n];if(i<o.length){let r=o[i],s=e[r];return u(s)&&++n<t.length?WTe(s,t,n,i):s}}function xEt(e,t){let n=0,i=e.length;if(n<i)do{let o=n+i>>>1;e[o]<t?n=o+1:i=o}while(n<i);return n}function bEt(e,t,n){let i=t[n],o=xEt(e.ranges,i);return e.symbols[o]}J5.prototype._getSymbology=async function(e){let t={default:this._defaultSymbology};if(this._valueFields.length>0){let n=[];for(let r=0;r<this._valueFields.length;r++)n.push(e.loadField(this._valueFields[r]));await Promise.all(n);let i=[];for(let r=0;r<this._valueFields.length;r++)i.push(e.fields[this._valueFields[r]].values);let o;if(u(this._uniqueValueHash)?o=r=>WTe(this._uniqueValueHash,i,0,r):u(this._classBreaksHash)&&(o=r=>bEt(this._classBreaksHash,i[0],r)),u(o)){let r=i[0];for(let s=0;s<r.length;s++){let a=o(s);u(a)&&(t[s]=a)}}}return t};var eH=J5;function Hl(e,t,n){this._dataProvider=e,this._parent=n,!u(t.href)&&u(t.id)&&(t.href=`layers/${t.id}`);let i=this._parent.resource.getUrlComponent(),o="";i.match(/layers\/\d/)?o=`${i}`.replace(/\/+$/,""):o=`${i}`.replace(/\/?$/,"/").concat(`${t.href}`),this._version=t.store.version;let r=this._version.split(".");this._majorVersion=parseInt(r[0]),this._minorVersion=r.length>1?parseInt(r[1]):0,this._resource=new De({url:o}),this._resource.setQueryParameters(this._dataProvider.resource.queryParameters),this._resource.appendForwardSlash(),this._data=t,this._rootNode=void 0,this._nodePages={},this._nodePageFetches={},this._extent=void 0,this._tileset=void 0,this._geometryDefinitions=void 0,this._filters=[],this._symbology=void 0,this._computeGeometryDefinitions(!0),this._computeExtent()}Object.defineProperties(Hl.prototype,{resource:{get:function(){return this._resource}},rootNode:{get:function(){return this._rootNode}},tileset:{get:function(){return this._tileset}},data:{get:function(){return this._data}},version:{get:function(){return this._version}},majorVersion:{get:function(){return this._majorVersion}},minorVersion:{get:function(){return this._minorVersion}},legacyVersion16:{get:function(){if(u(this.version))return this.majorVersion<1||this.majorVersion===1&&this.minorVersion<=6}}});Hl.prototype.load=async function(e){if(this._data.spatialReference.wkid!==4326)throw new ce(`Unsupported spatial reference: ${this._data.spatialReference.wkid}`);if(this._dataProvider.applySymbology&&(this._symbology=new eH(this)),await this._dataProvider.loadGeoidData(),await this._loadRootNode(e),await this._create3DTileset(e),this._rootNode._tile=this._tileset._root,this._tileset._root._i3sNode=this._rootNode,this.legacyVersion16)return this._rootNode._loadChildren()};Hl.prototype._computeGeometryDefinitions=function(e){if(this._geometryDefinitions=[],u(this._data.geometryDefinitions))for(let t=0;t<this._data.geometryDefinitions.length;t++){let n=[],i=this._data.geometryDefinitions[t].geometryBuffers;for(let o=0;o<i.length;o++){let r=i[o],s=[],a=!1;if(u(r.compressedAttributes)&&e){a=!0;let c=r.compressedAttributes.attributes;for(let l=0;l<c.length;l++)s.push(c[l])}else for(let c in r)c!=="offset"&&s.push(c);n.push({compressed:a,attributes:s,index:i.indexOf(r)})}n.sort(function(o,r){return o.compressed&&!r.compressed?-1:!o.compressed&&r.compressed?1:o.attributes.length-r.attributes.length}),this._geometryDefinitions.push(n)}};Hl.prototype._findBestGeometryBuffers=function(e,t){let n=this._geometryDefinitions[e];if(u(n)){for(let i=0;i<n.length;++i){let o=n[i],r=!1,s=o.attributes;for(let a=0;a<t.length;a++)if(!s.includes(t[a])){r=!0;break}if(!r)return{bufferIndex:o.index,definition:n,geometryBufferInfo:o}}if(u(n[0]))return{bufferIndex:0,definition:n,geometryBufferInfo:n[0]}}};Hl.prototype._loadRootNode=function(e){if(u(this._data.nodePages)){let t=0;u(this._data.nodePages.rootIndex)&&(t=this._data.nodePages.rootIndex),this._rootNode=new RI(this,t,!0)}else this._rootNode=new RI(this,this._data.store.rootNode,!0);return this._rootNode.load(e)};Hl.prototype._getNodeInNodePages=function(e){let t=Math.floor(e/this._data.nodePages.nodesPerPage),n=e%this._data.nodePages.nodesPerPage;return this._loadNodePage(t).then(function(i){return i.nodes[n]})};Hl._fetchJson=function(e){return e.fetchJson()};Hl.prototype._loadNodePage=function(e){let t=this;if(!u(this._nodePageFetches[e])){let n=this.resource.getDerivedResource({url:`nodepages/${e}/`}),i=Hl._fetchJson(n).then(function(o){return u(o.error)&&o.error.code!==200?Promise.reject(o.error):(t._nodePages[e]=o.nodes,o)});this._nodePageFetches[e]=i}return this._nodePageFetches[e]};Hl.prototype._computeExtent=function(){u(this._data.fullExtent)?this._extent=se.fromDegrees(this._data.fullExtent.xmin,this._data.fullExtent.ymin,this._data.fullExtent.xmax,this._data.fullExtent.ymax):u(this._data.store.extent)&&(this._extent=se.fromDegrees(this._data.store.extent[0],this._data.store.extent[1],this._data.store.extent[2],this._data.store.extent[3]))};Hl.prototype._create3DTileset=async function(e){let t={asset:{version:"1.0"},geometricError:Number.MAX_VALUE,root:this._rootNode._create3DTileDefinition()},n=new Blob([JSON.stringify(t)],{type:"application/json"}),i=URL.createObjectURL(n),o=this._symbology?.defaultSymbology?.edges?.color;u(o)&&!u(e?.outlineColor)&&(e=u(e)?Ge(e):{},e.outlineColor=G.fromCartesian4(oe.fromArray(o))),this._tileset=await Ia.fromUrl(i,e),this._tileset.show=this._parent.show,this._tileset._isI3STileSet=!0,this._tileset.tileUnload.addEventListener(function(r){r._i3sNode._clearGeometryData(),URL.revokeObjectURL(r._contentResource._url),r._contentResource=r._i3sNode.resource}),this._tileset.tileVisible.addEventListener(function(r){u(r._i3sNode)&&r._i3sNode._loadChildren()})};Hl.prototype._updateVisibility=function(){u(this._tileset)&&(this._tileset.show=this._parent.show)};Hl.prototype.filterByAttributes=function(e){this._filters=u(e)?Ge(e,!0):[];let t=this._rootNode;return u(t)?t._filterFeatures():Promise.resolve()};var AS=Hl;function tH(e,t){this._dataProvider=e,this._resource=new De({url:t}),this._resource.setQueryParameters(e.resource.queryParameters),this._resource.appendForwardSlash()}Object.defineProperties(tH.prototype,{resource:{get:function(){return this._resource}},data:{get:function(){return this._data}},names:{get:function(){let e=[],t=this._data.summary;if(u(t))for(let n=0;n<t.length;++n)e.push(t[n].fieldName);return e}}});tH.prototype.load=async function(){return this._data=await jm.loadJson(this._resource),this._data};tH.prototype._getValues=function(e){let t=this._data.summary;if(u(t))for(let n=0;n<t.length;++n){let i=t[n];if(i.fieldName===e)return u(i.mostFrequentValues)?[...i.mostFrequentValues]:[]}};var nH=tH;function OI(e,t,n){this._dataProvider=e,this._parent=t,this._data=n,this._name=n.name,this._modelName=n.modelName,this._visibility=x(n.visibility,!0),this._resource=void 0,this._sublayers=[],this._i3sLayers=[]}Object.defineProperties(OI.prototype,{resource:{get:function(){return this._resource}},data:{get:function(){return this._data}},name:{get:function(){return this._name}},modelName:{get:function(){return this._modelName}},sublayers:{get:function(){return this._sublayers}},visibility:{get:function(){return this._visibility},set:function(e){if(this._visibility!==e){this._visibility=e;for(let t=0;t<this._i3sLayers.length;t++)this._i3sLayers[t]._updateVisibility()}}},show:{get:function(){return this._visibility&&this._parent.show}}});OI._fromData=async function(e,t,n,i){let o=new OI(e,i,n);if(o._data.layerType==="group"){let r=o._data.sublayers;if(u(r)){let s=[];for(let c=0;c<r.length;c++){let l=OI._fromData(e,t,r[c],o);s.push(l)}let a=await Promise.all(s);for(let c=0;c<a.length;c++){let l=a[c];o._sublayers.push(l),o._i3sLayers.push(...l._i3sLayers)}}}else if(o._data.layerType==="3DObject"){let r=t.concat(`/sublayers/${o._data.id}`),s=new De({url:r});s.setQueryParameters(e.resource.queryParameters),s.appendForwardSlash(),o._resource=s;let a=await jm.loadJson(o._resource),c=new AS(e,a,o);o._i3sLayers.push(c)}else console.log(`${o._data.layerType} layer ${o._data.name} is skipped as not supported.`);return o};var iH=OI;var YTe=Dr(jTe(),1);function ms(e){e=x(e,x.EMPTY_OBJECT),this._name=e.name,this._show=x(e.show,!0),this._geoidTiledTerrainProvider=e.geoidTiledTerrainProvider,this._showFeatures=x(e.showFeatures,!1),this._adjustMaterialAlphaMode=x(e.adjustMaterialAlphaMode,!1),this._applySymbology=x(e.applySymbology,!1),this._calculateNormals=x(e.calculateNormals,!1),this._cesium3dTilesetOptions=x(e.cesium3dTilesetOptions,x.EMPTY_OBJECT),this._layers=[],this._sublayers=[],this._data=void 0,this._extent=void 0,this._geoidDataPromise=void 0,this._geoidDataList=void 0,this._decoderTaskProcessor=void 0,this._taskProcessorReadyPromise=void 0,this._attributeStatistics=[],this._layersExtent=[]}Object.defineProperties(ms.prototype,{name:{get:function(){return this._name}},show:{get:function(){return this._show},set:function(e){if(this._show!==e){this._show=e;for(let t=0;t<this._layers.length;t++)this._layers[t]._updateVisibility()}}},geoidTiledTerrainProvider:{get:function(){return this._geoidTiledTerrainProvider}},layers:{get:function(){return this._layers}},sublayers:{get:function(){return this._sublayers}},data:{get:function(){return this._data}},extent:{get:function(){return this._extent}},resource:{get:function(){return this._resource}},showFeatures:{get:function(){return this._showFeatures}},adjustMaterialAlphaMode:{get:function(){return this._adjustMaterialAlphaMode}},applySymbology:{get:function(){return this._applySymbology}},calculateNormals:{get:function(){return this._calculateNormals}}});ms.prototype.destroy=function(){for(let e=0;e<this._layers.length;e++)u(this._layers[e]._tileset)&&this._layers[e]._tileset.destroy();return ue(this)};ms.prototype.isDestroyed=function(){return!1};ms.prototype.update=function(e){for(let t=0;t<this._layers.length;t++)u(this._layers[t]._tileset)&&this._layers[t]._tileset.update(e)};ms.prototype.prePassesUpdate=function(e){for(let t=0;t<this._layers.length;t++)u(this._layers[t]._tileset)&&this._layers[t]._tileset.prePassesUpdate(e)};ms.prototype.postPassesUpdate=function(e){for(let t=0;t<this._layers.length;t++)u(this._layers[t]._tileset)&&this._layers[t]._tileset.postPassesUpdate(e)};ms.prototype.updateForPass=function(e,t){for(let n=0;n<this._layers.length;n++)u(this._layers[n]._tileset)&&this._layers[n]._tileset.updateForPass(e,t)};function CEt(e,t){let n=e.resource.getUrlComponent(),i="";return n.match(/layers\/\d/)?i=`${n}`.replace(/\/+$/,""):i=`${n}`.replace(/\/?$/,"/").concat(`layers/${t}`),i}async function qTe(e,t,n){if(t.layerType==="Building"){u(n.showFeatures)||(e._showFeatures=!0),u(n.adjustMaterialAlphaMode)||(e._adjustMaterialAlphaMode=!0),u(n.applySymbology)||(e._applySymbology=!0),u(n.calculateNormals)||(e._calculateNormals=!0);let i=CEt(e,t.id);if(u(t.sublayers)){let o=[];for(let s=0;s<t.sublayers.length;s++){let a=iH._fromData(e,i,t.sublayers[s],e);o.push(a)}let r=await Promise.all(o);for(let s=0;s<r.length;s++){let a=r[s];e._sublayers.push(a),e._layers.push(...a._i3sLayers)}}if(u(t.statisticsHRef)){let o=i.concat(`/${t.statisticsHRef}`),r=new nH(e,o);await r.load(),e._attributeStatistics.push(r)}if(u(t.fullExtent)){let o=se.fromDegrees(t.fullExtent.xmin,t.fullExtent.ymin,t.fullExtent.xmax,t.fullExtent.ymax);e._layersExtent.push(o)}}else if(t.layerType==="3DObject"||t.layerType==="IntegratedMesh"){!u(n.calculateNormals)&&!u(t.textureSetDefinitions)&&(e._calculateNormals=!0);let i=new AS(e,t,e);e._layers.push(i),u(i._extent)&&e._layersExtent.push(i._extent)}else console.log(`${t.layerType} layer ${t.name} is skipped as not supported.`)}ms.fromUrl=async function(e,t){t=x(t,x.EMPTY_OBJECT);let n=De.createIfNeeded(e);n.setQueryParameters({f:"pjson"},!0);let i=await ms.loadJson(n),o=new ms(t);if(o._resource=n,o._data=i,u(i.layers)){let s=[];for(let a=0;a<i.layers.length;a++){let c=qTe(o,i.layers[a],t);s.push(c)}await Promise.all(s)}else await qTe(o,i,t);o._computeExtent();let r=[];for(let s=0;s<o._layers.length;s++)r.push(o._layers[s].load(t.cesium3dTilesetOptions));return await Promise.all(r),o};ms._fetchJson=function(e){return e.fetchJson()};ms.loadJson=async function(e){let t=await ms._fetchJson(e);if(u(t.error)){if(console.error("Failed to fetch I3S ",e.url),u(t.error.message)&&console.error(t.error.message),u(t.error.details))for(let n=0;n<t.error.details.length;n++)console.log(t.error.details[n]);throw new ce(t.error)}return t};ms.prototype._loadBinary=async function(e){let t=await e.fetchArrayBuffer();if(t.byteLength>0&&new Uint8Array(t)[0]===123&&new TextDecoder().decode(t).includes("404"))throw new ce(`Failed to load binary: ${e.url}`);return t};ms.prototype._binarizeGltf=function(e){let n=new TextEncoder().encode(JSON.stringify(e)),i=new Uint8Array(n.byteLength+20),o={magic:new Uint8Array(i.buffer,0,4),version:new Uint32Array(i.buffer,4,1),length:new Uint32Array(i.buffer,8,1),chunkLength:new Uint32Array(i.buffer,12,1),chunkType:new Uint32Array(i.buffer,16,1),chunkData:new Uint8Array(i.buffer,20,n.byteLength)};return o.magic[0]=103,o.magic[1]=108,o.magic[2]=84,o.magic[3]=70,o.version[0]=2,o.length[0]=i.byteLength,o.chunkLength[0]=n.byteLength,o.chunkType[0]=1313821514,o.chunkData.set(n),i};var AEt=new H;function TEt(e,t){let n=e.tilingScheme,i=[],o={},r=e._lodCount,s=de.fromRadians(t.west,t.north),a=de.fromRadians(t.east,t.south),c=n.positionToTileXY(s,r),l=n.positionToTileXY(a,r);for(let d=c.x;d<=l.x;d++)for(let p=c.y;p<=l.y;p++){let g=H.fromElements(d,p,AEt),m=g.toString();if(!o.hasOwnProperty(m)){let y={x:g.x,y:g.y,level:r,tilingScheme:n,terrainProvider:e,positions:[]};o[m]=y,i.push(y)}}let f=[];for(let d=0;d<i.length;++d){let p=i[d],g=p.terrainProvider.requestTileGeometry(p.x,p.y,p.level);f.push(g)}return Promise.all(f).then(function(d){let p=[];for(let g=0;g<d.length;g++){let m={tilingScheme:n,x:i[g].x,y:i[g].y,level:i[g].level},y=d[g],b="Geographic";n._projection instanceof Li&&(b="WebMercator");let C={projectionType:b,projection:n._projection,nativeExtent:n.tileXYToNativeRectangle(m.x,m.y,m.level),height:y._height,width:y._width,scale:y._structure.heightScale,offset:y._structure.heightOffset};if(y._encoding===eh.LERC){let A=YTe.default.decode(y._buffer);C.buffer=A.pixels[0]}else C.buffer=y._buffer;p.push(C)}return p})}async function EEt(e){let t=e._geoidTiledTerrainProvider;if(u(t))try{let n=await TEt(t,e._extent);e._geoidDataList=n}catch{console.log("Error retrieving Geoid Terrain tiles - no geoid conversion will be performed.")}}ms.prototype.loadGeoidData=async function(){return u(this._geoidDataPromise)?this._geoidDataPromise:(this._geoidDataPromise=EEt(this),this._geoidDataPromise)};ms.prototype._computeExtent=function(){let e;for(let t=0;t<this._layersExtent.length;t++){let n=this._layersExtent[t];u(e)?se.union(e,n,e):e=se.clone(n)}this._extent=e};ms.prototype.getAttributeNames=function(){let e=[];for(let t=0;t<this._attributeStatistics.length;++t)e.push(...this._attributeStatistics[t].names);return e};ms.prototype.getAttributeValues=function(e){for(let t=0;t<this._attributeStatistics.length;++t){let n=this._attributeStatistics[t]._getValues(e);if(u(n))return n}return[]};ms.prototype.filterByAttributes=function(e){let t=[];for(let n=0;n<this._layers.length;n++){let i=this._layers[n].filterByAttributes(e);t.push(i)}return Promise.all(t)};var jm=ms;function XTe(){}Object.defineProperties(XTe.prototype,{color:{get:he.throwInstantiationError},intensity:{get:he.throwInstantiationError}});var KTe=XTe;var SEt=/\/$/,ZTe=new wt('&copy; <a href="https://www.mapbox.com/about/maps/">Mapbox</a> &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/">Improve this map</a></strong>');function TS(e){e=x(e,x.EMPTY_OBJECT);let t=e.styleId,n=e.accessToken;this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0;let i=De.createIfNeeded(x(e.url,"https://api.mapbox.com/styles/v1/"));this._styleId=t,this._accessToken=n;let o=x(e.tilesize,512);this._tilesize=o;let r=x(e.username,"mapbox");this._username=r;let s=u(e.scaleFactor)?"@2x":"",a=i.getUrlComponent();SEt.test(a)||(a+="/"),a+=`${this._username}/${t}/tiles/${this._tilesize}/{z}/{x}/{y}${s}`,i.url=a,i.setQueryParameters({access_token:n});let c;u(e.credit)?(c=e.credit,typeof c=="string"&&(c=new wt(c))):c=ZTe,this._resource=i,this._imageryProvider=new fc({url:i,credit:c,ellipsoid:e.ellipsoid,minimumLevel:e.minimumLevel,maximumLevel:e.maximumLevel,rectangle:e.rectangle})}Object.defineProperties(TS.prototype,{url:{get:function(){return this._imageryProvider.url}},rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._imageryProvider.errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},proxy:{get:function(){return this._imageryProvider.proxy}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel}}});TS.prototype.getTileCredits=function(e,t,n){};TS.prototype.requestImage=function(e,t,n,i){return this._imageryProvider.requestImage(e,t,n,i)};TS.prototype.pickFeatures=function(e,t,n,i,o){return this._imageryProvider.pickFeatures(e,t,n,i,o)};TS._defaultCredit=ZTe;var $Te=TS;function ZZ(e){}ZZ.prototype.isReady=function(){return!0};ZZ.prototype.shouldDiscardImage=function(e){return!1};var QTe=ZZ;var vEt=new wt("MapQuest, Open Street Map and contributors, CC-BY-SA");function rH(e){e=x(e,x.EMPTY_OBJECT);let t=De.createIfNeeded(x(e.url,"https://tile.openstreetmap.org/"));t.appendForwardSlash(),t.url+=`{z}/{x}/{y}${e.retinaTiles?"@2x":""}.${x(e.fileExtension,"png")}`;let n=new hs({ellipsoid:e.ellipsoid}),i=256,o=256,r=x(e.minimumLevel,0),s=e.maximumLevel,a=x(e.rectangle,n.rectangle),c=n.positionToTileXY(se.southwest(a),r),l=n.positionToTileXY(se.northeast(a),r),f=(Math.abs(l.x-c.x)+1)*(Math.abs(l.y-c.y)+1),d=x(e.credit,vEt);typeof d=="string"&&(d=new wt(d)),fc.call(this,{url:t,credit:d,tilingScheme:n,tileWidth:i,tileHeight:o,minimumLevel:r,maximumLevel:s,rectangle:a})}u(Object.create)&&(rH.prototype=Object.create(fc.prototype),rH.prototype.constructor=rH);var my=rH;var wEt=new H(1,1);function $Z(e){e=x(e,x.EMPTY_OBJECT),this.mass=x(e.mass,1),this.position=h.clone(x(e.position,h.ZERO)),this.velocity=h.clone(x(e.velocity,h.ZERO)),this.life=x(e.life,Number.MAX_VALUE),this.image=e.image,this.startColor=G.clone(x(e.startColor,G.WHITE)),this.endColor=G.clone(x(e.endColor,G.WHITE)),this.startScale=x(e.startScale,1),this.endScale=x(e.endScale,1),this.imageSize=H.clone(x(e.imageSize,wEt)),this._age=0,this._normalizedAge=0,this._billboard=void 0}Object.defineProperties($Z.prototype,{age:{get:function(){return this._age}},normalizedAge:{get:function(){return this._normalizedAge}}});var JTe=new h;$Z.prototype.update=function(e,t){return h.multiplyByScalar(this.velocity,e,JTe),h.add(this.position,JTe,this.position),u(t)&&t(this,e),this._age+=e,this.life===Number.MAX_VALUE?this._normalizedAge=0:this._normalizedAge=this._age/this.life,this._age<=this.life};var MI=$Z;function eEe(e){e=x(e,x.EMPTY_OBJECT),this.time=x(e.time,0),this.minimum=x(e.minimum,0),this.maximum=x(e.maximum,50),this._complete=!1}Object.defineProperties(eEe.prototype,{complete:{get:function(){return this._complete}}});var tEe=eEe;function nEe(e){}nEe.prototype.emit=function(e){he.throwInstantiationError()};var iEe=nEe;var oEe=new H(1,1);function LI(e){e=x(e,x.EMPTY_OBJECT),this.show=x(e.show,!0),this.updateCallback=e.updateCallback,this.loop=x(e.loop,!0),this.image=x(e.image,void 0);let t=e.emitter;u(t)||(t=new U5(.5)),this._emitter=t,this._bursts=e.bursts,this._modelMatrix=F.clone(x(e.modelMatrix,F.IDENTITY)),this._emitterModelMatrix=F.clone(x(e.emitterModelMatrix,F.IDENTITY)),this._matrixDirty=!0,this._combinedMatrix=new F,this._startColor=G.clone(x(e.color,x(e.startColor,G.WHITE))),this._endColor=G.clone(x(e.color,x(e.endColor,G.WHITE))),this._startScale=x(e.scale,x(e.startScale,1)),this._endScale=x(e.scale,x(e.endScale,1)),this._emissionRate=x(e.emissionRate,5),this._minimumSpeed=x(e.speed,x(e.minimumSpeed,1)),this._maximumSpeed=x(e.speed,x(e.maximumSpeed,1)),this._minimumParticleLife=x(e.particleLife,x(e.minimumParticleLife,5)),this._maximumParticleLife=x(e.particleLife,x(e.maximumParticleLife,5)),this._minimumMass=x(e.mass,x(e.minimumMass,1)),this._maximumMass=x(e.mass,x(e.maximumMass,1)),this._minimumImageSize=H.clone(x(e.imageSize,x(e.minimumImageSize,oEe))),this._maximumImageSize=H.clone(x(e.imageSize,x(e.maximumImageSize,oEe))),this._sizeInMeters=x(e.sizeInMeters,!1),this._lifetime=x(e.lifetime,Number.MAX_VALUE),this._billboardCollection=void 0,this._particles=[],this._particlePool=[],this._previousTime=void 0,this._currentTime=0,this._carryOver=0,this._complete=new me,this._isComplete=!1,this._updateParticlePool=!0,this._particleEstimate=0}Object.defineProperties(LI.prototype,{emitter:{get:function(){return this._emitter},set:function(e){this._emitter=e}},bursts:{get:function(){return this._bursts},set:function(e){this._bursts=e,this._updateParticlePool=!0}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._matrixDirty=this._matrixDirty||!F.equals(this._modelMatrix,e),F.clone(e,this._modelMatrix)}},emitterModelMatrix:{get:function(){return this._emitterModelMatrix},set:function(e){this._matrixDirty=this._matrixDirty||!F.equals(this._emitterModelMatrix,e),F.clone(e,this._emitterModelMatrix)}},startColor:{get:function(){return this._startColor},set:function(e){G.clone(e,this._startColor)}},endColor:{get:function(){return this._endColor},set:function(e){G.clone(e,this._endColor)}},startScale:{get:function(){return this._startScale},set:function(e){this._startScale=e}},endScale:{get:function(){return this._endScale},set:function(e){this._endScale=e}},emissionRate:{get:function(){return this._emissionRate},set:function(e){this._emissionRate=e,this._updateParticlePool=!0}},minimumSpeed:{get:function(){return this._minimumSpeed},set:function(e){this._minimumSpeed=e}},maximumSpeed:{get:function(){return this._maximumSpeed},set:function(e){this._maximumSpeed=e}},minimumParticleLife:{get:function(){return this._minimumParticleLife},set:function(e){this._minimumParticleLife=e}},maximumParticleLife:{get:function(){return this._maximumParticleLife},set:function(e){this._maximumParticleLife=e,this._updateParticlePool=!0}},minimumMass:{get:function(){return this._minimumMass},set:function(e){this._minimumMass=e}},maximumMass:{get:function(){return this._maximumMass},set:function(e){this._maximumMass=e}},minimumImageSize:{get:function(){return this._minimumImageSize},set:function(e){this._minimumImageSize=e}},maximumImageSize:{get:function(){return this._maximumImageSize},set:function(e){this._maximumImageSize=e}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(e){this._sizeInMeters=e}},lifetime:{get:function(){return this._lifetime},set:function(e){this._lifetime=e}},complete:{get:function(){return this._complete}},isComplete:{get:function(){return this._isComplete}}});function DEt(e){let t=e._emissionRate,n=e._maximumParticleLife,i=0,o=e._bursts;if(u(o)){let d=o.length;for(let p=0;p<d;++p)i+=o[p].maximum}let r=e._billboardCollection,s=e.image,a=Math.ceil(t*n+i),c=e._particles,l=e._particlePool,f=Math.max(a-c.length-l.length,0);for(let d=0;d<f;++d){let p=new MI;p._billboard=r.add({image:s,show:!1}),l.push(p)}e._particleEstimate=a}function IEt(e){let t=e._particlePool.pop();return u(t)||(t=new MI),t}function PEt(e,t){e._particlePool.push(t)}function REt(e){let t=e._particles,n=e._particlePool,i=e._billboardCollection,o=t.length,r=n.length,s=e._particleEstimate,a=r-Math.max(s-o-r,0);for(let c=a;c<r;++c){let l=n[c];i.remove(l._billboard)}n.length=a}function OEt(e){u(e._billboard)&&(e._billboard.show=!1)}function rEe(e,t){let n=t._billboard;u(n)||(n=t._billboard=e._billboardCollection.add({image:t.image})),n.width=t.imageSize.x,n.height=t.imageSize.y,n.position=t.position,n.sizeInMeters=e.sizeInMeters,n.show=!0;let i=R.lerp(t.startColor.red,t.endColor.red,t.normalizedAge),o=R.lerp(t.startColor.green,t.endColor.green,t.normalizedAge),r=R.lerp(t.startColor.blue,t.endColor.blue,t.normalizedAge),s=R.lerp(t.startColor.alpha,t.endColor.alpha,t.normalizedAge);n.color=new G(i,o,r,s),n.scale=R.lerp(t.startScale,t.endScale,t.normalizedAge)}function MEt(e,t){t.startColor=G.clone(e._startColor,t.startColor),t.endColor=G.clone(e._endColor,t.endColor),t.startScale=e._startScale,t.endScale=e._endScale,t.image=e.image,t.life=R.randomBetween(e._minimumParticleLife,e._maximumParticleLife),t.mass=R.randomBetween(e._minimumMass,e._maximumMass),t.imageSize.x=R.randomBetween(e._minimumImageSize.x,e._maximumImageSize.x),t.imageSize.y=R.randomBetween(e._minimumImageSize.y,e._maximumImageSize.y),t._normalizedAge=0,t._age=0;let n=R.randomBetween(e._minimumSpeed,e._maximumSpeed);h.multiplyByScalar(t.velocity,n,t.velocity),e._particles.push(t)}function LEt(e,t){if(e._isComplete)return 0;t=R.mod(t,e._lifetime);let n=t*e._emissionRate,i=Math.floor(n);if(e._carryOver+=n-i,e._carryOver>1&&(i++,e._carryOver-=1),u(e.bursts)){let o=e.bursts.length;for(let r=0;r<o;r++){let s=e.bursts[r],a=e._currentTime;u(s)&&!s._complete&&a>s.time&&(i+=R.randomBetween(s.minimum,s.maximum),s._complete=!0)}}return i}var sH=new h;LI.prototype.update=function(e){if(!this.show)return;u(this._billboardCollection)||(this._billboardCollection=new Cf),this._updateParticlePool&&(DEt(this),this._updateParticlePool=!1);let t=0;this._previousTime&&(t=$.secondsDifference(e.time,this._previousTime)),t<0&&(t=0);let n=this._particles,i=this._emitter,o=this.updateCallback,r,s,a=n.length;for(r=0;r<a;++r)s=n[r],s.update(t,o)?rEe(this,s):(OEt(s),PEt(this,s),n[r]=n[a-1],--r,--a);n.length=a;let c=LEt(this,t);if(c>0&&u(i)){this._matrixDirty&&(this._combinedMatrix=F.multiply(this.modelMatrix,this.emitterModelMatrix,this._combinedMatrix),this._matrixDirty=!1);let l=this._combinedMatrix;for(r=0;r<c;r++)s=IEt(this),this._emitter.emit(s),h.add(s.position,s.velocity,sH),F.multiplyByPoint(l,sH,sH),s.position=F.multiplyByPoint(l,s.position,s.position),h.subtract(sH,s.position,s.velocity),h.normalize(s.velocity,s.velocity),MEt(this,s),rEe(this,s)}if(this._billboardCollection.update(e),this._previousTime=$.clone(e.time,this._previousTime),this._currentTime+=t,this._lifetime!==Number.MAX_VALUE&&this._currentTime>this._lifetime)if(this.loop){if(this._currentTime=R.mod(this._currentTime,this._lifetime),this.bursts){let l=this.bursts.length;for(r=0;r<l;r++)this.bursts[r]._complete=!1}}else this._isComplete=!0,this._complete.raiseEvent(this);e.frameNumber%120===0&&REt(this)};LI.prototype.isDestroyed=function(){return!1};LI.prototype.destroy=function(){return this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),ue(this)};var sEe=LI;function Vu(){he.throwInstantiationError()}Vu.computeDefaultLevelZeroMaximumGeometricError=function(e){return e.ellipsoid.maximumRadius*2*Math.PI*.25/(65*e.getNumberOfXTilesAtLevel(0))};Object.defineProperties(Vu.prototype,{quadtree:{get:he.throwInstantiationError,set:he.throwInstantiationError},tilingScheme:{get:he.throwInstantiationError},errorEvent:{get:he.throwInstantiationError}});Vu.prototype.update=he.throwInstantiationError;Vu.prototype.beginUpdate=he.throwInstantiationError;Vu.prototype.endUpdate=he.throwInstantiationError;Vu.prototype.getLevelMaximumGeometricError=he.throwInstantiationError;Vu.prototype.loadTile=he.throwInstantiationError;Vu.prototype.computeTileVisibility=he.throwInstantiationError;Vu.prototype.showTileThisFrame=he.throwInstantiationError;Vu.prototype.computeDistanceToTile=he.throwInstantiationError;Vu.prototype.isDestroyed=he.throwInstantiationError;Vu.prototype.destroy=he.throwInstantiationError;var aEe=Vu;function QZ(e){e=x(e,1),this._radius=x(e,1)}Object.defineProperties(QZ.prototype,{radius:{get:function(){return this._radius},set:function(e){this._radius=e}}});QZ.prototype.emit=function(e){let t=R.randomBetween(0,R.TWO_PI),n=R.randomBetween(0,R.PI),i=R.randomBetween(0,this._radius),o=i*Math.cos(t)*Math.sin(n),r=i*Math.sin(t)*Math.sin(n),s=i*Math.cos(n);e.position=h.fromElements(o,r,s,e.position),e.velocity=h.normalize(e.position,e.velocity)};var cEe=QZ;function NI(){}NI.prototype.evaluate=function(e,t){he.throwInstantiationError()};NI.prototype.evaluateColor=function(e,t){he.throwInstantiationError()};NI.prototype.getShaderFunction=function(e,t,n,i){he.throwInstantiationError()};NI.prototype.getVariables=function(){he.throwInstantiationError()};var lEe=NI;function ES(e){this._ready=!1,this._provider=void 0,this._errorEvent=new me,this._readyEvent=new me,FEt(this,e)}Object.defineProperties(ES.prototype,{errorEvent:{get:function(){return this._errorEvent}},readyEvent:{get:function(){return this._readyEvent}},ready:{get:function(){return this._ready}},provider:{get:function(){return this._provider}}});ES.fromWorldTerrain=function(e){return new ES(wE(e))};ES.fromWorldBathymetry=function(e){return new ES(HV(e))};function NEt(e,t){e.numberOfListeners>0?e.raiseEvent(t):console.error(t)}async function FEt(e,t){let n;try{n=await Promise.resolve(t),e._provider=n,e._ready=!0,e._readyEvent.raiseEvent(n)}catch(i){NEt(e._errorEvent,i)}}var aH=ES;function SS(){}SS.prototype.boundingVolume=void 0;SS.prototype.boundingSphere=void 0;SS.prototype.distanceToCamera=function(e){he.throwInstantiationError()};SS.prototype.intersectPlane=function(e){he.throwInstantiationError()};SS.prototype.createDebugVolume=function(e){he.throwInstantiationError()};var uEe=SS;function FI(e){e=x(e,x.EMPTY_OBJECT),this._tilingScheme=u(e.tilingScheme)?e.tilingScheme:new $i({ellipsoid:e.ellipsoid}),this._color=x(e.color,G.YELLOW),this._errorEvent=new me,this._tileWidth=x(e.tileWidth,256),this._tileHeight=x(e.tileHeight,256),this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0}Object.defineProperties(FI.prototype,{proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){}},minimumLevel:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){}},hasAlphaChannel:{get:function(){return!0}}});FI.prototype.getTileCredits=function(e,t,n){};FI.prototype.requestImage=function(e,t,n,i){let o=document.createElement("canvas");o.width=256,o.height=256;let r=o.getContext("2d"),s=this._color.toCssColorString();return r.strokeStyle=s,r.lineWidth=2,r.strokeRect(1,1,255,255),r.font="bold 25px Arial",r.textAlign="center",r.fillStyle=s,r.fillText(`L: ${n}`,124,86),r.fillText(`X: ${e}`,124,136),r.fillText(`Y: ${t}`,124,186),Promise.resolve(o)};FI.prototype.pickFeatures=function(e,t,n,i,o){};var cH=FI;function JZ(e){he.throwInstantiationError()}JZ.prototype.isReady=he.throwInstantiationError;JZ.prototype.shouldDiscardImage=he.throwInstantiationError;var fEe=JZ;var BEt={START:0,LOADING:1,READY:2,UPSAMPLED_ONLY:3},dEe=Object.freeze(BEt);function lH(e,t){this.show=!0,u(e)||(e=new qe),this.rectangle=qe.clone(e),u(t)||(t=Zi.fromType(Zi.ColorType,{color:new G(1,1,1,1)})),this.material=t,this._material=void 0,this._overlayCommand=void 0,this._rs=void 0}lH.prototype.update=function(e){if(!this.show)return;let t=this._rs;if((!u(t)||!qe.equals(t.viewport,this.rectangle))&&(this._rs=Ue.fromCache({blending:un.ALPHA_BLEND,viewport:this.rectangle})),e.passes.render){let i=e.context;if(this._material!==this.material||!u(this._overlayCommand)){this._material=this.material,u(this._overlayCommand)&&this._overlayCommand.shaderProgram.destroy();let o=new ze({sources:[this._material.shaderSource,L5]});this._overlayCommand=i.createViewportQuadCommand(o,{renderState:this._rs,uniformMap:this._material._uniforms,owner:this}),this._overlayCommand.pass=we.OVERLAY}this._material.update(i),this._overlayCommand.renderState=this._rs,this._overlayCommand.uniformMap=this._material._uniforms,e.commandList.push(this._overlayCommand)}};lH.prototype.isDestroyed=function(){return!1};lH.prototype.destroy=function(){return u(this._overlayCommand)&&(this._overlayCommand.shaderProgram=this._overlayCommand.shaderProgram&&this._overlayCommand.shaderProgram.destroy()),ue(this)};var hEe=lH;function e$(){he.throwInstantiationError()}Object.defineProperties(e$.prototype,{globalTransform:{get:he.throwInstantiationError},shapeTransform:{get:he.throwInstantiationError},shape:{get:he.throwInstantiationError},minBounds:{get:he.throwInstantiationError},maxBounds:{get:he.throwInstantiationError},dimensions:{get:he.throwInstantiationError},paddingBefore:{get:he.throwInstantiationError},paddingAfter:{get:he.throwInstantiationError},names:{get:he.throwInstantiationError},types:{get:he.throwInstantiationError},componentTypes:{get:he.throwInstantiationError},minimumValues:{get:he.throwInstantiationError},maximumValues:{get:he.throwInstantiationError},maximumTileCount:{get:he.throwInstantiationError},keyframeCount:{get:he.throwInstantiationError},timeIntervalCollection:{get:he.throwInstantiationError}});e$.prototype.requestData=he.throwInstantiationError;var mEe=e$;function Wb(){he.throwInstantiationError()}Object.defineProperties(Wb.prototype,{orientedBoundingBox:{get:he.throwInstantiationError},boundingSphere:{get:he.throwInstantiationError},boundTransform:{get:he.throwInstantiationError},shapeTransform:{get:he.throwInstantiationError},shaderUniforms:{get:he.throwInstantiationError},shaderDefines:{get:he.throwInstantiationError},shaderMaximumIntersectionsLength:{get:he.throwInstantiationError}});Wb.prototype.update=he.throwInstantiationError;Wb.prototype.computeOrientedBoundingBoxForTile=he.throwInstantiationError;Wb.prototype.computeOrientedBoundingBoxForSample=he.throwInstantiationError;Wb.DefaultMinBounds=he.throwInstantiationError;Wb.DefaultMaxBounds=he.throwInstantiationError;var pEe=Wb;var _Ee=`uniform sampler2D u_depthTexture;

in vec2 v_textureCoordinates;

void main()
{
    float z_window = czm_unpackDepth(texture(u_depthTexture, v_textureCoordinates));
    z_window = czm_reverseLogDepth(z_window);
    float n_range = czm_depthRange.near;
    float f_range = czm_depthRange.far;
    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);
    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);
    out_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);
}
`;function kEt(e){e=x(e,x.EMPTY_OBJECT),this.typedArray=e.typedArray,this.width=e.width,this.height=e.height,this.pixelFormat=x(e.pixelFormat,tt.RGBA),this.pixelDatatype=x(e.pixelDatatype,Ke.UNSIGNED_BYTE);let t=e.url;typeof t=="string"&&(t=De.createIfNeeded(t)),this.resource=t;let i=x(e.repeat,!0)?En.REPEAT:En.CLAMP_TO_EDGE;this.sampler=new Qt({wrapS:i,wrapT:i,minificationFilter:e.minificationFilter,magnificationFilter:e.magnificationFilter,maximumAnisotropy:e.maximumAnisotropy})}var gEe=kEt;var VEt={FLOAT:"float",VEC2:"vec2",VEC3:"vec3",VEC4:"vec4",MAT2:"mat2",MAT3:"mat2",MAT4:"mat4"},yEe=Object.freeze(VEt);var UEt={SIGX:"SIGX",SIGY:"SIGY",SIGZ:"SIGZ",VARX:"VARX",VARY:"VARY",VARZ:"VARZ",SIGR:"VARZ"},xEe=Object.freeze(UEt);function zEt(e){async function t({data:i}){let o=[],r={id:i.id,result:void 0,error:void 0};self.CESIUM_BASE_URL=i.baseUrl;try{let s=await e(i.parameters,o);r.result=s}catch(s){s instanceof Error?r.error={name:s.name,message:s.message,stack:s.stack}:r.error=s}i.canTransferArrayBuffer||(o.length=0);try{postMessage(r,o)}catch(s){r.result=void 0,r.error=`postMessage failed with error: ${f_(s)}
  with responseMessage: ${JSON.stringify(r)}`,postMessage(r)}}function n(i){postMessage({id:i.data?.id,error:`postMessage failed with error: ${JSON.stringify(i)}`})}return self.onmessage=t,self.onmessageerror=n,self}var bEe=zEt;globalThis.CESIUM_VERSION="1.123";var BI;typeof ko<"u"&&(BI=ko);(function(){/*!
 * Knockout JavaScript library v3.5.1
 * (c) The Knockout.js team - http://knockoutjs.com/
 * License: MIT (http://www.opensource.org/licenses/mit-license.php)
 */(function(){(function(e){var t=this||(0,eval)("this"),n=t.document,i=t.navigator,o=t.jQuery,r=t.JSON;o||typeof jQuery>"u"||(o=jQuery),function(s){s(t.ko={})}(function(s,a){function c(_,S){return _===null||typeof _ in y?_===S:!1}function l(_,S){var w;return function(){w||(w=m.a.setTimeout(function(){w=e,_()},S))}}function f(_,S){var w;return function(){clearTimeout(w),w=m.a.setTimeout(_,S)}}function d(_,S){S&&S!=="change"?S==="beforeChange"?this.pc(_):this.gb(_,S):this.qc(_)}function p(_,S){S!==null&&S.s&&S.s()}function g(_,S){var w=this.qd,I=w[E];I.ra||(this.Qb&&this.mb[S]?(w.uc(S,_,this.mb[S]),this.mb[S]=null,--this.Qb):I.I[S]||w.uc(S,_,I.J?{da:_}:w.$c(_)),_.Ja&&_.gd())}var m=typeof s<"u"?s:{};m.b=function(_,S){for(var w=_.split("."),I=m,N=0;N<w.length-1;N++)I=I[w[N]];I[w[w.length-1]]=S},m.L=function(_,S,w){_[S]=w},m.version="3.5.1",m.b("version",m.version),m.options={deferUpdates:!1,useOnlyNativeEvents:!1,foreachHidesDestroyed:!1},m.a=function(){function _(q,X){for(var Z in q)N.call(q,Z)&&X(Z,q[Z])}function S(q,X){if(X)for(var Z in X)N.call(X,Z)&&(q[Z]=X[Z]);return q}function w(q,X){return q.__proto__=X,q}function I(q,X,Z,fe){var xe=q[X].match(j)||[];m.a.D(Z.match(j),function(re){m.a.Na(xe,re,fe)}),q[X]=xe.join(" ")}var N=Object.prototype.hasOwnProperty,k={__proto__:[]}instanceof Array,z=typeof Symbol=="function",V={},U={};V[i&&/Firefox\/2/i.test(i.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],V.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),_(V,function(q,X){if(X.length)for(var Z=0,fe=X.length;Z<fe;Z++)U[X[Z]]=q});var B={propertychange:!0},W=n&&function(){for(var q=3,X=n.createElement("div"),Z=X.getElementsByTagName("i");X.innerHTML="<!--[if gt IE "+ ++q+"]><i></i><![endif]-->",Z[0];);return 4<q?q:e}(),j=/\S+/g,Q;return{Jc:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],D:function(q,X,Z){for(var fe=0,xe=q.length;fe<xe;fe++)X.call(Z,q[fe],fe,q)},A:typeof Array.prototype.indexOf=="function"?function(q,X){return Array.prototype.indexOf.call(q,X)}:function(q,X){for(var Z=0,fe=q.length;Z<fe;Z++)if(q[Z]===X)return Z;return-1},Lb:function(q,X,Z){for(var fe=0,xe=q.length;fe<xe;fe++)if(X.call(Z,q[fe],fe,q))return q[fe];return e},Pa:function(q,X){var Z=m.a.A(q,X);0<Z?q.splice(Z,1):Z===0&&q.shift()},wc:function(q){var X=[];return q&&m.a.D(q,function(Z){0>m.a.A(X,Z)&&X.push(Z)}),X},Mb:function(q,X,Z){var fe=[];if(q)for(var xe=0,re=q.length;xe<re;xe++)fe.push(X.call(Z,q[xe],xe));return fe},jb:function(q,X,Z){var fe=[];if(q)for(var xe=0,re=q.length;xe<re;xe++)X.call(Z,q[xe],xe)&&fe.push(q[xe]);return fe},Nb:function(q,X){if(X instanceof Array)q.push.apply(q,X);else for(var Z=0,fe=X.length;Z<fe;Z++)q.push(X[Z]);return q},Na:function(q,X,Z){var fe=m.a.A(m.a.bc(q),X);0>fe?Z&&q.push(X):Z||q.splice(fe,1)},Ba:k,extend:S,setPrototypeOf:w,Ab:k?w:S,P:_,Ga:function(q,X,Z){if(!q)return q;var fe={},xe;for(xe in q)N.call(q,xe)&&(fe[xe]=X.call(Z,q[xe],xe,q));return fe},Tb:function(q){for(;q.firstChild;)m.removeNode(q.firstChild)},Yb:function(q){q=m.a.la(q);for(var X=(q[0]&&q[0].ownerDocument||n).createElement("div"),Z=0,fe=q.length;Z<fe;Z++)X.appendChild(m.oa(q[Z]));return X},Ca:function(q,X){for(var Z=0,fe=q.length,xe=[];Z<fe;Z++){var re=q[Z].cloneNode(!0);xe.push(X?m.oa(re):re)}return xe},va:function(q,X){if(m.a.Tb(q),X)for(var Z=0,fe=X.length;Z<fe;Z++)q.appendChild(X[Z])},Xc:function(q,X){var Z=q.nodeType?[q]:q;if(0<Z.length){for(var fe=Z[0],xe=fe.parentNode,re=0,pe=X.length;re<pe;re++)xe.insertBefore(X[re],fe);for(re=0,pe=Z.length;re<pe;re++)m.removeNode(Z[re])}},Ua:function(q,X){if(q.length){for(X=X.nodeType===8&&X.parentNode||X;q.length&&q[0].parentNode!==X;)q.splice(0,1);for(;1<q.length&&q[q.length-1].parentNode!==X;)q.length--;if(1<q.length){var Z=q[0],fe=q[q.length-1];for(q.length=0;Z!==fe;)q.push(Z),Z=Z.nextSibling;q.push(fe)}}return q},Zc:function(q,X){7>W?q.setAttribute("selected",X):q.selected=X},Db:function(q){return q===null||q===e?"":q.trim?q.trim():q.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},Ud:function(q,X){return q=q||"",X.length>q.length?!1:q.substring(0,X.length)===X},vd:function(q,X){if(q===X)return!0;if(q.nodeType===11)return!1;if(X.contains)return X.contains(q.nodeType!==1?q.parentNode:q);if(X.compareDocumentPosition)return(X.compareDocumentPosition(q)&16)==16;for(;q&&q!=X;)q=q.parentNode;return!!q},Sb:function(q){return m.a.vd(q,q.ownerDocument.documentElement)},kd:function(q){return!!m.a.Lb(q,m.a.Sb)},R:function(q){return q&&q.tagName&&q.tagName.toLowerCase()},Ac:function(q){return m.onError?function(){try{return q.apply(this,arguments)}catch(X){throw m.onError&&m.onError(X),X}}:q},setTimeout:function(q,X){return setTimeout(m.a.Ac(q),X)},Gc:function(q){setTimeout(function(){throw m.onError&&m.onError(q),q},0)},B:function(q,X,Z){var fe=m.a.Ac(Z);if(Z=B[X],m.options.useOnlyNativeEvents||Z||!o)if(Z||typeof q.addEventListener!="function")if(typeof q.attachEvent<"u"){var xe=function(pe){fe.call(q,pe)},re="on"+X;q.attachEvent(re,xe),m.a.K.za(q,function(){q.detachEvent(re,xe)})}else throw Error("Browser doesn't support addEventListener or attachEvent");else q.addEventListener(X,fe,!1);else Q||(Q=typeof o(q).on=="function"?"on":"bind"),o(q)[Q](X,fe)},Fb:function(q,X){if(!q||!q.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var Z;if(m.a.R(q)==="input"&&q.type&&X.toLowerCase()=="click"?(Z=q.type,Z=Z=="checkbox"||Z=="radio"):Z=!1,m.options.useOnlyNativeEvents||!o||Z)if(typeof n.createEvent=="function")if(typeof q.dispatchEvent=="function")Z=n.createEvent(U[X]||"HTMLEvents"),Z.initEvent(X,!0,!0,t,0,0,0,0,0,!1,!1,!1,!1,0,q),q.dispatchEvent(Z);else throw Error("The supplied element doesn't support dispatchEvent");else if(Z&&q.click)q.click();else if(typeof q.fireEvent<"u")q.fireEvent("on"+X);else throw Error("Browser doesn't support triggering events");else o(q).trigger(X)},f:function(q){return m.O(q)?q():q},bc:function(q){return m.O(q)?q.v():q},Eb:function(q,X,Z){var fe;X&&(typeof q.classList=="object"?(fe=q.classList[Z?"add":"remove"],m.a.D(X.match(j),function(xe){fe.call(q.classList,xe)})):typeof q.className.baseVal=="string"?I(q.className,"baseVal",X,Z):I(q,"className",X,Z))},Bb:function(q,X){var Z=m.a.f(X);(Z===null||Z===e)&&(Z="");var fe=m.h.firstChild(q);!fe||fe.nodeType!=3||m.h.nextSibling(fe)?m.h.va(q,[q.ownerDocument.createTextNode(Z)]):fe.data=Z,m.a.Ad(q)},Yc:function(q,X){if(q.name=X,7>=W)try{var Z=q.name.replace(/[&<>'"]/g,function(fe){return"&#"+fe.charCodeAt(0)+";"});q.mergeAttributes(n.createElement("<input name='"+Z+"'/>"),!1)}catch{}},Ad:function(q){9<=W&&(q=q.nodeType==1?q:q.parentNode,q.style&&(q.style.zoom=q.style.zoom))},wd:function(q){if(W){var X=q.style.width;q.style.width=0,q.style.width=X}},Pd:function(q,X){q=m.a.f(q),X=m.a.f(X);for(var Z=[],fe=q;fe<=X;fe++)Z.push(fe);return Z},la:function(q){for(var X=[],Z=0,fe=q.length;Z<fe;Z++)X.push(q[Z]);return X},Da:function(q){return z?Symbol(q):q},Zd:W===6,$d:W===7,W,Lc:function(q,X){for(var Z=m.a.la(q.getElementsByTagName("input")).concat(m.a.la(q.getElementsByTagName("textarea"))),fe=typeof X=="string"?function(pe){return pe.name===X}:function(pe){return X.test(pe.name)},xe=[],re=Z.length-1;0<=re;re--)fe(Z[re])&&xe.push(Z[re]);return xe},Nd:function(q){return typeof q=="string"&&(q=m.a.Db(q))?r&&r.parse?r.parse(q):new Function("return "+q)():null},hc:function(q,X,Z){if(!r||!r.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return r.stringify(m.a.f(q),X,Z)},Od:function(q,X,Z){Z=Z||{};var fe=Z.params||{},xe=Z.includeFields||this.Jc,re=q;if(typeof q=="object"&&m.a.R(q)==="form")for(var re=q.action,pe=xe.length-1;0<=pe;pe--)for(var ye=m.a.Lc(q,xe[pe]),Se=ye.length-1;0<=Se;Se--)fe[ye[Se].name]=ye[Se].value;X=m.a.f(X);var Te=n.createElement("form");Te.style.display="none",Te.action=re,Te.method="post";for(var Fe in X)q=n.createElement("input"),q.type="hidden",q.name=Fe,q.value=m.a.hc(m.a.f(X[Fe])),Te.appendChild(q);_(fe,function(Ve,Ze){var gt=n.createElement("input");gt.type="hidden",gt.name=Ve,gt.value=Ze,Te.appendChild(gt)}),n.body.appendChild(Te),Z.submitter?Z.submitter(Te):Te.submit(),setTimeout(function(){Te.parentNode.removeChild(Te)},0)}}}(),m.b("utils",m.a),m.b("utils.arrayForEach",m.a.D),m.b("utils.arrayFirst",m.a.Lb),m.b("utils.arrayFilter",m.a.jb),m.b("utils.arrayGetDistinctValues",m.a.wc),m.b("utils.arrayIndexOf",m.a.A),m.b("utils.arrayMap",m.a.Mb),m.b("utils.arrayPushAll",m.a.Nb),m.b("utils.arrayRemoveItem",m.a.Pa),m.b("utils.cloneNodes",m.a.Ca),m.b("utils.createSymbolOrString",m.a.Da),m.b("utils.extend",m.a.extend),m.b("utils.fieldsIncludedWithJsonPost",m.a.Jc),m.b("utils.getFormFields",m.a.Lc),m.b("utils.objectMap",m.a.Ga),m.b("utils.peekObservable",m.a.bc),m.b("utils.postJson",m.a.Od),m.b("utils.parseJson",m.a.Nd),m.b("utils.registerEventHandler",m.a.B),m.b("utils.stringifyJson",m.a.hc),m.b("utils.range",m.a.Pd),m.b("utils.toggleDomNodeCssClass",m.a.Eb),m.b("utils.triggerEvent",m.a.Fb),m.b("utils.unwrapObservable",m.a.f),m.b("utils.objectForEach",m.a.P),m.b("utils.addOrRemoveItem",m.a.Na),m.b("utils.setTextContent",m.a.Bb),m.b("unwrap",m.a.f),Function.prototype.bind||(Function.prototype.bind=function(_){var S=this;if(arguments.length===1)return function(){return S.apply(_,arguments)};var w=Array.prototype.slice.call(arguments,1);return function(){var I=w.slice(0);return I.push.apply(I,arguments),S.apply(_,I)}}),m.a.g=new function(){var _=0,S="__ko__"+new Date().getTime(),w={},I,N;return m.a.W?(I=function(k,z){var V=k[S];if(!V||V==="null"||!w[V]){if(!z)return e;V=k[S]="ko"+_++,w[V]={}}return w[V]},N=function(k){var z=k[S];return z?(delete w[z],k[S]=null,!0):!1}):(I=function(k,z){var V=k[S];return!V&&z&&(V=k[S]={}),V},N=function(k){return k[S]?(delete k[S],!0):!1}),{get:function(k,z){var V=I(k,!1);return V&&V[z]},set:function(k,z,V){(k=I(k,V!==e))&&(k[z]=V)},Ub:function(k,z,V){return k=I(k,!0),k[z]||(k[z]=V)},clear:N,Z:function(){return _+++S}}},m.b("utils.domData",m.a.g),m.b("utils.domData.clear",m.a.g.clear),m.a.K=new function(){function _(z,V){var U=m.a.g.get(z,I);return U===e&&V&&(U=[],m.a.g.set(z,I,U)),U}function S(z){var V=_(z,!1);if(V)for(var V=V.slice(0),U=0;U<V.length;U++)V[U](z);m.a.g.clear(z),m.a.K.cleanExternalData(z),k[z.nodeType]&&w(z.childNodes,!0)}function w(z,V){for(var U=[],B,W=0;W<z.length;W++)if((!V||z[W].nodeType===8)&&(S(U[U.length]=B=z[W]),z[W]!==B))for(;W--&&m.a.A(U,z[W])==-1;);}var I=m.a.g.Z(),N={1:!0,8:!0,9:!0},k={1:!0,9:!0};return{za:function(z,V){if(typeof V!="function")throw Error("Callback must be a function");_(z,!0).push(V)},yb:function(z,V){var U=_(z,!1);U&&(m.a.Pa(U,V),U.length==0&&m.a.g.set(z,I,e))},oa:function(z){return m.u.G(function(){N[z.nodeType]&&(S(z),k[z.nodeType]&&w(z.getElementsByTagName("*")))}),z},removeNode:function(z){m.oa(z),z.parentNode&&z.parentNode.removeChild(z)},cleanExternalData:function(z){o&&typeof o.cleanData=="function"&&o.cleanData([z])}}},m.oa=m.a.K.oa,m.removeNode=m.a.K.removeNode,m.b("cleanNode",m.oa),m.b("removeNode",m.removeNode),m.b("utils.domNodeDisposal",m.a.K),m.b("utils.domNodeDisposal.addDisposeCallback",m.a.K.za),m.b("utils.domNodeDisposal.removeDisposeCallback",m.a.K.yb),function(){var _=[0,"",""],S=[1,"<table>","</table>"],w=[3,"<table><tbody><tr>","</tr></tbody></table>"],I=[1,"<select multiple='multiple'>","</select>"],N={thead:S,tbody:S,tfoot:S,tr:[2,"<table><tbody>","</tbody></table>"],td:w,th:w,option:I,optgroup:I},k=8>=m.a.W;m.a.ua=function(z,V){var U;if(o){if(o.parseHTML)U=o.parseHTML(z,V)||[];else if((U=o.clean([z],V))&&U[0]){for(var B=U[0];B.parentNode&&B.parentNode.nodeType!==11;)B=B.parentNode;B.parentNode&&B.parentNode.removeChild(B)}}else{(U=V)||(U=n);var B=U.parentWindow||U.defaultView||t,W=m.a.Db(z).toLowerCase(),j=U.createElement("div"),Q;for(Q=(W=W.match(/^(?:\x3c!--.*?--\x3e\s*?)*?<([a-z]+)[\s>]/))&&N[W[1]]||_,W=Q[0],Q="ignored<div>"+Q[1]+z+Q[2]+"</div>",typeof B.innerShiv=="function"?j.appendChild(B.innerShiv(Q)):(k&&U.body.appendChild(j),j.innerHTML=Q,k&&j.parentNode.removeChild(j));W--;)j=j.lastChild;U=m.a.la(j.lastChild.childNodes)}return U},m.a.Md=function(z,V){var U=m.a.ua(z,V);return U.length&&U[0].parentElement||m.a.Yb(U)},m.a.fc=function(z,V){if(m.a.Tb(z),V=m.a.f(V),V!==null&&V!==e)if(typeof V!="string"&&(V=V.toString()),o)o(z).html(V);else for(var U=m.a.ua(V,z.ownerDocument),B=0;B<U.length;B++)z.appendChild(U[B])}}(),m.b("utils.parseHtmlFragment",m.a.ua),m.b("utils.setHtml",m.a.fc),m.aa=function(){function _(w,I){if(w){if(w.nodeType==8){var N=m.aa.Uc(w.nodeValue);N!=null&&I.push({ud:w,Kd:N})}else if(w.nodeType==1)for(var N=0,k=w.childNodes,z=k.length;N<z;N++)_(k[N],I)}}var S={};return{Xb:function(w){if(typeof w!="function")throw Error("You can only pass a function to ko.memoization.memoize()");var I=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return S[I]=w,"<!--[ko_memo:"+I+"]-->"},bd:function(w,I){var N=S[w];if(N===e)throw Error("Couldn't find any memo with ID "+w+". Perhaps it's already been unmemoized.");try{return N.apply(null,I||[]),!0}finally{delete S[w]}},cd:function(w,I){var N=[];_(w,N);for(var k=0,z=N.length;k<z;k++){var V=N[k].ud,U=[V];I&&m.a.Nb(U,I),m.aa.bd(N[k].Kd,U),V.nodeValue="",V.parentNode&&V.parentNode.removeChild(V)}},Uc:function(w){return(w=w.match(/^\[ko_memo\:(.*?)\]$/))?w[1]:null}}}(),m.b("memoization",m.aa),m.b("memoization.memoize",m.aa.Xb),m.b("memoization.unmemoize",m.aa.bd),m.b("memoization.parseMemoText",m.aa.Uc),m.b("memoization.unmemoizeDomNodeAndDescendants",m.aa.cd),m.na=function(){function _(){if(N){for(var V=N,U=0,B;z<N;)if(B=I[z++]){if(z>V){if(5e3<=++U){z=N,m.a.Gc(Error("'Too much recursion' after processing "+U+" task groups."));break}V=N}try{B()}catch(W){m.a.Gc(W)}}}}function S(){_(),z=N=I.length=0}var w,I=[],N=0,k=1,z=0;return t.MutationObserver?w=function(V){var U=n.createElement("div");return new MutationObserver(V).observe(U,{attributes:!0}),function(){U.classList.toggle("foo")}}(S):w=n&&"onreadystatechange"in n.createElement("script")?function(V){var U=n.createElement("script");U.onreadystatechange=function(){U.onreadystatechange=null,n.documentElement.removeChild(U),U=null,V()},n.documentElement.appendChild(U)}:function(V){setTimeout(V,0)},{scheduler:w,zb:function(V){return N||m.na.scheduler(S),I[N++]=V,k++},cancel:function(V){V=V-(k-N),V>=z&&V<N&&(I[V]=null)},resetForTesting:function(){var V=N-z;return z=N=I.length=0,V},Sd:_}}(),m.b("tasks",m.na),m.b("tasks.schedule",m.na.zb),m.b("tasks.runEarly",m.na.Sd),m.Ta={throttle:function(_,S){_.throttleEvaluation=S;var w=null;return m.$({read:_,write:function(I){clearTimeout(w),w=m.a.setTimeout(function(){_(I)},S)}})},rateLimit:function(_,S){var w,I,N;typeof S=="number"?w=S:(w=S.timeout,I=S.method),_.Hb=!1,N=typeof I=="function"?I:I=="notifyWhenChangesStop"?f:l,_.ub(function(k){return N(k,w,S)})},deferred:function(_,S){if(S!==!0)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");_.Hb||(_.Hb=!0,_.ub(function(w){var I,N=!1;return function(){if(!N){m.na.cancel(I),I=m.na.zb(w);try{N=!0,_.notifySubscribers(e,"dirty")}finally{N=!1}}}}))},notify:function(_,S){_.equalityComparer=S=="always"?null:c}};var y={undefined:1,boolean:1,number:1,string:1};m.b("extenders",m.Ta),m.ic=function(_,S,w){this.da=_,this.lc=S,this.mc=w,this.Ib=!1,this.fb=this.Jb=null,m.L(this,"dispose",this.s),m.L(this,"disposeWhenNodeIsRemoved",this.l)},m.ic.prototype.s=function(){this.Ib||(this.fb&&m.a.K.yb(this.Jb,this.fb),this.Ib=!0,this.mc(),this.da=this.lc=this.mc=this.Jb=this.fb=null)},m.ic.prototype.l=function(_){this.Jb=_,m.a.K.za(_,this.fb=this.s.bind(this))},m.T=function(){m.a.Ab(this,b),b.qb(this)};var b={qb:function(_){_.U={change:[]},_.sc=1},subscribe:function(_,S,w){var I=this;w=w||"change";var N=new m.ic(I,S?_.bind(S):_,function(){m.a.Pa(I.U[w],N),I.hb&&I.hb(w)});return I.Qa&&I.Qa(w),I.U[w]||(I.U[w]=[]),I.U[w].push(N),N},notifySubscribers:function(_,S){if(S=S||"change",S==="change"&&this.Gb(),this.Wa(S)){var w=S==="change"&&this.ed||this.U[S].slice(0);try{m.u.xc();for(var I=0,N;N=w[I];++I)N.Ib||N.lc(_)}finally{m.u.end()}}},ob:function(){return this.sc},Dd:function(_){return this.ob()!==_},Gb:function(){++this.sc},ub:function(_){var S=this,w=m.O(S),I,N,k,z,V;S.gb||(S.gb=S.notifySubscribers,S.notifySubscribers=d);var U=_(function(){S.Ja=!1,w&&z===S&&(z=S.nc?S.nc():S());var B=N||V&&S.sb(k,z);V=N=I=!1,B&&S.gb(k=z)});S.qc=function(B,W){W&&S.Ja||(V=!W),S.ed=S.U.change.slice(0),S.Ja=I=!0,z=B,U()},S.pc=function(B){I||(k=B,S.gb(B,"beforeChange"))},S.rc=function(){V=!0},S.gd=function(){S.sb(k,S.v(!0))&&(N=!0)}},Wa:function(_){return this.U[_]&&this.U[_].length},Bd:function(_){if(_)return this.U[_]&&this.U[_].length||0;var S=0;return m.a.P(this.U,function(w,I){w!=="dirty"&&(S+=I.length)}),S},sb:function(_,S){return!this.equalityComparer||!this.equalityComparer(_,S)},toString:function(){return"[object Object]"},extend:function(_){var S=this;return _&&m.a.P(_,function(w,I){var N=m.Ta[w];typeof N=="function"&&(S=N(S,I)||S)}),S}};m.L(b,"init",b.qb),m.L(b,"subscribe",b.subscribe),m.L(b,"extend",b.extend),m.L(b,"getSubscriptionsCount",b.Bd),m.a.Ba&&m.a.setPrototypeOf(b,Function.prototype),m.T.fn=b,m.Qc=function(_){return _!=null&&typeof _.subscribe=="function"&&typeof _.notifySubscribers=="function"},m.b("subscribable",m.T),m.b("isSubscribable",m.Qc),m.S=m.u=function(){function _(k){w.push(I),I=k}function S(){I=w.pop()}var w=[],I,N=0;return{xc:_,end:S,cc:function(k){if(I){if(!m.Qc(k))throw Error("Only subscribable things can act as dependencies");I.od.call(I.pd,k,k.fd||(k.fd=++N))}},G:function(k,z,V){try{return _(),k.apply(z,V||[])}finally{S()}},qa:function(){if(I)return I.o.qa()},Va:function(){if(I)return I.o.Va()},Ya:function(){if(I)return I.Ya},o:function(){if(I)return I.o}}}(),m.b("computedContext",m.S),m.b("computedContext.getDependenciesCount",m.S.qa),m.b("computedContext.getDependencies",m.S.Va),m.b("computedContext.isInitial",m.S.Ya),m.b("computedContext.registerDependency",m.S.cc),m.b("ignoreDependencies",m.Yd=m.u.G);var C=m.a.Da("_latestValue");m.ta=function(_){function S(){return 0<arguments.length?(S.sb(S[C],arguments[0])&&(S.ya(),S[C]=arguments[0],S.xa()),this):(m.u.cc(S),S[C])}return S[C]=_,m.a.Ba||m.a.extend(S,m.T.fn),m.T.fn.qb(S),m.a.Ab(S,A),m.options.deferUpdates&&m.Ta.deferred(S,!0),S};var A={equalityComparer:c,v:function(){return this[C]},xa:function(){this.notifySubscribers(this[C],"spectate"),this.notifySubscribers(this[C])},ya:function(){this.notifySubscribers(this[C],"beforeChange")}};m.a.Ba&&m.a.setPrototypeOf(A,m.T.fn);var T=m.ta.Ma="__ko_proto__";A[T]=m.ta,m.O=function(_){if((_=typeof _=="function"&&_[T])&&_!==A[T]&&_!==m.o.fn[T])throw Error("Invalid object that looks like an observable; possibly from another Knockout instance");return!!_},m.Za=function(_){return typeof _=="function"&&(_[T]===A[T]||_[T]===m.o.fn[T]&&_.Nc)},m.b("observable",m.ta),m.b("isObservable",m.O),m.b("isWriteableObservable",m.Za),m.b("isWritableObservable",m.Za),m.b("observable.fn",A),m.L(A,"peek",A.v),m.L(A,"valueHasMutated",A.xa),m.L(A,"valueWillMutate",A.ya),m.Ha=function(_){if(_=_||[],typeof _!="object"||!("length"in _))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return _=m.ta(_),m.a.Ab(_,m.Ha.fn),_.extend({trackArrayChanges:!0})},m.Ha.fn={remove:function(_){for(var S=this.v(),w=[],I=typeof _!="function"||m.O(_)?function(z){return z===_}:_,N=0;N<S.length;N++){var k=S[N];if(I(k)){if(w.length===0&&this.ya(),S[N]!==k)throw Error("Array modified during remove; cannot remove item");w.push(k),S.splice(N,1),N--}}return w.length&&this.xa(),w},removeAll:function(_){if(_===e){var S=this.v(),w=S.slice(0);return this.ya(),S.splice(0,S.length),this.xa(),w}return _?this.remove(function(I){return 0<=m.a.A(_,I)}):[]},destroy:function(_){var S=this.v(),w=typeof _!="function"||m.O(_)?function(k){return k===_}:_;this.ya();for(var I=S.length-1;0<=I;I--){var N=S[I];w(N)&&(N._destroy=!0)}this.xa()},destroyAll:function(_){return _===e?this.destroy(function(){return!0}):_?this.destroy(function(S){return 0<=m.a.A(_,S)}):[]},indexOf:function(_){var S=this();return m.a.A(S,_)},replace:function(_,S){var w=this.indexOf(_);0<=w&&(this.ya(),this.v()[w]=S,this.xa())},sorted:function(_){var S=this().slice(0);return _?S.sort(_):S.sort()},reversed:function(){return this().slice(0).reverse()}},m.a.Ba&&m.a.setPrototypeOf(m.Ha.fn,m.ta.fn),m.a.D("pop push reverse shift sort splice unshift".split(" "),function(_){m.Ha.fn[_]=function(){var S=this.v();this.ya(),this.zc(S,_,arguments);var w=S[_].apply(S,arguments);return this.xa(),w===S?this:w}}),m.a.D(["slice"],function(_){m.Ha.fn[_]=function(){var S=this();return S[_].apply(S,arguments)}}),m.Pc=function(_){return m.O(_)&&typeof _.remove=="function"&&typeof _.push=="function"},m.b("observableArray",m.Ha),m.b("isObservableArray",m.Pc),m.Ta.trackArrayChanges=function(_,S){function w(){function j(){if(V){var Q=[].concat(_.v()||[]),q;_.Wa("arrayChange")&&((!N||1<V)&&(N=m.a.Pb(U,Q,_.Ob)),q=N),U=Q,N=null,V=0,q&&q.length&&_.notifySubscribers(q,"arrayChange")}}I?j():(I=!0,z=_.subscribe(function(){++V},null,"spectate"),U=[].concat(_.v()||[]),N=null,k=_.subscribe(j))}if(_.Ob={},S&&typeof S=="object"&&m.a.extend(_.Ob,S),_.Ob.sparse=!0,!_.zc){var I=!1,N=null,k,z,V=0,U,B=_.Qa,W=_.hb;_.Qa=function(j){B&&B.call(_,j),j==="arrayChange"&&w()},_.hb=function(j){W&&W.call(_,j),j!=="arrayChange"||_.Wa("arrayChange")||(k&&k.s(),z&&z.s(),z=k=null,I=!1,U=e)},_.zc=function(j,Q,q){function X(Te,Fe,Ve){return Z[Z.length]={status:Te,value:Fe,index:Ve}}if(I&&!V){var Z=[],fe=j.length,xe=q.length,re=0;switch(Q){case"push":re=fe;case"unshift":for(Q=0;Q<xe;Q++)X("added",q[Q],re+Q);break;case"pop":re=fe-1;case"shift":fe&&X("deleted",j[re],re);break;case"splice":Q=Math.min(Math.max(0,0>q[0]?fe+q[0]:q[0]),fe);for(var fe=xe===1?fe:Math.min(Q+(q[1]||0),fe),xe=Q+xe-2,re=Math.max(fe,xe),pe=[],ye=[],Se=2;Q<re;++Q,++Se)Q<fe&&ye.push(X("deleted",j[Q],Q)),Q<xe&&pe.push(X("added",q[Se],Q));m.a.Kc(ye,pe);break;default:return}N=Z}}}};var E=m.a.Da("_state");m.o=m.$=function(_,S,w){function I(){if(0<arguments.length){if(typeof N=="function")N.apply(k.nb,arguments);else throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return this}return k.ra||m.u.cc(I),(k.ka||k.J&&I.Xa())&&I.ha(),k.X}if(typeof _=="object"?w=_:(w=w||{},_&&(w.read=_)),typeof w.read!="function")throw Error("Pass a function that returns the value of the ko.computed");var N=w.write,k={X:e,sa:!0,ka:!0,rb:!1,jc:!1,ra:!1,wb:!1,J:!1,Wc:w.read,nb:S||w.owner,l:w.disposeWhenNodeIsRemoved||w.l||null,Sa:w.disposeWhen||w.Sa,Rb:null,I:{},V:0,Ic:null};return I[E]=k,I.Nc=typeof N=="function",m.a.Ba||m.a.extend(I,m.T.fn),m.T.fn.qb(I),m.a.Ab(I,v),w.pure?(k.wb=!0,k.J=!0,m.a.extend(I,D)):w.deferEvaluation&&m.a.extend(I,O),m.options.deferUpdates&&m.Ta.deferred(I,!0),k.l&&(k.jc=!0,k.l.nodeType||(k.l=null)),k.J||w.deferEvaluation||I.ha(),k.l&&I.ja()&&m.a.K.za(k.l,k.Rb=function(){I.s()}),I};var v={equalityComparer:c,qa:function(){return this[E].V},Va:function(){var _=[];return m.a.P(this[E].I,function(S,w){_[w.Ka]=w.da}),_},Vb:function(_){if(!this[E].V)return!1;var S=this.Va();return m.a.A(S,_)!==-1?!0:!!m.a.Lb(S,function(w){return w.Vb&&w.Vb(_)})},uc:function(_,S,w){if(this[E].wb&&S===this)throw Error("A 'pure' computed must not be called recursively");this[E].I[_]=w,w.Ka=this[E].V++,w.La=S.ob()},Xa:function(){var _,S,w=this[E].I;for(_ in w)if(Object.prototype.hasOwnProperty.call(w,_)&&(S=w[_],this.Ia&&S.da.Ja||S.da.Dd(S.La)))return!0},Jd:function(){this.Ia&&!this[E].rb&&this.Ia(!1)},ja:function(){var _=this[E];return _.ka||0<_.V},Rd:function(){this.Ja?this[E].ka&&(this[E].sa=!0):this.Hc()},$c:function(_){if(_.Hb){var S=_.subscribe(this.Jd,this,"dirty"),w=_.subscribe(this.Rd,this);return{da:_,s:function(){S.s(),w.s()}}}return _.subscribe(this.Hc,this)},Hc:function(){var _=this,S=_.throttleEvaluation;S&&0<=S?(clearTimeout(this[E].Ic),this[E].Ic=m.a.setTimeout(function(){_.ha(!0)},S)):_.Ia?_.Ia(!0):_.ha(!0)},ha:function(_){var S=this[E],w=S.Sa,I=!1;if(!S.rb&&!S.ra){if(S.l&&!m.a.Sb(S.l)||w&&w()){if(!S.jc){this.s();return}}else S.jc=!1;S.rb=!0;try{I=this.zd(_)}finally{S.rb=!1}return I}},zd:function(_){var S=this[E],I=!1,w=S.wb?e:!S.V,I={qd:this,mb:S.I,Qb:S.V};m.u.xc({pd:I,od:g,o:this,Ya:w}),S.I={},S.V=0;var N=this.yd(S,I);return S.V?I=this.sb(S.X,N):(this.s(),I=!0),I&&(S.J?this.Gb():this.notifySubscribers(S.X,"beforeChange"),S.X=N,this.notifySubscribers(S.X,"spectate"),!S.J&&_&&this.notifySubscribers(S.X),this.rc&&this.rc()),w&&this.notifySubscribers(S.X,"awake"),I},yd:function(_,S){try{var w=_.Wc;return _.nb?w.call(_.nb):w()}finally{m.u.end(),S.Qb&&!_.J&&m.a.P(S.mb,p),_.sa=_.ka=!1}},v:function(_){var S=this[E];return(S.ka&&(_||!S.V)||S.J&&this.Xa())&&this.ha(),S.X},ub:function(_){m.T.fn.ub.call(this,_),this.nc=function(){return this[E].J||(this[E].sa?this.ha():this[E].ka=!1),this[E].X},this.Ia=function(S){this.pc(this[E].X),this[E].ka=!0,S&&(this[E].sa=!0),this.qc(this,!S)}},s:function(){var _=this[E];!_.J&&_.I&&m.a.P(_.I,function(S,w){w.s&&w.s()}),_.l&&_.Rb&&m.a.K.yb(_.l,_.Rb),_.I=e,_.V=0,_.ra=!0,_.sa=!1,_.ka=!1,_.J=!1,_.l=e,_.Sa=e,_.Wc=e,this.Nc||(_.nb=e)}},D={Qa:function(_){var S=this,w=S[E];if(!w.ra&&w.J&&_=="change"){if(w.J=!1,w.sa||S.Xa())w.I=null,w.V=0,S.ha()&&S.Gb();else{var I=[];m.a.P(w.I,function(N,k){I[k.Ka]=N}),m.a.D(I,function(N,k){var z=w.I[N],V=S.$c(z.da);V.Ka=k,V.La=z.La,w.I[N]=V}),S.Xa()&&S.ha()&&S.Gb()}w.ra||S.notifySubscribers(w.X,"awake")}},hb:function(_){var S=this[E];S.ra||_!="change"||this.Wa("change")||(m.a.P(S.I,function(w,I){I.s&&(S.I[w]={da:I.da,Ka:I.Ka,La:I.La},I.s())}),S.J=!0,this.notifySubscribers(e,"asleep"))},ob:function(){var _=this[E];return _.J&&(_.sa||this.Xa())&&this.ha(),m.T.fn.ob.call(this)}},O={Qa:function(_){_!="change"&&_!="beforeChange"||this.v()}};m.a.Ba&&m.a.setPrototypeOf(v,m.T.fn);var P=m.ta.Ma;v[P]=m.o,m.Oc=function(_){return typeof _=="function"&&_[P]===v[P]},m.Fd=function(_){return m.Oc(_)&&_[E]&&_[E].wb},m.b("computed",m.o),m.b("dependentObservable",m.o),m.b("isComputed",m.Oc),m.b("isPureComputed",m.Fd),m.b("computed.fn",v),m.L(v,"peek",v.v),m.L(v,"dispose",v.s),m.L(v,"isActive",v.ja),m.L(v,"getDependenciesCount",v.qa),m.L(v,"getDependencies",v.Va),m.xb=function(_,S){return typeof _=="function"?m.o(_,S,{pure:!0}):(_=m.a.extend({},_),_.pure=!0,m.o(_,S))},m.b("pureComputed",m.xb),function(){function _(I,N,k){if(k=k||new w,I=N(I),typeof I!="object"||I===null||I===e||I instanceof RegExp||I instanceof Date||I instanceof String||I instanceof Number||I instanceof Boolean)return I;var z=I instanceof Array?[]:{};return k.save(I,z),S(I,function(V){var U=N(I[V]);switch(typeof U){case"boolean":case"number":case"string":case"function":z[V]=U;break;case"object":case"undefined":var B=k.get(U);z[V]=B!==e?B:_(U,N,k)}}),z}function S(I,N){if(I instanceof Array){for(var k=0;k<I.length;k++)N(k);typeof I.toJSON=="function"&&N("toJSON")}else for(k in I)N(k)}function w(){this.keys=[],this.values=[]}m.ad=function(I){if(arguments.length==0)throw Error("When calling ko.toJS, pass the object you want to convert.");return _(I,function(N){for(var k=0;m.O(N)&&10>k;k++)N=N();return N})},m.toJSON=function(I,N,k){return I=m.ad(I),m.a.hc(I,N,k)},w.prototype={constructor:w,save:function(I,N){var k=m.a.A(this.keys,I);0<=k?this.values[k]=N:(this.keys.push(I),this.values.push(N))},get:function(I){return I=m.a.A(this.keys,I),0<=I?this.values[I]:e}}}(),m.b("toJS",m.ad),m.b("toJSON",m.toJSON),m.Wd=function(_,S,w){function I(N){var k=m.xb(_,w).extend({ma:"always"}),z=k.subscribe(function(V){V&&(z.s(),N(V))});return k.notifySubscribers(k.v()),z}return typeof Promise!="function"||S?I(S.bind(w)):new Promise(I)},m.b("when",m.Wd),function(){m.w={M:function(_){switch(m.a.R(_)){case"option":return _.__ko__hasDomDataOptionValue__===!0?m.a.g.get(_,m.c.options.$b):7>=m.a.W?_.getAttributeNode("value")&&_.getAttributeNode("value").specified?_.value:_.text:_.value;case"select":return 0<=_.selectedIndex?m.w.M(_.options[_.selectedIndex]):e;default:return _.value}},cb:function(_,S,w){switch(m.a.R(_)){case"option":typeof S=="string"?(m.a.g.set(_,m.c.options.$b,e),"__ko__hasDomDataOptionValue__"in _&&delete _.__ko__hasDomDataOptionValue__,_.value=S):(m.a.g.set(_,m.c.options.$b,S),_.__ko__hasDomDataOptionValue__=!0,_.value=typeof S=="number"?S:"");break;case"select":(S===""||S===null)&&(S=e);for(var I=-1,N=0,k=_.options.length,z;N<k;++N)if(z=m.w.M(_.options[N]),z==S||z===""&&S===e){I=N;break}(w||0<=I||S===e&&1<_.size)&&(_.selectedIndex=I,m.a.W===6&&m.a.setTimeout(function(){_.selectedIndex=I},0));break;default:(S===null||S===e)&&(S=""),_.value=S}}}}(),m.b("selectExtensions",m.w),m.b("selectExtensions.readValue",m.w.M),m.b("selectExtensions.writeValue",m.w.cb),m.m=function(){function _(V){V=m.a.Db(V),V.charCodeAt(0)===123&&(V=V.slice(1,-1)),V+=`
,`;var U=[],B=V.match(I),W,j=[],Q=0;if(1<B.length){for(var q=0,X;X=B[q];++q){var Z=X.charCodeAt(0);if(Z===44){if(0>=Q){U.push(W&&j.length?{key:W,value:j.join("")}:{unknown:W||j.join("")}),W=Q=0,j=[];continue}}else if(Z===58){if(!Q&&!W&&j.length===1){W=j.pop();continue}}else{if(Z===47&&1<X.length&&(X.charCodeAt(1)===47||X.charCodeAt(1)===42))continue;Z===47&&q&&1<X.length?(Z=B[q-1].match(N))&&!k[Z[0]]&&(V=V.substr(V.indexOf(X)+1),B=V.match(I),q=-1,X="/"):Z===40||Z===123||Z===91?++Q:Z===41||Z===125||Z===93?--Q:W||j.length||Z!==34&&Z!==39||(X=X.slice(1,-1))}j.push(X)}if(0<Q)throw Error("Unbalanced parentheses, braces, or brackets")}return U}var S=["true","false","null","undefined"],w=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,I=RegExp(`"(?:\\\\.|[^"])*"|'(?:\\\\.|[^'])*'|\`(?:\\\\.|[^\`])*\`|/\\*(?:[^*]|\\*+[^*/])*\\*+/|//.*
|/(?:\\\\.|[^/])+/w*|[^\\s:,/][^,"'\`{}()/:[\\]]*[^\\s,"'\`{}()/:[\\]]|[^\\s]`,"g"),N=/[\])"'A-Za-z0-9_$]+$/,k={in:1,return:1,typeof:1},z={};return{Ra:[],wa:z,ac:_,vb:function(V,U){function B(Z,fe){var xe;if(!q){var re=m.getBindingHandler(Z);if(re&&re.preprocess&&!(fe=re.preprocess(fe,Z,B)))return;(re=z[Z])&&(xe=fe,0<=m.a.A(S,xe)?xe=!1:(re=xe.match(w),xe=re===null?!1:re[1]?"Object("+re[1]+")"+re[2]:xe),re=xe),re&&j.push("'"+(typeof z[Z]=="string"?z[Z]:Z)+"':function(_z){"+xe+"=_z}")}Q&&(fe="function(){return "+fe+" }"),W.push("'"+Z+"':"+fe)}U=U||{};var W=[],j=[],Q=U.valueAccessors,q=U.bindingParams,X=typeof V=="string"?_(V):V;return m.a.D(X,function(Z){B(Z.key||Z.unknown,Z.value)}),j.length&&B("_ko_property_writers","{"+j.join(",")+" }"),W.join(",")},Id:function(V,U){for(var B=0;B<V.length;B++)if(V[B].key==U)return!0;return!1},eb:function(V,U,B,W,j){V&&m.O(V)?!m.Za(V)||j&&V.v()===W||V(W):(V=U.get("_ko_property_writers"))&&V[B]&&V[B](W)}}}(),m.b("expressionRewriting",m.m),m.b("expressionRewriting.bindingRewriteValidators",m.m.Ra),m.b("expressionRewriting.parseObjectLiteral",m.m.ac),m.b("expressionRewriting.preProcessBindings",m.m.vb),m.b("expressionRewriting._twoWayBindings",m.m.wa),m.b("jsonExpressionRewriting",m.m),m.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",m.m.vb),function(){function _(B){return B.nodeType==8&&k.test(N?B.text:B.nodeValue)}function S(B){return B.nodeType==8&&z.test(N?B.text:B.nodeValue)}function w(B,W){for(var j=B,Q=1,q=[];j=j.nextSibling;){if(S(j)&&(m.a.g.set(j,U,!0),Q--,Q===0))return q;q.push(j),_(j)&&Q++}if(!W)throw Error("Cannot find closing comment tag to match: "+B.nodeValue);return null}function I(B,W){var j=w(B,W);return j?0<j.length?j[j.length-1].nextSibling:B.nextSibling:null}var N=n&&n.createComment("test").text==="<!--test-->",k=N?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,z=N?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,V={ul:!0,ol:!0},U="__ko_matchedEndComment__";m.h={ea:{},childNodes:function(B){return _(B)?w(B):B.childNodes},Ea:function(B){if(_(B)){B=m.h.childNodes(B);for(var W=0,j=B.length;W<j;W++)m.removeNode(B[W])}else m.a.Tb(B)},va:function(B,W){if(_(B)){m.h.Ea(B);for(var j=B.nextSibling,Q=0,q=W.length;Q<q;Q++)j.parentNode.insertBefore(W[Q],j)}else m.a.va(B,W)},Vc:function(B,W){var j;_(B)?(j=B.nextSibling,B=B.parentNode):j=B.firstChild,j?W!==j&&B.insertBefore(W,j):B.appendChild(W)},Wb:function(B,W,j){j?(j=j.nextSibling,_(B)&&(B=B.parentNode),j?W!==j&&B.insertBefore(W,j):B.appendChild(W)):m.h.Vc(B,W)},firstChild:function(B){if(_(B))return!B.nextSibling||S(B.nextSibling)?null:B.nextSibling;if(B.firstChild&&S(B.firstChild))throw Error("Found invalid end comment, as the first child of "+B);return B.firstChild},nextSibling:function(B){if(_(B)&&(B=I(B)),B.nextSibling&&S(B.nextSibling)){var W=B.nextSibling;if(S(W)&&!m.a.g.get(W,U))throw Error("Found end comment without a matching opening comment, as child of "+B);return null}return B.nextSibling},Cd:_,Vd:function(B){return(B=(N?B.text:B.nodeValue).match(k))?B[1]:null},Sc:function(B){if(V[m.a.R(B)]){var W=B.firstChild;if(W)do if(W.nodeType===1){var j;j=W.firstChild;var Q=null;if(j)do if(Q)Q.push(j);else if(_(j)){var q=I(j,!0);q?j=q:Q=[j]}else S(j)&&(Q=[j]);while(j=j.nextSibling);if(j=Q)for(Q=W.nextSibling,q=0;q<j.length;q++)Q?B.insertBefore(j[q],Q):B.appendChild(j[q])}while(W=W.nextSibling)}}}}(),m.b("virtualElements",m.h),m.b("virtualElements.allowedBindings",m.h.ea),m.b("virtualElements.emptyNode",m.h.Ea),m.b("virtualElements.insertAfter",m.h.Wb),m.b("virtualElements.prepend",m.h.Vc),m.b("virtualElements.setDomNodeChildren",m.h.va),function(){m.ga=function(){this.nd={}},m.a.extend(m.ga.prototype,{nodeHasBindings:function(_){switch(_.nodeType){case 1:return _.getAttribute("data-bind")!=null||m.j.getComponentNameForNode(_);case 8:return m.h.Cd(_);default:return!1}},getBindings:function(_,S){var w=this.getBindingsString(_,S),w=w?this.parseBindingsString(w,S,_):null;return m.j.tc(w,_,S,!1)},getBindingAccessors:function(_,S){var w=this.getBindingsString(_,S),w=w?this.parseBindingsString(w,S,_,{valueAccessors:!0}):null;return m.j.tc(w,_,S,!0)},getBindingsString:function(_){switch(_.nodeType){case 1:return _.getAttribute("data-bind");case 8:return m.h.Vd(_);default:return null}},parseBindingsString:function(_,S,w,I){try{var N=this.nd,k=_+(I&&I.valueAccessors||""),z;if(!(z=N[k])){var V,U="with($context){with($data||{}){return{"+m.m.vb(_,I)+"}}}";V=new Function("$context","$element",U),z=N[k]=V}return z(S,w)}catch(B){throw B.message=`Unable to parse bindings.
Bindings value: `+_+`
Message: `+B.message,B}}}),m.ga.instance=new m.ga}(),m.b("bindingProvider",m.ga),function(){function _(re){var pe=(re=m.a.g.get(re,xe))&&re.N;pe&&(re.N=null,pe.Tc())}function S(re,pe,ye){this.node=re,this.yc=pe,this.kb=[],this.H=!1,pe.N||m.a.K.za(re,_),ye&&ye.N&&(ye.N.kb.push(re),this.Kb=ye)}function w(re){return function(){return re}}function I(re){return re()}function N(re){return m.a.Ga(m.u.G(re),function(pe,ye){return function(){return re()[ye]}})}function k(re,pe,ye){return typeof re=="function"?N(re.bind(null,pe,ye)):m.a.Ga(re,w)}function z(re,pe){return N(this.getBindings.bind(this,re,pe))}function V(re,pe){var ye=m.h.firstChild(pe);if(ye){var Se,Te=m.ga.instance,Fe=Te.preprocessNode;if(Fe){for(;Se=ye;)ye=m.h.nextSibling(Se),Fe.call(Te,Se);ye=m.h.firstChild(pe)}for(;Se=ye;)ye=m.h.nextSibling(Se),U(re,Se)}m.i.ma(pe,m.i.H)}function U(re,pe){var ye=re,Se=pe.nodeType===1;Se&&m.h.Sc(pe),(Se||m.ga.instance.nodeHasBindings(pe))&&(ye=W(pe,null,re).bindingContextForDescendants),ye&&!Z[m.a.R(pe)]&&V(ye,pe)}function B(re){var pe=[],ye={},Se=[];return m.a.P(re,function Te(Fe){if(!ye[Fe]){var Ve=m.getBindingHandler(Fe);Ve&&(Ve.after&&(Se.push(Fe),m.a.D(Ve.after,function(Ze){if(re[Ze]){if(m.a.A(Se,Ze)!==-1)throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+Se.join(", "));Te(Ze)}}),Se.length--),pe.push({key:Fe,Mc:Ve})),ye[Fe]=!0}}),pe}function W(re,pe,ye){var Se=m.a.g.Ub(re,xe,{}),Te=Se.hd;if(!pe){if(Te)throw Error("You cannot apply bindings multiple times to the same element.");Se.hd=!0}Te||(Se.context=ye),Se.Zb||(Se.Zb={});var Fe;if(pe&&typeof pe!="function")Fe=pe;else{var Ve=m.ga.instance,Ze=Ve.getBindingAccessors||z,gt=m.$(function(){return(Fe=pe?pe(ye,re):Ze.call(Ve,re,ye))&&(ye[Q]&&ye[Q](),ye[X]&&ye[X]()),Fe},null,{l:re});Fe&&gt.ja()||(gt=null)}var lt=ye,Oe;if(Fe){var Mt=function(){return m.a.Ga(gt?gt():Fe,I)},ut=gt?function(at){return function(){return I(gt()[at])}}:function(at){return Fe[at]};Mt.get=function(at){return Fe[at]&&I(ut(at))},Mt.has=function(at){return at in Fe},m.i.H in Fe&&m.i.subscribe(re,m.i.H,function(){var at=(0,Fe[m.i.H])();if(at){var Kt=m.h.childNodes(re);Kt.length&&at(Kt,m.Ec(Kt[0]))}}),m.i.pa in Fe&&(lt=m.i.Cb(re,ye),m.i.subscribe(re,m.i.pa,function(){var at=(0,Fe[m.i.pa])();at&&m.h.firstChild(re)&&at(re)})),Se=B(Fe),m.a.D(Se,function(at){var Kt=at.Mc.init,Ce=at.Mc.update,Ae=at.key;if(re.nodeType===8&&!m.h.ea[Ae])throw Error("The binding '"+Ae+"' cannot be used with virtual elements");try{typeof Kt=="function"&&m.u.G(function(){var nt=Kt(re,ut(Ae),Mt,lt.$data,lt);if(nt&&nt.controlsDescendantBindings){if(Oe!==e)throw Error("Multiple bindings ("+Oe+" and "+Ae+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");Oe=Ae}}),typeof Ce=="function"&&m.$(function(){Ce(re,ut(Ae),Mt,lt.$data,lt)},null,{l:re})}catch(nt){throw nt.message='Unable to process binding "'+Ae+": "+Fe[Ae]+`"
Message: `+nt.message,nt}})}return Se=Oe===e,{shouldBindDescendants:Se,bindingContextForDescendants:Se&&lt}}function j(re,pe){return re&&re instanceof m.fa?re:new m.fa(re,e,e,pe)}var Q=m.a.Da("_subscribable"),q=m.a.Da("_ancestorBindingInfo"),X=m.a.Da("_dataDependency");m.c={};var Z={script:!0,textarea:!0,template:!0};m.getBindingHandler=function(re){return m.c[re]};var fe={};m.fa=function(re,pe,ye,Se,Te){function Fe(){var ut=lt?gt():gt,at=m.a.f(ut);return pe?(m.a.extend(Ve,pe),q in pe&&(Ve[q]=pe[q])):(Ve.$parents=[],Ve.$root=at,Ve.ko=m),Ve[Q]=Oe,Ze?at=Ve.$data:(Ve.$rawData=ut,Ve.$data=at),ye&&(Ve[ye]=at),Se&&Se(Ve,pe,at),pe&&pe[Q]&&!m.S.o().Vb(pe[Q])&&pe[Q](),Mt&&(Ve[X]=Mt),Ve.$data}var Ve=this,Ze=re===fe,gt=Ze?e:re,lt=typeof gt=="function"&&!m.O(gt),Oe,Mt=Te&&Te.dataDependency;Te&&Te.exportDependencies?Fe():(Oe=m.xb(Fe),Oe.v(),Oe.ja()?Oe.equalityComparer=null:Ve[Q]=e)},m.fa.prototype.createChildContext=function(re,pe,ye,Se){if(!Se&&pe&&typeof pe=="object"&&(Se=pe,pe=Se.as,ye=Se.extend),pe&&Se&&Se.noChildContext){var Te=typeof re=="function"&&!m.O(re);return new m.fa(fe,this,null,function(Fe){ye&&ye(Fe),Fe[pe]=Te?re():re},Se)}return new m.fa(re,this,pe,function(Fe,Ve){Fe.$parentContext=Ve,Fe.$parent=Ve.$data,Fe.$parents=(Ve.$parents||[]).slice(0),Fe.$parents.unshift(Fe.$parent),ye&&ye(Fe)},Se)},m.fa.prototype.extend=function(re,pe){return new m.fa(fe,this,null,function(ye){m.a.extend(ye,typeof re=="function"?re(ye):re)},pe)};var xe=m.a.g.Z();S.prototype.Tc=function(){this.Kb&&this.Kb.N&&this.Kb.N.sd(this.node)},S.prototype.sd=function(re){m.a.Pa(this.kb,re),!this.kb.length&&this.H&&this.Cc()},S.prototype.Cc=function(){this.H=!0,this.yc.N&&!this.kb.length&&(this.yc.N=null,m.a.K.yb(this.node,_),m.i.ma(this.node,m.i.pa),this.Tc())},m.i={H:"childrenComplete",pa:"descendantsComplete",subscribe:function(re,pe,ye,Se,Te){var Fe=m.a.g.Ub(re,xe,{});return Fe.Fa||(Fe.Fa=new m.T),Te&&Te.notifyImmediately&&Fe.Zb[pe]&&m.u.G(ye,Se,[re]),Fe.Fa.subscribe(ye,Se,pe)},ma:function(re,pe){var ye=m.a.g.get(re,xe);if(ye&&(ye.Zb[pe]=!0,ye.Fa&&ye.Fa.notifySubscribers(re,pe),pe==m.i.H)){if(ye.N)ye.N.Cc();else if(ye.N===e&&ye.Fa&&ye.Fa.Wa(m.i.pa))throw Error("descendantsComplete event not supported for bindings on this node")}},Cb:function(re,pe){var ye=m.a.g.Ub(re,xe,{});return ye.N||(ye.N=new S(re,ye,pe[q])),pe[q]==ye?pe:pe.extend(function(Se){Se[q]=ye})}},m.Td=function(re){return(re=m.a.g.get(re,xe))&&re.context},m.ib=function(re,pe,ye){return re.nodeType===1&&m.h.Sc(re),W(re,pe,j(ye))},m.ld=function(re,pe,ye){return ye=j(ye),m.ib(re,k(pe,ye,re),ye)},m.Oa=function(re,pe){pe.nodeType!==1&&pe.nodeType!==8||V(j(re),pe)},m.vc=function(re,pe,ye){if(!o&&t.jQuery&&(o=t.jQuery),2>arguments.length){if(pe=n.body,!pe)throw Error("ko.applyBindings: could not find document.body; has the document been loaded?")}else if(!pe||pe.nodeType!==1&&pe.nodeType!==8)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");U(j(re,ye),pe)},m.Dc=function(re){return!re||re.nodeType!==1&&re.nodeType!==8?e:m.Td(re)},m.Ec=function(re){return(re=m.Dc(re))?re.$data:e},m.b("bindingHandlers",m.c),m.b("bindingEvent",m.i),m.b("bindingEvent.subscribe",m.i.subscribe),m.b("bindingEvent.startPossiblyAsyncContentBinding",m.i.Cb),m.b("applyBindings",m.vc),m.b("applyBindingsToDescendants",m.Oa),m.b("applyBindingAccessorsToNode",m.ib),m.b("applyBindingsToNode",m.ld),m.b("contextFor",m.Dc),m.b("dataFor",m.Ec)}(),function(_){function S(z,V){var U=Object.prototype.hasOwnProperty.call(N,z)?N[z]:_,B;U?U.subscribe(V):(U=N[z]=new m.T,U.subscribe(V),w(z,function(W,j){var Q=!(!j||!j.synchronous);k[z]={definition:W,Gd:Q},delete N[z],B||Q?U.notifySubscribers(W):m.na.zb(function(){U.notifySubscribers(W)})}),B=!0)}function w(z,V){I("getConfig",[z],function(U){U?I("loadComponent",[z,U],function(B){V(B,U)}):V(null,null)})}function I(z,V,U,B){B||(B=m.j.loaders.slice(0));var W=B.shift();if(W){var j=W[z];if(j){var Q=!1;if(j.apply(W,V.concat(function(q){Q?U(null):q!==null?U(q):I(z,V,U,B)}))!==_&&(Q=!0,!W.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else I(z,V,U,B)}else U(null)}var N={},k={};m.j={get:function(z,V){var U=Object.prototype.hasOwnProperty.call(k,z)?k[z]:_;U?U.Gd?m.u.G(function(){V(U.definition)}):m.na.zb(function(){V(U.definition)}):S(z,V)},Bc:function(z){delete k[z]},oc:I},m.j.loaders=[],m.b("components",m.j),m.b("components.get",m.j.get),m.b("components.clearCachedDefinition",m.j.Bc)}(),function(){function _(U,B,W,j){function Q(){--X===0&&j(q)}var q={},X=2,Z=W.template;W=W.viewModel,Z?N(B,Z,function(fe){m.j.oc("loadTemplate",[U,fe],function(xe){q.template=xe,Q()})}):Q(),W?N(B,W,function(fe){m.j.oc("loadViewModel",[U,fe],function(xe){q[V]=xe,Q()})}):Q()}function S(U,B,W){if(typeof B=="function")W(function(Q){return new B(Q)});else if(typeof B[V]=="function")W(B[V]);else if("instance"in B){var j=B.instance;W(function(){return j})}else"viewModel"in B?S(U,B.viewModel,W):U("Unknown viewModel value: "+B)}function w(U){switch(m.a.R(U)){case"script":return m.a.ua(U.text);case"textarea":return m.a.ua(U.value);case"template":if(I(U.content))return m.a.Ca(U.content.childNodes)}return m.a.Ca(U.childNodes)}function I(U){return t.DocumentFragment?U instanceof DocumentFragment:U&&U.nodeType===11}function N(U,B,W){typeof B.require=="string"?a||t.require?(a||t.require)([B.require],function(j){j&&typeof j=="object"&&j.Xd&&j.default&&(j=j.default),W(j)}):U("Uses require, but no AMD loader is present"):W(B)}function k(U){return function(B){throw Error("Component '"+U+"': "+B)}}var z={};m.j.register=function(U,B){if(!B)throw Error("Invalid configuration for "+U);if(m.j.tb(U))throw Error("Component "+U+" is already registered");z[U]=B},m.j.tb=function(U){return Object.prototype.hasOwnProperty.call(z,U)},m.j.unregister=function(U){delete z[U],m.j.Bc(U)},m.j.Fc={getConfig:function(U,B){B(m.j.tb(U)?z[U]:null)},loadComponent:function(U,B,W){var j=k(U);N(j,B,function(Q){_(U,j,Q,W)})},loadTemplate:function(U,B,W){if(U=k(U),typeof B=="string")W(m.a.ua(B));else if(B instanceof Array)W(B);else if(I(B))W(m.a.la(B.childNodes));else if(B.element)if(B=B.element,t.HTMLElement?B instanceof HTMLElement:B&&B.tagName&&B.nodeType===1)W(w(B));else if(typeof B=="string"){var j=n.getElementById(B);j?W(w(j)):U("Cannot find element with ID "+B)}else U("Unknown element type: "+B);else U("Unknown template value: "+B)},loadViewModel:function(U,B,W){S(k(U),B,W)}};var V="createViewModel";m.b("components.register",m.j.register),m.b("components.isRegistered",m.j.tb),m.b("components.unregister",m.j.unregister),m.b("components.defaultLoader",m.j.Fc),m.j.loaders.push(m.j.Fc),m.j.dd=z}(),function(){function _(w,I){var N=w.getAttribute("params");if(N){var N=S.parseBindingsString(N,I,w,{valueAccessors:!0,bindingParams:!0}),N=m.a.Ga(N,function(V){return m.o(V,null,{l:w})}),k=m.a.Ga(N,function(V){var U=V.v();return V.ja()?m.o({read:function(){return m.a.f(V())},write:m.Za(U)&&function(B){V()(B)},l:w}):U});return Object.prototype.hasOwnProperty.call(k,"$raw")||(k.$raw=N),k}return{$raw:{}}}m.j.getComponentNameForNode=function(w){var I=m.a.R(w);if(m.j.tb(I)&&(I.indexOf("-")!=-1||""+w=="[object HTMLUnknownElement]"||8>=m.a.W&&w.tagName===I))return I},m.j.tc=function(w,I,N,k){if(I.nodeType===1){var z=m.j.getComponentNameForNode(I);if(z){if(w=w||{},w.component)throw Error('Cannot use the "component" binding on a custom element matching a component');var V={name:z,params:_(I,N)};w.component=k?function(){return V}:V}}return w};var S=new m.ga;9>m.a.W&&(m.j.register=function(w){return function(I){return w.apply(this,arguments)}}(m.j.register),n.createDocumentFragment=function(w){return function(){var I=w(),N=m.j.dd,k;for(k in N);return I}}(n.createDocumentFragment))}(),function(){function _(I,N,k){if(N=N.template,!N)throw Error("Component '"+I+"' has no template");I=m.a.Ca(N),m.h.va(k,I)}function S(I,N,k){var z=I.createViewModel;return z?z.call(I,N,k):N}var w=0;m.c.component={init:function(I,N,k,z,V){function U(){var q=B&&B.dispose;typeof q=="function"&&q.call(B),j&&j.s(),W=B=j=null}var B,W,j,Q=m.a.la(m.h.childNodes(I));return m.h.Ea(I),m.a.K.za(I,U),m.o(function(){var q=m.a.f(N()),X,Z;if(typeof q=="string"?X=q:(X=m.a.f(q.name),Z=m.a.f(q.params)),!X)throw Error("No component name specified");var fe=m.i.Cb(I,V),xe=W=++w;m.j.get(X,function(re){if(W===xe){if(U(),!re)throw Error("Unknown component '"+X+"'");_(X,re,I);var pe=S(re,Z,{element:I,templateNodes:Q});re=fe.createChildContext(pe,{extend:function(ye){ye.$component=pe,ye.$componentTemplateNodes=Q}}),pe&&pe.koDescendantsComplete&&(j=m.i.subscribe(I,m.i.pa,pe.koDescendantsComplete,pe)),B=pe,m.Oa(re,I)}})},null,{l:I}),{controlsDescendantBindings:!0}}},m.h.ea.component=!0}();var M={class:"className",for:"htmlFor"};m.c.attr={update:function(_,S){var w=m.a.f(S())||{};m.a.P(w,function(I,N){N=m.a.f(N);var k=I.indexOf(":"),k="lookupNamespaceURI"in _&&0<k&&_.lookupNamespaceURI(I.substr(0,k)),z=N===!1||N===null||N===e;z?k?_.removeAttributeNS(k,I):_.removeAttribute(I):N=N.toString(),8>=m.a.W&&I in M?(I=M[I],z?_.removeAttribute(I):_[I]=N):z||(k?_.setAttributeNS(k,I,N):_.setAttribute(I,N)),I==="name"&&m.a.Yc(_,z?"":N)})}},function(){m.c.checked={after:["value","attr"],init:function(_,S,w){function I(){var q=_.checked,X=k();if(!m.S.Ya()&&(q||!V&&!m.S.qa())){var Z=m.u.G(S);if(B){var fe=W?Z.v():Z,xe=Q;Q=X,xe!==X?q&&(m.a.Na(fe,X,!0),m.a.Na(fe,xe,!1)):m.a.Na(fe,X,q),W&&m.Za(Z)&&Z(fe)}else z&&(X===e?X=q:q||(X=e)),m.m.eb(Z,w,"checked",X,!0)}}function N(){var q=m.a.f(S()),X=k();B?(_.checked=0<=m.a.A(q,X),Q=X):_.checked=z&&X===e?!!q:k()===q}var k=m.xb(function(){if(w.has("checkedValue"))return m.a.f(w.get("checkedValue"));if(j)return w.has("value")?m.a.f(w.get("value")):_.value}),z=_.type=="checkbox",V=_.type=="radio";if(z||V){var U=S(),B=z&&m.a.f(U)instanceof Array,W=!(B&&U.push&&U.splice),j=V||B,Q=B?k():e;V&&!_.name&&m.c.uniqueName.init(_,function(){return!0}),m.o(I,null,{l:_}),m.a.B(_,"click",I),m.o(N,null,{l:_}),U=e}}},m.m.wa.checked=!0,m.c.checkedValue={update:function(_,S){_.value=m.a.f(S())}}}(),m.c.class={update:function(_,S){var w=m.a.Db(m.a.f(S()));m.a.Eb(_,_.__ko__cssValue,!1),_.__ko__cssValue=w,m.a.Eb(_,w,!0)}},m.c.css={update:function(_,S){var w=m.a.f(S());w!==null&&typeof w=="object"?m.a.P(w,function(I,N){N=m.a.f(N),m.a.Eb(_,I,N)}):m.c.class.update(_,S)}},m.c.enable={update:function(_,S){var w=m.a.f(S());w&&_.disabled?_.removeAttribute("disabled"):w||_.disabled||(_.disabled=!0)}},m.c.disable={update:function(_,S){m.c.enable.update(_,function(){return!m.a.f(S())})}},m.c.event={init:function(_,S,w,I,N){var k=S()||{};m.a.P(k,function(z){typeof z=="string"&&m.a.B(_,z,function(V){var U,B=S()[z];if(B){try{var W=m.a.la(arguments);I=N.$data,W.unshift(I),U=B.apply(I,W)}finally{U!==!0&&(V.preventDefault?V.preventDefault():V.returnValue=!1)}w.get(z+"Bubble")===!1&&(V.cancelBubble=!0,V.stopPropagation&&V.stopPropagation())}})})}},m.c.foreach={Rc:function(_){return function(){var S=_(),w=m.a.bc(S);return!w||typeof w.length=="number"?{foreach:S,templateEngine:m.ba.Ma}:(m.a.f(S),{foreach:w.data,as:w.as,noChildContext:w.noChildContext,includeDestroyed:w.includeDestroyed,afterAdd:w.afterAdd,beforeRemove:w.beforeRemove,afterRender:w.afterRender,beforeMove:w.beforeMove,afterMove:w.afterMove,templateEngine:m.ba.Ma})}},init:function(_,S){return m.c.template.init(_,m.c.foreach.Rc(S))},update:function(_,S,w,I,N){return m.c.template.update(_,m.c.foreach.Rc(S),w,I,N)}},m.m.Ra.foreach=!1,m.h.ea.foreach=!0,m.c.hasfocus={init:function(_,S,w){function I(z){_.__ko_hasfocusUpdating=!0;var V=_.ownerDocument;if("activeElement"in V){var U;try{U=V.activeElement}catch{U=V.body}z=U===_}V=S(),m.m.eb(V,w,"hasfocus",z,!0),_.__ko_hasfocusLastValue=z,_.__ko_hasfocusUpdating=!1}var N=I.bind(null,!0),k=I.bind(null,!1);m.a.B(_,"focus",N),m.a.B(_,"focusin",N),m.a.B(_,"blur",k),m.a.B(_,"focusout",k),_.__ko_hasfocusLastValue=!1},update:function(_,S){var w=!!m.a.f(S());_.__ko_hasfocusUpdating||_.__ko_hasfocusLastValue===w||(w?_.focus():_.blur(),!w&&_.__ko_hasfocusLastValue&&_.ownerDocument.body.focus(),m.u.G(m.a.Fb,null,[_,w?"focusin":"focusout"]))}},m.m.wa.hasfocus=!0,m.c.hasFocus=m.c.hasfocus,m.m.wa.hasFocus="hasfocus",m.c.html={init:function(){return{controlsDescendantBindings:!0}},update:function(_,S){m.a.fc(_,S())}},function(){function _(S,w,I){m.c[S]={init:function(N,k,z,V,U){var B,W,j={},Q,q,X;if(w){V=z.get("as");var Z=z.get("noChildContext");X=!(V&&Z),j={as:V,noChildContext:Z,exportDependencies:X}}return q=(Q=z.get("completeOn")=="render")||z.has(m.i.pa),m.o(function(){var fe=m.a.f(k()),xe=!I!=!fe,re=!W,pe;(X||xe!==B)&&(q&&(U=m.i.Cb(N,U)),xe&&((!w||X)&&(j.dataDependency=m.S.o()),pe=w?U.createChildContext(typeof fe=="function"?fe:k,j):m.S.qa()?U.extend(null,j):U),re&&m.S.qa()&&(W=m.a.Ca(m.h.childNodes(N),!0)),xe?(re||m.h.va(N,m.a.Ca(W)),m.Oa(pe,N)):(m.h.Ea(N),Q||m.i.ma(N,m.i.H)),B=xe)},null,{l:N}),{controlsDescendantBindings:!0}}},m.m.Ra[S]=!1,m.h.ea[S]=!0}_("if"),_("ifnot",!1,!0),_("with",!0)}(),m.c.let={init:function(_,S,w,I,N){return S=N.extend(S),m.Oa(S,_),{controlsDescendantBindings:!0}}},m.h.ea.let=!0;var L={};m.c.options={init:function(_){if(m.a.R(_)!=="select")throw Error("options binding applies only to SELECT elements");for(;0<_.length;)_.remove(0);return{controlsDescendantBindings:!0}},update:function(_,S,w){function I(){return m.a.jb(_.options,function(Z){return Z.selected})}function N(Z,fe,xe){var re=typeof fe;return re=="function"?fe(Z):re=="string"?Z[fe]:xe}function k(Z,fe){if(q&&B)m.i.ma(_,m.i.H);else if(Q.length){var xe=0<=m.a.A(Q,m.w.M(fe[0]));m.a.Zc(fe[0],xe),q&&!xe&&m.u.G(m.a.Fb,null,[_,"change"])}}var z=_.multiple,V=_.length!=0&&z?_.scrollTop:null,U=m.a.f(S()),B=w.get("valueAllowUnset")&&w.has("value"),W=w.get("optionsIncludeDestroyed");S={};var j,Q=[];B||(z?Q=m.a.Mb(I(),m.w.M):0<=_.selectedIndex&&Q.push(m.w.M(_.options[_.selectedIndex]))),U&&(typeof U.length>"u"&&(U=[U]),j=m.a.jb(U,function(Z){return W||Z===e||Z===null||!m.a.f(Z._destroy)}),w.has("optionsCaption")&&(U=m.a.f(w.get("optionsCaption")),U!==null&&U!==e&&j.unshift(L)));var q=!1;if(S.beforeRemove=function(Z){_.removeChild(Z)},U=k,w.has("optionsAfterRender")&&typeof w.get("optionsAfterRender")=="function"&&(U=function(Z,fe){k(0,fe),m.u.G(w.get("optionsAfterRender"),null,[fe[0],Z!==L?Z:e])}),m.a.ec(_,j,function(Z,fe,xe){return xe.length&&(Q=!B&&xe[0].selected?[m.w.M(xe[0])]:[],q=!0),fe=_.ownerDocument.createElement("option"),Z===L?(m.a.Bb(fe,w.get("optionsCaption")),m.w.cb(fe,e)):(xe=N(Z,w.get("optionsValue"),Z),m.w.cb(fe,m.a.f(xe)),Z=N(Z,w.get("optionsText"),xe),m.a.Bb(fe,Z)),[fe]},S,U),!B){var X;z?X=Q.length&&I().length<Q.length:X=Q.length&&0<=_.selectedIndex?m.w.M(_.options[_.selectedIndex])!==Q[0]:Q.length||0<=_.selectedIndex,X&&m.u.G(m.a.Fb,null,[_,"change"])}(B||m.S.Ya())&&m.i.ma(_,m.i.H),m.a.wd(_),V&&20<Math.abs(V-_.scrollTop)&&(_.scrollTop=V)}},m.c.options.$b=m.a.g.Z(),m.c.selectedOptions={init:function(_,S,w){function I(){var z=S(),V=[];m.a.D(_.getElementsByTagName("option"),function(U){U.selected&&V.push(m.w.M(U))}),m.m.eb(z,w,"selectedOptions",V)}function N(){var z=m.a.f(S()),V=_.scrollTop;z&&typeof z.length=="number"&&m.a.D(_.getElementsByTagName("option"),function(U){var B=0<=m.a.A(z,m.w.M(U));U.selected!=B&&m.a.Zc(U,B)}),_.scrollTop=V}if(m.a.R(_)!="select")throw Error("selectedOptions binding applies only to SELECT elements");var k;m.i.subscribe(_,m.i.H,function(){k?I():(m.a.B(_,"change",I),k=m.o(N,null,{l:_}))},null,{notifyImmediately:!0})},update:function(){}},m.m.wa.selectedOptions=!0,m.c.style={update:function(_,S){var w=m.a.f(S()||{});m.a.P(w,function(I,N){if(N=m.a.f(N),(N===null||N===e||N===!1)&&(N=""),o)o(_).css(I,N);else if(/^--/.test(I))_.style.setProperty(I,N);else{I=I.replace(/-(\w)/g,function(z,V){return V.toUpperCase()});var k=_.style[I];_.style[I]=N,N===k||_.style[I]!=k||isNaN(N)||(_.style[I]=N+"px")}})}},m.c.submit={init:function(_,S,w,I,N){if(typeof S()!="function")throw Error("The value for a submit binding must be a function");m.a.B(_,"submit",function(k){var z,V=S();try{z=V.call(N.$data,_)}finally{z!==!0&&(k.preventDefault?k.preventDefault():k.returnValue=!1)}})}},m.c.text={init:function(){return{controlsDescendantBindings:!0}},update:function(_,S){m.a.Bb(_,S())}},m.h.ea.text=!0,function(){if(t&&t.navigator){var _=function(j){if(j)return parseFloat(j[1])},S=t.navigator.userAgent,w,I,N,k,z;(w=t.opera&&t.opera.version&&parseInt(t.opera.version()))||(z=_(S.match(/Edge\/([^ ]+)$/)))||_(S.match(/Chrome\/([^ ]+)/))||(I=_(S.match(/Version\/([^ ]+) Safari/)))||(N=_(S.match(/Firefox\/([^ ]+)/)))||(k=m.a.W||_(S.match(/MSIE ([^ ]+)/)))||(k=_(S.match(/rv:([^ )]+)/)))}if(8<=k&&10>k)var V=m.a.g.Z(),U=m.a.g.Z(),B=function(j){var Q=this.activeElement;(Q=Q&&m.a.g.get(Q,U))&&Q(j)},W=function(j,Q){var q=j.ownerDocument;m.a.g.get(q,V)||(m.a.g.set(q,V,!0),m.a.B(q,"selectionchange",B)),m.a.g.set(j,U,Q)};m.c.textInput={init:function(j,Q,q){function X(Fe,Ve){m.a.B(j,Fe,Ve)}function Z(){var Fe=m.a.f(Q());(Fe===null||Fe===e)&&(Fe=""),ye!==e&&Fe===ye?m.a.setTimeout(Z,4):j.value!==Fe&&(Te=!0,j.value=Fe,Te=!1,re=j.value)}function fe(){pe||(ye=j.value,pe=m.a.setTimeout(xe,4))}function xe(){clearTimeout(pe),ye=pe=e;var Fe=j.value;re!==Fe&&(re=Fe,m.m.eb(Q(),q,"textInput",Fe))}var re=j.value,pe,ye,Se=m.a.W==9?fe:xe,Te=!1;k&&X("keypress",xe),11>k&&X("propertychange",function(Fe){Te||Fe.propertyName!=="value"||Se(Fe)}),k==8&&(X("keyup",xe),X("keydown",xe)),W&&(W(j,Se),X("dragend",fe)),(!k||9<=k)&&X("input",Se),5>I&&m.a.R(j)==="textarea"?(X("keydown",fe),X("paste",fe),X("cut",fe)):11>w?X("keydown",fe):4>N?(X("DOMAutoComplete",xe),X("dragdrop",xe),X("drop",xe)):z&&j.type==="number"&&X("keydown",fe),X("change",xe),X("blur",xe),m.o(Z,null,{l:j})}},m.m.wa.textInput=!0,m.c.textinput={preprocess:function(j,Q,q){q("textInput",j)}}}(),m.c.uniqueName={init:function(_,S){if(S()){var w="ko_unique_"+ ++m.c.uniqueName.rd;m.a.Yc(_,w)}}},m.c.uniqueName.rd=0,m.c.using={init:function(_,S,w,I,N){var k;return w.has("as")&&(k={as:w.get("as"),noChildContext:w.get("noChildContext")}),S=N.createChildContext(S,k),m.Oa(S,_),{controlsDescendantBindings:!0}}},m.h.ea.using=!0,m.c.value={init:function(_,S,w){var I=m.a.R(_),N=I=="input";if(!N||_.type!="checkbox"&&_.type!="radio"){var k=[],z=w.get("valueUpdate"),V=!1,U=null;z&&(typeof z=="string"?k=[z]:k=m.a.wc(z),m.a.Pa(k,"change"));var B=function(){U=null,V=!1;var Q=S(),q=m.w.M(_);m.m.eb(Q,w,"value",q)};!m.a.W||!N||_.type!="text"||_.autocomplete=="off"||_.form&&_.form.autocomplete=="off"||m.a.A(k,"propertychange")!=-1||(m.a.B(_,"propertychange",function(){V=!0}),m.a.B(_,"focus",function(){V=!1}),m.a.B(_,"blur",function(){V&&B()})),m.a.D(k,function(Q){var q=B;m.a.Ud(Q,"after")&&(q=function(){U=m.w.M(_),m.a.setTimeout(B,0)},Q=Q.substring(5)),m.a.B(_,Q,q)});var W;if(W=N&&_.type=="file"?function(){var Q=m.a.f(S());Q===null||Q===e||Q===""?_.value="":m.u.G(B)}:function(){var Q=m.a.f(S()),q=m.w.M(_);U!==null&&Q===U?m.a.setTimeout(W,0):(Q!==q||q===e)&&(I==="select"?(q=w.get("valueAllowUnset"),m.w.cb(_,Q,q),q||Q===m.w.M(_)||m.u.G(B)):m.w.cb(_,Q))},I==="select"){var j;m.i.subscribe(_,m.i.H,function(){j?w.get("valueAllowUnset")?W():B():(m.a.B(_,"change",B),j=m.o(W,null,{l:_}))},null,{notifyImmediately:!0})}else m.a.B(_,"change",B),m.o(W,null,{l:_})}else m.ib(_,{checkedValue:S})},update:function(){}},m.m.wa.value=!0,m.c.visible={update:function(_,S){var w=m.a.f(S()),I=_.style.display!="none";w&&!I?_.style.display="":!w&&I&&(_.style.display="none")}},m.c.hidden={update:function(_,S){m.c.visible.update(_,function(){return!m.a.f(S())})}},function(_){m.c[_]={init:function(S,w,I,N,k){return m.c.event.init.call(this,S,function(){var z={};return z[_]=w(),z},I,N,k)}}}("click"),m.ca=function(){},m.ca.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},m.ca.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},m.ca.prototype.makeTemplateSource=function(_,S){if(typeof _=="string"){S=S||n;var w=S.getElementById(_);if(!w)throw Error("Cannot find template with ID "+_);return new m.C.F(w)}if(_.nodeType==1||_.nodeType==8)return new m.C.ia(_);throw Error("Unknown template type: "+_)},m.ca.prototype.renderTemplate=function(_,S,w,I){return _=this.makeTemplateSource(_,I),this.renderTemplateSource(_,S,w,I)},m.ca.prototype.isTemplateRewritten=function(_,S){return this.allowTemplateRewriting===!1?!0:this.makeTemplateSource(_,S).data("isRewritten")},m.ca.prototype.rewriteTemplate=function(_,S,w){_=this.makeTemplateSource(_,w),S=S(_.text()),_.text(S),_.data("isRewritten",!0)},m.b("templateEngine",m.ca),m.kc=function(){function _(I,N,k,z){I=m.m.ac(I);for(var V=m.m.Ra,U=0;U<I.length;U++){var B=I[U].key;if(Object.prototype.hasOwnProperty.call(V,B)){var W=V[B];if(typeof W=="function"){if(B=W(I[U].value))throw Error(B)}else if(!W)throw Error("This template engine does not support the '"+B+"' binding within its templates")}}return k="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+m.m.vb(I,{valueAccessors:!0})+" } })()},'"+k.toLowerCase()+"')",z.createJavaScriptEvaluatorBlock(k)+N}var S=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,w=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{xd:function(I,N,k){N.isTemplateRewritten(I,k)||N.rewriteTemplate(I,function(z){return m.kc.Ld(z,N)},k)},Ld:function(I,N){return I.replace(S,function(k,z,V,U,B){return _(B,z,V,N)}).replace(w,function(k,z){return _(z,"<!-- ko -->","#comment",N)})},md:function(I,N){return m.aa.Xb(function(k,z){var V=k.nextSibling;V&&V.nodeName.toLowerCase()===N&&m.ib(V,I,z)})}}}(),m.b("__tr_ambtns",m.kc.md),function(){m.C={},m.C.F=function(w){if(this.F=w){var I=m.a.R(w);this.ab=I==="script"?1:I==="textarea"?2:I=="template"&&w.content&&w.content.nodeType===11?3:4}},m.C.F.prototype.text=function(){var w=this.ab===1?"text":this.ab===2?"value":"innerHTML";if(arguments.length==0)return this.F[w];var I=arguments[0];w==="innerHTML"?m.a.fc(this.F,I):this.F[w]=I};var _=m.a.g.Z()+"_";m.C.F.prototype.data=function(w){if(arguments.length===1)return m.a.g.get(this.F,_+w);m.a.g.set(this.F,_+w,arguments[1])};var S=m.a.g.Z();m.C.F.prototype.nodes=function(){var w=this.F;if(arguments.length==0){var I=m.a.g.get(w,S)||{},N=I.lb||(this.ab===3?w.content:this.ab===4?w:e);if(!N||I.jd){var k=this.text();k&&k!==I.bb&&(N=m.a.Md(k,w.ownerDocument),m.a.g.set(w,S,{lb:N,bb:k,jd:!0}))}return N}I=arguments[0],this.ab!==e&&this.text(""),m.a.g.set(w,S,{lb:I})},m.C.ia=function(w){this.F=w},m.C.ia.prototype=new m.C.F,m.C.ia.prototype.constructor=m.C.ia,m.C.ia.prototype.text=function(){if(arguments.length==0){var w=m.a.g.get(this.F,S)||{};return w.bb===e&&w.lb&&(w.bb=w.lb.innerHTML),w.bb}m.a.g.set(this.F,S,{bb:arguments[0]})},m.b("templateSources",m.C),m.b("templateSources.domElement",m.C.F),m.b("templateSources.anonymousTemplate",m.C.ia)}(),function(){function _(U,B,W){var j;for(B=m.h.nextSibling(B);U&&(j=U)!==B;)U=m.h.nextSibling(j),W(j,U)}function S(U,B){if(U.length){var W=U[0],j=U[U.length-1],Q=W.parentNode,q=m.ga.instance,X=q.preprocessNode;if(X){if(_(W,j,function(Z,fe){var xe=Z.previousSibling,re=X.call(q,Z);re&&(Z===W&&(W=re[0]||fe),Z===j&&(j=re[re.length-1]||xe))}),U.length=0,!W)return;W===j?U.push(W):(U.push(W,j),m.a.Ua(U,Q))}_(W,j,function(Z){Z.nodeType!==1&&Z.nodeType!==8||m.vc(B,Z)}),_(W,j,function(Z){Z.nodeType!==1&&Z.nodeType!==8||m.aa.cd(Z,[B])}),m.a.Ua(U,Q)}}function w(U){return U.nodeType?U:0<U.length?U[0]:null}function I(U,B,W,j,Q){Q=Q||{};var q=(U&&w(U)||W||{}).ownerDocument,X=Q.templateEngine||k;if(m.kc.xd(W,X,q),W=X.renderTemplate(W,j,Q,q),typeof W.length!="number"||0<W.length&&typeof W[0].nodeType!="number")throw Error("Template engine must return an array of DOM nodes");switch(q=!1,B){case"replaceChildren":m.h.va(U,W),q=!0;break;case"replaceNode":m.a.Xc(U,W),q=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+B)}return q&&(S(W,j),Q.afterRender&&m.u.G(Q.afterRender,null,[W,j[Q.as||"$data"]]),B=="replaceChildren"&&m.i.ma(U,m.i.H)),W}function N(U,B,W){return m.O(U)?U():typeof U=="function"?U(B,W):U}var k;m.gc=function(U){if(U!=e&&!(U instanceof m.ca))throw Error("templateEngine must inherit from ko.templateEngine");k=U},m.dc=function(U,B,W,j,Q){if(W=W||{},(W.templateEngine||k)==e)throw Error("Set a template engine before calling renderTemplate");if(Q=Q||"replaceChildren",j){var q=w(j);return m.$(function(){var Z=B&&B instanceof m.fa?B:new m.fa(B,null,null,null,{exportDependencies:!0}),X=N(U,Z.$data,Z),Z=I(j,Q,X,Z,W);Q=="replaceNode"&&(j=Z,q=w(j))},null,{Sa:function(){return!q||!m.a.Sb(q)},l:q&&Q=="replaceNode"?q.parentNode:q})}return m.aa.Xb(function(X){m.dc(U,B,W,X,"replaceNode")})},m.Qd=function(U,B,W,j,Q){function q(ye,Se){m.u.G(m.a.ec,null,[j,ye,Z,W,X,Se]),m.i.ma(j,m.i.H)}function X(ye,Se){S(Se,fe),W.afterRender&&W.afterRender(Se,ye),fe=null}function Z(ye,Se){fe=Q.createChildContext(ye,{as:xe,noChildContext:W.noChildContext,extend:function(Fe){Fe.$index=Se,xe&&(Fe[xe+"Index"]=Se)}});var Te=N(U,ye,fe);return I(j,"ignoreTargetNode",Te,fe,W)}var fe,xe=W.as,re=W.includeDestroyed===!1||m.options.foreachHidesDestroyed&&!W.includeDestroyed;if(re||W.beforeRemove||!m.Pc(B))return m.$(function(){var ye=m.a.f(B)||[];typeof ye.length>"u"&&(ye=[ye]),re&&(ye=m.a.jb(ye,function(Se){return Se===e||Se===null||!m.a.f(Se._destroy)})),q(ye)},null,{l:j});q(B.v());var pe=B.subscribe(function(ye){q(B(),ye)},null,"arrayChange");return pe.l(j),pe};var z=m.a.g.Z(),V=m.a.g.Z();m.c.template={init:function(U,B){var W=m.a.f(B());if(typeof W=="string"||"name"in W)m.h.Ea(U);else if("nodes"in W){if(W=W.nodes||[],m.O(W))throw Error('The "nodes" option must be a plain, non-observable array.');var j=W[0]&&W[0].parentNode;j&&m.a.g.get(j,V)||(j=m.a.Yb(W),m.a.g.set(j,V,!0)),new m.C.ia(U).nodes(j)}else if(W=m.h.childNodes(U),0<W.length)j=m.a.Yb(W),new m.C.ia(U).nodes(j);else throw Error("Anonymous template defined, but no template content was provided");return{controlsDescendantBindings:!0}},update:function(U,B,W,j,Q){var q=B();B=m.a.f(q),W=!0,j=null,typeof B=="string"?B={}:(q="name"in B?B.name:U,"if"in B&&(W=m.a.f(B.if)),W&&"ifnot"in B&&(W=!m.a.f(B.ifnot)),W&&!q&&(W=!1)),"foreach"in B?j=m.Qd(q,W&&B.foreach||[],B,U,Q):W?(W=Q,"data"in B&&(W=Q.createChildContext(B.data,{as:B.as,noChildContext:B.noChildContext,exportDependencies:!0})),j=m.dc(q,W,B,U)):m.h.Ea(U),Q=j,(B=m.a.g.get(U,z))&&typeof B.s=="function"&&B.s(),m.a.g.set(U,z,!Q||Q.ja&&!Q.ja()?e:Q)}},m.m.Ra.template=function(U){return U=m.m.ac(U),U.length==1&&U[0].unknown||m.m.Id(U,"name")?null:"This template engine does not support anonymous templates nested within its templates"},m.h.ea.template=!0}(),m.b("setTemplateEngine",m.gc),m.b("renderTemplate",m.dc),m.a.Kc=function(_,S,w){if(_.length&&S.length){var I,N,k,z,V;for(I=N=0;(!w||I<w)&&(z=_[N]);++N){for(k=0;V=S[k];++k)if(z.value===V.value){z.moved=V.index,V.moved=z.index,S.splice(k,1),I=k=0;break}I+=k}}},m.a.Pb=function(){function _(S,w,I,N,k){var z=Math.min,V=Math.max,U=[],B,W=S.length,j,Q=w.length,q=Q-W||1,X=W+Q+1,Z,fe,xe;for(B=0;B<=W;B++)for(fe=Z,U.push(Z=[]),xe=z(Q,B+q),j=V(0,B-1);j<=xe;j++)Z[j]=j?B?S[B-1]===w[j-1]?fe[j-1]:z(fe[j]||X,Z[j-1]||X)+1:j+1:B+1;for(z=[],V=[],q=[],B=W,j=Q;B||j;)Q=U[B][j]-1,j&&Q===U[B][j-1]?V.push(z[z.length]={status:I,value:w[--j],index:j}):B&&Q===U[B-1][j]?q.push(z[z.length]={status:N,value:S[--B],index:B}):(--j,--B,k.sparse||z.push({status:"retained",value:w[j]}));return m.a.Kc(q,V,!k.dontLimitMoves&&10*W),z.reverse()}return function(S,w,I){return I=typeof I=="boolean"?{dontLimitMoves:I}:I||{},S=S||[],w=w||[],S.length<w.length?_(S,w,"added","deleted",I):_(w,S,"deleted","added",I)}}(),m.b("utils.compareArrays",m.a.Pb),function(){function _(I,N,k,z,V){var U=[],B=m.$(function(){var W=N(k,V,m.a.Ua(U,I))||[];0<U.length&&(m.a.Xc(U,W),z&&m.u.G(z,null,[k,W,V])),U.length=0,m.a.Nb(U,W)},null,{l:I,Sa:function(){return!m.a.kd(U)}});return{Y:U,$:B.ja()?B:e}}var S=m.a.g.Z(),w=m.a.g.Z();m.a.ec=function(I,N,k,z,V,U){function B(at){Te={Aa:at,pb:m.ta(fe++)},X.push(Te),q||Se.push(Te)}function W(at){Te=Q[at],fe!==Te.pb.v()&&ye.push(Te),Te.pb(fe++),m.a.Ua(Te.Y,I),X.push(Te)}function j(at,Kt){if(at)for(var Ce=0,Ae=Kt.length;Ce<Ae;Ce++)m.a.D(Kt[Ce].Y,function(nt){at(nt,Ce,Kt[Ce].Aa)})}N=N||[],typeof N.length>"u"&&(N=[N]),z=z||{};var Q=m.a.g.get(I,S),q=!Q,X=[],Z=0,fe=0,xe=[],re=[],pe=[],ye=[],Se=[],Te,Fe=0;if(q)m.a.D(N,B);else{if(!U||Q&&Q._countWaitingForRemove){var Ve=m.a.Mb(Q,function(at){return at.Aa});U=m.a.Pb(Ve,N,{dontLimitMoves:z.dontLimitMoves,sparse:!0})}for(var Ve=0,Ze,gt,lt;Ze=U[Ve];Ve++)switch(gt=Ze.moved,lt=Ze.index,Ze.status){case"deleted":for(;Z<lt;)W(Z++);gt===e&&(Te=Q[Z],Te.$&&(Te.$.s(),Te.$=e),m.a.Ua(Te.Y,I).length&&(z.beforeRemove&&(X.push(Te),Fe++,Te.Aa===w?Te=null:pe.push(Te)),Te&&xe.push.apply(xe,Te.Y))),Z++;break;case"added":for(;fe<lt;)W(Z++);gt!==e?(re.push(X.length),W(gt)):B(Ze.value)}for(;fe<N.length;)W(Z++);X._countWaitingForRemove=Fe}m.a.g.set(I,S,X),j(z.beforeMove,ye),m.a.D(xe,z.beforeRemove?m.oa:m.removeNode);var Oe,Mt,ut;try{ut=I.ownerDocument.activeElement}catch{}if(re.length)for(;(Ve=re.shift())!=e;){for(Te=X[Ve],Oe=e;Ve;)if((Mt=X[--Ve].Y)&&Mt.length){Oe=Mt[Mt.length-1];break}for(N=0;Z=Te.Y[N];Oe=Z,N++)m.h.Wb(I,Z,Oe)}for(Ve=0;Te=X[Ve];Ve++){for(Te.Y||m.a.extend(Te,_(I,k,Te.Aa,V,Te.pb)),N=0;Z=Te.Y[N];Oe=Z,N++)m.h.Wb(I,Z,Oe);!Te.Ed&&V&&(V(Te.Aa,Te.Y,Te.pb),Te.Ed=!0,Oe=Te.Y[Te.Y.length-1])}for(ut&&I.ownerDocument.activeElement!=ut&&ut.focus(),j(z.beforeRemove,pe),Ve=0;Ve<pe.length;++Ve)pe[Ve].Aa=w;j(z.afterMove,ye),j(z.afterAdd,Se)}}(),m.b("utils.setDomNodeChildrenFromArrayMapping",m.a.ec),m.ba=function(){this.allowTemplateRewriting=!1},m.ba.prototype=new m.ca,m.ba.prototype.constructor=m.ba,m.ba.prototype.renderTemplateSource=function(_,S,w,I){return(S=!(9>m.a.W)&&_.nodes?_.nodes():null)?m.a.la(S.cloneNode(!0).childNodes):(_=_.text(),m.a.ua(_,I))},m.ba.Ma=new m.ba,m.gc(m.ba.Ma),m.b("nativeTemplateEngine",m.ba),function(){m.$a=function(){var S=this.Hd=function(){if(!o||!o.tmpl)return 0;try{if(0<=o.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch{}return 1}();this.renderTemplateSource=function(w,I,N,k){if(k=k||n,N=N||{},2>S)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var z=w.data("precompiled");return z||(z=w.text()||"",z=o.template(null,"{{ko_with $item.koBindingContext}}"+z+"{{/ko_with}}"),w.data("precompiled",z)),w=[I.$data],I=o.extend({koBindingContext:I},N.templateOptions),I=o.tmpl(z,w,I),I.appendTo(k.createElement("div")),o.fragments={},I},this.createJavaScriptEvaluatorBlock=function(w){return"{{ko_code ((function() { return "+w+" })()) }}"},this.addTemplate=function(w,I){n.write("<script type='text/html' id='"+w+"'>"+I+"<\/script>")},0<S&&(o.tmpl.tag.ko_code={open:"__.push($1 || '');"},o.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},m.$a.prototype=new m.ca,m.$a.prototype.constructor=m.$a;var _=new m.$a;0<_.Hd&&m.gc(_),m.b("jqueryTmplTemplateEngine",m.$a)}()})})()})()})();var HEt=ko;typeof window<"u"?(ko=window.ko,typeof BI<"u"?window.ko=BI:delete window.ko):(ko=global.ko,typeof BI<"u"?global.ko=BI:delete global.ko);var vS=HEt;/**
 * @license
 * Knockout ES5 plugin - https://github.com/SteveSanderson/knockout-es5
 * Copyright (c) Steve Sanderson
 * MIT license
 */var t$="__knockoutObservables",n$="__knockoutSubscribable";function CEe(e,t){if(!e)throw new Error("When calling ko.track, you must pass an object as the first parameter.");var n=this,i=AEe(e,!0);return t=t||Object.getOwnPropertyNames(e),t.forEach(function(o){if(!(o===t$||o===n$)&&!(o in i)){var r=e[o],s=r instanceof Array,a=n.isObservable(r)?r:s?n.observableArray(r):n.observable(r);Object.defineProperty(e,o,{configurable:!0,enumerable:!0,get:a,set:n.isWriteableObservable(a)?a:void 0}),i[o]=a,s&&WEt(n,a)}}),e}function AEe(e,t){var n=e[t$];return!n&&t&&(n={},Object.defineProperty(e,t$,{value:n})),n}function GEt(e,t,n){var i=this,o={owner:e,deferEvaluation:!0};if(typeof n=="function")o.read=n;else{if("value"in n)throw new Error('For ko.defineProperty, you must not specify a "value" for the property. You must provide a "get" function.');if(typeof n.get!="function")throw new Error('For ko.defineProperty, the third parameter must be either an evaluator function, or an options object containing a function called "get".');o.read=n.get,o.write=n.set}return e[t]=i.computed(o),CEe.call(i,e,[t]),e}function WEt(e,t){var n=null;e.computed(function(){n&&(n.dispose(),n=null);var i=t();i instanceof Array&&(n=jEt(e,t,i))})}function jEt(e,t,n){var i=qEt(e,n);return i.subscribe(t)}function qEt(e,t){var n=t[n$];if(!n){n=new e.subscribable,Object.defineProperty(t,n$,{value:n});var i={};YEt(t,n,i),XEt(e,t,n,i)}return n}function YEt(e,t,n){["pop","push","reverse","shift","sort","splice","unshift"].forEach(function(i){var o=e[i];e[i]=function(){var r=o.apply(this,arguments);return n.pause!==!0&&t.notifySubscribers(this),r}})}function XEt(e,t,n,i){["remove","removeAll","destroy","destroyAll","replace"].forEach(function(o){Object.defineProperty(t,o,{enumerable:!1,value:function(){var r;i.pause=!0;try{r=e.observableArray.fn[o].apply(e.observableArray(t),arguments)}finally{i.pause=!1}return n.notifySubscribers(t),r}})})}function TEe(e,t){if(!e)return null;var n=AEe(e,!1);return n&&n[t]||null}function KEt(e,t){var n=TEe(e,t);n&&n.valueHasMutated()}function ZEt(e){e.track=CEe,e.getObservable=TEe,e.valueHasMutated=KEt,e.defineProperty=GEt}var uH={attachToKo:ZEt};var EEe="http://www.w3.org/2000/svg",SEe="cesium-svgPath-svg",$Et={register:function(e){e.bindingHandlers.cesiumSvgPath={init:function(t,n){let i=document.createElementNS(EEe,"svg:svg");i.setAttribute("class",SEe);let o=document.createElementNS(EEe,"path");return i.appendChild(o),e.virtualElements.setDomNodeChildren(t,[i]),e.computed({read:function(){let r=e.unwrap(n());o.setAttribute("d",e.unwrap(r.path));let s=e.unwrap(r.width),a=e.unwrap(r.height);i.setAttribute("width",s),i.setAttribute("height",a),i.setAttribute("viewBox",`0 0 ${s} ${a}`),r.css&&i.setAttribute("class",`${SEe} ${e.unwrap(r.css)}`)},disposeWhenNodeIsRemoved:t}),{controlsDescendantBindings:!0}}},e.virtualElements.allowedBindings.cesiumSvgPath=!0}},fH=$Et;uH.attachToKo(vS);fH.register(vS);var be=vS;function kI(e){u(e)||(e=new cm),this._clock=e,this._eventHelper=new Ar,this._eventHelper.add(e.onTick,this.synchronize,this),this.systemTime=be.observable($.now()),this.systemTime.equalityComparer=$.equals,this.startTime=be.observable(e.startTime),this.startTime.equalityComparer=$.equals,this.startTime.subscribe(function(t){e.startTime=t,this.synchronize()},this),this.stopTime=be.observable(e.stopTime),this.stopTime.equalityComparer=$.equals,this.stopTime.subscribe(function(t){e.stopTime=t,this.synchronize()},this),this.currentTime=be.observable(e.currentTime),this.currentTime.equalityComparer=$.equals,this.currentTime.subscribe(function(t){e.currentTime=t,this.synchronize()},this),this.multiplier=be.observable(e.multiplier),this.multiplier.subscribe(function(t){e.multiplier=t,this.synchronize()},this),this.clockStep=be.observable(e.clockStep),this.clockStep.subscribe(function(t){e.clockStep=t,this.synchronize()},this),this.clockRange=be.observable(e.clockRange),this.clockRange.subscribe(function(t){e.clockRange=t,this.synchronize()},this),this.canAnimate=be.observable(e.canAnimate),this.canAnimate.subscribe(function(t){e.canAnimate=t,this.synchronize()},this),this.shouldAnimate=be.observable(e.shouldAnimate),this.shouldAnimate.subscribe(function(t){e.shouldAnimate=t,this.synchronize()},this),be.track(this,["systemTime","startTime","stopTime","currentTime","multiplier","clockStep","clockRange","canAnimate","shouldAnimate"])}Object.defineProperties(kI.prototype,{clock:{get:function(){return this._clock}}});kI.prototype.synchronize=function(){let e=this._clock;this.systemTime=$.now(),this.startTime=e.startTime,this.stopTime=e.stopTime,this.currentTime=e.currentTime,this.multiplier=e.multiplier,this.clockStep=e.clockStep,this.clockRange=e.clockRange,this.canAnimate=e.canAnimate,this.shouldAnimate=e.shouldAnimate};kI.prototype.isDestroyed=function(){return!1};kI.prototype.destroy=function(){this._eventHelper.removeAll(),ue(this)};var dH=kI;function QEt(){this.canExecute=void 0,this.beforeExecute=void 0,this.afterExecute=void 0,he.throwInstantiationError()}var vEe=QEt;function JEt(e,t){t=x(t,!0);let n=new me,i=new me;function o(){let r={args:arguments,cancel:!1},s;return n.raiseEvent(r),r.cancel||(s=e.apply(null,arguments),i.raiseEvent(s)),s}return o.canExecute=t,be.track(o,["canExecute"]),Object.defineProperties(o,{beforeExecute:{value:n},afterExecute:{value:i}}),o}var vn=JEt;var VI={};VI.createCheckbox=function(e,t,n){let i=document.createElement("div"),o=document.createElement("label"),r=document.createElement("input");r.type="checkbox";let s=`checked: ${t}`;return u(n)&&(s+=`, enable: ${n}`),r.setAttribute("data-bind",s),o.appendChild(r),o.appendChild(document.createTextNode(e)),i.appendChild(o),i};VI.createSection=function(e,t,n,i){let o=document.createElement("div");o.className="cesium-cesiumInspector-section",o.setAttribute("data-bind",`css: { "cesium-cesiumInspector-section-collapsed": !${n} }`),e.appendChild(o);let r=document.createElement("h3");r.className="cesium-cesiumInspector-sectionHeader",r.appendChild(document.createTextNode(t)),r.setAttribute("data-bind",`click: ${i}`),o.appendChild(r);let s=document.createElement("div");return s.className="cesium-cesiumInspector-sectionContent",o.appendChild(s),s};VI.createRangeInput=function(e,t,n,i,o,r){r=x(r,t);let s=document.createElement("input");s.setAttribute("data-bind",`value: ${r}`),s.type="number";let a=document.createElement("input");a.type="range",a.min=n,a.max=i,a.step=x(o,"any"),a.setAttribute("data-bind",`valueUpdate: "input", value: ${t}`);let c=document.createElement("div");c.appendChild(a);let l=document.createElement("div");return l.className="cesium-cesiumInspector-slider",l.appendChild(document.createTextNode(e)),l.appendChild(s),l.appendChild(c),l};VI.createButton=function(e,t,n){let i=document.createElement("button");i.type="button",i.textContent=e,i.className="cesium-cesiumInspector-pickButton";let o=`click: ${t}`;return u(n)&&(o+=`, css: {"cesium-cesiumInspector-pickButtonHighlight" : ${n}}`),i.setAttribute("data-bind",o),i};var gc=VI;function eSt(e,t,n,i,o){return n.call(i,e[t]),be.getObservable(e,t).subscribe(n,i,o)}var Ba=eSt;function wEe(e,t){this._command=e,t=x(t,x.EMPTY_OBJECT),this.toggled=x(t.toggled,!1),this.tooltip=x(t.tooltip,""),be.track(this,["toggled","tooltip"])}Object.defineProperties(wEe.prototype,{command:{get:function(){return this._command}}});var jb=wEe;var qb="http://www.w3.org/2000/svg",PEe="http://www.w3.org/1999/xlink",hH,UI=G.fromCssColorString("rgba(247,250,255,0.384)"),mH=G.fromCssColorString("rgba(143,191,255,0.216)"),i$=G.fromCssColorString("rgba(153,197,255,0.098)"),pH=G.fromCssColorString("rgba(255,255,255,0.086)"),tSt=G.fromCssColorString("rgba(255,255,255,0.267)"),nSt=G.fromCssColorString("rgba(255,255,255,0)"),DEe=G.fromCssColorString("rgba(66,67,68,0.3)"),IEe=G.fromCssColorString("rgba(0,0,0,0.5)");function py(e){return G.fromCssColorString(window.getComputedStyle(e).getPropertyValue("color"))}var zI={animation_pathReset:{tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M24.316,5.318,9.833,13.682,9.833,5.5,5.5,5.5,5.5,25.5,9.833,25.5,9.833,17.318,24.316,25.682z"},animation_pathPause:{tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M13,5.5,7.5,5.5,7.5,25.5,13,25.5zM24.5,5.5,19,5.5,19,25.5,24.5,25.5z"},animation_pathPlay:{tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M6.684,25.682L24.316,15.5L6.684,5.318V25.682z"},animation_pathPlayReverse:{tagName:"path",transform:"translate(16,16) scale(-0.85,0.85) translate(-16,-16)",d:"M6.684,25.682L24.316,15.5L6.684,5.318V25.682z"},animation_pathLoop:{tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M24.249,15.499c-0.009,4.832-3.918,8.741-8.75,8.75c-2.515,0-4.768-1.064-6.365-2.763l2.068-1.442l-7.901-3.703l0.744,8.694l2.193-1.529c2.244,2.594,5.562,4.242,9.26,4.242c6.767,0,12.249-5.482,12.249-12.249H24.249zM15.499,6.75c2.516,0,4.769,1.065,6.367,2.764l-2.068,1.443l7.901,3.701l-0.746-8.693l-2.192,1.529c-2.245-2.594-5.562-4.245-9.262-4.245C8.734,3.25,3.25,8.734,3.249,15.499H6.75C6.758,10.668,10.668,6.758,15.499,6.75z"},animation_pathClock:{tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-15.5)",d:"M15.5,2.374C8.251,2.375,2.376,8.251,2.374,15.5C2.376,22.748,8.251,28.623,15.5,28.627c7.249-0.004,13.124-5.879,13.125-13.127C28.624,8.251,22.749,2.375,15.5,2.374zM15.5,25.623C9.909,25.615,5.385,21.09,5.375,15.5C5.385,9.909,9.909,5.384,15.5,5.374c5.59,0.01,10.115,4.535,10.124,10.125C25.615,21.09,21.091,25.615,15.5,25.623zM8.625,15.5c-0.001-0.552-0.448-0.999-1.001-1c-0.553,0-1,0.448-1,1c0,0.553,0.449,1,1,1C8.176,16.5,8.624,16.053,8.625,15.5zM8.179,18.572c-0.478,0.277-0.642,0.889-0.365,1.367c0.275,0.479,0.889,0.641,1.365,0.365c0.479-0.275,0.643-0.887,0.367-1.367C9.27,18.461,8.658,18.297,8.179,18.572zM9.18,10.696c-0.479-0.276-1.09-0.112-1.366,0.366s-0.111,1.09,0.365,1.366c0.479,0.276,1.09,0.113,1.367-0.366C9.821,11.584,9.657,10.973,9.18,10.696zM22.822,12.428c0.478-0.275,0.643-0.888,0.366-1.366c-0.275-0.478-0.89-0.642-1.366-0.366c-0.479,0.278-0.642,0.89-0.366,1.367C21.732,12.54,22.344,12.705,22.822,12.428zM12.062,21.455c-0.478-0.275-1.089-0.111-1.366,0.367c-0.275,0.479-0.111,1.09,0.366,1.365c0.478,0.277,1.091,0.111,1.365-0.365C12.704,22.344,12.54,21.732,12.062,21.455zM12.062,9.545c0.479-0.276,0.642-0.888,0.366-1.366c-0.276-0.478-0.888-0.642-1.366-0.366s-0.642,0.888-0.366,1.366C10.973,9.658,11.584,9.822,12.062,9.545zM22.823,18.572c-0.48-0.275-1.092-0.111-1.367,0.365c-0.275,0.479-0.112,1.092,0.367,1.367c0.477,0.275,1.089,0.113,1.365-0.365C23.464,19.461,23.3,18.848,22.823,18.572zM19.938,7.813c-0.477-0.276-1.091-0.111-1.365,0.366c-0.275,0.48-0.111,1.091,0.366,1.367s1.089,0.112,1.366-0.366C20.581,8.702,20.418,8.089,19.938,7.813zM23.378,14.5c-0.554,0.002-1.001,0.45-1.001,1c0.001,0.552,0.448,1,1.001,1c0.551,0,1-0.447,1-1C24.378,14.949,23.929,14.5,23.378,14.5zM15.501,6.624c-0.552,0-1,0.448-1,1l-0.466,7.343l-3.004,1.96c-0.478,0.277-0.642,0.889-0.365,1.365c0.275,0.479,0.889,0.643,1.365,0.367l3.305-1.676C15.39,16.99,15.444,17,15.501,17c0.828,0,1.5-0.671,1.5-1.5l-0.5-7.876C16.501,7.072,16.053,6.624,15.501,6.624zM15.501,22.377c-0.552,0-1,0.447-1,1s0.448,1,1,1s1-0.447,1-1S16.053,22.377,15.501,22.377zM18.939,21.455c-0.479,0.277-0.643,0.889-0.366,1.367c0.275,0.477,0.888,0.643,1.366,0.365c0.478-0.275,0.642-0.889,0.366-1.365C20.028,21.344,19.417,21.18,18.939,21.455z"},animation_pathWingButton:{tagName:"path",d:"m 4.5,0.5 c -2.216,0 -4,1.784 -4,4 l 0,24 c 0,2.216 1.784,4 4,4 l 13.71875,0 C 22.478584,27.272785 27.273681,22.511272 32.5,18.25 l 0,-13.75 c 0,-2.216 -1.784,-4 -4,-4 l -24,0 z"},animation_pathPointer:{tagName:"path",d:"M-15,-65,-15,-55,15,-55,15,-65,0,-95z"},animation_pathSwooshFX:{tagName:"path",d:"m 85,0 c 0,16.617 -4.813944,35.356 -13.131081,48.4508 h 6.099803 c 8.317138,-13.0948 13.13322,-28.5955 13.13322,-45.2124 0,-46.94483 -38.402714,-85.00262 -85.7743869,-85.00262 -1.0218522,0 -2.0373001,0.0241 -3.0506131,0.0589 45.958443,1.59437 82.723058,35.77285 82.723058,81.70532 z"}};function ph(e){let t=document.createElementNS(qb,e.tagName);for(let n in e)if(e.hasOwnProperty(n)&&n!=="tagName")if(n==="children"){let i=e.children.length;for(let o=0;o<i;++o)t.appendChild(ph(e.children[o]))}else n.indexOf("xlink:")===0?t.setAttributeNS(PEe,n.substring(6),e[n]):n==="textContent"?t.textContent=e[n]:t.setAttribute(n,e[n]);return t}function o$(e,t,n){let i=document.createElementNS(qb,"text");i.setAttribute("x",e),i.setAttribute("y",t),i.setAttribute("class","cesium-animation-svgText");let o=document.createElementNS(qb,"tspan");return o.textContent=n,i.appendChild(o),i}function iSt(e,t,n){e.setAttribute("transform",`translate(100,100) rotate(${n})`),t.setAttribute("transform",`rotate(${n})`)}var _H=new G;function es(e,t){let n=t.alpha,i=1-n;return _H.red=e.red*i+t.red*n,_H.green=e.green*i+t.green*n,_H.blue=e.blue*i+t.blue*n,_H.toCssColorString()}function r$(e,t,n){let i=zI[n],o={tagName:"g",class:"cesium-animation-rectButton",transform:`translate(${e},${t})`,children:[{tagName:"rect",class:"cesium-animation-buttonGlow",width:32,height:32,rx:2,ry:2},{tagName:"rect",class:"cesium-animation-buttonMain",width:32,height:32,rx:4,ry:4},{class:"cesium-animation-buttonPath",id:n,tagName:i.tagName,transform:i.transform,d:i.d},{tagName:"title",textContent:""}]};return ph(o)}function oSt(e,t,n){let i=zI[n],o=zI.animation_pathWingButton,r={tagName:"g",class:"cesium-animation-rectButton",transform:`translate(${e},${t})`,children:[{class:"cesium-animation-buttonGlow",id:"animation_pathWingButton",tagName:o.tagName,d:o.d},{class:"cesium-animation-buttonMain",id:"animation_pathWingButton",tagName:o.tagName,d:o.d},{class:"cesium-animation-buttonPath",id:n,tagName:i.tagName,transform:i.transform,d:i.d},{tagName:"title",textContent:""}]};return ph(r)}function rSt(e,t){let n=e._viewModel,i=n.shuttleRingDragging;if(!(i&&hH!==e))if(t.type==="mousedown"||i&&t.type==="mousemove"||t.type==="touchstart"&&t.touches.length===1||i&&t.type==="touchmove"&&t.touches.length===1){let o=e._centerX,r=e._centerY,a=e._svgNode.getBoundingClientRect(),c,l;if(t.type==="touchstart"||t.type==="touchmove"?(c=t.touches[0].clientX,l=t.touches[0].clientY):(c=t.clientX,l=t.clientY),!i&&(c>a.right||c<a.left||l<a.top||l>a.bottom))return;let f=e._shuttleRingPointer.getBoundingClientRect(),d=c-o-a.left,p=l-r-a.top,g=Math.atan2(p,d)*180/Math.PI+90;g>180&&(g-=360);let m=n.shuttleRingAngle;i||c<f.right&&c>f.left&&l>f.top&&l<f.bottom?(hH=e,n.shuttleRingDragging=!0,n.shuttleRingAngle=g):g<m?n.slower():g>m&&n.faster(),t.preventDefault()}else e===hH&&(hH=void 0),n.shuttleRingDragging=!1}function D_(e,t){this._viewModel=t,this.svgElement=e,this._enabled=void 0,this._toggled=void 0;let n=this;this._clickFunction=function(){let i=n._viewModel.command;i.canExecute&&i()},e.addEventListener("click",this._clickFunction,!0),this._subscriptions=[Ba(t,"toggled",this.setToggled,this),Ba(t,"tooltip",this.setTooltip,this),Ba(t.command,"canExecute",this.setEnabled,this)]}D_.prototype.destroy=function(){this.svgElement.removeEventListener("click",this._clickFunction,!0);let e=this._subscriptions;for(let t=0,n=e.length;t<n;t++)e[t].dispose();ue(this)};D_.prototype.isDestroyed=function(){return!1};D_.prototype.setEnabled=function(e){if(this._enabled!==e){if(this._enabled=e,!e){this.svgElement.setAttribute("class","cesium-animation-buttonDisabled");return}if(this._toggled){this.svgElement.setAttribute("class","cesium-animation-rectButton cesium-animation-buttonToggled");return}this.svgElement.setAttribute("class","cesium-animation-rectButton")}};D_.prototype.setToggled=function(e){this._toggled!==e&&(this._toggled=e,this._enabled&&(e?this.svgElement.setAttribute("class","cesium-animation-rectButton cesium-animation-buttonToggled"):this.svgElement.setAttribute("class","cesium-animation-rectButton")))};D_.prototype.setTooltip=function(e){this.svgElement.getElementsByTagName("title")[0].textContent=e};function wS(e,t){e=Rn(e),this._viewModel=t,this._container=e,this._centerX=0,this._centerY=0,this._defsElement=void 0,this._svgNode=void 0,this._topG=void 0,this._lastHeight=void 0,this._lastWidth=void 0;let n=e.ownerDocument,i=document.createElement("style");i.textContent=".cesium-animation-rectButton .cesium-animation-buttonGlow { filter: url(#animation_blurred); }.cesium-animation-rectButton .cesium-animation-buttonMain { fill: url(#animation_buttonNormal); }.cesium-animation-buttonToggled .cesium-animation-buttonMain { fill: url(#animation_buttonToggled); }.cesium-animation-rectButton:hover .cesium-animation-buttonMain { fill: url(#animation_buttonHovered); }.cesium-animation-buttonDisabled .cesium-animation-buttonMain { fill: url(#animation_buttonDisabled); }.cesium-animation-shuttleRingG .cesium-animation-shuttleRingSwoosh { fill: url(#animation_shuttleRingSwooshGradient); }.cesium-animation-shuttleRingG:hover .cesium-animation-shuttleRingSwoosh { fill: url(#animation_shuttleRingSwooshHovered); }.cesium-animation-shuttleRingPointer { fill: url(#animation_shuttleRingPointerGradient); }.cesium-animation-shuttleRingPausePointer { fill: url(#animation_shuttleRingPointerPaused); }.cesium-animation-knobOuter { fill: url(#animation_knobOuter); }.cesium-animation-knobInner { fill: url(#animation_knobInner); }",n.head.insertBefore(i,n.head.childNodes[0]);let o=document.createElement("div");o.className="cesium-animation-theme",o.innerHTML='<div class="cesium-animation-themeNormal"></div><div class="cesium-animation-themeHover"></div><div class="cesium-animation-themeSelect"></div><div class="cesium-animation-themeDisabled"></div><div class="cesium-animation-themeKnob"></div><div class="cesium-animation-themePointer"></div><div class="cesium-animation-themeSwoosh"></div><div class="cesium-animation-themeSwooshHover"></div>',this._theme=o,this._themeNormal=o.childNodes[0],this._themeHover=o.childNodes[1],this._themeSelect=o.childNodes[2],this._themeDisabled=o.childNodes[3],this._themeKnob=o.childNodes[4],this._themePointer=o.childNodes[5],this._themeSwoosh=o.childNodes[6],this._themeSwooshHover=o.childNodes[7];let r=document.createElementNS(qb,"svg:svg");this._svgNode=r,r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink",PEe);let s=document.createElementNS(qb,"g");this._topG=s,this._realtimeSVG=new D_(oSt(3,4,"animation_pathClock"),t.playRealtimeViewModel),this._playReverseSVG=new D_(r$(44,99,"animation_pathPlayReverse"),t.playReverseViewModel),this._playForwardSVG=new D_(r$(124,99,"animation_pathPlay"),t.playForwardViewModel),this._pauseSVG=new D_(r$(84,99,"animation_pathPause"),t.pauseViewModel);let a=document.createElementNS(qb,"g");a.appendChild(this._realtimeSVG.svgElement),a.appendChild(this._playReverseSVG.svgElement),a.appendChild(this._playForwardSVG.svgElement),a.appendChild(this._pauseSVG.svgElement);let c=ph({tagName:"circle",class:"cesium-animation-shuttleRingBack",cx:100,cy:100,r:99});this._shuttleRingBackPanel=c;let l=zI.animation_pathSwooshFX,f=zI.animation_pathPointer,d=ph({tagName:"g",class:"cesium-animation-shuttleRingSwoosh",children:[{tagName:l.tagName,transform:"translate(100,97) scale(-1,1)",id:"animation_pathSwooshFX",d:l.d},{tagName:l.tagName,transform:"translate(100,97)",id:"animation_pathSwooshFX",d:l.d},{tagName:"line",x1:100,y1:8,x2:100,y2:22}]});this._shuttleRingSwooshG=d,this._shuttleRingPointer=ph({class:"cesium-animation-shuttleRingPointer",id:"animation_pathPointer",tagName:f.tagName,d:f.d});let p=ph({tagName:"g",transform:"translate(100,100)"});this._knobOuter=ph({tagName:"circle",class:"cesium-animation-knobOuter",cx:0,cy:0,r:71});let g=61,m=ph({tagName:"circle",class:"cesium-animation-knobInner",cx:0,cy:0,r:g});this._knobDate=o$(0,-24,""),this._knobTime=o$(0,-7,""),this._knobStatus=o$(0,-41,"");let y=ph({tagName:"circle",class:"cesium-animation-blank",cx:0,cy:0,r:g}),b=document.createElementNS(qb,"g");b.setAttribute("class","cesium-animation-shuttleRingG"),e.appendChild(o),s.appendChild(b),s.appendChild(p),s.appendChild(a),b.appendChild(c),b.appendChild(d),b.appendChild(this._shuttleRingPointer),p.appendChild(this._knobOuter),p.appendChild(m),p.appendChild(this._knobDate),p.appendChild(this._knobTime),p.appendChild(this._knobStatus),p.appendChild(y),r.appendChild(s),e.appendChild(r);let C=this;function A(O){rSt(C,O)}this._mouseCallback=A,c.addEventListener("mousedown",A,!0),c.addEventListener("touchstart",A,!0),d.addEventListener("mousedown",A,!0),d.addEventListener("touchstart",A,!0),n.addEventListener("mousemove",A,!0),n.addEventListener("touchmove",A,!0),n.addEventListener("mouseup",A,!0),n.addEventListener("touchend",A,!0),n.addEventListener("touchcancel",A,!0),this._shuttleRingPointer.addEventListener("mousedown",A,!0),this._shuttleRingPointer.addEventListener("touchstart",A,!0),this._knobOuter.addEventListener("mousedown",A,!0),this._knobOuter.addEventListener("touchstart",A,!0);let T=this._knobTime.childNodes[0],E=this._knobDate.childNodes[0],v=this._knobStatus.childNodes[0],D;this._subscriptions=[Ba(t.pauseViewModel,"toggled",function(O){D!==O&&(D=O,D?C._shuttleRingPointer.setAttribute("class","cesium-animation-shuttleRingPausePointer"):C._shuttleRingPointer.setAttribute("class","cesium-animation-shuttleRingPointer"))}),Ba(t,"shuttleRingAngle",function(O){iSt(C._shuttleRingPointer,C._knobOuter,O)}),Ba(t,"dateLabel",function(O){E.textContent!==O&&(E.textContent=O)}),Ba(t,"timeLabel",function(O){T.textContent!==O&&(T.textContent=O)}),Ba(t,"multiplierLabel",function(O){v.textContent!==O&&(v.textContent=O)})],this.applyThemeChanges(),this.resize()}Object.defineProperties(wS.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});wS.prototype.isDestroyed=function(){return!1};wS.prototype.destroy=function(){u(this._observer)&&(this._observer.disconnect(),this._observer=void 0);let e=this._container.ownerDocument,t=this._mouseCallback;this._shuttleRingBackPanel.removeEventListener("mousedown",t,!0),this._shuttleRingBackPanel.removeEventListener("touchstart",t,!0),this._shuttleRingSwooshG.removeEventListener("mousedown",t,!0),this._shuttleRingSwooshG.removeEventListener("touchstart",t,!0),e.removeEventListener("mousemove",t,!0),e.removeEventListener("touchmove",t,!0),e.removeEventListener("mouseup",t,!0),e.removeEventListener("touchend",t,!0),e.removeEventListener("touchcancel",t,!0),this._shuttleRingPointer.removeEventListener("mousedown",t,!0),this._shuttleRingPointer.removeEventListener("touchstart",t,!0),this._knobOuter.removeEventListener("mousedown",t,!0),this._knobOuter.removeEventListener("touchstart",t,!0),this._container.removeChild(this._svgNode),this._container.removeChild(this._theme),this._realtimeSVG.destroy(),this._playReverseSVG.destroy(),this._playForwardSVG.destroy(),this._pauseSVG.destroy();let n=this._subscriptions;for(let i=0,o=n.length;i<o;i++)n[i].dispose();return ue(this)};wS.prototype.resize=function(){let e=this._container.clientWidth,t=this._container.clientHeight;if(e===this._lastWidth&&t===this._lastHeight)return;let n=this._svgNode,i=200,o=132,r=e,s=t;e===0&&t===0?(r=i,s=o):e===0?(s=t,r=i*(t/o)):t===0&&(r=e,s=o*(e/i));let a=r/i,c=s/o;n.style.cssText=`width: ${r}px; height: ${s}px; position: absolute; bottom: 0; left: 0; overflow: hidden;`,n.setAttribute("width",r),n.setAttribute("height",s),n.setAttribute("viewBox",`0 0 ${r} ${s}`),this._topG.setAttribute("transform",`scale(${a},${c})`),this._centerX=Math.max(1,100*a),this._centerY=Math.max(1,100*c),this._lastHeight=e,this._lastWidth=t};wS.prototype.applyThemeChanges=function(){let e=this._container.ownerDocument;if(!e.body.contains(this._container)){if(u(this._observer))return;let f=this;f._observer=new MutationObserver(function(){e.body.contains(f._container)&&(f._observer.disconnect(),f._observer=void 0,f.applyThemeChanges())}),f._observer.observe(e,{childList:!0,subtree:!0});return}let t=py(this._themeNormal),n=py(this._themeHover),i=py(this._themeSelect),o=py(this._themeDisabled),r=py(this._themeKnob),s=py(this._themePointer),a=py(this._themeSwoosh),c=py(this._themeSwooshHover),l=ph({tagName:"defs",children:[{id:"animation_buttonNormal",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":es(t,UI)},{tagName:"stop",offset:"12%","stop-color":es(t,mH)},{tagName:"stop",offset:"46%","stop-color":es(t,i$)},{tagName:"stop",offset:"81%","stop-color":es(t,pH)}]},{id:"animation_buttonHovered",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":es(n,UI)},{tagName:"stop",offset:"12%","stop-color":es(n,mH)},{tagName:"stop",offset:"46%","stop-color":es(n,i$)},{tagName:"stop",offset:"81%","stop-color":es(n,pH)}]},{id:"animation_buttonToggled",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":es(i,UI)},{tagName:"stop",offset:"12%","stop-color":es(i,mH)},{tagName:"stop",offset:"46%","stop-color":es(i,i$)},{tagName:"stop",offset:"81%","stop-color":es(i,pH)}]},{id:"animation_buttonDisabled",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":es(o,tSt)},{tagName:"stop",offset:"75%","stop-color":es(o,nSt)}]},{id:"animation_blurred",tagName:"filter",width:"200%",height:"200%",x:"-50%",y:"-50%",children:[{tagName:"feGaussianBlur",stdDeviation:4,in:"SourceGraphic"}]},{id:"animation_shuttleRingSwooshGradient",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-opacity":.2,"stop-color":a.toCssColorString()},{tagName:"stop",offset:"85%","stop-opacity":.85,"stop-color":a.toCssColorString()},{tagName:"stop",offset:"95%","stop-opacity":.05,"stop-color":a.toCssColorString()}]},{id:"animation_shuttleRingSwooshHovered",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-opacity":.2,"stop-color":c.toCssColorString()},{tagName:"stop",offset:"85%","stop-opacity":.85,"stop-color":c.toCssColorString()},{tagName:"stop",offset:"95%","stop-opacity":.05,"stop-color":c.toCssColorString()}]},{id:"animation_shuttleRingPointerGradient",tagName:"linearGradient",x1:"0%",y1:"50%",x2:"100%",y2:"50%",children:[{tagName:"stop",offset:"0%","stop-color":s.toCssColorString()},{tagName:"stop",offset:"40%","stop-color":s.toCssColorString()},{tagName:"stop",offset:"60%","stop-color":es(s,IEe)},{tagName:"stop",offset:"100%","stop-color":es(s,IEe)}]},{id:"animation_shuttleRingPointerPaused",tagName:"linearGradient",x1:"0%",y1:"50%",x2:"100%",y2:"50%",children:[{tagName:"stop",offset:"0%","stop-color":"#CCC"},{tagName:"stop",offset:"40%","stop-color":"#CCC"},{tagName:"stop",offset:"60%","stop-color":"#555"},{tagName:"stop",offset:"100%","stop-color":"#555"}]},{id:"animation_knobOuter",tagName:"linearGradient",x1:"20%",y1:"0%",x2:"90%",y2:"100%",children:[{tagName:"stop",offset:"5%","stop-color":es(r,UI)},{tagName:"stop",offset:"60%","stop-color":es(r,DEe)},{tagName:"stop",offset:"85%","stop-color":es(r,mH)}]},{id:"animation_knobInner",tagName:"linearGradient",x1:"20%",y1:"0%",x2:"90%",y2:"100%",children:[{tagName:"stop",offset:"5%","stop-color":es(r,DEe)},{tagName:"stop",offset:"60%","stop-color":es(r,UI)},{tagName:"stop",offset:"85%","stop-color":es(r,pH)}]}]});u(this._defsElement)?this._svgNode.replaceChild(l,this._defsElement):this._svgNode.appendChild(l),this._defsElement=l};var gH=wS;var sSt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],_y=15,DS=105;function REe(e,t){return e-t}function s$(e,t){let n=No(t,e,REe);return n<0?~n:n}function aSt(e,t){if(Math.abs(e)<=_y)return e/_y;let n=_y,i=DS,o,r=0,s;return e>0?(o=Math.log(t[t.length-1]),s=(o-r)/(i-n),Math.exp(r+s*(e-n))):(o=Math.log(-t[0]),s=(o-r)/(i-n),-Math.exp(r+s*(Math.abs(e)-n)))}function cSt(e,t,n){if(n.clockStep===Ao.SYSTEM_CLOCK)return _y;if(Math.abs(e)<=1)return e*_y;let i=t[t.length-1];e>i?e=i:e<-i&&(e=-i);let o=_y,r=DS,s,a=0,c;return e>0?(s=Math.log(i),c=(s-a)/(r-o),(Math.log(e)-a)/c+o):(s=Math.log(-t[0]),c=(s-a)/(r-o),-((Math.log(Math.abs(e))-a)/c+o))}function td(e){let t=this;this._clockViewModel=e,this._allShuttleRingTicks=[],this._dateFormatter=td.defaultDateFormatter,this._timeFormatter=td.defaultTimeFormatter,this.shuttleRingDragging=!1,this.snapToTicks=!1,be.track(this,["_allShuttleRingTicks","_dateFormatter","_timeFormatter","shuttleRingDragging","snapToTicks"]),this._sortedFilteredPositiveTicks=[],this.setShuttleRingTicks(td.defaultTicks),this.timeLabel=void 0,be.defineProperty(this,"timeLabel",function(){return t._timeFormatter(t._clockViewModel.currentTime,t)}),this.dateLabel=void 0,be.defineProperty(this,"dateLabel",function(){return t._dateFormatter(t._clockViewModel.currentTime,t)}),this.multiplierLabel=void 0,be.defineProperty(this,"multiplierLabel",function(){let s=t._clockViewModel;if(s.clockStep===Ao.SYSTEM_CLOCK)return"Today";let a=s.multiplier;return a%1===0?`${a.toFixed(0)}x`:`${a.toFixed(3).replace(/0{0,3}$/,"")}x`}),this.shuttleRingAngle=void 0,be.defineProperty(this,"shuttleRingAngle",{get:function(){return cSt(e.multiplier,t._allShuttleRingTicks,e)},set:function(s){s=Math.max(Math.min(s,DS),-DS);let a=t._allShuttleRingTicks,c=t._clockViewModel;if(c.clockStep=Ao.SYSTEM_CLOCK_MULTIPLIER,Math.abs(s)===DS){c.multiplier=s>0?a[a.length-1]:a[0];return}let l=aSt(s,a);if(t.snapToTicks)l=a[s$(l,a)];else if(l!==0){let f=Math.abs(l);if(f>100){let d=f.toFixed(0).length-2,p=Math.pow(10,d);l=Math.round(l/p)*p|0}else f>_y?l=Math.round(l):f>1?l=+l.toFixed(1):f>0&&(l=+l.toFixed(2))}c.multiplier=l}}),this._canAnimate=void 0,be.defineProperty(this,"_canAnimate",function(){let s=t._clockViewModel,a=s.clockRange;if(t.shuttleRingDragging||a===Zr.UNBOUNDED)return!0;let c=s.multiplier,l=s.currentTime,f=s.startTime,d=!1;if(a===Zr.LOOP_STOP)d=$.greaterThan(l,f)||l.equals(f)&&c>0;else{let p=s.stopTime;d=$.greaterThan(l,f)&&$.lessThan(l,p)||l.equals(f)&&c>0||l.equals(p)&&c<0}return d||(s.shouldAnimate=!1),d}),this._isSystemTimeAvailable=void 0,be.defineProperty(this,"_isSystemTimeAvailable",function(){let s=t._clockViewModel;if(s.clockRange===Zr.UNBOUNDED)return!0;let c=s.systemTime;return $.greaterThanOrEquals(c,s.startTime)&&$.lessThanOrEquals(c,s.stopTime)}),this._isAnimating=void 0,be.defineProperty(this,"_isAnimating",function(){return t._clockViewModel.shouldAnimate&&(t._canAnimate||t.shuttleRingDragging)});let n=vn(function(){let s=t._clockViewModel;s.shouldAnimate?s.shouldAnimate=!1:t._canAnimate&&(s.shouldAnimate=!0)});this._pauseViewModel=new jb(n,{toggled:be.computed(function(){return!t._isAnimating}),tooltip:"Pause"});let i=vn(function(){let s=t._clockViewModel,a=s.multiplier;a>0&&(s.multiplier=-a),s.shouldAnimate=!0});this._playReverseViewModel=new jb(i,{toggled:be.computed(function(){return t._isAnimating&&e.multiplier<0}),tooltip:"Play Reverse"});let o=vn(function(){let s=t._clockViewModel,a=s.multiplier;a<0&&(s.multiplier=-a),s.shouldAnimate=!0});this._playForwardViewModel=new jb(o,{toggled:be.computed(function(){return t._isAnimating&&e.multiplier>0&&e.clockStep!==Ao.SYSTEM_CLOCK}),tooltip:"Play Forward"});let r=vn(function(){t._clockViewModel.clockStep=Ao.SYSTEM_CLOCK},be.getObservable(this,"_isSystemTimeAvailable"));this._playRealtimeViewModel=new jb(r,{toggled:be.computed(function(){return e.clockStep===Ao.SYSTEM_CLOCK}),tooltip:be.computed(function(){return t._isSystemTimeAvailable?"Today (real-time)":"Current time not in range"})}),this._slower=vn(function(){let s=t._clockViewModel,a=t._allShuttleRingTicks,c=s.multiplier,l=s$(c,a)-1;l>=0&&(s.multiplier=a[l])}),this._faster=vn(function(){let s=t._clockViewModel,a=t._allShuttleRingTicks,c=s.multiplier,l=s$(c,a)+1;l<a.length&&(s.multiplier=a[l])})}td.defaultDateFormatter=function(e,t){let n=$.toGregorianDate(e);return`${sSt[n.month-1]} ${n.day} ${n.year}`};td.defaultTicks=[.001,.002,.005,.01,.02,.05,.1,.25,.5,1,2,5,10,15,30,60,120,300,600,900,1800,3600,7200,14400,21600,43200,86400,172800,345600,604800];td.defaultTimeFormatter=function(e,t){let n=$.toGregorianDate(e),i=Math.round(n.millisecond);return Math.abs(t._clockViewModel.multiplier)<1?`${n.hour.toString().padStart(2,"0")}:${n.minute.toString().padStart(2,"0")}:${n.second.toString().padStart(2,"0")}.${i.toString().padStart(3,"0")}`:`${n.hour.toString().padStart(2,"0")}:${n.minute.toString().padStart(2,"0")}:${n.second.toString().padStart(2,"0")} UTC`};td.prototype.getShuttleRingTicks=function(){return this._sortedFilteredPositiveTicks.slice(0)};td.prototype.setShuttleRingTicks=function(e){let t,n,i,o={},r=this._sortedFilteredPositiveTicks;for(r.length=0,t=0,n=e.length;t<n;++t)i=e[t],o.hasOwnProperty(i)||(o[i]=!0,r.push(i));r.sort(REe);let s=[];for(n=r.length,t=n-1;t>=0;--t)i=r[t],i!==0&&s.push(-i);Array.prototype.push.apply(s,r),this._allShuttleRingTicks=s};Object.defineProperties(td.prototype,{slower:{get:function(){return this._slower}},faster:{get:function(){return this._faster}},clockViewModel:{get:function(){return this._clockViewModel}},pauseViewModel:{get:function(){return this._pauseViewModel}},playReverseViewModel:{get:function(){return this._playReverseViewModel}},playForwardViewModel:{get:function(){return this._playForwardViewModel}},playRealtimeViewModel:{get:function(){return this._playRealtimeViewModel}},dateFormatter:{get:function(){return this._dateFormatter},set:function(e){this._dateFormatter=e}},timeFormatter:{get:function(){return this._timeFormatter},set:function(e){this._timeFormatter=e}}});td._maxShuttleRingAngle=DS;td._realtimeShuttleRingAngle=_y;var yH=td;function lSt(e){return function(t){let n=e._scene.pick(t.position);u(n)&&n.primitive instanceof Ia&&(e.tileset=n.primitive),e.pickActive=!1}}function MEe(e,t){t?e._eventHandler.setInputAction(function(n){let i=e._scene.pick(n.endPosition);u(i)&&i.primitive instanceof Ia&&(e.tileset=i.primitive)},Cn.MOUSE_MOVE):(e._eventHandler.removeInputAction(Cn.MOUSE_MOVE),e.picking=e.picking)}var uSt={maximumFractionDigits:3};function HI(e){let t=e/1048576;return t<1?t.toLocaleString(void 0,uSt):Math.round(t).toLocaleString()}function GI(e,t){if(!u(e))return"";let n=t?e._statisticsPerPass[Ho.PICK]:e._statisticsPerPass[Ho.RENDER],i='<ul class="cesium-cesiumInspector-statistics">';return i+=`<li><strong>Visited: </strong>${n.visited.toLocaleString()}</li><li><strong>Selected: </strong>${n.selected.toLocaleString()}</li><li><strong>Commands: </strong>${n.numberOfCommands.toLocaleString()}</li>`,i+="</ul>",t||(i+='<ul class="cesium-cesiumInspector-statistics">',i+=`<li><strong>Requests: </strong>${n.numberOfPendingRequests.toLocaleString()}</li><li><strong>Attempted: </strong>${n.numberOfAttemptedRequests.toLocaleString()}</li><li><strong>Processing: </strong>${n.numberOfTilesProcessing.toLocaleString()}</li><li><strong>Content Ready: </strong>${n.numberOfTilesWithContentReady.toLocaleString()}</li><li><strong>Total: </strong>${n.numberOfTilesTotal.toLocaleString()}</li>`,i+="</ul>",i+='<ul class="cesium-cesiumInspector-statistics">',i+=`<li><strong>Features Selected: </strong>${n.numberOfFeaturesSelected.toLocaleString()}</li><li><strong>Features Loaded: </strong>${n.numberOfFeaturesLoaded.toLocaleString()}</li><li><strong>Points Selected: </strong>${n.numberOfPointsSelected.toLocaleString()}</li><li><strong>Points Loaded: </strong>${n.numberOfPointsLoaded.toLocaleString()}</li><li><strong>Triangles Selected: </strong>${n.numberOfTrianglesSelected.toLocaleString()}</li>`,i+="</ul>",i+='<ul class="cesium-cesiumInspector-statistics">',i+=`<li><strong>Tiles styled: </strong>${n.numberOfTilesStyled.toLocaleString()}</li><li><strong>Features styled: </strong>${n.numberOfFeaturesStyled.toLocaleString()}</li>`,i+="</ul>",i+='<ul class="cesium-cesiumInspector-statistics">',i+=`<li><strong>Children Union Culled: </strong>${n.numberOfTilesCulledWithChildrenUnion.toLocaleString()}</li>`,i+="</ul>",i+='<ul class="cesium-cesiumInspector-statistics">',i+=`<li><strong>Geometry Memory (MB): </strong>${HI(n.geometryByteLength)}</li><li><strong>Texture Memory (MB): </strong>${HI(n.texturesByteLength)}</li><li><strong>Batch Table Memory (MB): </strong>${HI(n.batchTableByteLength)}</li>`,i+="</ul>"),i}function LEe(){let e=wi.statistics;return`
  <ul class="cesium-cesiumInspector-statistics">
    <li><strong>Geometry Memory (MB): </strong>${HI(e.geometryByteLength)}</li>
    <li><strong>Texture Memory (MB): </strong>${HI(e.texturesByteLength)}</li>
  </ul>
  `}var fSt=[{text:"Highlight",value:nu.HIGHLIGHT},{text:"Replace",value:nu.REPLACE},{text:"Mix",value:nu.MIX}],OEe=new G(1,1,0,.4),dSt=new G,xH=new G;function xa(e,t){let n=this,i=e.canvas;this._eventHandler=new Wf(i),this._scene=e,this._performanceContainer=t,this._canvas=i,this._performanceDisplay=new sy({container:t}),this._statisticsText="",this._pickStatisticsText="",this._resourceCacheStatisticsText="",this._editorError="",this.performance=!1,this.showStatistics=!0,this.showPickStatistics=!0,this.showResourceCacheStatistics=!1,this.inspectorVisible=!0,this.tilesetVisible=!1,this.displayVisible=!1,this.updateVisible=!1,this.loggingVisible=!1,this.styleVisible=!1,this.tileDebugLabelsVisible=!1,this.optimizationVisible=!1,this.styleString="{}",this.hasEnabledWireframe=!1,this._tileset=void 0,this._feature=void 0,this._tile=void 0,be.track(this,["performance","inspectorVisible","_statisticsText","_pickStatisticsText","_resourceCacheStatisticsText","_editorError","showPickStatistics","showStatistics","showResourceCacheStatistics","tilesetVisible","displayVisible","updateVisible","loggingVisible","styleVisible","optimizationVisible","tileDebugLabelsVisible","styleString","_feature","_tile","_tileset","hasEnabledWireframe"]),this._properties=be.observable({}),this.properties=[],be.defineProperty(this,"properties",function(){let B=[],W=n._properties();for(let j in W)W.hasOwnProperty(j)&&B.push(j);return B});let o=be.observable();be.defineProperty(this,"dynamicScreenSpaceError",{get:function(){return o()},set:function(B){o(B),u(n._tileset)&&(n._tileset.dynamicScreenSpaceError=B)}}),this.dynamicScreenSpaceError=!1;let r=be.observable();be.defineProperty(this,"colorBlendMode",{get:function(){return r()},set:function(B){r(B),u(n._tileset)&&(n._tileset.colorBlendMode=B,n._scene.requestRender())}}),this.colorBlendMode=nu.HIGHLIGHT;let s=be.observable(),a=be.observable();be.defineProperty(this,"picking",{get:function(){return a()},set:function(B){a(B),B?n._eventHandler.setInputAction(function(W){let j=e.pick(W.endPosition);if(j instanceof ta?(n.feature=j,n.tile=j.content.tile):u(j)&&u(j.content)?(n.feature=void 0,n.tile=j.content.tile):(n.feature=void 0,n.tile=void 0),!!u(n._tileset)){if(s&&u(j)&&u(j.content)){let Q;e.pickPositionSupported&&(Q=e.pickPosition(W.endPosition),u(Q)&&(n._tileset.debugPickPosition=Q)),n._tileset.debugPickedTile=j.content.tile}else n._tileset.debugPickedTile=void 0;n._scene.requestRender()}},Cn.MOUSE_MOVE):(n.feature=void 0,n.tile=void 0,n._eventHandler.removeInputAction(Cn.MOUSE_MOVE))}}),this.picking=!0;let c=be.observable();be.defineProperty(this,"colorize",{get:function(){return c()},set:function(B){c(B),u(n._tileset)&&(n._tileset.debugColorizeTiles=B,n._scene.requestRender())}}),this.colorize=!1;let l=be.observable();be.defineProperty(this,"wireframe",{get:function(){return l()},set:function(B){l(B),u(n._tileset)&&(n._tileset.debugWireframe=B,n._scene.requestRender())}}),this.wireframe=!1;let f=be.observable();be.defineProperty(this,"showBoundingVolumes",{get:function(){return f()},set:function(B){f(B),u(n._tileset)&&(n._tileset.debugShowBoundingVolume=B,n._scene.requestRender())}}),this.showBoundingVolumes=!1;let d=be.observable();be.defineProperty(this,"showContentBoundingVolumes",{get:function(){return d()},set:function(B){d(B),u(n._tileset)&&(n._tileset.debugShowContentBoundingVolume=B,n._scene.requestRender())}}),this.showContentBoundingVolumes=!1;let p=be.observable();be.defineProperty(this,"showRequestVolumes",{get:function(){return p()},set:function(B){p(B),u(n._tileset)&&(n._tileset.debugShowViewerRequestVolume=B,n._scene.requestRender())}}),this.showRequestVolumes=!1;let g=be.observable();be.defineProperty(this,"freezeFrame",{get:function(){return g()},set:function(B){g(B),u(n._tileset)&&(n._tileset.debugFreezeFrame=B,n._scene.debugShowFrustumPlanes=B,n._scene.requestRender())}}),this.freezeFrame=!1,be.defineProperty(this,"showOnlyPickedTileDebugLabel",{get:function(){return s()},set:function(B){s(B),u(n._tileset)&&(n._tileset.debugPickedTileLabelOnly=B,n._scene.requestRender())}}),this.showOnlyPickedTileDebugLabel=!1;let m=be.observable();be.defineProperty(this,"showGeometricError",{get:function(){return m()},set:function(B){m(B),u(n._tileset)&&(n._tileset.debugShowGeometricError=B,n._scene.requestRender())}}),this.showGeometricError=!1;let y=be.observable();be.defineProperty(this,"showRenderingStatistics",{get:function(){return y()},set:function(B){y(B),u(n._tileset)&&(n._tileset.debugShowRenderingStatistics=B,n._scene.requestRender())}}),this.showRenderingStatistics=!1;let b=be.observable();be.defineProperty(this,"showMemoryUsage",{get:function(){return b()},set:function(B){b(B),u(n._tileset)&&(n._tileset.debugShowMemoryUsage=B,n._scene.requestRender())}}),this.showMemoryUsage=!1;let C=be.observable();be.defineProperty(this,"showUrl",{get:function(){return C()},set:function(B){C(B),u(n._tileset)&&(n._tileset.debugShowUrl=B,n._scene.requestRender())}}),this.showUrl=!1;let A=be.observable();be.defineProperty(this,"maximumScreenSpaceError",{get:function(){return A()},set:function(B){B=Number(B),isNaN(B)||(A(B),u(n._tileset)&&(n._tileset.maximumScreenSpaceError=B))}}),this.maximumScreenSpaceError=16;let T=be.observable();be.defineProperty(this,"dynamicScreenSpaceErrorDensity",{get:function(){return T()},set:function(B){B=Number(B),isNaN(B)||(T(B),u(n._tileset)&&(n._tileset.dynamicScreenSpaceErrorDensity=B))}}),this.dynamicScreenSpaceErrorDensity=2e-4,this.dynamicScreenSpaceErrorDensitySliderValue=void 0,be.defineProperty(this,"dynamicScreenSpaceErrorDensitySliderValue",{get:function(){return Math.pow(T(),1/6)},set:function(B){let W=Math.pow(B,6);T(W),u(n._tileset)&&(n._tileset.dynamicScreenSpaceErrorDensity=W)}});let E=be.observable();be.defineProperty(this,"dynamicScreenSpaceErrorFactor",{get:function(){return E()},set:function(B){B=Number(B),isNaN(B)||(E(B),u(n._tileset)&&(n._tileset.dynamicScreenSpaceErrorFactor=B))}}),this.dynamicScreenSpaceErrorFactor=24;let v=lSt(this),D=be.observable();be.defineProperty(this,"pickActive",{get:function(){return D()},set:function(B){D(B),B?n._eventHandler.setInputAction(v,Cn.LEFT_CLICK):n._eventHandler.removeInputAction(Cn.LEFT_CLICK)}});let O=be.observable();be.defineProperty(this,"pointCloudShading",{get:function(){return O()},set:function(B){O(B),u(n._tileset)&&(n._tileset.pointCloudShading.attenuation=B)}}),this.pointCloudShading=!1;let P=be.observable();be.defineProperty(this,"geometricErrorScale",{get:function(){return P()},set:function(B){B=Number(B),isNaN(B)||(P(B),u(n._tileset)&&(n._tileset.pointCloudShading.geometricErrorScale=B))}}),this.geometricErrorScale=1;let M=be.observable();be.defineProperty(this,"maximumAttenuation",{get:function(){return M()},set:function(B){B=Number(B),isNaN(B)||(M(B),u(n._tileset)&&(n._tileset.pointCloudShading.maximumAttenuation=B===0?void 0:B))}}),this.maximumAttenuation=0;let L=be.observable();be.defineProperty(this,"baseResolution",{get:function(){return L()},set:function(B){B=Number(B),isNaN(B)||(L(B),u(n._tileset)&&(n._tileset.pointCloudShading.baseResolution=B===0?void 0:B))}}),this.baseResolution=0;let _=be.observable();be.defineProperty(this,"eyeDomeLighting",{get:function(){return _()},set:function(B){_(B),u(n._tileset)&&(n._tileset.pointCloudShading.eyeDomeLighting=B)}}),this.eyeDomeLighting=!1;let S=be.observable();be.defineProperty(this,"eyeDomeLightingStrength",{get:function(){return S()},set:function(B){B=Number(B),isNaN(B)||(S(B),u(n._tileset)&&(n._tileset.pointCloudShading.eyeDomeLightingStrength=B))}}),this.eyeDomeLightingStrength=1;let w=be.observable();be.defineProperty(this,"eyeDomeLightingRadius",{get:function(){return w()},set:function(B){B=Number(B),isNaN(B)||(w(B),u(n._tileset)&&(n._tileset.pointCloudShading.eyeDomeLightingRadius=B))}}),this.eyeDomeLightingRadius=1,this.pickActive=!1;let I=be.observable();be.defineProperty(this,"skipLevelOfDetail",{get:function(){return I()},set:function(B){I(B),u(n._tileset)&&(n._tileset.skipLevelOfDetail=B)}}),this.skipLevelOfDetail=!0;let N=be.observable();be.defineProperty(this,"skipScreenSpaceErrorFactor",{get:function(){return N()},set:function(B){B=Number(B),isNaN(B)||(N(B),u(n._tileset)&&(n._tileset.skipScreenSpaceErrorFactor=B))}}),this.skipScreenSpaceErrorFactor=16;let k=be.observable();be.defineProperty(this,"baseScreenSpaceError",{get:function(){return k()},set:function(B){B=Number(B),isNaN(B)||(k(B),u(n._tileset)&&(n._tileset.baseScreenSpaceError=B))}}),this.baseScreenSpaceError=1024;let z=be.observable();be.defineProperty(this,"skipLevels",{get:function(){return z()},set:function(B){B=Number(B),isNaN(B)||(z(B),u(n._tileset)&&(n._tileset.skipLevels=B))}}),this.skipLevels=1;let V=be.observable();be.defineProperty(this,"immediatelyLoadDesiredLevelOfDetail",{get:function(){return V()},set:function(B){V(B),u(n._tileset)&&(n._tileset.immediatelyLoadDesiredLevelOfDetail=B)}}),this.immediatelyLoadDesiredLevelOfDetail=!1;let U=be.observable();be.defineProperty(this,"loadSiblings",{get:function(){return U()},set:function(B){U(B),u(n._tileset)&&(n._tileset.loadSiblings=B)}}),this.loadSiblings=!1,this._style=void 0,this._shouldStyle=!1,this._definedProperties=["properties","dynamicScreenSpaceError","colorBlendMode","picking","colorize","wireframe","showBoundingVolumes","showContentBoundingVolumes","showRequestVolumes","freezeFrame","maximumScreenSpaceError","dynamicScreenSpaceErrorDensity","baseScreenSpaceError","skipScreenSpaceErrorFactor","skipLevelOfDetail","skipLevels","immediatelyLoadDesiredLevelOfDetail","loadSiblings","dynamicScreenSpaceErrorDensitySliderValue","dynamicScreenSpaceErrorFactor","pickActive","showOnlyPickedTileDebugLabel","showGeometricError","showRenderingStatistics","showMemoryUsage","showUrl","pointCloudShading","geometricErrorScale","maximumAttenuation","baseResolution","eyeDomeLighting","eyeDomeLightingStrength","eyeDomeLightingRadius"],this._removePostRenderEvent=e.postRender.addEventListener(function(){n._update()}),u(this._tileset)||MEe(this,!0)}Object.defineProperties(xa.prototype,{scene:{get:function(){return this._scene}},performanceContainer:{get:function(){return this._performanceContainer}},statisticsText:{get:function(){return this._statisticsText}},pickStatisticsText:{get:function(){return this._pickStatisticsText}},resourceCacheStatisticsText:{get:function(){return this._resourceCacheStatisticsText}},colorBlendModes:{get:function(){return fSt}},editorError:{get:function(){return this._editorError}},tileset:{get:function(){return this._tileset},set:function(e){if(this._tileset=e,this._style=void 0,this.styleString="{}",this.feature=void 0,this.tile=void 0,u(e)){this._properties(e.properties);let t=["colorize","wireframe","showBoundingVolumes","showContentBoundingVolumes","showRequestVolumes","freezeFrame","showOnlyPickedTileDebugLabel","showGeometricError","showRenderingStatistics","showMemoryUsage","showUrl"],n=t.length;for(let o=0;o<n;++o){let r=t[o];this[r]=this[r]}this.maximumScreenSpaceError=e.maximumScreenSpaceError,this.dynamicScreenSpaceError=e.dynamicScreenSpaceError,this.dynamicScreenSpaceErrorDensity=e.dynamicScreenSpaceErrorDensity,this.dynamicScreenSpaceErrorFactor=e.dynamicScreenSpaceErrorFactor,this.colorBlendMode=e.colorBlendMode,this.skipLevelOfDetail=e.skipLevelOfDetail,this.skipScreenSpaceErrorFactor=e.skipScreenSpaceErrorFactor,this.baseScreenSpaceError=e.baseScreenSpaceError,this.skipLevels=e.skipLevels,this.immediatelyLoadDesiredLevelOfDetail=e.immediatelyLoadDesiredLevelOfDetail,this.loadSiblings=e.loadSiblings,this.hasEnabledWireframe=e._enableDebugWireframe;let i=e.pointCloudShading;this.pointCloudShading=i.attenuation,this.geometricErrorScale=i.geometricErrorScale,this.maximumAttenuation=i.maximumAttenuation?i.maximumAttenuation:0,this.baseResolution=i.baseResolution?i.baseResolution:0,this.eyeDomeLighting=i.eyeDomeLighting,this.eyeDomeLightingStrength=i.eyeDomeLightingStrength,this.eyeDomeLightingRadius=i.eyeDomeLightingRadius,this._scene.requestRender()}else this._properties({});this._statisticsText=GI(e,!1),this._pickStatisticsText=GI(e,!0),this._resourceCacheStatisticsText=LEe(),MEe(this,!1)}},feature:{get:function(){return this._feature},set:function(e){if(this._feature===e)return;let t=this._feature;u(t)&&!t.content.isDestroyed()&&(!this.colorize&&u(this._style)?t.color=u(this._style.color)?this._style.color.evaluateColor(t,dSt):G.WHITE:t.color=xH,this._scene.requestRender()),u(e)&&(G.clone(e.color,xH),e.color=OEe,this._scene.requestRender()),this._feature=e}},tile:{get:function(){return this._tile},set:function(e){if(this._tile===e)return;let t=this._tile;u(t)&&!t.isDestroyed()&&!a$(t.content)&&(t.color=xH,this._scene.requestRender()),u(e)&&!a$(e.content)&&(G.clone(e.color,xH),e.color=OEe,this._scene.requestRender()),this._tile=e}}});function a$(e){if(!u(e))return!1;if(e.featuresLength>0)return!0;let t=e.innerContents;if(u(t)){let n=t.length;for(let i=0;i<n;++i)if(!a$(t[i]))return!1;return!0}return!1}xa.prototype.togglePickTileset=function(){this.pickActive=!this.pickActive};xa.prototype.toggleInspector=function(){this.inspectorVisible=!this.inspectorVisible};xa.prototype.toggleTileset=function(){this.tilesetVisible=!this.tilesetVisible};xa.prototype.toggleDisplay=function(){this.displayVisible=!this.displayVisible};xa.prototype.toggleUpdate=function(){this.updateVisible=!this.updateVisible};xa.prototype.toggleLogging=function(){this.loggingVisible=!this.loggingVisible};xa.prototype.toggleStyle=function(){this.styleVisible=!this.styleVisible};xa.prototype.toggleTileDebugLabels=function(){this.tileDebugLabelsVisible=!this.tileDebugLabelsVisible};xa.prototype.toggleOptimization=function(){this.optimizationVisible=!this.optimizationVisible};xa.prototype.trimTilesCache=function(){u(this._tileset)&&this._tileset.trimLoadedTiles()};xa.prototype.compileStyle=function(){let e=this._tileset;if(!(!u(e)||this.styleString===JSON.stringify(e.style))){this._editorError="";try{this.styleString.length===0&&(this.styleString="{}"),this._style=new bS(JSON.parse(this.styleString)),this._shouldStyle=!0,this._scene.requestRender()}catch(t){this._editorError=t.toString()}this.feature=this._feature,this.tile=this._tile}};xa.prototype.styleEditorKeyPress=function(e,t){if(t.keyCode===9){t.preventDefault();let n=t.target,i=n.selectionStart,o=n.selectionEnd,r=o,a=n.value.slice(i,o).split(`
`),c=a.length,l;if(t.shiftKey)for(l=0;l<c;++l)a[l][0]===" "&&(a[l][1]===" "?(a[l]=a[l].substr(2),r-=2):(a[l]=a[l].substr(1),r-=1));else for(l=0;l<c;++l)a[l]=`  ${a[l]}`,r+=2;let f=a.join(`
`);n.value=n.value.slice(0,i)+f+n.value.slice(o),n.selectionStart=i!==o?i:r,n.selectionEnd=r}else t.ctrlKey&&(t.keyCode===10||t.keyCode===13)&&this.compileStyle();return!0};xa.prototype._update=function(){let e=this._tileset;if(this.performance&&this._performanceDisplay.update(),u(e)){if(e.isDestroyed()){this.tile=void 0,this.feature=void 0,this.tileset=void 0;return}let t=e.style;this._style!==e.style&&(this._shouldStyle?(e.style=this._style,this._shouldStyle=!1):(this._style=t,this.styleString=JSON.stringify(t.style,null,"  ")))}this.showStatistics&&(this._statisticsText=GI(e,!1),this._pickStatisticsText=GI(e,!0),this._resourceCacheStatisticsText=LEe())};xa.prototype.isDestroyed=function(){return!1};xa.prototype.destroy=function(){this._eventHandler.destroy(),this._removePostRenderEvent();let e=this;return this._definedProperties.forEach(function(t){be.getObservable(e,t).dispose()}),ue(this)};xa.getStatistics=GI;var bH=xa;function CH(e,t){e=Rn(e);let n=document.createElement("div"),i=document.createElement("div");i.setAttribute("data-bind","visible: performance");let o=new bH(t,i);this._viewModel=o,this._container=e,this._element=n;let r=document.createElement("div");r.textContent="3D Tiles Inspector",r.className="cesium-cesiumInspector-button",r.setAttribute("data-bind","click: toggleInspector"),n.appendChild(r),n.className="cesium-cesiumInspector cesium-3DTilesInspector",n.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : inspectorVisible, "cesium-cesiumInspector-hidden" : !inspectorVisible}'),e.appendChild(n);let s=document.createElement("div");s.className="cesium-cesiumInspector-dropDown",n.appendChild(s);let a=gc.createSection,c=gc.createCheckbox,l=gc.createRangeInput,f=gc.createButton,d=a(s,"Tileset","tilesetVisible","toggleTileset"),p=a(s,"Display","displayVisible","toggleDisplay"),g=a(s,"Update","updateVisible","toggleUpdate"),m=a(s,"Logging","loggingVisible","toggleLogging"),y=a(s,"Tile Debug Labels","tileDebugLabelsVisible","toggleTileDebugLabels"),b=a(s,"Style","styleVisible","toggleStyle"),C=a(s,"Optimization","optimizationVisible","toggleOptimization"),A=document.createElement("div");A.className="field-group";let T=document.createElement("label");T.className="field-label",T.appendChild(document.createTextNode("Properties: "));let E=document.createElement("div");E.setAttribute("data-bind","text: properties"),A.appendChild(T),A.appendChild(E),d.appendChild(A),d.appendChild(f("Pick Tileset","togglePickTileset","pickActive")),d.appendChild(f("Trim Tiles Cache","trimTilesCache")),d.appendChild(c("Enable Picking","picking")),p.appendChild(c("Colorize","colorize"));let v=p.appendChild(c("Wireframe","wireframe","_tileset === undefined || hasEnabledWireframe")),D=document.createElement("p");D.setAttribute("data-bind","visible: _tileset !== undefined && !hasEnabledWireframe"),D.setAttribute("class","cesium-3DTilesInspector-disabledElementsInfo"),D.innerText="Set enableDebugWireframe to true in the tileset constructor to enable this option.",v.appendChild(D),p.appendChild(c("Bounding Volumes","showBoundingVolumes")),p.appendChild(c("Content Volumes","showContentBoundingVolumes")),p.appendChild(c("Request Volumes","showRequestVolumes")),p.appendChild(c("Point Cloud Shading","pointCloudShading"));let O=document.createElement("div");O.setAttribute("data-bind","visible: pointCloudShading"),O.appendChild(l("Geometric Error Scale","geometricErrorScale",0,2,.01)),O.appendChild(l("Maximum Attenuation","maximumAttenuation",0,32,1)),O.appendChild(l("Base Resolution","baseResolution",0,1,.01)),O.appendChild(c("Eye Dome Lighting (EDL)","eyeDomeLighting")),p.appendChild(O);let P=document.createElement("div");P.setAttribute("data-bind","visible: eyeDomeLighting"),P.appendChild(l("EDL Strength","eyeDomeLightingStrength",0,2,.1)),P.appendChild(l("EDL Radius","eyeDomeLightingRadius",0,4,.1)),O.appendChild(P),g.appendChild(c("Freeze Frame","freezeFrame")),g.appendChild(c("Dynamic Screen Space Error","dynamicScreenSpaceError"));let M=document.createElement("div");M.appendChild(l("Maximum Screen Space Error","maximumScreenSpaceError",0,128,1)),g.appendChild(M);let L=document.createElement("div");L.setAttribute("data-bind","visible: dynamicScreenSpaceError"),L.appendChild(l("Screen Space Error Density","dynamicScreenSpaceErrorDensitySliderValue",0,1,.005,"dynamicScreenSpaceErrorDensity")),L.appendChild(l("Screen Space Error Factor","dynamicScreenSpaceErrorFactor",1,32,.1)),g.appendChild(L),m.appendChild(c("Performance","performance")),m.appendChild(i),m.appendChild(c("Statistics","showStatistics"));let _=document.createElement("div");_.className="cesium-3dTilesInspector-statistics",_.setAttribute("data-bind","html: statisticsText, visible: showStatistics"),m.appendChild(_),m.appendChild(c("Pick Statistics","showPickStatistics"));let S=document.createElement("div");S.className="cesium-3dTilesInspector-statistics",S.setAttribute("data-bind","html: pickStatisticsText, visible: showPickStatistics"),m.appendChild(S),m.appendChild(c("Resource Cache Statistics","showResourceCacheStatistics"));let w=document.createElement("div");w.className="cesium-3dTilesInspector-statistics",w.setAttribute("data-bind","html: resourceCacheStatisticsText, visible: showResourceCacheStatistics"),m.appendChild(w);let I=document.createElement("div");b.appendChild(I),I.appendChild(document.createTextNode("Color Blend Mode: "));let N=document.createElement("select");N.setAttribute("data-bind",'options: colorBlendModes, optionsText: "text", optionsValue: "value", value: colorBlendMode'),I.appendChild(N);let k=document.createElement("textarea");k.setAttribute("data-bind","textInput: styleString, event: { keydown: styleEditorKeyPress }"),I.className="cesium-cesiumInspector-styleEditor",I.appendChild(k);let z=f("Compile (Ctrl+Enter)","compileStyle");I.appendChild(z);let V=document.createElement("div");V.className="cesium-cesiumInspector-error",V.setAttribute("data-bind","text: editorError"),I.appendChild(V),y.appendChild(c("Show Picked Only","showOnlyPickedTileDebugLabel")),y.appendChild(c("Geometric Error","showGeometricError")),y.appendChild(c("Rendering Statistics","showRenderingStatistics")),y.appendChild(c("Memory Usage (MB)","showMemoryUsage")),y.appendChild(c("Url","showUrl")),C.appendChild(c("Skip Tile LODs","skipLevelOfDetail"));let U=document.createElement("div");U.appendChild(l("Skip SSE Factor","skipScreenSpaceErrorFactor",1,50,1)),C.appendChild(U);let B=document.createElement("div");B.appendChild(l("SSE before skipping LOD","baseScreenSpaceError",0,4096,1)),C.appendChild(B);let W=document.createElement("div");W.appendChild(l("Min. levels to skip","skipLevels",0,10,1)),C.appendChild(W),C.appendChild(c("Load only tiles that meet the max SSE.","immediatelyLoadDesiredLevelOfDetail")),C.appendChild(c("Load siblings of visible tiles","loadSiblings")),be.applyBindings(o,n)}Object.defineProperties(CH.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});CH.prototype.isDestroyed=function(){return!1};CH.prototype.destroy=function(){return be.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),ue(this)};var AH=CH;function NEe(e){e=x(e,x.EMPTY_OBJECT);let t=e.globe,n=x(e.imageryProviderViewModels,[]),i=x(e.terrainProviderViewModels,[]);this._globe=t,this.imageryProviderViewModels=n.slice(0),this.terrainProviderViewModels=i.slice(0),this.dropDownVisible=!1,be.track(this,["imageryProviderViewModels","terrainProviderViewModels","dropDownVisible"]);let o=be.getObservable(this,"imageryProviderViewModels"),r=be.pureComputed(function(){let d=o(),p={},g;for(g=0;g<d.length;g++){let b=d[g],C=b.category;u(p[C])?p[C].push(b):p[C]=[b]}let m=Object.keys(p),y=[];for(g=0;g<m.length;g++){let b=m[g];y.push({name:b,providers:p[b]})}return y});this._imageryProviders=r;let s=be.getObservable(this,"terrainProviderViewModels"),a=be.pureComputed(function(){let d=s(),p={},g;for(g=0;g<d.length;g++){let b=d[g],C=b.category;u(p[C])?p[C].push(b):p[C]=[b]}let m=Object.keys(p),y=[];for(g=0;g<m.length;g++){let b=m[g];y.push({name:b,providers:p[b]})}return y});this._terrainProviders=a,this.buttonTooltip=void 0,be.defineProperty(this,"buttonTooltip",function(){let d=this.selectedImagery,p=this.selectedTerrain,g=u(d)?d.name:void 0,m=u(p)?p.name:void 0;return u(g)&&u(m)?`${g}
${m}`:u(g)?g:m}),this.buttonImageUrl=void 0,be.defineProperty(this,"buttonImageUrl",function(){let d=this.selectedImagery;if(u(d))return d.iconUrl}),this.selectedImagery=void 0;let c=be.observable();this._currentImageryLayers=[],be.defineProperty(this,"selectedImagery",{get:function(){return c()},set:function(d){if(c()===d){this.dropDownVisible=!1;return}let p,g=this._currentImageryLayers,m=g.length,y=this._globe.imageryLayers,b=!1;for(p=0;p<m;p++){let C=y.length;for(let A=0;A<C;A++){let T=y.get(A);if(T===g[p]){y.remove(T),b=!0;break}}}if(u(d)){let C=d.creationCommand();if(Array.isArray(C)){let A=C.length;for(this._currentImageryLayers=[],p=A-1;p>=0;p--){let T=dc.fromProviderAsync(C[p]);y.add(T,0),this._currentImageryLayers.push(T)}}else{this._currentImageryLayers=[];let A=dc.fromProviderAsync(C);if(A.name=d.name,b)y.add(A,0);else{let T=y.get(0);u(T)&&y.remove(T),y.add(A,0)}this._currentImageryLayers.push(A)}}c(d),this.dropDownVisible=!1}}),this.selectedTerrain=void 0;let l=be.observable();be.defineProperty(this,"selectedTerrain",{get:function(){return l()},set:function(d){if(l()===d){this.dropDownVisible=!1;return}let p;if(u(d)&&(p=d.creationCommand()),u(p)&&!u(p.then))this._globe.depthTestAgainstTerrain=!(p instanceof h_),this._globe.terrainProvider=p;else if(u(p)){let g=!1,m=this._globe.terrainProviderChanged.addEventListener(()=>{g=!0,m()}),b=new aH(p).readyEvent.addEventListener(C=>{g||(this._globe.depthTestAgainstTerrain=!(C instanceof h_),this._globe.terrainProvider=C,b())})}l(d),this.dropDownVisible=!1}});let f=this;this._toggleDropDown=vn(function(){f.dropDownVisible=!f.dropDownVisible}),this.selectedImagery=x(e.selectedImageryProviderViewModel,n[0]),this.selectedTerrain=e.selectedTerrainProviderViewModel}Object.defineProperties(NEe.prototype,{toggleDropDown:{get:function(){return this._toggleDropDown}},globe:{get:function(){return this._globe}}});var TH=NEe;function EH(e,t){e=Rn(e);let n=new TH(t),i=document.createElement("button");i.type="button",i.className="cesium-button cesium-toolbar-button",i.setAttribute("data-bind","attr: { title: buttonTooltip },click: toggleDropDown"),e.appendChild(i);let o=document.createElement("img");o.setAttribute("draggable","false"),o.className="cesium-baseLayerPicker-selected",o.setAttribute("data-bind","attr: { src: buttonImageUrl }, visible: !!buttonImageUrl"),i.appendChild(o);let r=document.createElement("div");r.className="cesium-baseLayerPicker-dropDown",r.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-dropDown-visible" : dropDownVisible }'),e.appendChild(r);let s=document.createElement("div");s.className="cesium-baseLayerPicker-sectionTitle",s.setAttribute("data-bind","visible: imageryProviderViewModels.length > 0"),s.innerHTML="Imagery",r.appendChild(s);let a=document.createElement("div");a.className="cesium-baseLayerPicker-section",a.setAttribute("data-bind","foreach: _imageryProviders"),r.appendChild(a);let c=document.createElement("div");c.className="cesium-baseLayerPicker-category",a.appendChild(c);let l=document.createElement("div");l.className="cesium-baseLayerPicker-categoryTitle",l.setAttribute("data-bind","text: name"),c.appendChild(l);let f=document.createElement("div");f.className="cesium-baseLayerPicker-choices",f.setAttribute("data-bind","foreach: providers"),c.appendChild(f);let d=document.createElement("div");d.className="cesium-baseLayerPicker-item",d.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-selectedItem" : $data === $parents[1].selectedImagery },attr: { title: tooltip },visible: creationCommand.canExecute,click: function($data) { $parents[1].selectedImagery = $data; }'),f.appendChild(d);let p=document.createElement("img");p.className="cesium-baseLayerPicker-itemIcon",p.setAttribute("data-bind","attr: { src: iconUrl }"),p.setAttribute("draggable","false"),d.appendChild(p);let g=document.createElement("div");g.className="cesium-baseLayerPicker-itemLabel",g.setAttribute("data-bind","text: name"),d.appendChild(g);let m=document.createElement("div");m.className="cesium-baseLayerPicker-sectionTitle",m.setAttribute("data-bind","visible: terrainProviderViewModels.length > 0"),m.innerHTML="Terrain",r.appendChild(m);let y=document.createElement("div");y.className="cesium-baseLayerPicker-section",y.setAttribute("data-bind","foreach: _terrainProviders"),r.appendChild(y);let b=document.createElement("div");b.className="cesium-baseLayerPicker-category",y.appendChild(b);let C=document.createElement("div");C.className="cesium-baseLayerPicker-categoryTitle",C.setAttribute("data-bind","text: name"),b.appendChild(C);let A=document.createElement("div");A.className="cesium-baseLayerPicker-choices",A.setAttribute("data-bind","foreach: providers"),b.appendChild(A);let T=document.createElement("div");T.className="cesium-baseLayerPicker-item",T.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-selectedItem" : $data === $parents[1].selectedTerrain },attr: { title: tooltip },visible: creationCommand.canExecute,click: function($data) { $parents[1].selectedTerrain = $data; }'),A.appendChild(T);let E=document.createElement("img");E.className="cesium-baseLayerPicker-itemIcon",E.setAttribute("data-bind","attr: { src: iconUrl }"),E.setAttribute("draggable","false"),T.appendChild(E);let v=document.createElement("div");v.className="cesium-baseLayerPicker-itemLabel",v.setAttribute("data-bind","text: name"),T.appendChild(v),be.applyBindings(n,i),be.applyBindings(n,r),this._viewModel=n,this._container=e,this._element=i,this._dropPanel=r,this._closeDropDown=function(D){i.contains(D.target)||r.contains(D.target)||(n.dropDownVisible=!1)},Wt.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeDropDown,!0):(document.addEventListener("mousedown",this._closeDropDown,!0),document.addEventListener("touchstart",this._closeDropDown,!0))}Object.defineProperties(EH.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});EH.prototype.isDestroyed=function(){return!1};EH.prototype.destroy=function(){return Wt.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeDropDown,!0):(document.removeEventListener("mousedown",this._closeDropDown,!0),document.removeEventListener("touchstart",this._closeDropDown,!0)),be.cleanNode(this._element),be.cleanNode(this._dropPanel),this._container.removeChild(this._element),this._container.removeChild(this._dropPanel),ue(this)};var SH=EH;function FEe(e){let t=e.creationFunction;u(t.canExecute)||(t=vn(t)),this._creationCommand=t,this.name=e.name,this.tooltip=e.tooltip,this.iconUrl=e.iconUrl,this._category=x(e.category,""),be.track(this,["name","tooltip","iconUrl"])}Object.defineProperties(FEe.prototype,{creationCommand:{get:function(){return this._creationCommand}},category:{get:function(){return this._category}}});var ps=FEe;function hSt(){let e=[],t=devicePixelRatio>=2;return e.push(new ps({name:"Bing Maps Aerial",iconUrl:on("Widgets/Images/ImageryProviders/bingAerial.png"),tooltip:"Bing Maps aerial imagery, provided by Cesium ion",category:"Cesium ion",creationFunction:function(){return ny({style:ty.AERIAL})}})),e.push(new ps({name:"Bing Maps Aerial with Labels",iconUrl:on("Widgets/Images/ImageryProviders/bingAerialLabels.png"),tooltip:"Bing Maps aerial imagery with labels, provided by Cesium ion",category:"Cesium ion",creationFunction:function(){return ny({style:ty.AERIAL_WITH_LABELS})}})),e.push(new ps({name:"Bing Maps Roads",iconUrl:on("Widgets/Images/ImageryProviders/bingRoads.png"),tooltip:"Bing Maps standard road maps, provided by Cesium ion",category:"Cesium ion",creationFunction:function(){return ny({style:ty.ROAD})}})),e.push(new ps({name:"ArcGIS World Imagery",iconUrl:on("Widgets/Images/ImageryProviders/ArcGisMapServiceWorldImagery.png"),tooltip:`ArcGIS World Imagery provides one meter or better satellite and aerial imagery in many parts of the world and lower resolution satellite imagery worldwide. The map includes 15m TerraColor imagery at small and mid-scales (~1:591M down to ~1:288k) for the world. The map features Maxar imagery at 0.3m resolution for select metropolitan areas around the world, 0.5m resolution across the United States and parts of Western Europe, and 1m resolution imagery across the rest of the world. In addition to commercial sources, the World Imagery map features high-resolution aerial photography contributed by the GIS User Community. This imagery ranges from 0.3m to 0.03m resolution (down to ~1:280 nin select communities). For more information on this map, including the terms of use, visit us online at 
https://www.arcgis.com/home/item.html?id=10df2279f9684e4a9f6a7f08febac2a9`,category:"Other",creationFunction:function(){return J0.fromBasemapType(Lm.SATELLITE,{enablePickFeatures:!1})}})),e.push(new ps({name:"ArcGIS World Hillshade",iconUrl:on("Widgets/Images/ImageryProviders/ArcGisMapServiceWorldHillshade.png"),tooltip:`ArcGIS World Hillshade map portrays elevation as an artistic hillshade. This map is designed to be used as a backdrop for topographical, soil, hydro, landcover or other outdoor recreational maps. The map was compiled from a variety of sources from several data providers. The basemap has global coverage down to a scale of ~1:72k. In select areas of the United States and Europe, coverage is available down to ~1:9k. For more information on this map, including the terms of use, visit us online at 
https://www.arcgis.com/home/item.html?id=1b243539f4514b6ba35e7d995890db1d`,category:"Other",creationFunction:function(){return J0.fromBasemapType(Lm.HILLSHADE,{enablePickFeatures:!1})}})),e.push(new ps({name:"Esri World Ocean",iconUrl:on("Widgets/Images/ImageryProviders/ArcGisMapServiceWorldOcean.png"),tooltip:`ArcGIS World Ocean map is designed to be used as a base map by marine GIS professionals and as a reference map by anyone interested in ocean data.  The base map features marine bathymetry. Land features include inland waters and roads overlaid on land cover and shaded relief imagery. The map was compiled from a variety of best available sources from several data providers, including General Bathymetric Chart of the Oceans GEBCO_08 Grid, National Oceanic and Atmospheric Administration (NOAA), and National Geographic, Garmin, HERE, Geonames.org, and Esri, and various other contributors. The base map currently provides coverage for the world down to a scale of ~1:577k, and coverage down to 1:72k in US coastal areas, and various other areas. Coverage down to ~ 1:9k is available limited areas based on regional hydrographic survey data. The base map was designed and developed by Esri. For more information on this map, including our terms of use, visit us online at 
https://www.arcgis.com/home/item.html?id=1e126e7520f9466c9ca28b8f28b5e500`,category:"Other",creationFunction:function(){return J0.fromBasemapType(Lm.OCEANS,{enablePickFeatures:!1})}})),e.push(new ps({name:"Open\xADStreet\xADMap",iconUrl:on("Widgets/Images/ImageryProviders/openStreetMap.png"),tooltip:`OpenStreetMap (OSM) is a collaborative project to create a free editable map of the world.
http://www.openstreetmap.org`,category:"Other",creationFunction:function(){return new my({url:"https://tile.openstreetmap.org/"})}})),e.push(new ps({name:"Stadia x Stamen Watercolor",iconUrl:on("Widgets/Images/ImageryProviders/stamenWatercolor.png"),tooltip:`Based on the original basemaps created for the Knight Foundation and reminiscent of hand drawn maps, the watercolor maps from Stamen Design apply raster effect area washes and organic edges over a paper texture to add warm pop to any map.
https://docs.stadiamaps.com/map-styles/stamen-watercolor/`,category:"Other",creationFunction:function(){return new my({url:"https://tiles.stadiamaps.com/tiles/stamen_watercolor/",fileExtension:"jpg",credit:`&copy; <a href="https://stamen.com/" target="_blank">Stamen Design</a>
           &copy; <a href="https://www.stadiamaps.com/" target="_blank">Stadia Maps</a>
           &copy; <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a>
           &copy; <a href="https://www.openstreetmap.org/about/" target="_blank">OpenStreetMap contributors</a>`})}})),e.push(new ps({name:"Stadia x Stamen Toner",iconUrl:on("Widgets/Images/ImageryProviders/stamenToner.png"),tooltip:`Based on the original basemaps created for the Knight Foundation and the most popular of the excellent styles from Stamen Design, these high-contrast B+W (black and white) maps are the perfect backdrop for your colorful and eye-catching overlays.
https://docs.stadiamaps.com/map-styles/stamen-toner/`,category:"Other",creationFunction:function(){return new my({url:"https://tiles.stadiamaps.com/tiles/stamen_toner/",retinaTiles:t,credit:`&copy; <a href="https://stamen.com/" target="_blank">Stamen Design</a>
            &copy; <a href="https://www.stadiamaps.com/" target="_blank">Stadia Maps</a>
            &copy; <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a>
            &copy; <a href="https://www.openstreetmap.org/about/" target="_blank">OpenStreetMap contributors</a>`})}})),e.push(new ps({name:"Stadia Alidade Smooth",iconUrl:on("Widgets/Images/ImageryProviders/stadiaAlidadeSmooth.png"),tooltip:`Stadia's custom Alidade Smooth style is designed for maps that use a lot of markers or overlays. It features a muted color scheme and fewer points of interest to allow your added data to shine.
https://docs.stadiamaps.com/map-styles/alidade-smooth/`,category:"Other",creationFunction:function(){return new my({url:"https://tiles.stadiamaps.com/tiles/alidade_smooth/",retinaTiles:t,credit:`&copy; <a href="https://www.stadiamaps.com/" target="_blank">Stadia Maps</a>
            &copy; <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a>
            &copy; <a href="https://www.openstreetmap.org/about/" target="_blank">OpenStreetMap contributors</a>`})}})),e.push(new ps({name:"Stadia Alidade Smooth Dark",iconUrl:on("Widgets/Images/ImageryProviders/stadiaAlidadeSmoothDark.png"),tooltip:`Stadia Alidade Smooth Dark, like its lighter cousin, is also designed to stay out of the way. It just flips the dark mode switch on the color scheme. With the lights out, your data can now literally shine.
https://docs.stadiamaps.com/map-styles/alidade-smooth-dark/`,category:"Other",creationFunction:function(){return new my({url:"https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/",retinaTiles:t,credit:`&copy; <a href="https://www.stadiamaps.com/" target="_blank">Stadia Maps</a>
            &copy; <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a>
            &copy; <a href="https://www.openstreetmap.org/about/" target="_blank">OpenStreetMap contributors</a>`})}})),e.push(new ps({name:"Sentinel-2",iconUrl:on("Widgets/Images/ImageryProviders/sentinel-2.png"),tooltip:"Sentinel-2 cloudless by EOX IT Services GmbH (Contains modified Copernicus Sentinel data 2016 and 2017).",category:"Cesium ion",creationFunction:function(){return ey.fromAssetId(3954)}})),e.push(new ps({name:"Blue Marble",iconUrl:on("Widgets/Images/ImageryProviders/blueMarble.png"),tooltip:"Blue Marble Next Generation July, 2004 imagery from NASA.",category:"Cesium ion",creationFunction:function(){return ey.fromAssetId(3845)}})),e.push(new ps({name:"Earth at night",iconUrl:on("Widgets/Images/ImageryProviders/earthAtNight.png"),tooltip:"The Earth at night, also known as The Black Marble, is a 500 meter resolution global composite imagery layer released by NASA.",category:"Cesium ion",creationFunction:function(){return ey.fromAssetId(3812)}})),e.push(new ps({name:"Natural Earth\xA0II",iconUrl:on("Widgets/Images/ImageryProviders/naturalEarthII.png"),tooltip:`Natural Earth II, darkened for contrast.
http://www.naturalearthdata.com/`,category:"Cesium ion",creationFunction:function(){return _b.fromUrl(on("Assets/Textures/NaturalEarthII"))}})),e}var vH=hSt;function mSt(){let e=[];return e.push(new ps({name:"WGS84 Ellipsoid",iconUrl:on("Widgets/Images/TerrainProviders/Ellipsoid.png"),tooltip:"WGS84 standard ellipsoid, also known as EPSG:4326",category:"Cesium ion",creationFunction:function(){return new h_({ellipsoid:ee.WGS84})}})),e.push(new ps({name:"Cesium World Terrain",iconUrl:on("Widgets/Images/TerrainProviders/CesiumWorldTerrain.png"),tooltip:"High-resolution global terrain tileset curated from several datasources and hosted by Cesium ion",category:"Cesium ion",creationFunction:function(){return wE({requestWaterMask:!0,requestVertexNormals:!0})}})),e}var wH=mSt;function pSt(e){let t;if(u(e)){t="Command Statistics";let n=e.commandsInFrustums;for(let i in n)if(n.hasOwnProperty(i)){let o=parseInt(i,10),r;if(o===7)r="1, 2 and 3";else{let s=[];for(let a=2;a>=0;a--){let c=Math.pow(2,a);o>=c&&(s.push(a+1),o-=c)}r=s.reverse().join(" and ")}t+=`<br>&nbsp;&nbsp;&nbsp;&nbsp;${n[i]} in frustum ${r}`}t+=`<br>Total: ${e.totalCommands}`}return t}function c$(e,t,n){let i=Math.min(n,t);return i=Math.max(i,e),i}var _St=new _n,gSt=new h;function WI(e,t){let n=this,i=e.canvas,o=new Wf(i);this._eventHandler=o,this._scene=e,this._canvas=i,this._primitive=void 0,this._tile=void 0,this._modelMatrixPrimitive=void 0,this._performanceDisplay=void 0,this._performanceContainer=t;let r=this._scene.globe;r.depthTestAgainstTerrain=!0,this.frustums=!1,this.frustumPlanes=!1,this.performance=!1,this.shaderCacheText="",this.primitiveBoundingSphere=!1,this.primitiveReferenceFrame=!1,this.filterPrimitive=!1,this.tileBoundingSphere=!1,this.filterTile=!1,this.wireframe=!1,this.depthFrustum=1,this._numberOfFrustums=1,this.suspendUpdates=!1,this.tileCoordinates=!1,this.frustumStatisticText=!1,this.tileText="",this.hasPickedPrimitive=!1,this.hasPickedTile=!1,this.pickPrimitiveActive=!1,this.pickTileActive=!1,this.dropDownVisible=!0,this.generalVisible=!0,this.primitivesVisible=!1,this.terrainVisible=!1,this.depthFrustumText="",be.track(this,["frustums","frustumPlanes","performance","shaderCacheText","primitiveBoundingSphere","primitiveReferenceFrame","filterPrimitive","tileBoundingSphere","filterTile","wireframe","depthFrustum","suspendUpdates","tileCoordinates","frustumStatisticText","tileText","hasPickedPrimitive","hasPickedTile","pickPrimitiveActive","pickTileActive","dropDownVisible","generalVisible","primitivesVisible","terrainVisible","depthFrustumText"]),this._toggleDropDown=vn(function(){n.dropDownVisible=!n.dropDownVisible}),this._toggleGeneral=vn(function(){n.generalVisible=!n.generalVisible}),this._togglePrimitives=vn(function(){n.primitivesVisible=!n.primitivesVisible}),this._toggleTerrain=vn(function(){n.terrainVisible=!n.terrainVisible}),this._frustumsSubscription=be.getObservable(this,"frustums").subscribe(function(l){n._scene.debugShowFrustums=l,n._scene.requestRender()}),this._frustumPlanesSubscription=be.getObservable(this,"frustumPlanes").subscribe(function(l){n._scene.debugShowFrustumPlanes=l,n._scene.requestRender()}),this._performanceSubscription=be.getObservable(this,"performance").subscribe(function(l){l?n._performanceDisplay=new sy({container:n._performanceContainer}):n._performanceContainer.innerHTML=""}),this._showPrimitiveBoundingSphere=vn(function(){return n._primitive.debugShowBoundingVolume=n.primitiveBoundingSphere,n._scene.requestRender(),!0}),this._primitiveBoundingSphereSubscription=be.getObservable(this,"primitiveBoundingSphere").subscribe(function(){n._showPrimitiveBoundingSphere()}),this._showPrimitiveReferenceFrame=vn(function(){if(n.primitiveReferenceFrame){let l=n._primitive.modelMatrix;n._modelMatrixPrimitive=new W5({modelMatrix:l}),n._scene.primitives.add(n._modelMatrixPrimitive)}else u(n._modelMatrixPrimitive)&&(n._scene.primitives.remove(n._modelMatrixPrimitive),n._modelMatrixPrimitive=void 0);return n._scene.requestRender(),!0}),this._primitiveReferenceFrameSubscription=be.getObservable(this,"primitiveReferenceFrame").subscribe(function(){n._showPrimitiveReferenceFrame()}),this._doFilterPrimitive=vn(function(){return n.filterPrimitive?n._scene.debugCommandFilter=function(l){return u(n._modelMatrixPrimitive)&&l.owner===n._modelMatrixPrimitive._primitive?!0:u(n._primitive)?l.owner===n._primitive||l.owner===n._primitive._billboardCollection||l.owner.primitive===n._primitive:!1}:n._scene.debugCommandFilter=void 0,!0}),this._filterPrimitiveSubscription=be.getObservable(this,"filterPrimitive").subscribe(function(){n._doFilterPrimitive(),n._scene.requestRender()}),this._wireframeSubscription=be.getObservable(this,"wireframe").subscribe(function(l){r._surface.tileProvider._debug.wireframe=l,n._scene.requestRender()}),this._depthFrustumSubscription=be.getObservable(this,"depthFrustum").subscribe(function(l){n._scene.debugShowDepthFrustum=l,n._scene.requestRender()}),this._incrementDepthFrustum=vn(function(){let l=n.depthFrustum+1;return n.depthFrustum=c$(1,n._numberOfFrustums,l),n._scene.requestRender(),!0}),this._decrementDepthFrustum=vn(function(){let l=n.depthFrustum-1;return n.depthFrustum=c$(1,n._numberOfFrustums,l),n._scene.requestRender(),!0}),this._suspendUpdatesSubscription=be.getObservable(this,"suspendUpdates").subscribe(function(l){r._surface._debug.suspendLodUpdate=l,l||(n.filterTile=!1)});let s;this._showTileCoordinates=vn(function(){return n.tileCoordinates&&!u(s)?s=e.imageryLayers.addImageryProvider(new cH({tilingScheme:e.terrainProvider.tilingScheme})):!n.tileCoordinates&&u(s)&&(e.imageryLayers.remove(s),s=void 0),!0}),this._tileCoordinatesSubscription=be.getObservable(this,"tileCoordinates").subscribe(function(){n._showTileCoordinates(),n._scene.requestRender()}),this._tileBoundingSphereSubscription=be.getObservable(this,"tileBoundingSphere").subscribe(function(){n._showTileBoundingSphere(),n._scene.requestRender()}),this._showTileBoundingSphere=vn(function(){return n.tileBoundingSphere?r._surface.tileProvider._debug.boundingSphereTile=n._tile:r._surface.tileProvider._debug.boundingSphereTile=void 0,n._scene.requestRender(),!0}),this._doFilterTile=vn(function(){return n.filterTile?(n.suspendUpdates=!0,r._surface._tilesToRender=[],u(n._tile)&&n._tile.renderable&&r._surface._tilesToRender.push(n._tile)):n.suspendUpdates=!1,!0}),this._filterTileSubscription=be.getObservable(this,"filterTile").subscribe(function(){n.doFilterTile(),n._scene.requestRender()});function a(l){let f=n._scene.pick({x:l.position.x,y:l.position.y});u(f)&&(n.primitive=u(f.collection)?f.collection:f.primitive),n._scene.requestRender(),n.pickPrimitiveActive=!1}this._pickPrimitive=vn(function(){n.pickPrimitiveActive=!n.pickPrimitiveActive}),this._pickPrimitiveActiveSubscription=be.getObservable(this,"pickPrimitiveActive").subscribe(function(l){l?o.setInputAction(a,Cn.LEFT_CLICK):o.removeInputAction(Cn.LEFT_CLICK)});function c(l){let f,d=r.ellipsoid,p=n._scene.camera.getPickRay(l.position,_St),g=r.pick(p,n._scene,gSt);if(u(g)){let m=d.cartesianToCartographic(g),y=r._surface.tileProvider._tilesToRenderByTextureCount;for(let b=0;!f&&b<y.length;++b){let C=y[b];if(u(C))for(let A=0;!f&&A<C.length;++A){let T=C[A];se.contains(T.rectangle,m)&&(f=T)}}}n.tile=f,n.pickTileActive=!1}this._pickTile=vn(function(){n.pickTileActive=!n.pickTileActive}),this._pickTileActiveSubscription=be.getObservable(this,"pickTileActive").subscribe(function(l){l?o.setInputAction(c,Cn.LEFT_CLICK):o.removeInputAction(Cn.LEFT_CLICK)}),this._removePostRenderEvent=e.postRender.addEventListener(function(){n._update()})}Object.defineProperties(WI.prototype,{scene:{get:function(){return this._scene}},performanceContainer:{get:function(){return this._performanceContainer}},toggleDropDown:{get:function(){return this._toggleDropDown}},showPrimitiveBoundingSphere:{get:function(){return this._showPrimitiveBoundingSphere}},showPrimitiveReferenceFrame:{get:function(){return this._showPrimitiveReferenceFrame}},doFilterPrimitive:{get:function(){return this._doFilterPrimitive}},incrementDepthFrustum:{get:function(){return this._incrementDepthFrustum}},decrementDepthFrustum:{get:function(){return this._decrementDepthFrustum}},showTileCoordinates:{get:function(){return this._showTileCoordinates}},showTileBoundingSphere:{get:function(){return this._showTileBoundingSphere}},doFilterTile:{get:function(){return this._doFilterTile}},toggleGeneral:{get:function(){return this._toggleGeneral}},togglePrimitives:{get:function(){return this._togglePrimitives}},toggleTerrain:{get:function(){return this._toggleTerrain}},pickPrimitive:{get:function(){return this._pickPrimitive}},pickTile:{get:function(){return this._pickTile}},selectParent:{get:function(){let e=this;return vn(function(){e.tile=e.tile.parent})}},selectNW:{get:function(){let e=this;return vn(function(){e.tile=e.tile.northwestChild})}},selectNE:{get:function(){let e=this;return vn(function(){e.tile=e.tile.northeastChild})}},selectSW:{get:function(){let e=this;return vn(function(){e.tile=e.tile.southwestChild})}},selectSE:{get:function(){let e=this;return vn(function(){e.tile=e.tile.southeastChild})}},primitive:{get:function(){return this._primitive},set:function(e){let t=this._primitive;e!==t&&(this.hasPickedPrimitive=!0,u(t)&&(t.debugShowBoundingVolume=!1),this._scene.debugCommandFilter=void 0,u(this._modelMatrixPrimitive)&&(this._scene.primitives.remove(this._modelMatrixPrimitive),this._modelMatrixPrimitive=void 0),this._primitive=e,e.show=!1,setTimeout(function(){e.show=!0},50),this.showPrimitiveBoundingSphere(),this.showPrimitiveReferenceFrame(),this.doFilterPrimitive())}},tile:{get:function(){return this._tile},set:function(e){if(u(e)){this.hasPickedTile=!0;let t=this._tile;if(e!==t){this.tileText=`L: ${e.level} X: ${e.x} Y: ${e.y}`,this.tileText+=`<br>SW corner: ${e.rectangle.west}, ${e.rectangle.south}`,this.tileText+=`<br>NE corner: ${e.rectangle.east}, ${e.rectangle.north}`;let n=e.data;u(n)&&u(n.tileBoundingRegion)?this.tileText+=`<br>Min: ${n.tileBoundingRegion.minimumHeight} Max: ${n.tileBoundingRegion.maximumHeight}`:this.tileText+="<br>(Tile is not loaded)"}this._tile=e,this.showTileBoundingSphere(),this.doFilterTile()}else this.hasPickedTile=!1,this._tile=void 0}}});WI.prototype._update=function(){this.frustums&&(this.frustumStatisticText=pSt(this._scene.debugFrustumStatistics));let e=this._scene.numberOfFrustums;this._numberOfFrustums=e,this.depthFrustum=c$(1,e,this.depthFrustum),this.depthFrustumText=`${this.depthFrustum} of ${e}`,this.performance&&this._performanceDisplay.update(),this.primitiveReferenceFrame&&(this._modelMatrixPrimitive.modelMatrix=this._primitive.modelMatrix),this.shaderCacheText=`Cached shaders: ${this._scene.context.shaderCache.numberOfShaders}`};WI.prototype.isDestroyed=function(){return!1};WI.prototype.destroy=function(){return this._eventHandler.destroy(),this._removePostRenderEvent(),this._frustumsSubscription.dispose(),this._frustumPlanesSubscription.dispose(),this._performanceSubscription.dispose(),this._primitiveBoundingSphereSubscription.dispose(),this._primitiveReferenceFrameSubscription.dispose(),this._filterPrimitiveSubscription.dispose(),this._wireframeSubscription.dispose(),this._depthFrustumSubscription.dispose(),this._suspendUpdatesSubscription.dispose(),this._tileCoordinatesSubscription.dispose(),this._tileBoundingSphereSubscription.dispose(),this._filterTileSubscription.dispose(),this._pickPrimitiveActiveSubscription.dispose(),this._pickTileActiveSubscription.dispose(),ue(this)};var DH=WI;function IH(e,t){e=Rn(e);let n=document.createElement("div"),i=new DH(t,n);this._viewModel=i,this._container=e;let o=document.createElement("div");this._element=o;let r=document.createElement("div");r.textContent="Cesium Inspector",r.className="cesium-cesiumInspector-button",r.setAttribute("data-bind","click: toggleDropDown"),o.appendChild(r),o.className="cesium-cesiumInspector",o.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : dropDownVisible, "cesium-cesiumInspector-hidden" : !dropDownVisible }'),e.appendChild(this._element);let s=document.createElement("div");s.className="cesium-cesiumInspector-dropDown",o.appendChild(s);let a=gc.createSection,c=gc.createCheckbox,l=a(s,"General","generalVisible","toggleGeneral"),f=c("Show Frustums","frustums"),d=document.createElement("div");d.className="cesium-cesiumInspector-frustumStatistics",d.setAttribute("data-bind","visible: frustums, html: frustumStatisticText"),f.appendChild(d),l.appendChild(f),l.appendChild(c("Show Frustum Planes","frustumPlanes")),l.appendChild(c("Performance Display","performance")),n.className="cesium-cesiumInspector-performanceDisplay",l.appendChild(n);let p=document.createElement("div");p.className="cesium-cesiumInspector-shaderCache",p.setAttribute("data-bind","html: shaderCacheText"),l.appendChild(p);let g=document.createElement("div");l.appendChild(g);let m=document.createElement("span");m.setAttribute("data-bind",'html: "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Frustum:"'),g.appendChild(m);let y=document.createElement("span");y.setAttribute("data-bind","text: depthFrustumText"),g.appendChild(y);let b=document.createElement("input");b.type="button",b.value="-",b.className="cesium-cesiumInspector-pickButton",b.setAttribute("data-bind","click: decrementDepthFrustum"),g.appendChild(b);let C=document.createElement("input");C.type="button",C.value="+",C.className="cesium-cesiumInspector-pickButton",C.setAttribute("data-bind","click: incrementDepthFrustum"),g.appendChild(C);let A=a(s,"Primitives","primitivesVisible","togglePrimitives"),T=document.createElement("div");T.className="cesium-cesiumInspector-pickSection",A.appendChild(T);let E=document.createElement("input");E.type="button",E.value="Pick a primitive",E.className="cesium-cesiumInspector-pickButton",E.setAttribute("data-bind",'css: {"cesium-cesiumInspector-pickButtonHighlight" : pickPrimitiveActive}, click: pickPrimitive');let v=document.createElement("div");v.className="cesium-cesiumInspector-center",v.appendChild(E),T.appendChild(v),T.appendChild(c("Show bounding sphere","primitiveBoundingSphere","hasPickedPrimitive")),T.appendChild(c("Show reference frame","primitiveReferenceFrame","hasPickedPrimitive")),this._primitiveOnly=c("Show only selected","filterPrimitive","hasPickedPrimitive"),T.appendChild(this._primitiveOnly);let D=a(s,"Terrain","terrainVisible","toggleTerrain"),O=document.createElement("div");O.className="cesium-cesiumInspector-pickSection",D.appendChild(O);let P=document.createElement("input");P.type="button",P.value="Pick a tile",P.className="cesium-cesiumInspector-pickButton",P.setAttribute("data-bind",'css: {"cesium-cesiumInspector-pickButtonHighlight" : pickTileActive}, click: pickTile'),v=document.createElement("div"),v.appendChild(P),v.className="cesium-cesiumInspector-center",O.appendChild(v);let M=document.createElement("div");O.appendChild(M);let L=document.createElement("input");L.type="button",L.value="Parent",L.className="cesium-cesiumInspector-pickButton",L.setAttribute("data-bind","click: selectParent");let _=document.createElement("input");_.type="button",_.value="NW",_.className="cesium-cesiumInspector-pickButton",_.setAttribute("data-bind","click: selectNW");let S=document.createElement("input");S.type="button",S.value="NE",S.className="cesium-cesiumInspector-pickButton",S.setAttribute("data-bind","click: selectNE");let w=document.createElement("input");w.type="button",w.value="SW",w.className="cesium-cesiumInspector-pickButton",w.setAttribute("data-bind","click: selectSW");let I=document.createElement("input");I.type="button",I.value="SE",I.className="cesium-cesiumInspector-pickButton",I.setAttribute("data-bind","click: selectSE");let N=document.createElement("div");N.className="cesium-cesiumInspector-tileText",M.className="cesium-cesiumInspector-frustumStatistics",M.appendChild(N),M.setAttribute("data-bind","visible: hasPickedTile"),N.setAttribute("data-bind","html: tileText");let k=document.createElement("div");k.className="cesium-cesiumInspector-relativeText",k.textContent="Select relative:",M.appendChild(k);let z=document.createElement("table"),V=document.createElement("tr"),U=document.createElement("tr"),B=document.createElement("td");B.appendChild(L);let W=document.createElement("td");W.appendChild(_);let j=document.createElement("td");j.appendChild(S),V.appendChild(B),V.appendChild(W),V.appendChild(j);let Q=document.createElement("td"),q=document.createElement("td");q.appendChild(w);let X=document.createElement("td");X.appendChild(I),U.appendChild(Q),U.appendChild(q),U.appendChild(X),z.appendChild(V),z.appendChild(U),M.appendChild(z),O.appendChild(c("Show bounding volume","tileBoundingSphere","hasPickedTile")),O.appendChild(c("Show only selected","filterTile","hasPickedTile")),D.appendChild(c("Wireframe","wireframe")),D.appendChild(c("Suspend LOD update","suspendUpdates")),D.appendChild(c("Show tile coordinates","tileCoordinates")),be.applyBindings(i,this._element)}Object.defineProperties(IH.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});IH.prototype.isDestroyed=function(){return!1};IH.prototype.destroy=function(){return be.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),ue(this)};var PH=IH;function RH(e,t){u(t)||(t=document.body),t=Rn(t);let n=this,i=be.observable(Pr.fullscreen),o=be.observable(Pr.enabled),r=t.ownerDocument;this.isFullscreen=void 0,be.defineProperty(this,"isFullscreen",{get:function(){return i()}}),this.isFullscreenEnabled=void 0,be.defineProperty(this,"isFullscreenEnabled",{get:function(){return o()},set:function(s){o(s&&Pr.enabled)}}),this.tooltip=void 0,be.defineProperty(this,"tooltip",function(){return this.isFullscreenEnabled?i()?"Exit full screen":"Full screen":"Full screen unavailable"}),this._command=vn(function(){Pr.fullscreen?Pr.exitFullscreen():Pr.requestFullscreen(n._fullscreenElement)},be.getObservable(this,"isFullscreenEnabled")),this._fullscreenElement=x(Rn(e),r.body),this._callback=function(){i(Pr.fullscreen)},r.addEventListener(Pr.changeEventName,this._callback)}Object.defineProperties(RH.prototype,{fullscreenElement:{get:function(){return this._fullscreenElement},set:function(e){this._fullscreenElement=e}},command:{get:function(){return this._command}}});RH.prototype.isDestroyed=function(){return!1};RH.prototype.destroy=function(){document.removeEventListener(Pr.changeEventName,this._callback),ue(this)};var OH=RH;var ySt="M 83.96875 17.5625 L 83.96875 17.59375 L 76.65625 24.875 L 97.09375 24.96875 L 76.09375 45.96875 L 81.9375 51.8125 L 102.78125 30.9375 L 102.875 51.15625 L 110.15625 43.875 L 110.1875 17.59375 L 83.96875 17.5625 z M 44.125 17.59375 L 17.90625 17.625 L 17.9375 43.90625 L 25.21875 51.1875 L 25.3125 30.96875 L 46.15625 51.8125 L 52 45.96875 L 31 25 L 51.4375 24.90625 L 44.125 17.59375 z M 46.0625 76.03125 L 25.1875 96.875 L 25.09375 76.65625 L 17.8125 83.9375 L 17.8125 110.21875 L 44 110.25 L 51.3125 102.9375 L 30.90625 102.84375 L 51.875 81.875 L 46.0625 76.03125 z M 82 76.15625 L 76.15625 82 L 97.15625 103 L 76.71875 103.0625 L 84.03125 110.375 L 110.25 110.34375 L 110.21875 84.0625 L 102.9375 76.8125 L 102.84375 97 L 82 76.15625 z",xSt="M 104.34375 17.5625 L 83.5 38.4375 L 83.40625 18.21875 L 76.125 25.5 L 76.09375 51.78125 L 102.3125 51.8125 L 102.3125 51.78125 L 109.625 44.5 L 89.1875 44.40625 L 110.1875 23.40625 L 104.34375 17.5625 z M 23.75 17.59375 L 17.90625 23.4375 L 38.90625 44.4375 L 18.5 44.53125 L 25.78125 51.8125 L 52 51.78125 L 51.96875 25.53125 L 44.6875 18.25 L 44.625 38.46875 L 23.75 17.59375 z M 25.6875 76.03125 L 18.375 83.3125 L 38.78125 83.40625 L 17.8125 104.40625 L 23.625 110.25 L 44.5 89.375 L 44.59375 109.59375 L 51.875 102.3125 L 51.875 76.0625 L 25.6875 76.03125 z M 102.375 76.15625 L 76.15625 76.1875 L 76.1875 102.4375 L 83.46875 109.71875 L 83.5625 89.53125 L 104.40625 110.375 L 110.25 104.53125 L 89.25 83.53125 L 109.6875 83.46875 L 102.375 76.15625 z";function MH(e,t){e=Rn(e);let n=new OH(t,e);n._exitFullScreenPath=xSt,n._enterFullScreenPath=ySt;let i=document.createElement("button");i.type="button",i.className="cesium-button cesium-fullscreenButton",i.setAttribute("data-bind","attr: { title: tooltip },click: command,enable: isFullscreenEnabled,cesiumSvgPath: { path: isFullscreen ? _exitFullScreenPath : _enterFullScreenPath, width: 128, height: 128 }"),e.appendChild(i),be.applyBindings(n,i),this._container=e,this._viewModel=n,this._element=i}Object.defineProperties(MH.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});MH.prototype.isDestroyed=function(){return!1};MH.prototype.destroy=function(){return this._viewModel.destroy(),be.cleanNode(this._element),this._container.removeChild(this._element),ue(this)};var LH=MH;var BEe=1e3;function nd(e){u(e.geocoderServices)?this._geocoderServices=e.geocoderServices:this._geocoderServices=[new iU({scene:e.scene})],this._viewContainer=e.container,this._scene=e.scene,this._flightDuration=e.flightDuration,this._searchText="",this._isSearchInProgress=!1,this._wasGeocodeCancelled=!1,this._previousCredits=[],this._complete=new me,this._suggestions=[],this._selectedSuggestion=void 0,this._showSuggestions=!0,this._handleArrowDown=VEe,this._handleArrowUp=kEe;let t=this;this._suggestionsVisible=be.pureComputed(function(){let o=be.getObservable(t,"_suggestions")().length>0,r=be.getObservable(t,"_showSuggestions")();return o&&r}),this._searchCommand=vn(function(i){if(i=x(i,db.SEARCH),t._focusTextbox=!1,u(t._selectedSuggestion))return t.activateSuggestion(t._selectedSuggestion),!1;if(t.hideSuggestions(),t.isSearchInProgress)SSt(t);else return TSt(t,t._geocoderServices,i)}),this.deselectSuggestion=function(){t._selectedSuggestion=void 0},this.handleKeyDown=function(i,o){let r=o.key==="ArrowDown"||o.key==="Down"||o.keyCode===40,s=o.key==="ArrowUp"||o.key==="Up"||o.keyCode===38;return(r||s)&&o.preventDefault(),!0},this.handleKeyUp=function(i,o){let r=o.key==="ArrowDown"||o.key==="Down"||o.keyCode===40,s=o.key==="ArrowUp"||o.key==="Up"||o.keyCode===38,a=o.key==="Enter"||o.keyCode===13;return s?kEe(t):r?VEe(t):a&&t._searchCommand(),!0},this.activateSuggestion=function(i){t.hideSuggestions(),t._searchText=i.displayName;let o=i.destination;HEe(t),t.destinationFound(t,o)},this.hideSuggestions=function(){t._showSuggestions=!1,t._selectedSuggestion=void 0},this.showSuggestions=function(){t._showSuggestions=!0},this.handleMouseover=function(i,o){i!==t._selectedSuggestion&&(t._selectedSuggestion=i)},this.keepExpanded=!1,this.autoComplete=x(e.autocomplete,!0),this.destinationFound=x(e.destinationFound,nd.flyToDestination),this._focusTextbox=!1,be.track(this,["_searchText","_isSearchInProgress","keepExpanded","_suggestions","_selectedSuggestion","_showSuggestions","_focusTextbox"]);let n=be.getObservable(this,"_searchText");n.extend({rateLimit:{timeout:500}}),this._suggestionSubscription=n.subscribe(function(){nd._updateSearchSuggestions(t)}),this.isSearchInProgress=void 0,be.defineProperty(this,"isSearchInProgress",{get:function(){return this._isSearchInProgress}}),this.searchText=void 0,be.defineProperty(this,"searchText",{get:function(){return this.isSearchInProgress?"Searching...":this._searchText},set:function(i){this._searchText=i}}),this.flightDuration=void 0,be.defineProperty(this,"flightDuration",{get:function(){return this._flightDuration},set:function(i){this._flightDuration=i}})}Object.defineProperties(nd.prototype,{complete:{get:function(){return this._complete}},scene:{get:function(){return this._scene}},search:{get:function(){return this._searchCommand}},selectedSuggestion:{get:function(){return this._selectedSuggestion}},suggestions:{get:function(){return this._suggestions}}});nd.prototype.destroy=function(){this._suggestionSubscription.dispose()};function kEe(e){if(e._suggestions.length===0)return;let t=e._suggestions.indexOf(e._selectedSuggestion);if(t===-1||t===0){e._selectedSuggestion=void 0;return}let n=t-1;e._selectedSuggestion=e._suggestions[n],nd._adjustSuggestionsScroll(e,n)}function VEe(e){if(e._suggestions.length===0)return;let t=e._suggestions.length,i=(e._suggestions.indexOf(e._selectedSuggestion)+1)%t;e._selectedSuggestion=e._suggestions[i],nd._adjustSuggestionsScroll(e,i)}function bSt(e,t){let n=u(t)?t.availability:void 0;return u(n)?NE(t,[e]).then(function(i){return e=i[0],e.height+=BEe,e}):(e.height+=BEe,Promise.resolve(e))}function CSt(e,t){let n=e._scene,i=n.ellipsoid,o=n.camera,r=n.terrainProvider,s=t,a;return t instanceof se?R.equalsEpsilon(t.south,t.north,R.EPSILON7)&&R.equalsEpsilon(t.east,t.west,R.EPSILON7)?t=se.center(t):a=kE(t,n):t=i.cartesianToCartographic(t),u(a)||(a=bSt(t,r)),a.then(function(c){s=i.cartographicToCartesian(c)}).finally(function(){o.flyTo({destination:s,complete:function(){e._complete.raiseEvent()},duration:e._flightDuration,endTransform:F.IDENTITY})})}async function ASt(e,t,n){try{return{state:"fulfilled",value:await e.geocode(t,n),credits:e.credit}}catch(i){return{state:"rejected",reason:i}}}async function TSt(e,t,n){let i=e._searchText;if(zEe(i)){e.showSuggestions();return}e._isSearchInProgress=!0,e._wasGeocodeCancelled=!1;let o,r;for(o=0;o<t.length;o++){if(e._wasGeocodeCancelled)return;if(r=await ASt(t[o],i,n),u(r)&&r.state==="fulfilled"&&r.value.length>0)break}if(e._wasGeocodeCancelled)return;e._isSearchInProgress=!1,u$(e);let s=r.value;if(r.state==="fulfilled"&&u(s)&&s.length>0){e._searchText=s[0].displayName,e.destinationFound(e,s[0].destination);let a=UEe(e,ED.getCreditsFromResult(s[0]));u(a)||l$(e,t[o].credit);return}e._searchText=`${i} (not found)`}function l$(e,t){u(t)&&!e._scene.isDestroyed()&&!e._scene.frameState.creditDisplay.isDestroyed()&&(e._scene.frameState.creditDisplay.addStaticCredit(t),e._previousCredits.push(t))}function UEe(e,t){return u(t)&&t.forEach(n=>l$(e,n)),t}function u$(e){!e._scene.isDestroyed()&&!e._scene.frameState.creditDisplay.isDestroyed()&&e._previousCredits.forEach(t=>{e._scene.frameState.creditDisplay.removeStaticCredit(t)}),e._previousCredits.length=0}function ESt(e,t){let n=Rn(e._viewContainer),i=n.getElementsByClassName("search-results")[0],r=n.getElementsByTagName("li")[t];if(t===0){i.scrollTop=0;return}let s=r.offsetTop;s+r.clientHeight>i.clientHeight?i.scrollTop=s+r.clientHeight:s<i.scrollTop&&(i.scrollTop=s)}function SSt(e){e._isSearchInProgress&&(e._isSearchInProgress=!1,e._wasGeocodeCancelled=!0)}function zEe(e){return/^\s*$/.test(e)}function HEe(e){be.getObservable(e,"_suggestions").removeAll()}async function vSt(e){if(!e.autoComplete)return;let t=e._searchText;if(HEe(e),u$(e),!zEe(t))for(let n of e._geocoderServices){let i=await n.geocode(t,db.AUTOCOMPLETE);if(e._suggestions=e._suggestions.concat(i),i.length>0){let o=!0;i.forEach(r=>{let s=ED.getCreditsFromResult(r);o=o&&!u(s),UEe(e,s)}),o&&l$(e,n.credit)}if(e._suggestions.length>=5)return}}nd.flyToDestination=CSt;nd._updateSearchSuggestions=vSt;nd._adjustSuggestionsScroll=ESt;nd.prototype.isDestroyed=function(){return!1};nd.prototype.destroy=function(){return u$(this),ue(this)};var NH=nd;var wSt="M29.772,26.433l-7.126-7.126c0.96-1.583,1.523-3.435,1.524-5.421C24.169,8.093,19.478,3.401,13.688,3.399C7.897,3.401,3.204,8.093,3.204,13.885c0,5.789,4.693,10.481,10.484,10.481c1.987,0,3.839-0.563,5.422-1.523l7.128,7.127L29.772,26.433zM7.203,13.885c0.006-3.582,2.903-6.478,6.484-6.486c3.579,0.008,6.478,2.904,6.484,6.486c-0.007,3.58-2.905,6.476-6.484,6.484C10.106,20.361,7.209,17.465,7.203,13.885z",DSt="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z";function FH(e){let t=Rn(e.container),n=new NH(e);n._startSearchPath=wSt,n._stopSearchPath=DSt;let i=document.createElement("form");i.setAttribute("data-bind","submit: search");let o=document.createElement("input");o.type="search",o.className="cesium-geocoder-input",o.setAttribute("placeholder","Enter an address or landmark..."),o.setAttribute("data-bind",'textInput: searchText,disable: isSearchInProgress,event: { keyup: handleKeyUp, keydown: handleKeyDown, mouseover: deselectSuggestion },css: { "cesium-geocoder-input-wide" : keepExpanded || searchText.length > 0 },hasFocus: _focusTextbox'),this._onTextBoxFocus=function(){setTimeout(function(){o.select()},0)},o.addEventListener("focus",this._onTextBoxFocus,!1),i.appendChild(o),this._textBox=o;let r=document.createElement("span");r.className="cesium-geocoder-searchButton",r.setAttribute("data-bind","click: search,cesiumSvgPath: { path: isSearchInProgress ? _stopSearchPath : _startSearchPath, width: 32, height: 32 }"),i.appendChild(r),t.appendChild(i);let s=document.createElement("div");s.className="search-results",s.setAttribute("data-bind","visible: _suggestionsVisible");let a=document.createElement("ul");a.setAttribute("data-bind","foreach: _suggestions");let c=document.createElement("li");a.appendChild(c),c.setAttribute("data-bind","text: $data.displayName, click: $parent.activateSuggestion, event: { mouseover: $parent.handleMouseover}, css: { active: $data === $parent._selectedSuggestion }"),s.appendChild(a),t.appendChild(s),be.applyBindings(n,i),be.applyBindings(n,s),this._container=t,this._searchSuggestionsContainer=s,this._viewModel=n,this._form=i,this._onInputBegin=function(l){let f=l.target;typeof l.composedPath=="function"&&(f=l.composedPath()[0]),t.contains(f)||(n._focusTextbox=!1,n.hideSuggestions())},this._onInputEnd=function(l){n._focusTextbox=!0,n.showSuggestions()},Wt.supportsPointerEvents()?(document.addEventListener("pointerdown",this._onInputBegin,!0),t.addEventListener("pointerup",this._onInputEnd,!0),t.addEventListener("pointercancel",this._onInputEnd,!0)):(document.addEventListener("mousedown",this._onInputBegin,!0),t.addEventListener("mouseup",this._onInputEnd,!0),document.addEventListener("touchstart",this._onInputBegin,!0),t.addEventListener("touchend",this._onInputEnd,!0),t.addEventListener("touchcancel",this._onInputEnd,!0))}Object.defineProperties(FH.prototype,{container:{get:function(){return this._container}},searchSuggestionsContainer:{get:function(){return this._searchSuggestionsContainer}},viewModel:{get:function(){return this._viewModel}}});FH.prototype.isDestroyed=function(){return!1};FH.prototype.destroy=function(){let e=this._container;return Wt.supportsPointerEvents()?(document.removeEventListener("pointerdown",this._onInputBegin,!0),e.removeEventListener("pointerup",this._onInputEnd,!0)):(document.removeEventListener("mousedown",this._onInputBegin,!0),e.removeEventListener("mouseup",this._onInputEnd,!0),document.removeEventListener("touchstart",this._onInputBegin,!0),e.removeEventListener("touchend",this._onInputEnd,!0)),this._viewModel.destroy(),be.cleanNode(this._form),be.cleanNode(this._searchSuggestionsContainer),e.removeChild(this._form),e.removeChild(this._searchSuggestionsContainer),this._textBox.removeEventListener("focus",this._onTextBoxFocus,!1),ue(this)};var BH=FH;function GEe(e,t){this._scene=e,this._duration=t;let n=this;this._command=vn(function(){n._scene.camera.flyHome(n._duration)}),this.tooltip="View Home",be.track(this,["tooltip"])}Object.defineProperties(GEe.prototype,{scene:{get:function(){return this._scene}},command:{get:function(){return this._command}},duration:{get:function(){return this._duration},set:function(e){this._duration=e}}});var kH=GEe;function VH(e,t,n){e=Rn(e);let i=new kH(t,n);i._svgPath="M14,4l-10,8.75h20l-4.25-3.7188v-4.6562h-2.812v2.1875l-2.938-2.5625zm-7.0938,9.906v10.094h14.094v-10.094h-14.094zm2.1876,2.313h3.3122v4.25h-3.3122v-4.25zm5.8442,1.281h3.406v6.438h-3.406v-6.438z";let o=document.createElement("button");o.type="button",o.className="cesium-button cesium-toolbar-button cesium-home-button",o.setAttribute("data-bind","attr: { title: tooltip },click: command,cesiumSvgPath: { path: _svgPath, width: 28, height: 28 }"),e.appendChild(o),be.applyBindings(i,o),this._container=e,this._viewModel=i,this._element=o}Object.defineProperties(VH.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});VH.prototype.isDestroyed=function(){return!1};VH.prototype.destroy=function(){return be.cleanNode(this._element),this._container.removeChild(this._element),ue(this)};var UH=VH;var ISt="M 13.84375 7.03125 C 11.412798 7.03125 9.46875 8.975298 9.46875 11.40625 L 9.46875 11.59375 L 2.53125 7.21875 L 2.53125 24.0625 L 9.46875 19.6875 C 9.4853444 22.104033 11.423165 24.0625 13.84375 24.0625 L 25.875 24.0625 C 28.305952 24.0625 30.28125 22.087202 30.28125 19.65625 L 30.28125 11.40625 C 30.28125 8.975298 28.305952 7.03125 25.875 7.03125 L 13.84375 7.03125 z",PSt="M 27.34375 1.65625 L 5.28125 27.9375 L 8.09375 30.3125 L 30.15625 4.03125 L 27.34375 1.65625 z M 13.84375 7.03125 C 11.412798 7.03125 9.46875 8.975298 9.46875 11.40625 L 9.46875 11.59375 L 2.53125 7.21875 L 2.53125 24.0625 L 9.46875 19.6875 C 9.4724893 20.232036 9.5676108 20.7379 9.75 21.21875 L 21.65625 7.03125 L 13.84375 7.03125 z M 28.21875 7.71875 L 14.53125 24.0625 L 25.875 24.0625 C 28.305952 24.0625 30.28125 22.087202 30.28125 19.65625 L 30.28125 11.40625 C 30.28125 9.8371439 29.456025 8.4902779 28.21875 7.71875 z";function f$(){this._cameraClicked=new me,this._closeClicked=new me,this.maxHeight=500,this.enableCamera=!1,this.isCameraTracking=!1,this.showInfo=!1,this.titleText="",this.description="",be.track(this,["showInfo","titleText","description","maxHeight","enableCamera","isCameraTracking"]),this._loadingIndicatorHtml='<div class="cesium-infoBox-loadingContainer"><span class="cesium-infoBox-loading"></span></div>',this.cameraIconPath=void 0,be.defineProperty(this,"cameraIconPath",{get:function(){return!this.enableCamera||this.isCameraTracking?PSt:ISt}}),be.defineProperty(this,"_bodyless",{get:function(){return!u(this.description)||this.description.length===0}})}f$.prototype.maxHeightOffset=function(e){return`${this.maxHeight-e}px`};Object.defineProperties(f$.prototype,{cameraClicked:{get:function(){return this._cameraClicked}},closeClicked:{get:function(){return this._closeClicked}}});var zH=f$;function HH(e){e=Rn(e);let t=document.createElement("div");t.className="cesium-infoBox",t.setAttribute("data-bind",'css: { "cesium-infoBox-visible" : showInfo, "cesium-infoBox-bodyless" : _bodyless }'),e.appendChild(t);let n=document.createElement("div");n.className="cesium-infoBox-title",n.setAttribute("data-bind","text: titleText"),t.appendChild(n);let i=document.createElement("button");i.type="button",i.className="cesium-button cesium-infoBox-camera",i.setAttribute("data-bind",'attr: { title: "Focus camera on object" },click: function () { cameraClicked.raiseEvent(this); },enable: enableCamera,cesiumSvgPath: { path: cameraIconPath, width: 32, height: 32 }'),t.appendChild(i);let o=document.createElement("button");o.type="button",o.className="cesium-infoBox-close",o.setAttribute("data-bind","click: function () { closeClicked.raiseEvent(this); }"),o.innerHTML="&times;",t.appendChild(o);let r=document.createElement("iframe");r.className="cesium-infoBox-iframe",r.setAttribute("sandbox","allow-same-origin allow-popups allow-forms"),r.setAttribute("data-bind","style : { maxHeight : maxHeightOffset(40) }"),r.setAttribute("allowfullscreen",!0),t.appendChild(r);let s=new zH;be.applyBindings(s,t),this._container=e,this._element=t,this._frame=r,this._viewModel=s,this._descriptionSubscription=void 0;let a=this;r.addEventListener("load",function(){let c=r.contentDocument,l=c.createElement("link");l.href=on("Widgets/InfoBox/InfoBoxDescription.css"),l.rel="stylesheet",l.type="text/css";let f=c.createElement("div");f.className="cesium-infoBox-description",c.head.appendChild(l),c.body.appendChild(f),a._descriptionSubscription=Ba(s,"description",function(d){r.style.height="5px",f.innerHTML=d;let p=null,g=f.firstElementChild;if(g!==null&&f.childNodes.length===1){let y=window.getComputedStyle(g);if(y!==null){let b=y["background-color"],C=G.fromCssColorString(b);u(C)&&C.alpha!==0&&(p=y["background-color"])}}t.style["background-color"]=p;let m=f.getBoundingClientRect().height;r.style.height=`${m}px`})}),r.setAttribute("src","about:blank")}Object.defineProperties(HH.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}},frame:{get:function(){return this._frame}}});HH.prototype.isDestroyed=function(){return!1};HH.prototype.destroy=function(){let e=this._container;return be.cleanNode(this._element),e.removeChild(this._element),u(this._descriptionSubscription)&&this._descriptionSubscription.dispose(),ue(this)};var GH=HH;function RSt(e,t){t.currentTarget.parentElement.parentElement.querySelector(`#${e.name}-expander`).classList.toggle("active"),t.currentTarget.textContent=t.currentTarget.textContent==="+"?"-":"+"}function jEe(e,t){be.track(e);for(let n=0;n<e.sublayers.length;n++)jEe(e.sublayers[n],t)}function WH(e){return e.modelName==="FullModel"}function qEe(e){return e.modelName==="Overview"}function YEe(e){return qEe(e)||WH(e)}function WEe(e,t){if(YEe(e)){e.visibility=!1;for(let i=0;i<e.sublayers.length;i++)e.sublayers[i].visibility=!0;let n={name:e.name,modelName:e.modelName,disable:be.observable(!1),index:t.sublayers.length};return t.topLayers.push(n),t.sublayers.push(e),n}}function OSt(e,t){if(YEe(e)){t.sublayers.forEach(i=>i.visibility=!1),t.sublayers[e.index].visibility=!0;let n=document.getElementById("bsl-wrapper");WH(e)?(t.currentLevel=t.selectedLevel,n.style.display="block"):(t.selectedLevel=t.currentLevel,t.currentLevel="All",n.style.display="none")}}async function MSt(e,t){try{let n=e.getAttributeNames();for(let i=0;i<n.length;i++)if(n[i]==="BldgLevel"){let o=e.getAttributeValues(n[i]);for(let r=0;r<o.length;r++)t.push(o[r])}t.sort((i,o)=>i-o),t.unshift("All")}catch(n){console.log(`There was an error getting attributes: ${n}`)}}function LSt(e){let t=this;this.levels=[],this.viewModel={sublayers:[],levels:this.levels,currentLevel:be.observable(),selectedLevel:"All",topLayers:[{name:"Select a layer to explore...",disable:be.observable(!0),index:-1}],currentLayer:be.observable(),expandClickHandler:RSt,setOptionDisable:function(i,o){be.applyBindingsToNode(i,{disable:o.disable},o)},defaultLayer:void 0},this.viewModel.currentLayer.subscribe(function(i){OSt(i,t.viewModel)});let n=e.sublayers;for(let i=0;i<n.length;i++){jEe(n[i],this.viewModel);let o=WEe(n[i],this.viewModel);u(o)&&(qEe(o)||!u(this.viewModel.defaultLayer)&&WH(o))&&(this.viewModel.defaultLayer=o)}if(this.viewModel.topLayers.length===1&&n.length>0){e.show=!1;let i={name:"Full Model",modelName:"FullModel",visibility:e.show,sublayers:e.sublayers};this.viewModel.defaultLayer=WEe(i,this.viewModel),this.viewModel.currentLayer.subscribe(function(o){e.show=WH(o)})}else this.viewModel.topLayers.length===1&&(this.viewModel.topLayers[0].name="Building layers not found");return MSt(e,this.levels),this.viewModel.currentLevel.subscribe(function(i){i!=="All"?e.filterByAttributes([{name:"BldgLevel",values:[i]}]):e.filterByAttributes()}),this.viewModel}var jH=LSt;function NSt(e,t){let n=document.getElementById(e),i=document.createElement("div");i.classList.add("cesium-viewer-i3s-explorer"),i.innerHTML=`
        <h3>Building explorer</h3>
        <select
          data-bind="options: topLayers, optionsText: 'name', optionsAfterRender: setOptionDisable, value: currentLayer"
        ></select>
        <div id="bsl-wrapper">
          <h3>Select Level</h3>
          <select data-bind="options: levels, value: currentLevel"></select>
          <h3>Disciplines & Categories</h3>
          <ul class="layersList" data-bind="foreach: sublayers">
            <ul class="layersList" data-bind="foreach: sublayers.sort(function (l, r) { return l.name.localeCompare(r.name) })">
              <li>
                <div class="li-wrapper">
                  <span
                    class="expandItem"
                    data-bind="click: $root.expandClickHandler"
                    >+</span
                  >
                  <input
                    type="checkbox"
                    data-bind="checked: visibility, valueUpdate: 'input', attr: { id: name}"
                  />
                  <label data-bind="attr: { for: name}">
                    <span data-bind="text: name"></span>
                  </label>
                </div>
                <ul class="nested" data-bind="attr: { id: name + '-expander'}">
                  <li data-bind="foreach: sublayers.sort(function (l, r) { return l.name.localeCompare(r.name) })">
                    <div class="li-wrapper">
                      <input
                        type="checkbox"
                        data-bind="checked: visibility, valueUpdate: 'input', attr: { id: name}"
                      />
                      <label data-bind="attr: { for: name}">
                        <span data-bind="text: name"></span>
                      </label>
                    </div>
                  </li>
                </ul>
              </li>
            </ul>
          </ul>
        </div>`,n.appendChild(i);let o=new jH(t);be.track(o),be.applyBindings(o,n),u(o.defaultLayer)&&(o.currentLayer=o.defaultLayer)}var XEe=NSt;function d$(e){this._scene=e.scene,this.lowFrameRateMessage=x(e.lowFrameRateMessage,"This application appears to be performing poorly on your system.  Please try using a different web browser or updating your video drivers."),this.lowFrameRateMessageDismissed=!1,this.showingLowFrameRateMessage=!1,be.track(this,["lowFrameRateMessage","lowFrameRateMessageDismissed","showingLowFrameRateMessage"]);let t=this;this._dismissMessage=vn(function(){t.showingLowFrameRateMessage=!1,t.lowFrameRateMessageDismissed=!0});let n=Y5.fromScene(e.scene);this._unsubscribeLowFrameRate=n.lowFrameRate.addEventListener(function(){t.lowFrameRateMessageDismissed||(t.showingLowFrameRateMessage=!0)}),this._unsubscribeNominalFrameRate=n.nominalFrameRate.addEventListener(function(){t.showingLowFrameRateMessage=!1})}Object.defineProperties(d$.prototype,{scene:{get:function(){return this._scene}},dismissMessage:{get:function(){return this._dismissMessage}}});d$.prototype.destroy=function(){return this._unsubscribeLowFrameRate(),this._unsubscribeNominalFrameRate(),ue(this)};var qH=d$;function YH(e){let t=Rn(e.container),n=new qH(e),i=document.createElement("div");i.className="cesium-performance-watchdog-message-area",i.setAttribute("data-bind","visible: showingLowFrameRateMessage");let o=document.createElement("button");o.setAttribute("type","button"),o.className="cesium-performance-watchdog-message-dismiss",o.innerHTML="&times;",o.setAttribute("data-bind","click: dismissMessage"),i.appendChild(o);let r=document.createElement("div");r.className="cesium-performance-watchdog-message",r.setAttribute("data-bind","html: lowFrameRateMessage"),i.appendChild(r),t.appendChild(i),be.applyBindings(n,i),this._container=t,this._viewModel=n,this._element=i}Object.defineProperties(YH.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});YH.prototype.isDestroyed=function(){return!1};YH.prototype.destroy=function(){return this._viewModel.destroy(),be.cleanNode(this._element),this._container.removeChild(this._element),ue(this)};var XH=YH;function KEe(){this.showInstructions=!1;let e=this;this._command=vn(function(){e.showInstructions=!e.showInstructions}),this._showClick=vn(function(){e._touch=!1}),this._showTouch=vn(function(){e._touch=!0}),this._touch=!1,this.tooltip="Navigation Instructions",be.track(this,["tooltip","showInstructions","_touch"])}Object.defineProperties(KEe.prototype,{command:{get:function(){return this._command}},showClick:{get:function(){return this._showClick}},showTouch:{get:function(){return this._showTouch}}});var KH=KEe;function ZH(e){let t=Rn(e.container),n=new KH,i=x(e.instructionsInitiallyVisible,!1);n.showInstructions=i,n._svgPath="M16,1.466C7.973,1.466,1.466,7.973,1.466,16c0,8.027,6.507,14.534,14.534,14.534c8.027,0,14.534-6.507,14.534-14.534C30.534,7.973,24.027,1.466,16,1.466z M17.328,24.371h-2.707v-2.596h2.707V24.371zM17.328,19.003v0.858h-2.707v-1.057c0-3.19,3.63-3.696,3.63-5.963c0-1.034-0.924-1.826-2.134-1.826c-1.254,0-2.354,0.924-2.354,0.924l-1.541-1.915c0,0,1.519-1.584,4.137-1.584c2.487,0,4.796,1.54,4.796,4.136C21.156,16.208,17.328,16.627,17.328,19.003z";let o=document.createElement("span");o.className="cesium-navigationHelpButton-wrapper",t.appendChild(o);let r=document.createElement("button");r.type="button",r.className="cesium-button cesium-toolbar-button cesium-navigation-help-button",r.setAttribute("data-bind","attr: { title: tooltip },click: command,cesiumSvgPath: { path: _svgPath, width: 32, height: 32 }"),o.appendChild(r);let s=document.createElement("div");s.className="cesium-navigation-help",s.setAttribute("data-bind",'css: { "cesium-navigation-help-visible" : showInstructions}'),o.appendChild(s);let a=document.createElement("button");a.type="button",a.className="cesium-navigation-button cesium-navigation-button-left",a.setAttribute("data-bind",'click: showClick, css: {"cesium-navigation-button-selected": !_touch, "cesium-navigation-button-unselected": _touch}');let c=document.createElement("img");c.src=on("Widgets/Images/NavigationHelp/Mouse.svg"),c.className="cesium-navigation-button-icon",c.style.width="25px",c.style.height="25px",a.appendChild(c),a.appendChild(document.createTextNode("Mouse"));let l=document.createElement("button");l.type="button",l.className="cesium-navigation-button cesium-navigation-button-right",l.setAttribute("data-bind",'click: showTouch, css: {"cesium-navigation-button-selected": _touch, "cesium-navigation-button-unselected": !_touch}');let f=document.createElement("img");f.src=on("Widgets/Images/NavigationHelp/Touch.svg"),f.className="cesium-navigation-button-icon",f.style.width="25px",f.style.height="25px",l.appendChild(f),l.appendChild(document.createTextNode("Touch")),s.appendChild(a),s.appendChild(l);let d=document.createElement("div");d.className="cesium-click-navigation-help cesium-navigation-help-instructions",d.setAttribute("data-bind",'css: { "cesium-click-navigation-help-visible" : !_touch}'),d.innerHTML=`            <table>                <tr>                    <td><img src="${on("Widgets/Images/NavigationHelp/MouseLeft.svg")}" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-pan">Pan view</div>                        <div class="cesium-navigation-help-details">Left click + drag</div>                    </td>                </tr>                <tr>                    <td><img src="${on("Widgets/Images/NavigationHelp/MouseRight.svg")}" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-zoom">Zoom view</div>                        <div class="cesium-navigation-help-details">Right click + drag, or</div>                        <div class="cesium-navigation-help-details">Mouse wheel scroll</div>                    </td>                </tr>                <tr>                    <td><img src="${on("Widgets/Images/NavigationHelp/MouseMiddle.svg")}" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-rotate">Rotate view</div>                        <div class="cesium-navigation-help-details">Middle click + drag, or</div>                        <div class="cesium-navigation-help-details">CTRL + Left/Right click + drag</div>                    </td>                </tr>            </table>`,s.appendChild(d);let p=document.createElement("div");p.className="cesium-touch-navigation-help cesium-navigation-help-instructions",p.setAttribute("data-bind",'css: { "cesium-touch-navigation-help-visible" : _touch}'),p.innerHTML=`            <table>                <tr>                    <td><img src="${on("Widgets/Images/NavigationHelp/TouchDrag.svg")}" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-pan">Pan view</div>                        <div class="cesium-navigation-help-details">One finger drag</div>                    </td>                </tr>                <tr>                    <td><img src="${on("Widgets/Images/NavigationHelp/TouchZoom.svg")}" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-zoom">Zoom view</div>                        <div class="cesium-navigation-help-details">Two finger pinch</div>                    </td>                </tr>                <tr>                    <td><img src="${on("Widgets/Images/NavigationHelp/TouchTilt.svg")}" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-rotate">Tilt view</div>                        <div class="cesium-navigation-help-details">Two finger drag, same direction</div>                    </td>                </tr>                <tr>                    <td><img src="${on("Widgets/Images/NavigationHelp/TouchRotate.svg")}" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-tilt">Rotate view</div>                        <div class="cesium-navigation-help-details">Two finger drag, opposite direction</div>                    </td>                </tr>            </table>`,s.appendChild(p),be.applyBindings(n,o),this._container=t,this._viewModel=n,this._wrapper=o,this._closeInstructions=function(g){o.contains(g.target)||(n.showInstructions=!1)},Wt.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeInstructions,!0):(document.addEventListener("mousedown",this._closeInstructions,!0),document.addEventListener("touchstart",this._closeInstructions,!0))}Object.defineProperties(ZH.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});ZH.prototype.isDestroyed=function(){return!1};ZH.prototype.destroy=function(){return Wt.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeInstructions,!0):(document.removeEventListener("mousedown",this._closeInstructions,!0),document.removeEventListener("touchstart",this._closeInstructions,!0)),be.cleanNode(this._wrapper),this._container.removeChild(this._wrapper),ue(this)};var $H=ZH;function QH(e,t){this._scene=e;let n=this,i=function(o,r,s,a){n.sceneMode=s,n.dropDownVisible=!1};this._eventHelper=new Ar,this._eventHelper.add(e.morphStart,i),this._duration=x(t,2),this.sceneMode=e.mode,this.dropDownVisible=!1,this.tooltip2D="2D",this.tooltip3D="3D",this.tooltipColumbusView="Columbus View",be.track(this,["sceneMode","dropDownVisible","tooltip2D","tooltip3D","tooltipColumbusView"]),this.selectedTooltip=void 0,be.defineProperty(this,"selectedTooltip",function(){let o=n.sceneMode;return o===ne.SCENE2D?n.tooltip2D:o===ne.SCENE3D?n.tooltip3D:n.tooltipColumbusView}),this._toggleDropDown=vn(function(){n.dropDownVisible=!n.dropDownVisible}),this._morphTo2D=vn(function(){e.morphTo2D(n._duration)}),this._morphTo3D=vn(function(){e.morphTo3D(n._duration)}),this._morphToColumbusView=vn(function(){e.morphToColumbusView(n._duration)}),this._sceneMode=ne}Object.defineProperties(QH.prototype,{scene:{get:function(){return this._scene}},duration:{get:function(){return this._duration},set:function(e){this._duration=e}},toggleDropDown:{get:function(){return this._toggleDropDown}},morphTo2D:{get:function(){return this._morphTo2D}},morphTo3D:{get:function(){return this._morphTo3D}},morphToColumbusView:{get:function(){return this._morphToColumbusView}}});QH.prototype.isDestroyed=function(){return!1};QH.prototype.destroy=function(){this._eventHelper.removeAll(),ue(this)};var JH=QH;var FSt="m 32.401392,4.9330437 c -7.087603,0 -14.096095,2.884602 -19.10793,7.8946843 -5.0118352,5.010083 -7.9296167,11.987468 -7.9296167,19.072999 0,7.085531 2.9177815,14.097848 7.9296167,19.107931 4.837653,4.835961 11.541408,7.631372 18.374354,7.82482 0.05712,0.01231 0.454119,0.139729 0.454119,0.139729 l 0.03493,-0.104797 c 0.08246,7.84e-4 0.162033,0.03493 0.244525,0.03493 0.08304,0 0.161515,-0.03414 0.244526,-0.03493 l 0.03493,0.104797 c 0,0 0.309474,-0.129487 0.349323,-0.139729 6.867765,-0.168094 13.582903,-2.965206 18.444218,-7.82482 2.558195,-2.5573 4.551081,-5.638134 5.903547,-8.977584 1.297191,-3.202966 2.02607,-6.661489 2.02607,-10.130347 0,-6.237309 -2.366261,-12.31219 -6.322734,-17.116794 -0.0034,-0.02316 0.0049,-0.04488 0,-0.06986 -0.01733,-0.08745 -0.104529,-0.278855 -0.104797,-0.279458 -5.31e-4,-0.0012 -0.522988,-0.628147 -0.523984,-0.62878         -3.47e-4,-2.2e-4 -0.133444,-0.03532 -0.244525,-0.06987 C 51.944299,13.447603 51.751076,13.104317 51.474391,12.827728 46.462556,7.8176457 39.488996,4.9330437 32.401392,4.9330437 z m -2.130866,3.5281554 0.104797,9.6762289 c -4.111695,-0.08361 -7.109829,-0.423664 -9.257041,-0.943171 1.198093,-2.269271 2.524531,-4.124404 3.91241,-5.414496 2.167498,-2.0147811 3.950145,-2.8540169 5.239834,-3.3185619 z m 2.794579,0 c 1.280302,0.4754953 3.022186,1.3285948 5.065173,3.2486979 1.424667,1.338973 2.788862,3.303645 3.982275,5.728886 -2.29082,0.403367 -5.381258,0.621049 -8.942651,0.698645 L 33.065105,8.4611991 z m 5.728886,0.2445256 c 4.004072,1.1230822 7.793098,3.1481363 10.724195,6.0782083 0.03468,0.03466 0.07033,0.06991 0.104797,0.104797 -0.45375,0.313891 -0.923054,0.663002 -1.956205,1.082899 -0.647388,0.263114 -1.906242,0.477396 -2.829511,0.733577 -1.382296,-2.988132         -3.027146,-5.368585 -4.785716,-7.0213781 -0.422866,-0.397432 -0.835818,-0.6453247 -1.25756,-0.9781032 z m -15.33525,0.7685092 c -0.106753,0.09503 -0.207753,0.145402 -0.31439,0.244526 -1.684973,1.5662541 -3.298068,3.8232211 -4.680919,6.5672591 -0.343797,-0.14942 -1.035052,-0.273198 -1.292493,-0.419186 -0.956528,-0.542427 -1.362964,-1.022024 -1.537018,-1.292493 -0.0241,-0.03745 -0.01868,-0.0401 -0.03493,-0.06986 2.250095,-2.163342 4.948824,-3.869984 7.859752,-5.0302421 z m -9.641296,7.0912431 c 0.464973,0.571618 0.937729,1.169056 1.956205,1.746612 0.349907,0.198425 1.107143,0.335404 1.537018,0.523983 -1.20166,3.172984 -1.998037,7.051901 -2.165798,11.772162 C 14.256557,30.361384 12.934823,30.161483 12.280427,29.90959 10.644437,29.279855 9.6888882,28.674891 9.1714586,28.267775 8.6540289,27.860658 8.6474751,27.778724 8.6474751,27.778724 l -0.069864,0.03493 C 9.3100294,23.691285         11.163248,19.798527 13.817445,16.565477 z m 37.552149,0.523984 c 2.548924,3.289983 4.265057,7.202594 4.890513,11.318043 -0.650428,0.410896 -1.756876,1.001936 -3.563088,1.606882 -1.171552,0.392383 -3.163859,0.759153 -4.960377,1.117832 -0.04367,-4.752703 -0.784809,-8.591423 -1.88634,-11.807094 0.917574,-0.263678 2.170552,-0.486495 2.864443,-0.76851 1.274693,-0.518066 2.003942,-1.001558 2.654849,-1.467153 z m -31.439008,2.619917 c 2.487341,0.672766 5.775813,1.137775 10.479669,1.222628 l 0.104797,10.689263 0,0.03493 0,0.733577 c -5.435005,-0.09059 -9.512219,-0.519044 -12.610536,-1.117831 0.106127,-4.776683 0.879334,-8.55791 2.02607,-11.562569 z m 23.264866,0.31439 c 1.073459,3.067541 1.833795,6.821314 1.816476,11.702298 -3.054474,0.423245 -7.062018,0.648559 -11.702298,0.698644 l 0,-0.838373 -0.104796,-10.654331 c 4.082416,-0.0864 7.404468,-0.403886 9.990618,-0.908238 z         M 8.2632205,30.922625 c 0.7558676,0.510548 1.5529563,1.013339 3.0041715,1.57195 0.937518,0.360875 2.612202,0.647642 3.91241,0.978102 0.112814,3.85566 0.703989,7.107756 1.606883,9.920754 -1.147172,-0.324262 -2.644553,-0.640648 -3.423359,-0.978102 -1.516688,-0.657177 -2.386627,-1.287332 -2.864443,-1.71168 -0.477816,-0.424347 -0.489051,-0.489051 -0.489051,-0.489051 L 9.8002387,40.319395 C 8.791691,37.621767 8.1584238,34.769583 8.1584238,31.900727 c 0,-0.330153 0.090589,-0.648169 0.1047967,-0.978102 z m 48.2763445,0.419186 c 0.0047,0.188973 0.06986,0.36991 0.06986,0.558916 0,2.938869 -0.620228,5.873558 -1.676747,8.628261 -0.07435,0.07583 -0.06552,0.07411 -0.454119,0.349323 -0.606965,0.429857 -1.631665,1.042044 -3.318562,1.676747 -1.208528,0.454713 -3.204964,0.850894 -5.135038,1.25756 0.84593,-2.765726 1.41808,-6.005357 1.606883,-9.815957 2.232369,-0.413371 4.483758,-0.840201         5.938479,-1.327425 1.410632,-0.472457 2.153108,-0.89469 2.96924,-1.327425 z m -38.530252,2.864443 c 3.208141,0.56697 7.372279,0.898588 12.575603,0.978103 l 0.174662,9.885821 c -4.392517,-0.06139 -8.106722,-0.320566 -10.863925,-0.803441 -1.051954,-2.664695 -1.692909,-6.043794 -1.88634,-10.060483 z m 26.793022,0.31439 c -0.246298,3.923551 -0.877762,7.263679 -1.816476,9.885822 -2.561957,0.361954 -5.766249,0.560708 -9.431703,0.62878 l -0.174661,-9.815957 c 4.491734,-0.04969 8.334769,-0.293032 11.42284,-0.698645 z M 12.035901,44.860585 c 0.09977,0.04523 0.105535,0.09465 0.209594,0.139729 1.337656,0.579602 3.441099,1.058072 5.589157,1.537018 1.545042,3.399208 3.548524,5.969402 5.589157,7.789888 -3.034411,-1.215537 -5.871615,-3.007978 -8.174142,-5.309699 -1.245911,-1.245475 -2.271794,-2.662961 -3.213766,-4.156936 z m 40.69605,0 c -0.941972,1.493975 -1.967855,2.911461         -3.213765,4.156936 -2.74253,2.741571 -6.244106,4.696717 -9.955686,5.868615 0.261347,-0.241079 0.507495,-0.394491 0.768509,-0.663713 1.674841,-1.727516 3.320792,-4.181056 4.645987,-7.265904 2.962447,-0.503021 5.408965,-1.122293 7.161107,-1.781544 0.284034,-0.106865 0.337297,-0.207323 0.593848,-0.31439 z m -31.404076,2.305527 c 2.645807,0.376448 5.701178,0.649995 9.466635,0.698645 l 0.139729,7.789888 c -1.38739,-0.480844 -3.316218,-1.29837 -5.659022,-3.388427 -1.388822,-1.238993 -2.743668,-3.0113 -3.947342,-5.100106 z m 20.365491,0.104797 c -1.04872,2.041937 -2.174337,3.779068 -3.353494,4.995309 -1.853177,1.911459 -3.425515,2.82679 -4.611055,3.353494 l -0.139729,-7.789887 c 3.13091,-0.05714 5.728238,-0.278725 8.104278,-0.558916 z",BSt="m 2.9825053,17.550598 0,1.368113 0,26.267766 0,1.368113 1.36811,0 54.9981397,0 1.36811,0 0,-1.368113 0,-26.267766 0,-1.368113 -1.36811,0 -54.9981397,0 -1.36811,0 z m 2.73623,2.736226 10.3292497,0 0,10.466063 -10.3292497,0 0,-10.466063 z m 13.0654697,0 11.69737,0 0,10.466063 -11.69737,0 0,-10.466063 z m 14.43359,0 11.69737,0 0,10.466063 -11.69737,0 0,-10.466063 z m 14.43359,0 10.32926,0 0,10.466063 -10.32926,0 0,-10.466063 z m -41.9326497,13.202288 10.3292497,0 0,10.329252 -10.3292497,0 0,-10.329252 z m 13.0654697,0 11.69737,0 0,10.329252 -11.69737,0 0,-10.329252 z m 14.43359,0 11.69737,0 0,10.329252 -11.69737,0 0,-10.329252 z m 14.43359,0 10.32926,0 0,10.329252 -10.32926,0 0,-10.329252 z",kSt="m 14.723969,17.675598 -0.340489,0.817175 -11.1680536,26.183638 -0.817175,1.872692 2.076986,0 54.7506996,0 2.07698,0 -0.81717,-1.872692 -11.16805,-26.183638 -0.34049,-0.817175 -0.91933,0 -32.414586,0 -0.919322,0 z m 1.838643,2.723916 6.196908,0 -2.928209,10.418977 -7.729111,0 4.460412,-10.418977 z m 9.02297,0 4.903049,0 0,10.418977 -7.831258,0 2.928209,-10.418977 z m 7.626964,0 5.584031,0 2.62176,10.418977 -8.205791,0 0,-10.418977 z m 8.410081,0 5.51593,0 4.46042,10.418977 -7.38863,0 -2.58772,-10.418977 z m -30.678091,13.142892 8.103649,0 -2.89416,10.282782 -9.6018026,0 4.3923136,-10.282782 z m 10.929711,0 8.614384,0 0,10.282782 -11.508544,0 2.89416,-10.282782 z m 11.338299,0 8.852721,0 2.58772,10.282782 -11.440441,0 0,-10.282782 z m 11.678781,0 7.86531,0 4.39231,10.282782 -9.6699,0 -2.58772,-10.282782 z";function e6(e,t,n){e=Rn(e);let i=new JH(t,n);i._globePath=FSt,i._flatMapPath=BSt,i._columbusViewPath=kSt;let o=document.createElement("span");o.className="cesium-sceneModePicker-wrapper cesium-toolbar-button",e.appendChild(o);let r=document.createElement("button");r.type="button",r.className="cesium-button cesium-toolbar-button",r.setAttribute("data-bind",'css: { "cesium-sceneModePicker-button2D": sceneMode === _sceneMode.SCENE2D,       "cesium-sceneModePicker-button3D": sceneMode === _sceneMode.SCENE3D,       "cesium-sceneModePicker-buttonColumbusView": sceneMode === _sceneMode.COLUMBUS_VIEW,       "cesium-sceneModePicker-selected": dropDownVisible },attr: { title: selectedTooltip },click: toggleDropDown'),r.innerHTML='<!-- ko cesiumSvgPath: { path: _globePath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-icon3D" } --><!-- /ko --><!-- ko cesiumSvgPath: { path: _flatMapPath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-icon2D" } --><!-- /ko --><!-- ko cesiumSvgPath: { path: _columbusViewPath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-iconColumbusView" } --><!-- /ko -->',o.appendChild(r);let s=document.createElement("button");s.type="button",s.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon",s.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.SCENE3D)) || (!dropDownVisible && (sceneMode === _sceneMode.SCENE3D)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.SCENE3D,       "cesium-sceneModePicker-hidden" : !dropDownVisible },attr: { title: tooltip3D },click: morphTo3D,cesiumSvgPath: { path: _globePath, width: 64, height: 64 }'),o.appendChild(s);let a=document.createElement("button");a.type="button",a.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon",a.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.SCENE2D)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.SCENE2D,       "cesium-sceneModePicker-hidden" : !dropDownVisible },attr: { title: tooltip2D },click: morphTo2D,cesiumSvgPath: { path: _flatMapPath, width: 64, height: 64 }'),o.appendChild(a);let c=document.createElement("button");c.type="button",c.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon",c.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.COLUMBUS_VIEW)) || (!dropDownVisible && (sceneMode === _sceneMode.COLUMBUS_VIEW)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.COLUMBUS_VIEW,       "cesium-sceneModePicker-hidden" : !dropDownVisible},attr: { title: tooltipColumbusView },click: morphToColumbusView,cesiumSvgPath: { path: _columbusViewPath, width: 64, height: 64 }'),o.appendChild(c),be.applyBindings(i,o),this._viewModel=i,this._container=e,this._wrapper=o,this._closeDropDown=function(l){o.contains(l.target)||(i.dropDownVisible=!1)},Wt.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeDropDown,!0):(document.addEventListener("mousedown",this._closeDropDown,!0),document.addEventListener("touchstart",this._closeDropDown,!0))}Object.defineProperties(e6.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});e6.prototype.isDestroyed=function(){return!1};e6.prototype.destroy=function(){return this._viewModel.destroy(),Wt.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeDropDown,!0):(document.removeEventListener("mousedown",this._closeDropDown,!0),document.removeEventListener("touchstart",this._closeDropDown,!0)),be.cleanNode(this._wrapper),this._container.removeChild(this._wrapper),ue(this)};var t6=e6;function n6(e){this._scene=e,this._orthographic=e.camera.frustum instanceof sn,this._flightInProgress=!1,this.dropDownVisible=!1,this.tooltipPerspective="Perspective Projection",this.tooltipOrthographic="Orthographic Projection",this.selectedTooltip=void 0,this.sceneMode=e.mode,be.track(this,["_orthographic","_flightInProgress","sceneMode","dropDownVisible","tooltipPerspective","tooltipOrthographic"]);let t=this;be.defineProperty(this,"selectedTooltip",function(){return t._orthographic?t.tooltipOrthographic:t.tooltipPerspective}),this._toggleDropDown=vn(function(){t.sceneMode===ne.SCENE2D||t._flightInProgress||(t.dropDownVisible=!t.dropDownVisible)}),this._eventHelper=new Ar,this._eventHelper.add(e.morphComplete,function(n,i,o,r){t.sceneMode=o,t._orthographic=o===ne.SCENE2D||t._scene.camera.frustum instanceof sn}),this._eventHelper.add(e.preRender,function(){t._flightInProgress=u(e.camera._currentFlight)}),this._switchToPerspective=vn(function(){t.sceneMode!==ne.SCENE2D&&(t._scene.camera.switchToPerspectiveFrustum(),t._orthographic=!1,t.dropDownVisible=!1)}),this._switchToOrthographic=vn(function(){t.sceneMode!==ne.SCENE2D&&(t._scene.camera.switchToOrthographicFrustum(),t._orthographic=!0,t.dropDownVisible=!1)}),this._sceneMode=ne}Object.defineProperties(n6.prototype,{scene:{get:function(){return this._scene}},toggleDropDown:{get:function(){return this._toggleDropDown}},switchToPerspective:{get:function(){return this._switchToPerspective}},switchToOrthographic:{get:function(){return this._switchToOrthographic}},isOrthographicProjection:{get:function(){return this._orthographic}}});n6.prototype.isDestroyed=function(){return!1};n6.prototype.destroy=function(){this._eventHelper.removeAll(),ue(this)};var i6=n6;var VSt="M 28.15625,10.4375 9.125,13.21875 13.75,43.25 41.75,55.09375 50.8125,37 54.5,11.9375 z m 0.125,3 19.976451,0.394265 L 43.03125,16.875 22.6875,14.28125 z M 50.971746,15.705477 47.90625,36.03125 42.53125,46 44.84375,19.3125 z M 12.625,16.03125 l 29.15625,3.6875 -2.65625,31 L 16.4375,41.125 z",USt="m 31.560594,6.5254438 -20.75,12.4687502 0.1875,24.5625 22.28125,11.8125 19.5,-12 0.65625,-0.375 0,-0.75 0.0312,-23.21875 z m 0.0625,3.125 16.65625,9.5000002 -16.125,10.28125 -17.34375,-9.71875 z m 18.96875,11.1875002 0.15625,20.65625 -17.46875,10.59375 0.15625,-20.28125 z m -37.0625,1.25 17.21875,9.625 -0.15625,19.21875 -16.9375,-9 z";function o6(e,t){e=Rn(e);let n=new i6(t);n._perspectivePath=VSt,n._orthographicPath=USt;let i=document.createElement("span");i.className="cesium-projectionPicker-wrapper cesium-toolbar-button",e.appendChild(i);let o=document.createElement("button");o.type="button",o.className="cesium-button cesium-toolbar-button",o.setAttribute("data-bind",'css: { "cesium-projectionPicker-buttonPerspective": !_orthographic,       "cesium-projectionPicker-buttonOrthographic": _orthographic,       "cesium-button-disabled" : sceneMode === _sceneMode.SCENE2D || _flightInProgress,        "cesium-projectionPicker-selected": dropDownVisible },attr: { title: selectedTooltip },click: toggleDropDown'),o.innerHTML='<!-- ko cesiumSvgPath: { path: _perspectivePath, width: 64, height: 64, css: "cesium-projectionPicker-iconPerspective" } --><!-- /ko --><!-- ko cesiumSvgPath: { path: _orthographicPath, width: 64, height: 64, css: "cesium-projectionPicker-iconOrthographic" } --><!-- /ko -->',i.appendChild(o);let r=document.createElement("button");r.type="button",r.className="cesium-button cesium-toolbar-button cesium-projectionPicker-dropDown-icon",r.setAttribute("data-bind",'css: { "cesium-projectionPicker-visible" : (dropDownVisible && _orthographic),       "cesium-projectionPicker-none" : !_orthographic,       "cesium-projectionPicker-hidden" : !dropDownVisible },attr: { title: tooltipPerspective },click: switchToPerspective,cesiumSvgPath: { path: _perspectivePath, width: 64, height: 64 }'),i.appendChild(r);let s=document.createElement("button");s.type="button",s.className="cesium-button cesium-toolbar-button cesium-projectionPicker-dropDown-icon",s.setAttribute("data-bind",'css: { "cesium-projectionPicker-visible" : (dropDownVisible && !_orthographic),       "cesium-projectionPicker-none" : _orthographic,       "cesium-projectionPicker-hidden" : !dropDownVisible},attr: { title: tooltipOrthographic },click: switchToOrthographic,cesiumSvgPath: { path: _orthographicPath, width: 64, height: 64 }'),i.appendChild(s),be.applyBindings(n,i),this._viewModel=n,this._container=e,this._wrapper=i,this._closeDropDown=function(a){i.contains(a.target)||(n.dropDownVisible=!1)},Wt.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeDropDown,!0):(document.addEventListener("mousedown",this._closeDropDown,!0),document.addEventListener("touchstart",this._closeDropDown,!0))}Object.defineProperties(o6.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});o6.prototype.isDestroyed=function(){return!1};o6.prototype.destroy=function(){return this._viewModel.destroy(),Wt.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeDropDown,!0):(document.removeEventListener("mousedown",this._closeDropDown,!0),document.removeEventListener("touchstart",this._closeDropDown,!0)),be.cleanNode(this._wrapper),this._container.removeChild(this._wrapper),ue(this)};var r6=o6;var zSt=new H,s6="-1000px";function jI(e,t,n){this._scene=e,this._screenPositionX=s6,this._screenPositionY=s6,this._tweens=e.tweens,this._container=x(n,document.body),this._selectionIndicatorElement=t,this._scale=1,this.position=void 0,this.showSelection=!1,be.track(this,["position","_screenPositionX","_screenPositionY","_scale","showSelection"]),this.isVisible=void 0,be.defineProperty(this,"isVisible",{get:function(){return this.showSelection&&u(this.position)}}),be.defineProperty(this,"_transform",{get:function(){return`scale(${this._scale})`}}),this.computeScreenSpacePosition=function(i,o){return Wi.worldToWindowCoordinates(e,i,o)}}jI.prototype.update=function(){if(this.showSelection&&u(this.position)){let e=this.computeScreenSpacePosition(this.position,zSt);if(!u(e))this._screenPositionX=s6,this._screenPositionY=s6;else{let t=this._container,n=t.parentNode.clientWidth,i=t.parentNode.clientHeight,o=this._selectionIndicatorElement.clientWidth,r=o*.5;e.x=Math.min(Math.max(e.x,-o),n+o)-r,e.y=Math.min(Math.max(e.y,-o),i+o)-r,this._screenPositionX=`${Math.floor(e.x+.25)}px`,this._screenPositionY=`${Math.floor(e.y+.25)}px`}}};jI.prototype.animateAppear=function(){this._tweens.addProperty({object:this,property:"_scale",startValue:2,stopValue:1,duration:.8,easingFunction:Qr.EXPONENTIAL_OUT})};jI.prototype.animateDepart=function(){this._tweens.addProperty({object:this,property:"_scale",startValue:this._scale,stopValue:1.5,duration:.8,easingFunction:Qr.EXPONENTIAL_OUT})};Object.defineProperties(jI.prototype,{container:{get:function(){return this._container}},selectionIndicatorElement:{get:function(){return this._selectionIndicatorElement}},scene:{get:function(){return this._scene}}});var a6=jI;function c6(e,t){e=Rn(e),this._container=e;let n=document.createElement("div");n.className="cesium-selection-wrapper",n.setAttribute("data-bind",'style: { "top" : _screenPositionY, "left" : _screenPositionX },css: { "cesium-selection-wrapper-visible" : isVisible }'),e.appendChild(n),this._element=n;let i="http://www.w3.org/2000/svg",o="M -34 -34 L -34 -11.25 L -30 -15.25 L -30 -30 L -15.25 -30 L -11.25 -34 L -34 -34 z M 11.25 -34 L 15.25 -30 L 30 -30 L 30 -15.25 L 34 -11.25 L 34 -34 L 11.25 -34 z M -34 11.25 L -34 34 L -11.25 34 L -15.25 30 L -30 30 L -30 15.25 L -34 11.25 z M 34 11.25 L 30 15.25 L 30 30 L 15.25 30 L 11.25 34 L 34 34 L 34 11.25 z",r=document.createElementNS(i,"svg:svg");r.setAttribute("width",160),r.setAttribute("height",160),r.setAttribute("viewBox","0 0 160 160");let s=document.createElementNS(i,"g");s.setAttribute("transform","translate(80,80)"),r.appendChild(s);let a=document.createElementNS(i,"path");a.setAttribute("data-bind","attr: { transform: _transform }"),a.setAttribute("d",o),s.appendChild(a),n.appendChild(r);let c=new a6(t,this._element,this._container);this._viewModel=c,be.applyBindings(this._viewModel,this._element)}Object.defineProperties(c6.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});c6.prototype.isDestroyed=function(){return!1};c6.prototype.destroy=function(){let e=this._container;return be.cleanNode(this._element),e.removeChild(this._element),ue(this)};var l6=c6;function Yb(e,t,n){this._color=e,this._height=t,this._base=x(n,0)}Yb.prototype.getHeight=function(){return this._height};Yb.prototype.getBase=function(){return this._base};Yb.prototype.getStartTime=function(){return this._start};Yb.prototype.getStopTime=function(){return this._stop};Yb.prototype.setRange=function(e,t){this._start=e,this._stop=t};Yb.prototype.render=function(e){let t="";if(this._start&&this._stop&&this._color){let n=$.secondsDifference(this._start,e.epochJulian),i=Math.round(e.timeBarWidth*e.getAlpha(n)),o=$.secondsDifference(this._stop,e.epochJulian),r=Math.round(e.timeBarWidth*e.getAlpha(o))-i;i<0&&(r+=i,i=0),i+r>e.timeBarWidth&&(r=e.timeBarWidth-i),r>0&&(t=`<span class="cesium-timeline-highlight" style="left: ${i.toString()}px; width: ${r.toString()}px; bottom: ${this._base.toString()}px; height: ${this._height}px; background-color: ${this._color};"></span>`)}return t};var u6=Yb;function ZEe(e,t,n,i){this.interval=e,this.height=t,this.color=n||new G(.5,.5,.5,1),this.backgroundColor=i||new G(0,0,0,0)}ZEe.prototype.render=function(e,t){let n=this.interval.start,i=this.interval.stop,o=t.startJulian,r=$.addSeconds(t.startJulian,t.duration,new $);if($.lessThan(n,o)&&$.greaterThan(i,r))e.fillStyle=this.color.toCssColorString(),e.fillRect(0,t.y,t.timeBarWidth,this.height);else if($.lessThanOrEquals(n,r)&&$.greaterThanOrEquals(i,o)){let s,a,c;for(s=0;s<t.timeBarWidth;++s){let l=$.addSeconds(t.startJulian,s/t.timeBarWidth*t.duration,new $);!u(a)&&$.greaterThanOrEquals(l,n)?a=s:!u(c)&&$.greaterThanOrEquals(l,i)&&(c=s)}e.fillStyle=this.backgroundColor.toCssColorString(),e.fillRect(0,t.y,t.timeBarWidth,this.height),u(a)&&(u(c)||(c=t.timeBarWidth),e.fillStyle=this.color.toCssColorString(),e.fillRect(a,t.y,Math.max(c-a,1),this.height))}};var f6=ZEe;var h$=1e12,id={none:0,scrub:1,slide:2,zoom:3,touchOnly:4},il={none:0,scrub:1,slideZoom:2,singleTap:3,ignore:4},gy=[.001,.002,.005,.01,.02,.05,.1,.25,.5,1,2,5,10,15,30,60,120,300,600,900,1800,3600,7200,14400,21600,43200,86400,172800,345600,604800,1296e3,2592e3,5184e3,7776e3,15552e3,31536e3,63072e3,126144e3,15768e4,31536e4,63072e4,126144e4,15768e5,31536e5,63072e5,126144e5,15768e6,31536e6],HSt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function ol(e,t){e=Rn(e);let n=e.ownerDocument;this.container=e;let i=n.createElement("div");i.className="cesium-timeline-main",e.appendChild(i),this._topDiv=i,this._endJulian=void 0,this._epochJulian=void 0,this._lastXPos=void 0,this._scrubElement=void 0,this._startJulian=void 0,this._timeBarSecondsSpan=void 0,this._clock=t,this._scrubJulian=t.currentTime,this._mainTicSpan=-1,this._mouseMode=id.none,this._touchMode=il.none,this._touchState={centerX:0,spanX:0},this._mouseX=0,this._timelineDrag=0,this._timelineDragLocation=void 0,this._lastHeight=void 0,this._lastWidth=void 0,this._topDiv.innerHTML='<div class="cesium-timeline-bar"></div><div class="cesium-timeline-trackContainer"><canvas class="cesium-timeline-tracks" width="10" height="1"></canvas></div><div class="cesium-timeline-needle"></div><span class="cesium-timeline-ruler"></span>',this._timeBarEle=this._topDiv.childNodes[0],this._trackContainer=this._topDiv.childNodes[1],this._trackListEle=this._topDiv.childNodes[1].childNodes[0],this._needleEle=this._topDiv.childNodes[2],this._rulerEle=this._topDiv.childNodes[3],this._context=this._trackListEle.getContext("2d"),this._trackList=[],this._highlightRanges=[],this.zoomTo(t.startTime,t.stopTime),this._onMouseDown=GSt(this),this._onMouseUp=WSt(this),this._onMouseMove=jSt(this),this._onMouseWheel=qSt(this),this._onTouchStart=YSt(this),this._onTouchMove=KSt(this),this._onTouchEnd=XSt(this);let o=this._timeBarEle;n.addEventListener("mouseup",this._onMouseUp,!1),n.addEventListener("mousemove",this._onMouseMove,!1),o.addEventListener("mousedown",this._onMouseDown,!1),o.addEventListener("DOMMouseScroll",this._onMouseWheel,!1),o.addEventListener("mousewheel",this._onMouseWheel,!1),o.addEventListener("touchstart",this._onTouchStart,!1),o.addEventListener("touchmove",this._onTouchMove,!1),o.addEventListener("touchend",this._onTouchEnd,!1),o.addEventListener("touchcancel",this._onTouchEnd,!1),this._topDiv.oncontextmenu=function(){return!1},t.onTick.addEventListener(this.updateFromClock,this),this.updateFromClock()}ol.prototype.addEventListener=function(e,t,n){this._topDiv.addEventListener(e,t,n)};ol.prototype.removeEventListener=function(e,t,n){this._topDiv.removeEventListener(e,t,n)};ol.prototype.isDestroyed=function(){return!1};ol.prototype.destroy=function(){this._clock.onTick.removeEventListener(this.updateFromClock,this);let e=this.container.ownerDocument;e.removeEventListener("mouseup",this._onMouseUp,!1),e.removeEventListener("mousemove",this._onMouseMove,!1);let t=this._timeBarEle;t.removeEventListener("mousedown",this._onMouseDown,!1),t.removeEventListener("DOMMouseScroll",this._onMouseWheel,!1),t.removeEventListener("mousewheel",this._onMouseWheel,!1),t.removeEventListener("touchstart",this._onTouchStart,!1),t.removeEventListener("touchmove",this._onTouchMove,!1),t.removeEventListener("touchend",this._onTouchEnd,!1),t.removeEventListener("touchcancel",this._onTouchEnd,!1),this.container.removeChild(this._topDiv),ue(this)};ol.prototype.addHighlightRange=function(e,t,n){let i=new u6(e,t,n);return this._highlightRanges.push(i),this.resize(),i};ol.prototype.addTrack=function(e,t,n,i){let o=new f6(e,t,n,i);return this._trackList.push(o),this._lastHeight=void 0,this.resize(),o};ol.prototype.zoomTo=function(e,t){if(this._startJulian=e,this._endJulian=t,this._timeBarSecondsSpan=$.secondsDifference(t,e),this._clock&&this._clock.clockRange!==Zr.UNBOUNDED){let i=this._clock.startTime,o=this._clock.stopTime,r=$.secondsDifference(o,i),s=$.secondsDifference(i,this._startJulian),a=$.secondsDifference(o,this._endJulian);this._timeBarSecondsSpan>=r?(this._timeBarSecondsSpan=r,this._startJulian=this._clock.startTime,this._endJulian=this._clock.stopTime):s>0?(this._endJulian=$.addSeconds(this._endJulian,s,new $),this._startJulian=i,this._timeBarSecondsSpan=$.secondsDifference(this._endJulian,this._startJulian)):a<0&&(this._startJulian=$.addSeconds(this._startJulian,a,new $),this._endJulian=o,this._timeBarSecondsSpan=$.secondsDifference(this._endJulian,this._startJulian))}this._makeTics();let n=document.createEvent("Event");n.initEvent("setzoom",!0,!0),n.startJulian=this._startJulian,n.endJulian=this._endJulian,n.epochJulian=this._epochJulian,n.totalSpan=this._timeBarSecondsSpan,n.mainTicSpan=this._mainTicSpan,this._topDiv.dispatchEvent(n)};ol.prototype.zoomFrom=function(e){let t=$.secondsDifference(this._scrubJulian,this._startJulian);e>1||t<0||t>this._timeBarSecondsSpan?t=this._timeBarSecondsSpan*.5:t+=t-this._timeBarSecondsSpan*.5;let n=this._timeBarSecondsSpan-t;this.zoomTo($.addSeconds(this._startJulian,t-t*e,new $),$.addSeconds(this._endJulian,n*e-n,new $))};function m$(e){return e<10?`0${e.toString()}`:e.toString()}ol.prototype.makeLabel=function(e){let t=$.toGregorianDate(e),n=t.millisecond,i=" UTC";if(n>0&&this._timeBarSecondsSpan<3600){for(i=Math.floor(n).toString();i.length<3;)i=`0${i}`;i=`.${i}`}return`${HSt[t.month-1]} ${t.day} ${t.year} ${m$(t.hour)}:${m$(t.minute)}:${m$(t.second)}${i}`};ol.prototype.smallestTicInPixels=7;ol.prototype._makeTics=function(){let e=this._timeBarEle,t=$.secondsDifference(this._scrubJulian,this._startJulian),n=Math.round(t*this._topDiv.clientWidth/this._timeBarSecondsSpan),i=n-8,o,r=this;this._needleEle.style.left=`${n.toString()}px`;let s="",a=.01,c=31536e6,l=1e-10,f=0,d=this._timeBarSecondsSpan;d<a?(d=a,this._timeBarSecondsSpan=a,this._endJulian=$.addSeconds(this._startJulian,a,new $)):d>c&&(d=c,this._timeBarSecondsSpan=c,this._endJulian=$.addSeconds(this._startJulian,c,new $));let p=this._timeBarEle.clientWidth;p<10&&(p=10);let g=this._startJulian,m=Math.min(d/p*1e-5,.4),y,b=$.toGregorianDate(g);d>31536e4?y=$.fromDate(new Date(Date.UTC(Math.floor(b.year/100)*100,0))):d>31536e3?y=$.fromDate(new Date(Date.UTC(Math.floor(b.year/10)*10,0))):d>86400?y=$.fromDate(new Date(Date.UTC(b.year,0))):y=$.fromDate(new Date(Date.UTC(b.year,b.month,b.day)));let C=$.secondsDifference(this._startJulian,$.addSeconds(y,m,new $)),A=C+d;this._epochJulian=y;function T(B){return Math.floor(C/B)*B}function E(B,W){return Math.ceil(B/W+.5)*W}function v(B){return(B-C)/d}function D(B,W){return B-W*Math.round(B/W)}this._rulerEle.innerHTML=this.makeLabel($.addSeconds(this._endJulian,-a,new $));let O=this._rulerEle.offsetWidth+20;O<30&&(O=180);let P=f;f-=l;let M={startTime:C,startJulian:g,epochJulian:y,duration:d,timeBarWidth:p,getAlpha:v};this._highlightRanges.forEach(function(B){s+=B.render(M)});let L=0,_=0,S=0,w=O/p;w>1&&(w=1),w*=this._timeBarSecondsSpan;let I=-1,N=-1,k=gy.length,z;for(z=0;z<k;++z){let B=gy[z];if(++I,L=B,B>w&&B>f)break;N<0&&p*(B/this._timeBarSecondsSpan)>=this.smallestTicInPixels&&(N=I)}if(I>0){for(;I>0;)if(--I,Math.abs(D(L,gy[I]))<1e-5){gy[I]>=f&&(_=gy[I]);break}if(N>=0)for(;N<I;){if(Math.abs(D(_,gy[N]))<1e-5&&gy[N]>=f){S=gy[N];break}++N}}f=P,f>l&&S<1e-5&&Math.abs(f-L)>l&&(S=f,f<=L+l&&(_=0));let V=-999999,U;if(p*(S/this._timeBarSecondsSpan)>=3)for(o=T(S);o<=A;o=E(o,S))s+=`<span class="cesium-timeline-ticTiny" style="left: ${Math.round(p*v(o)).toString()}px;"></span>`;if(p*(_/this._timeBarSecondsSpan)>=3)for(o=T(_);o<=A;o=E(o,_))s+=`<span class="cesium-timeline-ticSub" style="left: ${Math.round(p*v(o)).toString()}px;"></span>`;if(p*(L/this._timeBarSecondsSpan)>=2){this._mainTicSpan=L,A+=L,o=T(L);let B=$.computeTaiMinusUtc(y);for(;o<=A;){let W=$.addSeconds(g,o-C,new $);if(L>2.1){let X=$.computeTaiMinusUtc(W);Math.abs(X-B)>.1&&(o+=X-B,W=$.addSeconds(g,o-C,new $))}let j=Math.round(p*v(o)),Q=this.makeLabel(W);this._rulerEle.innerHTML=Q,U=this._rulerEle.offsetWidth,U<10&&(U=O);let q=j-(U/2-1);q>V?(V=q+U+5,s+=`<span class="cesium-timeline-ticMain" style="left: ${j.toString()}px;"></span><span class="cesium-timeline-ticLabel" style="left: ${q.toString()}px;">${Q}</span>`):s+=`<span class="cesium-timeline-ticSub" style="left: ${j.toString()}px;"></span>`,o=E(o,L)}}else this._mainTicSpan=-1;s+=`<span class="cesium-timeline-icon16" style="left:${i}px;bottom:0;background-position: 0 0;"></span>`,e.innerHTML=s,this._scrubElement=e.lastChild,this._context.clearRect(0,0,this._trackListEle.width,this._trackListEle.height),M.y=0,this._trackList.forEach(function(B){B.render(r._context,M),M.y+=B.height})};ol.prototype.updateFromClock=function(){this._scrubJulian=this._clock.currentTime;let e=this._scrubElement;if(u(this._scrubElement)){let t=$.secondsDifference(this._scrubJulian,this._startJulian),n=Math.round(t*this._topDiv.clientWidth/this._timeBarSecondsSpan);this._lastXPos!==n&&(this._lastXPos=n,e.style.left=`${n-8}px`,this._needleEle.style.left=`${n}px`)}u(this._timelineDragLocation)&&(this._setTimeBarTime(this._timelineDragLocation,this._timelineDragLocation*this._timeBarSecondsSpan/this._topDiv.clientWidth),this.zoomTo($.addSeconds(this._startJulian,this._timelineDrag,new $),$.addSeconds(this._endJulian,this._timelineDrag,new $)))};ol.prototype._setTimeBarTime=function(e,t){if(e=Math.round(e),this._scrubJulian=$.addSeconds(this._startJulian,t,new $),this._scrubElement){let i=e-8;this._scrubElement.style.left=`${i.toString()}px`,this._needleEle.style.left=`${e.toString()}px`}let n=document.createEvent("Event");n.initEvent("settime",!0,!0),n.clientX=e,n.timeSeconds=t,n.timeJulian=this._scrubJulian,n.clock=this._clock,this._topDiv.dispatchEvent(n)};function GSt(e){return function(t){e._mouseMode!==id.touchOnly&&(t.button===0?(e._mouseMode=id.scrub,e._scrubElement&&(e._scrubElement.style.backgroundPosition="-16px 0"),e._onMouseMove(t)):(e._mouseX=t.clientX,t.button===2?e._mouseMode=id.zoom:e._mouseMode=id.slide)),t.preventDefault()}}function WSt(e){return function(t){e._mouseMode=id.none,e._scrubElement&&(e._scrubElement.style.backgroundPosition="0 0"),e._timelineDrag=0,e._timelineDragLocation=void 0}}function jSt(e){return function(t){let n;if(e._mouseMode===id.scrub){t.preventDefault();let i=t.clientX-e._topDiv.getBoundingClientRect().left;i<0?(e._timelineDragLocation=0,e._timelineDrag=-.01*e._timeBarSecondsSpan):i>e._topDiv.clientWidth?(e._timelineDragLocation=e._topDiv.clientWidth,e._timelineDrag=.01*e._timeBarSecondsSpan):(e._timelineDragLocation=void 0,e._setTimeBarTime(i,i*e._timeBarSecondsSpan/e._topDiv.clientWidth))}else if(e._mouseMode===id.slide){if(n=e._mouseX-t.clientX,e._mouseX=t.clientX,n!==0){let i=n*e._timeBarSecondsSpan/e._topDiv.clientWidth;e.zoomTo($.addSeconds(e._startJulian,i,new $),$.addSeconds(e._endJulian,i,new $))}}else e._mouseMode===id.zoom&&(n=e._mouseX-t.clientX,e._mouseX=t.clientX,n!==0&&e.zoomFrom(Math.pow(1.01,n)))}}function qSt(e){return function(t){let n=t.wheelDeltaY||t.wheelDelta||-t.detail;h$=Math.max(Math.min(Math.abs(n),h$),1),n/=h$,e.zoomFrom(Math.pow(1.05,-n))}}function YSt(e){return function(t){let n=t.touches.length,i,o,r=e._topDiv.getBoundingClientRect().left;t.preventDefault(),e._mouseMode=id.touchOnly,n===1?(i=$.secondsDifference(e._scrubJulian,e._startJulian),o=Math.round(i*e._topDiv.clientWidth/e._timeBarSecondsSpan+r),Math.abs(t.touches[0].clientX-o)<50?(e._touchMode=il.scrub,e._scrubElement&&(e._scrubElement.style.backgroundPosition=n===1?"-16px 0":"0 0")):(e._touchMode=il.singleTap,e._touchState.centerX=t.touches[0].clientX-r)):n===2?(e._touchMode=il.slideZoom,e._touchState.centerX=(t.touches[0].clientX+t.touches[1].clientX)*.5-r,e._touchState.spanX=Math.abs(t.touches[0].clientX-t.touches[1].clientX)):e._touchMode=il.ignore}}function XSt(e){return function(t){let n=t.touches.length,i=e._topDiv.getBoundingClientRect().left;e._touchMode===il.singleTap?(e._touchMode=il.scrub,e._onTouchMove(t)):e._touchMode===il.scrub&&e._onTouchMove(t),e._mouseMode=id.touchOnly,n!==1?e._touchMode=n>0?il.ignore:il.none:e._touchMode===il.slideZoom&&(e._touchState.centerX=t.touches[0].clientX-i),e._scrubElement&&(e._scrubElement.style.backgroundPosition="0 0")}}function KSt(e){return function(t){let n,i,o,r,s,a,c=1,l=e._topDiv.getBoundingClientRect().left;e._touchMode===il.singleTap&&(e._touchMode=il.slideZoom),e._mouseMode=id.touchOnly,e._touchMode===il.scrub?(t.preventDefault(),t.changedTouches.length===1&&(i=t.changedTouches[0].clientX-l,i>=0&&i<=e._topDiv.clientWidth&&e._setTimeBarTime(i,i*e._timeBarSecondsSpan/e._topDiv.clientWidth))):e._touchMode===il.slideZoom&&(o=t.touches.length,o===2?(r=(t.touches[0].clientX+t.touches[1].clientX)*.5-l,s=Math.abs(t.touches[0].clientX-t.touches[1].clientX)):o===1&&(r=t.touches[0].clientX-l,s=0),u(r)&&(s>0&&e._touchState.spanX>0?(c=e._touchState.spanX/s,a=$.addSeconds(e._startJulian,(e._touchState.centerX*e._timeBarSecondsSpan-r*e._timeBarSecondsSpan*c)/e._topDiv.clientWidth,new $)):(n=e._touchState.centerX-r,a=$.addSeconds(e._startJulian,n*e._timeBarSecondsSpan/e._topDiv.clientWidth,new $)),e.zoomTo(a,$.addSeconds(a,e._timeBarSecondsSpan*c,new $)),e._touchState.centerX=r,e._touchState.spanX=s))}}ol.prototype.resize=function(){let e=this.container.clientWidth,t=this.container.clientHeight;if(e===this._lastWidth&&t===this._lastHeight)return;this._trackContainer.style.height=`${t}px`;let n=1;this._trackList.forEach(function(i){n+=i.height}),this._trackListEle.style.height=`${n.toString()}px`,this._trackListEle.width=this._trackListEle.clientWidth,this._trackListEle.height=n,this._makeTics(),this._lastXPos=void 0,this._lastWidth=e,this._lastHeight=t};var d6=ol;var tSe=Dr(eSe(),1);function QSt(e){let t=!1,n=window.screen;return u(n)&&(u(n.lockOrientation)?t=n.lockOrientation(e):u(n.mozLockOrientation)?t=n.mozLockOrientation(e):u(n.msLockOrientation)?t=n.msLockOrientation(e):u(n.orientation&&n.orientation.lock)&&(t=n.orientation.lock(e))),t}function nSe(){let e=window.screen;u(e)&&(u(e.unlockOrientation)?e.unlockOrientation():u(e.mozUnlockOrientation)?e.mozUnlockOrientation():u(e.msUnlockOrientation)?e.msUnlockOrientation():u(e.orientation&&e.orientation.unlock)&&e.orientation.unlock())}function JSt(e,t,n,i){i()||(n()?(t.useWebVR=!1,e._locked&&(nSe(),e._locked=!1),e._noSleep.disable(),Pr.exitFullscreen(),n(!1)):(Pr.fullscreen||Pr.requestFullscreen(e._vrElement),e._noSleep.enable(),e._locked||(e._locked=QSt("landscape")),t.useWebVR=!0,n(!0)))}function h6(e,t){let n=this,i=be.observable(Pr.enabled),o=be.observable(!1);this.isVRMode=void 0,be.defineProperty(this,"isVRMode",{get:function(){return o()}}),this.isVREnabled=void 0,be.defineProperty(this,"isVREnabled",{get:function(){return i()},set:function(s){i(s&&Pr.enabled)}}),this.tooltip=void 0,be.defineProperty(this,"tooltip",function(){return i()?o()?"Exit VR mode":"Enter VR mode":"VR mode is unavailable"});let r=be.observable(!1);this._isOrthographic=void 0,be.defineProperty(this,"_isOrthographic",{get:function(){return r()}}),this._eventHelper=new Ar,this._eventHelper.add(e.preRender,function(){r(e.camera.frustum instanceof sn)}),this._locked=!1,this._noSleep=new tSe.default,this._command=vn(function(){JSt(n,e,o,r)},be.getObservable(this,"isVREnabled")),this._vrElement=x(Rn(t),document.body),this._callback=function(){!Pr.fullscreen&&o()&&(e.useWebVR=!1,n._locked&&(nSe(),n._locked=!1),n._noSleep.disable(),o(!1))},document.addEventListener(Pr.changeEventName,this._callback)}Object.defineProperties(h6.prototype,{vrElement:{get:function(){return this._vrElement},set:function(e){this._vrElement=e}},command:{get:function(){return this._command}}});h6.prototype.isDestroyed=function(){return!1};h6.prototype.destroy=function(){this._eventHelper.removeAll(),document.removeEventListener(Pr.changeEventName,this._callback),ue(this)};var m6=h6;var evt="M 5.3125 6.375 C 4.008126 6.375 2.96875 7.4141499 2.96875 8.71875 L 2.96875 19.5 C 2.96875 20.8043 4.008126 21.875 5.3125 21.875 L 13.65625 21.875 C 13.71832 20.0547 14.845166 18.59375 16.21875 18.59375 C 17.592088 18.59375 18.71881 20.0552 18.78125 21.875 L 27.09375 21.875 C 28.398125 21.875 29.4375 20.8043 29.4375 19.5 L 29.4375 8.71875 C 29.4375 7.4141499 28.398125 6.375 27.09375 6.375 L 5.3125 6.375 z M 9.625 10.4375 C 11.55989 10.4375 13.125 12.03385 13.125 13.96875 C 13.125 15.90365 11.55989 17.46875 9.625 17.46875 C 7.69011 17.46875 6.125 15.90365 6.125 13.96875 C 6.125 12.03385 7.69011 10.4375 9.625 10.4375 z M 22.46875 10.4375 C 24.40364 10.4375 25.96875 12.03385 25.96875 13.96875 C 25.96875 15.90365 24.40364 17.46875 22.46875 17.46875 C 20.53386 17.46875 18.96875 15.90365 18.96875 13.96875 C 18.96875 12.03385 20.53386 10.4375 22.46875 10.4375 z",tvt="M 25.770585,2.4552065 C 15.72282,13.962707 10.699956,19.704407 8.1768352,22.580207 c -1.261561,1.4379 -1.902282,2.1427 -2.21875,2.5 -0.141624,0.1599 -0.208984,0.2355 -0.25,0.2813 l 0.6875,0.75 c 10e-5,-10e-5 0.679191,0.727 0.6875,0.7187 0.01662,-0.016 0.02451,-0.024 0.03125,-0.031 0.01348,-0.014 0.04013,-0.038 0.0625,-0.062 0.04474,-0.05 0.120921,-0.1315 0.28125,-0.3126 0.320657,-0.3619 0.956139,-1.0921 2.2187499,-2.5312 2.5252219,-2.8781 7.5454589,-8.6169 17.5937499,-20.1250005 l -1.5,-1.3125 z m -20.5624998,3.9063 c -1.304375,0 -2.34375,1.0391 -2.34375,2.3437 l 0,10.8125005 c 0,1.3043 1.039375,2.375 2.34375,2.375 l 2.25,0 c 1.9518039,-2.2246 7.4710958,-8.5584 13.5624998,-15.5312005 l -15.8124998,0 z m 21.1249998,0 c -1.855467,2.1245 -2.114296,2.4005 -3.59375,4.0936995 1.767282,0.1815 3.15625,1.685301 3.15625,3.500001 0,1.9349 -1.56511,3.5 -3.5,3.5 -1.658043,0 -3.043426,-1.1411 -3.40625,-2.6875 -1.089617,1.2461 -2.647139,2.9988 -3.46875,3.9375 0.191501,-0.062 0.388502,-0.094 0.59375,-0.094 1.373338,0 2.50006,1.4614 2.5625,3.2812 l 8.3125,0 c 1.304375,0 2.34375,-1.0707 2.34375,-2.375 l 0,-10.8125005 c 0,-1.3046 -1.039375,-2.3437 -2.34375,-2.3437 l -0.65625,0 z M 9.5518351,10.423906 c 1.9348899,0 3.4999999,1.596401 3.4999999,3.531301 0,1.9349 -1.56511,3.5 -3.4999999,3.5 -1.9348899,0 -3.4999999,-1.5651 -3.4999999,-3.5 0,-1.9349 1.56511,-3.531301 3.4999999,-3.531301 z m 4.2187499,10.312601 c -0.206517,0.2356 -0.844218,0.9428 -1.03125,1.1562 l 0.8125,0 c 0.01392,-0.4081 0.107026,-0.7968 0.21875,-1.1562 z";function p6(e,t,n){e=Rn(e);let i=new m6(t,n);i._exitVRPath=tvt,i._enterVRPath=evt;let o=document.createElement("button");o.type="button",o.className="cesium-button cesium-vrButton",o.setAttribute("data-bind",'css: { "cesium-button-disabled" : _isOrthographic }, attr: { title: tooltip },click: command,enable: isVREnabled,cesiumSvgPath: { path: isVRMode ? _exitVRPath : _enterVRPath, width: 32, height: 32 }'),e.appendChild(o),be.applyBindings(i,o),this._container=e,this._viewModel=i,this._element=o}Object.defineProperties(p6.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});p6.prototype.isDestroyed=function(){return!1};p6.prototype.destroy=function(){return this._viewModel.destroy(),be.cleanNode(this._element),this._container.removeChild(this._element),ue(this)};var _6=p6;var iSe=new ae;function sSe(e){let t=e.clock;t.currentTime=e.timeJulian,t.shouldAnimate=!1}function nvt(e){let t=e.getPropertyIds(),n="";return t.forEach(function(i){let o=e.getProperty(i);u(o)&&(n+=`<tr><th>${i}</th><td>${o}</td></tr>`)}),n.length>0&&(n=`<table class="cesium-infoBox-defaultTable"><tbody>${n}</tbody></table>`),n}function ivt(e){let t,n=[],i=e.getPropertyIds();for(t=0;t<i.length;t++){let r=i[t];/^name$/i.test(r)?n[0]=e.getProperty(r):/name/i.test(r)?n[1]=e.getProperty(r):/^title$/i.test(r)?n[2]=e.getProperty(r):/^(id|identifier)$/i.test(r)?n[3]=e.getProperty(r):/element/i.test(r)?n[4]=e.getProperty(r):/(id|identifier)$/i.test(r)&&(n[5]=e.getProperty(r))}let o=n.length;for(t=0;t<o;t++){let r=n[t];if(u(r)&&r!=="")return r}return"Unnamed Feature"}function oSe(e,t){let n=e.scene.pick(t.position);if(u(n)){let i=x(n.id,n.primitive.id);if(i instanceof ar)return i;if(n instanceof ta)return new ar({name:ivt(n),description:nvt(n),feature:n})}if(u(e.scene.globe))return svt(e,t.position)}var ovt=new $;function y$(e,t){if(u(t)){let n=t.clock;if(u(n)&&u(e)){let i=n.startTime,o=n.stopTime;$.equals(i,o)&&(o=$.addSeconds(i,R.EPSILON2,ovt)),e.updateFromClock(),e.zoomTo(i,o)}}}var rvt=new h;function svt(e,t){let n=e.scene,i=n.camera.getPickRay(t),o=n.imageryLayers.pickImageryLayerFeatures(i,n);if(!u(o))return;let r=new ar({id:"Loading...",description:"Loading feature information..."});return o.then(function(s){if(e.selectedEntity!==r)return;if(!u(s)||s.length===0){e.selectedEntity=rSe();return}let a=s[0],c=new ar({id:a.name,description:a.description});if(u(a.position)){let l=e.scene.ellipsoid.cartographicToCartesian(a.position,rvt);c.position=new gl(l)}e.selectedEntity=c},function(){e.selectedEntity===r&&(e.selectedEntity=rSe())}),r}function rSe(){return new ar({id:"None",description:"No features found."})}function avt(e,t){let n=e._geocoder,i=e._homeButton,o=e._sceneModePicker,r=e._projectionPicker,s=e._baseLayerPicker,a=e._animation,c=e._timeline,l=e._fullscreenButton,f=e._infoBox,d=e._selectionIndicator,p=t?"hidden":"visible";if(u(n)&&(n.container.style.visibility=p),u(i)&&(i.container.style.visibility=p),u(o)&&(o.container.style.visibility=p),u(r)&&(r.container.style.visibility=p),u(s)&&(s.container.style.visibility=p),u(a)&&(a.container.style.visibility=p),u(c)&&(c.container.style.visibility=p),u(l)&&l.viewModel.isFullscreenEnabled&&(l.container.style.visibility=p),u(f)&&(f.container.style.visibility=p),u(d)&&(d.container.style.visibility=p),e._container){let g=t||!u(l)?0:l.container.clientWidth;e._vrButton.container.style.right=`${g}px`,e.forceResize()}}function Xi(e,t){e=Rn(e),t=x(t,x.EMPTY_OBJECT);let n=(!u(t.globe)||t.globe!==!1)&&(!u(t.baseLayerPicker)||t.baseLayerPicker!==!1),i=this,o=document.createElement("div");o.className="cesium-viewer",e.appendChild(o);let r=document.createElement("div");r.className="cesium-viewer-cesiumWidgetContainer",o.appendChild(r);let s=document.createElement("div");s.className="cesium-viewer-bottom",o.appendChild(s);let a=x(t.scene3DOnly,!1),c,l,f=!1;u(t.clockViewModel)?(l=t.clockViewModel,c=l.clock):(c=new cm,l=new dH(c),f=!0);let d=new I5(r,{baseLayer:n&&u(t.selectedImageryProviderViewModel)||u(t.baseLayer)||u(t.imageryProvider)?!1:void 0,clock:c,shouldAnimate:t.shouldAnimate,skyBox:t.skyBox,skyAtmosphere:t.skyAtmosphere,sceneMode:t.sceneMode,ellipsoid:t.ellipsoid,mapProjection:t.mapProjection,globe:t.globe,orderIndependentTranslucency:t.orderIndependentTranslucency,automaticallyTrackDataSourceClocks:t.automaticallyTrackDataSourceClocks,contextOptions:t.contextOptions,useDefaultRenderLoop:t.useDefaultRenderLoop,targetFrameRate:t.targetFrameRate,showRenderLoopErrors:t.showRenderLoopErrors,useBrowserRecommendedResolution:t.useBrowserRecommendedResolution,creditContainer:u(t.creditContainer)?t.creditContainer:s,creditViewport:t.creditViewport,dataSources:t.dataSources,scene3DOnly:a,shadows:t.shadows,terrainShadows:t.terrainShadows,mapMode2D:t.mapMode2D,blurActiveElementOnCanvasFocus:t.blurActiveElementOnCanvasFocus,requestRenderMode:t.requestRenderMode,maximumRenderTimeChange:t.maximumRenderTimeChange,depthPlaneEllipsoidOffset:t.depthPlaneEllipsoidOffset,msaaSamples:t.msaaSamples}),p=d.scene,g=new Ar;g.add(c.onTick,Xi.prototype._onTick,this);let m;if(!u(t.selectionIndicator)||t.selectionIndicator!==!1){let W=document.createElement("div");W.className="cesium-viewer-selectionIndicatorContainer",o.appendChild(W),m=new l6(W,p)}let y;if(!u(t.infoBox)||t.infoBox!==!1){let W=document.createElement("div");W.className="cesium-viewer-infoBoxContainer",o.appendChild(W),y=new GH(W);let j=y.viewModel;g.add(j.cameraClicked,Xi.prototype._onInfoBoxCameraClicked,this),g.add(j.closeClicked,Xi.prototype._onInfoBoxClockClicked,this)}let b=document.createElement("div");b.className="cesium-viewer-toolbar",o.appendChild(b);let C;if(!u(t.geocoder)||t.geocoder!==!1){let W=document.createElement("div");W.className="cesium-viewer-geocoderContainer",b.appendChild(W);let j;u(t.geocoder)&&typeof t.geocoder!="boolean"&&(j=Array.isArray(t.geocoder)?t.geocoder:[t.geocoder]),C=new BH({container:W,geocoderServices:j,scene:p}),g.add(C.viewModel.search.beforeExecute,Xi.prototype._clearObjects,this)}let A;(!u(t.homeButton)||t.homeButton!==!1)&&(A=new UH(b,p),u(C)&&g.add(A.viewModel.command.afterExecute,function(){let W=C.viewModel;W.searchText="",W.isSearchInProgress&&W.search()}),g.add(A.viewModel.command.beforeExecute,Xi.prototype._clearTrackedObject,this));let T;!a&&(!u(t.sceneModePicker)||t.sceneModePicker!==!1)&&(T=new t6(b,p));let E;t.projectionPicker&&(E=new r6(b,p));let v,D;if(n){let W=x(t.imageryProviderViewModels,vH()),j=x(t.terrainProviderViewModels,wH());v=new SH(b,{globe:p.globe,imageryProviderViewModels:W,selectedImageryProviderViewModel:t.selectedImageryProviderViewModel,terrainProviderViewModels:j,selectedTerrainProviderViewModel:t.selectedTerrainProviderViewModel}),D=b.getElementsByClassName("cesium-baseLayerPicker-dropDown")[0]}u(t.baseLayer)&&t.baseLayer!==!1&&(n&&(v.viewModel.selectedImagery=void 0),p.imageryLayers.removeAll(),p.imageryLayers.add(t.baseLayer)),u(t.terrainProvider)&&(n&&(v.viewModel.selectedTerrain=void 0),p.terrainProvider=t.terrainProvider),u(t.terrain)&&(n&&(p.globe.depthTestAgainstTerrain=!0),p.setTerrain(t.terrain));let O;if(!u(t.navigationHelpButton)||t.navigationHelpButton!==!1){let W=!0;try{if(u(window.localStorage)){let j=window.localStorage.getItem("cesium-hasSeenNavHelp");u(j)&&j?W=!1:window.localStorage.setItem("cesium-hasSeenNavHelp","true")}}catch{}O=new $H({container:b,instructionsInitiallyVisible:x(t.navigationInstructionsInitiallyVisible,W)})}let P;if(!u(t.animation)||t.animation!==!1){let W=document.createElement("div");W.className="cesium-viewer-animationContainer",o.appendChild(W),P=new gH(W,new yH(l))}let M;if(!u(t.timeline)||t.timeline!==!1){let W=document.createElement("div");W.className="cesium-viewer-timelineContainer",o.appendChild(W),M=new d6(W,c),M.addEventListener("settime",sSe,!1),M.zoomTo(c.startTime,c.stopTime)}let L,_,S;(!u(t.fullscreenButton)||t.fullscreenButton!==!1)&&(S=document.createElement("div"),S.className="cesium-viewer-fullscreenContainer",o.appendChild(S),L=new LH(S,t.fullscreenElement),_=Ba(L.viewModel,"isFullscreenEnabled",function(W){S.style.display=W?"block":"none",u(M)&&(M.container.style.right=`${S.clientWidth}px`,M.resize())}));let w,I,N;if(t.vrButton){let W=document.createElement("div");W.className="cesium-viewer-vrContainer",o.appendChild(W),w=new _6(W,p,t.fullScreenElement),I=Ba(w.viewModel,"isVREnabled",function(j){W.style.display=j?"block":"none",u(L)&&(W.style.right=`${S.clientWidth}px`),u(M)&&(M.container.style.right=`${W.clientWidth}px`,M.resize())}),N=Ba(w.viewModel,"isVRMode",function(j){avt(i,j)})}this._baseLayerPickerDropDown=D,this._fullscreenSubscription=_,this._vrSubscription=I,this._vrModeSubscription=N,this._dataSourceChangedListeners={},this._container=e,this._bottomContainer=s,this._element=o,this._cesiumWidget=d,this._selectionIndicator=m,this._infoBox=y,this._clockViewModel=l,this._destroyClockViewModel=f,this._toolbar=b,this._homeButton=A,this._sceneModePicker=T,this._projectionPicker=E,this._baseLayerPicker=v,this._navigationHelpButton=O,this._animation=P,this._timeline=M,this._fullscreenButton=L,this._vrButton=w,this._geocoder=C,this._eventHelper=g,this._lastWidth=0,this._lastHeight=0,this._enableInfoOrSelection=u(y)||u(m),this._selectedEntity=void 0,this._selectedEntityChanged=new me;let k=this._cesiumWidget.dataSources,z=this._cesiumWidget.dataSourceDisplay;g.add(k.dataSourceAdded,Xi.prototype._onDataSourceAdded,this),g.add(k.dataSourceRemoved,Xi.prototype._onDataSourceRemoved,this),g.add(p.postUpdate,Xi.prototype.resize,this);let V=k.length;for(let W=0;W<V;W++)this._dataSourceAdded(k,k.get(W));this._dataSourceAdded(void 0,z.defaultDataSource),g.add(k.dataSourceAdded,Xi.prototype._dataSourceAdded,this),g.add(k.dataSourceRemoved,Xi.prototype._dataSourceRemoved,this);function U(W){let j=oSe(i,W);u(j)?Y.getValueOrUndefined(j.position,i.clock.currentTime)?i.trackedEntity=j:i.zoomTo(j):u(i.trackedEntity)&&(i.trackedEntity=void 0)}function B(W){i.selectedEntity=oSe(i,W)}d.screenSpaceEventHandler.setInputAction(B,Cn.LEFT_CLICK),d.screenSpaceEventHandler.setInputAction(U,Cn.LEFT_DOUBLE_CLICK),d._canAnimateUpdateCallback=this._updateCanAnimate(this)}Object.defineProperties(Xi.prototype,{container:{get:function(){return this._container}},creditDisplay:{get:function(){return this._cesiumWidget.creditDisplay}},bottomContainer:{get:function(){return this._bottomContainer}},cesiumWidget:{get:function(){return this._cesiumWidget}},selectionIndicator:{get:function(){return this._selectionIndicator}},infoBox:{get:function(){return this._infoBox}},geocoder:{get:function(){return this._geocoder}},homeButton:{get:function(){return this._homeButton}},sceneModePicker:{get:function(){return this._sceneModePicker}},projectionPicker:{get:function(){return this._projectionPicker}},baseLayerPicker:{get:function(){return this._baseLayerPicker}},navigationHelpButton:{get:function(){return this._navigationHelpButton}},animation:{get:function(){return this._animation}},timeline:{get:function(){return this._timeline}},fullscreenButton:{get:function(){return this._fullscreenButton}},vrButton:{get:function(){return this._vrButton}},dataSourceDisplay:{get:function(){return this._cesiumWidget.dataSourceDisplay}},entities:{get:function(){return this._cesiumWidget.entities}},dataSources:{get:function(){return this._cesiumWidget.dataSources}},canvas:{get:function(){return this._cesiumWidget.canvas}},scene:{get:function(){return this._cesiumWidget.scene}},shadows:{get:function(){return this.scene.shadowMap.enabled},set:function(e){this.scene.shadowMap.enabled=e}},terrainShadows:{get:function(){return this.scene.globe.shadows},set:function(e){this.scene.globe.shadows=e}},shadowMap:{get:function(){return this.scene.shadowMap}},imageryLayers:{get:function(){return this.scene.imageryLayers}},terrainProvider:{get:function(){return this.scene.terrainProvider},set:function(e){this.scene.terrainProvider=e}},camera:{get:function(){return this.scene.camera}},ellipsoid:{get:function(){return this._scene.ellipsoid}},postProcessStages:{get:function(){return this.scene.postProcessStages}},clock:{get:function(){return this._clockViewModel.clock}},clockViewModel:{get:function(){return this._clockViewModel}},screenSpaceEventHandler:{get:function(){return this._cesiumWidget.screenSpaceEventHandler}},targetFrameRate:{get:function(){return this._cesiumWidget.targetFrameRate},set:function(e){this._cesiumWidget.targetFrameRate=e}},useDefaultRenderLoop:{get:function(){return this._cesiumWidget.useDefaultRenderLoop},set:function(e){this._cesiumWidget.useDefaultRenderLoop=e}},resolutionScale:{get:function(){return this._cesiumWidget.resolutionScale},set:function(e){this._cesiumWidget.resolutionScale=e}},useBrowserRecommendedResolution:{get:function(){return this._cesiumWidget.useBrowserRecommendedResolution},set:function(e){this._cesiumWidget.useBrowserRecommendedResolution=e}},allowDataSourcesToSuspendAnimation:{get:function(){return this._cesiumWidget.allowDataSourcesToSuspendAnimation},set:function(e){this._cesiumWidget.allowDataSourcesToSuspendAnimation=e}},trackedEntity:{get:function(){return this._cesiumWidget.trackedEntity},set:function(e){this._cesiumWidget.trackedEntity=e}},selectedEntity:{get:function(){return this._selectedEntity},set:function(e){if(this._selectedEntity!==e){this._selectedEntity=e;let t=u(this._selectionIndicator)?this._selectionIndicator.viewModel:void 0;u(e)?u(t)&&t.animateAppear():u(t)&&t.animateDepart(),this._selectedEntityChanged.raiseEvent(e)}}},selectedEntityChanged:{get:function(){return this._selectedEntityChanged}},trackedEntityChanged:{get:function(){return this._cesiumWidget.trackedEntityChanged}},clockTrackedDataSource:{get:function(){return this._cesiumWidget.clockTrackedDataSource},set:function(e){this._cesiumWidget.clockTrackedDataSource!==e&&(this._cesiumWidget.clockTrackedDataSource=e,y$(this._timeline,e))}}});Xi.prototype.extend=function(e,t){e(this,t)};Xi.prototype.resize=function(){let e=this._cesiumWidget,t=this._container,n=t.clientWidth,i=t.clientHeight,o=u(this._animation),r=u(this._timeline);if(e.resize(),n===this._lastWidth&&i===this._lastHeight)return;let s=i-125,a=this._baseLayerPickerDropDown;if(u(a)&&(a.style.maxHeight=`${s}px`),u(this._geocoder)){let m=this._geocoder.searchSuggestionsContainer;m.style.maxHeight=`${s}px`}u(this._infoBox)&&(this._infoBox.viewModel.maxHeight=s);let c=this._timeline,l,f=0,d=5,p=3,g=0;if(o&&window.getComputedStyle(this._animation.container).visibility!=="hidden"){let m=this._lastWidth;l=this._animation.container,n>900?(f=169,m<=900&&(l.style.width="169px",l.style.height="112px",this._animation.resize())):n>=600?(f=136,(m<600||m>900)&&(l.style.width="136px",l.style.height="90px",this._animation.resize())):(f=106,(m>600||m===0)&&(l.style.width="106px",l.style.height="70px",this._animation.resize())),d=f+5}if(r&&window.getComputedStyle(this._timeline.container).visibility!=="hidden"){let m=this._fullscreenButton,y=this._vrButton,b=c.container,C=b.style;p=b.clientHeight+3,C.left=`${f}px`;let A=0;u(m)&&(A+=m.container.clientWidth),u(y)&&(A+=y.container.clientWidth),C.right=`${A}px`,c.resize()}!r&&u(this._fullscreenButton)&&(g=this._fullscreenButton.container.clientWidth),this._bottomContainer.style.left=`${d}px`,this._bottomContainer.style.bottom=`${p}px`,this._bottomContainer.style.right=`${g}px`,this._lastWidth=n,this._lastHeight=i};Xi.prototype.forceResize=function(){this._lastWidth=0,this.resize()};Xi.prototype.render=function(){this._cesiumWidget.render()};Xi.prototype.isDestroyed=function(){return!1};Xi.prototype.destroy=function(){return u(this.screenSpaceEventHandler)&&!this.screenSpaceEventHandler.isDestroyed()&&(this.screenSpaceEventHandler.removeInputAction(Cn.LEFT_CLICK),this.screenSpaceEventHandler.removeInputAction(Cn.LEFT_DOUBLE_CLICK)),this._container.removeChild(this._element),this._element.removeChild(this._toolbar),this._eventHelper.removeAll(),u(this._geocoder)&&(this._geocoder=this._geocoder.destroy()),u(this._homeButton)&&(this._homeButton=this._homeButton.destroy()),u(this._sceneModePicker)&&(this._sceneModePicker=this._sceneModePicker.destroy()),u(this._projectionPicker)&&(this._projectionPicker=this._projectionPicker.destroy()),u(this._baseLayerPicker)&&(this._baseLayerPicker=this._baseLayerPicker.destroy()),u(this._animation)&&(this._element.removeChild(this._animation.container),this._animation=this._animation.destroy()),u(this._timeline)&&(this._timeline.removeEventListener("settime",sSe,!1),this._element.removeChild(this._timeline.container),this._timeline=this._timeline.destroy()),u(this._fullscreenButton)&&(this._fullscreenSubscription.dispose(),this._element.removeChild(this._fullscreenButton.container),this._fullscreenButton=this._fullscreenButton.destroy()),u(this._vrButton)&&(this._vrSubscription.dispose(),this._vrModeSubscription.dispose(),this._element.removeChild(this._vrButton.container),this._vrButton=this._vrButton.destroy()),u(this._infoBox)&&(this._element.removeChild(this._infoBox.container),this._infoBox=this._infoBox.destroy()),u(this._selectionIndicator)&&(this._element.removeChild(this._selectionIndicator.container),this._selectionIndicator=this._selectionIndicator.destroy()),this._destroyClockViewModel&&(this._clockViewModel=this._clockViewModel.destroy()),this._cesiumWidget=this._cesiumWidget.destroy(),ue(this)};Xi.prototype._dataSourceAdded=function(e,t){t.entities.collectionChanged.addEventListener(Xi.prototype._onEntityCollectionChanged,this)};Xi.prototype._dataSourceRemoved=function(e,t){let n=t.entities;n.collectionChanged.removeEventListener(Xi.prototype._onEntityCollectionChanged,this),u(this.selectedEntity)&&n.getById(this.selectedEntity.id)===this.selectedEntity&&(this.selectedEntity=void 0)};Xi.prototype._updateCanAnimate=function(e){return function(t){e._clockViewModel.canAnimate=t}};Xi.prototype._onTick=function(e){let t=e.currentTime,n,i=!1,o=this.selectedEntity,r=u(o)&&this._enableInfoOrSelection;r&&o.isShowing&&o.isAvailable(t)&&(this._cesiumWidget.dataSourceDisplay.getBoundingSphere(o,!0,iSe)!==dt.FAILED?n=iSe.center:u(o.position)&&(n=o.position.getValue(t,n)),i=u(n));let s=u(this._selectionIndicator)?this._selectionIndicator.viewModel:void 0;u(s)&&(s.position=h.clone(n,s.position),s.showSelection=r&&i,s.update());let a=u(this._infoBox)?this._infoBox.viewModel:void 0;u(a)&&(a.showInfo=r,a.enableCamera=i,a.isCameraTracking=this.trackedEntity===this.selectedEntity,r?(a.titleText=x(o.name,o.id),a.description=Y.getValueOrDefault(o.description,t,"")):(a.titleText="",a.description=""))};Xi.prototype._onEntityCollectionChanged=function(e,t,n){let i=n.length;for(let o=0;o<i;o++){let r=n[o];this.selectedEntity===r&&(this.selectedEntity=void 0)}};Xi.prototype._onInfoBoxCameraClicked=function(e){if(e.isCameraTracking&&this.trackedEntity===this.selectedEntity)this.trackedEntity=void 0;else{let n=this.selectedEntity.position;u(n)?this.trackedEntity=this.selectedEntity:this.zoomTo(this.selectedEntity)}};Xi.prototype._clearTrackedObject=function(){this.trackedEntity=void 0};Xi.prototype._onInfoBoxClockClicked=function(e){this.selectedEntity=void 0};Xi.prototype._clearObjects=function(){this.trackedEntity=void 0,this.selectedEntity=void 0};Xi.prototype._onDataSourceChanged=function(e){this.clockTrackedDataSource===e&&y$(this.timeline,e)};Xi.prototype._onDataSourceAdded=function(e,t){this._cesiumWidget._automaticallyTrackDataSourceClocks&&t===this.clockTrackedDataSource&&y$(this._timeline,t);let n=t.entities.id,i=this._eventHelper.add(t.changedEvent,Xi.prototype._onDataSourceChanged,this);this._dataSourceChangedListeners[n]=i};Xi.prototype._onDataSourceRemoved=function(e,t){let n=t.entities.id;this._dataSourceChangedListeners[n](),this._dataSourceChangedListeners[n]=void 0};Xi.prototype.zoomTo=function(e,t){return this._cesiumWidget.zoomTo(e,t)};Xi.prototype.flyTo=function(e,t){return this._cesiumWidget.flyTo(e,t)};var aSe=Xi;function cvt(e){let t=document.createElement("div");t.className="cesium-viewer-cesium3DTilesInspectorContainer",e.container.appendChild(t);let n=new AH(t,e.scene);Object.defineProperties(e,{cesium3DTilesInspector:{get:function(){return n}}})}var cSe=cvt;function lvt(e){let t=document.createElement("div");t.className="cesium-viewer-cesiumInspectorContainer",e.container.appendChild(t);let n=new PH(t,e.scene);Object.defineProperties(e,{cesiumInspector:{get:function(){return n}}})}var lSe=lvt;function uvt(e,t){t=x(t,x.EMPTY_OBJECT);let n=!0,i=x(t.flyToOnDrop,!0),o=new me,r=x(t.clearOnDrop,!0),s=x(t.dropTarget,e.container),a=x(t.clampToGround,!0),c=t.proxy;s=Rn(s),Object.defineProperties(e,{dropTarget:{get:function(){return s},set:function(f){uSe(s,l),s=f,x$(s,l)}},dropEnabled:{get:function(){return n},set:function(f){f!==n&&(f?x$(s,l):uSe(s,l),n=f)}},dropError:{get:function(){return o}},clearOnDrop:{get:function(){return r},set:function(f){r=f}},flyToOnDrop:{get:function(){return i},set:function(f){i=f}},proxy:{get:function(){return c},set:function(f){c=f}},clampToGround:{get:function(){return a},set:function(f){a=f}}});function l(f){Xb(f),r&&(e.entities.removeAll(),e.dataSources.removeAll());let d=f.dataTransfer.files,p=d.length;for(let g=0;g<p;g++){let m=d[g],y=new FileReader;y.onload=fvt(e,m,c,a),y.onerror=dvt(e,m),y.readAsText(m)}}x$(s,l),e.destroy=mU(e,e.destroy,function(){e.dropEnabled=!1}),e._handleDrop=l}function Xb(e){e.stopPropagation(),e.preventDefault()}function uSe(e,t){let n=e;u(n)&&(n.removeEventListener("drop",t,!1),n.removeEventListener("dragenter",Xb,!1),n.removeEventListener("dragover",Xb,!1),n.removeEventListener("dragexit",Xb,!1))}function x$(e,t){e.addEventListener("drop",t,!1),e.addEventListener("dragenter",Xb,!1),e.addEventListener("dragover",Xb,!1),e.addEventListener("dragexit",Xb,!1)}function fvt(e,t,n,i){let o=e.scene;return function(r){let s=t.name;try{let a;if(/\.czml$/i.test(s))a=dk.load(JSON.parse(r.target.result),{sourceUri:s});else if(/\.geojson$/i.test(s)||/\.json$/i.test(s)||/\.topojson$/i.test(s))a=aV.load(JSON.parse(r.target.result),{sourceUri:s,clampToGround:i});else if(/\.(kml|kmz)$/i.test(s))a=RV.load(t,{sourceUri:s,proxy:n,camera:o.camera,canvas:o.canvas,clampToGround:i,screenOverlayContainer:e.container});else if(/\.gpx$/i.test(s))a=gV.load(t,{sourceUri:s,proxy:n});else{e.dropError.raiseEvent(e,s,`Unrecognized file: ${s}`);return}u(a)&&e.dataSources.add(a).then(function(c){e.flyToOnDrop&&e.flyTo(c)}).catch(function(c){e.dropError.raiseEvent(e,s,c)})}catch(a){e.dropError.raiseEvent(e,s,a)}}}function dvt(e,t){return function(n){e.dropError.raiseEvent(e,t.name,n.target.error)}}var fSe=uvt;function hvt(e,t){t=x(t,x.EMPTY_OBJECT);let n=new XH({scene:e.scene,container:e.bottomContainer,lowFrameRateMessage:t.lowFrameRateMessage});Object.defineProperties(e,{performanceWatchdog:{get:function(){return n}}})}var dSe=hvt;function hSe(e){let t=e.split(`
`),n;for(n=0;n<t.length&&!t[n].match(/\S/);n++);if(n===t.length)return"";let i="",o=/^\s*/,s=t[n].match(o)[0].length;for(let a=n;a<t.length;a++){let c=t[a];c.match(o)[0].length>=s&&(c=c.slice(s)),i+=`${c}
`}return i}function od(e){this._scene=e,this._voxelPrimitive=void 0,this._customShaderCompilationRemoveCallback=void 0,this._definedProperties=[],this._getPrimitiveFunctions=[],this._modelMatrixReady=!1;let t=this;function n(o){let{name:r,initialValue:s}=o;t._definedProperties.push(r);let a=o.setPrimitiveFunction;a===!0&&(a=function(f){t._voxelPrimitive[r]=f});let c=o.getPrimitiveFunction;c===!0&&(c=function(){t[r]=t._voxelPrimitive[r]}),u(c)&&t._getPrimitiveFunctions.push(c);let l=be.observable();return be.defineProperty(t,r,{get:function(){return l()},set:function(f){typeof s=="number"&&typeof f=="string"&&(f=Number(f),isNaN(f)&&(f=s)),typeof s=="boolean"&&typeof f=="number"&&(f=f===1),l(f),u(a)&&u(t._voxelPrimitive)&&(a(f),e.requestRender())}}),t[r]=s,l}function i(o,r){return function(s){let a=t._voxelPrimitive[o].clone();a[r]=s,t._voxelPrimitive[o]=a}}n({name:"inspectorVisible",initialValue:!0}),n({name:"displayVisible",initialValue:!1}),n({name:"transformVisible",initialValue:!1}),n({name:"boundsVisible",initialValue:!1}),n({name:"clippingVisible",initialValue:!1}),n({name:"shaderVisible",initialValue:!1}),n({name:"shaderString",initialValue:"",getPrimitiveFunction:function(){let o=t._voxelPrimitive.customShader.fragmentShaderText;t.shaderString=hSe(o)}}),n({name:"shaderCompilationMessage",initialValue:""}),n({name:"shaderCompilationSuccess",initialValue:!0}),n({name:"depthTest",initialValue:!1,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),n({name:"show",initialValue:!0,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),n({name:"disableUpdate",initialValue:!1,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),n({name:"debugDraw",initialValue:!1,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),n({name:"jitter",initialValue:!0,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),n({name:"nearestSampling",initialValue:!0,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),n({name:"screenSpaceError",initialValue:4,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),n({name:"stepSize",initialValue:1,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),n({name:"shapeIsBox",getPrimitiveFunction:function(){let o=t._voxelPrimitive.shape;t.shapeIsBox=o===zi.BOX}}),n({name:"shapeIsEllipsoid",getPrimitiveFunction:function(){let o=t._voxelPrimitive.shape;t.shapeIsEllipsoid=o===zi.ELLIPSOID}}),n({name:"shapeIsCylinder",getPrimitiveFunction:function(){let o=t._voxelPrimitive.shape;t.shapeIsCylinder=o===zi.CYLINDER}}),n({name:"boundsBoxMaxX",initialValue:0,setPrimitiveFunction:i("maxBounds","x"),getPrimitiveFunction:function(){t.boundsBoxMaxX=t._voxelPrimitive.maxBounds.x}}),n({name:"boundsBoxMinX",initialValue:0,setPrimitiveFunction:i("minBounds","x"),getPrimitiveFunction:function(){t.boundsBoxMinX=t._voxelPrimitive.minBounds.x}}),n({name:"boundsBoxMaxY",initialValue:0,setPrimitiveFunction:i("maxBounds","y"),getPrimitiveFunction:function(){t.boundsBoxMaxY=t._voxelPrimitive.maxBounds.y}}),n({name:"boundsBoxMinY",initialValue:0,setPrimitiveFunction:i("minBounds","y"),getPrimitiveFunction:function(){t.boundsBoxMinY=t._voxelPrimitive.minBounds.y}}),n({name:"boundsBoxMaxZ",initialValue:0,setPrimitiveFunction:i("maxBounds","z"),getPrimitiveFunction:function(){t.boundsBoxMaxZ=t._voxelPrimitive.maxBounds.z}}),n({name:"boundsBoxMinZ",initialValue:0,setPrimitiveFunction:i("minBounds","z"),getPrimitiveFunction:function(){t.boundsBoxMinZ=t._voxelPrimitive.minBounds.z}}),n({name:"boundsEllipsoidMaxLongitude",initialValue:0,setPrimitiveFunction:i("maxBounds","x"),getPrimitiveFunction:function(){t.boundsEllipsoidMaxLongitude=t._voxelPrimitive.maxBounds.x}}),n({name:"boundsEllipsoidMinLongitude",initialValue:0,setPrimitiveFunction:i("minBounds","x"),getPrimitiveFunction:function(){t.boundsEllipsoidMinLongitude=t._voxelPrimitive.minBounds.x}}),n({name:"boundsEllipsoidMaxLatitude",initialValue:0,setPrimitiveFunction:i("maxBounds","y"),getPrimitiveFunction:function(){t.boundsEllipsoidMaxLatitude=t._voxelPrimitive.maxBounds.y}}),n({name:"boundsEllipsoidMinLatitude",initialValue:0,setPrimitiveFunction:i("minBounds","y"),getPrimitiveFunction:function(){t.boundsEllipsoidMinLatitude=t._voxelPrimitive.minBounds.y}}),n({name:"boundsEllipsoidMaxHeight",initialValue:0,setPrimitiveFunction:i("maxBounds","z"),getPrimitiveFunction:function(){t.boundsEllipsoidMaxHeight=t._voxelPrimitive.maxBounds.z}}),n({name:"boundsEllipsoidMinHeight",initialValue:0,setPrimitiveFunction:i("minBounds","z"),getPrimitiveFunction:function(){t.boundsEllipsoidMinHeight=t._voxelPrimitive.minBounds.z}}),n({name:"boundsCylinderMaxRadius",initialValue:0,setPrimitiveFunction:i("maxBounds","x"),getPrimitiveFunction:function(){t.boundsCylinderMaxRadius=t._voxelPrimitive.maxBounds.x}}),n({name:"boundsCylinderMinRadius",initialValue:0,setPrimitiveFunction:i("minBounds","x"),getPrimitiveFunction:function(){t.boundsCylinderMinRadius=t._voxelPrimitive.minBounds.x}}),n({name:"boundsCylinderMaxHeight",initialValue:0,setPrimitiveFunction:i("maxBounds","y"),getPrimitiveFunction:function(){t.boundsCylinderMaxHeight=t._voxelPrimitive.maxBounds.y}}),n({name:"boundsCylinderMinHeight",initialValue:0,setPrimitiveFunction:i("minBounds","y"),getPrimitiveFunction:function(){t.boundsCylinderMinHeight=t._voxelPrimitive.minBounds.y}}),n({name:"boundsCylinderMaxAngle",initialValue:0,setPrimitiveFunction:i("maxBounds","z"),getPrimitiveFunction:function(){t.boundsCylinderMaxAngle=t._voxelPrimitive.maxBounds.z}}),n({name:"boundsCylinderMinAngle",initialValue:0,setPrimitiveFunction:i("minBounds","z"),getPrimitiveFunction:function(){t.boundsCylinderMinAngle=t._voxelPrimitive.minBounds.z}}),n({name:"clippingBoxMaxX",initialValue:0,setPrimitiveFunction:i("maxClippingBounds","x"),getPrimitiveFunction:function(){t.clippingBoxMaxX=t._voxelPrimitive.maxClippingBounds.x}}),n({name:"clippingBoxMinX",initialValue:0,setPrimitiveFunction:i("minClippingBounds","x"),getPrimitiveFunction:function(){t.clippingBoxMinX=t._voxelPrimitive.minClippingBounds.x}}),n({name:"clippingBoxMaxY",initialValue:0,setPrimitiveFunction:i("maxClippingBounds","y"),getPrimitiveFunction:function(){t.clippingBoxMaxY=t._voxelPrimitive.maxClippingBounds.y}}),n({name:"clippingBoxMinY",initialValue:0,setPrimitiveFunction:i("minClippingBounds","y"),getPrimitiveFunction:function(){t.clippingBoxMinY=t._voxelPrimitive.minClippingBounds.y}}),n({name:"clippingBoxMaxZ",initialValue:0,setPrimitiveFunction:i("maxClippingBounds","z"),getPrimitiveFunction:function(){t.clippingBoxMaxZ=t._voxelPrimitive.maxClippingBounds.z}}),n({name:"clippingBoxMinZ",initialValue:0,setPrimitiveFunction:i("minClippingBounds","z"),getPrimitiveFunction:function(){t.clippingBoxMinZ=t._voxelPrimitive.minClippingBounds.z}}),n({name:"clippingEllipsoidMaxLongitude",initialValue:0,setPrimitiveFunction:i("maxClippingBounds","x"),getPrimitiveFunction:function(){t.clippingEllipsoidMaxLongitude=t._voxelPrimitive.maxClippingBounds.x}}),n({name:"clippingEllipsoidMinLongitude",initialValue:0,setPrimitiveFunction:i("minClippingBounds","x"),getPrimitiveFunction:function(){t.clippingEllipsoidMinLongitude=t._voxelPrimitive.minClippingBounds.x}}),n({name:"clippingEllipsoidMaxLatitude",initialValue:0,setPrimitiveFunction:i("maxClippingBounds","y"),getPrimitiveFunction:function(){t.clippingEllipsoidMaxLatitude=t._voxelPrimitive.maxClippingBounds.y}}),n({name:"clippingEllipsoidMinLatitude",initialValue:0,setPrimitiveFunction:i("minClippingBounds","y"),getPrimitiveFunction:function(){t.clippingEllipsoidMinLatitude=t._voxelPrimitive.minClippingBounds.y}}),n({name:"clippingEllipsoidMaxHeight",initialValue:0,setPrimitiveFunction:i("maxClippingBounds","z"),getPrimitiveFunction:function(){t.clippingEllipsoidMaxHeight=t._voxelPrimitive.maxClippingBounds.z}}),n({name:"clippingEllipsoidMinHeight",initialValue:0,setPrimitiveFunction:i("minClippingBounds","z"),getPrimitiveFunction:function(){t.clippingEllipsoidMinHeight=t._voxelPrimitive.minClippingBounds.z}}),n({name:"clippingCylinderMaxRadius",initialValue:0,setPrimitiveFunction:i("maxClippingBounds","x"),getPrimitiveFunction:function(){t.clippingCylinderMaxRadius=t._voxelPrimitive.maxClippingBounds.x}}),n({name:"clippingCylinderMinRadius",initialValue:0,setPrimitiveFunction:i("minClippingBounds","x"),getPrimitiveFunction:function(){t.clippingCylinderMinRadius=t._voxelPrimitive.minClippingBounds.x}}),n({name:"clippingCylinderMaxHeight",initialValue:0,setPrimitiveFunction:i("maxClippingBounds","y"),getPrimitiveFunction:function(){t.clippingCylinderMaxHeight=t._voxelPrimitive.maxClippingBounds.y}}),n({name:"clippingCylinderMinHeight",initialValue:0,setPrimitiveFunction:i("minClippingBounds","y"),getPrimitiveFunction:function(){t.clippingCylinderMinHeight=t._voxelPrimitive.minClippingBounds.y}}),n({name:"clippingCylinderMaxAngle",initialValue:0,setPrimitiveFunction:i("maxClippingBounds","z"),getPrimitiveFunction:function(){t.clippingCylinderMaxAngle=t._voxelPrimitive.maxClippingBounds.z}}),n({name:"clippingCylinderMinAngle",initialValue:0,setPrimitiveFunction:i("minClippingBounds","z"),getPrimitiveFunction:function(){t.clippingCylinderMinAngle=t._voxelPrimitive.minClippingBounds.z}}),n({name:"translationX",initialValue:0,setPrimitiveFunction:function(){t._modelMatrixReady&&qm(t)},getPrimitiveFunction:function(){t.translationX=F.getTranslation(t._voxelPrimitive.modelMatrix,new h).x}}),n({name:"translationY",initialValue:0,setPrimitiveFunction:function(){t._modelMatrixReady&&qm(t)},getPrimitiveFunction:function(){t.translationY=F.getTranslation(t._voxelPrimitive.modelMatrix,new h).y}}),n({name:"translationZ",initialValue:0,setPrimitiveFunction:function(){t._modelMatrixReady&&qm(t)},getPrimitiveFunction:function(){t.translationZ=F.getTranslation(t._voxelPrimitive.modelMatrix,new h).z}}),n({name:"scaleX",initialValue:1,setPrimitiveFunction:function(){t._modelMatrixReady&&qm(t)},getPrimitiveFunction:function(){t.scaleX=F.getScale(t._voxelPrimitive.modelMatrix,new h).x}}),n({name:"scaleY",initialValue:1,setPrimitiveFunction:function(){t._modelMatrixReady&&qm(t)},getPrimitiveFunction:function(){t.scaleY=F.getScale(t._voxelPrimitive.modelMatrix,new h).y}}),n({name:"scaleZ",initialValue:1,setPrimitiveFunction:function(){t._modelMatrixReady&&qm(t)},getPrimitiveFunction:function(){t.scaleZ=F.getScale(t._voxelPrimitive.modelMatrix,new h).z}}),n({name:"angleX",initialValue:0,setPrimitiveFunction:function(){t._modelMatrixReady&&qm(t)}}),n({name:"angleY",initialValue:0,setPrimitiveFunction:function(){t._modelMatrixReady&&qm(t)}}),n({name:"angleZ",initialValue:0,setPrimitiveFunction:function(){t._modelMatrixReady&&qm(t)}})}var mvt=new h,pvt=new h,_vt=new Wa,gvt=new J;function qm(e){let t=h.fromElements(e.translationX,e.translationY,e.translationZ,mvt),n=h.fromElements(e.scaleX,e.scaleY,e.scaleZ,pvt),i=_vt;i.heading=e.angleX,i.pitch=e.angleY,i.roll=e.angleZ;let o=J.fromHeadingPitchRoll(i,gvt),r=J.multiplyByScale(o,n,o);e._voxelPrimitive.modelMatrix=F.fromRotationTranslation(r,t,e._voxelPrimitive.modelMatrix)}Object.defineProperties(od.prototype,{scene:{get:function(){return this._scene}},voxelPrimitive:{get:function(){return this._voxelPrimitive},set:function(e){if(u(this._customShaderCompilationRemoveCallback)&&this._customShaderCompilationRemoveCallback(),u(e)){this._voxelPrimitive=e;let t=this;t._customShaderCompilationRemoveCallback=t._voxelPrimitive.customShaderCompilationEvent.addEventListener(function(n){let i=t._voxelPrimitive.customShader.fragmentShaderText;t.shaderString=hSe(i),u(n)?(t.shaderCompilationMessage=n.message,t.shaderCompilationSuccess=!1):(t.shaderCompilationMessage="Shader compiled successfully!",t.shaderCompilationSuccess=!0)}),t._modelMatrixReady=!1;for(let n=0;n<t._getPrimitiveFunctions.length;n++)t._getPrimitiveFunctions[n]();t._modelMatrixReady=!0,qm(t)}}}});od.prototype.toggleInspector=function(){this.inspectorVisible=!this.inspectorVisible};od.prototype.toggleDisplay=function(){this.displayVisible=!this.displayVisible};od.prototype.toggleTransform=function(){this.transformVisible=!this.transformVisible};od.prototype.toggleBounds=function(){this.boundsVisible=!this.boundsVisible};od.prototype.toggleClipping=function(){this.clippingVisible=!this.clippingVisible};od.prototype.toggleShader=function(){this.shaderVisible=!this.shaderVisible};od.prototype.compileShader=function(){u(this._voxelPrimitive)&&(this._voxelPrimitive.customShader=new hS({fragmentShaderText:this.shaderString,uniforms:this._voxelPrimitive.customShader.uniforms}))};od.prototype.shaderEditorKeyPress=function(e,t){if(t.keyCode===9){t.preventDefault();let n=t.target,i=n.selectionStart,o=n.selectionEnd,r=o,a=n.value.slice(i,o).split(`
`),c=a.length,l;if(t.shiftKey)for(l=0;l<c;++l)a[l][0]===" "&&(a[l][1]===" "?(a[l]=a[l].substr(2),r-=2):(a[l]=a[l].substr(1),r-=1));else for(l=0;l<c;++l)a[l]=`  ${a[l]}`,r+=2;let f=a.join(`
`);n.value=n.value.slice(0,i)+f+n.value.slice(o),n.selectionStart=i!==o?i:r,n.selectionEnd=r}else t.ctrlKey&&(t.keyCode===10||t.keyCode===13)&&this.compileShader();return!0};od.prototype.isDestroyed=function(){return!1};od.prototype.destroy=function(){let e=this;return this._definedProperties.forEach(function(t){be.getObservable(e,t).dispose()}),ue(this)};var g6=od;function y6(e,t){e=Rn(e);let n=document.createElement("div"),i=new g6(t);this._viewModel=i,this._container=e,this._element=n;let o=document.createElement("div");o.textContent="Voxel Inspector",o.className="cesium-cesiumInspector-button",o.setAttribute("data-bind","click: toggleInspector"),n.appendChild(o),n.className="cesium-cesiumInspector cesium-VoxelInspector",n.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : inspectorVisible, "cesium-cesiumInspector-hidden" : !inspectorVisible}'),e.appendChild(n);let r=document.createElement("div");r.className="cesium-cesiumInspector-dropDown",n.appendChild(r);let s=gc.createSection,a=gc.createCheckbox,c=gc.createRangeInput,l=gc.createButton,f=s(r,"Display","displayVisible","toggleDisplay"),d=s(r,"Transform","transformVisible","toggleTransform"),p=s(r,"Bounds","boundsVisible","toggleBounds"),g=s(r,"Clipping","clippingVisible","toggleClipping"),m=s(r,"Shader","shaderVisible","toggleShader");f.appendChild(a("Depth Test","depthTest")),f.appendChild(a("Show","show")),f.appendChild(a("Disable Update","disableUpdate")),f.appendChild(a("Debug Draw","debugDraw")),f.appendChild(a("Jitter","jitter")),f.appendChild(a("Nearest Sampling","nearestSampling")),f.appendChild(c("Screen Space Error","screenSpaceError",0,128)),f.appendChild(c("Step Size","stepSize",0,2));let y=10,b=10,C=R.PI;d.appendChild(c("Translation X","translationX",-y,+y)),d.appendChild(c("Translation Y","translationY",-y,+y)),d.appendChild(c("Translation Z","translationZ",-y,+y)),d.appendChild(c("Scale X","scaleX",0,+b)),d.appendChild(c("Scale Y","scaleY",0,+b)),d.appendChild(c("Scale Z","scaleZ",0,+b)),d.appendChild(c("Heading","angleX",-C,+C)),d.appendChild(c("Pitch","angleY",-C,+C)),d.appendChild(c("Roll","angleZ",-C,+C));let A=zi.getMinBounds(zi.BOX),T=zi.getMaxBounds(zi.BOX),E=h.fromElements(zi.getMinBounds(zi.ELLIPSOID).x,zi.getMinBounds(zi.ELLIPSOID).y,-ee.WGS84.maximumRadius,new h),v=h.fromElements(zi.getMaxBounds(zi.ELLIPSOID).x,zi.getMaxBounds(zi.ELLIPSOID).y,1e7,new h),D=zi.getMinBounds(zi.CYLINDER),O=zi.getMaxBounds(zi.CYLINDER);IS("Max X","Min X","Max Y","Min Y","Max Z","Min Z","boundsBoxMaxX","boundsBoxMinX","boundsBoxMaxY","boundsBoxMinY","boundsBoxMaxZ","boundsBoxMinZ",A,T,"shapeIsBox",p),IS("Max Longitude","Min Longitude","Max Latitude","Min Latitude","Max Height","Min Height","boundsEllipsoidMaxLongitude","boundsEllipsoidMinLongitude","boundsEllipsoidMaxLatitude","boundsEllipsoidMinLatitude","boundsEllipsoidMaxHeight","boundsEllipsoidMinHeight",E,v,"shapeIsEllipsoid",p),IS("Max Radius","Min Radius","Max Height","Min Height","Max Angle","Min Angle","boundsCylinderMaxRadius","boundsCylinderMinRadius","boundsCylinderMaxHeight","boundsCylinderMinHeight","boundsCylinderMaxAngle","boundsCylinderMinAngle",D,O,"shapeIsCylinder",p),IS("Max X","Min X","Max Y","Min Y","Max Z","Min Z","clippingBoxMaxX","clippingBoxMinX","clippingBoxMaxY","clippingBoxMinY","clippingBoxMaxZ","clippingBoxMinZ",A,T,"shapeIsBox",g),IS("Max Longitude","Min Longitude","Max Latitude","Min Latitude","Max Height","Min Height","clippingEllipsoidMaxLongitude","clippingEllipsoidMinLongitude","clippingEllipsoidMaxLatitude","clippingEllipsoidMinLatitude","clippingEllipsoidMaxHeight","clippingEllipsoidMinHeight",E,v,"shapeIsEllipsoid",g),IS("Max Radius","Min Radius","Max Height","Min Height","Max Angle","Min Angle","clippingCylinderMaxRadius","clippingCylinderMinRadius","clippingCylinderMaxHeight","clippingCylinderMinHeight","clippingCylinderMaxAngle","clippingCylinderMinAngle",D,O,"shapeIsCylinder",g);let P=document.createElement("div");m.appendChild(P);let M=document.createElement("textarea");M.setAttribute("data-bind","textInput: shaderString, event: { keydown: shaderEditorKeyPress }"),P.className="cesium-cesiumInspector-styleEditor",P.appendChild(M);let L=l("Compile (Ctrl+Enter)","compileShader");P.appendChild(L);let _=document.createElement("label");_.style.display="block",_.setAttribute("data-bind","text: shaderCompilationMessage, style: {color: shaderCompilationSuccess ? 'green' : 'red'}"),P.appendChild(_),be.applyBindings(i,n)}Object.defineProperties(y6.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});y6.prototype.isDestroyed=function(){return!1};y6.prototype.destroy=function(){return be.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),ue(this)};function IS(e,t,n,i,o,r,s,a,c,l,f,d,p,g,m,y){let b=gc.createRangeInput,C=p,A=g,T=y.appendChild(document.createElement("div"));T.setAttribute("data-bind",`if: ${m}`),T.appendChild(b(e,s,C.x,A.x)),T.appendChild(b(t,a,C.x,A.x)),T.appendChild(b(n,c,C.y,A.y)),T.appendChild(b(i,l,C.y,A.y)),T.appendChild(b(o,f,C.z,A.z)),T.appendChild(b(r,d,C.z,A.z))}var x6=y6;function yvt(e){let t=document.createElement("div");t.className="cesium-viewer-voxelInspectorContainer",e.container.appendChild(t);let n=new x6(t,e.scene);Object.defineProperties(e,{voxelInspector:{get:function(){return n}}})}var mSe=yvt;globalThis.CESIUM_VERSION="1.123";var huo="1.123";export{bp as AlphaMode,J2 as AlphaPipelineStage,JN as AnchorPointDirect,e2 as AnchorPointIndirect,gH as Animation,yH as AnimationViewModel,so as Appearance,di as ApproximateTerrainHeights,A0e as ArcGISTiledElevationTerrainProvider,Lm as ArcGisBaseMapType,J0 as ArcGisMapServerImageryProvider,jf as ArcGisMapService,nn as ArcType,kc as ArticulationStageType,St as AssociativeArray,AA as Atmosphere,O2 as AtmospherePipelineStage,Ln as AttributeCompression,rn as AttributeType,x8 as AutoExposure,I_ as AutomaticUniforms,Vo as Axis,Vy as AxisAlignedBoundingBox,d2 as B3dmLoader,f2 as B3dmParser,SH as BaseLayerPicker,TH as BaseLayerPickerViewModel,LC as BatchTable,oA as BatchTableHierarchy,xl as BatchTexture,eF as BatchTexturePipelineStage,po as Billboard,Cf as BillboardCollection,Sc as BillboardGraphics,jM as BillboardVisualizer,E0e as BingMapsGeocoderService,bU as BingMapsImageryProvider,PD as BingMapsStyle,Xa as BlendEquation,Do as BlendFunction,Ro as BlendOption,un as BlendingState,qe as BoundingRectangle,ae as BoundingSphere,dt as BoundingSphereState,pA as BoundingVolumeSemantics,pTe as BoxEmitter,Ya as BoxGeometry,zL as BoxGeometryUpdater,HC as BoxGraphics,Ih as BoxOutlineGeometry,lz as BrdfLutGenerator,xt as Buffer,aA as BufferLoader,ke as BufferUsage,oF as CPUStylingPipelineStage,HL as CallbackPositionProperty,Fh as CallbackProperty,uo as Camera,E8 as CameraEventAggregator,Ui as CameraEventType,uz as CameraFlightPath,H as Cartesian2,h as Cartesian3,oe as Cartesian4,de as Cartographic,S0e as CartographicGeocoderService,w0e as CatmullRomSpline,iA as Cesium3DContentGroup,Od as Cesium3DTile,ng as Cesium3DTileBatchTable,nu as Cesium3DTileColorBlendMode,_Te as Cesium3DTileContent,ZA as Cesium3DTileContentFactory,Qo as Cesium3DTileContentState,Us as Cesium3DTileContentType,ta as Cesium3DTileFeature,Zh as Cesium3DTileFeatureTable,Id as Cesium3DTileOptimizationHint,S3 as Cesium3DTileOptimizations,Ho as Cesium3DTilePass,lh as Cesium3DTilePassState,Vg as Cesium3DTilePointFeature,Zo as Cesium3DTileRefine,bS as Cesium3DTileStyle,R3 as Cesium3DTileStyleEngine,AH as Cesium3DTilesInspector,bH as Cesium3DTilesInspectorViewModel,yTe as Cesium3DTilesVoxelProvider,Ia as Cesium3DTileset,M3 as Cesium3DTilesetBaseTraversal,w3 as Cesium3DTilesetCache,KC as Cesium3DTilesetGraphics,I3 as Cesium3DTilesetHeatmap,lT as Cesium3DTilesetMetadata,O3 as Cesium3DTilesetMostDetailedTraversal,N3 as Cesium3DTilesetSkipTraversal,Zg as Cesium3DTilesetStatistics,ca as Cesium3DTilesetTraversal,B3 as Cesium3DTilesetVisualizer,PH as CesiumInspector,DH as CesiumInspectorViewModel,SE as CesiumTerrainProvider,I5 as CesiumWidget,To as Check,o1 as CheckerboardMaterialProperty,U5 as CircleEmitter,F0e as CircleGeometry,B0e as CircleOutlineGeometry,KF as ClassificationModelDrawCommand,tF as ClassificationPipelineStage,uv as ClassificationPrimitive,Vn as ClassificationType,ni as ClearCommand,gA as ClippingPlane,As as ClippingPlaneCollection,lw as ClippingPolygon,Yh as ClippingPolygonCollection,cm as Clock,Zr as ClockRange,Ao as ClockStep,dH as ClockViewModel,STe as CloudCollection,vI as CloudType,G as Color,Bc as ColorBlendMode,jt as ColorGeometryInstanceAttribute,Ht as ColorMaterialProperty,vEe as Command,K as ComponentDatatype,YL as Composite3DTileContent,que as CompositeEntityCollection,c1 as CompositeMaterialProperty,Pa as CompositePositionProperty,Hc as CompositeProperty,zP as CompressedTextureBuffer,cl as ComputeCommand,UP as ComputeEngine,N5 as ConditionsExpression,vTe as ConeEmitter,gl as ConstantPositionProperty,Kn as ConstantProperty,b2 as ConstantSpline,IB as ContentMetadata,UM as Context,Vt as ContextLimits,Rk as CoplanarPolygonGeometry,Gg as CoplanarPolygonGeometryLibrary,Rd as CoplanarPolygonOutlineGeometry,ki as CornerType,t2 as CorrelationGroup,yT as CorridorGeometry,ji as CorridorGeometryLibrary,Y3 as CorridorGeometryUpdater,WC as CorridorGraphics,q3 as CorridorOutlineGeometry,wt as Credit,bz as CreditDisplay,Or as CubeMap,tR as CubeMapFace,yC as CubicRealPolynomial,Ci as CullFace,bs as CullingVolume,ed as CumulusCloud,Q3 as CustomDataSource,k0e as CustomHeightmapTerrainProvider,hS as CustomShader,Ng as CustomShaderMode,fF as CustomShaderPipelineStage,xx as CustomShaderTranslucencyMode,J3 as CylinderGeometry,bT as CylinderGeometryLibrary,tk as CylinderGeometryUpdater,jC as CylinderGraphics,ek as CylinderOutlineGeometry,dk as CzmlDataSource,Kr as DataSource,lm as DataSourceClock,mk as DataSourceCollection,n4 as DataSourceDisplay,NTe as DebugAppearance,p_ as DebugCameraPrimitive,k8 as DebugInspector,W5 as DebugModelMatrixPrimitive,U0e as DefaultProxy,wc as DepthFunction,Sz as DepthPlane,dF as DequantizationPipelineStage,__ as DerivedCommand,he as DeveloperError,wz as DeviceOrientationCameraController,FTe as DirectionalLight,OD as DiscardEmptyTileImagePolicy,yU as DiscardMissingTileImagePolicy,Nt as DistanceDisplayCondition,kn as DistanceDisplayConditionGeometryInstanceAttribute,IE as DoubleEndedPriorityQueue,v3 as DoublyLinkedList,fg as DracoLoader,Qe as DrawCommand,Tg as DynamicAtmosphereLightingType,Eg as DynamicEnvironmentMapManager,LT as DynamicGeometryBatch,oi as DynamicGeometryUpdater,EP as EarthOrientationParameters,Cy as EarthOrientationParametersSample,Qr as EasingFunction,wl as EllipseGeometry,gu as EllipseGeometryLibrary,Tk as EllipseGeometryUpdater,qC as EllipseGraphics,Bf as EllipseOutlineGeometry,ee as Ellipsoid,Y_ as EllipsoidGeodesic,da as EllipsoidGeometry,Ek as EllipsoidGeometryUpdater,YC as EllipsoidGraphics,Df as EllipsoidOutlineGeometry,oz as EllipsoidPrimitive,Ka as EllipsoidRhumbLine,BTe as EllipsoidSurfaceAppearance,os as EllipsoidTangentPlane,h_ as EllipsoidTerrainProvider,i0 as EllipsoidalOccluder,Ww as Empty3DTileContent,Gn as EncodedCartesian3,ar as Entity,Mf as EntityCluster,la as EntityCollection,r4 as EntityView,me as Event,Ar as EventHelper,_d as Expression,pt as ExpressionNodeType,Lf as ExtrapolationType,Wt as FeatureDetection,yx as FeatureIdPipelineStage,Dz as Fog,Pe as ForEach,Y5 as FrameRateMonitor,Iz as FrameState,Hr as Framebuffer,pi as FramebufferManager,Fz as FrustumCommands,OE as FrustumGeometry,qV as FrustumOutlineGeometry,Pr as Fullscreen,LH as FullscreenButton,OH as FullscreenButtonViewModel,aV as GeoJsonDataSource,m2 as GeoJsonLoader,db as GeocodeType,BH as Geocoder,ED as GeocoderService,NH as GeocoderViewModel,Oi as GeographicProjection,$i as GeographicTilingScheme,ft as Geometry,tN as Geometry3DTileContent,ve as GeometryAttribute,hn as GeometryAttributes,X0e as GeometryFactory,vt as GeometryInstance,Dc as GeometryInstanceAttribute,an as GeometryOffsetAttribute,Nn as GeometryPipeline,pF as GeometryPipelineStage,ad as GeometryType,ri as GeometryUpdater,ZT as GeometryUpdaterSet,qk as GeometryVisualizer,jE as GetFeatureInfoFormat,nz as Globe,Bz as GlobeDepth,gU as GlobeSurfaceShaderSet,sh as GlobeSurfaceTile,jU as GlobeSurfaceTileProvider,qU as GlobeTranslucency,kz as GlobeTranslucencyFramebuffer,Pz as GlobeTranslucencyState,Wv as GltfBufferViewLoader,jv as GltfDracoLoader,i2 as GltfGpmLoader,pw as GltfGpmLocal,qv as GltfImageLoader,Yv as GltfIndexBufferLoader,Kv as GltfJsonLoader,Dg as GltfLoader,su as GltfLoaderUtil,a2 as GltfMeshPrimitiveGpmLoader,KN as GltfStructuralMetadataLoader,Jv as GltfTextureLoader,ew as GltfVertexBufferLoader,VTe as GoogleEarthEnterpriseImageryProvider,vU as GoogleEarthEnterpriseMapsProvider,j0 as GoogleEarthEnterpriseMetadata,SD as GoogleEarthEnterpriseTerrainData,iye as GoogleEarthEnterpriseTerrainProvider,KV as GoogleEarthEnterpriseTileInformation,ME as GoogleMaps,gV as GpxDataSource,R_ as GregorianDate,UTe as GridImageryProvider,y1 as GridMaterialProperty,Wn as GroundGeometryUpdater,VC as GroundPolylineGeometry,Rh as GroundPolylinePrimitive,_l as GroundPrimitive,Kw as GroupMetadata,Yd as HeadingPitchRange,Wa as HeadingPitchRoll,xP as Heap,Xe as HeightReference,eh as HeightmapEncoding,lc as HeightmapTerrainData,yD as HeightmapTessellator,ik as HermitePolynomialApproximation,px as HermiteSpline,Uv as HilbertOrder,UH as HomeButton,kH as HomeButtonViewModel,bi as HorizontalOrigin,XEe as I3SBuildingSceneLayerExplorer,jH as I3SBuildingSceneLayerExplorerViewModel,jm as I3SDataProvider,X5 as I3SDecoder,K5 as I3SFeature,$5 as I3SField,PI as I3SGeometry,AS as I3SLayer,RI as I3SNode,nH as I3SStatistics,iH as I3SSublayer,eH as I3SSymbology,x2 as I3dmLoader,_2 as I3dmParser,eU as Iau2000Orientation,wP as Iau2006XysData,dC as Iau2006XysSample,tU as IauOrientationAxes,JV as IauOrientationParameters,nA as ImageBasedLighting,L2 as ImageBasedLightingPipelineStage,jy as ImageMaterialProperty,BD as Imagery,dc as ImageryLayer,XU as ImageryLayerCollection,Mm as ImageryLayerFeatureInfo,Fl as ImageryProvider,ci as ImageryState,rw as Implicit3DTileContent,zv as ImplicitAvailabilityBitstream,Hv as ImplicitMetadataView,ss as ImplicitSubdivisionScheme,hA as ImplicitSubtree,F5 as ImplicitSubtreeCache,rN as ImplicitSubtreeMetadata,dT as ImplicitTileCoordinates,fT as ImplicitTileset,Be as IndexDatatype,GH as InfoBox,zH as InfoBoxViewModel,gc as InspectorShared,as as InstanceAttributeSemantic,K2 as InstancingPipelineStage,xye as InterpolationAlgorithm,Kh as InterpolationType,qt as Intersect,Qn as IntersectionTests,H0 as Intersections2D,qa as Interval,eI as InvertClassification,Vh as Ion,iU as IonGeocoderService,ey as IonImageryProvider,cf as IonResource,ty as IonWorldImageryStyle,He as Iso8601,Oz as JobScheduler,Qa as JobType,Sg as JsonMetadataTable,$ as JulianDate,HP as KTX2Transcoder,_a as KeyboardEventModifier,io as KeyframeNode,yV as KmlCamera,RV as KmlDataSource,xV as KmlLookAt,CV as KmlTour,TV as KmlTourFlyTo,EV as KmlTourWait,vx as Label,Lp as LabelCollection,Mh as LabelGraphics,$o as LabelStyle,Yk as LabelVisualizer,ok as LagrangePolynomialApproximation,Ki as LeapSecond,KTe as Light,Ip as LightingModel,gF as LightingPipelineStage,ET as LinearApproximation,mx as LinearSpline,yl as ManagedArray,Mu as MapMode2D,bye as MapProjection,wU as MapboxImageryProvider,$Te as MapboxStyleImageryProvider,Zi as Material,ho as MaterialAppearance,xF as MaterialPipelineStage,sr as MaterialProperty,R as Math,Hi as Matrix2,J as Matrix3,F as Matrix4,hI as Megatexture,s2 as MeshPrimitiveGpmLocal,jh as MetadataClass,tx as MetadataClassProperty,Gt as MetadataComponentType,Bn as MetadataEntity,DN as MetadataEnum,vN as MetadataEnumValue,Lz as MetadataPicking,_f as MetadataPickingPipelineStage,Ad as MetadataPipelineStage,hf as MetadataSchema,nw as MetadataSchemaLoader,mA as MetadataSemantic,ou as MetadataTable,aN as MetadataTableProperty,Et as MetadataType,ip as MipmapHint,Jh as Model,Rp as Model3DTileContent,BF as ModelAlphaOptions,E2 as ModelAnimation,T2 as ModelAnimationChannel,v2 as ModelAnimationCollection,cu as ModelAnimationLoop,$h as ModelAnimationState,B2 as ModelArticulation,N2 as ModelArticulationStage,U2 as ModelClippingPlanesPipelineStage,G2 as ModelClippingPolygonsPipelineStage,gx as ModelColorPipelineStage,bn as ModelComponents,$F as ModelDrawCommand,eB as ModelDrawCommands,w2 as ModelFeature,D2 as ModelFeatureTable,Z_ as ModelGraphics,YF as ModelLightingOptions,Z2 as ModelMatrixUpdateStage,W2 as ModelNode,kF as ModelRenderResources,Q2 as ModelRuntimeNode,NF as ModelRuntimePrimitive,nB as ModelSceneGraph,HF as ModelSilhouettePipelineStage,FF as ModelSkin,jF as ModelSplitterPipelineStage,iB as ModelStatistics,Cr as ModelType,Zt as ModelUtility,Kk as ModelVisualizer,az as Moon,CF as MorphTargetsPipelineStage,Cye as MorphWeightSpline,Nx as MortonOrder,OB as Multiple3DTileContent,zM as MultisampleFramebuffer,$H as NavigationHelpButton,KH as NavigationHelpButtonViewModel,kt as NearFarScalar,QTe as NeverTileDiscardPolicy,qF as NodeRenderResources,$2 as NodeStatisticsPipelineStage,XC as NodeTransformationProperty,Uz as OIT,cU as Occluder,to as OffsetGeometryInstanceAttribute,Eye as OpenCageGeocoderService,my as OpenStreetMapImageryProvider,_k as OrderedGroundPrimitiveCollection,wn as OrientedBoundingBox,sn as OrthographicFrustum,Gr as OrthographicOffCenterFrustum,Sye as Packable,vye as PackableForInterpolation,MI as Particle,tEe as ParticleBurst,iEe as ParticleEmitter,sEe as ParticleSystem,we as Pass,Tc as PassState,$_ as PathGraphics,Zk as PathVisualizer,nU as PeliasGeocoderService,ln as PerInstanceColorAppearance,sy as PerformanceDisplay,XH as PerformanceWatchdog,qH as PerformanceWatchdogViewModel,Ri as PerspectiveFrustum,Ll as PerspectiveOffCenterFrustum,Nz as PickDepth,zz as PickDepthFramebuffer,Hz as PickFramebuffer,f5 as PickedMetadataInfo,Jz as Picking,AF as PickingPipelineStage,I0 as PinBuilder,Ke as PixelDatatype,tt as PixelFormat,cn as Plane,wk as PlaneGeometry,Pk as PlaneGeometryUpdater,UL as PlaneGraphics,Ik as PlaneOutlineGeometry,rB as PntsLoader,HA as PntsParser,D5 as PointCloud,Ig as PointCloudEyeDomeLighting,Tp as PointCloudShading,EF as PointCloudStylingPipelineStage,ZC as PointGraphics,Ws as PointPrimitive,m1 as PointPrimitiveCollection,$k as PointVisualizer,Ag as PolygonGeometry,zn as PolygonGeometryLibrary,Lk as PolygonGeometryUpdater,Lh as PolygonGraphics,Za as PolygonHierarchy,Mk as PolygonOutlineGeometry,ai as PolygonPipeline,Td as Polyline,x1 as PolylineArrowMaterialProperty,im as PolylineCollection,rs as PolylineColorAppearance,b1 as PolylineDashMaterialProperty,b0 as PolylineGeometry,Jk as PolylineGeometryUpdater,C1 as PolylineGlowMaterialProperty,Pc as PolylineGraphics,Sa as PolylineMaterialAppearance,zx as PolylineOutlineMaterialProperty,Fi as PolylinePipeline,t4 as PolylineVisualizer,Nk as PolylineVolumeGeometry,sm as PolylineVolumeGeometryLibrary,Bk as PolylineVolumeGeometryUpdater,$C as PolylineVolumeGraphics,Fk as PolylineVolumeOutlineGeometry,Oh as PositionProperty,r0 as PositionPropertyArray,xo as PostProcessStage,C8 as PostProcessStageCollection,kl as PostProcessStageComposite,Zf as PostProcessStageLibrary,Kf as PostProcessStageSampleMode,sS as PostProcessStageTextureCache,r2 as PpeMetadata,xEe as PpeSource,o2 as PpeTexture,In as Primitive,_u as PrimitiveCollection,vA as PrimitiveLoadPlan,SA as PrimitiveOutlineGenerator,wF as PrimitiveOutlinePipelineStage,NC as PrimitivePipeline,XF as PrimitiveRenderResources,Lr as PrimitiveState,DF as PrimitiveStatisticsPipelineStage,Ne as PrimitiveType,r6 as ProjectionPicker,i6 as ProjectionPickerViewModel,Y as Property,A1 as PropertyArray,TA as PropertyAttribute,qN as PropertyAttributeProperty,Ql as PropertyBag,Cl as PropertyTable,vg as PropertyTexture,jN as PropertyTextureProperty,ps as ProviderViewModel,Iye as Proxy,ul as QuadraticRealPolynomial,KU as QuadtreeOccluders,tz as QuadtreePrimitive,$U as QuadtreeTile,ga as QuadtreeTileLoadState,aEe as QuadtreeTileProvider,EE as QuantizedMeshTerrainData,WP as QuarticRealPolynomial,Le as Quaternion,A2 as QuaternionSpline,lx as Queue,_n as Ray,se as Rectangle,JT as RectangleCollisionChecker,qT as RectangleGeometry,Hs as RectangleGeometryLibrary,kk as RectangleGeometryUpdater,Nh as RectangleGraphics,tT as RectangleOutlineGeometry,Gi as ReferenceFrame,a0 as ReferenceProperty,Ue as RenderState,Ju as Renderbuffer,hl as RenderbufferFormat,rr as Request,Zm as RequestErrorEvent,Cc as RequestScheduler,$n as RequestState,gs as RequestType,De as Resource,wi as ResourceCache,au as ResourceCacheKey,RN as ResourceCacheStatistics,Qi as ResourceLoader,_t as ResourceLoaderState,Fd as Rotation,ce as RuntimeError,lg as S2Cell,sa as SDFSettings,Ra as SampledPositionProperty,Nf as SampledProperty,Qt as Sampler,o_ as ScaledPositionProperty,m5 as Scene,nS as SceneFramebuffer,ne as SceneMode,IF as SceneMode2DPipelineStage,t6 as SceneModePicker,JH as SceneModePickerViewModel,Wi as SceneTransforms,T8 as SceneTransitioner,L8 as ScreenSpaceCameraController,Wf as ScreenSpaceEventHandler,Cn as ScreenSpaceEventType,bx as SelectedFeatureIdPipelineStage,l6 as SelectionIndicator,a6 as SelectionIndicatorViewModel,S1 as SensorVolumePortionToDisplay,wC as ShaderBuilder,LM as ShaderCache,_e as ShaderDestination,WM as ShaderFunction,tn as ShaderProgram,ze as ShaderSource,GM as ShaderStruct,cy as ShadowMap,x_ as ShadowMapShader,xn as ShadowMode,of as ShadowVolumeAppearance,yn as ShowGeometryInstanceAttribute,Ly as Simon1994PlanetaryPositions,Yye as SimplePolylineGeometry,DU as SingleTileImageryProvider,RF as SkinningPipelineStage,g5 as SkyAtmosphere,b5 as SkyBox,s5 as SpatialNode,n2 as Spdcf,kh as SpecularEnvironmentCubeMap,cEe as SphereEmitter,Xye as SphereGeometry,jg as SphereOutlineGeometry,rk as Spherical,ao as Spline,Wr as SplitDirection,CI as Splitter,Hd as StaticGeometryColorBatch,Wd as StaticGeometryPerMaterialBatch,k1 as StaticGroundGeometryColorBatch,jk as StaticGroundGeometryPerMaterialBatch,e4 as StaticGroundPolylinePerMaterialBatch,V1 as StaticOutlineGeometryBatch,Ut as StencilConstants,Un as StencilFunction,mt as StencilOperation,C2 as SteppedSpline,Fc as Stereographic,dx as StorageType,T1 as StripeMaterialProperty,um as StripeOrientation,oa as StructuralMetadata,Qh as StyleCommandsNeeded,lEe as StyleExpression,E5 as Sun,H_ as SunLight,B8 as SunPostProcess,QN as SupportedImageFormats,fH as SvgPathBindingHandler,xi as TaskProcessor,aH as Terrain,Im as TerrainData,Zc as TerrainEncoding,UD as TerrainFillMesh,th as TerrainMesh,eA as TerrainOffsetProperty,ds as TerrainProvider,pa as TerrainQuantization,yo as TerrainState,Ot as Texture,Tx as TextureAtlas,FM as TextureCache,mi as TextureMagnificationFilter,l5 as TextureManager,$t as TextureMinificationFilter,gEe as TextureUniform,En as TextureWrap,Pm as TileAvailability,Pd as TileBoundingRegion,FB as TileBoundingS2Cell,qg as TileBoundingSphere,uEe as TileBoundingVolume,cH as TileCoordinatesImageryProvider,fEe as TileDiscardPolicy,gn as TileEdge,kD as TileImagery,_b as TileMapServiceImageryProvider,PB as TileMetadata,If as TileOrientedBoundingBox,Oo as TileProviderError,JU as TileReplacementQueue,Xn as TileSelectionResult,dEe as TileState,aB as Tileset3DTileContent,E3 as TilesetMetadata,I2 as TilesetPipelineStage,Kye as TilingScheme,Yn as TimeConstants,qE as TimeDynamicImagery,TI as TimeDynamicPointCloud,Sn as TimeInterval,Xr as TimeIntervalCollection,l0 as TimeIntervalCollectionPositionProperty,u0 as TimeIntervalCollectionProperty,jn as TimeStandard,d6 as Timeline,u6 as TimelineHighlightRange,f6 as TimelineTrack,YP as Tipsify,jb as ToggleButtonViewModel,uy as Tonemapper,Lt as Transforms,Yy as TranslationRotationScale,jz as TranslucentTileClassification,xw as TridiagonalSystemSolver,FS as TrustedServers,cS as TweenCollection,VM as UniformState,_I as UniformType,fc as UrlTemplateImageryProvider,huo as VERSION,_6 as VRButton,m6 as VRButtonViewModel,Jye as VRTheWorldTerrainProvider,yEe as VaryingType,mp as Vector3DTileBatch,vB as Vector3DTileClampedPolylines,DB as Vector3DTileContent,rg as Vector3DTileGeometry,CB as Vector3DTilePoints,AB as Vector3DTilePolygons,KA as Vector3DTilePolylines,rA as Vector3DTilePrimitive,ak as VelocityOrientationProperty,OT as VelocityVectorProperty,ii as VertexArray,G_ as VertexArrayFacade,Tt as VertexAttributeSemantic,Ie as VertexFormat,Mr as VerticalExaggeration,MF as VerticalExaggerationPipelineStage,On as VerticalOrigin,Zye as VideoSynchronizer,oS as View,aSe as Viewer,hEe as ViewportQuad,Sr as Visibility,l0e as Visualizer,T_ as VoxelBoxShape,V8 as VoxelCell,k5 as VoxelContent,E_ as VoxelCylinderShape,fS as VoxelEllipsoidShape,x6 as VoxelInspector,g6 as VoxelInspectorViewModel,Nb as VoxelPrimitive,mEe as VoxelProvider,e5 as VoxelRenderResources,pEe as VoxelShape,zi as VoxelShapeType,pI as VoxelTraversal,exe as VulkanConstants,Uk as WallGeometry,XT as WallGeometryLibrary,Hk as WallGeometryUpdater,Q_ as WallGraphics,zk as WallOutlineGeometry,te as WebGLConstants,PU as WebMapServiceImageryProvider,RU as WebMapTileServiceImageryProvider,Li as WebMercatorProjection,hs as WebMercatorTilingScheme,xs as WindingOrder,Sw as WireframeIndexGenerator,LF as WireframePipelineStage,e8 as _shadersAcesTonemappingStage,N8 as _shadersAdditiveBlend,tI as _shadersAdjustTranslucentFS,YM as _shadersAllMaterialAppearanceFS,XM as _shadersAllMaterialAppearanceVS,t8 as _shadersAmbientOcclusionGenerate,n8 as _shadersAmbientOcclusionModulate,JM as _shadersAspectRampMaterial,Xh as _shadersAtmosphereCommon,P2 as _shadersAtmosphereStageFS,R2 as _shadersAtmosphereStageVS,KM as _shadersBasicMaterialAppearanceFS,ZM as _shadersBasicMaterialAppearanceVS,cB as _shadersBillboardCollectionFS,lB as _shadersBillboardCollectionVS,i8 as _shadersBlackAndWhite,o8 as _shadersBloomComposite,cz as _shadersBrdfLutGeneratorFS,F8 as _shadersBrightPass,r8 as _shadersBrightness,eL as _shadersBumpMapMaterial,iF as _shadersCPUStylingStageFS,nF as _shadersCPUStylingStageVS,tL as _shadersCheckerboardMaterial,P5 as _shadersCloudCollectionFS,R5 as _shadersCloudCollectionVS,O5 as _shadersCloudNoiseFS,M5 as _shadersCloudNoiseVS,Wz as _shadersCompareAndPackTranslucentDepth,Vz as _shadersCompositeOITFS,iS as _shadersCompositeTranslucentClassification,zN as _shadersComputeIrradianceFS,HN as _shadersComputeRadianceMapFS,s8 as _shadersContrastBias,GN as _shadersConvolveSpecularMapFS,WN as _shadersConvolveSpecularMapVS,sF as _shadersCustomShaderStageFS,rF as _shadersCustomShaderStageVS,TC as _shadersCzmBuiltins,a8 as _shadersDepthOfField,Az as _shadersDepthPlaneFS,Tz as _shadersDepthPlaneVS,c8 as _shadersDepthView,_Ee as _shadersDepthViewPacked,nL as _shadersDotMaterial,l8 as _shadersEdgeDetection,iL as _shadersElevationBandMaterial,oL as _shadersElevationContourMaterial,rL as _shadersElevationRampMaterial,WD as _shadersEllipsoidFS,j5 as _shadersEllipsoidSurfaceAppearanceFS,q5 as _shadersEllipsoidSurfaceAppearanceVS,jD as _shadersEllipsoidVS,d8 as _shadersFXAA,y8 as _shadersFXAA3_11,sL as _shadersFadeMaterial,aF as _shadersFeatureIdStageFS,cF as _shadersFeatureIdStageVS,u8 as _shadersFilmicTonemapping,Sb as _shadersGaussianBlur1D,hF as _shadersGeometryStageFS,mF as _shadersGeometryStageVS,pU as _shadersGlobeFS,_U as _shadersGlobeVS,aL as _shadersGridMaterial,ID as _shadersGroundAtmosphere,MO as _shadersHSBToRGB,LO as _shadersHSLToRGB,M2 as _shadersImageBasedLightingStageFS,j2 as _shadersInstancingStageCommon,q2 as _shadersInstancingStageVS,q8 as _shadersIntersectBox,j8 as _shadersIntersectClippingPlanes,Y8 as _shadersIntersectCylinder,W8 as _shadersIntersectDepth,X8 as _shadersIntersectEllipsoid,dI as _shadersIntersectLongitude,uS as _shadersIntersection,G8 as _shadersIntersectionUtils,Y2 as _shadersLegacyInstancingStageVS,h8 as _shadersLensFlare,_F as _shadersLightingStageFS,yF as _shadersMaterialStageFS,J8 as _shadersMegatexture,lF as _shadersMetadataStageFS,uF as _shadersMetadataStageVS,V2 as _shadersModelClippingPlanesStageFS,H2 as _shadersModelClippingPolygonsStageFS,z2 as _shadersModelClippingPolygonsStageVS,k2 as _shadersModelColorStageFS,JF as _shadersModelFS,VF as _shadersModelSilhouetteStageFS,UF as _shadersModelSilhouetteStageVS,GF as _shadersModelSplitterStageFS,QF as _shadersModelVS,m8 as _shadersModifiedReinhardTonemapping,bF as _shadersMorphTargetsStageVS,p8 as _shadersNightVision,cL as _shadersNormalMapMaterial,Q8 as _shadersOctree,Lu as _shadersPassThrough,Ab as _shadersPassThroughDepth,f8 as _shadersPbrNeutralTonemapping,yL as _shadersPerInstanceColorAppearanceFS,xL as _shadersPerInstanceColorAppearanceVS,OC as _shadersPerInstanceFlatColorAppearanceFS,bL as _shadersPerInstanceFlatColorAppearanceVS,u2 as _shadersPointCloudEyeDomeLighting,TF as _shadersPointCloudStylingStageVS,kx as _shadersPointPrimitiveCollectionFS,Z3 as _shadersPointPrimitiveCollectionVS,UN as _shadersPolygonSignedDistanceFS,lL as _shadersPolylineArrowMaterial,kL as _shadersPolylineColorAppearanceVS,rf as _shadersPolylineCommon,uL as _shadersPolylineDashMaterial,UC as _shadersPolylineFS,fL as _shadersPolylineGlowMaterial,VL as _shadersPolylineMaterialAppearanceVS,dL as _shadersPolylineOutlineMaterial,LL as _shadersPolylineShadowVolumeFS,NL as _shadersPolylineShadowVolumeMorphFS,FL as _shadersPolylineShadowVolumeMorphVS,BL as _shadersPolylineShadowVolumeVS,_B as _shadersPolylineVS,vF as _shadersPrimitiveOutlineStageFS,SF as _shadersPrimitiveOutlineStageVS,sM as _shadersRGBToHSB,aM as _shadersRGBToHSL,cM as _shadersRGBToXYZ,_8 as _shadersReinhardTonemapping,OU as _shadersReprojectWebMercatorFS,MU as _shadersReprojectWebMercatorVS,hL as _shadersRimLightingMaterial,Tw as _shadersSelectedFeatureIdStageCommon,lv as _shadersShadowVolumeAppearanceFS,EL as _shadersShadowVolumeAppearanceVS,Uy as _shadersShadowVolumeFS,g8 as _shadersSilhouette,PF as _shadersSkinningStageVS,yI as _shadersSkyAtmosphereCommon,p5 as _shadersSkyAtmosphereFS,_5 as _shadersSkyAtmosphereVS,y5 as _shadersSkyBoxFS,x5 as _shadersSkyBoxVS,mL as _shadersSlopeRampMaterial,pL as _shadersStripeMaterial,C5 as _shadersSunFS,A5 as _shadersSunTextureFS,T5 as _shadersSunVS,$M as _shadersTexturedMaterialAppearanceFS,QM as _shadersTexturedMaterialAppearanceVS,SB as _shadersVector3DTileClampedPolylinesFS,EB as _shadersVector3DTileClampedPolylinesVS,TB as _shadersVector3DTilePolylinesVS,Vv as _shadersVectorTileVS,OF as _shadersVerticalExaggerationStageVS,L5 as _shadersViewportQuadFS,pC as _shadersViewportQuadVS,z8 as _shadersVoxelFS,U8 as _shadersVoxelUtils,H8 as _shadersVoxelVS,gL as _shadersWater,_L as _shadersWaterMaskMaterial,OM as _shadersXYZToRGB,$R as _shadersacesTonemapping,QR as _shadersalphaWeight,JR as _shadersantialias,eO as _shadersapplyHSBShift,tO as _shadersapproximateSphericalCoordinates,nO as _shadersapproximateTanh,iO as _shadersbackFacing,oO as _shadersbranchFreeTernary,rO as _shaderscascadeColor,sO as _shaderscascadeDistance,aO as _shaderscascadeMatrix,cO as _shaderscascadeWeights,lO as _shadersclipPolygons,uO as _shaderscolumbusViewMorph,fO as _shaderscomputeAtmosphereColor,dO as _shaderscomputeGroundAtmosphereScattering,hO as _shaderscomputePosition,mO as _shaderscomputeScattering,K8 as _shadersconvertUvToBox,Z8 as _shadersconvertUvToCylinder,$8 as _shadersconvertUvToEllipsoid,pO as _shaderscosineAndSine,_O as _shadersdecompressTextureCoordinates,rR as _shadersdegreesPerRadian,gO as _shadersdepthClamp,sR as _shadersdepthRange,GR as _shadersdepthRangeStruct,yO as _shaderseastNorthUpToEyeCoordinates,xO as _shadersellipsoidContainsPoint,bO as _shadersellipsoidTextureCoordinates,aR as _shadersepsilon1,cR as _shadersepsilon2,lR as _shadersepsilon3,uR as _shadersepsilon4,fR as _shadersepsilon5,dR as _shadersepsilon6,hR as _shadersepsilon7,CO as _shadersequalsEpsilon,AO as _shaderseyeOffset,TO as _shaderseyeToWindowCoordinates,EO as _shadersfastApproximateAtan,SO as _shadersfog,vO as _shadersgammaCorrect,wO as _shadersgeodeticSurfaceNormal,DO as _shadersgetDefaultMaterial,IO as _shadersgetDynamicAtmosphereLightDirection,PO as _shadersgetLambertDiffuse,RO as _shadersgetSpecular,OO as _shadersgetWaterNoise,NO as _shadershue,mR as _shadersinfinity,FO as _shadersinverseGamma,BO as _shadersisEmpty,kO as _shadersisFull,VO as _shaderslatitudeToWebMercatorFraction,zO as _shaderslineDistance,UO as _shaderslinearToSrgb,HO as _shadersluminance,WR as _shadersmaterial,jR as _shadersmaterialInput,GO as _shadersmaximumComponent,WO as _shadersmetersPerPixel,qR as _shadersmodelMaterial,jO as _shadersmodelToWindowCoordinates,YR as _shadersmodelVertexOutput,qO as _shadersmultiplyWithColorBalance,YO as _shadersnearFarScalar,XO as _shadersoctDecode,pR as _shadersoneOverPi,_R as _shadersoneOverTwoPi,KO as _shaderspackDepth,gR as _shaderspassCesium3DTile,yR as _shaderspassCesium3DTileClassification,xR as _shaderspassCesium3DTileClassificationIgnoreShow,bR as _shaderspassClassification,CR as _shaderspassCompute,AR as _shaderspassEnvironment,TR as _shaderspassGlobe,ER as _shaderspassOpaque,SR as _shaderspassOverlay,vR as _shaderspassTerrainClassification,wR as _shaderspassTranslucent,DR as _shaderspassVoxels,ZO as _shaderspbrLighting,$O as _shaderspbrNeutralTonemapping,QO as _shadersphong,IR as _shaderspi,PR as _shaderspiOverFour,RR as _shaderspiOverSix,OR as _shaderspiOverThree,MR as _shaderspiOverTwo,JO as _shadersplaneDistance,eM as _shaderspointAlongRay,LR as _shadersradiansPerDegree,XR as _shadersray,tM as _shadersrayEllipsoidIntersectionInterval,KR as _shadersraySegment,nM as _shadersraySphereIntersectionInterval,iM as _shadersreadDepth,oM as _shadersreadNonPerspective,rM as _shadersreverseLogDepth,lM as _shadersround,uM as _shaderssaturation,NR as _shaderssceneMode2D,FR as _shaderssceneMode3D,BR as _shaderssceneModeColumbusView,kR as _shaderssceneModeMorphing,fM as _shadersshadowDepthCompare,ZR as _shadersshadowParameters,dM as _shadersshadowVisibility,hM as _shaderssignNotZero,VR as _shaderssolarRadius,mM as _shaderssphericalHarmonics,pM as _shaderssrgbToLinear,_M as _shaderstangentToEyeSpaceMatrix,gM as _shaderstextureCube,UR as _shadersthreePiOver2,yM as _shaderstransformPlane,xM as _shaderstranslateRelativeToEye,bM as _shaderstranslucentPhong,CM as _shaderstranspose,zR as _shaderstwoPi,AM as _shadersunpackClippingExtents,TM as _shadersunpackDepth,EM as _shadersunpackFloat,SM as _shadersunpackUint,vM as _shadersvalueTransform,wM as _shadersvertexLogDepth,HR as _shaderswebMercatorMaxLatitude,DM as _shaderswindowToEyeCoordinates,IM as _shaderswriteDepthClamp,PM as _shaderswriteLogDepth,RM as _shaderswriteNonPerspective,yN as addBuffer,cN as addDefaults,pN as addExtensionsRequired,yd as addExtensionsUsed,ox as addPipelineExtras,ks as addToArray,pP as appendForwardSlash,Eo as arrayRemoveDuplicates,gC as barycentricCoordinates,No as binarySearch,on as buildModuleUrl,i5 as buildVoxelDrawCommands,Ge as clone,bt as combine,kE as computeFlyToLocationForRectangle,WA as createBillboardPointCallback,vn as createCommand,vH as createDefaultImageryProviderViewModels,wH as createDefaultTerrainProviderViewModels,PTe as createElevationBandMaterial,OTe as createGooglePhotorealistic3DTileset,Hn as createGuid,Bo as createMaterialPropertyDescriptor,MTe as createOsmBuildingsAsync,le as createPropertyDescriptor,$l as createRawPropertyDescriptor,LTe as createTangentSpaceDebugPrimitive,bEe as createTaskProcessorWorker,FP as createUniform,BP as createUniformArray,HV as createWorldBathymetryAsync,ny as createWorldImageryAsync,wE as createWorldTerrainAsync,GV as decodeGoogleEarthEnterpriseData,wB as decodeVectorPolylinePositions,x as defaultValue,Wl as defer,u as defined,MM as demodernizeShader,ys as deprecationWarning,ue as destroyObject,b_e as exportKml,uA as findAccessorMinMax,$A as findContentMetadata,QA as findGroupMetadata,RB as findTileMetadata,Xv as forEachTextureInMaterial,f_ as formatError,FQ as freezeRenderState,Km as getAbsoluteUri,ru as getAccessorByteStride,_P as getBaseUri,uf as getBinaryAccessor,S5 as getClipAndStyleCode,Q0 as getClippingFunction,mg as getComponentReader,Rn as getElement,rC as getExtensionFromUri,o0 as getFilenameFromUri,XV as getImageFromTypedArray,yh as getImagePixels,Uo as getJsonFromTypedArray,zh as getMagic,u5 as getMetadataClassProperty,tu as getStringFromTypedArray,Ei as getTimestamp,si as hasExtension,J_ as heightReferenceOnEntityPropertyChanged,Qc as isBitSet,sC as isBlobUri,Ay as isCrossOriginUrl,M_ as isDataUri,gh as isLeapYear,be as knockout,vS as knockout_3_5_1,uH as knockout_es5,aC as loadAndExecuteScript,HM as loadCubeMap,cA as loadImageFromTypedArray,jl as loadKTX2,Y0 as mergeSort,mN as moveTechniqueRenderStates,_N as moveTechniquesToExtension,df as numberOfComponentsForType,cC as objectToQuery,At as oneTimeWarning,Pg as parseBatchTable,XN as parseFeatureMetadataLegacy,fN as parseGlb,yP as parseResponseHeaders,YN as parseStructuralMetadata,Dw as pickModel,wye as pointInsideTriangle,zp as preprocess3DTileContent,n5 as processVoxelProperties,Xu as queryToObject,xN as readAccessorPacked,fA as removeExtension,uN as removeExtensionsRequired,lA as removeExtensionsUsed,hN as removePipelineExtras,gN as removeUnusedElements,sx as resizeImageToNextPowerOfTwo,lU as sampleTerrain,NE as sampleTerrainMostDetailed,tC as scaleToGeodeticSurface,BE as srgbToLinear,SL as subdivideArray,Ba as subscribeAndEvaluate,CN as updateAccessorComponentTypes,TN as updateVersion,xr as usesExtension,cSe as viewerCesium3DTilesInspectorMixin,lSe as viewerCesiumInspectorMixin,fSe as viewerDragDropMixin,dSe as viewerPerformanceWatchdogMixin,mSe as viewerVoxelInspectorMixin,txe as webGLConstantToGlslType,mU as wrapFunction,qA as writeTextToCanvas};
